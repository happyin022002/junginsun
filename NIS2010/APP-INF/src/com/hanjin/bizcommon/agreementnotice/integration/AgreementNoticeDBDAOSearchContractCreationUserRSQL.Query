<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AgreementNoticeDBDAOSearchContractCreationUserRSQL">
			<desc><![CDATA[SearchContractCreationUser]]></desc>
			<sql><![CDATA[
SELECT SYS_CD
     , AGMT_NO
     , CTRT_UPD_USR_ID
     , OFC_CD
     , CTRT_UPD_DT
     , USE_FLG
     , AGMT_EFF_DT
     , AGMT_EXP_DT
FROM (  SELECT SYS_CD
             , CASE WHEN SYS_CD = 'TRS' THEN SUBSTR(AGMT_NO,1,INSTR(AGMT_NO,'-',1,1)-1)
                    ELSE AGMT_NO
               END AS AGMT_NO
             , CTRT_UPD_USR_ID
             , (SELECT COM.OFC_CD FROM COM_USER COM WHERE COM.USR_ID = CTRT_UPD_USR_ID) AS OFC_CD
             , TO_CHAR(CTRT_UPD_DT,'YYYY-MM-DD') AS CTRT_UPD_DT
             , NVL((SELECT COM.USE_FLG FROM COM_USER COM WHERE COM.USR_ID = CTRT_UPD_USR_ID),'N') AS USE_FLG
             , TO_CHAR(AGMT_EFF_DT,'YYYY-MM-DD') AS AGMT_EFF_DT
             , TO_CHAR(AGMT_EXP_DT,'YYYY-MM-DD') AS AGMT_EXP_DT
             , ROW_NUMBER() OVER (PARTITION BY CTRT_UPD_USR_ID ORDER BY CTRT_UPD_DT DESC) AS ROW_NUM
             , '' AS OFC_TP_CD
             , '' AS CTRT_OFC_CD
             , '' AS AGMT_MAPG_NO
          FROM COM_CTRT_NTC_INFO
         WHERE 1=1 
           AND SYS_CD = @[sys_cd] 
           AND CTRT_OFC_CD = @[ctrt_ofc_cd]
        #if(${agmt_mapg_no} != '')
           AND AGMT_NO LIKE '%'||@[agmt_mapg_no]||'%'
        #end
      )
WHERE ROW_NUM = 1 			]]></sql>
			<params>
				<param name="sys_cd" type="12" value="" out="N"/>
				<param name="ctrt_ofc_cd" type="12" value="" out="N"/>
				<param name="agmt_mapg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
