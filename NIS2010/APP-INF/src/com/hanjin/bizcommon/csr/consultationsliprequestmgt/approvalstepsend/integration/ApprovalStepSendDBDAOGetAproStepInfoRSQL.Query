<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ApprovalStepSendDBDAOGetAproStepInfoRSQL">
			<desc><![CDATA[Approval Step info 조회]]></desc>
			<sql><![CDATA[
SELECT 
D.CSR_NO, TO_CHAR(R.APRO_DT,'YYYYMMDD') APRO_DT, R.APRO_OFC_CD, R.APRO_USR_ID
,
CASE
WHEN H.CRNT_APRO_SEQ = (SELECT MAX(X.APRO_RQST_SEQ)
                        FROM COM_APRO_RQST_ROUT X
                        WHERE 1=1
                        AND X.APRO_RQST_NO = H.APRO_RQST_NO)
THEN 'Y'
ELSE 'N'
END CHK_VAL
FROM COM_APRO_CSR_DTL D, COM_APRO_RQST_HDR H, COM_APRO_RQST_ROUT R
WHERE 1=1
AND D.APRO_RQST_NO = H.APRO_RQST_NO
AND D.CSR_NO =  @[csr_no]
--AND H.APRO_KND_CD = 'CSR'
AND H.APSTS_CD = 'C'
AND H.APRO_RQST_NO = R.APRO_RQST_NO
AND R.APRO_RQST_SEQ = (
    SELECT MAX(X.APRO_RQST_SEQ)
    FROM COM_APRO_RQST_ROUT X
    WHERE 1=1
    AND X.APRO_RQST_NO = H.APRO_RQST_NO
)			]]></sql>
			<params>
				<param name="csr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
