<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ConsultationSlipRequestMgtDBDAOSearchErpInterfaceListRSQL">
			<desc><![CDATA[ERP Interface list search]]></desc>
			<sql><![CDATA[
SELECT
      A.CSR_NO
    , A.VNDR_NO
    , (SELECT DECODE(VNDR_CNT_CD,'KR',VNDR_LOCL_LANG_NM,VNDR_LGL_ENG_NM)
         FROM MDM_VENDOR
        WHERE VNDR_SEQ = A.VNDR_NO
     ) INV_DESC              
    , TO_CHAR(A.IF_DT,'YYYY-MM-DD') IF_DT
    , A.IF_ERR_RSN
    , A.CSR_CURR_CD
       , DECODE(A.CSR_CURR_CD, 'KRW', ROUND(NVL(A.CSR_AMT,0),0)
          				  , 'JPY', ROUND(NVL(A.CSR_AMT,0),0)
    					  , ROUND(NVL(A.CSR_AMT,0),2)) CSR_AMT
    , A.CSR_USD_AMT
    , SUBSTR(A.INV_TERM_DT, 1, 4) ||'/' ||SUBSTR(A.INV_TERM_DT, 5, 2) ||'/' ||SUBSTR(A.INV_TERM_DT, 7, 2) DUE_DT
    , A.IF_FLG	   
    , NVL(A.CSR_APRO_TP_CD,'AL') CSR_APRO_TP_CD
     , (SELECT H.CORR_HIS_RMK
        FROM COM_AP_CSR_HIS H
        WHERE H.CSR_NO = A.CSR_NO
          AND H.COM_AP_CSR_APRO_HIS_SEQ =
           (
                SELECT 
                MAX(D.COM_AP_CSR_APRO_HIS_SEQ)
                FROM COM_AP_CSR_HIS D
                WHERE 1=1
                AND D.CSR_NO = A.CSR_NO
            )
        ) CORR_HIS_RMK
    FROM  AP_INV_HDR A , COM_APRO_SND_MN_RULE R
WHERE 1=1
	AND A.SRC_CTNT = R.SRC_CTNT(+)
    AND A.CSR_NO LIKE @[search_csr_no]||'%'			]]></sql>
			<params>
				<param name="search_csr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
