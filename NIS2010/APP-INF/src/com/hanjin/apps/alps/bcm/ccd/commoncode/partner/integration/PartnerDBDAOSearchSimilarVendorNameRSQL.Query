<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PartnerDBDAOSearchSimilarVendorNameRSQL">
			<desc><![CDATA[신규코드 생성 전에 유사한 Vendor명을 pop-up으로 조회 (BCM_CCD_1040)]]></desc>
			<sql><![CDATA[
SELECT VNDR_SEQ CODE, 
       VNDR_LGL_ENG_NM NAME,
       LOC_CD LOCATION,
       OFC_CD OFFICE
FROM  MDM_VENDOR
WHERE 1=1
#if (${match_rule} == 'I')
AND  UPPER(REPLACE(TRIM(VNDR_LGL_ENG_NM),' ','')) like '%'||UPPER(REPLACE(DECODE(instr(@[name], ' ',1,2), 0, TRIM(@[name]), TRIM(SUBSTR(@[name], 1, instr(@[name], ' ',1,2)))),' ',''))||'%'
#elseif (${match_rule} == 'E')
AND  UPPER(REPLACE(TRIM(VNDR_LGL_ENG_NM),' ','')) = UPPER(REPLACE(TRIM(@[name]),' ',''))
#elseif (${match_rule} == 'S')
AND  UPPER(REPLACE(TRIM(VNDR_LGL_ENG_NM),' ','')) like UPPER(REPLACE(DECODE(instr(@[name], ' ',1,2), 0, TRIM(@[name]), TRIM(SUBSTR(@[name], 1, instr(@[name], ' ',1,2)))),' ',''))||'%'
#end
#if (${vndr_cnt_cd} != '')
AND VNDR_CNT_CD = @[vndr_cnt_cd]
#else
#end
ORDER BY NAME, LOCATION			]]></sql>
			<params>
				<param name="name" type="12" value="" out="N"/>
				<param name="vndr_cnt_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
