<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PartnerDBDAOmergeVndrToCustAddrCSQL">
			<desc><![CDATA[Create TPB Customer를 체크항 경우 Vendor 정보를 MDM_CUST_ADDR 테이블에 입력]]></desc>
			<sql><![CDATA[
MERGE INTO mdm_cust_addr a										
 USING ( select substr(@[rfnd_psdo_cust_cd], 1, 2) cust_cnt_cd, @[vndr_seq] cust_seq from dual ) b           
 ON (a.cust_cnt_cd = b.cust_cnt_cd and a.cust_seq = b.cust_seq )  
 WHEN MATCHED THEN                                                
 update                                                           
 set                                                              
 	PRMRY_CHK_FLG  = 'Y',                                           
 	upd_usr_id  = @[upd_usr_id],                                                
 	upd_dt      = sysdate,          
	bzet_nm	    = @[bzct_nm],          
	bzet_addr   = @[eng_addr],                    
 	locl_addr1  = @[locl_lang_addr],
 	locl_addr2  = @[chk_de_addr1],
 	locl_addr3  = @[chk_de_addr2],
 	locl_addr4  = @[chk_de_addr3]
      
 WHEN NOT MATCHED THEN                                            
 insert                                                           
 (                                                                
 	cust_cnt_cd,                                                    
 	cust_seq,                                                       
 	addr_tp_cd,                                                     
 	addr_seq,                                                       
 	PRMRY_CHK_FLG,                                                  
 	bzet_nm,
	bzet_addr,
 	cre_usr_id,                                                     
 	cre_dt,                                                         
 	upd_usr_id,                                                     
 	upd_dt,                                                         
 	delt_flg,                                                       
 	locl_addr1,                                                     
 	locl_addr2,                                                     
 	locl_addr3,                                                     
 	locl_addr4
 )                                                                
 values                                                           
 (                                                                
 	substr(@[rfnd_psdo_cust_cd], 1, 2),                                              				
 	@[vndr_seq],        
 	'1',                                              				
 	@[vndr_seq],                                                				
 	'Y',                                                				
 	@[bzct_nm],
 	@[eng_addr],                  		
 	@[cre_usr_id],                                                     			
 	to_date(substr(@[cre_dt], 1, 19),'YYYY-MM-DD HH24:MI:SS'),                                  
 	@[upd_usr_id],                                                     			
 	to_date(substr(@[upd_dt], 1, 19),'YYYY-MM-DD HH24:MI:SS'), 					           		
 	'N',                                                            
 	@[locl_lang_addr],
	@[chk_de_addr1],
	@[chk_de_addr2],
	@[chk_de_addr3]
 )			]]></sql>
			<params>
				<param name="rfnd_psdo_cust_cd" type="12" value="" out="N"/>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="bzct_nm" type="12" value="" out="N"/>
				<param name="eng_addr" type="12" value="" out="N"/>
				<param name="locl_lang_addr" type="12" value="" out="N"/>
				<param name="chk_de_addr1" type="12" value="" out="N"/>
				<param name="chk_de_addr2" type="12" value="" out="N"/>
				<param name="chk_de_addr3" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="cre_dt" type="12" value="" out="N"/>
				<param name="upd_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
