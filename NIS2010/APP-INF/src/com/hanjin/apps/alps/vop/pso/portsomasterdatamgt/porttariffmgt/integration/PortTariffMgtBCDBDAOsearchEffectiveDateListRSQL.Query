<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PortTariffMgtBCDBDAOsearchEffectiveDateListRSQL">
			<desc><![CDATA[pso_yd_charge_xpr의 version정보를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT DISTINCT 
	   A.YD_CHG_NO
      ,TRIM(TO_CHAR(A.YD_CHG_VER_SEQ, '000')) VER
      ,TO_CHAR(A.EFF_DT, 'YYYY-MM-DD') EFF_DT
      ,TO_CHAR(A.EXP_DT, 'YYYY-MM-DD') EXP_DT
      ,A.CURR_CD   
      ,A.CPLS_FLG    
	  ,A.ORG_VNDR_NM 
      ,D.ISS_CTY_CD 
	  ,C.UPD_MNU_NO
	  ,A.PORT_TRF_URL
	  ,A.PORT_TRF_RMK
FROM   PSO_YD_CHG     A
      ,PSO_YD_CHG_XPR B
      ,PSO_CHG_XPR    C 
      ,PSO_CHG_DTL    D
WHERE  1 = 1
AND    A.YD_CD = @[port_cd] || @[combo1]
AND    A.VNDR_SEQ = @[vndr_seq]
#if(${acct_cd} == '')
AND    A.LGS_COST_CD = @[combo3]
#end
AND    A.YD_CHG_NO = B.YD_CHG_NO
AND    A.YD_CHG_VER_SEQ = B.YD_CHG_VER_SEQ
AND    C.CHG_XPR_NO = B.CHG_XPR_NO
AND    A.YD_CHG_NO = D.YD_CHG_NO(+)
AND    A.YD_CHG_VER_SEQ = D.YD_CHG_VER_SEQ(+)
#if(${year} != '')
--AND    A.EFF_DT >= TO_DATE(LPAD(*year,   4, 0) || '0101', 'YYYYMMDD')
--AND    A.EFF_DT <  TO_DATE(LPAD(*year+1, 4, 0) || '0101', 'YYYYMMDD')

AND    A.EFF_DT <= TO_DATE(LPAD(${year}, 4, 0) || '1231', 'YYYYMMDD')    -- end_dt
AND    A.EXP_DT >= TO_DATE(LPAD(${year}, 4, 0) || '0101', 'YYYYMMDD')    -- start_dt
#end
AND    B.PSO_CHG_TP_CD = 'B'
--AND    C.UPD_MNU_NO = DECODE(*uid, '0002', 1, '0004', 2) -- 0002화면이면 1, 0004이면 2
#if(${yd_chg_ver_seq} != '')
AND    A.YD_CHG_VER_SEQ = @[yd_chg_ver_seq]
#end
ORDER  BY 3 DESC, 2 DESC			]]></sql>
			<params>
				<param name="port_cd" type="12" value="" out="N"/>
				<param name="combo1" type="12" value="" out="N"/>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="combo3" type="12" value="" out="N"/>
				<param name="yd_chg_ver_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
