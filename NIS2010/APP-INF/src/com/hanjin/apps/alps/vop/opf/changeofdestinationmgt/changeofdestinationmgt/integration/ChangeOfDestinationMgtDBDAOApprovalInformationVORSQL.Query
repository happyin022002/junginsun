<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChangeOfDestinationMgtDBDAOApprovalInformationVORSQL">
			<desc><![CDATA[dummy]]></desc>
			<sql><![CDATA[
SELECT 
    BC.RGN_CD
,   SUBSTR(BC.OLD_POR_YD_CD, 1, 5) OLD_POR
,   SUBSTR(BC.OLD_POL_YD_CD, 1, 5) OLD_POL
,   SUBSTR(BC.OLD_POD_YD_CD, 1, 5) OLD_POD
,   SUBSTR(BC.OLD_DEL_YD_CD, 1, 5) OLD_DEL
,   SUBSTR(BC.NEW_POR_YD_CD, 1, 5) NEW_POR
,   SUBSTR(BC.NEW_POL_YD_CD, 1, 5) NEW_POL
,   SUBSTR(BC.NEW_POD_YD_CD, 1, 5) NEW_POD
,   SUBSTR(BC.NEW_DEL_YD_CD, 1, 5) NEW_DEL
,   BC.OLD_VSL_CD
,   BC.OLD_SKD_VOY_NO
,   BC.OLD_SKD_DIR_CD
,   BC.OLD_VSL_CD||BC.OLD_SKD_VOY_NO||BC.OLD_SKD_DIR_CD OLD_VVD
,   BC.NEW_VSL_CD
,   BC.NEW_SKD_VOY_NO
,   BC.NEW_SKD_DIR_CD
,   BC.NEW_VSL_CD||BC.NEW_SKD_VOY_NO||BC.NEW_SKD_DIR_CD NEW_VVD
,   BC.OLD_POL_YD_CD
,   BC.OLD_POD_YD_CD
,   BC.NEW_POL_YD_CD
,   BC.NEW_POD_YD_CD
,   BC.DIFF_RMK
--,   BC.COD_RQST_RSN_CD --COD Reason 출력
,   (SELECT INTG_CD_VAL_CTNT||' : '||INTG_CD_VAL_DESC
     FROM   COM_INTG_CD_DTL
     WHERE  INTG_CD_ID = 'CD02153'
     AND    INTG_CD_VAL_CTNT = BC.COD_RQST_RSN_CD
    ) AS COD_RQST_RSN_CD --COD Reason 출력
,   BC.COD_RQST_SEQ 
,   BC.COD_RHND_PORT_CD --Re-Handling PORT 출력
,   BC.COD_STS_CD
,   BC.COD_RJCT_CD
,   BC.BKG_NO
,   BC.CRE_USR_ID
,   (SELECT USR_NM
     FROM   COM_USER
     WHERE  USR_ID=BC.CRE_USR_ID) AS CRE_USR_NM
,   (SELECT  L.LOC_NM
     FROM    MDM_LOCATION L
     WHERE   L.LOC_CD     = SUBSTR(BC.OLD_POL_YD_CD,1,5)) AS POL_FULL_NM
,   (SELECT  L.LOC_NM
     FROM    MDM_LOCATION L
     WHERE   L.LOC_CD     = SUBSTR(BC.OLD_POD_YD_CD,1,5)) AS OLD_POD_FULL_NM
,   (SELECT  L.LOC_NM
     FROM    MDM_LOCATION L
     WHERE   L.LOC_CD     = SUBSTR(BC.NEW_POD_YD_CD,1,5)) AS NEW_POD_FULL_NM
,   TO_CHAR(SYSDATE,'YYYY/MM/DD') AS CRE_DT
,   (SELECT   VC.VSL_ENG_NM                            
     FROM     MDM_VSL_CNTR VC
     WHERE    VC.VSL_CD    = BC.OLD_VSL_CD) AS VSL_ENG_NM
     
,   (SELECT     SUBSTR(VVD.POD_YD_CD,1,5)
     FROM       BKG_COD_VVD              VVD
     WHERE      VVD.BKG_NO               = BC.BKG_NO
     AND        VVD.COD_RQST_SEQ         = @[cod_rqst_seq]
     AND        VVD.VVD_OP_CD            = 'O'      
     AND        VVD.VSL_PRE_PST_CD       = 'T'
     AND        VVD.VSL_SEQ              = 0
    ) AS TRK_OLD_POD_CD
,   (SELECT     ML.LOC_NM
     FROM       MDM_LOCATION  ML
     WHERE      ML.LOC_CD     = (SELECT     SUBSTR(VVD.POD_YD_CD,1,5)
                                 FROM       BKG_COD_VVD              VVD
                                 WHERE      VVD.BKG_NO               = BC.BKG_NO
                                 AND        VVD.COD_RQST_SEQ         = @[cod_rqst_seq]
                                 AND        VVD.VVD_OP_CD            = 'O'      -- O:Original, N:New
                                 AND        VVD.VSL_PRE_PST_CD       = 'T'      -- T:Trunk
                                 AND        VVD.VSL_SEQ              = 0        -- 0 (Fix)
                                )
     ) AS TRK_OLD_POD_FULL_NM
,   (SELECT     SUBSTR(VVD.POD_YD_CD,1,5)
     FROM       BKG_COD_VVD              VVD
     WHERE      VVD.BKG_NO               = BC.BKG_NO
     AND        VVD.COD_RQST_SEQ         = @[cod_rqst_seq]
     AND        VVD.VVD_OP_CD            = 'N'      
     AND        VVD.VSL_PRE_PST_CD       = 'T'
     AND        VVD.VSL_SEQ              = 0
    ) AS TRK_NEW_POD_CD
,   (SELECT     ML.LOC_NM
     FROM       MDM_LOCATION  ML
     WHERE      ML.LOC_CD     = (SELECT     SUBSTR(VVD.POD_YD_CD,1,5)
                                 FROM       BKG_COD_VVD              VVD
                                 WHERE      VVD.BKG_NO               = BC.BKG_NO
                                 AND        VVD.COD_RQST_SEQ         = @[cod_rqst_seq]
                                 AND        VVD.VVD_OP_CD            = 'N'      -- O:Original, N:New
                                 AND        VVD.VSL_PRE_PST_CD       = 'T'      -- T:Trunk
                                 AND        VVD.VSL_SEQ              = 0        -- 0 (Fix)
                                )
      ) AS TRK_NEW_POD_FULL_NM 
FROM  BKG_COD BC 
WHERE BC.BKG_NO = @[bkg_no]
AND   BC.COD_RQST_SEQ = @[cod_rqst_seq]			]]></sql>
			<params>
				<param name="cod_rqst_seq" type="12" value="1" out="N"/>
				<param name="bkg_no" type="12" value="HFA001203200" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
