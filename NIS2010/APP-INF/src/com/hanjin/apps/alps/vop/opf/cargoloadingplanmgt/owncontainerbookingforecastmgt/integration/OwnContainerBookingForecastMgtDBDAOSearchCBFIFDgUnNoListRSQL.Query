<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="OwnContainerBookingForecastMgtDBDAOSearchCBFIFDgUnNoListRSQL">
			<desc><![CDATA[OwnContainerBookingForecastMgtDBDAOSearchCBFIFDgUnNoList]]></desc>
			<sql><![CDATA[
SELECT
		IMDG_UN_NO
		#if (${imdg_subs_rsk_lbl_cd} == 'Y')    
		   , IMDG_SUBS_RSK_LBL_CD
		#else
	       , IMDG_CLSS_CD
		#end
FROM	(
SELECT
		B1.IMDG_UN_NO
		#if (${imdg_subs_rsk_lbl_cd} == 'Y')    
		   , ( SELECT IMDG_SUBS_RSK_LBL_CD FROM (SELECT ROW_NUMBER() OVER (PARTITION BY IMDG_UN_NO, IMDG_UN_NO_SEQ ORDER BY IMDG_SUBS_RSK_LBL_CD) RNUM, IMDG_UN_NO, IMDG_UN_NO_SEQ, IMDG_SUBS_RSK_LBL_CD FROM SCG_IMDG_SUBS_RSK_LBL WHERE IMDG_SUBS_RSK_LBL_CD <> 0) WHERE IMDG_UN_NO = B1.IMDG_UN_NO AND IMDG_UN_NO_SEQ = B1.IMDG_UN_NO_SEQ AND rnum =1 ) IMDG_SUBS_RSK_LBL_CD
		#else
	       , B1.IMDG_CLSS_CD
		#end
FROM     SCG_IMDG_UN_NO B1
       , SCG_IMDG_UN_NO_SPCL_PROVI B2
       , SCG_IMDG_UN_NO_ORG_RACT B4
WHERE    B1.IMDG_UN_NO = B2.IMDG_UN_NO (+)
AND      B1.IMDG_UN_NO = B4.IMDG_UN_NO (+)
AND      B1.IMDG_UN_NO_SEQ = B2.IMDG_UN_NO_SEQ (+)
AND      B1.IMDG_UN_NO_SEQ = B4.IMDG_UN_NO_SEQ (+)
AND      B2.IMDG_SPCL_PROVI_NO(+) = 274
AND	     B1.IMDG_UN_NO LIKE @[imdg_un_no]||'%'
		)
#if (${imdg_subs_rsk_lbl_cd} == 'Y')    
	GROUP BY IMDG_UN_NO, IMDG_SUBS_RSK_LBL_CD
#else
	GROUP BY IMDG_UN_NO, IMDG_CLSS_CD
#end
			]]></sql>
			<params>
				<param name="imdg_un_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
