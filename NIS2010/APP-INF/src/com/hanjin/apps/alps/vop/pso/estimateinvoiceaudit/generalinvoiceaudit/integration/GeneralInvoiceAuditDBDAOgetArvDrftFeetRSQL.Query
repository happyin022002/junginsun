<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralInvoiceAuditDBDAOgetArvDrftFeetRSQL">
			<desc><![CDATA[Tariff 비용 계산을 위해 Arrival Draft Feet를 구한다. 
2014.03.25 CHM-201429461 이윤정 [PSO] Object 중 Meter에서 Feet 변환 로직 수정]]></desc>
			<sql><![CDATA[
SELECT  ROUND( MAX(ARR_AFTDR_HGT) * 3.281 , 2)
FROM  VSK_VSL_PORT_SKD A, VSK_ACT_PORT_SKD B
WHERE A.VSL_CD = B.VSL_CD
AND   A.SKD_VOY_NO = B.SKD_VOY_NO
AND   A.SKD_DIR_CD = B.SKD_DIR_CD
AND   A.VPS_PORT_CD = B.VPS_PORT_CD
AND   A.CLPT_IND_SEQ = B.CLPT_IND_SEQ
AND   (A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD) IN (
                                                SELECT VSL_CD, 
                                                    DECODE(TURN_PORT_IND_CD, 'Y', SKD_VOY_NO, 'N', SKD_VOY_NO, TURN_SKD_VOY_NO) SKD_VOY_NO,
                                                    DECODE(TURN_PORT_IND_CD, 'Y', SKD_DIR_CD, 'N', SKD_DIR_CD, TURN_SKD_DIR_CD) SKD_DIR_CD
                                                FROM VSK_VSL_PORT_SKD
                                                WHERE VSL_CD = SUBSTR(@[vvd], 1, 4)
                                                AND SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
                                                AND SKD_DIR_CD = SUBSTR(@[vvd], 9)
                                                AND VPS_PORT_CD = SUBSTR(@[yd_cd], 1, 5))
AND A.YD_CD = @[yd_cd]			]]></sql>
			<params>
				<param name="vvd" type="12" value="HJBJ0100E" out="N"/>
				<param name="yd_cd" type="12" value="CNSHAYS" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
