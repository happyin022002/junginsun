<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BudgetPortChargeMgtDBDAOselectYdChgRSQL">
			<desc><![CDATA[selectYdChg]]></desc>
			<sql><![CDATA[
--YardChargeVO
SELECT   		 YD_CHG_NO,
		         YD_CHG_VER_SEQ,
		         CURR_CD,
		         YD_CD,
		         LGS_COST_CD,
		         VNDR_SEQ,
				 CURR_CD
		  FROM   (  SELECT   MAX (YD_CHG_NO) YD_CHG_NO,
		                     MAX (YD_CHG_VER_SEQ) YD_CHG_VER_SEQ,
		                     SUBSTR (MAX (YD_CHG_VER_SEQ || CURR_CD), -3) CURR_CD,
		                     YD_CD,
		                     LGS_COST_CD,
		                     VNDR_SEQ,
		                     CPLS_FLG,
		                     COUNT( * )
		                        OVER (PARTITION BY YD_CD, LGS_COST_CD
		                              ORDER BY YD_CD, LGS_COST_CD)
		                        cnt
		              FROM   PSO_YD_CHG
		             WHERE   YD_CD = @[yd_cd]
		     				 AND TO_DATE (@[rev_yrmon], 'YYYY-MM') BETWEEN EFF_DT AND EXP_DT
		          GROUP BY   YD_CD,
		                     LGS_COST_CD,
		                     VNDR_SEQ,
		                     CPLS_FLG)
		 WHERE   CASE WHEN cnt >= 2 THEN 'Y' ELSE cpls_flg END = cpls_flg			]]></sql>
			<params>
				<param name="yd_cd" type="12" value="" out="N"/>
				<param name="rev_yrmon" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
