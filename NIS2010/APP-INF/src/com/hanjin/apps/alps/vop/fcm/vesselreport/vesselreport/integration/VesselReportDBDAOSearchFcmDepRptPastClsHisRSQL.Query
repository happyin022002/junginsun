<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="VesselReportDBDAOSearchFcmDepRptPastClsHisRSQL">
			<desc><![CDATA[FCM DEPARTURE REPORT ERROR Past Cleansing History 조회 쿼리 - FcmDepRptErrClsVO 형태]]></desc>
			<sql><![CDATA[
SELECT DEP_RPT_CLS_SEQ ,
       VSL_CD ,
       (
       	SELECT CNTR_DZN_CAPA
        FROM MDM_VSL_CNTR
        WHERE VSL_CD = @[vsl_cd]
        AND ROWNUM = 1 
       ) AS CNTR_DZN_CAPA ,
       VSL_CD ,
       CONCAT(SKD_VOY_NO, SKD_DIR_CD) AS SKD_VOY_NO ,
       SKD_DIR_CD ,
       DEP_PORT_CD ,
       CLPT_IND_SEQ ,
       DECODE(DEP_RPT_ERR_TP_CD,'PM','PK Mismatched'
        ,DECODE(DEP_RPT_ERR_TP_CD,'PO','PK Overlap'
         ,DECODE(DEP_RPT_ERR_TP_CD,'IE','Item Error'
          ,DECODE(DEP_RPT_ERR_TP_CD,'IM','Item Missing'
           ,DECODE(DEP_RPT_ERR_TP_CD,'MC','Multi Calling'
            ,DECODE(DEP_RPT_ERR_TP_CD,'LM','Last Report Missing'
       )))))) AS DEP_RPT_ERR_TP_CD,
       VSL_SLAN_CD ,
       NVGT_ML_DIST_CTNT ,
       ENG_ML_DIST_CTNT ,
       MNVR_IN_ML_DIST_CTNT ,
       MNVR_OUT_ML_DIST_CTNT ,
       AVG_SPD_CTNT ,
       AVG_RPM_PWR_CTNT ,
       ARR_FOIL_CTNT ,
       ARR_LOW_SULP_FOIL_CTNT ,
       ARR_DOIL_CTNT ,
       ARR_LOW_SULP_DOIL_CTNT ,
       DEP_FOIL_CTNT ,
       DEP_LOW_SULP_FOIL_CTNT ,
       DEP_DOIL_CTNT ,
       DEP_LOW_SULP_DOIL_CTNT ,
       SEA_MN_FOIL_CTNT ,
       SEA_GNR_FOIL_CTNT ,
       SEA_BLR_FOIL_CTNT ,
       SEA_MN_LOW_SULP_FOIL_CTNT ,
       SEA_GNR_LOW_SULP_FOIL_CTNT ,
       SEA_BLR_LOW_SULP_FOIL_CTNT ,
       SEA_MN_DOIL_CTNT ,
       SEA_GNR_DOIL_CTNT ,
       SEA_BLR_DOIL_CTNT ,
       SEA_MN_LOW_SULP_DOIL_CTNT ,
       SEA_GNR_LOW_SULP_DOIL_CTNT ,
       SEA_BLR_LOW_SULP_DOIL_CTNT ,
       PORT_MN_FOIL_CTNT ,
       PORT_GNR_FOIL_CTNT ,
       PORT_BLR_FOIL_CTNT ,
       PORT_MN_LOW_SULP_FOIL_CTNT ,
       PORT_GNR_LOW_SULP_FOIL_CTNT ,
       PORT_BLR_LOW_SULP_FOIL_CTNT ,
       PORT_MN_DOIL_CTNT ,
       PORT_GNR_DOIL_CTNT ,
       PORT_BLR_DOIL_CTNT ,
       PORT_MN_LOW_SULP_DOIL_CTNT ,
       PORT_GNR_LOW_SULP_DOIL_CTNT ,
       PORT_BLR_LOW_SULP_DOIL_CTNT ,
       SPL_FOIL_BDR_CTNT ,
       SPL_FOIL_ACT_CTNT ,
       SPL_FOIL_SULP_CTNT ,
       SPL_LOW_SULP_FOIL_BDR_CTNT ,
       SPL_LOW_SULP_FOIL_ACT_CTNT ,
       SPL_LOW_SULP_FOIL_SULP_CTNT ,
       SPL_DOIL_BDR_CTNT ,
       SPL_DOIL_ACT_CTNT ,
       SPL_DOIL_SULP_CTNT ,
       SPL_LOW_SULP_DOIL_BDR_CTNT ,
       SPL_LOW_SULP_DOIL_ACT_CTNT ,
       SPL_LOW_SULP_DOIL_SULP_CTNT ,
       NXT_PORT_CD ,
       NVL2(NXT_PORT_ETA_DT,TO_CHAR(NXT_PORT_ETA_DT, 'YYYYMMDDHH24MI'),'') AS NXT_PORT_ETA_DT,
       RMN_DIST_CTNT ,
       RMN_AVG_SPD_CTNT ,
       NVL2(SB_ENG_DT,TO_CHAR(SB_ENG_DT, 'YYYYMMDDHH24MI'),'') AS SB_ENG_DT,
       NVL2(PLT_IN_DT,TO_CHAR(PLT_IN_DT, 'YYYYMMDDHH24MI'),'') AS PLT_IN_DT,
       NVL2(BFR_BRTH_ANK_DRP_DT,TO_CHAR(BFR_BRTH_ANK_DRP_DT, 'YYYYMMDDHH24MI'),'') AS BFR_BRTH_ANK_DRP_DT,
       NVL2(BFR_BRTH_ANK_OFF_DT,TO_CHAR(BFR_BRTH_ANK_OFF_DT, 'YYYYMMDDHH24MI'),'') AS BFR_BRTH_ANK_OFF_DT,
       NVL2(VPS_ETB_DT,TO_CHAR(VPS_ETB_DT, 'YYYYMMDDHH24MI'),'') AS VPS_ETB_DT,
       NVL2(CGO_WRK_ST_DT,TO_CHAR(CGO_WRK_ST_DT, 'YYYYMMDDHH24MI'),'') AS CGO_WRK_ST_DT,
       NVL2(CGO_WRK_END_DT,TO_CHAR(CGO_WRK_END_DT, 'YYYYMMDDHH24MI'),'') AS CGO_WRK_END_DT,
       NVL2(VPS_ETD_DT,TO_CHAR(VPS_ETD_DT, 'YYYYMMDDHH24MI'),'') AS VPS_ETD_DT,
       NVL2(AFT_UNBRTH_ANK_DRP_DT,TO_CHAR(AFT_UNBRTH_ANK_DRP_DT, 'YYYYMMDDHH24MI'),'') AS AFT_UNBRTH_ANK_DRP_DT,
       NVL2(AFT_UNBRTH_ANK_OFF_DT,TO_CHAR(AFT_UNBRTH_ANK_OFF_DT, 'YYYYMMDDHH24MI'),'') AS AFT_UNBRTH_ANK_OFF_DT,
       NVL2(PLT_OUT_DT,TO_CHAR(PLT_OUT_DT, 'YYYYMMDDHH24MI'),'') AS PLT_OUT_DT,
       NVL2(RUP_DT,TO_CHAR(RUP_DT, 'YYYYMMDDHH24MI'),'') AS RUP_DT,
       ARR_FWDDR_CTNT ,
       ARR_MID_DRFT_CTNT ,
       ARR_AFTDR_CTNT ,
       ARR_GM_CTNT ,
       DEP_FWDDR_CTNT ,
       DEP_MID_DRFT_CTNT ,
       DEP_AFTDR_CTNT ,
       DEP_GM_CTNT ,
       FCNTR_OBRD_TEU_CTNT ,
       MCNTR_OBRD_TEU_CTNT ,
       TTL_CNTR_OBRD_TEU_CTNT ,
       DEP_CGO_CTNT ,
       DEP_DPL_CTNT ,
       RF_CNTR_DCHG_KNT_CTNT ,
       RF_CNTR_LOD_KNT_CTNT ,
       RF_CNTR_OBRD_KNT_CTNT ,
       OLD_VSL_CD ,
       OLD_SKD_VOY_NO ,
       OLD_SKD_DIR_CD ,
       OLD_DEP_PORT_CD ,
       OLD_CLPT_IND_SEQ ,
       CRE_USR_ID ,
       CRE_DT ,
       UPD_USR_ID ,
       UPD_DT ,
       LST_DEP_PORT_CD ,
       AVG_PRLR_PCH_VAL ,
       SAIL_TM_HRS ,
       LST_DEP_FOIL_CTNT ,
       LST_DEP_LOW_SULP_FOIL_CTNT ,
       LST_DEP_DOIL_CTNT ,
       LST_DEP_LOW_SULP_DOIL_CTNT ,
       SEA_STMNG_MN_ENG_TTL_QTY ,
       AVG_PORT_TTL_QTY ,
       AVG_PORT_TTL_HR_QTY ,
       NVL2(LST_PORT_RUP_DT,TO_CHAR(LST_PORT_RUP_DT, 'YYYYMMDDHH24MI'),'') AS LST_PORT_RUP_DT
  FROM FCM_DEP_RPT_CLS_HIS
  WHERE VSL_CD = @[vsl_cd] 
  AND SKD_VOY_NO = SUBSTR(@[skd_voy_no], 1,4) 
  AND SKD_DIR_CD = @[skd_dir_cd] 
  AND DEP_PORT_CD = @[dep_port_cd] 
  AND CLPT_IND_SEQ = @[clpt_ind_seq]
  AND DEP_RPT_ERR_TP_CD NOT IN ('PM', 'MC', 'LM')
  ORDER BY DEP_RPT_CLS_SEQ DESC			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="dep_port_cd" type="12" value="" out="N"/>
				<param name="clpt_ind_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
