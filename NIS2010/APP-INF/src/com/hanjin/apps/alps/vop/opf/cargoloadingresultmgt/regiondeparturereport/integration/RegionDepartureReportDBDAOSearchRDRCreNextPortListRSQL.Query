<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RegionDepartureReportDBDAOSearchRDRCreNextPortListRSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
SELECT (SELECT VPS_PORT_CD
        FROM   VSK_VSL_PORT_SKD
        WHERE  VSL_CD = P.VSL_CD
        AND    SKD_VOY_NO = P.SKD_VOY_NO
        AND    SKD_DIR_CD = P.SKD_DIR_CD
        AND    CLPT_SEQ = (SELECT MIN(CLPT_SEQ)
                FROM   VSK_VSL_PORT_SKD
                WHERE  VSL_CD = P.VSL_CD
                AND    SKD_VOY_NO = P.SKD_VOY_NO
                AND    SKD_DIR_CD = P.SKD_DIR_CD
                AND    CLPT_SEQ > P.CLPT_SEQ
                AND    NVL(SKD_CNG_STS_CD, '-') != 'S'
                AND    VPS_PORT_CD NOT IN ('PAPAC', 'EGSUZ') ) ) AS NEXT_PORT,
       (SELECT TO_CHAR(VPS_ETA_DT, 'YYYY-MM-DD HH24:MI')
        FROM   VSK_VSL_PORT_SKD
        WHERE  VSL_CD = P.VSL_CD
        AND    SKD_VOY_NO = P.SKD_VOY_NO
        AND    SKD_DIR_CD = P.SKD_DIR_CD
        AND    CLPT_SEQ = (SELECT MIN(CLPT_SEQ)
                FROM   VSK_VSL_PORT_SKD
                WHERE  VSL_CD = P.VSL_CD
                AND    SKD_VOY_NO = P.SKD_VOY_NO
                AND    SKD_DIR_CD = P.SKD_DIR_CD
                AND    CLPT_SEQ > P.CLPT_SEQ
                AND    NVL(SKD_CNG_STS_CD, '-') != 'S'
                AND    VPS_PORT_CD NOT IN ('PAPAC', 'EGSUZ') ) ) AS ETA ,
       ''ETA_CANAL ,
       ''NEXT_CANAL
FROM   VSK_VSL_PORT_SKD P,
       VSK_ACT_PORT_SKD A
WHERE  P.VSL_CD       =	@[vsl_cd]
AND	   P.SKD_VOY_NO   =	@[voy_no]
AND	   P.SKD_DIR_CD   =	@[dir_cd]
AND	   P.VPS_PORT_CD  =	@[port_cd]
AND    P.VSL_CD = A.VSL_CD
AND    P.SKD_VOY_NO = A.SKD_VOY_NO
AND    P.SKD_DIR_CD = A.SKD_DIR_CD
AND    P.VPS_PORT_CD = A.VPS_PORT_CD
AND    P.CLPT_IND_SEQ = A.CLPT_IND_SEQ 
 			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="voy_no" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="port_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
