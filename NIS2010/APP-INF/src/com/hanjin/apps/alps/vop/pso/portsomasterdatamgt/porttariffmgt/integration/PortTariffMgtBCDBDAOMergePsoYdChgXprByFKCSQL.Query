<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PortTariffMgtBCDBDAOMergePsoYdChgXprByFKCSQL">
			<desc><![CDATA[PSO_YD_CHG_XPR <merge By FK>]]></desc>
			<sql><![CDATA[
MERGE INTO PSO_YD_CHG_XPR A   -- 의미상 Key
USING DUAL ON (A.PSO_CHG_TP_CD      = @[pso_chg_tp_cd]
               AND A.YD_CHG_NO      = @[yd_chg_no]
               AND A.YD_CHG_VER_SEQ = @[yd_chg_ver_seq])
WHEN MATCHED
THEN UPDATE SET 
			 A.CHG_XPR_NO       = @[chg_xpr_no] 
            ,A.UPD_USR_ID       = @[cre_usr_id]
            ,A.UPD_DT           = SYSDATE              
     WHERE  1=1
     AND    A.PSO_CHG_TP_CD  = @[pso_chg_tp_cd]
     AND    A.YD_CHG_NO      = @[yd_chg_no]
     AND    A.YD_CHG_VER_SEQ = @[yd_chg_ver_seq]
WHEN NOT MATCHED
THEN INSERT (A.YD_CHG_XPR_NO
            ,A.PSO_CHG_TP_CD
            ,A.XTER_PGM_FLG
            ,A.YD_CHG_NO
            ,A.YD_CHG_VER_SEQ
            ,A.CHG_XPR_NO
            ,A.CRE_USR_ID
            ,A.CRE_DT
            ,A.UPD_USR_ID
            ,A.UPD_DT)
     VALUES ((SELECT /*+ INDEX_DESC(Z XPKPSO_YD_CHG_XPR) */ NVL(MAX(Z.YD_CHG_XPR_NO), 0) + 1 YD_CHG_XPR_NO
              FROM   PSO_YD_CHG_XPR Z
              WHERE  ROWNUM = 1)            
            ,@[pso_chg_tp_cd]                
            ,@[xter_pgm_flg]        
            ,@[yd_chg_no]                    
            ,@[yd_chg_ver_seq]              
            ,@[chg_xpr_no]                    
            ,@[cre_usr_id]           
            ,SYSDATE                     
            ,@[cre_usr_id]                 
            ,SYSDATE                       
     )			]]></sql>
			<params>
				<param name="pso_chg_tp_cd" type="12" value="" out="N"/>
				<param name="yd_chg_no" type="12" value="" out="N"/>
				<param name="yd_chg_ver_seq" type="12" value="" out="N"/>
				<param name="chg_xpr_no" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="xter_pgm_flg" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
