<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PortTariffMgtBCDBDAOSearchVendorByYardAndCostRSQL">
			<desc><![CDATA[PSO_YD_CHG]]></desc>
			<sql><![CDATA[
SELECT DISTINCT 
       B.VNDR_SEQ
      ,B.VNDR_LGL_ENG_NM    
FROM   PSO_YD_CHG     A
      ,MDM_VENDOR     B      
      ,PSO_YD_CHG_XPR C
      ,PSO_CHG_XPR    D  
	  , TES_LGS_COST E
      , MDM_ACCOUNT  F
WHERE  1=1
AND    A.YD_CD = @[yd_cd]
#if(${acct_cd} == '' && ${lgs_cost_cd} != '')
AND    A.LGS_COST_CD = @[lgs_cost_cd]
#end

#if(${year} != '')
--AND    A.EFF_DT >= TO_DATE(LPAD(*year,   4, 0) || '0101', 'YYYYMMDD')
--AND    A.EFF_DT <  TO_DATE(LPAD(*year+1, 4, 0) || '0101', 'YYYYMMDD')

AND    A.EFF_DT <= TO_DATE(LPAD(${year}, 4, 0) || '1231', 'YYYYMMDD')    -- end_dt
AND    A.EXP_DT >= TO_DATE(LPAD(${year}, 4, 0) || '0101', 'YYYYMMDD')    -- start_dt
#end

AND    A.VNDR_SEQ = B.VNDR_SEQ
AND    A.YD_CHG_NO = C.YD_CHG_NO
AND    A.YD_CHG_VER_SEQ = C.YD_CHG_VER_SEQ
AND    D.CHG_XPR_NO = C.CHG_XPR_NO
AND    C.PSO_CHG_TP_CD = 'B'
AND    D.UPD_MNU_NO = DECODE(@[uid], '0002', 1, '0004', 2) -- 0002화면이면 1, 0004이면 2

AND    E.ACCT_CD = F.ACCT_CD
AND    E.LGS_COST_SUBJ_CD IN ('PT', 'CN')
AND    E.LGS_COST_CD_CLSS_LVL = 'A'
#if(${acct_cd} != '')
AND    E.ACCT_CD = @[acct_cd]
#end
AND    A.LGS_COST_CD = E.LGS_COST_CD

ORDER BY 2			]]></sql>
			<params>
				<param name="yd_cd" type="12" value="" out="N"/>
				<param name="lgs_cost_cd" type="12" value="" out="N"/>
				<param name="uid" type="12" value="" out="N"/>
				<param name="acct_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
