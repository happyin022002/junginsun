<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TerminalDepartureReportDBDAOSlotPortImpVORSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
SELECT  OPR_CD,
        TRADE_FULL,
        TRADE_MT,
        (TRADE_FULL + TRADE_MT) AS TRADE_SUB_SLOT,
        INTER_FULL,
        INTER_MT,
        TRADE_SUB_WGT,
        INTER_SUB_WGT,
        (INTER_FULL + INTER_MT) AS INTER_SUB_SLOT,
        (TRADE_FULL + TRADE_MT + INTER_FULL + INTER_MT)  AS GRAND_TTL_SLOT,
        (TRADE_SUB_WGT + INTER_SUB_WGT) AS GRAND_TTL_WGT        
FROM(
    SELECT	OPR_CD,
            (FULL_OUT_20 + FULL_OUT_2H) + (FULL_OUT_40 + FULL_OUT_4H + FULL_OUT_45) * 2  AS TRADE_FULL,
    		(ET_OUT_20 + ET_OUT_2H) + (ET_OUT_40 + ET_OUT_4H + ET_OUT_45) * 2  AS TRADE_MT,
    		WT_OUT AS TRADE_SUB_WGT,
    		(FULL_IN_20 + FULL_IN_2H) + (FULL_IN_40 + FULL_IN_4H + FULL_IN_45) * 2  AS INTER_FULL,
    		(ET_IN_20 + ET_IN_2H) + (ET_IN_40 + ET_IN_4H + ET_IN_45) * 2  AS INTER_MT,
    		WT_IN AS INTER_SUB_WGT
    FROM(
    	SELECT  OPR_CD,
    	       SUM(DECODE(S.STATUS,'LM',DECODE(S.CNTR_SIZE,'2',DECODE(S.CNTR_TYPE,'F',S.QTY,'R',S.QTY,0),0),0)) FULL_OUT_20,
    	       SUM(DECODE(S.STATUS,'LM',DECODE(S.CNTR_SIZE,'3',DECODE(S.CNTR_TYPE,'F',S.QTY,'R',S.QTY,0),0),0)) FULL_OUT_2H,
    	       SUM(DECODE(S.STATUS,'LM',DECODE(S.CNTR_SIZE,'4',DECODE(S.CNTR_TYPE,'F',S.QTY,'R',S.QTY,0),0),0)) FULL_OUT_40,
    	       SUM(DECODE(S.STATUS,'LM',DECODE(S.CNTR_SIZE,'H',DECODE(S.CNTR_TYPE,'F',S.QTY,'R',S.QTY,0),0),0)) FULL_OUT_4H,
    	       SUM(DECODE(S.STATUS,'LM',DECODE(S.CNTR_SIZE,'L',DECODE(S.CNTR_TYPE,'F',S.QTY,'R',S.QTY,0),0),0)) FULL_OUT_45,
    	       SUM(DECODE(S.STATUS,'LM',DECODE(S.CNTR_SIZE,'2',DECODE(S.CNTR_TYPE,'E',S.QTY,0),0),0))           ET_OUT_20,
    	       SUM(DECODE(S.STATUS,'LM',DECODE(S.CNTR_SIZE,'3',DECODE(S.CNTR_TYPE,'E',S.QTY,0),0),0))           ET_OUT_2H,
    	       SUM(DECODE(S.STATUS,'LM',DECODE(S.CNTR_SIZE,'4',DECODE(S.CNTR_TYPE,'E',S.QTY,0),0),0))           ET_OUT_40,
    	       SUM(DECODE(S.STATUS,'LM',DECODE(S.CNTR_SIZE,'H',DECODE(S.CNTR_TYPE,'E',S.QTY,0),0),0))           ET_OUT_4H,
    	       SUM(DECODE(S.STATUS,'LM',DECODE(S.CNTR_SIZE,'L',DECODE(S.CNTR_TYPE,'E',S.QTY,0),0),0))           ET_OUT_45,
    	       SUM(DECODE(S.STATUS,'LM',S.WEIGHT,0))                                  							WT_OUT,
    	       SUM(DECODE(S.STATUS,'LI',DECODE(S.CNTR_SIZE,'2',DECODE(S.CNTR_TYPE,'F',S.QTY,'R',S.QTY,0),0),0)) FULL_IN_20,
    	       SUM(DECODE(S.STATUS,'LI',DECODE(S.CNTR_SIZE,'3',DECODE(S.CNTR_TYPE,'F',S.QTY,'R',S.QTY,0),0),0)) FULL_IN_2H,
    	       SUM(DECODE(S.STATUS,'LI',DECODE(S.CNTR_SIZE,'4',DECODE(S.CNTR_TYPE,'F',S.QTY,'R',S.QTY,0),0),0)) FULL_IN_40,
    	       SUM(DECODE(S.STATUS,'LI',DECODE(S.CNTR_SIZE,'H',DECODE(S.CNTR_TYPE,'F',S.QTY,'R',S.QTY,0),0),0)) FULL_IN_4H,
    	       SUM(DECODE(S.STATUS,'LI',DECODE(S.CNTR_SIZE,'L',DECODE(S.CNTR_TYPE,'F',S.QTY,'R',S.QTY,0),0),0)) FULL_IN_45,
    	       SUM(DECODE(S.STATUS,'LI',DECODE(S.CNTR_SIZE,'2',DECODE(S.CNTR_TYPE,'E',S.QTY,0),0),0))           ET_IN_20,
    	       SUM(DECODE(S.STATUS,'LI',DECODE(S.CNTR_SIZE,'3',DECODE(S.CNTR_TYPE,'E',S.QTY,0),0),0))           ET_IN_2H,
    	       SUM(DECODE(S.STATUS,'LI',DECODE(S.CNTR_SIZE,'4',DECODE(S.CNTR_TYPE,'E',S.QTY,0),0),0))           ET_IN_40,
    	       SUM(DECODE(S.STATUS,'LI',DECODE(S.CNTR_SIZE,'H',DECODE(S.CNTR_TYPE,'E',S.QTY,0),0),0))           ET_IN_4H,
    	       SUM(DECODE(S.STATUS,'LI',DECODE(S.CNTR_SIZE,'L',DECODE(S.CNTR_TYPE,'E',S.QTY,0),0),0))           ET_IN_45,
    	       SUM(DECODE(S.STATUS,'LI',S.WEIGHT,0))                                  							WT_IN
    	FROM    TDR_SUMMARY S
    	WHERE  VSL_CD = @[vsl_cd]
    	AND    VOY_NO = @[voy_no]
    	AND    DIR_CD  = @[dir_cd]
    	AND    PORT_CD = @[port_cd]
        AND    CALL_IND=  @[clpt_ind_seq]
    	AND    STATUS IN ('LI', 'LM')
    	AND	   CNTR_TYPE NOT IN ('D', 'R', 'A')
    	GROUP   BY OPR_CD
    	ORDER   BY OPR_CD
    )X
)Y
ORDER BY OPR_CD			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="voy_no" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="port_cd" type="12" value="" out="N"/>
				<param name="clpt_ind_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
