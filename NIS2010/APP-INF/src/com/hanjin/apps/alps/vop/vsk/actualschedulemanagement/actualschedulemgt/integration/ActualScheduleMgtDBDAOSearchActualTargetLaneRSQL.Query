<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ActualScheduleMgtDBDAOSearchActualTargetLaneRSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
SELECT  	T1.VSL_SLAN_CD
        , 	VSL_SLAN_NM
        , 	'Y' AS ACT_SKD_TGT_FLG
        , 	DECODE(VSL_SVC_TP_CD, 'O', 'O', 'T') AS VSL_SVC_TP_CD
		--,	NVL(T1.ACT_CRR_CD,VC.CRR_CD)
FROM		VSK_VSL_SKD 		T1
        , 	VSK_VSL_PORT_SKD	T2
        , 	MDM_VSL_SVC_LANE	T3 
		,	MDM_VSL_CNTR		VC
WHERE		1 = 1
AND     	T1.VSL_CD         	= T2.VSL_CD
AND     	T1.SKD_VOY_NO     	= T2.SKD_VOY_NO
AND     	T1.SKD_DIR_CD     	= T2.SKD_DIR_CD
AND     	T1.VSL_SLAN_CD    	= T3.VSL_SLAN_CD
AND     	T1.SKD_STS_CD     	IN ('ACT', 'CLO')

AND			T1.VSL_CD			= VC.VSL_CD

AND     	'S'               	!= NVL(T2.SKD_CNG_STS_CD, ' ')
AND     	T1.VSL_SLAN_CD    	!= 'GBA'
AND     	T3.VSL_TP_CD       	= 'C' /* 컨테이너선 */
AND     	T2.VPS_ETD_DT 		BETWEEN TO_DATE(@[fm_dt], 'YYYY-MM-DD') AND     TO_DATE(@[to_dt], 'YYYY-MM-DD') + 0.99999
#if (${vsl_svc_tp_cd} == 'T') 
AND     	'O'               	!= NVL(T3.VSL_SVC_TP_CD, ' ')
#elseif (${vsl_svc_tp_cd} == 'O') 
AND     	VSL_SVC_TP_CD      	= 'O'
#end

#if (${crr_cd} != '')
AND			NVL(T1.ACT_CRR_CD,VC.CRR_CD)	= @[crr_cd]
#end

AND     	EXISTS
        						(   SELECT  	'X'
            						FROM 		BKG_VVD S
											, 	BKG_BOOKING S1
            						WHERE   	1   = 1
            						AND	    	S.BKG_NO            = S1.BKG_NO
            						AND     	S1.BKG_STS_CD      != 'X'
            						AND     	S1.BKG_CGO_TP_CD    = 'F'              /* FULL BOOKING      */
            						AND     	S.VSL_CD            = T2.VSL_CD
            						AND     	S.SKD_VOY_NO        = T2.SKD_VOY_NO
            						AND     	S.SKD_DIR_CD        = T2.SKD_DIR_CD
            						AND   		((S.POL_CD 			= T2.VPS_PORT_CD AND S.POL_CLPT_IND_SEQ = T2.CLPT_IND_SEQ)
                									OR 
												 (S.POD_CD 			= T2.VPS_PORT_CD AND S.POD_CLPT_IND_SEQ = T2.CLPT_IND_SEQ)
												)
            						AND     ROWNUM              	= 1
        )
GROUP BY 	T1.VSL_SLAN_CD
		, 	VSL_SLAN_NM
		, 	DECODE(VSL_SVC_TP_CD, 'O', 'O', 'T')
		--,	NVL(T1.ACT_CRR_CD,VC.CRR_CD)
ORDER BY 	1			]]></sql>
			<params>
				<param name="fm_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
				<param name="crr_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
