<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="VesselScheduleMgtDBDAOSearchVesselLaneLastPortRSQL">
			<desc><![CDATA[Vessel / Lane 에 대해서 마지막 Port 의 정보를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT
	MAX(VSL_CD) KEEP(DENSE_RANK FIRST ORDER BY VSK.SKD_VOY_NO DESC, MDM.VSL_SLAN_DIR_SEQ DESC, VSK.CLPT_SEQ DESC) AS VSL_CD
	,MAX(SKD_VOY_NO) KEEP(DENSE_RANK FIRST ORDER BY VSK.SKD_VOY_NO DESC, MDM.VSL_SLAN_DIR_SEQ DESC, VSK.CLPT_SEQ DESC) AS SKD_VOY_NO
	,MAX(SKD_DIR_CD) KEEP(DENSE_RANK FIRST ORDER BY VSK.SKD_VOY_NO DESC, MDM.VSL_SLAN_DIR_SEQ DESC, VSK.CLPT_SEQ DESC) AS SKD_DIR_CD
	,MAX(VPS_PORT_CD) KEEP(DENSE_RANK FIRST ORDER BY VSK.SKD_VOY_NO DESC, MDM.VSL_SLAN_DIR_SEQ DESC, VSK.CLPT_SEQ DESC) AS VPS_PORT_CD
	,MAX(CLPT_IND_SEQ) KEEP(DENSE_RANK FIRST ORDER BY VSK.SKD_VOY_NO DESC, MDM.VSL_SLAN_DIR_SEQ DESC, VSK.CLPT_SEQ DESC) AS CLPT_IND_SEQ
	,MAX(TO_CHAR(VPS_ETA_DT, 'YYYYMMDD')) KEEP(DENSE_RANK FIRST ORDER BY VSK.SKD_VOY_NO DESC, MDM.VSL_SLAN_DIR_SEQ DESC, VSK.CLPT_SEQ DESC) AS VPS_ETA_DT
	,MAX(SKD_CNG_STS_CD) KEEP(DENSE_RANK FIRST ORDER BY VSK.SKD_VOY_NO DESC, MDM.VSL_SLAN_DIR_SEQ DESC, VSK.CLPT_SEQ DESC) AS SKD_CNG_STS_CD
FROM VSK_VSL_PORT_SKD VSK, MDM_VSL_SVC_LANE_DIR MDM
WHERE VSK.SLAN_CD = MDM.VSL_SLAN_CD
AND VSK.SKD_DIR_CD = MDM.VSL_SLAN_DIR_CD
AND VSK.VSL_CD = @[vsl_cd]
AND VSK.SLAN_CD = @[slan_cd]
AND VSK.TURN_PORT_IND_CD IN ('Y', 'N')
			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="slan_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
