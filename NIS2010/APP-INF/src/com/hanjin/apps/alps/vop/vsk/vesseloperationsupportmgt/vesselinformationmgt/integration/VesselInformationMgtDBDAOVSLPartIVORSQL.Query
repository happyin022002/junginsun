<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="VesselInformationMgtDBDAOVSLPartIVORSQL">
			<desc><![CDATA[Particular I, Particular II 정보를 조회 합니다.

=====================================================
History
2011.04.26 진마리아 [CHM-201110282-01] 로직 변경 요청(Engine Power 단위 BHP/KW 항목구분)
2012.04.02 진마리아 CHM-201217105-01 Local Vessel name 칼럼 추가 요청건]]></desc>
			<sql><![CDATA[
SELECT 
	MVC.CNTR_VSL_CLSS_CAPA
,	MVC.RF_RCPT_KNT
,	MVC.RF_RCPT_MAX_KNT
,	MVC.FBD_CAPA
,	MVC.DPL_CAPA
,	MVC.BLST_TNK_CAPA
,	MVC.FOIL_CSM
,	MVC.DOIL_CSM
,	MVC.FRSH_WTR_CSM
,	MVC.MN_ENG_RPM_PWR
,	MVC.GNR_RPM_PWR
,	MVC.VSL_HGT
,	TO_CHAR(MVC.RGST_DT,'ddMonyy', 'NLS_DATE_LANGUAGE=American') RGST_DT
,	MVC.VSL_EDI_NM
,	MVC.CO_CD 
,	MVC.VSL_CLZ_DT
,	MVC.VSL_CRE_OFC_CD
,	MVC.VSL_DELT_OFC_CD
,	MVC.VSL_BLD_AREA_NM 
,	MVC.GNR_MKR_NM
,	MVC.GNR_TP_DESC
,	MVC.GNR_BHP_PWR
,	MVC.BWTHST_MKR_NM
,	MVC.BWTHST_TP_DESC
,	MVC.BWTHST_BHP_PWR
,	MVC.BWTHST_RPM_PWR
,	MVC.LLOYD_NO
,	TO_CHAR(MVC.VSL_LNCH_DT,'ddMonyy', 'NLS_DATE_LANGUAGE=American') VSL_LNCH_DT
,	TO_CHAR(MVC.VSL_DE_DT,'ddMonyy', 'NLS_DATE_LANGUAGE=American') VSL_DE_DT
,	TO_CHAR(MVC.VSL_KEL_LY_DT,'ddMonyy', 'NLS_DATE_LANGUAGE=American') VSL_KEL_LY_DT
,	MVC.VSL_HL_NO
,	MVC.TTL_TEU_KNT
,	MVC.VSL_HTCH_KNT
,	MVC.VSL_HLD_KNT
,	MVC.VSL_RMK
,	MVC.INTL_TONG_CERTI_FLG
,	MVC.VSL_SFT_CSTRU_CERTI_EXP_DT
,	MVC.VSL_SFT_RDO_CERTI_EXP_DT
,	MVC.VSL_SFT_EQ_CERTI_EXP_DT
,	MVC.VSL_LOD_LINE_CERTI_EXP_DT
,	MVC.VSL_DERAT_CERTI_EXP_DT
,	MVC.CRE_USR_ID
,	MVC.CRE_DT
,	MVC.UPD_USR_ID
,	TO_CHAR(MVC.UPD_DT,'yyyy-mm-dd hh24:mi') UPD_DT
,	MVC.DELT_FLG
,	MVC.EAI_EVNT_DT
,	MVC.VSL_CD
,	'' VSL_CLSS_CD
,	MVC.VSL_ENG_NM
,	MVC.VSL_KRN_NM
,	MVC.FOIL_CAPA
,	MVC.DOIL_CAPA
,	MVC.FRSH_WTR_CAPA
,	MVC.CALL_SGN_NO
,	MVC.RGST_NO
,	MVC.PHN_NO
,	MVC.FAX_NO
,	MVC.TLX_NO
,	MVC.VSL_EML
,	MVC.PICLB_DESC
,	ML.LOC_NM||', '||MC2.CNT_NM RGST_PORT_CD
,	MVC.CLSS_NO_RGST_AREA_NM
,	MVC.VSL_CLSS_NO
,	MVC.VSL_BLDR_NM
,	MVC.LOA_LEN
,	MVC.LBP_LEN
,	MVC.VSL_WDT
,	MVC.VSL_DPTH
,	MVC.SMR_DRFT_HGT
,	MVC.DWT_WGT
,	MVC.LGT_SHP_TONG_WGT
,	MVC.GRS_RGST_TONG_WGT
,	MVC.NET_RGST_TONG_WGT
,	MVC.PNM_GT_WGT
,	MVC.PNM_NET_TONG_WGT
,	MVC.SUZ_GT_WGT
,	MVC.SUZ_NET_TONG_WGT
,   MVC.MADN_VOY_SUZ_NET_TONG_WGT
,	MVC.MN_ENG_MKR_NM
,	MVC.MN_ENG_TP_DESC
,	DECODE(MVC.MN_ENG_HOR_PWR_UT_CD, 'KW', MVC.MN_ENG_BHP_PWR, 0) MN_ENG_KW_PWR
,	DECODE(MVC.MN_ENG_HOR_PWR_UT_CD, 'KW', 0, MVC.MN_ENG_BHP_PWR) MN_ENG_BHP_PWR
,	DECODE(MVC.VSL_OWN_IND_CD,'O','OWNER','C','CHARTER') AS VSL_OWN_IND_CD
,	MVC.VSL_RGST_CNT_CD
,	DECODE(MVC.VSL_BLD_CD,'N','NEW','U','USED') AS VSL_BLD_CD
,	MVC.CRR_CD
,	MVC.FDR_DIV_CD
,	MVC.VSL_SVC_SPD
,	MVC.MAX_SPD
,	MVC.ECN_SPD
,	MVC.CRW_KNT
,	MVC.CNTR_DZN_CAPA
,	MVC.CNTR_OP_CAPA
,	MVC.CNTR_PNM_CAPA
,	VC.CRR_NM AS CRR_FULL_NM
,	MC1.CNT_CD
,	MC1.CNT_NM 
,   'CNTR' AS VSL_TYPE
,   MVC.VSL_LOCL_NM
,   TO_CHAR(DAILY_HIRE.N1ST_EFF_DT,'yyyy-mm-dd') N1ST_EFF_DT
,   TO_CHAR(DAILY_HIRE.N1ST_EXP_DT,'yyyy-mm-dd') N1ST_EXP_DT
,   TO_CHAR(DAILY_HIRE.N2ND_EFF_DT,'yyyy-mm-dd') N2ND_EFF_DT 
,   TO_CHAR(DAILY_HIRE.N2ND_EXP_DT,'yyyy-mm-dd') N2ND_EXP_DT
, 	DECODE(DAILY_HIRE.N1ST_EXP_DT, NULL, '', (TRUNC(MONTHS_BETWEEN(DAILY_HIRE.N1ST_EXP_DT, SYSDATE)/12)||'-'||
    TRUNC(MONTHS_BETWEEN(DAILY_HIRE.N1ST_EXP_DT , SYSDATE)-TRUNC(MONTHS_BETWEEN(DAILY_HIRE.N1ST_EXP_DT, SYSDATE)/12)*12)||'-'||
    CEIL((MONTHS_BETWEEN(DAILY_HIRE.N1ST_EXP_DT, SYSDATE)-TRUNC(MONTHS_BETWEEN(DAILY_HIRE.N1ST_EXP_DT, SYSDATE)))*30.5)))
    N1ST_RMN_DT
, 	DECODE(DAILY_HIRE.N2ND_EXP_DT, NULL, '', (TRUNC(MONTHS_BETWEEN(DAILY_HIRE.N2ND_EXP_DT, SYSDATE)/12)||'-'||
    TRUNC(MONTHS_BETWEEN(DAILY_HIRE.N2ND_EXP_DT , SYSDATE)-TRUNC(MONTHS_BETWEEN(DAILY_HIRE.N2ND_EXP_DT, SYSDATE)/12)*12)||'-'||
    CEIL((MONTHS_BETWEEN(DAILY_HIRE.N2ND_EXP_DT, SYSDATE)-TRUNC(MONTHS_BETWEEN(DAILY_HIRE.N2ND_EXP_DT, SYSDATE)))*30.5)))
    N2ND_RMN_DT
,   DAILY_HIRE.N1ST_VNDR_SEQ
,   DAILY_HIRE.N1ST_VNDR_NM
,   DAILY_HIRE.N2ND_VNDR_SEQ
,   DAILY_HIRE.N2ND_VNDR_NM
,   DAILY_HIRE.N1ST_HIR_CURR_N1ST_CD
,   DAILY_HIRE.N1ST_HIR_RT_N1ST_AMT
,   DAILY_HIRE.N1ST_HIR_CURR_N2ND_CD
,   DAILY_HIRE.N1ST_HIR_RT_N2ND_AMT
,   DAILY_HIRE.N2ND_HIR_CURR_N1ST_CD
,   DAILY_HIRE.N2ND_HIR_RT_N1ST_AMT
,   DAILY_HIRE.N2ND_HIR_CURR_N2ND_CD
,   DAILY_HIRE.N2ND_HIR_RT_N2ND_AMT
,   MVC.MN_ENG_TR_KNT
,   '' GNR_TR_KNT
,   '' BWTHST_TR_KNT
FROM   MDM_VSL_CNTR MVC
,      MDM_CARRIER  VC
,      MDM_COUNTRY  MC1
,      MDM_COUNTRY  MC2
,      MDM_LOCATION ML
,(
       
    SELECT      MAX(X.VSL_CD)                          AS VSL_CD                                                            
              , MAX(DECODE(SEQ,1,X.EFF_DT)           ) AS N1ST_EFF_DT                               /* PERIOD FROM    */       
              , MAX(DECODE(SEQ,1,X.EXP_DT)           ) AS N1ST_EXP_DT                               /* PERIOD TO      */       
              , MAX(DECODE(SEQ,2,X.EFF_DT)           ) AS N2ND_EFF_DT                               /* PERIOD FROM    */       
              , MAX(DECODE(SEQ,2,X.EXP_DT)           ) AS N2ND_EXP_DT                               /* PERIOD TO      */       
             -- , MAX(DECODE(SEQ,1,X.VNDR_SEQ,2,X.VNDR_SEQ)) AS VNDR_SEQ   
             -- , MAX(DECODE(SEQ,1,X.VNDR_NM ,2,X.VNDR_NM )) AS VNDR_NM                               /* OWNER          */   
              , MAX(DECODE(SEQ,1,X.VNDR_SEQ)) AS N1ST_VNDR_SEQ   
              , MAX(DECODE(SEQ,1,X.VNDR_NM )) AS N1ST_VNDR_NM                               /* OWNER          */      
              , MAX(DECODE(SEQ,2,X.VNDR_SEQ)) AS N2ND_VNDR_SEQ   
              , MAX(DECODE(SEQ,2,X.VNDR_NM )) AS N2ND_VNDR_NM                               /* OWNER          */                      
              , MAX(DECODE(SEQ,1,X.HIR_CURR_N1ST_CD) ) AS N1ST_HIR_CURR_N1ST_CD                     /* FIRST CURRENCY */     
              , MAX(DECODE(SEQ,1,X.HIR_RT_N1ST_AMT)  ) AS N1ST_HIR_RT_N1ST_AMT                      /* FIRST AMOUNT   */      
              , MAX(DECODE(SEQ,1,X.HIR_CURR_N2ND_CD) ) AS N1ST_HIR_CURR_N2ND_CD                     /* SECOND AMOUNT  */     
              , MAX(DECODE(SEQ,1,X.HIR_RT_N2ND_AMT)  ) AS N1ST_HIR_RT_N2ND_AMT                      /* SECOND AMOUNT  */      
              , MAX(DECODE(SEQ,2,X.HIR_CURR_N1ST_CD) ) AS N2ND_HIR_CURR_N1ST_CD                     /* FIRST CURRENCY */     
              , MAX(DECODE(SEQ,2,X.HIR_RT_N1ST_AMT)  ) AS N2ND_HIR_RT_N1ST_AMT                      /* FIRST AMOUNT   */      
              , MAX(DECODE(SEQ,2,X.HIR_CURR_N2ND_CD) ) AS N2ND_HIR_CURR_N2ND_CD                     /* SECOND AMOUNT  */     
              , MAX(DECODE(SEQ,2,X.HIR_RT_N2ND_AMT)  ) AS N2ND_HIR_RT_N2ND_AMT                      /* SECOND AMOUNT  */     
    FROM     
                (
                -------------------------------------------------------------------------------------
                SELECT      ROW_NUMBER() OVER (ORDER BY Y.SEQ ASC) AS SEQ
                          , Y.VSL_CD
                          , Y.FLET_CTRT_NO
                          , Y.FLET_CTRT_TP_CD
                          , Y.EFF_DT                              
                          , Y.EXP_DT                              
                          , Y.VNDR_SEQ 
                          , Y.VNDR_NM                                         
                          , Y.HIR_CURR_N1ST_CD                    
                          , Y.HIR_RT_N1ST_AMT                     
                          , Y.HIR_CURR_N2ND_CD                    
                          , Y.HIR_RT_N2ND_AMT                                 
                FROM        (
                            SELECT  1 SEQ
                                  , X.VSL_CD
                                  , X.FLET_CTRT_NO
                                  , X.FLET_CTRT_TP_CD
                                  , X.EFF_DT                                /* PERIOD FROM */
                                  , X.EXP_DT                                /* PERIOD TO   */
                                  , X.VNDR_SEQ 
                                  , (SELECT   V.VNDR_LGL_ENG_NM 
                                     FROM     MDM_VENDOR    V 
                                     WHERE    1 = 1
                                     AND      V.VNDR_SEQ    = X.VNDR_SEQ
                                     ) VNDR_NM                             /* OWNER */                            
                                  , Y.HIR_CURR_N1ST_CD                     /* FIRST CURRENCY */
                                  , Y.HIR_RT_N1ST_AMT                      /* FIRST AMOUNT   */
                                  , Y.HIR_CURR_N2ND_CD                     /* SECOND AMOUNT  */
                                  , Y.HIR_RT_N2ND_AMT                      /* SECOND AMOUNT  */
                            FROM    FMS_CONTRACT        X
                                  , FMS_HIRE            Y
                            WHERE   1 = 1
                            AND     X.FLET_CTRT_NO      = Y.FLET_CTRT_NO   
                            AND     X.FLET_CTRT_TP_CD   IN ('OW','TI')  
                            AND     X.FLET_CTRT_FACT_CD = 'ACT' 
                            AND     X.DELT_FLG          = 'N'
                            AND     SYSDATE             BETWEEN TO_DATE(TO_CHAR(X.EFF_DT,'YYYYMMDD'),'YYYYMMDD') AND TO_DATE(TO_CHAR(X.EXP_DT,'YYYYMMDD'),'YYYYMMDD')+0.99999
                            AND     SYSDATE             BETWEEN TO_DATE(TO_CHAR(Y.EFF_DT,'YYYYMMDD'),'YYYYMMDD') AND TO_DATE(TO_CHAR(Y.EXP_DT,'YYYYMMDD'),'YYYYMMDD')+0.99999
                            AND     X.VSL_CD            =  @[vsl_cd]
    
                            UNION ALL
    
                            SELECT  2 SEQ
                                  , X.VSL_CD
                                  , X.FLET_CTRT_NO
                                  , X.FLET_CTRT_TP_CD
                                  , X.EFF_DT                                /* PERIOD FROM */
                                  , X.EXP_DT                                /* PERIOD TO   */
                                  , X.VNDR_SEQ   
                                  , (SELECT   V.VNDR_LGL_ENG_NM 
                                     FROM     MDM_VENDOR    V 
                                     WHERE    1 = 1
                                     AND      V.VNDR_SEQ    = X.VNDR_SEQ
                                     ) VNDR_NM                             /* OWNER */                           
                                  , Y.HIR_CURR_N1ST_CD                     /* FIRST CURRENCY */
                                  , Y.HIR_RT_N1ST_AMT                      /* FIRST AMOUNT   */
                                  , Y.HIR_CURR_N2ND_CD                     /* SECOND AMOUNT  */
                                  , Y.HIR_RT_N2ND_AMT                      /* SECOND AMOUNT  */
                            FROM    FMS_CONTRACT        X
                                  , FMS_HIRE            Y
                            WHERE   1 = 1
                            AND     X.FLET_CTRT_NO      = Y.FLET_CTRT_NO   
                            AND     X.FLET_CTRT_TP_CD   = 'TO'  
                            AND     X.FLET_CTRT_FACT_CD = 'ACT' 
                            AND     X.DELT_FLG          = 'N'
                            AND     SYSDATE             BETWEEN TO_DATE(TO_CHAR(X.EFF_DT,'YYYYMMDD'),'YYYYMMDD') AND TO_DATE(TO_CHAR(X.EXP_DT,'YYYYMMDD'),'YYYYMMDD')+0.99999
                            AND     SYSDATE             BETWEEN TO_DATE(TO_CHAR(Y.EFF_DT,'YYYYMMDD'),'YYYYMMDD') AND TO_DATE(TO_CHAR(Y.EXP_DT,'YYYYMMDD'),'YYYYMMDD')+0.99999
                            AND     X.VSL_CD            =   @[vsl_cd]
                            ) Y
                -------------------------------------------------------------------------------------                        
                ) X

 ) DAILY_HIRE

WHERE MVC.CRR_CD = VC.CRR_CD(+)
AND   MVC.VSL_RGST_CNT_CD = MC1.CNT_CD(+)
AND   SUBSTR(MVC.RGST_PORT_CD,1,2) = MC2.CNT_CD(+)
AND   MVC.RGST_PORT_CD = ML.LOC_CD(+)
AND   MVC.VSL_CD =   @[vsl_cd]			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
