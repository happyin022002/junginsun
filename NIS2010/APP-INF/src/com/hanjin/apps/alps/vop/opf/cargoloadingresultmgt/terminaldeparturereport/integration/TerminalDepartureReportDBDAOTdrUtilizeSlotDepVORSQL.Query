<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TerminalDepartureReportDBDAOTdrUtilizeSlotDepVORSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
SELECT		X.OPR_CD,
			------------------
			-- Trade 
			------------------
			TRADE_FULL,
			TRADE_MT,
			TRADE_AB,
			(NVL(TRADE_FULL, 0) + NVL(TRADE_MT, 0) + NVL(TRADE_AB, 0)) AS TRADE_SUB_SLOT,
			(NVL(TRADE_FULL_W, 0) + NVL(TRADE_MT_W, 0) + NVL(TRADE_AB_W, 0)) AS TRADE_SUB_WGT,
			------------------
			-- Inter
			------------------
			INTER_FULL,
			INTER_MT,
			INTER_AB,
			(NVL(INTER_FULL, 0) + NVL(INTER_MT, 0) + NVL(INTER_AB, 0)) AS INTER_SUB_SLOT,
			(NVL(INTER_FULL_W, 0) + NVL(INTER_MT_W, 0) + NVL(INTER_AB_W, 0)) AS INTER_SUB_WGT,
			------------------
			-- Grand TTL
			------------------
			(NVL(TRADE_FULL, 0) + NVL(TRADE_MT, 0) + NVL(TRADE_AB, 0))  + 
			(NVL(INTER_FULL, 0) + NVL(INTER_MT, 0) + NVL(INTER_AB, 0))
			AS GRAND_TTL_SLOT,

			(NVL(TRADE_FULL_W, 0) + NVL(TRADE_MT_W, 0) + NVL(TRADE_AB_W, 0))  + 
			(NVL(INTER_FULL_W, 0) + NVL(INTER_MT_W, 0) + NVL(INTER_AB_W, 0))
			AS GRAND_TTL_WGT
FROM
(
	SELECT  C.OPR_CD,
	        SUM(DECODE(C.STATUS, @[sl_status1], DECODE(C.CNTR_TYPE, 'F', DECODE(C.CNTR_SIZE, 'A', 0, C.QTY), 0),0))     TRADE_FULL,
	        SUM(DECODE(C.STATUS, @[sl_status1], DECODE(C.CNTR_TYPE, 'E', DECODE(C.CNTR_SIZE, 'A', 0, C.QTY), 0),0))     TRADE_MT,
	        SUM(DECODE(C.STATUS, @[sl_status1], DECODE(C.CNTR_SIZE, 'A', C.QTY, 0),0))                                	TRADE_AB,

	        SUM(DECODE(C.STATUS, @[sl_status1], DECODE(C.CNTR_TYPE, 'F', DECODE(C.CNTR_SIZE, 'A', 0, C.WEIGHT), 0),0))  TRADE_FULL_W,
	        SUM(DECODE(C.STATUS, @[sl_status1], DECODE(C.CNTR_TYPE, 'E', DECODE(C.CNTR_SIZE, 'A', 0, C.WEIGHT), 0),0))  TRADE_MT_W,
	        SUM(DECODE(C.STATUS, @[sl_status1], DECODE(C.CNTR_SIZE, 'A', C.WEIGHT, 0),0))                               TRADE_AB_W,

	        SUM(DECODE(C.STATUS, @[sl_status2], DECODE(C.CNTR_TYPE, 'F', DECODE(C.CNTR_SIZE, 'A', 0, C.QTY), 0), 0))    INTER_FULL,
	        SUM(DECODE(C.STATUS, @[sl_status2], DECODE(C.CNTR_TYPE, 'E', DECODE(C.CNTR_SIZE, 'A', 0, C.QTY), 0), 0))    INTER_MT,
	        SUM(DECODE(C.STATUS, @[sl_status2], DECODE(C.CNTR_TYPE, 'A', C.QTY, 0),0))                                	INTER_AB,

	        SUM(DECODE(C.STATUS, @[sl_status2], DECODE(C.CNTR_TYPE, 'F', DECODE(C.CNTR_SIZE, 'A', 0, C.WEIGHT), 0), 0)) INTER_FULL_W,
	        SUM(DECODE(C.STATUS, @[sl_status2], DECODE(C.CNTR_TYPE, 'E', DECODE(C.CNTR_SIZE, 'A', 0, C.WEIGHT), 0), 0)) INTER_MT_W,
	        SUM(DECODE(C.STATUS, @[sl_status2], DECODE(C.CNTR_TYPE, 'A', C.WEIGHT, 0),0))                               INTER_AB_W

	FROM   VSK_VSL_PORT_SKD V, TDR_HEADER H, TDR_UTILIZE C
	WHERE  V.VSL_CD       = @[vsl_cd]
	AND    V.SKD_VOY_NO   = @[voy_no]
	AND    V.SKD_DIR_CD   = @[dir_cd]
	AND	   V.YD_CD		  = @[yd_cd]
    AND    V.CLPT_IND_SEQ = @[clpt_ind_seq]
	AND    V.VSL_CD       = H.VSL_CD
	AND    V.SKD_VOY_NO   = H.VOY_NO
	AND    V.SKD_DIR_CD   = H.DIR_CD
	AND    V.VPS_PORT_CD  = H.PORT_CD
	AND    V.CLPT_IND_SEQ = H.CALL_IND
	AND    H.VSL_CD       = C.VSL_CD
	AND    H.VOY_NO       = C.VOY_NO
	AND    H.DIR_CD       = C.DIR_CD
	AND    H.PORT_CD      = C.PORT_CD
	AND    H.CALL_IND     = C.CALL_IND
	AND	   C.STATUS		  IN (@[sl_status1], @[sl_status2])
	GROUP BY C.OPR_CD
)X
ORDER BY X.OPR_CD			]]></sql>
			<params>
				<param name="sl_status1" type="12" value="" out="N"/>
				<param name="sl_status2" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="voy_no" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="yd_cd" type="12" value="" out="N"/>
				<param name="clpt_ind_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
