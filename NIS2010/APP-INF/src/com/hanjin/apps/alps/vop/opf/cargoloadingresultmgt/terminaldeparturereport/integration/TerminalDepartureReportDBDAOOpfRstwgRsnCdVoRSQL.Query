<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TerminalDepartureReportDBDAOOpfRstwgRsnCdVoRSQL">
			<desc><![CDATA[입력한 Reason 코드의 정합성을 체크한다.
2011.08.16 김민아 [CHM-201112982] [TDR] R/H의 acct 관련 보완요청 : 두개의 코드 값을 한번에 체크한다.]]></desc>
			<sql><![CDATA[
SELECT  RSTWG_RSN_CD
       ,DELT_FLG
  FROM  (
        SELECT  RSTWG_RSN_CD
               ,MAX(RSTWG_RSN_CD_FULL_DESC) AS RSTWG_RSN_CD_FULL_DESC
               ,SUM(COUNT(1)) OVER() AS TOT_CNT
               ,DELT_FLG
          FROM  OPF_RSTWG_RSN_CD
         WHERE  DELT_FLG = 'N'
           AND  (RSTWG_CD_TP_CD = 'S' AND RSTWG_RSN_CD = SUBSTR(@[rstwg_rsn_cd], 1, 1))
            OR  (RSTWG_CD_TP_CD = 'R' AND RSTWG_RSN_CD = SUBSTR(@[rstwg_rsn_cd], 2))
        GROUP BY RSTWG_RSN_CD, DELT_FLG, RSTWG_CD_TP_CD
        ORDER BY RSTWG_CD_TP_CD
        )
 WHERE  1 = 1
   AND  TOT_CNT > 1
   AND  ROWNUM = 1
GROUP BY RSTWG_RSN_CD, DELT_FLG			]]></sql>
			<params>
				<param name="rstwg_rsn_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
