<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="VesselScheduleMgtDBDAOCheckVskVslPortSkdRSQL">
			<desc><![CDATA[Vessel Port Schedule에 VVD, Port가 존재하는지 확인한다.

* History
* 2011.02.22 진마리아 CHM-201108456-01 사업계획용 스케줄 정보 노출 대응을 위한 시스템 업데이트건]]></desc>
			<sql><![CDATA[
SELECT  NVL(SUM (1), 0) AS CNT
		, NVL(SUM (
                  CASE WHEN TURN_PORT_IND_CD IN ('D', 'V', 'F') AND (TURN_SKD_VOY_NO != @[turn_skd_voy_no] OR TURN_SKD_DIR_CD != @[turn_skd_dir_cd])
                       THEN 1
                       ELSE 0
                  END
              ), 0) AS VRT_CNT /* 연결하려는 VVD에 쪽 VIRUAL PORT에 사용자가 입력하는 TURN VVD가 같은지 확인*/ 
        , MAX((
            SELECT  MAX(VSL_CD || TURN_SKD_VOY_NO || TURN_SKD_DIR_CD)
            FROM    VSK_BUD_VSL_PORT_SKD T11
            WHERE   VSL_CD = T1.VSL_CD
            AND     SKD_VOY_NO = T1.SKD_VOY_NO
            AND     SKD_DIR_CD = T1.SKD_DIR_CD
            AND     TURN_PORT_IND_CD IN ('D', 'V', 'F')
          )) AS VVD	/* 연결하려는 VVD에 쪽 VIRUAL PORT에 VVD를 조회 */ 
FROM	VSK_BUD_VSL_PORT_SKD T1
WHERE	VSL_CD		= @[vsl_cd]
AND	SKD_VOY_NO	= @[skd_voy_no]
AND	SKD_DIR_CD	= @[skd_dir_cd]			]]></sql>
			<params>
				<param name="turn_skd_voy_no" type="12" value="" out="N"/>
				<param name="turn_skd_dir_cd" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
