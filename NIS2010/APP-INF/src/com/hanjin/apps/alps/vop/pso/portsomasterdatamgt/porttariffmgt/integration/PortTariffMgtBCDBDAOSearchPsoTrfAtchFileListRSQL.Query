<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PortTariffMgtBCDBDAOSearchPsoTrfAtchFileListRSQL">
			<desc><![CDATA[searchPsoTrfAtchFileList]]></desc>
			<sql><![CDATA[
SELECT * FROM (
    SELECT 
         RANK() OVER(PARTITION BY YD_CHG_NO  ORDER BY UPD_DT DESC) AS RANK_CD,
         A.* FROM (
         SELECT  T1.YD_CHG_NO
               ,T1.ATCH_FILE_DIV_CD
               ,T2.FILE_SAV_ID
               ,T2.FILE_UPLD_NM     AS FILE_NM
               ,T2.FILE_SZ_CAPA     AS FILE_SIZE
               ,T2.FILE_PATH_URL    AS FILE_PATH
               ,TO_CHAR(T1.UPD_DT, 'YYYY-MM-DD')   AS UPD_DT
               ,DECODE(T1.CTRT_SCR_FLG, 'Y', 1, 0) AS CTRT_SCR_FLG
         FROM  PSO_TRF_ATCH_FILE T1
               ,COM_UPLD_FILE T2
         WHERE  T1.YD_CHG_NO = @[yd_chg_no]
           AND  T1.ATCH_FILE_DIV_CD = @[atch_file_div_cd]
           AND  T1.FILE_SAVE_ID = T2.FILE_SAV_ID
           AND  T2.DELT_FLG = 'N'
		#if(${atchFileAuth} != 'Y') 
   		   AND  T1.CTRT_SCR_FLG = 'N' 
		#end
        ORDER BY T2.UPD_DT DESC
    ) A 
)
WHERE RANK_CD = 1			]]></sql>
			<params>
				<param name="yd_chg_no" type="12" value="1" out="N"/>
				<param name="atch_file_div_cd" type="12" value="R" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
