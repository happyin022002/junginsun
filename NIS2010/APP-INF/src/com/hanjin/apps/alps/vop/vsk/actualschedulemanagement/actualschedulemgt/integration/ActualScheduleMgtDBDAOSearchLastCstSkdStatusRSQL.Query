<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ActualScheduleMgtDBDAOSearchLastCstSkdStatusRSQL">
			<desc><![CDATA[특정 Port Schedule의 최종 상태 ( Actual 혹은 Estimate ) 를 조회한다.
---------------------------------------------------------------------------
2010.12.22 CHM-201007901-01 진마리아 SPP에서 전송된 Actual Port SKD에 대한 처리 로직 수정]]></desc>
			<sql><![CDATA[
SELECT	CASE WHEN NVL(T1.PORT_SKD_STS_CD, '0') >= @[port_skd_sts_cd] THEN T1.PORT_SKD_STS_CD ELSE @[port_skd_sts_cd] END  AS PORT_SKD_STS_CD
		, CASE WHEN ACT_ATA_INP_DT IS NULL AND @[act_arr_dt] IS NULL 
		       THEN NULL
			   WHEN ACT_ATA_INP_DT IS NULL AND @[act_arr_dt] IS NOT NULL 
			   THEN TO_CHAR(VPS_ETA_DT, 'YYYY-MM-DD HH24:MI')
			   ELSE TO_CHAR(LST_ETA_DT, 'YYYY-MM-DD HH24:MI')
		  END AS LST_ETA_DT
		, CASE WHEN ACT_ATB_INP_DT IS NULL AND @[act_brth_dt] IS NULL
		       THEN NULL
			   WHEN ACT_ATB_INP_DT IS NULL AND @[act_brth_dt] IS NOT NULL 
			   THEN TO_CHAR(VPS_ETB_DT, 'YYYY-MM-DD HH24:MI')
			   ELSE TO_CHAR(LST_ETB_DT, 'YYYY-MM-DD HH24:MI')
		  END AS LST_ETB_DT
		, CASE WHEN ACT_ATD_INP_DT IS NULL AND @[act_dep_dt] IS NULL
		       THEN NULL
			   WHEN ACT_ATD_INP_DT IS NULL AND @[act_dep_dt] IS NOT NULL 
			   THEN TO_CHAR(VPS_ETD_DT, 'YYYY-MM-DD HH24:MI')
			   ELSE TO_CHAR(LST_ETD_DT, 'YYYY-MM-DD HH24:MI')
		  END AS LST_ETD_DT
	    , T1.TURN_PORT_FLG
        , T1.TURN_PORT_IND_CD
        , T1.TURN_SKD_VOY_NO
        , T1.TURN_SKD_DIR_CD
        , T1.TURN_CLPT_IND_SEQ
        , T1.SLAN_CD
FROM	VSK_VSL_PORT_SKD T1, VSK_ACT_PORT_SKD T2
WHERE	1	= 1
AND		T1.VSL_CD		= T2.VSL_CD			(+)
AND		T1.SKD_VOY_NO	= T2.SKD_VOY_NO		(+)
AND		T1.SKD_DIR_CD	= T2.SKD_DIR_CD		(+)
AND		T1.VPS_PORT_CD	= T2.VPS_PORT_CD	(+)
AND		T1.CLPT_IND_SEQ	= T2.CLPT_IND_SEQ	(+)
AND		T1.VSL_CD 		= @[vsl_cd]
AND		T1.SKD_VOY_NO 	= @[skd_voy_no]
AND		T1.SKD_DIR_CD 	= @[skd_dir_cd]
AND		T1.VPS_PORT_CD	= @[vps_port_cd]
AND		T1.CLPT_IND_SEQ	= @[clpt_ind_seq]			]]></sql>
			<params>
				<param name="port_skd_sts_cd" type="12" value="" out="N"/>
				<param name="act_arr_dt" type="12" value="" out="N"/>
				<param name="act_brth_dt" type="12" value="" out="N"/>
				<param name="act_dep_dt" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="vps_port_cd" type="12" value="" out="N"/>
				<param name="clpt_ind_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
