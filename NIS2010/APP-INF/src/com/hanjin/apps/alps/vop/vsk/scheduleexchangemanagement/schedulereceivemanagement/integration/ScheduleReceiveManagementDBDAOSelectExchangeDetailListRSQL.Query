<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ScheduleReceiveManagementDBDAOSelectExchangeDetailListRSQL">
			<desc><![CDATA[Exchange Detail List 조회]]></desc>
			<sql><![CDATA[
SELECT    	D.SND_RCV_KND_CD
      ,    	D.SKD_EDI_RCV_DT

	  ,		(SELECT VS.VSL_SLAN_CD FROM VSK_VSL_SKD VS WHERE VS.VSL_CD = D.VSL_CD_CTNT AND VS.SKD_VOY_NO = D.SKD_VOY_NO_CTNT AND VS.SKD_DIR_CD = D.SKD_DIR_CD_CTNT)
			AS VSL_SLAN_CD_CTNT

      ,    	D.VSL_CD_CTNT
      ,    	D.SKD_VOY_NO_CTNT
      ,    	D.SKD_DIR_CD_CTNT
      
      ,    	D.SKD_EDI_RCV_SEQ
      ,    	D.EDI_XCH_LOG_SEQ
      ,    	PS.VPS_PORT_CD								AS VPS_PORT_CD_CTNT
      ,    	D.VPS_PORT_NM
      ,    	D.YD_CD_CTNT
      ,    	D.CLPT_IND_SEQ_CTNT
      ,    	D.CLPT_SEQ_CTNT
      ,    	D.LOC_IND_CD_CTNT
      ,    	D.CALL_YD_IND_SEQ_CTNT

      ,     TO_CHAR(PS.VPS_ETA_DT,'YYYYMMDDHH24MI')   	AS CST_ETA_DT
      ,     TO_CHAR(PS.VPS_ETB_DT,'YYYYMMDDHH24MI')   	AS CST_ETB_DT
      ,     TO_CHAR(PS.VPS_ETD_DT,'YYYYMMDDHH24MI')   	AS CST_ETD_DT

      ,      CASE WHEN D.VPS_ETA_DT_CTNT IS NULL THEN TO_CHAR(PS.VPS_ETA_DT,'YYYYMMDDHH24MI')
                  ELSE TO_CHAR(TO_DATE(D.VPS_ETA_DT_CTNT,'YYYYMMDDHH24MI') ,'YYYYMMDDHH24MI')
             END  VPS_ETA_DT_CTNT
      ,      CASE WHEN D.VPS_ETB_DT_CTNT IS NULL THEN TO_CHAR(PS.VPS_ETB_DT,'YYYYMMDDHH24MI')
                  ELSE TO_CHAR(TO_DATE(D.VPS_ETB_DT_CTNT,'YYYYMMDDHH24MI') ,'YYYYMMDDHH24MI')
             END  VPS_ETB_DT_CTNT
      ,      CASE WHEN D.VPS_ETD_DT_CTNT IS NULL THEN TO_CHAR(PS.VPS_ETD_DT,'YYYYMMDDHH24MI')
                  ELSE TO_CHAR(TO_DATE(D.VPS_ETD_DT_CTNT,'YYYYMMDDHH24MI') ,'YYYYMMDDHH24MI')
             END  VPS_ETD_DT_CTNT 

      ,    	D.ACT_ARR_DT_CTNT
      ,    	D.ACT_BRTH_DT_CTNT
      ,    	D.ACT_DEP_DT_CTNT
      ,    	D.TURN_PORT_FLG_CTNT
      ,    	D.TURN_PORT_IND_CD_CTNT
      ,    	D.TURN_SKD_VOY_NO_CTNT
      ,    	D.TURN_SKD_DIR_CD_CTNT
      ,    	D.TURN_CLPT_IND_SEQ_CTNT
      ,    	D.CRE_USR_ID
      ,    	D.CRE_DT
      ,    	PS.UPD_USR_ID
      ,    	TO_CHAR(PS.UPD_DT,'YYYYMMDDHH24MISS')	AS UPD_DT

      ------- ::2014-04-14::----------------------------------------------------------------
      ,     PS.CLPT_SEQ
      ,     PS.YD_CD
      ,     PS.CALL_YD_IND_SEQ
      ,     SUBSTR(PS.YD_CD,6,2)					AS TML_CD
      ,     PS.TURN_PORT_FLG
      ,     PS.TURN_PORT_IND_CD
      ,     PS.TURN_SKD_VOY_NO
      ,     PS.TURN_SKD_DIR_CD
      ,     PS.TURN_CLPT_IND_SEQ


FROM      	VSK_VSL_SKD_XCH_EDI_DTL  	D
      ,   	VSK_VSL_PORT_SKD         	PS
WHERE     	1 = 1
AND       	PS.VSL_CD                	= D.VSL_CD_CTNT
AND       	PS.SKD_VOY_NO            	= D.SKD_VOY_NO_CTNT
AND       	PS.SKD_DIR_CD            	= D.SKD_DIR_CD_CTNT

--AND       	PS.VPS_PORT_CD           	= D.VPS_PORT_CD_CTNT
AND         DECODE(PS.VPS_PORT_CD,'USLGB','0','USLAX','0',PS.VPS_PORT_CD)
                                       = DECODE(D.VPS_PORT_CD_CTNT,'USLGB','0','USLAX','0',D.VPS_PORT_CD_CTNT)

AND       	PS.CLPT_IND_SEQ          	= '1'
AND       	D.SND_RCV_KND_CD        	= 'R'
AND       	D.SKD_EDI_RCV_SEQ       	= @[skd_edi_rcv_seq]

 			]]></sql>
			<params>
				<param name="skd_edi_rcv_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
