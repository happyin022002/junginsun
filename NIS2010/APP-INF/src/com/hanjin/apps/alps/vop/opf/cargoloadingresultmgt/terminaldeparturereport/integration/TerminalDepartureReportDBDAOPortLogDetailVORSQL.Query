<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TerminalDepartureReportDBDAOPortLogDetailVORSQL">
			<desc><![CDATA[PortLogDetail Search]]></desc>
			<sql><![CDATA[
SELECT 
 CRANE_NO 
,WORK_COMM
,WORK_COMP
,BREAK_DOWN
,MEAL   
,WEATHER
,OTHER
,TOTAL 
,WORK  
,LOSE_TIME
,TO_CHAR(FLOOR(NET_WORK)) ||':'|| LTRIM(TO_CHAR(ROUND(ABS(MOD(NET_WORK*60,60))),'00')) AS NET_WORK_HRS
,GROSS_WORK
,GROSS_WORK_HRS
FROM 
(
SELECT C.CRANE_NO   CRANE_NO,
       C.START_DATE	WORK_COMM,
       C.END_DATE	WORK_COMP,
       DECODE(LENGTH(BDT_TIME), 4, '00' || BDT_TIME, 5, '0' || BDT_TIME, BDT_TIME) AS BREAK_DOWN,
       DECODE(LENGTH(MT_TIME), 4, '00' || MT_TIME, 5, '0' || MT_TIME, MT_TIME) AS MEAL,
       DECODE(LENGTH(BW_TIME), 4, '00' || BW_TIME, 5, '0' || BW_TIME, BW_TIME) AS WEATHER,
       DECODE(LENGTH(OTHER_TIME), 4, '00' || OTHER_TIME, 5, '0' || OTHER_TIME, OTHER_TIME) AS OTHER,
       DECODE(LENGTH(LOSE_TIME), 4, '00' || LOSE_TIME, 5, '0' || LOSE_TIME, LOSE_TIME) AS TOTAL,
       DECODE(LENGTH(WORK_TIME), 4, '00' || WORK_TIME, 5, '0' || WORK_TIME, WORK_TIME) AS WORK,
       ROUND(TO_NUMBER(SUBSTR(C.LOSE_TIME,1,INSTR(C.LOSE_TIME,':')-1))+TO_NUMBER(SUBSTR(C.LOSE_TIME,INSTR(C.LOSE_TIME,':')+1)/60),2) LOSE_TIME,
       (C.END_DATE - C.START_DATE)*24 - (TO_NUMBER(SUBSTR(C.LOSE_TIME,1,INSTR(C.LOSE_TIME,':')-1))+TO_NUMBER(SUBSTR(C.LOSE_TIME,INSTR(C.LOSE_TIME,':')+1)/60)) AS NET_WORK,                          
       TO_CHAR(ROUND(C.END_DATE - C.START_DATE,2)*24, '999.99')  AS GROSS_WORK,
	   TO_CHAR(FLOOR((C.END_DATE - C.START_DATE)*24)) || ':' || LTRIM(TO_CHAR(ROUND(ABS(MOD((C.END_DATE - C.START_DATE)*24*60,60))), '00'))  AS GROSS_WORK_HRS
FROM   VSK_VSL_PORT_SKD V, TDR_HEADER H, TDR_CRANE C
WHERE  V.VSL_CD       = H.VSL_CD
AND    V.SKD_VOY_NO   = H.VOY_NO
AND    V.SKD_DIR_CD   = H.DIR_CD
AND    V.VPS_PORT_CD  = H.PORT_CD
AND    V.CLPT_IND_SEQ = H.CALL_IND
AND    H.VSL_CD       = C.VSL_CD
AND    H.VOY_NO       = C.VOY_NO
AND    H.DIR_CD       = C.DIR_CD
AND    H.PORT_CD      = C.PORT_CD
AND    H.CALL_IND     = C.CALL_IND
AND    V.VSL_CD  	  = @[vsl_cd]
AND    V.SKD_VOY_NO   = @[voy_no]
AND    V.SKD_DIR_CD   = @[dir_cd]
AND    V.YD_CD 	      = @[yd_cd]
AND    V.CLPT_IND_SEQ = @[clpt_ind_seq]
)
ORDER BY CRANE_NO			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="voy_no" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="yd_cd" type="12" value="" out="N"/>
				<param name="clpt_ind_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
