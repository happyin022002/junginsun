<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralInvoiceAuditDBDAOSearchGwApprFileAttachRSQL">
			<desc><![CDATA[2014.11.03 PSO FILE 조회하여 GW로 전송하기위한 FILE정보]]></desc>
			<sql><![CDATA[
WITH FILES AS (
                                  SELECT 'PSO' AS L_FILE_MODULE_ID
                                            ,A.FILE_SAVE_ID AS L_FILE_SAV_ID
                                   FROM PSO_TRF_ATCH_FILE A,
                                            AP_PAY_INV C, 
                                             PSO_CHARGE D,
                                             PSO_CHG_DTL E
                                 WHERE C.INV_RGST_NO = D.INV_RGST_NO 
                                      AND D.ISS_CTY_CD   = E.ISS_CTY_CD
                                      AND D.SO_SEQ         = E.SO_SEQ
                                      AND E.YD_CHG_NO   = A.YD_CHG_NO
                                      AND C.CSR_NO = @[csr_no]
                                      AND C.INV_SUB_SYS_CD = 'PSO'
                                      AND C.DELT_FLG = 'N'
                                      AND C.CSR_NO IS NOT NULL
                                      AND E.YD_CHG_NO IS NOT NULL
                                 )
                SELECT A.L_FILE_MODULE_ID,  A.L_FILE_SAV_ID  ,B.FILE_UPLD_NM AS L_FILE_NM 
                   FROM  FILES A, COM_UPLD_FILE B
                  WHERE A.L_FILE_SAV_ID = B.FILE_SAV_ID
                    AND B.DELT_FLG = 'N'
 GROUP BY A.L_FILE_MODULE_ID,  A.L_FILE_SAV_ID  ,B.FILE_UPLD_NM			]]></sql>
			<params>
				<param name="csr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
