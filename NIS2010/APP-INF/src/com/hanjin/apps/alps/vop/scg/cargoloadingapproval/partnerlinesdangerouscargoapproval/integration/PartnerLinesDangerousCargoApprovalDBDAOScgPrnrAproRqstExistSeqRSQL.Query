<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PartnerLinesDangerousCargoApprovalDBDAOScgPrnrAproRqstExistSeqRSQL">
			<desc><![CDATA[Dangerous CGO Application Details for Partner Lines 의 신규 입력된 
데이터 건에 대해서 기존에 존재하는 건과 
bkg_ref_no, vvd, bkg operator, pol+(calling seq ), pod+(calling seq ) 의 조합이
같은 건이 있는 경우 해당 건은 insert 가 되지 않아야 하며 
존재하던 spcl_cgo_rqst_seq 를 리턴받아 detail 건에 적용 해야 한다.
-------------------------------------------------------------------------------------------
2012.01.11 김민아 [CHM-201115273-01] [VOP-SCG] SPCL CGO APVL for Partner Lines - AWK 보완]]></desc>
			<sql><![CDATA[
SELECT NVL(MAX(A.SPCL_CGO_RQST_SEQ),0) SPCL_CGO_RQST_SEQ
FROM   SCG_PRNR_APRO_RQST A
     , SCG_PRNR_APRO_RQST_CGO B 
WHERE  A.CRR_CD            = B.CRR_CD
AND    A.BKG_REF_NO        = B.BKG_REF_NO
AND    A.SPCL_CGO_RQST_SEQ = B.SPCL_CGO_RQST_SEQ
AND    A.DG_FLG            = @[dg_flg]
AND    A.AWK_FLG           = @[awk_flg]
AND    B.CGO_OPR_CD    = @[cgo_opr_cd]
AND    A.BKG_REF_NO    = @[bkg_ref_no]
AND    A.VSL_CD        = @[vsl_cd]
AND    A.SKD_VOY_NO    = @[skd_voy_no]
AND    A.SKD_DIR_CD    = @[skd_dir_cd]
AND    A.POL_CD = SUBSTR(@[pol_cd],1,5)
AND    A.POL_CLPT_IND_SEQ = DECODE ( SUBSTR(@[pol_cd],6,1), NULL, @[pol_clpt_ind_seq], SUBSTR(@[pol_cd],6,1) )
AND    A.POD_CD = SUBSTR(@[pod_cd],1,5)
AND    A.POD_CLPT_IND_SEQ = DECODE ( SUBSTR(@[pod_cd],6,1), NULL, @[pod_clpt_ind_seq], SUBSTR(@[pod_cd],6,1) )			]]></sql>
			<params>
				<param name="dg_flg" type="12" value="" out="N"/>
				<param name="awk_flg" type="12" value="" out="N"/>
				<param name="cgo_opr_cd" type="12" value="" out="N"/>
				<param name="bkg_ref_no" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pol_clpt_ind_seq" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="pod_clpt_ind_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
