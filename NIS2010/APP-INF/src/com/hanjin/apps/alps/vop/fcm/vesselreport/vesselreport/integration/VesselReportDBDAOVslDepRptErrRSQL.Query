<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="VesselReportDBDAOVslDepRptErrRSQL">
			<desc><![CDATA[VslDepRptErr]]></desc>
			<sql><![CDATA[
SELECT	*
FROM	(
            SELECT  F.DEP_RPT_ERR_SEQ
                    , F.VSL_CD||F.SKD_VOY_NO||F.SKD_DIR_CD AS VVD
                    , F.DEP_PORT_CD 
                    , F.CLPT_IND_SEQ
                    , F.DEP_RPT_ERR_TP_CD
                    , C.INTG_CD_VAL_DESC
                    , F.VSL_SLAN_CD
                    , F.NXT_PORT_CD
                    , TO_CHAR(F.RUP_DT, 'YYYY-MM-DD HH24:MI:SS') AS RUP_DT
                    , TO_CHAR(F.SB_ENG_DT, 'YYYY-MM-DD HH24:MI:SS') AS SB_ENG_DT
                    , F.RCV_DT
                    , F.RCV_SEQ
                    , F.VSL_CD
                    , F.VPS_ETD_DT
            FROM    VSK_VSL_PORT_SKD V
                    , FCM_DEP_RPT_ERR F
                    , COM_INTG_CD_DTL C
            WHERE   1=1
            AND     F.VSL_CD = V.VSL_CD (+)
            AND     F.SKD_VOY_NO = V.SKD_VOY_NO (+)
            AND     F.SKD_DIR_CD = V.SKD_DIR_CD (+)
            AND     F.DEP_PORT_CD = V.VPS_PORT_CD (+)
            AND     F.CLPT_IND_SEQ = V.CLPT_IND_SEQ (+)
            AND     F.DEP_RPT_ERR_TP_CD <> 'PO'
            AND     F.DEP_RPT_ERR_TP_CD = C.INTG_CD_VAL_CTNT
            AND     C.INTG_CD_ID = 'CD03523'
#if( ${fm_dt} != '' )
    -- Canal SKD does not have ETD. RUP_DT is all exist.
    AND F.RUP_DT BETWEEN TO_DATE(REPLACE(@[fm_dt], '-', ''), 'YYYY-MM-DD')     -- UI Condition : Period From
                     AND TO_DATE(REPLACE(@[to_dt], '-', ''), 'YYYY-MM-DD')+0.99999 -- UI Condition : Period To
#end
#if( ${vsl_slan_cd} != '' )								  
	-- UI Condition : Lane Code
    AND F.VSL_SLAN_CD IN (                     
		#foreach($sVslSlanCd in ${vel_vsl_slan_cd})  
			'$sVslSlanCd',  
			#end  
			'') 
#end
#if( ${vsl_cd} != '' )
	-- UI Condition : Vessel Code
    AND F.VSL_CD IN (                     
		#foreach($sVslCd in ${vel_vsl_cd})  
			'$sVslCd',  
			#end  
			'') 
#end
#if( ${vps_port_cd} != '' )
	-- UI Condition : Port Code
    AND F.DEP_PORT_CD IN (                     
		#foreach($sVpsPortCd in ${vel_vps_port_cd})  
			'$sVpsPortCd',  
			#end  
			'') 
#end
#if( ${skd_dir_cd} != '' )
	-- UI Condition : Direction Code
    AND F.SKD_DIR_CD=@[skd_dir_cd]
#end
) X
WHERE	1=1

ORDER BY VSL_CD, VPS_ETD_DT			]]></sql>
			<params>
				<param name="fm_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
