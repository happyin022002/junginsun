<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ProformaScheduleMgtDBDAOSearchHireBaseByDznCapaRSQL">
			<desc><![CDATA[SearchHireBaseByDznCapa]]></desc>
			<sql><![CDATA[
SELECT  '' AS VSL_OWNR_FLG, TO_NUMBER(@[vsl_csl1]) AS VSL_CSL1, TO_NUMBER(@[vsl_csl2]) AS VSL_CSL2,  TO_NUMBER(@[vsl_csl3]) AS VSL_CSL3 FROM DUAL
UNION ALL
SELECT @[vsl_ownr_flg_y]
, NVL( ROUND(AVG(DECODE(T2.CNTR_VSL_CLSS_CAPA, @[vsl_csl1], T1.DHIR_AMT / T2.CNTR_VSL_CLSS_CAPA)), 2), 0 ) AS DAILY_HIRE_BY_CLASS01
, NVL( ROUND(AVG(DECODE(T2.CNTR_VSL_CLSS_CAPA, @[vsl_csl2], T1.DHIR_AMT / T2.CNTR_VSL_CLSS_CAPA)), 2), 0 ) AS DAILY_HIRE_BY_CLASS02
, NVL( ROUND(AVG(DECODE(T2.CNTR_VSL_CLSS_CAPA, @[vsl_csl3], T1.DHIR_AMT / T2.CNTR_VSL_CLSS_CAPA)), 2), 0 ) AS DAILY_HIRE_BY_CLASS03
FROM    VSK_DLY_HIR T1, MDM_VSL_CNTR T2
WHERE   1   = 1
AND     T1.VSL_CD   = T2.VSL_CD
AND     PLN_YR      = @[slt_prc_wrk_yr]
AND     T2.CNTR_DZN_CAPA IN (@[vsl_csl1], @[vsl_csl2], @[vsl_csl3])
UNION ALL
SELECT  @[vsl_ownr_flg_n]
, NVL( MAX( ROUND ( DECODE( T3.CNTR_VSL_CLSS_CAPA, @[vsl_csl1], (NVL(T2.HIR_RT_N1ST_AMT, 0) + (NVL(T2.HIR_RT_N2ND_AMT, 0) / T4.USD_LOCL_XCH_RT)) / TO_NUMBER(@[vsl_csl1]) ), 2)), 0) AS CLASS01
, NVL( MAX( ROUND ( DECODE( T3.CNTR_VSL_CLSS_CAPA, @[vsl_csl2], (NVL(T2.HIR_RT_N1ST_AMT, 0) + (NVL(T2.HIR_RT_N2ND_AMT, 0) / T4.USD_LOCL_XCH_RT)) / TO_NUMBER(@[vsl_csl2]) ), 2)), 0) AS CLASS02
, NVL( MAX( ROUND ( DECODE( T3.CNTR_VSL_CLSS_CAPA, @[vsl_csl3], (NVL(T2.HIR_RT_N1ST_AMT, 0) + (NVL(T2.HIR_RT_N2ND_AMT, 0) / T4.USD_LOCL_XCH_RT)) / TO_NUMBER(@[vsl_csl3]) ), 2)), 0) AS CLASS03
FROM    FMS_CONTRACT T1, FMS_HIRE T2, MDM_VSL_CNTR T3, GL_MON_XCH_RT T4
WHERE   T1.FLET_CTRT_NO      = T2.FLET_CTRT_NO(+)
AND     SYSDATE     BETWEEN T2.EFF_DT   AND T2.EXP_DT + 0.99999
AND     T1.DELT_FLG          = 'N'
AND     T4.ACCT_XCH_RT_YRMON = (@[slt_prc_wrk_yr]|| CASE WHEN @[bse_qtr_cd] = '1Q' THEN '01' WHEN @[bse_qtr_cd] = '2Q' THEN '04' WHEN @[bse_qtr_cd] = '3Q' THEN '07' ELSE '10' END)
AND     T4.ACCT_XCH_RT_LVL   = 1
AND     T4.CURR_CD           = NVL(T2.HIR_CURR_N2ND_CD, 'USD')
AND     T1.VSL_CD            = T3.VSL_CD
AND     T3.CNTR_DZN_CAPA IN (@[vsl_csl1], @[vsl_csl2], @[vsl_csl3])			]]></sql>
			<params>
				<param name="vsl_csl1" type="12" value="" out="N"/>
				<param name="vsl_csl2" type="12" value="" out="N"/>
				<param name="vsl_csl3" type="12" value="" out="N"/>
				<param name="vsl_ownr_flg_y" type="12" value="" out="N"/>
				<param name="slt_prc_wrk_yr" type="12" value="" out="N"/>
				<param name="vsl_ownr_flg_n" type="12" value="" out="N"/>
				<param name="bse_qtr_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
