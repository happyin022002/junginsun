<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TerminalDepartureReportDBDAOMergeVnorCSQL">
			<desc><![CDATA[OPF_VNOR 테이블 Merge

History
2015.04.21 이병훈 [CHM-201535480] VNOR Report Creation 화면 기능 개선(Remark Submit)]]></desc>
			<sql><![CDATA[
MERGE INTO OPF_VNOR T
USING (
		SELECT 	@[vsl_cd] AS VSL_CD
				,@[vnor_seq] AS VNOR_SEQ
				,TO_DATE(@[vnor_offh_fm_dt], 'yyyy.mm.dd.hh24:mi') AS VNOR_OFFH_FM_DT
				,TO_DATE(@[vnor_offh_to_dt], 'yyyy.mm.dd.hh24:mi') AS VNOR_OFFH_TO_DT
				,@[cr_chk_flg] AS CR_CHK_FLG
				,SUBSTR(@[skd_voy_no], 1, 4) AS SKD_VOY_NO
				,SUBSTR(@[skd_voy_no], 5, 6) AS SKD_DIR_CD
				,@[vnor_stup_sts_cd] AS VNOR_STUP_STS_CD
				,@[vnor_offh_knd_cd] AS VNOR_OFFH_KND_CD
				,@[vnor_offh_tp_cd] AS VNOR_OFFH_TP_CD
				,@[vnor_vsl_sts_cd] AS VNOR_VSL_STS_CD
				,@[vnor_fm_port_cd] AS VNOR_FM_PORT_CD
				,@[vnor_to_port_cd] AS VNOR_TO_PORT_CD
				,@[cre_usr_id] AS CRE_USR_ID
				,SYSDATE AS CRE_DT
				,@[cre_usr_id] AS UPD_USR_ID
				,SYSDATE AS UPD_DT
				,@[vnor_rmk] AS VNOR_RMK
				,@[eml_snd_no] AS EML_SND_NO
		FROM DUAL
      ) I
   ON (
		T.VSL_CD = I.VSL_CD
		AND T.VNOR_SEQ = I.VNOR_SEQ
      )
WHEN MATCHED THEN
    UPDATE
       SET T.SKD_VOY_NO = I.SKD_VOY_NO
          ,T.SKD_DIR_CD = I.SKD_DIR_CD
          ,T.VNOR_STUP_STS_CD = I.VNOR_STUP_STS_CD
          ,T.VNOR_OFFH_KND_CD = I.VNOR_OFFH_KND_CD
          ,T.VNOR_OFFH_TP_CD = I.VNOR_OFFH_TP_CD
          ,T.VNOR_VSL_STS_CD = I.VNOR_VSL_STS_CD
          ,T.VNOR_FM_PORT_CD = I.VNOR_FM_PORT_CD
          ,T.VNOR_TO_PORT_CD = I.VNOR_TO_PORT_CD
          ,T.UPD_USR_ID = I.UPD_USR_ID
          ,T.UPD_DT = I.UPD_DT
          ,T.VNOR_RMK = I.VNOR_RMK
          ,T.EML_SND_NO = I.EML_SND_NO
WHEN NOT MATCHED THEN
    INSERT (
		T.VSL_CD
		,T.VNOR_SEQ
		,T.VNOR_OFFH_FM_DT
		,T.VNOR_OFFH_TO_DT
		,T.CR_CHK_FLG
		,T.SKD_VOY_NO
		,T.SKD_DIR_CD
		,T.VNOR_STUP_STS_CD
		,T.VNOR_OFFH_KND_CD
		,T.VNOR_OFFH_TP_CD
		,T.VNOR_VSL_STS_CD
		,T.VNOR_FM_PORT_CD
		,T.VNOR_TO_PORT_CD
		,T.CRE_USR_ID
		,T.CRE_DT
		,T.UPD_USR_ID
		,T.UPD_DT
		,T.VNOR_RMK
    ) VALUES (
		I.VSL_CD
		,I.VNOR_SEQ
		,I.VNOR_OFFH_FM_DT
		,I.VNOR_OFFH_TO_DT
		,I.CR_CHK_FLG
		,I.SKD_VOY_NO
		,I.SKD_DIR_CD
		,I.VNOR_STUP_STS_CD
		,I.VNOR_OFFH_KND_CD
		,I.VNOR_OFFH_TP_CD
		,I.VNOR_VSL_STS_CD
		,I.VNOR_FM_PORT_CD
		,I.VNOR_TO_PORT_CD
		,I.CRE_USR_ID
		,I.CRE_DT
		,I.UPD_USR_ID
		,I.UPD_DT
		,I.VNOR_RMK
    )			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="vnor_seq" type="12" value="" out="N"/>
				<param name="vnor_offh_fm_dt" type="12" value="" out="N"/>
				<param name="vnor_offh_to_dt" type="12" value="" out="N"/>
				<param name="cr_chk_flg" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="vnor_stup_sts_cd" type="12" value="" out="N"/>
				<param name="vnor_offh_knd_cd" type="12" value="" out="N"/>
				<param name="vnor_offh_tp_cd" type="12" value="" out="N"/>
				<param name="vnor_vsl_sts_cd" type="12" value="" out="N"/>
				<param name="vnor_fm_port_cd" type="12" value="" out="N"/>
				<param name="vnor_to_port_cd" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="vnor_rmk" type="2005" value="" out="N"/>
				<param name="eml_snd_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
