<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PortTariffMgtBCDBDAOSearchAccountAndCostByConditionRSQL">
			<desc><![CDATA[SearchAccountAndCostByCondition]]></desc>
			<sql><![CDATA[
SELECT A.ACCT_CD			ACCT_CD
,B.ACCT_ENG_NM 		ACCT_NM
,A.LGS_COST_CD		COST_CD
,A.LGS_COST_FULL_NM	COST_NM
FROM   TES_LGS_COST A
,MDM_ACCOUNT  B
,PSO_YD_CHG C
WHERE  1=1
AND    A.ACCT_CD = B.ACCT_CD
AND    A.LGS_COST_SUBJ_CD IN ('PT', 'CN')
AND    A.LGS_COST_CD_CLSS_LVL = 'A'
AND    C.LGS_COST_CD = A.LGS_COST_CD
#if( ${port_cd}!='')           
AND SUBSTR (C.YD_CD, 1, 5) = @[port_cd]
#end
#if( ${yd_cd}!='')
AND SUBSTR (C.YD_CD, 6) IN (#foreach( $key IN ${arr_yd_cd}) 
                                 #if($velocityCount < $arr_yd_cd.size())
                                      '$key',
                                 #else
                                      '$key'
                                 #end
                              #end)
#end
#if( ${year} != '' )
AND C.EFF_DT <= TO_DATE(@[year]||'1231', 'YYYYMMDD')
AND C.EXP_DT >= TO_DATE(@[year]||'0101', 'YYYYMMDD')
#end
GROUP BY A.ACCT_CD, A.LGS_COST_CD, ACCT_ENG_NM, A.LGS_COST_CD, A.LGS_COST_FULL_NM
ORDER BY A.ACCT_CD, A.LGS_COST_CD			]]></sql>
			<params>
				<param name="port_cd" type="12" value="" out="N"/>
				<param name="year" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
