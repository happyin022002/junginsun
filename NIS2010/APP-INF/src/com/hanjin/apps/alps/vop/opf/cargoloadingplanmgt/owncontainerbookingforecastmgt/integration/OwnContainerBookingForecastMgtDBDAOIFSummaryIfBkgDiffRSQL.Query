<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="OwnContainerBookingForecastMgtDBDAOIFSummaryIfBkgDiffRSQL">
			<desc><![CDATA[korea cll과 booking interface시 서로 차이가 있는 cntr no list]]></desc>
			<sql><![CDATA[
SELECT  DECODE(NVL(LENGTH(WM_CONCAT(CNTR_NO)),0),0,'N','Y') AS CNTR_FLAG
 FROM ( SELECT CNTR_NO 
    FROM ( ( SELECT DISTINCT CNTR_NO  
            FROM BKG_CSTMS_TML_KR_CLL
           WHERE VSL_CD            = @[vsl_cd]
             AND SKD_VOY_NO        = @[skd_voy_no]
             AND SKD_DIR_CD        = @[skd_dir_cd]
             AND POL_CD||POL_YD_CD = SUBSTR(@[yd_cd],1,7)
           MINUS
           SELECT DISTINCT BCT.CNTR_NO
             FROM BKG_VVD       VVD, 
                  BKG_BOOKING   BKG,
                  BKG_CONTAINER BCT
            WHERE VVD.VSL_CD                          = @[vsl_cd]
              AND VVD.SKD_VOY_NO                      = @[skd_voy_no]
              AND VVD.SKD_DIR_CD                      = @[skd_dir_cd]
              AND VVD.POL_YD_CD||VVD.POL_CLPT_IND_SEQ = @[yd_cd]    
              AND VVD.BKG_NO                          = BKG.BKG_NO
              AND BKG.BKG_STS_CD                      <> 'X'
              AND BKG.BKG_NO                          = BCT.BKG_NO )
          UNION 
         (  SELECT DISTINCT BCT.CNTR_NO
              FROM BKG_VVD       VVD, 
                   BKG_BOOKING   BKG,
                   BKG_CONTAINER BCT
             WHERE VVD.VSL_CD                          = @[vsl_cd]
               AND VVD.SKD_VOY_NO                      = @[skd_voy_no]
               AND VVD.SKD_DIR_CD                      = @[skd_dir_cd]
               AND VVD.POL_YD_CD||VVD.POL_CLPT_IND_SEQ = @[yd_cd]       
               AND VVD.BKG_NO                          = BKG.BKG_NO
               AND BKG.BKG_STS_CD                      <> 'X'
               AND BKG.BKG_NO                          = BCT.BKG_NO
           MINUS
           SELECT DISTINCT CNTR_NO  
             FROM BKG_CSTMS_TML_KR_CLL
            WHERE VSL_CD            = @[vsl_cd]
              AND SKD_VOY_NO        = @[skd_voy_no]
              AND SKD_DIR_CD        = @[skd_dir_cd]
              AND POL_CD||POL_YD_CD = SUBSTR(@[yd_cd],1,7) ) )
      WHERE ROWNUM = 1 )			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="yd_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
