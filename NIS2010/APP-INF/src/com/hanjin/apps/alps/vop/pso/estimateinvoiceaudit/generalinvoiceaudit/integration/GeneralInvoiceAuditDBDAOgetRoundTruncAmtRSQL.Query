<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralInvoiceAuditDBDAOgetRoundTruncAmtRSQL">
			<desc><![CDATA[IN/OUT 에 따라서 AMOUNT를 반으로 나누어 준다.

*History
2011.01.18 진마리아 [CHM-201007407-01] Turning indicator로 인한 Invocie amount 생성 로직 변경 요청건]]></desc>
			<sql><![CDATA[
SELECT  ROUND( @[locl_amt]*@[ratio]/100 ) locl_amt, ROUND( @[calc_amt]*@[ratio]/100 ) calc_amt, ROUND( @[adj_amt]*@[ratio]/100 ) adj_amt
FROM    DUAL
WHERE  @[io_bnd_cd] = 'O'
--CHM-201007407-01 진마리아 'KRW', 'JPY', 'TWD' 에서 'CLP' 를 포함하기 위해, 소수점 자리수가 0인 모든 CURRENCY로 수정하였음
AND @[curr_cd] IN (SELECT CURR_CD 
				  FROM MDM_CURRENCY 
				  WHERE DP_PRCS_KNT = 0 
				  AND DELT_FLG = 'N')
--AND [curr_cd] in ('KRW','JPY','TWD')

union all
SELECT  ROUND( @[locl_amt]*@[ratio]/100, 2 ), ROUND( @[calc_amt]*@[ratio]/100, 2 ) , ROUND( @[adj_amt]*@[ratio]/100, 2 )
FROM    DUAL
WHERE  @[io_bnd_cd] = 'O'
--CHM-201007407-01
AND @[curr_cd] NOT IN (SELECT CURR_CD 
				  FROM MDM_CURRENCY 
				  WHERE DP_PRCS_KNT = 0 
				  AND DELT_FLG = 'N')
--AND [curr_cd] not in ('KRW','JPY','TWD')
union all
/*In-Bound 인 경우 ; 내림*/
SELECT  TRUNC( @[locl_amt]*@[ratio]/100 ), TRUNC( @[calc_amt]*@[ratio]/100 ) , TRUNC( @[adj_amt]*@[ratio]/100 )
FROM    DUAL
where @[io_bnd_cd] = 'I'
--CHM-201007407-01
AND @[curr_cd] IN (SELECT CURR_CD 
				  FROM MDM_CURRENCY 
				  WHERE DP_PRCS_KNT = 0 
				  AND DELT_FLG = 'N')
--AND [curr_cd] in ('KRW','JPY','TWD')
union all
SELECT  TRUNC( @[locl_amt]*@[ratio]/100, 2 ), TRUNC( @[calc_amt]*@[ratio]/100, 2 ) , TRUNC( @[adj_amt]*@[ratio]/100, 2 )
FROM    DUAL
where @[io_bnd_cd] = 'I'
--CHM-201007407-01
AND @[curr_cd] NOT IN (SELECT CURR_CD 
				  FROM MDM_CURRENCY 
				  WHERE DP_PRCS_KNT = 0 
				  AND DELT_FLG = 'N')
--AND [curr_cd] not in ('KRW','JPY','TWD')			]]></sql>
			<params>
				<param name="locl_amt" type="12" value="" out="N"/>
				<param name="ratio" type="12" value="" out="N"/>
				<param name="calc_amt" type="12" value="" out="N"/>
				<param name="adj_amt" type="12" value="" out="N"/>
				<param name="io_bnd_cd" type="12" value="" out="N"/>
				<param name="curr_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
