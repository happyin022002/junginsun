<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TerminalDepartureReportDBDAOLoadVolInterPortTdrVORSQL">
			<desc><![CDATA[TDR Creation - Load Vol. Tab. - Inter Port Query]]></desc>
			<sql><![CDATA[
SELECT  XX.OPR_CD
  , XX.POD_CD
  , DECODE(NVL(XX.FULL_BO_20,0) + NVL(XX.FULL_TS_20,0), 0, NULL, NVL(XX.FULL_BO_20,0) + NVL(XX.FULL_TS_20,0))  AS FULL_BO_20
  , DECODE(NVL(XX.FULL_BO_2H,0) + NVL(XX.FULL_TS_2H,0), 0, NULL, NVL(XX.FULL_BO_2H,0) + NVL(XX.FULL_TS_2H,0))  AS FULL_BO_2H
  , DECODE(NVL(XX.FULL_BO_40,0) + NVL(XX.FULL_TS_40,0), 0, NULL, NVL(XX.FULL_BO_40,0) + NVL(XX.FULL_TS_40,0))  AS FULL_BO_40
  , DECODE(NVL(XX.FULL_BO_4H,0) + NVL(XX.FULL_TS_4H,0), 0, NULL, NVL(XX.FULL_BO_4H,0) + NVL(XX.FULL_TS_4H,0))  AS FULL_BO_4H
  , DECODE(NVL(XX.FULL_BO_45,0) + NVL(XX.FULL_TS_45,0), 0, NULL, NVL(XX.FULL_BO_45,0) + NVL(XX.FULL_TS_45,0))  AS FULL_BO_45
  , DECODE(NVL(XX.FULL_BO_DX,0) + NVL(XX.FULL_TS_DX,0), 0, NULL, NVL(XX.FULL_BO_DX,0) + NVL(XX.FULL_TS_DX,0))  AS FULL_BO_DX
  --, XX.FULL_TS_20
  --, XX.FULL_TS_2H
  --, XX.FULL_TS_40
  --, XX.FULL_TS_4H
  --, XX.FULL_TS_45
  , DECODE(NVL(XX.ET_BO_20,0) + NVL(XX.ET_TS_20,0), 0, NULL, NVL(XX.ET_BO_20,0) + NVL(XX.ET_TS_20,0)) AS ET_BO_20
  , DECODE(NVL(XX.ET_BO_2H,0) + NVL(XX.ET_TS_2H,0), 0, NULL, NVL(XX.ET_BO_2H,0) + NVL(XX.ET_TS_2H,0)) AS ET_BO_2H
  , DECODE(NVL(XX.ET_BO_40,0) + NVL(XX.ET_TS_40,0), 0, NULL, NVL(XX.ET_BO_40,0) + NVL(XX.ET_TS_40,0)) AS ET_BO_40
  , DECODE(NVL(XX.ET_BO_4H,0) + NVL(XX.ET_TS_4H,0), 0, NULL, NVL(XX.ET_BO_4H,0) + NVL(XX.ET_TS_4H,0)) AS ET_BO_4H
  , DECODE(NVL(XX.ET_BO_45,0) + NVL(XX.ET_TS_45,0), 0, NULL, NVL(XX.ET_BO_45,0) + NVL(XX.ET_TS_45,0)) AS ET_BO_45
  , DECODE(NVL(XX.ET_BO_DX,0) + NVL(XX.ET_TS_DX,0), 0, NULL, NVL(XX.ET_BO_DX,0) + NVL(XX.ET_TS_DX,0)) AS ET_BO_DX
  --, XX.ET_TS_20
  --, XX.ET_TS_2H
  --, XX.ET_TS_40
  --, XX.ET_TS_4H
  --, XX.ET_TS_45
  , XX.WT_20
  , XX.WT_2H
  , XX.WT_40
  , XX.WT_4H
  , XX.WT_45
  , XX.WT_DX

FROM  (

SELECT OPR_CD,
       POD_ISO AS POD_CD,
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, '2', DECODE(CNTR_TYPE, 'F', DECODE(QTY, 0, NULL, QTY), 'R', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))      				FULL_BO_20, 
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, '3', DECODE(CNTR_TYPE, 'F', DECODE(QTY, 0, NULL, QTY), 'R', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))      				FULL_BO_2H, 
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, '4', DECODE(CNTR_TYPE, 'F', DECODE(QTY, 0, NULL, QTY), 'R', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))      				FULL_BO_40, 
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, 'H', DECODE(CNTR_TYPE, 'F', DECODE(QTY, 0, NULL, QTY), 'R', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))      				FULL_BO_4H, 
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, 'L', DECODE(CNTR_TYPE, 'F', DECODE(QTY, 0, NULL, QTY), 'R', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))      				FULL_BO_45, 
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, 'X', DECODE(CNTR_TYPE, 'F', DECODE(QTY, 0, NULL, QTY), 'R', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))      				FULL_BO_DX,
       SUM(DECODE(STATUS, @[status2], DECODE(CNTR_SIZE, '2', DECODE(CNTR_TYPE, 'F', DECODE(QTY, 0, NULL, QTY), 'R', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))      				FULL_TS_20,  
       SUM(DECODE(STATUS, @[status2], DECODE(CNTR_SIZE, '3', DECODE(CNTR_TYPE, 'F', DECODE(QTY, 0, NULL, QTY), 'R', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))      				FULL_TS_2H,  
       SUM(DECODE(STATUS, @[status2], DECODE(CNTR_SIZE, '4', DECODE(CNTR_TYPE, 'F', DECODE(QTY, 0, NULL, QTY), 'R', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))      				FULL_TS_40,  
       SUM(DECODE(STATUS, @[status2], DECODE(CNTR_SIZE, 'H', DECODE(CNTR_TYPE, 'F', DECODE(QTY, 0, NULL, QTY), 'R', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))      				FULL_TS_4H,  
       SUM(DECODE(STATUS, @[status2], DECODE(CNTR_SIZE, 'L', DECODE(CNTR_TYPE, 'F', DECODE(QTY, 0, NULL, QTY), 'R', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))      				FULL_TS_45,  
       SUM(DECODE(STATUS, @[status2], DECODE(CNTR_SIZE, 'X', DECODE(CNTR_TYPE, 'F', DECODE(QTY, 0, NULL, QTY), 'R', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))      				FULL_TS_DX,
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, '2', DECODE(CNTR_TYPE, 'E', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))                										ET_BO_20,   
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, '3', DECODE(CNTR_TYPE, 'E', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))                										ET_BO_2H,   
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, '4', DECODE(CNTR_TYPE, 'E', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))                										ET_BO_40,   
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, 'H', DECODE(CNTR_TYPE, 'E', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))                										ET_BO_4H,   
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, 'L', DECODE(CNTR_TYPE, 'E', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))                										ET_BO_45,   
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, 'X', DECODE(CNTR_TYPE, 'E', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))                										ET_BO_DX,
       SUM(DECODE(STATUS, @[status2], DECODE(CNTR_SIZE, '2', DECODE(CNTR_TYPE, 'E', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))                										ET_TS_20,    
       SUM(DECODE(STATUS, @[status2], DECODE(CNTR_SIZE, '3', DECODE(CNTR_TYPE, 'E', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))                										ET_TS_2H,    
       SUM(DECODE(STATUS, @[status2], DECODE(CNTR_SIZE, '4', DECODE(CNTR_TYPE, 'E', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))                										ET_TS_40,    
       SUM(DECODE(STATUS, @[status2], DECODE(CNTR_SIZE, 'H', DECODE(CNTR_TYPE, 'E', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))                										ET_TS_4H,    
       SUM(DECODE(STATUS, @[status2], DECODE(CNTR_SIZE, 'L', DECODE(CNTR_TYPE, 'E', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))                										ET_TS_45,    
       SUM(DECODE(STATUS, @[status2], DECODE(CNTR_SIZE, 'X', DECODE(CNTR_TYPE, 'E', DECODE(QTY, 0, NULL, QTY), NULL), NULL), NULL))                										ET_TS_DX, 
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, '2', DECODE(WEIGHT, 0, NULL, WEIGHT), NULL), @[status2], DECODE(CNTR_SIZE, '2', DECODE(WEIGHT, 0, NULL, WEIGHT), NULL), NULL)) 	WT_20,       
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, '3', DECODE(WEIGHT, 0, NULL, WEIGHT), NULL), @[status2], DECODE(CNTR_SIZE, '3', DECODE(WEIGHT, 0, NULL, WEIGHT), NULL), NULL)) 	WT_2H,       
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, '4', DECODE(WEIGHT, 0, NULL, WEIGHT), NULL), @[status2], DECODE(CNTR_SIZE, '4', DECODE(WEIGHT, 0, NULL, WEIGHT), NULL), NULL)) 	WT_40,       
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, 'H', DECODE(WEIGHT, 0, NULL, WEIGHT), NULL), @[status2], DECODE(CNTR_SIZE, 'H', DECODE(WEIGHT, 0, NULL, WEIGHT), NULL), NULL)) 	WT_4H,       
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, 'L', DECODE(WEIGHT, 0, NULL, WEIGHT), NULL), @[status2], DECODE(CNTR_SIZE, 'L', DECODE(WEIGHT, 0, NULL, WEIGHT), NULL), NULL)) 	WT_45,       
       SUM(DECODE(STATUS, @[status1], DECODE(CNTR_SIZE, 'X', DECODE(WEIGHT, 0, NULL, WEIGHT), NULL), @[status2], DECODE(CNTR_SIZE, 'L', DECODE(WEIGHT, 0, NULL, WEIGHT), NULL), NULL)) 	WT_DX 
FROM   VSK_VSL_PORT_SKD V, TDR_HEADER H, TDR_SUMMARY S 
WHERE  V.VSL_CD  		= @[vsl_cd] 
AND    V.SKD_VOY_NO  	= @[voy_no] 
AND    V.SKD_DIR_CD  	= @[dir_cd] 
AND    V.YD_CD 			= @[yd_cd] 
AND    V.CLPT_IND_SEQ   = @[clpt_ind_seq]
AND    S.STATUS IN (@[status1], @[status2])
#if (${sys_create} != 'Externally Produced')
AND    S.CNTR_TYPE NOT IN ('D', 'R', 'A')
#end
AND    V.VSL_CD       	= H.VSL_CD 
AND    V.SKD_VOY_NO   	= H.VOY_NO 
AND    V.SKD_DIR_CD   	= H.DIR_CD 
AND    V.VPS_PORT_CD  	= H.PORT_CD 
AND    V.CLPT_IND_SEQ 	= H.CALL_IND 
AND    H.VSL_CD       	= S.VSL_CD 
AND    H.VOY_NO       	= S.VOY_NO 
AND    H.DIR_CD       	= S.DIR_CD 
AND    H.PORT_CD      	= S.PORT_CD 
AND    H.CALL_IND     	= S.CALL_IND 
GROUP BY OPR_CD,  POD_ISO
ORDER BY OPR_CD,  POD_ISO ) XX			]]></sql>
			<params>
				<param name="status1" type="12" value="" out="N"/>
				<param name="status2" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="voy_no" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="yd_cd" type="12" value="" out="N"/>
				<param name="clpt_ind_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
