<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="StevedoreDamageMgtDBDAOSdmsDamageClaimSendMailContentRSQL">
			<desc><![CDATA[mail을 보내기 위한 Stevedore Damage 정보를 조회 합니다.
-------------------------------------------------------------------------------------------
2011.10.21 김민아 [CHM-201113609-01] SDMS 신속 처리를 위한 Auto mailing 기능 추가
2011.11.08 김민아 [CHM-201114487-01] SDMS내 과거 SDR 입력 불가 관련 기능 개선 요청]]></desc>
			<sql><![CDATA[
SELECT   (SELECT   MAX(PS.VSL_SLAN_CD)
           FROM     VSK_VSL_SKD  PS
           WHERE    PS.VSL_CD         = H.VSL_CD
           AND      PS.SKD_VOY_NO     = H.SKD_VOY_NO
           AND      PS.SKD_DIR_CD     = H.SKD_DIR_CD
--           AND      PS.VPS_PORT_CD    = H.VPS_PORT_CD
           )                                       AS SLAN_CD
      ,   H.VSL_CD||H.SKD_VOY_NO||H.SKD_DIR_CD     AS VVD
      ,   H.VPS_PORT_CD   
      ,   H.STV_DMG_NO                              
      ,   H.CLM_HNDL_OFC_CD
      ,   TO_CHAR(H.STV_DMG_EVNT_DT, 'YYYY/MM/DD') AS STV_DMG_EVNT_DT
            
          /*  CD01890              
              BEN  : Bent  
              BRO  : Broken 
              CRA  : Crack 
              DEN  : Dent 
              HOL  : Hole 
              HULL : Hull 
              MIS  : Missing  
              SPILL : Spill  
              FOL  : Fold   
              PLL  : Pollution 
          */
      ,   CASE D.STV_DMG_TP_CD  WHEN 'BEN'  THEN 'Bent'  
                                WHEN 'BRO'  THEN 'Broken' 
                                WHEN 'CRA'  THEN 'Crack' 
                                WHEN 'DEN'  THEN 'Dent' 
                                WHEN 'HOL'  THEN 'Hole' 
                                WHEN 'HULL' THEN 'Hull' 
                                WHEN 'MIS'  THEN 'Missing'  
                                WHEN 'SPILL' THEN 'Spill'  
                                WHEN 'FOL'  THEN 'Fold'   
                                WHEN 'PLL'  THEN 'Pollution'  
                                ELSE ''
           END                  STV_DMG_TP_CD     
      
          /*  CD02809
              T : Terminal 
              S : Stevedore Company 
              U : Unknown 
          */
      ,   CASE D.STV_DMG_RESPB_PTY_KWN_CD WHEN 'T' THEN 'Terminal'       
                                          WHEN 'S' THEN 'Stevedore Company'
                                          WHEN 'U' THEN 'Unknown'
                                          ELSE ''
          END                             STV_DMG_RESPB_PTY_KWN_CD   
          
      ,   'Pls refer to SDMS in ALPS'     AS DTL_INFO
      ,   (SELECT TO_CHAR(SYSDATE, 'YYYY.MM.DD') FROM DUAL) AS TODAY
FROM      OPF_STV_DMG       H
      ,   OPF_STV_DMG_DTL   D
WHERE     H.STV_DMG_NO      = D.STV_DMG_NO
AND       H.STV_DMG_NO      = @[stv_dmg_no]			]]></sql>
			<params>
				<param name="stv_dmg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
