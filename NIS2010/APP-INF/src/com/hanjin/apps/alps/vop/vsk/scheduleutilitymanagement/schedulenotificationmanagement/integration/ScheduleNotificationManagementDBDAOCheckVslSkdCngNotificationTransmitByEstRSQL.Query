<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ScheduleNotificationManagementDBDAOCheckVslSkdCngNotificationTransmitByEstRSQL">
			<desc><![CDATA[Vessel Schedule ETA/ETB/ETD 변경에 따른 전송이력내역중 동일이력체크]]></desc>
			<sql><![CDATA[
SELECT    COUNT(1)                   EXIST_KNT
FROM      VSK_VSL_SKD_NTFC_TRSM_LOG  X
WHERE     1 = 1
AND       X.NTFC_TRSM_TP_CD          = 'ET'
AND       X.VSL_CD                   = @[vsl_cd]      
AND       X.SKD_VOY_NO               = @[skd_voy_no]  
AND       X.SKD_DIR_CD               = @[skd_dir_cd]  
AND       X.VPS_PORT_CD              = @[vps_port_cd] 
AND       X.CLPT_IND_SEQ             = @[clpt_ind_seq]
AND       X.USR_ID                   = @[usr_id]      
AND       X.VPS_ETA_DT               = TO_DATE(@[vps_eta_dt], 'YYYY-MM-DD HH24:MI')  
AND       X.VPS_ETB_DT               = TO_DATE(@[vps_etb_dt], 'YYYY-MM-DD HH24:MI')  
AND       X.VPS_ETD_DT               = TO_DATE(@[vps_etd_dt], 'YYYY-MM-DD HH24:MI')  
AND       X.NTFC_TRSM_HIS_SEQ        = (SELECT    MAX(XX.NTFC_TRSM_HIS_SEQ)
                                        FROM      VSK_VSL_SKD_NTFC_TRSM_LOG XX
                                        WHERE     1 = 1
                                        AND       XX.VSL_CD                 = X.VSL_CD
                                        AND       XX.SKD_VOY_NO             = X.SKD_VOY_NO
                                        AND       XX.SKD_DIR_CD             = X.SKD_DIR_CD
                                        AND       XX.VPS_PORT_CD            = X.VPS_PORT_CD
                                        AND       XX.CLPT_IND_SEQ           = X.CLPT_IND_SEQ
                                        AND       XX.USR_ID                 = X.USR_ID
                                        AND       XX.NTFC_TRSM_TP_CD        = X.NTFC_TRSM_TP_CD
                                        )			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="vps_port_cd" type="12" value="" out="N"/>
				<param name="clpt_ind_seq" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="vps_eta_dt" type="12" value="" out="N"/>
				<param name="vps_etb_dt" type="12" value="" out="N"/>
				<param name="vps_etd_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
