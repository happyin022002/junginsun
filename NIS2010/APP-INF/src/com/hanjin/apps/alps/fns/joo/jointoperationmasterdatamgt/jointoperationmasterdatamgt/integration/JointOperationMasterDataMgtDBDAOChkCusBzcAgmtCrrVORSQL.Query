<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JointOperationMasterDataMgtDBDAOChkCusBzcAgmtCrrVORSQL">
			<desc><![CDATA[Add Carriers 중복조회
2012.06.01 : 김상근[CHM-201218057-01]
Discription : Table의 Key변경 RLANE_CD, JO_REP_CRR_CD, JO_CRR_CD -> JO_REF_NO, JO_CRR_CD]]></desc>
			<sql><![CDATA[
SELECT JO_REF_NO,
        MAX(DECODE(RN#, 1, JO_CRR_CD )) JO_CRR_CD1,
        MAX(DECODE(RN#, 2, JO_CRR_CD )) JO_CRR_CD2,
        MAX(DECODE(RN#, 3, JO_CRR_CD )) JO_CRR_CD3,
        MAX(DECODE(RN#, 4, JO_CRR_CD )) JO_CRR_CD4,
        MAX(DECODE(RN#, 5, JO_CRR_CD )) JO_CRR_CD5,
        MAX(DECODE(RN#, 6, JO_CRR_CD )) JO_CRR_CD6,
        MAX(DECODE(RN#, 7, JO_CRR_CD )) JO_CRR_CD7,
        MAX(DECODE(RN#, 8, JO_CRR_CD )) JO_CRR_CD8,
        MAX(DECODE(RN#, 9, JO_CRR_CD )) JO_CRR_CD9,
        MAX(DECODE(RN#, 10, JO_CRR_CD )) JO_CRR_CD10
    FROM ( 
    SELECT JO_REF_NO, JO_CRR_CD,
    ROW_NUMBER() OVER( PARTITION BY JO_REF_NO ORDER BY JO_CRR_CD ) RN#
    FROM JOO_BZC_AGMT_CRR 
    WHERE 1=1
    #if (${jo_ref_no} != '')
    AND JO_REF_NO = @[jo_ref_no]
    #end
    #if (${jo_crr_cd} != '')
    AND JO_CRR_CD = @[jo_crr_cd]
    #end
	)
    GROUP BY JO_REF_NO			]]></sql>
			<params>
				<param name="jo_ref_no" type="12" value="" out="N"/>
				<param name="jo_crr_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
