<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ARInvoiceInquiryDBDAOFaxEmailSentResultVORSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
#if (${svr_id} != 'KOR')

SELECT T00.ISS_OFC_CD, 
       T00.CRE_USR_ID, 
       T00.SENT_BY, 
       T00.INV_NO, 
	   T00.AUTO_INV_ISS_FLG,
       T00.INV_SEQ, 
	   --T00.CURR_CD,
	   --T00.CHG_AMT,
       T00.BL_SRC_NO, 
       T00.CUST_CODE, 
       T00.RECEIVED_NO,  
       T00.TIME_REQUESTED, 
       T00.RESULT,  
       T00.TIME_SENT, 
       T00.VVD, 
       T00.IO_BND_CD, 
       T00.PORT
FROM (
		SELECT DISTINCT
		       T05.ISS_OFC_CD AS ISS_OFC_CD
		     , T05.CRE_USR_ID AS CRE_USR_ID
		     , CASE WHEN T01.INV_ISS_SND_TP_CD = 'E' THEN 'e-mail'
		            WHEN T01.INV_ISS_SND_TP_CD = 'F' THEN 'FAX'
		            WHEN T01.INV_ISS_SND_TP_CD = 'P' THEN 'Paper'
		            WHEN T01.INV_ISS_SND_TP_CD_CHK IS NOT NULL THEN ''
					ELSE 'Unperformed'
		       END AS SENT_BY
		    , T01.INV_NO
		    , T01.INV_SEQ
 			, T01.AUTO_INV_ISS_FLG
			--, T01.CURR_CD
			--, T01.CHG_AMT
		    , T02.BL_SRC_NO
		    , T02.ACT_CUST_CNT_CD||'-'||TO_CHAR(T02.ACT_CUST_SEQ, 'FM000000')  AS CUST_CODE
		    , T01.INV_SND_CUST_NO RECEIVED_NO
		    , T01.INV_SND_DT TIME_REQUESTED
		    , CASE WHEN T01.INV_ISS_SND_TP_CD = 'E' THEN
		                CASE WHEN (SELECT S.AR_HD_QTR_OFC_CD FROM MDM_ORGANIZATION S WHERE T05.ISS_OFC_CD = S.OFC_CD) = 'HAMRU' THEN
		                    -- Email 일 경우 Issue Office가 구주지역일 경우 구주 인증 메일 서버에서 최종 전송할 결과를 표시한다.
		                    DECODE(NVL(T01.EUR_EML_SND_RSLT_CD, 'N'), 'S', 'RECEIVED', 'F', 'FAIL', 'N', DECODE(NVL(T03.EML_PROC_STS_CD, 'N'), '1', 'SENDING', '3', 'SENT', 'FAIL'))
		                ELSE
		                    -- 기타 지역에 Email 전송은 ALPS 메일 서버에서 전송할 결과를 표시한다.
		                    DECODE(NVL(T03.EML_PROC_STS_CD, 'N'), '1', 'SENDING', '3', 'SUCCESS',                 'FAIL')
				
		                END
		           WHEN T01.INV_ISS_SND_TP_CD = 'F' THEN DECODE(NVL(T04.FAX_PROC_STS_CD, 'N'), '1', 'SENDING', '3', 'SENDING', '5', 'SUCCESS', 'FAIL')
		           WHEN T01.INV_ISS_SND_TP_CD = 'P' THEN 'SUCCESS'
		      END                                                   AS RESULT
		    , CASE WHEN T01.INV_ISS_SND_TP_CD = 'E' THEN (SELECT GLOBALDATE_PKG.TIME_CONV_OFC_FNC('SELHO', T03.EML_DT, T05.ISS_OFC_CD) FROM DUAL)
		           WHEN T01.INV_ISS_SND_TP_CD = 'F' THEN (SELECT GLOBALDATE_PKG.TIME_CONV_OFC_FNC('SELHO', T04.FAX_DT, T05.ISS_OFC_CD) FROM DUAL)
		           WHEN T01.INV_ISS_SND_TP_CD = 'P' THEN (SELECT GLOBALDATE_PKG.TIME_CONV_OFC_FNC('SELHO', T05.CRE_DT, T05.ISS_OFC_CD) FROM DUAL)
		      END                                                    AS TIME_SENT
		    , T02.VSL_CD||T02.SKD_VOY_NO||T02.SKD_DIR_CD             AS VVD
		    , DECODE(T02.IO_BND_CD,'I','I/B', 'O/B')                 AS IO_BND_CD
		    , DECODE(T02.IO_BND_CD,'I', T02.POD_CD, 'O', T02.POL_CD) AS PORT
		FROM    (
		        SELECT  T3.INV_NO 
						,T3.INV_SEQ
						, CASE WHEN   NVL(T3.AUTO_INV_ISS_FLG,'N') ='Y' THEN 'A'  ELSE 'M'  END  AUTO_INV_ISS_FLG
						--, T4.CURR_CD
						--, SUM(T4.CHG_AMT) AS CHG_AMT
		                , T1.INV_ISS_SND_TP_CD
		                , (SELECT MAX(INV_ISS_SND_TP_CD)  FROM INV_AR_ISS_SND WHERE INV_NO = T3.INV_NO) INV_ISS_SND_TP_CD_CHK
		                , T1.INV_SND_CUST_NO
		                , T1.INV_SND_DT
		                , T1.INV_SND_NO
		                , T2.AR_IF_NO
		                , T1.EUR_EML_SND_RSLT_CD
		                , T1.SND_DT
		        FROM    INV_AR_ISS T3, INV_AR_ISS_SND T1, INV_AR_ISS_DTL T2,INV_AR_CHG T4
		        WHERE   1=1
		        AND     T1.INV_NO(+)   = T3.INV_NO
		        AND     T1.INV_SEQ(+)   = T3.INV_SEQ
		        AND     T3.INV_NO       = T2.INV_NO
				AND     T2.AR_IF_NO     = T4.AR_IF_NO 
				AND     T2.CHG_SEQ      = T4.CHG_SEQ  
		        #if (${from_dt} != '' && ${to_dt} != '' && ${date_type} == 'S')
		        AND     T1.INV_SND_DT BETWEEN REPLACE(TO_DATE(@[from_dt],'YYYYMMDD'), '-', '') AND REPLACE(TO_DATE(@[to_dt],'YYYYMMDD'), '-', '')
		        #end
 				#if (${from_dt} != '' && ${to_dt} != ''  && ${date_type} == 'C')
		        AND     T3.ISS_DT BETWEEN REPLACE(@[from_dt], '-', '') AND REPLACE(@[to_dt], '-', '')
		        #end
		        #if (${sent_by} != '')
		        AND     T1.INV_ISS_SND_TP_CD IN (@[sent_by])
		        #end
		        GROUP BY T3.INV_NO
						, T3.INV_SEQ
						, T3.AUTO_INV_ISS_FLG
						--, T4.CURR_CD
		                , T1.INV_ISS_SND_TP_CD
		                , T1.INV_SND_CUST_NO
		                , T1.INV_SND_NO
		                , T1.INV_SND_DT
		                , T2.AR_IF_NO
		                , T1.EUR_EML_SND_RSLT_CD
		                , T1.SND_DT
		        ) T01, INV_AR_MN T02, COM_EML_SND_INFO T03, COM_FAX_SND_INFO T04, INV_AR_ISS T05
		WHERE   1=1
		AND     T01.AR_IF_NO    = T02.AR_IF_NO
		AND     T01.INV_SND_NO  = T03.EML_SND_NO (+)
		AND     T01.INV_SND_NO  = T04.FAX_SND_NO (+)
		AND     T01.INV_NO      = T05.INV_NO
		AND     T01.INV_SEQ     = T05.INV_SEQ
		#if  (${ofc_cd} == '')
		AND     T02.AR_OFC_CD IN (
		                    SELECT AR_OFC_CD
		                    FROM   MDM_ORGANIZATION
		                    WHERE  OFC_CD           = AR_OFC_CD
		                    AND    AR_HD_QTR_OFC_CD = (
		                                              SELECT AR_HD_QTR_OFC_CD
		                                              FROM   MDM_ORGANIZATION
		                                              WHERE  OFC_CD = @[user_ofc_cd]
		                                              )  
 		                   )
		#else
		AND     T02.AR_OFC_CD  = @[ofc_cd]
		#end 

		AND		(T02.INV_SRC_NO IS NULL   OR NVL(T02.INV_SRC_NO,'N') != T05.INV_NO)
      
		#if (${act_cust_cnt_cd} != '')
		AND     T02.ACT_CUST_CNT_CD = @[act_cust_cnt_cd]
		#end

		#if (${act_cust_seq} != '')
		AND     T02.ACT_CUST_SEQ    = @[act_cust_seq]
		#end

		#if (${vsl_cd} != '')
		AND     T02.VSL_CD          = @[vsl_cd]
		#end

		#if (${skd_voy_no} != '')
		AND     T02.SKD_VOY_NO      = @[skd_voy_no]
		#end

		#if (${skd_dir_cd} != '')
		AND     T02.SKD_DIR_CD      = @[skd_dir_cd]
		#end

		#if (${bl_src_no} != '')		
		AND     T02.BL_SRC_NO       = @[bl_src_no]
		#end

		#if (${svc_scp_cd} != '')
		AND     T02.SVC_SCP_CD      = @[svc_scp_cd]
		#end

		#if (${io_bnd_cd} != '')
		AND     T02.IO_BND_CD       = @[io_bnd_cd]
		#end

		#if (${port} != '')
		AND    ((T02.IO_BND_CD      = 'I' AND T02.POD_CD = @[port]) OR (T02.IO_BND_CD = 'O' AND T02.POL_CD = @[port])) 
		#end

		#if (${inv_no} != '')
		AND     T05.INV_NO = @[inv_no]
		#end

		#if (${iss_ofc_cd} != '')
		AND     T05.ISS_OFC_CD  = @[iss_ofc_cd]
		#end

		#if (${cre_usr_id} != '')
		AND     T05.CRE_USR_ID  = @[cre_usr_id]
		#end



--ORDER BY T05.ISS_OFC_CD, T05.CRE_USR_ID, T01.INV_NO, T01.INV_SEQ, T02.BL_SRC_NO, CUST_CODE


		UNION ALL

		SELECT DISTINCT
		       T05.ISS_OFC_CD AS ISS_OFC_CD
		     , T05.CRE_USR_ID AS CRE_USR_ID
		     , CASE WHEN T01.INV_ISS_SND_TP_CD = 'E' THEN 'e-mail'
		            WHEN T01.INV_ISS_SND_TP_CD = 'F' THEN 'FAX'
		            WHEN T01.INV_ISS_SND_TP_CD = 'P' THEN 'Paper'
		            WHEN T01.INV_ISS_SND_TP_CD_CHK IS NOT NULL THEN ''
					ELSE 'Unperformed'
		       END AS SENT_BY
		    , T01.INV_NO
		    , T01.INV_SEQ
			, 'N' AUTO_INV_ISS_FLG
			--, T01.CURR_CD
			--, T01.CHG_AMT
		    , T02.BL_SRC_NO
		    , T02.ACT_CUST_CNT_CD||'-'||TO_CHAR(T02.ACT_CUST_SEQ, 'FM000000')  AS CUST_CODE
		    , T01.INV_SND_CUST_NO RECEIVED_NO
		    , T01.INV_SND_DT TIME_REQUESTED
		    , CASE WHEN T01.INV_ISS_SND_TP_CD = 'E' THEN
		                CASE WHEN (SELECT S.AR_HD_QTR_OFC_CD FROM MDM_ORGANIZATION S WHERE T05.ISS_OFC_CD = S.OFC_CD) = 'HAMRU' THEN
		                    -- Email 일 경우 Issue Office가 구주지역일 경우 구주 인증 메일 서버에서 최종 전송할 결과를 표시한다.
		                    DECODE(NVL(T01.EUR_EML_SND_RSLT_CD, 'N'), 'S', 'RECEIVED', 'F', 'FAIL', 'N', DECODE(NVL(T03.EML_PROC_STS_CD, 'N'), '1', 'SENDING', '3', 'SENT', 'FAIL'))
		                ELSE
		                    -- 기타 지역에 Email 전송은 ALPS 메일 서버에서 전송할 결과를 표시한다.
		                    DECODE(NVL(T03.EML_PROC_STS_CD, 'N'), '1', 'SENDING', '3', 'SUCCESS',                 'FAIL')
				
		                END
		           WHEN T01.INV_ISS_SND_TP_CD = 'F' THEN DECODE(NVL(T04.FAX_PROC_STS_CD, 'N'), '1', 'SENDING', '3', 'SENDING', '5', 'SUCCESS', 'FAIL')
		           WHEN T01.INV_ISS_SND_TP_CD = 'P' THEN 'SUCCESS'
		      END                                                   AS RESULT
		    , CASE WHEN T01.INV_ISS_SND_TP_CD = 'E' THEN (SELECT GLOBALDATE_PKG.TIME_CONV_OFC_FNC('SELHO', T03.EML_DT, T05.ISS_OFC_CD) FROM DUAL)
		           WHEN T01.INV_ISS_SND_TP_CD = 'F' THEN (SELECT GLOBALDATE_PKG.TIME_CONV_OFC_FNC('SELHO', T04.FAX_DT, T05.ISS_OFC_CD) FROM DUAL)
		           WHEN T01.INV_ISS_SND_TP_CD = 'P' THEN (SELECT GLOBALDATE_PKG.TIME_CONV_OFC_FNC('SELHO', T05.CRE_DT, T05.ISS_OFC_CD) FROM DUAL)
		      END                                                    AS TIME_SENT
		    , T02.VSL_CD||T02.SKD_VOY_NO||T02.SKD_DIR_CD             AS VVD
		    , DECODE(T02.IO_BND_CD,'I','I/B', 'O/B')                 AS IO_BND_CD
		    , DECODE(T02.IO_BND_CD,'I', T02.POD_CD, 'O', T02.POL_CD) AS PORT
		FROM    (
       
		        SELECT    T2.INV_NO 
						, T2.INV_SEQ
						--, T3.CURR_CD
						--, SUM(T3.CHG_AMT) AS CHG_AMT
		                , T1.INV_ISS_SND_TP_CD
		                , (SELECT MAX(INV_ISS_SND_TP_CD)  FROM INV_AR_ISS_SND WHERE INV_NO = T2.INV_NO) INV_ISS_SND_TP_CD_CHK
		                , T1.INV_SND_CUST_NO
		                , T1.INV_SND_DT
		                , T1.INV_SND_NO
		                , T2.AR_IF_NO
		                , T1.EUR_EML_SND_RSLT_CD
		                , T1.SND_DT
		        FROM    INV_AR_ISS_SND T1, INV_AR_SPLIT_ISS T2 , INV_AR_CHG T3
		        WHERE   1=1
		        AND     T1.INV_NO(+)   = T2.INV_NO
		        AND     T1.INV_SEQ(+)  = T2.INV_SEQ
				AND     T2.AR_IF_NO    = T3.AR_IF_NO
				#if (${from_dt} != '' && ${to_dt} != '' && ${date_type} == 'S')
				AND     T1.INV_SND_DT BETWEEN REPLACE(TO_DATE(@[from_dt],'YYYYMMDD'), '-', '') AND REPLACE(TO_DATE(@[to_dt],'YYYYMMDD'), '-', '')
		        #end
 				#if (${from_dt} != '' && ${to_dt} != ''  && ${date_type} == 'C')
		        AND     T2.ISS_DT BETWEEN REPLACE(@[from_dt], '-', '') AND REPLACE(@[to_dt], '-', '')
		        #end
		        #if (${sent_by} != '')
		        AND     T1.INV_ISS_SND_TP_CD IN (@[sent_by])
		        #end
		        GROUP BY T2.INV_NO, T2.INV_SEQ --, T3.CURR_CD
		                , T1.INV_ISS_SND_TP_CD
		                , T1.INV_SND_CUST_NO
		                , T1.INV_SND_NO
		                , T1.INV_SND_DT
		                , T2.AR_IF_NO
		                , T1.EUR_EML_SND_RSLT_CD
		                , T1.SND_DT              
                               
                
		        ) T01, INV_AR_MN T02, COM_EML_SND_INFO T03, COM_FAX_SND_INFO T04, --INV_AR_ISS T05
		        ( SELECT INV_NO, INV_SEQ, ISS_OFC_CD, CRE_USR_ID, CRE_DT
		          FROM   INV_AR_ISS 
		          UNION ALL
		          SELECT INV_NO, INV_SEQ, AR_OFC_CD AS ISS_OFC_CD, CRE_USR_ID, CRE_DT
		          FROM   INV_AR_SPLIT_ISS
		        ) T05
		WHERE   1=1
		AND     T01.AR_IF_NO    = T02.AR_IF_NO
		AND     T01.INV_SND_NO  = T03.EML_SND_NO (+)
		AND     T01.INV_SND_NO  = T04.FAX_SND_NO (+)
		AND     T01.INV_NO      = T05.INV_NO
		AND     T01.INV_SEQ     = T05.INV_SEQ
		#if  (${ofc_cd} == '')
		AND     T02.AR_OFC_CD IN (
		                    SELECT AR_OFC_CD
		                    FROM   MDM_ORGANIZATION
		                    WHERE  OFC_CD           = AR_OFC_CD
		                    AND    AR_HD_QTR_OFC_CD = (
		                                              SELECT AR_HD_QTR_OFC_CD
		                                              FROM   MDM_ORGANIZATION
		                                              WHERE  OFC_CD = @[user_ofc_cd]
		                                              )  
		                    )		
		#else
		AND     T02.AR_OFC_CD  = @[ofc_cd]
		#end    
      
		AND		(T02.INV_SRC_NO IS NULL OR NVL(T02.INV_SRC_NO,'N') != T05.INV_NO)

		#if (${act_cust_cnt_cd} != '')
		AND     T02.ACT_CUST_CNT_CD = @[act_cust_cnt_cd]
		#end

		#if (${act_cust_seq} != '')
		AND     T02.ACT_CUST_SEQ    = @[act_cust_seq]
		#end

		#if (${vsl_cd} != '')		
		AND     T02.VSL_CD          = @[vsl_cd]		
		#end

		#if (${skd_voy_no} != '')
		AND     T02.SKD_VOY_NO      = @[skd_voy_no]
		#end

		#if (${skd_dir_cd} != '')
		AND     T02.SKD_DIR_CD      = @[skd_dir_cd]
		#end

		#if (${bl_src_no} != '')
		AND     T02.BL_SRC_NO       = @[bl_src_no]
		#end

		#if (${svc_scp_cd} != '')
		AND     T02.SVC_SCP_CD      = @[svc_scp_cd]
		#end

		#if (${io_bnd_cd} != '')
		AND     T02.IO_BND_CD       = @[io_bnd_cd]
		#end

		#if (${port} != '')
		AND    ((T02.IO_BND_CD      = 'I' AND T02.POD_CD = @[port]) OR (T02.IO_BND_CD = 'O' AND T02.POL_CD = @[port])) 
		#end

		#if (${inv_no} != '')
		AND     T05.INV_NO = @[inv_no]
		#end

		#if (${iss_ofc_cd} != '')
		AND     T05.ISS_OFC_CD  = @[iss_ofc_cd]
		#end
		
		#if (${cre_usr_id} != '')
		AND     T05.CRE_USR_ID  = @[cre_usr_id]
		#end
		) T00
WHERE T00.SENT_BY IS NOT NULL
ORDER BY ISS_OFC_CD, CRE_USR_ID, INV_NO, INV_SEQ, BL_SRC_NO, CUST_CODE
--ORDER BY T05.ISS_OFC_CD, T05.CRE_USR_ID, T01.INV_NO, T01.INV_SEQ, T02.BL_SRC_NO, CUST_CODE

#else ------------------------------------------------------------------------------------------------------------------------

SELECT DISTINCT A.AR_OFC_CD ISS_OFC_CD
     , A.CRE_USR_ID CRE_USR_ID
     , CASE WHEN A.EML_SND_NO IS NOT NULL THEN 'e-mail'
            WHEN A.FAX_SND_NO IS NOT NULL THEN 'FAX'
            ELSE 'Paper'
       END SENT_BY
     , CASE WHEN A.EML_SND_NO IS NOT NULL THEN DECODE(NVL(E.EML_PROC_STS_CD, 'N'), '1', 'SENDING', '3', 'SUCCESS', 'FAIL')
            WHEN A.FAX_SND_NO IS NOT NULL THEN DECODE(NVL(F.FAX_PROC_STS_CD, 'N'), '1', 'SENDING', '3', 'SENDING', '5', 'SUCCESS', 'FAIL')
            ELSE 'SUCCESS'
       END RESULT
     , A.INV_NO
     , A.INV_SEQ
	 , 'N' AUTO_INV_ISS_FLG
	 --, B.CURR_CD
	 --, B.CHG_AMT
	 --, SUM(B.CHG_AMT) AS CHG_AMT
     , B.BL_SRC_NO
     , A.ACT_CUST_CNT_CD||'-'||TO_CHAR(A.ACT_CUST_SEQ, 'FM000000')  CUST_CODE
     , CASE WHEN A.EML_SND_NO IS NOT NULL THEN A.CUST_EML
            WHEN A.FAX_SND_NO IS NOT NULL THEN A.CUST_FAX_NO
            ELSE ''
       END  RECEIVED_NO
     , CASE WHEN A.EML_SND_NO IS NOT NULL THEN A.EML_SND_DT
            WHEN A.FAX_SND_NO IS NOT NULL THEN A.FAX_SND_DT
            ELSE A.CRE_DT
       END  TIME_REQUESTED
     , CASE WHEN A.EML_SND_NO IS NOT NULL THEN (SELECT GLOBALDATE_PKG.TIME_CONV_OFC_FNC('SELHO', E.EML_DT, A.AR_OFC_CD) FROM DUAL)
            WHEN A.FAX_SND_NO IS NOT NULL THEN (SELECT GLOBALDATE_PKG.TIME_CONV_OFC_FNC('SELHO', F.FAX_DT, A.AR_OFC_CD) FROM DUAL)
            ELSE (SELECT GLOBALDATE_PKG.TIME_CONV_OFC_FNC('SELHO', A.CRE_DT, A.AR_OFC_CD) FROM DUAL)
       END TIME_SENT
       , B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD VVD
     , DECODE(B.IO_BND_CD,'I','I/B','O/B') IO_BND_CD
     , DECODE(B.IO_BND_CD,'I', B.POD_CD, 'O',B.POL_CD) PORT
FROM INV_AR_KR_ISS A, INV_AR_KR_ISS_CHG B, COM_EML_SND_INFO E, COM_FAX_SND_INFO F
WHERE A.EML_SND_NO = E.EML_SND_NO(+)
AND A.FAX_SND_NO = F.FAX_SND_NO(+)

#if  (${ofc_cd} == '')
AND A.AR_OFC_CD IN (
        SELECT AR_OFC_CD
        FROM MDM_ORGANIZATION
        WHERE AR_HD_QTR_OFC_CD = (
            SELECT AR_HD_QTR_OFC_CD
            FROM MDM_ORGANIZATION
            WHERE OFC_CD = @[user_ofc_cd])
          AND OFC_CD = AR_OFC_CD )
#else
AND A.AR_OFC_CD = @[ofc_cd]
#end

AND A.INV_NO = B.INV_NO
AND A.INV_SEQ = B.INV_SEQ
AND DECODE(A.RISS_DT, '', A.ISS_DT,  A.RISS_DT) BETWEEN REPLACE(@[from_dt], '-', '') AND REPLACE(@[to_dt], '-', '')

#if (${iss_ofc_cd} != '')
AND A.AR_OFC_CD = @[iss_ofc_cd]
#end

#if (${cre_usr_id} != '')
AND A.CRE_USR_ID = @[cre_usr_id]
#end

#if (${act_cust_cnt_cd} != '')
AND A.ACT_CUST_CNT_CD = @[act_cust_cnt_cd]
#end

#if (${act_cust_seq} != '')
AND A.ACT_CUST_SEQ = @[act_cust_seq]
#end

#if (${vsl_cd} != '')
AND B.VSL_CD = @[vsl_cd]
#end

#if (${skd_voy_no} != '')
AND B.SKD_VOY_NO = @[skd_voy_no]
#end

#if (${skd_dir_cd} != '')
AND B.SKD_DIR_CD = @[skd_dir_cd]
#end

#if (${bl_src_no} != '')
AND B.BL_SRC_NO = @[bl_src_no]
#end

#if (${inv_no} != '')
AND A.INV_NO = @[inv_no]
#end

#if (${io_bnd_cd} != '')
AND B.IO_BND_CD = @[io_bnd_cd]
#end

#if (${port} != '')
AND ((B.IO_BND_CD = 'I' AND B.POD_CD = @[port]) OR (B.IO_BND_CD = 'O' AND B.POL_CD = @[port])) 
#end

#if (${sent_by} != '')
       #if (${sent_by} == 'P')
             AND A.EML_SND_NO IS NULL AND A.FAX_SND_NO IS NULL
       #elseif (${sent_by} == 'E')
             AND A.EML_SND_NO IS NOT NULL
       #elseif (${sent_by} == 'F')
             AND A.FAX_SND_NO IS NOT NULL
       #elseif (${sent_by} == 'P,E')
             AND A.FAX_SND_NO IS NULL
       #elseif (${sent_by} == 'P,F')
             AND A.EML_SND_NO IS NULL
       #elseif (${sent_by} == 'E,F')
             AND (A.EML_SND_NO IS NOT NULL OR A.FAX_SND_NO IS NOT NULL)
       #end   
#end
ORDER BY A.AR_OFC_CD, A.CRE_USR_ID, A.INV_NO, A.INV_SEQ, B.BL_SRC_NO, CUST_CODE

#end			]]></sql>
			<params>
				<param name="from_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
				<param name="sent_by" type="12" value="" out="N"/>
				<param name="user_ofc_cd" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="act_cust_cnt_cd" type="12" value="" out="N"/>
				<param name="act_cust_seq" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="bl_src_no" type="12" value="" out="N"/>
				<param name="svc_scp_cd" type="12" value="" out="N"/>
				<param name="io_bnd_cd" type="12" value="" out="N"/>
				<param name="port" type="12" value="" out="N"/>
				<param name="inv_no" type="12" value="" out="N"/>
				<param name="iss_ofc_cd" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
