<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BookingARCreationDBDAOaddOtherInvChargeCSQL">
			<desc><![CDATA[BookingARCreationDBDAOaddOtherInvChargeCSQL]]></desc>
			<sql><![CDATA[
INSERT INTO INV_AR_CHG (
AR_IF_NO
,AR_IF_SER_NO
,CHG_SEQ
,CHG_CD
,CURR_CD
,PER_TP_CD
,TRF_RT_AMT
,RAT_AS_CNTR_QTY
,CHG_AMT
,INV_XCH_RT -- 10
,REP_CHG_CD
,CHG_FULL_NM
,INV_ISS_FLG
,INV_CLR_FLG
,SOB_ID
,INV_REV_TP_SRC_CD
,REV_COA_CO_CD
,REV_COA_RGN_CD
,REV_COA_CTR_CD
,REV_COA_ACCT_CD -- 20
,REV_COA_INTER_CO_CD
,REV_COA_VSL_CD
,REV_COA_VOY_NO
,REV_COA_SKD_DIR_CD
,REV_COA_DIR_CD
,ACCT_CD
,TVA_FLG
,CHG_RMK
,MNL_FLG
,MF_DIV_CD -- 30
,CRE_USR_ID
,CRE_DT
,UPD_USR_ID
,UPD_DT
,INV_XCH_RT_DT
,TJ_SRC_NM
,AR_IF_CHG_SEQ
,IDA_SAC_CD
)VALUES(
@[ar_if_no]
,@[ar_if_ser_no]
,@[chg_seq]
,@[chg_cd] 
,SUBSTR(@[curr_cd], 1, 3)
,@[per_tp_cd]
,ABS(NVL(@[trf_rt_amt], 0))
,NVL(@[rat_as_cntr_qty], 0)
,NVL(CASE WHEN @[if_src_cd] = 'DEM' OR @[if_src_cd] = 'DET' OR @[if_src_cd] = 'DEC' THEN
          (SELECT ROUND(@[chg_amt], B.DP_PRCS_KNT)
             FROM (SELECT CURR_CD
                         ,CURR_NM
                         ,DP_PRCS_KNT
                     FROM MDM_CURRENCY
                    WHERE NVL(TO_EFF_DT,SYSDATE) >= SYSDATE
                      AND DELT_FLG!='Y'
                    ORDER BY CURR_CD) B  
            WHERE SUBSTR(@[curr_cd], 1, 3) = B.CURR_CD)
ELSE
          (SELECT DECODE(SIGN(NVL(@[chg_amt],1)),0,1,SIGN(NVL(@[chg_amt],1))) * ROUND(ABS(NVL(@[trf_rt_amt],0)) * @[rat_as_cntr_qty], B.DP_PRCS_KNT)
             FROM (SELECT CURR_CD
                         ,CURR_NM
                         ,DP_PRCS_KNT
                     FROM MDM_CURRENCY
                    WHERE NVL(TO_EFF_DT,SYSDATE) >= SYSDATE
                      AND DELT_FLG!='Y'
                    ORDER BY CURR_CD) B  
            WHERE SUBSTR(@[curr_cd], 1, 3) = B.CURR_CD)
END, 0)
,NVL(@[inv_xch_rt], 0) -- 10
,@[rep_chg_cd]
,@[chg_full_nm]
,NVL(@[inv_iss_flg],'N')
,NVL(@[inv_clr_flg],'N')
,1
,@[inv_rev_tp_src_cd]
,'01'
,(SELECT FINC_RGN_CD FROM MDM_ORGANIZATION WHERE OFC_CD = @[ofc_cd])
,(SELECT AR_CTR_CD FROM MDM_ORGANIZATION WHERE OFC_CD = @[ofc_cd])
,@[rev_coa_acct_cd] -- 20
,@[rev_coa_inter_co_cd]
,(DECODE(@[rev_coa_acct_cd], null, '', DECODE(SUBSTR(@[rev_coa_acct_cd],1,1), '4', @[rev_coa_vsl_cd], '7', @[rev_coa_vsl_cd], DECODE(SUBSTR(@[rev_coa_acct_cd],1,2), '51', @[rev_coa_vsl_cd], '0000'))))
,(DECODE(@[rev_coa_acct_cd], null, '', DECODE(SUBSTR(@[rev_coa_acct_cd],1,1), '4', @[rev_coa_voy_no], '7', @[rev_coa_voy_no], DECODE(SUBSTR(@[rev_coa_acct_cd],1,2), '51', @[rev_coa_voy_no], '0000'))))
,(DECODE(@[rev_coa_acct_cd], null, '', DECODE(SUBSTR(@[rev_coa_acct_cd],1,1), '4', @[rev_coa_skd_dir_cd], '7', @[rev_coa_skd_dir_cd], DECODE(SUBSTR(@[rev_coa_acct_cd],1,2), '51', @[rev_coa_skd_dir_cd], '0'))))
,(DECODE(@[rev_coa_acct_cd], null, '', DECODE(SUBSTR(@[rev_coa_acct_cd],1,1), '4', @[rev_coa_dir_cd], '7', @[rev_coa_dir_cd], DECODE(SUBSTR(@[rev_coa_acct_cd],1,2), '51', @[rev_coa_dir_cd], '0'))))
,@[acct_cd]
,DECODE(@[tva_flg],'Y',DECODE(@[chg_cd],(SELECT IASO.INV_VAT_CHG_CD 
                                           FROM MDM_ORGANIZATION MO,
                                                INV_AR_STUP_OFC IASO
                                          WHERE MO.OFC_CD = @[ofc_cd]
                                            AND NVL(MO.DELT_FLG, 'N') <> 'Y'
                                            AND MO.AR_OFC_CD = IASO.AR_OFC_CD),'N','Y'),'N')
,@[chg_rmk]
,'Y'
,'N' -- 30
,@[cre_usr_id]
,SYSDATE
,@[upd_usr_id]
,SYSDATE
,@[inv_xch_rt_dt]
,@[tj_src_nm]
,@[ar_if_chg_seq]
,(DECODE(@[ofc_cd], 'BOMSC', (SELECT IDA_SAC_CD FROM MDM_CHARGE WHERE CHG_CD = @[chg_cd]), ''))
)			]]></sql>
			<params>
				<param name="ar_if_no" type="12" value="" out="N"/>
				<param name="ar_if_ser_no" type="12" value="" out="N"/>
				<param name="chg_seq" type="12" value="" out="N"/>
				<param name="chg_cd" type="12" value="" out="N"/>
				<param name="curr_cd" type="12" value="" out="N"/>
				<param name="per_tp_cd" type="12" value="" out="N"/>
				<param name="trf_rt_amt" type="12" value="" out="N"/>
				<param name="rat_as_cntr_qty" type="12" value="" out="N"/>
				<param name="if_src_cd" type="12" value="" out="N"/>
				<param name="chg_amt" type="12" value="" out="N"/>
				<param name="inv_xch_rt" type="12" value="" out="N"/>
				<param name="rep_chg_cd" type="12" value="" out="N"/>
				<param name="chg_full_nm" type="12" value="" out="N"/>
				<param name="inv_iss_flg" type="12" value="" out="N"/>
				<param name="inv_clr_flg" type="12" value="" out="N"/>
				<param name="inv_rev_tp_src_cd" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="rev_coa_acct_cd" type="12" value="" out="N"/>
				<param name="rev_coa_inter_co_cd" type="12" value="" out="N"/>
				<param name="rev_coa_vsl_cd" type="12" value="" out="N"/>
				<param name="rev_coa_voy_no" type="12" value="" out="N"/>
				<param name="rev_coa_skd_dir_cd" type="12" value="" out="N"/>
				<param name="rev_coa_dir_cd" type="12" value="" out="N"/>
				<param name="acct_cd" type="12" value="" out="N"/>
				<param name="tva_flg" type="12" value="" out="N"/>
				<param name="chg_rmk" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="inv_xch_rt_dt" type="12" value="" out="N"/>
				<param name="tj_src_nm" type="12" value="" out="N"/>
				<param name="ar_if_chg_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
