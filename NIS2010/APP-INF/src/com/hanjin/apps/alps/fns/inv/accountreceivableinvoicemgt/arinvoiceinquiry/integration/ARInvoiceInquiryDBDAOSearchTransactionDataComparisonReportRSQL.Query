<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ARInvoiceInquiryDBDAOSearchTransactionDataComparisonReportRSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
SELECT ERP_IF_GL_DT
, AR_HD_QTR_OFC_CD
, AR_OFC_CD
, REV_TP_CD
, REV_SRC_CD
, INV_COA_ACCT_CD
, ACCT_KRN_NM
, CURR_CD
, INV_AMT 
FROM (
SELECT T.ERP_IF_GL_DT
, D.AR_HD_QTR_OFC_CD
, T.AR_OFC_CD
, T.REV_TP_CD
, T.REV_SRC_CD
, T.INV_COA_ACCT_CD
, T.ACCT_KRN_NM
, T.CURR_CD
, T.INV_AMT
FROM MDM_ORGANIZATION D, (
SELECT TO_CHAR(TO_DATE(C.ERP_IF_GL_DT,'YYYYMMDD'),'YYYY/MM') ERP_IF_GL_DT
, A.AR_OFC_CD AR_OFC_CD
, DECODE(A.REV_TP_CD, 'B', 'B/L', 'C', 'C/A', 'M', 'MRI') REV_TP_CD
, A.REV_TP_CD||A.REV_SRC_CD REV_SRC_CD
, C.INV_COA_ACCT_CD INV_COA_ACCT_CD
, (SELECT MAX(ACCT_KRN_NM) FROM MDM_ACCOUNT WHERE ACCT_CD = C.INV_COA_ACCT_CD) ACCT_KRN_NM
, C.CURR_CD CURR_CD
, SUM(C.INV_AMT) INV_AMT
FROM INV_AR_MN A, INV_AR_AMT C
WHERE A.AR_IF_NO = C.AR_IF_NO
AND C.INV_ERP_IF_STS_CD = 'Y'
#if (${date_option} == 'I') 
    AND A.BL_INV_IF_DT BETWEEN REPLACE(@[from_date],'-','') AND REPLACE(@[to_date],'-','')
#elseif (${date_option} == 'C') 
    AND A.BL_INV_CFM_DT BETWEEN REPLACE(@[from_date],'-','') AND REPLACE(@[to_date],'-','')
#elseif (${date_option} == 'G') 
    AND C.ERP_IF_GL_DT BETWEEN REPLACE(@[from_date],'-','') AND REPLACE(@[to_date],'-','')
#end
#if (${ar_ofc_cd} != 'ALL' && ${ar_ofc_cd} != '')
    AND A.AR_OFC_CD = @[ar_ofc_cd]
#end
#if (${rev_tp_cd} != 'A' && ${rev_tp_cd} != '')
    AND A.REV_TP_CD = @[rev_tp_cd]
#end
#if (${rev_src_cd} != 'A' && ${rev_src_cd} != '')
    AND A.REV_SRC_CD IN (@[rev_src_cd])
#end
GROUP BY TO_CHAR(TO_DATE(ERP_IF_GL_DT,'YYYYMMDD'),'YYYY/MM')
, A.AR_OFC_CD
, DECODE(A.REV_TP_CD, 'B', 'B/L', 'C', 'C/A', 'M', 'MRI')
, A.REV_TP_CD||A.REV_SRC_CD
, C.INV_COA_ACCT_CD
, C.CURR_CD
) T
WHERE D.OFC_CD = T.AR_OFC_CD
#if (${ar_hd_qtr_ofc_cd} != 'ALL' && ${ar_hd_qtr_ofc_cd} != '')
    AND D.AR_HD_QTR_OFC_CD = @[ar_hd_qtr_ofc_cd]
#end
ORDER BY ERP_IF_GL_DT
, AR_HD_QTR_OFC_CD
, AR_OFC_CD
, REV_TP_CD
, REV_SRC_CD
, INV_COA_ACCT_CD
, ACCT_KRN_NM
, CURR_CD
, INV_AMT    
) 
UNION ALL
SELECT ERP_IF_GL_DT
, AR_HD_QTR_OFC_CD
, AR_OFC_CD
, REV_TP_CD
, REV_SRC_CD
, REV_COA_ACCT_CD
, ACCT_KRN_NM
, CURR_CD
, CHG_AMT
FROM (
SELECT T.ERP_IF_GL_DT
, D.AR_HD_QTR_OFC_CD
, T.AR_OFC_CD
, T.REV_TP_CD
, T.REV_SRC_CD
, T.REV_COA_ACCT_CD
, T.ACCT_KRN_NM
, T.CURR_CD
, T.CHG_AMT
FROM MDM_ORGANIZATION D, (
SELECT TO_CHAR(TO_DATE(C.ERP_IF_GL_DT,'YYYYMMDD'),'YYYY/MM') ERP_IF_GL_DT
, A.AR_OFC_CD AR_OFC_CD
, DECODE(A.REV_TP_CD, 'B', 'B/L', 'C', 'C/A', 'M', 'MRI') REV_TP_CD
, A.REV_TP_CD||A.REV_SRC_CD REV_SRC_CD
, B.REV_COA_ACCT_CD REV_COA_ACCT_CD
, (SELECT MAX(ACCT_KRN_NM) FROM MDM_ACCOUNT WHERE ACCT_CD = B.REV_COA_ACCT_CD) ACCT_KRN_NM
, C.CURR_CD CURR_CD
, SUM(B.CHG_AMT) CHG_AMT
FROM INV_AR_MN A, INV_AR_CHG B, INV_AR_AMT C
WHERE A.AR_IF_NO = B.AR_IF_NO
AND B.AR_IF_NO = C.AR_IF_NO
AND B.AR_IF_SER_NO = C.AR_IF_SER_NO
AND C.INV_ERP_IF_STS_CD = 'Y'
#if (${date_option} == 'I') 
    AND A.BL_INV_IF_DT BETWEEN REPLACE(@[from_date],'-','') AND REPLACE(@[to_date],'-','')
#elseif (${date_option} == 'C') 
    AND A.BL_INV_CFM_DT BETWEEN REPLACE(@[from_date],'-','') AND REPLACE(@[to_date],'-','')
#elseif (${date_option} == 'G') 
    AND C.ERP_IF_GL_DT BETWEEN REPLACE(@[from_date],'-','') AND REPLACE(@[to_date],'-','')
#end
#if (${ar_ofc_cd} != 'ALL' && ${ar_ofc_cd} != '')
    AND A.AR_OFC_CD = @[ar_ofc_cd]
#end
#if (${rev_tp_cd} != 'A' && ${rev_tp_cd} != '')
    AND A.REV_TP_CD = @[rev_tp_cd]
#end
#if (${rev_src_cd} != 'A' && ${rev_src_cd} != '')
    AND A.REV_SRC_CD IN (@[rev_src_cd])
#end
GROUP BY TO_CHAR(TO_DATE(ERP_IF_GL_DT,'YYYYMMDD'),'YYYY/MM')
, A.AR_OFC_CD
, DECODE(A.REV_TP_CD, 'B', 'B/L', 'C', 'C/A', 'M', 'MRI')
, A.REV_TP_CD||A.REV_SRC_CD
, B.REV_COA_ACCT_CD
, C.CURR_CD
) T
WHERE D.OFC_CD = T.AR_OFC_CD
#if (${ar_hd_qtr_ofc_cd} != 'ALL' && ${ar_hd_qtr_ofc_cd} != '')
    AND D.AR_HD_QTR_OFC_CD = @[ar_hd_qtr_ofc_cd]
#end
ORDER BY ERP_IF_GL_DT
, AR_HD_QTR_OFC_CD
, AR_OFC_CD
, REV_TP_CD
, REV_SRC_CD
, REV_COA_ACCT_CD
, ACCT_KRN_NM
, CURR_CD
, CHG_AMT )			]]></sql>
			<params>
				<param name="from_date" type="12" value="" out="N"/>
				<param name="to_date" type="12" value="" out="N"/>
				<param name="ar_ofc_cd" type="12" value="" out="N"/>
				<param name="rev_tp_cd" type="12" value="" out="N"/>
				<param name="rev_src_cd" type="12" value="" out="N"/>
				<param name="ar_hd_qtr_ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
