<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableEDISendDBDAOSearchEdiPHILSBkgCustTpRSQL">
			<desc><![CDATA[SearchEdiPHILSBkgCustTp]]></desc>
			<sql><![CDATA[
SELECT DECODE(BC.BKG_CUST_TP_CD, 'S', 'SF', 'ST') P_CUST_TP,
       REPLACE(BC.CUST_NM,chr(13)||chr(10),' ') CUST_NM, 
       REPLACE(BC.CUST_ADDR,chr(13)||chr(10),' ') CUST_ADDR, 
       REPLACE(BC.CUST_CTY_NM,chr(13)||chr(10),' ') CUST_CTY_NM, 
       ML.UN_LOC_CD, 
       MC.LOC_CD
FROM   BKG_BOOKING BK,
       BKG_CUSTOMER BC,
       MDM_CUSTOMER MC,
       MDM_LOCATION ML
WHERE  BK.BKG_NO = BC.BKG_NO
AND    BC.CUST_CNT_CD = MC.CUST_CNT_CD
AND    BC.CUST_SEQ = MC.CUST_SEQ
AND    MC.LOC_CD  =  ML.LOC_CD
AND    BK.BKG_NO = @[bkg_no] 
AND    BC.BKG_CUST_TP_CD IN ('S','C','N')
AND   ((CUST_TO_ORD_FLG = 'N' AND BKG_CUST_TP_CD IN ('S','C')) OR (CUST_TO_ORD_FLG = 'Y' AND BKG_CUST_TP_CD IN ('S','N')))
UNION ALL
SELECT 'BY' P_CUST_TP,
       REPLACE(MC.CUST_LGL_ENG_NM,chr(13)||chr(10),' ') CUST_NM, 
       REPLACE(UPPER(SUBSTR(CA.BZET_ADDR||' '||CA.CTY_NM||' '||CA.STE_CD,1,400)),chr(13)||chr(10),' ') CUST_ADDR, 
       REPLACE(UPPER(CA.CTY_NM),chr(13)||chr(10),' ') CUST_CTY_NM, 
       ML.UN_LOC_CD, 
       EPL.PHILS_LOC_CD_CTNT  LOC_CD
FROM   INV_EDI_PHILS_LOC EPL,
       MDM_CUSTOMER MC,
       MDM_LOCATION ML,
       MDM_CUST_ADDR CA
WHERE  EPL.CUST_CNT_CD = MC.CUST_CNT_CD
AND    EPL.CUST_SEQ = MC.CUST_SEQ
AND    EPL.CUST_CNT_CD = CA.CUST_CNT_CD
AND    EPL.CUST_SEQ = CA.CUST_SEQ
AND    MC.LOC_CD  =  ML.LOC_CD
AND    CA.PRMRY_CHK_FLG = 'Y'
AND    EPL.CUST_CNT_CD = NVL(@[inv_cust_cnt_cd], '')
AND    EPL.CUST_SEQ = CASE WHEN REGEXP_INSTR(@[inv_cust_seq], '[[:alpha:]]', 1, 1) = 0 THEN
                                TO_NUMBER(@[inv_cust_seq])
                           ELSE
                                -999999
                           END 
AND    ROWNUM = 1			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="inv_cust_cnt_cd" type="12" value="" out="N"/>
				<param name="inv_cust_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
