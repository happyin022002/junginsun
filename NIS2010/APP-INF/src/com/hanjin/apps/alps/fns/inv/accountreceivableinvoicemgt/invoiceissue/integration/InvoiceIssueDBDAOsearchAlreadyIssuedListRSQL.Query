<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceIssueDBDAOsearchAlreadyIssuedListRSQL">
			<desc><![CDATA[param으로 넘어온 bl_no가 기 발행되었는지 체크하여 list 생성]]></desc>
			<sql><![CDATA[
SELECT BL_SRC_NO
  FROM INV_AR_MN
 WHERE AR_OFC_CD = @[ar_ofc_cd2]
   AND NVL(INV_DELT_DIV_CD, 'N') <> 'Y' 
   AND INV_CLR_FLG = 'N'
   AND INV_NO IS NOT NULL

#if (${rev_type} != '')
    #if (${rev_type} == 'M')     
    AND REV_TP_CD = 'M'
    #elseif (${rev_type} == 'F')     
    AND REV_TP_CD <> 'M'
    #end
#end

#if (${from_dt} != '' && ${to_dt} != '') 
    #if (${dt_option} == 'G') 
    AND BL_INV_CFM_DT BETWEEN REPLACE(@[from_dt],'-','') AND REPLACE(@[to_dt],'-','')
    #else
    AND UPD_DT >= TO_DATE(REPLACE(@[from_dt],'-',''), 'YYYYMMDD') AND UPD_DT < TO_DATE(REPLACE(@[to_dt],'-',''), 'YYYYMMDD') + 1
    AND UPD_USR_ID = @[user_id]
    #end
#end

#if (${bl_nos} != '') 
    AND BL_SRC_NO IN (${bl_nos})
#end                                                 

#if (${cust_cnt_cd} != '') 
    AND ACT_CUST_CNT_CD = @[cust_cnt_cd]
#end

#if (${cust_seq} != '') 
    AND ACT_CUST_SEQ = @[cust_seq]
#end

#if (${if_user_id} != '') 
    AND UPD_USR_ID = @[if_user_id]
#end

#if (${vvd} != '') 
    AND VSL_CD = SUBSTR(@[vvd], 1, 4)
    AND SKD_VOY_NO = SUBSTR(@[vvd], 5, 4) 
    AND SKD_DIR_CD = SUBSTR(@[vvd], 9, 1)
#end

#if (${port} != '') 
    AND DECODE(IO_BND_CD, 'I', POD_CD, POL_CD) = @[port]
#end

#if (${scp} != '') 
    AND SVC_SCP_CD = @[scp]
#end

#if (${bnd} != 'A' && ${bnd} != '')     
    AND IO_BND_CD = @[bnd]
#end                                 

#if (${inv_dup_flg} != 'Y') 
    AND INV_ISS_FLG = 'N'   
#end
GROUP BY BL_SRC_NO			]]></sql>
			<params>
				<param name="ar_ofc_cd2" type="12" value="" out="N"/>
				<param name="from_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
				<param name="user_id" type="12" value="" out="N"/>
				<param name="cust_cnt_cd" type="12" value="" out="N"/>
				<param name="cust_seq" type="12" value="" out="N"/>
				<param name="if_user_id" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="port" type="12" value="" out="N"/>
				<param name="scp" type="12" value="" out="N"/>
				<param name="bnd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
