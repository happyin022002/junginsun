<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CarrierSettlementProcessDBDAORdrPortUSQL">
			<desc><![CDATA[RDR Port를 저장한다.]]></desc>
			<sql><![CDATA[
MERGE INTO JOO_RDR_PORT A
USING
(
    SELECT  @[vsl_cd]		AS VSL_CD 
           ,@[skd_voy_no]	AS SKD_VOY_NO 
           ,@[skd_dir_cd]	AS SKD_DIR_CD  
           ,@[vps_port_cd]	AS VPS_PORT_CD  
           ,@[split_no] 	AS CLPT_IND_SEQ
		   ,@[rlane_cd]		AS SLAN_CD
    FROM DUAL
) B
ON
(
        A.VSL_CD = B.VSL_CD
    AND A.SKD_VOY_NO = B.SKD_VOY_NO
    AND A.SKD_DIR_CD = B.SKD_DIR_CD
    AND A.VPS_PORT_CD = B.VPS_PORT_CD
    AND A.CLPT_IND_SEQ = B.CLPT_IND_SEQ    
    AND A.SLAN_CD = B.SLAN_CD
)
WHEN MATCHED THEN
UPDATE SET A.RDR_FLG = DECODE(@[rdr_flg],'R','Y','N')
		  ,A.UPD_DT = SYSDATE
          ,A.UPD_USR_ID = @[usr_id]
WHEN NOT MATCHED THEN
INSERT
(
     VSL_CD
    ,SKD_VOY_NO
    ,SKD_DIR_CD
    ,VPS_PORT_CD
    ,CLPT_IND_SEQ
    ,CLPT_SEQ
    ,SLAN_CD
    ,YD_CD
    ,VPS_ETD_DT
    ,RDR_FLG
    ,CRE_DT
    ,CRE_USR_ID
    ,UPD_DT
    ,UPD_USR_ID    
) VALUES (
     @[vsl_cd]
    ,@[skd_voy_no]
    ,@[skd_dir_cd]
    ,@[vps_port_cd]
    ,@[split_no]
    ,@[clpt_seq]
    ,@[rlane_cd]
    ,@[vps_port_cd] || @[tml_cd]
    ,TO_DATE(@[vps_etd_dt],'YYYYMMDDHH24MI')
    ,DECODE(@[rdr_flg],'R','Y','N')
    ,SYSDATE
    ,@[usr_id]
    ,SYSDATE
    ,@[usr_id]
)			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="vps_port_cd" type="12" value="" out="N"/>
				<param name="split_no" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="rdr_flg" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="clpt_seq" type="12" value="" out="N"/>
				<param name="tml_cd" type="12" value="" out="N"/>
				<param name="vps_etd_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
