<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ManualARCreationDBDAOsearchDueDateRSQL">
			<desc><![CDATA[Due Date 가져오기]]></desc>
			<sql><![CDATA[
#if (${cust_cnt_cd} == '' || ${cust_seq} == '')
SELECT  DECODE(@[bnd], 'I',
               TO_CHAR(TO_DATE(@[sa_dt], 'YYYY-MM-DD') + NVL(IB_CR_TERM_DYS,0), 'YYYY-MM-DD'),
               TO_CHAR(TO_DATE(@[sa_dt], 'YYYY-MM-DD') + NVL(OB_CR_TERM_DYS,0), 'YYYY-MM-DD')) DUE_DT
FROM   MDM_ORGANIZATION
WHERE  OFC_CD = @[ofc_cd]
AND    DELT_FLG <> 'Y'
#else 
SELECT  
        DECODE(A.CR_FLG, 'Y',
              DECODE(@[bnd], 'I',
                     TO_CHAR(TO_DATE(@[sa_dt], 'YYYY-MM-DD') + DECODE(NVL(A.IB_CR_TERM_DYS,0),0, NVL(B.IB_CR_TERM_DYS,0),NVL(A.IB_CR_TERM_DYS,0)),
                             'YYYY-MM-DD'),
                     TO_CHAR(TO_DATE(@[sa_dt], 'YYYY-MM-DD') + DECODE(NVL(A.OB_CR_TERM_DYS,0),0, NVL(B.OB_CR_TERM_DYS,0),NVL(A.OB_CR_TERM_DYS,0)),
                             'YYYY-MM-DD')),
              DECODE(@[bnd], 'I',
                     TO_CHAR(TO_DATE(@[sa_dt], 'YYYY-MM-DD') + NVL(B.IB_CR_TERM_DYS,0),
                             'YYYY-MM-DD'),
                     TO_CHAR(TO_DATE(@[sa_dt], 'YYYY-MM-DD') + NVL(B.OB_CR_TERM_DYS,0),
                             'YYYY-MM-DD'))
        ) DUE_DT
FROM   MDM_CR_CUST A, MDM_ORGANIZATION B, MDM_CUSTOMER C
WHERE  C.CUST_CNT_CD = @[cust_cnt_cd]
AND    C.CUST_SEQ = CASE WHEN REGEXP_INSTR(@[cust_seq], '[[:alpha:]]', 1, 1) = 0 THEN
                         TO_NUMBER(@[cust_seq])
                    ELSE
                         -999999
                    END 
AND    REPLACE(@[sa_dt],'-','') BETWEEN A.CR_ST_DT(+) AND A.CR_END_DT(+)
AND    C.CUST_CNT_CD = A.CUST_CNT_CD(+)
AND    C.CUST_SEQ = A.CUST_SEQ(+)
AND    B.OFC_CD = @[ofc_cd]
#end			]]></sql>
			<params>
				<param name="bnd" type="12" value="" out="N"/>
				<param name="sa_dt" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="cust_cnt_cd" type="12" value="" out="N"/>
				<param name="cust_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
