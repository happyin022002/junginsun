<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableEDISendDBDAOSearchSamsungAREDIMainRSQL">
			<desc><![CDATA[message no로  생성된  삼성전자의 EDI 전송할 정보를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD VVD,
  A.CUST_CNT_CD,
  A.CUST_SEQ,
  A.MSG_NM,
  A.MSG_NO,
  A.INV_XCH_RT,
  TO_CHAR(TO_DATE(MIN(A.SAIL_ARR_DT), 'YYYYMMDD'), 'YYYY-MM-DD') SAIL_ARR_DT,
  TO_CHAR(TO_DATE(A.BIL_DT, 'YYYYMMDD'), 'YYYY-MM-DD') BIL_DT,
  A.BIL_USD_AMT,
  A.BIL_KRW_AMT,
  MIN(A.INV_MSG_FUNC_CD) INV_MSG_FUNC_CD,
  D.LOCL_NM,
  DECODE(B.INDIV_CORP_DIV_CD, 'C', CASE WHEN LENGTH(B.CUST_RGST_NO) = 10 THEN SUBSTR(B.CUST_RGST_NO, 0, 3)||'-'||SUBSTR(B.CUST_RGST_NO, 4, 2)||'-'||SUBSTR(B.CUST_RGST_NO, 6, 5) ELSE B.CUST_RGST_NO END, 'P', CASE WHEN LENGTH(B.CUST_RGST_NO) = 13 THEN SUBSTR(B.CUST_RGST_NO, 0, 6) ||'-'||SUBSTR(B.CUST_RGST_NO, 7, 13) ELSE B.CUST_RGST_NO END) CUST_RGST_NO,
  CASE WHEN A.CUST_CNT_CD = 'KR' AND A.CUST_SEQ = '38221' THEN '1248100998' ELSE '8504187111' END E_SIGN,
  D.LOCL_ADDR1,
  D.LOCL_ADDR2,
  D.OWNR_NM,
  A.SREP_NM,
  A.RCVR_PHN_NO,
  A.EDI_HDR_RMK,
  A.SND_FLG
FROM INV_AR_EDI_GERP_HDR A,
  MDM_CUSTOMER B,
  MDM_CUST_ADDR C,
  MDM_CR_CUST D,
  MDM_CUST_CNTC_PNT E
WHERE A.CUST_CNT_CD = B.CUST_CNT_CD (+)
  AND A.CUST_SEQ = B.CUST_SEQ (+)
  AND A.CUST_CNT_CD = C.CUST_CNT_CD (+)
  AND A.CUST_SEQ = C.CUST_SEQ (+)
  AND C.PRMRY_CHK_FLG (+) = 'Y'
  AND A.CUST_CNT_CD = D.CUST_CNT_CD (+)
  AND A.CUST_SEQ = D.CUST_SEQ (+)
  AND A.CUST_CNT_CD = E.CUST_CNT_CD (+)
  AND A.CUST_SEQ = E.CUST_SEQ (+)
  AND A.DELT_FLG = 'N'
  AND B.DELT_FLG = 'N'
  AND C.DELT_FLG = 'N'
  AND D.DELT_FLG = 'N'
  AND A.MSG_ID = @[msg_id]
  AND A.MSG_NO = @[msg_no]
GROUP BY A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD, A.CUST_CNT_CD, A.CUST_SEQ, A.MSG_NM, A.MSG_NO, A.INV_XCH_RT, A.BIL_DT, A.BIL_USD_AMT, A.BIL_KRW_AMT, D.LOCL_NM, B.CUST_RGST_NO, B.INDIV_CORP_DIV_CD, D.LOCL_ADDR1, D.LOCL_ADDR2, D.OWNR_NM, A.SREP_NM, A.RCVR_PHN_NO, A.EDI_HDR_RMK, A.SND_FLG 			]]></sql>
			<params>
				<param name="msg_id" type="12" value="" out="N"/>
				<param name="msg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
