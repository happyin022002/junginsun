<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JointOperationAccrualCreationDBDAOEstdVvdRSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
SELECT DISTINCT G.RLANE_CD, G.VSL_CD||G.SKD_VOY_NO||G.SKD_DIR_CD||G.REV_DIR_CD vvdcode 
  FROM GL_ESTM_REV_VVD G, AR_ROUT_RNK R
 WHERE G.RLANE_CD = R.RLANE_CD
   AND G.ESTM_IOC_DIV_CD = SUBSTR(ZN_IOC_CD,1,2)
   AND G.EXE_YRMON = REPLACE(@[exe_yrmon],'-','')
   AND ( ( G.REV_YRMON = REPLACE( @[exe_yrmon], '-', '')  AND    G.ESTM_IOC_DIV_CD IN ('OO', 'IA','IM', 'IE') )
               OR  ( G.REV_YRMON > REPLACE( @[exe_yrmon], '-', '')  AND ( G.ESTM_VVD_TP_CD = 'PV' AND R.ZN_IOC_CD NOT IN ('IA', 'IE', 'IM') ) ) )
   AND G.ESTM_BC_DIV_CD = 'C'
MINUS
SELECT DISTINCT J.RLANE_CD, J.VSL_CD||J.SKD_VOY_NO||J.SKD_DIR_CD||J.REV_DIR_CD 
  FROM JOO_ESTM_ACT_RSLT J
 WHERE EXE_YRMON = REPLACE( @[exe_yrmon], '-' , '')			]]></sql>
			<params>
				<param name="exe_yrmon" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
