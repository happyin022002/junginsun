<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JointOperationMasterDataMgtDBDAOCheckVoyageRSQL">
			<desc><![CDATA[이전 버전의 End VVD의 Voyage와 신규입력, 수정하는 데이터의  Start VVD의 Voyage를 비교하여 순서에 맞는지를 확인함. 
Start VVD와  End VVD 간의 선후관계도  check.함.]]></desc>
			<sql><![CDATA[
SELECT 
#if (${old_jo_ver_no} == '0')

   CASE WHEN TO_NUMBER(@[jo_st_skd_voy_no])> TO_NUMBER(@[jo_end_skd_voy_no])
       THEN 'N'
       ELSE 'Y'
       END  AS VOY_CHK   
 FROM  DUAL

#else

#if (${jo_st_skd_voy_no} != '' && ${jo_end_skd_voy_no} != '' ) 
   CASE WHEN ( TO_NUMBER(A.JO_END_SKD_VOY_NO) >= TO_NUMBER(@[jo_st_skd_voy_no]) OR (TO_NUMBER(@[jo_st_skd_voy_no])> TO_NUMBER(@[jo_end_skd_voy_no])))
       THEN 'N'
       ELSE 'Y'
       END  AS VOY_CHK   
#elseif (${jo_st_skd_voy_no} != '' && ${jo_end_skd_voy_no} == '' ) 
   CASE WHEN  TO_NUMBER( A.JO_END_SKD_VOY_NO) >= TO_NUMBER(@[jo_st_skd_voy_no])
        THEN 'N'
        ELSE 'Y'
        END  AS VOY_CHK 
#else 
 'Y' AS VOY_CHK
#end
  FROM  JOO_BSA_INFO_ENTR A
 WHERE   A.VSL_CD     =  @[vsl_cd]       
   AND   A.SKD_DIR_CD =  @[skd_dir_cd]   
   AND   A.PORT_CD    =  @[port_cd]      
   AND   A.PORT_SEQ   =  @[port_seq]     
   AND   A.JO_CRR_CD  =  @[jo_crr_cd]    
   AND   A.JO_VER_NO  =  @[old_jo_ver_no]
   AND   A.RLANE_CD   =  @[rlane_cd]
   AND   A.JO_VER_FLG = 'Y'

#end			]]></sql>
			<params>
				<param name="jo_st_skd_voy_no" type="12" value="" out="N"/>
				<param name="jo_end_skd_voy_no" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="port_cd" type="12" value="" out="N"/>
				<param name="port_seq" type="12" value="" out="N"/>
				<param name="jo_crr_cd" type="12" value="" out="N"/>
				<param name="old_jo_ver_no" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
