<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JointOperationAccrualCreationDBDAOSearchJointOperationAccrualERPTotalRSQL">
			<desc><![CDATA[추정 건을 ERP보낸 보낸 후 총 합계]]></desc>
			<sql><![CDATA[
SELECT SUM(ROUND(A.ESTM_AMT,2)) AS ESTM_AMT
      ,SUM(ROUND(A.ACT_AMT, 2)) AS ACT_AMT
      ,SUM(ROUND(A.ACCL_AMT,2)) AS ACCL_AMT
      ,SUM(1) AS DIFF_AMT
      ,CEIL(COUNT(1)/TO_NUMBER(@[pagerows])) AS TOT_PAGE_CNT
FROM GL_ESTM_IF_ERP A
WHERE 1=1
AND A.SYS_SRC_ID = 'JOO'
AND A.EXE_YRMON = REPLACE(@[exe_yrmon],'-','')
           #if (${re_divr_cd} != '')
           AND A.ACCT_CD LIKE DECODE(@[re_divr_cd],'R','4','E','5')||'%'
           #end
           #if (${jo_crr_cd} != '')
           AND A.CRR_CD = @[jo_crr_cd]
           #end
           #if (${trd_cd} != '')
           #end
           #if (${rlane_cd} != '')
           AND A.WO_NO  = @[rlane_cd]
           #end
           #if (${vvd} != '')
           AND A.VSL_CD 	= substr(@[vvd],1,4) 
           AND A.SKD_VOY_NO = substr(@[vvd],5,4)
           AND A.SKD_DIR_CD = substr(@[vvd],9,1)
           AND A.REV_DIR_CD = substr(@[vvd],10,1)
           #end
           #if (${acct_cd} != '')
           AND A.ACCT_CD = @[acct_cd]
           #end
           #if (${estm_vvd_tp_cd} != '')
           AND A.ESTM_VVD_TP_CD = @[estm_vvd_tp_cd]
           #end
           #if (${diff} != '')
           #end
           #if (${adjust} != '')
           #end
           #if (${rev_yrmon_to} != '' && ${rev_yrmon_fr} != '')
		   AND A.REV_YRMON BETWEEN REPLACE(@[rev_yrmon_fr],'-','') AND REPLACE(@[rev_yrmon_to],'-','')
		   #end			]]></sql>
			<params>
				<param name="pagerows" type="12" value="" out="N"/>
				<param name="exe_yrmon" type="12" value="" out="N"/>
				<param name="re_divr_cd" type="12" value="" out="N"/>
				<param name="jo_crr_cd" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="acct_cd" type="12" value="" out="N"/>
				<param name="estm_vvd_tp_cd" type="12" value="" out="N"/>
				<param name="rev_yrmon_fr" type="12" value="" out="N"/>
				<param name="rev_yrmon_to" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
