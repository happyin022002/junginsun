<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JointOperationAccrualCreationDBDAOSearchEstmPerformanceRSQL">
			<desc><![CDATA[FNS_JOO_0074 Estimate Performance Inquiry]]></desc>
			<sql><![CDATA[
SELECT
       A.EXE_YRMON
      ,A.REV_YRMON
      ,A.JO_CRR_CD
      ,B.TRD_CD
      ,CASE WHEN A.ACCT_CD LIKE '4%' THEN
              B.CUST_CNT_CD||B.CUST_SEQ
            WHEN A.ACCT_CD LIKE '5%' THEN
              B.VNDR_SEQ||''
       END AS VNDR_CUST_SEQ
      ,CASE WHEN A.ACCT_CD LIKE '4%' THEN
              'R'
            WHEN A.ACCT_CD LIKE '5%' THEN
              'E'
       END AS RE_DIVR_CD
      ,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD||A.REV_DIR_CD AS VVD
      ,A.VSL_CD
      ,A.SKD_VOY_NO
      ,A.SKD_DIR_CD
      ,A.REV_DIR_CD
      ,A.RLANE_CD
      ,A.JO_STL_JB_CD
      ,A.BSA_QTY
      ,A.BSA_SLT_PRC
      ,A.ACCT_CD
      ,A.ESTM_AMT
      ,A.ACT_AMT
      ,A.ACCL_AMT
      ,A.ESTM_AMT - A.ACT_AMT AS DIFF_AMT
      ,A.ESTM_VVD_TP_CD
      ,A.JO_IOC_DIV_CD
      ,A.ESTM_VVD_HDR_ID
      ,A.CNTR_BLK_DIV_CD
      ,A.SYS_SRC_ID
      ,A.LOC_CD
      ,A.JO_CNTR_DIV_CTNT
      ,A.ACCL_AMT_CORR_FLG
FROM   JOO_ESTM_ACT_RSLT A
      ,JOO_CARRIER       B
WHERE  A.JO_CRR_CD = B.JO_CRR_CD
AND    A.RLANE_CD  = B.RLANE_CD
AND    A.EXE_YRMON  = REPLACE(@[exe_yrmon],'-','')
AND    A.REV_YRMON >= REPLACE(@[rev_yrmon_fr],'-','')
AND    A.REV_YRMON <= REPLACE(@[rev_yrmon_to],'-','')
#if (${re_divr_cd} != '')
AND    A.ACCT_CD = DECODE(@[re_divr_cd],'R','411221','E','510921')
#else
AND    A.ACCT_CD IN ('411221','510921')
#end
#if (${jo_crr_cd} != '')
AND    A.JO_CRR_CD = @[jo_crr_cd]
#end
#if (${trd_cd} != '')
AND    B.TRD_CD    = @[trd_cd]
#end
#if (${rlane_cd} != '')
AND    A.RLANE_CD  = @[rlane_cd]
#end
#if (${jo_stl_jb_cd} != '')
AND    A.JO_STL_JB_CD = @[jo_stl_jb_cd]
#end
#if (${diff_option} == '1')
AND    A.ESTM_AMT >= A.ACT_AMT
#elseif  (${diff_option} == '2')
AND    A.ESTM_AMT <> A.ACT_AMT
#end
#if (${vvd} != '')
AND    A.VSL_CD     = SUBSTR(@[vvd], 1,4)
AND    A.SKD_VOY_NO = SUBSTR(@[vvd], 5,4)
AND    A.SKD_DIR_CD = SUBSTR(@[vvd], 9,1)
AND    A.REV_DIR_CD = SUBSTR(@[vvd],10,1)
#end
ORDER  BY A.REV_YRMON, A.JO_CRR_CD, A.RLANE_CD, A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD, A.REV_DIR_CD, A.ESTM_VVD_TP_CD, A.ACCT_CD			]]></sql>
			<params>
				<param name="exe_yrmon" type="12" value="" out="N"/>
				<param name="rev_yrmon_fr" type="12" value="" out="N"/>
				<param name="rev_yrmon_to" type="12" value="" out="N"/>
				<param name="re_divr_cd" type="12" value="" out="N"/>
				<param name="jo_crr_cd" type="12" value="" out="N"/>
				<param name="trd_cd" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="jo_stl_jb_cd" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
