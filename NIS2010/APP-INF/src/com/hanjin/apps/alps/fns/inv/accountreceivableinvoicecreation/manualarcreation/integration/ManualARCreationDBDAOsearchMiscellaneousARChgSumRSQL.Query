<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ManualARCreationDBDAOsearchMiscellaneousARChgSumRSQL">
			<desc><![CDATA[ManualARCreationDBDAOsearchMiscellaneousARChgSumRSQL]]></desc>
			<sql><![CDATA[
SELECT A.CURR_CD
--, SUM(A.CHG_AMT) CHG_AMT
, DECODE(INSTR(SUM(A.CHG_AMT), '.'), 0, RPAD(TRIM(TO_CHAR(TRUNC(SUM(A.CHG_AMT)), '999,999,999,999'))|| '.', LENGTH(TRIM(TO_CHAR(TRUNC(SUM(A.CHG_AMT)), '999,999,999,999'))) + DECODE(C.DP_PRCS_KNT, 0, C.DP_PRCS_KNT, C.DP_PRCS_KNT + 1), '0')  
                                , RPAD(TRIM(TO_CHAR(TRUNC(SUM(A.CHG_AMT)), '999,999,999,999'))|| '.' ||SUBSTR(SUM(A.CHG_AMT), INSTR(SUM(A.CHG_AMT), '.')+1, LENGTH(SUM(A.CHG_AMT))), LENGTH(TRIM(TO_CHAR(TRUNC(SUM(A.CHG_AMT)), '999,999,999,999'))) + DECODE(C.DP_PRCS_KNT, 0, C.DP_PRCS_KNT, C.DP_PRCS_KNT + 1), '0')) CHG_AMT 
, MIN(A.INV_XCH_RT) INV_XCH_RT
, B.LOCL_CURR_CD
--, SUM(A.CHG_AMT) * MIN(A.INV_XCH_RT) LOCAL_TOTAL
, DECODE(INSTR(SUM(A.CHG_AMT) * MIN(A.INV_XCH_RT), '.'), 0, RPAD(TRIM(TO_CHAR(TRUNC(SUM(A.CHG_AMT) * MIN(A.INV_XCH_RT)), '999,999,999,999'))|| '.', LENGTH(TRIM(TO_CHAR(TRUNC(SUM(A.CHG_AMT) * MIN(A.INV_XCH_RT)), '999,999,999,999'))) + DECODE(D.DP_PRCS_KNT, 0, D.DP_PRCS_KNT, D.DP_PRCS_KNT + 1), '0')  
                                , RPAD(TRIM(TO_CHAR(TRUNC(SUM(A.CHG_AMT) * MIN(A.INV_XCH_RT)), '999,999,999,999'))|| '.' ||SUBSTR(SUM(A.CHG_AMT) * MIN(A.INV_XCH_RT), INSTR(SUM(A.CHG_AMT) * MIN(A.INV_XCH_RT), '.')+1, LENGTH(SUM(A.CHG_AMT) * MIN(A.INV_XCH_RT))), LENGTH(TRIM(TO_CHAR(TRUNC(SUM(A.CHG_AMT) * MIN(A.INV_XCH_RT)), '999,999,999,999'))) + DECODE(D.DP_PRCS_KNT, 0, D.DP_PRCS_KNT, D.DP_PRCS_KNT + 1), '0')) LOCAL_TOTAL
, C.DP_PRCS_KNT
, D.DP_PRCS_KNT
FROM INV_AR_CHG A
, INV_AR_MN B
, (SELECT CURR_CD
           , CURR_NM
           , DP_PRCS_KNT
        FROM MDM_CURRENCY
       WHERE NVL(TO_EFF_DT,SYSDATE) >= SYSDATE
         AND DELT_FLG!='Y'
       ORDER BY CURR_CD) C
, (SELECT EE.DP_PRCS_KNT
        , AA.OFC_CD
     FROM MDM_ORGANIZATION AA
        , MDM_CURRENCY EE
    WHERE AA.AR_CURR_CD = EE.CURR_CD) D      
WHERE A.AR_IF_NO = @[ar_if_no]
AND A.AR_IF_NO = B.AR_IF_NO
AND A.CURR_CD = C.CURR_CD
AND B.AR_OFC_CD = D.OFC_CD 
GROUP BY A.CURR_CD
, B.LOCL_CURR_CD
, C.DP_PRCS_KNT
, D.DP_PRCS_KNT			]]></sql>
			<params>
				<param name="ar_if_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
