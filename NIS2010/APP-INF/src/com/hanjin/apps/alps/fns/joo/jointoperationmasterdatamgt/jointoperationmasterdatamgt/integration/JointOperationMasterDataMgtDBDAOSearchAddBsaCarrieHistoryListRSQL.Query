<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JointOperationMasterDataMgtDBDAOSearchAddBsaCarrieHistoryListRSQL">
			<desc><![CDATA[SearchAddBsaCarrieHistoryList]]></desc>
			<sql><![CDATA[
SELECT  VVD_PORT, JO_CRR_CD, JO_CRR_CD,
        MAX(DECODE(RN#, 1, JO_ADD_CRR_CD )) JO_ADD_CRR_CD1,
        MAX(DECODE(RN#, 2, JO_ADD_CRR_CD )) JO_ADD_CRR_CD2,
        MAX(DECODE(RN#, 3, JO_ADD_CRR_CD )) JO_ADD_CRR_CD3,
        MAX(DECODE(RN#, 4, JO_ADD_CRR_CD )) JO_ADD_CRR_CD4,
        MAX(DECODE(RN#, 5, JO_ADD_CRR_CD )) JO_ADD_CRR_CD5,
        MAX(DECODE(RN#, 6, JO_ADD_CRR_CD )) JO_ADD_CRR_CD6,
        MAX(DECODE(RN#, 7, JO_ADD_CRR_CD )) JO_ADD_CRR_CD7,
        MAX(DECODE(RN#, 8, JO_ADD_CRR_CD )) JO_ADD_CRR_CD8,
        MAX(DECODE(RN#, 9, JO_ADD_CRR_CD )) JO_ADD_CRR_CD9,
        MAX(DECODE(RN#, 10, JO_ADD_CRR_CD )) JO_ADD_CRR_CD10,
        
        MAX(DECODE(RN#, 1, JO_ADD_CRR_CD )) OLD_JO_ADD_CRR_CD1,
        MAX(DECODE(RN#, 2, JO_ADD_CRR_CD )) OLD_JO_ADD_CRR_CD2,
        MAX(DECODE(RN#, 3, JO_ADD_CRR_CD )) OLD_JO_ADD_CRR_CD3,
        MAX(DECODE(RN#, 4, JO_ADD_CRR_CD )) OLD_JO_ADD_CRR_CD4,
        MAX(DECODE(RN#, 5, JO_ADD_CRR_CD )) OLD_JO_ADD_CRR_CD5,
        MAX(DECODE(RN#, 6, JO_ADD_CRR_CD )) OLD_JO_ADD_CRR_CD6,
        MAX(DECODE(RN#, 7, JO_ADD_CRR_CD )) OLD_JO_ADD_CRR_CD7,
        MAX(DECODE(RN#, 8, JO_ADD_CRR_CD )) OLD_JOADD__CRR_CD8,
        MAX(DECODE(RN#, 9, JO_ADD_CRR_CD )) OLD_JO_ADD_CRR_CD9,
        MAX(DECODE(RN#, 10, JO_ADD_CRR_CD )) OLD_JO_ADD_CRR_CD10,
                
        MAX(DECODE(RN#, 1, BSA )) BSA1,     
        MAX(DECODE(RN#, 2, BSA )) BSA2,
        MAX(DECODE(RN#, 3, BSA )) BSA3,
        MAX(DECODE(RN#, 4, BSA )) BSA4,
        MAX(DECODE(RN#, 5, BSA )) BSA5,
        MAX(DECODE(RN#, 6, BSA )) BSA6,
        MAX(DECODE(RN#, 7, BSA )) BSA7,
        MAX(DECODE(RN#, 8, BSA )) BSA8,
        MAX(DECODE(RN#, 9, BSA )) BSA9,
        MAX(DECODE(RN#, 10, BSA )) BSA10,

        MAX(DECODE(RN#, 1, 1 )) JO_BSA_ADD_REF_SEQ1,
        MAX(DECODE(RN#, 2, 2 )) JO_BSA_ADD_REF_SEQ2,
        MAX(DECODE(RN#, 3, 3 )) JO_BSA_ADD_REF_SEQ3,
        MAX(DECODE(RN#, 4, 4 )) JO_BSA_ADD_REF_SEQ4,
        MAX(DECODE(RN#, 5, 5 )) JO_BSA_ADD_REF_SEQ5,
        MAX(DECODE(RN#, 6, 6 )) JO_BSA_ADD_REF_SEQ6,
        MAX(DECODE(RN#, 7, 7 )) JO_BSA_ADD_REF_SEQ7,
        MAX(DECODE(RN#, 8, 8 )) JO_BSA_ADD_REF_SEQ8,
        MAX(DECODE(RN#, 9, 9 )) JO_BSA_ADD_REF_SEQ9,
        MAX(DECODE(RN#, 10, 10 )) JO_BSA_ADD_REF_SEQ10
    FROM ( 
          SELECT A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD||A.PORT_CD||A.PORT_SEQ||A.JO_CRR_CD VVD_PORT,  A.JO_CRR_CD, A.JO_BSA_TEU_QTY BSA, A.JO_ADD_CRR_CD,
              ROW_NUMBER() OVER( PARTITION BY A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD, A.PORT_CD, A.PORT_SEQ, A.JO_CRR_CD ORDER BY A.CRE_DT, A.JO_ADD_CRR_CD ) RN#
          FROM JOO_ADD_BSA_CRR A
          WHERE 1=1
            AND A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD||A.PORT_CD||A.PORT_SEQ||A.JO_CRR_CD =@[vvd_port]
          )
    GROUP BY VVD_PORT, JO_CRR_CD			]]></sql>
			<params>
				<param name="vvd_port" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
