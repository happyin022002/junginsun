<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableEDISendDBDAOsearchSamsungSendBLRSQL">
			<desc><![CDATA[Flate file작성시 사용할 실제 전송할 데이터 조회]]></desc>
			<sql><![CDATA[
#if (${rcrv_id} == 'FSELC') 
SELECT RPAD(A.SNDR_ID, 20, ' ')||RPAD(A.RCVR_ID, 20, ' ')||RPAD('FREINV', 10, ' ')||'INV'||TO_CHAR(SYSDATE, 'YYYYMMDDHHMMSS') HEADER,
  A.MSG_NO||B.BL_SRC_NO||TO_CHAR(SYSDATE, 'HH24MISS') MSG_NO,
  A.INV_MSG_FUNC_CD MSG_FUNC_CD,
  B.SR_INV_NO DOC_NO,
  TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')) DOC_DATE,
  A.BIL_DT BILLING_DATE,
  NVL(B.DIV_CTNT,' ') DIV_TY_CD,
  NVL(B.DIV_NM,' ') DIV_CD_DESC,
  A.MSG_NO||B.BL_SRC_NO||TO_CHAR(SYSDATE, 'HH24MISS') RLYDOC_MSG_NO,
  B.SR_INV_NO RLYDOC_DOC_NO,
  TO_CHAR(SYSDATE, 'YYYYMMDD') RLYDOC_DOC_DATE,
  ' ' RLYDOC_DOC_NO1,
  'SMLM'||B.BL_SRC_NO RLYDOC_DOC_NO2,
  (
    SELECT TO_CHAR(BL_OBRD_DT, 'YYYYMMDD')
    FROM BKG_BL_DOC
    WHERE BKG_NO = D.BKG_NO) ACTUAL_DATE,
  NVL(B.FCTRY_CTNT,' ') PLANT_CD,
  NVL(B.FCTRY_NM,' ') PLANT_DESC,
  NVL(A.EDI_HDR_RMK,' ') REMARK,
  'CA' CUSTOMER_TP_CD_CA,
  NVL(B.GERP_CRR_CTNT,' ') CUST_CD_CA,
  NVL(B.GERP_CRR_NM,' ') CUST_NAME_CA,
  'FW' CUSTOMER_TP_CD_FW,
  ' ' CUST_CD_FW,
  ' ' CUST_NAME_FW,
  'POR' LOC_TP_CD_POR,
  B.POR_CD LOC_CD_POR,
  L1.LOC_NM LOC_NAME_POR,
  L1.CNT_CD LOC_CNT_CD_POR,
  C1.CNT_NM LOC_CNT_NAME_POR,
  'POL' LOC_TP_CD_POL,
  B.POL_CD LOC_CD_POL,
  L2.LOC_NM LOC_NAME_POL,
  L2.CNT_CD LOC_CNT_CD_POL,
  C2.CNT_NM LOC_CNT_NAME_POL,
  'POD' LOC_TP_CD_POD,
  B.POD_CD LOC_CD_POD,
  L3.LOC_NM LOC_NAME_POD,
  L3.CNT_CD LOC_CNT_CD_POD,
  C3.CNT_NM LOC_CNT_NAME_POD,
  'DEL' LOC_TP_CD_DEL,
  B.DEL_CD LOC_CD_DEL,
  L4.LOC_NM LOC_NAME_DEL,
  L4.CNT_CD LOC_CNT_CD_DEL,
  C4.CNT_NM LOC_CNT_NAME_DEL,
  'T001' CS_MEA_CD,
  B.GRS_CNTR_WGT MEA_QTY,
  'KG' MEA_CD,
  B.MSG_ID MSG_ID_BL,
  B.MSG_NO MSG_NO_BL,
  B.BL_LINE_NO BL_LINE_NO_BL,
  B.BL_SRC_NO BL_SRC_NO_BL
FROM INV_AR_EDI_GERP_HDR A,
  INV_AR_EDI_GERP_BL B,
  INV_AR_MN D,
  MDM_LOCATION L1,
  MDM_COUNTRY C1,
  MDM_LOCATION L2,
  MDM_COUNTRY C2,
  MDM_LOCATION L3,
  MDM_COUNTRY C3,
  MDM_LOCATION L4,
  MDM_COUNTRY C4
WHERE A.MSG_ID = B.MSG_ID
  AND A.MSG_NO = B.MSG_NO
  AND B.BL_SRC_NO = D.BL_SRC_NO
  AND A.CUST_CNT_CD = D.ACT_CUST_CNT_CD
  AND A.CUST_SEQ = D.ACT_CUST_SEQ
  AND L1.LOC_CD = B.POR_CD
  AND L1.CNT_CD = C1.CNT_CD
  AND L2.LOC_CD = B.POL_CD
  AND L2.CNT_CD = C2.CNT_CD
  AND L3.LOC_CD = B.POD_CD
  AND L3.CNT_CD = C3.CNT_CD
  AND L4.LOC_CD = B.DEL_CD
  AND L4.CNT_CD = C4.CNT_CD
  AND A.MSG_ID = @[msg_id]
  AND A.MSG_NO = @[msg_no]
  AND B.BL_SRC_NO = @[bl_src_no]
#else 
SELECT RPAD(A.SNDR_ID, 20, ' ')||RPAD(A.RCVR_ID, 20, ' ')||RPAD('FREINV', 10, ' ')||'INV'||TO_CHAR(SYSDATE, 'YYYYMMDDHHMMSS') HEADER,
  A.MSG_NO||B.BL_SRC_NO||TO_CHAR(SYSDATE, 'HH24MISS') MSG_NO,
  A.INV_MSG_FUNC_CD MSG_FUNC_CD,
  B.SR_INV_NO DOC_NO,
  TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')) DOC_DATE,
  A.BIL_DT BILLING_DATE,
  NVL(B.DIV_CTNT,' ') DIV_TY_CD,
  NVL(B.DIV_NM,' ') DIV_CD_DESC,
  NVL(( SELECT /*+ INDEX_DESC( A XPKBKG_REFERENCE ) */
               SUBSTR(CUST_REF_NO_CTNT ,1,50)
        FROM BKG_REFERENCE  A
        WHERE BKG_NO = D.BKG_NO 
        AND BKG_REF_TP_CD = 'SAMF' 
        AND ROWNUM = 1
  ),' ') RLYDOC_MSG_NO,
  'SMLM'||B.BL_SRC_NO RLYDOC_DOC_NO,
  ' ' RLYDOC_DOC_DATE,
  ' ' RLYDOC_DOC_NO1,
  'SMLM'||B.BL_SRC_NO RLYDOC_DOC_NO2,
  (
    SELECT TO_CHAR(BL_OBRD_DT, 'YYYYMMDD')
    FROM BKG_BL_DOC
    WHERE BKG_NO = D.BKG_NO) ACTUAL_DATE,
  NVL(B.FCTRY_CTNT,' ') PLANT_CD,
  NVL(B.FCTRY_NM,' ') PLANT_DESC,
  NVL(A.EDI_HDR_RMK,' ') REMARK,
  'CA' CUSTOMER_TP_CD_CA,
  NVL(B.GERP_CRR_CTNT,' ') CUST_CD_CA,
  NVL(B.GERP_CRR_NM,' ') CUST_NAME_CA,
  'FW' CUSTOMER_TP_CD_FW,
  ' ' CUST_CD_FW,
  ' ' CUST_NAME_FW,
  'POR' LOC_TP_CD_POR,
  B.POR_CD LOC_CD_POR,
  L1.LOC_NM LOC_NAME_POR,
  L1.CNT_CD LOC_CNT_CD_POR,
  C1.CNT_NM LOC_CNT_NAME_POR,
  'POL' LOC_TP_CD_POL,
  B.POL_CD LOC_CD_POL,
  L2.LOC_NM LOC_NAME_POL,
  L2.CNT_CD LOC_CNT_CD_POL,
  C2.CNT_NM LOC_CNT_NAME_POL,
  'POD' LOC_TP_CD_POD,
  B.POD_CD LOC_CD_POD,
  L3.LOC_NM LOC_NAME_POD,
  L3.CNT_CD LOC_CNT_CD_POD,
  C3.CNT_NM LOC_CNT_NAME_POD,
  'DEL' LOC_TP_CD_DEL,
  B.DEL_CD LOC_CD_DEL,
  L4.LOC_NM LOC_NAME_DEL,
  L4.CNT_CD LOC_CNT_CD_DEL,
  C4.CNT_NM LOC_CNT_NAME_DEL,
  'T001' CS_MEA_CD,
  B.GRS_CNTR_WGT MEA_QTY,
  'KG' MEA_CD,
  B.MSG_ID MSG_ID_BL,
  B.MSG_NO MSG_NO_BL,
  B.BL_LINE_NO BL_LINE_NO_BL,
  B.BL_SRC_NO BL_SRC_NO_BL
FROM INV_AR_EDI_GERP_HDR A,
  INV_AR_EDI_GERP_BL B,
  INV_AR_MN D,
  MDM_LOCATION L1,
  MDM_COUNTRY C1,
  MDM_LOCATION L2,
  MDM_COUNTRY C2,
  MDM_LOCATION L3,
  MDM_COUNTRY C3,
  MDM_LOCATION L4,
  MDM_COUNTRY C4
WHERE A.MSG_ID = B.MSG_ID
  AND A.MSG_NO = B.MSG_NO
  AND B.BL_SRC_NO = D.BL_SRC_NO
  AND A.CUST_CNT_CD = D.ACT_CUST_CNT_CD
  AND A.CUST_SEQ = D.ACT_CUST_SEQ
  AND L1.LOC_CD = B.POR_CD
  AND L1.CNT_CD = C1.CNT_CD
  AND L2.LOC_CD = B.POL_CD
  AND L2.CNT_CD = C2.CNT_CD
  AND L3.LOC_CD = B.POD_CD
  AND L3.CNT_CD = C3.CNT_CD
  AND L4.LOC_CD = B.DEL_CD
  AND L4.CNT_CD = C4.CNT_CD
  AND A.MSG_ID = @[msg_id]
  AND A.MSG_NO = @[msg_no]
  AND B.BL_SRC_NO = @[bl_src_no]
#end			]]></sql>
			<params>
				<param name="msg_id" type="12" value="" out="N"/>
				<param name="msg_no" type="12" value="" out="N"/>
				<param name="bl_src_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
