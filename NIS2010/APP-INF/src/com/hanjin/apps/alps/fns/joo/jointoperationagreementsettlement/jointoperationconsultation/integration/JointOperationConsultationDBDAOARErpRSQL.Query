<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JointOperationConsultationDBDAOARErpRSQL">
			<desc><![CDATA[AR Data ERP Interface inquiry   ]]></desc>
			<sql><![CDATA[
select
       a.slp_no,
       a.iss_dt,
       a.sail_dt,
       a.due_dt,
       a.rlane_cd,
       a.rev_vsl_cd||a.rev_skd_voy_no||a.rev_skd_dir_cd||a.rev_dir_cd as vvd,
       a.locl_amt,
       a.jo_bl_no as bl_no,
       a.act_cust_cnt_cd||lpad(act_cust_seq,6,'0') as cust_seq,
       a.por_cd,
       a.csr_offst_no,
       decode(a.erp_if_flg,'Y','Success','E','Fail','Sending...') as erp_if_flg
from   joo_ar_mn a,
-- 2010.02.17 I/F error시 reject하면 Combined 단까지 삭제한다 => Error 리스트에 나오지 말아야 하므로 join을 건다. 
       joo_csr   b 
where  a.slp_no = B.SLP_TP_CD||B.SLP_FUNC_CD||B.SLP_OFC_CD||TO_CHAR(TO_DATE(B.SLP_ISS_DT,'YYYYMMDD'),'RRMMDD')||B.SLP_SER_NO
and    a.AR_IF_NO like 'JOO%'
#if(${erp_if_flg} != '')
and    a.erp_if_flg = @[erp_if_flg]
#end
#if(${dt_flg}=='0')
and    a.iss_dt >= @[iss_dt_fr]
and    a.iss_dt <= @[iss_dt_to]
#elseif(${dt_flg}=='1') 
and    a.gl_dt >= @[iss_dt_fr]
and    a.gl_dt <= @[iss_dt_to]
#end
order by 2			]]></sql>
			<params>
				<param name="erp_if_flg" type="12" value="" out="N"/>
				<param name="iss_dt_fr" type="12" value="" out="N"/>
				<param name="iss_dt_to" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
