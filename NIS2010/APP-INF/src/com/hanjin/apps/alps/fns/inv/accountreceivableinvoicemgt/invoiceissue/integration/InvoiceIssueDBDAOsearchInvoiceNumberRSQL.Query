<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceIssueDBDAOsearchInvoiceNumberRSQL">
			<desc><![CDATA[select]]></desc>
			<sql><![CDATA[
#if (${ofc_cd} == 'VLCSC') 

    SELECT A.INV_PFX_CD
         , NVL(A.INV_MAX_SEQ, 0) + 1 INV_MAX_SEQ
         , A.INV_PFX_CD||LPAD(NVL(A.INV_MAX_SEQ, 0) + 1, 7, '0') INV_NO
      FROM INV_AR_ISS_NO A
         , (SELECT INV_PFX_CD 
              FROM MDM_ORGANIZATION
             WHERE OFC_CD = (SELECT OFC_CD
                               FROM COM_USER
                              WHERE USR_ID = @[user_id])
               AND NVL(DELT_FLG, 'N') <> 'Y') B
     WHERE A.INV_PFX_CD(+) = B.INV_PFX_CD
       FOR UPDATE NOWAIT

#else 

    SELECT B.INV_PFX_CD
         , NVL(A.INV_MAX_SEQ, 0) + 1 INV_MAX_SEQ
         , B.INV_PFX_CD||LPAD(NVL(A.INV_MAX_SEQ, 0) + 1, 7, '0') INV_NO
      FROM INV_AR_ISS_NO A
         , (SELECT INV_PFX_CD 
              FROM MDM_ORGANIZATION
             WHERE OFC_CD = @[ofc_cd]
               AND NVL(DELT_FLG, 'N') <> 'Y') B
     WHERE A.INV_PFX_CD(+) = B.INV_PFX_CD
       FOR UPDATE NOWAIT

#end			]]></sql>
			<params>
				<param name="user_id" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
