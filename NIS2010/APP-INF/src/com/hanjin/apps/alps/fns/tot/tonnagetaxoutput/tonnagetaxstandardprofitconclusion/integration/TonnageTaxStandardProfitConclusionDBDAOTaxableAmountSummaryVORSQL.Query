<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TonnageTaxStandardProfitConclusionDBDAOTaxableAmountSummaryVORSQL">
			<desc><![CDATA[Taxable Amount Summary 조회]]></desc>
			<sql><![CDATA[
SELECT   A.VSL_CD
	      ,A.NRT_WGT
	      ,A.BSA_CAPA
	      ,A.ACT_BSA_CAPA
	      ,A.USG_RT
	      ,A.FM_VVD_STL_DT
	      ,A.TO_VVD_STL_DT
	      ,A.NRT_TONG_TAX_AMT
	      ,A.TONG_TAX_AMT
	      ,A.STL_YRMON
	      ,A.TONG_STL_BAT_JB_SEQ
	      ,A.LDB_CAPA_QTY
	      ,A.PER_TON_REV
	      ,A.TONG_FLET_TP_CD
	      ,A.VOY_DYS
	      ,A.VSL_DZND_CAPA
	      ,A.CHTR_BSA_CAPA
	      ,A.VVD_EXIST_YN

FROM (
				SELECT VSL_CD
				      ,NRT_WGT
				      ,NVL(BSA_CAPA,0) BSA_CAPA
				      ,ACT_BSA_CAPA
				      ,USG_RT
				      ,NVL(TO_CHAR(FM_VVD_STL_DT, 'YYYYMMDD'),'')   FM_VVD_STL_DT
				      ,NVL(TO_CHAR(TO_VVD_STL_DT, 'YYYYMMDD'),'')   TO_VVD_STL_DT
				      ,NRT_TONG_TAX_AMT
				      ,TONG_TAX_AMT
				      ,STL_YRMON
				      ,TONG_STL_BAT_JB_SEQ
				      ,LDB_CAPA_QTY
				      ,PER_TON_REV
				      ,TONG_FLET_TP_CD
				      ,VOY_DYS
				      ,VSL_DZND_CAPA
				      ,CHTR_BSA_CAPA
				      ,@[vvd_exist_yn]  VVD_EXIST_YN
				FROM TOT_VVD_STL_AMT
				WHERE STL_YRMON = @[stl_yrmon]
				  AND TONG_FLET_TP_CD = 'F'
				  AND TONG_STL_BAT_JB_SEQ = (SELECT MAX(TONG_STL_BAT_JB_SEQ) FROM TOT_VVD_STL_AMT WHERE STL_YRMON = @[stl_yrmon]  AND TONG_FLET_TP_CD = 'F') 
				  AND 'Y'= @[vvd_exist_yn]
				UNION ALL
				SELECT 
				      DECODE(VOY_DYS,  1, 'SP01',  2, 'SP02',  3, 'SP03',  4, 'SP04',  5, 'SP05',  6, 'SP06',
				                                  7, 'SP07',  8, 'SP08',  9, 'SP09', 10, 'SP10', 11, 'SP11', 12, 'SP12',
				                                 13, 'SP13', 14, 'SP14', 15, 'SP15', 16, 'SP16', 17, 'SP17', 18, 'SP18') VSL_CD
				,NVL(MAX(NRT_WGT), 1276)                     NRT_WGT
				,0                                           BSA_CAPA
				,ROUND(NVL(SUM(ACT_BSA_CAPA),0),0)           ACT_BSA_CAPA
				,MAX(USG_RT)                           USG_RT
				,DECODE(VOY_DYS, NULL, '', @[stl_yrmon]||'01')                                                             FM_VVD_STL_DT
				,DECODE(VOY_DYS, NULL, '', TO_CHAR(TO_DATE(@[stl_yrmon]||'01','YYYYMMDD') + VOY_DYS, 'YYYYMMDD'))          TO_VVD_STL_DT
				,NVL(SUM(NRT_TONG_TAX_AMT),0)                NRT_TONG_TAX_AMT
				,NVL(SUM(TONG_TAX_AMT),0)                    TONG_TAX_AMT
				,MAX(STL_YRMON)                              STL_YRMON
				,MAX(TONG_STL_BAT_JB_SEQ)                    TONG_STL_BAT_JB_SEQ
				,MAX(LDB_CAPA_QTY)                           LDB_CAPA_QTY
				,MAX(PER_TON_REV)                            PER_TON_REV
				,'F'                                         TONG_FLET_TP_CD
				,SUM(VOY_DYS)                                VOY_DYS
				,0                                           VSL_DZND_CAPA
				,0                                           CHTR_BSA_CAPA
				,'N'                                         VVD_EXIST_YN
				FROM TOT_FDR_STL_AMT
				WHERE STL_YRMON = @[stl_yrmon]
				AND TONG_STL_BAT_JB_SEQ = (SELECT MAX(TONG_STL_BAT_JB_SEQ) FROM TOT_FDR_STL_AMT WHERE STL_YRMON = @[stl_yrmon])
				AND VOY_DYS BETWEEN 1 AND 18
				AND 'N'= @[vvd_exist_yn]
				GROUP BY VOY_DYS
      ) A
ORDER BY A.VSL_CD			]]></sql>
			<params>
				<param name="vvd_exist_yn" type="12" value="" out="N"/>
				<param name="stl_yrmon" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
