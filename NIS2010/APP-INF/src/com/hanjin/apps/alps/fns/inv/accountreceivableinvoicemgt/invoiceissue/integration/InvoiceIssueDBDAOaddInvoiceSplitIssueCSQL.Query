<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceIssueDBDAOaddInvoiceSplitIssueCSQL">
			<desc><![CDATA[addInvoiceSplitIssue]]></desc>
			<sql><![CDATA[
INSERT INTO INV_AR_SPLIT_ISS
(
  INV_NO
, INV_SEQ
, AR_OFC_CD
, ACT_CUST_CNT_CD
, ACT_CUST_SEQ
, AR_IF_NO
, INV_RMK
, INV_REF_NO
, HJS_STF_CTNT
, ISS_DT
, BL_SRC_NO
, BKG_NO
, CRE_USR_ID
, CRE_DT
, UPD_USR_ID
, UPD_DT
, INV_SPLIT_ISS_WRK_NO
, BANK_ACCT_PRN_OPT_CD
, DUE_DT
, SAIL_ARR_DT
-- 2018.05.16 인도지역 Split Invoice Issue 기능 보완 
, IDA_STE_CD
, IDA_PAN_NO
, IDA_GST_RGST_NO
, IDA_SPCL_ECN_ZN_UT_FLG
, IDA_GST_DIV_CD
, IDA_ISS_TP_CD
, IDA_ISS_OFC_CD
)
VALUES
(
  @[inv_no]
, NVL(@[inv_seq],1)
, @[ar_ofc_cd]
, @[act_cust_cnt_cd]
, @[act_cust_seq]
, @[ar_if_no]
, @[inv_rmk]
, @[inv_ref_no]
, @[hjs_stf_ctnt]
, TO_CHAR(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[ar_ofc_cd]), 'YYYYMMDD')  
, @[bl_src_no]
, NVL(@[bkg_no],@[bl_src_no])
, @[user_id]
, SYSDATE
, @[user_id]
, SYSDATE
, @[inv_split_iss_wrk_no]
#if (${ar_ofc_cd} == 'SAOSC') 
, @[bank_acct_prn_opt_cd]
#else 
, 'A'
#end
, REPLACE(@[due_dt],'-','')
, REPLACE(@[sail_arr_dt],'-','')
-- 2018.05.16 인도지역 Split Invoice Issue 기능 보완 
,(DECODE(@[ar_ofc_cd], 'BOMSC', (SELECT C.IDA_STE_CD 
                                 FROM MDM_CUSTOMER A,
                                      MDM_LOCATION B,
                                      MDM_STATE C
                                 WHERE A.LOC_CD = B.LOC_CD
                                 AND B.CNT_CD = C.CNT_CD
                                 AND B.STE_CD = C.STE_CD
                                 AND A.CUST_CNT_CD = @[act_cust_cnt_cd] 
                                 AND A.CUST_SEQ = @[act_cust_seq]), ''))
,(DECODE(@[ar_ofc_cd], 'BOMSC', (SELECT IDA_PAN_NO FROM MDM_CUSTOMER WHERE CUST_CNT_CD = @[act_cust_cnt_cd] AND CUST_SEQ = @[act_cust_seq]), ''))
,(DECODE(@[ar_ofc_cd], 'BOMSC', (SELECT IDA_GST_RGST_NO FROM MDM_CUSTOMER WHERE CUST_CNT_CD = @[act_cust_cnt_cd] AND CUST_SEQ = @[act_cust_seq]), ''))
,(DECODE(@[ar_ofc_cd], 'BOMSC', (SELECT IDA_SPCL_ECN_ZN_UT_FLG FROM MDM_CUSTOMER WHERE CUST_CNT_CD = @[act_cust_cnt_cd] AND CUST_SEQ = @[act_cust_seq]), ''))
,(DECODE(@[ar_ofc_cd], 'BOMSC', (SELECT INV_GET_GST_DIV_CD_FNC(@[ida_iss_ofc_cd], 'C', @[act_cust_cnt_cd], @[act_cust_seq], '', DECODE(IO_BND_CD, 'O', POR_CD, DEL_CD))
                                 FROM INV_AR_MN
                                 WHERE AR_IF_NO = @[ar_if_no]), ''))
,(DECODE(@[ar_ofc_cd], 'BOMSC', @[ida_iss_tp_cd], ''))
,(DECODE(@[ar_ofc_cd], 'BOMSC', @[ida_iss_ofc_cd], ''))
)			]]></sql>
			<params>
				<param name="inv_no" type="12" value="" out="N"/>
				<param name="inv_seq" type="12" value="" out="N"/>
				<param name="ar_ofc_cd" type="12" value="" out="N"/>
				<param name="act_cust_cnt_cd" type="12" value="" out="N"/>
				<param name="act_cust_seq" type="12" value="" out="N"/>
				<param name="ar_if_no" type="12" value="" out="N"/>
				<param name="inv_rmk" type="12" value="" out="N"/>
				<param name="inv_ref_no" type="12" value="" out="N"/>
				<param name="hjs_stf_ctnt" type="12" value="" out="N"/>
				<param name="bl_src_no" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="user_id" type="12" value="" out="N"/>
				<param name="inv_split_iss_wrk_no" type="12" value="" out="N"/>
				<param name="bank_acct_prn_opt_cd" type="12" value="" out="N"/>
				<param name="due_dt" type="12" value="" out="N"/>
				<param name="sail_arr_dt" type="12" value="" out="N"/>
				<param name="ida_iss_ofc_cd" type="12" value="" out="N"/>
				<param name="ida_iss_tp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
