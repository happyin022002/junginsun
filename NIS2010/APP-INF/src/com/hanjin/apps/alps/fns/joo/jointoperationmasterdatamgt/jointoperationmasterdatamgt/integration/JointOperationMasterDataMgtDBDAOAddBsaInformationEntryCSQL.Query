<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JointOperationMasterDataMgtDBDAOAddBsaInformationEntryCSQL">
			<desc><![CDATA[AddBsaInformationEntry
1. 2013.02.07 이수진 [CHM-201322641] BSA Enmtry 기능 추가
   - 	JO_PRC_FSH_FLG 항목 추가

2. 2013.02.22 이수진 [CHM-201322641] BSA Enmtry 기능 추가
   - Add BSA 값이 0인 경우에 Add BSA Carrier Flag를 'N'으로 저장되도록 로직 변경

3. 2016.03.15 박정민 [CHM-201640491] JO Revenue Loading Information 기능 보완 건
   - INSERT 모듈 MERGE문으로 교체]]></desc>
			<sql><![CDATA[
MERGE INTO JOO_BSA_AGMT A
USING (
    SELECT @[trd_cd] AS  TRD_CD
         , @[rlane_cd] AS  RLANE_CD
         , @[vsl_cd] AS  VSL_CD
         , @[skd_voy_no] AS  SKD_VOY_NO
         , @[skd_dir_cd] AS  SKD_DIR_CD
         , @[port_cd] AS  PORT_CD
         , @[port_seq] AS  PORT_SEQ
         , @[jo_crr_cd] AS JO_CRR_CD
      FROM DUAL
) B
 ON
(
    A.TRD_CD = B.TRD_CD
AND A.RLANE_CD = B.RLANE_CD
AND A.VSL_CD = B.VSL_CD
AND A.SKD_VOY_NO = B.SKD_VOY_NO
AND A.SKD_DIR_CD = B.SKD_DIR_CD
AND A.PORT_CD = B.PORT_CD
AND A.PORT_SEQ = B.PORT_SEQ
AND A.JO_CRR_CD = B.JO_CRR_CD
)
WHEN MATCHED THEN
     UPDATE 
        SET OFC_CD = @[ofc_cd]
          , RE_DIVR_CD = @[re_divr_cd]
          , JO_BSA_TEU_QTY = @[jo_bsa_teu_qty]
          , JO_BSA_ADD_TEU_QTY = @[jo_bsa_add_teu_qty]
          , JO_ADD_BSA_CRR_FLG = decode(@[jo_bsa_add_teu_qty],0,'N',@[jo_add_bsa_crr_flg])
          , JO_OVR_BSA_TEU_QTY = @[jo_ovr_bsa_teu_qty]
          , JO_TON_TEU_QTY = @[jo_ton_teu_qty]
          , JO_OVR_TON_WGT = @[jo_ovr_ton_wgt]
          , JO_20FT_SUB_TEU_QTY = @[jo_20ft_sub_teu_qty]
          , JO_20FT_OVR_RTO = @[jo_20ft_ovr_rto]
          , JO_40FT_SUB_TEU_QTY = @[jo_40ft_sub_teu_qty]
          , JO_40FT_OVR_RTO = @[jo_40ft_ovr_rto]
          , JO_45FT_SUB_TEU_QTY = @[jo_45ft_sub_teu_qty]
          , JO_45FT_OVR_RTO = @[jo_45ft_ovr_rto]
          , JO_45FT_UND_RTO = @[jo_45ft_und_rto]
          , JO_RF_OCN_TEU_QTY = @[jo_rf_ocn_teu_qty]
          , JO_RF_INTER_TEU_QTY = @[jo_rf_inter_teu_qty]
          , JO_RND_KND_FLG = @[jo_rnd_knd_flg]
          , JO_RND_RULE_LVL = @[jo_rnd_rule_lvl]
          , JO_INTER_OVR_FLG = @[jo_inter_ovr_flg]
          , JO_RDR_PORT_CD = @[jo_rdr_port_cd]
          , JO_FSH_FLG = @[jo_fsh_flg]
          , JO_BSA_PRC = @[jo_bsa_prc]
          , JO_OVR_OCN_PRC = @[jo_ovr_ocn_prc]
          , JO_OVR_INTER_PRC = @[jo_ovr_inter_prc]
          , JO_OVR_MT_OCN_PRC = @[jo_ovr_mt_ocn_prc]
          , JO_OVR_MT_INTER_PRC = @[jo_ovr_mt_inter_prc]
          , JO_SCTR_PRC_FLG = @[jo_sctr_prc_flg]
          , JO_RF_OCN_PRC = @[jo_rf_ocn_prc]
          , JO_RF_INTER_PRC = @[jo_rf_inter_prc]
          , JO_PRC_FSH_FLG = @[jo_prc_fsh_flg]
          , YRWK = @[yrwk]
          , REV_PORT_ETD_DT = @[rev_port_etd_dt]
          , JO_BSA_ENTR_RMK = @[jo_bsa_entr_rmk]
          , JO_BSA_ENTR_RDR_RMK = @[jo_bsa_entr_rdr_rmk]
          , DELT_FLG = @[delt_flg]
          , CRE_DT = SYSDATE
          , CRE_USR_ID = @[upd_usr_id]
          , UPD_DT = SYSDATE
          , UPD_USR_ID = @[upd_usr_id]
WHEN NOT MATCHED THEN
     INSERT
     (
          TRD_CD
        , RLANE_CD
        , VSL_CD
        , SKD_VOY_NO
        , SKD_DIR_CD
        , PORT_CD
        , PORT_SEQ
        , OFC_CD
        , RE_DIVR_CD
        , JO_CRR_CD
        , JO_BSA_TEU_QTY
        , JO_BSA_ADD_TEU_QTY
        , JO_ADD_BSA_CRR_FLG
        , JO_OVR_BSA_TEU_QTY
        , JO_TON_TEU_QTY
        , JO_OVR_TON_WGT
        , JO_20FT_SUB_TEU_QTY
        , JO_20FT_OVR_RTO
        , JO_40FT_SUB_TEU_QTY
        , JO_40FT_OVR_RTO
        , JO_45FT_SUB_TEU_QTY
        , JO_45FT_OVR_RTO
        , JO_45FT_UND_RTO
        , JO_RF_OCN_TEU_QTY
        , JO_RF_INTER_TEU_QTY
        , JO_RND_KND_FLG
        , JO_RND_RULE_LVL
        , JO_INTER_OVR_FLG
        , JO_RDR_PORT_CD
        , JO_FSH_FLG
        , JO_BSA_PRC
        , JO_OVR_OCN_PRC
        , JO_OVR_INTER_PRC
        , JO_OVR_MT_OCN_PRC
        , JO_OVR_MT_INTER_PRC
        , JO_SCTR_PRC_FLG
        , JO_RF_OCN_PRC
        , JO_RF_INTER_PRC
        , JO_PRC_FSH_FLG
        , YRWK
        , REV_PORT_ETD_DT
        , JO_BSA_ENTR_RMK
        , JO_BSA_ENTR_RDR_RMK
        , DELT_FLG
        , CRE_DT
        , CRE_USR_ID
        , UPD_DT
        , UPD_USR_ID     
     )
     VALUES
     (
          @[trd_cd]
        , @[rlane_cd]
        , @[vsl_cd]
        , @[skd_voy_no]
        , @[skd_dir_cd]
        , @[port_cd]
        , @[port_seq]
        , @[ofc_cd]
        , @[re_divr_cd]
        , @[jo_crr_cd]
        , @[jo_bsa_teu_qty]
        , @[jo_bsa_add_teu_qty]
        , decode(@[jo_bsa_add_teu_qty],0,'N',@[jo_add_bsa_crr_flg])
        , @[jo_ovr_bsa_teu_qty]
        , @[jo_ton_teu_qty]
        , @[jo_ovr_ton_wgt]
        , @[jo_20ft_sub_teu_qty]
        , @[jo_20ft_ovr_rto]
        , @[jo_40ft_sub_teu_qty]
        , @[jo_40ft_ovr_rto]
        , @[jo_45ft_sub_teu_qty]
        , @[jo_45ft_ovr_rto]
        , @[jo_45ft_und_rto]
        , @[jo_rf_ocn_teu_qty]
        , @[jo_rf_inter_teu_qty]
        , @[jo_rnd_knd_flg]
        , @[jo_rnd_rule_lvl]
        , @[jo_inter_ovr_flg]
        , @[jo_rdr_port_cd]
        , @[jo_fsh_flg]
        , @[jo_bsa_prc]
        , @[jo_ovr_ocn_prc]
        , @[jo_ovr_inter_prc]
        , @[jo_ovr_mt_ocn_prc]
        , @[jo_ovr_mt_inter_prc]
        , @[jo_sctr_prc_flg]
        , @[jo_rf_ocn_prc]
        , @[jo_rf_inter_prc]
        , @[jo_prc_fsh_flg]
        , @[yrwk]
        , @[rev_port_etd_dt]
        , @[jo_bsa_entr_rmk]
        , @[jo_bsa_entr_rdr_rmk]
        , @[delt_flg]
        , SYSDATE
        , @[upd_usr_id]
        , SYSDATE
        , @[upd_usr_id]
     )
			]]></sql>
			<params>
				<param name="trd_cd" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="port_cd" type="12" value="" out="N"/>
				<param name="port_seq" type="12" value="" out="N"/>
				<param name="jo_crr_cd" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="re_divr_cd" type="12" value="" out="N"/>
				<param name="jo_bsa_teu_qty" type="12" value="" out="N"/>
				<param name="jo_bsa_add_teu_qty" type="12" value="" out="N"/>
				<param name="jo_add_bsa_crr_flg" type="12" value="" out="N"/>
				<param name="jo_ovr_bsa_teu_qty" type="12" value="" out="N"/>
				<param name="jo_ton_teu_qty" type="12" value="" out="N"/>
				<param name="jo_ovr_ton_wgt" type="12" value="" out="N"/>
				<param name="jo_20ft_sub_teu_qty" type="12" value="" out="N"/>
				<param name="jo_20ft_ovr_rto" type="12" value="" out="N"/>
				<param name="jo_40ft_sub_teu_qty" type="12" value="" out="N"/>
				<param name="jo_40ft_ovr_rto" type="12" value="" out="N"/>
				<param name="jo_45ft_sub_teu_qty" type="12" value="" out="N"/>
				<param name="jo_45ft_ovr_rto" type="12" value="" out="N"/>
				<param name="jo_45ft_und_rto" type="12" value="" out="N"/>
				<param name="jo_rf_ocn_teu_qty" type="12" value="" out="N"/>
				<param name="jo_rf_inter_teu_qty" type="12" value="" out="N"/>
				<param name="jo_rnd_knd_flg" type="12" value="" out="N"/>
				<param name="jo_rnd_rule_lvl" type="12" value="" out="N"/>
				<param name="jo_inter_ovr_flg" type="12" value="" out="N"/>
				<param name="jo_rdr_port_cd" type="12" value="" out="N"/>
				<param name="jo_fsh_flg" type="12" value="" out="N"/>
				<param name="jo_bsa_prc" type="12" value="" out="N"/>
				<param name="jo_ovr_ocn_prc" type="12" value="" out="N"/>
				<param name="jo_ovr_inter_prc" type="12" value="" out="N"/>
				<param name="jo_ovr_mt_ocn_prc" type="12" value="" out="N"/>
				<param name="jo_ovr_mt_inter_prc" type="12" value="" out="N"/>
				<param name="jo_sctr_prc_flg" type="12" value="" out="N"/>
				<param name="jo_rf_ocn_prc" type="12" value="" out="N"/>
				<param name="jo_rf_inter_prc" type="12" value="" out="N"/>
				<param name="jo_prc_fsh_flg" type="12" value="" out="N"/>
				<param name="yrwk" type="12" value="" out="N"/>
				<param name="rev_port_etd_dt" type="12" value="" out="N"/>
				<param name="jo_bsa_entr_rmk" type="12" value="" out="N"/>
				<param name="jo_bsa_entr_rdr_rmk" type="12" value="" out="N"/>
				<param name="delt_flg" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
