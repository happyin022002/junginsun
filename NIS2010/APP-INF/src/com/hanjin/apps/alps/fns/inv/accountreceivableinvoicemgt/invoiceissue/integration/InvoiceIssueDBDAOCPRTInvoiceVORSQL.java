/*=========================================================
*Copyright(c) 2017 CyberLogitec
*@FileName : InvoiceIssueDBDAOCPRTInvoiceVORSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2017.01.24
*@LastModifier : 
*@LastVersion : 1.0
* 2017.01.24 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.fns.inv.accountreceivableinvoicemgt.invoiceissue.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class InvoiceIssueDBDAOCPRTInvoiceVORSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  *    
	  * </pre>
	  */
	public InvoiceIssueDBDAOCPRTInvoiceVORSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("frt_term_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ar_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ob_sls_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_seq",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pol_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("from_date",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rpt_tmplt_nm",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("del_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("por_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sc_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pod_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_date",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("bkg_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_cnt_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rfa_no",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.fns.inv.accountreceivableinvoicemgt.invoiceissue.integration").append("\n"); 
		query.append("FileName : InvoiceIssueDBDAOCPRTInvoiceVORSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT	RPT_TMPLT_NM, FRT_TERM_CD" ).append("\n"); 
		query.append("#foreach( ${key} in ${allcols}) " ).append("\n"); 
		query.append("	#if($key == 'INV004'||$key == 'INV008'||$key == 'INV047'||$key == 'INV062'||$key == 'INV064'||$key == 'INV066'||$key == 'INV067'||$key == 'INV068'||$key == 'INV080')" ).append("\n"); 
		query.append("	,MAX($key) $key	" ).append("\n"); 
		query.append("	#elseif($key == 'INV074'||$key == 'INV075'||$key == 'INV102'||$key == 'INV106'||$key == 'INV107'||$key == 'INV112'|| $key == 'INV131'||$key == 'INV141')" ).append("\n"); 
		query.append("	,MAX($key) $key	" ).append("\n"); 
		query.append("	#elseif($key == 'CHG001'||$key == 'CHG002'||$key == 'CHG003'||$key == 'CHG004'||$key == 'CHG005'||$key == 'CHG999') " ).append("\n"); 
		query.append("		,''" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        ,$key " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#foreach( ${key} in ${allcols})" ).append("\n"); 
		query.append(" #if( $key == 'CHG001'||$key == 'CHG002'||$key == 'CHG003'||$key == 'CHG004'||$key == 'CHG005'||$key == 'CHG999') " ).append("\n"); 
		query.append(" ,(DECODE (0" ).append("\n"); 
		query.append("   #foreach( ${key} in ${allcols})" ).append("\n"); 
		query.append("      #if($key == 'INV069')" ).append("\n"); 
		query.append("         +1" ).append("\n"); 
		query.append("      #else" ).append("\n"); 
		query.append("	     +0" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("   #end" ).append("\n"); 
		query.append(",0,  " ).append("\n"); 
		query.append("    #if( $key == 'CHG001')" ).append("\n"); 
		query.append("         MAX(CHG001_S)," ).append("\n"); 
		query.append("    #elseif( $key == 'CHG002')" ).append("\n"); 
		query.append("         MAX(CHG002_S)," ).append("\n"); 
		query.append("    #elseif( $key == 'CHG003')" ).append("\n"); 
		query.append("         MAX(CHG003_S)," ).append("\n"); 
		query.append("    #elseif( $key == 'CHG004')" ).append("\n"); 
		query.append("         MAX(CHG004_S)," ).append("\n"); 
		query.append("    #elseif( $key == 'CHG005')" ).append("\n"); 
		query.append("         MAX(CHG005_S)," ).append("\n"); 
		query.append("    #elseif( $key == 'CHG999')" ).append("\n"); 
		query.append("         MAX(INV102)-(MAX(CHG001_S)+ MAX(CHG002_S)+ MAX(CHG003_S)+ MAX(CHG004_S)+ MAX(CHG005_S))," ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if( $key == 'CHG999')" ).append("\n"); 
		query.append("         MAX(INV106)-(MAX(CHG001)+MAX(CHG002)+MAX(CHG003)+MAX(CHG004)+MAX(CHG005))  )) $key" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("         MAX($key)  )) $key" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT  @[rpt_tmplt_nm] RPT_TMPLT_NM" ).append("\n"); 
		query.append("        ,MN5.BKG_NO        AS INV001" ).append("\n"); 
		query.append("        /***  BKG MAIN  *********/" ).append("\n"); 
		query.append("        ,MN5.BL_NO         AS INV002 " ).append("\n"); 
		query.append("        ,MN5.SCAC_CD       AS INV003" ).append("\n"); 
		query.append("        ,MN5.TOT_PCK_QTY   AS INV004" ).append("\n"); 
		query.append("        ,MN5.TOT_PCK_TP    AS INV005" ).append("\n"); 
		query.append("        ,MN5.ACT_WGT       AS INV006" ).append("\n"); 
		query.append("        ,MN5.TOT_WGT_UT_CD AS INV007" ).append("\n"); 
		query.append("        ,MN5.TOT_MEAS_QTY  AS INV008" ).append("\n"); 
		query.append("        ,MN5.MEAS_UT_CD    AS INV009" ).append("\n"); 
		query.append("        ,MN5.BKG_OFC_CD    AS INV010" ).append("\n"); 
		query.append("        ,N.OBL_ISS_OFC_CD  AS INV011  " ).append("\n"); 
		query.append("        ,MN5.RFA_NO  AS INV012" ).append("\n"); 
		query.append("        ,MN5.SC_NO   AS INV013" ).append("\n"); 
		query.append("        /*** CUSTOMER *********/" ).append("\n"); 
		query.append("        ,DECODE(NVL(MN5.CONSIGNEE,'000000'),'000000',NULL,SUBSTR(MN5.CONSIGNEE,1,2)||'-'||SUBSTR(MN5.CONSIGNEE,3,6)) AS INV014" ).append("\n"); 
		query.append("        ,MN5.CONSIGNEE_NM AS INV015" ).append("\n"); 
		query.append("        ,DECODE(NVL(MN5.CN_GROUP_CUST,'000000'),'000000',NULL,SUBSTR(MN5.CN_GROUP_CUST,1,2)||'-'||SUBSTR(MN5.CN_GROUP_CUST,3,6)) AS INV016" ).append("\n"); 
		query.append("        ,MN5.CN_GROUP_CUST_NM AS INV017" ).append("\n"); 
		query.append("        ,DECODE(NVL(MN5.NOTIFY_PARTY,'000000'),'000000',NULL,SUBSTR(MN5.NOTIFY_PARTY,1,2)||'-'||SUBSTR(MN5.NOTIFY_PARTY,3,6)) AS INV018" ).append("\n"); 
		query.append("        ,MN5.NOTIFY_PARTY_NM AS INV019" ).append("\n"); 
		query.append("        ,DECODE(NVL(MN5.SHIPPER,'000000'),'000000',NULL,SUBSTR(MN5.SHIPPER,1,2)||'-'||SUBSTR(MN5.SHIPPER,3,6))  AS INV020" ).append("\n"); 
		query.append("        ,MN5.SHIPPER_NM AS INV021" ).append("\n"); 
		query.append("        ,MN5.SHIPPER_ADDR AS INV147" ).append("\n"); 
		query.append("        ,MN5.FORWARDER_ADDR AS INV148" ).append("\n"); 
		query.append("        ,MN5.ACTUAL_CUST_NM AS INV149" ).append("\n"); 
		query.append("        ,MN5.BKG_CNTC_EMAIL  AS INV150" ).append("\n"); 
		query.append("        ,MN5.BKG_CNTC_NM  AS INV151" ).append("\n"); 
		query.append("        ,DECODE(NVL(MN5.SH_GROUP_CUST,'000000'),'000000',NULL,SUBSTR(MN5.SH_GROUP_CUST,1,2)||'-'||SUBSTR(MN5.SH_GROUP_CUST,3,6)) AS INV022" ).append("\n"); 
		query.append("        ,(SELECT C5.CUST_LGL_ENG_NM " ).append("\n"); 
		query.append("         FROM   MDM_CUSTOMER C5 " ).append("\n"); 
		query.append("         WHERE  C5.CUST_CNT_CD(+) = SUBSTR(MN5.SH_GROUP_CUST,1,2)" ).append("\n"); 
		query.append("         AND    TO_NUMBER(C5.CUST_SEQ(+))    = TO_NUMBER(SUBSTR(MN5.SH_GROUP_CUST,3,6)) ) AS INV023" ).append("\n"); 
		query.append("        ,(SELECT S.CUST_NM" ).append("\n"); 
		query.append("          FROM   BKG_CUSTOMER S" ).append("\n"); 
		query.append("          WHERE  S.BKG_NO = MN5.BKG_NO AND S.BKG_CUST_TP_CD = 'A' ) AS INV063" ).append("\n"); 
		query.append("        /*** ROUTE CONDITION *********/" ).append("\n"); 
		query.append("        ,MN5.POR_CD              AS INV024" ).append("\n"); 
		query.append("        ,SUBSTR(MN5.POR_CD,1,2)  AS INV025" ).append("\n"); 
		query.append("        ,(SELECT LOC1.LOC_NM FROM MDM_LOCATION LOC1  " ).append("\n"); 
		query.append("          WHERE  MN5.POR_CD = LOC1.LOC_CD(+)) AS INV026" ).append("\n"); 
		query.append("        ,MN5.POL_CD                           AS INV027" ).append("\n"); 
		query.append("        ,(SELECT LOC2.LOC_NM FROM MDM_LOCATION LOC2  " ).append("\n"); 
		query.append("          WHERE  MN5.POL_CD = LOC2.LOC_CD(+)) AS INV028" ).append("\n"); 
		query.append("        ,MN5.PRE_RELAY_PORT                   AS INV029" ).append("\n"); 
		query.append("        ,MN5.POD_CD                           AS INV030  " ).append("\n"); 
		query.append("        ,(SELECT LOC3.LOC_NM FROM MDM_LOCATION LOC3  " ).append("\n"); 
		query.append("          WHERE  MN5.POD_CD = LOC3.LOC_CD(+)) AS INV031" ).append("\n"); 
		query.append("        ,MN5.POST_RELAY_PORT                  AS INV032" ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CO1.CUST_CONV_CD_CTNT), MN5.DEL_CD) " ).append("\n"); 
		query.append("          FROM  INV_CPRT_CD_CONV CO1  " ).append("\n"); 
		query.append("          WHERE CO1.CPRT_CONV_TP_CD ='LOCATION'" ).append("\n"); 
		query.append("          AND   CO1.HJS_CD_CTNT = MN5.DEL_CD" ).append("\n"); 
		query.append("          AND   CO1.SC_NO  = NVL(MN5.SC_NO,'X') " ).append("\n"); 
		query.append("          AND   CO1.RFA_NO = NVL(MN5.RFA_NO,'X'))  AS INV033 " ).append("\n"); 
		query.append("        ,SUBSTR(MN5.DEL_CD,1,2)                AS INV034" ).append("\n"); 
		query.append("        ,(SELECT LOC4.STE_CD FROM MDM_LOCATION LOC4  " ).append("\n"); 
		query.append("          WHERE  MN5.DEL_CD = LOC4.LOC_CD(+)) AS INV035 " ).append("\n"); 
		query.append("        ,(SELECT LOC5.LOC_NM FROM MDM_LOCATION LOC5  " ).append("\n"); 
		query.append("          WHERE  MN5.DEL_CD = LOC5.LOC_CD(+)) AS INV036 " ).append("\n"); 
		query.append("        ,MN5.FNL_DEST_CD     AS INV037" ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CO2.CUST_CONV_CD_CTNT), MN5.RCV_TERM_CD)" ).append("\n"); 
		query.append("          FROM INV_CPRT_CD_CONV CO2" ).append("\n"); 
		query.append("          WHERE CO2.CPRT_CONV_TP_CD ='RECEIVINGTERM'" ).append("\n"); 
		query.append("          AND CO2.HJS_CD_CTNT = MN5.RCV_TERM_CD" ).append("\n"); 
		query.append("          AND CO2.SC_NO = NVL(MN5.SC_NO, 'X')" ).append("\n"); 
		query.append("          AND CO2.RFA_NO = NVL(MN5.RFA_NO, 'X')) AS INV038" ).append("\n"); 
		query.append("--        ,MN5.RCV_TERM_CD     AS INV038" ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CO2.CUST_CONV_CD_CTNT), MN5.DE_TERM_CD)" ).append("\n"); 
		query.append("          FROM INV_CPRT_CD_CONV CO2" ).append("\n"); 
		query.append("          WHERE CO2.CPRT_CONV_TP_CD ='DELIVERYTERM'" ).append("\n"); 
		query.append("          AND CO2.HJS_CD_CTNT = MN5.DE_TERM_CD" ).append("\n"); 
		query.append("          AND CO2.SC_NO = NVL(MN5.SC_NO, 'X')" ).append("\n"); 
		query.append("          AND CO2.RFA_NO = NVL(MN5.RFA_NO, 'X')) AS INV039" ).append("\n"); 
		query.append("--        ,MN5.DE_TERM_CD      AS INV039" ).append("\n"); 
		query.append("        ,MN5.FNL_DEST_NM     AS INV040   " ).append("\n"); 
		query.append("        ,(SELECT LOC6.EQ_CTRL_OFC_CD  FROM MDM_LOCATION LOC6  " ).append("\n"); 
		query.append("          WHERE  MN5.DEL_CD = LOC6.LOC_CD(+)) AS INV041 " ).append("\n"); 
		query.append("        ,MN5.DEST_TRNS_SVC_MOD_CD            AS INV042" ).append("\n"); 
		query.append("        /***  VESSEL *********/" ).append("\n"); 
		query.append("        ,MN5.T_VVD   AS INV043" ).append("\n"); 
		query.append("        ,(SELECT VSL_ENG_NM||' '||SUBSTR(MN5.T_VVD,5,5)  FROM MDM_VSL_CNTR WHERE VSL_CD = SUBSTR(MN5.T_VVD,1,4)) AS INV044" ).append("\n"); 
		query.append("        ,MN5.T_LANE  AS INV045" ).append("\n"); 
		query.append("        ,MN5.FST_VVD AS INV046" ).append("\n"); 
		query.append("        /*** DATE,TIME *********/" ).append("\n"); 
		query.append("        , TO_CHAR(NVL(" ).append("\n"); 
		query.append("          (SELECT /*+ INDEX_DESC (S XAK11CTM_MOVEMENT)*/" ).append("\n"); 
		query.append("                  S.CNMV_EVNT_DT" ).append("\n"); 
		query.append("           FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("           WHERE  1=1" ).append("\n"); 
		query.append("           AND    S.CNTR_NO     (+) = MN5.CNTR_NO" ).append("\n"); 
		query.append("           AND    S.CNMV_YR     (+) = MN5.CNMV_YR" ).append("\n"); 
		query.append("           AND    S.CNMV_CYC_NO (+) = MN5.CNMV_CYC_NO" ).append("\n"); 
		query.append("           AND    S.MVMT_STS_CD (+) = 'OC'" ).append("\n"); 
		query.append("           AND    ROWNUM            = 1" ).append("\n"); 
		query.append("           ), MN5.CGO_RCV_DT), 'YYYY-MM-DD') AS INV047" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(MN5.F_POL_ETA,'YYYYMMDD') ,'YYYY-MM-DD')  AS INV048" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(MN5.DUEDT,'YYYYMMDD') ,'YYYY-MM-DD')      AS INV049" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(MN5.F_POL_ETD,'YYYYMMDD') ,'YYYY-MM-DD')  AS INV050" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(MN5.T_POL_ETA,'YYYYMMDD') ,'YYYY-MM-DD')  AS INV051" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(MN5.T_POL_ETD,'YYYYMMDD') ,'YYYY-MM-DD')  AS INV052" ).append("\n"); 
		query.append("        ,MN5.OBRD_DT    AS INV053" ).append("\n"); 
		query.append("        ,TO_CHAR(N.OBL_ISS_DT,'YYYY-MM-DD')    AS INV054 " ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(MN5.T_POD_ETA,'YYYYMMDD') ,'YYYY-MM-DD')  AS INV055" ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(NVL(P.FAX_SND_DT, NVL(P.EML_SND_DT, '')),'YYYY-MM-DD') AN_SENT_DT" ).append("\n"); 
		query.append("          FROM   BKG_ARR_NTC_DTL P" ).append("\n"); 
		query.append("          WHERE  MN5.BKG_NO = P.BKG_NO(+)" ).append("\n"); 
		query.append("          AND    P.BKG_CUST_TP_CD(+) ='C' " ).append("\n"); 
		query.append("          AND    P.CUST_CNTC_TP_CD(+) = 'C1'  )    AS INV056 " ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(MN5.T_POD_ETD,'YYYYMMDD') ,'YYYY-MM-DD')   AS INV057" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(MN5.L_POD_ETA,'YYYYMMDD') ,'YYYY-MM-DD')  AS INV058" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(MN5.L_POD_ETD,'YYYYMMDD') ,'YYYY-MM-DD')  AS INV059" ).append("\n"); 
		query.append("        ,TO_CHAR(W.CSTMS_CLR_LST_DT,'YYYY-MM-DD')  AS INV060 " ).append("\n"); 
		query.append("        ,DECODE(TO_CHAR(O.DEL_ARR_DT,'YYYY-MM-DD'), NULL, DECODE(MN5.COP_DEL_ETA,'00000000', MN5.VSK_DEL_ETA, TO_CHAR(TO_DATE(MN5.COP_DEL_ETA,'YYYYMMDD'),'YYYY-MM-DD')),TO_CHAR(O.DEL_ARR_DT,'YYYY-MM-DD'))  AS INV061" ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_DESC(S XAK2CTM_MOVEMENT)*/" ).append("\n"); 
		query.append("                 S.MVMT_STS_CD||' '|| NVL(TO_CHAR(S.CNMV_EVNT_DT,'YYYY-MM-DD'),'') " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  S.BKG_NO     (+) = MN5.BKG_NO" ).append("\n"); 
		query.append("          AND    S.CNTR_NO    (+) = MN5.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO(+) = MN5.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    ROWNUM           = 1" ).append("\n"); 
		query.append("         ) AS INV062" ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_DESC(S XAK11CTM_MOVEMENT) */" ).append("\n"); 
		query.append("                 TO_CHAR(S.CNMV_EVNT_DT, 'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  1=1" ).append("\n"); 
		query.append("          AND    S.CNTR_NO     (+)  = MN5.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_YR     (+)  = MN5.CNMV_YR      " ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO (+)  = MN5.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    S.MVMT_STS_CD (+)  = 'ID'" ).append("\n"); 
		query.append("          AND    ROWNUM             = 1" ).append("\n"); 
		query.append("         ) AS INV064" ).append("\n"); 
		query.append("        ,TO_CHAR(O.PKUP_FREE_DT,'YYYY-MM-DD' ) AS INV065  " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_DESC(S XAK11CTM_MOVEMENT) */" ).append("\n"); 
		query.append("                 TO_CHAR(S.CNMV_EVNT_DT, 'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  1=1" ).append("\n"); 
		query.append("          AND    S.CNTR_NO     (+)  = MN5.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_YR     (+)  = MN5.CNMV_YR      " ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO (+)  = MN5.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    S.MVMT_STS_CD (+)  = 'ID'" ).append("\n"); 
		query.append("          AND    ROWNUM             = 1" ).append("\n"); 
		query.append("         ) AS INV066 " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_ASC(S XAK11CTM_MOVEMENT)*/" ).append("\n"); 
		query.append("                 TO_CHAR(S.CNMV_EVNT_DT,'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  1=1" ).append("\n"); 
		query.append("          AND    S.CNTR_NO     (+) = MN5.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_YR     (+) = MN5.CNMV_YR" ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO (+) = MN5.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    S.MVMT_STS_CD (+) = 'MT'" ).append("\n"); 
		query.append("          AND    ROWNUM            = 1" ).append("\n"); 
		query.append("         ) AS INV067" ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_ASC(S XAK11CTM_MOVEMENT)*/" ).append("\n"); 
		query.append("                 TO_CHAR(S.CNMV_EVNT_DT,'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  1=1" ).append("\n"); 
		query.append("          AND    S.CNTR_NO     (+) = MN5.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_YR     (+) = MN5.CNMV_YR" ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO (+) = MN5.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    S.MVMT_STS_CD (+) = 'IC'" ).append("\n"); 
		query.append("          AND    ROWNUM            = 1   " ).append("\n"); 
		query.append("         ) AS INV080" ).append("\n"); 
		query.append("        /*** CONTAINER  INV068 - INV078 *********/" ).append("\n"); 
		query.append("        ,MN5.MEAS_QTY      AS INV068" ).append("\n"); 
		query.append("        ,MN5.CNTR_NO       AS INV069" ).append("\n"); 
		query.append("        ,MN5.CNTR_PRT_FLG  AS INV070" ).append("\n"); 
		query.append("        ,MN5.CNTR_SEAL_NO  AS INV071" ).append("\n"); 
		query.append("        ,MN5.CNTR_SZ_CD    AS INV072" ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CO2.CUST_CONV_CD_CTNT), MN5.CNTR_TPSZ_CD) " ).append("\n"); 
		query.append("          FROM  INV_CPRT_CD_CONV CO2  " ).append("\n"); 
		query.append("          WHERE CO2.CPRT_CONV_TP_CD ='CNTRTPSZ'" ).append("\n"); 
		query.append("          AND   CO2.HJS_CD_CTNT = MN5.CNTR_TPSZ_CD " ).append("\n"); 
		query.append("          AND   CO2.SC_NO  = NVL(MN5.SC_NO,'X') " ).append("\n"); 
		query.append("          AND   CO2.RFA_NO = NVL(MN5.RFA_NO,'X')) AS INV073  " ).append("\n"); 
		query.append("        ,MN5.CNTR_VOL_QTY  AS INV074" ).append("\n"); 
		query.append("        ,MN5.PCK_QTY       AS INV075" ).append("\n"); 
		query.append("        ,MN5.PCK_TP_CD     AS INV076" ).append("\n"); 
		query.append("        ,MN5.CNTR_WGT      AS INV077" ).append("\n"); 
		query.append("        ,MN5.WGT_UT_CD     AS INV078" ).append("\n"); 
		query.append("        /***   CUSTOMER REF.  *********/" ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(U1.CUST_REF_NO_CTNT,1,50) FROM BKG_REFERENCE U1 " ).append("\n"); 
		query.append("          WHERE MN5.BKG_NO = U1.BKG_NO(+)" ).append("\n"); 
		query.append("          AND U1.BKG_REF_TP_CD='BKPO' AND ROWNUM=1) AS INV082  " ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(U2.CUST_REF_NO_CTNT,1,50) FROM BKG_REFERENCE U2 " ).append("\n"); 
		query.append("          WHERE MN5.BKG_NO = U2.BKG_NO(+) " ).append("\n"); 
		query.append("          AND  MN5.CNTR_NO = U2.CNTR_NO(+) " ).append("\n"); 
		query.append("          AND U2.BKG_REF_TP_CD='CTPO' AND ROWNUM=1) AS INV083" ).append("\n"); 
		query.append("        ,(SELECT V.PRT_NO FROM BKG_REF_DTL V " ).append("\n"); 
		query.append("          WHERE MN5.BKG_NO = V.BKG_NO(+)" ).append("\n"); 
		query.append("          AND V.CUST_REF_TP_CD='HP' AND ROWNUM=1)  AS INV084" ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(U3.CUST_REF_NO_CTNT,1,50) FROM BKG_REFERENCE U3 " ).append("\n"); 
		query.append("          WHERE MN5.BKG_NO = U3.BKG_NO(+)" ).append("\n"); 
		query.append("          AND U3.BKG_REF_TP_CD='FINV' AND ROWNUM=1) AS INV085" ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(U4.CUST_REF_NO_CTNT,1,50) FROM BKG_REFERENCE U4 " ).append("\n"); 
		query.append("          WHERE MN5.BKG_NO = U4.BKG_NO(+)" ).append("\n"); 
		query.append("          AND U4.BKG_REF_TP_CD='EBRF' AND ROWNUM=1) AS INV086" ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(U5.CUST_REF_NO_CTNT,1,50) FROM BKG_REFERENCE U5" ).append("\n"); 
		query.append("          WHERE MN5.BKG_NO = U5.BKG_NO(+)" ).append("\n"); 
		query.append("          AND U5.BKG_REF_TP_CD='ESRF' AND ROWNUM=1) AS INV087" ).append("\n"); 
		query.append("        ,(SELECT U6.CUST_NM FROM BKG_CUSTOMER U6" ).append("\n"); 
		query.append("          WHERE MN5.BKG_NO = U6.BKG_NO(+)" ).append("\n"); 
		query.append("          AND U6.BKG_CUST_TP_CD = 'E' AND ROWNUM=1) AS INV088" ).append("\n"); 
		query.append("        /***  RATE   *********/" ).append("\n"); 
		query.append("        ,''   AS INV090" ).append("\n"); 
		query.append("        ,''   AS INV089" ).append("\n"); 
		query.append("        ,''   AS INV091" ).append("\n"); 
		query.append("        ,MN5.THR_CUST AS INV092" ).append("\n"); 
		query.append("        ,''   AS INV093" ).append("\n"); 
		query.append("        ,MN5.CNTR_CHG_CURR AS INV126" ).append("\n"); 
		query.append("        ,''   AS INV094" ).append("\n"); 
		query.append("        ,''   AS INV095 " ).append("\n"); 
		query.append("        ,''   AS INV097" ).append("\n"); 
		query.append("        ,''   AS INV100" ).append("\n"); 
		query.append("        ,''   AS INV098" ).append("\n"); 
		query.append("        ,''   AS INV099" ).append("\n"); 
		query.append("        ,''   AS INV140" ).append("\n"); 
		query.append("        ,MN5.AUD_STS_CD AS INV101" ).append("\n"); 
		query.append("        ,MN5.GRP_CUR   AS INV103" ).append("\n"); 
		query.append("        ,MN5.TOT_CURR_AMT   AS INV102" ).append("\n"); 
		query.append("        ,DECODE(NVL(MN5.BILL_CUST,'000000'),'000000',NULL, SUBSTR(MN5.BILL_CUST,1,2)||'-'||SUBSTR(MN5.BILL_CUST,3,6)) AS INV104" ).append("\n"); 
		query.append("        ,MN5.OTS_OFC   AS INV105" ).append("\n"); 
		query.append("        ,MN5.CNTR_SUM  AS INV106" ).append("\n"); 
		query.append("        ,SUM(CHG4.CHG_AMT) AS INV107" ).append("\n"); 
		query.append("        ,MN5.CR_TERM   AS INV108" ).append("\n"); 
		query.append("        ,MN5.OVER_DUE  AS INV109" ).append("\n"); 
		query.append("        ,(SELECT DECODE(MN5.FRT_TERM_CD, 'C',W.FRT_CLT_FLG,  MIN(NVL(OT.OTS_STL_FLG,'N')))" ).append("\n"); 
		query.append("          FROM   BKG_OUTSTANDING OT" ).append("\n"); 
		query.append("          WHERE  OT.CLT_BL_NO = MN5.BL_NO AND OT.OFC_CD = MN5.OTS_OFC AND OT.OTS_BND_TP_CD='O')  AS INV110 " ).append("\n"); 
		query.append("        ,MN5.FRT_TERM_CD 	 " ).append("\n"); 
		query.append("        ,MN5.GL_EX     AS INV111" ).append("\n"); 
		query.append("        ,MN5.LCL_TOT   AS INV112" ).append("\n"); 
		query.append("        ,MN5.USD_TOT   AS INV141" ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CO3.CUST_CONV_CD_CTNT), MN5.CHG_CD) " ).append("\n"); 
		query.append("          FROM  INV_CPRT_CD_CONV CO3  " ).append("\n"); 
		query.append("          WHERE CO3.CPRT_CONV_TP_CD ='CHARGE' " ).append("\n"); 
		query.append("          AND  CO3.HJS_CD_CTNT =MN5.CHG_CD" ).append("\n"); 
		query.append("          AND  CO3.SC_NO  = NVL(MN5.SC_NO,'X') " ).append("\n"); 
		query.append("          AND  CO3.RFA_NO = NVL(MN5.RFA_NO,'X'))  AS INV096" ).append("\n"); 
		query.append("        ,MN5.CHG_CURR      AS INV127" ).append("\n"); 
		query.append("        ,MN5.CHG_RATED_AS  AS INV128" ).append("\n"); 
		query.append("        ,MN5.CHG_RATE      AS INV129" ).append("\n"); 
		query.append("        ,''                AS INV130" ).append("\n"); 
		query.append("        ,MN5.CHG_SUM       AS INV131" ).append("\n"); 
		query.append("        /***  RATE REP_CHGE *********/" ).append("\n"); 
		query.append("        ,''       AS INV132" ).append("\n"); 
		query.append("        ,''       AS INV133" ).append("\n"); 
		query.append("        ,''       AS INV134" ).append("\n"); 
		query.append("        ,''       AS INV135" ).append("\n"); 
		query.append("        ,''       AS INV136" ).append("\n"); 
		query.append("        ,''       AS INV137" ).append("\n"); 
		query.append("        ,''       AS INV138" ).append("\n"); 
		query.append("        ,''       AS INV139" ).append("\n"); 
		query.append("        /*** COMMODITY *********/" ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CO4.CUST_CONV_CD_CTNT), MN5.CMDT_CD) " ).append("\n"); 
		query.append("          FROM  INV_CPRT_CD_CONV CO4  " ).append("\n"); 
		query.append("          WHERE CO4.CPRT_CONV_TP_CD ='COMMODITY' " ).append("\n"); 
		query.append("          AND  CO4.HJS_CD_CTNT = MN5.CMDT_CD" ).append("\n"); 
		query.append("          AND  CO4.SC_NO  = NVL(MN5.SC_NO,'X') " ).append("\n"); 
		query.append("          AND  CO4.RFA_NO = NVL(MN5.RFA_NO,'X')) AS INV113 " ).append("\n"); 
		query.append("        ,(SELECT D.CMDT_NM   FROM MDM_COMMODITY D WHERE MN5.CMDT_CD = D.CMDT_CD(+)) AS INV114 " ).append("\n"); 
		query.append("        ,MN5.CSTMS_DESC     AS INV115" ).append("\n"); 
		query.append("        ,MN5.CNTR_SP_CGO_FG AS INV116" ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(S.MK_DESC) FROM BKG_BL_MK_DESC S WHERE S.BKG_NO = MN5.BKG_NO AND S.MK_SEQ=1) AS INV079" ).append("\n"); 
		query.append("        /***  I/B INFORM  *********/" ).append("\n"); 
		query.append("        ,(SELECT M.RTN_YD_CD FROM BKG_PKUP_NTC M " ).append("\n"); 
		query.append("          WHERE M.BKG_NO = MN5.BKG_NO " ).append("\n"); 
		query.append("          AND  M.NTC_SEQ = (SELECT MAX(MM.NTC_SEQ) " ).append("\n"); 
		query.append("                            FROM BKG_PKUP_NTC MM " ).append("\n"); 
		query.append("                            WHERE MM.BKG_NO = MN5.BKG_NO)) AS INV117" ).append("\n"); 
		query.append("        ,(SELECT HUB_LOC_CD FROM BKG_CSTMS_ADV_BL" ).append("\n"); 
		query.append("          WHERE BL_NO =MN5.BL_NO    " ).append("\n"); 
		query.append("          AND CNT_CD =SUBSTR(MN5.DEL_CD,1,2)) AS INV118  " ).append("\n"); 
		query.append("        ,(SELECT MAX(DECODE(CNT_CD, 'UA', IBD_TRSP_NO, ''))" ).append("\n"); 
		query.append("          FROM BKG_CSTMS_ADV_IBD" ).append("\n"); 
		query.append("          WHERE  BL_NO= MN5.BL_NO AND CNT_CD ='UA' )   AS INV119  " ).append("\n"); 
		query.append("        ,(SELECT MAX(DECODE(CNT_CD ,'US', TO_CHAR(IBD_TRSP_ISS_DT,'YYYY-MM-DD'), ''))" ).append("\n"); 
		query.append("          FROM  BKG_CSTMS_ADV_IBD" ).append("\n"); 
		query.append("          WHERE BL_NO=MN5.BL_NO AND CNT_CD ='US' ) AS INV120 " ).append("\n"); 
		query.append("        ,(SELECT M1.PKUP_NO FROM BKG_PKUP_NTC M1 " ).append("\n"); 
		query.append("          WHERE M1.BKG_NO = MN5.BKG_NO " ).append("\n"); 
		query.append("          AND M1.NTC_SEQ = (SELECT MAX(M2.NTC_SEQ) " ).append("\n"); 
		query.append("                           FROM BKG_PKUP_NTC M2 WHERE M2.BKG_NO = MN5.BKG_NO)) AS INV121" ).append("\n"); 
		query.append("        ,(SELECT M3.PKUP_YD_CD FROM BKG_PKUP_NTC M3 " ).append("\n"); 
		query.append("          WHERE M3.BKG_NO = MN5.BKG_NO " ).append("\n"); 
		query.append("          AND M3.NTC_SEQ = (SELECT MAX(M4.NTC_SEQ) " ).append("\n"); 
		query.append("                           FROM BKG_PKUP_NTC M4 WHERE M4.BKG_NO = MN5.BKG_NO)) AS INV122" ).append("\n"); 
		query.append("        ,''    AS INV123" ).append("\n"); 
		query.append("        ,W.OBL_RDEM_FLG    AS INV124" ).append("\n"); 
		query.append("        ,W.CSTMS_CLR_CD    AS INV125" ).append("\n"); 
		query.append("        ,''	AS INV081" ).append("\n"); 
		query.append("        ,MN5.RT_APLY_DT AS INV142" ).append("\n"); 
		query.append("        ,'' AS INV143 " ).append("\n"); 
		query.append("        ,(SELECT MAX(TO_CHAR(BC.CGO_RCV_DT,'YYYY-MM-DD'))" ).append("\n"); 
		query.append("          FROM BKG_CONTAINER BC " ).append("\n"); 
		query.append("          WHERE BC.BKG_NO = MN5.BKG_NO  ) AS INV144" ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(U7.CUST_REF_NO_CTNT,1,50) FROM BKG_REFERENCE U7" ).append("\n"); 
		query.append("          WHERE MN5.BKG_NO = U7.BKG_NO(+)" ).append("\n"); 
		query.append("          AND U7.BKG_REF_TP_CD='HPDP' AND ROWNUM=1) AS INV145 " ).append("\n"); 
		query.append("        ,MN5.PRT_NO    AS INV146 " ).append("\n"); 
		query.append("        ,MN5.CHG001" ).append("\n"); 
		query.append("        ,MN5.CHG002" ).append("\n"); 
		query.append("        ,MN5.CHG003" ).append("\n"); 
		query.append("        ,MN5.CHG004" ).append("\n"); 
		query.append("        ,MN5.CHG005" ).append("\n"); 
		query.append("        ,MN5.CHG001_S" ).append("\n"); 
		query.append("        ,MN5.CHG002_S" ).append("\n"); 
		query.append("        ,MN5.CHG003_S" ).append("\n"); 
		query.append("        ,MN5.CHG004_S" ).append("\n"); 
		query.append("        ,MN5.CHG005_S" ).append("\n"); 
		query.append("FROM    " ).append("\n"); 
		query.append("(       " ).append("\n"); 
		query.append("SELECT   MN4.BKG_NO" ).append("\n"); 
		query.append("        /*  BKG MAIN */" ).append("\n"); 
		query.append("        ,MN4.BL_NO" ).append("\n"); 
		query.append("        ,MN4.RFA_NO" ).append("\n"); 
		query.append("        ,MN4.SC_NO" ).append("\n"); 
		query.append("        ,MN4.SCAC_CD " ).append("\n"); 
		query.append("        ,MN4.BKG_OFC_CD " ).append("\n"); 
		query.append("        ,MN4.POR_CD" ).append("\n"); 
		query.append("        ,MN4.POD_CD" ).append("\n"); 
		query.append("        ,MN4.POL_CD" ).append("\n"); 
		query.append("        ,MN4.DEL_CD" ).append("\n"); 
		query.append("        ,MN4.FNL_DEST_CD" ).append("\n"); 
		query.append("        ,MN4.RCV_TERM_CD" ).append("\n"); 
		query.append("        ,MN4.DE_TERM_CD" ).append("\n"); 
		query.append("        ,MN4.DEST_TRNS_SVC_MOD_CD" ).append("\n"); 
		query.append("        ,MN4.CMDT_CD" ).append("\n"); 
		query.append("        ,MN4.FNL_DEST_NM" ).append("\n"); 
		query.append("        ,MN4.TOT_PCK_QTY" ).append("\n"); 
		query.append("        ,MN4.TOT_PCK_TP" ).append("\n"); 
		query.append("        ,MN4.ACT_WGT" ).append("\n"); 
		query.append("        ,MN4.TOT_WGT_UT_CD" ).append("\n"); 
		query.append("        ,MN4.TOT_MEAS_QTY" ).append("\n"); 
		query.append("        ,MN4.MEAS_UT_CD" ).append("\n"); 
		query.append("        ,MN4.VSL_NM" ).append("\n"); 
		query.append("        ,MN4.CSTMS_DESC" ).append("\n"); 
		query.append("        /* CUSTOMER */   " ).append("\n"); 
		query.append("        ,MN4.CONSIGNEE" ).append("\n"); 
		query.append("        ,MN4.CN_GROUP_CUST" ).append("\n"); 
		query.append("        ,MN4.NOTIFY_PARTY" ).append("\n"); 
		query.append("        ,MN4.SHIPPER" ).append("\n"); 
		query.append("        ,MN4.SH_GROUP_CUST" ).append("\n"); 
		query.append("        ,MN4.CONSIGNEE_NM" ).append("\n"); 
		query.append("        ,MN4.CN_GROUP_CUST_NM" ).append("\n"); 
		query.append("        ,MN4.NOTIFY_PARTY_NM" ).append("\n"); 
		query.append("        ,MN4.SHIPPER_NM" ).append("\n"); 
		query.append("        ,MN4.SHIPPER_ADDR" ).append("\n"); 
		query.append("        ,MN4.FORWARDER_ADDR" ).append("\n"); 
		query.append("        ,MN4.ACTUAL_CUST_NM" ).append("\n"); 
		query.append("        ,MN4.BKG_CNTC_EMAIL" ).append("\n"); 
		query.append("        ,MN4.BKG_CNTC_NM" ).append("\n"); 
		query.append("        /* ROUTE CONDITION */" ).append("\n"); 
		query.append("        ,MN4.PRE_RELAY_PORT" ).append("\n"); 
		query.append("        ,MN4.POST_RELAY_PORT" ).append("\n"); 
		query.append("        ,MN4.T_VVD" ).append("\n"); 
		query.append("        ,MN4.T_LANE" ).append("\n"); 
		query.append("        ,MN4.FST_VVD" ).append("\n"); 
		query.append("        /* DATE,TIME */" ).append("\n"); 
		query.append("        ,MN4.OBRD_DT" ).append("\n"); 
		query.append("        ,MN4.F_POL_ETA" ).append("\n"); 
		query.append("        ,MN4.F_POL_ETD" ).append("\n"); 
		query.append("        ,MN4.T_POL_ETA" ).append("\n"); 
		query.append("        ,MN4.T_POL_ETD" ).append("\n"); 
		query.append("        ,MN4.T_POD_ETA" ).append("\n"); 
		query.append("        ,MN4.T_POD_ETD" ).append("\n"); 
		query.append("        ,MN4.L_POD_ETA" ).append("\n"); 
		query.append("        ,MN4.L_POD_ETD" ).append("\n"); 
		query.append("        ,CNTR.CGO_RCV_DT" ).append("\n"); 
		query.append("        ,MN4.DUEDT" ).append("\n"); 
		query.append("        ,MN4.BILL_CUST" ).append("\n"); 
		query.append("        ,MN4.THR_CUST" ).append("\n"); 
		query.append("        ,MN4.OTS_OFC" ).append("\n"); 
		query.append("        ,MN4.CR_TERM " ).append("\n"); 
		query.append("        ,MN4.GL_EX " ).append("\n"); 
		query.append("        ,MN4.LCL_TOT" ).append("\n"); 
		query.append("        ,MN4.USD_TOT" ).append("\n"); 
		query.append("        ,MN4.OVER_DUE" ).append("\n"); 
		query.append("        ,MN4.AUD_STS_CD" ).append("\n"); 
		query.append("        ,MN4.GRP_CUR" ).append("\n"); 
		query.append("        ,DECODE(CHG3.CURR_CD, NULL, 0, MN4.TOT_CURR_AMT) AS TOT_CURR_AMT" ).append("\n"); 
		query.append("        ,MN4.CHG_CD" ).append("\n"); 
		query.append("        ,MN4.CHG_CURR" ).append("\n"); 
		query.append("        ,MN4.CHG_RATED_AS" ).append("\n"); 
		query.append("        ,MN4.CHG_RATE" ).append("\n"); 
		query.append("        ,MN4.CHG_SUM" ).append("\n"); 
		query.append("        ,MN4.FRT_TERM_CD" ).append("\n"); 
		query.append("        ,CNTR.CNTR_NO, CNTR.CNMV_CYC_NO, CNTR.CNMV_YR ,CNTR.MEAS_QTY, CNTR.CNTR_PRT_FLG" ).append("\n"); 
		query.append("        ,(SELECT CNTR_SEAL_NO" ).append("\n"); 
		query.append("          FROM   BKG_CNTR_SEAL_NO" ).append("\n"); 
		query.append("          WHERE  BKG_NO        =  MN4.BKG_NO" ).append("\n"); 
		query.append("          AND    CNTR_NO       = CNTR.CNTR_NO " ).append("\n"); 
		query.append("          AND    CNTR_SEAL_SEQ = 1 ) AS CNTR_SEAL_NO" ).append("\n"); 
		query.append("        ,(SELECT  DECODE(CNTR.CNTR_TPSZ_CD, 'D7','45',SUBSTR(SZ.CNTR_SZ_DESC, 1, 2))" ).append("\n"); 
		query.append("          FROM    MDM_CNTR_SZ SZ, MDM_CNTR_TP_SZ TP" ).append("\n"); 
		query.append("          WHERE   TP.CNTR_TPSZ_CD = CNTR.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("          AND     TP.CNTR_SZ_CD   = SZ.CNTR_SZ_CD)  AS CNTR_SZ_CD" ).append("\n"); 
		query.append("        ,CNTR.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("        ,CNTR.CNTR_VOL_QTY" ).append("\n"); 
		query.append("        ,CNTR.PCK_QTY" ).append("\n"); 
		query.append("        ,CNTR.PCK_TP_CD" ).append("\n"); 
		query.append("        ,CNTR.CNTR_WGT" ).append("\n"); 
		query.append("        ,CNTR.WGT_UT_CD" ).append("\n"); 
		query.append("        ,NVL(CNTR.DCGO_FLG, NVL(CNTR.RC_FLG,NVL(CNTR.BB_CGO_FLG,NVL(CNTR.AWK_CGO_FLG,'')))) AS CNTR_SP_CGO_FG" ).append("\n"); 
		query.append("        ,CHG3.CURR_CD AS CNTR_CHG_CURR" ).append("\n"); 
		query.append("        ,(SELECT NVL(SUM(CR.CHG_AMT),0)" ).append("\n"); 
		query.append("          FROM   BKG_CNTR_RT CR " ).append("\n"); 
		query.append("          WHERE  CR.BKG_NO               = MN4.BKG_NO" ).append("\n"); 
		query.append("          AND    CR.CNTR_NO              = CNTR.CNTR_NO" ).append("\n"); 
		query.append("          AND    CR.CURR_CD              = MN4.GRP_CUR" ).append("\n"); 
		query.append("          AND    CR.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND    CR.FRT_TERM_CD          = MN4.FRT_TERM_CD  ) AS CNTR_SUM" ).append("\n"); 
		query.append("        ,MN4.RT_APLY_DT" ).append("\n"); 
		query.append("        ,MN4.COP_DEL_ETA" ).append("\n"); 
		query.append("        ,MN4.VSK_DEL_ETA" ).append("\n"); 
		query.append("        ,MN4.PRT_NO" ).append("\n"); 
		query.append("        ,SUM(DECODE(CHG_T.FLG01, 'Y', DECODE(CHG_M.REP_CHG_CD, CHG_T.CHG01, CHG3.CHG_AMT, 0)," ).append("\n"); 
		query.append("                                      DECODE(CHG3.CHG_CD, CHG_T.CHG01, CHG3.CHG_AMT, 0))) AS CHG001" ).append("\n"); 
		query.append("        ,SUM(DECODE(CHG_T.FLG02, 'Y', DECODE(CHG_M.REP_CHG_CD, CHG_T.CHG02, CHG3.CHG_AMT, 0)," ).append("\n"); 
		query.append("                                      DECODE(CHG3.CHG_CD, CHG_T.CHG02, CHG3.CHG_AMT, 0))) AS CHG002" ).append("\n"); 
		query.append("        ,SUM(DECODE(CHG_T.FLG03, 'Y', DECODE(CHG_M.REP_CHG_CD, CHG_T.CHG03, CHG3.CHG_AMT, 0)," ).append("\n"); 
		query.append("                                      DECODE(CHG3.CHG_CD, CHG_T.CHG03, CHG3.CHG_AMT, 0))) AS CHG003" ).append("\n"); 
		query.append("        ,SUM(DECODE(CHG_T.FLG04, 'Y', DECODE(CHG_M.REP_CHG_CD, CHG_T.CHG04, CHG3.CHG_AMT, 0)," ).append("\n"); 
		query.append("                                      DECODE(CHG3.CHG_CD, CHG_T.CHG04, CHG3.CHG_AMT, 0))) AS CHG004" ).append("\n"); 
		query.append("        ,SUM(DECODE(CHG_T.FLG05, 'Y', DECODE(CHG_M.REP_CHG_CD, CHG_T.CHG05, CHG3.CHG_AMT, 0)," ).append("\n"); 
		query.append("                                      DECODE(CHG3.CHG_CD, CHG_T.CHG05, CHG3.CHG_AMT, 0))) AS CHG005" ).append("\n"); 
		query.append("        ,(SELECT NVL(SUM(RT.CHG_AMT),0)" ).append("\n"); 
		query.append("          FROM   BKG_CHG_RT RT, MDM_CHARGE  MD" ).append("\n"); 
		query.append("          WHERE  RT.BKG_NO                  = MN4.BKG_NO" ).append("\n"); 
		query.append("          AND    RT.CURR_CD                 = MN4.GRP_CUR" ).append("\n"); 
		query.append("          AND    RT.FRT_INCL_XCLD_DIV_CD(+) = 'N'" ).append("\n"); 
		query.append("          AND    RT.FRT_TERM_CD         (+) = MN4.FRT_TERM_CD" ).append("\n"); 
		query.append("#if (${frt_term_cd} != 'A')       " ).append("\n"); 
		query.append("         AND RT.FRT_TERM_CD(+) = @[frt_term_cd]" ).append("\n"); 
		query.append("#end         " ).append("\n"); 
		query.append("         AND RT.CHG_CD  = MD.CHG_CD" ).append("\n"); 
		query.append("         AND CHG_T.CHG01  = DECODE(CHG_T.FLG01, 'Y', MD.REP_CHG_CD, RT.CHG_CD ))  AS CHG001_S  " ).append("\n"); 
		query.append("       ,(SELECT NVL(SUM(RT.CHG_AMT),0) FROM BKG_CHG_RT RT, MDM_CHARGE  MD" ).append("\n"); 
		query.append("         WHERE  RT.BKG_NO                  = MN4.BKG_NO" ).append("\n"); 
		query.append("         AND    RT.CURR_CD                 = MN4.GRP_CUR" ).append("\n"); 
		query.append("         AND    RT.FRT_INCL_XCLD_DIV_CD(+) = 'N'" ).append("\n"); 
		query.append("         AND    RT.FRT_TERM_CD         (+) = MN4.FRT_TERM_CD" ).append("\n"); 
		query.append("#if (${frt_term_cd} != 'A')" ).append("\n"); 
		query.append("         AND RT.FRT_TERM_CD(+) = @[frt_term_cd]" ).append("\n"); 
		query.append("#end       " ).append("\n"); 
		query.append("         AND RT.CHG_CD  = MD.CHG_CD" ).append("\n"); 
		query.append("         AND CHG_T.CHG02  = DECODE(CHG_T.FLG02, 'Y', MD.REP_CHG_CD, RT.CHG_CD ))  AS CHG002_S  " ).append("\n"); 
		query.append("       ,(SELECT NVL(SUM(RT.CHG_AMT),0)" ).append("\n"); 
		query.append("         FROM   BKG_CHG_RT RT, MDM_CHARGE  MD" ).append("\n"); 
		query.append("         WHERE  RT.BKG_NO                  = MN4.BKG_NO" ).append("\n"); 
		query.append("         AND    RT.CURR_CD                 = MN4.GRP_CUR" ).append("\n"); 
		query.append("         AND    RT.FRT_INCL_XCLD_DIV_CD (+)='N'" ).append("\n"); 
		query.append("         AND    RT.FRT_TERM_CD          (+)= MN4.FRT_TERM_CD" ).append("\n"); 
		query.append("#if (${frt_term_cd} != 'A')" ).append("\n"); 
		query.append("         AND    RT.FRT_TERM_CD(+) = @[frt_term_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("         AND    RT.CHG_CD    = MD.CHG_CD" ).append("\n"); 
		query.append("         AND    CHG_T.CHG03  = DECODE(CHG_T.FLG03, 'Y', MD.REP_CHG_CD, RT.CHG_CD ))  AS CHG003_S" ).append("\n"); 
		query.append("       ,(SELECT NVL(SUM(RT.CHG_AMT),0)" ).append("\n"); 
		query.append("         FROM   BKG_CHG_RT RT, MDM_CHARGE  MD" ).append("\n"); 
		query.append("         WHERE  RT.BKG_NO                  = MN4.BKG_NO" ).append("\n"); 
		query.append("         AND    RT.CURR_CD                 = MN4.GRP_CUR" ).append("\n"); 
		query.append("         AND    RT.FRT_INCL_XCLD_DIV_CD(+) = 'N'" ).append("\n"); 
		query.append("         AND    RT.FRT_TERM_CD         (+) = MN4.FRT_TERM_CD" ).append("\n"); 
		query.append("#if (${frt_term_cd} != 'A')" ).append("\n"); 
		query.append("         AND    RT.FRT_TERM_CD(+) = @[frt_term_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("         AND    RT.CHG_CD  = MD.CHG_CD" ).append("\n"); 
		query.append("         AND    CHG_T.CHG04  = DECODE(CHG_T.FLG04, 'Y', MD.REP_CHG_CD, RT.CHG_CD ))  AS CHG004_S" ).append("\n"); 
		query.append("        ,(SELECT NVL(SUM(RT.CHG_AMT),0) FROM BKG_CHG_RT RT, MDM_CHARGE  MD" ).append("\n"); 
		query.append("         WHERE   RT.BKG_NO = MN4.BKG_NO" ).append("\n"); 
		query.append("         AND     RT.CURR_CD  = MN4.GRP_CUR" ).append("\n"); 
		query.append("         AND     RT.FRT_INCL_XCLD_DIV_CD(+) ='N'" ).append("\n"); 
		query.append("         AND     RT.FRT_TERM_CD(+) = MN4.FRT_TERM_CD" ).append("\n"); 
		query.append("#if (${frt_term_cd} != 'A')" ).append("\n"); 
		query.append("         AND RT.FRT_TERM_CD(+) = @[frt_term_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("         AND RT.CHG_CD  = MD.CHG_CD" ).append("\n"); 
		query.append("         AND CHG_T.CHG05  = DECODE(CHG_T.FLG05, 'Y', MD.REP_CHG_CD, RT.CHG_CD))  AS CHG005_S" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(SELECT   NVL(MAX(DECODE(SEQ, 1, CHG_CD)),'XXX') AS CHG01" ).append("\n"); 
		query.append("        , NVL(MAX(DECODE(SEQ, 1, CPRT_CHG_GRP_FLG)),'N') AS FLG01" ).append("\n"); 
		query.append("        , NVL(MAX(DECODE(SEQ, 2, CHG_CD)),'XXX') AS CHG02" ).append("\n"); 
		query.append("        , NVL(MAX(DECODE(SEQ, 2, CPRT_CHG_GRP_FLG)),'N') AS FLG02" ).append("\n"); 
		query.append("        , NVL(MAX(DECODE(SEQ, 3, CHG_CD)),'XXX') AS CHG03" ).append("\n"); 
		query.append("        , NVL(MAX(DECODE(SEQ, 3, CPRT_CHG_GRP_FLG)),'N') AS FLG03" ).append("\n"); 
		query.append("        , NVL(MAX(DECODE(SEQ, 4, CHG_CD)),'XXX') AS CHG04" ).append("\n"); 
		query.append("        , NVL(MAX(DECODE(SEQ, 4, CPRT_CHG_GRP_FLG)),'N') AS FLG04" ).append("\n"); 
		query.append("        , NVL(MAX(DECODE(SEQ, 5, CHG_CD)),'XXX') AS CHG05" ).append("\n"); 
		query.append("        , NVL(MAX(DECODE(SEQ, 5, CPRT_CHG_GRP_FLG)),'N') AS FLG05" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("        SELECT  DP_SEQ, CHG_CD, cprt_chg_grp_flg" ).append("\n"); 
		query.append("                , ROW_NUMBER() OVER ( ORDER BY CPRT_TP_CTNT,CPRT_VAL_CTNT,DP_SEQ) AS SEQ" ).append("\n"); 
		query.append("        FROM    INV_CPRT_TMPLT_CHG" ).append("\n"); 
		query.append("        WHERE   1=1" ).append("\n"); 
		query.append("        AND     AR_OFC_CD       = @[ar_ofc_cd]" ).append("\n"); 
		query.append("        AND     RPT_TMPLT_NM    = @[rpt_tmplt_nm]" ).append("\n"); 
		query.append("#if (${sc_no} != '')" ).append("\n"); 
		query.append("        AND     CPRT_TP_CTNT    = 'S'" ).append("\n"); 
		query.append("        AND     CPRT_VAL_CTNT = @[sc_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${rfa_no} != '')" ).append("\n"); 
		query.append("        AND     CPRT_TP_CTNT    = 'R'" ).append("\n"); 
		query.append("        AND     CPRT_VAL_CTNT = @[rfa_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append(") CHG_T" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT   MN3.BKG_NO" ).append("\n"); 
		query.append("       /*  BKG MAIN */" ).append("\n"); 
		query.append("        ,MN3.BL_NO" ).append("\n"); 
		query.append("        ,MN3.RFA_NO" ).append("\n"); 
		query.append("        ,MN3.SC_NO" ).append("\n"); 
		query.append("        ,MN3.SCAC_CD " ).append("\n"); 
		query.append("        ,MN3.BKG_OFC_CD " ).append("\n"); 
		query.append("        ,MN3.POR_CD " ).append("\n"); 
		query.append("        ,MN3.POD_CD " ).append("\n"); 
		query.append("        ,MN3.POL_CD " ).append("\n"); 
		query.append("        ,MN3.DEL_CD " ).append("\n"); 
		query.append("        ,MN3.FNL_DEST_CD" ).append("\n"); 
		query.append("        ,MN3.RCV_TERM_CD" ).append("\n"); 
		query.append("        ,MN3.DE_TERM_CD" ).append("\n"); 
		query.append("        ,MN3.DEST_TRNS_SVC_MOD_CD" ).append("\n"); 
		query.append("        ,MN3.CMDT_CD" ).append("\n"); 
		query.append("        ,MN3.FNL_DEST_NM" ).append("\n"); 
		query.append("        ,MN3.TOT_PCK_QTY" ).append("\n"); 
		query.append("        ,MN3.TOT_PCK_TP" ).append("\n"); 
		query.append("        ,MN3.ACT_WGT" ).append("\n"); 
		query.append("        ,MN3.TOT_WGT_UT_CD" ).append("\n"); 
		query.append("        ,MN3.TOT_MEAS_QTY" ).append("\n"); 
		query.append("        ,MN3.MEAS_UT_CD" ).append("\n"); 
		query.append("        ,MN3.VSL_NM" ).append("\n"); 
		query.append("        ,MN3.CSTMS_DESC" ).append("\n"); 
		query.append("      /* CUSTOMER */" ).append("\n"); 
		query.append("        ,MN3.CONSIGNEE" ).append("\n"); 
		query.append("        ,MN3.CN_GROUP_CUST" ).append("\n"); 
		query.append("        ,MN3.NOTIFY_PARTY" ).append("\n"); 
		query.append("        ,MN3.SHIPPER" ).append("\n"); 
		query.append("        ,MN3.SH_GROUP_CUST" ).append("\n"); 
		query.append("        ,MN3.CONSIGNEE_NM" ).append("\n"); 
		query.append("        ,MN3.CN_GROUP_CUST_NM" ).append("\n"); 
		query.append("        ,MN3.NOTIFY_PARTY_NM" ).append("\n"); 
		query.append("        ,MN3.SHIPPER_NM" ).append("\n"); 
		query.append("        ,MN3.SHIPPER_ADDR" ).append("\n"); 
		query.append("        ,MN3.FORWARDER_ADDR" ).append("\n"); 
		query.append("        ,MN3.ACTUAL_CUST_NM" ).append("\n"); 
		query.append("        ,MN3.BKG_CNTC_EMAIL" ).append("\n"); 
		query.append("        ,MN3.BKG_CNTC_NM" ).append("\n"); 
		query.append("       /* ROUTE CONDITION */" ).append("\n"); 
		query.append("        ,MN3.PRE_RELAY_PORT" ).append("\n"); 
		query.append("        ,MN3.POST_RELAY_PORT" ).append("\n"); 
		query.append("        ,MN3.T_VVD" ).append("\n"); 
		query.append("        ,MN3.T_LANE" ).append("\n"); 
		query.append("        ,MN3.FST_VVD" ).append("\n"); 
		query.append("       /* DATE,TIME */" ).append("\n"); 
		query.append("        ,MN3.OBRD_DT" ).append("\n"); 
		query.append("        ,MN3.F_POL_ETA" ).append("\n"); 
		query.append("        ,MN3.F_POL_ETD" ).append("\n"); 
		query.append("        ,MN3.T_POL_ETA" ).append("\n"); 
		query.append("        ,MN3.T_POL_ETD" ).append("\n"); 
		query.append("        ,MN3.T_POD_ETA" ).append("\n"); 
		query.append("        ,MN3.T_POD_ETD" ).append("\n"); 
		query.append("        ,MN3.L_POD_ETA" ).append("\n"); 
		query.append("        ,MN3.L_POD_ETD" ).append("\n"); 
		query.append("        ,MN3.DUEDT" ).append("\n"); 
		query.append("        ,MN3.BILL_CUST" ).append("\n"); 
		query.append("        ,MN3.THR_CUST" ).append("\n"); 
		query.append("        ,MN3.OTS_OFC" ).append("\n"); 
		query.append("        ,MN3.FRT_TERM_CD" ).append("\n"); 
		query.append("        ,MN3.CR_TERM " ).append("\n"); 
		query.append("        ,MN3.GL_EX " ).append("\n"); 
		query.append("        ,MN3.LCL_TOT" ).append("\n"); 
		query.append("        ,MN3.USD_TOT" ).append("\n"); 
		query.append("        ,MN3.OVER_DUE" ).append("\n"); 
		query.append("        ,MN3.AUD_STS_CD" ).append("\n"); 
		query.append("        ,MN3.GRP_CUR" ).append("\n"); 
		query.append("        ,MN3.TOT_CURR_AMT" ).append("\n"); 
		query.append("        ,CHG2.CHG_CD" ).append("\n"); 
		query.append("        ,CHG2.CURR_CD AS CHG_CURR" ).append("\n"); 
		query.append("        ,CHG2.RAT_AS_QTY AS CHG_RATED_AS" ).append("\n"); 
		query.append("        ,CHG2.CHG_UT_AMT AS CHG_RATE" ).append("\n"); 
		query.append("        ,SUM(CHG2.CHG_AMT) AS CHG_SUM" ).append("\n"); 
		query.append("        ,MN3.RT_APLY_DT" ).append("\n"); 
		query.append("        ,MN3.COP_DEL_ETA" ).append("\n"); 
		query.append("        ,MN3.VSK_DEL_ETA" ).append("\n"); 
		query.append("        ,MN3.PRT_NO" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT   MN2.BKG_NO" ).append("\n"); 
		query.append("       /*  BKG MAIN */" ).append("\n"); 
		query.append("        ,MN2.BL_NO" ).append("\n"); 
		query.append("        ,MN2.RFA_NO" ).append("\n"); 
		query.append("        ,MN2.SC_NO" ).append("\n"); 
		query.append("        ,MN2.SCAC_CD" ).append("\n"); 
		query.append("        ,MN2.BKG_OFC_CD" ).append("\n"); 
		query.append("        ,MN2.POR_CD" ).append("\n"); 
		query.append("        ,MN2.POD_CD" ).append("\n"); 
		query.append("        ,MN2.POL_CD" ).append("\n"); 
		query.append("        ,MN2.DEL_CD" ).append("\n"); 
		query.append("        ,MN2.FNL_DEST_CD" ).append("\n"); 
		query.append("        ,MN2.RCV_TERM_CD" ).append("\n"); 
		query.append("        ,MN2.DE_TERM_CD" ).append("\n"); 
		query.append("        ,MN2.DEST_TRNS_SVC_MOD_CD" ).append("\n"); 
		query.append("        ,MN2.CMDT_CD" ).append("\n"); 
		query.append("        ,MN2.FNL_DEST_NM" ).append("\n"); 
		query.append("        ,MN2.TOT_PCK_QTY" ).append("\n"); 
		query.append("        ,MN2.TOT_PCK_TP" ).append("\n"); 
		query.append("        ,MN2.ACT_WGT" ).append("\n"); 
		query.append("        ,MN2.TOT_WGT_UT_CD" ).append("\n"); 
		query.append("        ,MN2.TOT_MEAS_QTY" ).append("\n"); 
		query.append("        ,MN2.MEAS_UT_CD" ).append("\n"); 
		query.append("        ,MN2.VSL_NM" ).append("\n"); 
		query.append("        ,MN2.CSTMS_DESC" ).append("\n"); 
		query.append("      /* CUSTOMER */" ).append("\n"); 
		query.append("        ,MN2.CONSIGNEE" ).append("\n"); 
		query.append("        ,MN2.CN_GROUP_CUST" ).append("\n"); 
		query.append("        ,MN2.NOTIFY_PARTY" ).append("\n"); 
		query.append("        ,MN2.SHIPPER" ).append("\n"); 
		query.append("        ,MN2.SH_GROUP_CUST" ).append("\n"); 
		query.append("        ,MN2.CONSIGNEE_NM" ).append("\n"); 
		query.append("        ,MN2.CN_GROUP_CUST_NM" ).append("\n"); 
		query.append("        ,MN2.NOTIFY_PARTY_NM" ).append("\n"); 
		query.append("        ,MN2.SHIPPER_NM" ).append("\n"); 
		query.append("        ,MN2.SHIPPER_ADDR" ).append("\n"); 
		query.append("        ,MN2.FORWARDER_ADDR" ).append("\n"); 
		query.append("        ,MN2.ACTUAL_CUST_NM" ).append("\n"); 
		query.append("        ,MN2.BKG_CNTC_EMAIL" ).append("\n"); 
		query.append("        ,MN2.BKG_CNTC_NM" ).append("\n"); 
		query.append("       /* ROUTE CONDITION */" ).append("\n"); 
		query.append("        ,MN2.PRE_RELAY_PORT" ).append("\n"); 
		query.append("        ,MN2.POST_RELAY_PORT" ).append("\n"); 
		query.append("        ,MN2.T_VVD" ).append("\n"); 
		query.append("        ,MN2.T_LANE" ).append("\n"); 
		query.append("        ,MN2.FST_VVD" ).append("\n"); 
		query.append("       /* DATE,TIME */" ).append("\n"); 
		query.append("        ,MN2.OBRD_DT" ).append("\n"); 
		query.append("        ,SUBSTR(MN2.F_POL_ETAETD,1,8)  AS F_POL_ETA" ).append("\n"); 
		query.append("        ,SUBSTR(MN2.F_POL_ETAETD,9,8)  AS F_POL_ETD" ).append("\n"); 
		query.append("        ,SUBSTR(MN2.T_POL_ETAETD,1,8)  AS T_POL_ETA" ).append("\n"); 
		query.append("        ,SUBSTR(MN2.T_POL_ETAETD,9,8)  AS T_POL_ETD" ).append("\n"); 
		query.append("        ,SUBSTR(MN2.T_POD_ETAETD,1,8)  AS T_POD_ETA" ).append("\n"); 
		query.append("        ,SUBSTR(MN2.T_POD_ETAETD,9,8)  AS T_POD_ETD" ).append("\n"); 
		query.append("      	,SUBSTR(MN2.L_POD_ETAETD,1,8)  AS L_POD_ETA" ).append("\n"); 
		query.append("      	,SUBSTR(MN2.L_POD_ETAETD,9,8)  AS L_POD_ETD" ).append("\n"); 
		query.append("        ,DECODE(CHG.FRT_TERM_CD, 'P', TO_CHAR(TO_DATE(SUBSTR(MN2.F_POL_ETAETD,9,8),'YYYYMMDD')  " ).append("\n"); 
		query.append("                                             + DECODE(NVL(MN2.OB_CUST_CRTERM, 0),0, MN2.OB_OFC_CRTERM, MN2.OB_CUST_CRTERM ),'YYYYMMDD')" ).append("\n"); 
		query.append("                                    , TO_CHAR((TO_DATE(SUBSTR(MN2.L_POD_ETAETD,1,8),'YYYYMMDD')  " ).append("\n"); 
		query.append("                                             + DECODE(NVL(MN2.IB_CUST_CRTERM, 0),0, MN2.IB_OFC_CRTERM ,MN2.IB_CUST_CRTERM)),'YYYYMMDD')" ).append("\n"); 
		query.append("                                             ) AS DUEDT" ).append("\n"); 
		query.append("        ,DECODE(CHG.FRT_TERM_CD, 'P' ,MN2.PPD_CUST, MN2.CCT_CUST ) AS BILL_CUST" ).append("\n"); 
		query.append("        ,MN2.THR_CUST" ).append("\n"); 
		query.append("        ,DECODE(CHG.FRT_TERM_CD, 'P' ,MN2.PPD_OFC, MN2.CCT_OFC ) AS OTS_OFC" ).append("\n"); 
		query.append("        ,DECODE(CHG.FRT_TERM_CD, 'P'  ,DECODE(NVL(MN2.OB_CUST_CRTERM, 0),0, MN2.OB_OFC_CRTERM, NVL(MN2.OB_CUST_CRTERM, 0))" ).append("\n"); 
		query.append("                                      ,DECODE(NVL(MN2.IB_CUST_CRTERM, 0),0, MN2.IB_OFC_CRTERM, NVL(MN2.IB_CUST_CRTERM, 0))) AS CR_TERM " ).append("\n"); 
		query.append("                                    " ).append("\n"); 
		query.append("        ,DECODE(CHG.FRT_TERM_CD, 'P'  ,(TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'YYYYMMDD')" ).append("\n"); 
		query.append("                                         - (TO_DATE(SUBSTR(MN2.F_POL_ETAETD,9,8),'YYYYMMDD')  " ).append("\n"); 
		query.append("                                             + DECODE(NVL(MN2.OB_CUST_CRTERM, 0),0, MN2.OB_OFC_CRTERM, MN2.OB_CUST_CRTERM ))) " ).append("\n"); 
		query.append("                                      ,(TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'YYYYMMDD')" ).append("\n"); 
		query.append("                                         - (TO_DATE(SUBSTR(MN2.L_POD_ETAETD,1,8),'YYYYMMDD')  " ).append("\n"); 
		query.append("                                             + DECODE(NVL(MN2.IB_CUST_CRTERM, 0),0, MN2.IB_OFC_CRTERM, MN2.IB_CUST_CRTERM )))) AS OVER_DUE" ).append("\n"); 
		query.append("        ,DECODE( CHG.FRT_TERM_CD, 'P' ,MN2.GL_EX_PPD ,MN2.GL_EX_CCT     ) AS GL_EX" ).append("\n"); 
		query.append("        ,DECODE( CHG.FRT_TERM_CD, 'P' ,MN2.LCL_TOT_PPD, MN2.LCL_TOT_CCT ) AS LCL_TOT" ).append("\n"); 
		query.append("        ,DECODE( CHG.FRT_TERM_CD, 'P' ,MN2.USD_TOT_PPD, MN2.USD_TOT_CCT ) AS USD_TOT" ).append("\n"); 
		query.append("        ,CHG.FRT_TERM_CD " ).append("\n"); 
		query.append("        ,MN2.AUD_STS_CD" ).append("\n"); 
		query.append("        ,CHG.CURR_CD AS GRP_CUR " ).append("\n"); 
		query.append("        ,SUM(CHG.CHG_AMT) AS TOT_CURR_AMT " ).append("\n"); 
		query.append("        ,MN2.RT_APLY_DT" ).append("\n"); 
		query.append("        ,MN2.COP_DEL_ETA" ).append("\n"); 
		query.append("        ,MN2.VSK_DEL_ETA" ).append("\n"); 
		query.append("        ,MN2.PRT_NO" ).append("\n"); 
		query.append("FROM " ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT   MN.BKG_NO" ).append("\n"); 
		query.append("        ,MN.BL_NO" ).append("\n"); 
		query.append("        ,MN.RFA_NO" ).append("\n"); 
		query.append("        ,MN.SC_NO" ).append("\n"); 
		query.append("        ,MN.SCAC_CD " ).append("\n"); 
		query.append("        ,MN.BKG_OFC_CD " ).append("\n"); 
		query.append("        ,MN.POR_CD " ).append("\n"); 
		query.append("        ,MN.POD_CD " ).append("\n"); 
		query.append("        ,MN.POL_CD " ).append("\n"); 
		query.append("        ,MN.DEL_CD " ).append("\n"); 
		query.append("        ,MN.FNL_DEST_CD" ).append("\n"); 
		query.append("        ,MN.RCV_TERM_CD" ).append("\n"); 
		query.append("        ,MN.DE_TERM_CD" ).append("\n"); 
		query.append("        ,MN.DEST_TRNS_SVC_MOD_CD" ).append("\n"); 
		query.append("        ,MN.CMDT_CD" ).append("\n"); 
		query.append("        ,MN.FNL_DEST_NM" ).append("\n"); 
		query.append("        ,MN.TOT_PCK_QTY " ).append("\n"); 
		query.append("        ,MN.TOT_PCK_TP" ).append("\n"); 
		query.append("        ,MN.ACT_WGT" ).append("\n"); 
		query.append("        ,MN.TOT_WGT_UT_CD" ).append("\n"); 
		query.append("        ,MN.TOT_MEAS_QTY" ).append("\n"); 
		query.append("        ,MN.MEAS_UT_CD" ).append("\n"); 
		query.append("        ,MN.VSL_NM" ).append("\n"); 
		query.append("        ,MN.CSTMS_DESC" ).append("\n"); 
		query.append("        ,MN.CONSIGNEE " ).append("\n"); 
		query.append("        ,MN.CN_GROUP_CUST" ).append("\n"); 
		query.append("        ,MN.NOTIFY_PARTY" ).append("\n"); 
		query.append("        ,MN.SHIPPER " ).append("\n"); 
		query.append("        ,MN.SH_GROUP_CUST" ).append("\n"); 
		query.append("        ,MN.CONSIGNEE_NM" ).append("\n"); 
		query.append("        ,MN.CN_GROUP_CUST_NM" ).append("\n"); 
		query.append("        ,MN.NOTIFY_PARTY_NM" ).append("\n"); 
		query.append("        ,MN.SHIPPER_NM" ).append("\n"); 
		query.append("        ,MN.SHIPPER_ADDR" ).append("\n"); 
		query.append("        ,MN.FORWARDER_ADDR" ).append("\n"); 
		query.append("        ,MN.ACTUAL_CUST_NM" ).append("\n"); 
		query.append("        ,MN.BKG_CNTC_EMAIL" ).append("\n"); 
		query.append("        ,MN.BKG_CNTC_NM" ).append("\n"); 
		query.append("        ,MN.PRE_RELAY_PORT" ).append("\n"); 
		query.append("        ,MN.POST_RELAY_PORT" ).append("\n"); 
		query.append("        ,MN.T_VVD   " ).append("\n"); 
		query.append("        ,MN.T_LANE  " ).append("\n"); 
		query.append("        ,MN.FST_VVD" ).append("\n"); 
		query.append("        ,MN.OBRD_DT" ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(V1.VPS_ETA_DT,'YYYYMMDD')||TO_CHAR(V1.VPS_ETD_DT,'YYYYMMDD') AS ETAETD" ).append("\n"); 
		query.append("          FROM   VSK_VSL_PORT_SKD V1" ).append("\n"); 
		query.append("          WHERE  V1.VSL_CD       = SUBSTR(MN.FST_VVD,1,4)" ).append("\n"); 
		query.append("          AND    V1.SKD_VOY_NO   = SUBSTR(MN.FST_VVD,5,4)" ).append("\n"); 
		query.append("          AND    V1.SKD_DIR_CD   = SUBSTR(MN.FST_VVD,9,1)" ).append("\n"); 
		query.append("          AND    V1.VPS_PORT_CD  = MN.FST_POL" ).append("\n"); 
		query.append("          AND    V1.CLPT_IND_SEQ = (SELECT MAX(V2.CLPT_IND_SEQ)" ).append("\n"); 
		query.append("                                    FROM   VSK_VSL_PORT_SKD V2" ).append("\n"); 
		query.append("                                    WHERE  V2.VSL_CD      = SUBSTR(MN.FST_VVD,1,4)" ).append("\n"); 
		query.append("                                    AND    V2.SKD_VOY_NO  = SUBSTR(MN.FST_VVD,5,4)" ).append("\n"); 
		query.append("                                    AND    V2.SKD_DIR_CD  = SUBSTR(MN.FST_VVD,9,1)" ).append("\n"); 
		query.append("                                    AND    V2.VPS_PORT_CD = MN.FST_POL)" ).append("\n"); 
		query.append("        ) AS F_POL_ETAETD" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        ,MN.T_POL_ETAETD" ).append("\n"); 
		query.append("        ,MN.T_POD_ETAETD" ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(V3.VPS_ETA_DT,'YYYYMMDD')||TO_CHAR(V3.VPS_ETD_DT,'YYYYMMDD') AS ETAETD " ).append("\n"); 
		query.append("          FROM VSK_VSL_PORT_SKD V3" ).append("\n"); 
		query.append("          WHERE   V3.VSL_CD = SUBSTR(MN.LST_VVD,1,4)" ).append("\n"); 
		query.append("          AND     V3.SKD_VOY_NO = SUBSTR(MN.LST_VVD,5,4)" ).append("\n"); 
		query.append("          AND     V3.SKD_DIR_CD = SUBSTR(MN.LST_VVD,9,1)" ).append("\n"); 
		query.append("          AND     V3.VPS_PORT_CD = MN.LST_POD" ).append("\n"); 
		query.append("          AND     V3.CLPT_IND_SEQ = (SELECT MAX(V4.CLPT_IND_SEQ)" ).append("\n"); 
		query.append("                                     FROM   VSK_VSL_PORT_SKD V4" ).append("\n"); 
		query.append("                                     WHERE  V4.VSL_CD     = SUBSTR(MN.LST_VVD,1,4)" ).append("\n"); 
		query.append("                                     AND    V4.SKD_VOY_NO = SUBSTR(MN.LST_VVD,5,4)" ).append("\n"); 
		query.append("                                     AND    V4.SKD_DIR_CD = SUBSTR(MN.LST_VVD,9,1)" ).append("\n"); 
		query.append("                                     AND    V4.VPS_PORT_CD =  MN.LST_POD)" ).append("\n"); 
		query.append("        ) AS L_POD_ETAETD  " ).append("\n"); 
		query.append("      /*  RATE INV089 - INV112 */  " ).append("\n"); 
		query.append("        ,MN.CCT_CUST " ).append("\n"); 
		query.append("        ,MN.THR_CUST" ).append("\n"); 
		query.append("        ,MN.CCT_OFC " ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CR.IB_CR_TERM_DYS),0) FROM MDM_CR_CUST CR" ).append("\n"); 
		query.append("          WHERE CR.CUST_CNT_CD = SUBSTR(MN.CONSIGNEE,1,2)" ).append("\n"); 
		query.append("          AND CR.CUST_SEQ      = SUBSTR(MN.CONSIGNEE,3,6)  )  AS IB_CUST_CRTERM  " ).append("\n"); 
		query.append("        ,(SELECT M2.IB_CR_TERM_DYS " ).append("\n"); 
		query.append("          FROM  MDM_ORGANIZATION M1, MDM_ORGANIZATION M2" ).append("\n"); 
		query.append("          WHERE  M1.OFC_CD = MN.CCT_OFC" ).append("\n"); 
		query.append("          AND    M2.OFC_CD = M1.AR_OFC_CD)  AS IB_OFC_CRTERM" ).append("\n"); 
		query.append("        ,MN.GL_EX_CCT  " ).append("\n"); 
		query.append("        ,MN.LCL_TOT_CCT " ).append("\n"); 
		query.append("        ,MN.USD_TOT_CCT " ).append("\n"); 
		query.append("        ,MN.AUD_STS_CD" ).append("\n"); 
		query.append("        ,MN.PPD_CUST " ).append("\n"); 
		query.append("        ,MN.PPD_OFC  " ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CR2.IB_CR_TERM_DYS),0) FROM MDM_CR_CUST CR2" ).append("\n"); 
		query.append("          WHERE CR2.CUST_CNT_CD = SUBSTR(MN.SHIPPER,1,2)" ).append("\n"); 
		query.append("          AND CR2.CUST_SEQ =  SUBSTR(MN.SHIPPER,3,6)  ) AS OB_CUST_CRTERM" ).append("\n"); 
		query.append("        ,(SELECT M2.IB_CR_TERM_DYS " ).append("\n"); 
		query.append("          FROM   MDM_ORGANIZATION M1, MDM_ORGANIZATION M2" ).append("\n"); 
		query.append("          WHERE  M1.OFC_CD = MN.PPD_OFC" ).append("\n"); 
		query.append("          AND    M2.OFC_CD = M1.AR_OFC_CD)  AS OB_OFC_CRTERM" ).append("\n"); 
		query.append("        ,MN.GL_EX_PPD  " ).append("\n"); 
		query.append("        ,MN.LCL_TOT_PPD " ).append("\n"); 
		query.append("        ,MN.USD_TOT_PPD " ).append("\n"); 
		query.append("        ,MN.RT_APLY_DT " ).append("\n"); 
		query.append("        ,MN.COP_DEL_ETA  " ).append("\n"); 
		query.append("        ,MN.VSK_DEL_ETA" ).append("\n"); 
		query.append("        ,MN.PRT_NO" ).append("\n"); 
		query.append(" FROM " ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT   A.BKG_NO" ).append("\n"); 
		query.append("        ,A.BL_NO " ).append("\n"); 
		query.append("        ,A.SC_NO" ).append("\n"); 
		query.append("        ,A.RFA_NO " ).append("\n"); 
		query.append("        ,'SMLM' AS SCAC_CD --- ,'HJSC' AS SCAC_CD" ).append("\n"); 
		query.append("        ,A.BKG_OFC_CD" ).append("\n"); 
		query.append("        ,A.POR_CD" ).append("\n"); 
		query.append("        ,A.POD_CD " ).append("\n"); 
		query.append("        ,A.POL_CD" ).append("\n"); 
		query.append("        ,A.DEL_CD " ).append("\n"); 
		query.append("        ,A.FNL_DEST_CD" ).append("\n"); 
		query.append("        ,A.RCV_TERM_CD" ).append("\n"); 
		query.append("        ,A.DE_TERM_CD" ).append("\n"); 
		query.append("        ,A.DEST_TRNS_SVC_MOD_CD" ).append("\n"); 
		query.append("        ,A.CMDT_CD" ).append("\n"); 
		query.append("        ,B.FNL_DEST_NM" ).append("\n"); 
		query.append("        ,B.PCK_QTY AS TOT_PCK_QTY" ).append("\n"); 
		query.append("        ,B.PCK_TP_CD AS TOT_PCK_TP" ).append("\n"); 
		query.append("        ,B.ACT_WGT" ).append("\n"); 
		query.append("        ,B.WGT_UT_CD AS TOT_WGT_UT_CD" ).append("\n"); 
		query.append("        ,B.MEAS_QTY  AS TOT_MEAS_QTY" ).append("\n"); 
		query.append("        ,B.MEAS_UT_CD" ).append("\n"); 
		query.append("        ,B.VSL_NM" ).append("\n"); 
		query.append("        ,B.CSTMS_DESC" ).append("\n"); 
		query.append("       /* CUSTOMER  */   " ).append("\n"); 
		query.append("        ,( SELECT C1.CUST_CNT_CD||LPAD(TO_CHAR(C1.CUST_SEQ),6,'0')" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C1" ).append("\n"); 
		query.append("           WHERE  C1.BKG_NO = A.BKG_NO AND C1.BKG_CUST_TP_CD ='C' ) AS CONSIGNEE " ).append("\n"); 
		query.append("        ,( SELECT C1.CUST_NM" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C1" ).append("\n"); 
		query.append("           WHERE  C1.BKG_NO = A.BKG_NO AND C1.BKG_CUST_TP_CD ='C' ) AS CONSIGNEE_NM " ).append("\n"); 
		query.append("        ,(SELECT  SUBSTR(L1.CUST_GRP_ID,3,2)||SUBSTR(L1.CUST_GRP_ID,5,6)" ).append("\n"); 
		query.append("          FROM    MDM_CUSTOMER L1, BKG_CUSTOMER C3" ).append("\n"); 
		query.append("          WHERE   C3.BKG_NO = A.BKG_NO " ).append("\n"); 
		query.append("          AND     C3.CUST_CNT_CD = L1.CUST_CNT_CD " ).append("\n"); 
		query.append("          AND     C3.CUST_SEQ    = L1.CUST_SEQ" ).append("\n"); 
		query.append("          AND     C3.BKG_CUST_TP_CD = 'C'  AND C3.BKG_NO=A.BKG_NO )  AS CN_GROUP_CUST " ).append("\n"); 
		query.append("        ,(SELECT  C3.CUST_NM" ).append("\n"); 
		query.append("          FROM    MDM_CUSTOMER L1, BKG_CUSTOMER C3" ).append("\n"); 
		query.append("          WHERE   C3.BKG_NO = A.BKG_NO " ).append("\n"); 
		query.append("          AND     C3.CUST_CNT_CD = L1.CUST_CNT_CD " ).append("\n"); 
		query.append("          AND     C3.CUST_SEQ    = L1.CUST_SEQ" ).append("\n"); 
		query.append("          AND     C3.BKG_CUST_TP_CD = 'C'  AND C3.BKG_NO=A.BKG_NO )  AS CN_GROUP_CUST_NM  " ).append("\n"); 
		query.append("        ,(SELECT  C5.CUST_CNT_CD||LPAD(TO_CHAR(C5.CUST_SEQ),6,'0')" ).append("\n"); 
		query.append("          FROM    BKG_CUSTOMER C5" ).append("\n"); 
		query.append("          WHERE C5.BKG_NO=A.BKG_NO AND C5.BKG_CUST_TP_CD ='N'  ) AS NOTIFY_PARTY  " ).append("\n"); 
		query.append("        ,(SELECT C5.CUST_NM" ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C5" ).append("\n"); 
		query.append("          WHERE C5.BKG_NO=A.BKG_NO AND C5.BKG_CUST_TP_CD ='N'  ) AS NOTIFY_PARTY_NM   " ).append("\n"); 
		query.append("        ,(SELECT C7.CUST_CNT_CD||LPAD(TO_CHAR(C7.CUST_SEQ),6,'0')" ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C7" ).append("\n"); 
		query.append("          WHERE C7.BKG_NO=A.BKG_NO AND C7.BKG_CUST_TP_CD ='S' )AS SHIPPER  " ).append("\n"); 
		query.append("        ,(SELECT C7.CUST_NM" ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C7" ).append("\n"); 
		query.append("          WHERE C7.BKG_NO=A.BKG_NO AND C7.BKG_CUST_TP_CD ='S' )AS SHIPPER_NM  " ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(L3.CUST_GRP_ID,3,2)||SUBSTR(L3.CUST_GRP_ID,5,6)" ).append("\n"); 
		query.append("          FROM   MDM_CUSTOMER L3, BKG_CUSTOMER C9" ).append("\n"); 
		query.append("          WHERE  C9.BKG_NO         = A.BKG_NO  " ).append("\n"); 
		query.append("          AND    C9.CUST_CNT_CD    = L3.CUST_CNT_CD " ).append("\n"); 
		query.append("          AND    C9.CUST_SEQ       = L3.CUST_SEQ" ).append("\n"); 
		query.append("          AND    C9.BKG_CUST_TP_CD = 'S' ) AS SH_GROUP_CUST" ).append("\n"); 
		query.append("        ,(SELECT C9.CUST_ADDR" ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C9" ).append("\n"); 
		query.append("          WHERE C9.BKG_NO=A.BKG_NO AND C9.BKG_CUST_TP_CD ='S' )AS SHIPPER_ADDR     " ).append("\n"); 
		query.append("        ,(SELECT C9.CUST_NM" ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C9" ).append("\n"); 
		query.append("          WHERE C9.BKG_NO=A.BKG_NO AND C9.BKG_CUST_TP_CD ='F' )AS FORWARDER_ADDR" ).append("\n"); 
		query.append("        ,(SELECT C9.CUST_NM" ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C9" ).append("\n"); 
		query.append("          WHERE C9.BKG_NO=A.BKG_NO AND C9.BKG_CUST_TP_CD ='E' )AS ACTUAL_CUST_NM" ).append("\n"); 
		query.append("        ,(SELECT C10.CNTC_PSON_EML" ).append("\n"); 
		query.append("          FROM BKG_CNTC_PSON C10" ).append("\n"); 
		query.append("          WHERE C10.BKG_NO=A.BKG_NO AND C10.BKG_CNTC_PSON_TP_CD ='BK' )AS BKG_CNTC_EMAIL" ).append("\n"); 
		query.append("        ,(SELECT C11.CNTC_PSON_NM" ).append("\n"); 
		query.append("          FROM BKG_CNTC_PSON C11" ).append("\n"); 
		query.append("          WHERE C11.BKG_NO=A.BKG_NO AND C11.BKG_CNTC_PSON_TP_CD ='BK' )AS BKG_CNTC_NM" ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("       /* ROUTE CONDITION */" ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_DESC( K1 XPKBKG_VVD ) */ " ).append("\n"); 
		query.append("                 K1.POL_CD  " ).append("\n"); 
		query.append("          FROM   BKG_VVD K1" ).append("\n"); 
		query.append("          WHERE  K1.BKG_NO         = A.BKG_NO" ).append("\n"); 
		query.append("          AND    K1.VSL_PRE_PST_CD = 'S'  AND ROWNUM = 1 )  AS PRE_RELAY_PORT " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX( K2 XPKBKG_VVD ) */" ).append("\n"); 
		query.append("                       K2.POL_CD" ).append("\n"); 
		query.append("         FROM    BKG_VVD K2" ).append("\n"); 
		query.append("         WHERE   K2.BKG_NO         = A.BKG_NO" ).append("\n"); 
		query.append("         AND     K2.VSL_PRE_PST_CD = 'U' AND ROWNUM = 1 )   AS POST_RELAY_PORT  " ).append("\n"); 
		query.append("                                                                                    " ).append("\n"); 
		query.append("       /*  VESSEL  */" ).append("\n"); 
		query.append("        ,(SELECT K3.VSL_CD||K3.SKD_VOY_NO||K3.SKD_DIR_CD  " ).append("\n"); 
		query.append("          FROM BKG_VVD K3" ).append("\n"); 
		query.append("          WHERE K3.BKG_NO = A.BKG_NO AND K3.VSL_PRE_PST_CD ='T' ) AS T_VVD   " ).append("\n"); 
		query.append("        ,(SELECT K4.SLAN_CD FROM BKG_VVD K4" ).append("\n"); 
		query.append("          WHERE K4.BKG_NO = A.BKG_NO AND K4.VSL_PRE_PST_CD ='T'  ) AS T_LANE " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX( K5 XPKBKG_VVD ) */" ).append("\n"); 
		query.append("                K5.VSL_CD||K5.SKD_VOY_NO||K5.SKD_DIR_CD " ).append("\n"); 
		query.append("          FROM  BKG_VVD K5" ).append("\n"); 
		query.append("          WHERE K5.BKG_NO = A.BKG_NO  AND  ROWNUM = 1) AS FST_VVD    " ).append("\n"); 
		query.append("       /* DATE,TIME */" ).append("\n"); 
		query.append("        ,TO_CHAR(B.BL_OBRD_DT,'YYYY-MM-DD')  AS OBRD_DT   " ).append("\n"); 
		query.append("        ,A.POL_CD  AS FST_POL " ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(KK.VPS_ETA_DT,'YYYYMMDD')||TO_CHAR(KK.VPS_ETD_DT,'YYYYMMDD') AS ETAETD " ).append("\n"); 
		query.append("          FROM VSK_VSL_PORT_SKD KK, BKG_VVD BB" ).append("\n"); 
		query.append("          WHERE   KK.VSL_CD = BB.VSL_CD" ).append("\n"); 
		query.append("          AND     KK.SKD_VOY_NO = BB.SKD_VOY_NO" ).append("\n"); 
		query.append("          AND     KK.SKD_DIR_CD = BB.SKD_DIR_CD" ).append("\n"); 
		query.append("          AND     KK.VPS_PORT_CD = BB.POL_CD" ).append("\n"); 
		query.append("          AND     BB.VSL_PRE_PST_CD='T'" ).append("\n"); 
		query.append("          AND     BB.BKG_NO = A.BKG_NO" ).append("\n"); 
		query.append("          AND     KK.CLPT_IND_SEQ = (SELECT MAX(CLPT_IND_SEQ) FROM VSK_VSL_PORT_SKD" ).append("\n"); 
		query.append("                                     WHERE  VSL_CD      = KK.VSL_CD" ).append("\n"); 
		query.append("                                     AND    SKD_VOY_NO  = KK.SKD_VOY_NO" ).append("\n"); 
		query.append("                                     AND    SKD_DIR_CD  = KK.SKD_DIR_CD" ).append("\n"); 
		query.append("                                     AND    VPS_PORT_CD = KK.VPS_PORT_CD)" ).append("\n"); 
		query.append("          ) AS T_POL_ETAETD     " ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(KK1.VPS_ETA_DT,'YYYYMMDD')||TO_CHAR(KK1.VPS_ETD_DT,'YYYYMMDD') AS ETAETD " ).append("\n"); 
		query.append("          FROM VSK_VSL_PORT_SKD KK1, BKG_VVD BB1" ).append("\n"); 
		query.append("          WHERE   KK1.VSL_CD         = BB1.VSL_CD" ).append("\n"); 
		query.append("          AND     KK1.SKD_VOY_NO     = BB1.SKD_VOY_NO" ).append("\n"); 
		query.append("          AND     KK1.SKD_DIR_CD     = BB1.SKD_DIR_CD" ).append("\n"); 
		query.append("          AND     KK1.VPS_PORT_CD    = BB1.POD_CD" ).append("\n"); 
		query.append("          AND     BB1.VSL_PRE_PST_CD = 'T'" ).append("\n"); 
		query.append("          AND     BB1.BKG_NO         = A.BKG_NO" ).append("\n"); 
		query.append("          AND     KK1.CLPT_IND_SEQ   = (SELECT MAX(CLPT_IND_SEQ)" ).append("\n"); 
		query.append("                                        FROM   VSK_VSL_PORT_SKD" ).append("\n"); 
		query.append("                                        WHERE  VSL_CD      = KK1.VSL_CD" ).append("\n"); 
		query.append("                                        AND    SKD_VOY_NO  = KK1.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND    SKD_DIR_CD  = KK1.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND    VPS_PORT_CD = KK1.VPS_PORT_CD)" ).append("\n"); 
		query.append("          ) AS T_POD_ETAETD           " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_DESC( K6 XPKBKG_VVD ) */ " ).append("\n"); 
		query.append("                 K6.VSL_CD||K6.SKD_VOY_NO||K6.SKD_DIR_CD " ).append("\n"); 
		query.append("          FROM  BKG_VVD K6" ).append("\n"); 
		query.append("          WHERE K6.BKG_NO = A.BKG_NO" ).append("\n"); 
		query.append("          AND  ROWNUM = 1)     AS LST_VVD " ).append("\n"); 
		query.append("        ,A.POD_CD   AS LST_POD  " ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(MAX(DECODE(COPD.ACT_CD, 'FITRDO', '1', '0') || NVL(TO_CHAR(COPD.PLN_DT, 'YYYYMMDDHH24MISS'), '00000000000000')" ).append("\n"); 
		query.append("                            || NVL(TO_CHAR(NVL(COPD.ACT_DT, COPD.ESTM_DT), 'YYYYMMDDHH24MISS'), '00000000000000')" ).append("\n"); 
		query.append("                            || COPD.NOD_CD ), 2,8)" ).append("\n"); 
		query.append("          FROM SCE_COP_HDR COPM  , SCE_COP_DTL COPD" ).append("\n"); 
		query.append("          WHERE COPM.BKG_NO(+) = A.BKG_NO " ).append("\n"); 
		query.append("          AND COPD.COP_NO = COPM.COP_NO" ).append("\n"); 
		query.append("          AND COPM.COP_STS_CD <> 'X'" ).append("\n"); 
		query.append("          AND COPD.ACT_CD IN ('FITRDO', 'FUVMAD')  " ).append("\n"); 
		query.append("         ) AS COP_DEL_ETA " ).append("\n"); 
		query.append("        ,(SELECT  TO_CHAR(VSKD.VPS_ETA_DT + DECODE(SUBSTR(A.POD_CD,1,2) , 'US', 2 , DECODE(A.POD_CD, A.DEL_CD, 1, 2)),'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM BKG_VVD BVVD, VSK_VSL_PORT_SKD VSKD" ).append("\n"); 
		query.append("          WHERE  BVVD.VSL_CD = VSKD.VSL_CD(+)  " ).append("\n"); 
		query.append("          AND  BVVD.SKD_VOY_NO = VSKD.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("          AND  BVVD.SKD_DIR_CD = VSKD.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("          AND  BVVD.POD_CD = VSKD.VPS_PORT_CD(+)" ).append("\n"); 
		query.append("          AND  BVVD.POD_CLPT_IND_SEQ = VSKD.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("          AND  A.BKG_NO = BVVD.BKG_NO" ).append("\n"); 
		query.append("          AND  A.POD_CD = BVVD.POD_CD" ).append("\n"); 
		query.append("          AND  ROWNUM = 1" ).append("\n"); 
		query.append("          ) AS VSK_DEL_ETA         " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("      /*  RATE  INV089 - INV112 */  " ).append("\n"); 
		query.append("        ,F.CLT_PAYR_CNT_CD||LPAD(TO_CHAR(F.CLT_PAYR_CUST_SEQ),6,'0') AS CCT_CUST   " ).append("\n"); 
		query.append("        ,(SELECT N3PTY_CUST_CNT_CD||LPAD(TO_CHAR(N3PTY_CUST_SEQ),6,'0') FROM BKG_CHG_RT" ).append("\n"); 
		query.append("          WHERE BKG_NO=A.BKG_NO " ).append("\n"); 
		query.append("          AND N3PTY_CUST_CNT_CD IS NOT NULL " ).append("\n"); 
		query.append("          AND N3PTY_CUST_SEQ IS NOT NULL AND ROWNUM=1) AS THR_CUST    " ).append("\n"); 
		query.append("        ,F.CLT_OFC_CD   AS CCT_OFC        " ).append("\n"); 
		query.append("        ,(SELECT GLM.USD_LOCL_XCH_RT " ).append("\n"); 
		query.append("          FROM BKG_CHG_RT R1, GL_MON_XCH_RT GLM" ).append("\n"); 
		query.append("          WHERE R1.BKG_NO = A.BKG_NO" ).append("\n"); 
		query.append("          AND R1.FRT_TERM_CD='C'" ).append("\n"); 
		query.append("          AND R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND GLM.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND GLM.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND GLM.CURR_CD =  (SELECT O2.AR_CURR_CD" ).append("\n"); 
		query.append("                              FROM MDM_ORGANIZATION O1, MDM_ORGANIZATION O2" ).append("\n"); 
		query.append("                              WHERE O1.OFC_CD =F.CLT_OFC_CD" ).append("\n"); 
		query.append("                              AND  O2.OFC_CD = O1.AR_OFC_CD) " ).append("\n"); 
		query.append("          AND ROWNUM=1 )      AS GL_EX_CCT " ).append("\n"); 
		query.append("       ,(SELECT SUM(ROUND(R1.CHG_AMT*(GL2.USD_LOCL_XCH_RT/GL1.USD_LOCL_XCH_RT),2))    " ).append("\n"); 
		query.append("         FROM BKG_CHG_RT R1, GL_MON_XCH_RT GL1, GL_MON_XCH_RT GL2 " ).append("\n"); 
		query.append("         WHERE R1.BKG_NO = A.BKG_NO" ).append("\n"); 
		query.append("         AND R1.FRT_TERM_CD='C'" ).append("\n"); 
		query.append("         AND R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("         AND GL1.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("         AND GL1.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("         AND GL1.CURR_CD = R1.CURR_CD" ).append("\n"); 
		query.append("         AND GL2.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("         AND GL2.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("         AND GL2.CURR_CD =  (SELECT O2.AR_CURR_CD" ).append("\n"); 
		query.append("                             FROM MDM_ORGANIZATION O1, MDM_ORGANIZATION O2" ).append("\n"); 
		query.append("                             WHERE O1.OFC_CD =F.CLT_OFC_CD" ).append("\n"); 
		query.append("                             AND  O2.OFC_CD = O1.AR_OFC_CD)   ) AS LCL_TOT_CCT --INV099" ).append("\n"); 
		query.append("        ,(SELECT SUM(ROUND(R1.CHG_AMT/GL1.USD_LOCL_XCH_RT,2))    " ).append("\n"); 
		query.append("          FROM BKG_CHG_RT R1, GL_MON_XCH_RT GL1 " ).append("\n"); 
		query.append("          WHERE R1.BKG_NO = A.BKG_NO" ).append("\n"); 
		query.append("          AND R1.FRT_TERM_CD ='C'" ).append("\n"); 
		query.append("          AND R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND GL1.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND GL1.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND GL1.CURR_CD = R1.CURR_CD            ) AS USD_TOT_CCT " ).append("\n"); 
		query.append("        ,F.AUD_STS_CD  AS AUD_STS_CD  " ).append("\n"); 
		query.append("        ,F.PPD_PAYR_CNT_CD||LPAD(TO_CHAR(F.PPD_PAYR_CUST_SEQ),6,'0') AS PPD_CUST" ).append("\n"); 
		query.append("        ,F.PPD_RCV_OFC_CD   AS PPD_OFC    " ).append("\n"); 
		query.append("        ,(SELECT GLM.USD_LOCL_XCH_RT " ).append("\n"); 
		query.append("          FROM BKG_CHG_RT R1, GL_MON_XCH_RT GLM" ).append("\n"); 
		query.append("          WHERE R1.BKG_NO = A.BKG_NO" ).append("\n"); 
		query.append("          AND R1.FRT_TERM_CD='P'" ).append("\n"); 
		query.append("          AND  R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND GLM.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND GLM.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND GLM.CURR_CD =  (SELECT O2.AR_CURR_CD" ).append("\n"); 
		query.append("                              FROM MDM_ORGANIZATION O1, MDM_ORGANIZATION O2" ).append("\n"); 
		query.append("                              WHERE O1.OFC_CD =F.PPD_RCV_OFC_CD" ).append("\n"); 
		query.append("                              AND  O2.OFC_CD = O1.AR_OFC_CD )" ).append("\n"); 
		query.append("          AND ROWNUM=1     )      AS GL_EX_PPD  " ).append("\n"); 
		query.append("        ,(SELECT SUM(ROUND(R2.CHG_AMT*(GL4.USD_LOCL_XCH_RT/GL3.USD_LOCL_XCH_RT),2))    " ).append("\n"); 
		query.append("          FROM BKG_CHG_RT R2, GL_MON_XCH_RT GL3, GL_MON_XCH_RT GL4" ).append("\n"); 
		query.append("          WHERE R2.BKG_NO = A.BKG_NO" ).append("\n"); 
		query.append("          AND   R2.FRT_TERM_CD ='P'" ).append("\n"); 
		query.append("          AND   R2.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND   GL3.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R2.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND   GL3.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND   GL3.CURR_CD = R2.CURR_CD" ).append("\n"); 
		query.append("          AND   GL4.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R2.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND   GL4.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND   GL4.CURR_CD =  (SELECT O2.AR_CURR_CD" ).append("\n"); 
		query.append("                                FROM MDM_ORGANIZATION O1, MDM_ORGANIZATION O2" ).append("\n"); 
		query.append("                                WHERE O1.OFC_CD =F.PPD_RCV_OFC_CD" ).append("\n"); 
		query.append("                                AND  O2.OFC_CD = O1.AR_OFC_CD)   ) AS LCL_TOT_PPD " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        ,(SELECT SUM(ROUND(R1.CHG_AMT/GL1.USD_LOCL_XCH_RT,2))    " ).append("\n"); 
		query.append("          FROM BKG_CHG_RT R1, GL_MON_XCH_RT GL1 " ).append("\n"); 
		query.append("          WHERE R1.BKG_NO = A.BKG_NO" ).append("\n"); 
		query.append("          AND R1.FRT_TERM_CD='P'" ).append("\n"); 
		query.append("          AND R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND GL1.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND GL1.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND GL1.CURR_CD = R1.CURR_CD            ) AS USD_TOT_PPD " ).append("\n"); 
		query.append("        ,TO_CHAR(F.RT_APLY_DT,'YYYY-MM-DD') RT_APLY_DT " ).append("\n"); 
		query.append("        ,REPLACE(substr(xmlagg(xmlelement(a,';' || T.PRT_NO) order by T.PRT_NO).extract('//text()'), 2),';;','') PRT_NO" ).append("\n"); 
		query.append("FROM   BKG_BOOKING A" ).append("\n"); 
		query.append("      ,BKG_BL_DOC B" ).append("\n"); 
		query.append("      ,BKG_RATE F" ).append("\n"); 
		query.append("      , BKG_REF_DTL T" ).append("\n"); 
		query.append("    #if (${cust_gb} == 'S' || ${cust_gb} == 'C' || ${cust_gb} == 'N')" ).append("\n"); 
		query.append("		#if (${cust_cnt_cd} != '' && ${cust_seq} != '')" ).append("\n"); 
		query.append("  	  ,BKG_CUSTOMER G " ).append("\n"); 
		query.append("  		#end" ).append("\n"); 
		query.append("  	#end" ).append("\n"); 
		query.append("  	#if (${date_gb} == '1STVVD' || ${date_gb} == 'ETA' || ${date_gb} == 'ETD')" ).append("\n"); 
		query.append("      , BKG_VVD             T11" ).append("\n"); 
		query.append("      , VSK_VSL_PORT_SKD    T12" ).append("\n"); 
		query.append("  	#end" ).append("\n"); 
		query.append("WHERE  1=1" ).append("\n"); 
		query.append("AND  A.BKG_NO = B.BKG_NO(+)" ).append("\n"); 
		query.append("AND  A.BKG_NO = F.BKG_NO(+)" ).append("\n"); 
		query.append("AND  A.BKG_NO = T.BKG_NO(+)" ).append("\n"); 
		query.append("AND  A.BKG_STS_CD IN ('F','S')" ).append("\n"); 
		query.append("AND  A.BKG_CGO_TP_CD <> 'P'" ).append("\n"); 
		query.append("#if (${sc_no} != '')" ).append("\n"); 
		query.append("AND		A.SC_NO = @[sc_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${rfa_no} != '')" ).append("\n"); 
		query.append("AND		A.RFA_NO = @[rfa_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_ofc_cd} != '')" ).append("\n"); 
		query.append("AND		A.BKG_OFC_CD = @[bkg_ofc_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${ob_sls_ofc_cd} != '')" ).append("\n"); 
		query.append("AND		A.OB_SLS_OFC_CD = @[ob_sls_ofc_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cust_gb} == 'S')" ).append("\n"); 
		query.append("	#if (${cust_cnt_cd} != '' && ${cust_seq} != '')" ).append("\n"); 
		query.append("		AND A.BKG_NO = G.BKG_NO(+)" ).append("\n"); 
		query.append("		AND G.BKG_CUST_TP_CD='S'" ).append("\n"); 
		query.append("		AND G.Cust_Cnt_Cd =@[cust_cnt_cd]" ).append("\n"); 
		query.append("		AND G.Cust_Seq = @[cust_seq]" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cust_gb} == 'C')" ).append("\n"); 
		query.append("	#if (${cust_cnt_cd} != '' && ${cust_seq} != '')" ).append("\n"); 
		query.append("		AND A.BKG_NO = G.BKG_NO(+)" ).append("\n"); 
		query.append("		AND G.BKG_CUST_TP_CD='C'" ).append("\n"); 
		query.append("		AND G.Cust_Cnt_Cd =@[cust_cnt_cd]" ).append("\n"); 
		query.append("		AND G.Cust_Seq = @[cust_seq]" ).append("\n"); 
		query.append("  	#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cust_gb} == 'N')" ).append("\n"); 
		query.append("	#if (${cust_cnt_cd} != '' && ${cust_seq} != '')" ).append("\n"); 
		query.append("		AND A.BKG_NO = G.BKG_NO(+)" ).append("\n"); 
		query.append("		AND G.BKG_CUST_TP_CD='N'" ).append("\n"); 
		query.append("		AND G.Cust_Cnt_Cd =@[cust_cnt_cd]" ).append("\n"); 
		query.append("		AND G.Cust_Seq = @[cust_seq]" ).append("\n"); 
		query.append("  	#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${del_cd} != '')" ).append("\n"); 
		query.append("AND  A.DEL_CD like @[del_cd]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${por_cd} != '')" ).append("\n"); 
		query.append("AND  A.POR_CD like @[por_cd]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${pol_cd} != '')" ).append("\n"); 
		query.append("AND  A.POL_CD like @[pol_cd]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${pod_cd} != '')" ).append("\n"); 
		query.append("AND  A.POD_CD like @[pod_cd]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${date_gb} == '1STVVD')" ).append("\n"); 
		query.append("AND     T11.BKG_NO  (+)      = A.BKG_NO" ).append("\n"); 
		query.append("AND     T11.VSL_CD           = T12.VSL_CD" ).append("\n"); 
		query.append("AND     T11.SKD_VOY_NO       = T12.SKD_VOY_NO" ).append("\n"); 
		query.append("AND     T11.SKD_DIR_CD       = T12.SKD_DIR_CD" ).append("\n"); 
		query.append("AND     T11.POL_CD           = T12.VPS_PORT_CD" ).append("\n"); 
		query.append("AND     T11.POL_YD_CD        = T12.YD_CD" ).append("\n"); 
		query.append("AND     T11.POL_CLPT_IND_SEQ = T12.CLPT_IND_SEQ" ).append("\n"); 
		query.append("AND     T11.ROWID            =" ).append("\n"); 
		query.append("        (" ).append("\n"); 
		query.append("        SELECT  SUBSTR(MIN( S.VSL_PRE_PST_CD || LTRIM( TO_CHAR( S.VSL_SEQ , '000') )  || ROWID ), 5) -- 1st VVD" ).append("\n"); 
		query.append("        FROM    BKG_VVD S" ).append("\n"); 
		query.append("        WHERE   1=1" ).append("\n"); 
		query.append("        AND     S.BKG_NO    = T11.BKG_NO" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("AND     T12.VPS_ETD_DT BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999" ).append("\n"); 
		query.append("AND		NVL(T12.SKD_CNG_STS_CD, ' ') <> 'S'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${date_gb} == 'ETD')" ).append("\n"); 
		query.append("	#if (${from_date} != '' && ${to_date} != '')" ).append("\n"); 
		query.append("AND     T11.BKG_NO  (+)      = A.BKG_NO" ).append("\n"); 
		query.append("AND     T11.VSL_CD           = T12.VSL_CD" ).append("\n"); 
		query.append("AND     T11.SKD_VOY_NO       = T12.SKD_VOY_NO" ).append("\n"); 
		query.append("AND     T11.SKD_DIR_CD       = T12.SKD_DIR_CD" ).append("\n"); 
		query.append("AND     T11.POL_CD           = T12.VPS_PORT_CD" ).append("\n"); 
		query.append("AND     T11.POL_YD_CD        = T12.YD_CD" ).append("\n"); 
		query.append("AND     T11.POL_CLPT_IND_SEQ = T12.CLPT_IND_SEQ" ).append("\n"); 
		query.append("AND     T11.VSL_PRE_PST_CD   = 'T'" ).append("\n"); 
		query.append("AND     T12.VPS_ETD_DT BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999" ).append("\n"); 
		query.append("AND		NVL(T12.SKD_CNG_STS_CD, ' ') <> 'S'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("#if (${date_gb} == 'ETA')" ).append("\n"); 
		query.append("	#if (${from_date} != '' && ${to_date} != '')" ).append("\n"); 
		query.append("AND     T11.BKG_NO  (+)      = A.BKG_NO" ).append("\n"); 
		query.append("AND     T11.VSL_CD           = T12.VSL_CD" ).append("\n"); 
		query.append("AND     T11.SKD_VOY_NO       = T12.SKD_VOY_NO" ).append("\n"); 
		query.append("AND     T11.SKD_DIR_CD       = T12.SKD_DIR_CD" ).append("\n"); 
		query.append("AND     T11.POD_CD           = T12.VPS_PORT_CD" ).append("\n"); 
		query.append("AND     T11.POD_YD_CD        = T12.YD_CD" ).append("\n"); 
		query.append("AND     T11.POD_CLPT_IND_SEQ = T12.CLPT_IND_SEQ" ).append("\n"); 
		query.append("AND     T11.VSL_PRE_PST_CD   = 'T'" ).append("\n"); 
		query.append("AND     T12.VPS_ETA_DT BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999" ).append("\n"); 
		query.append("AND		NVL(T12.SKD_CNG_STS_CD, ' ') <> 'S'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${date_gb} == 'OBD')" ).append("\n"); 
		query.append("	#if (${from_date} != '' && ${to_date} != '')" ).append("\n"); 
		query.append("AND B.BL_OBRD_DT between to_date(REPLACE(@[from_date],'-',''),'YYYYMMDD') and to_date(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("#if (${date_gb} == 'PCD')" ).append("\n"); 
		query.append("	#if (${from_date} != '' && ${to_date} != '')	" ).append("\n"); 
		query.append("AND A.PORT_CLZ_DT  between to_date(REPLACE(@[from_date],'-',''),'YYYYMMDD') and to_date(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("#if (${date_gb} == 'BDR')" ).append("\n"); 
		query.append("	#if (${from_date} != '' && ${to_date} != '')" ).append("\n"); 
		query.append("AND B.BDR_DT  between to_date(REPLACE(@[from_date],'-',''),'YYYYMMDD') and to_date(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("GROUP BY A.BKG_NO       ,A.BL_NO " ).append("\n"); 
		query.append("        ,A.SC_NO        ,A.RFA_NO " ).append("\n"); 
		query.append("        ,SCAC_CD        ,A.BKG_OFC_CD" ).append("\n"); 
		query.append("        ,A.POR_CD       ,A.POD_CD " ).append("\n"); 
		query.append("        ,A.POL_CD       ,A.DEL_CD " ).append("\n"); 
		query.append("        ,A.FNL_DEST_CD  ,A.RCV_TERM_CD" ).append("\n"); 
		query.append("        ,A.DE_TERM_CD   ,A.DEST_TRNS_SVC_MOD_CD" ).append("\n"); 
		query.append("        ,A.CMDT_CD      ,B.FNL_DEST_NM" ).append("\n"); 
		query.append("        ,B.PCK_QTY      ,B.PCK_TP_CD" ).append("\n"); 
		query.append("        ,B.ACT_WGT      ,B.WGT_UT_CD" ).append("\n"); 
		query.append("        ,B.MEAS_QTY     ,B.MEAS_UT_CD" ).append("\n"); 
		query.append("        ,B.VSL_NM       ,B.CSTMS_DESC" ).append("\n"); 
		query.append("        ,B.BL_OBRD_DT   ,F.CLT_PAYR_CNT_CD||LPAD(TO_CHAR(F.CLT_PAYR_CUST_SEQ),6,'0') " ).append("\n"); 
		query.append("        ,F.CLT_OFC_CD   ,F.AUD_STS_CD" ).append("\n"); 
		query.append("        ,F.PPD_PAYR_CNT_CD||LPAD(TO_CHAR(F.PPD_PAYR_CUST_SEQ),6,'0') " ).append("\n"); 
		query.append("        ,F.PPD_RCV_OFC_CD" ).append("\n"); 
		query.append("        ,F.RT_APLY_DT" ).append("\n"); 
		query.append(") MN" ).append("\n"); 
		query.append("WHERE 1=1" ).append("\n"); 
		query.append("#if (${cust_gb} == 'GS')" ).append("\n"); 
		query.append("	#if (${cust_cnt_cd} != '' && ${cust_seq} != '')" ).append("\n"); 
		query.append("AND MN.SH_GROUP_CUST = @[cust_cnt_cd] || @[cust_seq]" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("#if (${cust_gb} == 'GC')" ).append("\n"); 
		query.append("	#if (${cust_cnt_cd} != '' && ${cust_seq} != '')" ).append("\n"); 
		query.append("AND MN.CN_GROUP_CUST = @[cust_cnt_cd] || @[cust_seq]" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("#if (${date_gb} == 'ETD')" ).append("\n"); 
		query.append("	#if (${from_date} != '' && ${to_date} != '')" ).append("\n"); 
		query.append("AND SUBSTR(MN.T_POL_ETAETD, 9,8) between REPLACE(@[from_date],'-','') and REPLACE(@[to_date],'-','')" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("#if (${date_gb} == 'ETA')" ).append("\n"); 
		query.append("	#if (${from_date} != '' && ${to_date} != '')" ).append("\n"); 
		query.append("AND SUBSTR(MN.T_POD_ETAETD, 1,8) between REPLACE(@[from_date],'-','') and REPLACE(@[to_date],'-','')" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("#if (${vvd} != '')" ).append("\n"); 
		query.append("and MN.T_VVD = @[vvd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")MN2  /* TOT Rate Per Currency */" ).append("\n"); 
		query.append(",BKG_CHG_RT CHG" ).append("\n"); 
		query.append("WHERE MN2.BKG_NO  = CHG.BKG_NO(+)" ).append("\n"); 
		query.append("AND   CHG.FRT_INCL_XCLD_DIV_CD(+) ='N'" ).append("\n"); 
		query.append("#if (${frt_term_cd} != 'A')" ).append("\n"); 
		query.append("AND   CHG.FRT_TERM_CD(+) = @[frt_term_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY  MN2.BKG_NO             ,MN2.BL_NO" ).append("\n"); 
		query.append("         ,MN2.RFA_NO             ,MN2.SC_NO " ).append("\n"); 
		query.append("         ,MN2.SCAC_CD            ,MN2.BKG_OFC_CD " ).append("\n"); 
		query.append("         ,MN2.POR_CD             ,MN2.POD_CD " ).append("\n"); 
		query.append("         ,MN2.POL_CD             ,MN2.DEL_CD " ).append("\n"); 
		query.append("         ,MN2.FNL_DEST_CD        ,MN2.RCV_TERM_CD" ).append("\n"); 
		query.append("         ,MN2.DE_TERM_CD         ,MN2.DEST_TRNS_SVC_MOD_CD" ).append("\n"); 
		query.append("         ,MN2.CMDT_CD            ,MN2.FNL_DEST_NM" ).append("\n"); 
		query.append("         ,MN2.TOT_PCK_QTY        ,MN2.TOT_PCK_TP" ).append("\n"); 
		query.append("         ,MN2.ACT_WGT            ,MN2.TOT_WGT_UT_CD" ).append("\n"); 
		query.append("         ,MN2.TOT_MEAS_QTY       ,MN2.MEAS_UT_CD" ).append("\n"); 
		query.append("         ,MN2.VSL_NM             ,MN2.CSTMS_DESC" ).append("\n"); 
		query.append("         ,MN2.CONSIGNEE          ,MN2.CN_GROUP_CUST" ).append("\n"); 
		query.append("         ,MN2.NOTIFY_PARTY       ,MN2.SHIPPER" ).append("\n"); 
		query.append("         ,MN2.SH_GROUP_CUST      ,MN2.CONSIGNEE_NM" ).append("\n"); 
		query.append("         ,MN2.CN_GROUP_CUST_NM   ,MN2.NOTIFY_PARTY_NM" ).append("\n"); 
		query.append("         ,MN2.SHIPPER_NM         ,MN2.SHIPPER_ADDR" ).append("\n"); 
		query.append("         ,MN2.FORWARDER_ADDR     ,MN2.ACTUAL_CUST_NM" ).append("\n"); 
		query.append("         ,MN2.BKG_CNTC_EMAIL     ,MN2.BKG_CNTC_NM " ).append("\n"); 
		query.append("         ,MN2.PRE_RELAY_PORT" ).append("\n"); 
		query.append("         ,MN2.POST_RELAY_PORT    ,MN2.T_VVD" ).append("\n"); 
		query.append("         ,MN2.T_LANE             ,MN2.FST_VVD      ,MN2.OBRD_DT" ).append("\n"); 
		query.append("         ,SUBSTR(MN2.F_POL_ETAETD,1,8)  ,SUBSTR(MN2.F_POL_ETAETD,9,8)" ).append("\n"); 
		query.append("         ,MN2.OB_CUST_CRTERM            ,MN2.OB_OFC_CRTERM" ).append("\n"); 
		query.append("         ,SUBSTR(MN2.T_POL_ETAETD,1,8)  ,SUBSTR(MN2.T_POL_ETAETD,9,8)" ).append("\n"); 
		query.append("         ,SUBSTR(MN2.T_POD_ETAETD,1,8)  ,SUBSTR(MN2.T_POD_ETAETD,9,8)" ).append("\n"); 
		query.append("         ,SUBSTR(MN2.L_POD_ETAETD,1,8)	,SUBSTR(MN2.L_POD_ETAETD,9,8) " ).append("\n"); 
		query.append("         ,MN2.IB_CUST_CRTERM     ,MN2.IB_OFC_CRTERM" ).append("\n"); 
		query.append("         ,MN2.CCT_CUST           ,MN2.THR_CUST      ,MN2.CCT_OFC      ,MN2.GL_EX_CCT " ).append("\n"); 
		query.append("         ,MN2.LCL_TOT_CCT        ,MN2.USD_TOT_CCT   ,MN2.AUD_STS_CD   ,MN2.PPD_CUST " ).append("\n"); 
		query.append("         ,MN2.PPD_OFC            ,MN2.GL_EX_PPD     ,MN2.LCL_TOT_PPD  ,MN2.USD_TOT_PPD " ).append("\n"); 
		query.append("         ,CHG.CURR_CD            ,MN2.RT_APLY_DT    ,MN2.COP_DEL_ETA  ,MN2.VSK_DEL_ETA" ).append("\n"); 
		query.append("         ,CHG.FRT_TERM_CD        ,MN2.PRT_NO" ).append("\n"); 
		query.append(")MN3" ).append("\n"); 
		query.append(",BKG_CHG_RT CHG2" ).append("\n"); 
		query.append("WHERE MN3.BKG_NO  = CHG2.BKG_NO(+)" ).append("\n"); 
		query.append("AND   CHG2.FRT_INCL_XCLD_DIV_CD(+) ='N'" ).append("\n"); 
		query.append("AND   MN3.FRT_TERM_CD = CHG2.FRT_TERM_CD(+)" ).append("\n"); 
		query.append("#if (${frt_term_cd} != 'A')" ).append("\n"); 
		query.append("AND   CHG2.FRT_TERM_CD(+) = @[frt_term_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND   MN3.GRP_CUR = CHG2.CURR_CD(+)" ).append("\n"); 
		query.append("GROUP BY   MN3.BKG_NO         ,MN3.BL_NO                ,MN3.RFA_NO            ,MN3.SC_NO" ).append("\n"); 
		query.append("          ,MN3.SCAC_CD        ,MN3.BKG_OFC_CD           ,MN3.POR_CD            ,MN3.POD_CD " ).append("\n"); 
		query.append("          ,MN3.POL_CD         ,MN3.DEL_CD               ,MN3.FNL_DEST_CD       ,MN3.RCV_TERM_CD" ).append("\n"); 
		query.append("          ,MN3.DE_TERM_CD     ,MN3.DEST_TRNS_SVC_MOD_CD ,MN3.CMDT_CD           ,MN3.FNL_DEST_NM" ).append("\n"); 
		query.append("          ,MN3.TOT_PCK_QTY    ,MN3.TOT_PCK_TP           ,MN3.ACT_WGT           ,MN3.TOT_WGT_UT_CD" ).append("\n"); 
		query.append("          ,MN3.TOT_MEAS_QTY   ,MN3.MEAS_UT_CD           ,MN3.VSL_NM            ,MN3.CSTMS_DESC" ).append("\n"); 
		query.append("          ,MN3.CONSIGNEE      ,MN3.CN_GROUP_CUST        ,MN3.NOTIFY_PARTY      ,MN3.SHIPPER" ).append("\n"); 
		query.append("          ,MN3.SH_GROUP_CUST  ,MN3.CONSIGNEE_NM   	    ,MN3.CN_GROUP_CUST_NM  ,MN3.NOTIFY_PARTY_NM" ).append("\n"); 
		query.append("  	      ,MN3.SHIPPER_NM     ,MN3.SHIPPER_ADDR         ,MN3.FORWARDER_ADDR    ,MN3.ACTUAL_CUST_NM" ).append("\n"); 
		query.append("          ,MN3.BKG_CNTC_EMAIL ,MN3.BKG_CNTC_NM          ,MN3.PRE_RELAY_PORT    ,MN3.POST_RELAY_PORT   ,MN3.T_VVD" ).append("\n"); 
		query.append("          ,MN3.T_LANE         ,MN3.FST_VVD              ,MN3.OBRD_DT           ,MN3.F_POL_ETA" ).append("\n"); 
		query.append("          ,MN3.F_POL_ETD      ,MN3.T_POL_ETA            ,MN3.T_POL_ETD" ).append("\n"); 
		query.append("          ,MN3.T_POD_ETA      ,MN3.T_POD_ETD            ,MN3.L_POD_ETA         ,MN3.L_POD_ETD" ).append("\n"); 
		query.append("          ,MN3.DUEDT          ,MN3.BILL_CUST            ,MN3.THR_CUST          ,MN3.OTS_OFC" ).append("\n"); 
		query.append("          ,MN3.CR_TERM        ,MN3.GL_EX                ,MN3.LCL_TOT           ,MN3.USD_TOT  " ).append("\n"); 
		query.append("          ,MN3.OVER_DUE       ,MN3.AUD_STS_CD           ,MN3.GRP_CUR           ,MN3.TOT_CURR_AMT " ).append("\n"); 
		query.append("          ,CHG2.CHG_CD        ,CHG2.CURR_CD             ,CHG2.RAT_AS_QTY       ,CHG2.CHG_UT_AMT " ).append("\n"); 
		query.append("          ,MN3.RT_APLY_DT     ,MN3.COP_DEL_ETA          ,MN3.VSK_DEL_ETA       ,MN3.FRT_TERM_CD" ).append("\n"); 
		query.append("          ,MN3.PRT_NO" ).append("\n"); 
		query.append(")MN4" ).append("\n"); 
		query.append(",BKG_CONTAINER  CNTR" ).append("\n"); 
		query.append(",BKG_CNTR_RT    CHG3" ).append("\n"); 
		query.append(",MDM_CHARGE     CHG_M" ).append("\n"); 
		query.append("WHERE MN4.BKG_NO      = CNTR.BKG_NO (+)" ).append("\n"); 
		query.append("AND   MN4.BKG_NO      = CHG3.BKG_NO (+)" ).append("\n"); 
		query.append("AND   MN4.GRP_CUR     = CHG3.CURR_CD(+)" ).append("\n"); 
		query.append("AND   CHG3.FRT_INCL_XCLD_DIV_CD(+) ='N'" ).append("\n"); 
		query.append("AND   MN4.FRT_TERM_CD = CHG3.FRT_TERM_CD(+)" ).append("\n"); 
		query.append("#if (${frt_term_cd} != 'A')" ).append("\n"); 
		query.append("AND   MN4.FRT_TERM_CD = @[frt_term_cd]" ).append("\n"); 
		query.append("AND   CHG3.FRT_TERM_CD(+) = @[frt_term_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND   CHG3.CHG_CD = CHG_M.CHG_CD (+)" ).append("\n"); 
		query.append("AND   CNTR.CNTR_NO = NVL(CHG3.CNTR_NO,CNTR.CNTR_NO)" ).append("\n"); 
		query.append("GROUP BY " ).append("\n"); 
		query.append("         MN4.BKG_NO         ,MN4.BL_NO            ,MN4.RFA_NO" ).append("\n"); 
		query.append("        ,MN4.SC_NO          ,MN4.SCAC_CD          ,MN4.BKG_OFC_CD       ,MN4.POR_CD " ).append("\n"); 
		query.append("        ,MN4.POD_CD         ,MN4.POL_CD           ,MN4.DEL_CD           ,MN4.FNL_DEST_CD" ).append("\n"); 
		query.append("        ,MN4.RCV_TERM_CD    ,MN4.DE_TERM_CD       ,MN4.DEST_TRNS_SVC_MOD_CD" ).append("\n"); 
		query.append("        ,MN4.CMDT_CD        ,MN4.FNL_DEST_NM      ,MN4.TOT_PCK_QTY      ,MN4.TOT_PCK_TP" ).append("\n"); 
		query.append("        ,MN4.ACT_WGT        ,MN4.TOT_WGT_UT_CD    ,MN4.TOT_MEAS_QTY" ).append("\n"); 
		query.append("        ,MN4.MEAS_UT_CD     ,MN4.VSL_NM           ,MN4.CSTMS_DESC       ,MN4.CONSIGNEE" ).append("\n"); 
		query.append("        ,MN4.CN_GROUP_CUST  ,MN4.NOTIFY_PARTY     ,MN4.SHIPPER          ,MN4.SH_GROUP_CUST" ).append("\n"); 
		query.append("        ,MN4.CONSIGNEE_NM   ,MN4.CN_GROUP_CUST_NM ,MN4.NOTIFY_PARTY_NM  ,MN4.SHIPPER_NM" ).append("\n"); 
		query.append("        ,MN4.SHIPPER_ADDR   ,MN4.FORWARDER_ADDR   ,MN4.ACTUAL_CUST_NM   ,MN4.BKG_CNTC_EMAIL" ).append("\n"); 
		query.append("        ,MN4.BKG_CNTC_NM    ,MN4.PRE_RELAY_PORT   ,MN4.POST_RELAY_PORT" ).append("\n"); 
		query.append("        ,MN4.T_VVD          ,MN4.T_LANE           ,MN4.FST_VVD          ,MN4.OBRD_DT" ).append("\n"); 
		query.append("        ,MN4.F_POL_ETA      ,MN4.F_POL_ETD        ,MN4.T_POL_ETA" ).append("\n"); 
		query.append("        ,MN4.T_POL_ETD      ,MN4.T_POD_ETA        ,MN4.T_POD_ETD        ,MN4.L_POD_ETA" ).append("\n"); 
		query.append("        ,MN4.L_POD_ETD      ,CNTR.CGO_RCV_DT      ,MN4.DUEDT            ,MN4.BILL_CUST" ).append("\n"); 
		query.append("        ,MN4.THR_CUST       ,MN4.OTS_OFC          ,MN4.CR_TERM          ,MN4.GL_EX" ).append("\n"); 
		query.append("        ,MN4.LCL_TOT        ,MN4.USD_TOT          ,MN4.OVER_DUE         ,MN4.AUD_STS_CD " ).append("\n"); 
		query.append("        ,MN4.GRP_CUR        ,DECODE(CHG3.CURR_CD, NULL, 0, MN4.TOT_CURR_AMT),MN4.CHG_CD           ,MN4.CHG_CURR" ).append("\n"); 
		query.append("        ,MN4.CHG_RATED_AS   ,MN4.CHG_RATE         ,MN4.CHG_SUM          ,CNTR.CNTR_NO             ,CNTR.CNMV_CYC_NO ,CNTR.CNMV_YR" ).append("\n"); 
		query.append("        ,CNTR.MEAS_QTY      ,CNTR.CNTR_PRT_FLG    ,CNTR.CNTR_TPSZ_CD    ,CNTR.CNTR_VOL_QTY" ).append("\n"); 
		query.append("        ,CNTR.PCK_QTY       ,CNTR.PCK_TP_CD       ,CNTR.CNTR_WGT        ,CNTR.WGT_UT_CD" ).append("\n"); 
		query.append("        ,NVL(CNTR.DCGO_FLG, NVL(CNTR.RC_FLG,NVL(CNTR.BB_CGO_FLG,NVL(CNTR.AWK_CGO_FLG,'')))) " ).append("\n"); 
		query.append("        ,CHG3.CURR_CD       ,MN4.RT_APLY_DT       ,MN4.COP_DEL_ETA      ,MN4.VSK_DEL_ETA" ).append("\n"); 
		query.append("        ,MN4.FRT_TERM_CD    ,MN4.PRT_NO" ).append("\n"); 
		query.append("        ,CHG_T.FLG01  ,CHG_T.FLG02  ,CHG_T.FLG03   ,CHG_T.FLG04  ,CHG_T.FLG05" ).append("\n"); 
		query.append("        ,CHG_T.CHG01  ,CHG_T.CHG02  ,CHG_T.CHG03   ,CHG_T.CHG04  ,CHG_T.CHG05" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")MN5" ).append("\n"); 
		query.append(",BKG_CNTR_RT CHG4" ).append("\n"); 
		query.append(",BKG_BL_ISS N" ).append("\n"); 
		query.append(",BKG_ARR_NTC O" ).append("\n"); 
		query.append(",BKG_CGO_RLSE W " ).append("\n"); 
		query.append("WHERE MN5.BKG_NO  = CHG4.BKG_NO(+)" ).append("\n"); 
		query.append("AND   MN5.GRP_CUR = CHG4.CURR_CD(+)" ).append("\n"); 
		query.append("AND   MN5.CHG_CD  = CHG4.CHG_CD(+)" ).append("\n"); 
		query.append("AND   MN5.CNTR_NO = CHG4.CNTR_NO(+) " ).append("\n"); 
		query.append("AND   CHG4.FRT_INCL_XCLD_DIV_CD(+) ='N'" ).append("\n"); 
		query.append("AND   MN5.FRT_TERM_CD = CHG4.FRT_TERM_CD(+)" ).append("\n"); 
		query.append("#if (${frt_term_cd} != 'A')" ).append("\n"); 
		query.append("AND   CHG4.FRT_TERM_CD(+) = @[frt_term_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND   MN5.BKG_NO  = N.BKG_NO(+)" ).append("\n"); 
		query.append("AND   MN5.BKG_NO  = O.BKG_NO(+)" ).append("\n"); 
		query.append("AND   MN5.BL_NO   = W.BL_NO(+)" ).append("\n"); 
		query.append("GROUP BY " ).append("\n"); 
		query.append("         MN5.BKG_NO          ,MN5.BL_NO                ,MN5.RFA_NO           ,MN5.SC_NO" ).append("\n"); 
		query.append("        ,MN5.SCAC_CD         ,MN5.BKG_OFC_CD           ,MN5.POR_CD           ,MN5.POD_CD " ).append("\n"); 
		query.append("        ,MN5.POL_CD          ,MN5.DEL_CD               ,MN5.FNL_DEST_CD      ,MN5.RCV_TERM_CD" ).append("\n"); 
		query.append("        ,MN5.DE_TERM_CD      ,MN5.DEST_TRNS_SVC_MOD_CD ,MN5.CMDT_CD          ,MN5.FNL_DEST_NM" ).append("\n"); 
		query.append("        ,MN5.TOT_PCK_QTY     ,MN5.TOT_PCK_TP           ,MN5.ACT_WGT          ,MN5.TOT_WGT_UT_CD" ).append("\n"); 
		query.append("        ,MN5.TOT_MEAS_QTY    ,MN5.MEAS_UT_CD           ,MN5.VSL_NM           ,MN5.CSTMS_DESC" ).append("\n"); 
		query.append("        ,MN5.CNTR_SP_CGO_FG  ,MN5.CONSIGNEE            ,MN5.CN_GROUP_CUST    ,MN5.NOTIFY_PARTY" ).append("\n"); 
		query.append("        ,MN5.SHIPPER         ,MN5.SH_GROUP_CUST	       ,MN5.CONSIGNEE_NM	 ,MN5.CN_GROUP_CUST_NM" ).append("\n"); 
		query.append("        ,MN5.NOTIFY_PARTY_NM ,MN5.SHIPPER_NM           ,MN5.SHIPPER_ADDR     ,MN5.FORWARDER_ADDR" ).append("\n"); 
		query.append("        ,MN5.ACTUAL_CUST_NM  ,MN5.BKG_CNTC_EMAIL       ,MN5.BKG_CNTC_NM      ,MN5.PRE_RELAY_PORT   ,MN5.POST_RELAY_PORT" ).append("\n"); 
		query.append("        ,MN5.T_VVD           ,MN5.T_LANE               ,MN5.FST_VVD          ,TO_CHAR(O.DEL_ARR_DT,'YYYY-MM-DD') " ).append("\n"); 
		query.append("        ,TO_CHAR(O.PKUP_FREE_DT,'YYYY-MM-DD')          ,MN5.OBRD_DT          ,MN5.F_POL_ETA               ,MN5.F_POL_ETD" ).append("\n"); 
		query.append("        ,MN5.T_POL_ETA       ,MN5.T_POL_ETD            ,MN5.T_POD_ETA        ,MN5.T_POD_ETD" ).append("\n"); 
		query.append("        ,MN5.L_POD_ETA       ,MN5.L_POD_ETD            ,MN5.CGO_RCV_DT       ,MN5.DUEDT" ).append("\n"); 
		query.append("        ,MN5.BILL_CUST	     ,MN5.THR_CUST             ,MN5.OTS_OFC          ,MN5.CR_TERM " ).append("\n"); 
		query.append("        ,MN5.GL_EX           ,MN5.LCL_TOT              ,MN5.USD_TOT          ,MN5.OVER_DUE" ).append("\n"); 
		query.append("        ,MN5.AUD_STS_CD      ,MN5.GRP_CUR              ,MN5.TOT_CURR_AMT     ,MN5.CHG_CD" ).append("\n"); 
		query.append("        ,MN5.CHG_CURR        ,MN5.CHG_RATED_AS         ,MN5.CHG_RATE         ,MN5.CHG_SUM" ).append("\n"); 
		query.append("        ,MN5.CNTR_NO         ,MN5.MEAS_QTY             ,MN5.CNTR_PRT_FLG     ,MN5.CNMV_CYC_NO           ,MN5.CNMV_YR" ).append("\n"); 
		query.append("        ,MN5.CNTR_SEAL_NO    ,MN5.CNTR_SZ_CD           ,MN5.CNTR_TPSZ_CD     ,MN5.CNTR_VOL_QTY" ).append("\n"); 
		query.append("        ,MN5.PCK_QTY         ,MN5.PCK_TP_CD            ,MN5.CNTR_WGT         ,MN5.WGT_UT_CD" ).append("\n"); 
		query.append("        ,MN5.CNTR_CHG_CURR   ,MN5.CNTR_SUM             ,N.OBL_ISS_OFC_CD     ,TO_CHAR(N.OBL_ISS_DT,'YYYY-MM-DD')" ).append("\n"); 
		query.append("        ,W.FRT_CLT_FLG       ,W.OBL_RDEM_FLG           ,W.CSTMS_CLR_CD       ,W.CSTMS_CLR_LST_DT" ).append("\n"); 
		query.append("        ,MN5.RT_APLY_DT      ,MN5.COP_DEL_ETA          ,MN5.VSK_DEL_ETA      ,MN5.FRT_TERM_CD" ).append("\n"); 
		query.append("        ,MN5.PRT_NO" ).append("\n"); 
		query.append("        ,MN5.CHG001          ,MN5.CHG002               ,MN5.CHG003           ,MN5.CHG004                ,MN5.CHG005" ).append("\n"); 
		query.append("        ,MN5.CHG001_S        ,MN5.CHG002_S             ,MN5.CHG003_S         ,MN5.CHG004_S              ,MN5.CHG005_S" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("ORDER BY MN5.BKG_NO ,MN5.GRP_CUR,MN5.CHG_CD ,MN5.CNTR_NO " ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("RPT_TMPLT_NM, FRT_TERM_CD, INV002" ).append("\n"); 
		query.append("#foreach( ${key} in ${allcols}) " ).append("\n"); 
		query.append("	#if($key == 'INV004'||$key == 'INV008'||$key == 'INV047'||$key == 'INV062'||$key == 'INV064'||$key == 'INV066'||$key == 'INV067'||$key == 'INV068'||$key == 'INV080')" ).append("\n"); 
		query.append("	,''" ).append("\n"); 
		query.append("	#elseif($key == 'INV074'||$key == 'INV075'||$key == 'INV112'||$key == 'INV141')" ).append("\n"); 
		query.append("	,''" ).append("\n"); 
		query.append("	#elseif($key == 'INV102'||$key == 'INV106'||$key == 'INV107'||$key == 'INV131')" ).append("\n"); 
		query.append("	, INV103" ).append("\n"); 
		query.append("	#elseif($key == 'CHG001'||$key == 'CHG002'||$key == 'CHG003'||$key == 'CHG004'||$key == 'CHG005'||$key == 'CHG999')" ).append("\n"); 
		query.append("	, INV103" ).append("\n"); 
		query.append("	#else" ).append("\n"); 
		query.append("		,$key" ).append("\n"); 
		query.append("	#end	" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("ORDER BY INV002, FRT_TERM_CD" ).append("\n"); 

	}
}