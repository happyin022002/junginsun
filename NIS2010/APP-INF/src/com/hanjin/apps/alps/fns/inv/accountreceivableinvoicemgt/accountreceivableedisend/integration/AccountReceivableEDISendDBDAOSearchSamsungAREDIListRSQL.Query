<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableEDISendDBDAOSearchSamsungAREDIListRSQL">
			<desc><![CDATA[VVD와 Customer로 기 생성된 EDI 문서번호(message no) list를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT B.BL_SRC_NO,
  B.SR_INV_NO,
  B.POR_CD,
  B.POL_CD,
  B.POD_CD,
  B.DEL_CD,
  B.INV_EDI_D2_QTY,
  B.INV_EDI_D4_QTY,
  B.INV_EDI_D5_QTY,
  B.INV_EDI_D7_QTY,
  B.INV_EDI_ETC_QTY,
  B.GRS_CNTR_WGT,
  B.GRS_CBM_CAPA,
  SUM(DECODE(C.CHG_CD, 'OFT', C.CHG_AMT, 0)) OFT_AMT,
  SUM(DECODE(C.CHG_CD, 'CMS', C.CHG_AMT, 0)) CMS_AMT,
  SUM(DECODE(C.CHG_CD, 'THC', C.CHG_AMT, 'OTH', C.CHG_AMT, 'DTH', C.CHG_AMT, 0)) THC_AMT,  
  --SUM(DECODE(C.CHG_CD, 'OTH', C.CHG_AMT, 0)) THC_AMT, --2010.04.16 OTH로 변경 이상희과장요청-->다시 THC로 변경
  SUM(DECODE(C.CHG_CD, 'DHF', C.CHG_AMT, 0)) DHF_AMT,
  SUM(DECODE(C.CHG_CD, 'WHF', C.CHG_AMT, 0)) WHF_AMT,
  SUM(DECODE(C.CHG_CD, 'O/F', C.CHG_AMT, 0)) OTR_AMT,
  --SUM(DECODE(C.CHG_CD, 'CFR', C.CHG_AMT, 0)) CFR_AMT, -- 항목삭제
  --SUM(DECODE(C.CHG_CD, 'BAF', C.CHG_AMT, 0)) BAF_AMT, -- 항목삭제
  SUM(DECODE(C.CHG_CD, 'SLF', C.CHG_AMT, 0)) SLF_AMT,     -- 2011.05.23 추가
  SUM(DECODE(C.CHG_CD, 'XXX', C.CHG_AMT, 0)) OTH_AMT,
  B.SND_FLG,
  B.BL_CNTR_GRP_CTNT
FROM INV_AR_EDI_GERP_HDR A,
  INV_AR_EDI_GERP_BL B,
  INV_AR_EDI_GERP_CHG C
WHERE A.MSG_ID = B.MSG_ID
  AND A.MSG_NO = B.MSG_NO
  AND B.MSG_ID = C.MSG_ID
  AND B.MSG_NO = C.MSG_NO
  AND B.BL_LINE_NO = C.BL_LINE_NO
  AND B.BL_SRC_NO = C.BL_SRC_NO
  AND A.MSG_ID = @[msg_id]
  AND A.MSG_NO = @[msg_no]
GROUP BY B.BL_SRC_NO, B.SR_INV_NO, B.POR_CD, B.POL_CD, B.POD_CD, B.DEL_CD, B.INV_EDI_D2_QTY, B.INV_EDI_D4_QTY, B.INV_EDI_D5_QTY, B.INV_EDI_D7_QTY, B.INV_EDI_ETC_QTY, B.GRS_CNTR_WGT, B.GRS_CBM_CAPA, B.SND_FLG, B.BL_CNTR_GRP_CTNT
ORDER BY B.BL_CNTR_GRP_CTNT, B.POR_CD, B.BL_SRC_NO			]]></sql>
			<params>
				<param name="msg_id" type="12" value="" out="N"/>
				<param name="msg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
