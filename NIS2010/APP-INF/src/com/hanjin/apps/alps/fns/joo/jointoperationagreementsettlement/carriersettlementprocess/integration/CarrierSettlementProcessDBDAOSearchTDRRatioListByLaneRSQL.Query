<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CarrierSettlementProcessDBDAOSearchTDRRatioListByLaneRSQL">
			<desc><![CDATA[1. Ticket No  : CHM-201218380
   개발자 : 김상근
   Ticket Title : [ALPS JOO] TDR Inquiry by VVD
   Description  :  Additional Slot 칼럼 및 Sub Alloc and Ratio 팝업 추가.

2. Ticket No  : CHM-201322276
   개발자 : 이수진
   Ticket Title : [ALPS JOO] 모델링 표준에 맞게 처리 되도록 테이블 칼럼 변경 작업 및 기능 변경
   Description  :  JO_REP_CRR_CD_FLG => JO_REP_CRR_FLG으로 컬럼명 변경 작업]]></desc>
			<sql><![CDATA[
SELECT A.SLAN_CD AS RLANE_CD,
       A.OPR_CD  AS JO_CRR_CD,
       B.JO_20FT_N1ST_RTO,
       B.JO_20FT_SUB_TEU_QTY,
       B.JO_40FT_N1ST_RTO,
       B.JO_40FT_SUB_TEU_QTY,
       B.JO_45FT_N1ST_RTO,
       B.JO_45FT_N2ND_RTO,
       B.JO_45FT_SUB_TEU_QTY,
       B.JO_RND_RULE_LVL,
       --DECODE(NVL(B.JO_REP_CRR_FLG,''),'Y','1','0') AS JO_REP_CRR_FLG
       B.JO_REP_CRR_FLG AS JO_REP_CRR_FLG
FROM
(
       SELECT DISTINCT NVL(B.OPR_CD, 'ZZZ') OPR_CD,
              K.SLAN_CD
         FROM BAY_PLAN B,
              VSK_VSL_PORT_SKD K
        WHERE ( (K.VPS_ETD_DT BETWEEN TO_DATE (REPLACE (@[pre_fr], '-', ''), 'YYYYMMDD')
                         AND TO_DATE (REPLACE (@[pre_to], '-', ''), 'YYYYMMDD') + 0.99999) OR K.VPS_ETD_DT IS NULL)
          AND K.VSL_CD       = B.VSL_CD
          AND K.SKD_VOY_NO   = B.VOY_NO
          AND K.SKD_DIR_CD   = B.DIR_CD
          AND K.VPS_PORT_CD  = B.PORT_CD
          AND K.CLPT_IND_SEQ = B.CALL_IND
          AND B.PLAN_TYPE    = 'F'
          AND K.SLAN_CD LIKE @[slane_cd] || '%'
          AND K.TURN_PORT_IND_CD NOT IN ('D', 'V', 'F')
) A, JOO_TDR_RTO B
WHERE A.SLAN_CD = B.RLANE_CD(+)
  AND A.OPR_CD = B.JO_CRR_CD(+)
ORDER BY A.OPR_CD			]]></sql>
			<params>
				<param name="pre_fr" type="12" value="" out="N"/>
				<param name="pre_to" type="12" value="" out="N"/>
				<param name="slane_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
