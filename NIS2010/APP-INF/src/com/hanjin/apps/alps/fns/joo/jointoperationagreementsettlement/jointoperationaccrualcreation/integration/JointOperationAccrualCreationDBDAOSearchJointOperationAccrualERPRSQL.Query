<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JointOperationAccrualCreationDBDAOSearchJointOperationAccrualERPRSQL">
			<desc><![CDATA[추정 건을 ERP로 보낸 목록]]></desc>
			<sql><![CDATA[
SELECT
AAA.*
FROM
(
SELECT
 ROWNUM AS SEQ_NO
,AA.*
FROM 
(
	SELECT 
	  'R' IBFLAG
      ,EXE_YRMON
      ,REV_YRMON
      ,CRR_CD AS JO_CRR_CD
      ,NULL AS TRD_CD
      ,NULL AS VNDR_CUST_SEQ
      ,CUST_CNT_CD
      ,CUST_SEQ      
      ,NULL AS RE_DIVR_CD
      ,NULL AS VVD
      ,VSL_CD
      ,SKD_VOY_NO
      ,SKD_DIR_CD
      ,REV_DIR_CD
      ,WO_NO AS RLANE_CD
      ,AGMT_NO AS JO_STL_JB_CD
      ,NULL AS JO_STL_JB_NM
      ,BSA_SLT_QTY  AS BSA_QTY
      ,SLT_COST_AMT AS BSA_SLT_PRC
      ,ACCT_CD
      ,ESTM_AMT AS ADJ_ESTM_AMT
      ,ACT_AMT
      ,ACCL_AMT AS ADJ_ACCL_AMT
      ,NULL AS DIFF_AMT
      ,ESTM_VVD_TP_CD
      ,ESTM_IOC_DIV_CD AS JO_IOC_DIV_CD 
      ,ESTM_VVD_HDR_ID
      ,ESTM_BC_DIV_CD AS CNTR_BLK_DIV_CD      
      ,SYS_SRC_ID
      ,LOC_CD
      ,BIZ_UT_ID AS JO_CNTR_DIV_CTNT
      ,NULL AS ACCL_AMT_CORR_FLG
      ,NULL AS ADJ_ESTM_FLG
      ,NULL AS ADJ_BSA_QTY
      ,NULL AS ADJ_BSA_SLT_PRC
   /* ,NULL AS ADJ_ESTM_AMT   */
   /* ,NULL AS ADJ_ACCL_AMT   */
      ,NULL AS ADJ_RMK
      ,CRE_USR_ID
      ,UPD_USR_ID
      ,NULL AS ESTM_ACT_SEQ
      ,NULL AS ADJ_RSLT_CD
      ,NULL AS ADJ_RLSE_RMK      
	FROM GL_ESTM_IF_ERP AA
	WHERE 1=1
	AND AA.SYS_SRC_ID = 'JOO'
	AND AA.EXE_YRMON = REPLACE(@[exe_yrmon],'-','')
           #if (${re_divr_cd} != '')
           AND AA.ACCT_CD LIKE DECODE(@[re_divr_cd],'R','4','E','5')||'%'
           #end
           #if (${jo_crr_cd} != '')
           AND AA.CRR_CD = @[jo_crr_cd]
           #end
           #if (${trd_cd} != '')
           #end
           #if (${rlane_cd} != '')
           AND AA.WO_NO  = @[rlane_cd]
           #end
           #if (${vvd} != '')
           AND AA.VSL_CD 	= substr(@[vvd],1,4) 
           AND AA.SKD_VOY_NO = substr(@[vvd],5,4)
           AND AA.SKD_DIR_CD = substr(@[vvd],9,1)
           AND AA.REV_DIR_CD = substr(@[vvd],10,1)
           #end
           #if (${acct_cd} != '')
           AND AA.ACCT_CD = @[acct_cd]
           #end
           #if (${estm_vvd_tp_cd} != '')
           AND AA.ESTM_VVD_TP_CD = @[estm_vvd_tp_cd]
           #end
           #if (${diff} != '')
           #end
           #if (${adjust} != '')
           #end
           #if (${rev_yrmon_to} != '' && ${rev_yrmon_fr} != '')
		   AND AA.REV_YRMON BETWEEN REPLACE(@[rev_yrmon_fr],'-','') AND REPLACE(@[rev_yrmon_to],'-','')
		   #end
	ORDER BY ACCT_CD, REV_YRMON, VVD
	) AA
) AAA
#if (${page_no} != '')
WHERE SEQ_NO BETWEEN 1 + ((@[page_no]-1)*@[pagerows]) AND (@[page_no]*@[pagerows])
#end			]]></sql>
			<params>
				<param name="exe_yrmon" type="12" value="" out="N"/>
				<param name="re_divr_cd" type="12" value="" out="N"/>
				<param name="jo_crr_cd" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="acct_cd" type="12" value="" out="N"/>
				<param name="estm_vvd_tp_cd" type="12" value="" out="N"/>
				<param name="rev_yrmon_fr" type="12" value="" out="N"/>
				<param name="rev_yrmon_to" type="12" value="" out="N"/>
				<param name="page_no" type="12" value="" out="N"/>
				<param name="pagerows" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
