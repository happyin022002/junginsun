<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceIssueDBDAOSearchKORIssuedCustomerRSQL">
			<desc><![CDATA[KOR Issue main, Customer 테이블에서 select]]></desc>
			<sql><![CDATA[
SELECT A.INV_NO,
  A.INV_SEQ,
  A.AR_OFC_CD,
  A.ACT_CUST_CNT_CD,
  LPAD(A.ACT_CUST_SEQ, 6, '0') ACT_CUST_SEQ,
  B.LOCL_NM,
  C.CUST_RGST_NO,
  C.INDIV_CORP_DIV_CD,
  B.ISS_DIV_CD,
  B.CNTC_PSON_NM,
  B.LOCL_ADDR1||B.LOCL_ADDR2||B.LOCL_ADDR3||B.LOCL_ADDR4 LOCL_ADDR,
  B.BZCT_NM,
  B.BZTP_NM,
  TO_CHAR(TO_DATE(A.ISS_DT, 'YYYYMMDD'), 'YYYY-MM-DD') ISS_DT,
  A.INV_RMK,
  DECODE(B.OB_FAX_NO, '', DECODE(B.IB_FAX_NO, '', A.CUST_FAX_NO, B.IB_FAX_NO), B.OB_FAX_NO) CUST_FAX_NO,
  DECODE(B.OB_EML, '', DECODE(B.IB_EML, '', A.CUST_EML, B.IB_EML), OB_EML) CUST_EML
FROM INV_AR_KR_ISS A,
  MDM_CR_CUST B,
  MDM_CUSTOMER C
WHERE A.ACT_CUST_CNT_CD = B.CUST_CNT_CD (+)
  AND A.ACT_CUST_SEQ = B.CUST_SEQ (+)
  AND A.ACT_CUST_CNT_CD = C.CUST_CNT_CD
  AND A.ACT_CUST_SEQ = C.CUST_SEQ
  AND A.INV_NO = @[inv_no]
  AND A.INV_SEQ = (
    SELECT MAX(INV_SEQ)
    FROM INV_AR_KR_ISS
    WHERE INV_NO = @[inv_no]
      AND AR_OFC_CD IN (
        SELECT DISTINCT AR_OFC_CD
        FROM MDM_ORGANIZATION
          WHERE (LOC_CD LIKE 'KR%' OR LOC_CD LIKE 'HQ%')
          AND DELT_FLG = 'N'
          AND AR_OFC_CD IS NOT NULL))			]]></sql>
			<params>
				<param name="inv_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
