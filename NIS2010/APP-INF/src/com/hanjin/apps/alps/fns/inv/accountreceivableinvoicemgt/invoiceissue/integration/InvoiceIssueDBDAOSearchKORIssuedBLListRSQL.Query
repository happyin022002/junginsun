<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceIssueDBDAOSearchKORIssuedBLListRSQL">
			<desc><![CDATA[KOR Invoice Main, Invoice Main 테이블에서 select]]></desc>
			<sql><![CDATA[
SELECT DISTINCT B.BL_SRC_NO,
  B.BKG_NO,
  B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD VVD,
  B.SAIL_ARR_DT,
  DECODE(B.IO_BND_CD, 'O', 'O/B', 'I', 'I/B') IO_BND_CD,
  DECODE(B.IO_BND_CD, 'O', B.POL_CD, 'I', B.POD_CD) PORT,
  B.POL_CD,
  B.POD_CD,
  C.USD_XCH_RT
FROM INV_AR_KR_ISS A,
  INV_AR_KR_ISS_CHG B,
  INV_AR_MN C
WHERE A.INV_NO = B.INV_NO
  AND A.INV_SEQ = B.INV_SEQ
  AND B.BL_SRC_NO = C.BL_SRC_NO
  AND A.INV_NO = @[inv_no]
  AND A.INV_SEQ = (
    SELECT MAX(INV_SEQ)
    FROM INV_AR_KR_ISS
    WHERE INV_NO = @[inv_no])
  AND C.AR_IF_NO = (
    SELECT MAX(AR_IF_NO)
    FROM INV_AR_MN
    WHERE BL_SRC_NO = B.BL_SRC_NO
      AND AR_OFC_CD IN (
            SELECT DISTINCT AR_OFC_CD
            FROM MDM_ORGANIZATION
            --WHERE AR_HD_QTR_OFC_CD = 'SHAAS'
              WHERE (LOC_CD LIKE 'KR%' OR LOC_CD LIKE 'HQ%')
              AND DELT_FLG = 'N'
              AND AR_OFC_CD IS NOT NULL))			]]></sql>
			<params>
				<param name="inv_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
