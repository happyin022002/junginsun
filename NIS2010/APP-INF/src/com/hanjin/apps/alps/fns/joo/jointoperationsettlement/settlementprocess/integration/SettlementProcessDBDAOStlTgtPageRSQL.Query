<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SettlementProcessDBDAOStlTgtPageRSQL">
			<desc><![CDATA[Settlement Target Page 조회]]></desc>
			<sql><![CDATA[
WITH STL_TGT AS ( 
    SELECT
         J.REV_YRMON
    FROM (
			SELECT * FROM JOO_SLT_TGT J
			WHERE 1=1
		    AND J.JO_FSH_FLG = '1'
		    AND J.REV_YRMON BETWEEN REPLACE(@[rev_yrmon_fr],'-','') AND REPLACE(@[rev_yrmon_to],'-','')
		    #if (${re_divr_cd} != '')
		    AND J.ACCT_CD LIKE DECODE(@[re_divr_cd],'R','4','E','5')||'%'
		    #end
		    #if (${jo_crr_cd} != '')
		    AND J.CRR_CD = @[jo_crr_cd]
		    #end
		    #if (${trd_cd} != '')
		    AND J.TRD_CD    = @[trd_cd]
		    #end
		    #if (${rlane_cd} != '')
		    AND J.RLANE_CD  = @[rlane_cd]
		    #end
		    #if (${vvd} != '')
		    AND J.VSL_CD 	= substr(@[vvd],1,4) 
		    AND J.SKD_VOY_NO = substr(@[vvd],5,4)
		    AND J.SKD_DIR_CD = substr(@[vvd],9,1)
		    #end
		    #if (${acct_cd} != '')
		    AND J.ACCT_CD = @[acct_cd]
		    #end
		 ) J
    UNION ALL
    SELECT
         J.REV_YRMON
    FROM 
    (
        SELECT LEVEL AS LEV
        FROM DUAL CONNECT BY LEVEL <= 3
    ) L, 
	(
			SELECT * FROM JOO_LODG_TGT J
			WHERE 1=1
		    AND J.REV_YRMON BETWEEN REPLACE(@[rev_yrmon_fr],'-','') AND REPLACE(@[rev_yrmon_to],'-','')
		    #if (${re_divr_cd} != '')
		    AND J.ACCT_CD LIKE DECODE(@[re_divr_cd],'R','4','E','5')||'%'
		    #end
		    #if (${jo_crr_cd} != '')
		    AND J.CRR_CD = @[jo_crr_cd]
		    #end
		    #if (${trd_cd} != '')
		    AND J.TRD_CD    = @[trd_cd]
		    #end
		    #if (${rlane_cd} != '')
		    AND J.RLANE_CD  = @[rlane_cd]
		    #end
		    #if (${vvd} != '')
		    AND J.VSL_CD 	= substr(@[vvd],1,4) 
		    AND J.SKD_VOY_NO = substr(@[vvd],5,4)
		    AND J.SKD_DIR_CD = substr(@[vvd],9,1)
		    #end
		    #if (${acct_cd} != '')
		    AND J.ACCT_CD = @[acct_cd]
		    #end	
	) J
) 
SELECT CEIL(COUNT(1)/TO_NUMBER(@[pagerows])) AS TOT_PAGE_CNT
FROM STL_TGT			]]></sql>
			<params>
				<param name="rev_yrmon_fr" type="12" value="" out="N"/>
				<param name="rev_yrmon_to" type="12" value="" out="N"/>
				<param name="re_divr_cd" type="12" value="" out="N"/>
				<param name="jo_crr_cd" type="12" value="" out="N"/>
				<param name="trd_cd" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="acct_cd" type="12" value="" out="N"/>
				<param name="pagerows" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
