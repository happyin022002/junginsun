CREATE OR REPLACE FUNCTION TRS_GET_FOC_INFO_FNC(    V_BL_NO in VARCHAR2,   V_TRSP_SO_OFC_CTY_CD in VARCHAR2,   V_TRSP_SO_SEQ in NUMBER,   V_DELIM in VARCHAR2 ) RETURN VARCHAR2AUTHID CURRENT_USER/*******************************************************************************   1. Object Name      : TRS_GET_FOC_INFO_FNC   2. Version          : 1.0   3. Create Date      : MAY 18, 2010   4. Sub System       : ALPS/TRS   5. Author           : POONG YEON CHO   6. Description      : GETTING FOC INFO   7. Revision History : 2010.05.18 CREATE*******************************************************************************/IS     V_RETURN_FOC    VARCHAR2(5)             ;    V_F_VALUE       VARCHAR2(1)      := ' ' ;    V_O_VALUE       VARCHAR2(1)      := ' ' ;    V_C_VALUE       VARCHAR2(1)      := ' ' ;    BEGIN    --DBMS_OUTPUT.ENABLE(200000);    /* SELECT BASIC FOC INFO */    BEGIN        SELECT            NVL(FRT_CLT_FLG, ' ')        ,   NVL(OBL_RDEM_FLG, ' ')        ,   DECODE(CSTMS_CLR_CD, 'Y', 'Y', ' ')        INTO            V_F_VALUE        ,   V_O_VALUE        ,   V_C_VALUE        FROM    BKG_CGO_RLSE        WHERE   1=1        AND BL_NO   = V_BL_NO        ;        --DBMS_OUTPUT.PUT_LINE('FOC BASIC ['||V_F_VALUE||V_O_VALUE||V_C_VALUE||']');    EXCEPTION WHEN NO_DATA_FOUND THEN       V_RETURN_FOC := V_F_VALUE||V_O_VALUE||V_C_VALUE;       --DBMS_OUTPUT.PUT_LINE('%%TRS_GET_FOC_FLG_FNC%% 1. SELECT ['||SQLERRM||']');    END;     /* END OF SELECT BASIC FOC INFO */        /* SELECT POD='CA', DEL='US' C INFO */    IF V_TRSP_SO_OFC_CTY_CD IS NOT NULL THEN        BEGIN            SELECT /*+ ORDERED INDEX_DESC(X XPKBKG_CSTMS_ADV_CNTR_RSLT) */                B.CSTMS_CLR_CD             INTO V_C_VALUE            FROM                BKG_BOOKING A            ,   BKG_CSTMS_ADV_CNTR_RSLT B            ,   TRS_TRSP_SVC_ORD C            WHERE 1=1            AND A.BL_NO = V_BL_NO            AND SUBSTR(A.POD_CD,0,2) = 'CA'            AND SUBSTR(A.DEL_CD,0,2) = 'US'            AND B.CNT_CD = 'US'            AND A.BL_NO = B.BL_NO            AND C.TRSP_SO_OFC_CTY_CD = V_TRSP_SO_OFC_CTY_CD            AND C.TRSP_SO_SEQ = V_TRSP_SO_SEQ            AND (SUBSTR(B.CNTR_NO,1,LENGTH(B.CNTR_NO)-1) = SUBSTR(C.EQ_NO,1,LENGTH(C.EQ_NO)-1)                        OR B.CNTR_NO = SUBSTR(C.EQ_NO,1,LENGTH(C.EQ_NO)-1))            AND ROWNUM = 1            ;            --DBMS_OUTPUT.PUT_LINE('C CA ['||V_C_VALUE||']');        EXCEPTION WHEN NO_DATA_FOUND THEN           V_RETURN_FOC := V_F_VALUE||V_O_VALUE||V_C_VALUE;           --DBMS_OUTPUT.PUT_LINE('%%TRS_GET_FOC_FLG_FNC%% 2. SELECT ['||SQLERRM||']');        END;    END IF;    /* END OF SELECT POD='CA', DEL='US' C INFO */        IF V_DELIM IS NULL THEN        RETURN V_F_VALUE||V_O_VALUE||V_C_VALUE;    ELSE        RETURN V_F_VALUE||V_DELIM||V_O_VALUE||V_DELIM||V_C_VALUE;    END IF;        EXCEPTION WHEN OTHERS THEN       --DBMS_OUTPUT.PUT_LINE('%%TRS_GET_FOC_FLG_FNC%% 3. ['||SQLERRM||']');       RETURN '   ';END;