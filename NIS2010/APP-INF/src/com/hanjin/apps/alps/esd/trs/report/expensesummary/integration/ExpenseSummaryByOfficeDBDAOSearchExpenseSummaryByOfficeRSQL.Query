<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ExpenseSummaryByOfficeDBDAOSearchExpenseSummaryByOfficeRSQL">
			<desc><![CDATA[조회대상 COUNT 조회]]></desc>
			<sql><![CDATA[
WITH WITH_RESULT 
AS
(    
#if( ${radio_office} == 'WO' )
                                  SELECT  WO_OFC_CD
                                        , MAX(INV_OFC_CD) INV_OFC_CD
#elseif(  ${radio_office} == 'IV' )
                                  SELECT  MAX(WO_OFC_CD) WO_OFC_CD
                                        , INV_OFC_CD
#end
                          , CRE_MONTH
                          , TRSP_COST_DTL_MOD_CD -- COST MODE
                          , TRSP_CRR_MOD_CD      -- TRANS_MODE
                          , TRSP_BND_CD
                          , TRSP_SO_TP_CD        -- S/O TYPE
                          , MAX(TRSP_SO_TP_NM) TRSP_SO_TP_NM     -- S/O TYPE NM
                          , BKG_TERM_CD
                          , NOD_CD                               --CUBE로 Group by 하기 위해서는 NODE가 하나의 컬럼으로 필요하기 때문에 사용
                          , MAX(FM_NOD_CD) FM_NOD_CD
                          , MAX(VIA_NOD_CD) VIA_NOD_CD
                          , MAX(TO_NOD_CD) TO_NOD_CD
                          , MAX(DOR_NOD_CD) DOR_NOD_CD
                          , INV_CURR_CD          -- CURR
                                                , WO_OFC_CD SUB_SUM_TITLE
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', INV_BZC_AMT, 0)) AS INV_BZC_D2_AMT
                                    -- Invoice Additional D2
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', INV_ETC_ADD_AMT, 0)) AS INV_ETC_ADD_D2_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, INV_BZC_AMT)) AS INV_BZC_D4_AMT
                                    -- Invoice Additional D4
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, INV_ETC_ADD_AMT)) AS INV_ETC_ADD_D4_AMT
                                    , SUM(INV_BZC_AMT) AS INV_BZC_AMT
                                    -- Invoice Additional
                                    , SUM(INV_ETC_ADD_AMT) AS INV_ETC_ADD_AMT
                                    , SUM(INV_BZC_AMT + INV_ETC_ADD_AMT) INV_TOT_AMT
                                    
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', INV_BZC_AMT, 0) / INV_USD_LOCL_XCH_RT,2), 0)) AS INV_BZC_D2_AMT_USD
                                    -- Invoice Additional D2 USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', INV_ETC_ADD_AMT, 0) / INV_USD_LOCL_XCH_RT,2), 0)) AS INV_ETC_ADD_D2_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, INV_BZC_AMT) / INV_USD_LOCL_XCH_RT,2), 0)) AS INV_BZC_D4_AMT_USD
                                    -- Invoice Additional D4 USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, INV_ETC_ADD_AMT) / INV_USD_LOCL_XCH_RT,2), 0)) AS INV_ETC_ADD_D4_AMT_USD
                                    , SUM(NVL(ROUND(INV_BZC_AMT / INV_USD_LOCL_XCH_RT,2), 0)) AS INV_BZC_AMT_USD
                                    -- Invoice Additional USD
                                    , SUM(NVL(ROUND(INV_ETC_ADD_AMT / INV_USD_LOCL_XCH_RT,2), 0)) AS INV_ETC_ADD_AMT_USD
                                    , SUM(NVL(ROUND((INV_BZC_AMT + INV_ETC_ADD_AMT) / INV_USD_LOCL_XCH_RT,2), 0)) INV_TOT_AMT_USD
                                    
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', BZC_AMT, 0)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', SCG_VAT_AMT, 0)) AS BZC_D2_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', FUEL_SCG_AMT, 0)) AS FUEL_SCG_D2_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', SCG_VAT_AMT, 0)) AS SCG_VAT_D2_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', NEGO_AMT, 0)) AS NEGO_D2_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', TOLL_FEE_AMT, 0)) AS TOLL_FEE_D2_AMT
                                    -- W/O Additional D2
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', ETC_ADD_AMT, 0)) AS ETC_ADD_D2_AMT
                                    -- rail other surcharge D2
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', RAIL_ETC_ADD_AMT, 0)) AS RAIL_ETC_ADD_D2_AMT
                                    -- truck Addtional D2
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', TRUK_ETC_ADD_AMT, 0)) AS TRUK_ETC_ADD_D2_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', HJL_HNDL_AMT, 0)) AS HJL_HNDL_D2_AMT
                                    -- over weight surcharge D2
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', OVR_WGT_SCG_AMT, 0)) AS OVR_WGT_SCG_D2_AMT
                                    -- HZD MTRL surcharge    D2
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', HZD_MTRL_SCG_AMT, 0)) AS HZD_MTRL_SCG_D2_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', BZC_AMT, 0)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', FUEL_SCG_AMT, 0)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', SCG_VAT_AMT, 0)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', NEGO_AMT, 0)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', TOLL_FEE_AMT, 0)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', ETC_ADD_AMT, 0))+ SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', HJL_HNDL_AMT, 0)) AS D2_AMT_SUM
                                    
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, BZC_AMT)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, SCG_VAT_AMT)) AS BZC_D4_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, FUEL_SCG_AMT)) AS FUEL_SCG_D4_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, SCG_VAT_AMT)) AS SCG_VAT_D4_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, NEGO_AMT)) AS NEGO_D4_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, TOLL_FEE_AMT)) AS TOLL_FEE_D4_AMT
                                    -- W/O Additional D4
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, ETC_ADD_AMT)) AS ETC_ADD_D4_AMT
                                    -- rail other surcharge D4
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, RAIL_ETC_ADD_AMT)) AS RAIL_ETC_ADD_D4_AMT
                                    -- truck Addtional D4
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, TRUK_ETC_ADD_AMT)) AS TRUK_ETC_ADD_D4_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, HJL_HNDL_AMT)) AS HJL_HNDL_D4_AMT
                                    -- over weight surcharge D4
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, OVR_WGT_SCG_AMT)) AS OVR_WGT_SCG_D4_AMT
                                    -- HZD MTRL surcharge D4
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, HZD_MTRL_SCG_AMT)) AS HZD_MTRL_SCG_D4_AMT
                                    , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, BZC_AMT)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, FUEL_SCG_AMT)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, SCG_VAT_AMT)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, NEGO_AMT)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, TOLL_FEE_AMT)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, ETC_ADD_AMT)) +SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, HJL_HNDL_AMT)) AS D4_AMT_SUM
                                    , SUM(BZC_AMT) + SUM(SCG_VAT_AMT) AS BZC_AMT
                                    , SUM(FUEL_SCG_AMT) AS FUEL_SCG_AMT
                                    , SUM(SCG_VAT_AMT) AS SCG_VAT_AMT
                                    , SUM(NEGO_AMT) AS NEGO_AMT
                                    , SUM(TOLL_FEE_AMT) AS TOLL_FEE_AMT
                                    -- W/O Additional
                                    , SUM(ETC_ADD_AMT) AS ETC_ADD_AMT
                                    , SUM(HJL_HNDL_AMT) AS HJL_HNDL_AMT
                                    -- rail other surcharge
                                    , SUM(RAIL_ETC_ADD_AMT) RAIL_ETC_ADD_AMT
                                    -- truck Addtional
                                    , SUM(TRUK_ETC_ADD_AMT) AS TRUK_ETC_ADD_AMT
                                    -- over weight surcharge
                                    , SUM(OVR_WGT_SCG_AMT) AS OVR_WGT_SCG_AMT
                                    -- HZD MTRL surcharge
                                    , SUM(HZD_MTRL_SCG_AMT) AS HZD_MTRL_SCG_AMT
                                    , SUM(BZC_AMT + FUEL_SCG_AMT + SCG_VAT_AMT + OVR_WGT_SCG_AMT + NEGO_AMT + TOLL_FEE_AMT + HZD_MTRL_SCG_AMT + ETC_ADD_AMT+HJL_HNDL_AMT) AS TOT_AMT
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', BZC_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', SCG_VAT_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS BZC_D2_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', FUEL_SCG_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS FUEL_SCG_D2_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', SCG_VAT_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS SCG_VAT_D2_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', NEGO_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS NEGO_D2_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', TOLL_FEE_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS TOLL_FEE_D2_AMT_USD
                                    -- W/O Additional D2 USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', ETC_ADD_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS ETC_ADD_D2_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', HJL_HNDL_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS HJL_HNDL_D2_AMT_USD
                                    -- rail other surcharge D2 USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', RAIL_ETC_ADD_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS RAIL_ETC_ADD_D2_AMT_USD
                                    -- truck Addtional USD D2
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', TRUK_ETC_ADD_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS TRUK_ETC_ADD_D2_AMT_USD
                                    -- over weight surcharge D2 USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', OVR_WGT_SCG_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS OVR_WGT_SCG_D2_AMT_USD
                                    -- HZD MTRL surcharge D2 USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', HZD_MTRL_SCG_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS HZD_MTRL_SCG_D2_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', BZC_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', FUEL_SCG_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', SCG_VAT_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', NEGO_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', TOLL_FEE_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', ETC_ADD_AMT, 0) / USD_LOCL_XCH_RT,2), 0))+ SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', HJL_HNDL_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS D2_AMT_SUM_USD
                                    
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, BZC_AMT) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, SCG_VAT_AMT) / USD_LOCL_XCH_RT,2), 0)) AS BZC_D4_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, FUEL_SCG_AMT) / USD_LOCL_XCH_RT,2), 0)) AS FUEL_SCG_D4_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, SCG_VAT_AMT) / USD_LOCL_XCH_RT,2), 0)) AS SCG_VAT_D4_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, NEGO_AMT) / USD_LOCL_XCH_RT,2), 0)) AS NEGO_D4_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, TOLL_FEE_AMT) / USD_LOCL_XCH_RT,2), 0)) AS TOLL_FEE_D4_AMT_USD
                                    -- W/O Additional D4 USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, ETC_ADD_AMT) / USD_LOCL_XCH_RT,2), 0)) AS ETC_ADD_D4_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, HJL_HNDL_AMT) / USD_LOCL_XCH_RT,2), 0)) AS HJL_HNDL_D4_AMT_USD
                                    -- rail other surcharge D4 USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, RAIL_ETC_ADD_AMT) / USD_LOCL_XCH_RT,2), 0)) AS RAIL_ETC_ADD_D4_AMT_USD
                                    -- truck Addtional USD D4 USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, TRUK_ETC_ADD_AMT) / USD_LOCL_XCH_RT,2), 0)) AS TRUK_ETC_ADD_D4_AMT_USD
                                    -- over weight surcharge D4 USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, OVR_WGT_SCG_AMT) / USD_LOCL_XCH_RT,2), 0)) AS OVR_WGT_SCG_D4_AMT_USD
                                    -- HZD MTRL surcharge D4 USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, HZD_MTRL_SCG_AMT) / USD_LOCL_XCH_RT,2), 0)) AS HZD_MTRL_SCG_D4_AMT_USD
                                    , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, BZC_AMT) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, FUEL_SCG_AMT) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, SCG_VAT_AMT) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, NEGO_AMT) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, TOLL_FEE_AMT) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, ETC_ADD_AMT) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, HJL_HNDL_AMT) / USD_LOCL_XCH_RT,2), 0))AS D4_AMT_SUM_USD
                                    , SUM(NVL(ROUND(BZC_AMT / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(SCG_VAT_AMT / USD_LOCL_XCH_RT,2), 0)) AS BZC_AMT_USD
                                    
                                    , SUM(NVL(ROUND(FUEL_SCG_AMT / USD_LOCL_XCH_RT,2), 0)) AS FUEL_SCG_AMT_USD
                                    , SUM(NVL(ROUND(SCG_VAT_AMT / USD_LOCL_XCH_RT,2), 0)) AS SCG_VAT_AMT_USD
                                    , SUM(NVL(ROUND(NEGO_AMT / USD_LOCL_XCH_RT,2), 0)) AS NEGO_AMT_USD
                                    , SUM(NVL(ROUND(TOLL_FEE_AMT / USD_LOCL_XCH_RT,2), 0)) AS TOLL_FEE_AMT_USD
                                    -- W/O Additional USD
                                    , SUM(NVL(ROUND(ETC_ADD_AMT / USD_LOCL_XCH_RT,2), 0)) AS ETC_ADD_AMT
                                    , SUM(NVL(ROUND(HJL_HNDL_AMT / USD_LOCL_XCH_RT,2), 0)) AS HJL_HNDL_AMT_USD
                                    -- rail other surcharge USD
                                    , SUM(NVL(ROUND(RAIL_ETC_ADD_AMT / USD_LOCL_XCH_RT,2), 0)) AS RAIL_ETC_ADD_AMT_USD
                                    -- truck Addtional USD
                                    , SUM(NVL(ROUND(TRUK_ETC_ADD_AMT / USD_LOCL_XCH_RT,2), 0)) AS TRUK_ETC_ADD_AMT_USD
                                    -- over weight surcharge USD
                                    , SUM(NVL(ROUND(OVR_WGT_SCG_AMT / USD_LOCL_XCH_RT,2), 0)) AS OVR_WGT_SCG_AMT_USD
                                    -- HZD MTRL surcharge USD
                                    , SUM(NVL(ROUND(HZD_MTRL_SCG_AMT / USD_LOCL_XCH_RT,2), 0)) AS HZD_MTRL_SCG_AMT_USD
                                    , SUM(NVL(ROUND((BZC_AMT + FUEL_SCG_AMT + SCG_VAT_AMT + OVR_WGT_SCG_AMT + NEGO_AMT + TOLL_FEE_AMT + HZD_MTRL_SCG_AMT + ETC_ADD_AMT+HJL_HNDL_AMT) / USD_LOCL_XCH_RT,2), 0)) TOT_AMT_USD
                                    
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 1, 0), 0)) CNTN20
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, 1), 0)) CNTN40
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 1, 0) + (DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, 1) * 2), 0)) CNTN_TEU
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 1, 0) + DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, 1), 0)) CNTN_BOX
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'D2', 1, 0), 0)) D2_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'D4', 1, 0), 0)) D4_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'D5', 1, 0), 0)) D5_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'D7', 1, 0), 0)) D7_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'R2', 1, 0), 0)) R2_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'R4', 1, 0), 0)) R4_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'R5', 1, 'R9', 1, 0), 0)) R5_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'R7', 1, 0), 0)) R7_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'R8', 1, 0), 0)) R8_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'F2', 1, 0), 0)) F2_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'F4', 1, 0), 0)) F4_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'F5', 1, 0), 0)) F5_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'A2', 1, 0), 0)) A2_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'A4', 1, 0), 0)) A4_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'A5', 1, 0), 0)) A5_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'P2', 1, 0), 0)) P2_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'P4', 1, 0), 0)) P4_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'O2', 1, 0), 0)) O2_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'O4', 1, 0), 0)) O4_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'O5', 1, 0), 0)) O5_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'O7', 1, 0), 0)) O7_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'S2', 1, 0), 0)) S2_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'S4', 1, 0), 0)) S4_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'T2', 1, 0), 0)) T2_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'T4', 1, 0), 0)) T4_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'DX', 1, 0), 0)) DX_CNT
                                    , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'DW', 1, 0), 0)) DW_CNT
                                       , SUM(NVL(TTL_DIST,0)) AS  TTL_DIST
                                      , CASE WHEN MAX(LNK_DIST_DIV_CD) = MIN(LNK_DIST_DIV_CD) THEN  MAX(LNK_DIST_DIV_CD) ELSE '' END AS LNK_DIST_DIV_CD
                          , ETS_YN
                    FROM    (
#if( ${period} == 'S' )
                                    SELECT  /*+ USE_NL(SO,WRK,BKG,IXCH) */
#elseif( ${period} == 'W' )
                                    SELECT  /*+ INDEX(WO XAK2TRS_TRSP_WRK_ORD ) */
#elseif( ${period} == 'I' )
                                    SELECT  /*+ USE_NL(SO,WRK,BKG,IXCH) */
#elseif( ${period} == 'G' )
                                    SELECT  /*+ USE_NL(SO,WRK,BKG,IXCH) */
#else
                                    SELECT  /*+ USE_NL(SO,WRK,BKG,IXCH) */
#end
                                SO.CRE_OFC_CD   WO_OFC_CD  -- W/O OFFICE
                                , WRK.CRE_OFC_CD  INV_OFC_CD --INVOICE OFFICE
#if( ${period} == 'S' )
                                    , TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM') CRE_MONTH
#elseif( ${period} == 'W' )
                                    , TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM') CRE_MONTH
#elseif( ${period} == 'I' )
                                    , TO_CHAR(WRK.INV_CFM_DT,'YYYYMM') CRE_MONTH
#else
                                    , SUBSTR(WRK.GL_DT,1,6) CRE_MONTH
#end

                                    , SO.TRSP_COST_DTL_MOD_CD -- COST MODE
                                    , SO.TRSP_CRR_MOD_CD      -- TRANS_MODE
                                    , DECODE(SO.TRSP_BND_CD,'I','I','O','O','T','T','') TRSP_BND_CD
                                    , SO.TRSP_SO_TP_CD           -- S/O TYPE
                                    , SOTP_CD.INTG_CD_VAL_DP_DESC TRSP_SO_TP_NM  -- S/O TYPE NM
                                                            , DECODE(SO.TRSP_BND_CD,'I',BKG.DE_TERM_CD,'O',BKG.RCV_TERM_CD,'') BKG_TERM_CD
                                    , NVL(SO.INV_CURR_CD, SO.CURR_CD) INV_CURR_CD         -- CURR
#if( ${radio_office} == 'WO' )
                                     , SO.CRE_OFC_CD  SUB_SUM_TITLE
#elseif(  ${radio_office} == 'IV' )
                              , WRK.CRE_OFC_CD  SUB_SUM_TITLE
#end

                                    , SUBSTR(SO.EQ_TPSZ_CD,2,1) EQ_TPSZ_CD_SUB
                                    , EQ_TPSZ_CD
                                    , DECODE(WRK.TRSP_INV_AUD_STS_CD, 'CF', SO.INV_BZC_AMT, 'AR', SO.INV_BZC_AMT, 'IF', SO.INV_BZC_AMT, 'DA', SO.INV_BZC_AMT, 'PD', SO.INV_BZC_AMT, 0) INV_BZC_AMT
                                    , NVL(DECODE(WRK.TRSP_INV_AUD_STS_CD, 'CF', SO.INV_ETC_ADD_AMT, 'AR', SO.INV_ETC_ADD_AMT, 'IF', SO.INV_ETC_ADD_AMT, 'DA', SO.INV_ETC_ADD_AMT, 'PD', SO.INV_ETC_ADD_AMT, 0),0) INV_ETC_ADD_AMT
                                    , CASE WHEN NVL(SO.INV_CURR_CD,'USD') = 'USD' THEN 1
                                           ELSE    
                                                ( SELECT  USD_LOCL_XCH_RT 
                                                  FROM    GL_MON_XCH_RT WXCH 
                                                  WHERE   ACCT_XCH_RT_LVL = 1
                                                  AND     CURR_CD           = NVL(SO.INV_CURR_CD, SO.CURR_CD) 
                                                  AND     ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WRK.LOCL_CRE_DT,'YYYYMM'),NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM'))) 
                                                )
                                      END INV_USD_LOCL_XCH_RT
                                    , CASE WHEN NVL(SO.CURR_CD,'USD') = 'USD' THEN 1
                                           ELSE    
                                                ( SELECT  USD_LOCL_XCH_RT 
                                                  FROM    GL_MON_XCH_RT WXCH 
                                                  WHERE   ACCT_XCH_RT_LVL = 1
                                                  AND     CURR_CD           = SO.CURR_CD 
                                                  AND     ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM')) 
                                                )
                                      END USD_LOCL_XCH_RT
                                    , NVL(SO.BZC_AMT,0) BZC_AMT
                                    , NVL(SO.ETC_ADD_AMT,0) ETC_ADD_AMT
                                    , NVL(SO.ETC_ADD_AMT,0) TRUK_ETC_ADD_AMT
                                    , NVL(SO.HJL_HNDL_AMT,0) HJL_HNDL_AMT
                                    , 0 RAIL_ETC_ADD_AMT
                                    , NVL(SO.FUEL_SCG_AMT,0) FUEL_SCG_AMT
                                    , NVL(SO.SCG_VAT_AMT,0) SCG_VAT_AMT
                                    , NVL(SO.NEGO_AMT,0) NEGO_AMT
                                    , NVL(SO.TOLL_FEE_AMT,0) TOLL_FEE_AMT
                                    , SUBSTR(SO.FM_NOD_CD,1,@[node_div])  FM_NOD_CD
                                    , SUBSTR(SO.VIA_NOD_CD,1,@[node_div]) VIA_NOD_CD
                                    , SUBSTR(SO.TO_NOD_CD,1,@[node_div])  TO_NOD_CD
                                    , SUBSTR(SO.DOR_NOD_CD,1,@[node_div]) DOR_NOD_CD
                                    , NVL(SUBSTR(SO.FM_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(SO.VIA_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(SO.TO_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(SO.DOR_NOD_CD,1,@[node_div]), '') NOD_CD
                                    , 0 AS OVR_WGT_SCG_AMT
                                    , 0 AS HZD_MTRL_SCG_AMT
                                    , SO.TTL_DIST
                                    , SO.LNK_DIST_DIV_CD
                                    , DECODE(SO.HJL_NO,'','N','Y') ETS_YN
                              FROM    TRS_TRSP_SVC_ORD SO
                                    , TRS_TRSP_WRK_ORD WO
                                    , TRS_TRSP_INV_WRK WRK
                                    , BKG_BOOKING BKG
                                    , COM_INTG_CD_DTL SOTP_CD
                              WHERE   SO.TRSP_WO_OFC_CTY_CD  = WO.TRSP_WO_OFC_CTY_CD(+)
                              AND     SO.TRSP_WO_SEQ         = WO.TRSP_WO_SEQ(+)
                              AND     SO.INV_NO              = WRK.INV_NO(+)
                              AND     SO.INV_VNDR_SEQ        = WRK.INV_VNDR_SEQ(+)
                              AND     SO.BKG_NO              = BKG.BKG_NO(+)
                              AND     SO.EQ_KND_CD = 'U'
                              AND     SO.DELT_FLG            = 'N'
                              AND     SOTP_CD.INTG_CD_ID(+) = 'CD00279'
                              AND     SOTP_CD.INTG_CD_VAL_CTNT(+)  = SO.TRSP_SO_TP_CD
#if (${bndcd} == 'I')
                              AND     SO.TRSP_BND_CD = 'I'
#elseif (${bndcd} == 'O')
                              AND     SO.TRSP_BND_CD = 'O'
#elseif (${bndcd} == 'T')
                              AND     SO.TRSP_BND_CD = 'T'
#elseif (${bndcd} == 'P')
                              AND     SO.TRSP_BND_CD IN ('I','O')
#end

#if( !((${FromDate} == '') && (${ToDate} == '')))
    #if( ${period} == 'S' )
                              AND     SO.LOCL_CRE_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'W' )
                              AND     WO.LOCL_CRE_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'I' )
                              AND     WRK.INV_CFM_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'G' )
                              AND     WRK.GL_DT BETWEEN '${FromDate}' AND '${ToDate}'
    #else
                              AND     1 = 2
    #end
#else
                              AND     1 = 2
#end

    #if($statusCdArr.size() > 0)
                              AND     WRK.TRSP_INV_AUD_STS_CD IN (
        #foreach( ${key} in ${statusCdArr})
            #if($velocityCount == 1)
            '${key}'
            #else
            , '${key}'
            #end
        #end
            )
    #end

#if( ${status_cd} == 'INV' )
                              AND     WRK.TRSP_INV_AUD_STS_CD IN ('RC','SV','CF','AR','DA','IF','RJ','PD')
#end 

#if( ${radio_office} == 'WO' )
    #if($inputOfcArr.size() > 0)
                              AND     WO.CRE_OFC_CD IN (
        #foreach( ${key} in ${inputOfcArr})
            #if($velocityCount == 1)
            UPPER('${key}')
            #else
            , UPPER('${key}')
            #end
        #end
            )
    #end
#elseif( ${radio_office} == 'IV' )
    #if($inputOfcArr.size() > 0)
                              AND     WRK.CRE_OFC_CD IN (
        #foreach( ${key} in ${inputOfcArr})
            #if($velocityCount == 1)
            UPPER('${key}')
            #else
            , UPPER('${key}')
            #end
        #end
            )
    #end
#end
#if($costmodeArr.size() > 0)
                    AND     SO.TRSP_COST_DTL_MOD_CD IN (
    #foreach( ${key} in ${costmodeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

#if($transmodeArr.size() > 0)
                    AND     SO.TRSP_CRR_MOD_CD IN (
    #foreach( ${key} in ${transmodeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

#if($sotypeArr.size() > 0)
                    AND     SO.TRSP_SO_TP_CD IN (
    #foreach( ${key} in ${sotypeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

#if( !(${from_node} == '' || ${from_node} == 'ALL') )
                              AND     SO.fm_nod_cd like '${from_node}'||'%'
#end
#if( !(${via_node} == '' || ${via_node} == 'ALL') )
                              AND     SO.via_nod_cd like '${via_node}'||'%'
#end
#if( !(${to_node} == '' || ${to_node} == 'ALL') )
                              AND     SO.to_nod_cd like '${to_node}'||'%'
#end
#if( !(${door_node} == '' || ${door_node} == 'ALL') )
                              AND     SO.dor_nod_cd like '${door_node}'||'%'
#end

#if( ${ets_yn} == 'N' )
                              AND     SO.HJL_NO IS NULL
#elseif( ${ets_yn} == 'Y' )
                              AND     SO.HJL_NO IS NOT NULL
#end


-- RFND START
#if( ${radio_office} == 'IV' && !( ${period} == 'S' || ${period} == 'W') )
UNION ALL

#if( ${period} == 'S' )
                                    SELECT  /*+ USE_NL(SO,WRK,BKG,IXCH) */
#elseif( ${period} == 'W' )
                                    SELECT  /*+ INDEX(WO XAK2TRS_TRSP_WRK_ORD ) */
#elseif( ${period} == 'I' )
                                    SELECT  /*+ USE_NL(SO,WRK,BKG,IXCH) */
#elseif( ${period} == 'G' )
                                    SELECT  /*+ USE_NL(SO,WRK,BKG,IXCH) */
#else
                                    SELECT  /*+ USE_NL(SO,WRK,BKG,IXCH) */
#end
                                SO.CRE_OFC_CD   WO_OFC_CD  -- W/O OFFICE
                                , WRK.CRE_OFC_CD  INV_OFC_CD --INVOICE OFFICE
#if( ${period} == 'S' )
                                    , TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM') CRE_MONTH
#elseif( ${period} == 'W' )
                                    , TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM') CRE_MONTH
#elseif( ${period} == 'I' )
                                    , TO_CHAR(WRK.INV_CFM_DT,'YYYYMM') CRE_MONTH
#else
                                    , SUBSTR(WRK.GL_DT,1,6) CRE_MONTH
#end

                                    , RI.TRSP_COST_DTL_MOD_CD -- COST MODE
                                    , RI.TRSP_CRR_MOD_CD      -- TRANS_MODE
                                    , DECODE(SO.TRSP_BND_CD,'I','I','O','O','T','T','') TRSP_BND_CD
                                    , SO.TRSP_SO_TP_CD           -- S/O TYPE
                                    , SOTP_CD.INTG_CD_VAL_DP_DESC TRSP_SO_TP_NM  -- S/O TYPE NM
                                                            , DECODE(SO.TRSP_BND_CD,'I',BKG.DE_TERM_CD,'O',BKG.RCV_TERM_CD,'') BKG_TERM_CD
                                    , NVL(NVL(SO.INV_CURR_CD, SO.CURR_CD), WRK.INV_CURR_CD) INV_CURR_CD         -- CURR
#if( ${radio_office} == 'WO' )
                                     , SO.CRE_OFC_CD  SUB_SUM_TITLE
#elseif(  ${radio_office} == 'IV' )
                              , WRK.CRE_OFC_CD  SUB_SUM_TITLE
#end

                                    , SUBSTR(RI.EQ_TPSZ_CD,2,1) EQ_TPSZ_CD_SUB
                                    , RI.EQ_TPSZ_CD
                                    , NVL(RI.TRSP_RFND_INV_AMT, 0)*-1 INV_BZC_AMT
                                    , NVL(DECODE(WRK.TRSP_INV_AUD_STS_CD, 'CF', SO.INV_ETC_ADD_AMT, 'AR', SO.INV_ETC_ADD_AMT, 'IF', SO.INV_ETC_ADD_AMT, 'DA', SO.INV_ETC_ADD_AMT, 'PD', SO.INV_ETC_ADD_AMT, 0),0) INV_ETC_ADD_AMT
                                    , CASE WHEN NVL(WRK.INV_CURR_CD,'USD') = 'USD' THEN 1
                                           ELSE    
                                                ( SELECT  USD_LOCL_XCH_RT 
                                                  FROM    GL_MON_XCH_RT WXCH 
                                                  WHERE   ACCT_XCH_RT_LVL = 1
                                                  AND     CURR_CD           = NVL(NVL(SO.INV_CURR_CD, SO.CURR_CD), WRK.INV_CURR_CD)
                                                  AND     ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WRK.LOCL_CRE_DT,'YYYYMM'),NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM'))) 
                                                )
                                      END INV_USD_LOCL_XCH_RT
                                    , CASE WHEN NVL(SO.CURR_CD,'USD') = 'USD' THEN 1
                                           ELSE    
                                                ( SELECT  USD_LOCL_XCH_RT 
                                                  FROM    GL_MON_XCH_RT WXCH 
                                                  WHERE   ACCT_XCH_RT_LVL = 1
                                                  AND     CURR_CD           = SO.CURR_CD 
                                                  AND     ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM')) 
                                                )
                                      END USD_LOCL_XCH_RT
                                    , NVL(SO.BZC_AMT,0) BZC_AMT
                                    , NVL(SO.ETC_ADD_AMT,0) ETC_ADD_AMT
                                    , NVL(SO.ETC_ADD_AMT,0) TRUK_ETC_ADD_AMT
                                    , NVL(SO.HJL_HNDL_AMT,0) HJL_HNDL_AMT
                                    , 0 RAIL_ETC_ADD_AMT
                                    , NVL(SO.FUEL_SCG_AMT,0) FUEL_SCG_AMT
                                    , NVL(SO.SCG_VAT_AMT,0) SCG_VAT_AMT
                                    , NVL(SO.NEGO_AMT,0) NEGO_AMT
                                    , NVL(SO.TOLL_FEE_AMT,0) TOLL_FEE_AMT
                                    , SUBSTR(SO.FM_NOD_CD,1,@[node_div])  FM_NOD_CD
                                    , SUBSTR(SO.VIA_NOD_CD,1,@[node_div]) VIA_NOD_CD
                                    , SUBSTR(SO.TO_NOD_CD,1,@[node_div])  TO_NOD_CD
                                    , SUBSTR(SO.DOR_NOD_CD,1,@[node_div]) DOR_NOD_CD
                                    , NVL(SUBSTR(SO.FM_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(SO.VIA_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(SO.TO_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(SO.DOR_NOD_CD,1,@[node_div]), '') NOD_CD
                                    , 0 AS OVR_WGT_SCG_AMT
                                    , 0 AS HZD_MTRL_SCG_AMT
                                    , SO.TTL_DIST
                                    , SO.LNK_DIST_DIV_CD
                                    , DECODE(SO.HJL_NO,'','N','Y') ETS_YN
                              FROM    TRS_TRSP_SVC_ORD SO
                                    , TRS_TRSP_WRK_ORD WO
                                    , TRS_TRSP_INV_WRK WRK
                                    , BKG_BOOKING BKG
                                    , COM_INTG_CD_DTL SOTP_CD
                                    , TRS_TRSP_RFND_INV RI
                              WHERE   SO.TRSP_WO_OFC_CTY_CD  = WO.TRSP_WO_OFC_CTY_CD(+)
                              AND     SO.TRSP_WO_SEQ         = WO.TRSP_WO_SEQ(+)
                              AND     SO.INV_NO(+)           = WRK.INV_NO
                              AND     SO.INV_VNDR_SEQ(+)     = WRK.INV_VNDR_SEQ
                              AND     SO.BKG_NO              = BKG.BKG_NO(+)
                              AND     RI.INV_NO              = WRK.INV_NO
                              AND     RI.INV_VNDR_SEQ        = WRK.INV_VNDR_SEQ
                              --AND     SO.EQ_KND_CD = 'U'
                              --AND     SO.DELT_FLG            = 'N'
                              AND     SOTP_CD.INTG_CD_ID(+) = 'CD00279'
                              AND     SOTP_CD.INTG_CD_VAL_CTNT(+)  = SO.TRSP_SO_TP_CD
#if (${bndcd} == 'I')
                              AND     SO.TRSP_BND_CD = 'I'
#elseif (${bndcd} == 'O')
                              AND     SO.TRSP_BND_CD = 'O'
#elseif (${bndcd} == 'T')
                              AND     SO.TRSP_BND_CD = 'T'
#elseif (${bndcd} == 'P')
                              AND     SO.TRSP_BND_CD IN ('I','O')
#end

#if( !((${FromDate} == '') && (${ToDate} == '')))
    #if( ${period} == 'S' )
                              AND     SO.LOCL_CRE_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'W' )
                              AND     WO.LOCL_CRE_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'I' )
                              AND     WRK.INV_CFM_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'G' )
                              AND     WRK.GL_DT BETWEEN '${FromDate}' AND '${ToDate}'
    #else
                              AND     1 = 2
    #end
#else
                              AND     1 = 2
#end

    #if($statusCdArr.size() > 0)
                              AND     WRK.TRSP_INV_AUD_STS_CD IN (
        #foreach( ${key} in ${statusCdArr})
            #if($velocityCount == 1)
            '${key}'
            #else
            , '${key}'
            #end
        #end
            )
    #end

#if( ${status_cd} == 'INV' )
                              AND     WRK.TRSP_INV_AUD_STS_CD IN ('RC','SV','CF','AR','DA','IF','RJ','PD')
#end 

#if( ${radio_office} == 'WO' )
    #if($inputOfcArr.size() > 0)
                              AND     WO.CRE_OFC_CD IN (
        #foreach( ${key} in ${inputOfcArr})
            #if($velocityCount == 1)
            UPPER('${key}')
            #else
            , UPPER('${key}')
            #end
        #end
            )
    #end
#elseif( ${radio_office} == 'IV' )
    #if($inputOfcArr.size() > 0)
                              AND     WRK.CRE_OFC_CD IN (
        #foreach( ${key} in ${inputOfcArr})
            #if($velocityCount == 1)
            UPPER('${key}')
            #else
            , UPPER('${key}')
            #end
        #end
            )
    #end
#end
#if($costmodeArr.size() > 0)
                    AND     RI.TRSP_COST_DTL_MOD_CD IN (
    #foreach( ${key} in ${costmodeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

#if($transmodeArr.size() > 0)
                    AND     RI.TRSP_CRR_MOD_CD IN (
    #foreach( ${key} in ${transmodeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

#if($sotypeArr.size() > 0)
                    AND     SO.TRSP_SO_TP_CD IN (
    #foreach( ${key} in ${sotypeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

#if( !(${from_node} == '' || ${from_node} == 'ALL') )
                              AND     SO.fm_nod_cd like '${from_node}'||'%'
#end
#if( !(${via_node} == '' || ${via_node} == 'ALL') )
                              AND     SO.via_nod_cd like '${via_node}'||'%'
#end
#if( !(${to_node} == '' || ${to_node} == 'ALL') )
                              AND     SO.to_nod_cd like '${to_node}'||'%'
#end
#if( !(${door_node} == '' || ${door_node} == 'ALL') )
                              AND     SO.dor_nod_cd like '${door_node}'||'%'
#end

#if( ${ets_yn} == 'N' )
                              AND     SO.HJL_NO IS NULL
#elseif( ${ets_yn} == 'Y' )
                              AND     SO.HJL_NO IS NOT NULL
#end

#end
-- RFND END

#if( ${chk} != '0' )
                              UNION ALL
                              SELECT  /*+ USE_NL(SO,WRK,BKG,IXCH) */
                                    SO.CRE_OFC_CD  WO_OFC_CD   -- W/O OFFICE
                                    , WRK.CRE_OFC_CD  INV_OFC_CD --INVOICE OFFICE
  #if( ${period} == 'S' )
                                    , TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM') CRE_MONTH
  #elseif( ${period} == 'W' )
                                    , TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM') CRE_MONTH
  #elseif( ${period} == 'I' )
                                    , TO_CHAR(WRK.INV_CFM_DT,'YYYYMM') CRE_MONTH
  #else
                                    , SUBSTR(WRK.GL_DT,1,6) CRE_MONTH
  #end

                                    , SO.TRSP_COST_DTL_MOD_CD -- COST MODE
                                    , 'RD' TRSP_CRR_MOD_CD    -- TRANS_MODE
                                    , DECODE(SO.TRSP_BND_CD,'I','I','O','O','') TRSP_BND_CD
                                    , 'R'  TRSP_SO_TP_CD      -- S/O TYPE
                                    , 'RAIL BILLING' TRSP_SO_TP_NM  -- S/O TYPE NM
                                    , DECODE(SO.TRSP_BND_CD,'I',BKG.DE_TERM_CD,'O',BKG.RCV_TERM_CD,'') BKG_TERM_CD
                                    , NVL(VNDR.INV_CURR_CD, VNDR.CURR_CD) INV_CURR_CD         -- CURR
#if( ${radio_office} == 'WO' )
                                               , SO.CRE_OFC_CD SUB_SUM_TITLE
#elseif(  ${radio_office} == 'IV' )
                                              , WRK.CRE_OFC_CD SUB_SUM_TITLE
#end
                                    , SUBSTR(SO.EQ_TPSZ_CD,2,1) EQ_TPSZ_CD_SUB
                                    , SO.EQ_TPSZ_CD
                                    , DECODE(WRK.TRSP_INV_AUD_STS_CD, 'CF', VNDR.INV_BZC_AMT, 'AR', VNDR.INV_BZC_AMT, 'IF', VNDR.INV_BZC_AMT, 'DA', VNDR.INV_BZC_AMT, 'PD', VNDR.INV_BZC_AMT, 0) INV_BZC_AMT
                                    , DECODE(WRK.TRSP_INV_AUD_STS_CD, 'CF', VNDR.INV_ETC_ADD_AMT, 'AR', VNDR.INV_ETC_ADD_AMT, 'IF', VNDR.INV_ETC_ADD_AMT, 'DA', VNDR.INV_ETC_ADD_AMT, 'PD', VNDR.INV_ETC_ADD_AMT, 0) INV_ETC_ADD_AMT
                                    , CASE WHEN NVL(VNDR.INV_CURR_CD,'USD') = 'USD' THEN 1
                                           ELSE
                                                ( SELECT  USD_LOCL_XCH_RT 
                                                  FROM    GL_MON_XCH_RT WXCH 
                                                  WHERE   ACCT_XCH_RT_LVL = 1 
                                                  AND     CURR_CD = NVL(VNDR.INV_CURR_CD, VNDR.CURR_CD) 
                                                  AND     ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WRK.LOCL_CRE_DT,'YYYYMM'),NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM')))  
                                                )
                                      END INV_USD_LOCL_XCH_RT
                                    , CASE WHEN NVL(VNDR.CURR_CD,'USD') = 'USD' THEN 1
                                           ELSE
                                                ( SELECT  USD_LOCL_XCH_RT 
                                                  FROM    GL_MON_XCH_RT WXCH 
                                                  WHERE   ACCT_XCH_RT_LVL = 1 
                                                  AND     CURR_CD = VNDR.CURR_CD
                                                  AND     ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM'))  
                                                )
                                      END USD_LOCL_XCH_RT
                                    , NVL(VNDR.BZC_AMT,0) BZC_AMT
                                    , NVL(VNDR.ETC_ADD_AMT,0) ETC_ADD_AMT
                                    , 0 TRUK_ETC_ADD_AMT
                                    , 0 HJL_HNDL_AMT
                                    , NVL(VNDR.ETC_ADD_AMT,0) RAIL_ETC_ADD_AMT
                                    , NVL(VNDR.FUEL_SCG_AMT,0) FUEL_SCG_AMT
                                    , 0 SCG_VAT_AMT
                                    , NVL(VNDR.NEGO_AMT,0) NEGO_AMT
                                    , 0 TOLL_FEE_AMT
                                    , SUBSTR(VNDR.FM_NOD_CD,1,@[node_div])  FM_NOD_CD
                                    , '' VIA_NOD_CD
                                    , SUBSTR(VNDR.TO_NOD_CD,1,@[node_div])  TO_NOD_CD
                                    , '' DOR_NOD_CD
                                    , NVL(SUBSTR(VNDR.FM_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(VNDR.TO_NOD_CD,1,@[node_div]), '') NOD_CD
                                    , NVL(VNDR.OVR_WGT_SCG_AMT,0) AS OVR_WGT_SCG_AMT
                                    , NVL(VNDR.HZD_MTRL_SCG_AMT,0) AS HZD_MTRL_SCG_AMT
                                    , 0 TTL_DIST
                                    , '' LNK_DIST_DIV_CD
                                    , 'N' ETS_YN
                              FROM    TRS_TRSP_RAIL_BIL_ORD SO
                                    , TRS_TRSP_EDI_RAIL_ORD WO
                                    , TRS_TRSP_RAIL_INV_WRK WRK
                                    , TRS_TRSP_RAIL_BIL_VNDR_SET VNDR
                                    , BKG_BOOKING BKG
                              WHERE   SO.TRSP_SO_OFC_CTY_CD  = WO.TRSP_SO_OFC_CTY_CD(+)
                              AND     SO.TRSP_SO_SEQ         = WO.TRSP_SO_SEQ(+)
                              AND     SO.BIL_ISS_KNT         = WO.BIL_ISS_KNT(+)
                              AND     SO.TRSP_SO_OFC_CTY_CD  = VNDR.TRSP_SO_OFC_CTY_CD
                              AND     SO.TRSP_SO_SEQ         = VNDR.TRSP_SO_SEQ
                                        AND     VNDR.INV_NO            = WRK.INV_NO (+)
                                        AND     VNDR.INV_VNDR_SEQ      = WRK.INV_VNDR_SEQ    (+)
                                        AND     SO.BKG_NO              = BKG.BKG_NO  (+)
                              AND     SO.DELT_FLG            = 'N'
                              AND     SO.EQ_KND_CD = 'U'

  #if (${bndcd} == 'I')
                              AND     SO.TRSP_BND_CD = 'I'
  #elseif (${bndcd} == 'O')
                              AND     SO.TRSP_BND_CD = 'O'
  #elseif (${bndcd} == 'T')
                              AND     1 = 2
  #elseif (${bndcd} == 'P')
                              AND     SO.TRSP_BND_CD IN ('I','O')
  #end


  #if( !((${FromDate} == '') && (${ToDate} == '')))
    #if( ${period} == 'S' )
                              AND     SO.LOCL_CRE_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'W' )
                              AND     WO.LOCL_CRE_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'I' )
                              AND     WRK.INV_CFM_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'G' )
                              AND     WRK.GL_DT BETWEEN '${FromDate}' AND '${ToDate}'
    #else
                              AND     1 = 2
    #end
  #else
                              AND     1 = 2
  #end

    #if($statusCdArr.size() > 0)
                              AND     WRK.TRSP_INV_AUD_STS_CD IN (
        #foreach( ${key} in ${statusCdArr})
            #if($velocityCount == 1)
            '${key}'
            #else
            , '${key}'
            #end
        #end
            )
    #end

  #if( ${status_cd} == 'INV' )
                              AND     WRK.TRSP_INV_AUD_STS_CD IN ('RC','SV','CF','AR','DA','IF','RJ','PD')
  #end 

  #if( ${radio_office} == 'WO' )
    #if($inputOfcArr.size() > 0)
                              AND     WO.CRE_OFC_CD IN (
        #foreach( ${key} in ${inputOfcArr})
            #if($velocityCount == 1)
            UPPER('${key}')
            #else
            , UPPER('${key}')
            #end
        #end
            )
    #end
  #elseif( ${radio_office} == 'IV' )
    #if($inputOfcArr.size() > 0)
                              AND     WRK.CRE_OFC_CD IN (
        #foreach( ${key} in ${inputOfcArr})
            #if($velocityCount == 1)
            UPPER('${key}')
            #else
            , UPPER('${key}')
            #end
        #end
            )
    #end
  #end

#if($costmodeArr.size() > 0)
                    AND     SO.TRSP_COST_DTL_MOD_CD IN (
    #foreach( ${key} in ${costmodeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end
#if($transmodeArr.size() > 0)
                    AND     'RD' IN (
    #foreach( ${key} in ${transmodeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end
#if($sotypeArr.size() > 0)
                    AND     'R' IN (
    #foreach( ${key} in ${sotypeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

  #if( !(${from_node} == '' || ${from_node} == 'ALL') )
                              AND     vndr.fm_nod_cd like '${from_node}'||'%'
  #end
  #if( !(${via_node} == '' || ${via_node} == 'ALL') )
                              AND     0 = 1
  #end
  #if( !(${to_node} == '' || ${to_node} == 'ALL') )
                              AND     vndr.to_nod_cd like '${to_node}'||'%'
  #end
  #if( !(${door_node} == '' || ${door_node} == 'ALL') )
                              AND     0 = 1
  #end
  #if( !(${bkgterm} == '' || ${bkgterm} == 'ALL') )
                                        AND     DECODE(SO.trsp_bnd_cd,'I',BKG.de_term_cd,'O',BKG.rcv_term_cd,'') = '${bkgterm}'
  #end
#end
                            )
            
    GROUP BY WO_OFC_CD
            ,INV_OFC_CD
            ,CRE_MONTH
            ,TRSP_COST_DTL_MOD_CD -- COST MODE
            ,TRSP_CRR_MOD_CD -- TRANS_MODE
            ,TRSP_BND_CD
            ,TRSP_SO_TP_CD   -- S/O TYPE
            ,BKG_TERM_CD      --BKG_TERM
            ,NOD_CD          -- NODE
            ,INV_CURR_CD -- CURR
            ,ETS_YN
)
          

SELECT CHK
      ,DIV
      ,WO_OFC_CD
      ,INV_OFC_CD
      ,CRE_MONTH
      ,TRSP_COST_DTL_MOD_CD 
      ,TRSP_CRR_MOD_CD
      ,TRSP_BND_CD
      ,TRSP_SO_TP_CD
      ,TRSP_SO_TP_NM
      ,BKG_TERM_CD
      ,BKG_TERM_NM
      ,FM_NOD_CD
      ,VIA_NOD_CD
      ,TO_NOD_CD
      ,DOR_NOD_CD
      ,ETS_YN
      ,TTL_DIST
      ,LNK_DIST_DIV_CD
      ,INV_CURR_CD
        , BZC_D2_AMT
        , FUEL_SCG_D2_AMT
        , SCG_VAT_D2_AMT
        , NEGO_D2_AMT
        , TOLL_FEE_D2_AMT
        , RAIL_ETC_ADD_D2_AMT
        , TRUK_ETC_ADD_D2_AMT
        , HJL_HNDL_D2_AMT
        , OVR_WGT_SCG_D2_AMT
        , HZD_MTRL_SCG_D2_AMT
        , D2_AMT_SUM
        , BZC_D4_AMT
        , FUEL_SCG_D4_AMT
        , SCG_VAT_D4_AMT
        , NEGO_D4_AMT
        , TOLL_FEE_D4_AMT
        , RAIL_ETC_ADD_D4_AMT
        , TRUK_ETC_ADD_D4_AMT
        , HJL_HNDL_D4_AMT
        , OVR_WGT_SCG_D4_AMT
        , HZD_MTRL_SCG_D4_AMT
        , D4_AMT_SUM
        , BZC_AMT
        , FUEL_SCG_AMT
        , SCG_VAT_AMT
        , NEGO_AMT
        , TOLL_FEE_AMT
        , RAIL_ETC_ADD_AMT
        , TRUK_ETC_ADD_AMT
        , HJL_HNDL_AMT
        , OVR_WGT_SCG_AMT
        , HZD_MTRL_SCG_AMT
        , TOT_AMT
        , BZC_D2_AMT_USD
        , FUEL_SCG_D2_AMT_USD
        , SCG_VAT_D2_AMT_USD
        , NEGO_D2_AMT_USD
        , TOLL_FEE_D2_AMT_USD
        , RAIL_ETC_ADD_D2_AMT_USD
        , TRUK_ETC_ADD_D2_AMT_USD
        , HJL_HNDL_D2_AMT_USD
        , OVR_WGT_SCG_D2_AMT_USD
        , HZD_MTRL_SCG_D2_AMT_USD
        , D2_AMT_SUM_USD
        , BZC_D4_AMT_USD
        , FUEL_SCG_D4_AMT_USD
        , SCG_VAT_D4_AMT_USD
        , NEGO_D4_AMT_USD
        , TOLL_FEE_D4_AMT_USD
        , RAIL_ETC_ADD_D4_AMT_USD
        , TRUK_ETC_ADD_D4_AMT_USD
        , HJL_HNDL_D4_AMT_USD
        , OVR_WGT_SCG_D4_AMT_USD
        , HZD_MTRL_SCG_D4_AMT_USD
        , D4_AMT_SUM_USD
        , BZC_AMT_USD
        , FUEL_SCG_AMT_USD
        , SCG_VAT_AMT_USD
        , NEGO_AMT_USD
        , TOLL_FEE_AMT_USD
        , RAIL_ETC_ADD_AMT_USD
        , TRUK_ETC_ADD_AMT_USD
        , HJL_HNDL_AMT_USD
        , OVR_WGT_SCG_AMT_USD
        , HZD_MTRL_SCG_AMT_USD
        , TOT_AMT_USD
        , INV_BZC_D2_AMT
        -- Invoice Additional D2
        , INV_ETC_ADD_D2_AMT
        , INV_BZC_D4_AMT
        -- Invoice Additional D4
        , INV_ETC_ADD_D4_AMT
        , INV_BZC_AMT
        -- Invoice Additional
        , INV_ETC_ADD_AMT
        , INV_TOT_AMT
        , INV_BZC_D2_AMT_USD
        -- Invoice Additional D2 USD
        , INV_ETC_ADD_D2_AMT_USD
        , INV_BZC_D4_AMT_USD
        -- Invoice Additional D4 USD
        , INV_ETC_ADD_D4_AMT_USD
        , INV_BZC_AMT_USD
        -- Invoice Additional USD
        , INV_ETC_ADD_AMT_USD
        , INV_TOT_AMT_USD
        , CNTN20
        , CNTN40
        , CNTN_TEU
        , CNTN_BOX
        , D2_CNT
        , D4_CNT
        , D5_CNT
        , D7_CNT
        , R2_CNT
        , R4_CNT
        , R5_CNT
        , R7_CNT
        , R8_CNT
        , F2_CNT
        , F4_CNT
        , F5_CNT
        , A2_CNT
        , A4_CNT
        , A5_CNT
        , P2_CNT
        , P4_CNT
        , O2_CNT
        , O4_CNT
        , O5_CNT
        , O7_CNT
        , S2_CNT
        , S4_CNT
        , T2_CNT
        , T4_CNT
        , DX_CNT
        , DW_CNT
FROM      
(
    SELECT  '' CHK
          ,DIV
          ,WO_OFC_CD
          ,INV_OFC_CD
          ,CRE_MONTH
          ,TRSP_COST_DTL_MOD_CD 
          ,TRSP_CRR_MOD_CD
          ,TRSP_BND_CD
          ,TRSP_SO_TP_CD
          ,TRSP_SO_TP_NM
          ,BKG_TERM_CD
          ,DECODE(BKG_TERM_CD,'Y','CY'
                            ,'D','Door'
                            ,'H','C''Haul on CY'
                            ,'T','Tackle'
                            ,'I','Free In'
                            ,'O','Free Out'
                            ,'M','Mixed'
                            ,'')  BKG_TERM_NM
          ,FM_NOD_CD
          ,VIA_NOD_CD
          ,TO_NOD_CD
          ,DOR_NOD_CD
          ,ETS_YN
          ,TTL_DIST
          ,LNK_DIST_DIV_CD
          ,INV_CURR_CD
            , BZC_D2_AMT
            , FUEL_SCG_D2_AMT
            , SCG_VAT_D2_AMT
            , NEGO_D2_AMT
            , TOLL_FEE_D2_AMT
            , RAIL_ETC_ADD_D2_AMT
            , TRUK_ETC_ADD_D2_AMT
            , HJL_HNDL_D2_AMT
            , OVR_WGT_SCG_D2_AMT
            , HZD_MTRL_SCG_D2_AMT
            , D2_AMT_SUM
            , BZC_D4_AMT
            , FUEL_SCG_D4_AMT
            , SCG_VAT_D4_AMT
            , NEGO_D4_AMT
            , TOLL_FEE_D4_AMT
            , RAIL_ETC_ADD_D4_AMT
            , TRUK_ETC_ADD_D4_AMT
            , HJL_HNDL_D4_AMT
            , OVR_WGT_SCG_D4_AMT
            , HZD_MTRL_SCG_D4_AMT
            , D4_AMT_SUM
            , BZC_AMT
            , FUEL_SCG_AMT
            , SCG_VAT_AMT
            , NEGO_AMT
            , TOLL_FEE_AMT
            , RAIL_ETC_ADD_AMT
            , TRUK_ETC_ADD_AMT
            , HJL_HNDL_AMT
            , OVR_WGT_SCG_AMT
            , HZD_MTRL_SCG_AMT
            , TOT_AMT
            , BZC_D2_AMT_USD
            , FUEL_SCG_D2_AMT_USD
            , SCG_VAT_D2_AMT_USD
            , NEGO_D2_AMT_USD
            , TOLL_FEE_D2_AMT_USD
            , RAIL_ETC_ADD_D2_AMT_USD
            , TRUK_ETC_ADD_D2_AMT_USD
            , HJL_HNDL_D2_AMT_USD
            , OVR_WGT_SCG_D2_AMT_USD
            , HZD_MTRL_SCG_D2_AMT_USD
            , D2_AMT_SUM_USD
            , BZC_D4_AMT_USD
            , FUEL_SCG_D4_AMT_USD
            , SCG_VAT_D4_AMT_USD
            , NEGO_D4_AMT_USD
            , TOLL_FEE_D4_AMT_USD
            , RAIL_ETC_ADD_D4_AMT_USD
            , TRUK_ETC_ADD_D4_AMT_USD
            , HJL_HNDL_D4_AMT_USD
            , OVR_WGT_SCG_D4_AMT_USD
            , HZD_MTRL_SCG_D4_AMT_USD
            , D4_AMT_SUM_USD
            , BZC_AMT_USD
            , FUEL_SCG_AMT_USD
            , SCG_VAT_AMT_USD
            , NEGO_AMT_USD
            , TOLL_FEE_AMT_USD
            , RAIL_ETC_ADD_AMT_USD
            , TRUK_ETC_ADD_AMT_USD
            , HJL_HNDL_AMT_USD
            , OVR_WGT_SCG_AMT_USD
            , HZD_MTRL_SCG_AMT_USD
            , TOT_AMT_USD
            , INV_BZC_D2_AMT
            -- Invoice Additional D2
            , INV_ETC_ADD_D2_AMT
            , INV_BZC_D4_AMT
            -- Invoice Additional D4
            , INV_ETC_ADD_D4_AMT
            , INV_BZC_AMT
            -- Invoice Additional
            , INV_ETC_ADD_AMT
            , INV_TOT_AMT
            , INV_BZC_D2_AMT_USD
            -- Invoice Additional D2 USD
            , INV_ETC_ADD_D2_AMT_USD
            , INV_BZC_D4_AMT_USD
            -- Invoice Additional D4 USD
            , INV_ETC_ADD_D4_AMT_USD
            , INV_BZC_AMT_USD
            -- Invoice Additional USD
            , INV_ETC_ADD_AMT_USD
            , INV_TOT_AMT_USD
            , CNTN20
            , CNTN40
            , CNTN_TEU
            , CNTN_BOX
            , D2_CNT
            , D4_CNT
            , D5_CNT
            , D7_CNT
            , R2_CNT
            , R4_CNT
            , R5_CNT
            , R7_CNT
            , R8_CNT
            , F2_CNT
            , F4_CNT
            , F5_CNT
            , A2_CNT
            , A4_CNT
            , A5_CNT
            , P2_CNT
            , P4_CNT
            , O2_CNT
            , O4_CNT
            , O5_CNT
            , O7_CNT
            , S2_CNT
            , S4_CNT
            , T2_CNT
            , T4_CNT
            , DX_CNT
            , DW_CNT
    FROM      
    (
        -- SUB SUM 없는 데이터
        SELECT '11' DIV
              ,WO_OFC_CD    
              ,INV_OFC_CD
              ,CRE_MONTH    
              ,TRSP_COST_DTL_MOD_CD    
              ,TRSP_CRR_MOD_CD    
              ,TRSP_BND_CD    
              ,TRSP_SO_TP_CD    
              ,TRSP_SO_TP_NM    
              ,BKG_TERM_CD
              ,NOD_CD    
              ,FM_NOD_CD    
              ,VIA_NOD_CD    
              ,TO_NOD_CD    
              ,DOR_NOD_CD    
              ,ETS_YN    
              ,TTL_DIST    
              ,LNK_DIST_DIV_CD    
              ,INV_CURR_CD    
              ,SUB_SUM_TITLE    
                    , BZC_D2_AMT
                    , FUEL_SCG_D2_AMT
                    , SCG_VAT_D2_AMT
                    , NEGO_D2_AMT
                    , TOLL_FEE_D2_AMT
                    , RAIL_ETC_ADD_D2_AMT
                    , TRUK_ETC_ADD_D2_AMT
                    , HJL_HNDL_D2_AMT
                    , OVR_WGT_SCG_D2_AMT
                    , HZD_MTRL_SCG_D2_AMT
                    , D2_AMT_SUM
                    , BZC_D4_AMT
                    , FUEL_SCG_D4_AMT
                    , SCG_VAT_D4_AMT
                    , NEGO_D4_AMT
                    , TOLL_FEE_D4_AMT
                    , RAIL_ETC_ADD_D4_AMT
                    , TRUK_ETC_ADD_D4_AMT
                    , HJL_HNDL_D4_AMT
                    , OVR_WGT_SCG_D4_AMT
                    , HZD_MTRL_SCG_D4_AMT
                    , D4_AMT_SUM
                    , BZC_AMT
                    , FUEL_SCG_AMT
                    , SCG_VAT_AMT
                    , NEGO_AMT
                    , TOLL_FEE_AMT
                    , RAIL_ETC_ADD_AMT
                    , TRUK_ETC_ADD_AMT
                    , HJL_HNDL_AMT
                    , OVR_WGT_SCG_AMT
                    , HZD_MTRL_SCG_AMT
                    , TOT_AMT
                    , BZC_D2_AMT_USD
                    , FUEL_SCG_D2_AMT_USD
                    , SCG_VAT_D2_AMT_USD
                    , NEGO_D2_AMT_USD
                    , TOLL_FEE_D2_AMT_USD
                    , RAIL_ETC_ADD_D2_AMT_USD
                    , TRUK_ETC_ADD_D2_AMT_USD
                    , HJL_HNDL_D2_AMT_USD
                    , OVR_WGT_SCG_D2_AMT_USD
                    , HZD_MTRL_SCG_D2_AMT_USD
                    , D2_AMT_SUM_USD
                    , BZC_D4_AMT_USD
                    , FUEL_SCG_D4_AMT_USD
                    , SCG_VAT_D4_AMT_USD
                    , NEGO_D4_AMT_USD
                    , TOLL_FEE_D4_AMT_USD
                    , RAIL_ETC_ADD_D4_AMT_USD
                    , TRUK_ETC_ADD_D4_AMT_USD
                    , HJL_HNDL_D4_AMT_USD
                    , OVR_WGT_SCG_D4_AMT_USD
                    , HZD_MTRL_SCG_D4_AMT_USD
                    , D4_AMT_SUM_USD
                    , BZC_AMT_USD
                    , FUEL_SCG_AMT_USD
                    , SCG_VAT_AMT_USD
                    , NEGO_AMT_USD
                    , TOLL_FEE_AMT_USD
                    , RAIL_ETC_ADD_AMT_USD
                    , TRUK_ETC_ADD_AMT_USD
                    , HJL_HNDL_AMT_USD
                    , OVR_WGT_SCG_AMT_USD
                    , HZD_MTRL_SCG_AMT_USD
                    , TOT_AMT_USD
                    , INV_BZC_D2_AMT
                    -- Invoice Additional D2
                    , INV_ETC_ADD_D2_AMT
                    , INV_BZC_D4_AMT
                    -- Invoice Additional D4
                    , INV_ETC_ADD_D4_AMT
                    , INV_BZC_AMT
                    -- Invoice Additional
                    , INV_ETC_ADD_AMT
                    , INV_TOT_AMT
                    , INV_BZC_D2_AMT_USD
                    -- Invoice Additional D2 USD
                    , INV_ETC_ADD_D2_AMT_USD
                    , INV_BZC_D4_AMT_USD
                    -- Invoice Additional D4 USD
                    , INV_ETC_ADD_D4_AMT_USD
                    , INV_BZC_AMT_USD
                    -- Invoice Additional USD
                    , INV_ETC_ADD_AMT_USD
                    , INV_TOT_AMT_USD
                    , CNTN20
                    , CNTN40
                    , CNTN_TEU
                    , CNTN_BOX
                    , D2_CNT
                    , D4_CNT
                    , D5_CNT
                    , D7_CNT
                    , R2_CNT
                    , R4_CNT
                    , R5_CNT
                    , R7_CNT
                    , R8_CNT
                    , F2_CNT
                    , F4_CNT
                    , F5_CNT
                    , A2_CNT
                    , A4_CNT
                    , A5_CNT
                    , P2_CNT
                    , P4_CNT
                    , O2_CNT
                    , O4_CNT
                    , O5_CNT
                    , O7_CNT
                    , S2_CNT
                    , S4_CNT
                    , T2_CNT
                    , T4_CNT
                    , DX_CNT
                    , DW_CNT
        FROM WITH_RESULT     
         
        -- OFFICE SUM SUM       
        UNION ALL
        SELECT '22' DIV
              ,SUB_SUM_TITLE  || ' Total' WO_OFC_CD
              ,NULL CRE_MONTH    
              ,NULL TRSP_COST_DTL_MOD_CD    
              ,NULL TRSP_CRR_MOD_CD    
              ,NULL TRSP_BND_CD    
              ,NULL TRSP_SO_TP_CD    
              ,NULL TRSP_SO_TP_NM    
              ,NULL BKG_TERM_CD
              ,NULL BKG_TERM_NM
              ,NULL NOD_CD    
              ,NULL FM_NOD_CD    
              ,NULL VIA_NOD_CD    
              ,NULL TO_NOD_CD    
              ,NULL DOR_NOD_CD    
              ,NULL ETS_YN    
              ,NVL(SUM(TTL_DIST                  ),0)
              ,NULL LNK_DIST_DIV_CD    
              ,NULL INV_CURR_CD    
              ,MAX(SUB_SUM_TITLE    )
                            ,NVL(SUM(BZC_D2_AMT                ),0)
                            ,NVL(SUM(FUEL_SCG_D2_AMT           ),0)
                            ,NVL(SUM(SCG_VAT_D2_AMT            ),0)
                            ,NVL(SUM(NEGO_D2_AMT               ),0)
                            ,NVL(SUM(TOLL_FEE_D2_AMT               ),0)
                            ,NVL(SUM(RAIL_ETC_ADD_D2_AMT       ),0)
                            ,NVL(SUM(TRUK_ETC_ADD_D2_AMT       ),0)
                            ,NVL(SUM(HJL_HNDL_D2_AMT           ),0)
                            ,NVL(SUM(OVR_WGT_SCG_D2_AMT        ),0)
                            ,NVL(SUM(HZD_MTRL_SCG_D2_AMT       ),0)
                            ,NVL(SUM(D2_AMT_SUM                ),0)
                            ,NVL(SUM(BZC_D4_AMT                ),0)
                            ,NVL(SUM(FUEL_SCG_D4_AMT           ),0)
                            ,NVL(SUM(SCG_VAT_D4_AMT            ),0)
                            ,NVL(SUM(NEGO_D4_AMT               ),0)
                            ,NVL(SUM(TOLL_FEE_D4_AMT               ),0)
                            ,NVL(SUM(RAIL_ETC_ADD_D4_AMT       ),0)
                            ,NVL(SUM(TRUK_ETC_ADD_D4_AMT       ),0)
                            ,NVL(SUM(HJL_HNDL_D4_AMT           ),0)
                            ,NVL(SUM(OVR_WGT_SCG_D4_AMT        ),0)
                            ,NVL(SUM(HZD_MTRL_SCG_D4_AMT       ),0)
                            ,NVL(SUM(D4_AMT_SUM                ),0)
                            ,NVL(SUM(BZC_AMT                   ),0)
                            ,NVL(SUM(FUEL_SCG_AMT              ),0)
                            ,NVL(SUM(SCG_VAT_AMT               ),0)
                            ,NVL(SUM(NEGO_AMT                  ),0)
                            ,NVL(SUM(TOLL_FEE_AMT                  ),0)
                            ,NVL(SUM(RAIL_ETC_ADD_AMT          ),0)
                            ,NVL(SUM(TRUK_ETC_ADD_AMT          ),0)
                            ,NVL(SUM(HJL_HNDL_AMT              ),0)
                            ,NVL(SUM(OVR_WGT_SCG_AMT           ),0)
                            ,NVL(SUM(HZD_MTRL_SCG_AMT          ),0)
                            ,NVL(SUM(TOT_AMT                   ),0)
                            ,NVL(SUM(BZC_D2_AMT_USD            ),0)
                            ,NVL(SUM(FUEL_SCG_D2_AMT_USD       ),0)
                            ,NVL(SUM(SCG_VAT_D2_AMT_USD        ),0)
                            ,NVL(SUM(NEGO_D2_AMT_USD           ),0)
                            ,NVL(SUM(TOLL_FEE_D2_AMT_USD           ),0)
                            ,NVL(SUM(RAIL_ETC_ADD_D2_AMT_USD   ),0)
                            ,NVL(SUM(TRUK_ETC_ADD_D2_AMT_USD   ),0)
                            ,NVL(SUM(HJL_HNDL_D2_AMT_USD       ),0)
                            ,NVL(SUM(OVR_WGT_SCG_D2_AMT_USD    ),0)
                            ,NVL(SUM(HZD_MTRL_SCG_D2_AMT_USD   ),0)
                            ,NVL(SUM(D2_AMT_SUM_USD            ),0)
                            ,NVL(SUM(BZC_D4_AMT_USD            ),0)
                            ,NVL(SUM(FUEL_SCG_D4_AMT_USD       ),0)
                            ,NVL(SUM(SCG_VAT_D4_AMT_USD        ),0)
                            ,NVL(SUM(NEGO_D4_AMT_USD           ),0)
                            ,NVL(SUM(TOLL_FEE_D4_AMT_USD           ),0)
                            ,NVL(SUM(RAIL_ETC_ADD_D4_AMT_USD   ),0)
                            ,NVL(SUM(TRUK_ETC_ADD_D4_AMT_USD   ),0)
                            ,NVL(SUM(HJL_HNDL_D4_AMT_USD       ),0)
                            ,NVL(SUM(OVR_WGT_SCG_D4_AMT_USD    ),0)
                            ,NVL(SUM(HZD_MTRL_SCG_D4_AMT_USD   ),0)
                            ,NVL(SUM(D4_AMT_SUM_USD            ),0)
                            ,NVL(SUM(BZC_AMT_USD               ),0)
                            ,NVL(SUM(FUEL_SCG_AMT_USD          ),0)
                            ,NVL(SUM(SCG_VAT_AMT_USD           ),0)
                            ,NVL(SUM(NEGO_AMT_USD              ),0)
                            ,NVL(SUM(TOLL_FEE_AMT_USD              ),0)
                            ,NVL(SUM(RAIL_ETC_ADD_AMT_USD      ),0)
                            ,NVL(SUM(TRUK_ETC_ADD_AMT_USD      ),0)
                            ,NVL(SUM(HJL_HNDL_AMT_USD          ),0)
                            ,NVL(SUM(OVR_WGT_SCG_AMT_USD       ),0)
                            ,NVL(SUM(HZD_MTRL_SCG_AMT_USD      ),0)
                            ,NVL(SUM(TOT_AMT_USD               ),0)
                            ,NVL(SUM(INV_BZC_D2_AMT            ),0)
                            ,NVL(SUM(INV_ETC_ADD_D2_AMT        ),0)
                            ,NVL(SUM(INV_BZC_D4_AMT            ),0)
                            ,NVL(SUM(INV_ETC_ADD_D4_AMT        ),0)
                            ,NVL(SUM(INV_BZC_AMT               ),0)
                            ,NVL(SUM(INV_ETC_ADD_AMT           ),0)
                            ,NVL(SUM(INV_TOT_AMT               ),0)
                            ,NVL(SUM(INV_BZC_D2_AMT_USD        ),0)
                            ,NVL(SUM(INV_ETC_ADD_D2_AMT_USD    ),0)
                            ,NVL(SUM(INV_BZC_D4_AMT_USD        ),0)
                            ,NVL(SUM(INV_ETC_ADD_D4_AMT_USD    ),0)
                            ,NVL(SUM(INV_BZC_AMT_USD           ),0)
                            ,NVL(SUM(INV_ETC_ADD_AMT_USD       ),0)
                            ,NVL(SUM(INV_TOT_AMT_USD           ),0)
                            ,NVL(SUM(CNTN20                    ),0)
                            ,NVL(SUM(CNTN40                    ),0)
                            ,NVL(SUM(CNTN_TEU                  ),0)
                            ,NVL(SUM(CNTN_BOX                  ),0)
                            ,NVL(SUM(D2_CNT                    ),0)
                            ,NVL(SUM(D4_CNT                    ),0)
                            ,NVL(SUM(D5_CNT                    ),0)
                            ,NVL(SUM(D7_CNT                    ),0)
                            ,NVL(SUM(R2_CNT                    ),0)
                            ,NVL(SUM(R4_CNT                    ),0)
                            ,NVL(SUM(R5_CNT                    ),0)
                            ,NVL(SUM(R7_CNT                    ),0)
                            ,NVL(SUM(R8_CNT                    ),0)
                            ,NVL(SUM(F2_CNT                    ),0)
                            ,NVL(SUM(F4_CNT                    ),0)
                            ,NVL(SUM(F5_CNT                    ),0)
                            ,NVL(SUM(A2_CNT                    ),0)
                            ,NVL(SUM(A4_CNT                    ),0)
                            ,NVL(SUM(A5_CNT                    ),0)
                            ,NVL(SUM(P2_CNT                    ),0)
                            ,NVL(SUM(P4_CNT                    ),0)
                            ,NVL(SUM(O2_CNT                    ),0)
                            ,NVL(SUM(O4_CNT                    ),0)
                            ,NVL(SUM(O5_CNT                    ),0)
                            ,NVL(SUM(O7_CNT                    ),0)
                            ,NVL(SUM(S2_CNT                    ),0)
                            ,NVL(SUM(S4_CNT                    ),0)
                            ,NVL(SUM(T2_CNT                    ),0)
                            ,NVL(SUM(T4_CNT                    ),0)
                            ,NVL(SUM(DX_CNT                    ),0)
                            ,NVL(SUM(DW_CNT                    ),0)

        FROM WITH_RESULT    
        GROUP BY SUB_SUM_TITLE  
    
        -- 전체 TOTAL 
        UNION ALL
        SELECT '44' DIV
              ,'G/Total' WO_OFC_CD    
              ,NULL CRE_MONTH    
              ,NULL TRSP_COST_DTL_MOD_CD    
              ,NULL TRSP_CRR_MOD_CD    
              ,NULL TRSP_BND_CD    
              ,NULL TRSP_SO_TP_CD    
              ,NULL TRSP_SO_TP_NM    
              ,NULL BKG_TERM_CD
              ,NULL BKG_TERM_NM
              ,NULL NOD_CD    
              ,NULL FM_NOD_CD    
              ,NULL VIA_NOD_CD    
              ,NULL TO_NOD_CD    
              ,NULL DOR_NOD_CD    
              ,NULL ETS_YN    
              ,NVL(SUM(TTL_DIST                  ),0)
              ,NULL LNK_DIST_DIV_CD    
              ,NULL INV_CURR_CD    
              ,NULL SUB_SUM_TITLE    
                            ,NVL(SUM(BZC_D2_AMT                ),0)
                            ,NVL(SUM(FUEL_SCG_D2_AMT           ),0)
                            ,NVL(SUM(SCG_VAT_D2_AMT            ),0)
                            ,NVL(SUM(NEGO_D2_AMT               ),0)
                            ,NVL(SUM(TOLL_FEE_D2_AMT               ),0)
                            ,NVL(SUM(RAIL_ETC_ADD_D2_AMT       ),0)
                            ,NVL(SUM(TRUK_ETC_ADD_D2_AMT       ),0)
                            ,NVL(SUM(HJL_HNDL_D2_AMT           ),0)
                            ,NVL(SUM(OVR_WGT_SCG_D2_AMT        ),0)
                            ,NVL(SUM(HZD_MTRL_SCG_D2_AMT       ),0)
                            ,NVL(SUM(D2_AMT_SUM                ),0)
                            ,NVL(SUM(BZC_D4_AMT                ),0)
                            ,NVL(SUM(FUEL_SCG_D4_AMT           ),0)
                            ,NVL(SUM(SCG_VAT_D4_AMT            ),0)
                            ,NVL(SUM(NEGO_D4_AMT               ),0)
                            ,NVL(SUM(TOLL_FEE_D4_AMT               ),0)
                            ,NVL(SUM(RAIL_ETC_ADD_D4_AMT       ),0)
                            ,NVL(SUM(TRUK_ETC_ADD_D4_AMT       ),0)
                            ,NVL(SUM(HJL_HNDL_D4_AMT           ),0)
                            ,NVL(SUM(OVR_WGT_SCG_D4_AMT        ),0)
                            ,NVL(SUM(HZD_MTRL_SCG_D4_AMT       ),0)
                            ,NVL(SUM(D4_AMT_SUM                ),0)
                            ,NVL(SUM(BZC_AMT                   ),0)
                            ,NVL(SUM(FUEL_SCG_AMT              ),0)
                            ,NVL(SUM(SCG_VAT_AMT               ),0)
                            ,NVL(SUM(NEGO_AMT                  ),0)
                            ,NVL(SUM(TOLL_FEE_AMT                  ),0)
                            ,NVL(SUM(RAIL_ETC_ADD_AMT          ),0)
                            ,NVL(SUM(TRUK_ETC_ADD_AMT          ),0)
                            ,NVL(SUM(HJL_HNDL_AMT              ),0)
                            ,NVL(SUM(OVR_WGT_SCG_AMT           ),0)
                            ,NVL(SUM(HZD_MTRL_SCG_AMT          ),0)
                            ,NVL(SUM(TOT_AMT                   ),0)
                            ,NVL(SUM(BZC_D2_AMT_USD            ),0)
                            ,NVL(SUM(FUEL_SCG_D2_AMT_USD       ),0)
                            ,NVL(SUM(SCG_VAT_D2_AMT_USD        ),0)
                            ,NVL(SUM(NEGO_D2_AMT_USD           ),0)
                            ,NVL(SUM(TOLL_FEE_D2_AMT_USD           ),0)
                            ,NVL(SUM(RAIL_ETC_ADD_D2_AMT_USD   ),0)
                            ,NVL(SUM(TRUK_ETC_ADD_D2_AMT_USD   ),0)
                            ,NVL(SUM(HJL_HNDL_D2_AMT_USD       ),0)
                            ,NVL(SUM(OVR_WGT_SCG_D2_AMT_USD    ),0)
                            ,NVL(SUM(HZD_MTRL_SCG_D2_AMT_USD   ),0)
                            ,NVL(SUM(D2_AMT_SUM_USD            ),0)
                            ,NVL(SUM(BZC_D4_AMT_USD            ),0)
                            ,NVL(SUM(FUEL_SCG_D4_AMT_USD       ),0)
                            ,NVL(SUM(SCG_VAT_D4_AMT_USD        ),0)
                            ,NVL(SUM(NEGO_D4_AMT_USD           ),0)
                            ,NVL(SUM(TOLL_FEE_D4_AMT_USD           ),0)
                            ,NVL(SUM(RAIL_ETC_ADD_D4_AMT_USD   ),0)
                            ,NVL(SUM(TRUK_ETC_ADD_D4_AMT_USD   ),0)
                            ,NVL(SUM(HJL_HNDL_D4_AMT_USD       ),0)
                            ,NVL(SUM(OVR_WGT_SCG_D4_AMT_USD    ),0)
                            ,NVL(SUM(HZD_MTRL_SCG_D4_AMT_USD   ),0)
                            ,NVL(SUM(D4_AMT_SUM_USD            ),0)
                            ,NVL(SUM(BZC_AMT_USD               ),0)
                            ,NVL(SUM(FUEL_SCG_AMT_USD          ),0)
                            ,NVL(SUM(SCG_VAT_AMT_USD           ),0)
                            ,NVL(SUM(NEGO_AMT_USD              ),0)
                            ,NVL(SUM(TOLL_FEE_AMT_USD              ),0)
                            ,NVL(SUM(RAIL_ETC_ADD_AMT_USD      ),0)
                            ,NVL(SUM(TRUK_ETC_ADD_AMT_USD      ),0)
                            ,NVL(SUM(HJL_HNDL_AMT_USD          ),0)
                            ,NVL(SUM(OVR_WGT_SCG_AMT_USD       ),0)
                            ,NVL(SUM(HZD_MTRL_SCG_AMT_USD      ),0)
                            ,NVL(SUM(TOT_AMT_USD               ),0)
                            ,NVL(SUM(INV_BZC_D2_AMT            ),0)
                            ,NVL(SUM(INV_ETC_ADD_D2_AMT        ),0)
                            ,NVL(SUM(INV_BZC_D4_AMT            ),0)
                            ,NVL(SUM(INV_ETC_ADD_D4_AMT        ),0)
                            ,NVL(SUM(INV_BZC_AMT               ),0)
                            ,NVL(SUM(INV_ETC_ADD_AMT           ),0)
                            ,NVL(SUM(INV_TOT_AMT               ),0)
                            ,NVL(SUM(INV_BZC_D2_AMT_USD        ),0)
                            ,NVL(SUM(INV_ETC_ADD_D2_AMT_USD    ),0)
                            ,NVL(SUM(INV_BZC_D4_AMT_USD        ),0)
                            ,NVL(SUM(INV_ETC_ADD_D4_AMT_USD    ),0)
                            ,NVL(SUM(INV_BZC_AMT_USD           ),0)
                            ,NVL(SUM(INV_ETC_ADD_AMT_USD       ),0)
                            ,NVL(SUM(INV_TOT_AMT_USD           ),0)
                            ,NVL(SUM(CNTN20                    ),0)
                            ,NVL(SUM(CNTN40                    ),0)
                            ,NVL(SUM(CNTN_TEU                  ),0)
                            ,NVL(SUM(CNTN_BOX                  ),0)
                            ,NVL(SUM(D2_CNT                    ),0)
                            ,NVL(SUM(D4_CNT                    ),0)
                            ,NVL(SUM(D5_CNT                    ),0)
                            ,NVL(SUM(D7_CNT                    ),0)
                            ,NVL(SUM(R2_CNT                    ),0)
                            ,NVL(SUM(R4_CNT                    ),0)
                            ,NVL(SUM(R5_CNT                    ),0)
                            ,NVL(SUM(R7_CNT                    ),0)
                            ,NVL(SUM(R8_CNT                    ),0)
                            ,NVL(SUM(F2_CNT                    ),0)
                            ,NVL(SUM(F4_CNT                    ),0)
                            ,NVL(SUM(F5_CNT                    ),0)
                            ,NVL(SUM(A2_CNT                    ),0)
                            ,NVL(SUM(A4_CNT                    ),0)
                            ,NVL(SUM(A5_CNT                    ),0)
                            ,NVL(SUM(P2_CNT                    ),0)
                            ,NVL(SUM(P4_CNT                    ),0)
                            ,NVL(SUM(O2_CNT                    ),0)
                            ,NVL(SUM(O4_CNT                    ),0)
                            ,NVL(SUM(O5_CNT                    ),0)
                            ,NVL(SUM(O7_CNT                    ),0)
                            ,NVL(SUM(S2_CNT                    ),0)
                            ,NVL(SUM(S4_CNT                    ),0)
                            ,NVL(SUM(T2_CNT                    ),0)
                            ,NVL(SUM(T4_CNT                    ),0)
                            ,NVL(SUM(DX_CNT                    ),0)
                            ,NVL(SUM(DW_CNT                    ),0)
        FROM WITH_RESULT    
        GROUP BY 'G/Total'
    )   
    ORDER BY SUB_SUM_TITLE
            ,DIV
            ,WO_OFC_CD
            ,INV_OFC_CD
            ,CRE_MONTH
            ,TRSP_BND_CD
            ,ETS_YN              
)             

#if (${grid_flg} == 'Y')
WHERE     ROWNUM < 2001
#end			]]></sql>
			<params>
				<param name="node_div" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
