<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceManageDBDAOSearchErpInterfaceCheckDataRSQL">
			<desc><![CDATA[SearchErpInterfaceCheckData]]></desc>
			<sql><![CDATA[
SELECT
    --- Source
    COUNT(distinct a.n3pty_expn_tp_cd) n3pty_expn_tp_cd_cnt,
    MAX(a.n3pty_expn_tp_cd) n3pty_expn_tp_cd_max,
    --- Billing case
    COUNT(distinct z.n3pty_bil_tp_cd) n3pty_bil_tp_cd_cnt,
    MAX(z.n3pty_bil_tp_cd) n3pty_bil_tp_cd_max,
    --- 3rd Party
    COUNT( distinct DECODE(a.vndr_cust_div_cd, 'V',TO_CHAR(a.vndr_seq), 'C', a.cust_cnt_cd||a.cust_seq, 'S',a.n3pty_ofc_cd, NULL) ) trd_party_code_cnt,
    MAX( DECODE(a.vndr_cust_div_cd, 'V',TO_CHAR(a.vndr_seq), 'C', a.cust_cnt_cd||a.cust_seq, 'S',a.n3pty_ofc_cd, NULL) ) trd_party_code_max,
    --- Revenue VVD
    COUNT( distinct NVL( DECODE(a.n3pty_src_sub_sys_cd, 'MNR',NULL, a.vsl_cd||a.skd_voy_no||a.finc_dir_cd), '-') ) revenue_vvd_cnt,
    MAX( DECODE(a.n3pty_src_sub_sys_cd, 'MNR',NULL, a.vsl_cd||a.skd_voy_no||a.finc_dir_cd) ) revenue_vvd_max,
    --- Currency
    COUNT( distinct y.curr_cd ) curr_cd_cnt,
    MAX( y.curr_cd ) curr_cd_max,
    --- Actual VVD
    COUNT( distinct NVL(z.vvd_cd,'-' )) vvd_cd_cnt,
    MAX( z.vvd_cd ) vvd_cd_max,
    --- CSR No.
    COUNT( distinct NVL(z.csr_no,'-' )) csr_no_cnt,
    MAX( z.csr_no ) csr_no_max,
    --- Month of GL Date
    COUNT( distinct NVL(SUBSTRB(z.gl_dt,1,6),'-') ) gl_month_cnt,
    MAX( SUBSTRB(z.gl_dt,1,6) ) gl_month_max
FROM tpb_ots_dtl a,
  tpb_ots_grp b,
  tpb_inv_rvis_dtl z,
  tpb_inv_rvis y,
  tpb_invoice x
WHERE y.n3pty_inv_no = x.n3pty_inv_no
  AND y.n3pty_inv_no = z.n3pty_inv_no
  AND y.n3pty_inv_no = b.n3pty_inv_no
  AND b.n3pty_no = a.n3pty_no
  AND a.n3pty_delt_tp_cd = 'N'
  AND x.n3pty_delt_tp_cd = 'N'
  AND y.n3pty_delt_tp_cd = 'N'
  AND z.n3pty_delt_tp_cd = 'N'
  AND y.n3pty_inv_no = @[s_n3pty_inv_no]
  AND y.n3pty_inv_rvis_seq = @[s_n3pty_inv_his_seq]			]]></sql>
			<params>
				<param name="s_n3pty_inv_no" type="12" value="" out="N"/>
				<param name="s_n3pty_inv_his_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
