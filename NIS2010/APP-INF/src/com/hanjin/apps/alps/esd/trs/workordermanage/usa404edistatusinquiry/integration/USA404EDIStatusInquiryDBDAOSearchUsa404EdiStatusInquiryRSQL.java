/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : USA404EDIStatusInquiryDBDAOSearchUsa404EdiStatusInquiryRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.07.11
*@LastModifier : 최종혁
*@LastVersion : 1.0
* 2016.07.11 최종혁
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esd.trs.workordermanage.usa404edistatusinquiry.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author CJH
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class USA404EDIStatusInquiryDBDAOSearchUsa404EdiStatusInquiryRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * 404 Edi 대상 조회 SQL
	  * </pre>
	  */
	public USA404EDIStatusInquiryDBDAOSearchUsa404EdiStatusInquiryRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sSvcProvid",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("frmNode",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("status",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("frmDate",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("toDate",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("edKind",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fuEmpy",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("railRoad",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("toNode",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("bound",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esd.trs.workordermanage.usa404edistatusinquiry.integration").append("\n"); 
		query.append("FileName : USA404EDIStatusInquiryDBDAOSearchUsa404EdiStatusInquiryRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT /*+ ORDERED USE_HASH(M) USE_NL(S T) */" ).append("\n"); 
		query.append("    M.INV_NO," ).append("\n"); 
		query.append("    M.LASTCHK," ).append("\n"); 
		query.append("    M.COP_NO," ).append("\n"); 
		query.append("    M.COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("    M.SUB_RAIL_SEQ," ).append("\n"); 
		query.append("    M.VNDR_SEQ," ).append("\n"); 
		query.append("    M.TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("    M.TRSP_SO_SEQ," ).append("\n"); 
		query.append("    '' CHK1," ).append("\n"); 
		query.append("    '' CHK2," ).append("\n"); 
		query.append("    '' CHK3," ).append("\n"); 
		query.append("    M.WO_RJCT_RSN," ).append("\n"); 
		query.append("    M.CXL_RQST_FLG," ).append("\n"); 
		query.append("    M.REPO_PLN_ID," ).append("\n"); 
		query.append("    M.PLN_YRWK," ).append("\n"); 
		query.append("    M.REF_ID," ).append("\n"); 
		query.append("    M.REF_SEQ," ).append("\n"); 
		query.append("    M.RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("    M.CRE_OFC_CD," ).append("\n"); 
		query.append("    M.BKG_CGO_TP_CD," ).append("\n"); 
		query.append("    M.TRSP_SO_STS_CD," ).append("\n"); 
		query.append("    M.TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("    M.EQ_NO," ).append("\n"); 
		query.append("    M.EQ_TPSZ_CD," ).append("\n"); 
		query.append("    M.CGO_TP_CD," ).append("\n"); 
		query.append("    M.CRE_DT," ).append("\n"); 
		query.append("    M.CRE_DT_HMS," ).append("\n"); 
		query.append("    M.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("    M.FM_NOD_CD," ).append("\n"); 
		query.append("    M.FM_NOD_YARD," ).append("\n"); 
		query.append("    M.TO_NOD_CD," ).append("\n"); 
		query.append("    M.TO_NOD_YARD," ).append("\n"); 
		query.append("    M.VNDR_ABBR_NM," ).append("\n"); 
		query.append("    M.BL_NO," ).append("\n"); 
		query.append("    M.BKG_NO," ).append("\n"); 
		query.append("    M.BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("    M.BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("    M.BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("    M.BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("    M.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("    M.BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("    M.BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("    M.WAYBILL_NO," ).append("\n"); 
		query.append("    M.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("    M.MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("    SUBSTR(M.BKG_SPE, 0, LENGTH(M.BKG_SPE)-1) AS BKG_SPE," ).append("\n"); 
		query.append("    M.SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("    M.MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("    M.CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("    M.CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("    M.PROV_VNDR_SEQ," ).append("\n"); 
		query.append("    M.CXL_RQST_DT," ).append("\n"); 
		query.append("    M.CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("    M.CXL_RQST_RSN," ).append("\n"); 
		query.append("    M.CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("    M.CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("    M.CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("    M.INTER_RMK," ).append("\n"); 
		query.append("    M.SPCL_INSTR_RMK," ).append("\n"); 
		query.append("    M.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("    TO_CHAR(M.CCREDT, 'YYYYMMDDHH24MISS') AS CCREDT," ).append("\n"); 
		query.append("    M.BIL_ISS_KNT," ).append("\n"); 
		query.append("    CASE WHEN LENGTH(S.EDI_RCV_VNDR_ABBR_NM) > 0 OR LENGTH(T.EDI_RCV_VNDR_ABBR_NM) > 0 THEN 'Y' " ).append("\n"); 
		query.append("         ELSE '' " ).append("\n"); 
		query.append("    END AS MTC_EDI_IND_CD," ).append("\n"); 
		query.append("    M.SLAN_CD," ).append("\n"); 
		query.append("    M.TRUNKVVD," ).append("\n"); 
		query.append("    M.CNTR_WGT," ).append("\n"); 
		query.append("    M.IBD_NO," ).append("\n"); 
		query.append("    M.SHPR_CUST_NM," ).append("\n"); 
		query.append("    M.CNEE_CUST_NM," ).append("\n"); 
		query.append("    M.EDI_USR_ID," ).append("\n"); 
		query.append("    M.TRSP_FRST_FLG," ).append("\n"); 
		query.append("    M.CMDT_NAME," ).append("\n"); 
		query.append("    M.REF_NO," ).append("\n"); 
		query.append("    M.AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("    M.AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("    M.BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("    M.IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("    M.TRSP_BND_CD," ).append("\n"); 
		query.append("    M.POLDEL_CD," ).append("\n"); 
		query.append("    M.POLDEL_YARD," ).append("\n"); 
		query.append("    M.ROUT_PLN_CD," ).append("\n"); 
		query.append("    M.INTER_FM_NOD_CD," ).append("\n"); 
		query.append("    M.INTER_FM_NOD_YARD," ).append("\n"); 
		query.append("    M.STATUS_NM," ).append("\n"); 
		query.append("    M.VGM_WGT," ).append("\n"); 
		query.append("    M.VGM_WGT_UT_CD" ).append("\n"); 
		query.append("FROM " ).append("\n"); 
		query.append("    (" ).append("\n"); 
		query.append("        SELECT " ).append("\n"); 
		query.append("            X.LASTCHK," ).append("\n"); 
		query.append("            X.INV_NO," ).append("\n"); 
		query.append("            X.CXL_RQST_FLG," ).append("\n"); 
		query.append("            X.COP_NO," ).append("\n"); 
		query.append("            X.COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("            X.SUB_RAIL_SEQ," ).append("\n"); 
		query.append("            X.VNDR_SEQ," ).append("\n"); 
		query.append("            X.BIL_ISS_KNT," ).append("\n"); 
		query.append("            X.TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("            X.TRSP_SO_SEQ," ).append("\n"); 
		query.append("            X.REPO_PLN_ID," ).append("\n"); 
		query.append("            X.PLN_YRWK," ).append("\n"); 
		query.append("            X.REF_ID," ).append("\n"); 
		query.append("            X.REF_SEQ," ).append("\n"); 
		query.append("            X.RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("            X.CRE_OFC_CD," ).append("\n"); 
		query.append("            X.BKG_CGO_TP_CD," ).append("\n"); 
		query.append("            X.TRSP_SO_STS_CD," ).append("\n"); 
		query.append("            X.TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("            X.EQ_NO," ).append("\n"); 
		query.append("            X.EQ_TPSZ_CD," ).append("\n"); 
		query.append("            X.CGO_TP_CD," ).append("\n"); 
		query.append("            X.CRE_DT," ).append("\n"); 
		query.append("            X.CRE_DT_HMS," ).append("\n"); 
		query.append("            X.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("            X.FM_NOD_CD," ).append("\n"); 
		query.append("            X.FM_NOD_YARD," ).append("\n"); 
		query.append("            X.TO_NOD_CD," ).append("\n"); 
		query.append("            X.TO_NOD_YARD," ).append("\n"); 
		query.append("            X.VNDR_ABBR_NM," ).append("\n"); 
		query.append("            X.BL_NO," ).append("\n"); 
		query.append("            X.BKG_NO," ).append("\n"); 
		query.append("            X.BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("            X.BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("            CASE WHEN X.BIL_EDI_RSNT_DT = '20000101' THEN ''" ).append("\n"); 
		query.append("                 ELSE X.BIL_EDI_RSNT_DT" ).append("\n"); 
		query.append("            END BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("            CASE WHEN X.BIL_EDI_RSNT_DT = '20000101' THEN ''" ).append("\n"); 
		query.append("                 ELSE X.BIL_EDI_RSNT_DT_HMS" ).append("\n"); 
		query.append("            END BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("            X.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("            X.BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("            X.BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("            X.WAYBILL_NO," ).append("\n"); 
		query.append("            X.MTC_EDI_IND_CD," ).append("\n"); 
		query.append("            X.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("            X.MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("            X.MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("            X.CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("            X.CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("            X.PROV_VNDR_SEQ," ).append("\n"); 
		query.append("            X.CXL_RQST_DT," ).append("\n"); 
		query.append("            X.CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("            X.CXL_RQST_RSN," ).append("\n"); 
		query.append("            X.CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("            X.CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("            X.CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("            X.INTER_RMK," ).append("\n"); 
		query.append("            X.SPCL_INSTR_RMK," ).append("\n"); 
		query.append("            X.SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("            X.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("            X.CCREDT," ).append("\n"); 
		query.append("            X.SLAN_CD," ).append("\n"); 
		query.append("            X.TRUNKVVD," ).append("\n"); 
		query.append("            X.CNTR_WGT," ).append("\n"); 
		query.append("            X.IBD_NO," ).append("\n"); 
		query.append("            X.SHPR_CUST_NM," ).append("\n"); 
		query.append("            X.CNEE_CUST_NM," ).append("\n"); 
		query.append("            X.EDI_USR_ID," ).append("\n"); 
		query.append("            X.TRSP_FRST_FLG," ).append("\n"); 
		query.append("            X.WO_RJCT_RSN," ).append("\n"); 
		query.append("            X.REF_NO," ).append("\n"); 
		query.append("            X.BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("            X.IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("            X.POL_NOD_CD," ).append("\n"); 
		query.append("            X.POD_NOD_CD," ).append("\n"); 
		query.append("            X.TRSP_BND_CD," ).append("\n"); 
		query.append("            X.AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("            X.AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("            X.POLDEL_CD," ).append("\n"); 
		query.append("            X.POLDEL_YARD," ).append("\n"); 
		query.append("            X.ROUT_PLN_CD," ).append("\n"); 
		query.append("            X.INTER_FM_NOD_CD," ).append("\n"); 
		query.append("            X.INTER_FM_NOD_YARD" ).append("\n"); 
		query.append("            ,(" ).append("\n"); 
		query.append("                SELECT" ).append("\n"); 
		query.append("                    REPLACE(MDM_CO.CMDT_NM, CHR(13)||CHR(10), ' ') AS CMDT_NAME" ).append("\n"); 
		query.append("                FROM" ).append("\n"); 
		query.append("                    MDM_COMMODITY MDM_CO," ).append("\n"); 
		query.append("                    BKG_BOOKING B" ).append("\n"); 
		query.append("                WHERE X.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                AND   B.CMDT_CD = MDM_CO.CMDT_CD" ).append("\n"); 
		query.append("            ) CMDT_NAME" ).append("\n"); 
		query.append("            ,(" ).append("\n"); 
		query.append("                SELECT" ).append("\n"); 
		query.append("                    DECODE( BK.DCGO_FLG , 'Y', 'DG /') || " ).append("\n"); 
		query.append("                    DECODE( BK.RC_FLG , 'Y', 'RF /') || " ).append("\n"); 
		query.append("                    DECODE( BK.AWK_CGO_FLG , 'Y', 'AK /') || " ).append("\n"); 
		query.append("                    DECODE( BK.BB_CGO_FLG , 'Y', 'BB /') || " ).append("\n"); 
		query.append("                    DECODE( BK.SPCL_HIDE_FLG , 'Y', 'HD /') || " ).append("\n"); 
		query.append("                    DECODE( BK.FD_GRD_FLG , 'Y', 'FG /') || " ).append("\n"); 
		query.append("                    DECODE( BK.RAIL_BLK_CD, '', '', 'RB /') AS BKG_SPE" ).append("\n"); 
		query.append("                FROM" ).append("\n"); 
		query.append("                    BKG_BOOKING BK" ).append("\n"); 
		query.append("                WHERE X.BKG_NO = BK.BKG_NO" ).append("\n"); 
		query.append("            ) BKG_SPE," ).append("\n"); 
		query.append("            X.STATUS_NM," ).append("\n"); 
		query.append("            X.VGM_WGT," ).append("\n"); 
		query.append("            X.VGM_WGT_UT_CD" ).append("\n"); 
		query.append("        FROM    " ).append("\n"); 
		query.append("            (" ).append("\n"); 
		query.append("                SELECT /*+ ORDERED USE_NL(A, B, C, CR, CFM, AGMT, BC, D) INDEX(A XAK17TRS_TRSP_RAIL_BIL_ORD) */" ).append("\n"); 
		query.append("                    DECODE(C.BIL_ISS_KNT, A.BIL_ISS_KNT, 'Y', NULL , 'Y' ) AS LASTCHK," ).append("\n"); 
		query.append("                    MAX(B.INV_NO) AS INV_NO," ).append("\n"); 
		query.append("                    A.CXL_RQST_FLG AS CXL_RQST_FLG," ).append("\n"); 
		query.append("                    A.COP_NO AS COP_NO," ).append("\n"); 
		query.append("                    A.COST_ACT_GRP_SEQ AS COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("                    MIN(B.SUB_RAIL_SEQ) AS SUB_RAIL_SEQ," ).append("\n"); 
		query.append("                    MAX(DECODE(B.SUB_RAIL_SEQ, 1, B.VNDR_SEQ)) AS VNDR_SEQ," ).append("\n"); 
		query.append("                    C.BIL_ISS_KNT AS BIL_ISS_KNT," ).append("\n"); 
		query.append("                    A.TRSP_SO_OFC_CTY_CD AS TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("                    A.TRSP_SO_SEQ AS TRSP_SO_SEQ," ).append("\n"); 
		query.append("                    A.REPO_PLN_ID AS REPO_PLN_ID," ).append("\n"); 
		query.append("                    A.PLN_YRWK AS PLN_YRWK," ).append("\n"); 
		query.append("                    A.REF_ID AS REF_ID," ).append("\n"); 
		query.append("                    A.REF_SEQ AS REF_SEQ," ).append("\n"); 
		query.append("                    A.RAIL_CMB_THRU_TP_CD AS RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("                    A.CRE_OFC_CD AS CRE_OFC_CD," ).append("\n"); 
		query.append("                    MAX(A.BKG_CGO_TP_CD) AS BKG_CGO_TP_CD," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_SO_STS_CD , 'C', 'S/O Created' , 'R', 'S/O Corrected' , 'I', 'EDI Sent' , '') ) AS TRSP_SO_STS_CD," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_RAIL_BIL_TP_CD , 'W', 'WRS' , 'ALPS') ) AS TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("                    MAX(A.EQ_NO) AS EQ_NO," ).append("\n"); 
		query.append("                    MAX(A.EQ_TPSZ_CD) AS EQ_TPSZ_CD," ).append("\n"); 
		query.append("                    MAX(A.CGO_TP_CD) AS CGO_TP_CD," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'YYYYMMDD')) AS CRE_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'HH24MISS')) AS CRE_DT_HMS," ).append("\n"); 
		query.append("                    C.BIL_ISS_STS_CD AS BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 1, 5)) AS FM_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 6)) AS FM_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 1, 5)) AS TO_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 6)) AS TO_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(DECODE(B.SUB_RAIL_SEQ, 1, D.VNDR_ABBR_NM)) AS VNDR_ABBR_NM," ).append("\n"); 
		query.append("                    MAX(A.BL_NO) AS BL_NO," ).append("\n"); 
		query.append("                    DECODE(A.BIL_ISS_STS_CD , 'I', C.BKG_NO , A.BKG_NO) AS BKG_NO," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_SNT_DT, 'YYYYMMDD') AS BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_SNT_DT, 'HH24MISS') AS BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                          ) , 'YYYYMMDD'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                          ) , 'HH24MISS'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("                    C.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'YYYYMMDD') AS BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'HH24MISS') AS BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    '' AS WAYBILL_NO," ).append("\n"); 
		query.append("                    C.MTC_EDI_IND_CD," ).append("\n"); 
		query.append("                    C.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("                    TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'YYYYMMDD') AS MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'HH24MISS') AS MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'YYYYMMDD')) AS CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'HH24MISS')) AS CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(A.PROV_VNDR_SEQ) AS PROV_VNDR_SEQ," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'YYYYMMDD')) AS CXL_RQST_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'HH24MISS')) AS CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_RSN) AS CXL_RQST_RSN," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'YYYYMMDD')) AS CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'HH24MISS')) AS CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_RJCT_RSN) AS CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("                    NVL(C.INTER_RMK, A.INTER_RMK) AS INTER_RMK," ).append("\n"); 
		query.append("                    C.SPCL_INSTR_RMK," ).append("\n"); 
		query.append("                    MAX(A.SPCL_CGO_CNTR_TP_CD) AS SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("                    C.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("                    C.LOCL_CRE_DT AS CCREDT," ).append("\n"); 
		query.append("                    MAX(A.SLAN_CD) AS SLAN_CD," ).append("\n"); 
		query.append("                    MAX((A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD)) AS TRUNKVVD," ).append("\n"); 
		query.append("                    MAX(A.CNTR_WGT) AS CNTR_WGT," ).append("\n"); 
		query.append("                    MAX(A.IBD_NO) AS IBD_NO," ).append("\n"); 
		query.append("                    MAX(A.SHPR_CUST_NM) AS SHPR_CUST_NM," ).append("\n"); 
		query.append("                    MAX(A.CNEE_CUST_NM) AS CNEE_CUST_NM," ).append("\n"); 
		query.append("                    DECODE(A.TRSP_RAIL_BIL_TP_CD, 'W', A.PROV_USR_ID, C.CRE_USR_ID) AS EDI_USR_ID," ).append("\n"); 
		query.append("                    MAX(A.TRSP_FRST_FLG) AS TRSP_FRST_FLG," ).append("\n"); 
		query.append("                    C.WO_RJCT_RSN," ).append("\n"); 
		query.append("                    MAX(DECODE(B.SUB_RAIL_SEQ, 1, AGMT.AGMT_REF_NO) || DECODE(B.TO_NOD_CD, NULL, '' , A.TO_NOD_CD, '', ' / ') ) || " ).append("\n"); 
		query.append("                    MAX( DECODE(B.SUB_RAIL_SEQ, 2 , AGMT.AGMT_REF_NO) || DECODE(B.TO_NOD_CD, NULL, '' , A.TO_NOD_CD, '', ' / ') ) || " ).append("\n"); 
		query.append("                    MAX( DECODE(B.SUB_RAIL_SEQ, 3 , AGMT.AGMT_REF_NO)) AS REF_NO," ).append("\n"); 
		query.append("                    MAX(DECODE(A.CGO_TP_CD, 'M', NULL, DECODE(BC.CNTR_NO, NULL , 'N', 'Y'))) AS BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("                    MAX(A.IBD_CSTMS_CLR_LOC_CD) AS IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("                    MAX(A.POL_NOD_CD) AS POL_NOD_CD," ).append("\n"); 
		query.append("                    MAX(A.POD_NOD_CD) AS POD_NOD_CD," ).append("\n"); 
		query.append("                    MAX(A.TRSP_BND_CD) AS TRSP_BND_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_CD AS AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_NO AS AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                    SUBSTR(DECODE(MAX(A.TRSP_BND_CD), 'I', MAX(A.DEL_NOD_CD), 'O', NVL(MAX(A.POL_NOD_CD), MAX(A.POL_CD)) , '') , 1, 5) AS POLDEL_CD," ).append("\n"); 
		query.append("                    SUBSTR(DECODE(MAX(A.TRSP_BND_CD), 'I', MAX(A.DEL_NOD_CD), 'O', NVL(MAX(A.POL_NOD_CD), MAX(A.POL_CD)) , '') , 6) AS POLDEL_YARD," ).append("\n"); 
		query.append("                    MAX(A.ROUT_PLN_CD) AS ROUT_PLN_CD," ).append("\n"); 
		query.append("                    (SELECT SUBSTR(VNDR.FM_NOD_CD,1,5) FROM TRS_TRSP_RAIL_BIL_VNDR_SET VNDR WHERE VNDR.TRSP_SO_OFC_CTY_CD = A.TRSP_SO_OFC_CTY_CD AND VNDR.TRSP_SO_SEQ = A.TRSP_SO_SEQ AND VNDR.SUB_RAIL_SEQ = 2) AS INTER_FM_NOD_CD," ).append("\n"); 
		query.append("                    (SELECT SUBSTR(VNDR.FM_NOD_CD,6) FROM TRS_TRSP_RAIL_BIL_VNDR_SET VNDR WHERE VNDR.TRSP_SO_OFC_CTY_CD = A.TRSP_SO_OFC_CTY_CD AND VNDR.TRSP_SO_SEQ = A.TRSP_SO_SEQ AND VNDR.SUB_RAIL_SEQ = 2) AS INTER_FM_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(CASE WHEN A.CXL_RQST_FLG = 'N' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'Y' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested Rejected'" ).append("\n"); 
		query.append("                             WHEN A.CXL_RQST_FLG = 'Y' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'N' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'E' THEN 'EDI Error'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'V' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' AND C.BIL_ISS_STS_CD = 'X' THEN 'Rail Billing Cancelled'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Rail Billed'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'C' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'R' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                    END) STATUS_NM," ).append("\n"); 
		query.append("                    MAX(BC.VGM_WGT) VGM_WGT," ).append("\n"); 
		query.append("                    MAX(BC.VGM_WGT_UT_CD) VGM_WGT_UT_CD" ).append("\n"); 
		query.append("                FROM " ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_ORD A," ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_VNDR_SET B," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD C," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD_RSND CR," ).append("\n"); 
		query.append("                    TRS_TRSP_CFM_MSG_HIS CFM," ).append("\n"); 
		query.append("                    TRS_AGMT_HDR AGMT," ).append("\n"); 
		query.append("                    BKG_CONTAINER BC," ).append("\n"); 
		query.append("                    MDM_VENDOR D" ).append("\n"); 
		query.append("                WHERE A.TRSP_SO_OFC_CTY_CD = B.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = B.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = C.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = C.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CR.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CR.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CFM.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CFM.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   B.TRSP_AGMT_OFC_CTY_CD = AGMT.TRSP_AGMT_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   B.TRSP_AGMT_SEQ = AGMT.TRSP_AGMT_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.BKG_NO = BC.BKG_NO (+)" ).append("\n"); 
		query.append("                AND   A.EQ_NO = BC.CNTR_NO (+)" ).append("\n"); 
		query.append("                AND   B.VNDR_SEQ = D.VNDR_SEQ" ).append("\n"); 
		query.append("                AND   A.RAIL_CMB_THRU_TP_CD IN ('C1T', 'C2T'," ).append("\n"); 
		query.append("                                                'C3T', 'C2R'," ).append("\n"); 
		query.append("                                                'C3R', 'C2C', 'C3S')" ).append("\n"); 
		query.append("                AND   A.DELT_FLG = 'N'" ).append("\n"); 
		query.append("                AND   NVL(A.SPND_FLG, 'N') = 'N'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if($vvd.size() > 0)" ).append("\n"); 
		query.append("    AND ((A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append("    #foreach($key IN ${vvd})" ).append("\n"); 
		query.append("        #if($velocityCount == 1)                        " ).append("\n"); 
		query.append("            ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("        #else" ).append("\n"); 
		query.append("            , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("    )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if($bl.size() > 0)" ).append("\n"); 
		query.append("    AND (A.BL_NO IN ( " ).append("\n"); 
		query.append("                        #foreach($key IN ${bl})" ).append("\n"); 
		query.append("                            #if($velocityCount == 1)" ).append("\n"); 
		query.append("                                '$key'" ).append("\n"); 
		query.append("                            #else" ).append("\n"); 
		query.append("                                ,'$key'" ).append("\n"); 
		query.append("                            #end" ).append("\n"); 
		query.append("                        #end" ).append("\n"); 
		query.append("                    )" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if($cntr.size() > 0)" ).append("\n"); 
		query.append("    AND A.EQ_NO IN (" ).append("\n"); 
		query.append("                        #foreach($key IN ${cntr})" ).append("\n"); 
		query.append("                            #if($velocityCount == 1)" ).append("\n"); 
		query.append("                                '$key'" ).append("\n"); 
		query.append("                            #else" ).append("\n"); 
		query.append("                                ,'$key'" ).append("\n"); 
		query.append("                            #end" ).append("\n"); 
		query.append("                        #end" ).append("\n"); 
		query.append("                    )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${frmDate} != '' && ${toDate} != '')" ).append("\n"); 
		query.append("    #if(${radDate} == 'DS')" ).append("\n"); 
		query.append("        AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("    #elseif(${radDate} == 'DB')" ).append("\n"); 
		query.append("        AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD')-21 AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("        AND C.BIL_EDI_SNT_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("    #elseif(${radDate} == 'DC')" ).append("\n"); 
		query.append("        AND A.CXL_RQST_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${frmNode} != '')" ).append("\n"); 
		query.append("    AND A.FM_NOD_CD LIKE @[frmNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${toNode} != '')" ).append("\n"); 
		query.append("    AND A.TO_NOD_CD LIKE @[toNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${radVendor} == 'V2' && ${svcProvid} != '')" ).append("\n"); 
		query.append("    AND A.PROV_VNDR_SEQ = @[sSvcProvid]" ).append("\n"); 
		query.append("#elseif(${radVendor} == 'V1' && ${railRoad} != 'ALL')" ).append("\n"); 
		query.append("    AND B.VNDR_SEQ = @[railRoad]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${status} != 'ALL')" ).append("\n"); 
		query.append("    AND A.TRSP_SO_STS_CD = @[status]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${edKind} != 'ALL')" ).append("\n"); 
		query.append("    AND C.BIL_ISS_STS_CD = @[edKind]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fuEmpy} != 'ALL')" ).append("\n"); 
		query.append("    AND A.CGO_TP_CD = @[fuEmpy]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${bound} != 'ALL')" ).append("\n"); 
		query.append("    AND A.TRSP_BND_CD = @[bound]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${through} != 'ALL')" ).append("\n"); 
		query.append("    #if(${through} == 'E')" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD <> 'W'" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD = 'W'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${bkgAtch} != 'ALL')" ).append("\n"); 
		query.append("    #if(${bkgAtch} == 'N')" ).append("\n"); 
		query.append("        AND BC.CNTR_NO IS NULL" ).append("\n"); 
		query.append("        AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append("    #elseif(${bkgAtch} == 'Y')" ).append("\n"); 
		query.append("        AND BC.CNTR_NO IS NOT NULL" ).append("\n"); 
		query.append("        AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                GROUP BY" ).append("\n"); 
		query.append("                    DECODE(C.BIL_ISS_KNT , A.BIL_ISS_KNT, 'Y' , NULL , 'Y' )," ).append("\n"); 
		query.append("                    A.CXL_RQST_FLG," ).append("\n"); 
		query.append("                    A.COP_NO," ).append("\n"); 
		query.append("                    A.COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("                    C.BIL_ISS_KNT," ).append("\n"); 
		query.append("                    A.TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("                    A.TRSP_SO_SEQ," ).append("\n"); 
		query.append("                    A.REPO_PLN_ID," ).append("\n"); 
		query.append("                    A.PLN_YRWK," ).append("\n"); 
		query.append("                    A.REF_ID," ).append("\n"); 
		query.append("                    A.REF_SEQ," ).append("\n"); 
		query.append("                    A.RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("                    A.CRE_OFC_CD," ).append("\n"); 
		query.append("                    A.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    C.BKG_NO," ).append("\n"); 
		query.append("                    A.BKG_NO," ).append("\n"); 
		query.append("                    C.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    C.BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("                    C.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("                    C.BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    C.MTC_EDI_IND_CD," ).append("\n"); 
		query.append("                    C.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("                    C.MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    NVL( C.INTER_RMK, A.INTER_RMK)," ).append("\n"); 
		query.append("                    C.SPCL_INSTR_RMK," ).append("\n"); 
		query.append("                    C.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("                    C.LOCL_CRE_DT," ).append("\n"); 
		query.append("                    DECODE(A.TRSP_RAIL_BIL_TP_CD, 'W', A.PROV_USR_ID, C.CRE_USR_ID)," ).append("\n"); 
		query.append("                    C.WO_RJCT_RSN," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_NO" ).append("\n"); 
		query.append("            ) X" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT" ).append("\n"); 
		query.append("            X.LASTCHK," ).append("\n"); 
		query.append("            X.INV_NO," ).append("\n"); 
		query.append("            X.CXL_RQST_FLG," ).append("\n"); 
		query.append("            X.COP_NO," ).append("\n"); 
		query.append("            X.COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("            X.SUB_RAIL_SEQ," ).append("\n"); 
		query.append("            X.VNDR_SEQ," ).append("\n"); 
		query.append("            X.BIL_ISS_KNT," ).append("\n"); 
		query.append("            X.TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("            X.TRSP_SO_SEQ," ).append("\n"); 
		query.append("            X.REPO_PLN_ID," ).append("\n"); 
		query.append("            X.PLN_YRWK," ).append("\n"); 
		query.append("            X.REF_ID," ).append("\n"); 
		query.append("            X.REF_SEQ," ).append("\n"); 
		query.append("            X.RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("            X.CRE_OFC_CD," ).append("\n"); 
		query.append("            X.BKG_CGO_TP_CD," ).append("\n"); 
		query.append("            X.TRSP_SO_STS_CD," ).append("\n"); 
		query.append("            X.TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("            X.EQ_NO," ).append("\n"); 
		query.append("            X.EQ_TPSZ_CD," ).append("\n"); 
		query.append("            X.CGO_TP_CD," ).append("\n"); 
		query.append("            X.CRE_DT," ).append("\n"); 
		query.append("            X.CRE_DT_HMS," ).append("\n"); 
		query.append("            X.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("            X.FM_NOD_CD," ).append("\n"); 
		query.append("            X.FM_NOD_YARD," ).append("\n"); 
		query.append("            X.TO_NOD_CD," ).append("\n"); 
		query.append("            X.TO_NOD_YARD," ).append("\n"); 
		query.append("            X.VNDR_ABBR_NM," ).append("\n"); 
		query.append("            X.BL_NO," ).append("\n"); 
		query.append("            X.BKG_NO," ).append("\n"); 
		query.append("            X.BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("            X.BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("            CASE WHEN X.BIL_EDI_RSNT_DT = '20000101' THEN ''" ).append("\n"); 
		query.append("                 ELSE X.BIL_EDI_RSNT_DT" ).append("\n"); 
		query.append("            END BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("            CASE WHEN X.BIL_EDI_RSNT_DT = '20000101' THEN ''" ).append("\n"); 
		query.append("                 ELSE X.BIL_EDI_RSNT_DT_HMS" ).append("\n"); 
		query.append("            END BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("            X.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("            X.BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("            X.BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("            X.WAYBILL_NO," ).append("\n"); 
		query.append("            X.MTC_EDI_IND_CD," ).append("\n"); 
		query.append("            X.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("            X.MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("            X.MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("            X.CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("            X.CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("            X.PROV_VNDR_SEQ," ).append("\n"); 
		query.append("            X.CXL_RQST_DT," ).append("\n"); 
		query.append("            X.CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("            X.CXL_RQST_RSN," ).append("\n"); 
		query.append("            X.CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("            X.CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("            X.CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("            X.INTER_RMK," ).append("\n"); 
		query.append("            X.SPCL_INSTR_RMK," ).append("\n"); 
		query.append("            X.SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("            X.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("            X.CCREDT," ).append("\n"); 
		query.append("            X.SLAN_CD," ).append("\n"); 
		query.append("            X.TRUNKVVD," ).append("\n"); 
		query.append("            X.CNTR_WGT," ).append("\n"); 
		query.append("            X.IBD_NO," ).append("\n"); 
		query.append("            X.SHPR_CUST_NM," ).append("\n"); 
		query.append("            X.CNEE_CUST_NM," ).append("\n"); 
		query.append("            X.EDI_USR_ID," ).append("\n"); 
		query.append("            X.TRSP_FRST_FLG," ).append("\n"); 
		query.append("            X.WO_RJCT_RSN," ).append("\n"); 
		query.append("            X.BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("            X.IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("            X.POL_NOD_CD," ).append("\n"); 
		query.append("            X.POD_NOD_CD," ).append("\n"); 
		query.append("            X.TRSP_BND_CD," ).append("\n"); 
		query.append("            X.AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("            X.AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("            X.POLDEL_CD," ).append("\n"); 
		query.append("            X.POLDEL_YARD," ).append("\n"); 
		query.append("            X.ROUT_PLN_CD," ).append("\n"); 
		query.append("            X.INTER_FM_NOD_CD," ).append("\n"); 
		query.append("            X.INTER_FM_NOD_YARD" ).append("\n"); 
		query.append("            ,(" ).append("\n"); 
		query.append("                SELECT" ).append("\n"); 
		query.append("                    REPLACE(MDM_CO.CMDT_NM, CHR(13)||CHR(10), ' ') AS CMDT_NAME" ).append("\n"); 
		query.append("                FROM" ).append("\n"); 
		query.append("                    MDM_COMMODITY MDM_CO," ).append("\n"); 
		query.append("                    BKG_BOOKING B" ).append("\n"); 
		query.append("                WHERE X.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                AND   B.CMDT_CD = MDM_CO.CMDT_CD" ).append("\n"); 
		query.append("            ) CMDT_NAME" ).append("\n"); 
		query.append("            ,(" ).append("\n"); 
		query.append("                SELECT" ).append("\n"); 
		query.append("                    AGMT.AGMT_REF_NO AS REF_NO" ).append("\n"); 
		query.append("                FROM" ).append("\n"); 
		query.append("                    TRS_AGMT_HDR AGMT" ).append("\n"); 
		query.append("                WHERE X.TRSP_AGMT_OFC_CTY_CD = AGMT.TRSP_AGMT_OFC_CTY_CD" ).append("\n"); 
		query.append("                AND   X.TRSP_AGMT_SEQ = AGMT.TRSP_AGMT_SEQ" ).append("\n"); 
		query.append("            ) REF_NO" ).append("\n"); 
		query.append("            ,(" ).append("\n"); 
		query.append("                SELECT" ).append("\n"); 
		query.append("                    DECODE( BK.DCGO_FLG , 'Y', 'DG /') || " ).append("\n"); 
		query.append("                    DECODE( BK.RC_FLG , 'Y', 'RF /') || " ).append("\n"); 
		query.append("                    DECODE( BK.AWK_CGO_FLG , 'Y', 'AK /') || " ).append("\n"); 
		query.append("                    DECODE( BK.BB_CGO_FLG , 'Y', 'BB /') || " ).append("\n"); 
		query.append("                    DECODE( BK.SPCL_HIDE_FLG , 'Y', 'HD /') || " ).append("\n"); 
		query.append("                    DECODE( BK.FD_GRD_FLG , 'Y', 'FG /') || " ).append("\n"); 
		query.append("                    DECODE( BK.RAIL_BLK_CD, '', '', 'RB /') AS BKG_SPE" ).append("\n"); 
		query.append("                FROM" ).append("\n"); 
		query.append("                    BKG_BOOKING BK" ).append("\n"); 
		query.append("                WHERE X.BKG_NO = BK.BKG_NO" ).append("\n"); 
		query.append("            ) BKG_SPE," ).append("\n"); 
		query.append("            X.STATUS_NM," ).append("\n"); 
		query.append("            X.VGM_WGT," ).append("\n"); 
		query.append("            X.VGM_WGT_UT_CD" ).append("\n"); 
		query.append("        FROM" ).append("\n"); 
		query.append("            (" ).append("\n"); 
		query.append("                SELECT /*+ ORDERED USE_NL(A, B, C, CR, CFM, BC, D) INDEX(A XAK17TRS_TRSP_RAIL_BIL_ORD) */" ).append("\n"); 
		query.append("                    MAX(DECODE(C.BIL_ISS_KNT, A.BIL_ISS_KNT, 'Y', A.BIL_ISS_KNT-1, 'Y', DECODE(SUBSTR(A.RAIL_CMB_THRU_TP_CD, 2, 1), '3', A.BIL_ISS_KNT-2 ), 'Y', NULL, 'Y')) AS LASTCHK," ).append("\n"); 
		query.append("                    MAX(B.INV_NO) AS INV_NO," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_FLG) AS CXL_RQST_FLG," ).append("\n"); 
		query.append("                    MAX(A.COP_NO) AS COP_NO," ).append("\n"); 
		query.append("                    MAX(A.COST_ACT_GRP_SEQ) AS COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("                    B.SUB_RAIL_SEQ," ).append("\n"); 
		query.append("                    MAX(B.VNDR_SEQ) AS VNDR_SEQ," ).append("\n"); 
		query.append("                    C.BIL_ISS_KNT AS BIL_ISS_KNT," ).append("\n"); 
		query.append("                    A.TRSP_SO_OFC_CTY_CD AS TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("                    A.TRSP_SO_SEQ AS TRSP_SO_SEQ," ).append("\n"); 
		query.append("                    MAX(A.REPO_PLN_ID) AS REPO_PLN_ID," ).append("\n"); 
		query.append("                    MAX(A.PLN_YRWK) AS PLN_YRWK," ).append("\n"); 
		query.append("                    MAX(A.REF_ID) AS REF_ID," ).append("\n"); 
		query.append("                    MAX(A.REF_SEQ) AS REF_SEQ," ).append("\n"); 
		query.append("                    MAX(A.RAIL_CMB_THRU_TP_CD) AS RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("                    MAX(A.CRE_OFC_CD) AS CRE_OFC_CD," ).append("\n"); 
		query.append("                    MAX(A.BKG_CGO_TP_CD) AS BKG_CGO_TP_CD," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_SO_STS_CD, 'C', 'S/O Created', 'R', 'S/O Corrected', 'I', 'EDI Sent', '')) AS TRSP_SO_STS_CD," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_RAIL_BIL_TP_CD, 'W', 'WRS', 'ALPS')) AS TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("                    MAX(A.EQ_NO) AS EQ_NO," ).append("\n"); 
		query.append("                    MAX(A.EQ_TPSZ_CD) AS EQ_TPSZ_CD," ).append("\n"); 
		query.append("                    MAX(A.CGO_TP_CD) AS CGO_TP_CD," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'YYYYMMDD')) AS CRE_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'HH24MISS')) AS CRE_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.BIL_ISS_STS_CD) AS BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 1, 5)) AS FM_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 6)) AS FM_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 1, 5)) AS TO_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 6)) AS TO_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(D.VNDR_ABBR_NM) AS VNDR_ABBR_NM," ).append("\n"); 
		query.append("                    MAX(A.BL_NO) AS BL_NO," ).append("\n"); 
		query.append("                    MAX(DECODE(A.BIL_ISS_STS_CD, 'I', C.BKG_NO, A.BKG_NO)) AS BKG_NO," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_SNT_DT, 'YYYYMMDD')) AS BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_SNT_DT, 'HH24MISS')) AS BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                          ) , 'YYYYMMDD'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                          ) , 'HH24MISS'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.BIL_EDI_RCV_RSLT_CD) AS BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'YYYYMMDD')) AS BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'HH24MISS')) AS BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    '' AS WAYBILL_NO," ).append("\n"); 
		query.append("                    MAX(C.MTC_EDI_IND_CD) AS MTC_EDI_IND_CD," ).append("\n"); 
		query.append("                    MAX(C.MTC_EDI_RCV_RSLT_FLG) AS MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'YYYYMMDD')) AS MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'HH24MISS')) AS MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'YYYYMMDD')) AS CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'HH24MISS')) AS CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(A.PROV_VNDR_SEQ) AS PROV_VNDR_SEQ," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'YYYYMMDD')) AS CXL_RQST_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'HH24MISS')) AS CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_RSN) AS CXL_RQST_RSN," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'YYYYMMDD')) AS CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'HH24MISS')) AS CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_RJCT_RSN) AS CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("                    MAX(NVL(C.INTER_RMK, A.INTER_RMK)) AS INTER_RMK," ).append("\n"); 
		query.append("                    MAX(C.SPCL_INSTR_RMK) AS SPCL_INSTR_RMK," ).append("\n"); 
		query.append("                    MAX(A.SPCL_CGO_CNTR_TP_CD) AS SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("                    MAX(C.RAIL_ORD_RJCT_FLG) AS RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("                    MAX(C.LOCL_CRE_DT) AS CCREDT," ).append("\n"); 
		query.append("                    MAX(A.SLAN_CD) AS SLAN_CD," ).append("\n"); 
		query.append("                    MAX(A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD) AS TRUNKVVD," ).append("\n"); 
		query.append("                    MAX(A.CNTR_WGT) AS CNTR_WGT," ).append("\n"); 
		query.append("                    MAX(A.IBD_NO) AS IBD_NO," ).append("\n"); 
		query.append("                    MAX(A.SHPR_CUST_NM) AS SHPR_CUST_NM," ).append("\n"); 
		query.append("                    MAX(A.CNEE_CUST_NM) AS CNEE_CUST_NM," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_RAIL_BIL_TP_CD, 'W', A.PROV_USR_ID, C.CRE_USR_ID)) AS EDI_USR_ID," ).append("\n"); 
		query.append("                    MAX(A.TRSP_FRST_FLG) AS TRSP_FRST_FLG," ).append("\n"); 
		query.append("                    MAX(C.WO_RJCT_RSN) AS WO_RJCT_RSN," ).append("\n"); 
		query.append("                    MAX(DECODE(A.CGO_TP_CD, 'M', NULL, DECODE(BC.CNTR_NO, NULL, 'N', 'Y'))) AS BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("                    MAX(A.IBD_CSTMS_CLR_LOC_CD) AS IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("                    MAX(A.POL_NOD_CD) AS POL_NOD_CD," ).append("\n"); 
		query.append("                    MAX(A.POD_NOD_CD) AS POD_NOD_CD," ).append("\n"); 
		query.append("                    MAX(A.TRSP_BND_CD) AS TRSP_BND_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_CD AS AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_NO AS AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_OFC_CTY_CD) AS TRSP_AGMT_OFC_CTY_CD," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_SEQ) AS TRSP_AGMT_SEQ," ).append("\n"); 
		query.append("                    SUBSTR(DECODE(MAX(A.TRSP_BND_CD), 'I', MAX(A.DEL_NOD_CD), 'O', NVL(MAX(A.POL_NOD_CD), MAX(A.POL_CD)) , '') , 1, 5) AS POLDEL_CD," ).append("\n"); 
		query.append("                    SUBSTR(DECODE(MAX(A.TRSP_BND_CD), 'I', MAX(A.DEL_NOD_CD), 'O', NVL(MAX(A.POL_NOD_CD), MAX(A.POL_CD)) , '') , 6) AS POLDEL_YARD," ).append("\n"); 
		query.append("                    MAX(A.ROUT_PLN_CD) AS ROUT_PLN_CD," ).append("\n"); 
		query.append("                    (SELECT SUBSTR(VNDR.FM_NOD_CD,1,5) FROM TRS_TRSP_RAIL_BIL_VNDR_SET VNDR WHERE VNDR.TRSP_SO_OFC_CTY_CD = A.TRSP_SO_OFC_CTY_CD AND VNDR.TRSP_SO_SEQ = A.TRSP_SO_SEQ AND VNDR.SUB_RAIL_SEQ = 2) AS INTER_FM_NOD_CD," ).append("\n"); 
		query.append("                    (SELECT SUBSTR(VNDR.FM_NOD_CD,6) FROM TRS_TRSP_RAIL_BIL_VNDR_SET VNDR WHERE VNDR.TRSP_SO_OFC_CTY_CD = A.TRSP_SO_OFC_CTY_CD AND VNDR.TRSP_SO_SEQ = A.TRSP_SO_SEQ AND VNDR.SUB_RAIL_SEQ = 2) AS INTER_FM_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(CASE WHEN A.CXL_RQST_FLG = 'N' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'Y' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested Rejected'" ).append("\n"); 
		query.append("                             WHEN A.CXL_RQST_FLG = 'Y' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'N' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'E' THEN 'EDI Error'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'V' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' AND C.BIL_ISS_STS_CD = 'X' THEN 'Rail Billing Cancelled'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Rail Billed'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'C' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'R' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                    END) STATUS_NM," ).append("\n"); 
		query.append("                    MAX(BC.VGM_WGT) VGM_WGT," ).append("\n"); 
		query.append("                    MAX(BC.VGM_WGT_UT_CD) VGM_WGT_UT_CD" ).append("\n"); 
		query.append("                FROM" ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_ORD A," ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_VNDR_SET B," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD C," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD_RSND CR," ).append("\n"); 
		query.append("                    BKG_CONTAINER BC," ).append("\n"); 
		query.append("                    MDM_VENDOR D," ).append("\n"); 
		query.append("                    TRS_TRSP_CFM_MSG_HIS CFM" ).append("\n"); 
		query.append("                WHERE A.TRSP_SO_OFC_CTY_CD = B.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = B.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = C.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = C.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CR.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CR.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   B.VNDR_SEQ = NVL(C.VNDR_SEQ, B.VNDR_SEQ)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CFM.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CFM.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.BKG_NO = BC.BKG_NO (+)" ).append("\n"); 
		query.append("                AND   A.EQ_NO = BC.CNTR_NO (+)" ).append("\n"); 
		query.append("                AND   B.VNDR_SEQ = D.VNDR_SEQ" ).append("\n"); 
		query.append("                AND   A.RAIL_CMB_THRU_TP_CD IN ('S2R', 'S3R')" ).append("\n"); 
		query.append("                AND   A.DELT_FLG = 'N'" ).append("\n"); 
		query.append("                AND   NVL(A.SPND_FLG, 'N') = 'N'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if($vvd.size() > 0)" ).append("\n"); 
		query.append("    AND ((A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append("    #foreach($key IN ${vvd})" ).append("\n"); 
		query.append("        #if($velocityCount == 1)                        " ).append("\n"); 
		query.append("            ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("        #else" ).append("\n"); 
		query.append("            , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("    )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if($bl.size() > 0)" ).append("\n"); 
		query.append("    AND (A.BL_NO IN ( " ).append("\n"); 
		query.append("                        #foreach($key IN ${bl})" ).append("\n"); 
		query.append("                            #if($velocityCount == 1)" ).append("\n"); 
		query.append("                                '$key'" ).append("\n"); 
		query.append("                            #else" ).append("\n"); 
		query.append("                                ,'$key'" ).append("\n"); 
		query.append("                            #end" ).append("\n"); 
		query.append("                        #end" ).append("\n"); 
		query.append("                    )" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if($cntr.size() > 0)" ).append("\n"); 
		query.append("    AND A.EQ_NO IN (" ).append("\n"); 
		query.append("                        #foreach($key IN ${cntr})" ).append("\n"); 
		query.append("                            #if($velocityCount == 1)" ).append("\n"); 
		query.append("                                '$key'" ).append("\n"); 
		query.append("                            #else" ).append("\n"); 
		query.append("                                ,'$key'" ).append("\n"); 
		query.append("                            #end" ).append("\n"); 
		query.append("                        #end" ).append("\n"); 
		query.append("                    )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${frmDate} != '' && ${toDate} != '')" ).append("\n"); 
		query.append("    #if(${radDate} == 'DS')" ).append("\n"); 
		query.append("        AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("    #elseif(${radDate} == 'DB')" ).append("\n"); 
		query.append("        AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD')-21 AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("        AND C.BIL_EDI_SNT_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("    #elseif(${radDate} == 'DC')" ).append("\n"); 
		query.append("        AND A.CXL_RQST_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${frmNode} != '')" ).append("\n"); 
		query.append("    AND A.FM_NOD_CD LIKE @[frmNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${toNode} != '')" ).append("\n"); 
		query.append("    AND A.TO_NOD_CD LIKE @[toNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${radVendor} == 'V2' && ${svcProvid} != '')" ).append("\n"); 
		query.append("    AND A.PROV_VNDR_SEQ = @[sSvcProvid]" ).append("\n"); 
		query.append("#elseif(${radVendor} == 'V1' && ${railRoad} != 'ALL')" ).append("\n"); 
		query.append("    AND B.VNDR_SEQ = @[railRoad]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${status} != 'ALL')" ).append("\n"); 
		query.append("    AND A.TRSP_SO_STS_CD = @[status]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${edKind} != 'ALL')" ).append("\n"); 
		query.append("    AND C.BIL_ISS_STS_CD = @[edKind]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fuEmpy} != 'ALL')" ).append("\n"); 
		query.append("    AND A.CGO_TP_CD = @[fuEmpy]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${bound} != 'ALL')" ).append("\n"); 
		query.append("    AND A.TRSP_BND_CD = @[bound]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${through} != 'ALL')" ).append("\n"); 
		query.append("    #if(${through} == 'E')" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD <> 'W'" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD = 'W'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${bkgAtch} != 'ALL')" ).append("\n"); 
		query.append("    #if(${bkgAtch} == 'N')" ).append("\n"); 
		query.append("        AND BC.CNTR_NO IS NULL" ).append("\n"); 
		query.append("        AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append("    #elseif(${bkgAtch} == 'Y')" ).append("\n"); 
		query.append("        AND BC.CNTR_NO IS NOT NULL" ).append("\n"); 
		query.append("        AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                GROUP BY " ).append("\n"); 
		query.append("                        A.TRSP_SO_OFC_CTY_CD, " ).append("\n"); 
		query.append("                        A.TRSP_SO_SEQ, " ).append("\n"); 
		query.append("                        B.SUB_RAIL_SEQ, " ).append("\n"); 
		query.append("                        C.BIL_ISS_KNT, " ).append("\n"); 
		query.append("                        A.AUTO_XPT_SYS_CD, " ).append("\n"); 
		query.append("                        A.AUTO_XPT_SYS_NO" ).append("\n"); 
		query.append("            ) X" ).append("\n"); 
		query.append("    ) M," ).append("\n"); 
		query.append("    TRS_TRSP_RAIL_EDI_NOD S," ).append("\n"); 
		query.append("    TRS_TRSP_RAIL_EDI_NOD T" ).append("\n"); 
		query.append("WHERE NVL(M.POL_NOD_CD, M.FM_NOD_CD||M.FM_NOD_YARD) = S.EDI_RCV_NOD_CD (+)" ).append("\n"); 
		query.append("AND   NVL(M.POD_NOD_CD, M.TO_NOD_CD||M.TO_NOD_YARD) = T.EDI_RCV_NOD_CD (+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${incHistory} != 'H')" ).append("\n"); 
		query.append("    AND M.LASTCHK = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("ORDER BY " ).append("\n"); 
		query.append("    M.TRSP_SO_OFC_CTY_CD, M.TRSP_SO_SEQ, M.BIL_ISS_KNT DESC" ).append("\n"); 

	}
}