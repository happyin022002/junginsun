<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PreDispatchSentHistoryDBDAOSearch01PreDispatchSentHistoryRSQL">
			<desc><![CDATA[search01PreDispatchSentHistory]]></desc>
			<sql><![CDATA[
SELECT
      A.TRSP_SO_OFC_CTY_CD
     ,A.TRSP_SO_SEQ       
     ,B.TRSP_DIS_REF_NO   
     ,A.TRSP_WO_OFC_CTY_CD
     ,A.TRSP_WO_SEQ       
     ,A.VNDR_SEQ VNDR_SEQ 
     ,D.VNDR_ABBR_NM      
     ,TO_CHAR(C.CRE_DT, 'YYYY-MM-DD HH24:MI:SS') SNT_DT
     ,C.TRSP_DIS_ISS_SEQ
     ,C.DIS_N1ST_FAX_NO 
     ,C.DIS_N2ND_FAX_NO 
     ,C.DIS_N3RD_FAX_NO 
     ,COMMCODE_PKG.GET_COMDTL_NAME_FNC('CD00959', FAX1.FAX_PROC_STS_CD) DIS_N1ST_FAX_RSLT_FLG
     ,COMMCODE_PKG.GET_COMDTL_NAME_FNC('CD00959', FAX2.FAX_PROC_STS_CD) DIS_N2ND_FAX_RSLT_FLG
     ,COMMCODE_PKG.GET_COMDTL_NAME_FNC('CD00959', FAX3.FAX_PROC_STS_CD) DIS_N3RD_FAX_RSLT_FLG
     ,C.DIS_N1ST_EML
     ,C.DIS_N2ND_EML
     ,C.DIS_N3RD_EML
     ,COMMCODE_PKG.GET_COMDTL_NAME_FNC('CD00960', EML1.EML_PROC_STS_CD) DIS_N1ST_EML_RSLT_FLG
     ,COMMCODE_PKG.GET_COMDTL_NAME_FNC('CD00960', EML2.EML_PROC_STS_CD) DIS_N2ND_EML_RSLT_FLG
     ,COMMCODE_PKG.GET_COMDTL_NAME_FNC('CD00960', EML3.EML_PROC_STS_CD) DIS_N3RD_EML_RSLT_FLG
     ,TO_CHAR(B.DLY_DIS_SNT_DT, 'YYYY-MM-DD HH24:MI:SS') DLY_DIS_SNT_DT
     ,DECODE(C.CNTR_AVAL_NTC_UPD_FLG ,'Y', TO_CHAR(C.CRE_DT, 'YYYY-MM-DD HH24:MI:SS')) TRSP_CNTR_AVAL_SNT_DT
FROM  TRS_TRSP_SVC_ORD A
    , TRS_TRSP_DIS_MST B
    , TRS_TRSP_DIS_HIS C
    , MDM_VENDOR D
    , TRS_TRSP_WRK_ORD E
    , COM_FAX_SND_INFO FAX1
    , COM_FAX_SND_INFO FAX2
    , COM_FAX_SND_INFO FAX3
    , COM_EML_SND_INFO EML1
    , COM_EML_SND_INFO EML2
    , COM_EML_SND_INFO EML3
    , MDM_LOCATION LOC
WHERE A.TRSP_SO_OFC_CTY_CD  = B.TRSP_SO_OFC_CTY_CD
AND   A.TRSP_SO_SEQ         = B.TRSP_SO_SEQ
AND   A.TRSP_WO_OFC_CTY_CD  = B.TRSP_WO_OFC_CTY_CD
AND   A.TRSP_WO_SEQ         = B.TRSP_WO_SEQ
AND   B.TRSP_SO_OFC_CTY_CD  = C.TRSP_SO_OFC_CTY_CD
AND   B.TRSP_SO_SEQ         = C.TRSP_SO_SEQ
AND   B.TRSP_WO_OFC_CTY_CD  = C.TRSP_WO_OFC_CTY_CD
AND   B.TRSP_WO_SEQ         = C.TRSP_WO_SEQ
AND   B.TRSP_DIS_REF_NO     = C.TRSP_DIS_REF_NO
AND   A.TRSP_WO_OFC_CTY_CD  = E.TRSP_WO_OFC_CTY_CD
AND   A.TRSP_WO_SEQ         = E.TRSP_WO_SEQ
AND   C.DIS_N1ST_FAX_SND_NO = FAX1.FAX_SND_NO(+)
AND   C.DIS_N2ND_FAX_SND_NO = FAX2.FAX_SND_NO(+)
AND   C.DIS_N3RD_FAX_SND_NO = FAX3.FAX_SND_NO(+)
AND   C.DIS_N1ST_EML_SND_NO = EML1.EML_SND_NO(+)
AND   C.DIS_N2ND_EML_SND_NO = EML2.EML_SND_NO(+)
AND   C.DIS_N3RD_EML_SND_NO = EML3.EML_SND_NO(+)
AND   A.VNDR_SEQ = D.VNDR_SEQ
AND   B.TRSP_WO_CXL_FLG IS NULL
AND   A.TRSP_CRR_MOD_CD = 'TD'
AND   A.TRSP_SO_STS_CD  = 'I'
AND   A.DELT_FLG        = 'N'
AND   LOC.LOC_CD   = SUBSTR(A.FM_NOD_CD, 1, 5)
AND   LOC.CONTI_CD = 'M'
AND   LOC.DELT_FLG = 'N'
AND   A.TRSP_SO_OFC_CTY_CD = @[trsp_so_ofc_cty_cd] 
AND   A.TRSP_SO_SEQ        = @[trsp_so_seq] 
AND   A.TRSP_WO_OFC_CTY_CD = @[trsp_wo_ofc_cty_cd] 
AND   A.TRSP_WO_SEQ        = @[trsp_wo_seq] 
AND   B.TRSP_DIS_REF_NO    = @[trsp_dis_ref_no] 

ORDER BY C.TRSP_DIS_ISS_SEQ			]]></sql>
			<params>
				<param name="trsp_so_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="trsp_so_seq" type="2" value="" out="N"/>
				<param name="trsp_wo_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="trsp_wo_seq" type="2" value="" out="N"/>
				<param name="trsp_dis_ref_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
