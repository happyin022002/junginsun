<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CSRIssueTransferSlipManageDBDAOSearchInvoiceInquiryRSQL">
			<desc><![CDATA[Invoice 조회]]></desc>
			<sql><![CDATA[
SELECT 
  HDR.CSR_NO ,
  HDR.VNDR_NO ,
  TRS_COMMON_PKG.GET_VNDR_FULL_NM_FNC(HDR.VNDR_NO) VNDR_NM ,
  COUNT(INV_WRK.INV_NO) INV_CNT ,
  HDR.CSR_CURR_CD ,
  HDR.CSR_AMT ,
  HDR.INV_DT MAX_ISS_DT ,
  HDR.INV_TERM_DT MAX_RCV_DT ,
  DECODE(HDR.PAY_MZD_LU_CD, 'CHECK' , HDR.ATTR_CTNT2 , '') ASA_NO ,
  HDR.VNDR_TERM_NM ,
  DECODE(HDR.VNDR_TERM_NM , 'KR H/O PAYMENT_60' , NULL , 'O60' , NULL , TO_CHAR(TO_DATE(HDR.INV_TERM_DT, 'YYYY-MM-DD') + HDR.VNDR_TERM_NM, 'YYYY-MM-DD' )) PRE_DUE_DATE ,
  TO_CHAR(TO_DATE(HDR.INV_TERM_DT, 'YYYY-MM-DD'), 'YYYY-MM-DD') PRE_DUE_DATE ,
  INV_WRK.CRE_OFC_CD COST_OFC
FROM AP_INV_HDR HDR ,
  (
    SELECT CSR_NO ,
      CRE_OFC_CD ,
      INV_NO
    FROM (
        SELECT CSR_NO ,
          CRE_OFC_CD ,
          INV_NO
        FROM TRS_TRSP_RAIL_INV_WRK
        UNION ALL
        SELECT CSR_NO ,
          CRE_OFC_CD ,
          INV_NO
        FROM TRS_TRSP_INV_WRK )
    GROUP BY CSR_NO , CRE_OFC_CD , INV_NO ) INV_WRK
WHERE INV_WRK.CSR_NO = HDR.CSR_NO
  AND HDR.CSR_NO = @[CSR_NO]
GROUP BY HDR.CSR_NO , HDR.VNDR_NO , HDR.CSR_CURR_CD , HDR.CSR_AMT , HDR.INV_DT , HDR.INV_TERM_DT , HDR.PAY_MZD_LU_CD , HDR.ATTR_CTNT2 , HDR.VNDR_TERM_NM , INV_WRK.CRE_OFC_CD			]]></sql>
			<params>
				<param name="CSR_NO" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
