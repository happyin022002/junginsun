<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CARIssueTransferSlipManageDBDAOCheckMissingLaneCode02RSQL">
			<desc><![CDATA[CheckMissingLaneCode02]]></desc>
			<sql><![CDATA[
 SELECT
 CASE
 WHEN SIGN(NVL((SELECT SUM(D.RVIS_VOL_QTY) FROM TES_TML_SO_DTL D
                WHERE D.TML_SO_OFC_CTY_CD = X.TML_SO_OFC_CTY_CD AND D.TML_SO_SEQ = X.TML_SO_SEQ AND D.CALC_TP_CD = 'A'),0)
           - NVL(SUM(RVIS_VOL_QTY),0)) = 0
 THEN 'Y'
 ELSE 'N'
 END LANE_CD_MATCH_CHK
 FROM (
 SELECT
        D.TML_SO_OFC_CTY_CD, D.TML_SO_SEQ,
        NVL(D.RVIS_VOL_QTY,0) RVIS_VOL_QTY
 FROM   (SELECT L.*
         FROM   TES_TML_SO_HDR H, TES_TML_SO_CNTR_LIST L
         WHERE  1=1
         AND    H.VNDR_SEQ = @[vndr_seq]
         AND    H.INV_NO = @[inv_no]
         AND    H.TML_INV_TP_CD = 'TM'
         AND    NVL(H.DELT_FLG,'N') <> 'Y'
         AND    H.TML_SO_OFC_CTY_CD = L.TML_SO_OFC_CTY_CD
         AND    H.TML_SO_SEQ = L.TML_SO_SEQ
         AND    L.VRFY_RSLT_IND_CD      = 'CO') L,
         (SELECT D.* FROM TES_TML_SO_DTL D WHERE D.CALC_TP_CD = 'A') D
 WHERE 1=1
 AND    L.TML_SO_OFC_CTY_CD = D.TML_SO_OFC_CTY_CD
 AND    L.TML_SO_SEQ = D.TML_SO_SEQ
 AND    L.VSL_CD     = D.VSL_CD
 AND    L.SKD_VOY_NO = D.SKD_VOY_NO
 AND    L.SKD_DIR_CD = D.SKD_DIR_CD
 AND    L.IO_BND_CD  = D.IO_BND_CD
 AND    DECODE(L.BB_CGO_FLG,'Y','BB',DECODE(L.LOCL_TS_IND_CD,'T',DECODE(L.CNTR_STY_CD,'F','TS','TM'),DECODE(L.CNTR_STY_CD,'F','FL','MT'))) = SUBSTR(D.LGS_COST_CD,5,2)
 AND    NVL(L.CNTR_TPSZ_CD,'X') = NVL(D.CNTR_TPSZ_CD,'X')
 AND    NVL(L.IO_BND_CD,'X')     = NVL(D.IO_BND_CD,'X')
 AND    NVL(L.DCGO_CLSS_CD,'X') = NVL(D.DCGO_IND_CD,'X')
 AND    NVL(L.IOC_CD,'X')         = NVL(D.IOC_CD,'X')
 AND    NVL(L.LANE_CD,'X')         = NVL(D.LANE_CD,'X')
 AND    DECODE(D.TML_TRNS_MOD_CD,'','S','S','S',NVL(L.TML_TRNS_MOD_CD,'S')) = NVL(D.TML_TRNS_MOD_CD,'S')
 GROUP BY D.TML_SO_OFC_CTY_CD, D.TML_SO_SEQ, D.VSL_CD, D.SKD_VOY_NO, D.SKD_DIR_CD, D.IO_BND_CD,
          D.LGS_COST_CD, D.CNTR_TPSZ_CD, D.IOC_CD, D.TML_TRNS_MOD_CD, D.DCGO_IND_CD, --D.RC_FLG,
          D.FM_TR_VOL_VAL, D.TO_TR_VOL_VAL, D.LANE_CD, D.RVIS_VOL_QTY
 ) X
 WHERE X.TML_SO_OFC_CTY_CD IS NOT NULL AND X.TML_SO_SEQ IS NOT NULL
 GROUP BY X.TML_SO_OFC_CTY_CD, X.TML_SO_SEQ
			]]></sql>
			<params>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="inv_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
