<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RailSoManageDBDAOMultiTrsTrspRailBilOrdChkRSQL">
			<desc><![CDATA[SO 대상이 맞는지 확인하는 조회 SQL]]></desc>
			<sql><![CDATA[
#set(${verifyCopNo}=${verifyCopNo})
#set(${verifyCostActGrpSeq}=${verifyCostActGrpSeq})
#set(${verifyRoutOrgNodCd}=${verifyRoutOrgNodCd})
#set(${verifyRoutDestNodCd}=${verifyRoutDestNodCd})
#set(${verifyRoutSeq}=${verifyRoutSeq})


#foreach(${key} IN ${arrNo})
#if($velocityCount == 1)	

SELECT 
    'X' CHK_UNIT 
FROM 
    DUAL 
WHERE EXISTS (
                SELECT 
                    'X' 
                FROM 
                    TRS_TRSP_RAIL_BIL_ORD 
                WHERE COP_NO = ${verifyCopNo.get($key)}
                AND   COST_ACT_GRP_SEQ = ${verifyCostActGrpSeq.get($key)}
                AND   DELT_FLG = 'N'
             ) 
OR EXISTS (
            SELECT 
                'X' 
            FROM 
                TRS_TRSP_SVC_ORD 
            WHERE COP_NO = ${verifyCopNo.get($key)}
            AND   COST_ACT_GRP_SEQ = ${verifyCostActGrpSeq.get($key)}
            AND   DELT_FLG = 'N'
          ) 
OR NOT EXISTS (
                SELECT 
                    'X' 
                FROM 
                    PRD_INLND_ROUT_MST A, 
                    PRD_INLND_ROUT_DTL B, 
                    PRD_INLND_EACH_LNK C 
                WHERE B.ROUT_ORG_NOD_CD = ${verifyRoutOrgNodCd.get($key)}
                AND   B.ROUT_DEST_NOD_CD = ${verifyRoutDestNodCd.get($key)}
                AND   B.ROUT_SEQ = ${verifyRoutSeq.get($key)}
                AND   B.TRSP_MOD_CD = 'RD' 
                AND   A.ROUT_ORG_NOD_CD = B.ROUT_ORG_NOD_CD 
                AND   A.ROUT_DEST_NOD_CD = B.ROUT_DEST_NOD_CD 
                AND   A.ROUT_SEQ = B.ROUT_SEQ 
                AND   NVL(A.DELT_FLG,'N') <> 'Y'  
                AND   B.LNK_ORG_NOD_CD = C.LNK_ORG_NOD_CD 
                AND   B.LNK_DEST_NOD_CD = C.LNK_DEST_NOD_CD 
                AND   B.TRSP_MOD_CD = C.TRSP_MOD_CD
              )

#else

UNION
SELECT 
    'X' CHK_UNIT 
FROM 
    DUAL 
WHERE EXISTS (
                SELECT 
                    'X' 
                FROM 
                    TRS_TRSP_RAIL_BIL_ORD 
                WHERE COP_NO = ${verifyCopNo.get($key)}
                AND   COST_ACT_GRP_SEQ = ${verifyCostActGrpSeq.get($key)}
                AND   DELT_FLG = 'N'
             ) 
OR EXISTS (
            SELECT 
                'X' 
            FROM 
                TRS_TRSP_SVC_ORD 
            WHERE COP_NO = ${verifyCopNo.get($key)}
            AND   COST_ACT_GRP_SEQ = ${verifyCostActGrpSeq.get($key)}
            AND   DELT_FLG = 'N'
          ) 
OR NOT EXISTS (
                SELECT 
                    'X' 
                FROM 
                    PRD_INLND_ROUT_MST A, 
                    PRD_INLND_ROUT_DTL B, 
                    PRD_INLND_EACH_LNK C 
                WHERE B.ROUT_ORG_NOD_CD = ${verifyRoutOrgNodCd.get($key)}
                AND   B.ROUT_DEST_NOD_CD = ${verifyRoutDestNodCd.get($key)}
                AND   B.ROUT_SEQ = ${verifyRoutSeq.get($key)}
                AND   B.TRSP_MOD_CD = 'RD' 
                AND   A.ROUT_ORG_NOD_CD = B.ROUT_ORG_NOD_CD 
                AND   A.ROUT_DEST_NOD_CD = B.ROUT_DEST_NOD_CD 
                AND   A.ROUT_SEQ = B.ROUT_SEQ 
                AND   NVL(A.DELT_FLG,'N') <> 'Y'  
                AND   B.LNK_ORG_NOD_CD = C.LNK_ORG_NOD_CD 
                AND   B.LNK_DEST_NOD_CD = C.LNK_DEST_NOD_CD 
                AND   B.TRSP_MOD_CD = C.TRSP_MOD_CD
              )

#end
#end			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
