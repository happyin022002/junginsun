<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PsoAdvanceAuditDBDAOconfirmPsoPreAuditCSQL">
			<desc><![CDATA[* 2016.03.25 CHM-201640191 Split02-Auto Audit - Invoice Batch 개발 요청
]]></desc>
			<sql><![CDATA[
MERGE INTO EAS_PORT_SO_CFM_INV K USING DUAL
ON( K.ISS_CTY_CD = @[iss_cty_cd]
AND K.SO_SEQ     = @[so_seq]
AND K.SO_DTL_SEQ = @[so_dtl_seq]
) 
WHEN MATCHED THEN
    UPDATE
    SET UPD_USR_ID = @[upd_usr_id]
        , UPD_DT = SYSDATE
		, PORT_CHG_AUD_CHK_CD = DECODE(@[s_save_tp_cd], 'C', @[select_flg], PORT_CHG_AUD_CHK_CD)
		, PORT_CHG_AUD_RSLT_RMK = DECODE(@[s_save_tp_cd], 'S', @[port_chg_aud_rslt_rmk], PORT_CHG_AUD_RSLT_RMK)
		, PORT_CHG_AUD_RSLT_USR_ID = DECODE(@[s_save_tp_cd], 'S', @[upd_usr_id], PORT_CHG_AUD_RSLT_USR_ID)
        , ATCH_FILE_LNK_ID = @[atch_file_lnk_id]
        , EXPN_AUD_RSLT_CD = DECODE(@[s_save_tp_cd], 'S', @[expn_aud_rslt_cd], EXPN_AUD_RSLT_CD)
#if(${batch_tp_cd} != '') -- 배치 프로그램 수행시에만 실행
    ,RHQ_CD						= @[rhq_cd]
    ,INV_OFC_CD                 = @[inv_ofc_cd]
    ,INV_CFM_DT                 = TO_DATE(@[inv_cfm_dt], 'YYYYMMDD HH24:MI:SS')
    ,AUTO_EXPN_AUD_STS_CD       = @[auto_expn_aud_sts_cd]
    ,YD_CD                      = @[yd_cd]
    ,VSL_CD                     = @[vsl_cd]
    ,SKD_VOY_NO                 = @[skd_voy_no]
    ,SKD_DIR_CD                 = @[skd_dir_cd]
    ,INV_NO                     = @[inv_no]
    ,ACCT_CD                    = @[acct_cd]
    ,LGS_COST_CD                = @[lgs_cost_cd]
    ,VNDR_SEQ                   = TO_NUMBER(@[vndr_seq])
    ,CURR_CD                    = @[curr_cd]
    ,CALC_AMT                   = TO_NUMBER(@[calc_amt])
    ,ADJ_AMT                    = TO_NUMBER(@[adj_amt])
    ,LOCL_AMT                   = TO_NUMBER(@[locl_amt])
    ,INV_AMT                    = TO_NUMBER(@[inv_amt])
    --,FLET_CTRT_TP_CD            = [flet_ctrt_tp_cd]
    ,CNTR_VSL_CLSS_CAPA         = TO_NUMBER(@[cntr_vsl_clss_capa])
    ,CSR_NO                     = @[csr_no]
    ,EXPN_AUD_INV_STS_CD        = @[expn_aud_inv_sts_cd]
    ,DP_IO_BND_CD               = @[dp_io_bnd_cd]
    ,VPS_ETB_DT                 = TO_DATE(@[vps_etb_dt], 'YYYY-MM-DD HH24:MI:SS')
    ,ISS_DT                     = TO_DATE(@[iss_dt], 'YYYY-MM-DD')
    ,INV_CRE_USR_ID             = @[inv_cre_usr_id]
    ,DIFF_AMT                   = TO_NUMBER(@[diff_amt])
    ,FOML_DESC                  = @[foml_desc]
    ,XPR_DESC                   = @[xpr_desc]
    ,PORT_CHG_AUD_DT            = TO_DATE(@[port_chg_aud_dt], 'YYYY-MM-DD HH24:MI:SS')
    ,PORT_CHG_AUD_USR_ID        = @[port_chg_aud_usr_id]
    ,DIFF_RMK                   = @[diff_rmk]
    ,BRTH_HRS                   = TO_NUMBER(@[brth_hrs])
    ,LST_PORT_CD                = @[lst_port_cd]
    ,ST_PORT_CD                 = @[st_port_cd]
    ,GRS_RGST_TONG_WGT          = TO_NUMBER(@[grs_rgst_tong_wgt])
    ,NET_RGST_TONG_WGT          = TO_NUMBER(@[net_rgst_tong_wgt])
    ,ARR_TUG_BOT_KNT            = TO_NUMBER(@[arr_tug_bot_knt])
    ,DEP_TUG_BOT_KNT            = TO_NUMBER(@[dep_tug_bot_knt])
    ,PAY_TERM_DYS               = TO_NUMBER(@[pay_term_dys])
    ,PAY_DUE_DT                 = @[pay_due_dt]
    ,AP_PAY_DT                  = TO_DATE(@[ap_pay_dt], 'YYYY-MM-DD HH24:MI:SS')
    ,SUZ_GT_WGT                 = TO_NUMBER(@[suz_gt_wgt])
    ,MADN_VOY_SUZ_NET_TONG_WGT  = TO_NUMBER(@[madn_voy_suz_net_tong_wgt])
    ,SDR_XCH_RT                 = TO_NUMBER(@[sdr_xch_rt])
    ,VSL_TR_NO                  = @[vsl_tr_no]
#end
WHEN NOT MATCHED THEN
    INSERT(
     K.ISS_CTY_CD
    ,K.SO_SEQ
    ,K.SO_DTL_SEQ
    ,K.PORT_CHG_AUD_CHK_CD
	,K.PORT_CHG_AUD_RSLT_RMK
	,K.PORT_CHG_AUD_RSLT_USR_ID
	,K.ATCH_FILE_LNK_ID
	,K.EXPN_AUD_RSLT_CD
    ,K.CRE_USR_ID
    ,K.CRE_DT
    ,K.UPD_USR_ID
    ,K.UPD_DT
#if(${batch_tp_cd} != '') -- 배치 프로그램 수행시에만 실행
    ,RHQ_CD
    ,INV_OFC_CD
    ,INV_CFM_DT
    ,AUTO_EXPN_AUD_STS_CD
    ,YD_CD
    ,VSL_CD
    ,SKD_VOY_NO
    ,SKD_DIR_CD
    ,INV_NO
    ,ACCT_CD
    ,LGS_COST_CD
    ,VNDR_SEQ
    ,CURR_CD
    ,CALC_AMT
    ,ADJ_AMT
    ,LOCL_AMT
    ,INV_AMT
    --,FLET_CTRT_TP_CD
    ,CNTR_VSL_CLSS_CAPA
    ,CSR_NO
    ,EXPN_AUD_INV_STS_CD
    ,DP_IO_BND_CD
    ,VPS_ETB_DT
    ,ISS_DT
    ,INV_CRE_USR_ID
    ,DIFF_AMT
    ,FOML_DESC
    ,XPR_DESC
    ,PORT_CHG_AUD_DT
    ,PORT_CHG_AUD_USR_ID
    ,DIFF_RMK
    ,BRTH_HRS
    ,LST_PORT_CD
    ,ST_PORT_CD
    ,GRS_RGST_TONG_WGT
    ,NET_RGST_TONG_WGT
    ,ARR_TUG_BOT_KNT
    ,DEP_TUG_BOT_KNT
    ,PAY_TERM_DYS
    ,PAY_DUE_DT
    ,AP_PAY_DT
    ,SUZ_GT_WGT
    ,MADN_VOY_SUZ_NET_TONG_WGT
    ,SDR_XCH_RT
    ,VSL_TR_NO
#end

    )
    values
    (
      @[iss_cty_cd]
    , TO_NUMBER(@[so_seq])
    , TO_NUMBER(@[so_dtl_seq])
    , DECODE(@[s_save_tp_cd], 'C', @[select_flg])
    , DECODE(@[s_save_tp_cd], 'S', @[port_chg_aud_rslt_rmk])
    , DECODE(@[s_save_tp_cd], 'S', @[upd_usr_id])
	, @[atch_file_lnk_id]
	, DECODE(@[s_save_tp_cd], 'S', @[expn_aud_rslt_cd])
    , @[upd_usr_id]
    , SYSDATE
    , @[upd_usr_id]
    , SYSDATE
#if(${batch_tp_cd} != '') -- 배치 프로그램 수행시에만 실행
    , @[rhq_cd]
    , @[inv_ofc_cd]
    , TO_DATE(@[inv_cfm_dt], 'YYYYMMDD HH24:MI:SS')
    , @[auto_expn_aud_sts_cd]
    , @[yd_cd]
    , @[vsl_cd]
    , @[skd_voy_no]
    , @[skd_dir_cd]
    , @[inv_no]
    , @[acct_cd]
    , @[lgs_cost_cd]
    , TO_NUMBER(@[vndr_seq])
    , @[curr_cd]
    , TO_NUMBER(@[calc_amt])
    , TO_NUMBER(@[adj_amt])
    , TO_NUMBER(@[locl_amt])
    , TO_NUMBER(@[inv_amt])
    -- [flet_ctrt_tp_cd]
    , TO_NUMBER(@[cntr_vsl_clss_capa])
    , @[csr_no]
    , @[expn_aud_inv_sts_cd]
    , @[dp_io_bnd_cd]
    , TO_DATE(@[vps_etb_dt], 'YYYY-MM-DD HH24:MI:SS')
    , TO_DATE(@[iss_dt], 'YYYY-MM-DD')
    , @[inv_cre_usr_id]
    , TO_NUMBER(@[diff_amt])
    , @[foml_desc]
    , @[xpr_desc]
    , TO_DATE(@[port_chg_aud_dt], 'YYYY-MM-DD HH24:MI:SS')
    , @[port_chg_aud_usr_id]
    , @[diff_rmk]
    , TO_NUMBER(@[brth_hrs])
    , @[lst_port_cd]
    , @[st_port_cd]
    , TO_NUMBER(@[grs_rgst_tong_wgt])
    , TO_NUMBER(@[net_rgst_tong_wgt])
    , TO_NUMBER(@[arr_tug_bot_knt])
    , TO_NUMBER(@[dep_tug_bot_knt])
    , TO_NUMBER(@[pay_term_dys])
    , @[pay_due_dt]
    , TO_DATE(@[ap_pay_dt], 'YYYY-MM-DD HH24:MI:SS')
    , TO_NUMBER(@[suz_gt_wgt])
    , TO_NUMBER(@[madn_voy_suz_net_tong_wgt])
    , TO_NUMBER(@[sdr_xch_rt])
    , @[vsl_tr_no]
#end
    )			]]></sql>
			<params>
				<param name="iss_cty_cd" type="12" value="" out="N"/>
				<param name="so_seq" type="12" value="" out="N"/>
				<param name="so_dtl_seq" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="s_save_tp_cd" type="12" value="" out="N"/>
				<param name="select_flg" type="12" value="" out="N"/>
				<param name="port_chg_aud_rslt_rmk" type="12" value="" out="N"/>
				<param name="atch_file_lnk_id" type="12" value="" out="N"/>
				<param name="expn_aud_rslt_cd" type="12" value="" out="N"/>
				<param name="rhq_cd" type="12" value="" out="N"/>
				<param name="inv_ofc_cd" type="12" value="" out="N"/>
				<param name="inv_cfm_dt" type="12" value="" out="N"/>
				<param name="auto_expn_aud_sts_cd" type="12" value="" out="N"/>
				<param name="yd_cd" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="inv_no" type="12" value="" out="N"/>
				<param name="acct_cd" type="12" value="" out="N"/>
				<param name="lgs_cost_cd" type="12" value="" out="N"/>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="curr_cd" type="12" value="" out="N"/>
				<param name="calc_amt" type="12" value="" out="N"/>
				<param name="adj_amt" type="12" value="" out="N"/>
				<param name="locl_amt" type="12" value="" out="N"/>
				<param name="inv_amt" type="12" value="" out="N"/>
				<param name="cntr_vsl_clss_capa" type="12" value="" out="N"/>
				<param name="csr_no" type="12" value="" out="N"/>
				<param name="expn_aud_inv_sts_cd" type="12" value="" out="N"/>
				<param name="dp_io_bnd_cd" type="12" value="" out="N"/>
				<param name="vps_etb_dt" type="12" value="" out="N"/>
				<param name="iss_dt" type="12" value="" out="N"/>
				<param name="inv_cre_usr_id" type="12" value="" out="N"/>
				<param name="diff_amt" type="12" value="" out="N"/>
				<param name="foml_desc" type="12" value="" out="N"/>
				<param name="xpr_desc" type="12" value="" out="N"/>
				<param name="port_chg_aud_dt" type="12" value="" out="N"/>
				<param name="port_chg_aud_usr_id" type="12" value="" out="N"/>
				<param name="diff_rmk" type="12" value="" out="N"/>
				<param name="brth_hrs" type="12" value="" out="N"/>
				<param name="lst_port_cd" type="12" value="" out="N"/>
				<param name="st_port_cd" type="12" value="" out="N"/>
				<param name="grs_rgst_tong_wgt" type="12" value="" out="N"/>
				<param name="net_rgst_tong_wgt" type="12" value="" out="N"/>
				<param name="arr_tug_bot_knt" type="12" value="" out="N"/>
				<param name="dep_tug_bot_knt" type="12" value="" out="N"/>
				<param name="pay_term_dys" type="12" value="" out="N"/>
				<param name="pay_due_dt" type="12" value="" out="N"/>
				<param name="ap_pay_dt" type="12" value="" out="N"/>
				<param name="suz_gt_wgt" type="12" value="" out="N"/>
				<param name="madn_voy_suz_net_tong_wgt" type="12" value="" out="N"/>
				<param name="sdr_xch_rt" type="12" value="" out="N"/>
				<param name="vsl_tr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
