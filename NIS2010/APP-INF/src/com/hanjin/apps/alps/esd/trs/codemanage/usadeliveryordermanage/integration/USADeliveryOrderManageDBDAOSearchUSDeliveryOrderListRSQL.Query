<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="USADeliveryOrderManageDBDAOSearchUSDeliveryOrderListRSQL">
			<desc><![CDATA[SearchUSDeliveryOrderList]]></desc>
			<sql><![CDATA[
SELECT 
  X.CNTR_NO EQ_NO,
  X.CNTR_TPSZ_CD,
  X.BKG_NO BKG_NO,
  X.BL_NO BL_NO,
  Y.FCTRY_NM ,
  Y.ACT_CUST_N1ST_ADDR ,
  Y.ACT_CUST_ZIP_CD ,
  Y.CNTC_PSON_NM ,
  Y.CNTC_PSON_PHN_NO ,
  Y.CNTC_PSON_FAX_NO,
  Y.DO_RMK,
  X.PO_NO,
  X.BKG_SPE,
  X.FULL_PICKUP_CY,
  X.MTY_RTN_CY,
  X.CMDT
FROM (
    SELECT 
      B.CNTR_NO,
      B.CNTR_TPSZ_CD,
      A.BKG_NO,
      A.BL_NO,
      A.BL_NO_TP,
	  REPLACE((SELECT PU.CUST_REF_NO_CTNT
                 FROM BKG_REFERENCE PU
                WHERE PU.BKG_NO = B.BKG_NO
                  AND PU.CNTR_NO = B.CNTR_NO 
                  AND PU.BKG_REF_TP_CD = 'CTPO' ), CHR(13)||CHR(10), ',') AS PO_No, -- comma 로 처리하기로 협의

      CASE 
        WHEN B.DCGO_FLG 	= 'Y' THEN 'DG' 
        WHEN B.BB_CGO_FLG 	= 'Y' THEN 'BB' 
        WHEN B.AWK_CGO_FLG 	= 'Y' THEN 'AK' 
        WHEN B.RC_FLG 		= 'Y' THEN 'RF' 
        WHEN B.RD_CGO_FLG 	= 'Y' THEN 'RD' 
      ELSE '' 
      END BKG_SPE,
      A.FULL_PKUP_YD_CD FULL_PICKUP_CY,
      A.FULL_RTN_YD_CD MTY_RTN_CY,
      C.CMDT_NM CMDT
    FROM BKG_BOOKING A,
      BKG_CONTAINER B,
      MDM_COMMODITY C
    WHERE A.BKG_NO = B.BKG_NO
      AND A.CMDT_CD = C.CMDT_CD(+) 

	  #if($blNoArr.size() > 0) 
		AND A.BL_NO IN (
		  	#foreach( ${key} in ${blNoArr}) 
		    	#if($velocityCount == 1)
 			  		'${key}'	
		    	#else 
 			  		, '${key}'
				#end 
			#end 
 		)
	  #end 

	  #if($bkgNoArr.size() > 0) 
  		AND A.BKG_NO IN ( 
			#foreach( ${key} in ${bkgNoArr}) 
				#if($velocityCount == 1)
 					'${key}'	
				#else 
 					, '${key}'	
				#end 
	  		#end 
 		)
	  #end
	  #if(!($blNoArr.size() > 0) && !($bkgNoArr.size() > 0)) 
  		AND 1 = 2	
	  #end	

) X,
(
	SELECT B.BL_NO,
      C.EQ_NO,
      B.FCTRY_NM,
      B.ACT_CUST_N1ST_ADDR,
      B.ACT_CUST_ZIP_CD,
      B.CNTC_PSON_NM,
      B.CNTC_PSON_PHN_NO,
      B.CNTC_PSON_FAX_NO,
      C.DO_RMK
    FROM BKG_BOOKING A,
      TRS_TRSP_USA_DO_HDR B,
      TRS_TRSP_USA_DO_DTL C
    WHERE A.BL_NO = B.BL_NO
      AND A.BL_NO = C.BL_NO

	  #if($blNoArr.size() > 0) 
		AND A.BL_NO IN (
		  	#foreach( ${key} in ${blNoArr}) 
		    	#if($velocityCount == 1)
 			  		'${key}'	
		    	#else 
 			  		, '${key}'
				#end 
			#end 
 		)
	  #end 

	  #if($bkgNoArr.size() > 0) 
  		AND A.BKG_NO  IN ( 
			#foreach( ${key} in ${bkgNoArr}) 
				#if($velocityCount == 1)
 					'${key}'	
				#else 
 					, '${key}'	
				#end 
	  		#end 
 		)
	  #end
	  #if(!($blNoArr.size() > 0) && !($bkgNoArr.size() > 0)) 
  		AND 1 = 2	
	  #end	

) Y
WHERE X.BL_NO = Y.BL_NO(+)
  AND X.CNTR_NO = Y.EQ_NO(+)			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
