<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TesAdvanceAuditDBDAOTesAuditOndockRailHistoryRSQL">
			<desc><![CDATA[TesAuditOndockRailHistory]]></desc>
			<sql><![CDATA[
SELECT H.YD_CD
     , H.VNDR_SEQ
     , H.INV_NO
     , TO_CHAR(H.ISS_DT,'YYYY-MM-DD') AS ISS_DT
     , D.VSL_CD||D.SKD_VOY_NO||D.SKD_DIR_CD AS VVD
     , D.IO_BND_CD
     , TO_CHAR(D.ATB_DT,'YYYY-MM-DD') AS ATB_DT
     , D.CALC_TP_CD
     , D.LGS_COST_CD
     , D.CNTR_TPSZ_CD
     , D.DCGO_IND_CD
     , D.RC_FLG
     , D.TML_WRK_DY_CD     --Applied Date
     , D.IOC_CD            --IPC
     , D.TML_TRNS_MOD_CD
     , D.LANE_CD
     , NVL(FM_TR_VOL_VAL,'1')||' ~ '||NVL(TO_TR_VOL_VAL,'99999') AS TIER
     , D.CALC_VOL_QTY
     , D.RVIS_VOL_QTY
     , D.VOL_TR_UT_CD
     , D.CTRT_RT
     , D.CURR_CD
     , D.INV_XCH_RT
     , D.INV_AMT
     , D.CALC_RMK
     , D.N3PTY_FLG
 FROM TES_TML_SO_HDR H
    , TES_TML_SO_DTL D
 WHERE H.TML_SO_OFC_CTY_CD = D.TML_SO_OFC_CTY_CD
   AND H.TML_SO_SEQ        = D.TML_SO_SEQ
   AND H.TML_INV_TP_CD     = 'ON'
   AND H.INV_CFM_DT BETWEEN TO_DATE(REPLACE(@[s_from_inv_cfm_dt],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[s_to_inv_cfm_dt],'-',''),'YYYYMMDD') + 0.99999
   AND H.YD_CD             = @[s_loc_cd]||@[s_nod_cd]
#if (${s_vndr_seq} != '')
   AND H.VNDR_SEQ          = @[s_vndr_seq]
#end
#if (${s_inv_ofc_cd} != '')
   AND H.INV_OFC_CD        = @[s_inv_ofc_cd]
#end
#if (${s_calc_tp_cd} != '')
   AND D.CALC_TP_CD        = @[s_calc_tp_cd]
#end
#if (${s_lgs_cost_subj_cd} != '')
   AND SUBSTR(D.LGS_COST_CD, 1, 2) = @[s_lgs_cost_subj_cd]
#end
#if ($lgs_cost_dtl_cds.size() > 0)
  AND D.LGS_COST_CD IN (
  #foreach($key in ${lgs_cost_dtl_cds}) 
    #if($velocityCount < $lgs_cost_dtl_cds.size()) 
      '$key', 
    #else 
      '$key' 
    #end 
  #end
  )
#end
ORDER BY  H.YD_CD, H.VNDR_SEQ			]]></sql>
			<params>
				<param name="s_from_inv_cfm_dt" type="12" value="" out="N"/>
				<param name="s_to_inv_cfm_dt" type="12" value="" out="N"/>
				<param name="s_loc_cd" type="12" value="" out="N"/>
				<param name="s_nod_cd" type="12" value="" out="N"/>
				<param name="s_vndr_seq" type="12" value="" out="N"/>
				<param name="s_inv_ofc_cd" type="12" value="" out="N"/>
				<param name="s_calc_tp_cd" type="12" value="" out="N"/>
				<param name="s_lgs_cost_subj_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
