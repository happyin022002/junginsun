<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceAuditDBDAOConfirmInvoiceAuditSbcUSQL">
			<desc><![CDATA[inv_sbc_amt update]]></desc>
			<sql><![CDATA[
UPDATE TRS_TRSP_SVC_ORD SO
SET INV_SBC_AMT  = (SELECT DECODE(MAX(TRSP_SO_SEQ), SO.TRSP_SO_SEQ, TRUNC(@[sbc_amt]/COUNT(1)) + MOD(@[sbc_amt], COUNT(1)), TRUNC(@[sbc_amt]/COUNT(1)) ) AS INV_SBC_AMT
                      FROM TRS_TRSP_SVC_ORD 
                     WHERE 1=1 
                       AND INV_NO = SO.INV_NO 
                       AND INV_VNDR_SEQ = SO.INV_VNDR_SEQ
                     GROUP BY INV_NO, INV_VNDR_SEQ)
WHERE 1=1
AND INV_NO = @[invoice_no]
AND INV_VNDR_SEQ = @[paymt_sp_cd]
AND @[sbc_amt] <> 0			]]></sql>
			<params>
				<param name="sbc_amt" type="12" value="" out="N"/>
				<param name="invoice_no" type="12" value="" out="N"/>
				<param name="paymt_sp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
