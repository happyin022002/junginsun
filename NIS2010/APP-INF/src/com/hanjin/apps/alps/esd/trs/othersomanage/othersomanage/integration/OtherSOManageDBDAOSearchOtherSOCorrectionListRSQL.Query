<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="OtherSOManageDBDAOSearchOtherSOCorrectionListRSQL">
			<desc><![CDATA[Other Correction 목록 조회]]></desc>
			<sql><![CDATA[
SELECT  X.EQ_NO,
	   	X.EQ_TPSZ_CD,
    	X.FM_NOD_CD,
 	    X.FM_LOC_VALUE,
	    X.FM_YARD_VALUE,
	    X.VIA_NOD_CD,
    	X.VIA_LOC_VALUE,
	    X.VIA_YARD_VALUE,
    	X.TO_NOD_CD,
    	X.TO_LOC_VALUE,
	    X.TO_YARD_VALUE,
	    X.DOR_NOD_CD,
	    X.DR_LOC_VALUE,
	    X.DR_YARD_VALUE,
	    X.ACT_CUST_CNT_CD,
	    X.DOR_DE_ADDR,
	    X.VNDR_SEQ,
	    X.VNDR_ABBR_NM,
	    X.CURR_CD,
	    X.BZC_AMT,
	    X.NEGO_AMT,
	    X.FUEL_SCG_AMT,
        X.TOLL_FEE_AMT,
	    X.ETC_ADD_AMT,
	    X.REF_BKG_NO,
	    X.REF_BL_NO,
	    X.TRSP_PURP_RSN,
	    X.TRSP_SO_OFC_CTY_CD,
	    X.TRSP_SO_SEQ,
	    X.TRSP_SO_TP_CD,
	    X.TRSP_SO_STS_CD,
	    X.EQ_KND_CD,
	    X.CGO_TP_CD,
	    X.TRSP_COST_DTL_MOD_CD,
	    X.TRSP_CRR_MOD_CD,
	    X.TRSP_OTR_COST_MON_DT,     
	    X.CRE_OFC_CD,
	    X.CRE_DT,
	    X.CRE_USR_ID,
	    X.UPD_DT,
	    X.UPD_USR_ID,
        CASE WHEN X.WO_NO IS NULL
                 THEN TO_NUMBER(SUBSTR(X.PRD_DIST, INSTR(X.PRD_DIST, '/') + 1))  
              ELSE X.TTL_DIST 
        END AS TTL_DIST,
        CASE WHEN X.WO_NO IS NULL
                THEN SUBSTR(X.PRD_DIST, 1, INSTR(X.PRD_DIST, '/') - 1)
             ELSE  X.LNK_DIST_DIV_CD 
        END AS LNK_DIST_DIV_CD, X.NEGO_RMK
FROM
( SELECT A.EQ_NO	eq_no,
	   	A.EQ_TPSZ_CD,
    	A.FM_NOD_CD,
 	    SUBSTR(A.FM_NOD_CD, 1, 5) FM_LOC_VALUE,
	    SUBSTR(A.FM_NOD_CD, 6, 2) FM_YARD_VALUE,
	    A.VIA_NOD_CD,
    	SUBSTR(A.VIA_NOD_CD, 1, 5) VIA_LOC_VALUE,
	    SUBSTR(A.VIA_NOD_CD, 6, 2) VIA_YARD_VALUE,
    	A.TO_NOD_CD,
    	SUBSTR(A.TO_NOD_CD, 1, 5) TO_LOC_VALUE,
	    SUBSTR(A.TO_NOD_CD, 6, 2) TO_YARD_VALUE,
	    A.DOR_NOD_CD,
	    SUBSTR(A.DOR_NOD_CD, 1, 5) DR_LOC_VALUE,
	    SUBSTR(A.DOR_NOD_CD, 6, 2) DR_YARD_VALUE,
	    A.ACT_CUST_CNT_CD||A.ACT_CUST_SEQ ACT_CUST_CNT_CD,
	    A.DOR_DE_ADDR,
	    A.VNDR_SEQ,
	    B.VNDR_ABBR_NM,
	    A.CURR_CD,
	    A.BZC_AMT,
	    A.NEGO_AMT,
	    A.FUEL_SCG_AMT,
		A.TOLL_FEE_AMT,
	    A.ETC_ADD_AMT,
	    A.REF_BKG_NO,
	    A.REF_BL_NO,
	    A.TRSP_PURP_RSN,
	    A.TRSP_SO_OFC_CTY_CD,
	    A.TRSP_SO_SEQ,
	    A.TRSP_SO_TP_CD,
	    A.TRSP_SO_STS_CD,
	    A.EQ_KND_CD,
	    A.CGO_TP_CD,
	    A.TRSP_COST_DTL_MOD_CD,
	    A.TRSP_CRR_MOD_CD,
	    A.TRSP_OTR_COST_MON_DT,     
	    A.CRE_OFC_CD,
	    TO_CHAR(A.LOCL_CRE_DT, 'YYYYMMDD') CRE_DT,
	    A.CRE_USR_ID,
	    TO_CHAR(A.LOCL_UPD_DT, 'YYYYMMDD') UPD_DT,
	    A.UPD_USR_ID,
	    A.TTL_DIST,
	    A.LNK_DIST_DIV_CD,
		A.TRSP_WO_OFC_CTY_CD || TRSP_WO_SEQ WO_NO,
		TRS_COMMON_PKG.GET_PRD_DISTANCE_FNC (A.FM_NOD_CD, A.TO_NOD_CD, A.VIA_NOD_CD, A.DOR_NOD_CD, A.TRSP_BND_CD, A.TRSP_COST_DTL_MOD_CD, A.TRSP_CRR_MOD_CD) PRD_DIST, A.NEGO_RMK
	FROM TRS_TRSP_SVC_ORD A,
	    MDM_VENDOR B
	WHERE A.VNDR_SEQ = B.VNDR_SEQ(+)
    AND A.TRSP_SO_STS_CD IN ('C','R') 

   	#if(${fmdate} != '')
       	AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[fmdate]||'000000','YYYYMMDDHH24MISS') AND TO_DATE(@[todate]||'235959','YYYYMMDDHH24MISS')  
    #end

  	#if(${trs_cost_md_cd} != '')
    	AND A.TRSP_COST_DTL_MOD_CD = @[trs_cost_md_cd]
	#end    

  	#if(${trs_md_cd} != '')
		AND A.TRSP_CRR_MOD_CD = @[trs_md_cd]
	#end    

  	#if(${trsp_so_fm_node} != '')
    	AND A.FM_NOD_CD = @[trsp_so_fm_node]
	#end    

  	#if(${trsp_so_to_node} != '')
    	AND A.TO_NOD_CD = @[trsp_so_to_node]
	#end    

    #if($eqnumberArr.size() > 0)
  	   	AND A.EQ_NO IN (
	   		#foreach( ${key} in ${eqnumberArr}) 
	      		#if($velocityCount == 1)
 		    		'${key}'	
	      		#else 
 		    		, '${key}'	
	      		#end 
	   		#end 
	   	)
    #end    

   	#if(${trsp_so_tp_cd} != '')
   		AND A.TRSP_SO_TP_CD = @[trsp_so_tp_cd]
	#end    

    AND A.DELT_FLG <> 'Y'
    AND A.CRE_OFC_CD = @[cre_ofc_cd]
    --/* 2008.04.29 ETS OPEN */
    AND A.HJL_NO IS NULL
	) X
ORDER BY X.EQ_NO			]]></sql>
			<params>
				<param name="fmdate" type="12" value="" out="N"/>
				<param name="todate" type="12" value="" out="N"/>
				<param name="trs_cost_md_cd" type="12" value="" out="N"/>
				<param name="trs_md_cd" type="12" value="" out="N"/>
				<param name="trsp_so_fm_node" type="12" value="" out="N"/>
				<param name="trsp_so_to_node" type="12" value="" out="N"/>
				<param name="trsp_so_tp_cd" type="12" value="" out="N"/>
				<param name="cre_ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
