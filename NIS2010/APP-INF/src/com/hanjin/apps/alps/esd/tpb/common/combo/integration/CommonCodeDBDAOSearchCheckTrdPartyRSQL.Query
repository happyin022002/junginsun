<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CommonCodeDBDAOSearchCheckTrdPartyRSQL">
			<desc><![CDATA[SearchCheckTrdParty]]></desc>
			<sql><![CDATA[
#if (${s_vndr_cust_div_cd} == 'V')
    -- Vendor
    SELECT 'V|$|'|| LPAD(VNDR_SEQ,6,'0') ||'|$|'|| VNDR_CNT_CD ||'|$|'|| REPLACE(VNDR_LGL_ENG_NM,'\"','\\\"') ||'|$|'|| DELT_FLG AS VAL,
           NULL
      FROM MDM_VENDOR
     WHERE 1=1
       AND VNDR_SEQ = TO_NUMBER(@[s_trd_party_val])
       AND DELT_FLG = 'N'
       AND RFND_PSDO_CUST_CD IS NOT NULL
       AND ROWNUM = 1
#elseif (${s_vndr_cust_div_cd} == 'C')
    -- Customer
    SELECT 'C|$|'|| LPAD(CUST_SEQ,6,'0') ||'|$|'|| CUST_CNT_CD ||'|$|'|| REPLACE(CUST_LGL_ENG_NM,'\"','\\\"') ||'|$|'|| DELT_FLG AS VAL,
           NULL
      FROM MDM_CUSTOMER
     WHERE 1=1
       AND (NMD_CUST_FLG IS NULL OR NMD_CUST_FLG != 'Y')
       AND CUST_CNT_CD = SUBSTRB(TRIM(@[s_trd_party_val]),1,2)
       AND CUST_SEQ = TO_NUMBER(SUBSTRB(TRIM(@[s_trd_party_val]),3))
       AND CNTR_DIV_FLG = 'Y'
       AND DELT_FLG = 'N'
       AND ROWNUM = 1
#elseif (${s_vndr_cust_div_cd} == 'S')
    -- Staff
    SELECT 'S|$||$|' || M.OFC_CD || '|$|'|| REPLACE(M.OFC_ENG_NM,'\"','\\\"') ||'|$|'|| M.DELT_FLG AS VAL,
           NULL
      FROM MDM_ORGANIZATION M,
           TPB_HNDL_OFC H
     WHERE 1=1
       AND M.OFC_CD = @[s_trd_party_val]
       AND M.DELT_FLG = 'N'
       AND H.DELT_FLG = 'N'
       AND M.OFC_CD = H.OFC_CD
       AND ROWNUM = 1
#else
-- ELSE
    SELECT NULL, NULL
      FROM DUAL
     WHERE 1=0
#end			]]></sql>
			<params>
				<param name="s_trd_party_val" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
