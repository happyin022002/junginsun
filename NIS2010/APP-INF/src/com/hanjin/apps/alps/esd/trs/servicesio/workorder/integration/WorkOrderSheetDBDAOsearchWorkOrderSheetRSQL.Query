<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WorkOrderSheetDBDAOsearchWorkOrderSheetRSQL">
			<desc><![CDATA[search Work Order Sheet]]></desc>
			<sql><![CDATA[
SELECT DISTINCT
       WO.WO_VNDR_SEQ                             AS VNDR_CODE,
       VD.VNDR_LGL_ENG_NM                         AS Full_Name,
       VD.ENG_ADDR                                AS ENG_ADDR,
       VD_CNTC.PHN_NO                             AS PHN_NO,
       VD_CNTC.FAX_NO                             AS FAX_NO,
       VD.CNTC_PSON_NM                            AS CNTC_PSON_NM,
       SO.TRSP_BND_CD                             AS TRSP_BND_CD,
       SO.TRSP_COST_DTL_MOD_CD                    AS TRSP_COST_DTL_MOD_CD,
       (select	intg_cd_val_dp_desc	from com_intg_cd_dtl  where	intg_cd_id = 'CD00283' and	intg_cd_val_ctnt = SO.TRSP_CRR_MOD_CD)     AS TRSP_CRR_MOD_NM,
       (select	intg_cd_val_dp_desc	from com_intg_cd_dtl  where	intg_cd_id = 'CD00744' and	intg_cd_val_ctnt = SO.TRSP_COST_DTL_MOD_CD)     AS TRSP_COST_DTL_MOD_NM,
       NVL(WO.TRSP_WO_OFC_CTY_CD,'')||NVL(WO.TRSP_WO_SEQ,'')                  											AS TRSP_WO_CD,
       DECODE (WO.WO_ISS_STS_CD, 'I','Issue','R', 'Reissue','C','Correction','N','Cancellation')    AS WO_ISS_STS_CD,
       FROM_YARD.YD_CD                            AS FM_CD,
       FROM_YARD.YD_NM                            AS FM_NM,
       FROM_YARD.YD_ADDR                          AS FM_ADDR,
       FROM_YARD.PHN_NO                           AS FM_PHN_NO,
       FROM_YARD.FAX_NO                           AS FM_FAX_NO,
       FROM_YARD.YD_PIC_NM                        AS FM_PIC_NM,
       TO_YARD.YD_CD                              AS TO_CD,
       TO_YARD.YD_NM                              AS TO_NM,
       TO_YARD.YD_ADDR                            AS TO_ADDR,
       TO_YARD.PHN_NO                             AS TO_PHN_NO,
       TO_YARD.FAX_NO                             AS TO_FAX_NO,
       TO_YARD.YD_PIC_NM                          AS TO_PIC_NM,
       VIA_YARD.YD_CD                             AS VIA_CD,
       VIA_YARD.YD_NM                             AS VIA_NM,
       VIA_YARD.YD_ADDR                           AS VIA_ADDR,
       VIA_YARD.PHN_NO                            AS VIA_PHN_NO,
       VIA_YARD.FAX_NO                            AS VIA_FAX_NO,
       VIA_YARD.YD_PIC_NM                         AS VIA_PIC_NM,
       SO.DOR_NOD_CD                              AS DR_CD,
       SO.DOR_DE_ADDR                             AS DR_ADDR,
       SO.FCTRY_NM                                AS DR_NM,
       SO.CNTC_PSON_PHN_NO                        AS DR_PHN_NO,
       SO.CNTC_PSON_FAX_NO                        AS DR_FAX_NO,
       SO.CNTC_PSON_NM                            AS DR_PIC_NM,
       WO.WO_RMK                                  AS Instruction,
       IB_VVD.VSL_ENG_NM ||' '||SUBSTR(SO.IB_VVD_CD,5,6) AS IB_VVD_CD,
       OB_VVD.VSL_ENG_NM ||' '||SUBSTR(SO.OB_VVD_CD,5,6) AS OB_VVD_CD,
       SO.FDR_VSL_CD||SO.FDR_SKD_VOY_NO||SO.FDR_SKD_DIR_CD AS Feeder_VVD,
       ORG.OFC_ADDR                               AS OFC_ADDR,
       ORG.OFC_PHN_NO                             AS OFC_PHN_NO,
       ORG.OFC_FAX_NO                             AS OFC_FAX_NO,
       USR.USR_NM                                 AS PIC,
       TO_CHAR(WO.LOCL_CRE_DT,'YYYY-MM-DD HH24:MI')  AS WO_ISS_AT,
	   NVL(to_char(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(WO.CRE_OFC_CD),'YYYY-MM-DD HH24:MI'),to_char(sysdate,'YYYY-MM-DD HH24:MI'))  as print_at,
       (SELECT LC.CONTI_CD AS MAE_FLG FROM MDM_LOCATION LC WHERE SUBSTR(SO.FM_NOD_CD,1,5) = LC.LOC_CD) AS MAE_FLG,
       WO.CRE_OFC_CD                              AS CRE_OFC_CD,
       WO.CRE_USR_ID                              AS CRE_USR_ID
FROM
      TRS_TRSP_SVC_ORD                            SO,
      MDM_VENDOR                                  VD,
      MDM_VNDR_CNTC_PNT                           VD_CNTC,
      MDM_YARD                                    FROM_YARD,
      MDM_YARD                                    TO_YARD,
      MDM_YARD                                    VIA_YARD,
      MDM_ORGANIZATION                            ORG,
      COM_USER                                    USR,
      TRS_TRSP_WRK_ORD                            WO,
      MDM_VSL_CNTR                                IB_VVD,
      MDM_VSL_CNTR                                OB_VVD
WHERE WO.TRSP_WO_OFC_CTY_CD                   = SO.TRSP_WO_OFC_CTY_CD
  AND WO.TRSP_WO_SEQ                          = SO.TRSP_WO_SEQ
  AND WO.CRE_OFC_CD                           = ORG.OFC_CD
  AND WO.WO_VNDR_SEQ                          = VD.VNDR_SEQ(+)
  AND VD.VNDR_SEQ                             = VD_CNTC.VNDR_SEQ(+)
  AND VD_CNTC.PRMRY_CHK_FLG (+)               = 'Y'
  AND VD_CNTC.PHN_NO (+)                      IS NOT NULL
  AND VD.DELT_FLG                             = 'N'
  AND VD_CNTC.DELT_FLG (+)                    = 'N'
  AND SO.FM_NOD_CD                            = FROM_YARD.YD_CD(+)
  AND SO.TO_NOD_CD                            = TO_YARD.YD_CD(+)
  AND SO.VIA_NOD_CD                           = VIA_YARD.YD_CD(+)
  AND WO.CRE_USR_ID                           = USR.USR_ID
  AND SUBSTR(SO.IB_VVD_CD,0,4) 				  = IB_VVD.VSL_CD(+)
  AND SUBSTR(SO.OB_VVD_CD,0,4) 				  = OB_VVD.VSL_CD(+)
#if (${wo_vndr_seq} != '')
	and   WO.wo_vndr_seq  =  @[wo_vndr_seq]
#end
#if ($trsp_wo_ofc_cty_cd.size() > 0) 
    AND (wo.trsp_wo_ofc_cty_cd,wo.trsp_wo_seq) in (
	#foreach($wonoKey in ${trsp_wo_ofc_cty_cd}) 
		#if($velocityCount < $trsp_wo_ofc_cty_cd.size()) 
			(substr('$wonoKey',0,3),to_number(substr('$wonoKey',4,length('$wonoKey')))),
		#else 
			(substr('$wonoKey',0,3),to_number(substr('$wonoKey',4,length('$wonoKey'))))
		#end 
	#end 
  )
#end			]]></sql>
			<params>
				<param name="wo_vndr_seq" type="2" value="105292" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
