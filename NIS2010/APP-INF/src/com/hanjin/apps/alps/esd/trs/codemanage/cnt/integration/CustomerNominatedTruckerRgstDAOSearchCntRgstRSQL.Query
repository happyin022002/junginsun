<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CustomerNominatedTruckerRgstDAOSearchCntRgstRSQL">
			<desc><![CDATA[2014_06_11 생성]]></desc>
			<sql><![CDATA[
SELECT A.PRC_CTRT_TP_CD
      ,A.PRC_CTRT_NO
      ,A.SLS_OFC_CD
      ,A.CTRT_CUST_SREP_CD 
      ,(SELECT X.SREP_NM FROM MDM_SLS_REP X WHERE X.SREP_CD = A.CTRT_CUST_SREP_CD) AS CTRT_CUST_SREP_NM
      ,A.CTRT_CUST_CNT_CD
	  ,CTRT_CUST_CNT_CD || LPAD(CTRT_CUST_SEQ, 6, 0) AS CTRT_CUST_CD
      ,A.CTRT_CUST_SEQ
      ,(SELECT X.CUST_LGL_ENG_NM FROM MDM_CUSTOMER X WHERE X.CUST_CNT_CD = A.CTRT_CUST_CNT_CD AND X.CUST_SEQ = A.CTRT_CUST_SEQ) CTRT_CUST_NM      
      ,A.CTRT_EFF_DT
      ,A.CTRT_EXP_DT
      ,A.FNL_MQC_DESC
      ,LPAD(A.VNDR_SEQ, 6, '0') AS VNDR_SEQ
      ,(SELECT X.VNDR_LGL_ENG_NM FROM MDM_VENDOR X WHERE X.VNDR_SEQ = A.VNDR_SEQ) VNDR_NM
      ,(SELECT X.USA_EDI_CD FROM MDM_VENDOR X WHERE X.VNDR_SEQ = A.VNDR_SEQ) USA_EDI_CD      
      ,A.IO_BND_CD
      ,SUBSTR(A.ORG_NOD_CD,1,5)  AS ORG_NOD_CD
      ,SUBSTR(A.ORG_NOD_CD,6)    AS ORG_NOD_YARD
      ,SUBSTR(A.ORG_NOD_CD,6)    AS ORG_NOD_YARD2
      ,SUBSTR(A.DEST_NOD_CD,1,5) AS DEST_NOD_CD
      ,SUBSTR(A.DEST_NOD_CD,6)   AS DEST_NOD_YARD
      ,SUBSTR(A.DEST_NOD_CD,6)   AS DEST_NOD_YARD2
      ,MTY_PKUP_RTN_YD_CD      
      ,(SELECT X.YD_NM
          FROM MDM_YARD X
         WHERE YD_CD = A.MTY_PKUP_RTN_YD_CD)
     ||(SELECT X.LSE_CO_YD_NM
          FROM MDM_LSE_CO_YD X
         WHERE LSE_CO_YD_CD = A.MTY_PKUP_RTN_YD_CD) AS MTY_PKUP_RTN_YD_NM
      ,A.CNTR_TPSZ_CD
      ,A.CUST_NOMI_TRKR_BZC_AMT
      ,A.CUST_NOMI_TRKR_FUEL_DIV_CD
      ,A.CUST_NOMI_TRKR_FUEL_RTO
      ,A.CUST_NOMI_TRKR_FUEL_AMT
      ,A.COST_DESC
      ,A.DISP_STS_CD
      ,TO_CHAR(A.CUST_NOMI_TRKR_SAV_DT, 'YYYYMMDD')  AS CUST_NOMI_TRKR_SAV_DT
      ,TO_CHAR(A.CUST_NOMI_TRKR_RQST_DT, 'YYYYMMDD') AS CUST_NOMI_TRKR_RQST_DT
      ,TO_CHAR(A.CUST_NOMI_TRKR_RJCT_DT, 'YYYYMMDD') AS CUST_NOMI_TRKR_RJCT_DT
      ,TO_CHAR(A.CUST_NOMI_TRKR_APRO_DT, 'YYYYMMDD') AS CUST_NOMI_TRKR_APRO_DT
      ,A.RGST_USR_ID
      ,(SELECT X.USR_NM FROM COM_USER X WHERE X.USR_ID = A.RGST_USR_ID) RGST_USR_NM
      , APRO_NO
      
  FROM TRS_CUST_NOMI_TRKR A
 WHERE 1=1
#if (${s_fm_dt} != '')
    #if (${s_to_dt} != '')
   -- Saved Date로 조회시
		#if (${s_dt_div_cd} == '00')
   AND A.CUST_NOMI_TRKR_SAV_DT  BETWEEN TO_DATE(@[s_fm_dt], 'YYYYMMDD') AND TO_DATE(@[s_to_dt], 'YYYYMMDD')+0.99999
		#end
   -- Requested Date로 조회시
		#if (${s_dt_div_cd} == '01')
   AND A.CUST_NOMI_TRKR_RQST_DT BETWEEN TO_DATE(@[s_fm_dt], 'YYYYMMDD') AND TO_DATE(@[s_to_dt], 'YYYYMMDD')+0.99999
		#end
   -- Rejected Date로 조회시
		#if (${s_dt_div_cd} == '02')
   AND A.CUST_NOMI_TRKR_RJCT_DT BETWEEN TO_DATE(@[s_fm_dt], 'YYYYMMDD') AND TO_DATE(@[s_to_dt], 'YYYYMMDD')+0.99999
		#end
   -- Approved Date로 조회시
		#if (${s_dt_div_cd} == '03')
   AND A.CUST_NOMI_TRKR_APRO_DT BETWEEN TO_DATE(@[s_fm_dt], 'YYYYMMDD') AND TO_DATE(@[s_to_dt], 'YYYYMMDD')+0.99999
		#end
    #end
#end

   -- Effective Date로 조회시
#if (${s_eff_dt} != '')
   AND TO_DATE(@[s_eff_dt], 'YYYYMMDD') BETWEEN A.CTRT_EFF_DT AND A.CTRT_EXP_DT   
#end

   -- Contract No로 조회시
#if (${s_ctrt_no} != '')
   AND A.PRC_CTRT_NO = @[s_ctrt_no]
#end
   
-- Status로 조회시 (MULTI 리스트로 파라메터 받아 loop문에서 처리)
#if ($s_disp_sts_cd.size() > 0)
      AND A.DISP_STS_CD IN (
	#foreach($key in ${s_disp_sts_cd}) 
		#if($velocityCount < $s_disp_sts_cd.size()) 
			'$key', 
		#else 
			'$key' 
		#end 
	#end
	)
#end

   -- Customer로 조회시
#if (${s_cust_seq} != '')
   AND (A.CTRT_CUST_CNT_CD, A.CTRT_CUST_SEQ) = ( ( SUBSTR(@[s_cust_seq],1,2), SUBSTR(@[s_cust_seq],3))  )
#end
   
   -- Trucker로 조회시
#if (${s_vndr_seq} != '')
   AND A.VNDR_SEQ = @[s_vndr_seq]
#end

#if (${s_dest_nod_cd} != '')
   AND SUBSTR(DECODE(A.IO_BND_CD, 'I', A.DEST_NOD_CD, 'O', A.ORG_NOD_CD), 1, 5) = @[s_dest_nod_cd]
#end			]]></sql>
			<params>
				<param name="s_fm_dt" type="12" value="" out="N"/>
				<param name="s_to_dt" type="12" value="" out="N"/>
				<param name="s_eff_dt" type="12" value="" out="N"/>
				<param name="s_ctrt_no" type="12" value="" out="N"/>
				<param name="s_cust_seq" type="12" value="" out="N"/>
				<param name="s_vndr_seq" type="12" value="" out="N"/>
				<param name="s_dest_nod_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
