<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TerminalAgreementManageDBDAOSearchTerminalAgreementDetailRSQL">
			<desc><![CDATA[Terminal Rate List Detail Select]]></desc>
			<sql><![CDATA[
SELECT	A.LGS_COST_CD
		, NVL((SELECT LGS_COST_ABBR_NM FROM TES_LGS_COST T WHERE T.LGS_COST_CD = A.LGS_COST_CD), '') AS LGS_COST_ABBR_NM
		, a.auto_calc_flg
		, a.tml_agmt_vol_ut_cd
		, a.curr_cd
		, a.thrp_lgs_cost_cd
		, a.ioc_cd
		, a.io_bnd_cd
		, a.tml_trns_mod_cd
		, b.wkdy_flg
		, b.sat_flg
		, b.sun_flg
		, b.hol_flg
		, a.lane_cd
		, DECODE(a.DCGO_APLY_TP_CD,'N','Y') dg_none
		, CASE  WHEN a.dcgo_aply_tp_cd = 'A' THEN  
				CASE  WHEN c.dcgo_non_clss_flg = 'Y' THEN 'Y'	END  
		END AS same_dg_none
		, CASE WHEN a.dcgo_aply_tp_cd = 'A' THEN  
			CASE WHEN c.dcgo_sam_clss_flg = 'Y' THEN 'Y' END 
		END AS same_dg
		, CASE WHEN a.dcgo_aply_tp_cd = 'S' THEN  
			CASE WHEN c.dcgo_non_clss_flg = 'Y' THEN 'Y' END 
		END AS sep_dg_none
		, c.dcgo_n1st_clss_flg
		, c.dcgo_n2nd_clss_flg
		, c.dcgo_n3rd_clss_flg
		, c.dcgo_n4th_clss_flg
		, c.dcgo_n5th_clss_flg
		, c.dcgo_n6th_clss_flg
		, c.dcgo_n7th_clss_flg
		, c.dcgo_n8th_clss_flg
		, c.dcgo_n9th_clss_flg
		, a.tml_ovt_shft_cd
		, a.thc_tp_cd
		, a.fm_tr_vol_val, a.to_tr_vol_val
		, d.D2, d.D4, d.D5, d.D7, d.D8, d.D9, d.DW, d.DX
		, d.R2, d.R4, d.R5, d.R7, d.R8, d.R9 
		, d.F2, d.F4 
		, d.O2, d.O4, d.O5, d.O7 
		, d.S2, d.S4 
		, d.T2, d.T4 
		, d.A2, d.A4, d.A5 
		, d.P2, d.P4 
        , d.C2, d.C4
		, d.F5 
		, DECODE(a.tml_agmt_vol_ut_cd,'T',a.agmt_ut_rt,'0') teu_rate 
		-- // CHM-201539086 AgreementInvoice(4종류Invoice모두) 에서 기존 U를 B로 일괄 변경 & CHM-201539507 UOM에 Metric Ton추가 (W)(CAH D - 2016-01-11)
		, DECODE(a.tml_agmt_vol_ut_cd,'B',a.agmt_ut_rt,'0') box_rate
		, DECODE(a.tml_agmt_vol_ut_cd,'M',a.agmt_ut_rt,'0') move_rate 
		, DECODE(a.tml_agmt_vol_ut_cd,'G',a.agmt_ut_rt,'0') gang_hour_rate 
		, DECODE(a.tml_agmt_vol_ut_cd,'W',a.agmt_ut_rt,'0') ton_rate 
		, '#'||d.D2||'#'||d.D4||'#'||d.D5||'#'||d.D7||'#'||d.D8||'#'||d.D9||'#'||d.DW||'#'||d.DX||'#'||d.R2||'#'||d.R4||'#'||d.R5||'#'||d.R7||'#'||d.R8||'#'||d.R9||'#'|| 
		d.F2||'#'||d.F4||'#'||d.F5||'#'||d.O2||'#'||d.O4||'#'||d.O5||'#'||d.O7||'#'||d.S2||'#'||d.S4||'#'||d.T2||'#'||d.T4||'#'||d.A2||'#'||d.A4||'#'||d.A5||'#'||d.P2||'#'||d.P4||'#'||d.C2||'#'||d.C4 	TS_RT
		, a.tml_agmt_dtl_seq 
		, a.agmt_dtl_rmk remark 
		, a.agmt_dtl_rmk 
		,(SELECT com_auto_calc_flg                          
				||'|'||tml_thrp_cost_cd_flg     																																																																																														
				||'|'||tml_io_bnd_flg           																																																																																														
				||'|'||tml_ioc_flg              																																																																																														
				||'|'||tml_aply_dt_flg          																																																																																														
				||'|'||tml_lane_flg             																																																																																														
				||'|'||tml_dcgo_aply_flg        																																																																																														
				||'|'||tml_tr_vol_flg           																																																																																														
				||'|'||tml_ovt_shft_flg         																																																																																														
				||'|'||tml_thc_flg              																																																																																														
				||'|'||sto_com_agmt_tp_flg      																																																																																														
				||'|'||sto_com_cmnc_tm_flg      																																																																																														
				||'|'||sto_free_dy_io_bnd_flg   																																																																																														
				||'|'||sto_free_dy_flg          																																																																																														
				||'|'||sto_free_dy_dcgo_tm_flg  																																																																																														
				||'|'||sto_free_dy_xcld_dt_flg  																																																																																																														
				||'|'||sto_free_dy_dcgo_rt_flg             																																																																																																														
				||'|'||sto_free_dy_tr_dy_flg               																																																																																																														
				||'|'||sto_fp_calc_prd_flg                 																																																																																																														
				||'|'||sto_fp_teu_flg                      																																																																																																														
				||'|'||rt_cntr_tpsz_flg                    																																																																																																														
				||'|'||rt_teu_flg                          																																																																																																														
				||'|'||rt_bx_flg                           																																																																																																														
				||'|'||rt_mv_flg                           																																																																																																														
				||'|'||free_dy_cntr_tpsz_flg  vrfy_string  																																																																																																														
		FROM	TES_TML_AGMT_VRFY_MZD                        
		WHERE lgs_cost_cd = a.lgs_cost_cd ) vrfyFlg				
FROM	TES_TML_AGMT_DTL A, TES_TML_AGMT_APLY_DY B, TES_TML_AGMT_DG_CGO_CLSS C, 
		(SELECT TML_AGMT_OFC_CTY_CD,TML_AGMT_SEQ, TML_AGMT_VER_NO, TML_AGMT_DTL_SEQ, CNTR_APLY_TP_CD, LGS_COST_CD, 
				DECODE(LGS_COST_CD,'TMXXDC',SUM(D2),MAX(D2)) D2,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(D4),MAX(D4)) D4,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(D5),MAX(D5)) D5,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(D7),MAX(D7)) D7,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(D8),MAX(D8)) D8,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(D9),MAX(D9)) D9, 
				DECODE(LGS_COST_CD,'TMXXDC',SUM(DW),MAX(DW)) DW, 
				DECODE(LGS_COST_CD,'TMXXDC',SUM(DX),MAX(DX)) DX, 
				DECODE(LGS_COST_CD,'TMXXDC',SUM(R2),MAX(R2)) R2,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(R4),MAX(R4)) R4,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(R5),MAX(R5)) R5,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(R7),MAX(R7)) R7,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(R8),MAX(R8)) R8,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(R9),MAX(R9)) R9, 
				DECODE(LGS_COST_CD,'TMXXDC',SUM(F2),MAX(F2)) F2,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(F4),MAX(F4)) F4, 
				DECODE(LGS_COST_CD,'TMXXDC',SUM(O2),MAX(O2)) O2,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(O4),MAX(O4)) O4,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(O5),MAX(O5)) O5, 
				DECODE(LGS_COST_CD,'TMXXDC',SUM(O7),MAX(O7)) O7,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(S2),MAX(S2)) S2,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(S4),MAX(S4)) S4, 
				DECODE(LGS_COST_CD,'TMXXDC',SUM(T2),MAX(T2)) T2,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(T4),MAX(T4)) T4, 
				DECODE(LGS_COST_CD,'TMXXDC',SUM(A2),MAX(A2)) A2,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(A4),MAX(A4)) A4, 
				DECODE(LGS_COST_CD,'TMXXDC',SUM(A5),MAX(A5)) A5,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(P2),MAX(P2)) P2,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(P4),MAX(P4)) P4,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(C2),MAX(C2)) C2,
				DECODE(LGS_COST_CD,'TMXXDC',SUM(C4),MAX(C4)) C4,  
				DECODE(LGS_COST_CD,'TMXXDC',SUM(F5),MAX(F5)) F5 
		FROM  ( SELECT	A.TML_AGMT_OFC_CTY_CD, A.TML_AGMT_SEQ, A.TML_AGMT_VER_NO, A.TML_AGMT_DTL_SEQ, B.CNTR_APLY_TP_CD, A.LGS_COST_CD,
						DECODE(B.CNTR_TPSZ_CD,'D2',AGMT_RT,0) D2, 
						DECODE(B.CNTR_TPSZ_CD,'D4',AGMT_RT,0) D4, 
						DECODE(B.CNTR_TPSZ_CD,'D5',AGMT_RT,0) D5, 
						DECODE(B.CNTR_TPSZ_CD,'D7',AGMT_RT,0) D7, 
						DECODE(B.CNTR_TPSZ_CD,'D8',AGMT_RT,0) D8, 
						DECODE(B.CNTR_TPSZ_CD,'D9',AGMT_RT,0) D9, 
						DECODE(B.CNTR_TPSZ_CD,'DW',AGMT_RT,0) DW, 
						DECODE(B.CNTR_TPSZ_CD,'DX',AGMT_RT,0) DX, 
						DECODE(B.CNTR_TPSZ_CD,'R2',AGMT_RT,0) R2, 
						DECODE(B.CNTR_TPSZ_CD,'R4',AGMT_RT,0) R4, 
						DECODE(B.CNTR_TPSZ_CD,'R5',AGMT_RT,0) R5, 
						DECODE(B.CNTR_TPSZ_CD,'R7',AGMT_RT,0) R7, 
						DECODE(B.CNTR_TPSZ_CD,'R8',AGMT_RT,0) R8, 
						DECODE(B.CNTR_TPSZ_CD,'R9',AGMT_RT,0) R9,
						DECODE(B.CNTR_TPSZ_CD,'F2',AGMT_RT,0) F2, 
						DECODE(B.CNTR_TPSZ_CD,'F4',AGMT_RT,0) F4, 
						DECODE(B.CNTR_TPSZ_CD,'O2',AGMT_RT,0) O2, 
						DECODE(B.CNTR_TPSZ_CD,'O4',AGMT_RT,0) O4, 
						DECODE(B.CNTR_TPSZ_CD,'O5',AGMT_RT,0) O5,
						DECODE(B.CNTR_TPSZ_CD,'O7',AGMT_RT,0) O7,
						DECODE(B.CNTR_TPSZ_CD,'S2',AGMT_RT,0) S2, 
						DECODE(B.CNTR_TPSZ_CD,'S4',AGMT_RT,0) S4, 
						DECODE(B.CNTR_TPSZ_CD,'T2',AGMT_RT,0) T2, 
						DECODE(B.CNTR_TPSZ_CD,'T4',AGMT_RT,0) T4, 
						DECODE(B.CNTR_TPSZ_CD,'A2',AGMT_RT,0) A2, 
						DECODE(B.CNTR_TPSZ_CD,'A4',AGMT_RT,0) A4, 
						DECODE(B.CNTR_TPSZ_CD,'A5',AGMT_RT,0) A5,
						DECODE(B.CNTR_TPSZ_CD,'P2',AGMT_RT,0) P2, 
						DECODE(B.CNTR_TPSZ_CD,'P4',AGMT_RT,0) P4,
						DECODE(B.CNTR_TPSZ_CD,'C2',AGMT_RT,0) C2, 
						DECODE(B.CNTR_TPSZ_CD,'C4',AGMT_RT,0) C4, 
						DECODE(B.CNTR_TPSZ_CD,'F5',AGMT_RT,0) F5  
				FROM	TES_TML_AGMT_DTL A, TES_TML_AGMT_TP_SZ B  
				WHERE	A.TML_AGMT_OFC_CTY_CD = B.TML_AGMT_OFC_CTY_CD 
				AND		A.TML_AGMT_SEQ = B.TML_AGMT_SEQ 
				AND		A.TML_AGMT_VER_NO = B.TML_AGMT_VER_NO 
				AND		A.TML_AGMT_DTL_SEQ = B.TML_AGMT_DTL_SEQ ) 
		GROUP BY TML_AGMT_OFC_CTY_CD,TML_AGMT_SEQ, TML_AGMT_VER_NO, TML_AGMT_DTL_SEQ, CNTR_APLY_TP_CD,LGS_COST_CD) D  
WHERE	A.TML_AGMT_OFC_CTY_CD	= @[tml_agmt_ofc_cty_cd]
AND		A.TML_AGMT_SEQ			= @[tml_agmt_seq]
AND		A.TML_AGMT_VER_NO		= @[tml_agmt_ver_no]
AND		A.TML_AGMT_TP_CD = 'T'  
AND		A.TMP_SAV_FLG IS NULL
AND		A.TML_AGMT_OFC_CTY_CD = B.TML_AGMT_OFC_CTY_CD(+)  
AND		A.TML_AGMT_OFC_CTY_CD = C.TML_AGMT_OFC_CTY_CD(+)  
AND		A.TML_AGMT_OFC_CTY_CD = D.TML_AGMT_OFC_CTY_CD(+) 
AND		A.TML_AGMT_SEQ = B.TML_AGMT_SEQ(+) 
AND		A.TML_AGMT_SEQ = C.TML_AGMT_SEQ(+) 
AND		A.TML_AGMT_SEQ = D.TML_AGMT_SEQ(+) 
AND		A.TML_AGMT_VER_NO = B.TML_AGMT_VER_NO(+) 
AND		A.TML_AGMT_VER_NO = C.TML_AGMT_VER_NO(+) 
AND		A.TML_AGMT_VER_NO = D.TML_AGMT_VER_NO(+) 
AND		A.TML_AGMT_DTL_SEQ = B.TML_AGMT_DTL_SEQ(+) 
AND		A.TML_AGMT_DTL_SEQ = C.TML_AGMT_DTL_SEQ(+) 
AND		A.TML_AGMT_DTL_SEQ = D.TML_AGMT_DTL_SEQ(+) 
ORDER BY A.LGS_COST_CD DESC			]]></sql>
			<params>
				<param name="tml_agmt_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="tml_agmt_seq" type="2" value="" out="N"/>
				<param name="tml_agmt_ver_no" type="2" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
