<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="MnrAdvanceAuditDBDAOupdatePreAuditUSQL">
			<desc><![CDATA[MNR 자동심사 대상 CONFIRM 업데이트]]></desc>
			<sql><![CDATA[
MERGE INTO EAS_MNR_CFM_INV A
USING DUAL
   ON (A.INV_NO = @[inv_no] AND A.VNDR_SEQ = @[vndr_seq] AND A.EQ_KND_CD = @[eq_knd_cd])
 WHEN MATCHED THEN
        UPDATE SET A.UPD_USR_ID = @[upd_usr_id]
                 , A.UPD_DT = SYSDATE
				 , AUD_CURR_CD = @[inv_aud_curr_cd]
				 , AUD_DIFF_AMT = @[inv_aud_diff_amt]
				 , AUD_USD_DIFF_AMT = @[inv_aud_usd_diff_amt]
#if(${batch_tp_cd} == '')
                 , A.EXPN_AUD_STS_CD = DECODE(@[s_save_tp_cd], 'S', A.EXPN_AUD_STS_CD, @[expn_aud_sts_cd])
                 , A.AUTO_AUD_CFM_DT = DECODE(@[s_save_tp_cd], 'S', A.AUTO_AUD_CFM_DT, SYSDATE)
                 , A.AUTO_AUD_CFM_USR_ID = DECODE(@[s_save_tp_cd], 'S', A.AUTO_AUD_CFM_USR_ID, @[upd_usr_id])
                 , A.LOCL_CRE_DT = GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd])
                 , A.CRE_OFC_CD = DECODE(A.CRE_OFC_CD, NULL, @[cre_ofc_cd], A.CRE_OFC_CD)
                 , A.EXPN_AUD_RSLT_RMK = DECODE(@[s_save_tp_cd], 'S', @[expn_aud_rslt_rmk], A.EXPN_AUD_RSLT_RMK)
                 , A.EXPN_AUD_RSLT_USR_ID = DECODE(@[s_save_tp_cd], 'S', @[upd_usr_id], A.EXPN_AUD_RSLT_USR_ID)
                 , A.ATCH_FILE_LNK_ID = @[atch_file_lnk_id]
                 , A.EXPN_AUD_RSLT_CD = DECODE(@[s_save_tp_cd], 'S',@[expn_aud_rslt_cd], EXPN_AUD_RSLT_CD)
#end
#if(${batch_tp_cd} != '') -- 배치 프로그램 수행시에만 실행
                 , RHQ_CD = @[rhq_cd]
                 , INV_OFC_CD = @[inv_ofc_cd]
                 , INV_CFM_DT = TO_DATE(@[inv_cfm_dt],'YYYYMMDDHH24MISS')
                 , AUTO_EXPN_AUD_STS_CD = @[auto_expn_aud_sts_cd]
                 , CURR_CD = @[curr_cd]
                 , WO_AMT = @[wo_amt]
                 , INV_AMT = @[inv_amt]
                 , CURR_CNG_FLG = @[curr_cng_flg]
                 , INV_DIFF_AMT = @[inv_diff_amt]
                 , INV_DIFF_RTO = @[inv_diff_rto]
                 , INV_CHG_AMT = @[inv_chg_amt]
                 , WO_VRFY_FLG = @[wo_vrfy_flg]
                 , ESTM_VRFY_FLG = @[estm_vrfy_flg]
                 , ESTM_VRFY_DESC = @[estm_vrfy_desc]
                 , WO_VRFY_DESC = @[wo_vrfy_desc]
                 , INV_RGST_NO = @[inv_rgst_no]
                 , INV_CURR_CD = @[inv_curr_cd]
                 , EXPN_MAX_PRMT_RTO = @[expn_max_prmt_rto]
                 , MLT_WO_CURR_FLG = @[mlt_wo_curr_flg]
#end
 WHEN NOT MATCHED THEN
        INSERT (
              INV_NO
            , VNDR_SEQ
            , EQ_KND_CD
            , EXPN_AUD_STS_CD
            , CRE_USR_ID
            , CRE_DT
            , UPD_USR_ID
            , UPD_DT
#if(${batch_tp_cd} != '') -- 배치 프로그램 수행시에만 실행
            , RHQ_CD
            , INV_OFC_CD
            , INV_CFM_DT
            , AUTO_EXPN_AUD_STS_CD
            , CURR_CD
            , WO_AMT
            , INV_AMT
            , CURR_CNG_FLG
            , INV_DIFF_AMT
            , INV_DIFF_RTO
            , INV_CHG_AMT
            , WO_VRFY_FLG
            , ESTM_VRFY_FLG
            , ESTM_VRFY_DESC
            , WO_VRFY_DESC
            , INV_RGST_NO
            , INV_CURR_CD
            , EXPN_MAX_PRMT_RTO
            , MLT_WO_CURR_FLG
#end
        )
        VALUES
        (
              @[inv_no]
            , @[vndr_seq]
            , @[eq_knd_cd]
            , DECODE(@[s_save_tp_cd], NULL, '', @[expn_aud_sts_cd])
            , @[upd_usr_id]
            , SYSDATE
            , @[upd_usr_id]
            , SYSDATE
#if(${batch_tp_cd} != '') -- 배치 프로그램 수행시에만 실행
            , @[rhq_cd]
            , @[inv_ofc_cd]
            , TO_DATE(@[inv_cfm_dt],'YYYYMMDDHH24MISS')
            , @[auto_expn_aud_sts_cd]
            , @[curr_cd]
            , @[wo_amt]
            , @[inv_amt]
            , @[curr_cng_flg]
            , @[inv_diff_amt]
            , @[inv_diff_rto]
            , @[inv_chg_amt]
            , @[wo_vrfy_flg]
            , @[estm_vrfy_flg]
            , @[estm_vrfy_desc]
            , @[wo_vrfy_desc]
            , @[inv_rgst_no]
            , @[inv_curr_cd]
            , @[expn_max_prmt_rto]
            , @[mlt_wo_curr_flg]
#end
        )			]]></sql>
			<params>
				<param name="inv_no" type="12" value="" out="N"/>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="eq_knd_cd" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="inv_aud_curr_cd" type="12" value="" out="N"/>
				<param name="inv_aud_diff_amt" type="12" value="" out="N"/>
				<param name="inv_aud_usd_diff_amt" type="12" value="" out="N"/>
				<param name="s_save_tp_cd" type="12" value="" out="N"/>
				<param name="expn_aud_sts_cd" type="12" value="" out="N"/>
				<param name="cre_ofc_cd" type="12" value="" out="N"/>
				<param name="expn_aud_rslt_rmk" type="12" value="" out="N"/>
				<param name="atch_file_lnk_id" type="12" value="" out="N"/>
				<param name="expn_aud_rslt_cd" type="12" value="" out="N"/>
				<param name="rhq_cd" type="12" value="" out="N"/>
				<param name="inv_ofc_cd" type="12" value="" out="N"/>
				<param name="inv_cfm_dt" type="12" value="" out="N"/>
				<param name="auto_expn_aud_sts_cd" type="12" value="" out="N"/>
				<param name="curr_cd" type="12" value="" out="N"/>
				<param name="wo_amt" type="12" value="" out="N"/>
				<param name="inv_amt" type="12" value="" out="N"/>
				<param name="curr_cng_flg" type="12" value="" out="N"/>
				<param name="inv_diff_amt" type="12" value="" out="N"/>
				<param name="inv_diff_rto" type="12" value="" out="N"/>
				<param name="inv_chg_amt" type="12" value="" out="N"/>
				<param name="wo_vrfy_flg" type="12" value="" out="N"/>
				<param name="estm_vrfy_flg" type="12" value="" out="N"/>
				<param name="estm_vrfy_desc" type="12" value="" out="N"/>
				<param name="wo_vrfy_desc" type="12" value="" out="N"/>
				<param name="inv_rgst_no" type="12" value="" out="N"/>
				<param name="inv_curr_cd" type="12" value="" out="N"/>
				<param name="expn_max_prmt_rto" type="12" value="" out="N"/>
				<param name="mlt_wo_curr_flg" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
