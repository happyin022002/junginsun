<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceEdiHitDBDAOSearchValidationInvEqEdiRSQL">
			<desc><![CDATA[TRS_INV_EDI_RCV_EQ Validation check]]></desc>
			<sql><![CDATA[
SELECT INV_EDI_RCV_SEQ
      ,INV_EDI_RCV_SUB_SEQ
      ,NVL(SUBSTR(INV_NO_CHK1||INV_NO_CHK2||SO_NO_CHK||WO_NO_CHK||CGO_TP_CHK||EQ_NO_CHK,2),'Y') VAL_CHK
   FROM ( SELECT A.INV_EDI_RCV_SEQ
                ,A.INV_EDI_RCV_SUB_SEQ
                ,CASE WHEN A.INV_NO IS NULL THEN ',INVALID INVOICE NUMBER' ELSE '' END AS INV_NO_CHK1
                ,CASE WHEN B.INV_NO IS NOT NULL THEN ',S/O('||A.TRSP_SO_OFC_CTY_CD || A.TRSP_SO_SEQ ||') INVOICE NUMBER DUPLICATION' ELSE '' END AS INV_NO_CHK2
                ,CASE WHEN A.TRSP_SO_OFC_CTY_CD || A.TRSP_SO_SEQ <> B.TRSP_SO_OFC_CTY_CD || B.TRSP_SO_SEQ THEN ',S/O('||A.TRSP_SO_OFC_CTY_CD || A.TRSP_SO_SEQ ||') NUMBER MISMATCH' ELSE '' END AS SO_NO_CHK
                ,CASE WHEN A.TRSP_WO_OFC_CTY_CD || A.TRSP_WO_SEQ <> B.TRSP_WO_OFC_CTY_CD || B.TRSP_WO_SEQ THEN ',W/O('||A.TRSP_WO_OFC_CTY_CD || A.TRSP_WO_SEQ ||') NUMBER MISMATCH' ELSE '' END AS WO_NO_CHK
                ,CASE WHEN A.CGO_TP_CD <> B.CGO_TP_CD THEN ',CGO TYPE MISMATCH' ELSE '' END AS CGO_TP_CHK
                ,CASE WHEN A.EQ_NO <> B.EQ_NO THEN ',EQ NUMBER MISMATCH' ELSE '' END AS EQ_NO_CHK
            FROM TRS_INV_EDI_RCV_EQ A
                ,TRS_TRSP_SVC_ORD B
           WHERE 1=1
             AND A.TRSP_SO_OFC_CTY_CD = B.TRSP_SO_OFC_CTY_CD(+)
             AND A.TRSP_SO_SEQ = B.TRSP_SO_SEQ(+)
             AND A.INV_EDI_RCV_SEQ = @[inv_edi_rcv_seq]
             AND 'N' = B.DELT_FLG(+)
       )			]]></sql>
			<params>
				<param name="inv_edi_rcv_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
