/*=========================================================
*Copyright(c) 2017 CyberLogitec
*@FileName : RailTransitReportDBDAOSearchRTRListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2017.06.20
*@LastModifier : 
*@LastVersion : 1.0
* 2017.06.20 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esd.sce.visibilitymanage.railtransitreport.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class RailTransitReportDBDAOSearchRTRListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * select list not single_excel
	  * 2012.03.12 채창호 [CHM-201216647-01] Rail Transit Report 상에, Empty Cargo 조회 보완요청
	  * </pre>
	  */
	public RailTransitReportDBDAOSearchRTRListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fm_nod_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pod_pol",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cgo_tp_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_cnt_seq",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cur_page",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("so_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("railcomp",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("customer_loc",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("parentScNo",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("trsp_bnd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sc_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_nod_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fm_dt",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esd.sce.visibilitymanage.railtransitreport.integration").append("\n"); 
		query.append("FileName : RailTransitReportDBDAOSearchRTRListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT t2.*" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("	SELECT t1.*" ).append("\n"); 
		query.append("		,COUNT(TRSP_SO_OFC_CTY_CD) OVER() CNT" ).append("\n"); 
		query.append("		,CEIL(rownum/6000) page" ).append("\n"); 
		query.append("	FROM (" ).append("\n"); 
		query.append("		SELECT --COUNT(TRSP_SO_OFC_CTY_CD) OVER() CNT" ).append("\n"); 
		query.append("		    TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("			,TRSP_SO_SEQ" ).append("\n"); 
		query.append("			,TRSP_SO_OFC_CTY_CD||TRSP_SO_SEQ SO_NO" ).append("\n"); 
		query.append("			,EQ_NO" ).append("\n"); 
		query.append("			,EQ_TPSZ_CD" ).append("\n"); 
		query.append("            ,RPT.COP_NO" ).append("\n"); 
		query.append("			,CGO_TP_CD" ).append("\n"); 
		query.append("           	,VVD_CD" ).append("\n"); 
		query.append("			,RPT.BKG_NO" ).append("\n"); 
		query.append("			,MST_BL_NO" ).append("\n"); 
		query.append("			,RPT.SC_NO" ).append("\n"); 
		query.append("			,TO_CHAR(so_cre_dt, 'yyyy-MM-dd') || TO_CHAR(so_cre_dt, ' hh24:mi') cre_date" ).append("\n"); 
		query.append("			,TO_CHAR(wo_iss_dt, 'yyyy-MM-dd') || TO_CHAR(wo_iss_dt, ' hh24:mi') swo_iss_date" ).append("\n"); 
		query.append("			,(select max(case when vt.SUB_RAIL_SEQ = '1' then mv.USA_EDI_CD end)||max(case when vt.SUB_RAIL_SEQ = '2' then '&'||mv.USA_EDI_CD end)||max(case when vt.SUB_RAIL_SEQ = '3' then '&'||mv.USA_EDI_CD end)" ).append("\n"); 
		query.append("				from trs_trsp_rail_bil_vndr_set vt, mdm_vendor mv" ).append("\n"); 
		query.append("				where vt.TRSP_SO_OFC_CTY_CD = RPT.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("				and vt.TRSP_SO_SEQ          = RPT.TRSP_SO_SEQ" ).append("\n"); 
		query.append("				and mv.VNDR_SEQ             = vt.VNDR_SEQ" ).append("\n"); 
		query.append("				group by vt.TRSP_SO_OFC_CTY_CD, vt.TRSP_SO_SEQ) USA_EDI_CD" ).append("\n"); 
		query.append("			,(SELECT MAX(W.WO_VNDR_SEQ)" ).append("\n"); 
		query.append("				FROM TRS_TRSP_SVC_ORD T" ).append("\n"); 
		query.append("			       ,TRS_TRSP_WRK_ORD W" ).append("\n"); 
		query.append("			       ,SCE_PLN_SO_LIST S" ).append("\n"); 
		query.append("				WHERE S.COP_NO           = RPT.COP_NO" ).append("\n"); 
		query.append("			  AND S.COST_ACT_GRP_SEQ   BETWEEN DECODE(RPT.trsp_bnd_cd,'I',600,NVL(RPT.cost_act_grp_seq,0)) AND DECODE(RPT.trsp_bnd_cd,'I',NVL(RPT.cost_act_grp_seq,0),400)" ).append("\n"); 
		query.append("			  AND S.TRSP_MOD_CD        = 'TD'" ).append("\n"); 
		query.append("			  AND S.COST_ACT_GRP_CD    = DECODE(RPT.trsp_bnd_cd,'I','IYTD','OYTD')" ).append("\n"); 
		query.append("			  AND T.COP_NO             = S.COP_NO" ).append("\n"); 
		query.append("			  AND T.COST_ACT_GRP_SEQ   = S.COST_ACT_GRP_SEQ" ).append("\n"); 
		query.append("			  AND T.DELT_FLG           = 'N'" ).append("\n"); 
		query.append("			  AND T.TRSP_BND_CD        = RPT.trsp_bnd_cd" ).append("\n"); 
		query.append("			  AND W.TRSP_WO_OFC_CTY_CD = T.TRSP_WO_OFC_CTY_CD" ).append("\n"); 
		query.append("			  AND W.TRSP_WO_SEQ        = T.TRSP_WO_SEQ" ).append("\n"); 
		query.append("			  /*AND W.WO_ISS_KNT         = T.WO_ISS_KNT*/" ).append("\n"); 
		query.append("			) wo_vndr_seq" ).append("\n"); 
		query.append("			,FM_NOD_CD" ).append("\n"); 
		query.append("			,TO_NOD_CD" ).append("\n"); 
		query.append("			,NVL(TRSP_BND_CD, 'ALL') TRSP_BND_CD" ).append("\n"); 
		query.append("			,RPT.BKG_HOT_DE_FLG" ).append("\n"); 
		query.append("			" ).append("\n"); 
		query.append("			,CR.FRT_CLT_FLG" ).append("\n"); 
		query.append("			,CR.OBL_RDEM_FLG" ).append("\n"); 
		query.append("			,CR.CSTMS_CLR_CD" ).append("\n"); 
		query.append("			,(SELECT TO_CHAR (DSPO_CRE_DT, 'yyyy-MM-dd hh24:mi') C_DATE" ).append("\n"); 
		query.append("                         FROM BKG_CSTMS_ADV_RSLT" ).append("\n"); 
		query.append("                        WHERE CNT_CD = 'US'" ).append("\n"); 
		query.append("                          AND BL_NO = BKG.BL_NO" ).append("\n"); 
		query.append("                          AND DSPO_CD = '1C'" ).append("\n"); 
		query.append("                          AND CSTMS_SEQ = (SELECT MAX (CSTMS_SEQ)" ).append("\n"); 
		query.append("                                             FROM BKG_CSTMS_ADV_RSLT" ).append("\n"); 
		query.append("                                            WHERE CNT_CD = 'US'" ).append("\n"); 
		query.append("                                              AND BL_NO = BKG.BL_NO" ).append("\n"); 
		query.append("                                              AND DSPO_CD = '1C'" ).append("\n"); 
		query.append("                                            GROUP BY CNT_CD, BL_NO, DSPO_CD)" ).append("\n"); 
		query.append("             ) AS C_DATE" ).append("\n"); 
		query.append("			,(	SELECT CSTMS_CLR_TP_CD" ).append("\n"); 
		query.append("				FROM BKG_CSTMS_ADV_IBD" ).append("\n"); 
		query.append("				WHERE (CNT_CD, BL_NO)" ).append("\n"); 
		query.append("					= (" ).append("\n"); 
		query.append("						SELECT SUBSTR(CSTMS_LOC_CD, 1, 2),  BL_NO" ).append("\n"); 
		query.append("						FROM BKG_CGO_RLSE_HIS" ).append("\n"); 
		query.append("						WHERE BL_NO = CR.BL_NO" ).append("\n"); 
		query.append("						  AND HIS_SEQ=(" ).append("\n"); 
		query.append("										SELECT MAX(HIS_SEQ)" ).append("\n"); 
		query.append("										FROM BKG_CGO_RLSE_HIS" ).append("\n"); 
		query.append("										WHERE BL_NO = CR.BL_NO" ).append("\n"); 
		query.append("									   )" ).append("\n"); 
		query.append("						) " ).append("\n"); 
		query.append("			) AS IB_IPI_LOCL_IND_CD" ).append("\n"); 
		query.append("			,(	SELECT CSTMS_LOC_CD" ).append("\n"); 
		query.append("				FROM BKG_CSTMS_ADV_BL" ).append("\n"); 
		query.append("				WHERE (CNT_CD, BL_NO)" ).append("\n"); 
		query.append("					= (" ).append("\n"); 
		query.append("						SELECT SUBSTR(CSTMS_LOC_CD, 1, 2),  BL_NO" ).append("\n"); 
		query.append("						FROM BKG_CGO_RLSE_HIS" ).append("\n"); 
		query.append("						WHERE BL_NO = CR.BL_NO" ).append("\n"); 
		query.append("						  AND HIS_SEQ=(" ).append("\n"); 
		query.append("										SELECT MAX(HIS_SEQ)" ).append("\n"); 
		query.append("										FROM BKG_CGO_RLSE_HIS" ).append("\n"); 
		query.append("										WHERE BL_NO = CR.BL_NO" ).append("\n"); 
		query.append("									   )" ).append("\n"); 
		query.append("						) " ).append("\n"); 
		query.append("			) AS IBD_CSTMS_CLR_LOC_CD" ).append("\n"); 
		query.append("			" ).append("\n"); 
		query.append("			--,RPT.CGOR_FRT_PAY_IND_FLG" ).append("\n"); 
		query.append("			--,RPT.CGOR_ORG_BL_RCVR_IND_FLG" ).append("\n"); 
		query.append("			--,CSTMS_ACPT_FLG" ).append("\n"); 
		query.append("			--,TO_CHAR(ams_upd_dt, 'yyyy-MM-dd') || TO_CHAR(ams_upd_dt, ' hh24:mi') c_date" ).append("\n"); 
		query.append("			--,IB_IPI_LOCL_IND_CD" ).append("\n"); 
		query.append("			--,IBD_CSTMS_CLR_LOC_CD" ).append("\n"); 
		query.append("			,DECODE(TRSP_BND_CD,'O',POR_NOD_CD,'I',DEL_NOD_CD) AS NOD_CD1" ).append("\n"); 
		query.append("			,NOD_CD" ).append("\n"); 
		query.append("			,TO_CHAR(vd_dt, 'yyyy-MM-dd') || TO_CHAR(vd_dt, ' hh24:mi') vd_date" ).append("\n"); 
		query.append("			,(CASE WHEN NOD_CD = 'USLGBPT' THEN" ).append("\n"); 
		query.append("              								CASE WHEN RHS.CSTMS_HLD_STS_CD IS NULL AND  RHS.USDA_HLD_STS_CD IS NULL AND RHS.CSTMS_HLD_STS_CD IS NULL AND RHS.TML_HLD_STS_CD IS NULL THEN NULL" ).append("\n"); 
		query.append("                   								 WHEN RHS.CSTMS_HLD_STS_CD = 'R' AND RHS.USDA_HLD_STS_CD = 'R' AND RHS.CRR_HLD_STS_CD = 'R' AND RHS.TML_HLD_STS_CD = 'R' THEN 'Released'" ).append("\n"); 
		query.append("              								ELSE REPLACE ( " ).append("\n"); 
		query.append("                                						'Hold (' " ).append("\n"); 
		query.append("                                						||" ).append("\n"); 
		query.append("                                					CASE WHEN RHS.CSTMS_HLD_STS_CD  = 'H'   THEN 'Customer,'    END ||" ).append("\n"); 
		query.append("                                					CASE WHEN RHS.USDA_HLD_STS_CD   = 'H'   THEN 'USDA,'        END ||" ).append("\n"); 
		query.append("                                					CASE WHEN RHS.CRR_HLD_STS_CD  = 'H'   THEN 'Carrier,'     END ||" ).append("\n"); 
		query.append("                                					CASE WHEN RHS.TML_HLD_STS_CD    = 'H'   THEN 'Terminal'     END ||" ).append("\n"); 
		query.append("                                					')', " ).append("\n"); 
		query.append("                                					',)',   ')'" ).append("\n"); 
		query.append("                           								 )" ).append("\n"); 
		query.append("             								END" ).append("\n"); 
		query.append("              END" ).append("\n"); 
		query.append("             ) HLD_FLG" ).append("\n"); 
		query.append("			,(CASE WHEN NOD_CD = 'USLGBPT' THEN DECODE(RHS.LST_RLSE_DT, NULL, NULL, TO_CHAR(RHS.LST_RLSE_DT,'YYYY-MM-DD HH24:MI'))" ).append("\n"); 
		query.append("               END) HLD_RMK" ).append("\n"); 
		query.append("			,(CASE WHEN NOD_CD = 'USLGBPT' AND RHS.BKG_NO IS NOT NULL THEN" ).append("\n"); 
		query.append("              CASE WHEN RHS.LST_RLSE_DT IS NULL THEN NULL" ).append("\n"); 
		query.append("                   WHEN RPT.VD_DT IS NULL THEN NULL" ).append("\n"); 
		query.append("                   WHEN RPT.VD_DT > RHS.LST_RLSE_DT THEN (ROUND(DECODE(vd_dt, NULL, 0," ).append("\n"); 
		query.append("                        DECODE(TRSP_BND_CD, 'I'," ).append("\n"); 
		query.append("                        DECODE(org_gate_in_dt, NULL, (CASE" ).append("\n"); 
		query.append("                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt >= ams_upd_dt THEN" ).append("\n"); 
		query.append("                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt" ).append("\n"); 
		query.append("                        WHEN ORG_DEP_FLG        = 'Y' THEN org_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))" ).append("\n"); 
		query.append("                        END  - vd_dt)*24" ).append("\n"); 
		query.append("                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt < ams_upd_dt THEN" ).append("\n"); 
		query.append("                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt" ).append("\n"); 
		query.append("                        WHEN ORG_DEP_FLG        = 'Y' THEN org_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))" ).append("\n"); 
		query.append("                        END  - ams_upd_dt)*24" ).append("\n"); 
		query.append("                        ELSE" ).append("\n"); 
		query.append("                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt" ).append("\n"); 
		query.append("                        WHEN ORG_DEP_FLG      = 'Y' THEN org_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))" ).append("\n"); 
		query.append("                        END  - vd_dt)*24" ).append("\n"); 
		query.append("                        END) ," ).append("\n"); 
		query.append("                        (CASE WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt >= ams_upd_dt THEN" ).append("\n"); 
		query.append("                        (org_gate_in_dt - vd_dt)*24" ).append("\n"); 
		query.append("                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt < ams_upd_dt THEN" ).append("\n"); 
		query.append("                        --Minh.pham Add Start" ).append("\n"); 
		query.append("                        --TRUNC((org_gate_in_dt - ams_upd_dt)*24)" ).append("\n"); 
		query.append("                        CASE WHEN (org_gate_in_dt - ams_upd_dt)<0 THEN" ).append("\n"); 
		query.append("                        (org_gate_in_dt - vd_dt)*24" ).append("\n"); 
		query.append("                        ELSE" ).append("\n"); 
		query.append("                        (org_gate_in_dt - ams_upd_dt)*24" ).append("\n"); 
		query.append("                        END" ).append("\n"); 
		query.append("                        --Minh.pham Add End" ).append("\n"); 
		query.append("                        ELSE" ).append("\n"); 
		query.append("                        (org_gate_in_dt - vd_dt)*24 END)" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("                        ,'O', 0)),1))" ).append("\n"); 
		query.append("                   WHEN RPT.VD_DT <= RHS.LST_RLSE_DT THEN (ROUND(DECODE(RHS.LST_RLSE_DT, NULL, 0," ).append("\n"); 
		query.append("                        DECODE(TRSP_BND_CD, 'I'," ).append("\n"); 
		query.append("                        DECODE(org_gate_in_dt, NULL, (CASE" ).append("\n"); 
		query.append("                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND RHS.LST_RLSE_DT >= ams_upd_dt THEN" ).append("\n"); 
		query.append("                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt" ).append("\n"); 
		query.append("                        WHEN ORG_DEP_FLG        = 'Y' THEN org_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))" ).append("\n"); 
		query.append("                        END  - RHS.LST_RLSE_DT)*24" ).append("\n"); 
		query.append("                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND RHS.LST_RLSE_DT < ams_upd_dt THEN" ).append("\n"); 
		query.append("                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt" ).append("\n"); 
		query.append("                        WHEN ORG_DEP_FLG        = 'Y' THEN org_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))" ).append("\n"); 
		query.append("                        END  - ams_upd_dt)*24" ).append("\n"); 
		query.append("                        ELSE" ).append("\n"); 
		query.append("                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt" ).append("\n"); 
		query.append("                        WHEN ORG_DEP_FLG      = 'Y' THEN org_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))" ).append("\n"); 
		query.append("                        END  - RHS.LST_RLSE_DT)*24" ).append("\n"); 
		query.append("                        END) ," ).append("\n"); 
		query.append("                        (CASE WHEN IB_IPI_LOCL_IND_CD = 'L' AND RHS.LST_RLSE_DT >= ams_upd_dt THEN" ).append("\n"); 
		query.append("                        (org_gate_in_dt - RHS.LST_RLSE_DT)*24" ).append("\n"); 
		query.append("                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND RHS.LST_RLSE_DT < ams_upd_dt THEN" ).append("\n"); 
		query.append("                        --Minh.pham Add Start" ).append("\n"); 
		query.append("                        --TRUNC((org_gate_in_dt - ams_upd_dt)*24)" ).append("\n"); 
		query.append("                        CASE WHEN (org_gate_in_dt - ams_upd_dt)<0 THEN" ).append("\n"); 
		query.append("                        (org_gate_in_dt - RHS.LST_RLSE_DT)*24" ).append("\n"); 
		query.append("                        ELSE" ).append("\n"); 
		query.append("                        (org_gate_in_dt - ams_upd_dt)*24" ).append("\n"); 
		query.append("                        END" ).append("\n"); 
		query.append("                        --Minh.pham Add End" ).append("\n"); 
		query.append("                        ELSE" ).append("\n"); 
		query.append("                        (org_gate_in_dt - RHS.LST_RLSE_DT)*24 END)" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("                        ,'O', 0)),1))" ).append("\n"); 
		query.append("                    END" ).append("\n"); 
		query.append("              ELSE " ).append("\n"); 
		query.append("              	(ROUND(DECODE(vd_dt, NULL, 0," ).append("\n"); 
		query.append("                        DECODE(TRSP_BND_CD, 'I'," ).append("\n"); 
		query.append("                        DECODE(org_gate_in_dt, NULL, (CASE" ).append("\n"); 
		query.append("                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt >= ams_upd_dt THEN" ).append("\n"); 
		query.append("                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt" ).append("\n"); 
		query.append("                        WHEN ORG_DEP_FLG        = 'Y' THEN org_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N1ST_DEP_FLG = 'Y'  THEN itchg_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))" ).append("\n"); 
		query.append("                        END  - vd_dt)*24" ).append("\n"); 
		query.append("                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt < ams_upd_dt THEN" ).append("\n"); 
		query.append("                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt" ).append("\n"); 
		query.append("                        WHEN ORG_DEP_FLG        = 'Y' THEN org_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))" ).append("\n"); 
		query.append("                        END  - ams_upd_dt)*24" ).append("\n"); 
		query.append("                        ELSE" ).append("\n"); 
		query.append("                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt" ).append("\n"); 
		query.append("                        WHEN ORG_DEP_FLG      = 'Y' THEN org_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt" ).append("\n"); 
		query.append("                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt" ).append("\n"); 
		query.append("                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))" ).append("\n"); 
		query.append("                        END  - vd_dt)*24" ).append("\n"); 
		query.append("                        END) ," ).append("\n"); 
		query.append("                        (CASE WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt >= ams_upd_dt THEN" ).append("\n"); 
		query.append("                        (org_gate_in_dt - vd_dt)*24" ).append("\n"); 
		query.append("                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt < ams_upd_dt THEN" ).append("\n"); 
		query.append("                        --Minh.pham Add Start" ).append("\n"); 
		query.append("                        --TRUNC((org_gate_in_dt - ams_upd_dt)*24)" ).append("\n"); 
		query.append("                        CASE WHEN (org_gate_in_dt - ams_upd_dt)<0 THEN" ).append("\n"); 
		query.append("                        (org_gate_in_dt - vd_dt)*24" ).append("\n"); 
		query.append("                        ELSE" ).append("\n"); 
		query.append("                        (org_gate_in_dt - ams_upd_dt)*24" ).append("\n"); 
		query.append("                        END" ).append("\n"); 
		query.append("                        --Minh.pham Add End" ).append("\n"); 
		query.append("                        ELSE" ).append("\n"); 
		query.append("                        (org_gate_in_dt - vd_dt)*24 END)" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("                        ,'O', 0)),1))" ).append("\n"); 
		query.append("             END" ).append("\n"); 
		query.append("             ) TML_DWLL_TM_HRS" ).append("\n"); 
		query.append("			,TML_DEP_FLG" ).append("\n"); 
		query.append("			,ORG_SPLC_LOC_NM" ).append("\n"); 
		query.append("			,TO_CHAR(org_gate_in_dt, 'yyyy-MM-dd') || TO_CHAR(org_gate_in_dt, ' hh24:mi') org_gate_in_date" ).append("\n"); 
		query.append("			,TO_CHAR(org_gate_in_dt, 'yyyy-MM-dd') || TO_CHAR(org_gate_in_dt, ' hh24:mi') org_gate_in_date_old" ).append("\n"); 
		query.append("			,NVL(org_gate_in_upd_flg,'N') org_gate_in_upd_flg" ).append("\n"); 
		query.append("			,NVL(ROUND(DECODE( org_gate_in_dt, NULL, 0," ).append("\n"); 
		query.append("    		DECODE(org_gate_out_dt, NULL,                                                                             " ).append("\n"); 
		query.append("          (CASE WHEN ORG_DEP_FLG = 'Y' THEN org_gate_out_dt                                                                             " ).append("\n"); 
		query.append("            WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt                                                                             " ).append("\n"); 
		query.append("            WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt                                                                             " ).append("\n"); 
		query.append("            WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt                                                                             " ).append("\n"); 
		query.append("            WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("          ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))                                                                             " ).append("\n"); 
		query.append("          END - org_gate_in_dt)*24, (org_gate_out_dt - org_gate_in_dt)*24)),1), 0) ORG_DWLL_TM_HRS    " ).append("\n"); 
		query.append("			,ORG_DEP_FLG" ).append("\n"); 
		query.append("			,TO_CHAR(org_gate_out_dt, 'yyyy-MM-dd') || TO_CHAR(org_gate_out_dt, ' hh24:mi') org_gate_out_date" ).append("\n"); 
		query.append("			,ITCHG_ARR_SPLC_LOC_NM" ).append("\n"); 
		query.append("			,TO_CHAR(itchg_gate_in_dt, 'yyyy-MM-dd') || TO_CHAR(itchg_gate_in_dt, ' hh24:mi') chg_arr_in_date" ).append("\n"); 
		query.append("			,ROUND(DECODE(itchg_gate_in_dt, NULL, 0, " ).append("\n"); 
		query.append("    		DECODE(itchg_dt, NULL,                                                                             " ).append("\n"); 
		query.append("          (CASE WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt                                                                             " ).append("\n"); 
		query.append("            WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt                                                                             " ).append("\n"); 
		query.append("            WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt                                                                             " ).append("\n"); 
		query.append("            WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("          ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))                                                                             " ).append("\n"); 
		query.append("          END - itchg_gate_in_dt)*24, (itchg_dt - itchg_gate_in_dt)*24)),1) ITCHG_N1ST_DWLL_TM_HRS" ).append("\n"); 
		query.append("			,ITCHG_N1ST_DEP_FLG" ).append("\n"); 
		query.append("			,ITCHG_SPLC_LOC_NM" ).append("\n"); 
		query.append("			,TO_CHAR(itchg_dt, 'yyyy-MM-dd') || TO_CHAR(itchg_dt, ' hh24:mi') chg_date" ).append("\n"); 
		query.append("			,ROUND(DECODE(itchg_dt, NULL, 0, " ).append("\n"); 
		query.append("    		DECODE(itchg_gate_out_dt, NULL,                                                                             " ).append("\n"); 
		query.append("          (CASE WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt                                                                             " ).append("\n"); 
		query.append("            WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt                                                                             " ).append("\n"); 
		query.append("            WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("          ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))                                                                             " ).append("\n"); 
		query.append("          END - itchg_dt)*24, (itchg_gate_out_dt - itchg_dt)*24)),1) ITCHG_N2ND_DWLL_TM_HRS   " ).append("\n"); 
		query.append("			,ITCHG_N2ND_DEP_FLG" ).append("\n"); 
		query.append("			,TO_CHAR(itchg_gate_out_dt, 'yyyy-MM-dd') || TO_CHAR(itchg_gate_out_dt, ' hh24:mi') chg_out_date" ).append("\n"); 
		query.append("			,DEST_LOC_NM" ).append("\n"); 
		query.append("			,TO_CHAR(dest_gate_in_dt, 'yyyy-MM-dd') || TO_CHAR(dest_gate_in_dt, ' hh24:mi') dest_in_date" ).append("\n"); 
		query.append("			,ROUND(DECODE(dest_gate_in_dt, NULL, 0, " ).append("\n"); 
		query.append("    		DECODE(dest_aval_dt, NULL,                                                                             " ).append("\n"); 
		query.append("          (CASE WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt                                                                             " ).append("\n"); 
		query.append("                   WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)" ).append("\n"); 
		query.append("          ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))                                                                             " ).append("\n"); 
		query.append("          END - dest_gate_in_dt)*24, (dest_aval_dt - dest_gate_in_dt)*24)),1) DEST_N1ST_DWLL_TM_HRS " ).append("\n"); 
		query.append("			,DEST_N1ST_DEP_FLG" ).append("\n"); 
		query.append("			,TO_CHAR(dest_aval_dt, 'yyyy-MM-dd') || TO_CHAR(dest_aval_dt, ' hh24:mi') dest_avail_date" ).append("\n"); 
		query.append("			,ROUND(DECODE(dest_aval_dt, NULL, 0," ).append("\n"); 
		query.append("				DECODE(to_nod_cd, RAIL_NOD, '0'," ).append("\n"); 
		query.append("					    DECODE(dest_gate_out_dt, NULL," ).append("\n"); 
		query.append("						  	(CASE WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN dest_gate_out_dt" ).append("\n"); 
		query.append("			          				ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))" ).append("\n"); 
		query.append("			                  END - dest_aval_dt)*24," ).append("\n"); 
		query.append("						   	(dest_gate_out_dt - dest_aval_dt)*24))),1) DEST_N2ND_DWLL_TM_HRS" ).append("\n"); 
		query.append("			,DEST_N2ND_DEP_FLG" ).append("\n"); 
		query.append("			,TO_CHAR(dest_gate_out_dt, 'yyyy-MM-dd') || TO_CHAR(dest_gate_out_dt, ' hh24:mi') dest_out_date" ).append("\n"); 
		query.append("			,DECODE(ROUND(((dest_gate_in_dt - org_gate_out_dt)*24),1), NULL, '', 0, ''," ).append("\n"); 
		query.append("				     		ROUND(((dest_gate_in_dt - org_gate_out_dt)*24),1)) RAIL_RUN_TM_HRS" ).append("\n"); 
		query.append("			,DECODE(trsp_bnd_cd, 'O'," ).append("\n"); 
		query.append("				DECODE(ROUND(((dest_gate_out_dt - org_gate_in_dt )*24),1), NULL, '', 0, ''," ).append("\n"); 
		query.append("			 					ROUND(((dest_gate_out_dt - org_gate_in_dt)*24),1))," ).append("\n"); 
		query.append("			 		    	DECODE(ROUND(((dest_aval_dt - vd_dt)*24),1), NULL, '', 0, ''," ).append("\n"); 
		query.append("			 			   	(CASE WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt < ams_upd_dt THEN" ).append("\n"); 
		query.append("			 			    			ROUND(((dest_aval_dt - ams_upd_dt)*24),1)" ).append("\n"); 
		query.append("			 			   	WHEN IB_IPI_LOCL_IND_CD = 'L' OR IB_IPI_LOCL_IND_CD = 'I' THEN" ).append("\n"); 
		query.append("			 			   		ROUND(((dest_aval_dt - vd_dt)*24),1)" ).append("\n"); 
		query.append("                            ELSE ROUND(((DEST_AVAL_DT - VD_DT)*24),1)" ).append("\n"); 
		query.append("			 			   	END )" ).append("\n"); 
		query.append("			)) RAIL_TZTM_HRS" ).append("\n"); 
		query.append("			,ARR_LOC_NM" ).append("\n"); 
		query.append("			,ARR_STE_CD" ).append("\n"); 
		query.append("			,TO_CHAR(RPT.ARR_DT, 'yyyy-MM-dd') || TO_CHAR(RPT.ARR_DT, ' hh24:mi') evnt_date" ).append("\n"); 
		query.append("			,DECODE(RPT.AVAL_FLG,'Y',0,ROUND(DECODE(clm_sght_cd, 'W', 0," ).append("\n"); 
		query.append("				DECODE(NVL(DECODE(DECODE(trsp_bnd_cd, 'I', dest_aval_dt," ).append("\n"); 
		query.append("					DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)), NULL, RPT.ARR_DT)," ).append("\n"); 
		query.append("			 			NULL)," ).append("\n"); 
		query.append("			 		    NULL, 0," ).append("\n"); 
		query.append("			 		    ((GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC')) - NVL(DECODE(trsp_bnd_cd," ).append("\n"); 
		query.append("			 						   'I', dest_aval_dt," ).append("\n"); 
		query.append("			 						   DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt))," ).append("\n"); 
		query.append("			 					    RPT.ARR_DT))*24)),1)) CRNT_DWLL_TM_HRS" ).append("\n"); 
		query.append("			,(SELECT C.CLM_SGHT_ABBR_NM" ).append("\n"); 
		query.append("              FROM TRS_TRSP_RAIL_BIL_ORD R, SCE_CLM_SGHT C" ).append("\n"); 
		query.append("              WHERE RPT.TRSP_SO_OFC_CTY_CD = R.TRSP_SO_OFC_CTY_CD AND RPT.TRSP_SO_SEQ = R.TRSP_SO_SEQ AND R.CLM_SGHT_CD=C.CLM_SGHT_CD AND ROWNUM=1) CLM_CRNT_STS" ).append("\n"); 
		query.append("            ,(SELECT R.ARR_STE_CD" ).append("\n"); 
		query.append("              FROM TRS_TRSP_RAIL_BIL_ORD R WHERE RPT.TRSP_SO_OFC_CTY_CD = R.TRSP_SO_OFC_CTY_CD AND RPT.TRSP_SO_SEQ = R.TRSP_SO_SEQ AND ROWNUM=1) CLM_LOC" ).append("\n"); 
		query.append("            ,(SELECT R.ARR_STE_CD" ).append("\n"); 
		query.append("              FROM TRS_TRSP_RAIL_BIL_ORD R WHERE RPT.TRSP_SO_OFC_CTY_CD = R.TRSP_SO_OFC_CTY_CD AND RPT.TRSP_SO_SEQ = R.TRSP_SO_SEQ AND ROWNUM=1) CLM_STATE" ).append("\n"); 
		query.append("            ,(SELECT TO_CHAR(R.ARR_DT,'YYYY/MM/DD HH24:MI:SS')" ).append("\n"); 
		query.append("              FROM TRS_TRSP_RAIL_BIL_ORD R WHERE RPT.TRSP_SO_OFC_CTY_CD = R.TRSP_SO_OFC_CTY_CD AND RPT.TRSP_SO_SEQ = R.TRSP_SO_SEQ AND ROWNUM=1) CLM_DT" ).append("\n"); 
		query.append("            ,TRN_NO" ).append("\n"); 
		query.append("			,FCAR_NO" ).append("\n"); 
		query.append("			,CNTR_SEAL_NO" ).append("\n"); 
		query.append("			,ITCHG_HRS" ).append("\n"); 
		query.append("			,TO_CHAR(RAIL_CO_ITCHG_PNT_ETA_DT, 'yyyy-MM-dd hh24:mi') RAIL_CO_ITCHG_PNT_ETA_DT" ).append("\n"); 
		query.append("			,TO_CHAR(to_date(trim(RAIL_ITCHG_N1ST_ETA_DT)), 'yyyy-MM-dd') || TO_CHAR(RAIL_ITCHG_N1ST_ETA_DT, ' hh24:mi') RAIL_ITCHG_N1ST_ETA_date" ).append("\n"); 
		query.append("			,TO_CHAR(to_date(trim(RAIL_ITCHG_N2ND_ETA_DT)), 'yyyy-MM-dd') || TO_CHAR(RAIL_ITCHG_N2ND_ETA_DT, ' hh24:mi') RAIL_ITCHG_N2ND_ETA_date" ).append("\n"); 
		query.append("			,DWLL_HRS" ).append("\n"); 
		query.append("			,TO_CHAR(to_date(trim(RAIL_ITCHG_N1ST_ETD_DT)), 'yyyy-MM-dd') || TO_CHAR(RAIL_ITCHG_N1ST_ETD_DT, ' hh24:mi') RAIL_ITCHG_N1ST_ETD_date" ).append("\n"); 
		query.append("			,TO_CHAR(to_date(trim(RAIL_ITCHG_N2ND_ETD_DT)), 'yyyy-MM-dd') || TO_CHAR(RAIL_ITCHG_N2ND_ETD_DT, ' hh24:mi') RAIL_ITCHG_N2ND_ETD_date" ).append("\n"); 
		query.append("			,AVG_TZ_HRS" ).append("\n"); 
		query.append("			,TO_CHAR(RAIL_CO_DEST_PNT_ETA_DT, 'yyyy-MM-dd hh24:mi') R_RAIL_CO_DEST_PNT_ETA_DT" ).append("\n"); 
		query.append("			,TO_CHAR(to_date(trim(RAIL_DEST_N1ST_ETA_DT)), 'yyyy-MM-dd') || TO_CHAR(RAIL_DEST_N1ST_ETA_DT, ' hh24:mi') RAIL_DEST_N1ST_ETA_date												       " ).append("\n"); 
		query.append("			,TO_CHAR(to_date(trim(RAIL_DEST_N2ND_ETA_DT)), 'yyyy-MM-dd') || TO_CHAR(RAIL_DEST_N2ND_ETA_DT, ' hh24:mi') RAIL_DEST_N2ND_ETA_date" ).append("\n"); 
		query.append("			,TZTM_DIFF_HRS												" ).append("\n"); 
		query.append("			,SHPR_NM												" ).append("\n"); 
		query.append("			,CNEE_NM												" ).append("\n"); 
		query.append("			,NTFY_NM" ).append("\n"); 
		query.append("			,RPT.CRNT_DWLL_RMK" ).append("\n"); 
		query.append("			,RPT.PRE_DWLL_RMK												" ).append("\n"); 
		query.append("			FROM	SCE_RAIL_TZ_RPT		RPT" ).append("\n"); 
		query.append("				,	BKG_BOOKING			BKG" ).append("\n"); 
		query.append("				,	BKG_CGO_RLSE    	CR" ).append("\n"); 
		query.append("                ,   SCE_RAIL_HLD_STS    RHS" ).append("\n"); 
		query.append("				,       (" ).append("\n"); 
		query.append("        SELECT 'CAVANM2' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'USLGBPT' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'USORFM2' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'USPDXM1' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'USSAVM1' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'USTIWM1' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'USLGBM5' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'USLGBM6' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'USLAXYM' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'USLAXM2' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'USORFM5' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'USTIWYM' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'CAPRRM1' RAIL_NOD FROM DUAL UNION ALL" ).append("\n"); 
		query.append("        SELECT 'CAMTRC2' RAIL_NOD FROM DUAL" ).append("\n"); 
		query.append("        ) MR_TML" ).append("\n"); 
		query.append("		 	WHERE	RPT.BKG_NO		= BKG.BKG_NO (+)" ).append("\n"); 
		query.append("		 	AND 	NVL(RPT.DELT_FLG, 'N') = 'N'" ).append("\n"); 
		query.append("			AND		CR.BL_NO (+)	= BKG.BL_NO" ).append("\n"); 
		query.append("		    AND     RPT.TO_NOD_CD           = MR_TML.RAIL_NOD(+)" ).append("\n"); 
		query.append("            AND     RPT.BKG_NO		= RHS.BKG_NO(+)" ).append("\n"); 
		query.append("            AND     RPT.EQ_NO		= RHS.CNTR_NO(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${parentScNo} != '')" ).append("\n"); 
		query.append("    AND RPT.SC_NO = @[parentScNo]" ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${summary} == 'Y')" ).append("\n"); 
		query.append("    #if(${rout_info} != '')" ).append("\n"); 
		query.append("    AND (					" ).append("\n"); 
		query.append("        #foreach( $info in ${rout_info}) " ).append("\n"); 
		query.append("            #if($velocityCount != 1) " ).append("\n"); 
		query.append("         OR" ).append("\n"); 
		query.append("            #end " ).append("\n"); 
		query.append("	      ( 1=1" ).append("\n"); 
		query.append("           #if($info.fmNodCd != '')" ).append("\n"); 
		query.append("           AND FM_NOD_CD LIKE '$info.fmNodCd'||'%' " ).append("\n"); 
		query.append("           #end" ).append("\n"); 
		query.append("           #if($info.toNodCd != '')       " ).append("\n"); 
		query.append("           AND TO_NOD_CD LIKE '$info.toNodCd'||'%'" ).append("\n"); 
		query.append("           #end" ).append("\n"); 
		query.append("                #if($info.cgoTpCd != '' && $info.cgoTpCd != 'ALL')" ).append("\n"); 
		query.append("           AND CGO_TP_CD = '$info.cgoTpCd' #end" ).append("\n"); 
		query.append("                #if($info.trspBndCd != '' && $info.trspBndCd != 'ALL')" ).append("\n"); 
		query.append("           AND TRSP_BND_CD = '$info.trspBndCd' #end" ).append("\n"); 
		query.append("                #if(${date_kind} == 'S')" ).append("\n"); 
		query.append("                    #if($info.slsFmDt != '' && $info.slsToDt != '')" ).append("\n"); 
		query.append("            AND RPT.SO_CRE_DT BETWEEN TO_DATE('$info.slsFmDt'||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE('$info.slsToDt'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS') #end	" ).append("\n"); 
		query.append("                #elseif(${date_kind} == 'A')" ).append("\n"); 
		query.append("                    #if($info.slsFmDt != '' && $info.slsToDt != '')" ).append("\n"); 
		query.append("            AND RPT.DEST_AVAL_DT BETWEEN  TO_DATE('$info.slsFmDt'||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE('$info.slsToDt'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS') #end" ).append("\n"); 
		query.append("                #elseif(${date_kind} == 'O')" ).append("\n"); 
		query.append("                    #if($info.slsFmDt != '' && $info.slsToDt != '')" ).append("\n"); 
		query.append("            AND (CASE WHEN(SELECT MAX(CASE WHEN (T.TRSP_BND_CD = 'O' AND T.POR_CD = T.POL_CD) OR (T.TRSP_BND_CD = 'I' AND T.POD_CD = T.DEL_CD)" ).append("\n"); 
		query.append("                                           THEN 'ON' ELSE 'OFF' END) CHKDOCK" ).append("\n"); 
		query.append("                             FROM TRS_TRSP_RAIL_BIL_ORD T" ).append("\n"); 
		query.append("                            WHERE T.TRSP_SO_OFC_CTY_CD = RPT.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                              AND T.TRSP_SO_SEQ = RPT.TRSP_SO_SEQ) = 'ON' THEN RPT.DEST_AVAL_DT" ).append("\n"); 
		query.append("                      ELSE RPT.DEST_GATE_OUT_DT" ).append("\n"); 
		query.append("                  END) BETWEEN  TO_DATE('$info.slsFmDt'||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE('$info.slsToDt'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS') #end" ).append("\n"); 
		query.append("                #elseif(${date_kind} == 'I')" ).append("\n"); 
		query.append("                    #if($info.slsFmDt != '' && $info.slsToDt != '')" ).append("\n"); 
		query.append("            AND RPT.ORG_GATE_IN_DT BETWEEN  TO_DATE('$info.slsFmDt'||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE('$info.slsToDt'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS') #end" ).append("\n"); 
		query.append("                #elseif(${date_kind} == 'D')" ).append("\n"); 
		query.append("                    #if($info.slsFmDt != '' && $info.slsToDt != '')" ).append("\n"); 
		query.append("            AND RPT.VD_DT BETWEEN  TO_DATE('$info.slsFmDt'||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE('$info.slsToDt'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS') #end" ).append("\n"); 
		query.append("                #elseif(${date_kind} == 'P')" ).append("\n"); 
		query.append("                    #if($info.slsFmDt != '' && $info.slsToDt != '')" ).append("\n"); 
		query.append("            AND RPT.ORG_GATE_OUT_DT BETWEEN  TO_DATE('$info.slsFmDt'||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE('$info.slsToDt'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS') #end               " ).append("\n"); 
		query.append("                #end" ).append("\n"); 
		query.append("          )" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else /* summary */" ).append("\n"); 
		query.append("		#if(${date_kind} != '')" ).append("\n"); 
		query.append("			#if(${date_kind} == 'S')" ).append("\n"); 
		query.append("      			#if(${fm_dt} != '' && ${to_dt} != '')" ).append("\n"); 
		query.append("        			AND RPT.SO_CRE_DT BETWEEN TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')" ).append("\n"); 
		query.append("        		#end	" ).append("\n"); 
		query.append("      		#elseif(${date_kind} == 'A')" ).append("\n"); 
		query.append("      			#if(${fm_dt} != '' && ${to_dt} != '')" ).append("\n"); 
		query.append("					AND RPT.DEST_AVAL_DT BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')" ).append("\n"); 
		query.append("        		#end" ).append("\n"); 
		query.append("      		#elseif(${date_kind} == 'O')" ).append("\n"); 
		query.append("        		#if(${fm_dt} != '' && ${to_dt} != '')" ).append("\n"); 
		query.append("        			AND (CASE WHEN(SELECT MAX(CASE WHEN (T.TRSP_BND_CD = 'O' AND T.POR_CD = T.POL_CD) OR (T.TRSP_BND_CD = 'I' AND T.POD_CD = T.DEL_CD)" ).append("\n"); 
		query.append("        																THEN 'ON' ELSE 'OFF' END) CHKDOCK" ).append("\n"); 
		query.append("        								FROM TRS_TRSP_RAIL_BIL_ORD T" ).append("\n"); 
		query.append("        								WHERE T.TRSP_SO_OFC_CTY_CD = RPT.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("        								AND T.TRSP_SO_SEQ = RPT.TRSP_SO_SEQ) = 'ON' THEN RPT.DEST_AVAL_DT" ).append("\n"); 
		query.append("        						ELSE RPT.DEST_GATE_OUT_DT" ).append("\n"); 
		query.append("        			END) BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')" ).append("\n"); 
		query.append("        		#end" ).append("\n"); 
		query.append("      		#elseif(${date_kind} == 'I')" ).append("\n"); 
		query.append("      			#if(${fm_dt} != '' && ${to_dt} != '')" ).append("\n"); 
		query.append("						  AND RPT.ORG_GATE_IN_DT BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')" ).append("\n"); 
		query.append("        		#end" ).append("\n"); 
		query.append("      		#elseif(${date_kind} == 'D')" ).append("\n"); 
		query.append("      			#if(${fm_dt} != '' && ${to_dt} != '')" ).append("\n"); 
		query.append("						  AND RPT.VD_DT BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')" ).append("\n"); 
		query.append("        		#end" ).append("\n"); 
		query.append("      		#elseif(${date_kind} == 'P')" ).append("\n"); 
		query.append("      			#if(${fm_dt} != '' && ${to_dt} != '')" ).append("\n"); 
		query.append("						  AND RPT.ORG_GATE_OUT_DT BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')" ).append("\n"); 
		query.append("        		#end        		" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		 #end	" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	/* BKG No && BKG No Split */" ).append("\n"); 
		query.append("	#if(${searchtype} == 'multi' && ${r_bkg_no} != '')" ).append("\n"); 
		query.append("		AND ((RPT.BKG_NO) IN (" ).append("\n"); 
		query.append("	   	#if(${searchtype} == 'multi')" ).append("\n"); 
		query.append("	    	/* condition - r_bkg_no */" ).append("\n"); 
		query.append("			#if (${r_bkg_no} != '') " ).append("\n"); 
		query.append("				#foreach($ele IN ${r_bkg_no})" ).append("\n"); 
		query.append("					#if($velocityCount == 1 ) " ).append("\n"); 
		query.append("						'$ele'" ).append("\n"); 
		query.append("					#else " ).append("\n"); 
		query.append("						,'$ele' " ).append("\n"); 
		query.append("					#end " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		))" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("		#if(${bkg_no} != '')" ).append("\n"); 
		query.append("    		AND RPT.BKG_NO IN ( ${bkg_no} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    #if(${so_no} != '')" ).append("\n"); 
		query.append("    AND (RPT.TRSP_SO_OFC_CTY_CD = SUBSTR(@[so_no],1,3)" ).append("\n"); 
		query.append("    AND  RPT.TRSP_SO_SEQ = SUBSTR(@[so_no],4))" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    /* Container No */" ).append("\n"); 
		query.append("    #if(${searchtype} == 'multi' && ${r_cntr_no} != '')" ).append("\n"); 
		query.append("		AND RPT.EQ_NO IN (" ).append("\n"); 
		query.append("		#if(${searchtype} == 'multi')" ).append("\n"); 
		query.append("			#if(${r_cntr_no} != '')" ).append("\n"); 
		query.append("    			#foreach($ele IN ${r_cntr_no})" ).append("\n"); 
		query.append("					#if($velocityCount == 1 ) " ).append("\n"); 
		query.append("						'$ele'" ).append("\n"); 
		query.append("					#else " ).append("\n"); 
		query.append("						,'$ele' " ).append("\n"); 
		query.append("					#end " ).append("\n"); 
		query.append("      			#end" ).append("\n"); 
		query.append("      		#end" ).append("\n"); 
		query.append("    	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    	)" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("		#if(${eq_no} != '')" ).append("\n"); 
		query.append("    		AND RPT.EQ_NO IN ( ${eq_no} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    /* Container TP/SZ */" ).append("\n"); 
		query.append("	#if(${cntr_tpsz} != '')" ).append("\n"); 
		query.append("    	AND RPT.EQ_TPSZ_CD IN ( ${cntr_tpsz} )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("	/* B/L No */" ).append("\n"); 
		query.append("	#if(${searchtype} == 'multi' && ${r_bl_no} != '')" ).append("\n"); 
		query.append("    	AND ((MST_BL_NO) IN (" ).append("\n"); 
		query.append("    	#if(${searchtype} == 'multi')" ).append("\n"); 
		query.append("    		#if(${r_bl_no} != '')" ).append("\n"); 
		query.append("    		    #foreach($ele IN ${r_bl_no})" ).append("\n"); 
		query.append("					#if($velocityCount == 1 ) " ).append("\n"); 
		query.append("						'$ele'" ).append("\n"); 
		query.append("					#else " ).append("\n"); 
		query.append("						,'$ele' " ).append("\n"); 
		query.append("					#end " ).append("\n"); 
		query.append("      			#end   	" ).append("\n"); 
		query.append("	    	#end" ).append("\n"); 
		query.append("	    #end	" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    	))" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("		#if(${bl_no} != '')" ).append("\n"); 
		query.append("    		AND MST_BL_NO IN ( ${bl_no} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("	/* VVD */" ).append("\n"); 
		query.append("    #if(${vvd} != '' || (${searchtype} == 'multi' && ${r_vvd} != ''))" ).append("\n"); 
		query.append("    	AND ( RPT.VVD_CD IN ( " ).append("\n"); 
		query.append("    	#if(${searchtype} == 'multi')" ).append("\n"); 
		query.append("    		#if(${r_vvd} != '')" ).append("\n"); 
		query.append("    			#foreach($ele IN ${r_vvd})" ).append("\n"); 
		query.append("					#if($velocityCount == 1 ) " ).append("\n"); 
		query.append("						'$ele'" ).append("\n"); 
		query.append("					#else " ).append("\n"); 
		query.append("						,'$ele' " ).append("\n"); 
		query.append("					#end " ).append("\n"); 
		query.append("      			#end" ).append("\n"); 
		query.append("      		#end" ).append("\n"); 
		query.append("      	#end" ).append("\n"); 
		query.append("    	#if(${vvd} != '')" ).append("\n"); 
		query.append("    		#if($r_vvd.size() > 0 && ${searchtype} == 'multi')" ).append("\n"); 
		query.append("    			," ).append("\n"); 
		query.append("    		#end" ).append("\n"); 
		query.append("      		@[vvd]" ).append("\n"); 
		query.append("      	#end" ).append("\n"); 
		query.append("    	) )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("	/* POL , POD (MULTI) */" ).append("\n"); 
		query.append("    #if(${searchtype} == 'multi' && ${r_polpod} != '')" ).append("\n"); 
		query.append("    	AND ( RPT.NOD_CD IN (" ).append("\n"); 
		query.append("    	#if(${searchtype} == 'multi')" ).append("\n"); 
		query.append("    		#if(${r_polpod} != '')" ).append("\n"); 
		query.append("    			#foreach($ele IN ${r_polpod})" ).append("\n"); 
		query.append("					#if($velocityCount == 1 ) " ).append("\n"); 
		query.append("						'$ele'" ).append("\n"); 
		query.append("					#else " ).append("\n"); 
		query.append("						,'$ele' " ).append("\n"); 
		query.append("					#end " ).append("\n"); 
		query.append("      			#end" ).append("\n"); 
		query.append("    		#end" ).append("\n"); 
		query.append("      	#end" ).append("\n"); 
		query.append("    	) )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("	/* ORIGIN (MULTI) */" ).append("\n"); 
		query.append("    #if(${searchtype} == 'multi' && ${r_origin} != '')" ).append("\n"); 
		query.append("    	AND " ).append("\n"); 
		query.append("    	#if(${r_origin} != '')" ).append("\n"); 
		query.append("	    	( RPT.FM_NOD_CD IN (" ).append("\n"); 
		query.append("	    	#foreach($ele IN ${r_origin})" ).append("\n"); 
		query.append("				#if($velocityCount == 1 ) " ).append("\n"); 
		query.append("					'$ele'" ).append("\n"); 
		query.append("				#else " ).append("\n"); 
		query.append("					,'$ele' " ).append("\n"); 
		query.append("				#end " ).append("\n"); 
		query.append("      		#end" ).append("\n"); 
		query.append("      	#end" ).append("\n"); 
		query.append("      	) )" ).append("\n"); 
		query.append("    #end        " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("	/* DEST (MULTI) */" ).append("\n"); 
		query.append("    #if(${searchtype} == 'multi' && ${r_dest} != '')" ).append("\n"); 
		query.append("    	AND " ).append("\n"); 
		query.append("    	#if(${r_dest} != '')" ).append("\n"); 
		query.append("    		( RPT.TO_NOD_CD IN (" ).append("\n"); 
		query.append("    		#foreach($ele IN ${r_dest})" ).append("\n"); 
		query.append("				#if($velocityCount == 1 ) " ).append("\n"); 
		query.append("					'$ele'" ).append("\n"); 
		query.append("				#else " ).append("\n"); 
		query.append("					,'$ele' " ).append("\n"); 
		query.append("				#end " ).append("\n"); 
		query.append("    	  	#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("    	) )" ).append("\n"); 
		query.append("    #end    " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("	/* SC NO (MULTI) */" ).append("\n"); 
		query.append("    #if(${searchtype} == 'multi' && ${r_scno} != '')" ).append("\n"); 
		query.append("    	AND " ).append("\n"); 
		query.append("    	#if(${r_scno} != '')" ).append("\n"); 
		query.append("    		( RPT.SC_NO IN (" ).append("\n"); 
		query.append("    		#foreach($ele IN ${r_scno})" ).append("\n"); 
		query.append("				#if($velocityCount == 1 ) " ).append("\n"); 
		query.append("					'$ele'" ).append("\n"); 
		query.append("				#else " ).append("\n"); 
		query.append("					,'$ele' " ).append("\n"); 
		query.append("				#end " ).append("\n"); 
		query.append("    	  	#end" ).append("\n"); 
		query.append("      	#end" ).append("\n"); 
		query.append("    	) )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("	/* CUST_CNT_CD, CUST_SEQ (CUSTOMER CODE : MULTI) */" ).append("\n"); 
		query.append("    #if(${searchtype} == 'multi' && ${r_cust_cnt_cd} != '')" ).append("\n"); 
		query.append("      	AND " ).append("\n"); 
		query.append("      	#if(${searchtype} == 'multi')" ).append("\n"); 
		query.append("      		#if(${r_cust_cnt_cd} != '')" ).append("\n"); 
		query.append("      			( EXISTS (SELECT '1' FROM BKG_CUSTOMER WHERE BKG_NO = BKG.BKG_NO AND (CUST_CNT_CD||CUST_SEQ) IN (" ).append("\n"); 
		query.append("						#foreach($ele IN ${r_cust_cnt_cd})" ).append("\n"); 
		query.append("							#if($velocityCount == 1 ) " ).append("\n"); 
		query.append("								'$ele'" ).append("\n"); 
		query.append("							#else " ).append("\n"); 
		query.append("								,'$ele' " ).append("\n"); 
		query.append("							#end " ).append("\n"); 
		query.append("				        #end" ).append("\n"); 
		query.append("       		#end" ).append("\n"); 
		query.append("   			)" ).append("\n"); 
		query.append("   		#end " ).append("\n"); 
		query.append("   		) )" ).append("\n"); 
		query.append("	#elseif(${cust_cnt_seq} != '')" ).append("\n"); 
		query.append("		AND ( EXISTS (SELECT '1' FROM BKG_CUSTOMER WHERE BKG_NO = BKG.BKG_NO AND (CUST_CNT_CD||CUST_SEQ) IN (" ).append("\n"); 
		query.append("    		@[cust_cnt_seq]) ) )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if(${fm_nod_cd} != '')" ).append("\n"); 
		query.append("	   	AND  RPT.fm_nod_cd LIKE @[fm_nod_cd]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("    #if(${to_nod_cd} != '')" ).append("\n"); 
		query.append("    	AND  RPT.to_nod_cd LIKE @[to_nod_cd]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    /* BKG_OFC_CD */" ).append("\n"); 
		query.append("    #if(${bkg_ofc_cd} != '')" ).append("\n"); 
		query.append("      	AND BKG.BKG_OFC_CD IN (" ).append("\n"); 
		query.append("			#foreach($ele IN ${bkg_ofc_cd})" ).append("\n"); 
		query.append("				#if($velocityCount == 1 ) " ).append("\n"); 
		query.append("					'$ele'" ).append("\n"); 
		query.append("				#else " ).append("\n"); 
		query.append("					,'$ele' " ).append("\n"); 
		query.append("				#end " ).append("\n"); 
		query.append("        	#end" ).append("\n"); 
		query.append("		  	)" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("			" ).append("\n"); 
		query.append("			" ).append("\n"); 
		query.append(" 	/* setConditionQuery(queryStr, dataSet, 'cgo_tp_cd', 'RPT', 'AND') */" ).append("\n"); 
		query.append(" 		#if(${cgo_tp_cd} != '')" ).append("\n"); 
		query.append("    		AND RPT.cgo_tp_cd = @[cgo_tp_cd]" ).append("\n"); 
		query.append("	    #end" ).append("\n"); 
		query.append("	    " ).append("\n"); 
		query.append("	/* setConditionQuery(queryStr, dataSet, 'trsp_bnd_cd', 'RPT', 'AND') */" ).append("\n"); 
		query.append("	    #if(${trsp_bnd_cd} != '')" ).append("\n"); 
		query.append("  			AND RPT.trsp_bnd_cd = @[trsp_bnd_cd]" ).append("\n"); 
		query.append("	    #end" ).append("\n"); 
		query.append("	    " ).append("\n"); 
		query.append("	/* setConditionQuery(queryStr, dataSet, 'sc_no', 'RPT', 'AND') */" ).append("\n"); 
		query.append(" 		#if(${sc_no} != '')" ).append("\n"); 
		query.append("  			AND RPT.sc_no = @[sc_no]" ).append("\n"); 
		query.append("	    #end" ).append("\n"); 
		query.append(" 			" ).append("\n"); 
		query.append(" 	/* setConditionQuery(queryStr, dataSet, 'cstms_acpt_flg', 'RPT', 'AND') */" ).append("\n"); 
		query.append(" 		#if(${cstms_acpt_flg} != '')" ).append("\n"); 
		query.append("			#if(${cstms_acpt_flg} == 'Y')" ).append("\n"); 
		query.append("  				AND CR.CSTMS_CLR_CD <> 'N'" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("  				AND CR.CSTMS_CLR_CD = 'N'" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("	    #end" ).append("\n"); 
		query.append("	    " ).append("\n"); 
		query.append("	/* C/Loc */" ).append("\n"); 
		query.append(" 		#if(${customer_loc} != '')" ).append("\n"); 
		query.append("    	  	AND  RPT.IB_IPI_LOCL_IND_CD = @[customer_loc]" ).append("\n"); 
		query.append("    	#end" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("    /* POD/POL */" ).append("\n"); 
		query.append("      	#if(${pod_pol} != '')" ).append("\n"); 
		query.append("      		AND  RPT.NOD_CD LIKE @[pod_pol]||'%'" ).append("\n"); 
		query.append("      	#end" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      	-- 2017.06.09 comment out Start" ).append("\n"); 
		query.append("      	/**" ).append("\n"); 
		query.append("      	#if(${dwell_kind} != '' && ${dwell_time} != '')" ).append("\n"); 
		query.append("      	#if(${dwell_kind} == 'T')" ).append("\n"); 
		query.append("      		#if(${t_dep} != '')" ).append("\n"); 
		query.append("        		#if(${t_dep} == 'Y')" ).append("\n"); 
		query.append("        			AND RPT.TML_DEP_FLG = 'Y'" ).append("\n"); 
		query.append("        		#elseif(${t_dep} == 'N')" ).append("\n"); 
		query.append("        			AND RPT.TML_DEP_FLG = 'N'" ).append("\n"); 
		query.append("        		#end" ).append("\n"); 
		query.append("        	#end" ).append("\n"); 
		query.append("      	#elseif(${dwell_kind} == 'O')" ).append("\n"); 
		query.append("      		#if(${t_dep} != '')" ).append("\n"); 
		query.append("        		#if(${t_dep} == 'Y')" ).append("\n"); 
		query.append("        			AND RPT.ORG_DEP_FLG = 'Y'" ).append("\n"); 
		query.append("        		#elseif(${t_dep} == 'N')" ).append("\n"); 
		query.append("        			AND RPT.ORG_DEP_FLG = 'N'" ).append("\n"); 
		query.append("        		#end" ).append("\n"); 
		query.append("        	#end" ).append("\n"); 
		query.append("      	#elseif(${dwell_kind} == 'I1')" ).append("\n"); 
		query.append("      		#if(${t_dep} != '')" ).append("\n"); 
		query.append("        		#if(${t_dep} == 'Y')" ).append("\n"); 
		query.append("        			AND RPT.ITCHG_N1ST_DEP_FLG = 'Y'" ).append("\n"); 
		query.append("        		#elseif(${t_dep} == 'N')" ).append("\n"); 
		query.append("        			AND RPT.ITCHG_N1ST_DEP_FLG = 'N'" ).append("\n"); 
		query.append("        		#end" ).append("\n"); 
		query.append("        	#end" ).append("\n"); 
		query.append("      	#elseif(${dwell_kind} == 'I2')" ).append("\n"); 
		query.append("      		#if(${t_dep} != '')" ).append("\n"); 
		query.append("        		#if(${t_dep} == 'Y')" ).append("\n"); 
		query.append("        			AND RPT.ITCHG_N2ND_DEP_FLG = 'Y'" ).append("\n"); 
		query.append("        		#elseif(${t_dep} == 'N')" ).append("\n"); 
		query.append("        			AND RPT.ITCHG_N2ND_DEP_FLG = 'N'" ).append("\n"); 
		query.append("        		#end" ).append("\n"); 
		query.append("        	#end" ).append("\n"); 
		query.append("      	#elseif(${dwell_kind} == 'D1')" ).append("\n"); 
		query.append("      		#if(${t_dep} != '')" ).append("\n"); 
		query.append("        		#if(${t_dep} == 'Y')" ).append("\n"); 
		query.append("        			AND RPT.DEST_N1ST_DEP_FLG = 'Y'" ).append("\n"); 
		query.append("        		#elseif(${t_dep} == 'N')" ).append("\n"); 
		query.append("        			AND RPT.DEST_N1ST_DEP_FLG = 'N'" ).append("\n"); 
		query.append("        		#end" ).append("\n"); 
		query.append("        	#end" ).append("\n"); 
		query.append("      	#elseif(${dwell_kind} == 'D2')" ).append("\n"); 
		query.append("      		#if(${t_dep} != '')" ).append("\n"); 
		query.append("        		#if(${t_dep} == 'Y')" ).append("\n"); 
		query.append("        			AND RPT.DEST_N2ND_DEP_FLG = 'Y'" ).append("\n"); 
		query.append("        		#elseif(${t_dep} == 'N')" ).append("\n"); 
		query.append("        			AND RPT.DEST_N2ND_DEP_FLG = 'N'" ).append("\n"); 
		query.append("        		#end" ).append("\n"); 
		query.append("        	#end" ).append("\n"); 
		query.append("      	#end" ).append("\n"); 
		query.append("    #end  	" ).append("\n"); 
		query.append("    */" ).append("\n"); 
		query.append("    -- 2017.06.09 comment out End" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    -- 2017.06.09 TMNL Departure Start" ).append("\n"); 
		query.append("    #if(${dwell_kind} == '' && ${dwell_time} == '')" ).append("\n"); 
		query.append("    	#if(${t_dep} == 'Y')" ).append("\n"); 
		query.append("    		AND RPT.TML_DEP_FLG = 'Y'" ).append("\n"); 
		query.append("    	#elseif(${t_dep} == 'N')" ).append("\n"); 
		query.append("    		AND RPT.TML_DEP_FLG = 'N'" ).append("\n"); 
		query.append("    	#end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    -- 2017.06.09 TMNL Departure End" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    -- 2017.06.14 ORG Departure Start" ).append("\n"); 
		query.append("    #if(${dwell_kind} == '' && ${dwell_time} == '')" ).append("\n"); 
		query.append("        #if(${o_dep} == 'Y')" ).append("\n"); 
		query.append("            AND RPT.ORG_DEP_FLG = 'Y'" ).append("\n"); 
		query.append("        #elseif(${o_dep} == 'N')" ).append("\n"); 
		query.append("            AND RPT.ORG_DEP_FLG = 'N'" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    -- 2017.06.14 ORG Departure End" ).append("\n"); 
		query.append(" 				" ).append("\n"); 
		query.append(" 		AND RPT.RPT_UPD_STS_CD = 'N'" ).append("\n"); 
		query.append("    	" ).append("\n"); 
		query.append("    	/* RailCompany */" ).append("\n"); 
		query.append("    	#if(${railcomp} != '')" ).append("\n"); 
		query.append("    		--AND (RPT.TRSP_SO_OFC_CTY_CD, RPT.TRSP_SO_SEQ) IN ( " ).append("\n"); 
		query.append("              AND EXISTS (" ).append("\n"); 
		query.append("    			select VND.TRSP_SO_OFC_CTY_CD, VND.TRSP_SO_SEQ" ).append("\n"); 
		query.append("    			from  TRS_TRSP_RAIL_BIL_VNDR_SET VND" ).append("\n"); 
		query.append("				where VND.VNDR_SEQ = @[railcomp]" ).append("\n"); 
		query.append("    			AND   VND.SUB_RAIL_SEQ = '1'" ).append("\n"); 
		query.append("                AND VND.TRSP_SO_OFC_CTY_CD=RPT.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                AND VND.TRSP_SO_SEQ=RPT.TRSP_SO_SEQ )" ).append("\n"); 
		query.append("    			--GROUP BY VND.TRSP_SO_OFC_CTY_CD, VND.TRSP_SO_SEQ )" ).append("\n"); 
		query.append("    	#end" ).append("\n"); 
		query.append("#end /* summary */	" ).append("\n"); 
		query.append("    	) t1" ).append("\n"); 
		query.append("        #if(${dwell_kind} != '' && ${dwell_time} != '')" ).append("\n"); 
		query.append("    			#if(${dwell_kind} == 'T')" ).append("\n"); 
		query.append("		    		#if(${dwell_time} == '1')" ).append("\n"); 
		query.append("				  		where t1.TML_DWLL_TM_HRS between 0 and 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '2')" ).append("\n"); 
		query.append("				  		where t1.TML_DWLL_TM_HRS between 25 and 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '3')" ).append("\n"); 
		query.append("				  		where t1.TML_DWLL_TM_HRS between 49 and 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '4')" ).append("\n"); 
		query.append("				  		where t1.TML_DWLL_TM_HRS between 73 and 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '5')" ).append("\n"); 
		query.append("				  		where t1.TML_DWLL_TM_HRS > 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '6')" ).append("\n"); 
		query.append("				  		where t1.TML_DWLL_TM_HRS > 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '7')" ).append("\n"); 
		query.append("				  		where t1.TML_DWLL_TM_HRS > 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '8')" ).append("\n"); 
		query.append("				  		where t1.TML_DWLL_TM_HRS > 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '9')" ).append("\n"); 
		query.append("				  		where t1.TML_DWLL_TM_HRS > 36" ).append("\n"); 
		query.append("				  	#end    		                          " ).append("\n"); 
		query.append("		    	#elseif(${dwell_kind} == 'O')" ).append("\n"); 
		query.append("		    		#if(${dwell_time} == '1')" ).append("\n"); 
		query.append("				  		where t1.ORG_DWLL_TM_HRS between 0 and 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '2')" ).append("\n"); 
		query.append("				  		where t1.ORG_DWLL_TM_HRS between 25 and 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '3')" ).append("\n"); 
		query.append("				  		where t1.ORG_DWLL_TM_HRS between 49 and 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '4')" ).append("\n"); 
		query.append("				  		where t1.ORG_DWLL_TM_HRS between 73 and 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '5')" ).append("\n"); 
		query.append("				  		where t1.ORG_DWLL_TM_HRS > 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '6')" ).append("\n"); 
		query.append("				  		where t1.ORG_DWLL_TM_HRS > 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '7')" ).append("\n"); 
		query.append("				  		where t1.ORG_DWLL_TM_HRS > 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '8')" ).append("\n"); 
		query.append("				  		where t1.ORG_DWLL_TM_HRS > 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '9')" ).append("\n"); 
		query.append("				  		where t1.ORG_DWLL_TM_HRS > 36" ).append("\n"); 
		query.append("				  	#end " ).append("\n"); 
		query.append("		    	#elseif(${dwell_kind} == 'I1')         " ).append("\n"); 
		query.append("		    		#if(${dwell_time} == '1')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N1ST_DWLL_TM_HRS between 0 and 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '2')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N1ST_DWLL_TM_HRS between 25 and 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '3')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N1ST_DWLL_TM_HRS between 49 and 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '4')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N1ST_DWLL_TM_HRS between 73 and 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '5')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '6')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '7')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '8')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '9')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 36" ).append("\n"); 
		query.append("				  	#end                   " ).append("\n"); 
		query.append("		    	#elseif(${dwell_kind} == 'I2')          " ).append("\n"); 
		query.append("		    		#if(${dwell_time} == '1')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N2ND_DWLL_TM_HRS between 0 and 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '2')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N2ND_DWLL_TM_HRS between 25 and 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '3')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N2ND_DWLL_TM_HRS between 49 and 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '4')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N2ND_DWLL_TM_HRS between 73 and 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '5')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '6')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '7')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '8')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '9')" ).append("\n"); 
		query.append("				  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 36" ).append("\n"); 
		query.append("				  	#end                    " ).append("\n"); 
		query.append("		    	#elseif(${dwell_kind} == 'D1')          " ).append("\n"); 
		query.append("		    		#if(${dwell_time} == '1')" ).append("\n"); 
		query.append("				  		where t1.DEST_N1ST_DWLL_TM_HRS between 0 and 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '2')" ).append("\n"); 
		query.append("				  		where t1.DEST_N1ST_DWLL_TM_HRS between 25 and 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '3')" ).append("\n"); 
		query.append("				  		where t1.DEST_N1ST_DWLL_TM_HRS between 49 and 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '4')" ).append("\n"); 
		query.append("				  		where t1.DEST_N1ST_DWLL_TM_HRS between 73 and 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '5')" ).append("\n"); 
		query.append("				  		where t1.DEST_N1ST_DWLL_TM_HRS > 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '6')" ).append("\n"); 
		query.append("				  		where t1.DEST_N1ST_DWLL_TM_HRS > 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '7')" ).append("\n"); 
		query.append("				  		where t1.DEST_N1ST_DWLL_TM_HRS > 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '8')" ).append("\n"); 
		query.append("				  		where t1.DEST_N1ST_DWLL_TM_HRS > 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '9')" ).append("\n"); 
		query.append("				  		where t1.DEST_N1ST_DWLL_TM_HRS > 36" ).append("\n"); 
		query.append("				  	#end                     " ).append("\n"); 
		query.append("		    	#elseif(${dwell_kind} == 'D2')" ).append("\n"); 
		query.append("		    		#if(${dwell_time} == '1')" ).append("\n"); 
		query.append("				  		where t1.DEST_N2ND_DWLL_TM_HRS between 0 and 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '2')" ).append("\n"); 
		query.append("				  		where t1.DEST_N2ND_DWLL_TM_HRS between 25 and 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '3')" ).append("\n"); 
		query.append("				  		where t1.DEST_N2ND_DWLL_TM_HRS between 49 and 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '4')" ).append("\n"); 
		query.append("				  		where t1.DEST_N2ND_DWLL_TM_HRS between 73 and 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '5')" ).append("\n"); 
		query.append("				  		where t1.DEST_N2ND_DWLL_TM_HRS > 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '6')" ).append("\n"); 
		query.append("				  		where t1.DEST_N2ND_DWLL_TM_HRS > 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '7')" ).append("\n"); 
		query.append("				  		where t1.DEST_N2ND_DWLL_TM_HRS > 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '8')" ).append("\n"); 
		query.append("				  		where t1.DEST_N2ND_DWLL_TM_HRS > 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '9')" ).append("\n"); 
		query.append("				  		where t1.DEST_N2ND_DWLL_TM_HRS > 36" ).append("\n"); 
		query.append("				  	#end                      " ).append("\n"); 
		query.append("		    	#elseif(${dwell_kind} == 'C')" ).append("\n"); 
		query.append("		    		#if(${dwell_time} == '1')" ).append("\n"); 
		query.append("				  		where t1.CRNT_DWLL_TM_HRS between 0 and 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '2')" ).append("\n"); 
		query.append("				  		where t1.CRNT_DWLL_TM_HRS between 25 and 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '3')" ).append("\n"); 
		query.append("				  		where t1.CRNT_DWLL_TM_HRS between 49 and 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '4')" ).append("\n"); 
		query.append("				  		where t1.CRNT_DWLL_TM_HRS between 73 and 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '5')" ).append("\n"); 
		query.append("				  		where t1.CRNT_DWLL_TM_HRS > 24" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '6')" ).append("\n"); 
		query.append("				  		where t1.CRNT_DWLL_TM_HRS > 48" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '7')" ).append("\n"); 
		query.append("				  		where t1.CRNT_DWLL_TM_HRS > 72" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '8')" ).append("\n"); 
		query.append("				  		where t1.CRNT_DWLL_TM_HRS > 96" ).append("\n"); 
		query.append("				  	#elseif(${dwell_time} == '9')" ).append("\n"); 
		query.append("				  		where t1.CRNT_DWLL_TM_HRS > 36" ).append("\n"); 
		query.append("				  	#end                             " ).append("\n"); 
		query.append("		    	#end" ).append("\n"); 
		query.append("		    #end	 " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("			) t2" ).append("\n"); 
		query.append("			WHERE   page = @[cur_page]" ).append("\n"); 

	}
}