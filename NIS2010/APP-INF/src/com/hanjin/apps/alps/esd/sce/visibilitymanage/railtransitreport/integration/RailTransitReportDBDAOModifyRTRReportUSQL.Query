<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RailTransitReportDBDAOModifyRTRReportUSQL">
			<desc><![CDATA[ModifyRTRReport]]></desc>
			<sql><![CDATA[
UPDATE SCE_RAIL_TZ_RPT              
SET    ORG_GATE_IN_DT = TO_DATE(@[org_gate_in_date],'YYYY-MM-DD HH24:MI')
	   ,TML_DEP_FLG = 
			DECODE(@[org_gate_in_date],   
	     	     NULL,   
	     	     DECODE(ORG_GATE_OUT_DT,   
	     		    NULL,  
	     		    DECODE(ITCHG_GATE_IN_DT,  
	     			   NULL,  
	     			   DECODE(ITCHG_DT,  
	     				  NULL,   
	     				  DECODE(ITCHG_GATE_OUT_DT,  
	     					 NULL,  
	     					 DECODE(DEST_GATE_IN_DT,  
	     						NULL,  
	     						DECODE(DEST_AVAL_DT,  
	     						       NULL,  
	     						       DECODE(DEST_GATE_OUT_DT,  
	     							      NULL, 'N', 'Y'),   
	     						       'Y'),   
	     						'Y'),   
	     					 'Y'),   
	     				  'Y'),  
	     			   'Y'),  
	     		    'Y'),  
	     	     'Y')
 		,TML_DWLL_TM_HRS=
                    DECODE(VD_DT,      
    	     		 NULL, 0,     
    	     		 DECODE(TRSP_BND_CD,    
    	     		 'I', DECODE(@[org_gate_in_date], NULL, TRUNC((SYSDATE - VD_DT)*24) ,     
    	     							   TRUNC((TO_DATE(@[org_gate_in_date],'YYYY-MM-DD HH24:MI') - VD_DT)*24))    
    	     		,'O', 0))
		,RAIL_RUN_TM_HRS=
    	       	 DECODE(TRSP_BND_CD,  
	     	        'O',   
	     	     	DECODE(FLOOR((( DEST_GATE_OUT_DT - TO_DATE(@[org_gate_in_date],'YYYY-MM-DD HH24:MI') )*24)),  
	     		    		NULL, '',  
	     		    		0, '',   
	     		    		FLOOR(((DEST_GATE_OUT_DT - TO_DATE(@[org_gate_in_date],'YYYY-MM-DD HH24:MI') )*24))
					),  
	     		    DECODE(FLOOR(((DEST_AVAL_DT - VD_DT)*24)),  -- INBOUND
	     			   	   NULL, '',  
	     			   	   0, '',   
	     			   	   FLOOR(((DEST_AVAL_DT - VD_DT)*24)))
                 )
		,ORG_DWLL_TM_HRS=
			DECODE( @[org_gate_in_date],  
	     	      NULL, 0,  
	     	      DECODE(ORG_GATE_OUT_DT,  
	     		     NULL,  
	     		     TRUNC((SYSDATE - TO_DATE(@[org_gate_in_date],'YYYY-MM-DD HH24:MI'))*24),  
	     		     TRUNC((ORG_GATE_OUT_DT - TO_DATE(@[org_gate_in_date],'YYYY-MM-DD HH24:MI'))*24))) 
		,ORG_GATE_IN_UPD_FLG='N'
#if(${crnt_dwll_rmk} != '')
		,CRNT_DWLL_RMK = @[crnt_dwll_rmk]
		,CRNT_DWLL_RMK_UPD_DT = SYSDATE
        ,DWLL_RSN_LOC_NM = @[arr_loc_nm]
#end

WHERE  TRSP_SO_OFC_CTY_CD = @[trsp_so_ofc_cty_cd]
AND    TRSP_SO_SEQ = @[trsp_so_seq]
			]]></sql>
			<params>
				<param name="org_gate_in_date" type="12" value="" out="N"/>
				<param name="crnt_dwll_rmk" type="12" value="" out="N"/>
				<param name="arr_loc_nm" type="12" value="" out="N"/>
				<param name="trsp_so_ofc_cty_cd" type="12" value="1" out="N"/>
				<param name="trsp_so_seq" type="12" value="1" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
