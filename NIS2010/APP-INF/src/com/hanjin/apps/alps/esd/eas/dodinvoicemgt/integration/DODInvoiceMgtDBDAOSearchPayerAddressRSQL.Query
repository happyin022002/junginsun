<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DODInvoiceMgtDBDAOSearchPayerAddressRSQL">
			<desc><![CDATA[Payer address 정보 조회]]></desc>
			<sql><![CDATA[
SELECT 'EAS' AS JOB_TP
	,'' AS GUBUN
	,REPLACE(CUST_ADDR,'@*',CHR(13)||CHR(10))	AS CUST_ADDR
FROM EAS_PAYR_INFO KK
WHERE CUST_CNT_CD 	= SUBSTR(@[s_cust_cd], 1, 2)
AND CUST_SEQ 		= SUBSTR(@[s_cust_cd], 3)
AND CUST_ADDR IS NOT NULL
UNION ALL
#if (${s_cust_gubun} == '1') 
SELECT 'MDM' AS JOB_TP
	,'GENERAL' AS GUBUN
	,ZIP_CD||','||ENG_ADDR AS CUST_ADDR
FROM MDM_VENDOR
WHERE VNDR_SEQ = @[s_cust_cd]
AND ENG_ADDR IS NOT NULL

#elseif (${s_cust_gubun} == '2') 
-- MDM - CREDIT
SELECT 'MDM' AS JOB_TP
	,'CREDIT' AS GUBUN
	,TRIM(LOCL_ADDR1)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR2)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR3)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR4)||CHR(13)||CHR(10)||LOCL_ZIP_CD AS CUST_ADDR
FROM MDM_CR_CUST
WHERE CUST_CNT_CD 	= SUBSTR(@[s_cust_cd], 1, 2)
AND CUST_SEQ 		= SUBSTR(@[s_cust_cd], 3)
AND TRIM(LOCL_ADDR1)||TRIM(LOCL_ADDR2)||TRIM(LOCL_ADDR3)||TRIM(LOCL_ADDR4) IS NOT NULL
UNION ALL
--MDM GENERAL
SELECT 'MDM' AS JOB_TP
	,'GENERAL' AS GUBUN
	, CASE WHEN CN.BKG_ADDR_ORD_CD = 1 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.ZIP_CD
		   WHEN CN.BKG_ADDR_ORD_CD = 2 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM
		   WHEN CN.BKG_ADDR_ORD_CD = 3 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD
		   WHEN CN.BKG_ADDR_ORD_CD = 4 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.STE_CD||' '||ADDR.ZIP_CD
		   WHEN CN.BKG_ADDR_ORD_CD = 5 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD
		   WHEN CN.BKG_ADDR_ORD_CD = 6 THEN ADDR.CTY_NM||' '||REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.ZIP_CD
		ELSE ADDR.BZET_ADDR||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD
	   END AS CUST_ADDR
FROM MDM_CUST_ADDR ADDR, MDM_COUNTRY CN
WHERE ADDR.CUST_CNT_CD = CN.CNT_CD(+)
AND ADDR.CUST_CNT_CD 	= SUBSTR(@[s_cust_cd], 1, 2)
AND ADDR.CUST_SEQ 		= SUBSTR(@[s_cust_cd], 3)
AND ADDR.BZET_ADDR IS NOT NULL
#end			]]></sql>
			<params>
				<param name="s_cust_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
