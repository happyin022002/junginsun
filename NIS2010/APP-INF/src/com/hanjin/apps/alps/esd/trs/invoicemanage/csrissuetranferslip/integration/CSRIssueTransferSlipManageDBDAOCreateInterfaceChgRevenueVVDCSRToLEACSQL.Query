<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CSRIssueTransferSlipManageDBDAOCreateInterfaceChgRevenueVVDCSRToLEACSQL">
			<desc><![CDATA[CreateInterfaceChgRevenueVVDCSRToLEA]]></desc>
			<sql><![CDATA[
INSERT INTO LEA_ACT_COST_IF ( 		EXE_YRMON																																							
					,	INV_SYS_ID                                                                                                                                                          
					,	IF_SEQ                                                                                                                                                              
					,	GL_DT                                                                                                                                                               
					,	BKG_NO                                                                                                                                                              
					,	BKG_NO_SPLIT                                                                                                                                                        
					,	COP_NO                                                                                                                                                              
					,	VSL_CD                                                                                                                                                              
					,	SKD_VOY_NO                                                                                                                                                          
					,	SKD_DIR_CD                                                                                                                                                          
					,	REV_DIR_CD                                                                                                                                                          
					,	ACT_VVD_CD                                                                                                                                                          
					,	CNTR_NO                                                                                                                                                             
					,	CNTR_TPSZ_CD                                                                                                                                                        
					,	COST_ACT_GRP_CD                                                                                                                                                     
					,	COST_ACT_GRP_SEQ                                                                                                                                                    
					,	COA_COST_SRC_CD         /* NEW : COA_COST_SRC_CD ; OLD : 20070418 - LGS_COST_CD         */                                                                          
					,	LOCL_CURR_CD                                                                                                                                                        
					,	LOCL_COST_AMT                                                                                                                                                       
					,	ACCT_CD                                                                                                                                                             
					,	CSR_NO                                                                                                                                                              
					,	CSR_TP_CD                                                                                                                                                           
					,	INV_NO                                                                                                                                                              
					,	INV_VNDR_SEQ                                                                                                                                                        
					,	TTL_INV_KNT                                                                                                                                                         
					,	INV_CXL_FLG             /* INVOICE CANCEL FLAG */                                                                                                                   
					,	INV_CXL_DT              /* INVOICE CANCEL DATE */                                                                                                                   
					,	COST_ACT_GRP_TP_CD                                                                                                                                                  
					,	N1ST_NOD_CD                                                                                                                                                         
					,	N2ND_NOD_CD                                                                                                                                                         
					,	N3RD_NOD_CD                                                                                                                                                         
					,	N4TH_NOD_CD                                                                                                                                                         
					,	CRE_DT                                                                                                                                                              
			     )                                                                                                                                                                          
																									
				SELECT         	SUBSTR(GL_DT,1,6)                                                                 	/* LEA.EXE_YRMON          	*/                                                  
								,	'TRS'                                                                             	/* LEA.INV_SYS_ID         	*/                                                  
								,	LEA_ACT_COST_IF_SEQ.NEXTVAL                                                       	/* LEA.IF_SEQ           	*/                                                  
								,	GL_DT                                                                            	/* LEA.GL_DT              	*/                                                  
								,	BKG_NO                                                                            	/* LEA.BKG_NO             	*/                                                  
								,	BKG_NO_SPLIT                                                                      	/* LEA.BKG_NO_SPLIT       	*/                                                  
								,	COP_NO                                                                            	/* LEA.COP_NO             	*/                                                  
								,	VSL_CD                                                                            	/* LEA.VSL_CD             	*/                                                  
								,	SKD_VOY_NO     					                                                    /* LEA.SKD_VOY_NO         	*/                                                  
								,	SKD_DIR_CD     					                                                    /* LEA.SKD_DIR_CD         	*/                                                  
								,	REV_DIR_CD							                                            	/* LEA.REV_DIR_CD         	*/                                                  
								,	ACT_VVD_CD													                        /* LEA.ACT_VVD_CD			*/                                                  
								,	CNTR_NO                                                                             /* LEA.CNTR_NO				*/                                                  
								,	CNTR_TPSZ_CD                                                                        /* LEA.CNTR_TPSZ_CD			*/                                                  
								,	COST_ACT_GRP_CD                                                                     /* LEA.COST_ACT_GRP_CD		*/                                                  
								,	COST_ACT_GRP_SEQ                                                                    /* LEA.COST_ACT_GRP_SEQ	 	*/                                                  
					, 	COA_COST_SRC_CD                                                                                                                                                     
								,	LOCL_CURR_CD                                                                        /* LEA.LOCL_CURR_CD			*/                                                  
								,	LOCL_COST_AMT     																	/* LEA.LOCL_COST_AMT		*/ /* INVOICE TOTAL AMOUNT */                       
								,	ACCT_CD														                        /* LEA.ACCT_CD				*/                                                  
								,	CSR_NO                                                                              /* LEA.CSR_NO				*/                                                  
								,	CSR_TP_CD                                                                           /* LEA.CSR_TP_CD			*/                                                  
								,	INV_NO                                                                              /* LEA.INV_NO				*/                                                  
								,	INV_VNDR_SEQ                                                                        /* LEA.INV_VNDR_SEQ			*/                                                  
								,	TTL_INV_KNT   																		/* LEA.TTL_INV_KNT			*/ /* CANCEL시에는 MINUS 값으로 넣는다. */          	
								,	INV_CXL_FLG                 														/* LEA.INV_CXL_FLG			*/ /* INVOICE CANCEL FLAG */                        
								,	INV_CXL_DT                  														/* LEA.INV_CXL_DT			*/ /* INVOICE CANCEL DATE */                        
								,	COST_ACT_GRP_TP_CD																	/* LEA.COST_ACT_GRP_TP_CD 	*/                                                  
								,	N1ST_NOD_CD                                                                     	/* LEA.N1ST_NOD_CD			*/                                                  
								,	N2ND_NOD_CD                                                                     	/* LEA.N2ND_NOD_CD			*/                                                  
								,	N3RD_NOD_CD                                                                     	/* LEA.N3RD_NOD_CD			*/                                                  
								,	N4TH_NOD_CD                                                                     	/* LEA.N4TH_NOD_CD			*/                                                  
								,	SYSDATE                                                                         	/* LEA.CRE_DT				*/                                                  
				FROM          	(                                                                                                                                                                   
									SELECT  		'12'            						CSR_KND_INDICATOR                                                                                           
												, 	LAST_DAY(TO_DATE(@[GL_DT], 'YYYYMM')) 			GL_DT                       /* LEA.GL_DT              	*/                                                  
												,	A.BKG_NO                                                            /* LEA.BKG_NO             	*/                                                  
												,	A.BKG_NO_SPLIT                                                      /* LEA.BKG_NO_SPLIT       	*/                                                  
												,	A.COP_NO                                                            /* LEA.COP_NO             	*/                                                  
												,	A.VSL_CD                                                            /* LEA.VSL_CD             	*/                                                  
												,	A.SKD_VOY_NO     					                                /* LEA.SKD_VOY_NO         	*/                                                  
												,	A.SKD_DIR_CD     					                                /* LEA.SKD_DIR_CD         	*/                                                  
												,	A.REV_DIR_CD							                            /* LEA.REV_DIR_CD         	*/                                                  
												,	A.ACT_VVD_CD													    /* LEA.ACT_VVD_CD			*/                                                  
												,	A.CNTR_NO                                                           /* LEA.CNTR_NO				*/                                                  
												,	A.CNTR_TPSZ_CD                                                      /* LEA.CNTR_TPSZ_CD			*/                                                  
												,	A.COST_ACT_GRP_CD                                                   /* LEA.COST_ACT_GRP_CD		*/                                                  
												,	A.COST_ACT_GRP_SEQ                                                  /* LEA.COST_ACT_GRP_SEQ	 	*/                                                  
									, 	A.COA_COST_SRC_CD                                                                                                                                   
												,	A.LOCL_CURR_CD                                                      /* LEA.LOCL_CURR_CD			*/                                                  
												,	A.LOCL_COST_AMT * (-1)  				LOCL_COST_AMT				/* LEA.LOCL_COST_AMT		*/ /* INVOICE TOTAL AMOUNT */                       
												,	A.ACCT_CD														    /* LEA.ACCT_CD				*/                                                  
												,	A.CSR_NO                                                            /* LEA.CSR_NO				*/                                                  
												,	A.CSR_TP_CD                                                         /* LEA.CSR_TP_CD			*/                                                  
												,	A.INV_NO                                                            /* LEA.INV_NO				*/                                                  
												,	A.INV_VNDR_SEQ                                                      /* LEA.INV_VNDR_SEQ			*/                                                  
												,	A.TTL_INV_KNT														/* LEA.TTL_INV_KNT			*/ /* CANCEL시에는 MINUS 값으로 넣는다. */          	
												,	'Y'										A.INV_CXL_FLG     			/* LEA.INV_CXL_FLG			*/ /* INVOICE CANCEL FLAG */                        
												,	A.INV_CXL_DT 														/* LEA.INV_CXL_DT			*/ /* INVOICE CANCEL DATE */                        
												,	A.COST_ACT_GRP_TP_CD												/* LEA.COST_ACT_GRP_TP_CD 	*/                                                  
												,	A.N1ST_NOD_CD                                                       /* LEA.N1ST_NOD_CD			*/                                                  
												,	A.N2ND_NOD_CD                                                       /* LEA.N2ND_NOD_CD			*/                                                  
												,	A.N3RD_NOD_CD                                                       /* LEA.N3RD_NOD_CD			*/                                                  
												,	A.N4TH_NOD_CD                                                       /* LEA.N4TH_NOD_CD			*/                                                  
										FROM    	LEA_ACT_COST_IF    A                                                                                                                                
									, 	LEA_REV_VVD_CNG    B                                                                                                                                
								WHERE   	B.BKG_NO           = A.BKG_NO                                                                                                                       
								AND     	B.BKG_NO_SPLIT     = A.BKG_NO_SPLIT                                                                                                                 
								AND     	B.OLD_VSL_CD       = A.VSL_CD                                                                                                                       
								AND     	B.OLD_SKD_VOY_NO   = A.SKD_VOY_NO                                                                                                                   
								AND     	B.OLD_SKD_DIR_CD   = A.SKD_DIR_CD                                                                                                                   
								AND     	B.OLD_REV_DIR_CD   = A.REV_DIR_CD                                                                                                                   
								AND     	B.CSR_NO           = @[CSR_NO]         /* OLD CSR NO. 		*/                                                                                              
								AND     	B.BKG_NO           = ''         /* BKG_NO. 			*/                                                                                              
								AND     	B.OLD_VSL_CD       = ''         /* OLD_VSL_CD. 		*/                                                                                              
								AND     	B.OLD_SKD_VOY_NO   = ''         /* OLD_SKD_VOY_NO. 	*/                                                                                              
								AND     	B.OLD_SKD_DIR_CD   = ''         /* OLD_SKD_DIR_CD. 	*/                                                                                              
								AND     	B.OLD_REV_DIR_CD   = ''         /* OLD_REV_DIR_CD. 	*/                                                                                              
																								    
								UNION ALL                                                                                                                                                       
																								    
										SELECT  	'14'            					CSR_KND_INDICATOR                                                                                              	
												, 	LAST_DAY(TO_DATE(?, 'YYYYMM')) 		GL_DT                        	/* LEA.GL_DT              	*/                                                  
												,	A.BKG_NO                                                            /* LEA.BKG_NO             	*/                                                  
												,	A.BKG_NO_SPLIT                                                      /* LEA.BKG_NO_SPLIT       	*/                                                  
												,	A.COP_NO                                                            /* LEA.COP_NO             	*/                                                  
												,	B.NEW_VSL_CD                                                        /* LEA.VSL_CD             	*/                                                  
												,	B.NEW_SKD_VOY_NO     					                            /* LEA.SKD_VOY_NO         	*/                                                  
												,	B.NEW_SKD_DIR_CD     					                            /* LEA.SKD_DIR_CD         	*/                                                  
												,	B.NEW_REV_DIR_CD							                        /* LEA.REV_DIR_CD         	*/                                                  
												,	A.ACT_VVD_CD													    /* LEA.ACT_VVD_CD			*/                                                  
												,	A.CNTR_NO                                                           /* LEA.CNTR_NO				*/                                                  
												,	A.CNTR_TPSZ_CD                                                      /* LEA.CNTR_TPSZ_CD			*/                                                  
												,	A.COST_ACT_GRP_CD                                                   /* LEA.COST_ACT_GRP_CD		*/                                                  
												,	A.COST_ACT_GRP_SEQ                                                  /* LEA.COST_ACT_GRP_SEQ	 	*/                                                  
									, 	A.COA_COST_SRC_CD                                                                                                                                   
												,	A.LOCL_CURR_CD                                                      /* LEA.LOCL_CURR_CD			*/                                                  
												,	A.LOCL_COST_AMT														/* LEA.LOCL_COST_AMT		*/ /* INVOICE TOTAL AMOUNT */                       
												,	A.ACCT_CD														    /* LEA.ACCT_CD				*/                                                  
												,	B.MODI_CSR_NO   					NEW_CSR_NO                      /* LEA.CSR_NO				*/                                                  
												,	'STANDARD'      					CSR_TP_CD                       /* LEA.CSR_TP_CD			*/                                                  
												,	A.INV_NO                                                            /* LEA.INV_NO				*/                                                  
												,	A.INV_VNDR_SEQ                                                      /* LEA.INV_VNDR_SEQ			*/                                                  
												,	A.TTL_INV_KNT														/* LEA.TTL_INV_KNT			*/ /* CANCEL시에는 MINUS 값으로 넣는다. */          	
												,	A.INV_CXL_FLG     													/* LEA.INV_CXL_FLG			*/ /* INVOICE CANCEL FLAG */                        
												,	A.INV_CXL_DT 														/* LEA.INV_CXL_DT			*/ /* INVOICE CANCEL DATE */                        
												,	A.COST_ACT_GRP_TP_CD												/* LEA.COST_ACT_GRP_TP_CD 	*/                                                  
												,	A.N1ST_NOD_CD                                                      	/* LEA.N1ST_NOD_CD			*/                                                  
												,	A.N2ND_NOD_CD                                                      	/* LEA.N2ND_NOD_CD			*/                                                  
												,	A.N3RD_NOD_CD                                                      	/* LEA.N3RD_NOD_CD			*/                                                  
												,	A.N4TH_NOD_CD                                                      	/* LEA.N4TH_NOD_CD			*/                                                  
										FROM    	LEA_ACT_COST_IF    A                                                                                                                                
									, 	LEA_REV_VVD_CNG    B                                                                                                                                
								WHERE   	B.BKG_NO           = A.BKG_NO                                                                                                                       
								AND     	B.BKG_NO_SPLIT     = A.BKG_NO_SPLIT                                                                                                                 
								AND     	B.OLD_VSL_CD       = A.VSL_CD                                                                                                                       
								AND     	B.OLD_SKD_VOY_NO   = A.SKD_VOY_NO                                                                                                                   
								AND     	B.OLD_SKD_DIR_CD   = A.SKD_DIR_CD                                                                                                                   
								AND     	B.OLD_REV_DIR_CD   = A.REV_DIR_CD                                                                                                                  	
								AND     	B.CSR_NO           = ''         /* OLD CSR NO. */                                                                                                   	
								AND     	B.BKG_NO           = ''         /* BKG_NO. 			*/                                                                                              
								AND     	B.OLD_VSL_CD       = ''         /* OLD_VSL_CD. 		*/                                                                                              
								AND     	B.OLD_SKD_VOY_NO   = ''         /* OLD_SKD_VOY_NO. 	*/                                                                                              
								AND     	B.OLD_SKD_DIR_CD   = ''         /* OLD_SKD_DIR_CD. 	*/                                                                                              
								AND     	B.OLD_REV_DIR_CD   = ''         /* OLD_REV_DIR_CD. 	*/                                                                                              
						)																																											
			]]></sql>
			<params>
				<param name="GL_DT" type="12" value="" out="N"/>
				<param name="CSR_NO" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
