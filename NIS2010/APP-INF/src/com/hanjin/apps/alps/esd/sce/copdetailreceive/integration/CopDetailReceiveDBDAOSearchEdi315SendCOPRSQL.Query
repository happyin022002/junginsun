<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CopDetailReceiveDBDAOSearchEdi315SendCOPRSQL">
			<desc><![CDATA[SearchEdi315SendCOP]]></desc>
			<sql><![CDATA[
SELECT c.cop_no
    ,c.cop_dtl_seq 
    ,d.bkg_no
    ,d.cntr_no
    ,c.nod_cd
    ,m.act_stnd_edi_sts_cd
	,f.rpln_bat_snd_flg
FROM    sce_cop_dtl c
        ,sce_cop_hdr d
        ,mdm_activity m
        ,edi_cgo_stnd_sts f
WHERE  c.vsl_cd      = @[vsl_cd]
    AND    c.skd_voy_no  = @[skd_voy_no]
    AND    c.skd_dir_cd  = @[skd_dir_cd]
    AND    c.vps_port_cd = @[vps_port_cd]
    AND    d.cop_no      = c.cop_no
    AND    c.act_cd      = m.act_cd
    AND    c.act_sts_cd  = 'F'
    AND    d.cntr_no    <> 'SMCU0000000'
    AND    d.cop_sts_cd  <> 'X'
    and    d.cop_no                 = decode(@[cop_no],null,d.cop_no,@[cop_no])
    and    d.bkg_no                 = decode(@[bkg_no],null,d.bkg_no,@[bkg_no])
    and    d.cntr_no                = decode(@[cntr_no],null,d.cntr_no,@[cntr_no])    
    AND    substr(c.act_cd,5,1) = 
        (CASE
            WHEN @[act_sts_mapg_cd] = 'ATD'
            THEN 'D'
            WHEN @[act_sts_mapg_cd] = 'ATA'
            THEN 'A'
			WHEN @[act_sts_mapg_cd] = 'ATB'
            THEN 'B'
        END)
	AND    c.stnd_edi_sts_cd = f.edi_stnd_sts_cd			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="vps_port_cd" type="12" value="" out="N"/>
				<param name="cop_no" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
				<param name="act_sts_mapg_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
