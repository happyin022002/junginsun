<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CARIssueTransferSlipManageDBDAOPrintComCsrAgmtInfo2RSQL">
			<desc><![CDATA[Agreement Info List]]></desc>
			<sql><![CDATA[
SELECT DISTINCT H.CSR_NO, 
		H.VNDR_SEQ, 
		H.INV_NO, 
		A.AGMT_DOC_NO l_assetcd, 
		A.AGMT_DOC_DESC l_document_title
FROM TES_TML_SO_HDR H, TES_TML_SO_DTL D, TES_TML_AGMT_HDR A
WHERE 1=1
AND H.TML_SO_OFC_CTY_CD = D.TML_SO_OFC_CTY_CD
AND H.TML_SO_SEQ = D.TML_SO_SEQ
AND (H.CSR_NO, H.VNDR_SEQ, H.INV_NO) IN (
    SELECT DISTINCT A.CSR_NO, A.VNDR_NO, D.ATTR_CTNT1 INV_NO
    FROM AP_INV_HDR A, AP_INV_DTRB D
    WHERE 1=1
    AND A.CSR_NO = D.CSR_NO
    AND A.CSR_NO = @[csr_no]
    AND A.SRC_CTNT = 'SO_TERMINAL'
    )
AND NVL(H.DELT_FLG,'N') <> 'Y'
AND H.TML_INV_STS_CD IN ('C','A','P')
AND H.TML_INV_RJCT_STS_CD IN ('NL','RL')
AND D.TML_AGMT_OFC_CTY_CD = A.TML_AGMT_OFC_CTY_CD
AND D.TML_AGMT_SEQ = A.TML_AGMT_SEQ
AND D.TML_AGMT_VER_NO = A.TML_AGMT_VER_NO
AND NVL(A.DELT_FLG,'N') <> 'Y'
AND A.TML_AGMT_STS_CD = 'C'
AND A.AGMT_DOC_NO IS NOT NULL
ORDER BY H.CSR_NO, 
		H.VNDR_SEQ, 
		H.INV_NO, 
		A.AGMT_DOC_DESC			]]></sql>
			<params>
				<param name="csr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
