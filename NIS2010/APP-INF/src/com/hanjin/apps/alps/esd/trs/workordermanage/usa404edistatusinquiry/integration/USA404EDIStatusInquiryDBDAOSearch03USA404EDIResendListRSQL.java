/*=========================================================
*Copyright(c) 2018 CyberLogitec
*@FileName : USA404EDIStatusInquiryDBDAOSearch03USA404EDIResendListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2018.05.16
*@LastModifier : 
*@LastVersion : 1.0
* 2018.05.16 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esd.trs.workordermanage.usa404edistatusinquiry.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class USA404EDIStatusInquiryDBDAOSearch03USA404EDIResendListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * 404 EDI Resend FF의 내용을 조회 SQL
	  * </pre>
	  */
	public USA404EDIStatusInquiryDBDAOSearch03USA404EDIResendListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("strsp_edi_snd_no",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esd.trs.workordermanage.usa404edistatusinquiry.integration").append("\n"); 
		query.append("FileName : USA404EDIStatusInquiryDBDAOSearch03USA404EDIResendListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT                                                                                                     " ).append("\n"); 
		query.append("                A.TRSP_SO_OFC_CTY_CD                                                                    " ).append("\n"); 
		query.append("        ,        A.TRSP_SO_SEQ                                                                            " ).append("\n"); 
		query.append("        ,        CASE     WHEN A.FM_NOD_CD = 'USNYCDS' THEN 'MAHERTRP'                                     " ).append("\n"); 
		query.append("                        WHEN A.TO_NOD_CD = 'USNYCDS' THEN 'MAHERTRP'                                     " ).append("\n"); 
		query.append("                        ELSE ''                                                                         " ).append("\n"); 
		query.append("                END     APP_MAHA                                                                        " ).append("\n"); 
		query.append("        ,        CASE     WHEN A.FM_NOD_CD = 'USTIWM1' THEN 'PTXX'                                          " ).append("\n"); 
		query.append("                        WHEN A.FM_NOD_CD = 'USTIWYM' THEN 'PTXX'                                          " ).append("\n"); 
		query.append("                        WHEN A.TO_NOD_CD = 'USTIWM1' THEN 'PTXX'                                         " ).append("\n"); 
		query.append("                        WHEN A.TO_NOD_CD = 'USTIWYM' THEN 'PTXX'                                         " ).append("\n"); 
		query.append("                        ELSE ''                                                                         " ).append("\n"); 
		query.append("                END     APP_PTXX                                                                        " ).append("\n"); 
		query.append("        ,        CASE     WHEN A.POD_NOD_CD = 'USLGBM5' AND A.FM_NOD_CD != 'USLGBPT' THEN 'SSOFA'             " ).append("\n"); 
		query.append("                        WHEN A.POL_NOD_CD = 'USLGBM5' AND A.TO_NOD_CD != 'USLGBPT' THEN 'SSOFA'             " ).append("\n"); 
		query.append("                        ELSE ''                                                                         " ).append("\n"); 
		query.append("                END     APP_SSOFA                                                                        " ).append("\n"); 
		query.append("        ,        CASE     WHEN A.POD_NOD_CD = 'USLGBM6' AND A.FM_NOD_CD != 'USLGBPT' THEN 'ITS'             " ).append("\n"); 
		query.append("                        WHEN A.POL_NOD_CD = 'USLGBM6' AND A.TO_NOD_CD != 'USLGBPT' THEN 'ITS'             " ).append("\n"); 
		query.append("                        ELSE ''                                                                         " ).append("\n"); 
		query.append("                END     APP_ITS                                                                            " ).append("\n"); 
		query.append("        ,        CASE     WHEN A.POD_NOD_CD = 'USLAXYM' AND A.FM_NOD_CD != 'USLGBPT' THEN 'MTCLAX'         " ).append("\n"); 
		query.append("                        WHEN A.POL_NOD_CD = 'USLAXYM' AND A.TO_NOD_CD != 'USLGBPT' THEN 'MTCLAX'" ).append("\n"); 
		query.append("                        WHEN NVL(A.TRSP_BND_CD, 'O') = 'I' AND A.CGO_TP_CD = 'F' AND A.FM_NOD_CD = 'USLAXYM' THEN 'MTCLAX'" ).append("\n"); 
		query.append("                        WHEN NVL(A.TRSP_BND_CD, 'O') = 'O' AND A.CGO_TP_CD = 'F' AND A.TO_NOD_CD = 'USLAXYM' THEN 'MTCLAX'" ).append("\n"); 
		query.append("                        ELSE ''                                                                         " ).append("\n"); 
		query.append("                END     APP_MTCLAX                                                                        " ).append("\n"); 
		query.append("        ,        CASE     WHEN A.POD_NOD_CD = 'USLAXM4' AND A.FM_NOD_CD != 'USLGBPT' THEN 'MTCLA'         " ).append("\n"); 
		query.append("                        WHEN A.POL_NOD_CD = 'USLAXM4' AND A.TO_NOD_CD != 'USLGBPT' THEN 'MTCLA'" ).append("\n"); 
		query.append("                        WHEN NVL(A.TRSP_BND_CD, 'O') = 'I' AND A.CGO_TP_CD = 'F' AND A.FM_NOD_CD = 'USLAXM4' THEN 'MTCLA'" ).append("\n"); 
		query.append("                        WHEN NVL(A.TRSP_BND_CD, 'O') = 'O' AND A.CGO_TP_CD = 'F' AND A.TO_NOD_CD = 'USLAXM4' THEN 'MTCLA'" ).append("\n"); 
		query.append("                        ELSE ''                                                                         " ).append("\n"); 
		query.append("                END     APP_MTCLA                                                            " ).append("\n"); 
		query.append("        ,        CASE     WHEN (A.POD_NOD_CD = 'USLGBM5' OR A.POD_NOD_CD = 'USLGBM6' OR                      " ).append("\n"); 
		query.append("                              A.POD_NOD_CD = 'USLAXYM' OR A.POD_NOD_CD = 'USLAXM1' OR                      " ).append("\n"); 
		query.append("                              A.POD_NOD_CD = 'USLAXM2' OR A.POD_NOD_CD = 'USLAXM4') " ).append("\n"); 
		query.append("                              AND A.FM_NOD_CD = 'USLGBPT' THEN 'MTCHANINT'      " ).append("\n"); 
		query.append("                        WHEN (A.POL_NOD_CD = 'USLGBM5' OR A.POL_NOD_CD = 'USLGBM6' OR                    " ).append("\n"); 
		query.append("                              A.POL_NOD_CD = 'USLAXYM' OR A.POL_NOD_CD = 'USLAXM1' OR                    " ).append("\n"); 
		query.append("                              A.POL_NOD_CD = 'USLAXM2' OR A.POL_NOD_CD = 'USLAXM4') " ).append("\n"); 
		query.append("                              AND A.TO_NOD_CD = 'USLGBPT' THEN 'MTCHANINT'    " ).append("\n"); 
		query.append("                        ELSE ''                                                                         " ).append("\n"); 
		query.append("                END     APP_MTCHANINT                                                                    " ).append("\n"); 
		query.append("        ,        CASE     WHEN (A.POD_NOD_CD = 'USLGBM5' OR A.POD_NOD_CD = 'USLGBM6' OR                 " ).append("\n"); 
		query.append("                              A.POD_NOD_CD = 'USLAXYM' OR A.POD_NOD_CD = 'USLAXM1' OR                 " ).append("\n"); 
		query.append("                              A.POD_NOD_CD = 'USLAXM2' OR A.POD_NOD_CD = 'USLAXM4') " ).append("\n"); 
		query.append("                              AND A.FM_NOD_CD = 'USLGBPT' THEN 'MTCHAN'" ).append("\n"); 
		query.append("                        WHEN (A.POL_NOD_CD = 'USLGBM5' OR A.POL_NOD_CD = 'USLGBM6' OR" ).append("\n"); 
		query.append("                              A.POL_NOD_CD = 'USLAXYM' OR A.POL_NOD_CD = 'USLAXM1' OR" ).append("\n"); 
		query.append("                              A.POL_NOD_CD = 'USLAXM2' OR A.POL_NOD_CD = 'USLAXM4') " ).append("\n"); 
		query.append("                              AND A.TO_NOD_CD = 'USLGBPT' THEN 'MTCHAN'" ).append("\n"); 
		query.append("                        WHEN NVL(A.TRSP_BND_CD, 'O') = 'I'" ).append("\n"); 
		query.append("                              AND A.CGO_TP_CD = 'F' AND A.FM_NOD_CD = 'USLGBPT' THEN 'MTCHAN'" ).append("\n"); 
		query.append("                        WHEN NVL(A.TRSP_BND_CD, 'O') = 'O'" ).append("\n"); 
		query.append("                              AND A.CGO_TP_CD = 'F' AND A.TO_NOD_CD = 'USLGBPT' THEN 'MTCHAN'" ).append("\n"); 
		query.append("                        ELSE ''                                                                         " ).append("\n"); 
		query.append("                END     APP_MTCHAN                                                                    " ).append("\n"); 
		query.append("        ,        CASE    WHEN A.POD_NOD_CD = 'USLAXM2' " ).append("\n"); 
		query.append("                              AND A.FM_NOD_CD = 'USLAXM2' THEN '3105488232'" ).append("\n"); 
		query.append("                        ELSE ''" ).append("\n"); 
		query.append("                END     APP_3105488232" ).append("\n"); 
		query.append("        ,        A.RAIL_CMB_THRU_TP_CD RAIL_CMB                                                " ).append("\n"); 
		query.append("        ,        S.EDI_RCV_VNDR_ABBR_NM APP_MTC1                                                " ).append("\n"); 
		query.append("        ,        T.EDI_RCV_VNDR_ABBR_NM APP_MTC2                                                " ).append("\n"); 
		query.append("        ,        C.USA_EDI_CD                                     APPRECV_C                                                        " ).append("\n"); 
		query.append("        ,        DECODE(A.CGO_TP_CD, 'F', 'B', 'M', 'E', '')     SHIPQLF_C                                                " ).append("\n"); 
		query.append("        ,        DECODE( A.CGO_TP_CD , 'M', 'EMPTY REPO', DECODE( A.TRSP_BND_CD, 'O' , O.BKG_NO, '') )  BKGNO                                                " ).append("\n"); 
		query.append("        ,        DECODE( A.TRSP_BND_CD, 'I' ,A.BL_NO, '') BLNO" ).append("\n"); 
		query.append("        ,        A.SC_NO BKG_SCNO" ).append("\n"); 
		query.append("        ,        A.VSL_CD VSLCODE                                                " ).append("\n"); 
		query.append("        ,        A.SKD_VOY_NO||A.SKD_DIR_CD VOYAGE                                                " ).append("\n"); 
		query.append("        ,        Q.VSL_ENG_NM VSLNAME" ).append("\n"); 
		query.append("        ,        CASE WHEN A.CGO_TP_CD ='F' AND A.TRSP_BND_CD = 'O' THEN ( SELECT TO_CHAR(A.SYS_SET_DT,'YYYYMMDDHH24MI') " ).append("\n"); 
		query.append("                                                                               FROM BKG_CLZ_TM A" ).append("\n"); 
		query.append("                                                                             WHERE BKG_NO = BK.BKG_NO" ).append("\n"); 
		query.append("                                                                                AND CLZ_TP_CD = 'T')" ).append("\n"); 
		query.append("                     ELSE ''" ).append("\n"); 
		query.append("                  END AS VSLCUTOFF" ).append("\n"); 
		query.append("        ,        Q.LLOYD_NO LLOYD" ).append("\n"); 
		query.append("        ,        CASE WHEN A.CGO_TP_CD ='F' AND A.TRSP_BND_CD = 'O' THEN ( SELECT TO_CHAR(A.SYS_SET_DT,'YYYYMMDDHH24MI') " ).append("\n"); 
		query.append("                                                                               FROM BKG_CLZ_TM A" ).append("\n"); 
		query.append("                                                                             WHERE BKG_NO = BK.BKG_NO" ).append("\n"); 
		query.append("                                                                               AND CLZ_TP_CD = 'F')" ).append("\n"); 
		query.append("                   END AS HUBETA                                                " ).append("\n"); 
		query.append("        ,        NVL(DECODE(A.TRSP_BND_CD, 'O', A.POL_NOD_CD, ''), '') POL                                                " ).append("\n"); 
		query.append("        ,        NVL(DECODE(A.TRSP_BND_CD, 'I', A.POD_NOD_CD, ''), '') POD                                                " ).append("\n"); 
		query.append("        ,        UPPER(O.AGMT_REF_NO) CONTRACT, LPAD(O.BIL_EDI_CTRL_SEQ, 9, '0') CREDIT                                                " ).append("\n"); 
		query.append("        ,        'M'||LPAD(O.BIL_EDI_CTRL_SEQ, 8, '0') MTC_CREDIT                                                " ).append("\n"); 
		query.append("        ,        DECODE(SUBSTR(BK.DEL_CD, 1, 2), 'CA', CND.IBD_LOC_GDS_DESC, DECODE(AI.IBD_TRSP_TP_CD, '61', AI.IBD_TRSP_NO, '')) IMTRANSNO                                                " ).append("\n"); 
		query.append("        ,        DECODE(SUBSTR(BK.DEL_CD,1,2), 'CA', '',DECODE( AI.IBD_TRSP_TP_CD, '62', AI.IBD_TRSP_NO)  ) TRANSEXPNO                                                " ).append("\n"); 
		query.append("        ,        '' DOCK                                                " ).append("\n"); 
		query.append("        ,        '' FFDESC                                                " ).append("\n"); 
		query.append("        ,        A.EQ_TPSZ_CD EQNISTS                                                " ).append("\n"); 
		query.append("        ,        SUBSTR(A.EQ_NO, 1, 4) EQINIT                                                " ).append("\n"); 
		query.append("        ,        SUBSTR(A.EQ_NO, 5, 6) EQNO                                                " ).append("\n"); 
		query.append("        ,        ROUND( DECODE (A.TRSP_BND_CD, 'O', A.CNTR_WGT, DECODE(D.WGT_UT_CD, 'KGS', NVL(D.CNTR_WGT, 0) * 2.2,  NVL(D.CNTR_WGT, 0)))) WGT                                                " ).append("\n"); 
		query.append("        ,        O.EQDESC_C                                                " ).append("\n"); 
		query.append("        ,        DECODE(SUBSTR(A.EQ_TPSZ_CD, 2, 1), '2', '2000', '7', '4500', '4000' ) EQLTH_C                                                " ).append("\n"); 
		query.append("        ,        SUBSTR(A.EQ_NO, 11, 1) EQCHK                                                " ).append("\n"); 
		query.append("        ,        (SELECT CNTR_SEAL_NO FROM BKG_CNTR_SEAL_NO WHERE BKG_NO = D.BKG_NO AND CNTR_NO = D.CNTR_NO AND CNTR_SEAL_SEQ = 1) SEALNO" ).append("\n"); 
		query.append("        ,        DECODE(A.CGO_TP_CD, 'M', 'XP', DECODE(A.TRSP_BND_CD, 'I', 'IP', 'O', 'XP', '')) SPCHAND_C                                                " ).append("\n"); 
		query.append("        ,        'ML' ILTRANS_C                                                " ).append("\n"); 
		query.append("        ,        DECODE(SUBSTR(A.FM_NOD_CD, 1, 5),'CAVAN','IB',  AI.IBD_TRSP_TP_CD) CUSTENTTP_C                                                " ).append("\n"); 
		query.append("        ,        DECODE(SUBSTR(BK.DEL_CD, 1, 2), 'CA', CV.CGO_CTRL_NO_PFX_NM, AI.IBD_TRSP_NO) CUSTENTNO                                                " ).append("\n"); 
		query.append("        ,        DECODE(C.USA_EDI_CD, 'CPRS', '61', '') CUSTTYPE                                                " ).append("\n"); 
		query.append("        ,        DECODE(C.USA_EDI_CD, 'CPRS', CASE WHEN AI.CSTMS_CLR_TP_CD = 'L' THEN " ).append("\n"); 
		query.append("                                                        (SELECT F.LOC_AMS_PORT_CD FROM MDM_LOCATION F WHERE F.LOC_CD = CND.CSTMS_POD_CD)" ).append("\n"); 
		query.append("                                                  ELSE (SELECT F.LOC_AMS_PORT_CD FROM MDM_LOCATION F WHERE F.LOC_CD = CND.HUB_LOC_CD)" ).append("\n"); 
		query.append("                                                END" ).append("\n"); 
		query.append("                , '') CUSTLOC" ).append("\n"); 
		query.append("        ,        DECODE(C.USA_EDI_CD, 'CPRS', A.CNTR_WGT, 0) CARGOWGT                                                " ).append("\n"); 
		query.append("        ,        I.YD_LOC_CTY_NM ORGCTY                                                " ).append("\n"); 
		query.append("        ,        I.YD_LOC_STE_CD ORGSTATE                                                " ).append("\n"); 
		query.append("        ,        I.YD_CTRL_OFC_CTY_NM||', '||I.YD_CTRL_OFC_STE_CD ORGLOC                                                " ).append("\n"); 
		query.append("        ,        A.FM_NOD_CD ORGYD                                                " ).append("\n"); 
		query.append("        ,        K.YD_LOC_CTY_NM DSTCTY                                                " ).append("\n"); 
		query.append("        ,        K.YD_LOC_STE_CD DSTSTATE                                                " ).append("\n"); 
		query.append("        ,        K.YD_CTRL_OFC_CTY_NM||', '||K.YD_CTRL_OFC_STE_CD DSTLOC                                                " ).append("\n"); 
		query.append("        ,        A.TO_NOD_CD DSTYD                                                " ).append("\n"); 
		query.append("        ,        'SM LINE CORPORATION' SHPR_N                                                " ).append("\n"); 
		query.append("        ,        TRIM(REPLACE( REPLACE(REPLACE(REPLACE(I.YD_CTRL_OFC_ADDR, CHR(13), ' '), CHR(10), ' '), CHR(9), ' '), CHR(43), ' ')) SHPR_A" ).append("\n"); 
		query.append("        ,        I.YD_CTRL_OFC_CTY_NM SHPR_C, I.YD_CTRL_OFC_STE_CD SHPR_S, I.YD_CTRL_OFC_ZIP_CD SHPR_P, LOC1.CNT_CD AS SHPR_CN" ).append("\n"); 
		query.append("        ,       DECODE(J.BKG_CUST_TP_CD, 'S',J.CUST_CNT_CD||LPAD(J.CUST_SEQ,6,0),'') ASHPR_CODE" ).append("\n"); 
		query.append("        ,        DECODE(J.BKG_CUST_TP_CD, 'S', TRIM(REPLACE( REPLACE(REPLACE(J.CUST_NM, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')), '') ASHPR_N" ).append("\n"); 
		query.append("        ,        DECODE(J.BKG_CUST_TP_CD, 'S', TRIM(REPLACE( REPLACE(REPLACE(J.CUST_ADDR, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')), '') ASHPR_A" ).append("\n"); 
		query.append("        ,        CASE WHEN SCST.CUST_CNT_CD = 'US' OR SCST.CUST_CNT_CD = 'CA' THEN DECODE(J.BKG_CUST_TP_CD, 'S', DECODE(J.CUST_CTY_NM, '', SCST.CTY_NM, J.CUST_CTY_NM), '')                                                " ).append("\n"); 
		query.append("                     ELSE DECODE(J.BKG_CUST_TP_CD, 'S', J.CUST_CTY_NM, '')                                                " ).append("\n"); 
		query.append("                END ASHPR_C                                                " ).append("\n"); 
		query.append("        ,        CASE WHEN SCST.CUST_CNT_CD = 'US' OR SCST.CUST_CNT_CD = 'CA' THEN DECODE(J.BKG_CUST_TP_CD, 'S', DECODE(J.CUST_STE_CD, '', SCST.STE_CD, J.CUST_STE_CD), '')                                                " ).append("\n"); 
		query.append("                     ELSE DECODE(J.BKG_CUST_TP_CD, 'S', J.CUST_STE_CD, '')                                                " ).append("\n"); 
		query.append("                END ASHPR_S                                                " ).append("\n"); 
		query.append("        ,        CASE WHEN SCST.CUST_CNT_CD = 'US' OR SCST.CUST_CNT_CD = 'CA' THEN DECODE(J.BKG_CUST_TP_CD, 'S', DECODE(J.CUST_ZIP_ID, '', SCST.ZIP_CD, J.CUST_ZIP_ID), '')                                                " ).append("\n"); 
		query.append("                     ELSE DECODE(J.BKG_CUST_TP_CD, 'S', J.CUST_ZIP_ID, '')                                                " ).append("\n"); 
		query.append("                END ASHPR_P                                                " ).append("\n"); 
		query.append("        ,        CASE WHEN SCST.CUST_CNT_CD = 'US' OR SCST.CUST_CNT_CD = 'CA' THEN DECODE(J.BKG_CUST_TP_CD, 'S', DECODE(J.CUST_CNT_CD, '', SCST.CUST_CNT_CD, J.CUST_CNT_CD), '')                                                " ).append("\n"); 
		query.append("                     ELSE DECODE(J.BKG_CUST_TP_CD, 'S', J.CUST_CNT_CD, '')                                                " ).append("\n"); 
		query.append("                END ASHPR_CN                                                " ).append("\n"); 
		query.append("        ,        'SM LINE CORPORATION' CNEE_N                                                " ).append("\n"); 
		query.append("        ,        TRIM(REPLACE(REPLACE(REPLACE(K.YD_CTRL_OFC_ADDR, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) CNEE_A                                                " ).append("\n"); 
		query.append("        ,        K.YD_CTRL_OFC_CTY_NM  CNEE_C                                                " ).append("\n"); 
		query.append("        ,        K.YD_CTRL_OFC_STE_CD CNEE_S                                                " ).append("\n"); 
		query.append("        ,        K.YD_CTRL_OFC_ZIP_CD CNEE_P" ).append("\n"); 
		query.append("        ,        LOC2.CNT_CD AS CNEE_CN" ).append("\n"); 
		query.append("        ,        NVL(OFC.TEAM_MGR_NM,  'SM LINE CORPORATION') NTFY_N                                                " ).append("\n"); 
		query.append("        ,        NVL(REPLACE(REPLACE(  NVL( OFC.TEAM_FAX_NO,  OFC.OFC_FAX_NO  )  , ' ', ''), '-', ''), '') NTFY_T                                                " ).append("\n"); 
		query.append("        ,        'SM LINE CORPORATION' CARE_N                                                " ).append("\n"); 
		query.append("        ,        K.YD_CTRL_OFC_ADDR CARE_A                                                " ).append("\n"); 
		query.append("        ,        K.YD_CTRL_OFC_CTY_NM CARE_C                                                " ).append("\n"); 
		query.append("        ,        K.YD_CTRL_OFC_STE_CD CARE_S                                                " ).append("\n"); 
		query.append("        ,        K.YD_CTRL_OFC_ZIP_CD CARE_P" ).append("\n"); 
		query.append("        ,        LOC2.CNT_CD AS CARE_CN" ).append("\n"); 
		query.append("        ,        'SM LINE CORPORATION' BILL_N                                                " ).append("\n"); 
		query.append("        ,        '1750 E. NORTHROP BLVD SUITE 140' BILL_A                                                " ).append("\n"); 
		query.append("        ,        'CHANDLER' BILL_C                                                " ).append("\n"); 
		query.append("        ,        'AZ' AS BILL_S                                                " ).append("\n"); 
		query.append("        ,        '85286' BILL_P" ).append("\n"); 
		query.append("        ,       'US'AS BILL_CN" ).append("\n"); 
		query.append("        ,       CASE WHEN A.TRSP_BND_CD='O' AND J.BKG_CUST_TP_CD='S' THEN J.CUST_CNT_CD||LPAD(J.CUST_SEQ,6,0)" ).append("\n"); 
		query.append("                     WHEN A.TRSP_BND_CD='I' AND BK.CUST_TO_ORD_FLG='Y' THEN N.CUST_CNT_CD||LPAD(N.CUST_SEQ,6,0)" ).append("\n"); 
		query.append("                      WHEN A.TRSP_BND_CD='I' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN L.CUST_CNT_CD||LPAD(L.CUST_SEQ,6,0)" ).append("\n"); 
		query.append("                       ELSE '' " ).append("\n"); 
		query.append("                  END UTCN_CODE" ).append("\n"); 
		query.append("        ,        CASE     WHEN A.TRSP_BND_CD='O' AND J.BKG_CUST_TP_CD='S' THEN TRIM(REPLACE(REPLACE(REPLACE(J.CUST_NM, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) " ).append("\n"); 
		query.append("                        WHEN A.TRSP_BND_CD='I' AND BK.CUST_TO_ORD_FLG='Y' THEN TRIM(REPLACE(REPLACE(REPLACE(N.CUST_NM, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) " ).append("\n"); 
		query.append("                        WHEN A.TRSP_BND_CD='I' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN TRIM(REPLACE(REPLACE(REPLACE(L.CUST_NM, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) " ).append("\n"); 
		query.append("                        WHEN A.CGO_TP_CD='M' THEN 'SM LINE CORPORATION' " ).append("\n"); 
		query.append("                        ELSE '' " ).append("\n"); 
		query.append("                END     UTCN_N                                                " ).append("\n"); 
		query.append("        ,        CASE     WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN TRIM(REPLACE(REPLACE(REPLACE(N.CUST_ADDR, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) " ).append("\n"); 
		query.append("                         WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN TRIM(REPLACE(REPLACE(REPLACE(L.CUST_ADDR, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) " ).append("\n"); 
		query.append("                        ELSE '' " ).append("\n"); 
		query.append("                END     UTCN_A                                                " ).append("\n"); 
		query.append("        ,        CASE WHEN CCST.CUST_CNT_CD = 'US' OR CCST.CUST_CNT_CD = 'CA' THEN CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN DECODE(N.CUST_CTY_NM, '', NCST.CTY_NM, N.CUST_CTY_NM) " ).append("\n"); 
		query.append("                                                                                                      WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN DECODE(L.CUST_CTY_NM, '', CCST.CTY_NM, L.CUST_CTY_NM) " ).append("\n"); 
		query.append("                                                                                                     ELSE '' " ).append("\n"); 
		query.append("                                                                                                     END " ).append("\n"); 
		query.append("                     ELSE CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN N.CUST_CTY_NM " ).append("\n"); 
		query.append("                                WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN L.CUST_CTY_NM " ).append("\n"); 
		query.append("                               ELSE '' " ).append("\n"); 
		query.append("                          END " ).append("\n"); 
		query.append("                END     UTCN_C                                                " ).append("\n"); 
		query.append("        ,        CASE WHEN CCST.CUST_CNT_CD = 'US' OR CCST.CUST_CNT_CD = 'CA' THEN CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN DECODE(N.CUST_STE_CD, '', NCST.STE_CD, N.CUST_STE_CD) " ).append("\n"); 
		query.append("                                                                                                      WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN DECODE(L.CUST_STE_CD, '', CCST.STE_CD, L.CUST_STE_CD) " ).append("\n"); 
		query.append("                                                                                                     ELSE '' " ).append("\n"); 
		query.append("                                                                                                     END " ).append("\n"); 
		query.append("                     ELSE CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN N.CUST_STE_CD " ).append("\n"); 
		query.append("                                WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN L.CUST_STE_CD " ).append("\n"); 
		query.append("                               ELSE '' " ).append("\n"); 
		query.append("                          END " ).append("\n"); 
		query.append("                END     UTCN_S                                                " ).append("\n"); 
		query.append("        ,        CASE WHEN CCST.CUST_CNT_CD = 'US' OR CCST.CUST_CNT_CD = 'CA' THEN CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN DECODE(N.CUST_ZIP_ID, '', NCST.ZIP_CD, N.CUST_ZIP_ID) " ).append("\n"); 
		query.append("                                                                                                      WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN DECODE(L.CUST_ZIP_ID, '', CCST.ZIP_CD, L.CUST_ZIP_ID) " ).append("\n"); 
		query.append("                                                                                                     ELSE '' " ).append("\n"); 
		query.append("                                                                                                     END " ).append("\n"); 
		query.append("                     ELSE CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN N.CUST_ZIP_ID " ).append("\n"); 
		query.append("                                WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN L.CUST_ZIP_ID " ).append("\n"); 
		query.append("                               ELSE '' " ).append("\n"); 
		query.append("                          END " ).append("\n"); 
		query.append("                END     UTCN_P" ).append("\n"); 
		query.append("        ,       CASE WHEN A.TRSP_BND_CD='O' AND J.BKG_CUST_TP_CD='S' THEN J.CUST_CNT_CD" ).append("\n"); 
		query.append("                     WHEN A.TRSP_BND_CD='I' AND BK.CUST_TO_ORD_FLG='Y' THEN N.CUST_CNT_CD" ).append("\n"); 
		query.append("                      WHEN A.TRSP_BND_CD='I' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN L.CUST_CNT_CD" ).append("\n"); 
		query.append("                       ELSE '' " ).append("\n"); 
		query.append("                  END UTCN_CN" ).append("\n"); 
		query.append("        ,        'SM LINE CORPORATION' RECV_N                                                " ).append("\n"); 
		query.append("        ,        '1750 E. NORTHROP BLVD SUITE 140' RECV_A                                                " ).append("\n"); 
		query.append("        ,        'CHANDLER' RECV_C                                                " ).append("\n"); 
		query.append("        ,        'AZ' RECV_S                                                " ).append("\n"); 
		query.append("        ,        '85286' RECV_P" ).append("\n"); 
		query.append("        ,        'US' RECV_CN" ).append("\n"); 
		query.append("        ,        'SM LINE CORPORATION' ADMC_C                                                " ).append("\n"); 
		query.append("        ,        SP.FDA FDA_IND                                                " ).append("\n"); 
		query.append("        ,        TRIM(REPLACE( REPLACE(REPLACE(BF.CUST_NM, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) CUST_F                                                " ).append("\n"); 
		query.append("        ,        TRIM(REPLACE( REPLACE(REPLACE(BE.CUST_NM, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) CUST_E                                                " ).append("\n"); 
		query.append("        ,        NVL(M.FDO_TEMP, 0) TEMP                                                " ).append("\n"); 
		query.append("        ,        CASE     WHEN M.BKG_NO IS NOT NULL AND M.CNTR_NO IS NOT NULL THEN 'F' " ).append("\n"); 
		query.append("                        ELSE '' " ).append("\n"); 
		query.append("                END     TUN                                                " ).append("\n"); 
		query.append("        ,        M.VENT_RTO VENT                                                " ).append("\n"); 
		query.append("        ,        M.HUMID_NO HUMID                                                " ).append("\n"); 
		query.append("        ,        M.PWR_SPL_CBL_FLG GENSET                                                " ).append("\n"); 
		query.append("        ,        'AESNO' REFID                                                " ).append("\n"); 
		query.append("        ,        A.AUTO_XPT_SYS_NO REFVAL                                                " ).append("\n"); 
		query.append("        ,        '' S                                                " ).append("\n"); 
		query.append("        ,        DECODE( A.CGO_TP_CD , 'M', 'EMPTY REPO', DECODE( A.TRSP_BND_CD, 'O' , O.BKG_NO, '') ) BKGNO_OLD        " ).append("\n"); 
		query.append("        ,        DECODE( A.TRSP_BND_CD, 'I' ,A.BL_NO, '') BLNO_OLD                            " ).append("\n"); 
		query.append("        ,        TO_CHAR(A.WO_ISS_DT, 'YYYYMMDD') SNDDT_OLD                                                            " ).append("\n"); 
		query.append("        ,        'N' TYPE                                                                                            " ).append("\n"); 
		query.append("        ,        O.ROUTCARR ROUTCARR                                                " ).append("\n"); 
		query.append("        ,        O.ROUTSEQ ROUTSEQ                                                " ).append("\n"); 
		query.append("        ,        O.ROUTCITY ROUTCITY                                                " ).append("\n"); 
		query.append("        ,        O.INTMOSVR INTMOSVR                                                " ).append("\n"); 
		query.append("        ,        O.TRANSTP TRANSTP                                                " ).append("\n"); 
		query.append("        ,        O.TO_YARD_CD TO_YARD_CD                                            " ).append("\n"); 
		query.append("        ,        UPPER(O.AGMT_REF_NO) CONTRACT                                    " ).append("\n"); 
		query.append("        ,        O.ROUTCARR2 ROUTCARR2                                            " ).append("\n"); 
		query.append("        ,        O.ROUTSEQ2 ROUTSEQ2                                                " ).append("\n"); 
		query.append("        ,        O.ROUTCITY2 ROUTCITY2                                            " ).append("\n"); 
		query.append("        ,        O.INTMOSVR2 INTMOSVR2                                            " ).append("\n"); 
		query.append("        ,        O.TRANSTP2 TRANSTP2                                                " ).append("\n"); 
		query.append("        ,        O.TO_YARD_CD2 TO_YARD_CD2                                        " ).append("\n"); 
		query.append("        ,        UPPER(O.AGMT_REF_NO2) CONTRACT2                                    " ).append("\n"); 
		query.append("        ,        O.ROUTCARR3 ROUTCARR3                                            " ).append("\n"); 
		query.append("        ,        O.ROUTSEQ3 ROUTSEQ3                                                " ).append("\n"); 
		query.append("        ,        O.ROUTCITY3 ROUTCITY3                                            " ).append("\n"); 
		query.append("        ,        O.INTMOSVR3 INTMOSVR3                                            " ).append("\n"); 
		query.append("        ,        O.TRANSTP3 TRANSTP3                                                " ).append("\n"); 
		query.append("        ,        O.TO_YARD_CD3 TO_YARD_CD3                                        " ).append("\n"); 
		query.append("        ,        UPPER(O.AGMT_REF_NO3) CONTRACT3                                    " ).append("\n"); 
		query.append("        ,        '' INBOND                                                " ).append("\n"); 
		query.append("        ,        SP.LADELINE1                                                " ).append("\n"); 
		query.append("        ,        SP.LADELINE2                                                " ).append("\n"); 
		query.append("        ,        SP.LADELINE3                                                " ).append("\n"); 
		query.append("        ,        SP.LADELINE4                                                " ).append("\n"); 
		query.append("        ,        SP.LADELINE5                                                " ).append("\n"); 
		query.append("        ,        SP.LADEDESC1                                                " ).append("\n"); 
		query.append("        ,        SP.LADEDESC2                                                " ).append("\n"); 
		query.append("        ,        SP.LADEDESC3                                                " ).append("\n"); 
		query.append("        ,        SP.LADEDESC4                                                " ).append("\n"); 
		query.append("        ,        SP.LADEDESC5                                                " ).append("\n"); 
		query.append("        ,        SP.COMMCODE1                                                " ).append("\n"); 
		query.append("        ,        SP.COMMCODE2                                                " ).append("\n"); 
		query.append("        ,        SP.COMMCODE3                                                " ).append("\n"); 
		query.append("        ,        SP.COMMCODE4                                                " ).append("\n"); 
		query.append("        ,        SP.COMMCODE5                                                " ).append("\n"); 
		query.append("        ,        SP.NISCOMM1                                                " ).append("\n"); 
		query.append("        ,        SP.NISCOMM2                                                " ).append("\n"); 
		query.append("        ,        SP.NISCOMM3                                                " ).append("\n"); 
		query.append("        ,        SP.NISCOMM4                                                " ).append("\n"); 
		query.append("        ,        SP.NISCOMM5                                                " ).append("\n"); 
		query.append("        ,        SP.NISRETP1                                                " ).append("\n"); 
		query.append("        ,        SP.NISRETP2                                                " ).append("\n"); 
		query.append("        ,        SP.NISRETP3                                                " ).append("\n"); 
		query.append("        ,        SP.NISRETP4                                                " ).append("\n"); 
		query.append("        ,        SP.NISRETP5                                                " ).append("\n"); 
		query.append("        ,        SP.BL_NO1                                                " ).append("\n"); 
		query.append("        ,        DECODE(A.TRSP_BND_CD, 'O', NVL(A.PCK_QTY, 1), 'I', NVL(D.PCK_QTY, 1), '1') LADEQTY                                                " ).append("\n"); 
		query.append("        ,        DECODE(A.TRSP_BND_CD, 'O', 'PCS', DECODE(D.PCK_QTY, NULL, 'TLD', 'PCS')) PACKFORM                                                " ).append("\n"); 
		query.append("        ,        R.STCC_CD DG_STCC                                                " ).append("\n"); 
		query.append("        ,        P.IMDG_UN_NO DG_UN                                                " ).append("\n"); 
		query.append("        ,        P.PRP_SHP_NM DG_NAME                                                " ).append("\n"); 
		query.append("        ,        P.HZD_DESC DG_CONTENTS                                                " ).append("\n"); 
		query.append("        ,        P.IMDG_CLSS_CD DG_CLASS                                                " ).append("\n"); 
		query.append("        ,       DECODE(P.IMDG_PCK_GRP_CD, '1', 'I', '2', 'II', '3', 'III') DG_PGRP" ).append("\n"); 
		query.append("        ,       P.PSA_NO DG_PSAGRP" ).append("\n"); 
		query.append("        ,       P.MRN_POLUT_FLG DG_MP" ).append("\n"); 
		query.append("        ,       P.FLSH_PNT_CDO_TEMP DG_FLSHTEMP" ).append("\n"); 
		query.append("        ,       'C' DG_FLSHUNIT" ).append("\n"); 
		query.append("        ,        NVL(P.OUT_IMDG_PCK_QTY1,0) DG_QTY                                                " ).append("\n"); 
		query.append("        ,        P.OUT_IMDG_PCK_CD1 DG_QUNIT                                                " ).append("\n"); 
		query.append("        ,        NVL(P.GRS_WGT,0) DG_WEIGHT                                                " ).append("\n"); 
		query.append("        ,        P.WGT_UT_CD DG_WUNIT                                                " ).append("\n"); 
		query.append("        ,        P.FLSH_PNT_CDO_TEMP DG_FLASHTEMP                        " ).append("\n"); 
		query.append("        ,        P.EMER_CNTC_PHN_NO_CTNT DG_TEL    " ).append("\n"); 
		query.append("        ,       P.EMER_CNTC_PSON_NM DG_CONTACT                                            " ).append("\n"); 
		query.append("        ,        A.CRE_OFC_CD " ).append("\n"); 
		query.append("        ,        DGP.DCGO_SEQ DG_MAX_SEQ " ).append("\n"); 
		query.append("        ,        O.BKG_NO DG_BKG_NO " ).append("\n"); 
		query.append("        ,        A.EQ_NO DG_EQ_NO " ).append("\n"); 
		query.append("FROM             TRS_TRSP_RAIL_BIL_ORD     A                                                " ).append("\n"); 
		query.append("        ,        MDM_VENDOR                 C                                                " ).append("\n"); 
		query.append("        ,        BKG_CONTAINER             D                                                " ).append("\n"); 
		query.append("        ,        MDM_YARD                 I                                                " ).append("\n"); 
		query.append("        ,        BKG_CUSTOMER             J                                                " ).append("\n"); 
		query.append("        ,        MDM_YARD                 K                                                " ).append("\n"); 
		query.append("        ,        BKG_CUSTOMER             L                                                " ).append("\n"); 
		query.append("        ,        BKG_CUSTOMER             N                                                " ).append("\n"); 
		query.append("        ,        BKG_RF_CGO                 M                                                " ).append("\n"); 
		query.append("        ,        BKG_DG_CGO                 P                                                " ).append("\n"); 
		query.append("        ,        BKG_DG_CGO                 DGP                                                " ).append("\n"); 
		query.append("        ,        MDM_VSL_CNTR             Q                                                " ).append("\n"); 
		query.append("        ,        TRS_STCC                R                                                " ).append("\n"); 
		query.append("        ,        TRS_TRSP_RAIL_EDI_NOD     S                                                " ).append("\n"); 
		query.append("        ,        TRS_TRSP_RAIL_EDI_NOD     T                                                " ).append("\n"); 
		query.append("        ,        BKG_BOOKING             BK                                                " ).append("\n"); 
		query.append("        ,        BKG_CSTMS_ADV_BL         CND                                                " ).append("\n"); 
		query.append("        ,        MDM_ORGANIZATION         OFC                                                " ).append("\n"); 
		query.append("        ,        BKG_CSTMS_CND_VSL         CV                                                " ).append("\n"); 
		query.append("        ,        BKG_CUSTOMER             BF                                                " ).append("\n"); 
		query.append("        ,        BKG_CUSTOMER             BE                                                " ).append("\n"); 
		query.append("        ,        MDM_CUST_ADDR             SCST                                                " ).append("\n"); 
		query.append("        ,        MDM_CUST_ADDR             CCST                                                " ).append("\n"); 
		query.append("        ,        MDM_CUST_ADDR             NCST" ).append("\n"); 
		query.append("        ,        BKG_CSTMS_ADV_IBD         AI" ).append("\n"); 
		query.append("        ,        MDM_LOCATION LOC1" ).append("\n"); 
		query.append("        ,        MDM_LOCATION LOC2" ).append("\n"); 
		query.append("        ,        (                                                                                         " ).append("\n"); 
		query.append("                SELECT         A.TRSP_SO_OFC_CTY_CD                                                " ).append("\n"); 
		query.append("                        ,    A.TRSP_SO_SEQ                                                " ).append("\n"); 
		query.append("                        ,    MIN(DECODE(A.SUB_RAIL_SEQ, 1, A.VNDR_SEQ)) VNDR_SEQ                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 1, B.USA_EDI_CD, '')) ROUTCARR                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 1, DECODE(SUBSTR(C.RAIL_CMB_THRU_TP_CD, 3), 'T', 'S', 'C', 'S', 'R'), '')) ROUTSEQ                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 1, PRD.INLND_ROUT_JUNC_NM, '')) ROUTCITY                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 1, MST.ROUT_PLN_CD, '')) INTMOSVR                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 1, DECODE(SUBSTR(A.RAIL_CRR_TP_CD, 1, 1), 'C', 'X'), '')) TRANSTP                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 1, A.TO_NOD_CD, '')) TO_YARD_CD                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 1, AGMT.AGMT_REF_NO)) AGMT_REF_NO                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 2, B.USA_EDI_CD, '')) ROUTCARR2                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 2, '1', '')) ROUTSEQ2                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 2, PRD.INLND_ROUT_JUNC_NM, '')) ROUTCITY2                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 2, MST.ROUT_PLN_CD, '')) INTMOSVR2                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 2, DECODE(SUBSTR(A.RAIL_CRR_TP_CD, 1, 1), 'C', 'X'), '')) TRANSTP2                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 2, A.TO_NOD_CD, '')) TO_YARD_CD2                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 2, AGMT.AGMT_REF_NO)) AGMT_REF_NO2                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 3, B.USA_EDI_CD, '')) ROUTCARR3                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 3, '2', '')) ROUTSEQ3                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 3, PRD.INLND_ROUT_JUNC_NM, '')) ROUTCITY3                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 3, MST.ROUT_PLN_CD, '')) INTMOSVR3                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 3, DECODE(SUBSTR(A.RAIL_CRR_TP_CD, 1, 1), 'C', 'X'), '')) TRANSTP3                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 3, A.TO_NOD_CD, '')) TO_YARD_CD3                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 3, AGMT.AGMT_REF_NO)) AGMT_REF_NO3                                                " ).append("\n"); 
		query.append("                        ,    MAX(NVL(EDI.BIL_EDI_CTRL_SEQ, RSND_EDI.BIL_EDI_CTRL_SEQ)) BIL_EDI_CTRL_SEQ, MAX(C.BKG_NO) BKG_NO                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 1, DECODE(SUBSTR(A.RAIL_CRR_TP_CD, 1, 1), 'C' , 'CN', 'T' ,'CC'))) EQDESC_C                                                " ).append("\n"); 
		query.append("                        ,    MAX(C.FM_NOD_CD) FM_NOD_CD                                                " ).append("\n"); 
		query.append("                        ,    MAX(C.TO_NOD_CD) TO_NOD_CD " ).append("\n"); 
		query.append("                FROM         TRS_TRSP_RAIL_BIL_VNDR_SET A                                                " ).append("\n"); 
		query.append("                        ,    MDM_VENDOR B                                                " ).append("\n"); 
		query.append("                        ,    TRS_TRSP_RAIL_BIL_ORD C                                                " ).append("\n"); 
		query.append("                        ,    TRS_TRSP_EDI_TMP TMP                                                " ).append("\n"); 
		query.append("                        ,    TRS_TRSP_EDI_RAIL_ORD EDI" ).append("\n"); 
		query.append("                        ,    TRS_TRSP_EDI_RAIL_ORD_RSND RSND_EDI                                                " ).append("\n"); 
		query.append("                        ,    TRS_AGMT_HDR AGMT                                                " ).append("\n"); 
		query.append("                        ,    PRD_INLND_ROUT_DTL PRD                                                " ).append("\n"); 
		query.append("                        ,    PRD_INLND_ROUT_MST MST                                                " ).append("\n"); 
		query.append("                WHERE         TMP.TRSP_EDI_SND_NO     = @[strsp_edi_snd_no]" ).append("\n"); 
		query.append("                AND         A.TRSP_SO_OFC_CTY_CD     = TMP.TRSP_SO_OFC_CTY_CD " ).append("\n"); 
		query.append("                AND         A.TRSP_SO_SEQ             = TMP.TRSP_SO_SEQ " ).append("\n"); 
		query.append("                AND         A.VNDR_SEQ                = B.VNDR_SEQ(+) " ).append("\n"); 
		query.append("                AND         A.TRSP_SO_OFC_CTY_CD    = C.TRSP_SO_OFC_CTY_CD " ).append("\n"); 
		query.append("                AND         A.TRSP_SO_SEQ            = C.TRSP_SO_SEQ " ).append("\n"); 
		query.append("                AND         C.ROUT_ORG_NOD_CD         = PRD.ROUT_ORG_NOD_CD " ).append("\n"); 
		query.append("                AND         C.ROUT_DEST_NOD_CD         = PRD.ROUT_DEST_NOD_CD " ).append("\n"); 
		query.append("                AND         C.ROUT_SEQ                 = PRD.ROUT_SEQ " ).append("\n"); 
		query.append("                AND         A.ROUT_DTL_SEQ             = PRD.ROUT_DTL_SEQ " ).append("\n"); 
		query.append("                AND         MST.ROUT_ORG_NOD_CD     = PRD.ROUT_ORG_NOD_CD " ).append("\n"); 
		query.append("                AND         MST.ROUT_DEST_NOD_CD     = PRD.ROUT_DEST_NOD_CD " ).append("\n"); 
		query.append("                AND         MST.ROUT_SEQ             = PRD.ROUT_SEQ " ).append("\n"); 
		query.append("                AND         A.TRSP_SO_OFC_CTY_CD    = EDI.TRSP_SO_OFC_CTY_CD(+)" ).append("\n"); 
		query.append("                AND         A.TRSP_SO_SEQ            = EDI.TRSP_SO_SEQ(+)" ).append("\n"); 
		query.append("                AND         A.TRSP_SO_OFC_CTY_CD    = RSND_EDI.TRSP_SO_OFC_CTY_CD(+)" ).append("\n"); 
		query.append("                AND         A.TRSP_SO_SEQ            = RSND_EDI.TRSP_SO_SEQ(+)" ).append("\n"); 
		query.append("                AND         A.TRSP_AGMT_OFC_CTY_CD     = AGMT.TRSP_AGMT_OFC_CTY_CD(+) " ).append("\n"); 
		query.append("                AND         A.TRSP_AGMT_SEQ         = AGMT.TRSP_AGMT_SEQ(+) " ).append("\n"); 
		query.append("                AND         C.RAIL_CMB_THRU_TP_CD     IN ('C1T', 'C2T', 'C3T', 'C2R', 'C3R', 'C2C', 'C3S') " ).append("\n"); 
		query.append("                GROUP BY     A.TRSP_SO_OFC_CTY_CD                                                " ).append("\n"); 
		query.append("                        ,    A.TRSP_SO_SEQ                                                                         " ).append("\n"); 
		query.append("                UNION                                                                                             " ).append("\n"); 
		query.append("                SELECT         A.TRSP_SO_OFC_CTY_CD                                                " ).append("\n"); 
		query.append("                        ,    A.TRSP_SO_SEQ                                                " ).append("\n"); 
		query.append("                        ,    A.VNDR_SEQ                                                " ).append("\n"); 
		query.append("                        ,    B.USA_EDI_CD ROUTCARR                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 1, DECODE(SUBSTR(C.RAIL_CMB_THRU_TP_CD, 3), 'T', 'S', 'C', 'S', 'R'), 2,1,3,2)) ROUTSEQ                                                " ).append("\n"); 
		query.append("                        ,    PRD.INLND_ROUT_JUNC_NM ROUTCITY                                                " ).append("\n"); 
		query.append("                        ,    MST.ROUT_PLN_CD INTMOSVR                                                " ).append("\n"); 
		query.append("                        ,    DECODE(SUBSTR(A.RAIL_CRR_TP_CD, 1, 1), 'C', 'X') TRANSTP                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 1, A.TO_NOD_CD, '')) TO_YARD_CD                " ).append("\n"); 
		query.append("                        ,    MAX(AGMT.AGMT_REF_NO) AGMT_REF_NO                                                " ).append("\n"); 
		query.append("                        ,    '' ROUTCARR2                                            " ).append("\n"); 
		query.append("                        ,    '' ROUTSEQ2                                                " ).append("\n"); 
		query.append("                        ,    '' ROUTCITY2                                            " ).append("\n"); 
		query.append("                        ,    '' INTMOSVR2                                            " ).append("\n"); 
		query.append("                        ,    '' TRANSTP2                                                " ).append("\n"); 
		query.append("                        ,    '' TO_YARD_CD2                                            " ).append("\n"); 
		query.append("                        ,    '' AGMT_REF_NO2                                            " ).append("\n"); 
		query.append("                        ,    '' ROUTCARR3                                            " ).append("\n"); 
		query.append("                        ,    '' ROUTSEQ3                                                " ).append("\n"); 
		query.append("                        ,    '' ROUTCITY3                                            " ).append("\n"); 
		query.append("                        ,    '' INTMOSVR3                                            " ).append("\n"); 
		query.append("                        ,    '' TRANSTP3                                                " ).append("\n"); 
		query.append("                        ,    '' TO_YARD_CD3                                            " ).append("\n"); 
		query.append("                        ,    '' AGMT_REF_NO3                                            " ).append("\n"); 
		query.append("                        ,    MAX(NVL(EDI.BIL_EDI_CTRL_SEQ, RSND_EDI.BIL_EDI_CTRL_SEQ)) BIL_EDI_CTRL_SEQ" ).append("\n"); 
		query.append("                        ,    MAX(C.BKG_NO) BKG_NO                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(A.SUB_RAIL_SEQ, 1, DECODE(SUBSTR(A.RAIL_CRR_TP_CD, 1, 1), 'C' , 'CN', 'T' ,'CC'))) EQDESC_C                                                " ).append("\n"); 
		query.append("                        ,    MAX(A.FM_NOD_CD) FM_NOD_CD                                                " ).append("\n"); 
		query.append("                        ,    MAX(A.TO_NOD_CD) TO_NOD_CD  " ).append("\n"); 
		query.append("                FROM         TRS_TRSP_RAIL_BIL_VNDR_SET A                                                " ).append("\n"); 
		query.append("                        ,    MDM_VENDOR B                                                " ).append("\n"); 
		query.append("                        ,    TRS_TRSP_RAIL_BIL_ORD C                                                " ).append("\n"); 
		query.append("                        ,    TRS_TRSP_EDI_TMP TMP                                                " ).append("\n"); 
		query.append("                        ,    TRS_TRSP_EDI_RAIL_ORD EDI" ).append("\n"); 
		query.append("                        ,    TRS_TRSP_EDI_RAIL_ORD_RSND RSND_EDI                                                                                            " ).append("\n"); 
		query.append("                        ,    TRS_AGMT_HDR AGMT                                                " ).append("\n"); 
		query.append("                        ,    PRD_INLND_ROUT_DTL PRD                                                " ).append("\n"); 
		query.append("                        ,    PRD_INLND_ROUT_MST MST   " ).append("\n"); 
		query.append("                WHERE         TMP.TRSP_EDI_SND_NO         = @[strsp_edi_snd_no] " ).append("\n"); 
		query.append("                AND         A.TRSP_SO_OFC_CTY_CD         = TMP.TRSP_SO_OFC_CTY_CD " ).append("\n"); 
		query.append("                AND         A.TRSP_SO_SEQ                 = TMP.TRSP_SO_SEQ " ).append("\n"); 
		query.append("                AND         A.VNDR_SEQ                    = B.VNDR_SEQ(+) " ).append("\n"); 
		query.append("                AND         A.TRSP_SO_OFC_CTY_CD        = C.TRSP_SO_OFC_CTY_CD " ).append("\n"); 
		query.append("                AND         A.TRSP_SO_SEQ                = C.TRSP_SO_SEQ " ).append("\n"); 
		query.append("                AND         C.ROUT_ORG_NOD_CD             = PRD.ROUT_ORG_NOD_CD " ).append("\n"); 
		query.append("                AND         C.ROUT_DEST_NOD_CD             = PRD.ROUT_DEST_NOD_CD " ).append("\n"); 
		query.append("                AND         C.ROUT_SEQ                     = PRD.ROUT_SEQ " ).append("\n"); 
		query.append("                AND         A.ROUT_DTL_SEQ                 = PRD.ROUT_DTL_SEQ " ).append("\n"); 
		query.append("                AND         MST.ROUT_ORG_NOD_CD         = PRD.ROUT_ORG_NOD_CD " ).append("\n"); 
		query.append("                AND         MST.ROUT_DEST_NOD_CD         = PRD.ROUT_DEST_NOD_CD " ).append("\n"); 
		query.append("                AND         MST.ROUT_SEQ                 = PRD.ROUT_SEQ " ).append("\n"); 
		query.append("                AND         A.TRSP_SO_OFC_CTY_CD        = EDI.TRSP_SO_OFC_CTY_CD(+)" ).append("\n"); 
		query.append("                AND         A.TRSP_SO_SEQ                = EDI.TRSP_SO_SEQ(+)" ).append("\n"); 
		query.append("                AND         A.TRSP_SO_OFC_CTY_CD        = RSND_EDI.TRSP_SO_OFC_CTY_CD(+)" ).append("\n"); 
		query.append("                AND         A.TRSP_SO_SEQ                = RSND_EDI.TRSP_SO_SEQ(+)" ).append("\n"); 
		query.append("                AND         A.TRSP_AGMT_OFC_CTY_CD         = AGMT.TRSP_AGMT_OFC_CTY_CD(+) " ).append("\n"); 
		query.append("                AND         A.TRSP_AGMT_SEQ             = AGMT.TRSP_AGMT_SEQ(+) " ).append("\n"); 
		query.append("                AND         B.VNDR_SEQ                     = EDI.VNDR_SEQ " ).append("\n"); 
		query.append("                AND         C.RAIL_CMB_THRU_TP_CD         IN ('S2R', 'S3R') " ).append("\n"); 
		query.append("                GROUP BY     A.TRSP_SO_OFC_CTY_CD                                                " ).append("\n"); 
		query.append("                        ,    A.TRSP_SO_SEQ                                                " ).append("\n"); 
		query.append("                        ,    A.VNDR_SEQ                                                " ).append("\n"); 
		query.append("                        ,    B.USA_EDI_CD                                                " ).append("\n"); 
		query.append("                        ,    A.TO_NOD_CD                                                " ).append("\n"); 
		query.append("                        ,    PRD.INLND_ROUT_JUNC_NM                                                " ).append("\n"); 
		query.append("                        ,    MST.ROUT_PLN_CD                                                " ).append("\n"); 
		query.append("                        ,    A.RAIL_CRR_TP_CD " ).append("\n"); 
		query.append("                ORDER BY     TRSP_SO_SEQ                                                                         " ).append("\n"); 
		query.append("                ) O                                                                                                " ).append("\n"); 
		query.append("        ,        (                                                                                                " ).append("\n"); 
		query.append("                SELECT         A.TRSP_SO_OFC_CTY_CD                                                " ).append("\n"); 
		query.append("                        ,    A.TRSP_SO_SEQ                                                " ).append("\n"); 
		query.append("                        ,    MAX(FDA_DECL_FLG) FDA" ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 1, LADELINE, '')) LADELINE1                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 2, LADELINE, '')) LADELINE2                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 3, LADELINE, '')) LADELINE3                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 4, LADELINE, '')) LADELINE4                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 5, LADELINE, '')) LADELINE5                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 1, LADEDESC, '')) LADEDESC1                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 2, LADEDESC, '')) LADEDESC2                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 3, LADEDESC, '')) LADEDESC3                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 4, LADEDESC, '')) LADEDESC4                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 5, LADEDESC, '')) LADEDESC5                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 1, COMMCODE, '')) COMMCODE1                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 2, COMMCODE, '')) COMMCODE2                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 3, COMMCODE, '')) COMMCODE3                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 4, COMMCODE, '')) COMMCODE4                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 5, COMMCODE, '')) COMMCODE5                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 1, NISCOMM, '')) NISCOMM1                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 2, NISCOMM, '')) NISCOMM2                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 3, NISCOMM, '')) NISCOMM3                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 4, NISCOMM, '')) NISCOMM4                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 5, NISCOMM, '')) NISCOMM5                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 1, NISRETP, '')) NISRETP1                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 2, NISRETP, '')) NISRETP2                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 3, NISRETP, '')) NISRETP3                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 4, NISRETP, '')) NISRETP4                                                " ).append("\n"); 
		query.append("                        ,    MAX(DECODE(LADELINE, 5, NISRETP, '')) NISRETP5                                                " ).append("\n"); 
		query.append("                        ,(" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ ,  1, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ ,  2, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ ,  3, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ ,  4, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ ,  5, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ ,  6, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ ,  7, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ ,  8, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ ,  9, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 10, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 11, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 12, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 13, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 14, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 15, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 16, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 17, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 18, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 19, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 20, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 21, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 22, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 23, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 24, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 25, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 26, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 27, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 28, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 29, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 30, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 31, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 32, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 33, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 34, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 35, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 36, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 37, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 38, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 39, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 40, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 41, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 42, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 43, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 44, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 45, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 46, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 47, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 48, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 49, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 50, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 51, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 52, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 53, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 54, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 55, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 56, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 57, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 58, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 59, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 60, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 61, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 62, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 63, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 64, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 65, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 66, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 67, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 68, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 69, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 70, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 71, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 72, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 73, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 74, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 75, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 76, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 77, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 78, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 79, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 80, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 81, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 82, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 83, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 84, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 85, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 86, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 87, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 88, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 89, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 90, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 91, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 92, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 93, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 94, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 95, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 96, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 97, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 98, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 99, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||" ).append("\n"); 
		query.append("                            MAX( DECODE( B.SEQ , 100, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))" ).append("\n"); 
		query.append("                        ) AS BL_NO1" ).append("\n"); 
		query.append("                FROM         (                                                                                                 " ).append("\n"); 
		query.append("                            SELECT     A.TRSP_SO_OFC_CTY_CD                                                                    " ).append("\n"); 
		query.append("                                ,    A.TRSP_SO_SEQ                                                                    " ).append("\n"); 
		query.append("                                ,   DECODE(A.TRSP_BND_CD, 'O', 1, RANK() OVER (PARTITION BY D.BKG_NO, D.CNTR_NO ORDER BY D.BKG_NO, D.CNTR_NO, D.CNTR_MF_SEQ)) AS LADELINE" ).append("\n"); 
		query.append("                                ,    DECODE(A.CGO_TP_CD, 'F', DECODE(A.TRSP_BND_CD, 'O', NVL(F.CMDT_NM, E.REP_CMDT_NM), " ).append("\n"); 
		query.append("                                        DECODE(D.CNTR_MF_SEQ, '01', NVL(REPLACE(REPLACE(REPLACE(D.CNTR_MF_GDS_DESC, CHR(13), ' '), CHR(10), ' '), CHR(43), ''), " ).append("\n"); 
		query.append("                                        E.REP_CMDT_NM), REPLACE(REPLACE(D.CNTR_MF_GDS_DESC, CHR(13), ' '), CHR(10), ' '))), 'F.A.K' " ).append("\n"); 
		query.append("                                    ) LADEDESC                                                                    " ).append("\n"); 
		query.append("                                ,    DECODE(                                                                     " ).append("\n"); 
		query.append("                                            A.CGO_TP_CD, 'F', DECODE(A.TRSP_BND_CD, 'I', DECODE(VD.USA_EDI_CD||B.SC_NO||B.REP_CMDT_CD, " ).append("\n"); 
		query.append("                                            'UPAEF2288867', '2541189', 'UPAEF2288862', '2541164',  " ).append("\n"); 
		query.append("                                            'UPAEF2127162', '2541164', 'UPAEF2127167', '2541189', 'UPAEF2127169', '2541164', 'UPAEF2127161', '2541192', 'UPAEF2127168', '2541164', " ).append("\n"); 
		query.append("                                            'UPGLO9100167', '2541189', 'UPGLO9100169', '2541164', 'UPGLO9100162', '2541164', 'UPGLO9100173', '2541192', 'UPGLO9100126', '2541192', 'UPGLO9100170', '2541164',  " ).append("\n"); 
		query.append("                                            'UPAEF2164186', '2541192', 'UPAEF2164126', '2541192',  " ).append("\n"); 
		query.append("                                            'UPAEF2070662', '2541164', 'UPAEF2070685', '2541164', 'UPAEF2070669', '2541164', 'UPAEF2070626', '2541192',  " ).append("\n"); 
		query.append("                                            'UPAEF2070262', '2541164', 'UPAEF2070285', '2541164', 'UPAEF2070269', '2541164', 'UPAEF2070226', '2541192',  " ).append("\n"); 
		query.append("                                            'UPAEF2138467', '2541189', 'UPAEF2138462', '2541164', 'UPAEF2138469', '2541164',  " ).append("\n"); 
		query.append("                                            'UPAEF2131062', '2541164', 'UPGLO9080146', '2541164', '4611110'), DECODE(B.SPCL_HIDE_FLG, 'Y', '2014116', '4611110')), '4221130' " ).append("\n"); 
		query.append("                                            ) COMMCODE                                                                    " ).append("\n"); 
		query.append("                                ,    B.CMDT_CD NISCOMM                                                                    " ).append("\n"); 
		query.append("                                ,    B.REP_CMDT_CD NISRETP                                                                    " ).append("\n"); 
		query.append("                                ,    TF.FDA_DECL_FLG" ).append("\n"); 
		query.append("                            FROM     TRS_TRSP_RAIL_BIL_ORD A                                                                    " ).append("\n"); 
		query.append("                                ,    TRS_TRSP_RAIL_BIL_VNDR_SET AB                                                                    " ).append("\n"); 
		query.append("                                ,    BKG_BOOKING B                                                                    " ).append("\n"); 
		query.append("                                ,    BKG_CONTAINER C                                                                    " ).append("\n"); 
		query.append("                                ,    BKG_CNTR_MF_DESC D                                                                    " ).append("\n"); 
		query.append("                                ,    MDM_REP_CMDT E                                                                    " ).append("\n"); 
		query.append("                                ,    MDM_COMMODITY F                                                                    " ).append("\n"); 
		query.append("                                ,    BKG_RATE BRH                                                                    " ).append("\n"); 
		query.append("                                ,    MDM_VENDOR VD                                                                    " ).append("\n"); 
		query.append("                                ,    TRS_TRSP_EDI_TMP STMP                                                                    " ).append("\n"); 
		query.append("                                ,    BKG_HAMO_TRF TF" ).append("\n"); 
		query.append("                            WHERE     A.BKG_NO                 = B.BKG_NO(+)" ).append("\n"); 
		query.append("                            AND     A.BKG_NO                 = C.BKG_NO(+)" ).append("\n"); 
		query.append("                            AND     A.EQ_NO                 = C.CNTR_NO(+) " ).append("\n"); 
		query.append("                            AND     A.BKG_NO                 = D.BKG_NO(+)" ).append("\n"); 
		query.append("                            AND     A.EQ_NO                    = D.CNTR_NO(+)" ).append("\n"); 
		query.append("                            AND     B.REP_CMDT_CD             = E.REP_CMDT_CD(+) " ).append("\n"); 
		query.append("                            AND     B.CMDT_CD                 = F.CMDT_CD(+) " ).append("\n"); 
		query.append("                            AND     A.BKG_NO                 = BRH.BKG_NO(+)" ).append("\n"); 
		query.append("                            AND     A.TRSP_SO_OFC_CTY_CD     = AB.TRSP_SO_OFC_CTY_CD " ).append("\n"); 
		query.append("                            AND     A.TRSP_SO_SEQ             = AB.TRSP_SO_SEQ " ).append("\n"); 
		query.append("                            AND     AB.SUB_RAIL_SEQ         = 1 " ).append("\n"); 
		query.append("                            AND     AB.VNDR_SEQ             = VD.VNDR_SEQ(+) " ).append("\n"); 
		query.append("                            AND     D.CMDT_HS_CD             = TF.HAMO_TRF_CD(+)" ).append("\n"); 
		query.append("                            AND     STMP.TRSP_EDI_SND_NO     = @[strsp_edi_snd_no] " ).append("\n"); 
		query.append("                            AND     A.TRSP_SO_OFC_CTY_CD     = STMP.TRSP_SO_OFC_CTY_CD " ).append("\n"); 
		query.append("                            AND     A.TRSP_SO_SEQ             = STMP.TRSP_SO_SEQ " ).append("\n"); 
		query.append("                            ) A                                                                    " ).append("\n"); 
		query.append("                        ,    (                                                                    " ).append("\n"); 
		query.append("                            SELECT     A.TRSP_SO_OFC_CTY_CD                                                                    " ).append("\n"); 
		query.append("                                ,    A.TRSP_SO_SEQ                                                                    " ).append("\n"); 
		query.append("                                ,    RANK() OVER (PARTITION BY A.TRSP_SO_OFC_CTY_CD, A.TRSP_SO_SEQ                  " ).append("\n"); 
		query.append("                                           ORDER BY BK.BKG_NO) SEQ                                " ).append("\n"); 
		query.append("                                ,    BK.BKG_NO                                                                    " ).append("\n"); 
		query.append("                                ,    BC.CNTR_NO                                                                    " ).append("\n"); 
		query.append("                                ,    BK.VSL_CD                                                                    " ).append("\n"); 
		query.append("                                ,    BK.SKD_VOY_NO                                                                    " ).append("\n"); 
		query.append("                                ,    BK.SKD_DIR_CD                                                                    " ).append("\n"); 
		query.append("                                ,    BK.POL_CD                                                                    " ).append("\n"); 
		query.append("                                ,    BK.POD_CD                                                                    " ).append("\n"); 
		query.append("                                ,    BK.BL_NO BL_NO                                                                    " ).append("\n"); 
		query.append("                                ,    BC.PCK_QTY                                                                    " ).append("\n"); 
		query.append("                                ,    DECODE(BC.WGT_UT_CD, 'KGS', NVL(BC.CNTR_WGT, 0) * 2.2,  NVL(BC.CNTR_WGT, 0 ) ) CNTR_WGT    " ).append("\n"); 
		query.append("                            FROM      BKG_CONTAINER BC                                                                    " ).append("\n"); 
		query.append("                                ,    BKG_BOOKING BK                                                                    " ).append("\n"); 
		query.append("                                ,    TRS_TRSP_RAIL_BIL_ORD A                                                                    " ).append("\n"); 
		query.append("                                ,    TRS_TRSP_EDI_TMP STMP    " ).append("\n"); 
		query.append("                            WHERE    BC.BKG_NO                     = BK.BKG_NO" ).append("\n"); 
		query.append("                                    AND BK.BKG_STS_CD            <> 'X'    " ).append("\n"); 
		query.append("                                    AND STMP.TRSP_EDI_SND_NO     = @[strsp_edi_snd_no]    " ).append("\n"); 
		query.append("                                    AND A.TRSP_SO_OFC_CTY_CD     = STMP.TRSP_SO_OFC_CTY_CD     " ).append("\n"); 
		query.append("                                    AND A.TRSP_SO_SEQ             = STMP.TRSP_SO_SEQ     " ).append("\n"); 
		query.append("                                    AND A.EQ_NO                 = BC.CNTR_NO    " ).append("\n"); 
		query.append("                                    AND A.VSL_CD                 = BK.VSL_CD    " ).append("\n"); 
		query.append("                                    AND A.SKD_VOY_NO             = BK.SKD_VOY_NO    " ).append("\n"); 
		query.append("                                    AND A.SKD_DIR_CD             = BK.SKD_DIR_CD    " ).append("\n"); 
		query.append("                                    AND A.POL_CD                = BK.POL_CD    " ).append("\n"); 
		query.append("                                    AND A.POD_CD                = BK.POD_CD    " ).append("\n"); 
		query.append("                            ) B    " ).append("\n"); 
		query.append("                WHERE        A.TRSP_SO_OFC_CTY_CD     = B.TRSP_SO_OFC_CTY_CD (+)    " ).append("\n"); 
		query.append("                AND         A.TRSP_SO_SEQ             = B.TRSP_SO_SEQ (+)        " ).append("\n"); 
		query.append("                GROUP BY     A.TRSP_SO_OFC_CTY_CD                                                                    " ).append("\n"); 
		query.append("                        ,    A.TRSP_SO_SEQ                                                                        " ).append("\n"); 
		query.append("                            ) SP                             " ).append("\n"); 
		query.append("WHERE         A.TRSP_SO_OFC_CTY_CD             = O.TRSP_SO_OFC_CTY_CD " ).append("\n"); 
		query.append("AND         A.TRSP_SO_SEQ                     = O.TRSP_SO_SEQ " ).append("\n"); 
		query.append("AND         A.TRSP_SO_OFC_CTY_CD             = SP.TRSP_SO_OFC_CTY_CD  " ).append("\n"); 
		query.append("AND         A.TRSP_SO_SEQ                     = SP.TRSP_SO_SEQ  " ).append("\n"); 
		query.append("AND         O.VNDR_SEQ                         = C.VNDR_SEQ(+) " ).append("\n"); 
		query.append("AND         A.BKG_NO                         = D.BKG_NO(+)" ).append("\n"); 
		query.append("AND         A.EQ_NO                         = D.CNTR_NO(+) " ).append("\n"); 
		query.append("AND         A.BL_NO                         = AI.BL_NO(+)" ).append("\n"); 
		query.append("AND         'US'                             = AI.CNT_CD(+)" ).append("\n"); 
		query.append("AND         O.FM_NOD_CD                     = I.YD_CD " ).append("\n"); 
		query.append("AND         O.TO_NOD_CD                     = K.YD_CD" ).append("\n"); 
		query.append("AND         I.LOC_CD                     = LOC1.LOC_CD(+)" ).append("\n"); 
		query.append("AND         K.LOC_CD                     = LOC2.LOC_CD(+)" ).append("\n"); 
		query.append("AND         A.BKG_NO                         = J.BKG_NO(+)" ).append("\n"); 
		query.append("AND         J.BKG_CUST_TP_CD(+)             = 'S' " ).append("\n"); 
		query.append("AND         A.BKG_NO                         = L.BKG_NO(+)" ).append("\n"); 
		query.append("AND         L.BKG_CUST_TP_CD(+)             = 'C' " ).append("\n"); 
		query.append("AND         A.BKG_NO                         = N.BKG_NO(+)" ).append("\n"); 
		query.append("AND         N.BKG_CUST_TP_CD(+)             = 'N' " ).append("\n"); 
		query.append("AND         A.BKG_NO                         = BF.BKG_NO(+)" ).append("\n"); 
		query.append("AND         BF.BKG_CUST_TP_CD(+)             = 'F'  " ).append("\n"); 
		query.append("AND         A.BKG_NO                         = BE.BKG_NO(+)" ).append("\n"); 
		query.append("AND         BE.BKG_CUST_TP_CD(+)             = 'E'  " ).append("\n"); 
		query.append("AND         A.BKG_NO                         = M.BKG_NO(+)" ).append("\n"); 
		query.append("AND         A.EQ_NO                         = M.CNTR_NO(+) " ).append("\n"); 
		query.append("AND         A.BKG_NO                         = P.BKG_NO(+)" ).append("\n"); 
		query.append("AND         A.VSL_CD                         = Q.VSL_CD(+) " ).append("\n"); 
		query.append("AND         P.DCGO_SEQ(+)                    = 1 " ).append("\n"); 
		query.append("AND         P.IMDG_UN_NO                      = R.UN_CMDT_CD(+) " ).append("\n"); 
		query.append("AND         P.IMDG_CLSS_CD||P.IMDG_COMP_GRP_CD = R.HZD_MTRL_CLSS_CD(+) " ).append("\n"); 
		query.append("AND            NVL(R.STCC_CD, 'N/A') = NVL((" ).append("\n"); 
		query.append("                                            SELECT " ).append("\n"); 
		query.append("                                                MIN(TST.STCC_CD)" ).append("\n"); 
		query.append("                                            FROM" ).append("\n"); 
		query.append("                                                TRS_STCC TST" ).append("\n"); 
		query.append("                                            WHERE    TST.UN_CMDT_CD = P.IMDG_UN_NO" ).append("\n"); 
		query.append("                                               AND        TST.HZD_MTRL_CLSS_CD = P.IMDG_CLSS_CD||P.IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("                                        ), 'N/A')" ).append("\n"); 
		query.append("AND         NVL(A.POL_NOD_CD,  A.FM_NOD_CD) = S.EDI_RCV_NOD_CD(+)  " ).append("\n"); 
		query.append("AND         NVL(A.POD_NOD_CD,  A.TO_NOD_CD) = T.EDI_RCV_NOD_CD(+)  " ).append("\n"); 
		query.append("AND         A.BKG_NO                         = BK.BKG_NO(+)" ).append("\n"); 
		query.append("AND         A.DELT_FLG                         = 'N' " ).append("\n"); 
		query.append("AND         A.BL_NO                         = CND.BL_NO(+)" ).append("\n"); 
		query.append("AND         DECODE( A.TRSP_BND_CD, 'I', DECODE(SUBSTR(A.TO_NOD_CD,1,2), 'US', 'US', 'CA', 'CA', '')," ).append("\n"); 
		query.append("                    'O', DECODE(SUBSTR(A.FM_NOD_CD,1,2), 'US', 'US', 'CA', 'CA', ''), '') = CND.CNT_CD(+)" ).append("\n"); 
		query.append("AND         CND.VSL_CD                        = CV.VSL_CD(+) " ).append("\n"); 
		query.append("AND         CND.SKD_VOY_NO                     = CV.SKD_VOY_NO(+) " ).append("\n"); 
		query.append("AND         CND.SKD_DIR_CD                     = CV.SKD_DIR_CD(+) " ).append("\n"); 
		query.append("AND         SCST.CUST_CNT_CD(+) = J.CUST_CNT_CD " ).append("\n"); 
		query.append("AND         SCST.CUST_SEQ(+) = J.CUST_SEQ " ).append("\n"); 
		query.append("AND         SCST.PRMRY_CHK_FLG(+) = 'Y' " ).append("\n"); 
		query.append("AND         SCST.DELT_FLG(+) = 'N' " ).append("\n"); 
		query.append("AND         CCST.CUST_CNT_CD(+) = L.CUST_CNT_CD " ).append("\n"); 
		query.append("AND         CCST.CUST_SEQ(+) = L.CUST_SEQ " ).append("\n"); 
		query.append("AND         CCST.PRMRY_CHK_FLG(+) = 'Y' " ).append("\n"); 
		query.append("AND         CCST.DELT_FLG(+) = 'N' " ).append("\n"); 
		query.append("AND         NCST.CUST_CNT_CD(+) = N.CUST_CNT_CD " ).append("\n"); 
		query.append("AND         NCST.CUST_SEQ(+) = N.CUST_SEQ " ).append("\n"); 
		query.append("AND         NCST.PRMRY_CHK_FLG(+) = 'Y' " ).append("\n"); 
		query.append("AND         NCST.DELT_FLG(+) = 'N' " ).append("\n"); 
		query.append("AND         A.BKG_NO = DGP.BKG_NO(+)" ).append("\n"); 
		query.append("AND         DGP.DCGO_SEQ(+) = 2" ).append("\n"); 
		query.append("AND         DECODE(K.OFC_CD, 'VANBB', 'SLCSC', 'SEASC', 'SLCSC', 'PDXBB', 'SLCSC', 'LGBSC', 'PHXSA', 'SFOBB', 'PHXSA', 'HOUSC', 'SAVBO', 'DALSO', 'SAVBO', K.OFC_CD) = OFC.OFC_CD(+) " ).append("\n"); 
		query.append("ORDER BY     C.USA_EDI_CD                                                                    " ).append("\n"); 
		query.append("        ,    A.TRSP_SO_SEQ" ).append("\n"); 

	}
}