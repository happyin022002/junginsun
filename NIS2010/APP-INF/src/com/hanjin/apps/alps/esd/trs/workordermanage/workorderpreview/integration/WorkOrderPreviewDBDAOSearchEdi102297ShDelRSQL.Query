<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WorkOrderPreviewDBDAOSearchEdi102297ShDelRSQL">
			<desc><![CDATA[searchEdi_102297_SH_DEL]]></desc>
			<sql><![CDATA[
SELECT so.to_nod_cd del_cy
 		,yd_nm del_cy_nm
 		,DECODE(so.trsp_cost_dtl_mod_cd,'TS',so.ob_vvd_cd,DECODE(so.trsp_bnd_cd, 'I',so.ib_vvd_cd,so.ob_vvd_cd)) out_vvd
 		,vsl_eng_nm vsl_eng_nm
 		,SUBSTR(DECODE(so.trsp_cost_dtl_mod_cd,'TS',so.ob_vvd_cd,DECODE(so.trsp_bnd_cd, 'I',so.ib_vvd_cd,so.ob_vvd_cd)),5) voy_dir
 		,TO_CHAR(vps.vps_eta_dt,'YYYYMMDD') eta_dt
 		,SUM(DECODE(SUBSTR(so.eq_tpsz_cd,2,1),'2',1,0)) qty_teu_s
 		,SUM(DECODE(SUBSTR(so.eq_tpsz_cd,2,1),'2',0,1)) qty_feu_s
 		,ROUND(SUM(DECODE(SUBSTR(so.eq_tpsz_cd,2,1),'2',DECODE(so.wgt_meas_ut_cd ,'LBS',cntr_wgt/2.2,cntr_wgt),0)),2) wgt_teu_s
 		,ROUND(SUM(DECODE(SUBSTR(so.eq_tpsz_cd,2,1),'2',0,DECODE(so.wgt_meas_ut_cd ,'LBS',cntr_wgt/2.2,cntr_wgt) )),2) wgt_feu_s
 		,SUM(NVL(so.bzc_amt,0) + NVL(so.nego_amt,0)+ NVL(so.etc_add_amt,0) + NVL(so.toll_fee_amt,0))	amt_s
 	FROM mdm_yard yd
     	,mdm_vsl_cntr vc
     	,vsk_vsl_port_skd vps
     	,trs_trsp_wrk_ord wo
     	,trs_trsp_svc_ord so
   WHERE so.delt_flg <> 'Y'					            
 	 AND wo.trsp_wo_ofc_cty_cd = @[trsp_wo_ofc_cty_cd]
 	 AND wo.trsp_wo_seq = @[trsp_wo_seq]
 	 AND wo.trsp_wo_ofc_cty_cd = so.trsp_wo_ofc_cty_cd             
 	 AND wo.trsp_wo_seq = so.trsp_wo_seq                    
 	 AND so.to_nod_cd	= yd.yd_cd                          
	 AND NVL(SUBSTR(DECODE(so.trsp_bnd_cd, 'T',so.ib_vvd_cd,'I',so.ib_vvd_cd,'O',so.ob_vvd_cd) ,1,4),SO.VSL_CD)= vc.vsl_cd
	 AND NVL(SUBSTR(DECODE(so.trsp_bnd_cd, 'T',so.ib_vvd_cd,'I',so.ib_vvd_cd,'O',so.ob_vvd_cd) ,1,4),SO.VSL_CD)= vps.vsl_cd (+)
	 AND NVL(SUBSTR(DECODE(so.trsp_bnd_cd, 'T',so.ib_vvd_cd,'I',so.ib_vvd_cd,'O',so.ob_vvd_cd) ,5,4),SO.SKD_VOY_NO)= vps.skd_voy_no(+)
	 AND NVL(SUBSTR(DECODE(so.trsp_bnd_cd, 'T',so.ib_vvd_cd,'I',so.ib_vvd_cd,'O',so.ob_vvd_cd) ,9,1),SO.SKD_DIR_CD)= vps.skd_dir_cd(+)		
 	 AND SUBSTR(so.fm_nod_cd,1,5) = vps.vps_port_cd (+)
 	 AND vps.clpt_ind_seq(+) =1
 	 AND so.hjl_no IS NULL
 	 AND wo.hjl_no IS NULL
GROUP BY so.to_nod_cd
 		,yd_nm
 		,DECODE(so.trsp_cost_dtl_mod_cd,'TS',so.ob_vvd_cd, DECODE(so.trsp_bnd_cd, 'I',so.ib_vvd_cd, so.ob_vvd_cd))
 		,vsl_eng_nm
 		,SUBSTR(so.ob_vvd_cd,5)
 		,vps.vps_eta_dt			]]></sql>
			<params>
				<param name="trsp_wo_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="trsp_wo_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
