<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PsoAdvanceAuditDBDAOSearchCostRSQL">
			<desc><![CDATA[PsoAdvanceAuditDBDAOSearchCost ]]></desc>
			<sql><![CDATA[
SELECT distinct A.LGS_COST_CD      AS COST_CD
     , B.LGS_COST_FULL_NM AS COST_NM
  FROM EAS_PORT_SO_CHG_ACCT  A
     , TES_LGS_COST B
     , MDM_ACCOUNT C
 WHERE A.LGS_COST_CD = B.LGS_COST_CD
   AND B.ACCT_CD = C.ACCT_CD
   AND B.ACCT_CD <> '999999' 
#if ( ${rhq} != '' ) 
   AND AUD_OFC_CD = @[rhq]
#end
#if ( ${divChargeType} == '1' ) 
AND   A.LGS_COST_AUD_FLG = 'Y'
#end
#if ( ${divChargeType} == '2')
    #if (${chargeType} != '04' ) 
      AND   A.LGS_COST_AUD_FLG = 'N'
    #end
#end
#if ( ${chargeType} != '' && ${chargeType} == '01' ) 
	----PORT CHARGE 선택시
	and SUBSTR(to_char(B.acct_cd),1,4) = '5117'
	and length(B.LGS_COST_CD) > 4
    and B.ACCT_CD <> '511795'
	AND C.ACCT_ENG_NM NOT LIKE 'OTHER PORT%'
#end
#if ( ${chargeType} != '' && ${chargeType} == '02' ) 
	----PORT SERVICE CHARGE 선택시
	and SUBSTR(to_char(B.acct_cd),1,4) = '5118'
	and length(B.LGS_COST_CD) > 4
    and B.ACCT_CD <> '511795'
	AND C.ACCT_ENG_NM NOT LIKE 'OTHER PORT%'
#end
#if ( ${chargeType} != '' && ${chargeType} == '03' ) 
	----Canal Transit Fee 선택시
	and SUBSTR(to_char(B.acct_cd),1,4) = '5119'
	and length(B.LGS_COST_CD) > 4
    and B.ACCT_CD <> '511795'
	AND C.ACCT_ENG_NM NOT LIKE 'OTHER PORT%'
#end
#if ( ${chargeType} != '' && ${chargeType} == '04' ) 
	----Other 선택시
	AND (B.ACCT_CD = '564611' OR B.ACCT_CD = '511795' OR C.ACCT_ENG_NM LIKE 'OTHER PORT%')
#end
#if ( ${acct_cd} != '') 
	----Other 선택시
	AND B.ACCT_CD = @[acct_cd]
#end

ORDER BY 1			]]></sql>
			<params>
				<param name="rhq" type="12" value="" out="N"/>
				<param name="acct_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
