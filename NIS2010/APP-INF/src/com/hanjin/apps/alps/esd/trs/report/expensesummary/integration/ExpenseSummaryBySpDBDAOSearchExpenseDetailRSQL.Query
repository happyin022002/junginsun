<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ExpenseSummaryBySpDBDAOSearchExpenseDetailRSQL">
			<desc><![CDATA[Service Provider 별로 Cost Mode, Trans Mode, S/O Type별, From, Via, Door, To별 운송컨테이너 숫자 및 운송금액 집계내역을 조회

Change History 
1. 2013-01-16
   신용찬 수석
   MONTH, BOUND 추가후 속도개선을 위한 SQL 변경 및 튜닝]]></desc>
			<sql><![CDATA[
WITH WITH_RESULT 
AS
(    
                    SELECT  CRE_OFC_CD           -- W/O OR Invoice OFFICE CD
                          , CRE_MONTH
                          , TRSP_COST_DTL_MOD_CD -- COST MODE
                          , TRSP_CRR_MOD_CD      -- TRANS_MODE
                          , TRSP_BND_CD
                          , TRSP_SO_TP_CD        -- S/O TYPE
                          , MAX(TRSP_SO_TP_NM) TRSP_SO_TP_NM     -- S/O TYPE NM
                          , NOD_CD                               --CUBE로 Group by 하기 위해서는 NODE가 하나의 컬럼으로 필요하기 때문에 사용
                          , MAX(FM_NOD_CD) FM_NOD_CD
                          , MAX(VIA_NOD_CD) VIA_NOD_CD
                          , MAX(TO_NOD_CD) TO_NOD_CD
                          , MAX(DOR_NOD_CD) DOR_NOD_CD
                          , ETS_YN
                          , SUM(TTL_DIST) TTL_DIST
                          , CASE WHEN MAX(LNK_DIST_DIV_CD)= MIN(LNK_DIST_DIV_CD) THEN MAX(LNK_DIST_DIV_CD) ELSE '' END AS LNK_DIST_DIV_CD
                          , INV_CURR_CD          -- CURR
                          , MAX(VNDR_SEQ) VNDR_SEQ
                          , MAX(VNDR_ABBR_NM) VNDR_ABBR_NM
                          , DECODE(VNDR_SEQ, NULL, '', VNDR_SEQ||' ('||VNDR_ABBR_NM||')') SUB_SUM_TITLE
                          , MAX(HJL_VNDR_SEQ) HJL_VNDR_SEQ
                          , MAX(HJL_VNDR_ABBR_NM) HJL_VNDR_ABBR_NM
                          , DECODE(HJL_VNDR_SEQ, NULL, '', HJL_VNDR_SEQ||' ('||HJL_VNDR_ABBR_NM||')') HJL_SUB_SUM_TITLE 
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', INV_BZC_AMT, 0)) AS INV_BZC_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', INV_ETC_ADD_AMT, 0)) AS INV_ETC_ADD_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, INV_BZC_AMT)) AS INV_BZC_D4_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, INV_ETC_ADD_AMT)) AS INV_ETC_ADD_D4_AMT
                          , SUM(INV_BZC_AMT) AS INV_BZC_AMT
                          , SUM(INV_ETC_ADD_AMT) AS INV_ETC_ADD_AMT
                          , SUM(INV_BZC_AMT + NVL(INV_ETC_ADD_AMT, 0)) INV_TOT_AMT
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', INV_BZC_AMT, 0) / INV_USD_LOCL_XCH_RT,2), 0)) AS INV_BZC_D2_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, INV_BZC_AMT) / INV_USD_LOCL_XCH_RT,2), 0)) AS INV_BZC_D4_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', INV_ETC_ADD_AMT, 0) / INV_USD_LOCL_XCH_RT,2), 0)) AS INV_ETC_ADD_D2_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, INV_ETC_ADD_AMT) / INV_USD_LOCL_XCH_RT,2), 0)) AS INV_ETC_ADD_D4_AMT_USD
                          , SUM(NVL(ROUND(INV_BZC_AMT / INV_USD_LOCL_XCH_RT,2), 0)) AS INV_BZC_AMT_USD
                          , SUM(NVL(ROUND(INV_ETC_ADD_AMT / INV_USD_LOCL_XCH_RT,2), 0)) AS INV_ETC_ADD_AMT_USD
                          , SUM(NVL(ROUND((INV_BZC_AMT + NVL(INV_ETC_ADD_AMT, 0)) / INV_USD_LOCL_XCH_RT,2), 0)) INV_TOT_AMT_USD
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', BZC_AMT, 0)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', SCG_VAT_AMT, 0)) AS BZC_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', FUEL_SCG_AMT, 0)) AS FUEL_SCG_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', SCG_VAT_AMT, 0)) AS SCG_VAT_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', NEGO_AMT, 0)) AS NEGO_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', TOLL_FEE_AMT, 0)) AS TOLL_FEE_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', ETC_ADD_AMT, 0)) AS ETC_ADD_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', RAIL_ETC_ADD_AMT, 0)) AS RAIL_ETC_ADD_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', TRUK_ETC_ADD_AMT, 0)) AS TRUK_ETC_ADD_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', HJL_HNDL_AMT, 0)) AS HJL_HNDL_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', OVR_WGT_SCG_AMT, 0)) AS OVR_WGT_SCG_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', HZD_MTRL_SCG_AMT, 0)) AS HZD_MTRL_SCG_D2_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', BZC_AMT, 0)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', FUEL_SCG_AMT, 0)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', SCG_VAT_AMT, 0))+ SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', ETC_ADD_AMT, 0)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', HJL_HNDL_AMT, 0))+ SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', NEGO_AMT, 0))+ SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', TOLL_FEE_AMT, 0)) AS D2_AMT_SUM
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, BZC_AMT)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, SCG_VAT_AMT)) AS BZC_D4_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, FUEL_SCG_AMT)) AS FUEL_SCG_D4_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, SCG_VAT_AMT)) AS SCG_VAT_D4_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, NEGO_AMT)) AS NEGO_D4_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, TOLL_FEE_AMT)) AS TOLL_FEE_D4_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, ETC_ADD_AMT)) AS ETC_ADD_D4_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, RAIL_ETC_ADD_AMT)) AS RAIL_ETC_ADD_D4_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, TRUK_ETC_ADD_AMT)) AS TRUK_ETC_ADD_D4_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, HJL_HNDL_AMT)) AS HJL_HNDL_D4_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, OVR_WGT_SCG_AMT)) AS OVR_WGT_SCG_D4_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, HZD_MTRL_SCG_AMT)) AS HZD_MTRL_SCG_D4_AMT
                          , SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, BZC_AMT)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, FUEL_SCG_AMT)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, SCG_VAT_AMT))+ SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, ETC_ADD_AMT)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, HJL_HNDL_AMT)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, NEGO_AMT)) + SUM(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, TOLL_FEE_AMT)) AS D4_AMT_SUM
                          , SUM(BZC_AMT) + SUM(SCG_VAT_AMT) AS BZC_AMT
                          , SUM(FUEL_SCG_AMT) AS FUEL_SCG_AMT
                          , SUM(SCG_VAT_AMT) AS SCG_VAT_AMT
                          , SUM(NEGO_AMT) AS NEGO_AMT
                          , SUM(TOLL_FEE_AMT) AS TOLL_FEE_AMT
                          , SUM(ETC_ADD_AMT) AS ETC_ADD_AMT
                          , SUM(RAIL_ETC_ADD_AMT) RAIL_ETC_ADD_AMT
                          , SUM(TRUK_ETC_ADD_AMT) AS TRUK_ETC_ADD_AMT
                          , SUM(HJL_HNDL_AMT) AS HJL_HNDL_AMT
                          , SUM(OVR_WGT_SCG_AMT) AS OVR_WGT_SCG_AMT
                          , SUM(HZD_MTRL_SCG_AMT) AS HZD_MTRL_SCG_AMT
                          , SUM(BZC_AMT + FUEL_SCG_AMT + SCG_VAT_AMT + OVR_WGT_SCG_AMT + NEGO_AMT + TOLL_FEE_AMT + HZD_MTRL_SCG_AMT + ETC_ADD_AMT+HJL_HNDL_AMT) AS TOT_AMT
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', BZC_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', SCG_VAT_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS BZC_D2_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', FUEL_SCG_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS FUEL_SCG_D2_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', SCG_VAT_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS SCG_VAT_D2_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', NEGO_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS NEGO_D2_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', TOLL_FEE_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS TOLL_FEE_D2_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', ETC_ADD_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS ETC_ADD_D2_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', RAIL_ETC_ADD_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS RAIL_ETC_ADD_D2_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', TRUK_ETC_ADD_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS TRUK_ETC_ADD_D2_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', HJL_HNDL_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS HJL_HNDL_D2_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', OVR_WGT_SCG_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS OVR_WGT_SCG_D2_AMT_USD    
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', HZD_MTRL_SCG_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS HZD_MTRL_SCG_D2_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', BZC_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', FUEL_SCG_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', SCG_VAT_AMT, 0) / USD_LOCL_XCH_RT,2), 0))+SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', ETC_ADD_AMT, 0) / USD_LOCL_XCH_RT,2), 0))+SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', HJL_HNDL_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', NEGO_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', TOLL_FEE_AMT, 0) / USD_LOCL_XCH_RT,2), 0)) AS D2_AMT_SUM_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, BZC_AMT) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, SCG_VAT_AMT) / USD_LOCL_XCH_RT,2), 0)) AS BZC_D4_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, FUEL_SCG_AMT) / USD_LOCL_XCH_RT,2), 0)) AS FUEL_SCG_D4_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, SCG_VAT_AMT) / USD_LOCL_XCH_RT,2), 0)) AS SCG_VAT_D4_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, NEGO_AMT) / USD_LOCL_XCH_RT,2), 0)) AS NEGO_D4_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, TOLL_FEE_AMT) / USD_LOCL_XCH_RT,2), 0)) AS TOLL_FEE_D4_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, ETC_ADD_AMT) / USD_LOCL_XCH_RT,2), 0)) AS ETC_ADD_D4_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, RAIL_ETC_ADD_AMT) / USD_LOCL_XCH_RT,2), 0)) AS RAIL_ETC_ADD_D4_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, TRUK_ETC_ADD_AMT) / USD_LOCL_XCH_RT,2), 0)) AS TRUK_ETC_ADD_D4_AMT_USD    
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, HJL_HNDL_AMT) / USD_LOCL_XCH_RT,2), 0)) AS HJL_HNDL_D4_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, OVR_WGT_SCG_AMT) / USD_LOCL_XCH_RT,2), 0)) AS OVR_WGT_SCG_D4_AMT_USD
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, HZD_MTRL_SCG_AMT) / USD_LOCL_XCH_RT,2), 0)) AS HZD_MTRL_SCG_D4_AMT_USD 
                          , SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, BZC_AMT) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, FUEL_SCG_AMT) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, SCG_VAT_AMT) / USD_LOCL_XCH_RT,2), 0))+SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, ETC_ADD_AMT) / USD_LOCL_XCH_RT,2), 0))+SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, HJL_HNDL_AMT) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, NEGO_AMT) / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, TOLL_FEE_AMT) / USD_LOCL_XCH_RT,2), 0)) AS D4_AMT_SUM_USD
                          , SUM(NVL(ROUND(BZC_AMT / USD_LOCL_XCH_RT,2), 0)) + SUM(NVL(ROUND(SCG_VAT_AMT / USD_LOCL_XCH_RT,2), 0)) AS BZC_AMT_USD
                          , SUM(NVL(ROUND(FUEL_SCG_AMT / USD_LOCL_XCH_RT,2), 0)) AS FUEL_SCG_AMT_USD
                          , SUM(NVL(ROUND(SCG_VAT_AMT / USD_LOCL_XCH_RT,2), 0)) AS SCG_VAT_AMT_USD
                          , SUM(NVL(ROUND(NEGO_AMT / USD_LOCL_XCH_RT,2), 0)) AS NEGO_AMT_USD
                          , SUM(NVL(ROUND(TOLL_FEE_AMT / USD_LOCL_XCH_RT,2), 0)) AS TOLL_FEE_AMT_USD
                          , SUM(NVL(ROUND(ETC_ADD_AMT / USD_LOCL_XCH_RT,2), 0)) AS ETC_ADD_AMT_USD
                          , SUM(NVL(ROUND(RAIL_ETC_ADD_AMT / USD_LOCL_XCH_RT,2), 0)) AS RAIL_ETC_ADD_AMT_USD
                          , SUM(NVL(ROUND(TRUK_ETC_ADD_AMT / USD_LOCL_XCH_RT,2), 0)) AS TRUK_ETC_ADD_AMT_USD
                          , SUM(NVL(ROUND(HJL_HNDL_AMT / USD_LOCL_XCH_RT,2), 0)) AS HJL_HNDL_AMT_USD
                          , SUM(NVL(ROUND(OVR_WGT_SCG_AMT / USD_LOCL_XCH_RT,2), 0)) AS OVR_WGT_SCG_AMT_USD         
                          , SUM(NVL(ROUND(HZD_MTRL_SCG_AMT / USD_LOCL_XCH_RT,2), 0)) AS HZD_MTRL_SCG_AMT_USD 
                          , SUM(NVL(ROUND((BZC_AMT + FUEL_SCG_AMT + SCG_VAT_AMT + OVR_WGT_SCG_AMT + NEGO_AMT + TOLL_FEE_AMT + HZD_MTRL_SCG_AMT + ETC_ADD_AMT + HJL_HNDL_AMT) / USD_LOCL_XCH_RT,2), 0)) TOT_AMT_USD
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 1, 0), 0)) CNTN20
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, 1), 0)) CNTN40
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 1, 0) + (DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, 1) * 2), 0)) CNTN_TEU
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 1, 0) + DECODE(SUBSTR(EQ_TPSZ_CD,2,1), '2', 0, 1), 0)) CNTN_BOX
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'D2', 1, 0), 0)) D2_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'D4', 1, 0), 0)) D4_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'D5', 1, 0), 0)) D5_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'D7', 1, 0), 0)) D7_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'R2', 1, 0), 0)) R2_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'R4', 1, 0), 0)) R4_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'R5', 1, 'R9', 1, 0), 0)) R5_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'R7', 1, 0), 0)) R7_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'R8', 1, 0), 0)) R8_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'F2', 1, 0), 0)) F2_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'F4', 1, 0), 0)) F4_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'F5', 1, 0), 0)) F5_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'A2', 1, 0), 0)) A2_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'A4', 1, 0), 0)) A4_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'A5', 1, 0), 0)) A5_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'P2', 1, 0), 0)) P2_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'P4', 1, 0), 0)) P4_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'O2', 1, 0), 0)) O2_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'O4', 1, 0), 0)) O4_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'O5', 1, 0), 0)) O5_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'O7', 1, 0), 0)) O7_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'S2', 1, 0), 0)) S2_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'S4', 1, 0), 0)) S4_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'T2', 1, 0), 0)) T2_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'T4', 1, 0), 0)) T4_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'DX', 1, 0), 0)) DX_CNT
                          , SUM(NVL2(TRSP_SO_TP_CD, DECODE(EQ_TPSZ_CD, 'DW', 1, 0), 0)) DW_CNT
                    FROM    (
                              SELECT  /*+ USE_NL(SO,WRK,VDR,IXCH) */
#if( ${radio_office} == 'WO' )
                                      WO.CRE_OFC_CD     -- W/O OFFICE
#elseif(  ${radio_office} == 'IV' )
                                      WRK.CRE_OFC_CD    -- Invoice OFFICE
#end

#if( ${period} == 'S' )
                                    , TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM') CRE_MONTH
#elseif( ${period} == 'W' )
                                    , TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM') CRE_MONTH
#elseif( ${period} == 'I' )
                                    , TO_CHAR(WRK.INV_CFM_DT,'YYYYMM') CRE_MONTH
#else
                                    , SUBSTR(WRK.GL_DT,1,6) CRE_MONTH
#end

                                    , SO.TRSP_COST_DTL_MOD_CD -- COST MODE
                                    , SO.TRSP_CRR_MOD_CD      -- TRANS_MODE
                                    , DECODE(SO.TRSP_BND_CD,'I','I','O','O','T','T','') TRSP_BND_CD
                                    , TRSP_SO_TP_CD           -- S/O TYPE
                                    , SOTP_CD.INTG_CD_VAL_DP_DESC TRSP_SO_TP_NM  -- S/O TYPE NM
                                    , NVL(SO.INV_CURR_CD, SO.CURR_CD) INV_CURR_CD         -- CURR

#if( ${sp_tp} == 'WO' )
    #if( ${chk_prnt_provider} == 'Y' )
                                    , P_VDR.VNDR_SEQ          -- W/O Parent S/P Code
                                    , P_VDR.VNDR_ABBR_NM      -- W/O Parent S/P Name
                                    , P_VDR.VNDR_SEQ ||' ('|| P_VDR.VNDR_ABBR_NM || ')'  SUB_SUM_TITLE
                                    , P_HVDR.VNDR_SEQ   HJL_VNDR_SEQ       -- HJL W/O Parent S/P Code
                                    , P_HVDR.VNDR_ABBR_NM  HJL_VNDR_ABBR_NM      -- HJL W/O Parent S/P Name
                                    , P_HVDR.VNDR_SEQ ||' ('|| P_HVDR.VNDR_ABBR_NM || ')'  HJL_SUB_SUM_TITLE
    #else
                                    , SO.VNDR_SEQ             -- W/O S/P Code
                                    , VDR.VNDR_ABBR_NM        -- W/O S/P Name
                                    , SO.VNDR_SEQ ||' ('|| VDR.VNDR_ABBR_NM || ')'  SUB_SUM_TITLE
                                    , HSO.HJL_VNDR_SEQ  HJL_VNDR_SEQ            -- HJL W/O S/P Code
                                    , HVDR.VNDR_ABBR_NM HJL_VNDR_ABBR_NM       -- HJL W/O S/P Name
                                    , HSO.HJL_VNDR_SEQ ||' ('|| HVDR.VNDR_ABBR_NM || ')'  HJL_SUB_SUM_TITLE
    #end
#elseif( ${sp_tp} == 'IV' )
    #if( ${chk_prnt_provider} == 'Y' )
                                    , P_IVDR.VNDR_SEQ  VNDR_SEQ      -- Invoice Parent S/P Code
                                    , P_IVDR.VNDR_ABBR_NM  VNDR_ABBR_NM  -- Invoice Parent S/P Name
                                    , P_IVDR.VNDR_SEQ ||' ('|| P_IVDR.VNDR_ABBR_NM || ')'  SUB_SUM_TITLE
                                    , P_HIVDR.VNDR_SEQ  HJL_VNDR_SEQ      --HJL Invoice Parent S/P Code
                                    , P_HIVDR.VNDR_ABBR_NM  HJL_VNDR_ABBR_NM  --HJL Invoice Parent S/P Name
                                    , P_HIVDR.VNDR_SEQ ||' ('|| P_HIVDR.VNDR_ABBR_NM || ')'  HJL_SUB_SUM_TITLE
    #else
                                    , SO.INV_VNDR_SEQ    VNDR_SEQ      -- Invoice S/P Code
                                    , IVDR.VNDR_ABBR_NM  VNDR_ABBR_NM  -- Invoice S/P Name
                                    , SO.INV_VNDR_SEQ ||' ('|| IVDR.VNDR_ABBR_NM || ')'  SUB_SUM_TITLE
                                    , HSO.HJL_INV_VNDR_SEQ    HJL_VNDR_SEQ      -- HJL Invoice S/P Code
                                    , HIVDR.VNDR_ABBR_NM  HJL_VNDR_ABBR_NM  -- HJL Invoice S/P Name
                                    , HSO.HJL_INV_VNDR_SEQ ||' ('|| HIVDR.VNDR_ABBR_NM || ')'  HJL_SUB_SUM_TITLE
    #end
#end

                                    , SUBSTR(SO.EQ_TPSZ_CD,2,1) EQ_TPSZ_CD_SUB
                                    , EQ_TPSZ_CD
                                    , DECODE(WRK.TRSP_INV_AUD_STS_CD, 'CF', SO.INV_BZC_AMT, 'AR', SO.INV_BZC_AMT, 'IF', SO.INV_BZC_AMT, 'DA', SO.INV_BZC_AMT, 'PD', SO.INV_BZC_AMT, 0) INV_BZC_AMT
                                    , DECODE(WRK.TRSP_INV_AUD_STS_CD, 'CF', SO.INV_ETC_ADD_AMT, 'AR', SO.INV_ETC_ADD_AMT, 'IF', SO.INV_ETC_ADD_AMT, 'DA', SO.INV_ETC_ADD_AMT, 'PD', SO.INV_ETC_ADD_AMT, 0) INV_ETC_ADD_AMT
                                    , CASE WHEN NVL(SO.INV_CURR_CD,'USD') = 'USD' THEN 1
                                           ELSE    
                                                ( SELECT  USD_LOCL_XCH_RT 
                                                  FROM    GL_MON_XCH_RT WXCH 
                                                  WHERE   ACCT_XCH_RT_LVL = 1
                                                  AND     CURR_CD           = NVL(SO.INV_CURR_CD, SO.CURR_CD) 
                                                  AND     ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WRK.LOCL_CRE_DT,'YYYYMM'),NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM'))) 
                                                )
                                      END INV_USD_LOCL_XCH_RT
                                    , CASE WHEN NVL(SO.CURR_CD,'USD') = 'USD' THEN 1
                                           ELSE    
                                                ( SELECT  USD_LOCL_XCH_RT 
                                                  FROM    GL_MON_XCH_RT WXCH 
                                                  WHERE   ACCT_XCH_RT_LVL = 1
                                                  AND     CURR_CD           = SO.CURR_CD 
                                                  AND     ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM')) 
                                                )
                                      END USD_LOCL_XCH_RT
                                    , NVL(SO.BZC_AMT,0) BZC_AMT
                                    , NVL(SO.ETC_ADD_AMT,0) ETC_ADD_AMT
                                    , NVL(SO.ETC_ADD_AMT,0) TRUK_ETC_ADD_AMT
                                    , NVL(SO.HJL_HNDL_AMT,0) HJL_HNDL_AMT
                                    , 0 RAIL_ETC_ADD_AMT
                                    , NVL(SO.FUEL_SCG_AMT,0) FUEL_SCG_AMT
                                    , NVL(SO.SCG_VAT_AMT,0) SCG_VAT_AMT
                                    , NVL(SO.NEGO_AMT,0) NEGO_AMT
                                    , NVL(SO.TOLL_FEE_AMT,0) TOLL_FEE_AMT
                                    , SUBSTR(SO.FM_NOD_CD,1,@[node_div])  FM_NOD_CD
                                    , SUBSTR(SO.VIA_NOD_CD,1,@[node_div]) VIA_NOD_CD
                                    , SUBSTR(SO.TO_NOD_CD,1,@[node_div])  TO_NOD_CD
                                    , SUBSTR(SO.DOR_NOD_CD,1,@[node_div]) DOR_NOD_CD
                                    , NVL(SUBSTR(SO.FM_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(SO.VIA_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(SO.TO_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(SO.DOR_NOD_CD,1,@[node_div]), '') NOD_CD
                                    , 0 AS OVR_WGT_SCG_AMT
                                    , 0 AS HZD_MTRL_SCG_AMT
                                    , NVL(SO.TTL_DIST,0) TTL_DIST
                                    , SO.LNK_DIST_DIV_CD
                                    , DECODE(SO.HJL_NO,'','N','Y') ETS_YN
                              FROM    TRS_TRSP_SVC_ORD SO
                                    , TRS_TRSP_HJL_SVC_ORD HSO
                                    , TRS_TRSP_WRK_ORD WO
                                    , TRS_TRSP_INV_WRK WRK
                                    , COM_INTG_CD_DTL SOTP_CD
                                    , ( SELECT  /*+ USE_NL(A,B) */
                                                A.TRSP_SO_OFC_CTY_CD
                                              , A.TRSP_SO_SEQ
                                              , DECODE(A.HJL_NO,'',A.VNDR_SEQ,B.HJL_VNDR_SEQ) VNDR_SEQ
                                              , DECODE(A.HJL_NO,'',A.INV_VNDR_SEQ,B.HJL_INV_VNDR_SEQ) INV_VNDR_SEQ
                                        FROM    TRS_TRSP_SVC_ORD A
                                              , TRS_TRSP_HJL_SVC_ORD B
                                        WHERE   A.TRSP_SO_OFC_CTY_CD = B.TRSP_SO_OFC_CTY_CD(+)
                                        AND     A.TRSP_SO_SEQ = B.TRSP_SO_SEQ(+)
                                        AND     A.DELT_FLG = 'N'
                                      ) ACT_VNDR
#if( ${sp_tp} == 'WO' )
                                    , MDM_VENDOR       VDR
                                    , MDM_VENDOR       HVDR
#elseif( ${sp_tp} == 'IV' )
                                    , MDM_VENDOR       IVDR
                                    , MDM_VENDOR       HIVDR
#end
#if( ${chk_prnt_provider} == 'Y' )
                -- Parent S/P를 체크하였을 경우
    #if( ${sp_tp} == 'WO' )
                                    , MDM_VENDOR       P_VDR
                                    , MDM_VENDOR       P_HVDR
    #elseif( ${sp_tp} == 'IV' )
                                    , MDM_VENDOR       P_IVDR
                                    , MDM_VENDOR       P_HIVDR
    #end
#end


                              WHERE   SO.TRSP_WO_OFC_CTY_CD  = WO.TRSP_WO_OFC_CTY_CD(+)
                              AND     SO.TRSP_WO_SEQ         = WO.TRSP_WO_SEQ(+)
                              AND     SO.TRSP_SO_OFC_CTY_CD  = HSO.TRSP_SO_OFC_CTY_CD(+)
                              AND     SO.TRSP_SO_SEQ         = HSO.TRSP_SO_SEQ(+)
                              AND     SO.TRSP_SO_OFC_CTY_CD   = ACT_VNDR.TRSP_SO_OFC_CTY_CD
                              AND     SO.TRSP_SO_SEQ            = ACT_VNDR.TRSP_SO_SEQ
                              AND     SO.INV_NO              = WRK.INV_NO(+)
                              AND     SO.INV_VNDR_SEQ        = WRK.INV_VNDR_SEQ(+)
                              AND     SO.DELT_FLG            = 'N'
#if( ${sp_tp} == 'WO' )
                              AND     SO.VNDR_SEQ            = VDR.VNDR_SEQ(+)
                              AND     HSO.HJL_VNDR_SEQ       = HVDR.VNDR_SEQ(+)
#elseif( ${sp_tp} == 'IV' )
                              AND     SO.INV_VNDR_SEQ        = IVDR.VNDR_SEQ(+)
                              AND     SO.INV_VNDR_SEQ        IS NOT NULL
                              AND     HSO.HJL_INV_VNDR_SEQ   = HIVDR.VNDR_SEQ(+)
#end

                              AND     SOTP_CD.INTG_CD_ID(+) = 'CD00279'
                              AND     SOTP_CD.INTG_CD_VAL_CTNT(+)  = SO.TRSP_SO_TP_CD
                              AND     SO.EQ_KND_CD = 'U'
#if( ${chk_prnt_provider} == 'Y' )
        --Parent S/P를 체크하였을 경우
    #if( ${sp_tp} == 'WO' )
                              AND     VDR.PRNT_VNDR_SEQ      = P_VDR.VNDR_SEQ
                              AND     HVDR.PRNT_VNDR_SEQ      = P_HVDR.VNDR_SEQ(+)
    #elseif( ${sp_tp} == 'IV' )
                              AND     IVDR.PRNT_VNDR_SEQ     = P_IVDR.VNDR_SEQ
                              AND     HIVDR.PRNT_VNDR_SEQ     = P_HIVDR.VNDR_SEQ(+)
    #end
#end

#if (${bndcd} == 'I')
                              AND     SO.TRSP_BND_CD = 'I'
#elseif (${bndcd} == 'O')
                              AND     SO.TRSP_BND_CD = 'O'
#elseif (${bndcd} == 'T')
                              AND     SO.TRSP_BND_CD = 'T'
#elseif (${bndcd} == 'P')
                              AND     SO.TRSP_BND_CD IN ('I','O')
#end

#if( !((${FromDate} == '') && (${ToDate} == '')))
    #if( ${period} == 'S' )
                              AND     SO.LOCL_CRE_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'W' )
                              AND     WO.LOCL_CRE_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'I' )
                              AND     WRK.INV_CFM_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'G' )
                              AND     WRK.GL_DT BETWEEN '${FromDate}' AND '${ToDate}'
    #else
                              AND     1 = 2
    #end
#else
                              AND     1 = 2
#end

    #if($statusCdArr.size() > 0)
                              AND     WRK.TRSP_INV_AUD_STS_CD IN (
        #foreach( ${key} in ${statusCdArr})
            #if($velocityCount == 1)
            '${key}'
            #else
            , '${key}'
            #end
        #end
            )
    #end

#if( ${status_cd} == 'INV' )
                              AND     WRK.TRSP_INV_AUD_STS_CD IN ('RC','SV','CF','AR','DA','IF','RJ','PD')
#end 

#if( ${radio_office} == 'WO' )
    #if($inputOfcArr.size() > 0)
                              AND     WO.CRE_OFC_CD IN (
        #foreach( ${key} in ${inputOfcArr})
            #if($velocityCount == 1)
            UPPER('${key}')
            #else
            , UPPER('${key}')
            #end
        #end
            )
    #end
#elseif( ${radio_office} == 'IV' )
    #if($inputOfcArr.size() > 0)
                              AND     WRK.CRE_OFC_CD IN (
        #foreach( ${key} in ${inputOfcArr})
            #if($velocityCount == 1)
            UPPER('${key}')
            #else
            , UPPER('${key}')
            #end
        #end
            )
    #end
#end
#if($costmodeArr.size() > 0)
                    AND     SO.TRSP_COST_DTL_MOD_CD IN (
    #foreach( ${key} in ${costmodeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

#if($transmodeArr.size() > 0)
                    AND     SO.TRSP_CRR_MOD_CD IN (
    #foreach( ${key} in ${transmodeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

#if($sotypeArr.size() > 0)
                    AND     SO.TRSP_SO_TP_CD IN (
    #foreach( ${key} in ${sotypeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

#if( !(${svc_provider} == '' ) )
    #if( ${sp_tp} == 'WO' )
        #if( ${chk_prnt_provider} == 'Y' )
                              AND     ACT_VNDR.VNDR_SEQ IN (SELECT VNDR_SEQ
                                          FROM MDM_VENDOR
                                         WHERE PRNT_VNDR_SEQ = ${svc_provider_prnt})
        #else
                              AND     ACT_VNDR.VNDR_SEQ = ${svc_provider}
        #end
    #elseif( ${sp_tp} == 'IV' )
        #if( ${chk_prnt_provider} == 'Y' )
                              AND     ACT_VNDR.INV_VNDR_SEQ IN (SELECT VNDR_SEQ
                                              FROM MDM_VENDOR
                                             WHERE PRNT_VNDR_SEQ = ${svc_provider_prnt})
        #else
                              AND     ACT_VNDR.INV_VNDR_SEQ = ${svc_provider}
        #end
    #end
#end
#if( ${svc_provider} == '' &&  !(${svc_provider_prnt} == '') )
    #if( ${sp_tp} == 'WO' )
                              AND     ACT_VNDR.VNDR_SEQ IN (SELECT VNDR_SEQ
                                          FROM MDM_VENDOR
                                            WHERE PRNT_VNDR_SEQ = ${svc_provider_prnt})
    #elseif( ${sp_tp} == 'IV' )
                              AND     ACT_VNDR.INV_VNDR_SEQ IN (SELECT VNDR_SEQ
                                                 FROM MDM_VENDOR
                                                WHERE PRNT_VNDR_SEQ = ${svc_provider_prnt})
    #end
#end
#if( !(${from_node} == '' || ${from_node} == 'ALL') )
                              AND     SO.fm_nod_cd like '${from_node}'||'%'
#end
#if( !(${via_node} == '' || ${via_node} == 'ALL') )
                              AND     SO.via_nod_cd like '${via_node}'||'%'
#end
#if( !(${to_node} == '' || ${to_node} == 'ALL') )
                              AND     SO.to_nod_cd like '${to_node}'||'%'
#end
#if( !(${door_node} == '' || ${door_node} == 'ALL') )
                              AND     SO.dor_nod_cd like '${door_node}'||'%'
#end

#if( ${ets_yn} == 'N' )
                              AND     SO.HJL_NO IS NULL
#elseif( ${ets_yn} == 'Y' )
                              AND     SO.HJL_NO IS NOT NULL
#end

-- RFND 20150304
#if( ${radio_office} == 'IV' && !( ${period} == 'S' || ${period} == 'W') )
UNION ALL
                              SELECT  /*+ USE_NL(SO,WRK,VDR,IXCH) */
#if( ${radio_office} == 'WO' )
                                      WO.CRE_OFC_CD     -- W/O OFFICE
#elseif(  ${radio_office} == 'IV' )
                                      WRK.CRE_OFC_CD    -- Invoice OFFICE
#end

#if( ${period} == 'S' )
                                    , TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM') CRE_MONTH
#elseif( ${period} == 'W' )
                                    , TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM') CRE_MONTH
#elseif( ${period} == 'I' )
                                    , TO_CHAR(WRK.INV_CFM_DT,'YYYYMM') CRE_MONTH
#else
                                    , SUBSTR(WRK.GL_DT,1,6) CRE_MONTH
#end

                                    , NVL(SO.TRSP_COST_DTL_MOD_CD, RI.TRSP_COST_DTL_MOD_CD) TRSP_COST_DTL_MOD_CD -- COST MODE
                                    , NVL(SO.TRSP_CRR_MOD_CD, RI.TRSP_CRR_MOD_CD) TRSP_CRR_MOD_CD      -- TRANS_MODE
                                    , DECODE(SO.TRSP_BND_CD,'I','I','O','O','T','T','') TRSP_BND_CD
                                    , SO.TRSP_SO_TP_CD           -- S/O TYPE
                                    , SOTP_CD.INTG_CD_VAL_DP_DESC TRSP_SO_TP_NM  -- S/O TYPE NM
                                    , NVL(NVL(SO.INV_CURR_CD, SO.CURR_CD), WRK.INV_CURR_CD) INV_CURR_CD         -- CURR

#if( ${sp_tp} == 'WO' )
    #if( ${chk_prnt_provider} == 'Y' )
                                    , P_VDR.VNDR_SEQ          -- W/O Parent S/P Code
                                    , P_VDR.VNDR_ABBR_NM      -- W/O Parent S/P Name
                                    , P_VDR.VNDR_SEQ ||' ('|| P_VDR.VNDR_ABBR_NM || ')'  SUB_SUM_TITLE
                                    , P_HVDR.VNDR_SEQ   HJL_VNDR_SEQ       -- HJL W/O Parent S/P Code
                                    , P_HVDR.VNDR_ABBR_NM  HJL_VNDR_ABBR_NM      -- HJL W/O Parent S/P Name
                                    , P_HVDR.VNDR_SEQ ||' ('|| P_HVDR.VNDR_ABBR_NM || ')'  HJL_SUB_SUM_TITLE
    #else
                                    , WRK.WO_VNDR_SEQ VNDR_SEQ -- W/O S/P Code
                                    , VDR.VNDR_ABBR_NM         -- W/O S/P Name
                                    , WRK.WO_VNDR_SEQ ||' ('|| VDR.VNDR_ABBR_NM || ')'  SUB_SUM_TITLE
                                    , HSO.HJL_VNDR_SEQ  HJL_VNDR_SEQ            -- HJL W/O S/P Code
                                    , HVDR.VNDR_ABBR_NM HJL_VNDR_ABBR_NM       -- HJL W/O S/P Name
                                    , HSO.HJL_VNDR_SEQ ||' ('|| HVDR.VNDR_ABBR_NM || ')'  HJL_SUB_SUM_TITLE
    #end
#elseif( ${sp_tp} == 'IV' )
    #if( ${chk_prnt_provider} == 'Y' )
                                    , P_IVDR.VNDR_SEQ  VNDR_SEQ      -- Invoice Parent S/P Code
                                    , P_IVDR.VNDR_ABBR_NM  VNDR_ABBR_NM  -- Invoice Parent S/P Name
                                    , P_IVDR.VNDR_SEQ ||' ('|| P_IVDR.VNDR_ABBR_NM || ')'  SUB_SUM_TITLE
                                    , P_HIVDR.VNDR_SEQ  HJL_VNDR_SEQ      --HJL Invoice Parent S/P Code
                                    , P_HIVDR.VNDR_ABBR_NM  HJL_VNDR_ABBR_NM  --HJL Invoice Parent S/P Name
                                    , P_HIVDR.VNDR_SEQ ||' ('|| P_HIVDR.VNDR_ABBR_NM || ')'  HJL_SUB_SUM_TITLE
    #else
                                    , NVL(SO.INV_VNDR_SEQ, WRK.INV_VNDR_SEQ)    VNDR_SEQ      -- Invoice S/P Code
                                    , IVDR.VNDR_ABBR_NM  VNDR_ABBR_NM  -- Invoice S/P Name
                                    , NVL(SO.INV_VNDR_SEQ, WRK.INV_VNDR_SEQ) ||' ('|| IVDR.VNDR_ABBR_NM || ')'  SUB_SUM_TITLE
                                    , HSO.HJL_INV_VNDR_SEQ    HJL_VNDR_SEQ      -- HJL Invoice S/P Code
                                    , HIVDR.VNDR_ABBR_NM  HJL_VNDR_ABBR_NM  -- HJL Invoice S/P Name
                                    , HSO.HJL_INV_VNDR_SEQ ||' ('|| HIVDR.VNDR_ABBR_NM || ')'  HJL_SUB_SUM_TITLE
    #end
#end

                                    , SUBSTR(NVL(SO.EQ_TPSZ_CD, RI.EQ_TPSZ_CD),2,1) EQ_TPSZ_CD_SUB
                                    , NVL(SO.EQ_TPSZ_CD, RI.EQ_TPSZ_CD) EQ_TPSZ_CD
                                    , NVL(RI.TRSP_RFND_INV_AMT, 0)*-1 INV_BZC_AMT
                                    , NVL(DECODE(WRK.TRSP_INV_AUD_STS_CD, 'CF', SO.INV_ETC_ADD_AMT, 'AR', SO.INV_ETC_ADD_AMT, 'IF', SO.INV_ETC_ADD_AMT, 'DA', SO.INV_ETC_ADD_AMT, 'PD', SO.INV_ETC_ADD_AMT, 0), 0) INV_ETC_ADD_AMT
                                    , CASE WHEN NVL(NVL(SO.INV_CURR_CD, WRK.INV_CURR_CD),'USD') = 'USD' THEN 1
                                           ELSE    
                                                ( SELECT  USD_LOCL_XCH_RT 
                                                  FROM    GL_MON_XCH_RT WXCH 
                                                  WHERE   ACCT_XCH_RT_LVL = 1
                                                  AND     CURR_CD           = NVL(NVL(SO.INV_CURR_CD, SO.CURR_CD), WRK.INV_CURR_CD)
                                                  AND     ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WRK.LOCL_CRE_DT,'YYYYMM'),NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM'))) 
                                                )
                                      END INV_USD_LOCL_XCH_RT
                                    , CASE WHEN NVL(SO.CURR_CD,'USD') = 'USD' THEN 1
                                           ELSE    
                                                ( SELECT  USD_LOCL_XCH_RT 
                                                  FROM    GL_MON_XCH_RT WXCH 
                                                  WHERE   ACCT_XCH_RT_LVL = 1
                                                  AND     CURR_CD           = SO.CURR_CD 
                                                  AND     ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM')) 
                                                )
                                      END USD_LOCL_XCH_RT
                                    , NVL(SO.BZC_AMT,0) BZC_AMT
                                    , NVL(SO.ETC_ADD_AMT,0) ETC_ADD_AMT
                                    , NVL(SO.ETC_ADD_AMT,0) TRUK_ETC_ADD_AMT
                                    , NVL(SO.HJL_HNDL_AMT,0) HJL_HNDL_AMT
                                    , 0 RAIL_ETC_ADD_AMT
                                    , NVL(SO.FUEL_SCG_AMT,0) FUEL_SCG_AMT
                                    , NVL(SO.SCG_VAT_AMT,0) SCG_VAT_AMT
                                    , NVL(SO.NEGO_AMT,0) NEGO_AMT
                                    , NVL(SO.TOLL_FEE_AMT,0) TOLL_FEE_AMT
                                    , SUBSTR(SO.FM_NOD_CD,1,@[node_div])  FM_NOD_CD
                                    , SUBSTR(SO.VIA_NOD_CD,1,@[node_div]) VIA_NOD_CD
                                    , SUBSTR(SO.TO_NOD_CD,1,@[node_div])  TO_NOD_CD
                                    , SUBSTR(SO.DOR_NOD_CD,1,@[node_div]) DOR_NOD_CD
                                    , NVL(SUBSTR(SO.FM_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(SO.VIA_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(SO.TO_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(SO.DOR_NOD_CD,1,@[node_div]), '') NOD_CD
                                    , 0 AS OVR_WGT_SCG_AMT
                                    , 0 AS HZD_MTRL_SCG_AMT
                                    , NVL(SO.TTL_DIST,0) TTL_DIST
                                    , SO.LNK_DIST_DIV_CD
                                    , DECODE(SO.HJL_NO,'','N','Y') ETS_YN
                              FROM    TRS_TRSP_SVC_ORD SO
                                    , TRS_TRSP_HJL_SVC_ORD HSO
                                    , TRS_TRSP_WRK_ORD WO
                                    , TRS_TRSP_INV_WRK WRK
                                    , COM_INTG_CD_DTL SOTP_CD
                                    , ( SELECT  /*+ USE_NL(A,B) */
                                                A.TRSP_SO_OFC_CTY_CD
                                              , A.TRSP_SO_SEQ
                                              , DECODE(A.HJL_NO,'',A.VNDR_SEQ,B.HJL_VNDR_SEQ) VNDR_SEQ
                                              , DECODE(A.HJL_NO,'',A.INV_VNDR_SEQ,B.HJL_INV_VNDR_SEQ) INV_VNDR_SEQ
                                        FROM    TRS_TRSP_SVC_ORD A
                                              , TRS_TRSP_HJL_SVC_ORD B
                                        WHERE   A.TRSP_SO_OFC_CTY_CD = B.TRSP_SO_OFC_CTY_CD(+)
                                        AND     A.TRSP_SO_SEQ = B.TRSP_SO_SEQ(+)
                                        AND     A.DELT_FLG = 'N'
                                      ) ACT_VNDR
                                    , TRS_TRSP_RFND_INV RI
#if( ${sp_tp} == 'WO' )
                                    , MDM_VENDOR       VDR
                                    , MDM_VENDOR       HVDR
#elseif( ${sp_tp} == 'IV' )
                                    , MDM_VENDOR       IVDR
                                    , MDM_VENDOR       HIVDR
#end
#if( ${chk_prnt_provider} == 'Y' )
                -- Parent S/P를 체크하였을 경우
    #if( ${sp_tp} == 'WO' )
                                    , MDM_VENDOR       P_VDR
                                    , MDM_VENDOR       P_HVDR
    #elseif( ${sp_tp} == 'IV' )
                                    , MDM_VENDOR       P_IVDR
                                    , MDM_VENDOR       P_HIVDR
    #end
#end


                              WHERE   SO.TRSP_WO_OFC_CTY_CD  = WO.TRSP_WO_OFC_CTY_CD(+)
                              AND     SO.TRSP_WO_SEQ         = WO.TRSP_WO_SEQ(+)
                              AND     SO.TRSP_SO_OFC_CTY_CD  = HSO.TRSP_SO_OFC_CTY_CD(+)
                              AND     SO.TRSP_SO_SEQ         = HSO.TRSP_SO_SEQ(+)
                              AND     SO.TRSP_SO_OFC_CTY_CD  = ACT_VNDR.TRSP_SO_OFC_CTY_CD(+)
                              AND     SO.TRSP_SO_SEQ          = ACT_VNDR.TRSP_SO_SEQ(+)
                              AND     SO.INV_NO(+)           = WRK.INV_NO
                              AND     SO.INV_VNDR_SEQ(+)     = WRK.INV_VNDR_SEQ
                              --AND     SO.DELT_FLG            = 'N'
                              AND     WRK.INV_NO(+)          = RI.INV_NO
                              AND     WRK.INV_VNDR_SEQ(+)    = RI.INV_VNDR_SEQ
#if( ${sp_tp} == 'WO' )
                              AND     WRK.WO_VNDR_SEQ        = VDR.VNDR_SEQ(+)
                              AND     HSO.HJL_VNDR_SEQ       = HVDR.VNDR_SEQ(+)
#elseif( ${sp_tp} == 'IV' )
                              AND     WRK.INV_VNDR_SEQ        = IVDR.VNDR_SEQ(+)
                              AND     WRK.INV_VNDR_SEQ        IS NOT NULL
                              AND     HSO.HJL_INV_VNDR_SEQ   = HIVDR.VNDR_SEQ(+)
#end

                              AND     SOTP_CD.INTG_CD_ID(+) = 'CD00279'
                              AND     SOTP_CD.INTG_CD_VAL_CTNT(+)  = SO.TRSP_SO_TP_CD
                              --AND     SO.EQ_KND_CD = 'U'
#if( ${chk_prnt_provider} == 'Y' )
        --Parent S/P를 체크하였을 경우
    #if( ${sp_tp} == 'WO' )
                              AND     VDR.PRNT_VNDR_SEQ      = P_VDR.VNDR_SEQ
                              AND     HVDR.PRNT_VNDR_SEQ      = P_HVDR.VNDR_SEQ(+)
    #elseif( ${sp_tp} == 'IV' )
                              AND     IVDR.PRNT_VNDR_SEQ     = P_IVDR.VNDR_SEQ
                              AND     HIVDR.PRNT_VNDR_SEQ     = P_HIVDR.VNDR_SEQ(+)
    #end
#end

#if (${bndcd} == 'I')
                              AND     SO.TRSP_BND_CD = 'I'
#elseif (${bndcd} == 'O')
                              AND     SO.TRSP_BND_CD = 'O'
#elseif (${bndcd} == 'T')
                              AND     SO.TRSP_BND_CD = 'T'
#elseif (${bndcd} == 'P')
                              AND     SO.TRSP_BND_CD IN ('I','O')
#end

#if( !((${FromDate} == '') && (${ToDate} == '')))
    #if( ${period} == 'S' )
                              AND     SO.LOCL_CRE_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'W' )
                              AND     WO.LOCL_CRE_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'I' )
                              AND     WRK.INV_CFM_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'G' )
                              AND     WRK.GL_DT BETWEEN '${FromDate}' AND '${ToDate}'
    #else
                              AND     1 = 2
    #end
#else
                              AND     1 = 2
#end

    #if($statusCdArr.size() > 0)
                              AND     WRK.TRSP_INV_AUD_STS_CD IN (
        #foreach( ${key} in ${statusCdArr})
            #if($velocityCount == 1)
            '${key}'
            #else
            , '${key}'
            #end
        #end
            )
    #end

#if( ${status_cd} == 'INV' )
                              AND     WRK.TRSP_INV_AUD_STS_CD IN ('RC','SV','CF','AR','DA','IF','RJ','PD')
#end 

#if( ${radio_office} == 'WO' )
    #if($inputOfcArr.size() > 0)
                              AND     WO.CRE_OFC_CD IN (
        #foreach( ${key} in ${inputOfcArr})
            #if($velocityCount == 1)
            UPPER('${key}')
            #else
            , UPPER('${key}')
            #end
        #end
            )
    #end
#elseif( ${radio_office} == 'IV' )
    #if($inputOfcArr.size() > 0)
                              AND     WRK.CRE_OFC_CD IN (
        #foreach( ${key} in ${inputOfcArr})
            #if($velocityCount == 1)
            UPPER('${key}')
            #else
            , UPPER('${key}')
            #end
        #end
            )
    #end
#end
#if($costmodeArr.size() > 0)
                    AND     RI.TRSP_COST_DTL_MOD_CD IN (
    #foreach( ${key} in ${costmodeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

#if($transmodeArr.size() > 0)
                    AND     RI.TRSP_CRR_MOD_CD IN (
    #foreach( ${key} in ${transmodeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

#if($sotypeArr.size() > 0)
                    AND     SO.TRSP_SO_TP_CD IN (
    #foreach( ${key} in ${sotypeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

#if( !(${svc_provider} == '' ) )
    #if( ${sp_tp} == 'WO' )
        #if( ${chk_prnt_provider} == 'Y' )
                              AND     WRK.WO_VNDR_SEQ IN (SELECT VNDR_SEQ
                                          FROM MDM_VENDOR
                                         WHERE PRNT_VNDR_SEQ = ${svc_provider_prnt})
        #else
                              AND     WRK.WO_VNDR_SEQ = ${svc_provider}
        #end
    #elseif( ${sp_tp} == 'IV' )
        #if( ${chk_prnt_provider} == 'Y' )
                              AND     WRK.INV_VNDR_SEQ IN (SELECT VNDR_SEQ
                                              FROM MDM_VENDOR
                                             WHERE PRNT_VNDR_SEQ = ${svc_provider_prnt})
        #else
                              AND     WRK.INV_VNDR_SEQ = ${svc_provider}
        #end
    #end
#end
#if( ${svc_provider} == '' &&  !(${svc_provider_prnt} == '') )
    #if( ${sp_tp} == 'WO' )
                              AND     WRK.WO_VNDR_SEQ IN (SELECT VNDR_SEQ
                                          FROM MDM_VENDOR
                                            WHERE PRNT_VNDR_SEQ = ${svc_provider_prnt})
    #elseif( ${sp_tp} == 'IV' )
                              AND     WRK.INV_VNDR_SEQ IN (SELECT VNDR_SEQ
                                                 FROM MDM_VENDOR
                                                WHERE PRNT_VNDR_SEQ = ${svc_provider_prnt})
    #end
#end
#if( !(${from_node} == '' || ${from_node} == 'ALL') )
                              AND     SO.fm_nod_cd like '${from_node}'||'%'
#end
#if( !(${via_node} == '' || ${via_node} == 'ALL') )
                              AND     SO.via_nod_cd like '${via_node}'||'%'
#end
#if( !(${to_node} == '' || ${to_node} == 'ALL') )
                              AND     SO.to_nod_cd like '${to_node}'||'%'
#end
#if( !(${door_node} == '' || ${door_node} == 'ALL') )
                              AND     SO.dor_nod_cd like '${door_node}'||'%'
#end

#if( ${ets_yn} == 'N' )
                              AND     SO.HJL_NO IS NULL
#elseif( ${ets_yn} == 'Y' )
                              AND     SO.HJL_NO IS NOT NULL
#end

#end
-- RFND END 20150304

#if( ${chk} != '0' )
                              UNION ALL
                              SELECT  /*+ USE_NL(SO,WRK,VDR,IXCH) */
  #if( ${radio_office} == 'WO' )
                                      WO.CRE_OFC_CD     -- W/O OFFICE
  #elseif( ${radio_office} == 'IV' )
                                      WRK.CRE_OFC_CD    -- Invoice OFFICE
  #end

  #if( ${period} == 'S' )
                                    , TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM') CRE_MONTH
  #elseif( ${period} == 'W' )
                                    , TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM') CRE_MONTH
  #elseif( ${period} == 'I' )
                                    , TO_CHAR(WRK.INV_CFM_DT,'YYYYMM') CRE_MONTH
  #else
                                    , SUBSTR(WRK.GL_DT,1,6) CRE_MONTH
  #end

                                    , SO.TRSP_COST_DTL_MOD_CD -- COST MODE
                                    , 'RD' TRSP_CRR_MOD_CD    -- TRANS_MODE
                                    , DECODE(SO.TRSP_BND_CD,'I','I','O','O','') TRSP_BND_CD
                                    , 'R'  TRSP_SO_TP_CD      -- S/O TYPE
                                    , SOTP_CD.INTG_CD_VAL_DP_DESC TRSP_SO_TP_NM  -- S/O TYPE NM
                                    , NVL(VNDR.INV_CURR_CD, VNDR.CURR_CD) INV_CURR_CD         -- CURR
  #if( ${sp_tp} == 'WO' )
    #if( ${chk_prnt_provider} == 'Y' )
                                    , P_VDR.VNDR_SEQ          -- W/O Parent S/P Code
                                    , P_VDR.VNDR_ABBR_NM      -- W/O Parent S/P Name
                                    , P_VDR.VNDR_SEQ ||' ('|| P_VDR.VNDR_ABBR_NM || ')'  SUB_SUM_TITLE
    #else
                                    , VNDR.VNDR_SEQ           -- W/O S/P Code
                                    , VDR.VNDR_ABBR_NM        -- W/O S/P Name
                                    , VNDR.VNDR_SEQ ||' ('|| VDR.VNDR_ABBR_NM || ')'  SUB_SUM_TITLE
    #end
  #elseif( ${sp_tp} == 'IV' )
    #if( ${chk_prnt_provider} == 'Y' )
                                    , P_IVDR.VNDR_SEQ  VNDR_SEQ      -- Invoice Parent S/P Code
                                    , P_IVDR.VNDR_ABBR_NM  VNDR_ABBR_NM  -- Invoice Parent S/P Name
                                    , P_IVDR.VNDR_SEQ ||' ('|| P_IVDR.VNDR_ABBR_NM || ')'  SUB_SUM_TITLE
    #else
                                    , VNDR.INV_VNDR_SEQ    VNDR_SEQ    -- Invoice S/P Code
                                    , IVDR.VNDR_ABBR_NM  VNDR_ABBR_NM  -- Invoice S/P Name
                                    , VNDR.INV_VNDR_SEQ ||' ('|| IVDR.VNDR_ABBR_NM || ')'  SUB_SUM_TITLE
    #end
  #end
                                    , TO_NUMBER('') HJL_VNDR_SEQ             
                                    , '' HJL_VNDR_ABBR_NM
                                    , '' HJL_SUB_SUM_TITLE
                                    , SUBSTR(SO.EQ_TPSZ_CD,2,1) EQ_TPSZ_CD_SUB
                                    , SO.EQ_TPSZ_CD
                                    , DECODE(WRK.TRSP_INV_AUD_STS_CD, 'CF', VNDR.INV_BZC_AMT, 'AR', VNDR.INV_BZC_AMT, 'IF', VNDR.INV_BZC_AMT, 'DA', VNDR.INV_BZC_AMT, 'PD', VNDR.INV_BZC_AMT, 0) INV_BZC_AMT
                                    , DECODE(WRK.TRSP_INV_AUD_STS_CD, 'CF', VNDR.INV_ETC_ADD_AMT, 'AR', VNDR.INV_ETC_ADD_AMT, 'IF', VNDR.INV_ETC_ADD_AMT, 'DA', VNDR.INV_ETC_ADD_AMT, 'PD', VNDR.INV_ETC_ADD_AMT, 0) INV_ETC_ADD_AMT
                                    , CASE WHEN NVL(VNDR.INV_CURR_CD,'USD') = 'USD' THEN 1
                                           ELSE
                                                ( SELECT  USD_LOCL_XCH_RT 
                                                  FROM    GL_MON_XCH_RT WXCH 
                                                  WHERE   ACCT_XCH_RT_LVL = 1 
                                                  AND     CURR_CD = NVL(VNDR.INV_CURR_CD, VNDR.CURR_CD) 
                                                  AND     ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WRK.LOCL_CRE_DT,'YYYYMM'),NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM')))  
                                                )
                                      END INV_USD_LOCL_XCH_RT
                                    , CASE WHEN NVL(VNDR.CURR_CD,'USD') = 'USD' THEN 1
                                           ELSE
                                                ( SELECT  USD_LOCL_XCH_RT 
                                                  FROM    GL_MON_XCH_RT WXCH 
                                                  WHERE   ACCT_XCH_RT_LVL = 1 
                                                  AND     CURR_CD = VNDR.CURR_CD
                                                  AND     ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM'))  
                                                )
                                      END USD_LOCL_XCH_RT
                                    , NVL(VNDR.BZC_AMT,0) BZC_AMT
                                    , NVL(VNDR.ETC_ADD_AMT,0) ETC_ADD_AMT
                                    , 0 TRUK_ETC_ADD_AMT
                                    , 0 HJL_HNDL_AMT
                                    , NVL(VNDR.ETC_ADD_AMT,0) RAIL_ETC_ADD_AMT
                                    , NVL(VNDR.FUEL_SCG_AMT,0) FUEL_SCG_AMT
                                    , 0 SCG_VAT_AMT
                                    , NVL(VNDR.NEGO_AMT,0) NEGO_AMT
                                    , 0 TOLL_FEE_AMT
                                    , SUBSTR(VNDR.FM_NOD_CD,1,@[node_div])  FM_NOD_CD
                                    , '' VIA_NOD_CD
                                    , SUBSTR(VNDR.TO_NOD_CD,1,@[node_div])  TO_NOD_CD
                                    , '' DOR_NOD_CD
                                    , NVL(SUBSTR(VNDR.FM_NOD_CD,1,@[node_div]), '')||NVL(SUBSTR(VNDR.TO_NOD_CD,1,@[node_div]), '') NOD_CD
                                    , NVL(VNDR.OVR_WGT_SCG_AMT,0) AS OVR_WGT_SCG_AMT
                                    , NVL(VNDR.HZD_MTRL_SCG_AMT,0) AS HZD_MTRL_SCG_AMT
                                    , 0 TTL_DIST
                                    , '' LNK_DIST_DIV_CD
                                    , 'N' ETS_YN
                              FROM    TRS_TRSP_RAIL_BIL_ORD SO
                                    , TRS_TRSP_EDI_RAIL_ORD WO
                                    , TRS_TRSP_RAIL_INV_WRK WRK
                                    , COM_INTG_CD_DTL SOTP_CD
  #if( ${sp_tp} == 'WO' )
                                    , MDM_VENDOR       VDR
  #elseif( ${sp_tp} == 'IV' )
                                    , MDM_VENDOR       IVDR
  #end
                                    , TRS_TRSP_RAIL_BIL_VNDR_SET VNDR
  #if( ${chk_prnt_provider} == 'Y' )
                -- Parent S/P를 체크하였을 경우
    #if( ${sp_tp} == 'WO' )
                                    , MDM_VENDOR       P_VDR
    #elseif( ${sp_tp} == 'IV' )
                                    , MDM_VENDOR       P_IVDR
    #end
  #end
                              WHERE   SO.TRSP_SO_OFC_CTY_CD  = WO.TRSP_SO_OFC_CTY_CD(+)
                              AND     SO.TRSP_SO_SEQ         = WO.TRSP_SO_SEQ(+)
                              AND     SO.BIL_ISS_KNT         = WO.BIL_ISS_KNT(+)
                              AND     VNDR.INV_NO            = WRK.INV_NO(+)
                              AND     VNDR.INV_VNDR_SEQ      = WRK.INV_VNDR_SEQ(+)
  #if( ${sp_tp} == 'WO' )
                              AND     VNDR.VNDR_SEQ          = VDR.VNDR_SEQ(+)
  #elseif( ${sp_tp} == 'IV' )
                              AND     VNDR.INV_VNDR_SEQ      = IVDR.VNDR_SEQ(+)
                              AND     VNDR.INV_VNDR_SEQ      IS NOT NULL
  #end
                              AND     SO.TRSP_SO_OFC_CTY_CD  = VNDR.TRSP_SO_OFC_CTY_CD
                              AND     SO.TRSP_SO_SEQ         = VNDR.TRSP_SO_SEQ
                              AND     SO.DELT_FLG            = 'N'
                              AND     VNDR.INV_NO            = WRK.INV_NO(+)
                              AND     VNDR.INV_VNDR_SEQ      = WRK.INV_VNDR_SEQ(+)
                              AND     SOTP_CD.INTG_CD_ID(+) = 'CD00279'
                              AND     SOTP_CD.INTG_CD_VAL_CTNT(+)  = 'R'
                              AND     SO.EQ_KND_CD = 'U'
  #if( ${chk_prnt_provider} == 'Y' )
    #if( ${sp_tp} == 'WO' )
                              AND     VDR.PRNT_VNDR_SEQ      = P_VDR.VNDR_SEQ
    #elseif( ${sp_tp} == 'IV' )
                              AND     IVDR.PRNT_VNDR_SEQ     = P_IVDR.VNDR_SEQ
    #end
  #end

  #if (${bndcd} == 'I')
                              AND     SO.TRSP_BND_CD = 'I'
  #elseif (${bndcd} == 'O')
                              AND     SO.TRSP_BND_CD = 'O'
  #elseif (${bndcd} == 'T')
                              AND     1 = 2
  #elseif (${bndcd} == 'P')
                              AND     SO.TRSP_BND_CD IN ('I','O')
  #end


  #if( !((${FromDate} == '') && (${ToDate} == '')))
    #if( ${period} == 'S' )
                              AND     SO.LOCL_CRE_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'W' )
                              AND     WO.LOCL_CRE_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'I' )
                              AND     WRK.INV_CFM_DT BETWEEN TO_DATE( '${FromDate}' ,'rrrrmmddhh24') AND TO_DATE( '${ToDate}' ,'rrrrmmddhh24') +0.999999
    #elseif( ${period} == 'G' )
                              AND     WRK.GL_DT BETWEEN '${FromDate}' AND '${ToDate}'
    #else
                              AND     1 = 2
    #end
  #else
                              AND     1 = 2
  #end

    #if($statusCdArr.size() > 0)
                              AND     WRK.TRSP_INV_AUD_STS_CD IN (
        #foreach( ${key} in ${statusCdArr})
            #if($velocityCount == 1)
            '${key}'
            #else
            , '${key}'
            #end
        #end
            )
    #end

  #if( ${status_cd} == 'INV' )
                              AND     WRK.TRSP_INV_AUD_STS_CD IN ('RC','SV','CF','AR','DA','IF','RJ','PD')
  #end 

  #if( ${radio_office} == 'WO' )
    #if($inputOfcArr.size() > 0)
                              AND     WO.CRE_OFC_CD IN (
        #foreach( ${key} in ${inputOfcArr})
            #if($velocityCount == 1)
            UPPER('${key}')
            #else
            , UPPER('${key}')
            #end
        #end
            )
    #end
  #elseif( ${radio_office} == 'IV' )
    #if($inputOfcArr.size() > 0)
                              AND     WRK.CRE_OFC_CD IN (
        #foreach( ${key} in ${inputOfcArr})
            #if($velocityCount == 1)
            UPPER('${key}')
            #else
            , UPPER('${key}')
            #end
        #end
            )
    #end
  #end

#if($costmodeArr.size() > 0)
                    AND     SO.TRSP_COST_DTL_MOD_CD IN (
    #foreach( ${key} in ${costmodeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end
#if($transmodeArr.size() > 0)
                    AND     'RD' IN (
    #foreach( ${key} in ${transmodeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end
#if($sotypeArr.size() > 0)
                    AND     'R' IN (
    #foreach( ${key} in ${sotypeArr})
        #if($velocityCount == 1)
        '${key}'
        #else
        , '${key}'
        #end
    #end
        )
#end

  #if( !(${svc_provider} == '' ) )
    #if( ${sp_tp} == 'WO' )
        #if( ${chk_prnt_provider} == 'Y' )
                              AND     VNDR.VNDR_SEQ IN ( SELECT  VNDR_SEQ
                                                         FROM    MDM_VENDOR
                                                         WHERE   PRNT_VNDR_SEQ = ${svc_provider_prnt})
        #else
                              AND     VNDR.VNDR_SEQ = ${svc_provider}
        #end
    #elseif( ${sp_tp} == 'IV' )
        #if( ${chk_prnt_provider} == 'Y' )
                              AND     VNDR.INV_VNDR_SEQ IN ( SELECT  VNDR_SEQ
                                                             FROM    MDM_VENDOR
                                                             WHERE   PRNT_VNDR_SEQ = ${svc_provider_prnt})
        #else
                              AND     VNDR.INV_VNDR_SEQ = ${svc_provider}
        #end
    #end
  #end
  #if( ${svc_provider} == '' &&  !(${svc_provider_prnt} == '') )
    #if( ${sp_tp} == 'WO' )
                              AND     VNDR.VNDR_SEQ IN ( SELECT  VNDR_SEQ
                                                         FROM    MDM_VENDOR
                                                         WHERE   PRNT_VNDR_SEQ = ${svc_provider_prnt})
    #elseif( ${sp_tp} == 'IV' )
                              AND     VNDR.INV_VNDR_SEQ IN ( SELECT  VNDR_SEQ
                                                             FROM    MDM_VENDOR
                                                             WHERE   PRNT_VNDR_SEQ = ${svc_provider_prnt})
    #end
  #end
  #if( !(${from_node} == '' || ${from_node} == 'ALL') )
                              AND     vndr.fm_nod_cd like '${from_node}'||'%'
  #end
  #if( !(${via_node} == '' || ${via_node} == 'ALL') )
                              AND     0 = 1
  #end
  #if( !(${to_node} == '' || ${to_node} == 'ALL') )
                              AND     vndr.to_nod_cd like '${to_node}'||'%'
  #end
  #if( !(${door_node} == '' || ${door_node} == 'ALL') )
                              AND     0 = 1
  #end

#end
                            )
            
    GROUP BY CRE_OFC_CD     -- W/O OR Invoice OFFICE CD
            ,DECODE(VNDR_SEQ, NULL, '', VNDR_SEQ||' ('||VNDR_ABBR_NM||')')  -- W/O OR Invoice S/P NAME
            ,DECODE(HJL_VNDR_SEQ, NULL, '', HJL_VNDR_SEQ||' ('||HJL_VNDR_ABBR_NM||')')
            ,CRE_MONTH
            ,TRSP_COST_DTL_MOD_CD -- COST MODE
            ,TRSP_CRR_MOD_CD -- TRANS_MODE
            ,TRSP_BND_CD
            ,TRSP_SO_TP_CD   -- S/O TYPE
            ,NOD_CD          -- NODE
            ,INV_CURR_CD -- CURR
            ,ETS_YN
)
          

SELECT CHK
      ,DIV
      ,CRE_OFC_CD
      ,VNDR_SEQ
      ,VNDR_ABBR_NM
      ,ACT_VNDR_SEQ
      ,ACT_VNDR_ABBR_NM
      ,CRE_MONTH
      ,TRSP_COST_DTL_MOD_CD 
      ,TRSP_CRR_MOD_CD
      ,TRSP_BND_CD
      ,TRSP_SO_TP_CD
      ,TRSP_SO_TP_NM
      ,FM_NOD_CD
      ,VIA_NOD_CD
      ,TO_NOD_CD
      ,DOR_NOD_CD
      ,ETS_YN
      ,TTL_DIST
      ,LNK_DIST_DIV_CD
      ,INV_CURR_CD
      ,INV_BZC_D2_AMT
      ,INV_BZC_D4_AMT
      ,INV_BZC_AMT
      ,INV_TOT_AMT
      ,INV_ETC_ADD_D2_AMT
      ,INV_ETC_ADD_D4_AMT
      ,INV_ETC_ADD_AMT
      ,INV_BZC_D2_AMT_USD
      ,INV_BZC_D4_AMT_USD
      ,INV_BZC_AMT_USD
      ,INV_TOT_AMT_USD
      ,INV_ETC_ADD_D2_AMT_USD
      ,INV_ETC_ADD_D4_AMT_USD
      ,INV_ETC_ADD_AMT_USD
      ,BZC_D2_AMT
      ,FUEL_SCG_D2_AMT
      ,SCG_VAT_D2_AMT
      ,NEGO_D2_AMT
      ,TOLL_FEE_D2_AMT
      ,D2_AMT_SUM
      ,BZC_D4_AMT
      ,FUEL_SCG_D4_AMT
      ,SCG_VAT_D4_AMT
      ,NEGO_D4_AMT
      ,TOLL_FEE_D4_AMT
      ,D4_AMT_SUM
      ,BZC_AMT
      ,FUEL_SCG_AMT
      ,SCG_VAT_AMT
      ,NEGO_AMT
      ,TOLL_FEE_AMT
      ,TOT_AMT
      ,ETC_ADD_D2_AMT
      ,RAIL_ETC_ADD_D2_AMT
      ,TRUK_ETC_ADD_D2_AMT
      ,HJL_HNDL_D2_AMT
      ,OVR_WGT_SCG_D2_AMT
      ,HZD_MTRL_SCG_D2_AMT
      ,ETC_ADD_D4_AMT
      ,RAIL_ETC_ADD_D4_AMT
      ,TRUK_ETC_ADD_D4_AMT
      ,HJL_HNDL_D4_AMT
      ,OVR_WGT_SCG_D4_AMT
      ,HZD_MTRL_SCG_D4_AMT
      ,ETC_ADD_AMT
      ,RAIL_ETC_ADD_AMT
      ,TRUK_ETC_ADD_AMT
      ,HJL_HNDL_AMT
      ,OVR_WGT_SCG_AMT
      ,HZD_MTRL_SCG_AMT
      ,BZC_D2_AMT_USD
      ,FUEL_SCG_D2_AMT_USD
      ,SCG_VAT_D2_AMT_USD
      ,NEGO_D2_AMT_USD
      ,TOLL_FEE_D2_AMT_USD
      ,D2_AMT_SUM_USD
      ,BZC_D4_AMT_USD
      ,FUEL_SCG_D4_AMT_USD
      ,SCG_VAT_D4_AMT_USD
      ,NEGO_D4_AMT_USD
      ,TOLL_FEE_D4_AMT_USD
      ,D4_AMT_SUM_USD
      ,BZC_AMT_USD
      ,FUEL_SCG_AMT_USD
      ,SCG_VAT_AMT_USD
      ,NEGO_AMT_USD
      ,TOLL_FEE_AMT_USD
      ,TOT_AMT_USD
      ,ETC_ADD_D2_AMT_USD
      ,RAIL_ETC_ADD_D2_AMT_USD
      ,TRUK_ETC_ADD_D2_AMT_USD
      ,HJL_HNDL_D2_AMT_USD
      ,OVR_WGT_SCG_D2_AMT_USD
      ,HZD_MTRL_SCG_D2_AMT_USD
      ,ETC_ADD_D4_AMT_USD
      ,RAIL_ETC_ADD_D4_AMT_USD
      ,TRUK_ETC_ADD_D4_AMT_USD
      ,HJL_HNDL_D4_AMT_USD
      ,OVR_WGT_SCG_D4_AMT_USD
      ,HZD_MTRL_SCG_D4_AMT_USD
      ,ETC_ADD_AMT_USD
      ,RAIL_ETC_ADD_AMT_USD
      ,TRUK_ETC_ADD_AMT_USD
      ,HJL_HNDL_AMT_USD
      ,OVR_WGT_SCG_AMT_USD
      ,HZD_MTRL_SCG_AMT_USD
      ,CNTN20
      ,CNTN40
      ,CNTN_TEU
      ,CNTN_BOX
      ,D2_CNT
      ,D4_CNT
      ,D5_CNT
      ,D7_CNT
      ,R2_CNT
      ,R4_CNT
      ,R5_CNT
      ,R7_CNT
      ,R8_CNT
      ,F2_CNT
      ,F4_CNT
      ,F5_CNT
      ,A2_CNT
      ,A4_CNT
      ,A5_CNT
      ,P2_CNT
      ,P4_CNT
      ,O2_CNT
      ,O4_CNT
      ,O5_CNT
      ,O7_CNT
      ,S2_CNT
      ,S4_CNT
      ,T2_CNT
      ,T4_CNT
      ,DX_CNT
      ,DW_CNT
FROM      
(
    SELECT  '' CHK
          ,DIV
          ,CRE_OFC_CD
          ,DECODE(ETS_YN,'N',HJL_VNDR_SEQ,VNDR_SEQ) VNDR_SEQ
          ,DECODE(DIV,'11',DECODE(ETS_YN,'N',HJL_VNDR_ABBR_NM,VNDR_ABBR_NM ),'') VNDR_ABBR_NM
          ,DECODE(ETS_YN,'Y',HJL_VNDR_SEQ,VNDR_SEQ) ACT_VNDR_SEQ
          ,DECODE(ETS_YN,'Y',HJL_VNDR_ABBR_NM,VNDR_ABBR_NM) ACT_VNDR_ABBR_NM
          ,CRE_MONTH
          ,TRSP_COST_DTL_MOD_CD 
          ,TRSP_CRR_MOD_CD
          ,TRSP_BND_CD
          ,TRSP_SO_TP_CD
          ,TRSP_SO_TP_NM
          ,FM_NOD_CD
          ,VIA_NOD_CD
          ,TO_NOD_CD
          ,DOR_NOD_CD
          ,ETS_YN
          ,TTL_DIST
          ,LNK_DIST_DIV_CD
          ,INV_CURR_CD
          ,INV_BZC_D2_AMT
          ,INV_BZC_D4_AMT
          ,INV_BZC_AMT
          ,INV_TOT_AMT
          ,INV_ETC_ADD_D2_AMT
          ,INV_ETC_ADD_D4_AMT
          ,INV_ETC_ADD_AMT
          ,INV_BZC_D2_AMT_USD
          ,INV_BZC_D4_AMT_USD
          ,INV_BZC_AMT_USD
          ,INV_TOT_AMT_USD
          ,INV_ETC_ADD_D2_AMT_USD
          ,INV_ETC_ADD_D4_AMT_USD
          ,INV_ETC_ADD_AMT_USD
          ,BZC_D2_AMT
          ,FUEL_SCG_D2_AMT
          ,SCG_VAT_D2_AMT
          ,NEGO_D2_AMT
          ,TOLL_FEE_D2_AMT
          ,D2_AMT_SUM
          ,BZC_D4_AMT
          ,FUEL_SCG_D4_AMT
          ,SCG_VAT_D4_AMT
          ,NEGO_D4_AMT
          ,TOLL_FEE_D4_AMT
          ,D4_AMT_SUM
          ,BZC_AMT
          ,FUEL_SCG_AMT
          ,SCG_VAT_AMT
          ,NEGO_AMT
          ,TOLL_FEE_AMT
          ,TOT_AMT
          ,ETC_ADD_D2_AMT
          ,RAIL_ETC_ADD_D2_AMT
          ,TRUK_ETC_ADD_D2_AMT
          ,HJL_HNDL_D2_AMT
          ,OVR_WGT_SCG_D2_AMT
          ,HZD_MTRL_SCG_D2_AMT
          ,ETC_ADD_D4_AMT
          ,RAIL_ETC_ADD_D4_AMT
          ,TRUK_ETC_ADD_D4_AMT
          ,HJL_HNDL_D4_AMT
          ,OVR_WGT_SCG_D4_AMT
          ,HZD_MTRL_SCG_D4_AMT
          ,ETC_ADD_AMT
          ,RAIL_ETC_ADD_AMT
          ,TRUK_ETC_ADD_AMT
          ,HJL_HNDL_AMT
          ,OVR_WGT_SCG_AMT
          ,HZD_MTRL_SCG_AMT
          ,BZC_D2_AMT_USD
          ,FUEL_SCG_D2_AMT_USD
          ,SCG_VAT_D2_AMT_USD
          ,NEGO_D2_AMT_USD
          ,TOLL_FEE_D2_AMT_USD
          ,D2_AMT_SUM_USD
          ,BZC_D4_AMT_USD
          ,FUEL_SCG_D4_AMT_USD
          ,SCG_VAT_D4_AMT_USD
          ,NEGO_D4_AMT_USD
          ,TOLL_FEE_D4_AMT_USD
          ,D4_AMT_SUM_USD
          ,BZC_AMT_USD
          ,FUEL_SCG_AMT_USD
          ,SCG_VAT_AMT_USD
          ,NEGO_AMT_USD
          ,TOLL_FEE_AMT_USD
          ,TOT_AMT_USD
          ,ETC_ADD_D2_AMT_USD
          ,RAIL_ETC_ADD_D2_AMT_USD
          ,TRUK_ETC_ADD_D2_AMT_USD
          ,HJL_HNDL_D2_AMT_USD
          ,OVR_WGT_SCG_D2_AMT_USD
          ,HZD_MTRL_SCG_D2_AMT_USD
          ,ETC_ADD_D4_AMT_USD
          ,RAIL_ETC_ADD_D4_AMT_USD
          ,TRUK_ETC_ADD_D4_AMT_USD
          ,HJL_HNDL_D4_AMT_USD
          ,OVR_WGT_SCG_D4_AMT_USD
          ,HZD_MTRL_SCG_D4_AMT_USD
          ,ETC_ADD_AMT_USD
          ,RAIL_ETC_ADD_AMT_USD
          ,TRUK_ETC_ADD_AMT_USD
          ,HJL_HNDL_AMT_USD
          ,OVR_WGT_SCG_AMT_USD
          ,HZD_MTRL_SCG_AMT_USD
          ,CNTN20
          ,CNTN40
          ,CNTN_TEU
          ,CNTN_BOX
          ,D2_CNT
          ,D4_CNT
          ,D5_CNT
          ,D7_CNT
          ,R2_CNT
          ,R4_CNT
          ,R5_CNT
          ,R7_CNT
          ,R8_CNT
          ,F2_CNT
          ,F4_CNT
          ,F5_CNT
          ,A2_CNT
          ,A4_CNT
          ,A5_CNT
          ,P2_CNT
          ,P4_CNT
          ,O2_CNT
          ,O4_CNT
          ,O5_CNT
          ,O7_CNT
          ,S2_CNT
          ,S4_CNT
          ,T2_CNT
          ,T4_CNT
          ,DX_CNT
          ,DW_CNT
    FROM      
    (
        -- SUB SUM 없는 데이터
        SELECT '11' DIV
              ,CRE_OFC_CD    
              ,CRE_MONTH    
              ,TRSP_COST_DTL_MOD_CD    
              ,TRSP_CRR_MOD_CD    
              ,TRSP_BND_CD    
              ,TRSP_SO_TP_CD    
              ,TRSP_SO_TP_NM    
              ,NOD_CD    
              ,FM_NOD_CD    
              ,VIA_NOD_CD    
              ,TO_NOD_CD    
              ,DOR_NOD_CD    
              ,ETS_YN    
              ,TTL_DIST    
              ,LNK_DIST_DIV_CD    
              ,INV_CURR_CD    
              ,VNDR_SEQ    
              ,VNDR_ABBR_NM    
              ,SUB_SUM_TITLE    
              ,HJL_VNDR_SEQ    
              ,HJL_VNDR_ABBR_NM    
              ,HJL_SUB_SUM_TITLE    
              ,INV_BZC_D2_AMT    
              ,INV_ETC_ADD_D2_AMT    
              ,INV_BZC_D4_AMT    
              ,INV_ETC_ADD_D4_AMT    
              ,INV_BZC_AMT    
              ,INV_ETC_ADD_AMT    
              ,INV_TOT_AMT    
              ,INV_BZC_D2_AMT_USD    
              ,INV_BZC_D4_AMT_USD    
              ,INV_ETC_ADD_D2_AMT_USD    
              ,INV_ETC_ADD_D4_AMT_USD    
              ,INV_BZC_AMT_USD    
              ,INV_ETC_ADD_AMT_USD    
              ,INV_TOT_AMT_USD    
              ,BZC_D2_AMT    
              ,FUEL_SCG_D2_AMT    
              ,SCG_VAT_D2_AMT    
              ,NEGO_D2_AMT    
              ,TOLL_FEE_D2_AMT    
              ,ETC_ADD_D2_AMT    
              ,RAIL_ETC_ADD_D2_AMT    
              ,TRUK_ETC_ADD_D2_AMT    
              ,HJL_HNDL_D2_AMT    
              ,OVR_WGT_SCG_D2_AMT    
              ,HZD_MTRL_SCG_D2_AMT    
              ,D2_AMT_SUM    
              ,BZC_D4_AMT    
              ,FUEL_SCG_D4_AMT    
              ,SCG_VAT_D4_AMT    
              ,NEGO_D4_AMT    
              ,TOLL_FEE_D4_AMT    
              ,ETC_ADD_D4_AMT    
              ,RAIL_ETC_ADD_D4_AMT    
              ,TRUK_ETC_ADD_D4_AMT    
              ,HJL_HNDL_D4_AMT    
              ,OVR_WGT_SCG_D4_AMT    
              ,HZD_MTRL_SCG_D4_AMT    
              ,D4_AMT_SUM    
              ,BZC_AMT    
              ,FUEL_SCG_AMT    
              ,SCG_VAT_AMT    
              ,NEGO_AMT    
              ,TOLL_FEE_AMT    
              ,ETC_ADD_AMT    
              ,RAIL_ETC_ADD_AMT    
              ,TRUK_ETC_ADD_AMT    
              ,HJL_HNDL_AMT    
              ,OVR_WGT_SCG_AMT    
              ,HZD_MTRL_SCG_AMT    
              ,TOT_AMT    
              ,BZC_D2_AMT_USD    
              ,FUEL_SCG_D2_AMT_USD    
              ,SCG_VAT_D2_AMT_USD    
              ,NEGO_D2_AMT_USD    
              ,TOLL_FEE_D2_AMT_USD    
              ,ETC_ADD_D2_AMT_USD    
              ,RAIL_ETC_ADD_D2_AMT_USD    
              ,TRUK_ETC_ADD_D2_AMT_USD    
              ,HJL_HNDL_D2_AMT_USD    
              ,OVR_WGT_SCG_D2_AMT_USD    
              ,HZD_MTRL_SCG_D2_AMT_USD    
              ,D2_AMT_SUM_USD    
              ,BZC_D4_AMT_USD    
              ,FUEL_SCG_D4_AMT_USD    
              ,SCG_VAT_D4_AMT_USD    
              ,NEGO_D4_AMT_USD    
              ,TOLL_FEE_D4_AMT_USD    
              ,ETC_ADD_D4_AMT_USD    
              ,RAIL_ETC_ADD_D4_AMT_USD    
              ,TRUK_ETC_ADD_D4_AMT_USD    
              ,HJL_HNDL_D4_AMT_USD    
              ,OVR_WGT_SCG_D4_AMT_USD    
              ,HZD_MTRL_SCG_D4_AMT_USD    
              ,D4_AMT_SUM_USD    
              ,BZC_AMT_USD    
              ,FUEL_SCG_AMT_USD    
              ,SCG_VAT_AMT_USD    
              ,NEGO_AMT_USD    
              ,TOLL_FEE_AMT_USD    
              ,ETC_ADD_AMT_USD    
              ,RAIL_ETC_ADD_AMT_USD    
              ,TRUK_ETC_ADD_AMT_USD    
              ,HJL_HNDL_AMT_USD    
              ,OVR_WGT_SCG_AMT_USD    
              ,HZD_MTRL_SCG_AMT_USD    
              ,TOT_AMT_USD    
              ,CNTN20    
              ,CNTN40    
              ,CNTN_TEU    
              ,CNTN_BOX    
              ,D2_CNT    
              ,D4_CNT    
              ,D5_CNT    
              ,D7_CNT    
              ,R2_CNT    
              ,R4_CNT    
              ,R5_CNT    
              ,R7_CNT    
              ,R8_CNT    
              ,F2_CNT    
              ,F4_CNT    
              ,F5_CNT    
              ,A2_CNT    
              ,A4_CNT    
              ,A5_CNT
              ,P2_CNT    
              ,P4_CNT    
              ,O2_CNT    
              ,O4_CNT    
              ,O5_CNT
              ,O7_CNT    
              ,S2_CNT    
              ,S4_CNT    
              ,T2_CNT    
              ,T4_CNT    
              ,DX_CNT    
              ,DW_CNT    
        FROM WITH_RESULT     
         
        -- HJS_SUB_SUM(HJL_VNDR_SEQ) + SUM_SUM(VNDR_SEQ) 를 합해서 SUM SUM     
        UNION ALL
        SELECT '22' DIV
              ,HJL_SUB_SUM_TITLE  || ' Total' CRE_OFC_CD
              ,NULL CRE_MONTH    
              ,NULL TRSP_COST_DTL_MOD_CD    
              ,NULL TRSP_CRR_MOD_CD    
              ,NULL TRSP_BND_CD    
              ,NULL TRSP_SO_TP_CD    
              ,NULL TRSP_SO_TP_NM    
              ,NULL NOD_CD    
              ,NULL FM_NOD_CD    
              ,NULL VIA_NOD_CD    
              ,NULL TO_NOD_CD    
              ,NULL DOR_NOD_CD    
              ,NULL ETS_YN    
              ,NVL(SUM(TTL_DIST                  ),0)
              ,NULL LNK_DIST_DIV_CD    
              ,INV_CURR_CD    
              ,NULL VNDR_SEQ    
              ,NULL VNDR_ABBR_NM    
              ,MAX(SUB_SUM_TITLE    )
              ,NULL HJL_VNDR_SEQ    
              ,NULL HJL_VNDR_ABBR_NM    
              ,MAX(HJL_SUB_SUM_TITLE)    
              ,NVL(SUM(INV_BZC_D2_AMT          ),0)
              ,NVL(SUM(INV_ETC_ADD_D2_AMT      ),0)
              ,NVL(SUM(INV_BZC_D4_AMT          ),0)
              ,NVL(SUM(INV_ETC_ADD_D4_AMT      ),0)
              ,NVL(SUM(INV_BZC_AMT              ),0)
              ,NVL(SUM(INV_ETC_ADD_AMT          ),0)
              ,NVL(SUM(INV_TOT_AMT              ),0)
              ,NVL(SUM(INV_BZC_D2_AMT_USD      ),0)
              ,NVL(SUM(INV_BZC_D4_AMT_USD      ),0)
              ,NVL(SUM(INV_ETC_ADD_D2_AMT_USD ),0)
              ,NVL(SUM(INV_ETC_ADD_D4_AMT_USD ),0)
              ,NVL(SUM(INV_BZC_AMT_USD          ),0)
              ,NVL(SUM(INV_ETC_ADD_AMT_USD      ),0)
              ,NVL(SUM(INV_TOT_AMT_USD          ),0)
              ,NVL(SUM(BZC_D2_AMT              ),0)
              ,NVL(SUM(FUEL_SCG_D2_AMT          ),0)
              ,NVL(SUM(SCG_VAT_D2_AMT          ),0)
              ,NVL(SUM(NEGO_D2_AMT              ),0)
              ,NVL(SUM(TOLL_FEE_D2_AMT              ),0)
              ,NVL(SUM(ETC_ADD_D2_AMT          ),0)
              ,NVL(SUM(RAIL_ETC_ADD_D2_AMT      ),0)
              ,NVL(SUM(TRUK_ETC_ADD_D2_AMT      ),0)
              ,NVL(SUM(HJL_HNDL_D2_AMT          ),0)
              ,NVL(SUM(OVR_WGT_SCG_D2_AMT      ),0)
              ,NVL(SUM(HZD_MTRL_SCG_D2_AMT      ),0)
              ,NVL(SUM(D2_AMT_SUM              ),0)
              ,NVL(SUM(BZC_D4_AMT              ),0)
              ,NVL(SUM(FUEL_SCG_D4_AMT          ),0)
              ,NVL(SUM(SCG_VAT_D4_AMT          ),0)
              ,NVL(SUM(NEGO_D4_AMT              ),0)
              ,NVL(SUM(TOLL_FEE_D4_AMT              ),0)
              ,NVL(SUM(ETC_ADD_D4_AMT          ),0)
              ,NVL(SUM(RAIL_ETC_ADD_D4_AMT      ),0)
              ,NVL(SUM(TRUK_ETC_ADD_D4_AMT      ),0)
              ,NVL(SUM(HJL_HNDL_D4_AMT          ),0)
              ,NVL(SUM(OVR_WGT_SCG_D4_AMT      ),0)
              ,NVL(SUM(HZD_MTRL_SCG_D4_AMT      ),0)
              ,NVL(SUM(D4_AMT_SUM              ),0)
              ,NVL(SUM(BZC_AMT                  ),0)
              ,NVL(SUM(FUEL_SCG_AMT              ),0)
              ,NVL(SUM(SCG_VAT_AMT              ),0)
              ,NVL(SUM(NEGO_AMT                  ),0)
              ,NVL(SUM(TOLL_FEE_AMT                  ),0)
              ,NVL(SUM(ETC_ADD_AMT              ),0)
              ,NVL(SUM(RAIL_ETC_ADD_AMT          ),0)
              ,NVL(SUM(TRUK_ETC_ADD_AMT          ),0)
              ,NVL(SUM(HJL_HNDL_AMT              ),0)
              ,NVL(SUM(OVR_WGT_SCG_AMT          ),0)
              ,NVL(SUM(HZD_MTRL_SCG_AMT          ),0)
              ,NVL(SUM(TOT_AMT                  ),0)
              ,NVL(SUM(BZC_D2_AMT_USD          ),0)
              ,NVL(SUM(FUEL_SCG_D2_AMT_USD      ),0)
              ,NVL(SUM(SCG_VAT_D2_AMT_USD      ),0)
              ,NVL(SUM(NEGO_D2_AMT_USD          ),0)
              ,NVL(SUM(TOLL_FEE_D2_AMT_USD          ),0)
              ,NVL(SUM(ETC_ADD_D2_AMT_USD      ),0)
              ,NVL(SUM(RAIL_ETC_ADD_D2_AMT_USD),0)    
              ,NVL(SUM(TRUK_ETC_ADD_D2_AMT_USD),0)    
              ,NVL(SUM(HJL_HNDL_D2_AMT_USD      ),0)
              ,NVL(SUM(OVR_WGT_SCG_D2_AMT_USD ),0)
              ,NVL(SUM(HZD_MTRL_SCG_D2_AMT_USD),0)    
              ,NVL(SUM(D2_AMT_SUM_USD          ),0)
              ,NVL(SUM(BZC_D4_AMT_USD          ),0)
              ,NVL(SUM(FUEL_SCG_D4_AMT_USD      ),0)
              ,NVL(SUM(SCG_VAT_D4_AMT_USD      ),0)
              ,NVL(SUM(NEGO_D4_AMT_USD          ),0)
              ,NVL(SUM(TOLL_FEE_D4_AMT_USD          ),0)
              ,NVL(SUM(ETC_ADD_D4_AMT_USD      ),0)
              ,NVL(SUM(RAIL_ETC_ADD_D4_AMT_USD),0)    
              ,NVL(SUM(TRUK_ETC_ADD_D4_AMT_USD),0)    
              ,NVL(SUM(HJL_HNDL_D4_AMT_USD      ),0)
              ,NVL(SUM(OVR_WGT_SCG_D4_AMT_USD ),0)
              ,NVL(SUM(HZD_MTRL_SCG_D4_AMT_USD),0)    
              ,NVL(SUM(D4_AMT_SUM_USD          ),0)
              ,NVL(SUM(BZC_AMT_USD              ),0)
              ,NVL(SUM(FUEL_SCG_AMT_USD          ),0)
              ,NVL(SUM(SCG_VAT_AMT_USD          ),0)
              ,NVL(SUM(NEGO_AMT_USD              ),0)
              ,NVL(SUM(TOLL_FEE_AMT_USD              ),0)
              ,NVL(SUM(ETC_ADD_AMT_USD          ),0)
              ,NVL(SUM(RAIL_ETC_ADD_AMT_USD      ),0)
              ,NVL(SUM(TRUK_ETC_ADD_AMT_USD      ),0)
              ,NVL(SUM(HJL_HNDL_AMT_USD          ),0)
              ,NVL(SUM(OVR_WGT_SCG_AMT_USD      ),0)
              ,NVL(SUM(HZD_MTRL_SCG_AMT_USD      ),0)
              ,NVL(SUM(TOT_AMT_USD              ),0)
              ,NVL(SUM(CNTN20                  ),0)
              ,NVL(SUM(CNTN40                  ),0)
              ,NVL(SUM(CNTN_TEU                  ),0)
              ,NVL(SUM(CNTN_BOX                  ),0)
              ,NVL(SUM(D2_CNT                  ),0)
              ,NVL(SUM(D4_CNT                  ),0)
              ,NVL(SUM(D5_CNT                  ),0)
              ,NVL(SUM(D7_CNT                  ),0)
              ,NVL(SUM(R2_CNT                  ),0)
              ,NVL(SUM(R4_CNT                  ),0)
              ,NVL(SUM(R5_CNT                  ),0)
              ,NVL(SUM(R7_CNT                  ),0)
              ,NVL(SUM(R8_CNT                  ),0)
              ,NVL(SUM(F2_CNT                  ),0)
              ,NVL(SUM(F4_CNT                  ),0)
              ,NVL(SUM(F5_CNT                  ),0)
              ,NVL(SUM(A2_CNT                  ),0)
              ,NVL(SUM(A4_CNT                  ),0)
              ,NVL(SUM(A5_CNT                  ),0)
              ,NVL(SUM(P2_CNT                  ),0)
              ,NVL(SUM(P4_CNT                  ),0)
              ,NVL(SUM(O2_CNT                  ),0)
              ,NVL(SUM(O4_CNT                  ),0)
              ,NVL(SUM(O5_CNT                  ),0)
              ,NVL(SUM(O7_CNT                  ),0)
              ,NVL(SUM(S2_CNT                  ),0)
              ,NVL(SUM(S4_CNT                  ),0)
              ,NVL(SUM(T2_CNT                  ),0)
              ,NVL(SUM(T4_CNT                  ),0)
              ,NVL(SUM(DX_CNT                  ),0)
              ,NVL(SUM(DW_CNT                  ),0)
        FROM WITH_RESULT    
        WHERE HJL_SUB_SUM_TITLE IS NOT NULL
        -- GROUP BY 를 HJS_SUB_SUM(HJL_VNDR_SEQ) + SUM_SUM(VNDR_SEQ) 를 합해서 수행
        GROUP BY HJL_SUB_SUM_TITLE
                ,SUB_SUM_TITLE 
                ,INV_CURR_CD     
    
        -- HJL_VENDOR SEQ가 없는 VENDOR SEQ 로만 SUM SUM
        UNION ALL
        SELECT '23' DIV
               ,SUB_SUM_TITLE  || ' Total' CRE_OFC_CD
               ,NULL CRE_MONTH    
               ,NULL TRSP_COST_DTL_MOD_CD    
               ,NULL TRSP_CRR_MOD_CD    
               ,NULL TRSP_BND_CD    
               ,NULL TRSP_SO_TP_CD    
               ,NULL TRSP_SO_TP_NM    
               ,NULL NOD_CD    
               ,NULL FM_NOD_CD    
               ,NULL VIA_NOD_CD    
               ,NULL TO_NOD_CD    
               ,NULL DOR_NOD_CD    
               ,NULL ETS_YN    
               ,NVL(SUM(TTL_DIST                  ),0)
               ,NULL LNK_DIST_DIV_CD    
               ,INV_CURR_CD    
               ,NULL VNDR_SEQ    
               ,NULL VNDR_ABBR_NM    
               ,MAX(SUB_SUM_TITLE    )
               ,NULL HJL_VNDR_SEQ    
               ,NULL HJL_VNDR_ABBR_NM    
               ,MAX(HJL_SUB_SUM_TITLE)    
               ,NVL(SUM(INV_BZC_D2_AMT          ),0)
               ,NVL(SUM(INV_ETC_ADD_D2_AMT      ),0)
               ,NVL(SUM(INV_BZC_D4_AMT          ),0)
               ,NVL(SUM(INV_ETC_ADD_D4_AMT      ),0)
               ,NVL(SUM(INV_BZC_AMT              ),0)
               ,NVL(SUM(INV_ETC_ADD_AMT          ),0)
               ,NVL(SUM(INV_TOT_AMT              ),0)
               ,NVL(SUM(INV_BZC_D2_AMT_USD      ),0)
               ,NVL(SUM(INV_BZC_D4_AMT_USD      ),0)
               ,NVL(SUM(INV_ETC_ADD_D2_AMT_USD ),0)
               ,NVL(SUM(INV_ETC_ADD_D4_AMT_USD ),0)
               ,NVL(SUM(INV_BZC_AMT_USD          ),0)
               ,NVL(SUM(INV_ETC_ADD_AMT_USD      ),0)
               ,NVL(SUM(INV_TOT_AMT_USD          ),0)
               ,NVL(SUM(BZC_D2_AMT              ),0)
               ,NVL(SUM(FUEL_SCG_D2_AMT          ),0)
               ,NVL(SUM(SCG_VAT_D2_AMT          ),0)
               ,NVL(SUM(NEGO_D2_AMT              ),0)
               ,NVL(SUM(TOLL_FEE_D2_AMT              ),0)
               ,NVL(SUM(ETC_ADD_D2_AMT          ),0)
               ,NVL(SUM(RAIL_ETC_ADD_D2_AMT      ),0)
               ,NVL(SUM(TRUK_ETC_ADD_D2_AMT      ),0)
               ,NVL(SUM(HJL_HNDL_D2_AMT          ),0)
               ,NVL(SUM(OVR_WGT_SCG_D2_AMT      ),0)
               ,NVL(SUM(HZD_MTRL_SCG_D2_AMT      ),0)
               ,NVL(SUM(D2_AMT_SUM              ),0)
               ,NVL(SUM(BZC_D4_AMT              ),0)
               ,NVL(SUM(FUEL_SCG_D4_AMT          ),0)
               ,NVL(SUM(SCG_VAT_D4_AMT          ),0)
               ,NVL(SUM(NEGO_D4_AMT              ),0)
               ,NVL(SUM(TOLL_FEE_D4_AMT              ),0)
               ,NVL(SUM(ETC_ADD_D4_AMT          ),0)
               ,NVL(SUM(RAIL_ETC_ADD_D4_AMT      ),0)
               ,NVL(SUM(TRUK_ETC_ADD_D4_AMT      ),0)
               ,NVL(SUM(HJL_HNDL_D4_AMT          ),0)
               ,NVL(SUM(OVR_WGT_SCG_D4_AMT      ),0)
               ,NVL(SUM(HZD_MTRL_SCG_D4_AMT      ),0)
               ,NVL(SUM(D4_AMT_SUM              ),0)
               ,NVL(SUM(BZC_AMT                  ),0)
               ,NVL(SUM(FUEL_SCG_AMT              ),0)
               ,NVL(SUM(SCG_VAT_AMT              ),0)
               ,NVL(SUM(NEGO_AMT                  ),0)
               ,NVL(SUM(TOLL_FEE_AMT                  ),0)
               ,NVL(SUM(ETC_ADD_AMT              ),0)
               ,NVL(SUM(RAIL_ETC_ADD_AMT          ),0)
               ,NVL(SUM(TRUK_ETC_ADD_AMT          ),0)
               ,NVL(SUM(HJL_HNDL_AMT              ),0)
               ,NVL(SUM(OVR_WGT_SCG_AMT          ),0)
               ,NVL(SUM(HZD_MTRL_SCG_AMT          ),0)
               ,NVL(SUM(TOT_AMT                  ),0)
               ,NVL(SUM(BZC_D2_AMT_USD          ),0)
               ,NVL(SUM(FUEL_SCG_D2_AMT_USD      ),0)
               ,NVL(SUM(SCG_VAT_D2_AMT_USD      ),0)
               ,NVL(SUM(NEGO_D2_AMT_USD          ),0)
               ,NVL(SUM(TOLL_FEE_D2_AMT_USD          ),0)
               ,NVL(SUM(ETC_ADD_D2_AMT_USD      ),0)
               ,NVL(SUM(RAIL_ETC_ADD_D2_AMT_USD),0)    
               ,NVL(SUM(TRUK_ETC_ADD_D2_AMT_USD),0)    
               ,NVL(SUM(HJL_HNDL_D2_AMT_USD      ),0)
               ,NVL(SUM(OVR_WGT_SCG_D2_AMT_USD ),0)
               ,NVL(SUM(HZD_MTRL_SCG_D2_AMT_USD),0)    
               ,NVL(SUM(D2_AMT_SUM_USD          ),0)
               ,NVL(SUM(BZC_D4_AMT_USD          ),0)
               ,NVL(SUM(FUEL_SCG_D4_AMT_USD      ),0)
               ,NVL(SUM(SCG_VAT_D4_AMT_USD      ),0)
               ,NVL(SUM(NEGO_D4_AMT_USD          ),0)
               ,NVL(SUM(TOLL_FEE_D4_AMT_USD          ),0)
               ,NVL(SUM(ETC_ADD_D4_AMT_USD      ),0)
               ,NVL(SUM(RAIL_ETC_ADD_D4_AMT_USD),0)    
               ,NVL(SUM(TRUK_ETC_ADD_D4_AMT_USD),0)    
               ,NVL(SUM(HJL_HNDL_D4_AMT_USD      ),0)
               ,NVL(SUM(OVR_WGT_SCG_D4_AMT_USD ),0)
               ,NVL(SUM(HZD_MTRL_SCG_D4_AMT_USD),0)    
               ,NVL(SUM(D4_AMT_SUM_USD          ),0)
               ,NVL(SUM(BZC_AMT_USD              ),0)
               ,NVL(SUM(FUEL_SCG_AMT_USD          ),0)
               ,NVL(SUM(SCG_VAT_AMT_USD          ),0)
               ,NVL(SUM(NEGO_AMT_USD              ),0)
               ,NVL(SUM(TOLL_FEE_AMT_USD              ),0)
               ,NVL(SUM(ETC_ADD_AMT_USD          ),0)
               ,NVL(SUM(RAIL_ETC_ADD_AMT_USD      ),0)
               ,NVL(SUM(TRUK_ETC_ADD_AMT_USD      ),0)
               ,NVL(SUM(HJL_HNDL_AMT_USD          ),0)
               ,NVL(SUM(OVR_WGT_SCG_AMT_USD      ),0)
               ,NVL(SUM(HZD_MTRL_SCG_AMT_USD      ),0)
               ,NVL(SUM(TOT_AMT_USD              ),0)
               ,NVL(SUM(CNTN20                  ),0)
               ,NVL(SUM(CNTN40                  ),0)
               ,NVL(SUM(CNTN_TEU                  ),0)
               ,NVL(SUM(CNTN_BOX                  ),0)
               ,NVL(SUM(D2_CNT                  ),0)
               ,NVL(SUM(D4_CNT                  ),0)
               ,NVL(SUM(D5_CNT                  ),0)
               ,NVL(SUM(D7_CNT                  ),0)
               ,NVL(SUM(R2_CNT                  ),0)
               ,NVL(SUM(R4_CNT                  ),0)
               ,NVL(SUM(R5_CNT                  ),0)
               ,NVL(SUM(R7_CNT                  ),0)
               ,NVL(SUM(R8_CNT                  ),0)
               ,NVL(SUM(F2_CNT                  ),0)
               ,NVL(SUM(F4_CNT                  ),0)
               ,NVL(SUM(F5_CNT                  ),0)
               ,NVL(SUM(A2_CNT                  ),0)
               ,NVL(SUM(A4_CNT                  ),0)
               ,NVL(SUM(A5_CNT                  ),0)
               ,NVL(SUM(P2_CNT                  ),0)
               ,NVL(SUM(P4_CNT                  ),0)
               ,NVL(SUM(O2_CNT                  ),0)
               ,NVL(SUM(O4_CNT                  ),0)
               ,NVL(SUM(O5_CNT                  ),0)
               ,NVL(SUM(O7_CNT                  ),0)
               ,NVL(SUM(S2_CNT                  ),0)
               ,NVL(SUM(S4_CNT                  ),0)
               ,NVL(SUM(T2_CNT                  ),0)
               ,NVL(SUM(T4_CNT                  ),0)
               ,NVL(SUM(DX_CNT                  ),0)
               ,NVL(SUM(DW_CNT                  ),0)
        FROM WITH_RESULT    
        WHERE HJL_SUB_SUM_TITLE IS NULL
        GROUP BY SUB_SUM_TITLE
                ,INV_CURR_CD     
    
        -- VENDOR SEQ 로만 SUM SUM                              
        UNION ALL
        SELECT '33' DIV
               ,SUB_SUM_TITLE || ' Total' CRE_OFC_CD
               ,NULL CRE_MONTH    
               ,NULL TRSP_COST_DTL_MOD_CD    
               ,NULL TRSP_CRR_MOD_CD    
               ,NULL TRSP_BND_CD    
               ,NULL TRSP_SO_TP_CD    
               ,NULL TRSP_SO_TP_NM    
               ,NULL NOD_CD    
               ,NULL FM_NOD_CD    
               ,NULL VIA_NOD_CD    
               ,NULL TO_NOD_CD    
               ,NULL DOR_NOD_CD    
               ,NULL ETS_YN    
               ,NVL(SUM(TTL_DIST                  ),0)
               ,NULL LNK_DIST_DIV_CD    
               ,INV_CURR_CD    
               ,NULL VNDR_SEQ    
               ,NULL VNDR_ABBR_NM    
               ,MAX(SUB_SUM_TITLE    )
               ,NULL HJL_VNDR_SEQ    
               ,NULL HJL_VNDR_ABBR_NM    
               ,MAX(HJL_SUB_SUM_TITLE    )
               ,NVL(SUM(INV_BZC_D2_AMT          ),0)
               ,NVL(SUM(INV_ETC_ADD_D2_AMT      ),0)
               ,NVL(SUM(INV_BZC_D4_AMT          ),0)
               ,NVL(SUM(INV_ETC_ADD_D4_AMT      ),0)
               ,NVL(SUM(INV_BZC_AMT              ),0)
               ,NVL(SUM(INV_ETC_ADD_AMT          ),0)
               ,NVL(SUM(INV_TOT_AMT              ),0)
               ,NVL(SUM(INV_BZC_D2_AMT_USD      ),0)
               ,NVL(SUM(INV_BZC_D4_AMT_USD      ),0)
               ,NVL(SUM(INV_ETC_ADD_D2_AMT_USD ),0)
               ,NVL(SUM(INV_ETC_ADD_D4_AMT_USD ),0)
               ,NVL(SUM(INV_BZC_AMT_USD          ),0)
               ,NVL(SUM(INV_ETC_ADD_AMT_USD      ),0)
               ,NVL(SUM(INV_TOT_AMT_USD          ),0)
               ,NVL(SUM(BZC_D2_AMT              ),0)
               ,NVL(SUM(FUEL_SCG_D2_AMT          ),0)
               ,NVL(SUM(SCG_VAT_D2_AMT          ),0)
               ,NVL(SUM(NEGO_D2_AMT              ),0)
               ,NVL(SUM(TOLL_FEE_D2_AMT              ),0)
               ,NVL(SUM(ETC_ADD_D2_AMT          ),0)
               ,NVL(SUM(RAIL_ETC_ADD_D2_AMT      ),0)
               ,NVL(SUM(TRUK_ETC_ADD_D2_AMT      ),0)
               ,NVL(SUM(HJL_HNDL_D2_AMT          ),0)
               ,NVL(SUM(OVR_WGT_SCG_D2_AMT      ),0)
               ,NVL(SUM(HZD_MTRL_SCG_D2_AMT      ),0)
               ,NVL(SUM(D2_AMT_SUM              ),0)
               ,NVL(SUM(BZC_D4_AMT              ),0)
               ,NVL(SUM(FUEL_SCG_D4_AMT          ),0)
               ,NVL(SUM(SCG_VAT_D4_AMT          ),0)
               ,NVL(SUM(NEGO_D4_AMT              ),0)
               ,NVL(SUM(TOLL_FEE_D4_AMT              ),0)
               ,NVL(SUM(ETC_ADD_D4_AMT          ),0)
               ,NVL(SUM(RAIL_ETC_ADD_D4_AMT      ),0)
               ,NVL(SUM(TRUK_ETC_ADD_D4_AMT      ),0)
               ,NVL(SUM(HJL_HNDL_D4_AMT          ),0)
               ,NVL(SUM(OVR_WGT_SCG_D4_AMT      ),0)
               ,NVL(SUM(HZD_MTRL_SCG_D4_AMT      ),0)
               ,NVL(SUM(D4_AMT_SUM              ),0)
               ,NVL(SUM(BZC_AMT                  ),0)
               ,NVL(SUM(FUEL_SCG_AMT              ),0)
               ,NVL(SUM(SCG_VAT_AMT              ),0)
               ,NVL(SUM(NEGO_AMT                  ),0)
               ,NVL(SUM(TOLL_FEE_AMT                  ),0)
               ,NVL(SUM(ETC_ADD_AMT              ),0)
               ,NVL(SUM(RAIL_ETC_ADD_AMT          ),0)
               ,NVL(SUM(TRUK_ETC_ADD_AMT          ),0)
               ,NVL(SUM(HJL_HNDL_AMT              ),0)
               ,NVL(SUM(OVR_WGT_SCG_AMT          ),0)
               ,NVL(SUM(HZD_MTRL_SCG_AMT          ),0)
               ,NVL(SUM(TOT_AMT                  ),0)
               ,NVL(SUM(BZC_D2_AMT_USD          ),0)
               ,NVL(SUM(FUEL_SCG_D2_AMT_USD      ),0)
               ,NVL(SUM(SCG_VAT_D2_AMT_USD      ),0)
               ,NVL(SUM(NEGO_D2_AMT_USD          ),0)
               ,NVL(SUM(TOLL_FEE_D2_AMT_USD          ),0)
               ,NVL(SUM(ETC_ADD_D2_AMT_USD      ),0)
               ,NVL(SUM(RAIL_ETC_ADD_D2_AMT_USD),0)    
               ,NVL(SUM(TRUK_ETC_ADD_D2_AMT_USD),0)    
               ,NVL(SUM(HJL_HNDL_D2_AMT_USD      ),0)
               ,NVL(SUM(OVR_WGT_SCG_D2_AMT_USD ),0)
               ,NVL(SUM(HZD_MTRL_SCG_D2_AMT_USD),0)    
               ,NVL(SUM(D2_AMT_SUM_USD          ),0)
               ,NVL(SUM(BZC_D4_AMT_USD          ),0)
               ,NVL(SUM(FUEL_SCG_D4_AMT_USD      ),0)
               ,NVL(SUM(SCG_VAT_D4_AMT_USD      ),0)
               ,NVL(SUM(NEGO_D4_AMT_USD          ),0)
               ,NVL(SUM(TOLL_FEE_D4_AMT_USD          ),0)
               ,NVL(SUM(ETC_ADD_D4_AMT_USD      ),0)
               ,NVL(SUM(RAIL_ETC_ADD_D4_AMT_USD),0)    
               ,NVL(SUM(TRUK_ETC_ADD_D4_AMT_USD),0)    
               ,NVL(SUM(HJL_HNDL_D4_AMT_USD      ),0)
               ,NVL(SUM(OVR_WGT_SCG_D4_AMT_USD ),0)
               ,NVL(SUM(HZD_MTRL_SCG_D4_AMT_USD),0)    
               ,NVL(SUM(D4_AMT_SUM_USD          ),0)
               ,NVL(SUM(BZC_AMT_USD              ),0)
               ,NVL(SUM(FUEL_SCG_AMT_USD          ),0)
               ,NVL(SUM(SCG_VAT_AMT_USD          ),0)
               ,NVL(SUM(NEGO_AMT_USD              ),0)
               ,NVL(SUM(TOLL_FEE_AMT_USD              ),0)
               ,NVL(SUM(ETC_ADD_AMT_USD          ),0)
               ,NVL(SUM(RAIL_ETC_ADD_AMT_USD      ),0)
               ,NVL(SUM(TRUK_ETC_ADD_AMT_USD      ),0)
               ,NVL(SUM(HJL_HNDL_AMT_USD          ),0)
               ,NVL(SUM(OVR_WGT_SCG_AMT_USD      ),0)
               ,NVL(SUM(HZD_MTRL_SCG_AMT_USD      ),0)
               ,NVL(SUM(TOT_AMT_USD              ),0)
               ,NVL(SUM(CNTN20                  ),0)
               ,NVL(SUM(CNTN40                  ),0)
               ,NVL(SUM(CNTN_TEU                  ),0)
               ,NVL(SUM(CNTN_BOX                  ),0)
               ,NVL(SUM(D2_CNT                  ),0)
               ,NVL(SUM(D4_CNT                  ),0)
               ,NVL(SUM(D5_CNT                  ),0)
               ,NVL(SUM(D7_CNT                  ),0)
               ,NVL(SUM(R2_CNT                  ),0)
               ,NVL(SUM(R4_CNT                  ),0)
               ,NVL(SUM(R5_CNT                  ),0)
               ,NVL(SUM(R7_CNT                  ),0)
               ,NVL(SUM(R8_CNT                  ),0)
               ,NVL(SUM(F2_CNT                  ),0)
               ,NVL(SUM(F4_CNT                  ),0)
               ,NVL(SUM(F5_CNT                  ),0)
               ,NVL(SUM(A2_CNT                  ),0)
               ,NVL(SUM(A4_CNT                  ),0)
               ,NVL(SUM(A5_CNT                  ),0)
               ,NVL(SUM(P2_CNT                  ),0)
               ,NVL(SUM(P4_CNT                  ),0)
               ,NVL(SUM(O2_CNT                  ),0)
               ,NVL(SUM(O4_CNT                  ),0)
               ,NVL(SUM(O5_CNT                  ),0)
               ,NVL(SUM(O7_CNT                  ),0)
               ,NVL(SUM(S2_CNT                  ),0)
               ,NVL(SUM(S4_CNT                  ),0)
               ,NVL(SUM(T2_CNT                  ),0)
               ,NVL(SUM(T4_CNT                  ),0)
               ,NVL(SUM(DX_CNT                  ),0)
               ,NVL(SUM(DW_CNT                  ),0)
        FROM WITH_RESULT 
        WHERE HJL_SUB_SUM_TITLE IS NOT NULL   
        GROUP BY SUB_SUM_TITLE || ' Total'
                ,INV_CURR_CD     
    
        -- 환율별 전체 TOTAL 
        UNION ALL
        SELECT '44' DIV
              ,'G/Total' CRE_OFC_CD    
              ,NULL CRE_MONTH    
              ,NULL TRSP_COST_DTL_MOD_CD    
              ,NULL TRSP_CRR_MOD_CD    
              ,NULL TRSP_BND_CD    
              ,NULL TRSP_SO_TP_CD    
              ,NULL TRSP_SO_TP_NM    
              ,NULL NOD_CD    
              ,NULL FM_NOD_CD    
              ,NULL VIA_NOD_CD    
              ,NULL TO_NOD_CD    
              ,NULL DOR_NOD_CD    
              ,NULL ETS_YN    
              ,NVL(SUM(TTL_DIST                  ),0)
              ,NULL LNK_DIST_DIV_CD    
              ,INV_CURR_CD    
              ,NULL VNDR_SEQ    
              ,NULL VNDR_ABBR_NM    
              ,NULL SUB_SUM_TITLE    
              ,NULL HJL_VNDR_SEQ    
              ,NULL HJL_VNDR_ABBR_NM    
              ,NULL HJL_SUB_SUM_TITLE    
              ,NVL(SUM(INV_BZC_D2_AMT          ),0)
              ,NVL(SUM(INV_ETC_ADD_D2_AMT      ),0)
              ,NVL(SUM(INV_BZC_D4_AMT          ),0)
              ,NVL(SUM(INV_ETC_ADD_D4_AMT      ),0)
              ,NVL(SUM(INV_BZC_AMT              ),0)
              ,NVL(SUM(INV_ETC_ADD_AMT          ),0)
              ,NVL(SUM(INV_TOT_AMT              ),0)
              ,NVL(SUM(INV_BZC_D2_AMT_USD      ),0)
              ,NVL(SUM(INV_BZC_D4_AMT_USD      ),0)
              ,NVL(SUM(INV_ETC_ADD_D2_AMT_USD ),0)
              ,NVL(SUM(INV_ETC_ADD_D4_AMT_USD ),0)
              ,NVL(SUM(INV_BZC_AMT_USD          ),0)
              ,NVL(SUM(INV_ETC_ADD_AMT_USD      ),0)
              ,NVL(SUM(INV_TOT_AMT_USD          ),0)
              ,NVL(SUM(BZC_D2_AMT              ),0)
              ,NVL(SUM(FUEL_SCG_D2_AMT          ),0)
              ,NVL(SUM(SCG_VAT_D2_AMT          ),0)
              ,NVL(SUM(NEGO_D2_AMT              ),0)
              ,NVL(SUM(TOLL_FEE_D2_AMT              ),0)
              ,NVL(SUM(ETC_ADD_D2_AMT          ),0)
              ,NVL(SUM(RAIL_ETC_ADD_D2_AMT      ),0)
              ,NVL(SUM(TRUK_ETC_ADD_D2_AMT      ),0)
              ,NVL(SUM(HJL_HNDL_D2_AMT          ),0)
              ,NVL(SUM(OVR_WGT_SCG_D2_AMT      ),0)
              ,NVL(SUM(HZD_MTRL_SCG_D2_AMT      ),0)
              ,NVL(SUM(D2_AMT_SUM              ),0)
              ,NVL(SUM(BZC_D4_AMT              ),0)
              ,NVL(SUM(FUEL_SCG_D4_AMT          ),0)
              ,NVL(SUM(SCG_VAT_D4_AMT          ),0)
              ,NVL(SUM(NEGO_D4_AMT              ),0)
              ,NVL(SUM(TOLL_FEE_D4_AMT              ),0)
              ,NVL(SUM(ETC_ADD_D4_AMT          ),0)
              ,NVL(SUM(RAIL_ETC_ADD_D4_AMT      ),0)
              ,NVL(SUM(TRUK_ETC_ADD_D4_AMT      ),0)
              ,NVL(SUM(HJL_HNDL_D4_AMT          ),0)
              ,NVL(SUM(OVR_WGT_SCG_D4_AMT      ),0)
              ,NVL(SUM(HZD_MTRL_SCG_D4_AMT      ),0)
              ,NVL(SUM(D4_AMT_SUM              ),0)
              ,NVL(SUM(BZC_AMT                  ),0)
              ,NVL(SUM(FUEL_SCG_AMT              ),0)
              ,NVL(SUM(SCG_VAT_AMT              ),0)
              ,NVL(SUM(NEGO_AMT                  ),0)
              ,NVL(SUM(TOLL_FEE_AMT                  ),0)
              ,NVL(SUM(ETC_ADD_AMT              ),0)
              ,NVL(SUM(RAIL_ETC_ADD_AMT          ),0)
              ,NVL(SUM(TRUK_ETC_ADD_AMT          ),0)
              ,NVL(SUM(HJL_HNDL_AMT              ),0)
              ,NVL(SUM(OVR_WGT_SCG_AMT          ),0)
              ,NVL(SUM(HZD_MTRL_SCG_AMT          ),0)
              ,NVL(SUM(TOT_AMT                  ),0)
              ,NVL(SUM(BZC_D2_AMT_USD          ),0)
              ,NVL(SUM(FUEL_SCG_D2_AMT_USD      ),0)
              ,NVL(SUM(SCG_VAT_D2_AMT_USD      ),0)
              ,NVL(SUM(NEGO_D2_AMT_USD          ),0)
              ,NVL(SUM(TOLL_FEE_D2_AMT_USD          ),0)
              ,NVL(SUM(ETC_ADD_D2_AMT_USD      ),0)
              ,NVL(SUM(RAIL_ETC_ADD_D2_AMT_USD),0)    
              ,NVL(SUM(TRUK_ETC_ADD_D2_AMT_USD),0)    
              ,NVL(SUM(HJL_HNDL_D2_AMT_USD      ),0)
              ,NVL(SUM(OVR_WGT_SCG_D2_AMT_USD ),0)
              ,NVL(SUM(HZD_MTRL_SCG_D2_AMT_USD),0)    
              ,NVL(SUM(D2_AMT_SUM_USD          ),0)
              ,NVL(SUM(BZC_D4_AMT_USD          ),0)
              ,NVL(SUM(FUEL_SCG_D4_AMT_USD      ),0)
              ,NVL(SUM(SCG_VAT_D4_AMT_USD      ),0)
              ,NVL(SUM(NEGO_D4_AMT_USD          ),0)
              ,NVL(SUM(TOLL_FEE_D4_AMT_USD          ),0)
              ,NVL(SUM(ETC_ADD_D4_AMT_USD      ),0)
              ,NVL(SUM(RAIL_ETC_ADD_D4_AMT_USD),0)    
              ,NVL(SUM(TRUK_ETC_ADD_D4_AMT_USD),0)    
              ,NVL(SUM(HJL_HNDL_D4_AMT_USD      ),0)
              ,NVL(SUM(OVR_WGT_SCG_D4_AMT_USD ),0)
              ,NVL(SUM(HZD_MTRL_SCG_D4_AMT_USD),0)    
              ,NVL(SUM(D4_AMT_SUM_USD          ),0)
              ,NVL(SUM(BZC_AMT_USD              ),0)
              ,NVL(SUM(FUEL_SCG_AMT_USD          ),0)
              ,NVL(SUM(SCG_VAT_AMT_USD          ),0)
              ,NVL(SUM(NEGO_AMT_USD              ),0)
              ,NVL(SUM(TOLL_FEE_AMT_USD              ),0)
              ,NVL(SUM(ETC_ADD_AMT_USD          ),0)
              ,NVL(SUM(RAIL_ETC_ADD_AMT_USD      ),0)
              ,NVL(SUM(TRUK_ETC_ADD_AMT_USD      ),0)
              ,NVL(SUM(HJL_HNDL_AMT_USD          ),0)
              ,NVL(SUM(OVR_WGT_SCG_AMT_USD      ),0)
              ,NVL(SUM(HZD_MTRL_SCG_AMT_USD      ),0)
              ,NVL(SUM(TOT_AMT_USD              ),0)
              ,NVL(SUM(CNTN20                  ),0)
              ,NVL(SUM(CNTN40                  ),0)
              ,NVL(SUM(CNTN_TEU                  ),0)
              ,NVL(SUM(CNTN_BOX                  ),0)
              ,NVL(SUM(D2_CNT                  ),0)
              ,NVL(SUM(D4_CNT                  ),0)
              ,NVL(SUM(D5_CNT                  ),0)
              ,NVL(SUM(D7_CNT                  ),0)
              ,NVL(SUM(R2_CNT                  ),0)
              ,NVL(SUM(R4_CNT                  ),0)
              ,NVL(SUM(R5_CNT                  ),0)
              ,NVL(SUM(R7_CNT                  ),0)
              ,NVL(SUM(R8_CNT                  ),0)
              ,NVL(SUM(F2_CNT                  ),0)
              ,NVL(SUM(F4_CNT                  ),0)
              ,NVL(SUM(F5_CNT                  ),0)
              ,NVL(SUM(A2_CNT                  ),0)
              ,NVL(SUM(A4_CNT                  ),0)
              ,NVL(SUM(A5_CNT                  ),0)
              ,NVL(SUM(P2_CNT                  ),0)
              ,NVL(SUM(P4_CNT                  ),0)
              ,NVL(SUM(O2_CNT                  ),0)
              ,NVL(SUM(O4_CNT                  ),0)
              ,NVL(SUM(O5_CNT                  ),0)
              ,NVL(SUM(O7_CNT                  ),0)
              ,NVL(SUM(S2_CNT                  ),0)
              ,NVL(SUM(S4_CNT                  ),0)
              ,NVL(SUM(T2_CNT                  ),0)
              ,NVL(SUM(T4_CNT                  ),0)
              ,NVL(SUM(DX_CNT                  ),0)
              ,NVL(SUM(DW_CNT                  ),0)
        FROM WITH_RESULT    
        GROUP BY 'G/Total'
                ,INV_CURR_CD         
        
    )   
    ORDER BY SUB_SUM_TITLE
            ,HJL_SUB_SUM_TITLE
            ,DIV
            ,CRE_MONTH
            ,TRSP_BND_CD             
)             

#if (${grid_flg} == 'Y')
WHERE     ROWNUM < 2001
#end			]]></sql>
			<params>
				<param name="node_div" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
