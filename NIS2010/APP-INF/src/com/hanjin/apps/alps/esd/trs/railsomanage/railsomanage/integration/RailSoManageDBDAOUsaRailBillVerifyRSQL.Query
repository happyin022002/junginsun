<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RailSoManageDBDAOUsaRailBillVerifyRSQL">
			<desc><![CDATA[SO 대상 중복여부 Verify SQL]]></desc>
			<sql><![CDATA[
#set(${verifyRepoPlnId}=${verifyRepoPlnId})
#set(${verifyPlnYrwk}=${verifyPlnYrwk})
#set(${verifyRefId}=${verifyRefId})
#set(${verifyRefSeq}=${verifyRefSeq})


#foreach(${key} IN ${arrNo})
#if($velocityCount == 1)	

SELECT 
    'X' CHK_UNIT 
FROM 
    DUAL 
WHERE EXISTS (
                SELECT 
                    'X' 
                FROM 
                    TRS_TRSP_RAIL_BIL_ORD 
                WHERE REPO_PLN_ID = ${verifyRepoPlnId.get($key)}
                AND   PLN_YRWK = ${verifyPlnYrwk.get($key)}
                AND   REF_ID = ${verifyRefId.get($key)}
                AND   REF_SEQ = ${verifyRefSeq.get($key)}
                AND   DELT_FLG = 'N'
             ) 
OR EXISTS (
            SELECT 
                'X' 
            FROM 
                TRS_TRSP_SVC_ORD 
            WHERE REPO_PLN_ID = ${verifyRepoPlnId.get($key)}
            AND   PLN_YRWK = ${verifyPlnYrwk.get($key)}
            AND   REF_ID = ${verifyRefId.get($key)}
            AND   REF_SEQ = ${verifyRefSeq.get($key)}
            AND   DELT_FLG = 'N'
          )             
    

#else	

UNION
SELECT 
    'X' CHK_UNIT 
FROM 
    DUAL 
WHERE EXISTS (
                SELECT 
                    'X' 
                FROM 
                    TRS_TRSP_RAIL_BIL_ORD 
                WHERE REPO_PLN_ID = ${verifyRepoPlnId.get($key)}
                AND   PLN_YRWK = ${verifyPlnYrwk.get($key)}
                AND   REF_ID = ${verifyRefId.get($key)}
                AND   REF_SEQ = ${verifyRefSeq.get($key)}
                AND   DELT_FLG = 'N'
             ) 
OR EXISTS (
            SELECT 
                'X' 
            FROM 
                TRS_TRSP_SVC_ORD 
            WHERE REPO_PLN_ID = ${verifyRepoPlnId.get($key)}
            AND   PLN_YRWK = ${verifyPlnYrwk.get($key)}
            AND   REF_ID = ${verifyRefId.get($key)}
            AND   REF_SEQ = ${verifyRefSeq.get($key)}
            AND   DELT_FLG = 'N'
          )                 
   

#end 
#end			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
