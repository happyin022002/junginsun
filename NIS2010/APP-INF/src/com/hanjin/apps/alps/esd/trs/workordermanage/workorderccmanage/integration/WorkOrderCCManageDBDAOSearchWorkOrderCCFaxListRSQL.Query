<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WorkOrderCCManageDBDAOSearchWorkOrderCCFaxListRSQL">
			<desc><![CDATA[입력된 vndr_seq 에 대한 팩스 정보 목록을 조회한다.]]></desc>
			<sql><![CDATA[
SELECT 
    A.TRS_CHK
,   A.MDM_CHK
,   A.WO_FAX_NO
,   A.VNDR_SEQ
,   A.WO_CC_SEQ 
FROM 
(
SELECT 
     DECODE(E.WO_FAX_NO, NULL, '0', '1' ) TRS_CHK
,   '1' MDM_CHK
,   M.INTL_FAX_NO || '-' || M.FAX_NO WO_FAX_NO
,   M.VNDR_SEQ VNDR_SEQ
,   M.VNDR_CNTC_PNT_SEQ WO_CC_SEQ
FROM
    MDM_VNDR_CNTC_PNT M
,   TRS_TRSP_WRK_ORD_CC_FAX E
WHERE
    M.FAX_NO IS NOT NULL
AND NVL(M.DELT_FLG, 'N') = 'N'
AND INSTR(M.VNDR_EML, '@') > 0
AND M.VNDR_SEQ = @[vndr_seq]
AND M.VNDR_SEQ = E.VNDR_SEQ(+)
AND M.INTL_FAX_NO = E.WO_FAX_NO(+)
UNION
SELECT
    '1' TRS_CHK
,   '0' MDM_CHK
,   E.WO_FAX_NO
,   E.VNDR_SEQ VNDR_SEQ
,   E.WO_CC_SEQ WO_CC_SEQ 
FROM
    TRS_TRSP_WRK_ORD_CC_FAX E
WHERE 
    E.WO_FAX_NO IS NOT NULL
AND E.VNDR_SEQ = @[vndr_seq]
AND NOT EXISTS
(
SELECT
'X'
FROM
MDM_VNDR_CNTC_PNT M
WHERE
M.VNDR_SEQ = E.VNDR_SEQ
AND M.INTL_FAX_NO = E.WO_FAX_NO
AND NVL(M.DELT_FLG, 'N') = 'N'
)
) A			]]></sql>
			<params>
				<param name="vndr_seq" type="2" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
