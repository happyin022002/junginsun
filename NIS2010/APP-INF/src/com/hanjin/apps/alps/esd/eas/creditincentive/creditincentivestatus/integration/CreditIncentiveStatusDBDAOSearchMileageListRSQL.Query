<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CreditIncentiveStatusDBDAOSearchMileageListRSQL">
			<desc><![CDATA[Search Mileage]]></desc>
			<sql><![CDATA[
SELECT A.BSE_YR
      ,A.INCNT_NO
      ,A.RHQ_CD
      ,A.TEAM_NM
      ,A.BANK_NM
      ,TO_CHAR(A.MLG_FM_DT,'YYYYMMDD') MLG_FM_DT
      ,TO_CHAR(A.MLG_TO_DT,'YYYYMMDD') MLG_TO_DT
      ,A.PAY_AMT
      ,TO_CHAR(A.MLG_ISS_DT,'YYYYMMDD') MLG_ISS_DT
      ,A.MLG_PNT_AMT
      ,TO_CHAR(A.CSH_BAK_DT,'YYYYMMDD') CSH_BAK_DT
      ,A.CSH_BAK_AMT
      ,SUM(SUM(A.MLG_PNT_AMT)-SUM(A.CSH_BAK_AMT)) OVER (ORDER BY A.BSE_YR,A.INCNT_NO) CSH_BAK_BAL_AMT
      ,A.INCNT_RMK
      ,DECODE(A.ATCH_FILE_LNK_ID,'','N','Y') ATCH_FLG
      ,A.ATCH_FILE_LNK_ID
	  ,DECODE(A.ATCH_N2ND_FILE_LNK_ID,'','N','Y') ATCH2_FLG
	  ,A.ATCH_N2ND_FILE_LNK_ID
      ,A.DELT_FLG
      ,A.CRE_USR_ID
      ,A.CRE_DT
      ,A.UPD_USR_ID
      ,A.UPD_DT
  FROM EAS_BNF_MLG A
 WHERE A.DELT_FLG = 'N'
#if (${s_fm_dt} !='' && ${s_to_dt} !='')
   AND A.MLG_ISS_DT BETWEEN TO_DATE(@[s_fm_dt],'YYYYMMDD') AND TO_DATE(@[s_to_dt],'YYYYMMDD')+0.99999
#end
GROUP BY A.BSE_YR
	    ,A.INCNT_NO
        ,A.RHQ_CD
        ,A.TEAM_NM
        ,A.BANK_NM
        ,TO_CHAR(A.MLG_FM_DT,'YYYYMMDD')
        ,TO_CHAR(A.MLG_TO_DT,'YYYYMMDD')
        ,A.PAY_AMT
        ,TO_CHAR(A.MLG_ISS_DT,'YYYYMMDD')
        ,A.MLG_PNT_AMT
        ,TO_CHAR(A.CSH_BAK_DT,'YYYYMMDD')
        ,A.CSH_BAK_AMT
        ,A.INCNT_RMK
        ,DECODE(A.ATCH_FILE_LNK_ID,'','N','Y')
        ,A.ATCH_FILE_LNK_ID
	    ,DECODE(A.ATCH_N2ND_FILE_LNK_ID,'','N','Y')
	    ,A.ATCH_N2ND_FILE_LNK_ID
        ,A.DELT_FLG
        ,A.CRE_USR_ID
        ,A.CRE_DT
        ,A.UPD_USR_ID
        ,A.UPD_DT
ORDER BY A.BSE_YR
        ,A.INCNT_NO			]]></sql>
			<params>
				<param name="s_fm_dt" type="12" value="" out="N"/>
				<param name="s_to_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
