<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WorkOrderIssueDBDAOsearchSpSelectListRSQL">
			<desc><![CDATA[searchSpSelectList]]></desc>
			<sql><![CDATA[
SELECT CASE WHEN WO_RJCT_FLG = 'Y' THEN '1' ELSE '0' END REJECTED_CHECK ,  
A.EQ_NO ,  
A.EQ_TPSZ_CD ,  
A.EQ_KND_CD ,  
A.CGO_TP_CD ,  
COMMCODE_PKG.GET_COMDTL_NAME_FNC('CD00748', A.CGO_TP_CD) AS CGO_TP_NM ,  
A.TRSP_COST_DTL_MOD_CD ,  
COMMCODE_PKG.GET_COMDTL_NAME_FNC('CD00744', A.TRSP_COST_DTL_MOD_CD) AS TRSP_COST_DTL_MOD_NM ,  
A.TRSP_SO_CMB_SEQ ,  
A.TRSP_CRR_MOD_CD ,  
COMMCODE_PKG.GET_COMDTL_NAME_FNC('CD00283', A.TRSP_CRR_MOD_CD) AS TRSP_CRR_MOD_NM ,  
SUBSTR(A.FM_NOD_CD, 1, 5) FM_LOC_VALUE ,  
SUBSTR(A.FM_NOD_CD, 6, 2) FM_YARD_VALUE ,  
SUBSTR(A.VIA_NOD_CD, 1, 5) VIA_LOC_VALUE ,  
SUBSTR(A.VIA_NOD_CD, 6, 2) VIA_YARD_VALUE ,  
SUBSTR(A.TO_NOD_CD, 1, 5) TO_LOC_VALUE ,  
SUBSTR(A.TO_NOD_CD, 6, 2) TO_YARD_VALUE ,  
SUBSTR(A.DOR_NOD_CD, 1, 5) DOR_LOC_VALUE ,  
SUBSTR(A.DOR_NOD_CD, 6, 2) DOR_YARD_VALUE ,  
A.CUST_CNT_CD||A.CUST_SEQ CUST_CNT_CD_SEQ ,  
DECODE(@[SP_TP_CD], 'CNT', 'Y', 'N') AS CUST_NOMI_TRKR_FLG ,  
A.CUST_CNT_CD ,  
A.CUST_SEQ ,  
A.DOR_DE_ADDR ,  
A.MLT_STOP_DE_FLG ,  
A.CNTR_WGT ,
A.WGT_MEAS_UT_CD WGT_UT_CD,
A.SPCL_CGO_CNTR_TP_CD,  -- 추가 
CASE WHEN D.DCGO_FLG ='Y' THEN 'DG' WHEN D.BB_CGO_FLG ='Y' THEN 'BB' WHEN D.AWK_CGO_FLG='Y' THEN 'AK' WHEN D.RC_FLG ='Y' THEN 'RF' WHEN D.RD_CGO_FLG ='Y' THEN 'RD' ELSE '' END BKGSPE ,  
TRS_AGMT_RATE_CC_PKG.GET_CAL_DIST_BTWN_NOD_FNC( 'KM' , 'D' , A.TRSP_COST_DTL_MOD_CD , A.TRSP_BND_CD , A.FM_NOD_CD , A.VIA_NOD_CD , A.DOR_NOD_CD , A.TO_NOD_CD ) AS DISTANCE ,  
TRS_AGMT_RATE_CC_PKG.GET_CAL_DIST_BTWN_NOD_FNC( 'ML' , 'D' , A.TRSP_COST_DTL_MOD_CD , A.TRSP_BND_CD , A.FM_NOD_CD , A.VIA_NOD_CD , A.DOR_NOD_CD , A.TO_NOD_CD ) AS DISTANCE_UOM ,  
' ' MORE_CANDIDATES ,  
A.TRSP_RQST_ORD_REV_AMT REVENUE ,  
A.REV_CURR_CD ,  
A.N3PTY_BIL_FLG ,  
A.BKG_NO BKG_NO ,  
A.BL_NO BL_NO ,  
A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD T_VVD ,  
A.SLAN_CD LANE ,  
FDR_VSL_CD||FDR_SKD_VOY_NO||FDR_SKD_DIR_CD FDR_VVD ,  
NVL(A.DTN_USE_FLG, 'N') DTN_USE_FLG ,  
NVL(A.WO_BL_NO_ISS_FLG, 'N') WO_BL_NO_ISS_FLG ,  
TO_CHAR(A.LOCL_CRE_DT, 'YYYYMMDD') SO_CRE_DT ,  
TO_CHAR(WRK.LOCL_CRE_DT, 'YYYYMMDD') WO_ISSUE_DT ,  
'' WO_RJCT_DT ,  
A.INTER_RMK ,  
A.SPCL_INSTR_RMK ,  
WRK.WO_RMK ,  
A.TRSP_SO_OFC_CTY_CD||A.TRSP_SO_SEQ AS TRSP_SO_OFC_CTY_CD_SEQ ,  
A.TRSP_SO_OFC_CTY_CD ,  
A.TRSP_SO_SEQ ,  
A.TRSP_SO_SEQ AS surcharge_key,
A.TRSP_SO_TP_CD ,  
A.TRSP_WO_OFC_CTY_CD||A.TRSP_WO_SEQ AS TRSP_WO_OFC_CTY_CD_SEQ ,  
A.TRSP_WO_OFC_CTY_CD ,  
A.TRSP_WO_SEQ ,  
A.CRE_OFC_CD ,  
TO_CHAR(A.LOCL_CRE_DT, 'YYYYMMDD') CRE_DT ,  
DECODE(VNDR.DELT_FLG, 'Y', '', @[VNDR_CD]) AS VNDR_SEQ ,  
DECODE(VNDR.DELT_FLG, 'Y', '', A.VNDR_SEQ) AS PRESET_VNDR_SEQ ,  
DECODE(VNDR.DELT_FLG, 'Y', '', VNDR.VNDR_LGL_ENG_NM) AS VNDR_NM ,  
NVL(VNDR.WO_EDI_USE_FLG, 'N') WO_EDI_USE_FLG ,  
A.TRSP_DFLT_VNDR_FLG AS DEFAULT_SP_FLG ,  
NVL(A.TRSP_FRST_FLG , 'N') TRSP_FRST_FLG ,  
A.TRSP_RJCT_RSN_CD ,  
A.TRSP_RQST_BKG_FLG ,  
A.TRSP_SO_CMB_TP_CD ,  
A.TRSP_BND_CD ,  
A.CMDT_CD ,  
A.FM_NOD_CD ,  
A.VIA_NOD_CD ,  
A.DOR_NOD_CD ,  
A.TO_NOD_CD ,  
CASE WHEN MCNTR_BDL_GRP_SEQ IS NOT NULL THEN MTY_BDL_CNTR_QTY ELSE 1 END BUNDLING_NO ,
A.CURR_CD ,  
A.WGT_MEAS_UT_CD ,  
A.ETC_ADD_AMT ,  
A.BZC_AMT ,  
A.FUEL_SCG_AMT ,
A.SCG_VAT_AMT ,   
A.NEGO_AMT ,  
( NVL(A.BZC_AMT, 0) + NVL(A.NEGO_AMT, 0) + NVL(A.FUEL_SCG_AMT, 0) + NVL(A.SCG_VAT_AMT, 0) + NVL(A.ETC_ADD_AMT, 0) ) AS WO_TOT_AMT ,  
(  
SELECT ROUND((TO_NUMBER( NVL(A.BZC_AMT, 0) + NVL(A.NEGO_AMT, 0) + NVL(A.FUEL_SCG_AMT, 0) + NVL(A.SCG_VAT_AMT, 0) + NVL(A.ETC_ADD_AMT, 0) ) / RAT.USD_LOCL_XCH_RT), 2) WO_TOT_AMT_USD  
FROM GL_MON_XCH_RT RAT  
WHERE RAT.CURR_CD = A.CURR_CD  
AND RAT.ACCT_XCH_RT_LVL = '1'  
AND RAT.ACCT_XCH_RT_YRMON = TO_CHAR(SYSDATE, 'YYYYMM') ) AS WO_TOT_AMT_USD ,  
TRS_COMMON_PKG.GET_VNDR_WO_RJCT_HIS_FNC(A.TRSP_SO_OFC_CTY_CD,A.TRSP_SO_SEQ,A.VNDR_SEQ)	 AS WO_RJCT_INDCT ,
@[SP_TP_CD] SP_TYPE ,  
A.TRSP_AGMT_RT_TP_CD ,  
'' AS TRSP_AGMT_RT_TP_NM ,  
A.TRO_SEQ ,  
TRSP_AGMT_WY_TP_CD  
FROM TRS_TRSP_SVC_ORD A ,  
BKG_BOOKING B ,  
BKG_CONTAINER D ,  
TRS_AGMT_DIST DIST ,  
MDM_VENDOR VNDR ,  
TRS_TRSP_WRK_ORD WRK
WHERE A.BKG_NO =B.BKG_NO(+)  
AND A.BKG_NO =D.BKG_NO(+)  
AND A.EQ_NO =D.CNTR_NO(+)  
AND A.FM_NOD_CD =DIST.FM_NOD_CD(+)  
AND A.TO_NOD_CD =DIST.TO_NOD_CD(+)  
AND ${VNDR_CD} =VNDR.VNDR_SEQ (+)  
AND A.TRSP_WO_OFC_CTY_CD =WRK.TRSP_WO_OFC_CTY_CD (+)  
AND A.TRSP_WO_SEQ =WRK.TRSP_WO_SEQ (+) 
AND NVL(A.DELT_FLG, 'N') = 'N'  
-- AND NVL(VNDR.DELT_FLG, 'N') = 'N'  

#if($SO_NO.size() > 0)
#foreach($code IN ${SO_NO})  
#if($velocityCount == 1)  
AND ((A.TRSP_SO_OFC_CTY_CD = SUBSTR('$code', 1, 3)  
AND A.TRSP_SO_SEQ = SUBSTR('$code', 4, 8))  
#else  
OR (A.TRSP_SO_OFC_CTY_CD = SUBSTR('$code', 1, 3)  
AND A.TRSP_SO_SEQ = SUBSTR('$code', 4, 8))  
#end  
#end  
)  
#end  
AND A.HJL_NO IS NULL  
AND DIST.HJL_NO IS NULL			]]></sql>
			<params>
				<param name="SP_TP_CD" type="12" value="" out="N"/>
				<param name="VNDR_CD" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
