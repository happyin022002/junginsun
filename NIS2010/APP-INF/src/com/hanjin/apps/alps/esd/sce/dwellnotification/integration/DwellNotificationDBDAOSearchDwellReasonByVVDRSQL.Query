<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DwellNotificationDBDAOSearchDwellReasonByVVDRSQL">
			<desc><![CDATA[Dwell Reason 입력 내역을 조회한다.]]></desc>
			<sql><![CDATA[
SELECT
  R.DWLL_RSN_SEQ
, V.SLAN_CD
, V.VSL_CD||V.SKD_VOY_NO||V.SKD_DIR_CD VVD
, TO_CHAR(V.VPS_ETA_DT,'YYYY-MM-DD HH24:MI:SS') ETA_DT
, TO_CHAR(V.INIT_ETD_DT,'YYYY-MM-DD HH24:MI:SS') ETD_DT
, R.DWLL_RSN
, TO_CHAR(GLOBALDATE_PKG.TIME_CONV_FNC('KRPUS', R.UPD_DT, 'USNYC'), 'YYYY-MM-DD HH24:MI:SS') UPD_DT
, R.UPD_USR_ID
, (SELECT USR_NM FROM COM_USER U WHERE U.USR_ID = R.UPD_USR_ID) UPD_USR_NM
, R.UPD_OFC_CD
, V.VPS_PORT_CD
, '' UPD_USR_ID1
, '' UPD_OFC_CD1
, '' UPD_USR_NM1
FROM
  VSK_VSL_PORT_SKD V
, SCE_DWLL_RSN R
WHERE 1=1
 #if (${vvd_cd} != '')
AND (V.VSL_CD,V.SKD_VOY_NO,V.SKD_DIR_CD) = ((SUBSTR(@[vvd_cd], 1,4), SUBSTR(@[vvd_cd], 5,4), SUBSTR(@[vvd_cd], 9)))
 #end
 #if (${port_cd} != '')
AND V.VPS_PORT_CD = @[port_cd]
 #end
 #if (${fr_eta_dt} != '' && ${to_eta_dt} != '' )
AND V.VPS_ETA_DT BETWEEN TO_DATE(@[fr_eta_dt] , 'YYYYMMDD') AND TO_DATE(@[to_eta_dt] , 'YYYYMMDD')+0.9999999999
 #end
AND EXISTS (
            SELECT 'X' FROM SCE_COP_DTL D WHERE 1=1
               AND (V.VSL_CD,V.SKD_VOY_NO,V.SKD_DIR_CD) = ((D.VSL_CD,D.SKD_VOY_NO,D.SKD_DIR_CD))
               AND V.VPS_PORT_CD = D.VPS_PORT_CD
               AND V.CLPT_IND_SEQ = D.CLPT_IND_SEQ
               AND D.ACT_CD LIKE ('FU_MAD')
            )
AND (V.VSL_CD,V.SKD_VOY_NO,V.SKD_DIR_CD) = ((R.VSL_CD(+),R.SKD_VOY_NO(+),R.SKD_DIR_CD(+)))
ORDER BY V.VPS_ETA_DT			]]></sql>
			<params>
				<param name="vvd_cd" type="12" value="" out="N"/>
				<param name="port_cd" type="12" value="" out="N"/>
				<param name="fr_eta_dt" type="12" value="" out="N"/>
				<param name="to_eta_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
