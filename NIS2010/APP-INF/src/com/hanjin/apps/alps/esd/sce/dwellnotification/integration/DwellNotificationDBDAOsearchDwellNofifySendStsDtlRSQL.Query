<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DwellNotificationDBDAOsearchDwellNofifySendStsDtlRSQL">
			<desc><![CDATA[Dwell/Delay Notification Sending Status]]></desc>
			<sql><![CDATA[
SELECT 
TO_CHAR(GLOBALDATE_PKG.TIME_CONV_FNC('KRPUS', TO_DATE(EML_SND_DT ||'0300', 'YYYYMMDDHH24MI'), 'USNYC'), 'YYYY.MM.DD') EML_SND_DT_DESC
, ''||NVL(SUM(DECODE(DWLL_TM_TP_CD, 'T96', 1)),0) T96_CNT
, ''||NVL(SUM(DECODE(DWLL_TM_TP_CD, 'E48', 1)),0) E48_CNT
, ''||NVL(SUM(DECODE(DWLL_TM_TP_CD, 'D72', 1)),0) D72_CNT
, ''||NVL(SUM(DECODE(DWLL_TM_TP_CD, 'V24', 1)),0) V24_CNT
, EML_SND_DT
FROM (
SELECT EML_SND_DT, DWLL_TM_TP_CD, CNTR_NO, BKG_NO, DWLL_CUST_CNT_CD, DWLL_CUST_SEQ
FROM SCE_DWLL_NTFC_EML_SND_RSLT
WHERE 1=1
AND EML_SND_DT BETWEEN TO_CHAR(GLOBALDATE_PKG.TIME_CONV_FNC('USNYC', TO_DATE(@[start_dt] ||'0300', 'YYYYMMDDHH24MI'), 'KRPUS'), 'YYYYMMDD') 
						AND TO_CHAR(GLOBALDATE_PKG.TIME_CONV_FNC('USNYC', TO_DATE(@[end_dt]   ||'0300', 'YYYYMMDDHH24MI'), 'KRPUS'), 'YYYYMMDD')
AND DWLL_CUST_CNT_CD = SUBSTR(@[cust_cd],1,2)
AND DWLL_CUST_SEQ = TO_NUMBER(SUBSTR(@[cust_cd],3,6))
GROUP BY EML_SND_DT, DWLL_TM_TP_CD, CNTR_NO, BKG_NO, DWLL_CUST_CNT_CD, DWLL_CUST_SEQ)
GROUP BY EML_SND_DT
UNION ALL
SELECT
''
, 'Total : '||NVL(SUM(DECODE(DWLL_TM_TP_CD, 'T96', 1)),0) T96_CNT
, 'Total : '||NVL(SUM(DECODE(DWLL_TM_TP_CD, 'E48', 1)),0) E48_CNT
, 'Total : '||NVL(SUM(DECODE(DWLL_TM_TP_CD, 'D72', 1)),0) D72_CNT
, 'Total : '||NVL(SUM(DECODE(DWLL_TM_TP_CD, 'V24', 1)),0) V24_CNT
, ''
FROM (
SELECT EML_SND_DT, DWLL_TM_TP_CD, CNTR_NO, BKG_NO, DWLL_CUST_CNT_CD, DWLL_CUST_SEQ
FROM SCE_DWLL_NTFC_EML_SND_RSLT
WHERE 1=1
AND EML_SND_DT BETWEEN TO_CHAR(GLOBALDATE_PKG.TIME_CONV_FNC('USNYC', TO_DATE(@[start_dt] ||'0300', 'YYYYMMDDHH24MI'), 'KRPUS'), 'YYYYMMDD') 
						AND TO_CHAR(GLOBALDATE_PKG.TIME_CONV_FNC('USNYC', TO_DATE(@[end_dt]   ||'0300', 'YYYYMMDDHH24MI'), 'KRPUS'), 'YYYYMMDD')
AND DWLL_CUST_CNT_CD = SUBSTR(@[cust_cd],1,2)
AND DWLL_CUST_SEQ = TO_NUMBER(SUBSTR(@[cust_cd],3,6))
GROUP BY EML_SND_DT, DWLL_TM_TP_CD, CNTR_NO, BKG_NO, DWLL_CUST_CNT_CD, DWLL_CUST_SEQ)
ORDER BY 1			]]></sql>
			<params>
				<param name="start_dt" type="12" value="" out="N"/>
				<param name="end_dt" type="12" value="" out="N"/>
				<param name="cust_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
