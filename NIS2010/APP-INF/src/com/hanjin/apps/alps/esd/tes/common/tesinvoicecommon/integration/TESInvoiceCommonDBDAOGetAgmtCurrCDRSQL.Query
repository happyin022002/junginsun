<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TESInvoiceCommonDBDAOGetAgmtCurrCDRSQL">
			<desc><![CDATA[(calc 계산시) agreement의 currency code를 가져온다.]]></desc>
			<sql><![CDATA[
SELECT	D.CURR_CD										
FROM	TES_TML_AGMT_HDR H
		, TES_TML_AGMT_DTL D                                                
WHERE	H.YD_CD				= @[yd_cd]
AND		H.VNDR_SEQ			= @[vndr_seq]
AND		H.TML_AGMT_STS_CD	= 'C'                                                                     
AND		TO_CHAR(H.EFF_FM_DT,'YYYYMMDD') <= REPLACE(@[from_date],'-')                                            
AND		TO_CHAR(H.EFF_TO_DT,'YYYYMMDD') >= REPLACE(@[to_date],'-')                                            
AND		H.TML_AGMT_VER_NO = ( SELECT	MAX(M.TML_AGMT_VER_NO)                                         
                             FROM	TES_TML_AGMT_HDR M                                             
                             WHERE	M.YD_CD               = @[yd_cd]                                     
                             AND	M.VNDR_SEQ            = @[vndr_seq]                                     
                             AND	M.TML_AGMT_STS_CD     = 'C'                                    
                             AND	TO_CHAR(M.EFF_FM_DT,'YYYYMMDD') <= REPLACE(@[from_date],'-')               
                             AND	TO_CHAR(M.EFF_TO_DT,'YYYYMMDD') >= REPLACE(@[to_date],'-'))              
AND		H.TML_AGMT_OFC_CTY_CD = D.TML_AGMT_OFC_CTY_CD(+)
AND		H.TML_AGMT_SEQ        = D.TML_AGMT_SEQ(+)
AND		H.TML_AGMT_VER_NO     = D.TML_AGMT_VER_NO(+)
AND		ROWNUM	= 1			]]></sql>
			<params>
				<param name="yd_cd" type="12" value="" out="N"/>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="from_date" type="12" value="" out="N"/>
				<param name="to_date" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
