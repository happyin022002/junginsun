<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CommonPopUpManageDBDAOSearchVVDManageRSQL">
			<desc><![CDATA[SearchVVDManage]]></desc>
			<sql><![CDATA[
select sk.vsl_cd||sk.skd_voy_no||sk.skd_dir_cd vvd, sk.slan_cd slane, 	

/* condition - seletad */	
#if (${seletad} == 'ETD')
			vd.pol_cd port, to_char(sk.vps_etd_dt, 'yyyy-mm-dd hh24:mm:ss') etdate 
#elseif (${seletad} == 'ETA') 
			vd.pod_cd port, to_char(sk.vps_eta_dt, 'yyyy-mm-dd hh24:mm:ss') etdate           
#end                  
                                 
		 from vsk_vsl_port_skd sk, bkg_vvd vd                                                              
		 where                                                                                                 
		     sk.vsl_cd = vd.vsl_cd                                                                             
		 and sk.skd_voy_no = vd.skd_voy_no                                                                     
		 and sk.skd_dir_cd = vd.skd_dir_cd                                                                     
		 and sk.slan_cd = vd.slan_cd     

/* condition - seletad */	
#if (${seletad} == 'ETD')  
			and sk.vps_port_cd = vd.pol_cd 
#elseif (${seletad} == 'ETA')                                                               
			and sk.vps_port_cd = vd.pod_cd                                                             
#end 

/* condition - selpol */
#if (${seletad} == 'ETD' && ${selpol} != '')  		
			and vd.pol_cd = @[selpol]  
#elseif (${seletad} == 'ETA' && ${selpod} != '')                                                                            
			and vd.pod_cd = @[selpod]                                                                           
#end 

/* condition - sellane */
#if (${sellane} != '')  			               
			and vd.slan_cd = @[sellane]                                                                              
#end 

/* condition - selvvd */
#if (${selvvd} != '')  
			and vd.vsl_cd = @[selvslcd]                                                                                 
			 and vd.skd_voy_no = @[skdvoyno]                                                                             
			 and vd.skd_dir_cd = @[skddircd]
#end 

/* condition - selfdate */
#if (${seletad} == 'ETD' && ${sdate} != '')  	
			and sk.vps_etd_dt between to_date(@[sdate],'yyyymmdd') and to_date(@[edate],'yyyymmdd') + 0.99999
/* condition - seltdate */
#elseif (${seletad} == 'ETA' && ${edate} != '')  
			and sk.vps_eta_dt between to_date(@[sdate],'yyyymmdd') and to_date(@[edate],'yyyymmdd') + 0.99999
#end 

		group by sk.vsl_cd, sk.skd_voy_no, sk.skd_dir_cd, sk.slan_cd,

/* condition - seletad */
#if (${seletad} == 'ETD')
			vd.pol_cd, sk.vps_etd_dt
#elseif (${seletad} == 'ETA')
			vd.pod_cd, sk.vps_eta_dt
#end

#if (${seletad} == 'ETD')
			order by to_char(sk.vps_etd_dt, 'yyyy-mm-dd hh24:mm:ss')
#elseif (${seletad} == 'ETA') 
			order by to_char(sk.vps_eta_dt, 'yyyy-mm-dd hh24:mm:ss')
#end   
			]]></sql>
			<params>
				<param name="selpol" type="12" value="" out="N"/>
				<param name="selpod" type="12" value="" out="N"/>
				<param name="sellane" type="12" value="" out="N"/>
				<param name="selvslcd" type="12" value="" out="N"/>
				<param name="skdvoyno" type="12" value="" out="N"/>
				<param name="skddircd" type="12" value="" out="N"/>
				<param name="sdate" type="12" value="" out="N"/>
				<param name="edate" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
