<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CustomerNominatedTruckerRgstDAOSearchRepYdRSQL">
			<desc><![CDATA[SearchRepYd]]></desc>
			<sql><![CDATA[
#if (${mtyPkupRtnYdCd} != '')
SELECT X.YD_NM
  FROM MDM_YARD X
 WHERE YD_CD = @[mtyPkupRtnYdCd]
UNION
SELECT X.LSE_CO_YD_NM
  FROM MDM_LSE_CO_YD X
 WHERE LSE_CO_YD_CD = @[mtyPkupRtnYdCd]
#else
SELECT YD_CD  AS REP_YD_CD
     , YD_NM  AS REP_YD_NM
  FROM MDM_YARD
 WHERE YD_CD = (
 SELECT MAX(YD_CD)
   FROM (
    SELECT DECODE(@[p_bnd], 'I', MTY_PKUP_YD_CD, 'O', EQ_RTN_YD_CD)  AS YD_CD -- BOUND에 따라 Pickup 또는 Return Yard 조회
      FROM MDM_LOCATION A
     WHERE LOC_CD = CASE LENGTH( DECODE(@[p_bnd], 'I', @[p_dest], 'O', @[p_orgin]) ) WHEN 7 THEN SUBSTR( DECODE(@[p_bnd], 'I', @[p_dest], 'O', @[p_orgin]), 1,5)
                                                                               WHEN 5 THEN DECODE(@[p_bnd], 'I', @[p_dest], 'O', @[p_orgin])
                                                                               ELSE ''
                    END
    UNION 
    SELECT REP_YD_CD
      FROM MDM_ZONE
     WHERE ZN_CD = CASE LENGTH( DECODE(@[p_bnd], 'I', @[p_dest], 'O', @[p_orgin]) ) WHEN 7 THEN DECODE(@[p_bnd], 'I', @[p_dest], 'O', @[p_orgin])
                                       WHEN 5 THEN DECODE(@[p_bnd], 'I', @[p_dest], 'O', @[p_orgin])||'01'
                                       ELSE ''
                   END
  )
)
UNION
SELECT LSE_CO_YD_CD, LSE_CO_YD_NM
  FROM MDM_LSE_CO_YD
 WHERE LSE_CO_YD_CD = (
 SELECT MAX(YD_CD)
   FROM (
    SELECT DECODE(@[p_bnd], 'I', MTY_PKUP_YD_CD, 'O', EQ_RTN_YD_CD)  AS YD_CD -- BOUND에 따라 Pickup 또는 Return Yard 조회
      FROM MDM_LOCATION A
     WHERE LOC_CD = CASE LENGTH(DECODE(@[p_bnd], 'I', @[p_dest], 'O', @[p_orgin])) WHEN 7 THEN SUBSTR( DECODE(@[p_bnd], 'I', @[p_dest], 'O', @[p_orgin]), 1,5)
                                                                             WHEN 5 THEN DECODE(@[p_bnd], 'I', @[p_dest], 'O', @[p_orgin])
                                                                             ELSE ''
                    END
    UNION 
    SELECT REP_YD_CD
      FROM MDM_ZONE
     WHERE ZN_CD = CASE LENGTH( DECODE(@[p_bnd], 'I', @[p_dest], 'O', @[p_orgin]) ) WHEN 7 THEN DECODE(@[p_bnd], 'I', @[p_dest], 'O', @[p_orgin])
                                       WHEN 5 THEN DECODE(@[p_bnd], 'I', @[p_dest], 'O', @[p_orgin])||'01'
                                       ELSE ''
                   END
  )
)
#end
			]]></sql>
			<params>
				<param name="mtyPkupRtnYdCd" type="12" value="" out="N"/>
				<param name="p_bnd" type="12" value="" out="N"/>
				<param name="p_dest" type="12" value="" out="N"/>
				<param name="p_orgin" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
