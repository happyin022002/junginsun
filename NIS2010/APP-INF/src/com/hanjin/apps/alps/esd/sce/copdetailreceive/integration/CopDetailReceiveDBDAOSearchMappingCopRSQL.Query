<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CopDetailReceiveDBDAOSearchMappingCopRSQL">
			<desc><![CDATA[SearchMappingCop]]></desc>
			<sql><![CDATA[
SELECT /*+ INDEX_DESC(SCE_COP_HDR XAK3SCE_COP_HDR) */
       REFND.BKG_NO, REFND.COP_NO, REFND.MST_COP_NO 
SELECT CUR.MST_COP_NO, REFND.COP_NO
,DECODE(CUR.COP_STS_CD,'F','F','C','T','T','T') CUR_STS_CD         
,CUR.BKG_NO,CUR.CNTR_NO,REFND.CNTR_NO,REFND.BKG_NO
,CUR.POL_NOD_CD,CUR.POD_NOD_CD,CUR.TRNK_VSL_CD,CUR.TRNK_SKD_VOY_NO,CUR.TRNK_SKD_DIR_CD
,REFND.POL_NOD_CD,REFND.POD_NOD_CD,REFND.TRNK_VSL_CD,REFND.TRNK_SKD_VOY_NO,REFND.TRNK_SKD_DIR_CD
FROM   SCE_COP_HDR CUR, SCE_COP_HDR REFND
WHERE  CUR.BKG_NO                = @[inBkgNo] 
AND    CUR.CNTR_NO               = @[inCntrNo]
AND    REFND.CNTR_NO             = CUR.CNTR_NO
AND    (CASE WHEN CUR.COP_STS_CD IN ('C','T') AND REFND.COP_STS_CD IN ('C','T') THEN 'SUCC' 
             WHEN CUR.COP_STS_CD = 'F' AND REFND.COP_STS_CD = 'F' THEN 'SUCC' ELSE 'FAIL' END) = 'SUCC'
AND    NVL(REFND.POL_NOD_CD,'X') = NVL(CUR.POL_NOD_CD,'X')      
AND    NVL(REFND.POD_NOD_CD,'X') = NVL(CUR.POD_NOD_CD,'X')      
AND    REFND.TRNK_VSL_CD         = CUR.TRNK_VSL_CD
AND    REFND.TRNK_SKD_VOY_NO     = CUR.TRNK_SKD_VOY_NO
AND    REFND.TRNK_SKD_DIR_CD     = CUR.TRNK_SKD_DIR_CD			]]></sql>
			<params>
				<param name="inBkgNo" type="12" value="" out="N"/>
				<param name="inCntrNo" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
