<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RailTransitReportDBDAOSearchRTRListRSQL">
			<desc><![CDATA[select list not single_excel
2012.03.12 채창호 [CHM-201216647-01] Rail Transit Report 상에, Empty Cargo 조회 보완요청]]></desc>
			<sql><![CDATA[
SELECT t2.*
FROM (
	SELECT t1.*
		,COUNT(TRSP_SO_OFC_CTY_CD) OVER() CNT
		,CEIL(rownum/6000) page
	FROM (
		SELECT --COUNT(TRSP_SO_OFC_CTY_CD) OVER() CNT
		    TRSP_SO_OFC_CTY_CD
			,TRSP_SO_SEQ
			,TRSP_SO_OFC_CTY_CD||TRSP_SO_SEQ SO_NO
			,EQ_NO
			,EQ_TPSZ_CD
            ,RPT.COP_NO
			,CGO_TP_CD
           	,VVD_CD
			,RPT.BKG_NO
			,MST_BL_NO
			,RPT.SC_NO
			,TO_CHAR(so_cre_dt, 'yyyy-MM-dd') || TO_CHAR(so_cre_dt, ' hh24:mi') cre_date
			,TO_CHAR(wo_iss_dt, 'yyyy-MM-dd') || TO_CHAR(wo_iss_dt, ' hh24:mi') swo_iss_date
			,(select max(case when vt.SUB_RAIL_SEQ = '1' then mv.USA_EDI_CD end)||max(case when vt.SUB_RAIL_SEQ = '2' then '&'||mv.USA_EDI_CD end)||max(case when vt.SUB_RAIL_SEQ = '3' then '&'||mv.USA_EDI_CD end)
				from trs_trsp_rail_bil_vndr_set vt, mdm_vendor mv
				where vt.TRSP_SO_OFC_CTY_CD = RPT.TRSP_SO_OFC_CTY_CD
				and vt.TRSP_SO_SEQ          = RPT.TRSP_SO_SEQ
				and mv.VNDR_SEQ             = vt.VNDR_SEQ
				group by vt.TRSP_SO_OFC_CTY_CD, vt.TRSP_SO_SEQ) USA_EDI_CD
			,(SELECT MAX(W.WO_VNDR_SEQ)
				FROM TRS_TRSP_SVC_ORD T
			       ,TRS_TRSP_WRK_ORD W
			       ,SCE_PLN_SO_LIST S
				WHERE S.COP_NO           = RPT.COP_NO
			  AND S.COST_ACT_GRP_SEQ   BETWEEN DECODE(RPT.trsp_bnd_cd,'I',600,NVL(RPT.cost_act_grp_seq,0)) AND DECODE(RPT.trsp_bnd_cd,'I',NVL(RPT.cost_act_grp_seq,0),400)
			  AND S.TRSP_MOD_CD        = 'TD'
			  AND S.COST_ACT_GRP_CD    = DECODE(RPT.trsp_bnd_cd,'I','IYTD','OYTD')
			  AND T.COP_NO             = S.COP_NO
			  AND T.COST_ACT_GRP_SEQ   = S.COST_ACT_GRP_SEQ
			  AND T.DELT_FLG           = 'N'
			  AND T.TRSP_BND_CD        = RPT.trsp_bnd_cd
			  AND W.TRSP_WO_OFC_CTY_CD = T.TRSP_WO_OFC_CTY_CD
			  AND W.TRSP_WO_SEQ        = T.TRSP_WO_SEQ
			  /*AND W.WO_ISS_KNT         = T.WO_ISS_KNT*/
			) wo_vndr_seq
			,FM_NOD_CD
			,TO_NOD_CD
			,NVL(TRSP_BND_CD, 'ALL') TRSP_BND_CD
			,RPT.BKG_HOT_DE_FLG
			
			,CR.FRT_CLT_FLG
			,CR.OBL_RDEM_FLG
			,CR.CSTMS_CLR_CD
			,(SELECT TO_CHAR (DSPO_CRE_DT, 'yyyy-MM-dd hh24:mi') C_DATE
                         FROM BKG_CSTMS_ADV_RSLT
                        WHERE CNT_CD = 'US'
                          AND BL_NO = BKG.BL_NO
                          AND DSPO_CD = '1C'
                          AND CSTMS_SEQ = (SELECT MAX (CSTMS_SEQ)
                                             FROM BKG_CSTMS_ADV_RSLT
                                            WHERE CNT_CD = 'US'
                                              AND BL_NO = BKG.BL_NO
                                              AND DSPO_CD = '1C'
                                            GROUP BY CNT_CD, BL_NO, DSPO_CD)
             ) AS C_DATE
			,(	SELECT CSTMS_CLR_TP_CD
				FROM BKG_CSTMS_ADV_IBD
				WHERE (CNT_CD, BL_NO)
					= (
						SELECT SUBSTR(CSTMS_LOC_CD, 1, 2),  BL_NO
						FROM BKG_CGO_RLSE_HIS
						WHERE BL_NO = CR.BL_NO
						  AND HIS_SEQ=(
										SELECT MAX(HIS_SEQ)
										FROM BKG_CGO_RLSE_HIS
										WHERE BL_NO = CR.BL_NO
									   )
						) 
			) AS IB_IPI_LOCL_IND_CD
			,(	SELECT CSTMS_LOC_CD
				FROM BKG_CSTMS_ADV_BL
				WHERE (CNT_CD, BL_NO)
					= (
						SELECT SUBSTR(CSTMS_LOC_CD, 1, 2),  BL_NO
						FROM BKG_CGO_RLSE_HIS
						WHERE BL_NO = CR.BL_NO
						  AND HIS_SEQ=(
										SELECT MAX(HIS_SEQ)
										FROM BKG_CGO_RLSE_HIS
										WHERE BL_NO = CR.BL_NO
									   )
						) 
			) AS IBD_CSTMS_CLR_LOC_CD
			
			--,RPT.CGOR_FRT_PAY_IND_FLG
			--,RPT.CGOR_ORG_BL_RCVR_IND_FLG
			--,CSTMS_ACPT_FLG
			--,TO_CHAR(ams_upd_dt, 'yyyy-MM-dd') || TO_CHAR(ams_upd_dt, ' hh24:mi') c_date
			--,IB_IPI_LOCL_IND_CD
			--,IBD_CSTMS_CLR_LOC_CD
			,DECODE(TRSP_BND_CD,'O',POR_NOD_CD,'I',DEL_NOD_CD) AS NOD_CD1
			,NOD_CD
			,TO_CHAR(vd_dt, 'yyyy-MM-dd') || TO_CHAR(vd_dt, ' hh24:mi') vd_date
			,(CASE WHEN NOD_CD = 'USLGBPT' THEN
              								CASE WHEN RHS.CSTMS_HLD_STS_CD IS NULL AND  RHS.USDA_HLD_STS_CD IS NULL AND RHS.CSTMS_HLD_STS_CD IS NULL AND RHS.TML_HLD_STS_CD IS NULL THEN NULL
                   								 WHEN RHS.CSTMS_HLD_STS_CD = 'R' AND RHS.USDA_HLD_STS_CD = 'R' AND RHS.CRR_HLD_STS_CD = 'R' AND RHS.TML_HLD_STS_CD = 'R' THEN 'Released'
              								ELSE REPLACE ( 
                                						'Hold (' 
                                						||
                                					CASE WHEN RHS.CSTMS_HLD_STS_CD  = 'H'   THEN 'Customer,'    END ||
                                					CASE WHEN RHS.USDA_HLD_STS_CD   = 'H'   THEN 'USDA,'        END ||
                                					CASE WHEN RHS.CRR_HLD_STS_CD  = 'H'   THEN 'Carrier,'     END ||
                                					CASE WHEN RHS.TML_HLD_STS_CD    = 'H'   THEN 'Terminal'     END ||
                                					')', 
                                					',)',   ')'
                           								 )
             								END
              END
             ) HLD_FLG
			,(CASE WHEN NOD_CD = 'USLGBPT' THEN DECODE(RHS.LST_RLSE_DT, NULL, NULL, TO_CHAR(RHS.LST_RLSE_DT,'YYYY-MM-DD HH24:MI'))
               END) HLD_RMK
			,(CASE WHEN NOD_CD = 'USLGBPT' AND RHS.BKG_NO IS NOT NULL THEN
              CASE WHEN RHS.LST_RLSE_DT IS NULL THEN NULL
                   WHEN RPT.VD_DT IS NULL THEN NULL
                   WHEN RPT.VD_DT > RHS.LST_RLSE_DT THEN (ROUND(DECODE(vd_dt, NULL, 0,
                        DECODE(TRSP_BND_CD, 'I',
                        DECODE(org_gate_in_dt, NULL, (CASE
                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt >= ams_upd_dt THEN
                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt
                        WHEN ORG_DEP_FLG        = 'Y' THEN org_gate_out_dt
                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt
                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt
                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt
                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))
                        END  - vd_dt)*24
                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt < ams_upd_dt THEN
                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt
                        WHEN ORG_DEP_FLG        = 'Y' THEN org_gate_out_dt
                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt
                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt
                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt
                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))
                        END  - ams_upd_dt)*24
                        ELSE
                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt
                        WHEN ORG_DEP_FLG      = 'Y' THEN org_gate_out_dt
                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt
                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt
                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt
                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))
                        END  - vd_dt)*24
                        END) ,
                        (CASE WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt >= ams_upd_dt THEN
                        (org_gate_in_dt - vd_dt)*24
                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt < ams_upd_dt THEN
                        --Minh.pham Add Start
                        --TRUNC((org_gate_in_dt - ams_upd_dt)*24)
                        CASE WHEN (org_gate_in_dt - ams_upd_dt)<0 THEN
                        (org_gate_in_dt - vd_dt)*24
                        ELSE
                        (org_gate_in_dt - ams_upd_dt)*24
                        END
                        --Minh.pham Add End
                        ELSE
                        (org_gate_in_dt - vd_dt)*24 END)
                        )
                        ,'O', 0)),1))
                   WHEN RPT.VD_DT <= RHS.LST_RLSE_DT THEN (ROUND(DECODE(RHS.LST_RLSE_DT, NULL, 0,
                        DECODE(TRSP_BND_CD, 'I',
                        DECODE(org_gate_in_dt, NULL, (CASE
                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND RHS.LST_RLSE_DT >= ams_upd_dt THEN
                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt
                        WHEN ORG_DEP_FLG        = 'Y' THEN org_gate_out_dt
                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt
                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt
                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt
                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))
                        END  - RHS.LST_RLSE_DT)*24
                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND RHS.LST_RLSE_DT < ams_upd_dt THEN
                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt
                        WHEN ORG_DEP_FLG        = 'Y' THEN org_gate_out_dt
                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt
                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt
                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt
                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))
                        END  - ams_upd_dt)*24
                        ELSE
                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt
                        WHEN ORG_DEP_FLG      = 'Y' THEN org_gate_out_dt
                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt
                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt
                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt
                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))
                        END  - RHS.LST_RLSE_DT)*24
                        END) ,
                        (CASE WHEN IB_IPI_LOCL_IND_CD = 'L' AND RHS.LST_RLSE_DT >= ams_upd_dt THEN
                        (org_gate_in_dt - RHS.LST_RLSE_DT)*24
                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND RHS.LST_RLSE_DT < ams_upd_dt THEN
                        --Minh.pham Add Start
                        --TRUNC((org_gate_in_dt - ams_upd_dt)*24)
                        CASE WHEN (org_gate_in_dt - ams_upd_dt)<0 THEN
                        (org_gate_in_dt - RHS.LST_RLSE_DT)*24
                        ELSE
                        (org_gate_in_dt - ams_upd_dt)*24
                        END
                        --Minh.pham Add End
                        ELSE
                        (org_gate_in_dt - RHS.LST_RLSE_DT)*24 END)
                        )
                        ,'O', 0)),1))
                    END
              ELSE 
              	(ROUND(DECODE(vd_dt, NULL, 0,
                        DECODE(TRSP_BND_CD, 'I',
                        DECODE(org_gate_in_dt, NULL, (CASE
                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt >= ams_upd_dt THEN
                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt
                        WHEN ORG_DEP_FLG        = 'Y' THEN org_gate_out_dt
                        WHEN ITCHG_N1ST_DEP_FLG = 'Y'  THEN itchg_dt
                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt
                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt
                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))
                        END  - vd_dt)*24
                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt < ams_upd_dt THEN
                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt
                        WHEN ORG_DEP_FLG        = 'Y' THEN org_gate_out_dt
                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt
                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt
                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt
                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))
                        END  - ams_upd_dt)*24
                        ELSE
                        (CASE WHEN TML_DEP_FLG = 'Y' THEN org_gate_in_dt
                        WHEN ORG_DEP_FLG      = 'Y' THEN org_gate_out_dt
                        WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt
                        WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt
                        WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt
                        WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
                        ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))
                        END  - vd_dt)*24
                        END) ,
                        (CASE WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt >= ams_upd_dt THEN
                        (org_gate_in_dt - vd_dt)*24
                        WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt < ams_upd_dt THEN
                        --Minh.pham Add Start
                        --TRUNC((org_gate_in_dt - ams_upd_dt)*24)
                        CASE WHEN (org_gate_in_dt - ams_upd_dt)<0 THEN
                        (org_gate_in_dt - vd_dt)*24
                        ELSE
                        (org_gate_in_dt - ams_upd_dt)*24
                        END
                        --Minh.pham Add End
                        ELSE
                        (org_gate_in_dt - vd_dt)*24 END)
                        )
                        ,'O', 0)),1))
             END
             ) TML_DWLL_TM_HRS
			,TML_DEP_FLG
			,ORG_SPLC_LOC_NM
			,TO_CHAR(org_gate_in_dt, 'yyyy-MM-dd') || TO_CHAR(org_gate_in_dt, ' hh24:mi') org_gate_in_date
			,TO_CHAR(org_gate_in_dt, 'yyyy-MM-dd') || TO_CHAR(org_gate_in_dt, ' hh24:mi') org_gate_in_date_old
			,NVL(org_gate_in_upd_flg,'N') org_gate_in_upd_flg
			,NVL(ROUND(DECODE( org_gate_in_dt, NULL, 0,
    		DECODE(org_gate_out_dt, NULL,                                                                             
          (CASE WHEN ORG_DEP_FLG = 'Y' THEN org_gate_out_dt                                                                             
            WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt                                                                             
            WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt                                                                             
            WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt                                                                             
            WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
          ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))                                                                             
          END - org_gate_in_dt)*24, (org_gate_out_dt - org_gate_in_dt)*24)),1), 0) ORG_DWLL_TM_HRS    
			,ORG_DEP_FLG
			,TO_CHAR(org_gate_out_dt, 'yyyy-MM-dd') || TO_CHAR(org_gate_out_dt, ' hh24:mi') org_gate_out_date
			,ITCHG_ARR_SPLC_LOC_NM
			,TO_CHAR(itchg_gate_in_dt, 'yyyy-MM-dd') || TO_CHAR(itchg_gate_in_dt, ' hh24:mi') chg_arr_in_date
			,ROUND(DECODE(itchg_gate_in_dt, NULL, 0, 
    		DECODE(itchg_dt, NULL,                                                                             
          (CASE WHEN ITCHG_N1ST_DEP_FLG = 'Y' THEN itchg_dt                                                                             
            WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt                                                                             
            WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt                                                                             
            WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
          ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))                                                                             
          END - itchg_gate_in_dt)*24, (itchg_dt - itchg_gate_in_dt)*24)),1) ITCHG_N1ST_DWLL_TM_HRS
			,ITCHG_N1ST_DEP_FLG
			,ITCHG_SPLC_LOC_NM
			,TO_CHAR(itchg_dt, 'yyyy-MM-dd') || TO_CHAR(itchg_dt, ' hh24:mi') chg_date
			,ROUND(DECODE(itchg_dt, NULL, 0, 
    		DECODE(itchg_gate_out_dt, NULL,                                                                             
          (CASE WHEN ITCHG_N2ND_DEP_FLG = 'Y' THEN itchg_gate_out_dt                                                                             
            WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt                                                                             
            WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
          ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))                                                                             
          END - itchg_dt)*24, (itchg_gate_out_dt - itchg_dt)*24)),1) ITCHG_N2ND_DWLL_TM_HRS   
			,ITCHG_N2ND_DEP_FLG
			,TO_CHAR(itchg_gate_out_dt, 'yyyy-MM-dd') || TO_CHAR(itchg_gate_out_dt, ' hh24:mi') chg_out_date
			,DEST_LOC_NM
			,TO_CHAR(dest_gate_in_dt, 'yyyy-MM-dd') || TO_CHAR(dest_gate_in_dt, ' hh24:mi') dest_in_date
			,ROUND(DECODE(dest_gate_in_dt, NULL, 0, 
    		DECODE(dest_aval_dt, NULL,                                                                             
          (CASE WHEN DEST_N1ST_DEP_FLG  = 'Y' THEN dest_aval_dt                                                                             
                   WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)
          ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))                                                                             
          END - dest_gate_in_dt)*24, (dest_aval_dt - dest_gate_in_dt)*24)),1) DEST_N1ST_DWLL_TM_HRS 
			,DEST_N1ST_DEP_FLG
			,TO_CHAR(dest_aval_dt, 'yyyy-MM-dd') || TO_CHAR(dest_aval_dt, ' hh24:mi') dest_avail_date
			,ROUND(DECODE(dest_aval_dt, NULL, 0,
				DECODE(to_nod_cd, RAIL_NOD, '0',
					    DECODE(dest_gate_out_dt, NULL,
						  	(CASE WHEN DEST_N2ND_DEP_FLG  = 'Y' THEN dest_gate_out_dt
			          				ELSE (GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC'))
			                  END - dest_aval_dt)*24,
						   	(dest_gate_out_dt - dest_aval_dt)*24))),1) DEST_N2ND_DWLL_TM_HRS
			,DEST_N2ND_DEP_FLG
			,TO_CHAR(dest_gate_out_dt, 'yyyy-MM-dd') || TO_CHAR(dest_gate_out_dt, ' hh24:mi') dest_out_date
			,DECODE(ROUND(((dest_gate_in_dt - org_gate_out_dt)*24),1), NULL, '', 0, '',
				     		ROUND(((dest_gate_in_dt - org_gate_out_dt)*24),1)) RAIL_RUN_TM_HRS
			,DECODE(trsp_bnd_cd, 'O',
				DECODE(ROUND(((dest_gate_out_dt - org_gate_in_dt )*24),1), NULL, '', 0, '',
			 					ROUND(((dest_gate_out_dt - org_gate_in_dt)*24),1)),
			 		    	DECODE(ROUND(((dest_aval_dt - vd_dt)*24),1), NULL, '', 0, '',
			 			   	(CASE WHEN IB_IPI_LOCL_IND_CD = 'L' AND vd_dt < ams_upd_dt THEN
			 			    			ROUND(((dest_aval_dt - ams_upd_dt)*24),1)
			 			   	WHEN IB_IPI_LOCL_IND_CD = 'L' OR IB_IPI_LOCL_IND_CD = 'I' THEN
			 			   		ROUND(((dest_aval_dt - vd_dt)*24),1)
                            ELSE ROUND(((DEST_AVAL_DT - VD_DT)*24),1)
			 			   	END )
			)) RAIL_TZTM_HRS
			,ARR_LOC_NM
			,ARR_STE_CD
			,TO_CHAR(RPT.ARR_DT, 'yyyy-MM-dd') || TO_CHAR(RPT.ARR_DT, ' hh24:mi') evnt_date
			,DECODE(RPT.AVAL_FLG,'Y',0,ROUND(DECODE(clm_sght_cd, 'W', 0,
				DECODE(NVL(DECODE(DECODE(trsp_bnd_cd, 'I', dest_aval_dt,
					DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)), NULL, RPT.ARR_DT),
			 			NULL),
			 		    NULL, 0,
			 		    ((GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR('KRPUS',1,5), SYSDATE, 'USNYC')) - NVL(DECODE(trsp_bnd_cd,
			 						   'I', dest_aval_dt,
			 						   DECODE(to_nod_cd, RAIL_NOD, dest_aval_dt, dest_gate_out_dt)),
			 					    RPT.ARR_DT))*24)),1)) CRNT_DWLL_TM_HRS
			,(SELECT C.CLM_SGHT_ABBR_NM
              FROM TRS_TRSP_RAIL_BIL_ORD R, SCE_CLM_SGHT C
              WHERE RPT.TRSP_SO_OFC_CTY_CD = R.TRSP_SO_OFC_CTY_CD AND RPT.TRSP_SO_SEQ = R.TRSP_SO_SEQ AND R.CLM_SGHT_CD=C.CLM_SGHT_CD AND ROWNUM=1) CLM_CRNT_STS
            ,(SELECT R.ARR_STE_CD
              FROM TRS_TRSP_RAIL_BIL_ORD R WHERE RPT.TRSP_SO_OFC_CTY_CD = R.TRSP_SO_OFC_CTY_CD AND RPT.TRSP_SO_SEQ = R.TRSP_SO_SEQ AND ROWNUM=1) CLM_LOC
            ,(SELECT R.ARR_STE_CD
              FROM TRS_TRSP_RAIL_BIL_ORD R WHERE RPT.TRSP_SO_OFC_CTY_CD = R.TRSP_SO_OFC_CTY_CD AND RPT.TRSP_SO_SEQ = R.TRSP_SO_SEQ AND ROWNUM=1) CLM_STATE
            ,(SELECT TO_CHAR(R.ARR_DT,'YYYY/MM/DD HH24:MI:SS')
              FROM TRS_TRSP_RAIL_BIL_ORD R WHERE RPT.TRSP_SO_OFC_CTY_CD = R.TRSP_SO_OFC_CTY_CD AND RPT.TRSP_SO_SEQ = R.TRSP_SO_SEQ AND ROWNUM=1) CLM_DT
            ,TRN_NO
			,FCAR_NO
			,CNTR_SEAL_NO
			,ITCHG_HRS
			,TO_CHAR(RAIL_CO_ITCHG_PNT_ETA_DT, 'yyyy-MM-dd hh24:mi') RAIL_CO_ITCHG_PNT_ETA_DT
			,TO_CHAR(to_date(trim(RAIL_ITCHG_N1ST_ETA_DT)), 'yyyy-MM-dd') || TO_CHAR(RAIL_ITCHG_N1ST_ETA_DT, ' hh24:mi') RAIL_ITCHG_N1ST_ETA_date
			,TO_CHAR(to_date(trim(RAIL_ITCHG_N2ND_ETA_DT)), 'yyyy-MM-dd') || TO_CHAR(RAIL_ITCHG_N2ND_ETA_DT, ' hh24:mi') RAIL_ITCHG_N2ND_ETA_date
			,DWLL_HRS
			,TO_CHAR(to_date(trim(RAIL_ITCHG_N1ST_ETD_DT)), 'yyyy-MM-dd') || TO_CHAR(RAIL_ITCHG_N1ST_ETD_DT, ' hh24:mi') RAIL_ITCHG_N1ST_ETD_date
			,TO_CHAR(to_date(trim(RAIL_ITCHG_N2ND_ETD_DT)), 'yyyy-MM-dd') || TO_CHAR(RAIL_ITCHG_N2ND_ETD_DT, ' hh24:mi') RAIL_ITCHG_N2ND_ETD_date
			,AVG_TZ_HRS
			,TO_CHAR(RAIL_CO_DEST_PNT_ETA_DT, 'yyyy-MM-dd hh24:mi') R_RAIL_CO_DEST_PNT_ETA_DT
			,TO_CHAR(to_date(trim(RAIL_DEST_N1ST_ETA_DT)), 'yyyy-MM-dd') || TO_CHAR(RAIL_DEST_N1ST_ETA_DT, ' hh24:mi') RAIL_DEST_N1ST_ETA_date												       
			,TO_CHAR(to_date(trim(RAIL_DEST_N2ND_ETA_DT)), 'yyyy-MM-dd') || TO_CHAR(RAIL_DEST_N2ND_ETA_DT, ' hh24:mi') RAIL_DEST_N2ND_ETA_date
			,TZTM_DIFF_HRS												
			,SHPR_NM												
			,CNEE_NM												
			,NTFY_NM
			,RPT.CRNT_DWLL_RMK
			,RPT.PRE_DWLL_RMK												
			FROM	SCE_RAIL_TZ_RPT		RPT
				,	BKG_BOOKING			BKG
				,	BKG_CGO_RLSE    	CR
                ,   SCE_RAIL_HLD_STS    RHS
				,       (
        SELECT 'CAVANM2' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'USLGBPT' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'USORFM2' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'USPDXM1' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'USSAVM1' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'USTIWM1' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'USLGBM5' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'USLGBM6' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'USLAXYM' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'USLAXM2' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'USORFM5' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'USTIWYM' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'CAPRRM1' RAIL_NOD FROM DUAL UNION ALL
        SELECT 'CAMTRC2' RAIL_NOD FROM DUAL
        ) MR_TML
		 	WHERE	RPT.BKG_NO		= BKG.BKG_NO (+)
		 	AND 	NVL(RPT.DELT_FLG, 'N') = 'N'
			AND		CR.BL_NO (+)	= BKG.BL_NO
		    AND     RPT.TO_NOD_CD           = MR_TML.RAIL_NOD(+)
            AND     RPT.BKG_NO		= RHS.BKG_NO(+)
            AND     RPT.EQ_NO		= RHS.CNTR_NO(+)

#if(${parentScNo} != '')
    AND RPT.SC_NO = @[parentScNo]
#end 

#if(${summary} == 'Y')
    #if(${rout_info} != '')
    AND (					
        #foreach( $info in ${rout_info}) 
            #if($velocityCount != 1) 
         OR
            #end 
	      ( 1=1
           #if($info.fmNodCd != '')
           AND FM_NOD_CD LIKE '$info.fmNodCd'||'%' 
           #end
           #if($info.toNodCd != '')       
           AND TO_NOD_CD LIKE '$info.toNodCd'||'%'
           #end
                #if($info.cgoTpCd != '' && $info.cgoTpCd != 'ALL')
           AND CGO_TP_CD = '$info.cgoTpCd' #end
                #if($info.trspBndCd != '' && $info.trspBndCd != 'ALL')
           AND TRSP_BND_CD = '$info.trspBndCd' #end
                #if(${date_kind} == 'S')
                    #if($info.slsFmDt != '' && $info.slsToDt != '')
            AND RPT.SO_CRE_DT BETWEEN TO_DATE('$info.slsFmDt'||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE('$info.slsToDt'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS') #end	
                #elseif(${date_kind} == 'A')
                    #if($info.slsFmDt != '' && $info.slsToDt != '')
            AND RPT.DEST_AVAL_DT BETWEEN  TO_DATE('$info.slsFmDt'||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE('$info.slsToDt'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS') #end
                #elseif(${date_kind} == 'O')
                    #if($info.slsFmDt != '' && $info.slsToDt != '')
            AND (CASE WHEN(SELECT MAX(CASE WHEN (T.TRSP_BND_CD = 'O' AND T.POR_CD = T.POL_CD) OR (T.TRSP_BND_CD = 'I' AND T.POD_CD = T.DEL_CD)
                                           THEN 'ON' ELSE 'OFF' END) CHKDOCK
                             FROM TRS_TRSP_RAIL_BIL_ORD T
                            WHERE T.TRSP_SO_OFC_CTY_CD = RPT.TRSP_SO_OFC_CTY_CD
                              AND T.TRSP_SO_SEQ = RPT.TRSP_SO_SEQ) = 'ON' THEN RPT.DEST_AVAL_DT
                      ELSE RPT.DEST_GATE_OUT_DT
                  END) BETWEEN  TO_DATE('$info.slsFmDt'||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE('$info.slsToDt'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS') #end
                #elseif(${date_kind} == 'I')
                    #if($info.slsFmDt != '' && $info.slsToDt != '')
            AND RPT.ORG_GATE_IN_DT BETWEEN  TO_DATE('$info.slsFmDt'||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE('$info.slsToDt'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS') #end
                #elseif(${date_kind} == 'D')
                    #if($info.slsFmDt != '' && $info.slsToDt != '')
            AND RPT.VD_DT BETWEEN  TO_DATE('$info.slsFmDt'||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE('$info.slsToDt'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS') #end
                #elseif(${date_kind} == 'P')
                    #if($info.slsFmDt != '' && $info.slsToDt != '')
            AND RPT.ORG_GATE_OUT_DT BETWEEN  TO_DATE('$info.slsFmDt'||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE('$info.slsToDt'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS') #end               
                #end
          )
        #end
        )
    #end


#else /* summary */
		#if(${date_kind} != '')
			#if(${date_kind} == 'S')
      			#if(${fm_dt} != '' && ${to_dt} != '')
        			AND RPT.SO_CRE_DT BETWEEN TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
        		#end	
      		#elseif(${date_kind} == 'A')
      			#if(${fm_dt} != '' && ${to_dt} != '')
					AND RPT.DEST_AVAL_DT BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
        		#end
      		#elseif(${date_kind} == 'O')
        		#if(${fm_dt} != '' && ${to_dt} != '')
        			AND (CASE WHEN(SELECT MAX(CASE WHEN (T.TRSP_BND_CD = 'O' AND T.POR_CD = T.POL_CD) OR (T.TRSP_BND_CD = 'I' AND T.POD_CD = T.DEL_CD)
        																THEN 'ON' ELSE 'OFF' END) CHKDOCK
        								FROM TRS_TRSP_RAIL_BIL_ORD T
        								WHERE T.TRSP_SO_OFC_CTY_CD = RPT.TRSP_SO_OFC_CTY_CD
        								AND T.TRSP_SO_SEQ = RPT.TRSP_SO_SEQ) = 'ON' THEN RPT.DEST_AVAL_DT
        						ELSE RPT.DEST_GATE_OUT_DT
        			END) BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
        		#end
      		#elseif(${date_kind} == 'I')
      			#if(${fm_dt} != '' && ${to_dt} != '')
						  AND RPT.ORG_GATE_IN_DT BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
        		#end
      		#elseif(${date_kind} == 'D')
      			#if(${fm_dt} != '' && ${to_dt} != '')
						  AND RPT.VD_DT BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
        		#end
      		#elseif(${date_kind} == 'P')
      			#if(${fm_dt} != '' && ${to_dt} != '')
						  AND RPT.ORG_GATE_OUT_DT BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
        		#end        		
			#end
		 #end	

	/* BKG No && BKG No Split */
	#if(${searchtype} == 'multi' && ${r_bkg_no} != '')
		AND ((RPT.BKG_NO) IN (
	   	#if(${searchtype} == 'multi')
	    	/* condition - r_bkg_no */
			#if (${r_bkg_no} != '') 
				#foreach($ele IN ${r_bkg_no})
					#if($velocityCount == 1 ) 
						'$ele'
					#else 
						,'$ele' 
					#end 
				#end
			#end
		#end

		))
    #else
		#if(${bkg_no} != '')
    		AND RPT.BKG_NO IN ( ${bkg_no} )
		#end
	#end
    
    #if(${so_no} != '')
    AND (RPT.TRSP_SO_OFC_CTY_CD = SUBSTR(@[so_no],1,3)
    AND  RPT.TRSP_SO_SEQ = SUBSTR(@[so_no],4))
    #end
    
    /* Container No */
    #if(${searchtype} == 'multi' && ${r_cntr_no} != '')
		AND RPT.EQ_NO IN (
		#if(${searchtype} == 'multi')
			#if(${r_cntr_no} != '')
    			#foreach($ele IN ${r_cntr_no})
					#if($velocityCount == 1 ) 
						'$ele'
					#else 
						,'$ele' 
					#end 
      			#end
      		#end
    	#end

    	)
    #else
		#if(${eq_no} != '')
    		AND RPT.EQ_NO IN ( ${eq_no} )
		#end
    #end

    /* Container TP/SZ */
	#if(${cntr_tpsz} != '')
    	AND RPT.EQ_TPSZ_CD IN ( ${cntr_tpsz} )
	#end
        
	/* B/L No */
	#if(${searchtype} == 'multi' && ${r_bl_no} != '')
    	AND ((MST_BL_NO) IN (
    	#if(${searchtype} == 'multi')
    		#if(${r_bl_no} != '')
    		    #foreach($ele IN ${r_bl_no})
					#if($velocityCount == 1 ) 
						'$ele'
					#else 
						,'$ele' 
					#end 
      			#end   	
	    	#end
	    #end	

    	))
    #else
		#if(${bl_no} != '')
    		AND MST_BL_NO IN ( ${bl_no} )
		#end
	#end
        
	/* VVD */
    #if(${vvd} != '' || (${searchtype} == 'multi' && ${r_vvd} != ''))
    	AND ( RPT.VVD_CD IN ( 
    	#if(${searchtype} == 'multi')
    		#if(${r_vvd} != '')
    			#foreach($ele IN ${r_vvd})
					#if($velocityCount == 1 ) 
						'$ele'
					#else 
						,'$ele' 
					#end 
      			#end
      		#end
      	#end
    	#if(${vvd} != '')
    		#if($r_vvd.size() > 0 && ${searchtype} == 'multi')
    			,
    		#end
      		@[vvd]
      	#end
    	) )
	#end
        
	/* POL , POD (MULTI) */
    #if(${searchtype} == 'multi' && ${r_polpod} != '')
    	AND ( RPT.NOD_CD IN (
    	#if(${searchtype} == 'multi')
    		#if(${r_polpod} != '')
    			#foreach($ele IN ${r_polpod})
					#if($velocityCount == 1 ) 
						'$ele'
					#else 
						,'$ele' 
					#end 
      			#end
    		#end
      	#end
    	) )
    #end
        
	/* ORIGIN (MULTI) */
    #if(${searchtype} == 'multi' && ${r_origin} != '')
    	AND 
    	#if(${r_origin} != '')
	    	( RPT.FM_NOD_CD IN (
	    	#foreach($ele IN ${r_origin})
				#if($velocityCount == 1 ) 
					'$ele'
				#else 
					,'$ele' 
				#end 
      		#end
      	#end
      	) )
    #end        
        
	/* DEST (MULTI) */
    #if(${searchtype} == 'multi' && ${r_dest} != '')
    	AND 
    	#if(${r_dest} != '')
    		( RPT.TO_NOD_CD IN (
    		#foreach($ele IN ${r_dest})
				#if($velocityCount == 1 ) 
					'$ele'
				#else 
					,'$ele' 
				#end 
    	  	#end
		#end
    	) )
    #end    
        
	/* SC NO (MULTI) */
    #if(${searchtype} == 'multi' && ${r_scno} != '')
    	AND 
    	#if(${r_scno} != '')
    		( RPT.SC_NO IN (
    		#foreach($ele IN ${r_scno})
				#if($velocityCount == 1 ) 
					'$ele'
				#else 
					,'$ele' 
				#end 
    	  	#end
      	#end
    	) )
    #end
       
	/* CUST_CNT_CD, CUST_SEQ (CUSTOMER CODE : MULTI) */
    #if(${searchtype} == 'multi' && ${r_cust_cnt_cd} != '')
      	AND 
      	#if(${searchtype} == 'multi')
      		#if(${r_cust_cnt_cd} != '')
      			( EXISTS (SELECT '1' FROM BKG_CUSTOMER WHERE BKG_NO = BKG.BKG_NO AND (CUST_CNT_CD||CUST_SEQ) IN (
						#foreach($ele IN ${r_cust_cnt_cd})
							#if($velocityCount == 1 ) 
								'$ele'
							#else 
								,'$ele' 
							#end 
				        #end
       		#end
   			)
   		#end 
   		) )
	#elseif(${cust_cnt_seq} != '')
		AND ( EXISTS (SELECT '1' FROM BKG_CUSTOMER WHERE BKG_NO = BKG.BKG_NO AND (CUST_CNT_CD||CUST_SEQ) IN (
    		@[cust_cnt_seq]) ) )
    #end

	#if(${fm_nod_cd} != '')
	   	AND  RPT.fm_nod_cd LIKE @[fm_nod_cd]||'%'
    #end
      
    #if(${to_nod_cd} != '')
    	AND  RPT.to_nod_cd LIKE @[to_nod_cd]||'%'
    #end

    /* BKG_OFC_CD */
    #if(${bkg_ofc_cd} != '')
      	AND BKG.BKG_OFC_CD IN (
			#foreach($ele IN ${bkg_ofc_cd})
				#if($velocityCount == 1 ) 
					'$ele'
				#else 
					,'$ele' 
				#end 
        	#end
		  	)
	#end
			
			
 	/* setConditionQuery(queryStr, dataSet, 'cgo_tp_cd', 'RPT', 'AND') */
 		#if(${cgo_tp_cd} != '')
    		AND RPT.cgo_tp_cd = @[cgo_tp_cd]
	    #end
	    
	/* setConditionQuery(queryStr, dataSet, 'trsp_bnd_cd', 'RPT', 'AND') */
	    #if(${trsp_bnd_cd} != '')
  			AND RPT.trsp_bnd_cd = @[trsp_bnd_cd]
	    #end
	    
	/* setConditionQuery(queryStr, dataSet, 'sc_no', 'RPT', 'AND') */
 		#if(${sc_no} != '')
  			AND RPT.sc_no = @[sc_no]
	    #end
 			
 	/* setConditionQuery(queryStr, dataSet, 'cstms_acpt_flg', 'RPT', 'AND') */
 		#if(${cstms_acpt_flg} != '')
			#if(${cstms_acpt_flg} == 'Y')
  				AND CR.CSTMS_CLR_CD <> 'N'
			#else
  				AND CR.CSTMS_CLR_CD = 'N'
			#end
	    #end
	    
	/* C/Loc */
 		#if(${customer_loc} != '')
    	  	AND  RPT.IB_IPI_LOCL_IND_CD = @[customer_loc]
    	#end
      
    /* POD/POL */
      	#if(${pod_pol} != '')
      		AND  RPT.NOD_CD LIKE @[pod_pol]||'%'
      	#end
      
      	-- 2017.06.09 comment out Start
      	/**
      	#if(${dwell_kind} != '' && ${dwell_time} != '')
      	#if(${dwell_kind} == 'T')
      		#if(${t_dep} != '')
        		#if(${t_dep} == 'Y')
        			AND RPT.TML_DEP_FLG = 'Y'
        		#elseif(${t_dep} == 'N')
        			AND RPT.TML_DEP_FLG = 'N'
        		#end
        	#end
      	#elseif(${dwell_kind} == 'O')
      		#if(${t_dep} != '')
        		#if(${t_dep} == 'Y')
        			AND RPT.ORG_DEP_FLG = 'Y'
        		#elseif(${t_dep} == 'N')
        			AND RPT.ORG_DEP_FLG = 'N'
        		#end
        	#end
      	#elseif(${dwell_kind} == 'I1')
      		#if(${t_dep} != '')
        		#if(${t_dep} == 'Y')
        			AND RPT.ITCHG_N1ST_DEP_FLG = 'Y'
        		#elseif(${t_dep} == 'N')
        			AND RPT.ITCHG_N1ST_DEP_FLG = 'N'
        		#end
        	#end
      	#elseif(${dwell_kind} == 'I2')
      		#if(${t_dep} != '')
        		#if(${t_dep} == 'Y')
        			AND RPT.ITCHG_N2ND_DEP_FLG = 'Y'
        		#elseif(${t_dep} == 'N')
        			AND RPT.ITCHG_N2ND_DEP_FLG = 'N'
        		#end
        	#end
      	#elseif(${dwell_kind} == 'D1')
      		#if(${t_dep} != '')
        		#if(${t_dep} == 'Y')
        			AND RPT.DEST_N1ST_DEP_FLG = 'Y'
        		#elseif(${t_dep} == 'N')
        			AND RPT.DEST_N1ST_DEP_FLG = 'N'
        		#end
        	#end
      	#elseif(${dwell_kind} == 'D2')
      		#if(${t_dep} != '')
        		#if(${t_dep} == 'Y')
        			AND RPT.DEST_N2ND_DEP_FLG = 'Y'
        		#elseif(${t_dep} == 'N')
        			AND RPT.DEST_N2ND_DEP_FLG = 'N'
        		#end
        	#end
      	#end
    #end  	
    */
    -- 2017.06.09 comment out End
    
    -- 2017.06.09 TMNL Departure Start
    #if(${dwell_kind} == '' && ${dwell_time} == '')
    	#if(${t_dep} == 'Y')
    		AND RPT.TML_DEP_FLG = 'Y'
    	#elseif(${t_dep} == 'N')
    		AND RPT.TML_DEP_FLG = 'N'
    	#end
    #end
    -- 2017.06.09 TMNL Departure End

    -- 2017.06.14 ORG Departure Start
    #if(${dwell_kind} == '' && ${dwell_time} == '')
        #if(${o_dep} == 'Y')
            AND RPT.ORG_DEP_FLG = 'Y'
        #elseif(${o_dep} == 'N')
            AND RPT.ORG_DEP_FLG = 'N'
        #end
    #end
    -- 2017.06.14 ORG Departure End
 				
 		AND RPT.RPT_UPD_STS_CD = 'N'
    	
    	/* RailCompany */
    	#if(${railcomp} != '')
    		--AND (RPT.TRSP_SO_OFC_CTY_CD, RPT.TRSP_SO_SEQ) IN ( 
              AND EXISTS (
    			select VND.TRSP_SO_OFC_CTY_CD, VND.TRSP_SO_SEQ
    			from  TRS_TRSP_RAIL_BIL_VNDR_SET VND
				where VND.VNDR_SEQ = @[railcomp]
    			AND   VND.SUB_RAIL_SEQ = '1'
                AND VND.TRSP_SO_OFC_CTY_CD=RPT.TRSP_SO_OFC_CTY_CD
                AND VND.TRSP_SO_SEQ=RPT.TRSP_SO_SEQ )
    			--GROUP BY VND.TRSP_SO_OFC_CTY_CD, VND.TRSP_SO_SEQ )
    	#end
#end /* summary */	
    	) t1
        #if(${dwell_kind} != '' && ${dwell_time} != '')
    			#if(${dwell_kind} == 'T')
		    		#if(${dwell_time} == '1')
				  		where t1.TML_DWLL_TM_HRS between 0 and 24
				  	#elseif(${dwell_time} == '2')
				  		where t1.TML_DWLL_TM_HRS between 25 and 48
				  	#elseif(${dwell_time} == '3')
				  		where t1.TML_DWLL_TM_HRS between 49 and 72
				  	#elseif(${dwell_time} == '4')
				  		where t1.TML_DWLL_TM_HRS between 73 and 96
				  	#elseif(${dwell_time} == '5')
				  		where t1.TML_DWLL_TM_HRS > 24
				  	#elseif(${dwell_time} == '6')
				  		where t1.TML_DWLL_TM_HRS > 48
				  	#elseif(${dwell_time} == '7')
				  		where t1.TML_DWLL_TM_HRS > 72
				  	#elseif(${dwell_time} == '8')
				  		where t1.TML_DWLL_TM_HRS > 96
				  	#elseif(${dwell_time} == '9')
				  		where t1.TML_DWLL_TM_HRS > 36
				  	#end    		                          
		    	#elseif(${dwell_kind} == 'O')
		    		#if(${dwell_time} == '1')
				  		where t1.ORG_DWLL_TM_HRS between 0 and 24
				  	#elseif(${dwell_time} == '2')
				  		where t1.ORG_DWLL_TM_HRS between 25 and 48
				  	#elseif(${dwell_time} == '3')
				  		where t1.ORG_DWLL_TM_HRS between 49 and 72
				  	#elseif(${dwell_time} == '4')
				  		where t1.ORG_DWLL_TM_HRS between 73 and 96
				  	#elseif(${dwell_time} == '5')
				  		where t1.ORG_DWLL_TM_HRS > 24
				  	#elseif(${dwell_time} == '6')
				  		where t1.ORG_DWLL_TM_HRS > 48
				  	#elseif(${dwell_time} == '7')
				  		where t1.ORG_DWLL_TM_HRS > 72
				  	#elseif(${dwell_time} == '8')
				  		where t1.ORG_DWLL_TM_HRS > 96
				  	#elseif(${dwell_time} == '9')
				  		where t1.ORG_DWLL_TM_HRS > 36
				  	#end 
		    	#elseif(${dwell_kind} == 'I1')         
		    		#if(${dwell_time} == '1')
				  		where t1.ITCHG_N1ST_DWLL_TM_HRS between 0 and 24
				  	#elseif(${dwell_time} == '2')
				  		where t1.ITCHG_N1ST_DWLL_TM_HRS between 25 and 48
				  	#elseif(${dwell_time} == '3')
				  		where t1.ITCHG_N1ST_DWLL_TM_HRS between 49 and 72
				  	#elseif(${dwell_time} == '4')
				  		where t1.ITCHG_N1ST_DWLL_TM_HRS between 73 and 96
				  	#elseif(${dwell_time} == '5')
				  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 24
				  	#elseif(${dwell_time} == '6')
				  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 48
				  	#elseif(${dwell_time} == '7')
				  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 72
				  	#elseif(${dwell_time} == '8')
				  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 96
				  	#elseif(${dwell_time} == '9')
				  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 36
				  	#end                   
		    	#elseif(${dwell_kind} == 'I2')          
		    		#if(${dwell_time} == '1')
				  		where t1.ITCHG_N2ND_DWLL_TM_HRS between 0 and 24
				  	#elseif(${dwell_time} == '2')
				  		where t1.ITCHG_N2ND_DWLL_TM_HRS between 25 and 48
				  	#elseif(${dwell_time} == '3')
				  		where t1.ITCHG_N2ND_DWLL_TM_HRS between 49 and 72
				  	#elseif(${dwell_time} == '4')
				  		where t1.ITCHG_N2ND_DWLL_TM_HRS between 73 and 96
				  	#elseif(${dwell_time} == '5')
				  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 24
				  	#elseif(${dwell_time} == '6')
				  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 48
				  	#elseif(${dwell_time} == '7')
				  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 72
				  	#elseif(${dwell_time} == '8')
				  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 96
				  	#elseif(${dwell_time} == '9')
				  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 36
				  	#end                    
		    	#elseif(${dwell_kind} == 'D1')          
		    		#if(${dwell_time} == '1')
				  		where t1.DEST_N1ST_DWLL_TM_HRS between 0 and 24
				  	#elseif(${dwell_time} == '2')
				  		where t1.DEST_N1ST_DWLL_TM_HRS between 25 and 48
				  	#elseif(${dwell_time} == '3')
				  		where t1.DEST_N1ST_DWLL_TM_HRS between 49 and 72
				  	#elseif(${dwell_time} == '4')
				  		where t1.DEST_N1ST_DWLL_TM_HRS between 73 and 96
				  	#elseif(${dwell_time} == '5')
				  		where t1.DEST_N1ST_DWLL_TM_HRS > 24
				  	#elseif(${dwell_time} == '6')
				  		where t1.DEST_N1ST_DWLL_TM_HRS > 48
				  	#elseif(${dwell_time} == '7')
				  		where t1.DEST_N1ST_DWLL_TM_HRS > 72
				  	#elseif(${dwell_time} == '8')
				  		where t1.DEST_N1ST_DWLL_TM_HRS > 96
				  	#elseif(${dwell_time} == '9')
				  		where t1.DEST_N1ST_DWLL_TM_HRS > 36
				  	#end                     
		    	#elseif(${dwell_kind} == 'D2')
		    		#if(${dwell_time} == '1')
				  		where t1.DEST_N2ND_DWLL_TM_HRS between 0 and 24
				  	#elseif(${dwell_time} == '2')
				  		where t1.DEST_N2ND_DWLL_TM_HRS between 25 and 48
				  	#elseif(${dwell_time} == '3')
				  		where t1.DEST_N2ND_DWLL_TM_HRS between 49 and 72
				  	#elseif(${dwell_time} == '4')
				  		where t1.DEST_N2ND_DWLL_TM_HRS between 73 and 96
				  	#elseif(${dwell_time} == '5')
				  		where t1.DEST_N2ND_DWLL_TM_HRS > 24
				  	#elseif(${dwell_time} == '6')
				  		where t1.DEST_N2ND_DWLL_TM_HRS > 48
				  	#elseif(${dwell_time} == '7')
				  		where t1.DEST_N2ND_DWLL_TM_HRS > 72
				  	#elseif(${dwell_time} == '8')
				  		where t1.DEST_N2ND_DWLL_TM_HRS > 96
				  	#elseif(${dwell_time} == '9')
				  		where t1.DEST_N2ND_DWLL_TM_HRS > 36
				  	#end                      
		    	#elseif(${dwell_kind} == 'C')
		    		#if(${dwell_time} == '1')
				  		where t1.CRNT_DWLL_TM_HRS between 0 and 24
				  	#elseif(${dwell_time} == '2')
				  		where t1.CRNT_DWLL_TM_HRS between 25 and 48
				  	#elseif(${dwell_time} == '3')
				  		where t1.CRNT_DWLL_TM_HRS between 49 and 72
				  	#elseif(${dwell_time} == '4')
				  		where t1.CRNT_DWLL_TM_HRS between 73 and 96
				  	#elseif(${dwell_time} == '5')
				  		where t1.CRNT_DWLL_TM_HRS > 24
				  	#elseif(${dwell_time} == '6')
				  		where t1.CRNT_DWLL_TM_HRS > 48
				  	#elseif(${dwell_time} == '7')
				  		where t1.CRNT_DWLL_TM_HRS > 72
				  	#elseif(${dwell_time} == '8')
				  		where t1.CRNT_DWLL_TM_HRS > 96
				  	#elseif(${dwell_time} == '9')
				  		where t1.CRNT_DWLL_TM_HRS > 36
				  	#end                             
		    	#end
		    #end	 
        
			) t2
			WHERE   page = @[cur_page]			]]></sql>
			<params>
				<param name="parentScNo" type="12" value="" out="N"/>
				<param name="fm_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
				<param name="so_no" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="cust_cnt_seq" type="12" value="" out="N"/>
				<param name="fm_nod_cd" type="12" value="" out="N"/>
				<param name="to_nod_cd" type="12" value="" out="N"/>
				<param name="cgo_tp_cd" type="12" value="" out="N"/>
				<param name="trsp_bnd_cd" type="12" value="" out="N"/>
				<param name="sc_no" type="12" value="" out="N"/>
				<param name="customer_loc" type="12" value="" out="N"/>
				<param name="pod_pol" type="12" value="" out="N"/>
				<param name="railcomp" type="12" value="" out="N"/>
				<param name="cur_page" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
