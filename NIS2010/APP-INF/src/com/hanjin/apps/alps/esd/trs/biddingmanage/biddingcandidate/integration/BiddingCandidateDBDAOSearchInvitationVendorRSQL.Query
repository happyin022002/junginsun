<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BiddingCandidateDBDAOSearchInvitationVendorRSQL">
			<desc><![CDATA[Spot Bid Invitation Vendor 조회]]></desc>
			<sql><![CDATA[
SELECT VNDR_SEQ, VNDR_LGL_ENG_NM, VNDR_EML, SP_PTAL_EXIST_FLG, RNK FROM (
SELECT A.VNDR_SEQ
      ,A.VNDR_LGL_ENG_NM
      ,REPLACE(B.VNDR_EML,',',';') VNDR_EML
      ,NVL((SELECT MAX(MAX(SP_EXIST_FLG) KEEP(DENSE_RANK LAST ORDER BY SP_USR_IF_SEQ)) FROM TRS_SVC_PROV_PTAL_USR_IF WHERE SP_VNDR_SEQ = A.VNDR_SEQ GROUP BY SP_USR_ID), 'N') AS SP_PTAL_EXIST_FLG 
      ,RANK() OVER(PARTITION BY A.VNDR_SEQ ORDER BY DECODE(B.CNTC_DIV_CD, 'EMAIL', 0, 1) ASC, B.UPD_DT DESC ) RNK
  FROM MDM_VENDOR A
      ,MDM_VNDR_CNTC_PNT B
 WHERE A.VNDR_SEQ = B.VNDR_SEQ
   AND A.DELT_FLG = 'N'
   AND B.PRMRY_CHK_FLG = 'Y'
--   AND B.CNTC_DIV_CD = 'EMAIL' 
--   AND B.VNDR_EML IS NOT NULL
   AND A.VNDR_SEQ = @[vndr_seq]
--   AND ROWNUM = 1
) WHERE 1=1 AND RNK = 1			]]></sql>
			<params>
				<param name="vndr_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
