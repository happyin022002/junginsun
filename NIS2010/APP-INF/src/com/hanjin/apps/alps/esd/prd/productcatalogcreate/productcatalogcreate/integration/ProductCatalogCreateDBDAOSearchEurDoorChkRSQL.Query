<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ProductCatalogCreateDBDAOSearchEurDoorChkRSQL">
			<desc><![CDATA[구주지역 door 예외처리 있는지 확인]]></desc>
			<sql><![CDATA[
SELECT 
MAX(CASE WHEN (SELECT CONTI_CD FROM MDM_LOCATION L WHERE L.LOC_CD = SUBSTR(B.POR_NOD_CD,1,5) AND NVL(L.DELT_FLG,'N')='N') ='E'
           AND (NVL((SELECT DOR_NOD_CD FROM TRS_TRSP_SVC_ORD 
                      WHERE COP_NO =H.COP_NO 
                        AND TRSP_BND_CD = 'O'
                        AND COST_ACT_GRP_CD LIKE 'OD%' 
                        AND TRSP_SO_TP_CD <> 'S'
                        AND NVL(RPLN_UMCH_FLG,'N') <> 'Y' -- 2010.04.09 추가 by j
                        AND NVL(TRSP_FRST_FLG,'N') <> 'Y'
                        AND NVL(DELT_FLG,'N') <> 'Y' ),B.POR_NOD_CD) <> B.POR_NOD_CD
                OR H.OB_TRO_FLG ='Y' AND H.POR_NOD_CD <> B.POR_NOD_CD )
      THEN 'Y'
         WHEN (SELECT CONTI_CD FROM MDM_LOCATION L WHERE L.LOC_CD = SUBSTR(B.DEL_NOD_CD,1,5) AND NVL(L.DELT_FLG,'N')='N') ='E'
           AND (NVL((SELECT DOR_NOD_CD FROM TRS_TRSP_SVC_ORD 
                     WHERE COP_NO =H.COP_NO 
                        AND TRSP_BND_CD = 'I'
                        AND COST_ACT_GRP_CD LIKE 'ID%' 
                       AND TRSP_SO_TP_CD <> 'S' 
                       AND NVL(RPLN_UMCH_FLG,'N') <> 'Y' -- 2010.04.09 추가 by j
                       AND NVL(TRSP_FRST_FLG,'N') <> 'Y'
                       AND NVL(DELT_FLG,'N') <> 'Y' ),B.DEL_NOD_CD) <> B.DEL_NOD_CD
                OR H.IB_TRO_FLG ='Y' AND H.DEL_NOD_CD <> B.DEL_NOD_CD )
      THEN 'Y'
      ELSE 'N'
    END)  EUR_DR_CHK
FROM BKG_BOOKING B,SCE_COP_HDR H
WHERE B.BKG_NO = @[bkg_no]
AND B.BKG_NO = H.BKG_NO
AND H.COP_STS_CD IN ('C','T','F')			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
