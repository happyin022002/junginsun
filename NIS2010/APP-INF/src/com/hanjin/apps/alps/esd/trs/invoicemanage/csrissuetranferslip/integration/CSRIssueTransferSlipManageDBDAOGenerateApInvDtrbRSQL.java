/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : CSRIssueTransferSlipManageDBDAOGenerateApInvDtrbRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.01.08
*@LastModifier : 
*@LastVersion : 1.0
* 2016.01.08 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esd.trs.invoicemanage.csrissuetranferslip.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class CSRIssueTransferSlipManageDBDAOGenerateApInvDtrbRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * CSR 생성내역을 조회
	  * </pre>
	  */
	public CSRIssueTransferSlipManageDBDAOGenerateApInvDtrbRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("INV_DT",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("CSR_NO",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("TRSP_INV_AUD_STS_CD",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("CNT_CD",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("COST_OFC_CD",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("AP_OFC_CD",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("CURR_CD",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("INV_TAX_CD",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("CRE_USR_ID",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("INV_VNDR_SEQ",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("INV_NO",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("LINE_NO",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esd.trs.invoicemanage.csrissuetranferslip.integration").append("\n"); 
		query.append("FileName : CSRIssueTransferSlipManageDBDAOGenerateApInvDtrbRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT		CSR_NO																										" ).append("\n"); 
		query.append("			,	ROWNUM			LINE_SEQ																					" ).append("\n"); 
		query.append("			,	LINE_NO																										" ).append("\n"); 
		query.append("			,	LINE_TP_LU_CD																								" ).append("\n"); 
		query.append("			,	CSR_AMT AS INV_AMT																										" ).append("\n"); 
		query.append("			,	INV_DESC																									" ).append("\n"); 
		query.append("			,	INV_TAX_CD																									" ).append("\n"); 
		query.append("			,	DTRB_COA_CO_CD																								" ).append("\n"); 
		query.append("			,	DTRB_COA_RGN_CD																								" ).append("\n"); 
		query.append("			,	DTRB_COA_CTR_CD																								" ).append("\n"); 
		query.append("			,	DTRB_COA_ACCT_CD																							" ).append("\n"); 
		query.append("			,	DTRB_COA_VVD_CD																								" ).append("\n"); 
		query.append("			,	DTRB_COA_INTER_CO_CD																						" ).append("\n"); 
		query.append("			,	DTRB_COA_FTU_N1ST_CD																						" ).append("\n"); 
		query.append("			,	DTRB_COA_FTU_N2ND_CD																						" ).append("\n"); 
		query.append("			,	ATTR_CATE_NM																								" ).append("\n"); 
		query.append("			,	ATTR_CTNT1																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT2																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT3																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT4																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT5																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT6																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT7																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT8																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT9																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT10																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT11																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT12																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT13																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT14																									" ).append("\n"); 
		query.append("			,	ATTR_CTNT15																									" ).append("\n"); 
		query.append("			,	CASE 	WHEN TRSP_SO_TP_CD = 'O' AND EQ_KND_CD = 'U' AND CGO_TP_CD = 'F' AND REF_BKG_NO IS NOT NULL " ).append("\n"); 
		query.append("						AND (SELECT B.BKG_STS_CD FROM BKG_BOOKING B WHERE B.BKG_NO = REF_BKG_NO) <> 'X' THEN REF_BKG_NO			" ).append("\n"); 
		query.append("						ELSE BKG_NO																							" ).append("\n"); 
		query.append("				END		BKG_NO																								" ).append("\n"); 
		query.append("			,	CNTR_TPSZ_CD																								" ).append("\n"); 
		query.append("			,	ACT_VVD_CD																									" ).append("\n"); 
		query.append("			,	PLN_SCTR_DIV_CD																								" ).append("\n"); 
		query.append("			,	SO_CRR_CD																									" ).append("\n"); 
		query.append("			,	YD_CD																										" ).append("\n"); 
		query.append("			,	FTU_USE_CTNT1																								" ).append("\n"); 
		query.append("			,	FTU_USE_CTNT2																								" ).append("\n"); 
		query.append("			,	FTU_USE_CTNT3																								" ).append("\n"); 
		query.append("			,	FTU_USE_CTNT4																								" ).append("\n"); 
		query.append("			,	FTU_USE_CNTR5																								" ).append("\n"); 
		query.append("			,	CRE_DT																										" ).append("\n"); 
		query.append("			,	CRE_USR_ID																									" ).append("\n"); 
		query.append("			,	EAI_EVNT_DT																									" ).append("\n"); 
		query.append("			,	TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("			,	TRSP_SO_OFC_CTY_CD AS SO_OFC_CTY_CD" ).append("\n"); 
		query.append("			,	TRSP_SO_SEQ AS SO_SEQ																									" ).append("\n"); 
		query.append("	FROM	(																												" ).append("\n"); 
		query.append("			SELECT		CSR_NO																								" ).append("\n"); 
		query.append("					,	LINE_SEQ																							" ).append("\n"); 
		query.append("					,	LINE_NO																								" ).append("\n"); 
		query.append("					,	LINE_TP_LU_CD																						" ).append("\n"); 
		query.append("					,	CSR_AMT																								" ).append("\n"); 
		query.append("					,	INV_DESC																							" ).append("\n"); 
		query.append("					,	INV_TAX_CD																							" ).append("\n"); 
		query.append("					,	DTRB_COA_CO_CD																						" ).append("\n"); 
		query.append("					,	DTRB_COA_RGN_CD																						" ).append("\n"); 
		query.append("					,	DTRB_COA_CTR_CD																						" ).append("\n"); 
		query.append("					,	DTRB_COA_ACCT_CD																					" ).append("\n"); 
		query.append("					,	DTRB_COA_VVD_CD																						" ).append("\n"); 
		query.append("					,	DTRB_COA_INTER_CO_CD																				" ).append("\n"); 
		query.append("					,	DTRB_COA_FTU_N1ST_CD																				" ).append("\n"); 
		query.append("					,	DTRB_COA_FTU_N2ND_CD																				" ).append("\n"); 
		query.append("					,	ATTR_CATE_NM																						" ).append("\n"); 
		query.append("					,	ATTR_CTNT1																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT2																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT3																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT4																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT5																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT6																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT7																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT8																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT9																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT10																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT11																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT12																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT13																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT14																							" ).append("\n"); 
		query.append("					,	ATTR_CTNT15																							" ).append("\n"); 
		query.append("					,	BKG_NO																								" ).append("\n"); 
		query.append("					,	CNTR_TPSZ_CD																						" ).append("\n"); 
		query.append("					,	ACT_VVD_CD																							" ).append("\n"); 
		query.append("					,	PLN_SCTR_DIV_CD																						" ).append("\n"); 
		query.append("					,	SO_CRR_CD																							" ).append("\n"); 
		query.append("					,	YD_CD																								" ).append("\n"); 
		query.append("					,	FTU_USE_CTNT1																						" ).append("\n"); 
		query.append("					,	FTU_USE_CTNT2																						" ).append("\n"); 
		query.append("					,	FTU_USE_CTNT3																						" ).append("\n"); 
		query.append("					,	FTU_USE_CTNT4																						" ).append("\n"); 
		query.append("					,	FTU_USE_CNTR5																						" ).append("\n"); 
		query.append("					,	CRE_DT																								" ).append("\n"); 
		query.append("					,	CRE_USR_ID																							" ).append("\n"); 
		query.append("					,	EAI_EVNT_DT        																					" ).append("\n"); 
		query.append("					,	TRSP_SO_TP_CD																					 	" ).append("\n"); 
		query.append("					,	TRSP_SO_OFC_CTY_CD																					" ).append("\n"); 
		query.append("					,	TRSP_SO_SEQ																							" ).append("\n"); 
		query.append("					,	REF_BKG_NO																							" ).append("\n"); 
		query.append("					,	CGO_TP_CD																							" ).append("\n"); 
		query.append("					,	EQ_KND_CD																							" ).append("\n"); 
		query.append("			FROM	(                                                                                                 		" ).append("\n"); 
		query.append("					SELECT		@[CSR_NO]	CSR_NO																					" ).append("\n"); 
		query.append("							,	'1'	LINE_SEQ													    " ).append("\n"); 
		query.append("							,	@[LINE_NO]      LINE_NO							                                " ).append("\n"); 
		query.append("							,	'ITEM'		LINE_TP_LU_CD													" ).append("\n"); 
		query.append("							,	SUM(CSR_AMT)        		CSR_AMT															" ).append("\n"); 
		query.append("							,	INV_DESC																					" ).append("\n"); 
		query.append("							,	INV_TAX_CD																					" ).append("\n"); 
		query.append("							,	DTRB_COA_CO_CD																				" ).append("\n"); 
		query.append("							,	DTRB_COA_RGN_CD																				" ).append("\n"); 
		query.append("							,	DTRB_COA_CTR_CD																				" ).append("\n"); 
		query.append("							,	DTRB_COA_ACCT_CD																			" ).append("\n"); 
		query.append("							,	DTRB_COA_VVD_CD		                                                                        " ).append("\n"); 
		query.append("							,	DTRB_COA_INTER_CO_CD																		" ).append("\n"); 
		query.append("							,	DTRB_COA_FTU_N1ST_CD																		" ).append("\n"); 
		query.append("							,	DTRB_COA_FTU_N2ND_CD																		" ).append("\n"); 
		query.append("							,	ATTR_CATE_NM																				" ).append("\n"); 
		query.append("							,	ATTR_CTNT1																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT2																			        " ).append("\n"); 
		query.append("							,	ATTR_CTNT3																			        " ).append("\n"); 
		query.append("							,	ATTR_CTNT4																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT5																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT6																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT7																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT8																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT9																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT10																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT11																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT12																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT13																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT14																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT15																					" ).append("\n"); 
		query.append("							,	BKG_NO																						" ).append("\n"); 
		query.append("							,	CNTR_TPSZ_CD																				" ).append("\n"); 
		query.append("							,	ACT_VVD_CD																					" ).append("\n"); 
		query.append("							,	PLN_SCTR_DIV_CD																				" ).append("\n"); 
		query.append("							,	SO_CRR_CD																					" ).append("\n"); 
		query.append("							,	YD_CD																						" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT1																				" ).append("\n"); 
		query.append("							,	TO_CHAR(COUNT(FTU_USE_CTNT2)) 	FTU_USE_CTNT2						                        " ).append("\n"); 
		query.append("							,	FTU_USE_CTNT3																				" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT4																				" ).append("\n"); 
		query.append("							,	FTU_USE_CNTR5																				" ).append("\n"); 
		query.append("							,	CRE_DT																						" ).append("\n"); 
		query.append("							,	CRE_USR_ID																					" ).append("\n"); 
		query.append("							,	EAI_EVNT_DT                                                                                 " ).append("\n"); 
		query.append("							,	TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("							,	TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("							,	TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("							,	REF_BKG_NO																							" ).append("\n"); 
		query.append("							,	CGO_TP_CD																							" ).append("\n"); 
		query.append("							,	EQ_KND_CD																							" ).append("\n"); 
		query.append("					FROM     	(                                                                                           " ).append("\n"); 
		query.append("					SELECT																									" ).append("\n"); 
		query.append("								CASE	WHEN @[CURR_CD] IN ('KRW','JPY','TWD') THEN																																			" ).append("\n"); 
		query.append("											CASE 	WHEN SVC_ORD.TRSP_INV_CALC_LGC_TP_CD = 'TM' THEN SUM( ROUND( ( (NVL(SVC_ORD.BZC_AMT,0) + NVL(SVC_ORD.NEGO_AMT,0) ) * NVL(SVC_ORD.INV_XCH_RT,1) ), 0) + NVL(SVC_ORD.CSR_BZC_CORR_AMT,0) ) 		" ).append("\n"); 
		query.append("													WHEN SVC_ORD.TRSP_INV_CALC_LGC_TP_CD = 'DV' THEN SUM( ROUND( ( (NVL(SVC_ORD.BZC_AMT,0) + NVL(SVC_ORD.NEGO_AMT,0) ) / NVL(SVC_ORD.INV_XCH_RT,1) ), 0) + NVL(SVC_ORD.CSR_BZC_CORR_AMT,0) ) 		" ).append("\n"); 
		query.append("													ELSE SUM( ROUND( (NVL(SVC_ORD.BZC_AMT,0) + NVL(SVC_ORD.NEGO_AMT,0) ), 0) + NVL(SVC_ORD.CSR_BZC_CORR_AMT,0) ) 																					" ).append("\n"); 
		query.append("											END																																									" ).append("\n"); 
		query.append("										ELSE																																									" ).append("\n"); 
		query.append("											CASE 	WHEN SVC_ORD.TRSP_INV_CALC_LGC_TP_CD = 'TM' THEN SUM( ROUND( ( (NVL(SVC_ORD.BZC_AMT,0) + NVL(SVC_ORD.NEGO_AMT,0) ) * NVL(SVC_ORD.INV_XCH_RT,1) ), 2) + NVL(SVC_ORD.CSR_BZC_CORR_AMT,0) )		" ).append("\n"); 
		query.append("													WHEN SVC_ORD.TRSP_INV_CALC_LGC_TP_CD = 'DV' THEN SUM( ROUND( ( (NVL(SVC_ORD.BZC_AMT,0) + NVL(SVC_ORD.NEGO_AMT,0) ) / NVL(SVC_ORD.INV_XCH_RT,1) ), 2) + NVL(SVC_ORD.CSR_BZC_CORR_AMT,0) )		" ).append("\n"); 
		query.append("													ELSE SUM( ROUND( (NVL(SVC_ORD.BZC_AMT,0) + NVL(SVC_ORD.NEGO_AMT,0) ), 2) + NVL(SVC_ORD.CSR_BZC_CORR_AMT,0) )																					" ).append("\n"); 
		query.append("											END																																									" ).append("\n"); 
		query.append("								END												CSR_AMT																																									" ).append("\n"); 
		query.append("							,	ACCT_NM.ACCT_ENG_NM								INV_DESC																								" ).append("\n"); 
		query.append("							,	@[INV_TAX_CD]									INV_TAX_CD																								" ).append("\n"); 
		query.append("							,	'01'											DTRB_COA_CO_CD																							" ).append("\n"); 
		query.append("							,	FINC_RGN_CD										DTRB_COA_RGN_CD																							" ).append("\n"); 
		query.append("							,	AP_CTR_CD										DTRB_COA_CTR_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.ACCT_CD									DTRB_COA_ACCT_CD																						" ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_VVD_CD								DTRB_COA_VVD_CD																							" ).append("\n"); 
		query.append("							,	NVL(SUBS_CO_CD,'00')    						DTRB_COA_INTER_CO_CD																					" ).append("\n"); 
		query.append("							,	'000000'                						DTRB_COA_FTU_N1ST_CD																					" ).append("\n"); 
		query.append("							,	'000000'                						DTRB_COA_FTU_N2ND_CD																					" ).append("\n"); 
		query.append("							,	SVC_ORD.ACCT_CD         						ATTR_CATE_NM																							" ).append("\n"); 
		query.append("							,	SVC_ORD.INV_NO          						ATTR_CTNT1																								" ).append("\n"); 
		query.append("							,	TO_CHAR(INV_WRK.INV_ISS_DT,'YYYYMMDD')      	ATTR_CTNT2																			" ).append("\n"); 
		query.append("							,	(	SELECT   A.LOC_CD																												" ).append("\n"); 
		query.append("									FROM     MDM_ORGANIZATION A																										" ).append("\n"); 
		query.append("									WHERE    SVC_ORD.CRE_OFC_CD	= A.OFC_CD																						" ).append("\n"); 
		query.append("								)     											ATTR_CTNT3																			" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT4																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT5																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT6																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT7																						" ).append("\n"); 
		query.append("							,	NULL   											ATTR_CTNT8																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT9																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT10																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT11																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT12																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT13																						" ).append("\n"); 
		query.append("							,	INV_WRK.AP_RVS_CNG_FLG							ATTR_CTNT14																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT15																						" ).append("\n"); 
		query.append("							,	SVC_ORD.ORG_BKG_NO								BKG_NO																							" ).append("\n"); 
		query.append("							,	SVC_ORD.EQ_TPSZ_CD								CNTR_TPSZ_CD																					" ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_VVD_CD								ACT_VVD_CD																												" ).append("\n"); 
		query.append("							,	'C'												PLN_SCTR_DIV_CD																					" ).append("\n"); 
		query.append("							,	NULL											SO_CRR_CD																						" ).append("\n"); 
		query.append("							,	NULL											YD_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.LGS_COST_CD								FTU_USE_CTNT1																					" ).append("\n"); 
		query.append("							,	COUNT(SVC_ORD.EQ_TPSZ_CD)  						FTU_USE_CTNT2			 																								" ).append("\n"); 
		query.append("							,	'C'												FTU_USE_CTNT3																					" ).append("\n"); 
		query.append("							,	NULL											FTU_USE_CTNT4																					" ).append("\n"); 
		query.append("							,	NULL											FTU_USE_CNTR5																					" ).append("\n"); 
		query.append("							,	SYSDATE											CRE_DT																							" ).append("\n"); 
		query.append("							,	@[CRE_USR_ID]                   				CRE_USR_ID																						" ).append("\n"); 
		query.append("							,	''												EAI_EVNT_DT              																		" ).append("\n"); 
		query.append("							,	INV_WRK.INV_NO																																	" ).append("\n"); 
		query.append("							,	INV_WRK.INV_VNDR_SEQ                                                                                                                            " ).append("\n"); 
		query.append("							,	SVC_ORD.TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("							,	SVC_ORD.TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("							,	SVC_ORD.REF_BKG_NO																									" ).append("\n"); 
		query.append("							,	SVC_ORD.CGO_TP_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.EQ_KND_CD																							" ).append("\n"); 
		query.append("					FROM		TRS_TRSP_INV_WRK 								INV_WRK		            																				" ).append("\n"); 
		query.append("							,	MDM_ACCOUNT       								ACCT_NM		            																				" ).append("\n"); 
		query.append("							,	TRS_TRSP_SVC_ORD 								SVC_ORD			            																			" ).append("\n"); 
		query.append("							,	MDM_ORGANIZATION  								MDM_ORG		            																				" ).append("\n"); 
		query.append("							,	TRS_TRSP_WRK_ORD 								WRK_ORD            																						" ).append("\n"); 
		query.append("							,	MDM_VENDOR 										MDM_VNDR                                         														" ).append("\n"); 
		query.append("					WHERE		ACCT_NM.ACCT_CD				= SVC_ORD.ACCT_CD           																			" ).append("\n"); 
		query.append("					AND			INV_WRK.INV_NO				= SVC_ORD.INV_NO              																			" ).append("\n"); 
		query.append("					AND			INV_WRK.INV_VNDR_SEQ		= SVC_ORD.INV_VNDR_SEQ        																			" ).append("\n"); 
		query.append("					AND			MDM_ORG.OFC_CD				= @[COST_OFC_CD]          																			" ).append("\n"); 
		query.append("					AND			MDM_VNDR.VNDR_SEQ			= SVC_ORD.INV_VNDR_SEQ        																			" ).append("\n"); 
		query.append("					AND			SVC_ORD.TRSP_WO_OFC_CTY_CD	= WRK_ORD.TRSP_WO_OFC_CTY_CD  																			" ).append("\n"); 
		query.append("					AND			SVC_ORD.TRSP_WO_SEQ			= WRK_ORD.TRSP_WO_SEQ         																			" ).append("\n"); 
		query.append("--					AND			SVC_ORD.WO_ISS_KNT			= WRK_ORD.WO_ISS_KNT            																		" ).append("\n"); 
		query.append("					AND			INV_WRK.INV_NO				= @[INV_NO]" ).append("\n"); 
		query.append("					AND			INV_WRK.INV_VNDR_SEQ		= @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("					AND			TRSP_INV_AUD_STS_CD			= @[TRSP_INV_AUD_STS_CD]                           																			" ).append("\n"); 
		query.append("					AND			NVL(SVC_ORD.DELT_FLG,'N')   = 'N'                           																			" ).append("\n"); 
		query.append("					AND			NVL(INV_HLD_FLG,'N')        = 'N'                 																					" ).append("\n"); 
		query.append("					AND			INV_WRK.DELT_FLG			= 'N'                     																				" ).append("\n"); 
		query.append("					GROUP BY	ACCT_NM.ACCT_ENG_NM		            																								" ).append("\n"); 
		query.append("							,	INV_WRK.INV_BZC_AMT	            																									" ).append("\n"); 
		query.append("							,	FINC_RGN_CD                 																										" ).append("\n"); 
		query.append("							,	AP_CTR_CD                        																									" ).append("\n"); 
		query.append("							,	SVC_ORD.ACCT_CD                   																									" ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_VSL_CD		               																								" ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_SKD_VOY_NO               																								" ).append("\n"); 
		query.append("							,	SVC_ORD.SKD_DIR_CD               																									" ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_SKD_DIR_CD               																								" ).append("\n"); 
		query.append("							,	NVL(SUBS_CO_CD,'00')               																									" ).append("\n"); 
		query.append("							,	SVC_ORD.ACCT_CD               																										" ).append("\n"); 
		query.append("							,	SVC_ORD.INV_NO               																										" ).append("\n"); 
		query.append("							,	INV_WRK.INV_ISS_DT " ).append("\n"); 
		query.append("							,   INV_WRK.AP_RVS_CNG_FLG                                            																		" ).append("\n"); 
		query.append("							,	SUBSTR(SVC_ORD.FM_NOD_CD,1,5)                                             															" ).append("\n"); 
		query.append("							,	SVC_ORD.ORG_BKG_NO                                             																			" ).append("\n"); 
		query.append("							,	SVC_ORD.EQ_TPSZ_CD                                             																		" ).append("\n"); 
		query.append("							,	NVL(SVC_ORD.VSL_CD||SVC_ORD.SKD_VOY_NO||SVC_ORD.SKD_DIR_CD,'CNTC'||TO_CHAR(WRK_ORD.LOCL_CRE_DT,'YYMM')||'MM')                            " ).append("\n"); 
		query.append("							,	SVC_ORD.LGS_COST_CD                                             																	" ).append("\n"); 
		query.append("							,	MDM_VNDR.LOC_CD                                               																		" ).append("\n"); 
		query.append("							,	WRK_ORD.LOCL_CRE_DT                                              																		" ).append("\n"); 
		query.append("							,	SVC_ORD.CRE_OFC_CD                                          																		" ).append("\n"); 
		query.append("							, 	SVC_ORD.INV_XCH_RT                                          																		" ).append("\n"); 
		query.append("							, 	SVC_ORD.TRSP_INV_CALC_LGC_TP_CD                                       																" ).append("\n"); 
		query.append("						    , 	INV_WRK.INV_NO																		" ).append("\n"); 
		query.append("						    , 	INV_WRK.INV_VNDR_SEQ                                                                  " ).append("\n"); 
		query.append("						    , 	SVC_ORD.FINC_VVD_CD                                                                   " ).append("\n"); 
		query.append("						    , 	SVC_ORD.TRSP_SO_TP_CD                                                                   " ).append("\n"); 
		query.append("						    , 	SVC_ORD.TRSP_SO_OFC_CTY_CD                                                                   " ).append("\n"); 
		query.append("						    , 	SVC_ORD.TRSP_SO_SEQ                                                                   " ).append("\n"); 
		query.append("							,	SVC_ORD.REF_BKG_NO																									" ).append("\n"); 
		query.append("							,	SVC_ORD.CGO_TP_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.EQ_KND_CD																							" ).append("\n"); 
		query.append("						    )                                                                                       " ).append("\n"); 
		query.append("				GROUP BY	INV_NO                                                                                  " ).append("\n"); 
		query.append("						,	INV_VNDR_SEQ                                                                            " ).append("\n"); 
		query.append("						,	INV_DESC																				" ).append("\n"); 
		query.append("						,	INV_TAX_CD																				" ).append("\n"); 
		query.append("						,	DTRB_COA_CO_CD																			" ).append("\n"); 
		query.append("						,	DTRB_COA_RGN_CD																			" ).append("\n"); 
		query.append("						,	DTRB_COA_CTR_CD																			" ).append("\n"); 
		query.append("						,	DTRB_COA_ACCT_CD																		" ).append("\n"); 
		query.append("						,	DTRB_COA_VVD_CD		                                                                    " ).append("\n"); 
		query.append("						,	DTRB_COA_INTER_CO_CD																	" ).append("\n"); 
		query.append("						,	DTRB_COA_FTU_N1ST_CD																	" ).append("\n"); 
		query.append("						,	DTRB_COA_FTU_N2ND_CD																	" ).append("\n"); 
		query.append("						,	ATTR_CATE_NM																			" ).append("\n"); 
		query.append("						,	ATTR_CTNT1																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT2																			    " ).append("\n"); 
		query.append("						,	ATTR_CTNT3																			    " ).append("\n"); 
		query.append("						,	ATTR_CTNT4																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT5																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT6																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT7																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT8																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT9																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT10																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT11																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT12																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT13																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT14																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT15																				" ).append("\n"); 
		query.append("						,	BKG_NO																					" ).append("\n"); 
		query.append("						,	CNTR_TPSZ_CD																			" ).append("\n"); 
		query.append("						,	ACT_VVD_CD																				" ).append("\n"); 
		query.append("						,	PLN_SCTR_DIV_CD																			" ).append("\n"); 
		query.append("						,	SO_CRR_CD																				" ).append("\n"); 
		query.append("						,	YD_CD																					" ).append("\n"); 
		query.append("						,	FTU_USE_CTNT1																			" ).append("\n"); 
		query.append("						,	FTU_USE_CTNT3																			" ).append("\n"); 
		query.append("						,	FTU_USE_CTNT4																			" ).append("\n"); 
		query.append("						,	FTU_USE_CNTR5																			" ).append("\n"); 
		query.append("						,	CRE_DT																					" ).append("\n"); 
		query.append("						,	CRE_USR_ID																				" ).append("\n"); 
		query.append("						,	EAI_EVNT_DT                                                                             " ).append("\n"); 
		query.append("						, 	TRSP_SO_TP_CD                                                                   		" ).append("\n"); 
		query.append("						, 	TRSP_SO_OFC_CTY_CD                                                                   	" ).append("\n"); 
		query.append("						, 	TRSP_SO_SEQ                                                                   			" ).append("\n"); 
		query.append("						,	REF_BKG_NO																				" ).append("\n"); 
		query.append("						, 	CGO_TP_CD                                                                   			" ).append("\n"); 
		query.append("						, 	EQ_KND_CD                                                                   			" ).append("\n"); 
		query.append("					UNION ALL 																						" ).append("\n"); 
		query.append("					SELECT		@[CSR_NO]	CSR_NO																					" ).append("\n"); 
		query.append("							,	'6'	LINE_SEQ													    " ).append("\n"); 
		query.append("							,	@[LINE_NO]      LINE_NO							                                " ).append("\n"); 
		query.append("							,	'ITEM'		LINE_TP_LU_CD													" ).append("\n"); 
		query.append("							,	SUM(CSR_AMT)        		CSR_AMT															" ).append("\n"); 
		query.append("							,	INV_DESC																					" ).append("\n"); 
		query.append("							,	INV_TAX_CD																					" ).append("\n"); 
		query.append("							,	DTRB_COA_CO_CD																				" ).append("\n"); 
		query.append("							,	DTRB_COA_RGN_CD																				" ).append("\n"); 
		query.append("							,	DTRB_COA_CTR_CD																				" ).append("\n"); 
		query.append("							,	DTRB_COA_ACCT_CD																			" ).append("\n"); 
		query.append("							,	DTRB_COA_VVD_CD		                                                                        " ).append("\n"); 
		query.append("							,	DTRB_COA_INTER_CO_CD																		" ).append("\n"); 
		query.append("							,	DTRB_COA_FTU_N1ST_CD																		" ).append("\n"); 
		query.append("							,	DTRB_COA_FTU_N2ND_CD																		" ).append("\n"); 
		query.append("							,	ATTR_CATE_NM																				" ).append("\n"); 
		query.append("							,	ATTR_CTNT1																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT2																			        " ).append("\n"); 
		query.append("							,	ATTR_CTNT3																			        " ).append("\n"); 
		query.append("							,	ATTR_CTNT4																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT5																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT6																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT7																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT8																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT9																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT10																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT11																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT12																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT13																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT14																					" ).append("\n"); 
		query.append("							,	ATTR_CTNT15																					" ).append("\n"); 
		query.append("							,	BKG_NO																						" ).append("\n"); 
		query.append("							,	CNTR_TPSZ_CD																				" ).append("\n"); 
		query.append("							,	ACT_VVD_CD																					" ).append("\n"); 
		query.append("							,	PLN_SCTR_DIV_CD																				" ).append("\n"); 
		query.append("							,	SO_CRR_CD																					" ).append("\n"); 
		query.append("							,	YD_CD																						" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT1																				" ).append("\n"); 
		query.append("							,	TO_CHAR(COUNT(FTU_USE_CTNT2)) 	FTU_USE_CTNT2						                        " ).append("\n"); 
		query.append("							,	FTU_USE_CTNT3																				" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT4																				" ).append("\n"); 
		query.append("							,	FTU_USE_CNTR5																				" ).append("\n"); 
		query.append("							,	CRE_DT																						" ).append("\n"); 
		query.append("							,	CRE_USR_ID																					" ).append("\n"); 
		query.append("							,	EAI_EVNT_DT                                                                                 " ).append("\n"); 
		query.append("							,	TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("							,	TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("							,	TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("							,	REF_BKG_NO																							" ).append("\n"); 
		query.append("							,	CGO_TP_CD																							" ).append("\n"); 
		query.append("							,	EQ_KND_CD																							" ).append("\n"); 
		query.append("					FROM     	(                                                                                           " ).append("\n"); 
		query.append("					SELECT																									" ).append("\n"); 
		query.append("								SUM(NVL(SVC_ORD.INV_SBC_AMT, 0))				CSR_AMT																																									" ).append("\n"); 
		query.append("							,	DECODE(SVC_ORD.CGO_TP_CD, 'F', 'SBC Tax Full', 'SBC Tax Empty')								INV_DESC																								" ).append("\n"); 
		query.append("							,	''												INV_TAX_CD																								" ).append("\n"); 
		query.append("							,	'01'											DTRB_COA_CO_CD																							" ).append("\n"); 
		query.append("							,	FINC_RGN_CD										DTRB_COA_RGN_CD																							" ).append("\n"); 
		query.append("							,	AP_CTR_CD										DTRB_COA_CTR_CD																							" ).append("\n"); 
		query.append("							,	DECODE(SVC_ORD.CGO_TP_CD, 'F', '512396', '512347') DTRB_COA_ACCT_CD																						" ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_VVD_CD								DTRB_COA_VVD_CD																							" ).append("\n"); 
		query.append("							,	NVL(SUBS_CO_CD,'00')    						DTRB_COA_INTER_CO_CD																					" ).append("\n"); 
		query.append("							,	'000000'                						DTRB_COA_FTU_N1ST_CD																					" ).append("\n"); 
		query.append("							,	'000000'                						DTRB_COA_FTU_N2ND_CD																					" ).append("\n"); 
		query.append("							,	DECODE(SVC_ORD.CGO_TP_CD, 'F', '512396', '512347') ATTR_CATE_NM																							" ).append("\n"); 
		query.append("							,	SVC_ORD.INV_NO          						ATTR_CTNT1																								" ).append("\n"); 
		query.append("							,	TO_CHAR(INV_WRK.INV_ISS_DT,'YYYYMMDD')      	ATTR_CTNT2																			" ).append("\n"); 
		query.append("							,	(	SELECT   A.LOC_CD																												" ).append("\n"); 
		query.append("									FROM     MDM_ORGANIZATION A																										" ).append("\n"); 
		query.append("									WHERE    SVC_ORD.CRE_OFC_CD	= A.OFC_CD																						" ).append("\n"); 
		query.append("								)     											ATTR_CTNT3																			" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT4																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT5																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT6																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT7																						" ).append("\n"); 
		query.append("							,	NULL   											ATTR_CTNT8																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT9																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT10																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT11																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT12																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT13																						" ).append("\n"); 
		query.append("							,	INV_WRK.AP_RVS_CNG_FLG							ATTR_CTNT14																						" ).append("\n"); 
		query.append("							,	NULL											ATTR_CTNT15																						" ).append("\n"); 
		query.append("							,	SVC_ORD.ORG_BKG_NO								BKG_NO																							" ).append("\n"); 
		query.append("							,	SVC_ORD.EQ_TPSZ_CD								CNTR_TPSZ_CD																					" ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_VVD_CD								ACT_VVD_CD																												" ).append("\n"); 
		query.append("							,	'C'												PLN_SCTR_DIV_CD																					" ).append("\n"); 
		query.append("							,	NULL											SO_CRR_CD																						" ).append("\n"); 
		query.append("							,	NULL											YD_CD																							" ).append("\n"); 
		query.append("							,	DECODE(SVC_ORD.CGO_TP_CD, 'F', 'SCOTAX', 'SMOTAX')								FTU_USE_CTNT1																					" ).append("\n"); 
		query.append("							,	COUNT(SVC_ORD.EQ_TPSZ_CD)  						FTU_USE_CTNT2			 																								" ).append("\n"); 
		query.append("							,	'C'												FTU_USE_CTNT3																					" ).append("\n"); 
		query.append("							,	NULL											FTU_USE_CTNT4																					" ).append("\n"); 
		query.append("							,	NULL											FTU_USE_CNTR5																					" ).append("\n"); 
		query.append("							,	SYSDATE											CRE_DT																							" ).append("\n"); 
		query.append("							,	@[CRE_USR_ID]                   				CRE_USR_ID																						" ).append("\n"); 
		query.append("							,	''												EAI_EVNT_DT              																		" ).append("\n"); 
		query.append("							,	INV_WRK.INV_NO																																	" ).append("\n"); 
		query.append("							,	INV_WRK.INV_VNDR_SEQ                                                                                                                            " ).append("\n"); 
		query.append("							,	SVC_ORD.TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("							,	SVC_ORD.TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("							,	SVC_ORD.REF_BKG_NO																									" ).append("\n"); 
		query.append("							,	SVC_ORD.CGO_TP_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.EQ_KND_CD																							" ).append("\n"); 
		query.append("					FROM		TRS_TRSP_INV_WRK 								INV_WRK		            																				" ).append("\n"); 
		query.append("							,	MDM_ACCOUNT       								ACCT_NM		            																				" ).append("\n"); 
		query.append("							,	TRS_TRSP_SVC_ORD 								SVC_ORD			            																			" ).append("\n"); 
		query.append("							,	MDM_ORGANIZATION  								MDM_ORG		            																				" ).append("\n"); 
		query.append("							,	TRS_TRSP_WRK_ORD 								WRK_ORD            																						" ).append("\n"); 
		query.append("							,	MDM_VENDOR 										MDM_VNDR                                         														" ).append("\n"); 
		query.append("					WHERE		ACCT_NM.ACCT_CD				= SVC_ORD.ACCT_CD           																			" ).append("\n"); 
		query.append("					AND			INV_WRK.INV_NO				= SVC_ORD.INV_NO              																			" ).append("\n"); 
		query.append("					AND			INV_WRK.INV_VNDR_SEQ		= SVC_ORD.INV_VNDR_SEQ        																			" ).append("\n"); 
		query.append("					AND			MDM_ORG.OFC_CD				= @[COST_OFC_CD]          																			" ).append("\n"); 
		query.append("					AND			MDM_VNDR.VNDR_SEQ			= SVC_ORD.INV_VNDR_SEQ        																			" ).append("\n"); 
		query.append("					AND			SVC_ORD.TRSP_WO_OFC_CTY_CD	= WRK_ORD.TRSP_WO_OFC_CTY_CD  																			" ).append("\n"); 
		query.append("					AND			SVC_ORD.TRSP_WO_SEQ			= WRK_ORD.TRSP_WO_SEQ         																			" ).append("\n"); 
		query.append("--					AND			SVC_ORD.WO_ISS_KNT			= WRK_ORD.WO_ISS_KNT            																		" ).append("\n"); 
		query.append("					AND			INV_WRK.INV_NO				= @[INV_NO]" ).append("\n"); 
		query.append("					AND			INV_WRK.INV_VNDR_SEQ		= @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("					AND			TRSP_INV_AUD_STS_CD			= @[TRSP_INV_AUD_STS_CD]                           																			" ).append("\n"); 
		query.append("					AND			NVL(SVC_ORD.DELT_FLG,'N')   = 'N'                           																			" ).append("\n"); 
		query.append("					AND			NVL(INV_HLD_FLG,'N')        = 'N'                 																					" ).append("\n"); 
		query.append("					AND			INV_WRK.DELT_FLG			= 'N'                     																				" ).append("\n"); 
		query.append("					AND			NVL(SVC_ORD.INV_SBC_AMT, 0) <> 0" ).append("\n"); 
		query.append("					GROUP BY	ACCT_NM.ACCT_ENG_NM		            																								" ).append("\n"); 
		query.append("							,	INV_WRK.INV_BZC_AMT	            																									" ).append("\n"); 
		query.append("							,	FINC_RGN_CD                 																										" ).append("\n"); 
		query.append("							,	AP_CTR_CD                        																									" ).append("\n"); 
		query.append("							,	SVC_ORD.ACCT_CD                   																									" ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_VSL_CD		               																								" ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_SKD_VOY_NO               																								" ).append("\n"); 
		query.append("							,	SVC_ORD.SKD_DIR_CD               																									" ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_SKD_DIR_CD               																								" ).append("\n"); 
		query.append("							,	NVL(SUBS_CO_CD,'00')               																									" ).append("\n"); 
		query.append("							,	SVC_ORD.ACCT_CD               																										" ).append("\n"); 
		query.append("							,	SVC_ORD.INV_NO               																										" ).append("\n"); 
		query.append("							,	INV_WRK.INV_ISS_DT " ).append("\n"); 
		query.append("							,   INV_WRK.AP_RVS_CNG_FLG                                            																		" ).append("\n"); 
		query.append("							,	SUBSTR(SVC_ORD.FM_NOD_CD,1,5)                                             															" ).append("\n"); 
		query.append("							,	SVC_ORD.ORG_BKG_NO                                             																			" ).append("\n"); 
		query.append("							,	SVC_ORD.EQ_TPSZ_CD                                             																		" ).append("\n"); 
		query.append("							,	NVL(SVC_ORD.VSL_CD||SVC_ORD.SKD_VOY_NO||SVC_ORD.SKD_DIR_CD,'CNTC'||TO_CHAR(WRK_ORD.LOCL_CRE_DT,'YYMM')||'MM')                            " ).append("\n"); 
		query.append("							,	SVC_ORD.LGS_COST_CD                                             																	" ).append("\n"); 
		query.append("							,	MDM_VNDR.LOC_CD                                               																		" ).append("\n"); 
		query.append("							,	WRK_ORD.LOCL_CRE_DT                                              																		" ).append("\n"); 
		query.append("							,	SVC_ORD.CRE_OFC_CD                                          																		" ).append("\n"); 
		query.append("							, 	SVC_ORD.INV_XCH_RT                                          																		" ).append("\n"); 
		query.append("							, 	SVC_ORD.TRSP_INV_CALC_LGC_TP_CD                                       																" ).append("\n"); 
		query.append("						    , 	INV_WRK.INV_NO																		" ).append("\n"); 
		query.append("						    , 	INV_WRK.INV_VNDR_SEQ                                                                  " ).append("\n"); 
		query.append("						    , 	SVC_ORD.FINC_VVD_CD                                                                   " ).append("\n"); 
		query.append("						    , 	SVC_ORD.TRSP_SO_TP_CD                                                                   " ).append("\n"); 
		query.append("						    , 	SVC_ORD.TRSP_SO_OFC_CTY_CD                                                                   " ).append("\n"); 
		query.append("						    , 	SVC_ORD.TRSP_SO_SEQ                                                                   " ).append("\n"); 
		query.append("							,	SVC_ORD.REF_BKG_NO																									" ).append("\n"); 
		query.append("							,	SVC_ORD.CGO_TP_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.EQ_KND_CD																							" ).append("\n"); 
		query.append("						    )                                                                                       " ).append("\n"); 
		query.append("				GROUP BY	INV_NO                                                                                  " ).append("\n"); 
		query.append("						,	INV_VNDR_SEQ                                                                            " ).append("\n"); 
		query.append("						,	INV_DESC																				" ).append("\n"); 
		query.append("						,	INV_TAX_CD																				" ).append("\n"); 
		query.append("						,	DTRB_COA_CO_CD																			" ).append("\n"); 
		query.append("						,	DTRB_COA_RGN_CD																			" ).append("\n"); 
		query.append("						,	DTRB_COA_CTR_CD																			" ).append("\n"); 
		query.append("						,	DTRB_COA_ACCT_CD																		" ).append("\n"); 
		query.append("						,	DTRB_COA_VVD_CD		                                                                    " ).append("\n"); 
		query.append("						,	DTRB_COA_INTER_CO_CD																	" ).append("\n"); 
		query.append("						,	DTRB_COA_FTU_N1ST_CD																	" ).append("\n"); 
		query.append("						,	DTRB_COA_FTU_N2ND_CD																	" ).append("\n"); 
		query.append("						,	ATTR_CATE_NM																			" ).append("\n"); 
		query.append("						,	ATTR_CTNT1																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT2																			    " ).append("\n"); 
		query.append("						,	ATTR_CTNT3																			    " ).append("\n"); 
		query.append("						,	ATTR_CTNT4																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT5																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT6																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT7																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT8																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT9																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT10																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT11																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT12																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT13																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT14																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT15																				" ).append("\n"); 
		query.append("						,	BKG_NO																					" ).append("\n"); 
		query.append("						,	CNTR_TPSZ_CD																			" ).append("\n"); 
		query.append("						,	ACT_VVD_CD																				" ).append("\n"); 
		query.append("						,	PLN_SCTR_DIV_CD																			" ).append("\n"); 
		query.append("						,	SO_CRR_CD																				" ).append("\n"); 
		query.append("						,	YD_CD																					" ).append("\n"); 
		query.append("						,	FTU_USE_CTNT1																			" ).append("\n"); 
		query.append("						,	FTU_USE_CTNT3																			" ).append("\n"); 
		query.append("						,	FTU_USE_CTNT4																			" ).append("\n"); 
		query.append("						,	FTU_USE_CNTR5																			" ).append("\n"); 
		query.append("						,	CRE_DT																					" ).append("\n"); 
		query.append("						,	CRE_USR_ID																				" ).append("\n"); 
		query.append("						,	EAI_EVNT_DT                                                                             " ).append("\n"); 
		query.append("						, 	TRSP_SO_TP_CD                                                                   		" ).append("\n"); 
		query.append("						, 	TRSP_SO_OFC_CTY_CD                                                                   	" ).append("\n"); 
		query.append("						, 	TRSP_SO_SEQ                                                                   			" ).append("\n"); 
		query.append("						,	REF_BKG_NO																				" ).append("\n"); 
		query.append("						, 	CGO_TP_CD                                                                   			" ).append("\n"); 
		query.append("						, 	EQ_KND_CD                                                                   			" ).append("\n"); 
		query.append("					UNION ALL" ).append("\n"); 
		query.append("					SELECT	@[CSR_NO]					CSR_NO														" ).append("\n"); 
		query.append("						,	'2'           				LINE_SEQ													" ).append("\n"); 
		query.append("						,	@[LINE_NO]            		LINE_NO														" ).append("\n"); 
		query.append("						,	'ITEM'						LINE_TP_LU_CD												" ).append("\n"); 
		query.append("						,	SUM(CSR_AMT+CSR_SCG_CORR_AMT) CSR_AMT										" ).append("\n"); 
		query.append("						,	INV_DESC																				" ).append("\n"); 
		query.append("						,	INV_TAX_CD																				" ).append("\n"); 
		query.append("						,	DTRB_COA_CO_CD																			" ).append("\n"); 
		query.append("						,	DTRB_COA_RGN_CD																			" ).append("\n"); 
		query.append("						,	DTRB_COA_CTR_CD																			" ).append("\n"); 
		query.append("						,	DTRB_COA_ACCT_CD																		" ).append("\n"); 
		query.append("						,	DTRB_COA_VVD_CD		                                                                    " ).append("\n"); 
		query.append("						,	DTRB_COA_INTER_CO_CD																	" ).append("\n"); 
		query.append("						,	DTRB_COA_FTU_N1ST_CD																	" ).append("\n"); 
		query.append("						,	DTRB_COA_FTU_N2ND_CD																	" ).append("\n"); 
		query.append("						,	ATTR_CATE_NM																			" ).append("\n"); 
		query.append("						,	ATTR_CTNT1																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT2																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT3											                                    " ).append("\n"); 
		query.append("						,	ATTR_CTNT4																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT5																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT6																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT7																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT8																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT9																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT10																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT11																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT12																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT13																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT14																				" ).append("\n"); 
		query.append("						,	ATTR_CTNT15																				" ).append("\n"); 
		query.append("						,	BKG_NO																					" ).append("\n"); 
		query.append("						,	CNTR_TPSZ_CD																			" ).append("\n"); 
		query.append("						,	ACT_VVD_CD		                                                                        " ).append("\n"); 
		query.append("						,	PLN_SCTR_DIV_CD																			" ).append("\n"); 
		query.append("						,	SO_CRR_CD																				" ).append("\n"); 
		query.append("						,	YD_CD																					" ).append("\n"); 
		query.append("						,	FTU_USE_CTNT1																			" ).append("\n"); 
		query.append("						,	TO_CHAR(COUNT(FTU_USE_CTNT2)) 	FTU_USE_CTNT2				                            " ).append("\n"); 
		query.append("						,	FTU_USE_CTNT3																			" ).append("\n"); 
		query.append("						,	FTU_USE_CTNT4																			" ).append("\n"); 
		query.append("						,	FTU_USE_CNTR5																			" ).append("\n"); 
		query.append("						,	CRE_DT																					" ).append("\n"); 
		query.append("						,	CRE_USR_ID																				" ).append("\n"); 
		query.append("						,	EAI_EVNT_DT                                                                             " ).append("\n"); 
		query.append("						,	TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("						,	TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("						,	TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("						,	REF_BKG_NO																									" ).append("\n"); 
		query.append("						,	CGO_TP_CD																							" ).append("\n"); 
		query.append("						,	EQ_KND_CD																							" ).append("\n"); 
		query.append("					FROM 	(                                                                 						" ).append("\n"); 
		query.append("					SELECT																													" ).append("\n"); 
		query.append("								CASE	WHEN @[CURR_CD] IN ('KRW','JPY','TWD') THEN																															" ).append("\n"); 
		query.append("												CASE 	WHEN SVC_ORD.TRSP_INV_CALC_LGC_TP_CD = 'TM' THEN SUM( ROUND( ( (NVL(SCG_AMT,0)*NVL(SVC_ORD.INV_XCH_RT,1)) + NVL(INV_SCG_AMT,0) ), 0) )  	" ).append("\n"); 
		query.append("														WHEN SVC_ORD.TRSP_INV_CALC_LGC_TP_CD = 'DV' THEN SUM( ROUND( ( (NVL(SCG_AMT,0)/NVL(SVC_ORD.INV_XCH_RT,1)) + NVL(INV_SCG_AMT,0) ), 0) )  	" ).append("\n"); 
		query.append("														ELSE SUM( ROUND( (NVL(SCG_AMT,0) + NVL(INV_SCG_AMT,0) ), 0) )   																			" ).append("\n"); 
		query.append("												END																																				" ).append("\n"); 
		query.append("										ELSE																																					" ).append("\n"); 
		query.append("												CASE 	WHEN SVC_ORD.TRSP_INV_CALC_LGC_TP_CD = 'TM' THEN SUM( ROUND( ( (NVL(SCG_AMT,0)*NVL(SVC_ORD.INV_XCH_RT,1)) + NVL(INV_SCG_AMT,0) ), 2) )		" ).append("\n"); 
		query.append("														WHEN SVC_ORD.TRSP_INV_CALC_LGC_TP_CD = 'DV' THEN SUM( ROUND( ( (NVL(SCG_AMT,0)/NVL(SVC_ORD.INV_XCH_RT,1)) + NVL(INV_SCG_AMT,0) ), 2) )		" ).append("\n"); 
		query.append("														ELSE SUM( ROUND( (NVL(SCG_AMT,0) + NVL(INV_SCG_AMT,0) ), 2) )																				" ).append("\n"); 
		query.append("												END																																				" ).append("\n"); 
		query.append("								END										CSR_AMT																																					" ).append("\n"); 
		query.append("							,	DECODE(ROW_NUMBER() OVER (PARTITION BY SVC_ORD.TRSP_SO_SEQ ORDER BY LGS_CST.LGS_COST_CD), 1, NVL(SVC_ORD.CSR_SCG_CORR_AMT, 0), 0) CSR_SCG_CORR_AMT	                 " ).append("\n"); 
		query.append("							,	ACCT_NM.ACCT_ENG_NM     				INV_DESC																									" ).append("\n"); 
		query.append("							,	''					    				INV_TAX_CD																									" ).append("\n"); 
		query.append("							,	'01'                    				DTRB_COA_CO_CD																								" ).append("\n"); 
		query.append("							,	FINC_RGN_CD             				DTRB_COA_RGN_CD																								" ).append("\n"); 
		query.append("							,	AP_CTR_CD               				DTRB_COA_CTR_CD																								" ).append("\n"); 
		query.append("							,	LGS_CST.ACCT_CD         				DTRB_COA_ACCT_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_VVD_CD 					DTRB_COA_VVD_CD		" ).append("\n"); 
		query.append("							,	NVL(SUBS_CO_CD,'00')    				DTRB_COA_INTER_CO_CD																						" ).append("\n"); 
		query.append("							,	'000000'                				DTRB_COA_FTU_N1ST_CD																						" ).append("\n"); 
		query.append("							,	'000000'                				DTRB_COA_FTU_N2ND_CD																						" ).append("\n"); 
		query.append("							,	LGS_CST.ACCT_CD         				ATTR_CATE_NM																								" ).append("\n"); 
		query.append("							,	SVC_ORD.INV_NO          				ATTR_CTNT1																									" ).append("\n"); 
		query.append("							,	TO_CHAR(INV_WRK.INV_ISS_DT,'YYYYMMDD')  ATTR_CTNT2																									" ).append("\n"); 
		query.append("							,	(SELECT A.LOC_CD FROM MDM_ORGANIZATION A WHERE SVC_ORD.CRE_OFC_CD = A.OFC_CD) ATTR_CTNT3																									" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT4																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT5																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT6																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT7																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT8																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT9																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT10																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT11																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT12																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT13																							" ).append("\n"); 
		query.append("							,	INV_WRK.AP_RVS_CNG_FLG                  ATTR_CTNT14																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT15																							" ).append("\n"); 
		query.append("							,	SVC_ORD.ORG_BKG_NO                 		BKG_NO																								" ).append("\n"); 
		query.append("							,	SVC_ORD.EQ_TPSZ_CD             			CNTR_TPSZ_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_VVD_CD						ACT_VVD_CD																								" ).append("\n"); 
		query.append("							,	'C'                            			PLN_SCTR_DIV_CD																						" ).append("\n"); 
		query.append("							,	NULL                           			SO_CRR_CD																							" ).append("\n"); 
		query.append("							,	NULL                           			YD_CD																								" ).append("\n"); 
		query.append("							,	LGS_CST.LGS_COST_CD            			FTU_USE_CTNT1																						" ).append("\n"); 
		query.append("							,	COUNT(SVC_ORD.EQ_TPSZ_CD)      FTU_USE_CTNT2																				" ).append("\n"); 
		query.append("							,	'C'                            			FTU_USE_CTNT3																						" ).append("\n"); 
		query.append("							,	NULL                           			FTU_USE_CTNT4																						" ).append("\n"); 
		query.append("							,	NULL                           			FTU_USE_CNTR5																						" ).append("\n"); 
		query.append("							,	SYSDATE                        			CRE_DT																								" ).append("\n"); 
		query.append("							,	@[CRE_USR_ID]                   		CRE_USR_ID																							" ).append("\n"); 
		query.append("							,	''                             			EAI_EVNT_DT             																				" ).append("\n"); 
		query.append("							,	INV_WRK.INV_NO																																" ).append("\n"); 
		query.append("							,	INV_WRK.INV_VNDR_SEQ                                                                                                                        " ).append("\n"); 
		query.append("							,	SVC_ORD.TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("							,	SVC_ORD.TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("							,	SVC_ORD.REF_BKG_NO																									" ).append("\n"); 
		query.append("							,	SVC_ORD.CGO_TP_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.EQ_KND_CD																							" ).append("\n"); 
		query.append("					FROM		TRS_TRSP_INV_WRK 				INV_WRK																								" ).append("\n"); 
		query.append("							,	MDM_ACCOUNT						ACCT_NM																								" ).append("\n"); 
		query.append("							,	TRS_TRSP_SVC_ORD 				SVC_ORD																								" ).append("\n"); 
		query.append("							,	MDM_ORGANIZATION				MDM_ORG																								" ).append("\n"); 
		query.append("							,	TRS_TRSP_WRK_ORD 				WRK_ORD																								" ).append("\n"); 
		query.append("							,	MDM_VENDOR 						MDM_VNDR																							" ).append("\n"); 
		query.append("							,	TES_LGS_COST					LGS_CST																								" ).append("\n"); 
		query.append("							,	TRS_TRSP_SCG_DTL				SCG_DTL             																				" ).append("\n"); 
		query.append("					WHERE		ACCT_NM.ACCT_CD            		= LGS_CST.ACCT_CD                   																" ).append("\n"); 
		query.append("								AND			INV_WRK.INV_NO             		= SVC_ORD.INV_NO                    																" ).append("\n"); 
		query.append("								AND			INV_WRK.INV_VNDR_SEQ       		= SVC_ORD.INV_VNDR_SEQ              																" ).append("\n"); 
		query.append("								AND			MDM_VNDR.VNDR_SEQ          		= SVC_ORD.INV_VNDR_SEQ              																" ).append("\n"); 
		query.append("								AND			SCG_DTL.TRSP_SO_OFC_CTY_CD 		= SVC_ORD.TRSP_SO_OFC_CTY_CD        																" ).append("\n"); 
		query.append("								AND			SCG_DTL.TRSP_SO_SEQ        		= SVC_ORD.TRSP_SO_SEQ               																" ).append("\n"); 
		query.append("								AND			SCG_DTL.LGS_COST_CD        		= LGS_CST.LGS_COST_CD               																" ).append("\n"); 
		query.append("								AND			MDM_ORG.OFC_CD             		= @[COST_OFC_CD]" ).append("\n"); 
		query.append("								AND			INV_WRK.INV_NO             		= @[INV_NO]" ).append("\n"); 
		query.append("								AND			INV_WRK.INV_VNDR_SEQ       		= @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("								AND			TRSP_INV_AUD_STS_CD        		= @[TRSP_INV_AUD_STS_CD]" ).append("\n"); 
		query.append("								AND			NVL(INV_HLD_FLG,'N')       		= 'N'                               																" ).append("\n"); 
		query.append("								AND			SVC_ORD.TRSP_WO_OFC_CTY_CD 		= WRK_ORD.TRSP_WO_OFC_CTY_CD  																		" ).append("\n"); 
		query.append("								AND			SVC_ORD.TRSP_WO_SEQ  			= WRK_ORD.TRSP_WO_SEQ         																		" ).append("\n"); 
		query.append("--								AND			SVC_ORD.WO_ISS_KNT 				= WRK_ORD.WO_ISS_KNT            																	" ).append("\n"); 
		query.append("								AND			NVL(SVC_ORD.DELT_FLG,'N')   	= 'N'                              																	" ).append("\n"); 
		query.append("								AND			INV_WRK.DELT_FLG           		= 'N'                               																" ).append("\n"); 
		query.append("					GROUP BY    ACCT_NM.ACCT_ENG_NM																													" ).append("\n"); 
		query.append("							,	FINC_RGN_CD																															" ).append("\n"); 
		query.append("							,	AP_CTR_CD																															" ).append("\n"); 
		query.append("							,	LGS_CST.ACCT_CD																														" ).append("\n"); 
		query.append("							,	DECODE (SVC_ORD.ORG_BKG_NO, NULL, 'CNTC'||TO_CHAR(WRK_ORD.LOCL_CRE_DT,'YYMM')||'MM', SVC_ORD.FINC_VSL_CD||SVC_ORD.FINC_SKD_VOY_NO||SVC_ORD.SKD_DIR_CD||SVC_ORD.FINC_SKD_DIR_CD)		" ).append("\n"); 
		query.append("							,	NVL(SUBS_CO_CD,'00')																												" ).append("\n"); 
		query.append("							,	LGS_CST.ACCT_CD																														" ).append("\n"); 
		query.append("							,	SVC_ORD.INV_NO																														" ).append("\n"); 
		query.append("							,	TO_CHAR(INV_WRK.INV_ISS_DT,'YYYYMMDD')	" ).append("\n"); 
		query.append("							,   INV_WRK.AP_RVS_CNG_FLG																							" ).append("\n"); 
		query.append("							,	SVC_ORD.ORG_BKG_NO 																														" ).append("\n"); 
		query.append("							,	SVC_ORD.EQ_TPSZ_CD																													" ).append("\n"); 
		query.append("							,	SVC_ORD.CRE_OFC_CD																													" ).append("\n"); 
		query.append("							,	SVC_ORD.VSL_CD																														" ).append("\n"); 
		query.append("							,	SVC_ORD.SKD_VOY_NO																													" ).append("\n"); 
		query.append("							,	SVC_ORD.SKD_DIR_CD																													" ).append("\n"); 
		query.append("							,	WRK_ORD.LOCL_CRE_DT																														" ).append("\n"); 
		query.append("							,	LGS_CST.LGS_COST_CD																													" ).append("\n"); 
		query.append("							,	SVC_ORD.CRE_OFC_CD                       			   	          																	" ).append("\n"); 
		query.append("							, 	SVC_ORD.TRSP_INV_CALC_LGC_TP_CD                    			   	          																	" ).append("\n"); 
		query.append("							,	INV_WRK.INV_NO																		" ).append("\n"); 
		query.append("							,	INV_WRK.INV_VNDR_SEQ                                                                " ).append("\n"); 
		query.append("							,	SVC_ORD.CSR_SCG_CORR_AMT                                                            " ).append("\n"); 
		query.append("							,	SVC_ORD.FINC_VVD_CD                                                            		" ).append("\n"); 
		query.append("						    , 	SVC_ORD.TRSP_SO_TP_CD                                                                   " ).append("\n"); 
		query.append("						    , 	SVC_ORD.TRSP_SO_OFC_CTY_CD                                                                   " ).append("\n"); 
		query.append("						    , 	SVC_ORD.TRSP_SO_SEQ                                                                   " ).append("\n"); 
		query.append("							,	SVC_ORD.REF_BKG_NO																									" ).append("\n"); 
		query.append("							,	SVC_ORD.CGO_TP_CD																							" ).append("\n"); 
		query.append("							,	SVC_ORD.EQ_KND_CD																							" ).append("\n"); 
		query.append("					    )                                                                                           " ).append("\n"); 
		query.append("					GROUP BY  	INV_NO                                                                              " ).append("\n"); 
		query.append("							, 	INV_VNDR_SEQ                                                                        " ).append("\n"); 
		query.append("							,	INV_DESC																			" ).append("\n"); 
		query.append("							,	INV_TAX_CD																			" ).append("\n"); 
		query.append("							,	DTRB_COA_CO_CD																		" ).append("\n"); 
		query.append("							,	DTRB_COA_RGN_CD																		" ).append("\n"); 
		query.append("							,	DTRB_COA_CTR_CD																		" ).append("\n"); 
		query.append("							,	DTRB_COA_ACCT_CD																	" ).append("\n"); 
		query.append("							,	DTRB_COA_VVD_CD		                                                                " ).append("\n"); 
		query.append("							,	DTRB_COA_INTER_CO_CD																" ).append("\n"); 
		query.append("							,	DTRB_COA_FTU_N1ST_CD																" ).append("\n"); 
		query.append("							,	DTRB_COA_FTU_N2ND_CD																" ).append("\n"); 
		query.append("							,	ATTR_CATE_NM																		" ).append("\n"); 
		query.append("							,	ATTR_CTNT1																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT2																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT3											                                " ).append("\n"); 
		query.append("							,	ATTR_CTNT4																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT5																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT6																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT7																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT8																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT9																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT10																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT11																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT12																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT13																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT14																			" ).append("\n"); 
		query.append("							,	ATTR_CTNT15																			" ).append("\n"); 
		query.append("							,	BKG_NO																				" ).append("\n"); 
		query.append("							,	CNTR_TPSZ_CD																		" ).append("\n"); 
		query.append("							,	ACT_VVD_CD		                                                                    " ).append("\n"); 
		query.append("							,	PLN_SCTR_DIV_CD																		" ).append("\n"); 
		query.append("							,	SO_CRR_CD																			" ).append("\n"); 
		query.append("							,	YD_CD																				" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT1																		" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT3																		" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT4																		" ).append("\n"); 
		query.append("							,	FTU_USE_CNTR5																		" ).append("\n"); 
		query.append("							,	CRE_DT																				" ).append("\n"); 
		query.append("							,	CRE_USR_ID																			" ).append("\n"); 
		query.append("							,	EAI_EVNT_DT                                                                         " ).append("\n"); 
		query.append("						    , 	TRSP_SO_TP_CD                                                               " ).append("\n"); 
		query.append("						    , 	TRSP_SO_OFC_CTY_CD                                                          " ).append("\n"); 
		query.append("						    , 	TRSP_SO_SEQ                                                                 " ).append("\n"); 
		query.append("							,	REF_BKG_NO																									" ).append("\n"); 
		query.append("							,	CGO_TP_CD																							" ).append("\n"); 
		query.append("							,	EQ_KND_CD																							" ).append("\n"); 
		query.append("					UNION ALL                                                     																					" ).append("\n"); 
		query.append("					SELECT		@[CSR_NO]			CSR_NO" ).append("\n"); 
		query.append("							,	'3'           		LINE_SEQ																											" ).append("\n"); 
		query.append("							,	@[LINE_NO]          LINE_NO																												" ).append("\n"); 
		query.append("							,	'ITEM'             	LINE_TP_LU_CD																							" ).append("\n"); 
		query.append("							,	SUM(CSR_AMT) 		CSR_AMT																												" ).append("\n"); 
		query.append("							,	INV_DESC																															" ).append("\n"); 
		query.append("							,	''                 	INV_TAX_CD																							" ).append("\n"); 
		query.append("							,	'01'                DTRB_COA_CO_CD																						" ).append("\n"); 
		query.append("							,	DTRB_COA_RGN_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_CTR_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_ACCT_CD																													" ).append("\n"); 
		query.append("							,	DTRB_COA_VVD_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_INTER_CO_CD																												" ).append("\n"); 
		query.append("							,	'000000'                       			DTRB_COA_FTU_N1ST_CD																					" ).append("\n"); 
		query.append("							,	'000000'                       			DTRB_COA_FTU_N2ND_CD																					" ).append("\n"); 
		query.append("							,	ATTR_CATE_NM																														" ).append("\n"); 
		query.append("							,	ATTR_CTNT1																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT2																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT3																															" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT4																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT5																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT6																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT7																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT8																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT9																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT10																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT11																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT12																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT13																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT14																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT15																							" ).append("\n"); 
		query.append("							,	BKG_NO																																" ).append("\n"); 
		query.append("							,	CNTR_TPSZ_CD																														" ).append("\n"); 
		query.append("							,	ACT_VVD_CD																															" ).append("\n"); 
		query.append("							,	'C'                            			PLN_SCTR_DIV_CD																						" ).append("\n"); 
		query.append("							,	NULL                           			SO_CRR_CD																							" ).append("\n"); 
		query.append("							,	NULL                           			YD_CD																								" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT1																														" ).append("\n"); 
		query.append("							,	TO_CHAR(COUNT(*))      					FTU_USE_CTNT2																								" ).append("\n"); 
		query.append("							,	NULL                           			FTU_USE_CTNT3																						" ).append("\n"); 
		query.append("							,	NULL                           			FTU_USE_CTNT4																						" ).append("\n"); 
		query.append("							,	NULL                           			FTU_USE_CNTR5																						" ).append("\n"); 
		query.append("							,	SYSDATE                        			CRE_DT																								" ).append("\n"); 
		query.append("							,	@[CRE_USR_ID]                   		   			CRE_USR_ID																							" ).append("\n"); 
		query.append("							,	''                             			EAI_EVNT_DT                                                                  						" ).append("\n"); 
		query.append("							,	TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("							,	TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("							,	TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("							,	NULL									REF_BKG_NO																							" ).append("\n"); 
		query.append("							,	NULL									CGO_TP_CD																					" ).append("\n"); 
		query.append("							,	NULL									EQ_KND_CD																					" ).append("\n"); 
		query.append("					FROM        (                                                                                                               					" ).append("\n"); 
		query.append("								SELECT		NVL(INV_DTL.INV_BZC_AMT,0)-NVL(INV_DTL.FUEL_SCG_AMT,0)				CSR_AMT											" ).append("\n"); 
		query.append("										,	ACCT_NM.ACCT_ENG_NM           			INV_DESC																					" ).append("\n"); 
		query.append("										,	FINC_RGN_CD                    			DTRB_COA_RGN_CD																			" ).append("\n"); 
		query.append("										,	AP_CTR_CD                      			DTRB_COA_CTR_CD																			" ).append("\n"); 
		query.append("										,	INV_DTL.ACCT_CD                			DTRB_COA_ACCT_CD																			" ).append("\n"); 
		query.append("										,	INV_DTL.FINC_VVD_CD						DTRB_COA_VVD_CD																								" ).append("\n"); 
		query.append("										,	NVL(SUBS_CO_CD,'00')           			DTRB_COA_INTER_CO_CD																		" ).append("\n"); 
		query.append("										,	INV_DTL.ACCT_CD                			ATTR_CATE_NM																				" ).append("\n"); 
		query.append("										,	INV_WRK.INV_NO                 			ATTR_CTNT1																				" ).append("\n"); 
		query.append("										,	TO_CHAR(INV_WRK.INV_ISS_DT,'YYYYMMDD')  ATTR_CTNT2															" ).append("\n"); 
		query.append("										,	MDM_ORG.LOC_CD 							ATTR_CTNT3																	" ).append("\n"); 
		query.append("										,	SVC_ORD.ORG_BKG_NO                 		BKG_NO																					" ).append("\n"); 
		query.append("										,	SVC_ORD.EQ_TPSZ_CD             			CNTR_TPSZ_CD																				" ).append("\n"); 
		query.append("										,	INV_DTL.FINC_VVD_CD						ACT_VVD_CD																									" ).append("\n"); 
		query.append("										,	INV_DTL.LGS_COST_CD            			FTU_USE_CTNT1                                                                			" ).append("\n"); 
		query.append("										,	'R'										TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("										,	INV_DTL.TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("										,	INV_DTL.TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("								FROM		TRS_TRSP_RAIL_INV_WRK 			INV_WRK																							" ).append("\n"); 
		query.append("										,	TRS_TRSP_RAIL_INV_DTL 			INV_DTL																							" ).append("\n"); 
		query.append("										,	MDM_ACCOUNT						ACCT_NM																										" ).append("\n"); 
		query.append("										,	MDM_ORGANIZATION  				MDM_ORG																								" ).append("\n"); 
		query.append("										,	MDM_VENDOR 						MDM_VNDR																										" ).append("\n"); 
		query.append("										,	TRS_TRSP_RAIL_BIL_ORD			SVC_ORD                                                                                                                     " ).append("\n"); 
		query.append("								WHERE		INV_WRK.INV_NO					= INV_DTL.INV_NO                                                                                    " ).append("\n"); 
		query.append("											AND			INV_WRK.INV_VNDR_SEQ			= INV_DTL.INV_VNDR_SEQ                                                                              " ).append("\n"); 
		query.append("											AND     	INV_DTL.ACCT_CD					= ACCT_NM.ACCT_CD                                                                                   " ).append("\n"); 
		query.append("											AND			MDM_ORG.OFC_CD					= @[COST_OFC_CD]" ).append("\n"); 
		query.append("											AND     	INV_DTL.INV_VNDR_SEQ    		= MDM_VNDR.VNDR_SEQ		                                                                            " ).append("\n"); 
		query.append("											AND     	INV_DTL.TRSP_SO_OFC_CTY_CD  	= SVC_ORD.TRSP_SO_OFC_CTY_CD(+)                                                                     " ).append("\n"); 
		query.append("											AND     	INV_DTL.TRSP_SO_SEQ         	= SVC_ORD.TRSP_SO_SEQ       (+)		                                                                " ).append("\n"); 
		query.append("											AND			INV_WRK.INV_NO					= @[INV_NO]" ).append("\n"); 
		query.append("											AND			INV_WRK.INV_VNDR_SEQ			= @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("											AND			TRSP_INV_AUD_STS_CD				= @[TRSP_INV_AUD_STS_CD]" ).append("\n"); 
		query.append("											AND			NVL(INV_WRK.INV_HLD_FLG,'N')    = 'N'                                                               					" ).append("\n"); 
		query.append("											AND			INV_WRK.DELT_FLG				= 'N'                                                                         					" ).append("\n"); 
		query.append("											AND     	INV_DTL.PAY_FLG         		= 'Y'																									" ).append("\n"); 
		query.append("								)                                                                                                               					" ).append("\n"); 
		query.append("					GROUP BY	INV_DESC																															" ).append("\n"); 
		query.append("							,	DTRB_COA_RGN_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_CTR_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_ACCT_CD																													" ).append("\n"); 
		query.append("							,	DTRB_COA_VVD_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_INTER_CO_CD																												" ).append("\n"); 
		query.append("							,	ATTR_CATE_NM																														" ).append("\n"); 
		query.append("							,	ATTR_CTNT1																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT2																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT3																															" ).append("\n"); 
		query.append("							,	BKG_NO																																" ).append("\n"); 
		query.append("							,	CNTR_TPSZ_CD																														" ).append("\n"); 
		query.append("							,	ACT_VVD_CD																															" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT1                                                                                               						" ).append("\n"); 
		query.append("						    , 	TRSP_SO_TP_CD                                                               " ).append("\n"); 
		query.append("						    , 	TRSP_SO_OFC_CTY_CD                                                          " ).append("\n"); 
		query.append("						    , 	TRSP_SO_SEQ                                                                 " ).append("\n"); 
		query.append("					UNION ALL                                                     																					" ).append("\n"); 
		query.append("					SELECT		CSR_NO																																" ).append("\n"); 
		query.append("							,	LINE_SEQ																															" ).append("\n"); 
		query.append("							,	LINE_NO																																" ).append("\n"); 
		query.append("							,	LINE_TP_LU_CD																														" ).append("\n"); 
		query.append("							,	CSR_AMT																																" ).append("\n"); 
		query.append("							,	INV_DESC																															" ).append("\n"); 
		query.append("							,	INV_TAX_CD																															" ).append("\n"); 
		query.append("							,	DTRB_COA_CO_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_RGN_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_CTR_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_ACCT_CD																													" ).append("\n"); 
		query.append("							,	DTRB_COA_VVD_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_INTER_CO_CD																												" ).append("\n"); 
		query.append("							,	DTRB_COA_FTU_N1ST_CD																												" ).append("\n"); 
		query.append("							,	DTRB_COA_FTU_N2ND_CD																												" ).append("\n"); 
		query.append("							,	ATTR_CATE_NM																														" ).append("\n"); 
		query.append("							,	ATTR_CTNT1																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT2																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT3																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT4																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT5																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT6																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT7																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT8																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT9																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT10																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT11																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT12																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT13																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT14																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT15																															" ).append("\n"); 
		query.append("							,	BKG_NO																																" ).append("\n"); 
		query.append("							,	CNTR_TPSZ_CD																														" ).append("\n"); 
		query.append("							,	ACT_VVD_CD																															" ).append("\n"); 
		query.append("							,	PLN_SCTR_DIV_CD																														" ).append("\n"); 
		query.append("							,	SO_CRR_CD																															" ).append("\n"); 
		query.append("							,	YD_CD																																" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT1																														" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT2																														" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT3																														" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT4																														" ).append("\n"); 
		query.append("							,	FTU_USE_CNTR5																														" ).append("\n"); 
		query.append("							,	CRE_DT																																" ).append("\n"); 
		query.append("							,	CRE_USR_ID																															" ).append("\n"); 
		query.append("							,	EAI_EVNT_DT              																											" ).append("\n"); 
		query.append("							,	TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("							,	TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("							,	TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("							,	NULL									REF_BKG_NO																							" ).append("\n"); 
		query.append("							,	NULL									CGO_TP_CD																					" ).append("\n"); 
		query.append("							,	NULL									EQ_KND_CD																					" ).append("\n"); 
		query.append("					FROM		(             		                                               																	" ).append("\n"); 
		query.append("								SELECT 		@[CSR_NO]           					CSR_NO																									" ).append("\n"); 
		query.append("										,	'4'           							LINE_SEQ																								" ).append("\n"); 
		query.append("										,	@[LINE_NO]            					LINE_NO																									" ).append("\n"); 
		query.append("										,	'ITEM'               					LINE_TP_LU_CD" ).append("\n"); 
		query.append("										,	INV_WRK.INV_VAT_AMT               		CSR_AMT																				" ).append("\n"); 
		query.append("										,	SVC_ORD.INV_NO     				  		INV_DESC																				" ).append("\n"); 
		query.append("										,	''       								INV_TAX_CD																										" ).append("\n"); 
		query.append("										,	'01'                             		DTRB_COA_CO_CD																			" ).append("\n"); 
		query.append("										,	FINC_RGN_CD                      		DTRB_COA_RGN_CD																		" ).append("\n"); 
		query.append("										,	AP_CTR_CD                        		DTRB_COA_CTR_CD																		" ).append("\n"); 
		query.append("										,	'111821'          				 		DTRB_COA_ACCT_CD																		" ).append("\n"); 
		query.append("										,	'0000000000'                     		DTRB_COA_VVD_CD																		" ).append("\n"); 
		query.append("										,	NVL(SUBS_CO_CD,'00')             		DTRB_COA_INTER_CO_CD																	" ).append("\n"); 
		query.append("										,	'000000'                         		DTRB_COA_FTU_N1ST_CD																	" ).append("\n"); 
		query.append("										,	'000000'                         		DTRB_COA_FTU_N2ND_CD																	" ).append("\n"); 
		query.append("										,	'111821'          						ATTR_CATE_NM																									" ).append("\n"); 
		query.append("										,	SVC_ORD.INV_NO                   		ATTR_CTNT1																				" ).append("\n"); 
		query.append("										,	TO_CHAR(INV_WRK.INV_ISS_DT,'YYYYMMDD')	ATTR_CTNT2															" ).append("\n"); 
		query.append("										,	MDM_ORG.LOC_CD                			ATTR_CTNT3																				" ).append("\n"); 
		query.append("										,	NULL                           			ATTR_CTNT4																				" ).append("\n"); 
		query.append("										,	NULL                           			ATTR_CTNT5																				" ).append("\n"); 
		query.append("										,	NULL                           			ATTR_CTNT6                      															" ).append("\n"); 
		query.append("										,	NULL                           			ATTR_CTNT7																				" ).append("\n"); 
		query.append("										,	NULL                           			ATTR_CTNT8																				" ).append("\n"); 
		query.append("										,	NULL                           			ATTR_CTNT9																				" ).append("\n"); 
		query.append("										,	NULL                           			ATTR_CTNT10																				" ).append("\n"); 
		query.append("										,	NULL                           			ATTR_CTNT11																				" ).append("\n"); 
		query.append("										,	NULL                           			ATTR_CTNT12																				" ).append("\n"); 
		query.append("										,	NULL                           			ATTR_CTNT13																				" ).append("\n"); 
		query.append("										,	INV_WRK.AP_RVS_CNG_FLG                  ATTR_CTNT14																				" ).append("\n"); 
		query.append("										,	NULL                           			ATTR_CTNT15																				" ).append("\n"); 
		query.append("										,	NULL                           			BKG_NO																					" ).append("\n"); 
		query.append("										,	NULL                           			CNTR_TPSZ_CD																				" ).append("\n"); 
		query.append("										,	NULL                           			ACT_VVD_CD																				" ).append("\n"); 
		query.append("										,	NULL                           			PLN_SCTR_DIV_CD																			" ).append("\n"); 
		query.append("										,	NULL                           			SO_CRR_CD																				" ).append("\n"); 
		query.append("										,	NULL                           			YD_CD																					" ).append("\n"); 
		query.append("										,	NULL                           			FTU_USE_CTNT1																			" ).append("\n"); 
		query.append("										,	NULL                           			FTU_USE_CTNT2																			" ).append("\n"); 
		query.append("										,	NULL                           			FTU_USE_CTNT3																			" ).append("\n"); 
		query.append("										,	NULL                           			FTU_USE_CTNT4																			" ).append("\n"); 
		query.append("										,	NULL                           			FTU_USE_CNTR5																			" ).append("\n"); 
		query.append("										,	SYSDATE                        			CRE_DT																					" ).append("\n"); 
		query.append("										,	@[CRE_USR_ID]                  			CRE_USR_ID																				" ).append("\n"); 
		query.append("										,	''                             			EAI_EVNT_DT                      														" ).append("\n"); 
		query.append("										,	NULL	TRSP_SO_TP_CD																					 						" ).append("\n"); 
		query.append("										,	NULL	TRSP_SO_OFC_CTY_CD																										" ).append("\n"); 
		query.append("										,	-1		TRSP_SO_SEQ																												" ).append("\n"); 
		query.append("								FROM		TRS_TRSP_INV_WRK						INV_WRK																					" ).append("\n"); 
		query.append("										,	MDM_ACCOUNT								ACCT_NM																					" ).append("\n"); 
		query.append("										,	TRS_TRSP_SVC_ORD						SVC_ORD																					" ).append("\n"); 
		query.append("										,	MDM_ORGANIZATION						MDM_ORG																					" ).append("\n"); 
		query.append("										,	MDM_VENDOR								MDM_VNDR                                             									" ).append("\n"); 
		query.append("								WHERE		ACCT_NM.ACCT_CD							= SVC_ORD.ACCT_CD                 														" ).append("\n"); 
		query.append("										AND			INV_WRK.INV_NO							= SVC_ORD.INV_NO                      													" ).append("\n"); 
		query.append("										AND			INV_WRK.INV_VNDR_SEQ					= SVC_ORD.INV_VNDR_SEQ                													" ).append("\n"); 
		query.append("										AND			MDM_ORG.OFC_CD							= @[COST_OFC_CD]" ).append("\n"); 
		query.append("										AND			MDM_VNDR.VNDR_SEQ						= SVC_ORD.INV_VNDR_SEQ                													" ).append("\n"); 
		query.append("										AND			INV_WRK.INV_NO							= @[INV_NO]" ).append("\n"); 
		query.append("										AND			INV_WRK.INV_VNDR_SEQ					= @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("										AND			TRSP_INV_AUD_STS_CD						= @[TRSP_INV_AUD_STS_CD]" ).append("\n"); 
		query.append("										AND			NVL(SVC_ORD.DELT_FLG,'N')   			= 'N'                              														" ).append("\n"); 
		query.append("										AND			NVL(INV_HLD_FLG,'N')    				= 'N'                         															" ).append("\n"); 
		query.append("										AND			INV_WRK.DELT_FLG        				= 'N'                             														" ).append("\n"); 
		query.append("										AND			'KR'									<>  NVL(@[CNT_CD], ' ')                              											" ).append("\n"); 
		query.append("								GROUP BY    FINC_RGN_CD																														" ).append("\n"); 
		query.append("										,	INV_WRK.INV_VAT_AMT																												" ).append("\n"); 
		query.append("										,	AP_CTR_CD																														" ).append("\n"); 
		query.append("										,	NVL(SUBS_CO_CD,'00')																											" ).append("\n"); 
		query.append("										,	SVC_ORD.INV_NO																													" ).append("\n"); 
		query.append("										,	TO_CHAR(INV_WRK.INV_ISS_DT, 'YYYYMMDD')																							" ).append("\n"); 
		query.append("										,	MDM_ORG.LOC_CD" ).append("\n"); 
		query.append("										,	INV_WRK.AP_RVS_CNG_FLG                                                 																	" ).append("\n"); 
		query.append("								UNION ALL                                                     																				" ).append("\n"); 
		query.append("								SELECT 		@[CSR_NO]           						CSR_NO																				" ).append("\n"); 
		query.append("										,	'5'           								LINE_SEQ																			" ).append("\n"); 
		query.append("										,	@[LINE_NO]            						LINE_NO																				" ).append("\n"); 
		query.append("										,	'ITEM'										LINE_TP_LU_CD																		" ).append("\n"); 
		query.append("										,	INV_WRK.INV_WHLD_TAX_AMT*(-1)       		CSR_AMT																				" ).append("\n"); 
		query.append("										,	'CFHOLDING TAX'    							INV_DESC																			" ).append("\n"); 
		query.append("										,	''											INV_TAX_CD																			" ).append("\n"); 
		query.append("										,	'01'										DTRB_COA_CO_CD																		" ).append("\n"); 
		query.append("										,	FINC_RGN_CD									DTRB_COA_RGN_CD																		" ).append("\n"); 
		query.append("										,	AP_CTR_CD									DTRB_COA_CTR_CD																		" ).append("\n"); 
		query.append("										,	'211691'									DTRB_COA_ACCT_CD																	" ).append("\n"); 
		query.append("										,	'0000000000'								DTRB_COA_VVD_CD																		" ).append("\n"); 
		query.append("										,	NVL(SUBS_CO_CD,'00')						DTRB_COA_INTER_CO_CD																" ).append("\n"); 
		query.append("										,	'000000'									DTRB_COA_FTU_N1ST_CD																" ).append("\n"); 
		query.append("										,	'000000'									DTRB_COA_FTU_N2ND_CD																" ).append("\n"); 
		query.append("										,	'211691'									ATTR_CATE_NM																		" ).append("\n"); 
		query.append("										,	SVC_ORD.INV_NO								ATTR_CTNT1																			" ).append("\n"); 
		query.append("										,	TO_CHAR(INV_WRK.INV_ISS_DT, 'YYYYMMDD')     ATTR_CTNT2																			" ).append("\n"); 
		query.append("										,	MDM_ORG.LOC_CD								ATTR_CTNT3                      													" ).append("\n"); 
		query.append("										,	NULL										ATTR_CTNT4																			" ).append("\n"); 
		query.append("										,	NULL										ATTR_CTNT5																			" ).append("\n"); 
		query.append("										,	NULL										ATTR_CTNT6                      													" ).append("\n"); 
		query.append("										,	NULL										ATTR_CTNT7																				" ).append("\n"); 
		query.append("										,	NULL   										ATTR_CTNT8																				" ).append("\n"); 
		query.append("										,	NULL										ATTR_CTNT9																				" ).append("\n"); 
		query.append("										,	NULL										ATTR_CTNT10																				" ).append("\n"); 
		query.append("										,	NULL										ATTR_CTNT11																				" ).append("\n"); 
		query.append("										,	NULL										ATTR_CTNT12																				" ).append("\n"); 
		query.append("										,	NULL										ATTR_CTNT13																				" ).append("\n"); 
		query.append("										,	INV_WRK.AP_RVS_CNG_FLG						ATTR_CTNT14																				" ).append("\n"); 
		query.append("										,	NULL										ATTR_CTNT15																				" ).append("\n"); 
		query.append("										,	NULL										BKG_NO																					" ).append("\n"); 
		query.append("										,	NULL										CNTR_TPSZ_CD																				" ).append("\n"); 
		query.append("										,	NULL										ACT_VVD_CD																				" ).append("\n"); 
		query.append("										,	NULL										PLN_SCTR_DIV_CD																			" ).append("\n"); 
		query.append("										,	NULL										SO_CRR_CD																				" ).append("\n"); 
		query.append("										,	NULL										YD_CD																					" ).append("\n"); 
		query.append("										,	NULL										FTU_USE_CTNT1																			" ).append("\n"); 
		query.append("										,	NULL										FTU_USE_CTNT2																			" ).append("\n"); 
		query.append("										,	NULL										FTU_USE_CTNT3																			" ).append("\n"); 
		query.append("										,	NULL										FTU_USE_CTNT4																			" ).append("\n"); 
		query.append("										,	NULL										FTU_USE_CNTR5																			" ).append("\n"); 
		query.append("										,	SYSDATE										CRE_DT																					" ).append("\n"); 
		query.append("										,	@[CRE_USR_ID]         						CRE_USR_ID																				" ).append("\n"); 
		query.append("										,	''											EAI_EVNT_DT                      														" ).append("\n"); 
		query.append("										,	NULL	TRSP_SO_TP_CD																					 						" ).append("\n"); 
		query.append("										,	NULL	TRSP_SO_OFC_CTY_CD																										" ).append("\n"); 
		query.append("										,	-2		TRSP_SO_SEQ																												" ).append("\n"); 
		query.append("								FROM		TRS_TRSP_INV_WRK							INV_WRK																								" ).append("\n"); 
		query.append("										,	MDM_ACCOUNT									ACCT_NM																								" ).append("\n"); 
		query.append("										,	TRS_TRSP_SVC_ORD							SVC_ORD																								" ).append("\n"); 
		query.append("										,	MDM_ORGANIZATION							MDM_ORG																								" ).append("\n"); 
		query.append("										,	MDM_VENDOR									MDM_VNDR                                                 													" ).append("\n"); 
		query.append("								WHERE		ACCT_NM.ACCT_CD      						= SVC_ORD.ACCT_CD                 																	" ).append("\n"); 
		query.append("											AND			INV_WRK.INV_NO       						= SVC_ORD.INV_NO                      																" ).append("\n"); 
		query.append("											AND			INV_WRK.INV_VNDR_SEQ 						= SVC_ORD.INV_VNDR_SEQ                																" ).append("\n"); 
		query.append("											AND			MDM_ORG.OFC_CD       						= @[COST_OFC_CD]" ).append("\n"); 
		query.append("											AND			MDM_VNDR.VNDR_SEQ    						= SVC_ORD.INV_VNDR_SEQ                																" ).append("\n"); 
		query.append("											AND			INV_WRK.INV_NO       						= @[INV_NO]" ).append("\n"); 
		query.append("											AND			INV_WRK.INV_VNDR_SEQ 						= @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("											AND			TRSP_INV_AUD_STS_CD  						= @[TRSP_INV_AUD_STS_CD]" ).append("\n"); 
		query.append("											AND			NVL(SVC_ORD.DELT_FLG,'N')   				= 'N'                              																	" ).append("\n"); 
		query.append("											AND			NVL(INV_HLD_FLG,'N') 						= 'N'                         																" ).append("\n"); 
		query.append("											AND			INV_WRK.DELT_FLG    						= 'N'                             																" ).append("\n"); 
		query.append("								GROUP BY    FINC_RGN_CD																												" ).append("\n"); 
		query.append("										,	INV_WRK.INV_WHLD_TAX_AMT																								" ).append("\n"); 
		query.append("										,	AP_CTR_CD																												" ).append("\n"); 
		query.append("										,	NVL(SUBS_CO_CD,'00')																									" ).append("\n"); 
		query.append("										,	SVC_ORD.INV_NO																											" ).append("\n"); 
		query.append("										,	TO_CHAR(INV_WRK.INV_ISS_DT,'YYYYMMDD')																					" ).append("\n"); 
		query.append("										,	MDM_ORG.LOC_CD " ).append("\n"); 
		query.append("										,	INV_WRK.AP_RVS_CNG_FLG                                                															" ).append("\n"); 
		query.append("								) A																																	" ).append("\n"); 
		query.append("	WHERE	CSR_AMT <> 0																																			" ).append("\n"); 
		query.append("	UNION ALL                                                             																							" ).append("\n"); 
		query.append("	SELECT		CSR_NO																																				" ).append("\n"); 
		query.append("			,	LINE_SEQ																																			" ).append("\n"); 
		query.append("			,	LINE_NO																																				" ).append("\n"); 
		query.append("			,	LINE_TP_LU_CD																																		" ).append("\n"); 
		query.append("			,	CSR_AMT																																				" ).append("\n"); 
		query.append("			,	INV_DESC																																			" ).append("\n"); 
		query.append("			,	INV_TAX_CD																																			" ).append("\n"); 
		query.append("			,	DTRB_COA_CO_CD																																		" ).append("\n"); 
		query.append("			,	DTRB_COA_RGN_CD																																		" ).append("\n"); 
		query.append("			,	DTRB_COA_CTR_CD																																		" ).append("\n"); 
		query.append("			,	DTRB_COA_ACCT_CD																																	" ).append("\n"); 
		query.append("			,	DTRB_COA_VVD_CD																																		" ).append("\n"); 
		query.append("			,	DTRB_COA_INTER_CO_CD																																" ).append("\n"); 
		query.append("			,	DTRB_COA_FTU_N1ST_CD																																" ).append("\n"); 
		query.append("			,	DTRB_COA_FTU_N2ND_CD																																" ).append("\n"); 
		query.append("			,	ATTR_CATE_NM																																		" ).append("\n"); 
		query.append("			,	ATTR_CTNT1																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT2																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT3																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT4																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT5																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT6																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT7																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT8																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT9																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT10																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT11																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT12																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT13																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT14																																			" ).append("\n"); 
		query.append("			,	ATTR_CTNT15																																			" ).append("\n"); 
		query.append("			,	BKG_NO																																				" ).append("\n"); 
		query.append("			,	CNTR_TPSZ_CD																																		" ).append("\n"); 
		query.append("			,	ACT_VVD_CD																																			" ).append("\n"); 
		query.append("			,	PLN_SCTR_DIV_CD																																		" ).append("\n"); 
		query.append("			,	SO_CRR_CD																																			" ).append("\n"); 
		query.append("			,	YD_CD																																				" ).append("\n"); 
		query.append("			,	FTU_USE_CTNT1																																		" ).append("\n"); 
		query.append("			,	FTU_USE_CTNT2																																		" ).append("\n"); 
		query.append("			,	FTU_USE_CTNT3																																		" ).append("\n"); 
		query.append("			,	FTU_USE_CTNT4																																		" ).append("\n"); 
		query.append("			,	FTU_USE_CNTR5																																		" ).append("\n"); 
		query.append("			,	CRE_DT																																				" ).append("\n"); 
		query.append("			,	CRE_USR_ID																																			" ).append("\n"); 
		query.append("			,	EAI_EVNT_DT              																															" ).append("\n"); 
		query.append("			,	TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("			,	TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("			,	TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("			,	NULL									REF_BKG_NO																							" ).append("\n"); 
		query.append("			,	NULL									CGO_TP_CD																					" ).append("\n"); 
		query.append("			,	NULL									EQ_KND_CD																					" ).append("\n"); 
		query.append("		FROM	(                                                                   																				" ).append("\n"); 
		query.append("				SELECT		@[CSR_NO]           						CSR_NO																													" ).append("\n"); 
		query.append("						,	'7'           								LINE_SEQ																												" ).append("\n"); 
		query.append("						,	@[LINE_NO]            						LINE_NO																													" ).append("\n"); 
		query.append("						,	'ITEM'            							LINE_TP_LU_CD																											" ).append("\n"); 
		query.append("						,	INV_WRK.INV_VAT_AMT         				CSR_AMT																										" ).append("\n"); 
		query.append("						,	INV_WRK.INV_NO			    				INV_DESC																									" ).append("\n"); 
		query.append("						,	''                               			INV_TAX_CD																								" ).append("\n"); 
		query.append("						,	'01'                             			DTRB_COA_CO_CD																							" ).append("\n"); 
		query.append("						,	MDM_ORG.FINC_RGN_CD                			DTRB_COA_RGN_CD																						" ).append("\n"); 
		query.append("						,	MDM_ORG.AP_CTR_CD                  			DTRB_COA_CTR_CD																						" ).append("\n"); 
		query.append("						,	'111821'                         			DTRB_COA_ACCT_CD																						" ).append("\n"); 
		query.append("						,	'0000000000'                     			DTRB_COA_VVD_CD																						" ).append("\n"); 
		query.append("						,	NVL(MDM_VNDR.SUBS_CO_CD,'00')       		DTRB_COA_INTER_CO_CD																					" ).append("\n"); 
		query.append("						,	'000000'                         			DTRB_COA_FTU_N1ST_CD																					" ).append("\n"); 
		query.append("						,	'000000'                         			DTRB_COA_FTU_N2ND_CD																					" ).append("\n"); 
		query.append("						,	'111821'						 			ATTR_CATE_NM																							" ).append("\n"); 
		query.append("						,	INV_WRK.INV_NO                 				ATTR_CTNT1																								" ).append("\n"); 
		query.append("						,	TO_CHAR(INV_WRK.INV_ISS_DT,'YYYYMMDD')      ATTR_CTNT2																			" ).append("\n"); 
		query.append("						,	MDM_ORG.LOC_CD                				ATTR_CTNT3																								" ).append("\n"); 
		query.append("						,	NULL                           				ATTR_CTNT4																								" ).append("\n"); 
		query.append("						,	NULL                           				ATTR_CTNT5																								" ).append("\n"); 
		query.append("						,	NULL                           				ATTR_CTNT6																								" ).append("\n"); 
		query.append("						,	NULL                           				ATTR_CTNT7																								" ).append("\n"); 
		query.append("						,	NULL                           				ATTR_CTNT8																								" ).append("\n"); 
		query.append("						,	NULL                           				ATTR_CTNT9																								" ).append("\n"); 
		query.append("						,	NULL                           				ATTR_CTNT10																								" ).append("\n"); 
		query.append("						,	NULL                           				ATTR_CTNT11																								" ).append("\n"); 
		query.append("						,	NULL                           				ATTR_CTNT12																								" ).append("\n"); 
		query.append("						,	NULL                           				ATTR_CTNT13																								" ).append("\n"); 
		query.append("						,	NULL                           				ATTR_CTNT14																								" ).append("\n"); 
		query.append("						,	NULL                           				ATTR_CTNT15																								" ).append("\n"); 
		query.append("						,	NULL                           				BKG_NO																									" ).append("\n"); 
		query.append("						,	NULL                           				CNTR_TPSZ_CD																								" ).append("\n"); 
		query.append("						,	NULL                           				ACT_VVD_CD																								" ).append("\n"); 
		query.append("						,	NULL                           				PLN_SCTR_DIV_CD																							" ).append("\n"); 
		query.append("						,	NULL                           				SO_CRR_CD																								" ).append("\n"); 
		query.append("						,	NULL                           				YD_CD																									" ).append("\n"); 
		query.append("						,	NULL                           				FTU_USE_CTNT1																							" ).append("\n"); 
		query.append("						,	NULL                           				FTU_USE_CTNT2																							" ).append("\n"); 
		query.append("						,	NULL                           				FTU_USE_CTNT3																							" ).append("\n"); 
		query.append("						,	NULL                           				FTU_USE_CTNT4																							" ).append("\n"); 
		query.append("						,	NULL                           				FTU_USE_CNTR5																							" ).append("\n"); 
		query.append("						,	SYSDATE                        				CRE_DT																									" ).append("\n"); 
		query.append("						,	@[CRE_USR_ID]                  				CRE_USR_ID																								" ).append("\n"); 
		query.append("						,	''                             				EAI_EVNT_DT                                                                  							" ).append("\n"); 
		query.append("						,	'R'											TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("						,	NULL										TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("						,	-3											TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("				FROM		TRS_TRSP_RAIL_INV_WRK 						INV_WRK																											" ).append("\n"); 
		query.append("						,	MDM_ORGANIZATION  							MDM_ORG																												" ).append("\n"); 
		query.append("						,	MDM_VENDOR 									MDM_VNDR																														" ).append("\n"); 
		query.append("				WHERE		1 = 1             																				" ).append("\n"); 
		query.append("				AND			MDM_ORG.OFC_CD             					= @[COST_OFC_CD]" ).append("\n"); 
		query.append("				AND			MDM_VNDR.VNDR_SEQ          					= INV_WRK.INV_VNDR_SEQ         																				" ).append("\n"); 
		query.append("				AND			INV_WRK.INV_NO       						= @[INV_NO]" ).append("\n"); 
		query.append("				AND			INV_WRK.INV_VNDR_SEQ 						= @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("				AND			TRSP_INV_AUD_STS_CD  						= @[TRSP_INV_AUD_STS_CD]" ).append("\n"); 
		query.append("				AND			NVL(INV_HLD_FLG,'N')      					= 'N'         																								" ).append("\n"); 
		query.append("				AND			INV_WRK.DELT_FLG          					= 'N'                             																			" ).append("\n"); 
		query.append("				)																																					" ).append("\n"); 
		query.append("		WHERE	CSR_AMT <> 0	                                            																						" ).append("\n"); 
		query.append("		UNION ALL                                             																										" ).append("\n"); 
		query.append("		SELECT		@[CSR_NO]           						CSR_NO																															" ).append("\n"); 
		query.append("				,	'8'           								LINE_SEQ																														" ).append("\n"); 
		query.append("				,	@[LINE_NO]           						LINE_NO																															" ).append("\n"); 
		query.append("				,	'ITEM'                						LINE_TP_LU_CD																											" ).append("\n"); 
		query.append("				,	CASE	WHEN @[CURR_CD] IN ('KRW','JPY','TWD') THEN ROUND(NVL(SVC_ORD.AMT,0)) 																					" ).append("\n"); 
		query.append("				ELSE	ROUND(NVL(SVC_ORD.AMT,0)  , 2 )																											" ).append("\n"); 
		query.append("					END		CSR_AMT																																	" ).append("\n"); 
		query.append("				,	ACCT_NM.ACCT_ENG_NM     					INV_DESC																												" ).append("\n"); 
		query.append("				,	''    										INV_TAX_CD																																" ).append("\n"); 
		query.append("				,	'01'                    					DTRB_COA_CO_CD																											" ).append("\n"); 
		query.append("				,	FINC_RGN_CD             					DTRB_COA_RGN_CD																											" ).append("\n"); 
		query.append("				,	AP_CTR_CD               					DTRB_COA_CTR_CD																											" ).append("\n"); 
		query.append("				,	SVC_ORD.ACCT_CD         					DTRB_COA_ACCT_CD																										" ).append("\n"); 
		query.append("				,	'CNTC'||SVC_ORD.ACT_RFND_MONTH||'MM' 		DTRB_COA_VVD_CD																										" ).append("\n"); 
		query.append("				,	NVL(SUBS_CO_CD,'00')    					DTRB_COA_INTER_CO_CD																									" ).append("\n"); 
		query.append("				,	'000000'                					DTRB_COA_FTU_N1ST_CD																									" ).append("\n"); 
		query.append("				,	'000000'                					DTRB_COA_FTU_N2ND_CD																									" ).append("\n"); 
		query.append("				,	SVC_ORD.ACCT_CD         					ATTR_CATE_NM																											" ).append("\n"); 
		query.append("				,	SVC_ORD.INV_NO          					ATTR_CTNT1																												" ).append("\n"); 
		query.append("				,	TO_CHAR(INV_WRK.INV_ISS_DT,'YYYYMMDD')      ATTR_CTNT2																							" ).append("\n"); 
		query.append("				,	(SELECT A.LOC_CD FROM MDM_ORGANIZATION A WHERE SVC_ORD.CRE_OFC_CD = A.OFC_CD) ATTR_CTNT3														" ).append("\n"); 
		query.append("				,	NULL                           				ATTR_CTNT4																										" ).append("\n"); 
		query.append("				,	NULL                           				ATTR_CTNT5																										" ).append("\n"); 
		query.append("				,	NULL                           				ATTR_CTNT6																										" ).append("\n"); 
		query.append("				,	NULL                           				ATTR_CTNT7																										" ).append("\n"); 
		query.append("				,	NULL                           				ATTR_CTNT8																										" ).append("\n"); 
		query.append("				,	NULL                           				ATTR_CTNT9																										" ).append("\n"); 
		query.append("				,	NULL                           				ATTR_CTNT10																										" ).append("\n"); 
		query.append("				,	NULL                           				ATTR_CTNT11																										" ).append("\n"); 
		query.append("				,	NULL                           				ATTR_CTNT12																										" ).append("\n"); 
		query.append("				,	NULL                           				ATTR_CTNT13																										" ).append("\n"); 
		query.append("				,	INV_WRK.AP_RVS_CNG_FLG                      ATTR_CTNT14																										" ).append("\n"); 
		query.append("				,	NULL                           				ATTR_CTNT15																										" ).append("\n"); 
		query.append("				,	''                             				BKG_NO																											" ).append("\n"); 
		query.append("				,	SVC_ORD.EQ_TPSZ_CD             				CNTR_TPSZ_CD																										" ).append("\n"); 
		query.append("				,	'CNTC'||SVC_ORD.ACT_RFND_MONTH||'MM'     	ACT_VVD_CD																										" ).append("\n"); 
		query.append("				,	'C'                            				PLN_SCTR_DIV_CD																									" ).append("\n"); 
		query.append("				,	NULL                           				SO_CRR_CD																										" ).append("\n"); 
		query.append("				,	NULL                           				YD_CD																											" ).append("\n"); 
		query.append("				,	SVC_ORD.LGS_COST_CD            				FTU_USE_CTNT1																									" ).append("\n"); 
		query.append("				,	TO_CHAR(SVC_ORD.ACT_RFND_MONTH)             FTU_USE_CTNT2																							" ).append("\n"); 
		query.append("				,	'C'                            				FTU_USE_CTNT3																									" ).append("\n"); 
		query.append("				,	NULL                           				FTU_USE_CTNT4																									" ).append("\n"); 
		query.append("				,	NULL                           				FTU_USE_CNTR5																									" ).append("\n"); 
		query.append("				,	SYSDATE                        				CRE_DT																											" ).append("\n"); 
		query.append("				,	@[CRE_USR_ID]                   			CRE_USR_ID																										" ).append("\n"); 
		query.append("				,	''                             				EAI_EVNT_DT              																						" ).append("\n"); 
		query.append("				,	'F'											TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("				,	NULL										TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("				,	-4											TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("				,	NULL										REF_BKG_NO																							" ).append("\n"); 
		query.append("				,	NULL										CGO_TP_CD																					" ).append("\n"); 
		query.append("				,	NULL										EQ_KND_CD																					" ).append("\n"); 
		query.append("		FROM		TRS_TRSP_INV_WRK 							INV_WRK              																						" ).append("\n"); 
		query.append("				,	MDM_ACCOUNT       							ACCT_NM																								" ).append("\n"); 
		query.append("				,																																					" ).append("\n"); 
		query.append("					(SELECT     RFND_MONTH" ).append("\n"); 
		query.append("                            ,   ACT_RFND_MONTH																																" ).append("\n"); 
		query.append("							,	CASE WHEN TRSP_COST_DTL_MOD_CD IN ('ER', 'CN', 'CF') THEN '512362' ELSE '512361' END ACCT_CD										" ).append("\n"); 
		query.append("							,	'TR'|| CASE WHEN TRSP_COST_DTL_MOD_CD IN ('ER', 'CN', 'CF') THEN 'MX' ELSE 'FX' END||DECODE(TRSP_CRR_MOD_CD, 'TR', 'RT', 'RW', 'WR', 'TW', 'WT', TRSP_CRR_MOD_CD) LGS_COST_CD	" ).append("\n"); 
		query.append("							,	INV_NO																																" ).append("\n"); 
		query.append("							,	INV_VNDR_SEQ																														" ).append("\n"); 
		query.append("							,	EQ_TPSZ_CD																															" ).append("\n"); 
		query.append("							,	SUM(TRSP_RFND_QTY) CNT																												" ).append("\n"); 
		query.append("							,	SUM(AMT) AMT																														" ).append("\n"); 
		query.append("							,	CRE_OFC_CD	                                                                                    									" ).append("\n"); 
		query.append("					FROM		(                                                                                                									" ).append("\n"); 
		query.append("								SELECT		RFND_MONTH" ).append("\n"); 
		query.append("                                        ,   ACT_RFND_MONTH																													" ).append("\n"); 
		query.append("										, 	HNDL_PRD_FM_DT																											" ).append("\n"); 
		query.append("										,	HNDL_PRD_TO_DT																											" ).append("\n"); 
		query.append("										,	INV_NO																													" ).append("\n"); 
		query.append("										,	INV_VNDR_SEQ																											" ).append("\n"); 
		query.append("										,	EQ_TPSZ_CD																												" ).append("\n"); 
		query.append("										,	TRSP_RFND_QTY																											" ).append("\n"); 
		query.append("										,	DECODE(BASIS_AXLE_NO, 0, AMT + NVL(CSR_RFND_CORR_AMT*(-1), 0), AMT) 	AMT												" ).append("\n"); 
		query.append("										,	CRE_OFC_CD																												" ).append("\n"); 
		query.append("										,	TRSP_COST_DTL_MOD_CD																									" ).append("\n"); 
		query.append("										,	TRSP_CRR_MOD_CD                         																				" ).append("\n"); 
		query.append("								FROM   (																															" ).append("\n"); 
		query.append("								SELECT		BASIS_AXLE_NO" ).append("\n"); 
		query.append("                                        ,   CASE WHEN TRSP_COST_DTL_MOD_CD IN ('ER', 'CN', 'CF') THEN SUBSTR((TRS_GET_GL_DT_FNC( '', @[AP_OFC_CD], @[INV_DT], '15')),3,4)" ).append("\n"); 
		query.append("										    	ELSE TO_CHAR(ADD_MONTHS(HNDL_PRD_FM_DT, BASIS_AXLE_NO),'YYMM')		" ).append("\n"); 
		query.append("                                            END RFND_MONTH																										" ).append("\n"); 
		query.append("										,	TO_CHAR(ADD_MONTHS(HNDL_PRD_FM_DT, BASIS_AXLE_NO), 'YYMM') 				ACT_RFND_MONTH											" ).append("\n"); 
		query.append("										,	HNDL_PRD_FM_DT																											" ).append("\n"); 
		query.append("										,	HNDL_PRD_TO_DT																											" ).append("\n"); 
		query.append("										,	INV_NO																													" ).append("\n"); 
		query.append("										,	INV_VNDR_SEQ																											" ).append("\n"); 
		query.append("										,	EQ_TPSZ_CD																												" ).append("\n"); 
		query.append("										,	TRSP_RFND_QTY																											" ).append("\n"); 
		query.append("										,	TRSP_RFND_INV_AMT/RFND_MON_KNT 		AMT					/* TRSP_RFND_INV_AMT < TRSP_RFND_UC_RT */						" ).append("\n"); 
		query.append("										, 	CSR_RFND_CORR_AMT																										" ).append("\n"); 
		query.append("										,	CRE_OFC_CD																												" ).append("\n"); 
		query.append("										,	TRSP_COST_DTL_MOD_CD																									" ).append("\n"); 
		query.append("										,	TRSP_CRR_MOD_CD                                                                                     					" ).append("\n"); 
		query.append("								FROM		(                                                                                                  						" ).append("\n"); 
		query.append("											SELECT		TO_NUMBER	(	CEIL(	MONTHS_BETWEEN	( 		TO_DATE(TO_CHAR(HNDL_PRD_TO_DT,'YYYYMM'), 'YYYYMM')			" ).append("\n"); 
		query.append("																									,	TO_DATE(TO_CHAR(HNDL_PRD_FM_DT,'YYYYMM'), 'YYYYMM')     	" ).append("\n"); 
		query.append("																								)     																" ).append("\n"); 
		query.append("																			)     																					" ).append("\n"); 
		query.append("																	) + 1 	RFND_MON_KNT																			" ).append("\n"); 
		query.append("													,	HNDL_PRD_FM_DT																								" ).append("\n"); 
		query.append("													,	HNDL_PRD_TO_DT																								" ).append("\n"); 
		query.append("													,	INV_NO																										" ).append("\n"); 
		query.append("													,	INV_VNDR_SEQ																								" ).append("\n"); 
		query.append("													,	EQ_TPSZ_CD																									" ).append("\n"); 
		query.append("													,	TRSP_RFND_QTY																								" ).append("\n"); 
		query.append("													,	TRSP_RFND_INV_AMT * (-1)	TRSP_RFND_INV_AMT	/* TRSP_RFND_INV_AMT < TRSP_RFND_UC_RT */					" ).append("\n"); 
		query.append("													, 	CSR_RFND_CORR_AMT																							" ).append("\n"); 
		query.append("													,	CRE_OFC_CD																									" ).append("\n"); 
		query.append("													,	TRSP_COST_DTL_MOD_CD																						" ).append("\n"); 
		query.append("													,	TRSP_CRR_MOD_CD 	  					                                                    				" ).append("\n"); 
		query.append("											FROM		TRS_TRSP_RFND_INV                                                                        					" ).append("\n"); 
		query.append("											WHERE		INV_NO			= @[INV_NO]                                                                      					" ).append("\n"); 
		query.append("											AND			INV_VNDR_SEQ	= @[INV_VNDR_SEQ] 																						" ).append("\n"); 
		query.append("											) REFD																													" ).append("\n"); 
		query.append("											,                                                                                         								" ).append("\n"); 
		query.append("											(																														" ).append("\n"); 
		query.append("											SELECT		CPY_NO 		BASIS_AXLE_NO																					" ).append("\n"); 
		query.append("											FROM		COM_CPY_NO																									" ).append("\n"); 
		query.append("											WHERE		CPY_NO < 50																									" ).append("\n"); 
		query.append("											) A                                          																			" ).append("\n"); 
		query.append("								WHERE		BASIS_AXLE_NO < RFND_MON_KNT                                                                               				" ).append("\n"); 
		query.append("								)																																	" ).append("\n"); 
		query.append("								) SVC_ORD                                                                                               							" ).append("\n"); 
		query.append("						GROUP BY	RFND_MONTH" ).append("\n"); 
		query.append("                                ,   ACT_RFND_MONTH																															" ).append("\n"); 
		query.append("								,	INV_NO																															" ).append("\n"); 
		query.append("								,	INV_VNDR_SEQ																													" ).append("\n"); 
		query.append("								,	EQ_TPSZ_CD																														" ).append("\n"); 
		query.append("								,	CRE_OFC_CD																														" ).append("\n"); 
		query.append("								,	TRSP_COST_DTL_MOD_CD																											" ).append("\n"); 
		query.append("								,	TRSP_CRR_MOD_CD																													" ).append("\n"); 
		query.append("						)	SVC_ORD                                                                               													" ).append("\n"); 
		query.append("					,	MDM_ORGANIZATION  MDM_ORG																													" ).append("\n"); 
		query.append("					,	MDM_VENDOR MDM_VNDR                                         																				" ).append("\n"); 
		query.append("			WHERE		ACCT_NM.ACCT_CD      	= SVC_ORD.ACCT_CD           																							" ).append("\n"); 
		query.append("						AND  		INV_WRK.INV_NO       	= SVC_ORD.INV_NO              																								" ).append("\n"); 
		query.append("						AND  		INV_WRK.INV_VNDR_SEQ 	= SVC_ORD.INV_VNDR_SEQ        																								" ).append("\n"); 
		query.append("						AND  		MDM_ORG.OFC_CD       	= @[COST_OFC_CD]" ).append("\n"); 
		query.append("						AND  		MDM_VNDR.VNDR_SEQ    	= SVC_ORD.INV_VNDR_SEQ        																								" ).append("\n"); 
		query.append("						AND  		INV_WRK.INV_NO       	= @[INV_NO]" ).append("\n"); 
		query.append("						AND  		INV_WRK.INV_VNDR_SEQ 	= @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("						AND  		TRSP_INV_AUD_STS_CD  	= @[TRSP_INV_AUD_STS_CD]" ).append("\n"); 
		query.append("						AND  		NVL(INV_HLD_FLG, 'N')   = 'N'                 																									" ).append("\n"); 
		query.append("						AND  		INV_WRK.DELT_FLG        = 'N'                     																								" ).append("\n"); 
		query.append("			UNION ALL 																																				" ).append("\n"); 
		query.append("			SELECT		CSR_NO																																		" ).append("\n"); 
		query.append("					,	LINE_SEQ																																	" ).append("\n"); 
		query.append("					,	LINE_NO																																		" ).append("\n"); 
		query.append("					,	LINE_TP_LU_CD																																" ).append("\n"); 
		query.append("					,	CSR_AMT																																		" ).append("\n"); 
		query.append("					,	INV_DESC																																	" ).append("\n"); 
		query.append("					,	INV_TAX_CD																																	" ).append("\n"); 
		query.append("					,	DTRB_COA_CO_CD																																" ).append("\n"); 
		query.append("					,	DTRB_COA_RGN_CD																																" ).append("\n"); 
		query.append("					,	DTRB_COA_CTR_CD																																" ).append("\n"); 
		query.append("					,	DTRB_COA_ACCT_CD																															" ).append("\n"); 
		query.append("					,	DTRB_COA_VVD_CD																																" ).append("\n"); 
		query.append("					,	DTRB_COA_INTER_CO_CD																														" ).append("\n"); 
		query.append("					,	DTRB_COA_FTU_N1ST_CD																														" ).append("\n"); 
		query.append("					,	DTRB_COA_FTU_N2ND_CD																														" ).append("\n"); 
		query.append("					,	ATTR_CATE_NM																																" ).append("\n"); 
		query.append("					,	ATTR_CTNT1																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT2																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT3																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT4																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT5																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT6																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT7																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT8																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT9																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT10																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT11																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT12																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT13																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT14																																	" ).append("\n"); 
		query.append("					,	ATTR_CTNT15																																	" ).append("\n"); 
		query.append("					,	BKG_NO																																		" ).append("\n"); 
		query.append("					,	CNTR_TPSZ_CD																																" ).append("\n"); 
		query.append("					,	ACT_VVD_CD																																	" ).append("\n"); 
		query.append("					,	PLN_SCTR_DIV_CD																																" ).append("\n"); 
		query.append("					,	SO_CRR_CD																																	" ).append("\n"); 
		query.append("					,	YD_CD																																		" ).append("\n"); 
		query.append("					,	FTU_USE_CTNT1																																" ).append("\n"); 
		query.append("					,	FTU_USE_CTNT2																																" ).append("\n"); 
		query.append("					,	FTU_USE_CTNT3																																" ).append("\n"); 
		query.append("					,	FTU_USE_CTNT4																																" ).append("\n"); 
		query.append("					,	FTU_USE_CNTR5																																" ).append("\n"); 
		query.append("					,	CRE_DT																																		" ).append("\n"); 
		query.append("					,	CRE_USR_ID																																	" ).append("\n"); 
		query.append("					,	EAI_EVNT_DT              																													" ).append("\n"); 
		query.append("					,	TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("					,	TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("					,	TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("					,	NULL									REF_BKG_NO																							" ).append("\n"); 
		query.append("					,	NULL									CGO_TP_CD																					" ).append("\n"); 
		query.append("					,	NULL									EQ_KND_CD																					" ).append("\n"); 
		query.append("			FROM		(             		                                               																			" ).append("\n"); 
		query.append("						SELECT 		@[CSR_NO]           						CSR_NO                                         																	" ).append("\n"); 
		query.append("								,	'9'           								LINE_SEQ                                         																" ).append("\n"); 
		query.append("								,	@[LINE_NO]            						LINE_NO                                         																" ).append("\n"); 
		query.append("								,	'ITEM'               						LINE_TP_LU_CD                                       															" ).append("\n"); 
		query.append("								,	INV_WRK.INV_VAT_AMT * (-1)					CSR_AMT                       /* REFUND INVOICE - 'TAX'	*/										" ).append("\n"); 
		query.append("								,	SVC_ORD.INV_NO     							INV_DESC                                         												" ).append("\n"); 
		query.append("								,	''       									INV_TAX_CD                                         																	" ).append("\n"); 
		query.append("								,	'01'                            			DTRB_COA_CO_CD                                         										" ).append("\n"); 
		query.append("								,	FINC_RGN_CD                     			DTRB_COA_RGN_CD                                        										" ).append("\n"); 
		query.append("								,	AP_CTR_CD                       			DTRB_COA_CTR_CD                                         										" ).append("\n"); 
		query.append("								,	'211691'          							DTRB_COA_ACCT_CD                                         															" ).append("\n"); 
		query.append("								,	'0000000000'                    			DTRB_COA_VVD_CD                                         										" ).append("\n"); 
		query.append("								,	NVL(SUBS_CO_CD,'00')            			DTRB_COA_INTER_CO_CD                                       									" ).append("\n"); 
		query.append("								,	'000000'                        			DTRB_COA_FTU_N1ST_CD                                       									" ).append("\n"); 
		query.append("								,	'000000'                        			DTRB_COA_FTU_N2ND_CD                                       									" ).append("\n"); 
		query.append("								,	'211691'          							ATTR_CATE_NM                                         																" ).append("\n"); 
		query.append("								,	SVC_ORD.INV_NO                  			ATTR_CTNT1                                         											" ).append("\n"); 
		query.append("								,	TO_CHAR(INV_WRK.INV_ISS_DT, 'YYYYMMDD')     ATTR_CTNT2                               									" ).append("\n"); 
		query.append("								,	MDM_ORG.LOC_CD                				ATTR_CTNT3                                         												" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT4																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT5																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT6																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT7																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT8																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT9																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT10																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT11																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT12																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT13																						" ).append("\n"); 
		query.append("								,	INV_WRK.AP_RVS_CNG_FLG                      ATTR_CTNT14																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT15																						" ).append("\n"); 
		query.append("								,	NULL                           				BKG_NO																							" ).append("\n"); 
		query.append("								,	NULL                           				CNTR_TPSZ_CD																						" ).append("\n"); 
		query.append("								,	NULL                           				ACT_VVD_CD																						" ).append("\n"); 
		query.append("								,	NULL                           				PLN_SCTR_DIV_CD																					" ).append("\n"); 
		query.append("								,	NULL                           				SO_CRR_CD																						" ).append("\n"); 
		query.append("								,	NULL                           				YD_CD																							" ).append("\n"); 
		query.append("								,	NULL                           				FTU_USE_CTNT1																					" ).append("\n"); 
		query.append("								,	NULL                           				FTU_USE_CTNT2																					" ).append("\n"); 
		query.append("								,	NULL                           				FTU_USE_CTNT3																					" ).append("\n"); 
		query.append("								,	NULL                           				FTU_USE_CTNT4																					" ).append("\n"); 
		query.append("								,	NULL                           				FTU_USE_CNTR5																					" ).append("\n"); 
		query.append("								,	SYSDATE                        				CRE_DT																							" ).append("\n"); 
		query.append("								,	@[CRE_USR_ID]          		   				CRE_USR_ID																						" ).append("\n"); 
		query.append("								,	''                             				EAI_EVNT_DT                      																" ).append("\n"); 
		query.append("								,	'F'											TRSP_SO_TP_CD																					" ).append("\n"); 
		query.append("								,	NULL										TRSP_SO_OFC_CTY_CD																				" ).append("\n"); 
		query.append("								,	-5											TRSP_SO_SEQ																						" ).append("\n"); 
		query.append("						FROM		TRS_TRSP_INV_WRK 							INV_WRK																							" ).append("\n"); 
		query.append("								,	MDM_ACCOUNT       							ACCT_NM																							" ).append("\n"); 
		query.append("								,	TRS_TRSP_RFND_INV  							SVC_ORD                                                                      					" ).append("\n"); 
		query.append("								,	MDM_ORGANIZATION  							MDM_ORG																							" ).append("\n"); 
		query.append("								,	MDM_VENDOR 									MDM_VNDR                                                 										" ).append("\n"); 
		query.append("						WHERE		ACCT_NM.ACCT_CD      						= CASE WHEN TRSP_COST_DTL_MOD_CD IN ('ER' , 'CN' ,'CF' ) THEN '512362' ELSE '512361' END        " ).append("\n"); 
		query.append("									AND			INV_WRK.INV_NO       						= SVC_ORD.INV_NO                      															" ).append("\n"); 
		query.append("									AND			INV_WRK.INV_VNDR_SEQ 						= SVC_ORD.INV_VNDR_SEQ                															" ).append("\n"); 
		query.append("									AND			MDM_ORG.OFC_CD       						= @[COST_OFC_CD]" ).append("\n"); 
		query.append("									AND			MDM_VNDR.VNDR_SEQ    						= SVC_ORD.INV_VNDR_SEQ                															" ).append("\n"); 
		query.append("									AND			INV_WRK.INV_NO       						= @[INV_NO]" ).append("\n"); 
		query.append("									AND			INV_WRK.INV_VNDR_SEQ 						= @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("									AND			TRSP_INV_AUD_STS_CD  						= @[TRSP_INV_AUD_STS_CD]" ).append("\n"); 
		query.append("									AND			NVL(INV_HLD_FLG,'N') 						= 'N'                         																	" ).append("\n"); 
		query.append("									AND			INV_WRK.DELT_FLG     						= 'N'                             																" ).append("\n"); 
		query.append("									AND			'KR'										<>  NVL(@[CNT_CD], ' ')                              													" ).append("\n"); 
		query.append("						GROUP BY	INV_WRK.INV_VAT_AMT																															" ).append("\n"); 
		query.append("								,	SVC_ORD.INV_NO																																" ).append("\n"); 
		query.append("								,	FINC_RGN_CD																																	" ).append("\n"); 
		query.append("								,	AP_CTR_CD																																	" ).append("\n"); 
		query.append("								,	SUBS_CO_CD																																	" ).append("\n"); 
		query.append("								,	INV_WRK.INV_ISS_DT																															" ).append("\n"); 
		query.append("								,	MDM_ORG.LOC_CD" ).append("\n"); 
		query.append("								,	INV_WRK.AP_RVS_CNG_FLG                    																											" ).append("\n"); 
		query.append("						UNION ALL 																																				" ).append("\n"); 
		query.append("						SELECT 		@[CSR_NO]           						CSR_NO																							" ).append("\n"); 
		query.append("								,	'10'           								LINE_SEQ																						" ).append("\n"); 
		query.append("								,	@[LINE_NO]            						LINE_NO																							" ).append("\n"); 
		query.append("								,	'ITEM'               						LINE_TP_LU_CD																					" ).append("\n"); 
		query.append("								,	INV_WRK.INV_WHLD_TAX_AMT * (-1) * (-1)      CSR_AMT				/* REFUND INVOICE - 'WITHHOLDING TAX'	*/									" ).append("\n"); 
		query.append("								,	'WITHHOLDING TAX'     				  		INV_DESC																						" ).append("\n"); 
		query.append("								,	''       									INV_TAX_CD																						" ).append("\n"); 
		query.append("								,	'01'                             			DTRB_COA_CO_CD																					" ).append("\n"); 
		query.append("								,	FINC_RGN_CD                      			DTRB_COA_RGN_CD																					" ).append("\n"); 
		query.append("								,	AP_CTR_CD                        			DTRB_COA_CTR_CD																					" ).append("\n"); 
		query.append("								,	'111821'          							DTRB_COA_ACCT_CD																				" ).append("\n"); 
		query.append("								,	'0000000000'                     			DTRB_COA_VVD_CD																					" ).append("\n"); 
		query.append("								,	NVL(SUBS_CO_CD,'00')             			DTRB_COA_INTER_CO_CD																			" ).append("\n"); 
		query.append("								,	'000000'                         			DTRB_COA_FTU_N1ST_CD																			" ).append("\n"); 
		query.append("								,	'000000'                         			DTRB_COA_FTU_N2ND_CD																			" ).append("\n"); 
		query.append("								,	'111821'          							ATTR_CATE_NM																					" ).append("\n"); 
		query.append("								,	SVC_ORD.INV_NO                   			ATTR_CTNT1																						" ).append("\n"); 
		query.append("								,	TO_CHAR(INV_WRK.INV_ISS_DT,'YYYYMMDD')      ATTR_CTNT2																						" ).append("\n"); 
		query.append("								,	MDM_ORG.LOC_CD								ATTR_CTNT3                      																" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT4																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT5																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT6																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT7																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT8																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT9																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT10																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT11																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT12																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT13																						" ).append("\n"); 
		query.append("								,	INV_WRK.AP_RVS_CNG_FLG                      ATTR_CTNT14																						" ).append("\n"); 
		query.append("								,	NULL                           				ATTR_CTNT15																						" ).append("\n"); 
		query.append("								,	NULL                           				BKG_NO																							" ).append("\n"); 
		query.append("								,	NULL                           				CNTR_TPSZ_CD																					" ).append("\n"); 
		query.append("								,	NULL                           				ACT_VVD_CD																						" ).append("\n"); 
		query.append("								,	NULL                           				PLN_SCTR_DIV_CD																					" ).append("\n"); 
		query.append("								,	NULL                           				SO_CRR_CD																						" ).append("\n"); 
		query.append("								,	NULL                           				YD_CD																							" ).append("\n"); 
		query.append("								,	NULL                           				FTU_USE_CTNT1																					" ).append("\n"); 
		query.append("								,	NULL                           				FTU_USE_CTNT2																					" ).append("\n"); 
		query.append("								,	NULL                           				FTU_USE_CTNT3																					" ).append("\n"); 
		query.append("								,	NULL                           				FTU_USE_CTNT4																					" ).append("\n"); 
		query.append("								,	NULL                           				FTU_USE_CNTR5																					" ).append("\n"); 
		query.append("								,	SYSDATE                        				CRE_DT																							" ).append("\n"); 
		query.append("								,	@[CRE_USR_ID]          		   				CRE_USR_ID																						" ).append("\n"); 
		query.append("								,	''                             				EAI_EVNT_DT                      																" ).append("\n"); 
		query.append("								,	'F'											TRSP_SO_TP_CD																					" ).append("\n"); 
		query.append("								,	NULL										TRSP_SO_OFC_CTY_CD																				" ).append("\n"); 
		query.append("								,	-6											TRSP_SO_SEQ																						" ).append("\n"); 
		query.append("						FROM		TRS_TRSP_INV_WRK 							INV_WRK																							" ).append("\n"); 
		query.append("								,	MDM_ACCOUNT       							ACCT_NM																							" ).append("\n"); 
		query.append("								,	TRS_TRSP_RFND_INV  							SVC_ORD																							" ).append("\n"); 
		query.append("								,	MDM_ORGANIZATION  							MDM_ORG																							" ).append("\n"); 
		query.append("								,	MDM_VENDOR 									MDM_VNDR                                                 										" ).append("\n"); 
		query.append("						WHERE		ACCT_NM.ACCT_CD								= '211691'                        																" ).append("\n"); 
		query.append("									AND			INV_WRK.INV_NO								= SVC_ORD.INV_NO                      															" ).append("\n"); 
		query.append("									AND			INV_WRK.INV_VNDR_SEQ						= SVC_ORD.INV_VNDR_SEQ                															" ).append("\n"); 
		query.append("									AND			MDM_ORG.OFC_CD								= @[COST_OFC_CD]" ).append("\n"); 
		query.append("									AND			MDM_VNDR.VNDR_SEQ							= SVC_ORD.INV_VNDR_SEQ                															" ).append("\n"); 
		query.append("									AND			INV_WRK.INV_NO								= @[INV_NO]" ).append("\n"); 
		query.append("									AND			INV_WRK.INV_VNDR_SEQ						= @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("									AND			TRSP_INV_AUD_STS_CD							= @[TRSP_INV_AUD_STS_CD]" ).append("\n"); 
		query.append("									AND			NVL(INV_HLD_FLG,'N')        				= 'N'                         																	" ).append("\n"); 
		query.append("									AND			INV_WRK.DELT_FLG							= 'N'                             																" ).append("\n"); 
		query.append("				GROUP BY			INV_WRK.INV_WHLD_TAX_AMT																													" ).append("\n"); 
		query.append("								,	SVC_ORD.INV_NO																																" ).append("\n"); 
		query.append("								,	FINC_RGN_CD																																	" ).append("\n"); 
		query.append("								,	AP_CTR_CD																																	" ).append("\n"); 
		query.append("								,	SUBS_CO_CD																																	" ).append("\n"); 
		query.append("								,	INV_WRK.INV_ISS_DT																															" ).append("\n"); 
		query.append("								,	MDM_ORG.LOC_CD  " ).append("\n"); 
		query.append("								,	INV_WRK.AP_RVS_CNG_FLG                  																											" ).append("\n"); 
		query.append("				) A																																								" ).append("\n"); 
		query.append("	WHERE		CSR_AMT <> 0																																					" ).append("\n"); 
		query.append("	UNION ALL                                                                                                   " ).append("\n"); 
		query.append("	SELECT    @[CSR_NO]                   CSR_NO                                                                " ).append("\n"); 
		query.append("		 , '11'                           LINE_SEQ                                                           " ).append("\n"); 
		query.append("		 , @[LINE_NO]                     LINE_NO                                                            " ).append("\n"); 
		query.append("		 , 'ITEM'                         LINE_TP_LU_CD                                                " ).append("\n"); 
		query.append("		 , CASE  WHEN @[CURR_CD] IN ('KRW','JPY','TWD') THEN ROUND(NVL(SVC_ORD.AMT,0))                             " ).append("\n"); 
		query.append("		       ELSE  ROUND(NVL(SVC_ORD.AMT,0)  , 2 )                                                      " ).append("\n"); 
		query.append("		   END   CSR_AMT                                                                                  " ).append("\n"); 
		query.append("		 , ACCT_NM.ACCT_ENG_NM               INV_DESC                                                     " ).append("\n"); 
		query.append("		 , ''                     			 INV_TAX_CD                                                           " ).append("\n"); 
		query.append("		 , '01'                              DTRB_COA_CO_CD                                               " ).append("\n"); 
		query.append("		 , FINC_RGN_CD                       DTRB_COA_RGN_CD                                              " ).append("\n"); 
		query.append("		 , AP_CTR_CD                         DTRB_COA_CTR_CD                                              " ).append("\n"); 
		query.append("		 , SVC_ORD.ACCT_CD                   DTRB_COA_ACCT_CD                                             " ).append("\n"); 
		query.append("		 , 'CNTC'||SUBSTR(INV_WRK.POOL_CHSS_COST_YRMON, 3,4)||'MM'          DTRB_COA_VVD_CD               " ).append("\n"); 
		query.append("		 , NVL(SUBS_CO_CD,'00')              DTRB_COA_INTER_CO_CD                                         " ).append("\n"); 
		query.append("		 , '000000'                          DTRB_COA_FTU_N1ST_CD                                         " ).append("\n"); 
		query.append("		 , '000000'                          DTRB_COA_FTU_N2ND_CD                                         " ).append("\n"); 
		query.append("		 , SVC_ORD.ACCT_CD                   ATTR_CATE_NM                                                 " ).append("\n"); 
		query.append("		 , SVC_ORD.INV_NO                    ATTR_CTNT1                                                   " ).append("\n"); 
		query.append("		 , TO_CHAR(INV_WRK.INV_ISS_DT,'YYYYMMDD')      ATTR_CTNT2                                         " ).append("\n"); 
		query.append("		 , (SELECT A.LOC_CD FROM MDM_ORGANIZATION A WHERE SVC_ORD.CRE_OFC_CD = A.OFC_CD) ATTR_CTNT3       " ).append("\n"); 
		query.append("		 , NULL                                  ATTR_CTNT4                                               " ).append("\n"); 
		query.append("		 , NULL                                  ATTR_CTNT5                                               " ).append("\n"); 
		query.append("		 , NULL                                  ATTR_CTNT6                                               " ).append("\n"); 
		query.append("		 , NULL                                  ATTR_CTNT7                                               " ).append("\n"); 
		query.append("		 , NULL                                  ATTR_CTNT8                                               " ).append("\n"); 
		query.append("		 , NULL                                  ATTR_CTNT9                                               " ).append("\n"); 
		query.append("		 , NULL                                  ATTR_CTNT10                                              " ).append("\n"); 
		query.append("		 , NULL                                  ATTR_CTNT11                                              " ).append("\n"); 
		query.append("		 , NULL                                  ATTR_CTNT12                                              " ).append("\n"); 
		query.append("		 , NULL                                  ATTR_CTNT13                                              " ).append("\n"); 
		query.append("		 , INV_WRK.AP_RVS_CNG_FLG                ATTR_CTNT14                                              " ).append("\n"); 
		query.append("		 , NULL                                  ATTR_CTNT15                                              " ).append("\n"); 
		query.append("		 , ''                                    BKG_NO                                                   " ).append("\n"); 
		query.append("		 , NULL                                  CNTR_TPSZ_CD                                             " ).append("\n"); 
		query.append("		 , 'CNTC'||SUBSTR(INV_WRK.POOL_CHSS_COST_YRMON, 3,4)||'MM'            ACT_VVD_CD                  " ).append("\n"); 
		query.append("		 , 'C'                                   PLN_SCTR_DIV_CD                                          " ).append("\n"); 
		query.append("		 , NULL                                  SO_CRR_CD                                                " ).append("\n"); 
		query.append("		 , NULL                                  YD_CD                                                    " ).append("\n"); 
		query.append("		 , SVC_ORD.LGS_COST_CD                   FTU_USE_CTNT1                                            " ).append("\n"); 
		query.append("		 , TO_CHAR(SVC_ORD.CNT)                  FTU_USE_CTNT2                                        " ).append("\n"); 
		query.append("		 , 'C'                                   FTU_USE_CTNT3                                            " ).append("\n"); 
		query.append("		 , NULL                                  FTU_USE_CTNT4                                            " ).append("\n"); 
		query.append("		 , NULL                                  FTU_USE_CNTR5                                            " ).append("\n"); 
		query.append("		 , SYSDATE                               CRE_DT                                                   " ).append("\n"); 
		query.append("		 , @[CRE_USR_ID]                         CRE_USR_ID                                                   " ).append("\n"); 
		query.append("		 , ''                                    EAI_EVNT_DT                                              " ).append("\n"); 
		query.append("		 , 'F'                     TRSP_SO_TP_CD                                                          " ).append("\n"); 
		query.append("		 , NULL                    TRSP_SO_OFC_CTY_CD                                                     " ).append("\n"); 
		query.append("		 , -7                      TRSP_SO_SEQ                                                            " ).append("\n"); 
		query.append("	     , NULL                  REF_BKG_NO                                                                 " ).append("\n"); 
		query.append("	     , NULL                  CGO_TP_CD                                                                  " ).append("\n"); 
		query.append("	     , NULL                  EQ_KND_CD                                                                   " ).append("\n"); 
		query.append("	    FROM    TRS_TRSP_INV_WRK              INV_WRK                                                        " ).append("\n"); 
		query.append("		 , MDM_ACCOUNT                     ACCT_NM                                                        " ).append("\n"); 
		query.append("		 ,(SELECT  '512333' ACCT_CD                                                                       " ).append("\n"); 
		query.append("			 , 'TRCDTD' LGS_COST_CD                                                                   " ).append("\n"); 
		query.append("			 , INV_NO                                                                                 " ).append("\n"); 
		query.append("			 , INV_VNDR_SEQ                                                                           " ).append("\n"); 
		query.append("			 , SUM(TRSP_POOL_CHSS_QTY) CNT                                                            " ).append("\n"); 
		query.append("			 , SUM(TRSP_POOL_CHSS_INV_AMT) AMT                                                        " ).append("\n"); 
		query.append("			 , CRE_OFC_CD                                                                             " ).append("\n"); 
		query.append("		     FROM  TRS_TRSP_POOL_CHSS_INV                                                                 " ).append("\n"); 
		query.append("		    WHERE  INV_NO        = @[INV_NO]                                                                      " ).append("\n"); 
		query.append("		      AND  INV_VNDR_SEQ  = @[INV_VNDR_SEQ]                                                          " ).append("\n"); 
		query.append("		 GROUP BY  INV_NO                                                                                 " ).append("\n"); 
		query.append("			 , INV_VNDR_SEQ                                                                           " ).append("\n"); 
		query.append("			 , CRE_OFC_CD" ).append("\n"); 
		query.append("			) SVC_ORD                                                                    " ).append("\n"); 
		query.append("		   , MDM_ORGANIZATION  MDM_ORG                                                                    " ).append("\n"); 
		query.append("		   , MDM_VENDOR MDM_VNDR                                                                          " ).append("\n"); 
		query.append("	       WHERE   ACCT_NM.ACCT_CD       = SVC_ORD.ACCT_CD                                                    " ).append("\n"); 
		query.append("			       AND     INV_WRK.INV_NO        = SVC_ORD.INV_NO                                                     " ).append("\n"); 
		query.append("			       AND     INV_WRK.INV_VNDR_SEQ  = SVC_ORD.INV_VNDR_SEQ                                               " ).append("\n"); 
		query.append("			       AND     MDM_ORG.OFC_CD        = @[COST_OFC_CD]" ).append("\n"); 
		query.append("			       AND     MDM_VNDR.VNDR_SEQ     = SVC_ORD.INV_VNDR_SEQ                                               " ).append("\n"); 
		query.append("			       AND     INV_WRK.INV_NO        = @[INV_NO]" ).append("\n"); 
		query.append("			       AND     INV_WRK.INV_VNDR_SEQ  = @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("			       AND     TRSP_INV_AUD_STS_CD   = @[TRSP_INV_AUD_STS_CD]" ).append("\n"); 
		query.append("			       AND     NVL(INV_HLD_FLG, 'N') = 'N'                                                                " ).append("\n"); 
		query.append("			       AND     INV_WRK.DELT_FLG      = 'N'                                                                " ).append("\n"); 
		query.append("	UNION ALL                                                                                                        " ).append("\n"); 
		query.append("	       SELECT    CSR_NO                                                                                   " ).append("\n"); 
		query.append("		   , LINE_SEQ                                                                                     " ).append("\n"); 
		query.append("		   , LINE_NO                                                                                      " ).append("\n"); 
		query.append("		   , LINE_TP_LU_CD                                                                                " ).append("\n"); 
		query.append("		   , CSR_AMT                                                                                      " ).append("\n"); 
		query.append("		   , INV_DESC                                                                                     " ).append("\n"); 
		query.append("		   , INV_TAX_CD                                                                                   " ).append("\n"); 
		query.append("		   , DTRB_COA_CO_CD                                                                               " ).append("\n"); 
		query.append("		   , DTRB_COA_RGN_CD                                                                              " ).append("\n"); 
		query.append("		   , DTRB_COA_CTR_CD                                                                              " ).append("\n"); 
		query.append("		   , DTRB_COA_ACCT_CD                                                                             " ).append("\n"); 
		query.append("		   , DTRB_COA_VVD_CD                                                                              " ).append("\n"); 
		query.append("		   , DTRB_COA_INTER_CO_CD                                                                         " ).append("\n"); 
		query.append("		   , DTRB_COA_FTU_N1ST_CD                                                                         " ).append("\n"); 
		query.append("		   , DTRB_COA_FTU_N2ND_CD                                                                         " ).append("\n"); 
		query.append("		   , ATTR_CATE_NM                                                                                 " ).append("\n"); 
		query.append("		   , ATTR_CTNT1                                                                                   " ).append("\n"); 
		query.append("		   , ATTR_CTNT2                                                                                   " ).append("\n"); 
		query.append("		   , ATTR_CTNT3                                                                                   " ).append("\n"); 
		query.append("		   , NULL        ATTR_CTNT4                                                                       " ).append("\n"); 
		query.append("		   , NULL        ATTR_CTNT5                                                                       " ).append("\n"); 
		query.append("		   , NULL        ATTR_CTNT6                                                                       " ).append("\n"); 
		query.append("		   , NULL        ATTR_CTNT7                                                                       " ).append("\n"); 
		query.append("		   , NULL        ATTR_CTNT8                                                                       " ).append("\n"); 
		query.append("		   , NULL        ATTR_CTNT9                                                                       " ).append("\n"); 
		query.append("		   , NULL        ATTR_CTNT10                                                                      " ).append("\n"); 
		query.append("		   , NULL        ATTR_CTNT11                                                                      " ).append("\n"); 
		query.append("		   , NULL        ATTR_CTNT12                                                                      " ).append("\n"); 
		query.append("		   , NULL        ATTR_CTNT13                                                                      " ).append("\n"); 
		query.append("		   , ATTR_CTNT14                                                                      " ).append("\n"); 
		query.append("		   , NULL        ATTR_CTNT15                                                                      " ).append("\n"); 
		query.append("		   , NULL        BKG_NO                                                                           " ).append("\n"); 
		query.append("		   , NULL        CNTR_TPSZ_CD                                                                     " ).append("\n"); 
		query.append("		   , NULL        ACT_VVD_CD                                                                       " ).append("\n"); 
		query.append("		   , NULL        PLN_SCTR_DIV_CD                                                                  " ).append("\n"); 
		query.append("		   , NULL        SO_CRR_CD                                                                        " ).append("\n"); 
		query.append("		   , NULL        YD_CD                                                                            " ).append("\n"); 
		query.append("		   , NULL        FTU_USE_CTNT1                                                                    " ).append("\n"); 
		query.append("		   , NULL        FTU_USE_CTNT2                                                                    " ).append("\n"); 
		query.append("		   , NULL        FTU_USE_CTNT3                                                                    " ).append("\n"); 
		query.append("		   , NULL        FTU_USE_CTNT4                                                                    " ).append("\n"); 
		query.append("		   , NULL        FTU_USE_CNTR5                                                                    " ).append("\n"); 
		query.append("		   , CRE_DT                                                                                       " ).append("\n"); 
		query.append("		   , CRE_USR_ID                                                                                   " ).append("\n"); 
		query.append("		   , EAI_EVNT_DT                                                                                  " ).append("\n"); 
		query.append("		   , TRSP_SO_TP_CD                                                                                " ).append("\n"); 
		query.append("		   , TRSP_SO_OFC_CTY_CD                                                                           " ).append("\n"); 
		query.append("		   , TRSP_SO_SEQ                                                                                  " ).append("\n"); 
		query.append("		   , NULL                  REF_BKG_NO                                                             " ).append("\n"); 
		query.append("		   , NULL                  CGO_TP_CD                                                              " ).append("\n"); 
		query.append("		   , NULL                  EQ_KND_CD                                                               " ).append("\n"); 
		query.append("	       FROM    (                                                                                          " ).append("\n"); 
		query.append("		     SELECT    @[CSR_NO]              CSR_NO                                                  " ).append("\n"); 
		query.append("			 , '12'                           LINE_SEQ                                                   " ).append("\n"); 
		query.append("			 , @[LINE_NO]                     LINE_NO                                                    " ).append("\n"); 
		query.append("			 , 'ITEM'                         LINE_TP_LU_CD                                             " ).append("\n"); 
		query.append("			 , INV_WRK.INV_VAT_AMT            CSR_AMT     /*  'TAX' */                                 " ).append("\n"); 
		query.append("			 , SVC_ORD.INV_NO                 INV_DESC                                               " ).append("\n"); 
		query.append("			 , ''                             INV_TAX_CD                                       " ).append("\n"); 
		query.append("			 , '01'                           DTRB_COA_CO_CD                                   " ).append("\n"); 
		query.append("			 , FINC_RGN_CD                    DTRB_COA_RGN_CD                                  " ).append("\n"); 
		query.append("			 , AP_CTR_CD                      DTRB_COA_CTR_CD                                  " ).append("\n"); 
		query.append("			 , '111821'                       DTRB_COA_ACCT_CD                                 " ).append("\n"); 
		query.append("			 , '0000000000'                   DTRB_COA_VVD_CD                                  " ).append("\n"); 
		query.append("			 , NVL(SUBS_CO_CD,'00')           DTRB_COA_INTER_CO_CD                             " ).append("\n"); 
		query.append("			 , '000000'                       DTRB_COA_FTU_N1ST_CD                             " ).append("\n"); 
		query.append("			 , '000000'                       DTRB_COA_FTU_N2ND_CD                             " ).append("\n"); 
		query.append("			 , '111821'                       ATTR_CATE_NM                                     " ).append("\n"); 
		query.append("			 , SVC_ORD.INV_NO                 ATTR_CTNT1                                       " ).append("\n"); 
		query.append("			 , TO_CHAR(INV_WRK.INV_ISS_DT, 'YYYYMMDD')     ATTR_CTNT2                                 " ).append("\n"); 
		query.append("			 , MDM_ORG.LOC_CD                 ATTR_CTNT3" ).append("\n"); 
		query.append("			 , INV_WRK.AP_RVS_CNG_FLG         ATTR_CTNT14                              " ).append("\n"); 
		query.append("			 , SYSDATE                        CRE_DT                                           " ).append("\n"); 
		query.append("			 , @[CRE_USR_ID]                  CRE_USR_ID                                       " ).append("\n"); 
		query.append("			 , ''                             EAI_EVNT_DT                                      " ).append("\n"); 
		query.append("			 , 'F'                     		  TRSP_SO_TP_CD                                                  " ).append("\n"); 
		query.append("			 , NULL                    		  TRSP_SO_OFC_CTY_CD                                             " ).append("\n"); 
		query.append("			 , -8                      	 	  TRSP_SO_SEQ                                                    " ).append("\n"); 
		query.append("		     FROM    TRS_TRSP_INV_WRK          INV_WRK                                                " ).append("\n"); 
		query.append("			 , MDM_ACCOUNT                     ACCT_NM                                                " ).append("\n"); 
		query.append("			 , TRS_TRSP_POOL_CHSS_INV          SVC_ORD                                                " ).append("\n"); 
		query.append("			 , MDM_ORGANIZATION                MDM_ORG                                                " ).append("\n"); 
		query.append("			 , MDM_VENDOR                  MDM_VNDR                                                   " ).append("\n"); 
		query.append("		     WHERE   ACCT_NM.ACCT_CD                 = '512333'                                           " ).append("\n"); 
		query.append("				     AND     INV_WRK.INV_NO                  = SVC_ORD.INV_NO                                     " ).append("\n"); 
		query.append("				     AND     INV_WRK.INV_VNDR_SEQ            = SVC_ORD.INV_VNDR_SEQ                               " ).append("\n"); 
		query.append("				     AND     MDM_ORG.OFC_CD                  = @[COST_OFC_CD]" ).append("\n"); 
		query.append("				     AND     MDM_VNDR.VNDR_SEQ               = SVC_ORD.INV_VNDR_SEQ                               " ).append("\n"); 
		query.append("				     AND     INV_WRK.INV_NO                  = @[INV_NO]" ).append("\n"); 
		query.append("				     AND     INV_WRK.INV_VNDR_SEQ            = @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("				     AND     TRSP_INV_AUD_STS_CD             = @[TRSP_INV_AUD_STS_CD]" ).append("\n"); 
		query.append("				     AND     NVL(INV_HLD_FLG,'N')            = 'N'                                                " ).append("\n"); 
		query.append("				     AND     INV_WRK.DELT_FLG                = 'N'                                                " ).append("\n"); 
		query.append("				     AND     'KR'                    <>  NVL(@[CNT_CD], ' ')                                              " ).append("\n"); 
		query.append("		     GROUP BY  INV_WRK.INV_VAT_AMT                                                                " ).append("\n"); 
		query.append("			 , SVC_ORD.INV_NO                                                                         " ).append("\n"); 
		query.append("			 , FINC_RGN_CD                                                                            " ).append("\n"); 
		query.append("			 , AP_CTR_CD                                                                              " ).append("\n"); 
		query.append("			 , SUBS_CO_CD                                                                             " ).append("\n"); 
		query.append("			 , INV_WRK.INV_ISS_DT                                                                     " ).append("\n"); 
		query.append("			 , MDM_ORG.LOC_CD" ).append("\n"); 
		query.append("			 , INV_WRK.AP_RVS_CNG_FLG                                                                         " ).append("\n"); 
		query.append("		 ) A                                                                                              " ).append("\n"); 
		query.append("	   WHERE   CSR_AMT <> 0                                                                                   " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("					UNION ALL                                                     																					" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("					SELECT		@[CSR_NO]			CSR_NO" ).append("\n"); 
		query.append("							,	'13'           		LINE_SEQ																											" ).append("\n"); 
		query.append("							,	@[LINE_NO]          LINE_NO																												" ).append("\n"); 
		query.append("							,	'ITEM'             	LINE_TP_LU_CD																							" ).append("\n"); 
		query.append("							,	SUM(CSR_AMT) 		CSR_AMT																												" ).append("\n"); 
		query.append("							,	INV_DESC																															" ).append("\n"); 
		query.append("							,	''                 	INV_TAX_CD																							" ).append("\n"); 
		query.append("							,	'01'                DTRB_COA_CO_CD																						" ).append("\n"); 
		query.append("							,	DTRB_COA_RGN_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_CTR_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_ACCT_CD																													" ).append("\n"); 
		query.append("							,	DTRB_COA_VVD_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_INTER_CO_CD																												" ).append("\n"); 
		query.append("							,	'000000'                       			DTRB_COA_FTU_N1ST_CD																					" ).append("\n"); 
		query.append("							,	'000000'                       			DTRB_COA_FTU_N2ND_CD																					" ).append("\n"); 
		query.append("							,	ATTR_CATE_NM																														" ).append("\n"); 
		query.append("							,	ATTR_CTNT1																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT2																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT3																															" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT4																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT5																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT6																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT7																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT8																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT9																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT10																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT11																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT12																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT13																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT14																							" ).append("\n"); 
		query.append("							,	NULL                           			ATTR_CTNT15																							" ).append("\n"); 
		query.append("							,	BKG_NO																																" ).append("\n"); 
		query.append("							,	CNTR_TPSZ_CD																														" ).append("\n"); 
		query.append("							,	ACT_VVD_CD																															" ).append("\n"); 
		query.append("							,	'C'                            			PLN_SCTR_DIV_CD																						" ).append("\n"); 
		query.append("							,	NULL                           			SO_CRR_CD																							" ).append("\n"); 
		query.append("							,	NULL                           			YD_CD																								" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT1																														" ).append("\n"); 
		query.append("							,	TO_CHAR(COUNT(*))      					FTU_USE_CTNT2																								" ).append("\n"); 
		query.append("							,	NULL                           			FTU_USE_CTNT3																						" ).append("\n"); 
		query.append("							,	NULL                           			FTU_USE_CTNT4																						" ).append("\n"); 
		query.append("							,	NULL                           			FTU_USE_CNTR5																						" ).append("\n"); 
		query.append("							,	SYSDATE                        			CRE_DT																								" ).append("\n"); 
		query.append("							,	@[CRE_USR_ID]                   		   			CRE_USR_ID																							" ).append("\n"); 
		query.append("							,	''                             			EAI_EVNT_DT                                                                  						" ).append("\n"); 
		query.append("							,	TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("							,	TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("							,	TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("							,	NULL									REF_BKG_NO																							" ).append("\n"); 
		query.append("							,	NULL									CGO_TP_CD																					" ).append("\n"); 
		query.append("							,	NULL									EQ_KND_CD																					" ).append("\n"); 
		query.append("					FROM        (                                                                                                               					" ).append("\n"); 
		query.append("								SELECT		NVL(INV_DTL.FUEL_SCG_AMT,0)				CSR_AMT											" ).append("\n"); 
		query.append("										,	LGS_COST.LGS_COST_FULL_NM           	INV_DESC																					" ).append("\n"); 
		query.append("										,	FINC_RGN_CD                    			DTRB_COA_RGN_CD																			" ).append("\n"); 
		query.append("										,	AP_CTR_CD                      			DTRB_COA_CTR_CD																			" ).append("\n"); 
		query.append("										,	LGS_COST.ACCT_CD                		DTRB_COA_ACCT_CD																			" ).append("\n"); 
		query.append("										,	INV_DTL.FINC_VVD_CD						DTRB_COA_VVD_CD																								" ).append("\n"); 
		query.append("										,	NVL(SUBS_CO_CD,'00')           			DTRB_COA_INTER_CO_CD																		" ).append("\n"); 
		query.append("										,	LGS_COST.ACCT_CD                		ATTR_CATE_NM																				" ).append("\n"); 
		query.append("										,	INV_WRK.INV_NO                 			ATTR_CTNT1																				" ).append("\n"); 
		query.append("										,	TO_CHAR(INV_WRK.INV_ISS_DT,'YYYYMMDD')  ATTR_CTNT2															" ).append("\n"); 
		query.append("										,	MDM_ORG.LOC_CD 							ATTR_CTNT3																	" ).append("\n"); 
		query.append("										,	SVC_ORD.ORG_BKG_NO                 		BKG_NO																					" ).append("\n"); 
		query.append("										,	SVC_ORD.EQ_TPSZ_CD             			CNTR_TPSZ_CD																				" ).append("\n"); 
		query.append("										,	INV_DTL.FINC_VVD_CD						ACT_VVD_CD																									" ).append("\n"); 
		query.append("										,	LGS_COST.LGS_COST_CD            		FTU_USE_CTNT1                                                                			" ).append("\n"); 
		query.append("										,	'R'										TRSP_SO_TP_CD																					 			" ).append("\n"); 
		query.append("										,	INV_DTL.TRSP_SO_OFC_CTY_CD																							" ).append("\n"); 
		query.append("										,	INV_DTL.TRSP_SO_SEQ																									" ).append("\n"); 
		query.append("								FROM		TRS_TRSP_RAIL_INV_WRK 			INV_WRK																							" ).append("\n"); 
		query.append("										,	TRS_TRSP_RAIL_INV_DTL 			INV_DTL																							" ).append("\n"); 
		query.append("										,	MDM_ORGANIZATION  				MDM_ORG																								" ).append("\n"); 
		query.append("										,	MDM_VENDOR 						MDM_VNDR																										" ).append("\n"); 
		query.append("										,	TRS_TRSP_RAIL_BIL_ORD			SVC_ORD" ).append("\n"); 
		query.append("										,	TES_LGS_COST					LGS_COST" ).append("\n"); 
		query.append("								WHERE		INV_WRK.INV_NO					= INV_DTL.INV_NO                                                                                    " ).append("\n"); 
		query.append("											AND			INV_WRK.INV_VNDR_SEQ			= INV_DTL.INV_VNDR_SEQ                                                                              " ).append("\n"); 
		query.append("											AND			MDM_ORG.OFC_CD					= @[COST_OFC_CD]" ).append("\n"); 
		query.append("											AND     	INV_DTL.INV_VNDR_SEQ    		= MDM_VNDR.VNDR_SEQ		                                                                            " ).append("\n"); 
		query.append("											AND     	INV_DTL.TRSP_SO_OFC_CTY_CD  	= SVC_ORD.TRSP_SO_OFC_CTY_CD(+)                                                                     " ).append("\n"); 
		query.append("											AND     	INV_DTL.TRSP_SO_SEQ         	= SVC_ORD.TRSP_SO_SEQ       (+)		                                                                " ).append("\n"); 
		query.append("											AND			INV_WRK.INV_NO					= @[INV_NO]" ).append("\n"); 
		query.append("											AND			INV_WRK.INV_VNDR_SEQ			= @[INV_VNDR_SEQ]" ).append("\n"); 
		query.append("											AND			TRSP_INV_AUD_STS_CD				= @[TRSP_INV_AUD_STS_CD]" ).append("\n"); 
		query.append("											AND			NVL(INV_WRK.INV_HLD_FLG,'N')    = 'N'                                                               					" ).append("\n"); 
		query.append("											AND			INV_WRK.DELT_FLG				= 'N'                                                                         					" ).append("\n"); 
		query.append("											AND     	INV_DTL.PAY_FLG         		= 'Y'" ).append("\n"); 
		query.append("											AND     	NVL(INV_DTL.FUEL_SCG_AMT,0)     <> 0" ).append("\n"); 
		query.append("											AND         LGS_COST.LGS_COST_CD = DECODE(INV_DTL.CGO_TP_CD,'F','SCFURD','M','SMFURD')" ).append("\n"); 
		query.append("								)                                                                                                               					" ).append("\n"); 
		query.append("					GROUP BY	INV_DESC																															" ).append("\n"); 
		query.append("							,	DTRB_COA_RGN_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_CTR_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_ACCT_CD																													" ).append("\n"); 
		query.append("							,	DTRB_COA_VVD_CD																														" ).append("\n"); 
		query.append("							,	DTRB_COA_INTER_CO_CD																												" ).append("\n"); 
		query.append("							,	ATTR_CATE_NM																														" ).append("\n"); 
		query.append("							,	ATTR_CTNT1																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT2																															" ).append("\n"); 
		query.append("							,	ATTR_CTNT3																															" ).append("\n"); 
		query.append("							,	BKG_NO																																" ).append("\n"); 
		query.append("							,	CNTR_TPSZ_CD																														" ).append("\n"); 
		query.append("							,	ACT_VVD_CD																															" ).append("\n"); 
		query.append("							,	FTU_USE_CTNT1                                                                                               						" ).append("\n"); 
		query.append("						    , 	TRSP_SO_TP_CD                                                               " ).append("\n"); 
		query.append("						    , 	TRSP_SO_OFC_CTY_CD                                                          " ).append("\n"); 
		query.append("						    , 	TRSP_SO_SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("					)																																											" ).append("\n"); 
		query.append("			)" ).append("\n"); 

	}
}