<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CopDetailReceiveDBDAOSearchToDoMVMTRSQL">
			<desc><![CDATA[SearchToDoMVMT]]></desc>
			<sql><![CDATA[
SELECT bkg_no           bkg_no
,sysdate                cre_dt
,'1'                    act_rcv_tp_cd
,MVMT_STS_CD            act_sts_mapg_cd
,cntr_no                cntr_no           
,org_yd_cd              nod_cd    
,cnmv_evnt_dt           act_dt
,'00'                   act_umch_tp_cd
,CASE WHEN MVMT_EDI_MSG_TP_ID is null
   THEN ( CASE WHEN MVMT_CRE_TP_CD in ('A', 'C', 'L')
               THEN 'SYSTEM'
               WHEN MVMT_CRE_TP_CD is null
               THEN CRE_USR_ID
          END
        )
   ELSE (MVMT_EDI_MSG_TP_ID)
END                     edi_msg_tp_cd
,VNDR_SEQ               vndr_seq
,OB_CNTR_FLG            bnd_vskd_seq_cd
,(CASE WHEN SUBSTR(org_yd_cd,1,5) IS NOT NULL
   THEN GLOBALDATE_PKG.TIME_CONV_FNC(SUBSTR(org_yd_cd,1,5), cnmv_evnt_dt, 'GMT')
   WHEN (LOC_CD) IS NOT NULL
   THEN GLOBALDATE_PKG.TIME_CONV_FNC(LOC_CD, cnmv_evnt_dt, 'GMT')
END)                    act_gdt
,MVMT_CRE_TP_CD         cre_tp_cd
,CRNT_VSL_CD            vsl_cd
,CRNT_SKD_VOY_NO        skd_voy_no
,CRNT_SKD_DIR_CD        skd_dir_cd
FROM (SELECT MVMT_CRE_TP_CD,CNTR_NO,CNMV_YR,CNMV_ID_NO,CNMV_SEQ,CNMV_SPLIT_NO,CNTR_TPSZ_CD,MVMT_STS_CD,BKG_CGO_TP_CD,CNMV_CYC_NO,CNMV_LVL_NO,CNMV_EVNT_DT
,DEST_YD_CD,INP_YD_CD,ORG_YD_CD,CRNT_VSL_CD,CRNT_SKD_VOY_NO,CRNT_SKD_DIR_CD,TRNK_VSL_CD,TRNK_SKD_VOY_NO,TRNK_SKD_DIR_CD,CHSS_NO,MGST_NO
,CNTR_SEAL_NO,CNTR_DMG_FLG,FCNTR_FLG,OB_CNTR_FLG,BKG_RCV_TERM_CD,VNDR_SEQ,MVMT_TRSP_MOD_CD,LOC_CD,CNMV_RMK,USR_NM
,SUBST_RULE_CD,SPCL_CGO_FLG,BKG_NO,BKG_KNT,BL_NO,CNTR_HNGR_RCK_FLG,CNTR_HNGR_BAR_ATCH_KNT,CNTR_ACT_CD,CNTR_RFUB_FLG,CNTR_DISP_FLG
,IMDT_EXT_FLG,CNTR_XCH_CD,INLND_TRSP_LIC_NO,CTRT_OFC_CTY_CD,CTRT_SEQ,MVMT_EDI_TP_CD,MVMT_EDI_MSG_TP_ID,MVMT_EDI_MSG_AREA_CD
,MVMT_EDI_MSG_YRMONDY,MVMT_EDI_MSG_SEQ,WBL_NO,PKUP_NO,CNTR_STS_SEQ,CALL_SGN_NO,LLOYD_NO,MTY_REPO_VL_RMK,MVMT_INP_TP_CD,CNMV_CO_CD
,CNTR_SVR_ID,OFC_CD,PRE_STS_FLG,GMT_DT,CRE_LOCL_DT,UPD_LOCL_DT,CRE_USR_ID,CRE_DT,UPD_USR_ID,UPD_DT

FROM  CTM_MOVEMENT
WHERE CNTR_NO       = @[inCntrNo]
AND   CNMV_YR       = @[inCnmvYr]
AND   CNMV_ID_NO    = @[inCnmvIdNo]
AND   MVMT_STS_CD   = @[inMvmtStsCd]
AND   CNTR_TPSZ_CD  = @[inCntrTpszCd]
AND   BKG_CGO_TP_CD = @[inBkgCgoTpCd]
AND   CNMV_CO_CD     = 'SML'
AND   BKG_NO         IS NOT NULL
UNION
SELECT MVMT_CRE_TP_CD,CNTR_NO,CNMV_YR,CNMV_ID_NO,CNMV_SEQ,CNMV_SPLIT_NO,CNTR_TPSZ_CD,MVMT_STS_CD,BKG_CGO_TP_CD,CNMV_CYC_NO,CNMV_LVL_NO,CNMV_EVNT_DT
,DEST_YD_CD,INP_YD_CD,ORG_YD_CD,CRNT_VSL_CD,CRNT_SKD_VOY_NO,CRNT_SKD_DIR_CD,TRNK_VSL_CD,TRNK_SKD_VOY_NO,TRNK_SKD_DIR_CD,CHSS_NO,MGST_NO
,CNTR_SEAL_NO,CNTR_DMG_FLG,FCNTR_FLG,OB_CNTR_FLG,BKG_RCV_TERM_CD,VNDR_SEQ,MVMT_TRSP_MOD_CD,LOC_CD,CNMV_RMK,USR_NM
,SUBST_RULE_CD,SPCL_CGO_FLG,BKG_NO,BKG_KNT,BL_NO,CNTR_HNGR_RCK_FLG,CNTR_HNGR_BAR_ATCH_KNT,CNTR_ACT_CD,CNTR_RFUB_FLG,CNTR_DISP_FLG
,IMDT_EXT_FLG,CNTR_XCH_CD,INLND_TRSP_LIC_NO,CTRT_OFC_CTY_CD,CTRT_SEQ,MVMT_EDI_TP_CD,MVMT_EDI_MSG_TP_ID,MVMT_EDI_MSG_AREA_CD
,MVMT_EDI_MSG_YRMONDY,MVMT_EDI_MSG_SEQ,WBL_NO,PKUP_NO,CNTR_STS_SEQ,CALL_SGN_NO,LLOYD_NO,MTY_REPO_VL_RMK,MVMT_INP_TP_CD,CNMV_CO_CD
,CNTR_SVR_ID,OFC_CD,PRE_STS_FLG,GMT_DT,CRE_LOCL_DT,UPD_LOCL_DT,CRE_USR_ID,CRE_DT,UPD_USR_ID,UPD_DT

FROM  CTM_MOVEMENT
WHERE CNTR_NO        = @[inCntrNo]
AND   CNMV_EVNT_DT   = TO_DATE(:in_cnmv_evnt_dt,'YYYY/MM/DD HH24:MI:SS')
AND   CNTR_TPSZ_CD   = @[inCntrTpszCd]
AND   BKG_CGO_TP_CD  = @[inBkgCgoTpCd]
AND   MVMT_CRE_TP_CD IS NOT NULL
AND   CNMV_CO_CD     = 'SML'
AND   BKG_NO         IS NOT NULL) S			]]></sql>
			<params>
				<param name="inCntrNo" type="12" value="" out="N"/>
				<param name="inCnmvYr" type="12" value="" out="N"/>
				<param name="inCnmvIdNo" type="12" value="" out="N"/>
				<param name="inMvmtStsCd" type="12" value="" out="N"/>
				<param name="inCntrTpszCd" type="12" value="" out="N"/>
				<param name="inBkgCgoTpCd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
