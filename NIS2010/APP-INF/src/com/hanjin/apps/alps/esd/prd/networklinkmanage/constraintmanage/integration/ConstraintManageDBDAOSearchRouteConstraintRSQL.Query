<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ConstraintManageDBDAOSearchRouteConstraintRSQL">
			<desc><![CDATA[SearchRouteConstraint]]></desc>
			<sql><![CDATA[
SELECT DELT_FLG, TRNK_LANE_CD, DIR_CD, POL_CD, POL_NOD_CD, ROUT_CNST_SEQ, N1ST_LANE_CD, N1ST_TS_PORT_CD,
       N2ND_LANE_CD, N2ND_TS_PORT_CD, N3RD_LANE_CD, POD_CD, POD_NOD_CD, DEL_CD, DEL_NOD_CD, SVC_USE_FLG,
       ROUT_CNST_RMK, CRE_DT, CRE_OFC_CD, CRE_USR_ID, UPD_DT, UPD_OFC_CD, UPD_USR_ID,
       CNTR_TP_CD, CMDT_CD, CMDT_NM, VVD
FROM (
      SELECT DELT_FLG, TRNK_LANE_CD,DIR_CD,
              SUBSTR(POL_NOD_CD, 1, 5) POL_CD, SUBSTR(POL_NOD_CD, 6) POL_NOD_CD, ROUT_CNST_SEQ, N1ST_LANE_CD, N1ST_TS_PORT_CD, N2ND_LANE_CD, N2ND_TS_PORT_CD, N3RD_LANE_CD,
              SUBSTR(POD_NOD_CD, 1, 5) POD_CD, SUBSTR(POD_NOD_CD, 6) POD_NOD_CD, SUBSTR(DEL_NOD_CD, 1, 5) DEL_CD, SUBSTR(DEL_NOD_CD,6) DEL_NOD_CD, SVC_USE_FLG, ROUT_CNST_RMK, TO_CHAR(CRE_DT, 'YYYY-MM-DD') CRE_DT, CRE_OFC_CD, CRE_USR_ID, 
              TO_CHAR(UPD_DT, 'YYYY-MM-DD') UPD_DT, UPD_OFC_CD, UPD_USR_ID,
              CNTR_TP_CD, CMDT_CD, (SELECT CMDT_NM FROM MDM_COMMODITY M WHERE M.CMDT_CD  = P.CMDT_CD) CMDT_NM,
              VSL_CD || SKD_VOY_NO || SKD_DIR_CD VVD
          FROM PRD_ROUT_CNST P
          WHERE DECODE(TRNK_LANE_CD,'ALL',@[tlane]||'%',TRNK_LANE_CD) LIKE @[tlane] ||'%' 
          AND POL_NOD_CD LIKE @[pol]||'%' 
          AND (NVL(N1ST_TS_PORT_CD, '#') LIKE @[tsport] ||'%' OR NVL(N2ND_TS_PORT_CD, '#') LIKE @[tsport] ||'%') 
          AND POD_NOD_CD LIKE @[pod] ||'%' 
          AND NVL(DEL_NOD_CD, '#') LIKE @[del] ||'%' 
          AND NVL(DELT_FLG,'N') = 'N'
          AND NVL(DIR_CD, '#') like @[dir_cd] ||'%'  --μ„ΈνΈ
          AND SVC_USE_FLG = DECODE(@[svc], 'A', SVC_USE_FLG, NULL, SVC_USE_FLG, @[svc] )
          AND NVL(CMDT_CD, 'X') = NVL(TRIM(@[cmdt_cd]), NVL(CMDT_CD, 'X')) 
          AND (   NVL(N1ST_LANE_CD, '#') = NVL(TRIM(@[vsl_slan_cd]), NVL(N1ST_LANE_CD,'#'))
               OR NVL(N2ND_LANE_CD, '#') = NVL(TRIM(@[vsl_slan_cd]), NVL(N2ND_LANE_CD,'#'))
               OR NVL(N3RD_LANE_CD, '#') = NVL(TRIM(@[vsl_slan_cd]), NVL(N3RD_LANE_CD,'#'))
              )
--          AND NVL(VSL_CD || SKD_VOY_NO || SKD_DIR_CD, '#') = NVL(TRIM(:vvd), NVL(VSL_CD || SKD_VOY_NO || SKD_DIR_CD,'#'))
          AND NVL(VSL_CD || SKD_VOY_NO || SKD_DIR_CD, '#') LIKE NVL(TRIM(@[vvd]), NVL(VSL_CD || SKD_VOY_NO || SKD_DIR_CD,'%'))
)
WHERE NVL(UPPER(CMDT_NM), '#') LIKE DECODE(TRIM(@[cmdt_nm]), NULL, '%', '%' || UPPER(TRIM(@[cmdt_nm])) || '%')			]]></sql>
			<params>
				<param name="tlane" type="12" value="" out="N"/>
				<param name="pol" type="12" value="" out="N"/>
				<param name="tsport" type="12" value="" out="N"/>
				<param name="pod" type="12" value="" out="N"/>
				<param name="del" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="svc" type="12" value="" out="N"/>
				<param name="cmdt_cd" type="12" value="" out="N"/>
				<param name="vsl_slan_cd" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="cmdt_nm" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
