<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChassisGensetSOManageDBDAOSearchChassisCorrectionListRSQL">
			<desc><![CDATA[f_cmd : SEARCH08
Chassis correction list retrieve]]></desc>
			<sql><![CDATA[
SELECT x.trsp_so_cmb_seq
      ,x.trsp_so_cmb_seq trsp_so_cmb_seq2
      ,x.trsp_so_cmb_tp_cd
	  ,x.trsp_so_cmb_tp_nm
      ,x.eq_no
      ,x.eq_tpsz_cd
   	  ,x.fm_nod_cd
   	  ,x.fm_loc_value
   	  ,x.fm_yard_value
   	  ,x.to_nod_cd
   	  ,x.to_loc_value
   	  ,x.to_yard_value
   	  ,x.trsp_crr_mod_cd
      ,x.vndr_seq
      ,x.vndr_abbr_nm
      ,x.lstm_cd
      ,x.ownr_co_cd
      ,x.usr_co_cd
      ,x.mvmt_sts_cd
      ,x.mvmt_sts_nm
      ,x.lst_sts_yd_cd
      ,x.mvmt_dt
   	  ,x.inter_rmk
   	  ,x.cntr_no
      ,x.cntr_tpsz_cd
      ,x.ref_bkg_no
      ,x.ref_bkg_no_split
   	  ,x.ref_bl_no
   	  ,x.org_gate_out_date
   	  ,x.org_gate_out_time
   	  ,x.dest_gate_in_date
      ,x.dest_gate_in_time
      ,x.spcl_instr_rmk
      ,x.trsp_so_ofc_cty_cd
      ,x.trsp_so_seq
      ,x.trsp_so_tp_cd
      ,x.trsp_so_sts_cd
   	  ,x.eq_knd_cd
   	  ,x.chss_mgst_trsp_tp_cd
   	  ,x.cre_ofc_cd
 	  ,x.cre_dt
      ,x.cre_usr_id
      ,x.upd_dt
      ,x.upd_usr_id
   	  ,x.isimport
  	  ,x.wo_issue
	  ,CASE WHEN wo_issue = 'N'
				THEN TO_NUMBER(SUBSTR(x.prd_dist, INSTR(x.prd_dist, '/') + 1))
            ELSE NVL(x.ttl_dist,0) 
       END AS ttl_dist
	  ,CASE WHEN wo_issue = 'N'
			  THEN SUBSTR(x.prd_disT, 1, INSTR(x.prd_dist, '/') - 1)
            ELSE x.lnk_dist_div_cd
       END AS lnk_dist_div_cd
FROM ( SELECT a.trsp_so_cmb_seq
      		  ,a.trsp_so_cmb_seq trsp_so_cmb_seq2
      		  ,a.trsp_so_cmb_tp_cd
			  ,DECODE(a.trsp_so_cmb_tp_cd,'BS','Stack','BF','Flatbed','') trsp_so_cmb_tp_nm
     		  ,a.eq_no
        	  ,a.eq_tpsz_cd
   		      ,a.fm_nod_cd
   		      ,SUBSTR (a.fm_nod_cd ,1 ,5) fm_loc_value
   		      ,SUBSTR (a.fm_nod_cd ,6 ,2) fm_yard_value
   		      ,a.to_nod_cd
   		      ,SUBSTR (a.to_nod_cd ,1 ,5) to_loc_value
   		      ,SUBSTR (a.to_nod_cd ,6 ,2) to_yard_value
   		      ,a.trsp_crr_mod_cd
    		  ,b.vndr_seq
     		  ,d.vndr_abbr_nm
     		  ,b.agmt_lstm_cd lstm_cd
     		  ,b.chss_ownr_co_cd ownr_co_cd
     		  ,b.lst_use_co_cd usr_co_cd
    		  ,b.chss_mvmt_sts_cd  mvmt_sts_cd
    		  ,c.mvmt_sts_nm
    		  ,e.sts_evnt_yd_cd lst_sts_yd_cd
    		  ,TO_CHAR (b.chss_mvmt_dt, 'YYYYMMDD') mvmt_dt
   		      ,a.inter_rmk
   		      ,a.cntr_no
    		  ,a.cntr_tpsz_cd
     		  ,a.ref_bkg_no
     		  ,'' ref_bkg_no_split
   		      ,a.ref_bl_no
   		      ,TO_CHAR (a.org_gate_out_dt, 'YYYY-MM-DD') org_gate_out_date
   		      ,TO_CHAR (a.org_gate_out_dt, 'HH24:MI:SS') org_gate_out_time
   		      ,TO_CHAR (a.dest_gate_in_dt, 'YYYY-MM-DD') dest_gate_in_date
    		  ,TO_CHAR (a.dest_gate_in_dt, 'HH24:MI:SS') dest_gate_in_time
    		  ,a.spcl_instr_rmk
    		  ,a.trsp_so_ofc_cty_cd
    		  ,a.trsp_so_seq
    		  ,a.trsp_so_tp_cd
    		  ,a.trsp_so_sts_cd
   		      ,a.eq_knd_cd
   		      ,a.chss_mgst_trsp_tp_cd
   		      ,a.cre_ofc_cd
 		      ,TO_CHAR (a.locl_cre_dt, 'YYYYMMDD') cre_dt
    		  ,a.cre_usr_id
     		  ,TO_CHAR (a.locl_upd_dt, 'YYYYMMDD') upd_dt
     		  ,a.upd_usr_id
   		      ,(CASE WHEN a.eq_no IS NULL
		 		        THEN 'T'
			     END) AS isimport
  		      ,DECODE (a.trsp_wo_seq ,NULL, 'N' ,'Y' ) wo_issue
			  ,NVL(a.ttl_dist,0) ttl_dist
			  ,a.lnk_dist_div_cd
			  ,TRS_COMMON_PKG.GET_PRD_DISTANCE_FNC (a.fm_nod_cd, a.to_nod_cd, a.via_nod_cd, a.dor_nod_cd, a.trsp_bnd_cd, a.trsp_cost_dtl_mod_cd, a.trsp_crr_mod_cd) prd_dist
 		  FROM trs_trsp_svc_ord a
 		      ,cgm_equipment b
 		      ,mdm_mvmt_sts c
 		      ,mdm_vendor d
		      ,cgm_eq_sts_his e
   		 WHERE a.eq_no = b.eq_no(+)  
   	 	   AND b.eq_no = e.eq_no(+) 
  		   AND b.eq_sts_seq = e.eq_sts_seq(+) 
 		   AND b.chss_mvmt_sts_cd = c.mvmt_sts_cd(+)
 		   AND b.vndr_seq = d.vndr_seq(+)
 		   AND a.trsp_so_sts_cd IN ('C', 'R')
		   AND a.eq_knd_cd = @[kind_chassis]
		#if (${fmdate} != '' && ${todate} != '') 
		   AND a.locl_cre_dt BETWEEN TO_DATE(@[fmdate]||'000001','YYYYMMDDHH24MISS') AND TO_DATE(@[todate]||'235959','YYYYMMDDHH24MISS')
		#end    
		#if (${trs_tp_cd} != 'ALL') 
			AND a.chss_mgst_trsp_tp_cd =@[trs_tp_cd]
		#end
		#if (${trs_md_cd} != 'ALL') 
 		   AND a.trsp_crr_mod_cd = @[trs_md_cd]
		#end
		#if (${trsp_so_fm_node} != '') 
 		    AND a.fm_nod_cd = @[trsp_so_fm_node]
		#end
		#if (${trsp_so_to_node} != '') 
			 AND a.to_nod_cd = @[trsp_so_to_node]
		#end
		#if($eq_no.size() > 0) 
		    AND a.eq_no IN (
			#foreach( ${key} in ${eq_no}) 
				#if($velocityCount < $eq_no.size()) 
					'$key', 
				#else 
					'$key' 
				#end 
			#end
				)
		#end
     		AND a.delt_flg <> 'Y'
		    AND a.hjl_no IS NULL  
	) x                                                                                                                                                                                                         
ORDER BY x.trsp_so_cmb_seq
        ,x.eq_no			]]></sql>
			<params>
				<param name="kind_chassis" type="12" value=" " out="N"/>
				<param name="fmdate" type="12" value="" out="N"/>
				<param name="todate" type="12" value="" out="N"/>
				<param name="trs_tp_cd" type="12" value="" out="N"/>
				<param name="trs_md_cd" type="12" value="" out="N"/>
				<param name="trsp_so_fm_node" type="12" value="" out="N"/>
				<param name="trsp_so_to_node" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
