<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DOFChgTrfmanageDBDAOmultiDofChgTrfCSQL">
			<desc><![CDATA[Drop Off Charge Tariff 등록]]></desc>
			<sql><![CDATA[
MERGE INTO TRS_DRFF_CHG_TRF T
USING (
    SELECT @[effdt] EFF_DT, @[fm_loc_cd] FM_LOC_CD, @[cntr_tp_cd] CNTR_TP_CD, @[conti_cd] CONTI_CD,
           @[chrr_frt_tax_val] CHRR_FRT_TAX_VAL, @[curr_cd] CURR_CD,@[cust_rmk] CUST_RMK,
           @[ctrl_ofc_cd] CRE_OFC_CD, @[ctrl_user_id] CRE_USR_ID
           ,SUBSTR(@[cust_info],0,2) CNT_CD, SUBSTR(@[cust_info],3) CUST_SEQ
           ,@[conti_cd_old] CONTI_CD_OLD, @[newEffDate] NEW_EFF_DT
      FROM DUAL 
) D
ON ( to_char(T.eff_dt,'YYYYMMDD') = NEW_EFF_DT   AND T.FM_LOC_CD =D.FM_LOC_CD 
     AND T.CNT_CD = D.CNT_CD AND T.CUST_SEQ =D.CUST_SEQ  
     AND T.CNTR_TP_CD = D.CNTR_TP_CD AND T.CONTI_CD =D.CONTI_CD )
WHEN MATCHED THEN 
UPDATE SET 
    cust_rmk = @[cust_rmk]  
   ,CHRR_FRT_TAX_VAL = @[chrr_frt_tax_val]	        
   ,upd_usr_id = @[ctrl_user_id]  
   ,upd_dt = sysdate     

WHEN NOT MATCHED THEN 
INSERT ( EFF_DT, FM_LOC_CD, CNT_CD, CUST_SEQ, CONTI_CD, CNTR_TP_CD   
,CHRR_FRT_TAX_VAL ,CURR_CD ,CRE_USR_ID ,CRE_DT     
,UPD_USR_ID ,UPD_DT ,CUST_RMK,CRE_OFC_CD )
VALUES ( to_date( @[newEffDate]||'000000', 'YYYYMMDDHH24MISS'), @[fm_loc_cd],substr(@[cust_info],0,2), substr(@[cust_info],3), @[conti_cd], @[cntr_tp_cd],
@[chrr_frt_tax_val], @[curr_cd], @[ctrl_user_id], sysdate,     
@[ctrl_user_id], sysdate, @[cust_rmk], @[ctrl_ofc_cd] )			]]></sql>
			<params>
				<param name="effdt" type="12" value="" out="N"/>
				<param name="fm_loc_cd" type="12" value="a" out="N"/>
				<param name="cntr_tp_cd" type="12" value="d" out="N"/>
				<param name="conti_cd" type="12" value="c" out="N"/>
				<param name="chrr_frt_tax_val" type="2" value="123.1" out="N"/>
				<param name="curr_cd" type="12" value="" out="N"/>
				<param name="cust_rmk" type="12" value="b" out="N"/>
				<param name="ctrl_ofc_cd" type="12" value="c" out="N"/>
				<param name="ctrl_user_id" type="12" value="a" out="N"/>
				<param name="cust_info" type="12" value="abcdefg" out="N"/>
				<param name="conti_cd_old" type="12" value="" out="N"/>
				<param name="newEffDate" type="12" value="20090909" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
