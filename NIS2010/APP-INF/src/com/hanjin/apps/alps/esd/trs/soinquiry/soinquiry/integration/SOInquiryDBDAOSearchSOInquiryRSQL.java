/*=========================================================
*Copyright(c) 2018 CyberLogitec
*@FileName : SOInquiryDBDAOSearchSOInquiryRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2018.03.05
*@LastModifier : 
*@LastVersion : 1.0
* 2018.03.05 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esd.trs.soinquiry.soinquiry.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class SOInquiryDBDAOSearchSOInquiryRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * S/O Inquiry
	  * 2012.10.30 김기택 [CHM-201220924] CNG_RSN_DESC 컬럼 추가
	  * 2013.01.08 신용찬 [CHM-201322296] reason 컬럼 로직 변경
	  * </pre>
	  */
	public SOInquiryDBDAOSearchSOInquiryRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("spot_bid_flg",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_provider",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_transmode",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_boundmode",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_sotype",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_user_id",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_door_node",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_via_node",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_costmode",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_to_date",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_invoicemode",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_to_node",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_unplanned",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_from_node",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("spot_bid_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_prepull",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_from_date",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esd.trs.soinquiry.soinquiry.integration").append("\n"); 
		query.append("FileName : SOInquiryDBDAOSearchSOInquiryRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if (${hid_dom_usrail} == 'Y') " ).append("\n"); 
		query.append("WITH SRC AS (" ).append("\n"); 
		query.append("    SELECT SO.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("          ,SO.TRSP_SO_SEQ" ).append("\n"); 
		query.append("      FROM DOM_RAIL_SO_MST SO" ).append("\n"); 
		query.append("          ,DOM_RAIL_SO_DTL VNDR" ).append("\n"); 
		query.append("          ,TRS_TRSP_RAIL_INV_WRK WRK" ).append("\n"); 
		query.append("          ,TRS_TRSP_RAIL_INV_DTL WDTL" ).append("\n"); 
		query.append("     WHERE SO.TRSP_SO_OFC_CTY_CD  = VNDR.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("       AND SO.TRSP_SO_SEQ         = VNDR.TRSP_SO_SEQ" ).append("\n"); 
		query.append("       AND SO.TRSP_SO_OFC_CTY_CD  = WDTL.TRSP_SO_OFC_CTY_CD(+)" ).append("\n"); 
		query.append("       AND SO.TRSP_SO_SEQ         = WDTL.TRSP_SO_SEQ(+)" ).append("\n"); 
		query.append("       AND WDTL.INV_NO            = WRK.INV_NO(+)" ).append("\n"); 
		query.append("       AND WDTL.INV_VNDR_SEQ      = WRK.INV_VNDR_SEQ(+)" ).append("\n"); 
		query.append("       AND SO.DMST_SO_STS_CD      <> 'D' -- SO 삭제 제외" ).append("\n"); 
		query.append("       AND SO.DMST_EDI_STS_CD     = 'C'  -- COMPLETE ACK" ).append("\n"); 
		query.append("       AND SO.DMST_EDI_SND_CD     = 'S'  -- 404 EDI SUCESS" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_trunk_vvd.size() > 0) " ).append("\n"); 
		query.append("       AND ((SO.VSL_CD, SO.SKD_VOY_NO, SO.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_trunk_vvd}) " ).append("\n"); 
		query.append("         #if($velocityCount == 1) " ).append("\n"); 
		query.append("            ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("          , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("         )" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_bkgnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.DMST_BKG_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_bkgnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_bkgnumber.size()) " ).append("\n"); 
		query.append("            UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_eqnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.CNTR_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_eqnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_eqnumber.size()) " ).append("\n"); 
		query.append("           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("      #if (${r_radio_eq} == 'CNTR') " ).append("\n"); 
		query.append("        AND 1=1" ).append("\n"); 
		query.append("      #elseif (${r_radio_eq} == 'CHS') " ).append("\n"); 
		query.append("        AND 1=2" ).append("\n"); 
		query.append("      #elseif (${r_radio_eq} == 'GEN') " ).append("\n"); 
		query.append("        AND 1=2" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_sotype} != '' && ${r_sotype} != 'ALL')" ).append("\n"); 
		query.append("      AND 'D' = @[r_sotype]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_period} == 'S') " ).append("\n"); 
		query.append("      #if (${r_from_date} != ''|| ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND SO.CRE_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmdd') AND TO_DATE (@[r_to_date], 'rrrrmmdd') + 0.999999" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'W')" ).append("\n"); 
		query.append("      AND 1=2" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'I')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND WRK.INV_CFM_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'O')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND 1=2" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #elseif (${r_period} == 'L')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND 1=2" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #elseif (${r_period} == 'D')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND 1=2" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_somode} == 'LV') " ).append("\n"); 
		query.append("       AND SO.DELT_FLG = 'N'" ).append("\n"); 
		query.append("    #elseif (${r_somode}=='DL')" ).append("\n"); 
		query.append("       AND SO.DELT_FLG = 'Y'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_invoicemode} != '' && ${r_invoicemode} != 'ALL')" ).append("\n"); 
		query.append("      #if (${r_invoicemode} == 'NL') " ).append("\n"); 
		query.append("        AND WRK.TRSP_INV_AUD_STS_CD IS NULL" ).append("\n"); 
		query.append("      #else" ).append("\n"); 
		query.append("        AND WRK.TRSP_INV_AUD_STS_CD = @[r_invoicemode]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_user_id} != '')" ).append("\n"); 
		query.append("       AND 1=2" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_costmode} != '' && ${r_costmode} != 'ALL')" ).append("\n"); 
		query.append("      AND 'CY' = @[r_costmode]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_transmode} != '' && ${r_transmode} != 'ALL')" ).append("\n"); 
		query.append("      AND 'RD' = @[r_transmode]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_provider} != '' && ${r_provider} != 'ALL') " ).append("\n"); 
		query.append("      #if (${r_provider_type} == 'WO') " ).append("\n"); 
		query.append("        AND VNDR.VNDR_SEQ = @[r_provider]" ).append("\n"); 
		query.append("      #elseif (${r_provider_type} == 'PA') " ).append("\n"); 
		query.append("        AND VNDR.VNDR_SEQ IN ( SELECT PV.VNDR_SEQ" ).append("\n"); 
		query.append("                                 FROM MDM_VENDOR PV" ).append("\n"); 
		query.append("                                WHERE PV.PRNT_VNDR_SEQ = @[r_provider] ) " ).append("\n"); 
		query.append("      #elseif (${r_provider_type} == 'IV') " ).append("\n"); 
		query.append("        AND VNDR.INV_VNDR_SEQ = @[r_provider]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_from_node} != '') " ).append("\n"); 
		query.append("      AND VNDR.FM_YD_CD LIKE @[r_from_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_via_node} != '') " ).append("\n"); 
		query.append("      AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_to_node} != '') " ).append("\n"); 
		query.append("      AND VNDR.TO_YD_CD LIKE @[r_to_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_door_node} != '') " ).append("\n"); 
		query.append("      AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_sonumber.size() > 0) " ).append("\n"); 
		query.append("      AND ((SO.TRSP_SO_OFC_CTY_CD, SO.TRSP_SO_SEQ) IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_sonumber}) " ).append("\n"); 
		query.append("          #if($velocityCount == 1) " ).append("\n"); 
		query.append("             ( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #else" ).append("\n"); 
		query.append("            ,( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        ) " ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_wonumber.size() > 0) " ).append("\n"); 
		query.append("      AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_invoicenumber.size() > 0) " ).append("\n"); 
		query.append("       AND VNDR.INV_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} IN ${r_invoicenumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_invoicenumber.size()) " ).append("\n"); 
		query.append("            '${key}'," ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("            '${key}'" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_unplanned} != '' && ${r_unplanned} != 'ALL')" ).append("\n"); 
		query.append("       AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_zip_code.size() > 0) " ).append("\n"); 
		query.append("       AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_amount} == 'T')" ).append("\n"); 
		query.append("       AND WRK.INV_NO IS NOT NULL" ).append("\n"); 
		query.append("       AND NVL(WDTL.INV_ETC_ADD_AMT,0) = 0" ).append("\n"); 
		query.append("    #elseif (${r_amount} == 'F')" ).append("\n"); 
		query.append("       AND WRK.INV_NO IS NOT NULL" ).append("\n"); 
		query.append("       AND NVL(WDTL.INV_ETC_ADD_AMT,0) <> 0" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${opener} == 'chreport')" ).append("\n"); 
		query.append("       AND SO.TRSP_SO_SEQ=0" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${grid_flg} == 'Y')" ).append("\n"); 
		query.append("       AND ROWNUM < 2001" ).append("\n"); 
		query.append("    #end  " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${grid_flg} != 'Y')" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("'EQ No.'" ).append("\n"); 
		query.append(",'TP/SZ'" ).append("\n"); 
		query.append(",'Org TP/SZ'" ).append("\n"); 
		query.append(",'Cost Mode'" ).append("\n"); 
		query.append(",'Trans Mode'" ).append("\n"); 
		query.append(",'S/O TP'" ).append("\n"); 
		query.append(",'Unplanned'" ).append("\n"); 
		query.append("-- 2012.10.31 Pre-Pull" ).append("\n"); 
		query.append(",'Pre-Pull'" ).append("\n"); 
		query.append(",'CB'" ).append("\n"); 
		query.append(",'Frustrated'" ).append("\n"); 
		query.append(",'Block Stowage'" ).append("\n"); 
		query.append(",'S/O No.'" ).append("\n"); 
		query.append(",'S/O CRE DT'" ).append("\n"); 
		query.append(",'S/O DEL'" ).append("\n"); 
		query.append(",'S/O DEL DT'" ).append("\n"); 
		query.append(",'S/O UPD Name'" ).append("\n"); 
		query.append(",'W/O No.'" ).append("\n"); 
		query.append(",'W/O Iss STS'" ).append("\n"); 
		query.append(",'W/O Iss WK'" ).append("\n"); 
		query.append(",'W/O Iss DT'" ).append("\n"); 
		query.append(",'W/O ISS TP'" ).append("\n"); 
		query.append(",'W/O ISS OFC'" ).append("\n"); 
		query.append(",'W/O ISS Name'" ).append("\n"); 
		query.append("--,'Flag'" ).append("\n"); 
		query.append("--,'Type'" ).append("\n"); 
		query.append("--,'Flag'" ).append("\n"); 
		query.append("--,'Type'" ).append("\n"); 
		query.append("--,'Count'" ).append("\n"); 
		query.append(",'From'" ).append("\n"); 
		query.append(",'Via'" ).append("\n"); 
		query.append(",'To'" ).append("\n"); 
		query.append(",'Door'" ).append("\n"); 
		query.append(",'Km'" ).append("\n"); 
		query.append(",'R.Link'" ).append("\n"); 
		query.append(",'Bid'" ).append("\n"); 
		query.append(",'Bid No'" ).append("\n"); 
		query.append(",'Due Date'" ).append("\n"); 
		query.append(",'Due Date'" ).append("\n"); 
		query.append(",'Actual Customer'" ).append("\n"); 
		query.append(",'Factory Name'" ).append("\n"); 
		query.append(",'Zip Code'" ).append("\n"); 
		query.append(",'Address'" ).append("\n"); 
		query.append(",'TEL'" ).append("\n"); 
		query.append(",'FAX'" ).append("\n"); 
		query.append(",'PIC'" ).append("\n"); 
		query.append(",'User Info'" ).append("\n"); 
		query.append(",'Time'" ).append("\n"); 
		query.append(",'Time'" ).append("\n"); 
		query.append(",'Code'" ).append("\n"); 
		query.append(",'Name'" ).append("\n"); 
		query.append(",'Code'" ).append("\n"); 
		query.append(",'Name'" ).append("\n"); 
		query.append(",'W/O RCV DT'" ).append("\n"); 
		query.append(",'Appt. Time'" ).append("\n"); 
		query.append(",'Deliv. Time'" ).append("\n"); 
		query.append(",'Receiving'" ).append("\n"); 
		query.append(",'Delivery'" ).append("\n"); 
		query.append(",'3rd Party'" ).append("\n"); 
		query.append(",'Cost OFC'" ).append("\n"); 
		query.append(",'Rate Type'" ).append("\n"); 
		query.append(",'CNT Type'" ).append("\n"); 
		query.append(",'Currency'" ).append("\n"); 
		query.append(",'Basic'" ).append("\n"); 
		query.append(",'Negotiated'" ).append("\n"); 
		query.append(",'Fuel'" ).append("\n"); 
		query.append(",'Vat'" ).append("\n"); 
		query.append("#if (${invar_usrail} == 'N' && ${hid_dom_usrail} == 'N') " ).append("\n"); 
		query.append(",'Toll Fee'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",'Additional'" ).append("\n"); 
		query.append("-- 20100806 ADD HZD_MTRL_SCG_AMT, OVR_WGT_SCG_AMT" ).append("\n"); 
		query.append("#if (${invar_usrail} == 'Y' || ${hid_dom_usrail} == 'Y') " ).append("\n"); 
		query.append(",'HZD'" ).append("\n"); 
		query.append(",'OVR'" ).append("\n"); 
		query.append(",'USA Rail Surcharge'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("--" ).append("\n"); 
		query.append(",'Total'" ).append("\n"); 
		query.append(",'W/O Amount Total(USD)'" ).append("\n"); 
		query.append(",'Exchange Rate'" ).append("\n"); 
		query.append(",'Calculation Logic'" ).append("\n"); 
		query.append(",'Currency'" ).append("\n"); 
		query.append(",'Basic'" ).append("\n"); 
		query.append(",'Surcharge'" ).append("\n"); 
		query.append(",'Total'" ).append("\n"); 
		query.append(",'Invoice Amount Total(USD)'" ).append("\n"); 
		query.append(",'Code'" ).append("\n"); 
		query.append(",'Name'" ).append("\n"); 
		query.append(",'Invoice No.'" ).append("\n"); 
		query.append(",'INV STS'" ).append("\n"); 
		query.append(",'INV CNFM DT'" ).append("\n"); 
		query.append(",'CSR No.'" ).append("\n"); 
		query.append(",'INV I/F DT'" ).append("\n"); 
		query.append(",'INV OFC'" ).append("\n"); 
		query.append(",'INV User'" ).append("\n"); 
		query.append(",'Invoice Remark'" ).append("\n"); 
		query.append(",'From Departure'" ).append("\n"); 
		query.append(",'To Arrival'" ).append("\n"); 
		query.append(",'Door Arrival'" ).append("\n"); 
		query.append(",'TRO Door Date'" ).append("\n"); 
		query.append(",'COP No.'" ).append("\n"); 
		query.append(",'A/G SEQ'" ).append("\n"); 
		query.append(",'A/G Code'" ).append("\n"); 
		query.append(",'BKG No.'" ).append("\n"); 
		query.append(",'BL No.'" ).append("\n"); 
		query.append(",'BND'" ).append("\n"); 
		query.append(",'Term'" ).append("\n"); 
		query.append(",'SEQ'" ).append("\n"); 
		query.append(",'CNFM'" ).append("\n"); 
		query.append(",'Office'" ).append("\n"); 
		query.append(",'User ID'" ).append("\n"); 
		query.append(",'Time'" ).append("\n"); 
		query.append(",'T1 Document'" ).append("\n"); 
		query.append(",'Rev Curr'" ).append("\n"); 
		query.append(",'Rev Amt'" ).append("\n"); 
		query.append(",'Manifested'" ).append("\n"); 
		query.append(",'Load Ref No'" ).append("\n"); 
		query.append(",'BKG QTY'" ).append("\n"); 
		query.append(",'POR'" ).append("\n"); 
		query.append(",'POL'" ).append("\n"); 
		query.append(",'POD'" ).append("\n"); 
		query.append(",'DEL'" ).append("\n"); 
		query.append(",'T.VVD'" ).append("\n"); 
		query.append(",'Lane'" ).append("\n"); 
		query.append(",'In VVD'" ).append("\n"); 
		query.append(",'In VVD Lane'" ).append("\n"); 
		query.append(",'Out VVD'" ).append("\n"); 
		query.append(",'Out VVD Lane'" ).append("\n"); 
		query.append(",'CGO TP'" ).append("\n"); 
		query.append(",'CNTR SPE'" ).append("\n"); 
		query.append(",'Used'" ).append("\n"); 
		query.append(",'L/T'" ).append("\n"); 
		query.append(",'I.Exit'" ).append("\n"); 
		query.append(",'L/T EXP'" ).append("\n"); 
		query.append(",'Seal No.1'" ).append("\n"); 
		query.append(",'Seal No.2'" ).append("\n"); 
		query.append(",'Weight(KGS)'" ).append("\n"); 
		query.append(",'Weight(LBS)'" ).append("\n"); 
		query.append(",'No of PKG'" ).append("\n"); 
		query.append(",'PKG CD'" ).append("\n"); 
		query.append(",'Commodity DESC'" ).append("\n"); 
		query.append(",'C.LOC'" ).append("\n"); 
		query.append(",'USA Last City'" ).append("\n"); 
		query.append(",'F'" ).append("\n"); 
		query.append(",'O'" ).append("\n"); 
		query.append(",'C'" ).append("\n"); 
		query.append(",'IT No'" ).append("\n"); 
		query.append(",'Pickup No.'" ).append("\n"); 
		query.append(",'PU Yard'" ).append("\n"); 
		query.append(",'Available DT'" ).append("\n"); 
		query.append(",'Last Free DT'" ).append("\n"); 
		query.append(",'S/C No.'" ).append("\n"); 
		query.append(",'RFA No.'" ).append("\n"); 
		query.append(",'Contract Customer Name'" ).append("\n"); 
		query.append(",'Door SVC TP'" ).append("\n"); 
		query.append(",'Pickup CNTR'" ).append("\n"); 
		query.append(",'Shipper'" ).append("\n"); 
		query.append(",'Consignee'" ).append("\n"); 
		query.append(",'Notify'" ).append("\n"); 
		query.append(",'Ref.BKG No'" ).append("\n"); 
		query.append(",'Ref.BL No'" ).append("\n"); 
		query.append(",'Outgate Date'" ).append("\n"); 
		query.append(",'Ingate Date'" ).append("\n"); 
		query.append(",'MTY Reference No'" ).append("\n"); 
		query.append(",'Reason'" ).append("\n"); 
		query.append(",'Internal Remark'" ).append("\n"); 
		query.append(",'Nego. Remark'" ).append("\n"); 
		query.append("-- 2012.10.30 KTKIM 컬럼 추가 start" ).append("\n"); 
		query.append(",'Reason of Node Change'" ).append("\n"); 
		query.append("-- 2012.10.30 KTKIM 컬럼 추가 end" ).append("\n"); 
		query.append(",'Special Instruction'" ).append("\n"); 
		query.append(",'W/O Instruction'" ).append("\n"); 
		query.append(",'CHZ Bundle'" ).append("\n"); 
		query.append(",'Supplement Kind'" ).append("\n"); 
		query.append("#if (${invar_usdropnpull} == 'Y') " ).append("\n"); 
		query.append("--추가yj" ).append("\n"); 
		query.append(",'Date'" ).append("\n"); 
		query.append(",'Yard'" ).append("\n"); 
		query.append(",'Status'" ).append("\n"); 
		query.append(",'Date'" ).append("\n"); 
		query.append(",'Yard'" ).append("\n"); 
		query.append(",'Status'" ).append("\n"); 
		query.append(",'Date'" ).append("\n"); 
		query.append(",'Yard'" ).append("\n"); 
		query.append(",'WEB Mty'" ).append("\n"); 
		query.append(",'Grace End'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",'GP ID'" ).append("\n"); 
		query.append(",'GP Seq'" ).append("\n"); 
		query.append(",'ETS'" ).append("\n"); 
		query.append(",'HJL Handling Fee'" ).append("\n"); 
		query.append("FROM DUAL" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${invar_usrail} == 'N' && ${hid_dom_usrail} == 'N') " ).append("\n"); 
		query.append("/* S/O inquiry */" ).append("\n"); 
		query.append("SELECT X.EQ_NO" ).append("\n"); 
		query.append("      ,X.EQ_TPSZ" ).append("\n"); 
		query.append("      ,X.ORG_EQ_TPSZ AS ORG_EQ_TPSZ" ).append("\n"); 
		query.append("      ,X.TRSP_COST_DTL_MOD_CD" ).append("\n"); 
		query.append("      ,X.TRSP_CRR_MOD_CD" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00279' AND CD.INTG_CD_VAL_CTNT = X.TRSP_SO_TP_CD) AS TRSP_SO_TP_CD" ).append("\n"); 
		query.append("      ,X.UPLN_SO_FLG" ).append("\n"); 
		query.append("      ,X.PRE_PULL_FLG" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00762' AND CD.INTG_CD_VAL_CTNT = X.BKG_CNTR_CMB_SEQ) AS BKG_CNTR_CMB_SEQ" ).append("\n"); 
		query.append("      ,X.TRSP_FRST_FLG" ).append("\n"); 
		query.append("	  ,(SELECT B.BLCK_STWG_CD FROM BKG_BOOKING B WHERE B.BKG_NO = X.BKG_NO) AS BLCK_STWG" ).append("\n"); 
		query.append("      ,X.SO_NO" ).append("\n"); 
		query.append("      ,X.SO_CRE_DT1" ).append("\n"); 
		query.append("      ,X.SO_DEL_FLG" ).append("\n"); 
		query.append("      ,DECODE (X.SO_DEL_FLG,'Y', SO_UPD_DT) SO_DEL_DT" ).append("\n"); 
		query.append("      ,(SELECT USR_NM FROM COM_USER CU WHERE CU.USR_ID = X.UPD_USR_ID) AS UPD_USR_NM" ).append("\n"); 
		query.append("      ,X.WO_NO" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00804' AND CD.INTG_CD_VAL_CTNT = X.WO_ISS_STS_CD) AS WO_ISS_STS_CD" ).append("\n"); 
		query.append("      ,X.WO_ISS_WK" ).append("\n"); 
		query.append("      ,X.WO_ISS_DT" ).append("\n"); 
		query.append("      ,X.WO_ISS_TP" ).append("\n"); 
		query.append("      ,X.WO_ISS_OFC_CD" ).append("\n"); 
		query.append("      ,(SELECT USR_NM FROM COM_USER CU WHERE CU.USR_ID = X.WO_ISS_ID) AS WO_ISS_NM" ).append("\n"); 
		query.append("      --,X.AGMT_CNT_FLG" ).append("\n"); 
		query.append("      --,X.AGMT_CNT_TP_CD" ).append("\n"); 
		query.append("      --,X.CNT_FLG" ).append("\n"); 
		query.append("      --,X.CNT_TP_CD" ).append("\n"); 
		query.append("      --,TO_CHAR(X.CTRT_CNT) CTRT_CNT" ).append("\n"); 
		query.append("      ,X.FM_NOD_CD" ).append("\n"); 
		query.append("      ,X.VIA_NOD_CD" ).append("\n"); 
		query.append("      ,X.TO_NOD_CD" ).append("\n"); 
		query.append("      ,X.DOOR" ).append("\n"); 
		query.append("      ,TO_CHAR(X.TTL_DIST) TTL_DIST" ).append("\n"); 
		query.append("      ,X.LNK_DIST_DIV_CD" ).append("\n"); 
		query.append("      ,X.SPOT_BID_FLG" ).append("\n"); 
		query.append("      ,X.SPOT_BID_NO" ).append("\n"); 
		query.append("      ,X.SPOT_BID_DUE_DT" ).append("\n"); 
		query.append("      ,X.SPOT_BID_DUE_DT_HMS" ).append("\n"); 
		query.append("      ,CASE WHEN SUBSTR(X.USA_DO_INFO, 1, INSTR(X.USA_DO_INFO, '$', 1, 1) -1) = 'W'" ).append("\n"); 
		query.append("            THEN 'WEB'" ).append("\n"); 
		query.append("            WHEN SUBSTR(X.USA_DO_INFO, 1, INSTR(X.USA_DO_INFO, '$', 1, 1) -1) = 'E'" ).append("\n"); 
		query.append("            THEN 'TRS D/O'" ).append("\n"); 
		query.append("            ELSE X.DOOR_ACT_CUST" ).append("\n"); 
		query.append("       END DOOR_ACT_CUST" ).append("\n"); 
		query.append("      ,REPLACE(REPLACE(REPLACE(X.DOOR_FCTRY_NM, CHR(13), ' '), CHR(10), ' '), CHR(34), '') AS DOOR_FCTRY_NM" ).append("\n"); 
		query.append("      ,X.DOOR_ZIP" ).append("\n"); 
		query.append("      ,REPLACE(REPLACE(REPLACE(X.DOR_DE_ADDR, CHR(13), ' '), CHR(10), ' '), CHR(34), '') AS DOR_DE_ADDR" ).append("\n"); 
		query.append("      ,X.DOOR_TEL" ).append("\n"); 
		query.append("      ,X.DOOR_FAX" ).append("\n"); 
		query.append("      ,REPLACE(REPLACE(REPLACE(X.DOOR_PIC, CHR(13), ' '), CHR(10), ' '), CHR(34), '') AS DOOR_PIC" ).append("\n"); 
		query.append("      ,CASE WHEN SUBSTR(X.USA_DO_INFO, 1, INSTR(X.USA_DO_INFO, '$', 1, 1) - 1) = 'W' -- IF_SYS_KND_CD" ).append("\n"); 
		query.append("            THEN SUBSTR(X.USA_DO_INFO, INSTR(X.USA_DO_INFO, '$', 1, 2) + 1, INSTR(X.USA_DO_INFO, '$', 1, 3) - INSTR(X.USA_DO_INFO, '$', 1, 2) - 1) -- EMAIL, TEL" ).append("\n"); 
		query.append("            ELSE SUBSTR(X.USA_DO_INFO, INSTR(X.USA_DO_INFO, '$', 1, 3) + 1) -- USER_ID" ).append("\n"); 
		query.append("       END USA_DO_USR_INFO" ).append("\n"); 
		query.append("      ,TO_CHAR(TO_DATE(SUBSTR(X.USA_DO_INFO, INSTR(X.USA_DO_INFO, '$', 1, 1) + 1, INSTR(X.USA_DO_INFO, '$', 1, 2) - INSTR(X.USA_DO_INFO, '$', 1, 1) - 1),'YYYYMMDDHH24MISS'),'YYYY-MM-DD') AS DO_CRE_DATE" ).append("\n"); 
		query.append("      ,TO_CHAR(TO_DATE(SUBSTR(X.USA_DO_INFO, INSTR(X.USA_DO_INFO, '$', 1, 1) + 1, INSTR(X.USA_DO_INFO, '$', 1, 2) - INSTR(X.USA_DO_INFO, '$', 1, 1) - 1),'YYYYMMDDHH24MISS'),'HH24:MI:SS') AS DO_CRE_TIME" ).append("\n"); 
		query.append("--      ,X.VNDR_TP_CD" ).append("\n"); 
		query.append("      ,SUBSTR(X.INV_VNDR_INFO, 1, INSTR(X.INV_VNDR_INFO, '$', 1, 1) - 1) AS VNDR_CD" ).append("\n"); 
		query.append("      ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 1) + 1, INSTR(X.INV_VNDR_INFO, '$', 1, 2) - INSTR(X.INV_VNDR_INFO, '$', 1, 1) - 1) AS VNDR_ABBR_NM" ).append("\n"); 
		query.append("      ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 2) + 1, INSTR(X.INV_VNDR_INFO, '$', 1, 3) - INSTR(X.INV_VNDR_INFO, '$', 1, 2) - 1) AS PVNDR_CD" ).append("\n"); 
		query.append("      ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 3) + 1) AS PVNDR_NM" ).append("\n"); 
		query.append("      ,X.WO_RCV_DT" ).append("\n"); 
		query.append("      ,X.APPT_TIME" ).append("\n"); 
		query.append("      ,X.DELIV_TIME" ).append("\n"); 
		query.append("      ,X.WTR_RCV_TERM_CD   " ).append("\n"); 
		query.append("      ,X.WTR_DE_TERM_CD" ).append("\n"); 
		query.append("      ,X.N3PTY_BIL_FLG" ).append("\n"); 
		query.append("      ,CASE WHEN X.COST_OFC_CD_CN IS NOT NULL" ).append("\n"); 
		query.append("            THEN X.COST_OFC_CD_CN" ).append("\n"); 
		query.append("            WHEN X.COST_OFC_CD_M IS NOT NULL" ).append("\n"); 
		query.append("            THEN X.COST_OFC_CD_M" ).append("\n"); 
		query.append("            ELSE X.SO_CRE_OFC_CD" ).append("\n"); 
		query.append("        END COST_OFC_CD" ).append("\n"); 
		query.append("      ,X.TRSP_AGMT_WY_TP_NM" ).append("\n"); 
		query.append("      ,X.AGMT_CNT_TP_CD" ).append("\n"); 
		query.append("      ,X.WO_CURR_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_BZC_AMT) WO_BZC_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_NEGO_AMT) WO_NEGO_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_FUEL_SCG_AMT) WO_FUEL_SCG_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_VAT_SCG_AMT) WO_VAT_SCG_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_TOLL_FEE_AMT) WO_TOLL_FEE_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_ETC_ADD_AMT) WO_ETC_ADD_AMT --additional " ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_TOT_AMT) WO_TOT_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_TOT_AMT_USD) WO_TOT_AMT_USD" ).append("\n"); 
		query.append("      ,TO_CHAR(X.INV_XCH_RT) INV_XCH_RT" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00874' AND CD.INTG_CD_VAL_CTNT = X.INV_CALC_LGC_TP_CD) AS INV_CALC_LGC_TP_CD" ).append("\n"); 
		query.append("      ,X.INV_CURR_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(X.INV_BZC_AMT) INV_BZC_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.INV_ETC_ADD_AMT) INV_ETC_ADD_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.INV_TOT_AMT) INV_TOT_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.INV_TOT_AMT_USD) INV_TOT_AMT_USD" ).append("\n"); 
		query.append("      ,TO_CHAR(X.INV_VNDR_SEQ) INV_VNDR_CD" ).append("\n"); 
		query.append("      ,X.INV_VNDR_NM" ).append("\n"); 
		query.append("      ,X.INV_NO" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00824' AND CD.INTG_CD_VAL_CTNT = X.INV_STS_CD) AS INV_STS_CD" ).append("\n"); 
		query.append("      ,X.INV_CFM_DT" ).append("\n"); 
		query.append("      ,X.CSR_NO CAR_NO" ).append("\n"); 
		query.append("      ,TO_CHAR (X.IF_DT, 'YYYY-MM-DD HH24:MI:SS') INV_IF_DT" ).append("\n"); 
		query.append("      ,X.INV_CFM_OFC_CD" ).append("\n"); 
		query.append("      ,(SELECT USR_NM FROM COM_USER CU WHERE CU.USR_ID = X.INV_CRE_USR_ID) AS INV_CRE_USR_NM" ).append("\n"); 
		query.append("      ,REPLACE(REPLACE(X.INV_RMK , CHR(13), ' '), CHR(10), ' ') INV_RMK" ).append("\n"); 
		query.append("      ,X.N1ST_NOD_PLN_DT" ).append("\n"); 
		query.append("      ,X.LST_NOD_PLN_DT" ).append("\n"); 
		query.append("      ,X.DOR_NOD_PLN_DT" ).append("\n"); 
		query.append("      ,X.DOR_ARR_DT" ).append("\n"); 
		query.append("      ,X.COP_NO" ).append("\n"); 
		query.append("      ,TO_CHAR(X.AG_SEQ) AG_SEQ" ).append("\n"); 
		query.append("      ,X.AG_CODE" ).append("\n"); 
		query.append("      ,X.BKG_NO" ).append("\n"); 
		query.append("      ,X.BL_NO" ).append("\n"); 
		query.append("      ,X.TRSP_BND_CD" ).append("\n"); 
		query.append("      ,X.TERM" ).append("\n"); 
		query.append("      ,TO_CHAR(X.TRO_SEQ) TRO_SEQ" ).append("\n"); 
		query.append("      ,X.TRO_CNFM" ).append("\n"); 
		query.append("      ,X.TRO_CFM_OFC" ).append("\n"); 
		query.append("      ,X.TRO_CFM_USR" ).append("\n"); 
		query.append("      ,X.TRO_CFM_UPD" ).append("\n"); 
		query.append("      ,X.T1_DOC_FLG " ).append("\n"); 
		query.append("      ,X.TRO_REV_CUR     " ).append("\n"); 
		query.append("      ,SUBSTR(X.EUR_TRO_INFO, INSTR(X.EUR_TRO_INFO, '$', 1, 1) + 1, INSTR(X.EUR_TRO_INFO, '$', 1, 2) - INSTR(X.EUR_TRO_INFO, '$', 1, 1) - 1) EUR_TRO_REV" ).append("\n"); 
		query.append("      ,SUBSTR(X.EUR_TRO_INFO, 1, INSTR(X.EUR_TRO_INFO, '$', 1, 1) -1) AS MANIFESTED" ).append("\n"); 
		query.append("      ,X.TRO_LOD_REF" ).append("\n"); 
		query.append("      ,TO_CHAR(X.BKG_QTY) BKG_QTY" ).append("\n"); 
		query.append("      ,X.POR_CD POR_CD" ).append("\n"); 
		query.append("      ,X.POL_CD POL_CD" ).append("\n"); 
		query.append("      ,X.POD_CD POD_CD" ).append("\n"); 
		query.append("      ,X.DEL_CD DEL_CD" ).append("\n"); 
		query.append("      ,X.T_VVD" ).append("\n"); 
		query.append("      ,X.SLAN_CD" ).append("\n"); 
		query.append("      ,X.IB_VVD_CD" ).append("\n"); 
		query.append("      ,X.IB_SLAN_CD" ).append("\n"); 
		query.append("      ,X.OB_VVD_CD" ).append("\n"); 
		query.append("      ,X.OB_SLAN_CD" ).append("\n"); 
		query.append("      ,X.CGO_TP_CD" ).append("\n"); 
		query.append("--      ,SUBSTR(X.BKG_CNTR_INFO, INSTR(X.BKG_CNTR_INFO, '$', 1, 2) + 1) AS BKG_SPE" ).append("\n"); 
		query.append("      ,X.SPCL_CGO_CNTR_TP_CD AS BKG_SPE" ).append("\n"); 
		query.append("      ,SUBSTR(X.MST_CNTR_INFO, 1, INSTR(X.MST_CNTR_INFO, '$', 1, 1) -1) AS USED" ).append("\n"); 
		query.append("      ,SUBSTR(X.MST_CNTR_INFO, INSTR(X.MST_CNTR_INFO, '$', 1, 1) + 1, INSTR(X.MST_CNTR_INFO, '$', 1, 2) - INSTR(X.MST_CNTR_INFO, '$', 1, 1) - 1) AS LT" ).append("\n"); 
		query.append("      ,SUBSTR(X.MST_CNTR_INFO, INSTR(X.MST_CNTR_INFO, '$', 1, 2) + 1) AS I_EXIT" ).append("\n"); 
		query.append("      ,X.LSE_CNTR_FLG AS LT_EXP -- 직반납 대상여부 체크 플래그 (TO-BE모델에서 추가된 컬럼)" ).append("\n"); 
		query.append("      ,(SELECT CNTR_SEAL_NO FROM BKG_CNTR_SEAL_NO WHERE BKG_NO  = X.BKG_NO AND CNTR_NO = X.EQ_NO AND CNTR_SEAL_SEQ = 1) AS SEAL_NO" ).append("\n"); 
		query.append("      ,(SELECT CNTR_SEAL_NO FROM BKG_CNTR_SEAL_NO WHERE BKG_NO  = X.BKG_NO AND CNTR_NO = X.EQ_NO AND CNTR_SEAL_SEQ = 2) AS SEAL_NO2" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WEIGHT_KGS) WEIGHT_KGS" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WEIGHT_LBS) WEIGHT_LBS" ).append("\n"); 
		query.append("      ,SUBSTR(X.BKG_CNTR_INFO, 1, INSTR(X.BKG_CNTR_INFO, '$', 1, 1) -1) AS NO_PKG" ).append("\n"); 
		query.append("      ,SUBSTR(X.BKG_CNTR_INFO, INSTR(X.BKG_CNTR_INFO, '$', 1, 1) + 1, INSTR(X.BKG_CNTR_INFO, '$', 1, 2) - INSTR(X.BKG_CNTR_INFO, '$', 1, 1) - 1) PKG_CD" ).append("\n"); 
		query.append("      ,REPLACE(X.CMDT_NM, chr(34), '') AS CMDT_NM" ).append("\n"); 
		query.append("      ,X.C_LOC" ).append("\n"); 
		query.append("      ,X.USA_LAST_CITY" ).append("\n"); 
		query.append("      ,SUBSTR(X.EDI_FOC_INFO, 1, INSTR(X.EDI_FOC_INFO, '$', 1, 1) -1) AS F" ).append("\n"); 
		query.append("      ,SUBSTR(X.EDI_FOC_INFO, INSTR(X.EDI_FOC_INFO, '$', 1, 1) + 1, INSTR(X.EDI_FOC_INFO, '$', 1, 2) - INSTR(X.EDI_FOC_INFO, '$', 1, 1) - 1) AS O" ).append("\n"); 
		query.append("      ,SUBSTR(X.EDI_FOC_INFO, INSTR(X.EDI_FOC_INFO, '$', 1, 2) + 1) AS C" ).append("\n"); 
		query.append("      ,IT_NO" ).append("\n"); 
		query.append("      ,SUBSTR(X.PKUP_INFO, 1, INSTR(X.PKUP_INFO, '$', 1, 1) -1) AS PICKUP_NO" ).append("\n"); 
		query.append("      ,SUBSTR(X.PKUP_INFO, INSTR(X.PKUP_INFO, '$', 1, 1) + 1, INSTR(X.PKUP_INFO, '$', 1, 2) - INSTR(X.PKUP_INFO, '$', 1, 1) - 1) AS PU_YARD_CD" ).append("\n"); 
		query.append("      ,SUBSTR(X.PKUP_INFO, INSTR(X.PKUP_INFO, '$', 1, 2) + 1, INSTR(X.PKUP_INFO, '$', 1, 3) - INSTR(X.PKUP_INFO, '$', 1, 2) - 1) AS AVAILABLE_DT" ).append("\n"); 
		query.append("      ,SUBSTR(X.PKUP_INFO, INSTR(X.PKUP_INFO, '$', 1, 3) + 1, INSTR(X.PKUP_INFO, '$', 1, 4) - INSTR(X.PKUP_INFO, '$', 1, 3) - 1) AS LAST_FREE_DT" ).append("\n"); 
		query.append("      ,SUBSTR(X.BKG_SC_NO_INFO, 1, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) -1) AS SC_NO" ).append("\n"); 
		query.append("      ,SUBSTR(X.BKG_SC_NO_INFO, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) + 1) AS RFA_NO" ).append("\n"); 
		query.append("      ,DECODE(TRIM(SUBSTR(X.BKG_SC_NO_INFO, 1, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) -1)), NULL," ).append("\n"); 
		query.append("                   (" ).append("\n"); 
		query.append("                    -- RFA 조회" ).append("\n"); 
		query.append("                    SELECT (SELECT MC.CUST_LGL_ENG_NM FROM MDM_CUSTOMER MC WHERE MC.CUST_CNT_CD = A2.CTRT_CUST_CNT_CD AND MC.CUST_SEQ = A2.CTRT_CUST_SEQ) CTRT_CUST_NM" ).append("\n"); 
		query.append("                      FROM PRI_RP_HDR A1" ).append("\n"); 
		query.append("                          ,PRI_RP_MN A2" ).append("\n"); 
		query.append("                          ,PRI_RP_DUR A3" ).append("\n"); 
		query.append("                     WHERE A1.RFA_NO = SUBSTR(X.BKG_SC_NO_INFO, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) + 1)" ).append("\n"); 
		query.append("                       AND A1.PROP_NO = A2.PROP_NO" ).append("\n"); 
		query.append("                       AND A2.AMDT_SEQ = (" ).append("\n"); 
		query.append("                                         SELECT  /*+ INDEX_DESC(X XPKPRI_SP_MN) */" ).append("\n"); 
		query.append("                                                AMDT_SEQ" ).append("\n"); 
		query.append("                                           FROM PRI_RP_MN X" ).append("\n"); 
		query.append("                                          WHERE PROP_NO = A1.PROP_NO" ).append("\n"); 
		query.append("                                            AND PROP_STS_CD = 'A'" ).append("\n"); 
		query.append("                                            AND ROWNUM = 1)" ).append("\n"); 
		query.append("                       AND A2.PROP_NO  = A3.PROP_NO" ).append("\n"); 
		query.append("                       AND A2.AMDT_SEQ = A3.AMDT_SEQ" ).append("\n"); 
		query.append("                   )," ).append("\n"); 
		query.append("                    -- S/C 조회" ).append("\n"); 
		query.append("                   (SELECT (SELECT MC.CUST_LGL_ENG_NM FROM MDM_CUSTOMER MC WHERE MC.CUST_CNT_CD = A3.CUST_CNT_CD AND MC.CUST_SEQ = A3.CUST_SEQ) CTRT_CUST_NM" ).append("\n"); 
		query.append("                    FROM PRI_SP_HDR A1" ).append("\n"); 
		query.append("                        ,PRI_SP_MN A2" ).append("\n"); 
		query.append("                        ,PRI_SP_CTRT_PTY A3" ).append("\n"); 
		query.append("                    WHERE A1.SC_NO = SUBSTR(X.BKG_SC_NO_INFO, 1, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) -1)" ).append("\n"); 
		query.append("                      AND A1.PROP_NO = A2.PROP_NO" ).append("\n"); 
		query.append("                      AND A2.AMDT_SEQ = (" ).append("\n"); 
		query.append("                                        SELECT  /*+ INDEX_DESC(X XPKPRI_SP_MN) */" ).append("\n"); 
		query.append("                                               AMDT_SEQ" ).append("\n"); 
		query.append("                                          FROM PRI_SP_MN X" ).append("\n"); 
		query.append("                                         WHERE PROP_NO = A1.PROP_NO" ).append("\n"); 
		query.append("                                           AND PROP_STS_CD = 'F'" ).append("\n"); 
		query.append("                                           AND ROWNUM = 1)" ).append("\n"); 
		query.append("                      AND A2.PROP_NO  = A3.PROP_NO" ).append("\n"); 
		query.append("                      AND A2.AMDT_SEQ = A3.AMDT_SEQ" ).append("\n"); 
		query.append("                      AND A3.PRC_CTRT_PTY_TP_CD = 'C'" ).append("\n"); 
		query.append("                   )" ).append("\n"); 
		query.append("             ) AS CTRC_CUST_NM" ).append("\n"); 
		query.append("      ,X.DOOR_SVC_TP" ).append("\n"); 
		query.append("      ,X.PKUP_CNTR" ).append("\n"); 
		query.append("      ,REPLACE(X.SHIPPER, chr(34), '') AS SHIPPER " ).append("\n"); 
		query.append("      ,REPLACE(X.CONSIGNEE, chr(34), '') AS CONSIGNEE" ).append("\n"); 
		query.append("      ,REPLACE(X.NOTIFY, chr(34), '') AS NOTIFY" ).append("\n"); 
		query.append("      ,X.REF_BKG_NO" ).append("\n"); 
		query.append("      ,X.REF_BL_NO" ).append("\n"); 
		query.append("      ,X.ORG_GATE_OUT_DT" ).append("\n"); 
		query.append("      ,X.DEST_GATE_IN_DT" ).append("\n"); 
		query.append("      ,X.MTY_REF_ID" ).append("\n"); 
		query.append("      ,REPLACE(REPLACE(DECODE(X.TRSP_SO_TP_CD, 'S', X.SPL_ISS_RSN, X.TRSP_PURP_RSN), CHR(13)||CHR(10), ' '), chr(34), '') TRSP_PURP_RSN  " ).append("\n"); 
		query.append("      ,REPLACE(REPLACE(X.INTER_RMK, CHR(13)||CHR(10), ' '), chr(34), '')  INTER_RMK" ).append("\n"); 
		query.append("      ,X.NEGO_RMK NEGO_RMK" ).append("\n"); 
		query.append("      ,REPLACE(REPLACE(X.CNG_RSN_DESC, CHR(13)||CHR(10), ' '), chr(34), '') CNG_RSN_DESC" ).append("\n"); 
		query.append("      ,REPLACE(REPLACE(X.SPCL_INSTR_RMK, CHR(13)||CHR(10), ' '), chr(34), '')  SPCL_INSTR_RMK              " ).append("\n"); 
		query.append("      ,REPLACE(REPLACE(X.WO_INSTR_RMK, CHR(13)||CHR(10), ' '), chr(34), '')  WO_INSTR_RMK" ).append("\n"); 
		query.append("      ,TO_CHAR(X.CHZ_BUNDLE_SEQ) CHZ_BUNDLE_SEQ" ).append("\n"); 
		query.append("      ,X.TRSP_SPL_SO_TP_CD" ).append("\n"); 
		query.append("#if (${invar_usdropnpull} == 'Y') " ).append("\n"); 
		query.append("  ,SUBSTR(X.DMDT_INFO, 1, INSTR(X.DMDT_INFO, '$', 1, 1) -1) AS FM_DT" ).append("\n"); 
		query.append("  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 1) + 1, INSTR(X.DMDT_INFO, '$', 1, 2) - INSTR(X.DMDT_INFO, '$', 1, 1) - 1) AS FM_YD" ).append("\n"); 
		query.append("  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 2) + 1, INSTR(X.DMDT_INFO, '$', 1, 3) - INSTR(X.DMDT_INFO, '$', 1, 2) - 1) AS FM_STS " ).append("\n"); 
		query.append("  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 3) + 1, INSTR(X.DMDT_INFO, '$', 1, 4) - INSTR(X.DMDT_INFO, '$', 1, 3) - 1) AS TO_DT " ).append("\n"); 
		query.append("  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 4) + 1, INSTR(X.DMDT_INFO, '$', 1, 5) - INSTR(X.DMDT_INFO, '$', 1, 4) - 1) AS TO_YD " ).append("\n"); 
		query.append("  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 5) + 1, INSTR(X.DMDT_INFO, '$', 1, 6) - INSTR(X.DMDT_INFO, '$', 1, 5) - 1) AS TO_STS" ).append("\n"); 
		query.append("  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 6) + 1, INSTR(X.DMDT_INFO, '$', 1, 7) - INSTR(X.DMDT_INFO, '$', 1, 6) - 1) AS MT_DT " ).append("\n"); 
		query.append("  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 7) + 1, INSTR(X.DMDT_INFO, '$', 1, 8) - INSTR(X.DMDT_INFO, '$', 1, 7) - 1) AS MT_YD " ).append("\n"); 
		query.append("  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 8) + 1, INSTR(X.DMDT_INFO, '$', 1, 9) - INSTR(X.DMDT_INFO, '$', 1, 8) - 1) AS WEB_MT_DT " ).append("\n"); 
		query.append("  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 9) + 1, INSTR(X.DMDT_INFO, '$', 1,10) - INSTR(X.DMDT_INFO, '$', 1, 9) - 1) AS GRACE_END " ).append("\n"); 
		query.append("--  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 9) + 1, INSTR(X.DMDT_INFO, '^', 1, 1) - INSTR(X.DMDT_INFO, '$', 1, 9) - 1) AS GRACE_END " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("      ,X.MCNTR_BDL_GRP_SEQ" ).append("\n"); 
		query.append("      ,X.MCNTR_BDL_SEQ" ).append("\n"); 
		query.append("      ,X.HJL_NO" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_HJL_HNDL_AMT) WO_HJL_HNDL_AMT" ).append("\n"); 
		query.append("    #if (${grid_flg} == 'Y')" ).append("\n"); 
		query.append("      -- 여기서부터는 타이틀" ).append("\n"); 
		query.append("      ,X.CONTI_CD" ).append("\n"); 
		query.append("      ,X.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(X.TRSP_SO_SEQ) TRSP_SO_SEQ" ).append("\n"); 
		query.append("      ,TO_CHAR(X.VNDR_SEQ) VNDR_SEQ" ).append("\n"); 
		query.append("      ,X.TRSP_WO_OFC_CTY_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(X.TRSP_WO_SEQ) TRSP_WO_SEQ" ).append("\n"); 
		query.append("      ,X.WGT_MEAS_UT_CD UOM" ).append("\n"); 
		query.append("      ,X.REGISTRATION_NO" ).append("\n"); 
		query.append("      ,X.UPD_USR_ID" ).append("\n"); 
		query.append("      ,(SELECT USR_NM FROM COM_USER CU WHERE CU.USR_ID = X.UPD_USR_ID) AS UPD_USR_NM" ).append("\n"); 
		query.append("      ,SUBSTR(X.USA_DO_INFO, 1, INSTR(X.USA_DO_INFO, '$', 1, 1) - 1) AS IF_SYS_KND_CD" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("  FROM (" ).append("\n"); 
		query.append("          SELECT SO.CMDT_CD" ).append("\n"); 
		query.append("                ,CASE WHEN SO.HJL_NO IS NOT NULL THEN (SELECT HJL_VNDR_SEQ FROM TRS_TRSP_HJL_SVC_ORD WHERE TRSP_SO_OFC_CTY_CD = SO.TRSP_SO_OFC_CTY_CD AND TRSP_SO_SEQ = SO.TRSP_SO_SEQ)" ).append("\n"); 
		query.append("                      ELSE SO.VNDR_SEQ" ).append("\n"); 
		query.append("                 END VNDR_SEQ" ).append("\n"); 
		query.append("                ,SO.CUST_SEQ" ).append("\n"); 
		query.append("                ,SO.CUST_CNT_CD" ).append("\n"); 
		query.append("                ,WRK.CSR_NO" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_CMB_SEQ" ).append("\n"); 
		query.append("                ,DECODE(SO.PRE_PULL_FLG, 'Y', SO.PRE_PULL_FLG, '') AS PRE_PULL_FLG" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_CMB_TP_CD" ).append("\n"); 
		query.append("                ,SO.LOCL_CRE_DT AS SO_CRE_DT" ).append("\n"); 
		query.append("                ,WO.LOCL_CRE_DT AS WO_CRE_DT" ).append("\n"); 
		query.append("                ,WRK.CRE_OFC_CD AS INV_CRE_OFC_CD" ).append("\n"); 
		query.append("                ,SO.VSL_CD" ).append("\n"); 
		query.append("                ,SO.SKD_VOY_NO" ).append("\n"); 
		query.append("                ,SO.SKD_DIR_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_STS_CD" ).append("\n"); 
		query.append("                ,SO.CGO_TP_CD" ).append("\n"); 
		query.append("                ,SO.CNTR_KGS_WGT AS WEIGHT_KGS" ).append("\n"); 
		query.append("                ,SO.CNTR_LBS_WGT AS WEIGHT_LBS" ).append("\n"); 
		query.append("                ,SO.WGT_MEAS_UT_CD" ).append("\n"); 
		query.append("                ,SO.EQ_NO EQ_NO" ).append("\n"); 
		query.append("                ,SO.EQ_KND_CD" ).append("\n"); 
		query.append("                ,SO.EQ_TPSZ_CD AS EQ_TPSZ" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                ,SO.TRSP_COST_DTL_MOD_CD AS TRSP_COST_DTL_MOD_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_CRR_MOD_CD AS TRSP_CRR_MOD_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_OFC_CTY_CD || SO.TRSP_SO_SEQ AS SO_NO" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LOCL_CRE_DT, 'YYYY-MM-DD HH24:MI:SS') AS SO_CRE_DT1" ).append("\n"); 
		query.append("                ,SO.DELT_FLG SO_DEL_FLG" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LOCL_UPD_DT, 'YYYY-MM-DD HH24:MI:SS') AS SO_UPD_DT" ).append("\n"); 
		query.append("                ,WO.TRSP_WO_OFC_CTY_CD || WO.TRSP_WO_SEQ AS WO_NO" ).append("\n"); 
		query.append("                ,WO.TRSP_WO_OFC_CTY_CD" ).append("\n"); 
		query.append("                ,WO.TRSP_WO_SEQ" ).append("\n"); 
		query.append("                ,WO.WO_ISS_STS_CD AS WO_ISS_STS_CD" ).append("\n"); 
		query.append("                ,(SELECT COST_YR || COST_WK FROM MAS_WK_PRD WHERE TO_CHAR ( WO.LOCL_CRE_DT, 'YYYYMMDD') BETWEEN SLS_FM_DT AND SLS_TO_DT) WO_ISS_WK" ).append("\n"); 
		query.append("                ,TO_CHAR ( WO.LOCL_CRE_DT, 'YYYY-MM-DD HH24:MI:SS') AS WO_ISS_DT" ).append("\n"); 
		query.append("                ,DECODE (WO.WO_PRN_USE_FLG,'Y', 'PRINT','') " ).append("\n"); 
		query.append("                  || DECODE (WO.WO_FAX_USE_FLG,'Y', 'FAX','') " ).append("\n"); 
		query.append("                  || DECODE (WO.WO_EML_USE_FLG,'Y', ' EMAIL','') " ).append("\n"); 
		query.append("                  || DECODE (WO.WO_EDI_USE_FLG,'Y', ' EDI','') AS WO_ISS_TP" ).append("\n"); 
		query.append("                ,WO.CRE_OFC_CD AS WO_ISS_OFC_CD" ).append("\n"); 
		query.append("                ,WO.CRE_USR_ID AS WO_ISS_ID" ).append("\n"); 
		query.append("                ,DECODE(SO.CUST_NOMI_TRKR_FLG,'Y','Y','N') AGMT_CNT_FLG" ).append("\n"); 
		query.append("                ,CASE WHEN SO.CUST_NOMI_TRKR_FLG = 'Y' AND SO.CUST_NOMI_TRKR_IND_CD IS NULL THEN 'CNT'" ).append("\n"); 
		query.append("                      WHEN SO.CUST_NOMI_TRKR_FLG = 'N' THEN 'SML'" ).append("\n"); 
		query.append("                      WHEN SO.CUST_NOMI_TRKR_FLG IS NULL THEN 'SML'" ).append("\n"); 
		query.append("                      ELSE SO.CUST_NOMI_TRKR_IND_CD" ).append("\n"); 
		query.append("                 END AS AGMT_CNT_TP_CD" ).append("\n"); 
		query.append("                ,(SELECT CASE WHEN COUNT(PRC_CTRT_NO) > 0 THEN 'Y'" ).append("\n"); 
		query.append("                              ELSE 'N'" ).append("\n"); 
		query.append("                         END    " ).append("\n"); 
		query.append("                    FROM TRS_CUST_NOMI_TRKR A" ).append("\n"); 
		query.append("                        ,BKG_BOOKING B" ).append("\n"); 
		query.append("                   WHERE SO.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                     AND A.PRC_CTRT_TP_CD = DECODE(B.SC_NO,'','R','S')" ).append("\n"); 
		query.append("                     AND A.PRC_CTRT_NO = NVL(B.SC_NO,B.RFA_NO)" ).append("\n"); 
		query.append("                     AND A.IO_BND_CD = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("                     AND A.ORG_NOD_CD = CASE WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(A.ORG_NOD_CD)= 5 THEN SUBSTR(SO.FM_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                             WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(A.ORG_NOD_CD)= 7 THEN SO.FM_NOD_CD" ).append("\n"); 
		query.append("                                             WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(A.ORG_NOD_CD)= 5 THEN SUBSTR(SO.DOR_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                             WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(A.ORG_NOD_CD)= 7 THEN SO.DOR_NOD_CD" ).append("\n"); 
		query.append("                                         END " ).append("\n"); 
		query.append("                    AND A.DEST_NOD_CD = CASE WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(A.DEST_NOD_CD)= 5 THEN SUBSTR(SO.DOR_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                             WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(A.DEST_NOD_CD)= 7 THEN SO.DOR_NOD_CD" ).append("\n"); 
		query.append("                                             WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(A.DEST_NOD_CD)= 5 THEN SUBSTR(SO.TO_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                             WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(A.DEST_NOD_CD)= 7 THEN SO.TO_NOD_CD" ).append("\n"); 
		query.append("                                         END " ).append("\n"); 
		query.append("                    AND A.DISP_STS_CD = '03' --APPROVAL STATUS                   " ).append("\n"); 
		query.append("                 ) AS CNT_FLG  " ).append("\n"); 
		query.append("               ,NVL((SELECT A.CUST_NOMI_TRKR_IND_CD  " ).append("\n"); 
		query.append("                      FROM TRS_CUST_NOMI_TRKR A" ).append("\n"); 
		query.append("                          ,BKG_BOOKING B" ).append("\n"); 
		query.append("                     WHERE SO.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                       AND A.PRC_CTRT_TP_CD = DECODE(B.SC_NO,'','R','S')" ).append("\n"); 
		query.append("                       AND A.PRC_CTRT_NO = NVL(B.SC_NO,B.RFA_NO)" ).append("\n"); 
		query.append("                       AND A.IO_BND_CD = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("                       AND A.ORG_NOD_CD = CASE WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(A.ORG_NOD_CD)= 5 THEN SUBSTR(SO.FM_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                               WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(A.ORG_NOD_CD)= 7 THEN SO.FM_NOD_CD" ).append("\n"); 
		query.append("                                               WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(A.ORG_NOD_CD)= 5 THEN SUBSTR(SO.DOR_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                               WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(A.ORG_NOD_CD)= 7 THEN SO.DOR_NOD_CD" ).append("\n"); 
		query.append("                                           END " ).append("\n"); 
		query.append("                       AND A.DEST_NOD_CD = CASE WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(A.DEST_NOD_CD)= 5 THEN SUBSTR(SO.DOR_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                                WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(A.DEST_NOD_CD)= 7 THEN SO.DOR_NOD_CD" ).append("\n"); 
		query.append("                                                WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(A.DEST_NOD_CD)= 5 THEN SUBSTR(SO.TO_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                                WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(A.DEST_NOD_CD)= 7 THEN SO.TO_NOD_CD" ).append("\n"); 
		query.append("                                           END " ).append("\n"); 
		query.append("                      AND A.DISP_STS_CD = '03' --APPROVAL STATUS                   " ).append("\n"); 
		query.append("                      AND ROWNUM = 1" ).append("\n"); 
		query.append("                  ),'SML') CNT_TP_CD" ).append("\n"); 
		query.append("              ,(SELECT COUNT(PRC_CTRT_NO) CNT" ).append("\n"); 
		query.append("                  FROM TRS_CUST_NOMI_TRKR A" ).append("\n"); 
		query.append("                      ,BKG_BOOKING B" ).append("\n"); 
		query.append("                 WHERE SO.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                   AND A.PRC_CTRT_TP_CD = DECODE(B.SC_NO,'','R','S')" ).append("\n"); 
		query.append("                   AND A.PRC_CTRT_NO = NVL(B.SC_NO,B.RFA_NO)" ).append("\n"); 
		query.append("                   AND A.IO_BND_CD = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("                   AND A.ORG_NOD_CD = CASE WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(A.ORG_NOD_CD)= 5 THEN SUBSTR(SO.FM_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                           WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(A.ORG_NOD_CD)= 7 THEN SO.FM_NOD_CD" ).append("\n"); 
		query.append("                                           WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(A.ORG_NOD_CD)= 5 THEN SUBSTR(SO.DOR_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                           WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(A.ORG_NOD_CD)= 7 THEN SO.DOR_NOD_CD" ).append("\n"); 
		query.append("                                       END " ).append("\n"); 
		query.append("                   AND A.DEST_NOD_CD = CASE WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(A.DEST_NOD_CD)= 5 THEN SUBSTR(SO.DOR_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                            WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(A.DEST_NOD_CD)= 7 THEN SO.DOR_NOD_CD" ).append("\n"); 
		query.append("                                            WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(A.DEST_NOD_CD)= 5 THEN SUBSTR(SO.TO_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                            WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(A.DEST_NOD_CD)= 7 THEN SO.TO_NOD_CD" ).append("\n"); 
		query.append("                                        END " ).append("\n"); 
		query.append("                   AND A.DISP_STS_CD = '03'" ).append("\n"); 
		query.append("                ) AS CTRT_CNT" ).append("\n"); 
		query.append("                ,SO.FM_NOD_CD AS FM_NOD_CD" ).append("\n"); 
		query.append("                ,SO.VIA_NOD_CD AS VIA_NOD_CD" ).append("\n"); 
		query.append("                ,SO.TO_NOD_CD AS TO_NOD_CD" ).append("\n"); 
		query.append("                ,SO.FCTRY_NM AS DOOR_FCTRY_NM" ).append("\n"); 
		query.append("                ,SO.DOR_NOD_CD AS DOOR" ).append("\n"); 
		query.append("                ,SO.DOR_DE_ADDR AS DOR_DE_ADDR" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_TP_CD AS TRSP_SO_TP_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_CMB_TP_CD AS BKG_CNTR_CMB_SEQ" ).append("\n"); 
		query.append("--                ,DECODE (SO.CUST_NOMI_TRKR_FLG,'Y', 'CNT','SML') AS VNDR_TP_CD" ).append("\n"); 
		query.append("                ,DECODE (WO.WO_OPN_FLG,'Y', TO_CHAR (WO.UPD_DT, 'YYYY-MM-DD HH24:MI:SS')) AS WO_RCV_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.APNT_DT, 'YYYY-MM-DD HH24:MI:SS') AS APPT_TIME" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.DE_DT, 'YYYY-MM-DD HH24:MI:SS') AS DELIV_TIME" ).append("\n"); 
		query.append("                ,NVL (SO.N3PTY_BIL_FLG, 'N') AS N3PTY_BIL_FLG" ).append("\n"); 
		query.append("                ,SO.CURR_CD AS WO_CURR_CD" ).append("\n"); 
		query.append("                ,NVL (SO.BZC_AMT, 0) AS WO_BZC_AMT" ).append("\n"); 
		query.append("                ,NVL (SO.NEGO_AMT, 0) AS WO_NEGO_AMT" ).append("\n"); 
		query.append("                ,NVL (SO.FUEL_SCG_AMT, 0) AS WO_FUEL_SCG_AMT" ).append("\n"); 
		query.append("                ,NVL (SO.SCG_VAT_AMT, 0) AS WO_VAT_SCG_AMT" ).append("\n"); 
		query.append("                ,NVL (SO.TOLL_FEE_AMT, 0) AS WO_TOLL_FEE_AMT" ).append("\n"); 
		query.append("                ,NVL (SO.ETC_ADD_AMT, 0) AS WO_ETC_ADD_AMT -- additional  " ).append("\n"); 
		query.append("                ,NVL (SO.HJL_HNDL_AMT, 0) AS WO_HJL_HNDL_AMT" ).append("\n"); 
		query.append("                ,NVL (SO.BZC_AMT, 0) + NVL (SO.FUEL_SCG_AMT, 0)+ NVL (SO.SCG_VAT_AMT, 0) + NVL (SO.NEGO_AMT, 0) + NVL (SO.TOLL_FEE_AMT, 0)+ NVL (SO.ETC_ADD_AMT, 0)+NVL (SO.HJL_HNDL_AMT, 0) AS WO_TOT_AMT" ).append("\n"); 
		query.append("                ,SO.INV_XCH_RT AS INV_XCH_RT" ).append("\n"); 
		query.append("                ,SO.TRSP_INV_CALC_LGC_TP_CD AS INV_CALC_LGC_TP_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                ,( SELECT SO.CRE_OFC_CD" ).append("\n"); 
		query.append("                     FROM MDM_LOCATION LOC" ).append("\n"); 
		query.append("                    WHERE LOC.CNT_CD = 'CN' " ).append("\n"); 
		query.append("                      AND SUBSTR(SO.FM_NOD_CD,1,5) = LOC.LOC_CD ) AS COST_OFC_CD_CN" ).append("\n"); 
		query.append("                ,( SELECT SO.CRE_OFC_CD" ).append("\n"); 
		query.append("                     FROM MDM_LOCATION LOC" ).append("\n"); 
		query.append("                    WHERE LOC.CONTI_CD = 'M'" ).append("\n"); 
		query.append("                      AND SUBSTR(SO.TO_NOD_CD,1,5) = LOC.LOC_CD ) AS COST_OFC_CD_M" ).append("\n"); 
		query.append("                , SO.CRE_OFC_CD AS SO_CRE_OFC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                ,SO.INV_CURR_CD AS INV_CURR_CD" ).append("\n"); 
		query.append("                ,SO.INV_BZC_AMT AS INV_BZC_AMT" ).append("\n"); 
		query.append("                ,SO.INV_ETC_ADD_AMT AS INV_ETC_ADD_AMT" ).append("\n"); 
		query.append("                , NVL (SO.INV_BZC_AMT, 0) + NVL (SO.INV_ETC_ADD_AMT, 0) AS INV_TOT_AMT" ).append("\n"); 
		query.append("                ,SO.INV_NO AS INV_NO" ).append("\n"); 
		query.append("                ,WRK.TRSP_INV_AUD_STS_CD AS INV_STS_CD" ).append("\n"); 
		query.append("                ,WRK.RGST_NO AS REGISTRATION_NO" ).append("\n"); 
		query.append("                ,TO_CHAR (WRK.INV_CFM_DT, 'YYYYMMDD') AS INV_CFM_DT" ).append("\n"); 
		query.append("                ,WRK.CSR_NO AS CAR_NO" ).append("\n"); 
		query.append("                ,CASE" ).append("\n"); 
		query.append("                    WHEN WRK.TRSP_INV_AUD_STS_CD IN ('CF', 'AR', 'IF', 'PD')" ).append("\n"); 
		query.append("                       THEN WRK.CRE_OFC_CD" ).append("\n"); 
		query.append("                    ELSE ''" ).append("\n"); 
		query.append("                 END AS INV_CFM_OFC_CD" ).append("\n"); 
		query.append("                ,WRK.CRE_USR_ID AS INV_CRE_USR_ID" ).append("\n"); 
		query.append("                ,SO.INV_RMK" ).append("\n"); 
		query.append("                ,SO.BKG_NO AS BKG_NO" ).append("\n"); 
		query.append("                ,SO.BL_NO AS BL_NO" ).append("\n"); 
		query.append("                ,SO.TRSP_BND_CD AS TRSP_BND_CD" ).append("\n"); 
		query.append("                ,SO.BKG_RCVDE_TERM_CD AS TERM" ).append("\n"); 
		query.append("                ,SO.POR_CD POR_CD" ).append("\n"); 
		query.append("                ,SO.POL_CD POL_CD" ).append("\n"); 
		query.append("                ,SO.POD_CD POD_CD" ).append("\n"); 
		query.append("                ,SO.DEL_CD DEL_CD" ).append("\n"); 
		query.append("                ,SO.VSL_CD || SO.SKD_VOY_NO || SO.SKD_DIR_CD T_VVD" ).append("\n"); 
		query.append("                ,SO.SLAN_CD SLAN_CD" ).append("\n"); 
		query.append("                ,SO.IB_VVD_CD" ).append("\n"); 
		query.append("                ,(SELECT VS.VSL_SLAN_CD" ).append("\n"); 
		query.append("                    FROM VSK_VSL_SKD VS" ).append("\n"); 
		query.append("                   WHERE VS.VSL_CD = SUBSTR(SO.IB_VVD_CD,1,4)" ).append("\n"); 
		query.append("                     AND VS.SKD_VOY_NO = SUBSTR(SO.IB_VVD_CD,5,4)" ).append("\n"); 
		query.append("                     AND VS.SKD_DIR_CD = SUBSTR(SO.IB_VVD_CD,9,1)" ).append("\n"); 
		query.append("                  ) AS IB_SLAN_CD" ).append("\n"); 
		query.append("                   ,SO.OB_VVD_CD" ).append("\n"); 
		query.append("                ,(SELECT VS.VSL_SLAN_CD" ).append("\n"); 
		query.append("                    FROM VSK_VSL_SKD VS" ).append("\n"); 
		query.append("                   WHERE VS.VSL_CD = SUBSTR(SO.OB_VVD_CD,1,4)" ).append("\n"); 
		query.append("                     AND VS.SKD_VOY_NO = SUBSTR(SO.OB_VVD_CD,5,4)" ).append("\n"); 
		query.append("                     AND VS.SKD_DIR_CD = SUBSTR(SO.OB_VVD_CD,9,1)" ).append("\n"); 
		query.append("                  ) AS OB_SLAN_CD" ).append("\n"); 
		query.append("                ,SO.IBD_CSTMS_CLR_LOC_CD C_LOC" ).append("\n"); 
		query.append("                ,SO.LST_LOC_CD USA_LAST_CITY" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.AVAL_DT, 'YYYYMMDD') AVAILABLE_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LST_FREE_DT, 'YYYYMMDD') LAST_FREE_DT" ).append("\n"); 
		query.append("                ,SO.REF_BKG_NO REF_BKG_NO" ).append("\n"); 
		query.append("                ,SO.REF_BL_NO REF_BL_NO" ).append("\n"); 
		query.append("                ,SO.INTER_RMK INTER_RMK" ).append("\n"); 
		query.append("                ,SO.NEGO_RMK NEGO_RMK" ).append("\n"); 
		query.append("                ,WO.WO_RMK WO_INSTR_RMK" ).append("\n"); 
		query.append("                ,SO.SPCL_INSTR_RMK" ).append("\n"); 
		query.append("                ,CASE" ).append("\n"); 
		query.append("                    WHEN SO.EQ_KND_CD = 'Z'" ).append("\n"); 
		query.append("                    AND SO.TRSP_SO_CMB_TP_CD = 'BD'" ).append("\n"); 
		query.append("                       THEN COUNT (SO.TRSP_SO_SEQ) OVER (PARTITION BY SO.TRSP_SO_CMB_TP_CD, SO.TRSP_SO_CMB_SEQ)" ).append("\n"); 
		query.append("                    WHEN SO.EQ_KND_CD = 'Z'" ).append("\n"); 
		query.append("                       THEN 1" ).append("\n"); 
		query.append("                    ELSE NULL" ).append("\n"); 
		query.append("                 END AS CHZ_BUNDLE_SEQ" ).append("\n"); 
		query.append("                ,SO.COP_NO" ).append("\n"); 
		query.append("                ,SO.COST_ACT_GRP_SEQ AG_SEQ" ).append("\n"); 
		query.append("                ,SO.COST_ACT_GRP_CD AG_CODE" ).append("\n"); 
		query.append("                ,DECODE (SO.TRSP_COST_DTL_MOD_CD,'DR'" ).append("\n"); 
		query.append("                         , DECODE (NVL (SO.TRO_SEQ, ''),'', 'N','Y')" ).append("\n"); 
		query.append("                        ,'N/A') TRO_CNFM" ).append("\n"); 
		query.append("                ,SO.TRO_SEQ" ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append("                ,NVL (SO.UPD_USR_ID, SO.CRE_USR_ID) UPD_USR_ID" ).append("\n"); 
		query.append("                ,SO.ACT_CUST_CNT_CD || SO.ACT_CUST_SEQ DOOR_ACT_CUST" ).append("\n"); 
		query.append("                ,SO.DOR_PST_CD DOOR_ZIP" ).append("\n"); 
		query.append("                ,SO.CNTC_PSON_PHN_NO DOOR_TEL" ).append("\n"); 
		query.append("                ,SO.CNTC_PSON_FAX_NO DOOR_FAX" ).append("\n"); 
		query.append("                ,SO.CNTC_PSON_NM DOOR_PIC" ).append("\n"); 
		query.append("                ,DECODE (SO.DOR_SVC_TP_CD,'UD', 'UNDECIDED','LL', 'LIVE LOAD','LU', 'LIVE UNLOAD','ST', 'STREET TURN','DP', 'DROP AND PICK') DOOR_SVC_TP" ).append("\n"); 
		query.append("                ,SO.REF_ID MTY_REF_ID" ).append("\n"); 
		query.append("                ,DECODE (SO.TRSP_SPL_SO_TP_CD,'AS', 'ADD S.CHG','RR', 'RETROACTIVE') TRSP_SPL_SO_TP_CD" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.ORG_GATE_OUT_DT, 'YYYY-MM-DD HH24:MI:SS') ORG_GATE_OUT_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.DEST_GATE_IN_DT, 'YYYY-MM-DD HH24:MI:SS') DEST_GATE_IN_DT" ).append("\n"); 
		query.append("                ,SO.TRSP_PURP_RSN" ).append("\n"); 
		query.append("                ,SO.SPL_ISS_RSN -- SUPPLEMENT REASON, CSR : CHM-201322296, 2013-01-08 추가, 신용찬                " ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("                ,NVL(SO.UPLN_SO_FLG, 'N') UPLN_SO_FLG" ).append("\n"); 
		query.append("                ,NVL(SO.TRSP_FRST_FLG, 'N') TRSP_FRST_FLG" ).append("\n"); 
		query.append("                ,DECODE (SO.EQ_TPSZ_CD" ).append("\n"); 
		query.append("                        ,SO.ORG_EQ_TPSZ_CD, ''" ).append("\n"); 
		query.append("                        ,SO.ORG_EQ_TPSZ_CD" ).append("\n"); 
		query.append("                        ) ORG_EQ_TPSZ" ).append("\n"); 
		query.append("                ,SO.DOR_PKUP_CNTR_NO PKUP_CNTR" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.N1ST_NOD_PLN_DT, 'YYYY-MM-DD HH24:MI:SS') N1ST_NOD_PLN_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LST_NOD_PLN_DT, 'YYYY-MM-DD HH24:MI:SS') LST_NOD_PLN_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.DOR_NOD_PLN_DT, 'YYYY-MM-DD HH24:MI:SS') DOR_NOD_PLN_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.DOR_ARR_DT, 'YYYY-MM-DD HH24:MI:SS') DOR_ARR_DT" ).append("\n"); 
		query.append("                ,DECODE (SO.HJL_NO,'', 'N','Y') HJL_NO" ).append("\n"); 
		query.append("                ,(SELECT REPLACE (CUST_NM, CHR (13) || CHR (10),' ')" ).append("\n"); 
		query.append("                    FROM BKG_CUSTOMER CUST" ).append("\n"); 
		query.append("                   WHERE CUST.BKG_NO = SO.BKG_NO" ).append("\n"); 
		query.append("                     AND CUST.BKG_CUST_TP_CD = 'S' ) AS SHIPPER" ).append("\n"); 
		query.append("                ,(SELECT REPLACE (CUST_NM, CHR (13) || CHR (10),' ')" ).append("\n"); 
		query.append("                    FROM BKG_CUSTOMER CUST" ).append("\n"); 
		query.append("                   WHERE CUST.BKG_NO = SO.BKG_NO" ).append("\n"); 
		query.append("                     AND CUST.BKG_CUST_TP_CD = 'C' ) AS CONSIGNEE" ).append("\n"); 
		query.append("                ,(SELECT REPLACE (CUST_NM, CHR (13) || CHR (10),' ') " ).append("\n"); 
		query.append("                    FROM BKG_CUSTOMER CUST" ).append("\n"); 
		query.append("                   WHERE CUST.BKG_NO = SO.BKG_NO" ).append("\n"); 
		query.append("                     AND CUST.BKG_CUST_TP_CD = 'N' ) AS NOTIFY" ).append("\n"); 
		query.append("                ,(SELECT DECODE(NVL(U.EQ_SUBST_CGO_QTY, 0), 0, U.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("                           ||' '||U.OP_CNTR_QTY, U.CNTR_TPSZ_CD||' '||U.OP_CNTR_QTY" ).append("\n"); 
		query.append("                           ||'-SUB '||U.EQ_SUBST_CNTR_TPSZ_CD||' '||U.EQ_SUBST_CGO_QTY" ).append("\n"); 
		query.append("                          )" ).append("\n"); 
		query.append("                    FROM BKG_QUANTITY U" ).append("\n"); 
		query.append("                   WHERE U.BKG_NO       = SO.BKG_NO" ).append("\n"); 
		query.append("                     AND U.CNTR_TPSZ_CD = SO.EQ_TPSZ_CD) AS BKG_QTY" ).append("\n"); 
		query.append("                ,(SELECT CMDT_NM" ).append("\n"); 
		query.append("                    FROM MDM_COMMODITY CMT" ).append("\n"); 
		query.append("                   WHERE CMT.CMDT_CD = SO.CMDT_CD ) AS CMDT_NM" ).append("\n"); 
		query.append("                ,DECODE (SO.TRSP_COST_DTL_MOD_CD,'DR', SO.TRO_CFM_OFC_CD, '') TRO_CFM_OFC" ).append("\n"); 
		query.append("                ,DECODE (SO.TRSP_COST_DTL_MOD_CD,'DR', SO.TRO_CFM_USR_ID, '') TRO_CFM_USR" ).append("\n"); 
		query.append("                ,DECODE (SO.TRSP_COST_DTL_MOD_CD,'DR', TO_CHAR (SO.TRO_CFM_UPD_DT, 'YYYY-MM-DD HH24:MI:SS'), '') TRO_CFM_UPD" ).append("\n"); 
		query.append("                ,DECODE (SO.TRSP_COST_DTL_MOD_CD,'DR', SO.REV_CURR_CD, '') TRO_REV_CUR" ).append("\n"); 
		query.append("                ,(SELECT HDR.IF_DT" ).append("\n"); 
		query.append("                    FROM AP_INV_HDR HDR" ).append("\n"); 
		query.append("                   WHERE HDR.CSR_NO = WRK.CSR_NO) AS IF_DT" ).append("\n"); 
		query.append("                ,SO.LSE_CNTR_FLG" ).append("\n"); 
		query.append("                ,ROUND ((NVL (SO.BZC_AMT, 0) + NVL (SO.FUEL_SCG_AMT, 0) + NVL (SO.NEGO_AMT, 0)+ NVL (SO.TOLL_FEE_AMT, 0) + NVL (SO.ETC_ADD_AMT, 0) + NVL (SO.HJL_HNDL_AMT, 0) + NVL (SO.SCG_VAT_AMT, 0)) / " ).append("\n"); 
		query.append("                         CASE WHEN NVL(SO.CURR_CD,'USD') = 'USD' THEN 1" ).append("\n"); 
		query.append("                         ELSE    " ).append("\n"); 
		query.append("                         (SELECT USD_LOCL_XCH_RT" ).append("\n"); 
		query.append("                            FROM GL_MON_XCH_RT XCH" ).append("\n"); 
		query.append("                              WHERE XCH.ACCT_XCH_RT_LVL = 1 " ).append("\n"); 
		query.append("                               AND XCH.CURR_CD           = SO.CURR_CD" ).append("\n"); 
		query.append("                               AND XCH.ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR (SO.LOCL_CRE_DT, 'YYYYMM')))" ).append("\n"); 
		query.append("                         END" ).append("\n"); 
		query.append("                               , 2) WO_TOT_AMT_USD" ).append("\n"); 
		query.append("                ,ROUND ((NVL (SO.INV_BZC_AMT, 0) + NVL (SO.INV_ETC_ADD_AMT, 0)) / " ).append("\n"); 
		query.append("                         CASE WHEN NVL(SO.INV_CURR_CD,'USD') = 'USD' THEN 1" ).append("\n"); 
		query.append("                         ELSE    " ).append("\n"); 
		query.append("                        (SELECT USD_LOCL_XCH_RT" ).append("\n"); 
		query.append("                            FROM GL_MON_XCH_RT XCH" ).append("\n"); 
		query.append("                              WHERE XCH.ACCT_XCH_RT_LVL = 1 " ).append("\n"); 
		query.append("                               AND XCH.CURR_CD           = NVL(SO.INV_CURR_CD, SO.CURR_CD) " ).append("\n"); 
		query.append("                               AND XCH.ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WRK.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM')))" ).append("\n"); 
		query.append("                         END" ).append("\n"); 
		query.append("                               , 2) INV_TOT_AMT_USD" ).append("\n"); 
		query.append("                , CASE WHEN SO.HJL_NO IS NOT NULL THEN (SELECT HJL_INV_VNDR_SEQ FROM TRS_TRSP_HJL_SVC_ORD WHERE TRSP_SO_OFC_CTY_CD = SO.TRSP_SO_OFC_CTY_CD AND TRSP_SO_SEQ = SO.TRSP_SO_SEQ)" ).append("\n"); 
		query.append("                       ELSE SO.INV_VNDR_SEQ" ).append("\n"); 
		query.append("                  END INV_VNDR_SEQ" ).append("\n"); 
		query.append("                ,(SELECT VDR.VNDR_ABBR_NM" ).append("\n"); 
		query.append("                    FROM MDM_VENDOR VDR" ).append("\n"); 
		query.append("                   WHERE VDR.VNDR_SEQ = CASE WHEN SO.HJL_NO IS NOT NULL THEN (SELECT HJL_INV_VNDR_SEQ FROM TRS_TRSP_HJL_SVC_ORD WHERE TRSP_SO_OFC_CTY_CD = SO.TRSP_SO_OFC_CTY_CD AND TRSP_SO_SEQ = SO.TRSP_SO_SEQ)" ).append("\n"); 
		query.append("                                             ELSE SO.INV_VNDR_SEQ" ).append("\n"); 
		query.append("                                        END ) AS INV_VNDR_NM" ).append("\n"); 
		query.append("                ,(SELECT IVDR.VNDR_SEQ ||'$'|| NVL(IVDR.VNDR_ABBR_NM, ' ') ||'$'||" ).append("\n"); 
		query.append("                         (SELECT PVNDR.VNDR_SEQ ||'$'|| NVL(PVNDR.VNDR_ABBR_NM, ' ')" ).append("\n"); 
		query.append("                            FROM MDM_VENDOR PVNDR" ).append("\n"); 
		query.append("                           WHERE PVNDR.VNDR_SEQ = IVDR.PRNT_VNDR_SEQ )" ).append("\n"); 
		query.append("                    FROM MDM_VENDOR IVDR" ).append("\n"); 
		query.append("                   WHERE IVDR.VNDR_SEQ = CASE WHEN SO.HJL_NO IS NOT NULL THEN (SELECT HJL_VNDR_SEQ FROM TRS_TRSP_HJL_SVC_ORD WHERE TRSP_SO_OFC_CTY_CD = SO.TRSP_SO_OFC_CTY_CD AND TRSP_SO_SEQ = SO.TRSP_SO_SEQ)" ).append("\n"); 
		query.append("                                              ELSE SO.VNDR_SEQ" ).append("\n"); 
		query.append("                                         END ) AS INV_VNDR_INFO" ).append("\n"); 
		query.append("                ,SO.TRO_LOD_REF_NO AS TRO_LOD_REF " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                ,(SELECT IF_SYS_KND_CD ||'$'|| TO_CHAR(NVL(DOH.LOCL_UPD_DT, DOH.LOCL_CRE_DT),'YYYYMMDDHH24MISS') ||'$'||' Email : '|| NVL(DOH.USR_EML, ' ') ||' / Tel : '|| NVL(DOH.USR_PHN_NO, ' ') ||'$'||NVL(DOH.CRE_USR_ID, ' ')" ).append("\n"); 
		query.append("                    FROM TRS_TRSP_USA_DO_HDR DOH" ).append("\n"); 
		query.append("                   WHERE DOH.BL_NO = SO.BL_NO) USA_DO_INFO" ).append("\n"); 
		query.append("                ,(SELECT ETH.T1_DOC_FLG" ).append("\n"); 
		query.append("                    FROM BKG_EUR_TRO ETH" ).append("\n"); 
		query.append("                   WHERE ETH.BKG_NO = SO.BKG_NO" ).append("\n"); 
		query.append("                     AND ETH.IO_BND_CD = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("                     AND ETH.TRO_SEQ = SO.TRO_SEQ" ).append("\n"); 
		query.append("                     AND SO.TRSP_COST_DTL_MOD_CD = 'DR' ) T1_DOC_FLG" ).append("\n"); 
		query.append("                ,(SELECT NVL(ETH.ALL_IN_RT_CD,' ') ||'$'|| NVL(TO_CHAR(DECODE(NVL(ETH.TRNS_REV_AMT,0)+NVL(ETH.NMF_TRNS_REV_AMT, 0)+NVL(ETH.ADD_REV_AMT, 0),0,'',NVL(ETH.TRNS_REV_AMT,0)+NVL(ETH.NMF_TRNS_REV_AMT, 0)+NVL(ETH.ADD_REV_AMT, 0) )), ' ') ||'$'||" ).append("\n"); 
		query.append("                         NVL(ETH.CXL_FLG,' ') ||'$'|| NVL(ETH.TRO_PROC_CD,' ') ||'$'|| NVL(ETH.EUR_TRNS_TP_CD,' ')" ).append("\n"); 
		query.append("                    FROM BKG_EUR_TRO ETH" ).append("\n"); 
		query.append("                   WHERE ETH.BKG_NO    = SO.BKG_NO" ).append("\n"); 
		query.append("                     AND ETH.IO_BND_CD = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("                     AND ETH.TRO_SEQ   = SO.TRO_SEQ" ).append("\n"); 
		query.append("                     AND SO.TRSP_COST_DTL_MOD_CD = 'DR' ) EUR_TRO_INFO" ).append("\n"); 
		query.append("                ,(SELECT IBD_TRSP_NO" ).append("\n"); 
		query.append("                    FROM BKG_CSTMS_ADV_IBD" ).append("\n"); 
		query.append("                   WHERE CNT_CD = 'US'" ).append("\n"); 
		query.append("                     AND BL_NO = SO.BL_NO) AS IT_NO " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                ,(SELECT BKG.SC_NO ||'$'|| BKG.RFA_NO " ).append("\n"); 
		query.append("                    FROM BKG_BOOKING BKG     " ).append("\n"); 
		query.append("                   WHERE BKG.BKG_NO = SO.BKG_NO " ).append("\n"); 
		query.append("                   #if($r_sc_rfa_cd.size() > 0) " ).append("\n"); 
		query.append("                      #if (${r_radio_number} == 'S' )" ).append("\n"); 
		query.append("                        AND BKG.SC_NO IN (" ).append("\n"); 
		query.append("                        #foreach( ${key} in ${r_sc_rfa_cd}) " ).append("\n"); 
		query.append("                          #if($velocityCount < $r_sc_rfa_cd.size()) " ).append("\n"); 
		query.append("                             UPPER('${key}'), " ).append("\n"); 
		query.append("                          #else " ).append("\n"); 
		query.append("                             UPPER('${key}')" ).append("\n"); 
		query.append("                          #end " ).append("\n"); 
		query.append("                        #end" ).append("\n"); 
		query.append("                      )" ).append("\n"); 
		query.append("                      #else" ).append("\n"); 
		query.append("                        AND BKG.RFA_NO IN (" ).append("\n"); 
		query.append("                        #foreach( ${key} in ${r_sc_rfa_cd}) " ).append("\n"); 
		query.append("                          #if($velocityCount < $r_sc_rfa_cd.size()) " ).append("\n"); 
		query.append("                             UPPER('${key}'), " ).append("\n"); 
		query.append("                          #else " ).append("\n"); 
		query.append("                             UPPER('${key}')" ).append("\n"); 
		query.append("                          #end " ).append("\n"); 
		query.append("                        #end" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("                      #end" ).append("\n"); 
		query.append("                   #end" ).append("\n"); 
		query.append("                 ) BKG_SC_NO_INFO" ).append("\n"); 
		query.append("                     " ).append("\n"); 
		query.append("                ,(SELECT BKG_CNTR.PCK_QTY ||'$'|| BKG_CNTR.PCK_TP_CD ||'$'||" ).append("\n"); 
		query.append("                         NVL(CASE WHEN BKG_CNTR.DCGO_FLG = 'Y' THEN 'DG'" ).append("\n"); 
		query.append("                              WHEN BKG_CNTR.BB_CGO_FLG = 'Y' THEN 'BB'" ).append("\n"); 
		query.append("                              WHEN BKG_CNTR.AWK_CGO_FLG= 'Y' THEN 'AK'" ).append("\n"); 
		query.append("                              WHEN BKG_CNTR.RC_FLG = 'Y' THEN 'RF'" ).append("\n"); 
		query.append("                              WHEN BKG_CNTR.RD_CGO_FLG = 'Y' THEN 'RD' END" ).append("\n"); 
		query.append("                     , ' ') " ).append("\n"); 
		query.append("                    FROM BKG_CONTAINER BKG_CNTR " ).append("\n"); 
		query.append("                   WHERE BKG_CNTR.BKG_NO  = SO.BKG_NO" ).append("\n"); 
		query.append("                     AND BKG_CNTR.CNTR_NO = SO.EQ_NO" ).append("\n"); 
		query.append("                 ) BKG_CNTR_INFO" ).append("\n"); 
		query.append("                ,TRS_GET_FOC_INFO_FNC(SO.BL_NO, SO.TRSP_SO_OFC_CTY_CD, SO.TRSP_SO_SEQ, '$') EDI_FOC_INFO" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("                ,(SELECT NVL(MST_CNTR.OWNR_CO_CD, ' ') ||'$'|| NVL(MST_CNTR.LSTM_CD, ' ') ||'$'|| NVL(MST_CNTR.IMDT_EXT_FLG, ' ')" ).append("\n"); 
		query.append("                    FROM MST_CONTAINER MST_CNTR" ).append("\n"); 
		query.append("                   WHERE MST_CNTR.CNTR_NO = SO.EQ_NO ) MST_CNTR_INFO" ).append("\n"); 
		query.append("                 ,SO.BKG_RCVDE_TERM_CD" ).append("\n"); 
		query.append("                 ,CASE WHEN TRS_GET_FOC_INFO_FNC(SO.BL_NO, SO.TRSP_SO_OFC_CTY_CD, SO.TRSP_SO_SEQ, NULL) = 'YYY'" ).append("\n"); 
		query.append("                       THEN (SELECT PKUP_NO ||'$'|| PKUP_YD_CD ||'$'|| TO_CHAR(PKUP_AVAL_DT,'YYYYMMDD') ||'$'|| TO_CHAR(LST_FREE_DT,'YYYYMMDD') ||'$'" ).append("\n"); 
		query.append("                               FROM BKG_PKUP_NTC_PKUP_NO PU" ).append("\n"); 
		query.append("                                   ,MDM_LOCATION LOC" ).append("\n"); 
		query.append("                              WHERE LOC.LOC_CD  = PU.DEL_CD" ).append("\n"); 
		query.append("                                AND PU.BKG_NO   = SO.BKG_NO" ).append("\n"); 
		query.append("                                AND PU.CNTR_NO  = SO.EQ_NO" ).append("\n"); 
		query.append("                                AND PU.PKUP_YD_CD = SO.FM_NOD_CD" ).append("\n"); 
		query.append("                                AND SO.CONTI_CD = 'M'" ).append("\n"); 
		query.append("                                AND LOC.DELT_FLG = 'N'" ).append("\n"); 
		query.append("                                AND PU.UPD_DT = (SELECT MAX(Y.UPD_DT)" ).append("\n"); 
		query.append("                                                   FROM BKG_PKUP_NTC_PKUP_NO Y" ).append("\n"); 
		query.append("                                                  WHERE Y.BKG_NO  = PU.BKG_NO" ).append("\n"); 
		query.append("                                                    AND Y.CNTR_NO = PU.CNTR_NO" ).append("\n"); 
		query.append("                                                    AND Y.PKUP_YD_CD = PU.PKUP_YD_CD" ).append("\n"); 
		query.append("                                                )" ).append("\n"); 
		query.append("                                AND ROWNUM = 1" ).append("\n"); 
		query.append("                            )" ).append("\n"); 
		query.append("                       ELSE ''" ).append("\n"); 
		query.append("                  END AS PKUP_INFO" ).append("\n"); 
		query.append("                 ,SO.CONTI_CD" ).append("\n"); 
		query.append("      ,(" ).append("\n"); 
		query.append("        SELECT /*+ ORDERED INDEX_DESC(DMT_CNTR XPKDMT_CHG_BKG_CNTR) */" ).append("\n"); 
		query.append("           TO_CHAR(DMT_CALC.FM_MVMT_DT, 'YYYY-MM-DD')" ).append("\n"); 
		query.append("           || '$' ||DMT_CALC.FM_MVMT_YD_CD" ).append("\n"); 
		query.append("           || '$' ||DMT_CALC.FM_MVMT_STS_CD" ).append("\n"); 
		query.append("           || '$' ||DMT_CALC.TO_MVMT_DT" ).append("\n"); 
		query.append("           || '$' ||DMT_CALC.TO_MVMT_YD_CD" ).append("\n"); 
		query.append("           || '$' ||DMT_CALC.TO_MVMT_STS_CD" ).append("\n"); 
		query.append("           || '$' ||" ).append("\n"); 
		query.append("           NVL((SELECT TO_CHAR(CTM_MOV.CNMV_EVNT_DT, 'YYYY-MM-DD') || '$' || CTM_MOV.ORG_YD_CD" ).append("\n"); 
		query.append("              FROM CTM_MOVEMENT CTM_MOV" ).append("\n"); 
		query.append("             WHERE 1=1" ).append("\n"); 
		query.append("               AND CTM_MOV.CNTR_NO        = DMT_CNTR.CNTR_NO" ).append("\n"); 
		query.append("               AND CTM_MOV.CNMV_YR       IN (DMT_CALC.FM_MVMT_YR, DMT_CALC.TO_MVMT_YR) " ).append("\n"); 
		query.append("               AND CTM_MOV.CNMV_SEQ      IN (DMT_CALC.FM_MVMT_SEQ, DMT_CALC.TO_MVMT_SEQ)" ).append("\n"); 
		query.append("               AND CTM_MOV.CNMV_SPLIT_NO IN (DMT_CALC.FM_MVMT_SPLIT_NO, DMT_CALC.TO_MVMT_SPLIT_NO)" ).append("\n"); 
		query.append("               AND CTM_MOV.MVMT_STS_CD    = 'MT'" ).append("\n"); 
		query.append("               AND ROWNUM = 1" ).append("\n"); 
		query.append("           ),'$')" ).append("\n"); 
		query.append("           || '$' ||DECODE(DMT_CALC.WEB_IND_FLG, 'Y', TO_CHAR(NVL(DMT_CALC.WEB_MTY_DT, DMT_CALC.TO_MVMT_DT), 'YYYY-MM-DD'), TO_CHAR(DMT_CALC.WEB_MTY_DT, 'YYYY-MM-DD')) " ).append("\n"); 
		query.append("           || '$' ||DECODE(DMT_CALC.WEB_IND_FLG, 'Y', TO_CHAR(NVL(DMT_CALC.WEB_MTY_DT, DMT_CALC.TO_MVMT_DT) + 7, 'YYYY-MM-DD'), TO_CHAR(DMT_CALC.WEB_MTY_DT + 7, 'YYYY-MM-DD'))" ).append("\n"); 
		query.append("           || '$' DMT_INFO" ).append("\n"); 
		query.append("        FROM DMT_CHG_BKG_CNTR DMT_CNTR" ).append("\n"); 
		query.append("          ,DMT_CHG_CALC     DMT_CALC" ).append("\n"); 
		query.append("        WHERE DMT_CNTR.SYS_AREA_GRP_ID = DMT_CALC.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("        AND DMT_CNTR.CNTR_NO         = DMT_CALC.CNTR_NO" ).append("\n"); 
		query.append("        AND DMT_CNTR.CNTR_CYC_NO     = DMT_CALC.CNTR_CYC_NO" ).append("\n"); 
		query.append("        AND DMT_CNTR.BKG_NO  = SO.BKG_NO" ).append("\n"); 
		query.append("        AND DMT_CNTR.CNTR_NO = SO.EQ_NO" ).append("\n"); 
		query.append("        AND DMT_CALC.DMDT_TRF_CD = 'DTIC'" ).append("\n"); 
		query.append("        AND DMT_CALC.CHG_SEQ     = 1" ).append("\n"); 
		query.append("        AND 'I' = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("        AND ROWNUM = 1" ).append("\n"); 
		query.append("      )DMDT_INFO" ).append("\n"); 
		query.append("        , SO.SPCL_CGO_CNTR_TP_CD" ).append("\n"); 
		query.append("        , SO.MCNTR_BDL_GRP_SEQ" ).append("\n"); 
		query.append("        , SO.MCNTR_BDL_SEQ" ).append("\n"); 
		query.append("        , DECODE(SO.WTR_RCV_TERM_CD,'0',NULL,SO.WTR_RCV_TERM_CD) WTR_RCV_TERM_CD" ).append("\n"); 
		query.append("        , DECODE(SO.WTR_DE_TERM_CD,'0',NULL,SO.WTR_DE_TERM_CD) WTR_DE_TERM_CD" ).append("\n"); 
		query.append("        , NVL(SO.TTL_DIST,0) TTL_DIST" ).append("\n"); 
		query.append("        , SO.LNK_DIST_DIV_CD" ).append("\n"); 
		query.append("        , SO.CNG_RSN_DESC" ).append("\n"); 
		query.append("        , NVL(SO.SPOT_BID_FLG,'N') SPOT_BID_FLG" ).append("\n"); 
		query.append("        , SO.SPOT_BID_NO" ).append("\n"); 
		query.append("        ,TO_CHAR(SO.SPOT_BID_DUE_DT, 'YYYYMMDD')   SPOT_BID_DUE_DT" ).append("\n"); 
		query.append("        ,TO_CHAR(SO.SPOT_BID_DUE_DT, 'HH24:MI:SS') SPOT_BID_DUE_DT_HMS" ).append("\n"); 
		query.append("        ,DECODE(SO.TRSP_AGMT_WY_TP_CD,'ONE','One Way','RND','Round Trip') TRSP_AGMT_WY_TP_NM" ).append("\n"); 
		query.append("    FROM TRS_TRSP_SVC_ORD SO" ).append("\n"); 
		query.append("        ,TRS_TRSP_WRK_ORD WO" ).append("\n"); 
		query.append("        ,TRS_TRSP_INV_WRK WRK" ).append("\n"); 
		query.append("   WHERE SO.TRSP_WO_OFC_CTY_CD = WO.TRSP_WO_OFC_CTY_CD(+)" ).append("\n"); 
		query.append("     AND SO.TRSP_WO_SEQ = WO.TRSP_WO_SEQ(+)" ).append("\n"); 
		query.append("     AND SO.INV_NO = WRK.INV_NO(+) " ).append("\n"); 
		query.append("     AND SO.INV_VNDR_SEQ = WRK.INV_VNDR_SEQ(+)" ).append("\n"); 
		query.append("    #if($r_trunk_vvd.size() > 0) " ).append("\n"); 
		query.append("       AND ((SO.VSL_CD, SO.SKD_VOY_NO, SO.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_trunk_vvd}) " ).append("\n"); 
		query.append("         #if($velocityCount == 1) " ).append("\n"); 
		query.append("            ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("          , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("         )" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_bkgnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.BKG_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_bkgnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_bkgnumber.size()) " ).append("\n"); 
		query.append("            UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_blnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.BL_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_blnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_blnumber.size()) " ).append("\n"); 
		query.append("            UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_copnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.COP_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_copnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_copnumber.size()) " ).append("\n"); 
		query.append("           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_eqnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.EQ_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_eqnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_eqnumber.size()) " ).append("\n"); 
		query.append("           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      #if (${r_radio_eq} == 'CNTR') " ).append("\n"); 
		query.append("        AND SO.EQ_KND_CD = 'U'" ).append("\n"); 
		query.append("      #elseif (${r_radio_eq} == 'CHS') " ).append("\n"); 
		query.append("        AND SO.EQ_KND_CD = 'Z'" ).append("\n"); 
		query.append("      #elseif (${r_radio_eq} == 'GEN') " ).append("\n"); 
		query.append("        AND SO.EQ_KND_CD = 'G'" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_mtyrefnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.REF_ID IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_mtyrefnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_mtyrefnumber.size()) " ).append("\n"); 
		query.append("           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_period} == 'S') " ).append("\n"); 
		query.append("      #if (${r_from_date} != ''|| ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND SO.LOCL_CRE_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmdd') AND TO_DATE (@[r_to_date], 'rrrrmmdd') + 0.999999" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'W')" ).append("\n"); 
		query.append("      #if (${r_from_date} != ''|| ${r_to_date} != '') " ).append("\n"); 
		query.append("        #if (${month_flg}) " ).append("\n"); 
		query.append("          AND WO.LOCL_CRE_DT BETWEEN TO_DATE ( @[r_from_date] ,'RRRRMM') AND LAST_DAY( TO_DATE( @[r_to_date] , 'RRRRMM'))+1" ).append("\n"); 
		query.append("        #else " ).append("\n"); 
		query.append("          AND WO.LOCL_CRE_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("     #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'I')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND WRK.INV_CFM_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'O')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND SO.N1ST_NOD_PLN_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #elseif (${r_period} == 'L')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND SO.LST_NOD_PLN_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #elseif (${r_period} == 'D')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND SO.DOR_NOD_PLN_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #elseif (${r_period} == 'B')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND SO.SPOT_BID_DUE_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_input_office.size() > 0) " ).append("\n"); 
		query.append("      #if (${r_radio_office} == 'S')" ).append("\n"); 
		query.append("        AND SO.CRE_OFC_CD IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_input_office}) " ).append("\n"); 
		query.append("          #if($velocityCount < $r_input_office.size()) " ).append("\n"); 
		query.append("            UPPER('${key}')," ).append("\n"); 
		query.append("          #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("      #elseif (${r_radio_office} == 'V')" ).append("\n"); 
		query.append("        AND WRK.CRE_OFC_CD IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_input_office}) " ).append("\n"); 
		query.append("          #if($velocityCount < $r_input_office.size()) " ).append("\n"); 
		query.append("            UPPER('${key}')," ).append("\n"); 
		query.append("          #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("      #elseif (${r_radio_office} == 'W')" ).append("\n"); 
		query.append("        AND WO.CRE_OFC_CD IN (" ).append("\n"); 
		query.append("        #foreach( ${key} in ${r_input_office}) " ).append("\n"); 
		query.append("          #if($velocityCount < $r_input_office.size()) " ).append("\n"); 
		query.append("            UPPER('${key}')," ).append("\n"); 
		query.append("          #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_somode} == 'LV') " ).append("\n"); 
		query.append("       AND SO.DELT_FLG = 'N'" ).append("\n"); 
		query.append("    #elseif (${r_somode}=='DL')" ).append("\n"); 
		query.append("       AND SO.DELT_FLG = 'Y'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_womode} != 'ALL')" ).append("\n"); 
		query.append("      #if (${r_womode} == 'IS')" ).append("\n"); 
		query.append("        AND WO.WO_ISS_STS_CD IN ( 'I' , 'R' , 'C')" ).append("\n"); 
		query.append("      #elseif (${r_womode} == 'NS')" ).append("\n"); 
		query.append("        AND NVL(WO.WO_ISS_STS_CD,'N') = 'N'" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_invoicemode} != '' && ${r_invoicemode} != 'ALL')" ).append("\n"); 
		query.append("      #if (${r_invoicemode} == 'NL') " ).append("\n"); 
		query.append("        AND WRK.TRSP_INV_AUD_STS_CD IS NULL" ).append("\n"); 
		query.append("      #else" ).append("\n"); 
		query.append("        AND WRK.TRSP_INV_AUD_STS_CD = @[r_invoicemode]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_boundmode} != '' && ${r_boundmode} != 'ALL')" ).append("\n"); 
		query.append("      AND SO.TRSP_BND_CD = @[r_boundmode]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_radio_user} == 'S') " ).append("\n"); 
		query.append("      #if (${r_user_id} != '') " ).append("\n"); 
		query.append("        AND SO.CRE_USR_ID = @[r_user_id]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_radio_user} == 'V') " ).append("\n"); 
		query.append("      #if (${r_user_id} != '') " ).append("\n"); 
		query.append("        AND WRK.CRE_USR_ID = @[r_user_id]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_costmode} != '' && ${r_costmode} != 'ALL')" ).append("\n"); 
		query.append("      AND SO.TRSP_COST_DTL_MOD_CD = @[r_costmode]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_transmode} != '' && ${r_transmode} != 'ALL')" ).append("\n"); 
		query.append("      AND SO.TRSP_CRR_MOD_CD = @[r_transmode]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_sotype} != '' && ${r_sotype} != 'ALL')" ).append("\n"); 
		query.append("      AND SO.TRSP_SO_TP_CD = @[r_sotype]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_provider} != '' && ${r_provider} != 'ALL') " ).append("\n"); 
		query.append("      #if (${r_provider_type} == 'WO') " ).append("\n"); 
		query.append("        AND CASE WHEN SO.HJL_NO IS NOT NULL THEN (SELECT HJL_VNDR_SEQ FROM TRS_TRSP_HJL_SVC_ORD WHERE TRSP_SO_OFC_CTY_CD = SO.TRSP_SO_OFC_CTY_CD AND TRSP_SO_SEQ = SO.TRSP_SO_SEQ)" ).append("\n"); 
		query.append("                 ELSE SO.VNDR_SEQ" ).append("\n"); 
		query.append("            END = @[r_provider]" ).append("\n"); 
		query.append("      #elseif (${r_provider_type} == 'PA') " ).append("\n"); 
		query.append("        -- ETS ACTUAL VENDOR 고려하지 않기로 함(박진영)2014.03.10" ).append("\n"); 
		query.append("        AND SO.VNDR_SEQ IN ( SELECT PV.VNDR_SEQ" ).append("\n"); 
		query.append("                               FROM MDM_VENDOR PV" ).append("\n"); 
		query.append("                              WHERE PV.PRNT_VNDR_SEQ = @[r_provider])" ).append("\n"); 
		query.append("      #elseif (${r_provider_type} == 'IV') " ).append("\n"); 
		query.append("        AND CASE WHEN SO.HJL_NO IS NOT NULL THEN (SELECT HJL_INV_VNDR_SEQ FROM TRS_TRSP_HJL_SVC_ORD WHERE TRSP_SO_OFC_CTY_CD = SO.TRSP_SO_OFC_CTY_CD AND TRSP_SO_SEQ = SO.TRSP_SO_SEQ)" ).append("\n"); 
		query.append("                 ELSE SO.INV_VNDR_SEQ" ).append("\n"); 
		query.append("            END = @[r_provider]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_from_node} != '') " ).append("\n"); 
		query.append("      AND SO.FM_NOD_CD LIKE @[r_from_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_via_node} != '') " ).append("\n"); 
		query.append("      AND SO.VIA_NOD_CD LIKE @[r_via_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_to_node} != '') " ).append("\n"); 
		query.append("      AND SO.TO_NOD_CD LIKE @[r_to_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_door_node} != '') " ).append("\n"); 
		query.append("      AND SO.DOR_NOD_CD LIKE @[r_door_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_sonumber.size() > 0) " ).append("\n"); 
		query.append("      AND ((SO.TRSP_SO_OFC_CTY_CD, SO.TRSP_SO_SEQ) IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_sonumber}) " ).append("\n"); 
		query.append("          #if($velocityCount == 1) " ).append("\n"); 
		query.append("             ( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #else" ).append("\n"); 
		query.append("            ,( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        ) " ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("   #if (${spot_bid_no} != '') " ).append("\n"); 
		query.append("      AND SO.SPOT_BID_NO = @[spot_bid_no]" ).append("\n"); 
		query.append("   #end     " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("   #if (${spot_bid_flg} != '') " ).append("\n"); 
		query.append("      AND SO.SPOT_BID_FLG = @[spot_bid_flg]" ).append("\n"); 
		query.append("   #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_wonumber.size() > 0) " ).append("\n"); 
		query.append("      AND ((SO.TRSP_WO_OFC_CTY_CD, SO.TRSP_WO_SEQ) IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_wonumber}) " ).append("\n"); 
		query.append("          #if($velocityCount == 1) " ).append("\n"); 
		query.append("             ( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #else" ).append("\n"); 
		query.append("            ,( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        ) " ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_invoicenumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.INV_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} IN ${r_invoicenumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_invoicenumber.size()) " ).append("\n"); 
		query.append("            '${key}'," ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("            '${key}'" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_unplanned} != '' && ${r_unplanned} != 'ALL')" ).append("\n"); 
		query.append("       AND NVL(SO.UPLN_SO_FLG,'N') = @[r_unplanned]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_zip_code.size() > 0) " ).append("\n"); 
		query.append("       AND SO.DOR_PST_CD IN (" ).append("\n"); 
		query.append("       #foreach( ${key} IN ${r_zip_code}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_zip_code.size()) " ).append("\n"); 
		query.append("           UPPER('${key}')," ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_amount} == 'T')" ).append("\n"); 
		query.append("       AND SO.INV_NO IS NOT NULL" ).append("\n"); 
		query.append("       AND NVL(SO.INV_ETC_ADD_AMT,0) = 0" ).append("\n"); 
		query.append("    #elseif (${r_amount} == 'F')" ).append("\n"); 
		query.append("       AND SO.INV_NO IS NOT NULL" ).append("\n"); 
		query.append("       AND NVL(SO.INV_ETC_ADD_AMT,0) <> 0" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_prepull} == 'Y')" ).append("\n"); 
		query.append("       AND SO.PRE_PULL_FLG = @[r_prepull]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_cnt_flg} !='')    " ).append("\n"); 
		query.append("          #if   (${r_cnt_flg} =='Y')" ).append("\n"); 
		query.append("        AND (SO.CUST_NOMI_TRKR_FLG ='Y'    " ).append("\n"); 
		query.append("            OR 0 <> (SELECT COUNT(X.PRC_CTRT_NO)" ).append("\n"); 
		query.append("        #elseif (${r_cnt_flg} =='N')" ).append("\n"); 
		query.append("        AND ( NVL(SO.CUST_NOMI_TRKR_FLG, 'N' )    = 'N'" ).append("\n"); 
		query.append("             AND 0 = (SELECT COUNT(X.PRC_CTRT_NO)" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("                     FROM TRS_CUST_NOMI_TRKR X" ).append("\n"); 
		query.append("                         ,BKG_BOOKING Y" ).append("\n"); 
		query.append("                     WHERE SO.BKG_NO = Y.BKG_NO" ).append("\n"); 
		query.append("                        AND X.PRC_CTRT_TP_CD = DECODE(Y.SC_NO,'','R','S')" ).append("\n"); 
		query.append("                      AND X.PRC_CTRT_NO = NVL(Y.SC_NO,Y.RFA_NO)" ).append("\n"); 
		query.append("                      AND X.IO_BND_CD = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("                      AND X.ORG_NOD_CD = CASE WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(X.ORG_NOD_CD)= 5 THEN SUBSTR(SO.FM_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                              WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(X.ORG_NOD_CD)= 7 THEN SO.FM_NOD_CD" ).append("\n"); 
		query.append("                                              WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(X.ORG_NOD_CD)= 5 THEN SUBSTR(SO.DOR_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                              WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(X.ORG_NOD_CD)= 7 THEN SO.DOR_NOD_CD" ).append("\n"); 
		query.append("                                          END " ).append("\n"); 
		query.append("                      AND X.DEST_NOD_CD = CASE WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(X.DEST_NOD_CD)= 5 THEN SUBSTR(SO.DOR_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                               WHEN SO.TRSP_BND_CD = 'I' AND LENGTH(X.DEST_NOD_CD)= 7 THEN SO.DOR_NOD_CD" ).append("\n"); 
		query.append("                                               WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(X.DEST_NOD_CD)= 5 THEN SUBSTR(SO.TO_NOD_CD,1,5)" ).append("\n"); 
		query.append("                                               WHEN SO.TRSP_BND_CD = 'O' AND LENGTH(X.DEST_NOD_CD)= 7 THEN SO.TO_NOD_CD" ).append("\n"); 
		query.append("                                           END " ).append("\n"); 
		query.append("                         AND X.DISP_STS_CD = '03'" ).append("\n"); 
		query.append("                    )" ).append("\n"); 
		query.append("            )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${grid_flg} == 'Y' && $r_sc_rfa_cd.size() == 0)" ).append("\n"); 
		query.append("       AND ROWNUM < 2001" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append(") X" ).append("\n"); 
		query.append("WHERE 1=1" ).append("\n"); 
		query.append("    #if (${opener} == 'chreport')" ).append("\n"); 
		query.append("        AND NVL(SUBSTR(X.EUR_TRO_INFO, INSTR(X.EUR_TRO_INFO, '$', 1, 2) + 1, INSTR(X.EUR_TRO_INFO, '$', 1, 3) - INSTR(X.EUR_TRO_INFO, '$', 1, 2) - 1), ' ') != 'Y'" ).append("\n"); 
		query.append("        AND X.TRSP_SO_TP_CD IN ('Y','M') -- SO TYPE = Y 또는 MT 만." ).append("\n"); 
		query.append("        AND NVL(X.trsp_bnd_cd,'NULL') IN ('I','O',' ','NULL')    -- 'T' BND 제외08.09.22" ).append("\n"); 
		query.append("        AND X.TRSP_COST_DTL_MOD_CD IN ('CY','DR','ER')    " ).append("\n"); 
		query.append("        AND DECODE(X.TRSP_COST_DTL_MOD_CD, 'CY', X.TRSP_CRR_MOD_CD, 'TD') IN ('TD', 'RD', 'TR', 'RT')      -- 2008.09.03 C/H REPORT 조회시간 단축" ).append("\n"); 
		query.append("        #if (${invar_onlycy} == 'Y')" ).append("\n"); 
		query.append("            AND DECODE(X.TRSP_COST_DTL_MOD_CD, 'CY', X.BKG_RCVDE_TERM_CD, 'D') = 'Y'" ).append("\n"); 
		query.append("        #else" ).append("\n"); 
		query.append("            AND DECODE(X.TRSP_COST_DTL_MOD_CD, 'CY', X.BKG_RCVDE_TERM_CD, 'D') = 'D'    -- 2008.09.19 CY 일때 BKG TERM 'D'" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_sc_rfa_cd.size() > 0) " ).append("\n"); 
		query.append("       #if (${r_radio_number} == 'S' )" ).append("\n"); 
		query.append("         AND SUBSTR(X.BKG_SC_NO_INFO, 1, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) -1) IN (" ).append("\n"); 
		query.append("         #foreach( ${key} in ${r_sc_rfa_cd}) " ).append("\n"); 
		query.append("           #if($velocityCount < $r_sc_rfa_cd.size()) " ).append("\n"); 
		query.append("              UPPER('${key}'), " ).append("\n"); 
		query.append("           #else " ).append("\n"); 
		query.append("              UPPER('${key}')" ).append("\n"); 
		query.append("           #end " ).append("\n"); 
		query.append("         #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("         AND SUBSTR(X.BKG_SC_NO_INFO, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) + 1) IN (" ).append("\n"); 
		query.append("         #foreach( ${key} in ${r_sc_rfa_cd}) " ).append("\n"); 
		query.append("           #if($velocityCount < $r_sc_rfa_cd.size()) " ).append("\n"); 
		query.append("              UPPER('${key}'), " ).append("\n"); 
		query.append("           #else " ).append("\n"); 
		query.append("              UPPER('${key}')" ).append("\n"); 
		query.append("           #end " ).append("\n"); 
		query.append("         #end" ).append("\n"); 
		query.append("         )" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif (${invar_usrail} == 'Y') " ).append("\n"); 
		query.append("/* US RAIL Only inquiry */" ).append("\n"); 
		query.append("SELECT   X.EQ_NO" ).append("\n"); 
		query.append("        ,X.EQ_TPSZ" ).append("\n"); 
		query.append("        ,NULL ORG_EQ_TPSZ" ).append("\n"); 
		query.append("        ,X.TRSP_COST_DTL_MOD_CD" ).append("\n"); 
		query.append("        ,'RD' TRSP_CRR_MOD_CD" ).append("\n"); 
		query.append("        ,'RAIL BILLING' AS TRSP_SO_TP_CD" ).append("\n"); 
		query.append("        ,'N' UPLN_SO_FLG" ).append("\n"); 
		query.append("        ,NULL AS PRE_PULL_FLG" ).append("\n"); 
		query.append("        ,NULL AS BKG_CNTR_CMB_SEQ" ).append("\n"); 
		query.append("        ,X.TRSP_FRST_FLG" ).append("\n"); 
		query.append("		,(SELECT B.BLCK_STWG_CD FROM BKG_BOOKING B WHERE B.BKG_NO = X.BKG_NO) AS BLCK_STWG" ).append("\n"); 
		query.append("        ,X.SO_NO" ).append("\n"); 
		query.append("        ,X.SO_CRE_DT1" ).append("\n"); 
		query.append("        ,X.SO_DEL_FLG" ).append("\n"); 
		query.append("        ,DECODE (X.SO_DEL_FLG,'Y', SO_UPD_DT) SO_DEL_DT" ).append("\n"); 
		query.append("        ,X.SO_UPD_DT" ).append("\n"); 
		query.append("        ,NULL WO_NO" ).append("\n"); 
		query.append("        ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00804' AND CD.INTG_CD_VAL_CTNT = X.WO_ISS_STS_CD) AS WO_ISS_STS_CD" ).append("\n"); 
		query.append("        ,X.WO_ISS_WK" ).append("\n"); 
		query.append("        ,X.WO_ISS_DT" ).append("\n"); 
		query.append("        ,X.WO_ISS_TP" ).append("\n"); 
		query.append("        ,X.WO_ISS_OFC_CD" ).append("\n"); 
		query.append("--        ,X.WO_ISS_ID" ).append("\n"); 
		query.append("        ,(SELECT USR_NM FROM COM_USER CU WHERE CU.USR_ID = X.WO_ISS_ID) AS WO_ISS_NM" ).append("\n"); 
		query.append("        ,'' AGMT_CNT_FLG" ).append("\n"); 
		query.append("        ,'' AGMT_CNT_TP_CD" ).append("\n"); 
		query.append("        ,'' CNT_FLG" ).append("\n"); 
		query.append("        ,'' CNT_TP_CD" ).append("\n"); 
		query.append("        ,'0' CTRT_CNT" ).append("\n"); 
		query.append("        ,X.FM_NOD_CD" ).append("\n"); 
		query.append("        ,NULL VIA_NOD_CD" ).append("\n"); 
		query.append("        ,X.TO_NOD_CD" ).append("\n"); 
		query.append("        ,NULL DOOR" ).append("\n"); 
		query.append("        ,NULL TTL_DIST" ).append("\n"); 
		query.append("        ,NULL LNK_DIST_DIV_CD" ).append("\n"); 
		query.append("           , 'N' SPOT_BID_FLG" ).append("\n"); 
		query.append("        ,NULL SPOT_BID_NO" ).append("\n"); 
		query.append("        ,NULL SPOT_BID_DUE_DT" ).append("\n"); 
		query.append("        ,NULL SPOT_BID_DUE_DT_HMS" ).append("\n"); 
		query.append("        ,NULL DOOR_ACT_CUST" ).append("\n"); 
		query.append("        ,NULL DOOR_FCTRY_NM        " ).append("\n"); 
		query.append("        ,NULL DOOR_ZIP" ).append("\n"); 
		query.append("        ,NULL DOR_DE_ADDR" ).append("\n"); 
		query.append("        ,NULL DOOR_TEL" ).append("\n"); 
		query.append("        ,NULL DOOR_FAX" ).append("\n"); 
		query.append("        ,NULL DOOR_PIC" ).append("\n"); 
		query.append("        ,NULL USA_DO_USR_INFO" ).append("\n"); 
		query.append("        ,NULL DO_CRE_DATE" ).append("\n"); 
		query.append("        ,NULL DO_CRE_TIME" ).append("\n"); 
		query.append(" --       ,NULL VNDR_TP_CD" ).append("\n"); 
		query.append("        ,SUBSTR(X.INV_VNDR_INFO, 1, INSTR(X.INV_VNDR_INFO, '$', 1, 1) - 1) AS VNDR_CD" ).append("\n"); 
		query.append("        ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 1) + 1, INSTR(X.INV_VNDR_INFO, '$', 1, 2) - INSTR(X.INV_VNDR_INFO, '$', 1, 1) - 1) AS VNDR_ABBR_NM" ).append("\n"); 
		query.append("        ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 2) + 1, INSTR(X.INV_VNDR_INFO, '$', 1, 3) - INSTR(X.INV_VNDR_INFO, '$', 1, 2) - 1) AS PVNDR_CD" ).append("\n"); 
		query.append("        ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 3) + 1) AS PVNDR_NM" ).append("\n"); 
		query.append("        ,NULL WO_RCV_DT" ).append("\n"); 
		query.append("        ,NULL APPT_TIME" ).append("\n"); 
		query.append("        ,NULL DELIV_TIME" ).append("\n"); 
		query.append("        ,NULL WTR_RCV_TERM_CD" ).append("\n"); 
		query.append("        ,NULL WTR_DE_TERM_CD" ).append("\n"); 
		query.append("        ,X.N3PTY_BIL_FLG" ).append("\n"); 
		query.append("        ,X.COST_OFC_CD" ).append("\n"); 
		query.append("        ,X.TRSP_AGMT_WY_TP_NM" ).append("\n"); 
		query.append("        ,X.WO_CURR_CD" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_BZC_AMT) WO_BZC_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_NEGO_AMT) WO_NEGO_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_FUEL_SCG_AMT) WO_FUEL_SCG_AMT" ).append("\n"); 
		query.append("        ,'0' WO_VAT_SCG_AMT" ).append("\n"); 
		query.append("        ,'0' WO_ETC_ADD_AMT -- additional " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        -- 20100806 ADD HZD_MTRL_SCG_AMT, OVR_WGT_SCG_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_HZD_MTRL_SCG_AMT) WO_HZD_MTRL_SCG_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_OVR_WGT_SCG_AMT) WO_OVR_WGT_SCG_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_ETC_ADD_AMT) WO_USA_TTL_AMT  -- usa ttl " ).append("\n"); 
		query.append("        --" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_TOT_AMT) WO_TOT_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_TOT_AMT_USD) WO_TOT_AMT_USD" ).append("\n"); 
		query.append("        ,NULL INV_XCH_RT" ).append("\n"); 
		query.append("        ,NULL INV_CALC_LGC_TP_CD" ).append("\n"); 
		query.append("        ,X.INV_CURR_CD" ).append("\n"); 
		query.append("        ,TO_CHAR(X.INV_BZC_AMT) INV_BZC_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.INV_ETC_ADD_AMT) INV_ETC_ADD_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.INV_TOT_AMT) INV_TOT_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.INV_TOT_AMT_USD) INV_TOT_AMT_USD" ).append("\n"); 
		query.append("        ,TO_CHAR(X.INV_VNDR_SEQ) INV_VNDR_CD" ).append("\n"); 
		query.append("        ,X.INV_VNDR_NM" ).append("\n"); 
		query.append("        ,X.INV_NO" ).append("\n"); 
		query.append("        ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00824' AND CD.INTG_CD_VAL_CTNT = X.INV_STS_CD) AS INV_STS_CD" ).append("\n"); 
		query.append("        ,X.INV_CFM_DT" ).append("\n"); 
		query.append("        ,X.CSR_NO CAR_NO" ).append("\n"); 
		query.append("        ,TO_CHAR (X.IF_DT, 'YYYY-MM-DD HH24:MI:SS') INV_IF_DT" ).append("\n"); 
		query.append("        ,X.INV_CFM_OFC_CD" ).append("\n"); 
		query.append("--        ,X.INV_CRE_USR_ID" ).append("\n"); 
		query.append("        ,(SELECT USR_NM FROM COM_USER CU WHERE CU.USR_ID = X.INV_CRE_USR_ID) AS INV_CRE_USR_NM" ).append("\n"); 
		query.append("        ,NULL INV_RMK" ).append("\n"); 
		query.append("        ,X.N1ST_NOD_PLN_DT" ).append("\n"); 
		query.append("        ,X.LST_NOD_PLN_DT" ).append("\n"); 
		query.append("        ,NULL DOR_NOD_PLN_DT" ).append("\n"); 
		query.append("        ,NULL DOR_ARR_DT" ).append("\n"); 
		query.append("        ,X.COP_NO" ).append("\n"); 
		query.append("        ,TO_CHAR(X.AG_SEQ) AG_SEQ" ).append("\n"); 
		query.append("        ,X.AG_CODE" ).append("\n"); 
		query.append("        ,X.BKG_NO " ).append("\n"); 
		query.append("        ,X.BL_NO" ).append("\n"); 
		query.append("        ,X.TRSP_BND_CD" ).append("\n"); 
		query.append("        ,X.TERM" ).append("\n"); 
		query.append("        ,NULL TRO_SEQ" ).append("\n"); 
		query.append("        ,'N/A' TRO_CNFM" ).append("\n"); 
		query.append("        ,NULL TRO_CFM_OFC" ).append("\n"); 
		query.append("        ,NULL TRO_CFM_USR" ).append("\n"); 
		query.append("        ,NULL TRO_CFM_UPD" ).append("\n"); 
		query.append("        ,NULL T1_DOC_FLG " ).append("\n"); 
		query.append("        ,NULL TRO_REV_CUR" ).append("\n"); 
		query.append("        ,NULL EUR_TRO_REV" ).append("\n"); 
		query.append("        ,NULL MANIFESTED" ).append("\n"); 
		query.append("        ,NULL TRO_LOD_REF" ).append("\n"); 
		query.append("        ,NULL BKG_QTY" ).append("\n"); 
		query.append("        ,X.POR_CD POR_CD" ).append("\n"); 
		query.append("        ,X.POL_CD POL_CD" ).append("\n"); 
		query.append("        ,X.POD_CD POD_CD" ).append("\n"); 
		query.append("        ,X.DEL_CD DEL_CD" ).append("\n"); 
		query.append("        ,X.T_VVD" ).append("\n"); 
		query.append("        ,X.SLAN_CD" ).append("\n"); 
		query.append("        ,NULL IB_VVD_CD" ).append("\n"); 
		query.append("        ,NULL IB_SLAN_CD" ).append("\n"); 
		query.append("        ,NULL OB_VVD_CD" ).append("\n"); 
		query.append("        ,NULL OB_SLAN_CD" ).append("\n"); 
		query.append("        ,X.CGO_TP_CD" ).append("\n"); 
		query.append("        ,SUBSTR(X.BKG_CNTR_INFO, INSTR(X.BKG_CNTR_INFO, '$', 1, 2) + 1) AS BKG_SPE" ).append("\n"); 
		query.append("        ,SUBSTR(X.MST_CNTR_INFO, 1, INSTR(X.MST_CNTR_INFO, '$', 1, 1) -1) AS USED" ).append("\n"); 
		query.append("        ,SUBSTR(X.MST_CNTR_INFO, INSTR(X.MST_CNTR_INFO, '$', 1, 1) + 1, INSTR(X.MST_CNTR_INFO, '$', 1, 2) - INSTR(X.MST_CNTR_INFO, '$', 1, 1) - 1) AS LT" ).append("\n"); 
		query.append("        ,SUBSTR(X.MST_CNTR_INFO, INSTR(X.MST_CNTR_INFO, '$', 1, 2) + 1) AS I_EXIT" ).append("\n"); 
		query.append("        ,NULL LT_EXP" ).append("\n"); 
		query.append("        ,(SELECT CNTR_SEAL_NO FROM BKG_CNTR_SEAL_NO WHERE BKG_NO  = X.BKG_NO AND CNTR_NO = X.EQ_NO AND CNTR_SEAL_SEQ = 1) AS SEAL_NO" ).append("\n"); 
		query.append("        ,(SELECT CNTR_SEAL_NO FROM BKG_CNTR_SEAL_NO WHERE BKG_NO  = X.BKG_NO AND CNTR_NO = X.EQ_NO AND CNTR_SEAL_SEQ = 2) AS SEAL_NO2" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WEIGHT_KGS) WEIGHT_KGS" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WEIGHT_LBS) WEIGHT_LBS" ).append("\n"); 
		query.append("        ,SUBSTR(X.BKG_CNTR_INFO, 1, INSTR(X.BKG_CNTR_INFO, '$', 1, 1) -1) AS NO_PKG" ).append("\n"); 
		query.append("        ,SUBSTR(X.BKG_CNTR_INFO, INSTR(X.BKG_CNTR_INFO, '$', 1, 1) + 1, INSTR(X.BKG_CNTR_INFO, '$', 1, 2) - INSTR(X.BKG_CNTR_INFO, '$', 1, 1) - 1) PKG_CD" ).append("\n"); 
		query.append("        ,X.CMDT_NM" ).append("\n"); 
		query.append("        ,X.C_LOC" ).append("\n"); 
		query.append("        ,NULL USA_LAST_CITY" ).append("\n"); 
		query.append("        ,SUBSTR(X.EDI_FOC_INFO, 1, INSTR(X.EDI_FOC_INFO, '$', 1, 1) -1) AS F" ).append("\n"); 
		query.append("        ,SUBSTR(X.EDI_FOC_INFO, INSTR(X.EDI_FOC_INFO, '$', 1, 1) + 1, INSTR(X.EDI_FOC_INFO, '$', 1, 2) - INSTR(X.EDI_FOC_INFO, '$', 1, 1) - 1) AS O" ).append("\n"); 
		query.append("        ,SUBSTR(X.EDI_FOC_INFO, INSTR(X.EDI_FOC_INFO, '$', 1, 2) + 1) AS C" ).append("\n"); 
		query.append("        ,IT_NO" ).append("\n"); 
		query.append("        ,'' AS PICKUP_NO" ).append("\n"); 
		query.append("        ,'' AS PU_YARD_CD" ).append("\n"); 
		query.append("        ,'' AS AVAILABLE_DT" ).append("\n"); 
		query.append("        ,'' AS LAST_FREE_DT" ).append("\n"); 
		query.append("        ,SUBSTR(X.BKG_SC_NO_INFO, 1, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) -1) AS SC_NO" ).append("\n"); 
		query.append("        ,SUBSTR(X.BKG_SC_NO_INFO, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) + 1) AS RFA_NO" ).append("\n"); 
		query.append("        ,DECODE(TRIM(SUBSTR(X.BKG_SC_NO_INFO, 1, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) -1)), NULL," ).append("\n"); 
		query.append("                   (" ).append("\n"); 
		query.append("                    -- RFA 조회" ).append("\n"); 
		query.append("                    SELECT (SELECT MC.CUST_LGL_ENG_NM FROM MDM_CUSTOMER MC WHERE MC.CUST_CNT_CD = A2.CTRT_CUST_CNT_CD AND MC.CUST_SEQ = A2.CTRT_CUST_SEQ) CTRT_CUST_NM" ).append("\n"); 
		query.append("                      FROM PRI_RP_HDR A1" ).append("\n"); 
		query.append("                          ,PRI_RP_MN A2" ).append("\n"); 
		query.append("                          ,PRI_RP_DUR A3" ).append("\n"); 
		query.append("                     WHERE A1.RFA_NO = SUBSTR(X.BKG_SC_NO_INFO, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) + 1)" ).append("\n"); 
		query.append("                       AND A1.PROP_NO = A2.PROP_NO" ).append("\n"); 
		query.append("                       AND A2.AMDT_SEQ = (" ).append("\n"); 
		query.append("                                         SELECT  /*+ INDEX_DESC(X XPKPRI_SP_MN) */" ).append("\n"); 
		query.append("                                                AMDT_SEQ" ).append("\n"); 
		query.append("                                           FROM PRI_RP_MN X" ).append("\n"); 
		query.append("                                          WHERE PROP_NO = A1.PROP_NO" ).append("\n"); 
		query.append("                                            AND PROP_STS_CD = 'A'" ).append("\n"); 
		query.append("                                            AND ROWNUM = 1)" ).append("\n"); 
		query.append("                       AND A2.PROP_NO  = A3.PROP_NO" ).append("\n"); 
		query.append("                       AND A2.AMDT_SEQ = A3.AMDT_SEQ" ).append("\n"); 
		query.append("                   )," ).append("\n"); 
		query.append("                    -- S/C 조회" ).append("\n"); 
		query.append("                   (SELECT (SELECT MC.CUST_LGL_ENG_NM FROM MDM_CUSTOMER MC WHERE MC.CUST_CNT_CD = A3.CUST_CNT_CD AND MC.CUST_SEQ = A3.CUST_SEQ) CTRT_CUST_NM" ).append("\n"); 
		query.append("                    FROM PRI_SP_HDR A1" ).append("\n"); 
		query.append("                        ,PRI_SP_MN A2" ).append("\n"); 
		query.append("                        ,PRI_SP_CTRT_PTY A3" ).append("\n"); 
		query.append("                    WHERE A1.SC_NO = SUBSTR(X.BKG_SC_NO_INFO, 1, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) -1)" ).append("\n"); 
		query.append("                      AND A1.PROP_NO = A2.PROP_NO" ).append("\n"); 
		query.append("                      AND A2.AMDT_SEQ = (" ).append("\n"); 
		query.append("                                        SELECT  /*+ INDEX_DESC(X XPKPRI_SP_MN) */" ).append("\n"); 
		query.append("                                               AMDT_SEQ" ).append("\n"); 
		query.append("                                          FROM PRI_SP_MN X" ).append("\n"); 
		query.append("                                         WHERE PROP_NO = A1.PROP_NO" ).append("\n"); 
		query.append("                                           AND PROP_STS_CD = 'F'" ).append("\n"); 
		query.append("                                           AND ROWNUM = 1)" ).append("\n"); 
		query.append("                      AND A2.PROP_NO  = A3.PROP_NO" ).append("\n"); 
		query.append("                      AND A2.AMDT_SEQ = A3.AMDT_SEQ" ).append("\n"); 
		query.append("                      AND A3.PRC_CTRT_PTY_TP_CD = 'C'" ).append("\n"); 
		query.append("                   )" ).append("\n"); 
		query.append("             ) AS CTRC_CUST_NM" ).append("\n"); 
		query.append("        ,NULL DOOR_SVC_TP" ).append("\n"); 
		query.append("        ,NULL PKUP_CNTR" ).append("\n"); 
		query.append("        ,NULL SHIPPER" ).append("\n"); 
		query.append("        ,NULL CONSIGNEE" ).append("\n"); 
		query.append("        ,NULL NOTIFY" ).append("\n"); 
		query.append("        ,NULL REF_BKG_NO" ).append("\n"); 
		query.append("        ,NULL REF_BL_NO" ).append("\n"); 
		query.append("        ,NULL ORG_GATE_OUT_DT" ).append("\n"); 
		query.append("        ,NULL DEST_GATE_IN_DT" ).append("\n"); 
		query.append("        ,X.MTY_REF_ID" ).append("\n"); 
		query.append("        ,NULL TRSP_PURP_RSN" ).append("\n"); 
		query.append("        ,REPLACE(REPLACE(X.INTER_RMK, CHR(13)||CHR(10), ' '), chr(34), '') AS INTER_RMK" ).append("\n"); 
		query.append("        ,X.NEGO_RMK AS NEGO_RMK" ).append("\n"); 
		query.append("        ,NULL CNG_RSN_DESC        " ).append("\n"); 
		query.append("        ,NULL SPCL_INSTR_RMK" ).append("\n"); 
		query.append("        ,REPLACE(REPLACE(X.WO_INSTR_RMK, CHR(13)||CHR(10), ' '), chr(34), '') AS WO_INSTR_RMK" ).append("\n"); 
		query.append("        ,NULL CHZ_BUNDLE_SEQ" ).append("\n"); 
		query.append("        ,NULL TRSP_SPL_SO_TP_CD" ).append("\n"); 
		query.append("        ,NULL MCNTR_BDL_GRP_SEQ" ).append("\n"); 
		query.append("        ,NULL MCNTR_BDL_SEQ" ).append("\n"); 
		query.append("        ,NULL HJL_NO" ).append("\n"); 
		query.append("        ,NULL WO_HJL_HNDL_AMT" ).append("\n"); 
		query.append("#if (${invar_usdropnpull} == 'Y') " ).append("\n"); 
		query.append("--추가 YJ" ).append("\n"); 
		query.append("        ,''FM_DT" ).append("\n"); 
		query.append("        ,''FM_YD" ).append("\n"); 
		query.append("        ,''FM_STS" ).append("\n"); 
		query.append("        ,''TO_DT" ).append("\n"); 
		query.append("        ,''TO_YD" ).append("\n"); 
		query.append("        ,''TO_STS" ).append("\n"); 
		query.append("        ,''MT_DT" ).append("\n"); 
		query.append("        ,''MT_YD" ).append("\n"); 
		query.append("        ,''WEB_MT_DT" ).append("\n"); 
		query.append("        ,''GRACE_END" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("    #if (${grid_flg} == 'Y')" ).append("\n"); 
		query.append("        ,'M' CONTI_CD" ).append("\n"); 
		query.append("        ,X.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("        ,TO_CHAR(X.TRSP_SO_SEQ) TRSP_SO_SEQ" ).append("\n"); 
		query.append("        ,TO_CHAR(X.VNDR_SEQ) VNDR_SEQ" ).append("\n"); 
		query.append("        ,NULL TRSP_WO_OFC_CTY_CD" ).append("\n"); 
		query.append("        ,NULL TRSP_WO_SEQ" ).append("\n"); 
		query.append("        ,X.WGT_MEAS_UT_CD UOM" ).append("\n"); 
		query.append("        ,X.REGISTRATION_NO" ).append("\n"); 
		query.append("        ,X.UPD_USR_ID" ).append("\n"); 
		query.append("        ,(SELECT USR_NM FROM COM_USER CU WHERE CU.USR_ID = X.UPD_USR_ID) AS UPD_USR_NM" ).append("\n"); 
		query.append("        ,NULL IF_SYS_KND_CD" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("  FROM (" ).append("\n"); 
		query.append("          SELECT --/*+ USE_NL(SO,VNDR,WO,WRK,PU,CMT) USE_NL(WRK,HDR) USE_NL(VNDR,XCH) USE_NL(VNDR,IXCH) INDEX(SO XPKTRS_TRSP_RAIL_BIL_ORD)*/" ).append("\n"); 
		query.append("                 SO.CMDT_CD" ).append("\n"); 
		query.append("                ,VNDR.VNDR_SEQ" ).append("\n"); 
		query.append("                ,SO.CUST_SEQ" ).append("\n"); 
		query.append("                ,SO.CUST_CNT_CD" ).append("\n"); 
		query.append("                ,WRK.CSR_NO" ).append("\n"); 
		query.append("                ,SO.LOCL_CRE_DT SO_CRE_DT" ).append("\n"); 
		query.append("                ,VNDR.LOCL_CRE_DT WO_CRE_DT" ).append("\n"); 
		query.append("                ,WRK.CRE_OFC_CD INV_CRE_OFC_CD" ).append("\n"); 
		query.append("                ,SO.VSL_CD" ).append("\n"); 
		query.append("                ,SO.SKD_VOY_NO" ).append("\n"); 
		query.append("                ,SO.SKD_DIR_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_STS_CD" ).append("\n"); 
		query.append("                ,SO.CGO_TP_CD" ).append("\n"); 
		query.append("                ,(SO.CNTR_WGT / 2.2) WEIGHT_KGS" ).append("\n"); 
		query.append("                ,SO.CNTR_WGT WEIGHT_LBS" ).append("\n"); 
		query.append("                ,SO.WGT_MEAS_UT_CD" ).append("\n"); 
		query.append("                ,SO.EQ_NO EQ_NO" ).append("\n"); 
		query.append("                ,SO.EQ_KND_CD" ).append("\n"); 
		query.append("                ,SO.EQ_TPSZ_CD EQ_TPSZ" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                ,SO.TRSP_COST_DTL_MOD_CD TRSP_COST_DTL_MOD_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_OFC_CTY_CD || SO.TRSP_SO_SEQ SO_NO" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LOCL_CRE_DT, 'YYYY-MM-DD HH24:MI:SS') SO_CRE_DT1" ).append("\n"); 
		query.append("                ,SO.DELT_FLG SO_DEL_FLG" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LOCL_UPD_DT, 'YYYY-MM-DD HH24:MI:SS') SO_UPD_DT" ).append("\n"); 
		query.append("                ,DECODE (WO.BIL_ISS_STS_CD,'X', 'N',WO.BIL_ISS_STS_CD) WO_ISS_STS_CD" ).append("\n"); 
		query.append("                ,(SELECT COST_YR || COST_WK FROM MAS_WK_PRD WHERE TO_CHAR (WO.BIL_EDI_SNT_DT, 'YYYYMMDD') BETWEEN SLS_FM_DT AND SLS_TO_DT) WO_ISS_WK" ).append("\n"); 
		query.append("                ,TO_CHAR (WO.BIL_EDI_SNT_DT, 'YYYY-MM-DD HH24:MI:SS') WO_ISS_DT" ).append("\n"); 
		query.append("                ,DECODE (WO.BIL_ISS_STS_CD,'I', 'EDI','') WO_ISS_TP" ).append("\n"); 
		query.append("                ,WO.CRE_OFC_CD WO_ISS_OFC_CD" ).append("\n"); 
		query.append("                ,WO.CRE_USR_ID WO_ISS_ID" ).append("\n"); 
		query.append("                ,VNDR.FM_NOD_CD FM_NOD_CD" ).append("\n"); 
		query.append("                ,VNDR.TO_NOD_CD TO_NOD_CD" ).append("\n"); 
		query.append("                ,SO.N3PTY_BIL_FLG N3PTY_BIL_FLG" ).append("\n"); 
		query.append("                ,VNDR.CURR_CD WO_CURR_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                   -- 20100806 MOD, VNDR.BZC_AMT WO_BZC_AMT" ).append("\n"); 
		query.append("                ,VNDR.BZC_AMT WO_BZC_AMT " ).append("\n"); 
		query.append("                ,VNDR.NEGO_AMT WO_NEGO_AMT" ).append("\n"); 
		query.append("                ,VNDR.FUEL_SCG_AMT WO_FUEL_SCG_AMT" ).append("\n"); 
		query.append("                ,NVL (VNDR.ETC_ADD_AMT, 0) WO_ETC_ADD_AMT" ).append("\n"); 
		query.append("                -- 20100806 ADD HZD_MTRL_SCG_AMT, OVR_WGT_SCG_AMT" ).append("\n"); 
		query.append("                ,NVL(VNDR.HZD_MTRL_SCG_AMT,0) WO_HZD_MTRL_SCG_AMT" ).append("\n"); 
		query.append("                ,NVL(VNDR.OVR_WGT_SCG_AMT,0) WO_OVR_WGT_SCG_AMT" ).append("\n"); 
		query.append("                -- 20101209 J" ).append("\n"); 
		query.append("                ,NVL(VNDR.BZC_AMT,0) + NVL(VNDR.FUEL_SCG_AMT,0) + NVL(VNDR.OVR_WGT_SCG_AMT,0) + NVL(VNDR.HZD_MTRL_SCG_AMT,0) + NVL(VNDR.ETC_ADD_AMT,0) WO_TOT_AMT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                ,'PHXSA' COST_OFC_CD" ).append("\n"); 
		query.append("                ,VNDR.INV_CURR_CD INV_CURR_CD" ).append("\n"); 
		query.append("                ,NVL(VNDR.INV_BZC_AMT,0) - NVL(VNDR.INV_ETC_ADD_AMT,0) INV_BZC_AMT" ).append("\n"); 
		query.append("                ,VNDR.INV_ETC_ADD_AMT INV_ETC_ADD_AMT" ).append("\n"); 
		query.append("                ,VNDR.INV_BZC_AMT INV_TOT_AMT" ).append("\n"); 
		query.append("                ,VNDR.INV_NO INV_NO" ).append("\n"); 
		query.append("                ,WRK.TRSP_INV_AUD_STS_CD INV_STS_CD" ).append("\n"); 
		query.append("                ,WRK.RGST_NO REGISTRATION_NO" ).append("\n"); 
		query.append("                ,TO_CHAR (WRK.INV_CFM_DT, 'YYYYMMDD') INV_CFM_DT" ).append("\n"); 
		query.append("                ,WRK.CSR_NO CAR_NO" ).append("\n"); 
		query.append("                ,CASE" ).append("\n"); 
		query.append("                    WHEN WRK.TRSP_INV_AUD_STS_CD IN ('CF', 'AR', 'IF', 'PD')" ).append("\n"); 
		query.append("                       THEN WRK.CRE_OFC_CD" ).append("\n"); 
		query.append("                    ELSE ''" ).append("\n"); 
		query.append("                 END INV_CFM_OFC_CD" ).append("\n"); 
		query.append("                ,WRK.CRE_USR_ID INV_CRE_USR_ID" ).append("\n"); 
		query.append("                ,SO.BKG_NO BKG_NO" ).append("\n"); 
		query.append("                ,SO.BL_NO BL_NO" ).append("\n"); 
		query.append("                ,SO.TRSP_BND_CD TRSP_BND_CD" ).append("\n"); 
		query.append("                ,SO.BKG_RCVDE_TERM_CD TERM" ).append("\n"); 
		query.append("                ,SO.POR_CD POR_CD" ).append("\n"); 
		query.append("                ,SO.POL_CD POL_CD" ).append("\n"); 
		query.append("                ,SO.POD_CD POD_CD" ).append("\n"); 
		query.append("                ,SO.DEL_CD DEL_CD" ).append("\n"); 
		query.append("                ,SO.VSL_CD || SO.SKD_VOY_NO || SO.SKD_DIR_CD T_VVD" ).append("\n"); 
		query.append("                ,SO.SLAN_CD SLAN_CD" ).append("\n"); 
		query.append("                ,NULL IB_VVD_CD" ).append("\n"); 
		query.append("                ,NULL IB_SLAN_CD" ).append("\n"); 
		query.append("                  ,NULL OB_VVD_CD" ).append("\n"); 
		query.append("                   ,NULL OB_SLAN_CD" ).append("\n"); 
		query.append("                ,SO.IBD_CSTMS_CLR_LOC_CD C_LOC" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.AVAL_DT, 'YYYYMMDD') AVAILABLE_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LST_FREE_DT, 'YYYYMMDD') LAST_FREE_DT" ).append("\n"); 
		query.append("                ,SO.INTER_RMK INTER_RMK" ).append("\n"); 
		query.append("                ,NULL NEGO_RMK" ).append("\n"); 
		query.append("                ,WO.INTER_RMK WO_INSTR_RMK" ).append("\n"); 
		query.append("                ,SO.COP_NO" ).append("\n"); 
		query.append("                ,SO.COST_ACT_GRP_SEQ AG_SEQ" ).append("\n"); 
		query.append("                ,SO.COST_ACT_GRP_CD AG_CODE" ).append("\n"); 
		query.append("                ,NVL (SO.UPD_USR_ID, SO.CRE_USR_ID) UPD_USR_ID" ).append("\n"); 
		query.append("                ,SO.REF_ID MTY_REF_ID" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("                ,ROUND ((NVL(VNDR.BZC_AMT,0) + NVL(VNDR.FUEL_SCG_AMT,0) + NVL(VNDR.OVR_WGT_SCG_AMT,0) + NVL(VNDR.HZD_MTRL_SCG_AMT,0) + NVL(VNDR.ETC_ADD_AMT,0)) / " ).append("\n"); 
		query.append("                        CASE WHEN NVL(VNDR.CURR_CD,'USD') = 'USD' THEN 1" ).append("\n"); 
		query.append("                        ELSE" ).append("\n"); 
		query.append("                         (SELECT USD_LOCL_XCH_RT" ).append("\n"); 
		query.append("                            FROM GL_MON_XCH_RT XCH" ).append("\n"); 
		query.append("                              WHERE XCH.ACCT_XCH_RT_LVL = 1 " ).append("\n"); 
		query.append("                                  AND XCH.CURR_CD           = VNDR.CURR_CD" ).append("\n"); 
		query.append("                                  AND XCH.ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(SO.LOCL_CRE_DT,'YYYYMM')))" ).append("\n"); 
		query.append("                        END" ).append("\n"); 
		query.append("                               , 2) WO_TOT_AMT_USD         " ).append("\n"); 
		query.append("                ,ROUND (NVL (VNDR.INV_BZC_AMT, 0)  / " ).append("\n"); 
		query.append("                        CASE WHEN NVL(VNDR.INV_CURR_CD,'USD') = 'USD' THEN 1" ).append("\n"); 
		query.append("                        ELSE " ).append("\n"); 
		query.append("                        (SELECT USD_LOCL_XCH_RT" ).append("\n"); 
		query.append("                            FROM GL_MON_XCH_RT XCH" ).append("\n"); 
		query.append("                             WHERE XCH.ACCT_XCH_RT_LVL = 1 " ).append("\n"); 
		query.append("                               AND XCH.CURR_CD           = NVL(VNDR.INV_CURR_CD, VNDR.CURR_CD) " ).append("\n"); 
		query.append("                                  AND XCH.ACCT_XCH_RT_YRMON = NVL(TO_CHAR(WRK.LOCL_CRE_DT,'YYYYMM'),TO_CHAR(WO.LOCL_CRE_DT,'YYYYMM')))" ).append("\n"); 
		query.append("                        END       " ).append("\n"); 
		query.append("                               , 2) INV_TOT_AMT_USD           " ).append("\n"); 
		query.append("                ,NVL (SO.TRSP_FRST_FLG, 'N') TRSP_FRST_FLG" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.N1ST_NOD_PLN_DT, 'YYYY-MM-DD HH24:MI:SS') N1ST_NOD_PLN_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LST_NOD_PLN_DT, 'YYYY-MM-DD HH24:MI:SS') LST_NOD_PLN_DT" ).append("\n"); 
		query.append("                ,VNDR.INV_VNDR_SEQ" ).append("\n"); 
		query.append("                ,(SELECT VDR.VNDR_ABBR_NM" ).append("\n"); 
		query.append("                    FROM MDM_VENDOR VDR" ).append("\n"); 
		query.append("                   WHERE VDR.VNDR_SEQ = VNDR.INV_VNDR_SEQ ) AS INV_VNDR_NM" ).append("\n"); 
		query.append("                ,(SELECT HDR.IF_DT" ).append("\n"); 
		query.append("                    FROM AP_INV_HDR HDR" ).append("\n"); 
		query.append("                   WHERE HDR.CSR_NO = WRK.CSR_NO) AS IF_DT" ).append("\n"); 
		query.append("                ,(SELECT BKG.SC_NO ||'$'|| BKG.RFA_NO " ).append("\n"); 
		query.append("                    FROM BKG_BOOKING BKG     " ).append("\n"); 
		query.append("                   WHERE BKG.BKG_NO = SO.BKG_NO ) BKG_SC_NO_INFO  " ).append("\n"); 
		query.append("                ,(SELECT BKG_CNTR.PCK_QTY ||'$'|| BKG_CNTR.PCK_TP_CD ||'$'||" ).append("\n"); 
		query.append("                         NVL(CASE WHEN BKG_CNTR.DCGO_FLG = 'Y' THEN 'DG'" ).append("\n"); 
		query.append("                              WHEN BKG_CNTR.BB_CGO_FLG = 'Y' THEN 'BB'" ).append("\n"); 
		query.append("                              WHEN BKG_CNTR.AWK_CGO_FLG= 'Y' THEN 'AK'" ).append("\n"); 
		query.append("                              WHEN BKG_CNTR.RC_FLG = 'Y' THEN 'RF'" ).append("\n"); 
		query.append("                              WHEN BKG_CNTR.RD_CGO_FLG = 'Y' THEN 'RD' END" ).append("\n"); 
		query.append("                     , ' ') " ).append("\n"); 
		query.append("                    FROM BKG_CONTAINER BKG_CNTR " ).append("\n"); 
		query.append("                   WHERE BKG_CNTR.BKG_NO  = SO.BKG_NO" ).append("\n"); 
		query.append("                     AND BKG_CNTR.CNTR_NO = SO.EQ_NO" ).append("\n"); 
		query.append("                 ) BKG_CNTR_INFO" ).append("\n"); 
		query.append("                ,(SELECT NVL(MST_CNTR.OWNR_CO_CD, ' ') ||'$'|| NVL(MST_CNTR.LSTM_CD, ' ') ||'$'|| NVL(MST_CNTR.IMDT_EXT_FLG, ' ')" ).append("\n"); 
		query.append("                    FROM MST_CONTAINER MST_CNTR" ).append("\n"); 
		query.append("                   WHERE MST_CNTR.CNTR_NO = SO.EQ_NO ) MST_CNTR_INFO" ).append("\n"); 
		query.append("                ,(SELECT CMDT_NM" ).append("\n"); 
		query.append("                    FROM MDM_COMMODITY CMT" ).append("\n"); 
		query.append("                   WHERE CMT.CMDT_CD = SO.CMDT_CD ) AS CMDT_NM" ).append("\n"); 
		query.append("                ,TRS_GET_FOC_INFO_FNC(SO.BL_NO, SO.TRSP_SO_OFC_CTY_CD, SO.TRSP_SO_SEQ, '$') EDI_FOC_INFO" ).append("\n"); 
		query.append("                ,(SELECT IVDR.VNDR_SEQ ||'$'|| NVL(IVDR.VNDR_ABBR_NM, ' ') ||'$'||" ).append("\n"); 
		query.append("                         (SELECT PVNDR.VNDR_SEQ ||'$'|| NVL(PVNDR.VNDR_ABBR_NM, ' ')" ).append("\n"); 
		query.append("                            FROM MDM_VENDOR PVNDR" ).append("\n"); 
		query.append("                           WHERE PVNDR.VNDR_SEQ = IVDR.VNDR_SEQ )" ).append("\n"); 
		query.append("                   FROM MDM_VENDOR IVDR" ).append("\n"); 
		query.append("                   WHERE IVDR.VNDR_SEQ = VNDR.VNDR_SEQ ) AS INV_VNDR_INFO" ).append("\n"); 
		query.append("                , (SELECT IBD_NO" ).append("\n"); 
		query.append("                     FROM BKG_CGO_RLSE" ).append("\n"); 
		query.append("                    WHERE BL_NO = SO.BL_NO ) AS IT_NO" ).append("\n"); 
		query.append("                ,DECODE(VNDR.TRSP_AGMT_WY_TP_CD,'ONE','One Way','RND','Round Trip') TRSP_AGMT_WY_TP_NM" ).append("\n"); 
		query.append("            FROM TRS_TRSP_RAIL_BIL_ORD SO" ).append("\n"); 
		query.append("                ,TRS_TRSP_RAIL_BIL_VNDR_SET VNDR" ).append("\n"); 
		query.append("                ,TRS_TRSP_EDI_RAIL_ORD WO" ).append("\n"); 
		query.append("                ,TRS_TRSP_RAIL_INV_WRK WRK" ).append("\n"); 
		query.append("           WHERE SO.TRSP_SO_OFC_CTY_CD  = VNDR.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("             AND SO.TRSP_SO_SEQ         = VNDR.TRSP_SO_SEQ  " ).append("\n"); 
		query.append("             AND SO.TRSP_SO_OFC_CTY_CD  = WO.TRSP_SO_OFC_CTY_CD(+)" ).append("\n"); 
		query.append("             AND SO.TRSP_SO_SEQ = WO.TRSP_SO_SEQ(+)" ).append("\n"); 
		query.append("             AND SO.BIL_ISS_KNT = WO.BIL_ISS_KNT(+)" ).append("\n"); 
		query.append("             AND VNDR.INV_NO    = WRK.INV_NO(+)" ).append("\n"); 
		query.append("             AND VNDR.INV_VNDR_SEQ = WRK.INV_VNDR_SEQ(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_trunk_vvd.size() > 0) " ).append("\n"); 
		query.append("       AND ((SO.VSL_CD, SO.SKD_VOY_NO, SO.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_trunk_vvd}) " ).append("\n"); 
		query.append("         #if($velocityCount == 1) " ).append("\n"); 
		query.append("            ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("          , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("         )" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_bkgnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.BKG_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_bkgnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_bkgnumber.size()) " ).append("\n"); 
		query.append("            UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_blnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.BL_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_blnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_blnumber.size()) " ).append("\n"); 
		query.append("            UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_copnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.COP_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_copnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_copnumber.size()) " ).append("\n"); 
		query.append("           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_eqnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.EQ_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_eqnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_eqnumber.size()) " ).append("\n"); 
		query.append("           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      #if (${r_radio_eq} == 'CNTR') " ).append("\n"); 
		query.append("        AND SO.EQ_KND_CD = 'U'" ).append("\n"); 
		query.append("      #elseif (${r_radio_eq} == 'CHS') " ).append("\n"); 
		query.append("        AND SO.EQ_KND_CD = 'Z'" ).append("\n"); 
		query.append("      #elseif (${r_radio_eq} == 'GEN') " ).append("\n"); 
		query.append("        AND SO.EQ_KND_CD = 'G'" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_mtyrefnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.REF_ID IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_mtyrefnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_mtyrefnumber.size()) " ).append("\n"); 
		query.append("           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_period} == 'S') " ).append("\n"); 
		query.append("      #if (${r_from_date} != ''|| ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND SO.LOCL_CRE_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmdd') AND TO_DATE (@[r_to_date], 'rrrrmmdd') + 0.999999" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'W')" ).append("\n"); 
		query.append("      #if (${r_from_date} != ''|| ${r_to_date} != '') " ).append("\n"); 
		query.append("        #if (${month_flg}) " ).append("\n"); 
		query.append("          AND WO.LOCL_CRE_DT BETWEEN TO_DATE ( @[r_from_date] ,'RRRRMM') AND LAST_DAY( TO_DATE( @[r_to_date] , 'RRRRMM'))+1" ).append("\n"); 
		query.append("        #else " ).append("\n"); 
		query.append("          AND WO.LOCL_CRE_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("     #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'I')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND WRK.INV_CFM_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'O')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND SO.N1ST_NOD_PLN_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #elseif (${r_period} == 'L')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND SO.LST_NOD_PLN_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #elseif (${r_period} == 'D')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND 1=2" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_input_office.size() > 0) " ).append("\n"); 
		query.append("      #if (${r_radio_office} == 'S')" ).append("\n"); 
		query.append("        AND SO.CRE_OFC_CD IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_input_office}) " ).append("\n"); 
		query.append("          #if($velocityCount < $r_input_office.size()) " ).append("\n"); 
		query.append("            UPPER('${key}')," ).append("\n"); 
		query.append("          #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("      #elseif (${r_radio_office} == 'V')" ).append("\n"); 
		query.append("        AND WRK.CRE_OFC_CD IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_input_office}) " ).append("\n"); 
		query.append("          #if($velocityCount < $r_input_office.size()) " ).append("\n"); 
		query.append("            UPPER('${key}')," ).append("\n"); 
		query.append("          #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("      #elseif (${r_radio_office} == 'W')" ).append("\n"); 
		query.append("        AND WO.CRE_OFC_CD IN (" ).append("\n"); 
		query.append("        #foreach( ${key} in ${r_input_office}) " ).append("\n"); 
		query.append("          #if($velocityCount < $r_input_office.size()) " ).append("\n"); 
		query.append("            UPPER('${key}')," ).append("\n"); 
		query.append("          #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_somode} == 'LV') " ).append("\n"); 
		query.append("       AND SO.DELT_FLG = 'N'" ).append("\n"); 
		query.append("    #elseif (${r_somode}=='DL')" ).append("\n"); 
		query.append("       AND SO.DELT_FLG = 'Y'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_womode} != 'ALL')" ).append("\n"); 
		query.append("      #if (${r_womode} == 'IS')" ).append("\n"); 
		query.append("        AND WO.BIL_ISS_STS_CD = 'I'" ).append("\n"); 
		query.append("      #elseif (${r_womode} == 'NS')" ).append("\n"); 
		query.append("        AND NVL(WO.BIL_ISS_STS_CD,'X') = 'X'" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_invoicemode} != '' && ${r_invoicemode} != 'ALL')" ).append("\n"); 
		query.append("      #if (${r_invoicemode} == 'NL') " ).append("\n"); 
		query.append("        AND WRK.TRSP_INV_AUD_STS_CD IS NULL" ).append("\n"); 
		query.append("      #else" ).append("\n"); 
		query.append("        AND WRK.TRSP_INV_AUD_STS_CD = @[r_invoicemode]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_boundmode} != '' && ${r_boundmode} != 'ALL')" ).append("\n"); 
		query.append("      AND SO.TRSP_BND_CD = @[r_boundmode]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_radio_user} == 'S') " ).append("\n"); 
		query.append("      #if (${r_user_id} != '') " ).append("\n"); 
		query.append("        AND SO.CRE_USR_ID = @[r_user_id]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_radio_user} == 'V') " ).append("\n"); 
		query.append("      #if (${r_user_id} != '') " ).append("\n"); 
		query.append("        AND WRK.CRE_USR_ID = @[r_user_id]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_costmode} != '' && ${r_costmode} != 'ALL')" ).append("\n"); 
		query.append("      #if (${r_costmode} == 'CY') " ).append("\n"); 
		query.append("        AND SO.CGO_TP_CD = 'F'" ).append("\n"); 
		query.append("      #elseif (${r_costmode} == 'ER') " ).append("\n"); 
		query.append("        AND SO.CGO_TP_CD = 'M'" ).append("\n"); 
		query.append("      #else " ).append("\n"); 
		query.append("        AND SO.TRSP_SO_SEQ = 0" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_transmode} != '' && ${r_transmode} != 'ALL')" ).append("\n"); 
		query.append("      AND 'RD' = @[r_transmode]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_sotype} != '' && ${r_sotype} != 'ALL' && ${r_sotype} != 'R')" ).append("\n"); 
		query.append("      AND SO.TRSP_SO_SEQ = 0" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_provider} != '' && ${r_provider} != 'ALL') " ).append("\n"); 
		query.append("      #if (${r_provider_type} == 'WO') " ).append("\n"); 
		query.append("        AND VNDR.VNDR_SEQ = @[r_provider]" ).append("\n"); 
		query.append("      #elseif (${r_provider_type} == 'PA') " ).append("\n"); 
		query.append("        AND VNDR.VNDR_SEQ IN ( SELECT PV.VNDR_SEQ" ).append("\n"); 
		query.append("                                 FROM MDM_VENDOR PV" ).append("\n"); 
		query.append("                                WHERE PV.PRNT_VNDR_SEQ = @[r_provider] ) " ).append("\n"); 
		query.append("      #elseif (${r_provider_type} == 'IV') " ).append("\n"); 
		query.append("        AND VNDR.INV_VNDR_SEQ = @[r_provider]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_from_node} != '') " ).append("\n"); 
		query.append("      AND VNDR.FM_NOD_CD LIKE @[r_from_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_via_node} != '') " ).append("\n"); 
		query.append("      AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_to_node} != '') " ).append("\n"); 
		query.append("      AND VNDR.TO_NOD_CD LIKE @[r_to_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_door_node} != '') " ).append("\n"); 
		query.append("      AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_sonumber.size() > 0) " ).append("\n"); 
		query.append("      AND ((SO.TRSP_SO_OFC_CTY_CD, SO.TRSP_SO_SEQ) IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_sonumber}) " ).append("\n"); 
		query.append("          #if($velocityCount == 1) " ).append("\n"); 
		query.append("             ( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #else" ).append("\n"); 
		query.append("            ,( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        ) " ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_wonumber.size() > 0) " ).append("\n"); 
		query.append("      AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_invoicenumber.size() > 0) " ).append("\n"); 
		query.append("       AND VNDR.INV_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} IN ${r_invoicenumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_invoicenumber.size()) " ).append("\n"); 
		query.append("            '${key}'," ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("            '${key}'" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_unplanned} != '' && ${r_unplanned} != 'ALL')" ).append("\n"); 
		query.append("       AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_zip_code.size() > 0) " ).append("\n"); 
		query.append("       AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_amount} == 'T')" ).append("\n"); 
		query.append("       AND VNDR.INV_NO IS NOT NULL" ).append("\n"); 
		query.append("       AND NVL(VNDR.INV_ETC_ADD_AMT,0) = 0" ).append("\n"); 
		query.append("    #elseif (${r_amount} == 'F')" ).append("\n"); 
		query.append("       AND VNDR.INV_NO IS NOT NULL" ).append("\n"); 
		query.append("       AND NVL(VNDR.INV_ETC_ADD_AMT,0) <> 0" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${opener} == 'chreport')" ).append("\n"); 
		query.append("       AND SO.TRSP_SO_SEQ=0" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${grid_flg} == 'Y')" ).append("\n"); 
		query.append("       AND ROWNUM < 2001" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(") X" ).append("\n"); 
		query.append("WHERE 1=1" ).append("\n"); 
		query.append("    #if($r_sc_rfa_cd.size() > 0) " ).append("\n"); 
		query.append("       #if (${r_radio_number} == 'S' )" ).append("\n"); 
		query.append("         AND SUBSTR(X.BKG_SC_NO_INFO, 1, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) -1) IN (" ).append("\n"); 
		query.append("         #foreach( ${key} in ${r_sc_rfa_cd}) " ).append("\n"); 
		query.append("           #if($velocityCount < $r_sc_rfa_cd.size()) " ).append("\n"); 
		query.append("              UPPER('${key}'), " ).append("\n"); 
		query.append("           #else " ).append("\n"); 
		query.append("              UPPER('${key}')" ).append("\n"); 
		query.append("           #end " ).append("\n"); 
		query.append("         #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("         AND SUBSTR(X.BKG_SC_NO_INFO, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) + 1) IN (" ).append("\n"); 
		query.append("         #foreach( ${key} in ${r_sc_rfa_cd}) " ).append("\n"); 
		query.append("           #if($velocityCount < $r_sc_rfa_cd.size()) " ).append("\n"); 
		query.append("              UPPER('${key}'), " ).append("\n"); 
		query.append("           #else " ).append("\n"); 
		query.append("              UPPER('${key}')" ).append("\n"); 
		query.append("           #end " ).append("\n"); 
		query.append("         #end" ).append("\n"); 
		query.append("         )" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif (${hid_dom_usrail} == 'Y') " ).append("\n"); 
		query.append("/* Domestic us rail Only inquiry */" ).append("\n"); 
		query.append("SELECT   X.EQ_NO" ).append("\n"); 
		query.append("        ,(SELECT M.CNTR_TPSZ_CD FROM MST_CONTAINER M WHERE M.CNTR_NO = X.EQ_NO) EQ_TPSZ" ).append("\n"); 
		query.append("        ,NULL ORG_EQ_TPSZ" ).append("\n"); 
		query.append("        ,'CY' TRSP_COST_DTL_MOD_CD" ).append("\n"); 
		query.append("        ,'RD' TRSP_CRR_MOD_CD" ).append("\n"); 
		query.append("        ,'Domestic' AS TRSP_SO_TP_CD" ).append("\n"); 
		query.append("        ,'N' UPLN_SO_FLG" ).append("\n"); 
		query.append("        ,NULL PRE_PULL_FLG" ).append("\n"); 
		query.append("        ,NULL BKG_CNTR_CMB_SEQ" ).append("\n"); 
		query.append("        ,NULL TRSP_FRST_FLG" ).append("\n"); 
		query.append("		,(SELECT B.BLCK_STWG_CD FROM BKG_BOOKING B WHERE B.BKG_NO = X.BKG_NO) AS BLCK_STWG" ).append("\n"); 
		query.append("        ,X.SO_NO" ).append("\n"); 
		query.append("        ,X.SO_CRE_DT1" ).append("\n"); 
		query.append("        ,X.SO_DEL_FLG" ).append("\n"); 
		query.append("        ,DECODE (X.SO_DEL_FLG,'Y', SO_UPD_DT) SO_DEL_DT" ).append("\n"); 
		query.append("        ,X.SO_UPD_DT" ).append("\n"); 
		query.append("        ,NULL WO_NO" ).append("\n"); 
		query.append("        ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00804' AND CD.INTG_CD_VAL_CTNT = X.WO_ISS_STS_CD) AS WO_ISS_STS_CD" ).append("\n"); 
		query.append("        ,X.WO_ISS_WK" ).append("\n"); 
		query.append("        ,X.WO_ISS_DT" ).append("\n"); 
		query.append("        ,X.WO_ISS_TP" ).append("\n"); 
		query.append("        ,X.WO_ISS_OFC_CD" ).append("\n"); 
		query.append("        ,(SELECT USR_NM FROM COM_USER CU WHERE CU.USR_ID = X.WO_ISS_ID) AS WO_ISS_NM" ).append("\n"); 
		query.append("        ,'' AGMT_CNT_FLG" ).append("\n"); 
		query.append("        ,'' AGMT_CNT_TP_CD" ).append("\n"); 
		query.append("        ,'' CNT_FLG" ).append("\n"); 
		query.append("        ,'' CNT_TP_CD" ).append("\n"); 
		query.append("        ,'0' CTRT_CNT" ).append("\n"); 
		query.append("        ,X.FM_NOD_CD" ).append("\n"); 
		query.append("        ,NULL VIA_NOD_CD" ).append("\n"); 
		query.append("        ,X.TO_NOD_CD" ).append("\n"); 
		query.append("        ,NULL DOOR" ).append("\n"); 
		query.append("        ,NULL TTL_DIST" ).append("\n"); 
		query.append("        ,NULL LNK_DIST_DIV_CD" ).append("\n"); 
		query.append("        ,'N' SPOT_BID_FLG" ).append("\n"); 
		query.append("        ,NULL SPOT_BID_NO" ).append("\n"); 
		query.append("        ,NULL SPOT_BID_DUE_DT" ).append("\n"); 
		query.append("        ,NULL SPOT_BID_DUE_DT_HMS" ).append("\n"); 
		query.append("        ,NULL DOOR_ACT_CUST" ).append("\n"); 
		query.append("        ,NULL DOOR_FCTRY_NM        " ).append("\n"); 
		query.append("        ,NULL DOOR_ZIP" ).append("\n"); 
		query.append("        ,NULL DOR_DE_ADDR" ).append("\n"); 
		query.append("        ,NULL DOOR_TEL" ).append("\n"); 
		query.append("        ,NULL DOOR_FAX" ).append("\n"); 
		query.append("        ,NULL DOOR_PIC" ).append("\n"); 
		query.append("        ,NULL USA_DO_USR_INFO" ).append("\n"); 
		query.append("        ,NULL DO_CRE_DATE" ).append("\n"); 
		query.append("        ,NULL DO_CRE_TIME" ).append("\n"); 
		query.append("        ,SUBSTR(X.INV_VNDR_INFO, 1, INSTR(X.INV_VNDR_INFO, '$', 1, 1) - 1) AS VNDR_CD" ).append("\n"); 
		query.append("        ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 1) + 1, INSTR(X.INV_VNDR_INFO, '$', 1, 2) - INSTR(X.INV_VNDR_INFO, '$', 1, 1) - 1) AS VNDR_ABBR_NM" ).append("\n"); 
		query.append("        ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 2) + 1, INSTR(X.INV_VNDR_INFO, '$', 1, 3) - INSTR(X.INV_VNDR_INFO, '$', 1, 2) - 1) AS PVNDR_CD" ).append("\n"); 
		query.append("        ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 3) + 1) AS PVNDR_NM" ).append("\n"); 
		query.append("        ,NULL WO_RCV_DT" ).append("\n"); 
		query.append("        ,NULL APPT_TIME" ).append("\n"); 
		query.append("        ,NULL DELIV_TIME" ).append("\n"); 
		query.append("        ,NULL WTR_RCV_TERM_CD" ).append("\n"); 
		query.append("        ,NULL WTR_DE_TERM_CD" ).append("\n"); 
		query.append("        ,X.N3PTY_BIL_FLG" ).append("\n"); 
		query.append("        ,X.COST_OFC_CD" ).append("\n"); 
		query.append("        ,NULL TRSP_AGMT_WY_TP_NM" ).append("\n"); 
		query.append("        ,X.WO_CURR_CD" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_BZC_AMT) WO_BZC_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_NEGO_AMT) WO_NEGO_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_FUEL_SCG_AMT) WO_FUEL_SCG_AMT" ).append("\n"); 
		query.append("        ,'0' WO_VAT_SCG_AMT" ).append("\n"); 
		query.append("        ,'0' WO_ETC_ADD_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_HZD_MTRL_SCG_AMT) WO_HZD_MTRL_SCG_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_OVR_WGT_SCG_AMT) WO_OVR_WGT_SCG_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_ETC_ADD_AMT) WO_USA_TTL_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_TOT_AMT) WO_TOT_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_TOT_AMT_USD) WO_TOT_AMT_USD" ).append("\n"); 
		query.append("        ,NULL INV_XCH_RT" ).append("\n"); 
		query.append("        ,NULL INV_CALC_LGC_TP_CD" ).append("\n"); 
		query.append("        ,Y.INV_CURR_CD" ).append("\n"); 
		query.append("        ,TO_CHAR(Y.INV_BZC_AMT) INV_BZC_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(Y.INV_ETC_ADD_AMT) INV_ETC_ADD_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(Y.INV_TOT_AMT) INV_TOT_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(Y.INV_TOT_AMT_USD) INV_TOT_AMT_USD" ).append("\n"); 
		query.append("        ,TO_CHAR(Y.INV_VNDR_SEQ) INV_VNDR_CD" ).append("\n"); 
		query.append("        ,Y.INV_VNDR_NM" ).append("\n"); 
		query.append("        ,Y.INV_NO" ).append("\n"); 
		query.append("        ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00824' AND CD.INTG_CD_VAL_CTNT = Y.INV_STS_CD) AS INV_STS_CD" ).append("\n"); 
		query.append("        ,Y.INV_CFM_DT" ).append("\n"); 
		query.append("        ,Y.CSR_NO CAR_NO" ).append("\n"); 
		query.append("        ,TO_CHAR (Y.IF_DT, 'YYYY-MM-DD HH24:MI:SS') INV_IF_DT" ).append("\n"); 
		query.append("        ,Y.INV_CFM_OFC_CD" ).append("\n"); 
		query.append("        ,(SELECT USR_NM FROM COM_USER CU WHERE CU.USR_ID = Y.INV_CRE_USR_ID) AS INV_CRE_USR_NM" ).append("\n"); 
		query.append("        ,NULL INV_RMK" ).append("\n"); 
		query.append("        ,NULL N1ST_NOD_PLN_DT" ).append("\n"); 
		query.append("        ,NULL LST_NOD_PLN_DT" ).append("\n"); 
		query.append("        ,NULL DOR_NOD_PLN_DT" ).append("\n"); 
		query.append("        ,NULL DOR_ARR_DT" ).append("\n"); 
		query.append("        ,NULL COP_NO" ).append("\n"); 
		query.append("        ,NULL AG_SEQ" ).append("\n"); 
		query.append("        ,NULL AG_CODE" ).append("\n"); 
		query.append("        ,X.BKG_NO " ).append("\n"); 
		query.append("        ,NULL BL_NO" ).append("\n"); 
		query.append("        ,NULL TRSP_BND_CD" ).append("\n"); 
		query.append("        ,NULL TERM" ).append("\n"); 
		query.append("        ,NULL TRO_SEQ" ).append("\n"); 
		query.append("        ,'N/A' TRO_CNFM" ).append("\n"); 
		query.append("        ,NULL TRO_CFM_OFC" ).append("\n"); 
		query.append("        ,NULL TRO_CFM_USR" ).append("\n"); 
		query.append("        ,NULL TRO_CFM_UPD" ).append("\n"); 
		query.append("        ,NULL T1_DOC_FLG " ).append("\n"); 
		query.append("        ,NULL TRO_REV_CUR" ).append("\n"); 
		query.append("        ,NULL EUR_TRO_REV" ).append("\n"); 
		query.append("        ,NULL MANIFESTED" ).append("\n"); 
		query.append("        ,NULL TRO_LOD_REF" ).append("\n"); 
		query.append("        ,NULL BKG_QTY" ).append("\n"); 
		query.append("        ,NULL POR_CD" ).append("\n"); 
		query.append("        ,NULL POL_CD" ).append("\n"); 
		query.append("        ,NULL POD_CD" ).append("\n"); 
		query.append("        ,NULL DEL_CD" ).append("\n"); 
		query.append("        ,X.T_VVD" ).append("\n"); 
		query.append("        ,NULL SLAN_CD" ).append("\n"); 
		query.append("        ,NULL IB_VVD_CD" ).append("\n"); 
		query.append("        ,NULL IB_SLAN_CD" ).append("\n"); 
		query.append("        ,NULL OB_VVD_CD" ).append("\n"); 
		query.append("        ,NULL OB_SLAN_CD" ).append("\n"); 
		query.append("        ,X.CGO_TP_CD" ).append("\n"); 
		query.append("        ,NULL BKG_SPE" ).append("\n"); 
		query.append("        ,NULL USED" ).append("\n"); 
		query.append("        ,NULL LT" ).append("\n"); 
		query.append("        ,NULL I_EXIT" ).append("\n"); 
		query.append("        ,NULL LT_EXP" ).append("\n"); 
		query.append("        ,NULL SEAL_NO" ).append("\n"); 
		query.append("        ,NULL SEAL_NO2" ).append("\n"); 
		query.append("        ,NULL WEIGHT_KGS" ).append("\n"); 
		query.append("        ,NULL WEIGHT_LBS" ).append("\n"); 
		query.append("        ,NULL NO_PKG" ).append("\n"); 
		query.append("        ,NULL PKG_CD" ).append("\n"); 
		query.append("        ,NULL CMDT_NM" ).append("\n"); 
		query.append("        ,NULL C_LOC" ).append("\n"); 
		query.append("        ,NULL USA_LAST_CITY" ).append("\n"); 
		query.append("        ,NULL F" ).append("\n"); 
		query.append("        ,NULL O" ).append("\n"); 
		query.append("        ,NULL C" ).append("\n"); 
		query.append("        ,NULL IT_NO" ).append("\n"); 
		query.append("        ,NULL PICKUP_NO" ).append("\n"); 
		query.append("        ,NULL PU_YARD_CD" ).append("\n"); 
		query.append("        ,NULL AVAILABLE_DT" ).append("\n"); 
		query.append("        ,NULL LAST_FREE_DT" ).append("\n"); 
		query.append("        ,NULL SC_NO" ).append("\n"); 
		query.append("        ,NULL RFA_NO" ).append("\n"); 
		query.append("        ,NULL CTRC_CUST_NM" ).append("\n"); 
		query.append("        ,NULL DOOR_SVC_TP" ).append("\n"); 
		query.append("        ,NULL PKUP_CNTR" ).append("\n"); 
		query.append("        ,NULL SHIPPER" ).append("\n"); 
		query.append("        ,NULL CONSIGNEE" ).append("\n"); 
		query.append("        ,NULL NOTIFY" ).append("\n"); 
		query.append("        ,NULL REF_BKG_NO" ).append("\n"); 
		query.append("        ,NULL REF_BL_NO" ).append("\n"); 
		query.append("        ,NULL ORG_GATE_OUT_DT" ).append("\n"); 
		query.append("        ,NULL DEST_GATE_IN_DT" ).append("\n"); 
		query.append("        ,NULL MTY_REF_ID" ).append("\n"); 
		query.append("        ,NULL TRSP_PURP_RSN" ).append("\n"); 
		query.append("        ,NULL INTER_RMK" ).append("\n"); 
		query.append("        ,NULL NEGO_RMK" ).append("\n"); 
		query.append("        ,NULL CNG_RSN_DESC        " ).append("\n"); 
		query.append("        ,NULL SPCL_INSTR_RMK" ).append("\n"); 
		query.append("        ,NULL WO_INSTR_RMK" ).append("\n"); 
		query.append("        ,NULL CHZ_BUNDLE_SEQ" ).append("\n"); 
		query.append("        ,NULL TRSP_SPL_SO_TP_CD" ).append("\n"); 
		query.append("        ,NULL MCNTR_BDL_GRP_SEQ" ).append("\n"); 
		query.append("        ,NULL MCNTR_BDL_SEQ" ).append("\n"); 
		query.append("        ,NULL HJL_NO" ).append("\n"); 
		query.append("        ,NULL WO_HJL_HNDL_AMT" ).append("\n"); 
		query.append("#if (${invar_usdropnpull} == 'Y') " ).append("\n"); 
		query.append("        ,'' FM_DT" ).append("\n"); 
		query.append("        ,'' FM_YD" ).append("\n"); 
		query.append("        ,'' FM_STS" ).append("\n"); 
		query.append("        ,'' TO_DT" ).append("\n"); 
		query.append("        ,'' TO_YD" ).append("\n"); 
		query.append("        ,'' TO_STS" ).append("\n"); 
		query.append("        ,'' MT_DT" ).append("\n"); 
		query.append("        ,'' MT_YD" ).append("\n"); 
		query.append("        ,'' WEB_MT_DT" ).append("\n"); 
		query.append("        ,'' GRACE_END" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${grid_flg} == 'Y')" ).append("\n"); 
		query.append("        ,'M' CONTI_CD" ).append("\n"); 
		query.append("        ,X.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("        ,TO_CHAR(X.TRSP_SO_SEQ) TRSP_SO_SEQ" ).append("\n"); 
		query.append("        ,TO_CHAR(X.VNDR_SEQ) VNDR_SEQ" ).append("\n"); 
		query.append("        ,NULL TRSP_WO_OFC_CTY_CD" ).append("\n"); 
		query.append("        ,NULL TRSP_WO_SEQ" ).append("\n"); 
		query.append("        ,NULL UOM" ).append("\n"); 
		query.append("        ,Y.REGISTRATION_NO" ).append("\n"); 
		query.append("        ,X.UPD_USR_ID" ).append("\n"); 
		query.append("        ,(SELECT USR_NM FROM COM_USER CU WHERE CU.USR_ID = X.UPD_USR_ID) AS UPD_USR_NM" ).append("\n"); 
		query.append("        ,NULL IF_SYS_KND_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  FROM (" ).append("\n"); 
		query.append("          SELECT VNDR.VNDR_SEQ" ).append("\n"); 
		query.append("                ,SO.VSL_CD" ).append("\n"); 
		query.append("                ,SO.SKD_VOY_NO" ).append("\n"); 
		query.append("                ,SO.SKD_DIR_CD" ).append("\n"); 
		query.append("                ,'F' CGO_TP_CD" ).append("\n"); 
		query.append("                ,SO.CNTR_NO EQ_NO" ).append("\n"); 
		query.append("                ,'U' EQ_KND_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_OFC_CTY_CD || SO.TRSP_SO_SEQ SO_NO" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.CRE_DT, 'YYYY-MM-DD HH24:MI:SS') SO_CRE_DT1" ).append("\n"); 
		query.append("                ,SO.DELT_FLG SO_DEL_FLG" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.UPD_DT, 'YYYY-MM-DD HH24:MI:SS') SO_UPD_DT" ).append("\n"); 
		query.append("                ,'I' WO_ISS_STS_CD" ).append("\n"); 
		query.append("                ,(SELECT COST_YR || COST_WK FROM MAS_WK_PRD WHERE TO_CHAR (SO.CRE_DT, 'YYYYMMDD') BETWEEN SLS_FM_DT AND SLS_TO_DT) WO_ISS_WK" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.CRE_DT, 'YYYY-MM-DD HH24:MI:SS') WO_ISS_DT" ).append("\n"); 
		query.append("                ,'EDI' WO_ISS_TP  " ).append("\n"); 
		query.append("                ,NULL WO_ISS_OFC_CD" ).append("\n"); 
		query.append("                ,SO.CRE_USR_ID WO_ISS_ID" ).append("\n"); 
		query.append("                ,VNDR.FM_YD_CD FM_NOD_CD" ).append("\n"); 
		query.append("                ,VNDR.TO_YD_CD TO_NOD_CD" ).append("\n"); 
		query.append("                ,NULL N3PTY_BIL_FLG" ).append("\n"); 
		query.append("                ,'USD' WO_CURR_CD" ).append("\n"); 
		query.append("                ,VNDR.AGMT_BZC_AMT WO_BZC_AMT " ).append("\n"); 
		query.append("                ,0 WO_NEGO_AMT" ).append("\n"); 
		query.append("                ,VNDR.FUEL_SCG_AMT WO_FUEL_SCG_AMT" ).append("\n"); 
		query.append("                ,NVL (VNDR.TTL_SCG_AMT, 0) WO_ETC_ADD_AMT" ).append("\n"); 
		query.append("                ,NVL(VNDR.HZD_MTRL_SCG_AMT,0) WO_HZD_MTRL_SCG_AMT" ).append("\n"); 
		query.append("                ,0 WO_OVR_WGT_SCG_AMT" ).append("\n"); 
		query.append("                ,NVL(VNDR.AGMT_BZC_AMT,0) + NVL(VNDR.FUEL_SCG_AMT,0) + NVL(VNDR.HZD_MTRL_SCG_AMT,0) + NVL(VNDR.TTL_SCG_AMT,0) WO_TOT_AMT" ).append("\n"); 
		query.append("                ,'PHXSA' COST_OFC_CD" ).append("\n"); 
		query.append("                ,SO.DMST_BKG_NO BKG_NO" ).append("\n"); 
		query.append("                ,SO.VSL_CD || SO.SKD_VOY_NO || SO.SKD_DIR_CD T_VVD" ).append("\n"); 
		query.append("                ,NVL (SO.UPD_USR_ID, SO.CRE_USR_ID) UPD_USR_ID" ).append("\n"); 
		query.append("                ,ROUND ((NVL(VNDR.AGMT_BZC_AMT,0) + NVL(VNDR.FUEL_SCG_AMT,0) + NVL(VNDR.HZD_MTRL_SCG_AMT,0) + NVL(VNDR.TTL_SCG_AMT,0) ), 2) WO_TOT_AMT_USD       " ).append("\n"); 
		query.append("                ,(SELECT IVDR.VNDR_SEQ ||'$'|| NVL(IVDR.VNDR_ABBR_NM, ' ') ||'$'||" ).append("\n"); 
		query.append("                         (SELECT PVNDR.VNDR_SEQ ||'$'|| NVL(PVNDR.VNDR_ABBR_NM, ' ')" ).append("\n"); 
		query.append("                            FROM MDM_VENDOR PVNDR" ).append("\n"); 
		query.append("                           WHERE PVNDR.VNDR_SEQ = IVDR.VNDR_SEQ )" ).append("\n"); 
		query.append("                    FROM MDM_VENDOR IVDR" ).append("\n"); 
		query.append("                   WHERE IVDR.VNDR_SEQ = VNDR.VNDR_SEQ ) AS INV_VNDR_INFO" ).append("\n"); 
		query.append("            FROM DOM_RAIL_SO_MST SO" ).append("\n"); 
		query.append("                ,DOM_RAIL_SO_DTL VNDR" ).append("\n"); 
		query.append("           WHERE SO.TRSP_SO_OFC_CTY_CD  = VNDR.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("             AND SO.TRSP_SO_SEQ         = VNDR.TRSP_SO_SEQ" ).append("\n"); 
		query.append("             AND (SO.TRSP_SO_OFC_CTY_CD, SO.TRSP_SO_SEQ) IN (SELECT TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                                                                   ,TRSP_SO_SEQ" ).append("\n"); 
		query.append("                                                               FROM SRC)" ).append("\n"); 
		query.append("    ) X" ).append("\n"); 
		query.append("  , (SELECT WDTL.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("           ,WDTL.TRSP_SO_SEQ" ).append("\n"); 
		query.append("           ,WRK.INV_VNDR_SEQ" ).append("\n"); 
		query.append("           ,WRK.CSR_NO" ).append("\n"); 
		query.append("           ,WRK.INV_CURR_CD INV_CURR_CD" ).append("\n"); 
		query.append("           ,NVL(WDTL.INV_BZC_AMT,0) - NVL(WDTL.INV_ETC_ADD_AMT,0) INV_BZC_AMT" ).append("\n"); 
		query.append("           ,WDTL.INV_ETC_ADD_AMT INV_ETC_ADD_AMT" ).append("\n"); 
		query.append("           ,WDTL.INV_BZC_AMT INV_TOT_AMT" ).append("\n"); 
		query.append("           ,WRK.INV_NO INV_NO" ).append("\n"); 
		query.append("           ,WRK.TRSP_INV_AUD_STS_CD INV_STS_CD" ).append("\n"); 
		query.append("           ,WRK.RGST_NO REGISTRATION_NO" ).append("\n"); 
		query.append("           ,TO_CHAR (WRK.INV_CFM_DT, 'YYYYMMDD') INV_CFM_DT" ).append("\n"); 
		query.append("           ,WRK.CSR_NO CAR_NO" ).append("\n"); 
		query.append("           ,CASE WHEN WRK.TRSP_INV_AUD_STS_CD IN ('CF', 'AR', 'IF', 'PD')" ).append("\n"); 
		query.append("                 THEN WRK.CRE_OFC_CD" ).append("\n"); 
		query.append("                 ELSE ''" ).append("\n"); 
		query.append("            END INV_CFM_OFC_CD" ).append("\n"); 
		query.append("           ,WRK.CRE_USR_ID INV_CRE_USR_ID" ).append("\n"); 
		query.append("           ,ROUND (NVL (WDTL.INV_BZC_AMT, 0)  / " ).append("\n"); 
		query.append("                    CASE WHEN NVL(WRK.INV_CURR_CD,'USD') = 'USD' THEN 1" ).append("\n"); 
		query.append("                    ELSE (SELECT USD_LOCL_XCH_RT" ).append("\n"); 
		query.append("                            FROM GL_MON_XCH_RT XCH" ).append("\n"); 
		query.append("                           WHERE XCH.ACCT_XCH_RT_LVL = 1 " ).append("\n"); 
		query.append("                             AND XCH.CURR_CD           = WRK.INV_CURR_CD" ).append("\n"); 
		query.append("                             AND XCH.ACCT_XCH_RT_YRMON = TO_CHAR(WRK.CRE_DT,'YYYYMM'))" ).append("\n"); 
		query.append("                    END    " ).append("\n"); 
		query.append("                  , 2) INV_TOT_AMT_USD " ).append("\n"); 
		query.append("        ,(SELECT VDR.VNDR_ABBR_NM" ).append("\n"); 
		query.append("            FROM MDM_VENDOR VDR" ).append("\n"); 
		query.append("           WHERE VDR.VNDR_SEQ = WRK.INV_VNDR_SEQ ) AS INV_VNDR_NM" ).append("\n"); 
		query.append("        ,(SELECT HDR.IF_DT" ).append("\n"); 
		query.append("            FROM AP_INV_HDR HDR" ).append("\n"); 
		query.append("           WHERE HDR.CSR_NO = WRK.CSR_NO) AS IF_DT" ).append("\n"); 
		query.append("       FROM TRS_TRSP_RAIL_INV_WRK WRK" ).append("\n"); 
		query.append("           ,TRS_TRSP_RAIL_INV_DTL WDTL" ).append("\n"); 
		query.append("      WHERE 1=1           " ).append("\n"); 
		query.append("        AND WDTL.INV_NO            = WRK.INV_NO" ).append("\n"); 
		query.append("        AND WDTL.INV_VNDR_SEQ      = WRK.INV_VNDR_SEQ" ).append("\n"); 
		query.append("        AND (WDTL.TRSP_SO_OFC_CTY_CD, WDTL.TRSP_SO_SEQ) IN (SELECT TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                                                                  ,TRSP_SO_SEQ" ).append("\n"); 
		query.append("                                                              FROM SRC)" ).append("\n"); 
		query.append("    ) Y" ).append("\n"); 
		query.append("WHERE 1=1" ).append("\n"); 
		query.append("  AND X.TRSP_SO_OFC_CTY_CD  = Y.TRSP_SO_OFC_CTY_CD(+)" ).append("\n"); 
		query.append("  AND X.TRSP_SO_SEQ         = Y.TRSP_SO_SEQ(+)" ).append("\n"); 
		query.append("  AND X.VNDR_SEQ            = Y.INV_VNDR_SEQ(+)" ).append("\n"); 
		query.append("#end" ).append("\n"); 

	}
}