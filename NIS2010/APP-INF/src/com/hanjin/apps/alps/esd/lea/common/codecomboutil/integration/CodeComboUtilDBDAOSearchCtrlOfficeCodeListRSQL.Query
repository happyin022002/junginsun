<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CodeComboUtilDBDAOSearchCtrlOfficeCodeListRSQL">
			<desc><![CDATA[CtrlOfficeCodeList]]></desc>
			<sql><![CDATA[
SELECT  DISTINCT YY.CTRL_OFC_CD
FROM( SELECT DISTINCT
                   	CASE WHEN XX.OFC_CD IN ('SELTBB','SELOPE') THEN 'SHARC' --('SELTOB','SELCOE') THEN 'SHAAS'
                         ELSE XX.OFC_N3RD_LVL_CD
                    END	      AS RHQ_CD
               	   ,CASE WHEN XX.OFC_CD IN ('SELTBB','SELOPE') THEN 'SELSC' --('SELTOB','SELCOE') THEN 'SELBB'
                         ELSE XX.OFC_N5TH_LVL_CD
                   	END       AS P_OFC_CD
               		, XX.OFC_CD AS CTRL_OFC_CD
        	FROM( SELECT *
                 FROM( SELECT L.OFC_N3RD_LVL_CD
                             ,L.OFC_N5TH_LVL_CD
                             ,L.OFC_CD
                             ,L.OFC_APLY_TO_YRMON
                             ,L.OFC_APLY_FM_YRMON
                             ,ROW_NUMBER() OVER (PARTITION BY L.OFC_CD ORDER BY L.OFC_APLY_TO_YRMON DESC)  OFC_ORDER
                        FROM  MAS_OFC_LVL L
                       WHERE  L.OFC_N3RD_LVL_CD IS NOT NULL
                         AND  L.OFC_N5TH_LVL_CD IS NOT NULL
                     ) X
                WHERE X.OFC_ORDER = 1
               ) XX
) YY 
WHERE YY.RHQ_CD = @[rhq_cd]			]]></sql>
			<params>
				<param name="rhq_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
