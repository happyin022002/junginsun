<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="USA404EDIStatusInquiryDBDAOSearch04USA404EDIStatusSendRSQL">
			<desc><![CDATA[404 Cancel EDI FF의 내용을 조회 SQL]]></desc>
			<sql><![CDATA[
SELECT 
    A.TRSP_SO_OFC_CTY_CD, A.TRSP_SO_SEQ, 
    CASE WHEN A.FM_NOD_CD='USNYCDS' THEN 'MAHERTRP' 
    WHEN A.TO_NOD_CD='USNYCDS' THEN 'MAHERTRP' 
    ELSE '' 
    END APP_MAHA, 
    CASE WHEN LENGTH(S.EDI_RCV_VNDR_ABBR_NM) > 0 THEN S.EDI_RCV_VNDR_ABBR_NM 
    WHEN LENGTH(T.EDI_RCV_VNDR_ABBR_NM) > 0 THEN T.EDI_RCV_VNDR_ABBR_NM 
    ELSE '' 
    END APP_MTC, 
    CASE     WHEN A.FM_NOD_CD = 'USTIWM1' THEN 'PTXX'           
            WHEN A.FM_NOD_CD = 'USTIWYM' THEN 'PTXX'           
             WHEN A.TO_NOD_CD = 'USTIWM1' THEN 'PTXX'           
            WHEN A.TO_NOD_CD = 'USTIWYM' THEN 'PTXX'           
    ELSE    ''                                              
    END     APP_PTXX,                                        
    CASE     WHEN A.TRSP_BND_CD = 'I' AND                      
                 A.CGO_TP_CD = 'F' AND                        
                (A.FM_NOD_CD = 'USORFM1' OR                    
                A.FM_NOD_CD = 'USORFM2') THEN 'VITUSBRAIL'  
    ELSE    ''                                              
    END     APP_VITUSBRAIL,                                    
    CASE     WHEN A.POD_NOD_CD = 'USLGBM5' AND                 
                 A.FM_NOD_CD != 'USLGBPT' THEN 'SSOFA'        
             WHEN A.POL_NOD_CD = 'USLGBM5' AND                 
                 A.TO_NOD_CD != 'USLGBPT' THEN 'SSOFA'        
    ELSE    ''                                              
    END     APP_SSOFA,                                        
    CASE     WHEN A.POD_NOD_CD = 'USLGBM6' AND                 
                 A.FM_NOD_CD != 'USLGBPT' THEN 'ITS'        
             WHEN A.POL_NOD_CD = 'USLGBM6' AND                 
                 A.TO_NOD_CD != 'USLGBPT' THEN 'ITS'        
    ELSE    ''                                              
    END     APP_ITS,                                        
    CASE     WHEN A.POD_NOD_CD = 'USLAXYM' AND                 
                 A.FM_NOD_CD != 'USLGBPT' THEN 'MTCLAX'        
             WHEN A.POL_NOD_CD = 'USLAXYM' AND                 
                 A.TO_NOD_CD != 'USLGBPT' THEN 'MTCLAX'        
    ELSE    ''                                              
    END     APP_MTCLAX,                                        
    CASE     WHEN A.POD_NOD_CD = 'USLAXM4' AND A.FM_NOD_CD != 'USLGBPT' THEN 'MTCLA'        
             WHEN A.POL_NOD_CD = 'USLAXM4' AND A.TO_NOD_CD != 'USLGBPT' THEN 'MTCLA'
            WHEN A.CGO_TP_CD = 'M' AND A.FM_NOD_CD  = 'USLAXM4' THEN 'MTCLA'
            WHEN A.CGO_TP_CD = 'M' AND A.TO_NOD_CD  = 'USLAXM4' THEN 'MTCLA'
    ELSE    ''                                              
    END     APP_MTCLA,    --CHM-201325385 [TRS] 404 EDI terminal setup 차후 적용
    CASE     WHEN A.POD_NOD_CD = 'USLAXM4' AND A.FM_NOD_CD != 'USLGBPT' THEN 'ETSLAX'        
             WHEN A.POL_NOD_CD = 'USLAXM4' AND A.TO_NOD_CD != 'USLGBPT' THEN 'ETSLAX'
            WHEN A.CGO_TP_CD = 'M' AND A.FM_NOD_CD  = 'USLAXM4' THEN 'ETSLAX'
            WHEN A.CGO_TP_CD = 'M' AND A.TO_NOD_CD  = 'USLAXM4' THEN 'ETSLAX'
    ELSE    ''                                              
    END     APP_ETSLAX,    --CHM-201538922 RailBilling EDI (404 & 998) 중복 생성 요청    
    CASE     WHEN (A.POD_NOD_CD = 'USLGBM5' OR                  
                  A.POD_NOD_CD = 'USLGBM6' OR                 
                  A.POD_NOD_CD = 'USLAXYM' OR 
                  A.POD_NOD_CD = 'USLAXM1' OR 
                  A.POD_NOD_CD = 'USLAXM2' OR
                  A.POD_NOD_CD = 'USLAXM4' ) AND                 
                  A.FM_NOD_CD = 'USLGBPT' THEN 'MTCHANINT'    
             WHEN (A.POL_NOD_CD = 'USLGBM5' OR                  
                  A.POL_NOD_CD = 'USLGBM6' OR                 
                  A.POL_NOD_CD = 'USLAXYM' OR 
                  A.POL_NOD_CD = 'USLAXM1' OR 
                  A.POL_NOD_CD = 'USLAXM2' OR
                  A.POL_NOD_CD = 'USLAXM4' ) AND                 
                  A.TO_NOD_CD = 'USLGBPT' THEN 'MTCHANINT'    
    ELSE    ''                                              
    END     APP_MTCHANINT,                                    
    CASE     WHEN (A.POD_NOD_CD = 'USLGBM5' OR                  
                  A.POD_NOD_CD = 'USLGBM6' OR                 
                  A.POD_NOD_CD = 'USLAXYM' OR 
                  A.POD_NOD_CD = 'USLAXM1' OR 
                  A.POD_NOD_CD = 'USLAXM2' OR
                  A.POD_NOD_CD = 'USLAXM4' ) AND                 
                  A.FM_NOD_CD = 'USLGBPT' THEN 'MTCHAN'        
             WHEN (A.POL_NOD_CD = 'USLGBM5' OR                  
                  A.POL_NOD_CD = 'USLGBM6' OR                 
                  A.POL_NOD_CD = 'USLAXYM' OR 
                  A.POL_NOD_CD = 'USLAXM1' OR 
                  A.POL_NOD_CD = 'USLAXM2' OR
                  A.POL_NOD_CD = 'USLAXM4' ) AND                 
                  A.TO_NOD_CD = 'USLGBPT' THEN 'MTCHAN'        
    ELSE    ''                                              
    END     APP_MTCHAN,
    DECODE(C.USA_EDI_CD,'NWCS','NWCS310','') APP_NWCS310,
    CASE    WHEN A.POD_NOD_CD = 'USLAXM2' AND
                 A.FM_NOD_CD = 'USLAXM2' THEN '3105488232'
            WHEN A.POL_NOD_CD = 'USLAXM2' AND
                 A.TO_NOD_CD = 'USLAXM2' THEN '3105488232'
    ELSE    ''
    END     APP_3105488232,
    A.RAIL_CMB_THRU_TP_CD RAIL_CMB, S.EDI_RCV_VNDR_ABBR_NM APP_MTC1, T.EDI_RCV_VNDR_ABBR_NM APP_MTC2, 
    C.USA_EDI_CD APPRECV_C,
    DECODE(A.CGO_TP_CD, 'F', 'B', 'M', 'E', '') SHIPQLF_C, 
    DECODE( A.CGO_TP_CD , 'M', 'EMPTY REPO', DECODE( A.TRSP_BND_CD, 'O' , O.BKG_NO, '') )  BKGNO,
    DECODE( A.TRSP_BND_CD, 'I' ,A.BL_NO, '') BLNO,
    A.SC_NO BKG_SCNO,
    TO_CHAR(A.WO_ISS_DT, 'YYYYMMDD') ACTDT, 
    A.VSL_CD VSLCODE, 
    A.SKD_VOY_NO||A.SKD_DIR_CD VOYAGE, 
    Q.VSL_ENG_NM VSLNAME,
    CASE WHEN A.CGO_TP_CD ='F' AND A.TRSP_BND_CD = 'O' THEN ( SELECT TO_CHAR(A.SYS_SET_DT,'YYYYMMDDHH24MI') 
                                                                   FROM BKG_CLZ_TM A
                                                                 WHERE BKG_NO = BK.BKG_NO
                                                                    AND CLZ_TP_CD = 'T')
         ELSE ''
    END AS VSLCUTOFF,
    Q.LLOYD_NO LLOYD,
    CASE WHEN A.CGO_TP_CD ='F' AND A.TRSP_BND_CD = 'O' THEN ( SELECT TO_CHAR(A.SYS_SET_DT,'YYYYMMDDHH24MI') 
                                                                   FROM BKG_CLZ_TM A
                                                                 WHERE BKG_NO = BK.BKG_NO
                                                                    AND CLZ_TP_CD = 'F')
    END AS HUBETA,    
    NVL(DECODE(A.TRSP_BND_CD, 'O', A.POL_NOD_CD, ''), '') POL, 
    NVL(DECODE(A.TRSP_BND_CD, 'I', A.POD_NOD_CD, ''), '') POD, 
    UPPER(O.AGMT_REF_NO) CONTRACT, 
    LPAD(O.BIL_EDI_CTRL_SEQ, 8, '0') CREDIT, 
    'M'||LPAD(O.BIL_EDI_CTRL_SEQ, 8, '0') MTC_CREDIT, 
    DECODE(SUBSTR(BK.DEL_CD, 1, 2), 'CA', CND.IBD_LOC_GDS_DESC, DECODE(AI.IBD_TRSP_TP_CD, '61', AI.IBD_TRSP_NO, '')) IMTRANSNO, 
    DECODE(SUBSTR(BK.DEL_CD,1,2), 'CA', '',DECODE( AI.IBD_TRSP_TP_CD, '62', AI.IBD_TRSP_NO)  ) TRANSEXPNO, '' DOCK, 
    '' FFDESC, A.EQ_TPSZ_CD EQNISTS, SUBSTR(A.EQ_NO, 1, 4) EQINIT, SUBSTR(A.EQ_NO, 5, 6) EQNO, 
    ROUND( DECODE (A.TRSP_BND_CD, 'O', A.CNTR_WGT, DECODE(D.WGT_UT_CD, 'KGS', NVL(D.CNTR_WGT, 0) * 2.2,  NVL(D.CNTR_WGT, 0)))) WGT, 
    O.EQDESC_C, DECODE(SUBSTR(A.EQ_TPSZ_CD, 2, 1), '2', '2000', '7', '4500', '4000' ) EQLTH_C, 
    SUBSTR(A.EQ_NO, 11, 1) EQCHK, 
    CASE WHEN LENGTH(S.EDI_RCV_VNDR_ABBR_NM) > 0 OR LENGTH(T.EDI_RCV_VNDR_ABBR_NM) > 0 THEN 'Z' 
    ELSE 'X' 
    END EX_VNDR, 
    (SELECT CNTR_SEAL_NO FROM BKG_CNTR_SEAL_NO WHERE BKG_NO = D.BKG_NO AND CNTR_NO = D.CNTR_NO AND CNTR_SEAL_SEQ = 1) SEALNO,
    DECODE(A.CGO_TP_CD, 'M', 'XP', DECODE(A.TRSP_BND_CD, 'I', 'IP', 'O', 'XP', '')) SPCHAND_C, 
    'ML' ILTRANS_C, DECODE(SUBSTR(A.FM_NOD_CD, 1, 5),'CAVAN','IB',  AI.IBD_TRSP_TP_CD) CUSTENTTP_C, DECODE(SUBSTR(BK.DEL_CD, 1, 2), 'CA', CV.CGO_CTRL_NO_PFX_NM, AI.IBD_TRSP_NO) CUSTENTNO, 
    DECODE(C.USA_EDI_CD, 'CPRS', '61', '') CUSTTYPE, 
    DECODE(C.USA_EDI_CD, 'CPRS', CASE WHEN AI.CSTMS_CLR_TP_CD = 'L' THEN 
                                                (SELECT F.LOC_AMS_PORT_CD FROM MDM_LOCATION F WHERE F.LOC_CD = CND.CSTMS_POD_CD)
                                      ELSE (SELECT F.LOC_AMS_PORT_CD FROM MDM_LOCATION F WHERE F.LOC_CD = CND.HUB_LOC_CD)
                                 END
                        ,'CN',CASE WHEN A.TRSP_BND_CD = 'I' AND 'US' = SUBSTR(A.ROUT_DEST_NOD_CD,1,2) THEN( SELECT LOC_AMS_PORT_CD  
                                                                                                              FROM MDM_LOCATION
                                                                                                              WHERE LOC_CD = ( SELECT A.CSTMS_LOC_CD
                                                                                                                                 FROM BKG_CSTMS_ADV_BL A
                                                                                                                                   WHERE A.CNT_CD ='US'
                                                                                                                                      AND A.BL_NO = (SELECT BL_NO
                                                                                                                                                    FROM BKG_BOOKING A
                                                                                                                                                   WHERE A.BKG_NO = BK.BKG_NO)
                                                                                                                               )
                                                                                                              ) 
                              END
                              , '') CUSTLOC,
    DECODE(C.USA_EDI_CD, 'CPRS', A.CNTR_WGT, 0) CARGOWGT, 
    I.YD_LOC_CTY_NM ORGCTY, I.YD_LOC_STE_CD ORGSTATE, I.YD_CTRL_OFC_CTY_NM||', '||I.YD_CTRL_OFC_STE_CD ORGLOC, A.FM_NOD_CD ORGYD, 
    K.YD_LOC_CTY_NM DSTCTY, K.YD_LOC_STE_CD DSTSTATE, K.YD_CTRL_OFC_CTY_NM||', '||K.YD_CTRL_OFC_STE_CD DSTLOC, A.TO_NOD_CD DSTYD,  
    'SM LINE CORPORATION' SHPR_N,  TRIM(REPLACE( REPLACE(REPLACE(REPLACE(I.YD_CTRL_OFC_ADDR, CHR(13), ' '), CHR(10), ' '), CHR(9), ' '), CHR(43), ' ')) SHPR_A, 
    I.YD_CTRL_OFC_CTY_NM SHPR_C, I.YD_CTRL_OFC_STE_CD SHPR_S, I.YD_CTRL_OFC_ZIP_CD SHPR_P, LOC1.CNT_CD AS SHPR_CN,
    DECODE(J.BKG_CUST_TP_CD, 'S',J.CUST_CNT_CD||LPAD(J.CUST_SEQ,6,0),'') ASHPR_CODE, 
    DECODE(J.BKG_CUST_TP_CD, 'S', TRIM(REPLACE( REPLACE(REPLACE(J.CUST_NM, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')), '') ASHPR_N, 
    DECODE(J.BKG_CUST_TP_CD, 'S', TRIM(REPLACE( REPLACE(REPLACE(J.CUST_ADDR, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')), '') ASHPR_A, 
    CASE WHEN SCST.CUST_CNT_CD = 'US' OR SCST.CUST_CNT_CD = 'CA' THEN DECODE(J.BKG_CUST_TP_CD, 'S', DECODE(J.CUST_CTY_NM, '', SCST.CTY_NM, J.CUST_CTY_NM), '') 
         ELSE DECODE(J.BKG_CUST_TP_CD, 'S', J.CUST_CTY_NM, '') 
    END ASHPR_C, 
    CASE WHEN SCST.CUST_CNT_CD = 'US' OR SCST.CUST_CNT_CD = 'CA' THEN DECODE(J.BKG_CUST_TP_CD, 'S', DECODE(J.CUST_STE_CD, '', SCST.STE_CD, J.CUST_STE_CD), '') 
         ELSE DECODE(J.BKG_CUST_TP_CD, 'S', J.CUST_STE_CD, '') 
    END ASHPR_S, 
    CASE WHEN SCST.CUST_CNT_CD = 'US' OR SCST.CUST_CNT_CD = 'CA' THEN DECODE(J.BKG_CUST_TP_CD, 'S', DECODE(J.CUST_ZIP_ID, '', SCST.ZIP_CD, J.CUST_ZIP_ID), '') 
         ELSE DECODE(J.BKG_CUST_TP_CD, 'S', J.CUST_ZIP_ID, '') 
    END ASHPR_P, 
    CASE WHEN SCST.CUST_CNT_CD = 'US' OR SCST.CUST_CNT_CD = 'CA' THEN DECODE(J.BKG_CUST_TP_CD, 'S', DECODE(J.CUST_CNT_CD, '', SCST.CUST_CNT_CD, J.CUST_CNT_CD), '') 
         ELSE DECODE(J.BKG_CUST_TP_CD, 'S', J.CUST_CNT_CD, '') 
    END ASHPR_CN, 
    'SM LINE CORPORATION' CNEE_N, 
    TRIM(REPLACE(REPLACE(REPLACE(K.YD_CTRL_OFC_ADDR, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) CNEE_A, 
    K.YD_CTRL_OFC_CTY_NM  CNEE_C, K.YD_CTRL_OFC_STE_CD CNEE_S, K.YD_CTRL_OFC_ZIP_CD CNEE_P, LOC2.CNT_CD AS CNEE_CN,
    NVL(OFC.TEAM_MGR_NM,  'SM LINE CORPORATION') NTFY_N, NVL(REPLACE(REPLACE(  NVL( OFC.TEAM_FAX_NO,  OFC.OFC_FAX_NO  )  , ' ', ''), '-', ''), '') NTFY_T, 
    'SM LINE CORPORATION' CARE_N, K.YD_CTRL_OFC_ADDR CARE_A, K.YD_CTRL_OFC_CTY_NM CARE_C, 
    K.YD_CTRL_OFC_STE_CD CARE_S, K.YD_CTRL_OFC_ZIP_CD CARE_P, LOC2.CNT_CD AS CARE_CN, 'SM LINE CORPORATION' BILL_N, 
    '1750 E. NORTHROP BLVD SUITE 140' BILL_A, 'CHANDLER' BILL_C, 'AZ' BILL_S, '85286' BILL_P, 'US'AS BILL_CN,
      CASE WHEN A.TRSP_BND_CD='O' AND J.BKG_CUST_TP_CD='S' THEN J.CUST_CNT_CD||LPAD(J.CUST_SEQ,6,0)
         WHEN A.TRSP_BND_CD='I' AND BK.CUST_TO_ORD_FLG='Y' THEN N.CUST_CNT_CD||LPAD(N.CUST_SEQ,6,0)
         WHEN A.TRSP_BND_CD='I' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN L.CUST_CNT_CD||LPAD(L.CUST_SEQ,6,0)
          ELSE '' 
    END UTCN_CODE, 
    CASE WHEN A.TRSP_BND_CD='O' AND J.BKG_CUST_TP_CD='S' THEN TRIM(REPLACE(REPLACE(REPLACE(J.CUST_NM, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) 
         WHEN A.TRSP_BND_CD='I' AND BK.CUST_TO_ORD_FLG='Y' THEN TRIM(REPLACE(REPLACE(REPLACE(N.CUST_NM, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) 
         WHEN A.TRSP_BND_CD='I' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN TRIM(REPLACE(REPLACE(REPLACE(L.CUST_NM, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) 
         WHEN A.CGO_TP_CD='M' THEN 'SM LINE CORPORATION' 
         ELSE '' 
    END UTCN_N, 
    CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN TRIM(REPLACE(REPLACE(REPLACE(N.CUST_ADDR, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) 
         WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN TRIM(REPLACE(REPLACE(REPLACE(L.CUST_ADDR, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) 
         ELSE '' 
    END UTCN_A, 
    CASE WHEN CCST.CUST_CNT_CD = 'US' OR CCST.CUST_CNT_CD = 'CA' THEN CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN DECODE(N.CUST_CTY_NM, '', NCST.CTY_NM, N.CUST_CTY_NM) 
                                                                                          WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN DECODE(L.CUST_CTY_NM, '', CCST.CTY_NM, L.CUST_CTY_NM) 
                                                                                         ELSE '' 
                                                                                    END 
         ELSE CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN N.CUST_CTY_NM 
                    WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN L.CUST_CTY_NM 
                   ELSE '' 
              END 
    END UTCN_C, 
    CASE WHEN CCST.CUST_CNT_CD = 'US' OR CCST.CUST_CNT_CD = 'CA' THEN CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN DECODE(N.CUST_STE_CD, '', NCST.STE_CD, N.CUST_STE_CD) 
                                                                                          WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN DECODE(L.CUST_STE_CD, '', CCST.STE_CD, L.CUST_STE_CD) 
                                                                                         ELSE '' 
                                                                                    END 
         ELSE CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN N.CUST_STE_CD 
                    WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN L.CUST_STE_CD 
                   ELSE '' 
              END 
    END UTCN_S, 
    CASE WHEN CCST.CUST_CNT_CD = 'US' OR CCST.CUST_CNT_CD = 'CA' THEN CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN DECODE(N.CUST_ZIP_ID, '', NCST.ZIP_CD, N.CUST_ZIP_ID) 
                                                                                          WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN DECODE(L.CUST_ZIP_ID, '', CCST.ZIP_CD, L.CUST_ZIP_ID) 
                                                                                         ELSE '' 
                                                                                    END 
         ELSE CASE WHEN L.BKG_CUST_TP_CD='C' AND BK.CUST_TO_ORD_FLG='Y' THEN N.CUST_ZIP_ID 
                    WHEN L.BKG_CUST_TP_CD='C' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN L.CUST_ZIP_ID 
                   ELSE '' 
              END 
    END UTCN_P, 
      CASE WHEN A.TRSP_BND_CD='O' AND J.BKG_CUST_TP_CD='S' THEN J.CUST_CNT_CD
         WHEN A.TRSP_BND_CD='I' AND BK.CUST_TO_ORD_FLG='Y' THEN N.CUST_CNT_CD
         WHEN A.TRSP_BND_CD='I' AND NVL(BK.CUST_TO_ORD_FLG,'N')<>'Y' THEN L.CUST_CNT_CD
          ELSE '' 
    END UTCN_CN,
    'SM LINE CORPORATION' RECV_N, '1750 E. NORTHROP BLVD SUITE 140' RECV_A, 'CHANDLER' RECV_C, 'AZ' RECV_S, 
    '85286' RECV_P, 'US' AS RECV_CN, 'SM LINE CORPORATION' ADMC_C, SP.FDA FDA_IND, 
    TRIM(REPLACE( REPLACE(REPLACE(BF.CUST_NM, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) CUST_F, 
    TRIM(REPLACE( REPLACE(REPLACE(BE.CUST_NM, CHR(13), ' '), CHR(10), ' '), CHR(43), ' ')) CUST_E, 
    NVL(M.FDO_TEMP, 0) TEMP, 
    CASE WHEN M.BKG_NO IS NOT NULL AND M.CNTR_NO IS NOT NULL THEN 'F' 
    ELSE '' 
    END TUN, 
    M.VENT_RTO VENT, M.HUMID_NO HUMID, M.PWR_SPL_CBL_FLG GENSET, 
    'AESNO' REFID, A.AUTO_XPT_SYS_NO REFVAL, '' S, 
--    C.USA_EDI_CD APPRECV_C_OLD,
    C.USA_EDI_CD APPRECV_C_OLD,
    DECODE( A.CGO_TP_CD , 'M', 'EMPTY REPO', DECODE( A.TRSP_BND_CD, 'O' , O.BKG_NO, '') ) BKGNO_OLD, 
    DECODE( A.TRSP_BND_CD, 'I' ,A.BL_NO, '') BLNO_OLD, 
    UPPER(O.AGMT_REF_NO) CONTRACT, LPAD(O.BIL_EDI_CTRL_SEQ, 8, '0') CREDIT_OLD, 
    'M'||LPAD(O.BIL_EDI_CTRL_SEQ, 8, '0') MTC_CREDIT_OLD, 
    SUBSTR(A.EQ_NO, 1, 4) EQINIT_OLD, SUBSTR(A.EQ_NO, 5, 6) EQNO_OLD, 
    TO_CHAR(A.WO_ISS_DT, 'YYYYMMDD') SNDDT_OLD, 'R' TYPE, 
    O.ROUTCARR ROUTCARR, O.ROUTSEQ ROUTSEQ, O.ROUTCITY ROUTCITY, O.INTMOSVR INTMOSVR, 
    O.TRANSTP TRANSTP, O.TO_YARD_CD TO_YARD_CD, UPPER(O.AGMT_REF_NO) CONTRACT, O.ROUTCARR2 ROUTCARR2, O.ROUTSEQ2 ROUTSEQ2, O.ROUTCITY2 ROUTCITY2, 
    O.INTMOSVR2 INTMOSVR2, O.TRANSTP2 TRANSTP2, O.TO_YARD_CD2 TO_YARD_CD2, UPPER(O.AGMT_REF_NO2) CONTRACT2, O.ROUTCARR3 ROUTCARR3, O.ROUTSEQ3 ROUTSEQ3, 
    O.ROUTCITY3 ROUTCITY3, O.INTMOSVR3 INTMOSVR3, O.TRANSTP3 TRANSTP3, O.TO_YARD_CD3 TO_YARD_CD3, UPPER(O.AGMT_REF_NO3) CONTRACT3, '' INBOND, 
    SP.LADELINE1, SP.LADELINE2, SP.LADELINE3, SP.LADELINE4, SP.LADELINE5, 
    SP.LADEDESC1, SP.LADEDESC2, SP.LADEDESC3, SP.LADEDESC4, SP.LADEDESC5, 
    SP.COMMCODE1, SP.COMMCODE2, SP.COMMCODE3, SP.COMMCODE4, SP.COMMCODE5, 
    SP.NISCOMM1, SP.NISCOMM2, SP.NISCOMM3, SP.NISCOMM4, SP.NISCOMM5, 
    SP.NISRETP1, SP.NISRETP2, SP.NISRETP3, SP.NISRETP4, SP.NISRETP5, 
    SP.BL_NO1, 
    DECODE(A.TRSP_BND_CD, 'O', NVL(A.PCK_QTY, 1), 'I', NVL(D.PCK_QTY, 1), '1') LADEQTY, 
    DECODE(A.TRSP_BND_CD, 'O', 'PCS', DECODE(D.PCK_QTY, NULL, 'TLD', 'PCS')) PACKFORM, 
    R.STCC_CD DG_STCC, P.IMDG_UN_NO DG_UN, P.PRP_SHP_NM DG_NAME, P.HZD_DESC DG_CONTENTS, P.IMDG_CLSS_CD DG_CLASS, 
    DECODE(P.IMDG_PCK_GRP_CD, '1', 'I', '2', 'II', '3', 'III') DG_PGRP, P.PSA_NO DG_PSAGRP, P.MRN_POLUT_FLG DG_MP, P.FLSH_PNT_CDO_TEMP DG_FLSHTEMP, 'C' DG_FLSHUNIT, NVL(P.OUT_IMDG_PCK_QTY1,0) DG_QTY, P.OUT_IMDG_PCK_CD1 DG_QUNIT, NVL(P.GRS_WGT,0) DG_WEIGHT, 
    P.WGT_UT_CD DG_WUNIT,
    P.FLSH_PNT_CDO_TEMP DG_FLASHTEMP,
    CASE WHEN SUBSTR(P.IMDG_CLSS_CD,1,1)='1' AND NVL(P.SPCL_CGO_APRO_CD,'N')='Y' AND NVL(P.NET_EXPLO_WGT,0)<> 0 THEN TO_CHAR(P.NET_EXPLO_WGT)
         ELSE ''
     END AS DG_CLASS1NEW,
    CASE WHEN SUBSTR(P.IMDG_CLSS_CD,1,1)='1' AND NVL(P.SPCL_CGO_APRO_CD,'N')='Y'  AND NVL(P.NET_EXPLO_WGT,0)<> 0 THEN 'KGS' 
         ELSE '' 
     END AS DG_CLASS1NEWUNIT,
    P.EMER_CNTC_PHN_NO_CTNT DG_TEL,
    P.EMER_CNTC_PSON_NM DG_CONTACT,
    A.CRE_OFC_CD, 
    DGP.DCGO_SEQ DG_MAX_SEQ,
    O.BKG_NO DG_BKG_NO,
    A.EQ_NO DG_EQ_NO 
FROM TRS_TRSP_RAIL_BIL_ORD A, 
     MDM_VENDOR C, BKG_CONTAINER D, 
     MDM_YARD I, 
     BKG_CUSTOMER J, 
     MDM_YARD K, 
     BKG_CUSTOMER L, 
     BKG_CUSTOMER N, 
     BKG_RF_CGO M, 
     BKG_DG_CGO P, 
     BKG_DG_CGO DGP, 
     MDM_VSL_CNTR Q,
     TRS_STCC R, 
     TRS_TRSP_RAIL_EDI_NOD S, 
     TRS_TRSP_RAIL_EDI_NOD T, 
     BKG_BOOKING BK,  
     BKG_CSTMS_ADV_BL CND, 
     MDM_ORGANIZATION OFC,
     BKG_CSTMS_CND_VSL CV, 
     BKG_CUSTOMER BF, 
     BKG_CUSTOMER BE, 
     MDM_CUST_ADDR SCST,
     MDM_CUST_ADDR CCST,
     MDM_CUST_ADDR NCST, 
     BKG_CSTMS_ADV_IBD AI,
     MDM_LOCATION LOC1,
     MDM_LOCATION LOC2,
   (SELECT A.TRSP_SO_OFC_CTY_CD, A.TRSP_SO_SEQ, 
        MIN(DECODE(A.SUB_RAIL_SEQ, 1, A.VNDR_SEQ)) VNDR_SEQ, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 1, B.USA_EDI_CD, '')) ROUTCARR, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 1, DECODE(SUBSTR(C.RAIL_CMB_THRU_TP_CD, 3), 'T', 'S', 'C', 'S', 'R'), '')) ROUTSEQ, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 1, PRD.INLND_ROUT_JUNC_NM, '')) ROUTCITY, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 1, MST.ROUT_PLN_CD, '')) INTMOSVR, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 1, DECODE(SUBSTR(A.RAIL_CRR_TP_CD, 1, 1), 'C', 'X'), '')) TRANSTP, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 1, A.TO_NOD_CD, '')) TO_YARD_CD, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 1, AGMT.AGMT_REF_NO)) AGMT_REF_NO, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 2, B.USA_EDI_CD, '')) ROUTCARR2, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 2, '1', '')) ROUTSEQ2, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 2, PRD.INLND_ROUT_JUNC_NM, '')) ROUTCITY2, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 2, MST.ROUT_PLN_CD, '')) INTMOSVR2, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 2, DECODE(SUBSTR(A.RAIL_CRR_TP_CD, 1, 1), 'C', 'X'), '')) TRANSTP2, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 2, A.TO_NOD_CD, '')) TO_YARD_CD2, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 2, AGMT.AGMT_REF_NO)) AGMT_REF_NO2, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 3, B.USA_EDI_CD, '')) ROUTCARR3, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 3, '2', '')) ROUTSEQ3, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 3, PRD.INLND_ROUT_JUNC_NM, '')) ROUTCITY3, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 3, MST.ROUT_PLN_CD, '')) INTMOSVR3, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 3, DECODE(SUBSTR(A.RAIL_CRR_TP_CD, 1, 1), 'C', 'X'), '')) TRANSTP3, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 3, A.TO_NOD_CD, '')) TO_YARD_CD3, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 3, AGMT.AGMT_REF_NO)) AGMT_REF_NO3, 
        MAX(EDI.BIL_EDI_CTRL_SEQ) BIL_EDI_CTRL_SEQ, MAX(EDI.BKG_NO) BKG_NO, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 1, DECODE(SUBSTR(A.RAIL_CRR_TP_CD, 1, 1), 'C' , 'CN', 'T' ,'CC'))) EQDESC_C, 
        MAX(C.FM_NOD_CD) FM_NOD_CD,      MAX(C.TO_NOD_CD) TO_NOD_CD 
    FROM TRS_TRSP_RAIL_BIL_VNDR_SET A, MDM_VENDOR B, TRS_TRSP_RAIL_BIL_ORD C, TRS_TRSP_EDI_TMP TMP, TRS_TRSP_EDI_RAIL_ORD EDI, 
    TRS_AGMT_HDR AGMT, PRD_INLND_ROUT_DTL PRD , PRD_INLND_ROUT_MST MST 
    WHERE TMP.TRSP_EDI_SND_NO = @[strsp_edi_snd_no]
    AND A.TRSP_SO_OFC_CTY_CD = TMP.TRSP_SO_OFC_CTY_CD 
    AND A.TRSP_SO_SEQ = TMP.TRSP_SO_SEQ 
    AND A.VNDR_SEQ=B.VNDR_SEQ(+) 
    AND A.TRSP_SO_OFC_CTY_CD=C.TRSP_SO_OFC_CTY_CD 
    AND A.TRSP_SO_SEQ=C.TRSP_SO_SEQ 
    AND C.ROUT_ORG_NOD_CD = PRD.ROUT_ORG_NOD_CD 
    AND C.ROUT_DEST_NOD_CD = PRD.ROUT_DEST_NOD_CD 
    AND C.ROUT_SEQ = PRD.ROUT_SEQ 
    AND A.ROUT_DTL_SEQ = PRD.ROUT_DTL_SEQ 
    AND MST.ROUT_ORG_NOD_CD = PRD.ROUT_ORG_NOD_CD 
    AND MST.ROUT_DEST_NOD_CD = PRD.ROUT_DEST_NOD_CD 
    AND MST.ROUT_SEQ = PRD.ROUT_SEQ 
    AND A.TRSP_SO_OFC_CTY_CD=EDI.TRSP_SO_OFC_CTY_CD 
    AND A.TRSP_SO_SEQ=EDI.TRSP_SO_SEQ 
    AND A.TRSP_AGMT_OFC_CTY_CD = AGMT.TRSP_AGMT_OFC_CTY_CD(+) 
    AND A.TRSP_AGMT_SEQ = AGMT.TRSP_AGMT_SEQ(+) 
    AND C.RAIL_CMB_THRU_TP_CD IN ('C1T', 'C2T', 'C3T', 'C2R', 'C3R', 'C2C', 'C3S') 
    GROUP BY A.TRSP_SO_OFC_CTY_CD, A.TRSP_SO_SEQ 
    UNION 
    SELECT 
        A.TRSP_SO_OFC_CTY_CD, A.TRSP_SO_SEQ, A.VNDR_SEQ, 
        B.USA_EDI_CD ROUTCARR, MAX(DECODE(A.SUB_RAIL_SEQ, 1, DECODE(SUBSTR(C.RAIL_CMB_THRU_TP_CD, 3), 'T', 'S', 'C', 'S', 'R'), 2,1,3,2)) ROUTSEQ,  
        PRD.INLND_ROUT_JUNC_NM ROUTCITY, MST.ROUT_PLN_CD INTMOSVR, DECODE(SUBSTR(A.RAIL_CRR_TP_CD, 1, 1), 'C', 'X') TRANSTP, 
        MAX(DECODE(A.SUB_RAIL_SEQ, 1, A.TO_NOD_CD, '')) TO_YARD_CD, MAX(AGMT.AGMT_REF_NO) AGMT_REF_NO, 
        '' ROUTCARR2, '' ROUTSEQ2, '' ROUTCITY2, '' INTMOSVR2, '' TRANSTP2, '' TO_YARD_CD2, '' AGMT_REF_NO2, 
        '' ROUTCARR3, '' ROUTSEQ3, '' ROUTCITY3,'' INTMOSVR3, '' TRANSTP3, '' TO_YARD_CD3, '' AGMT_REF_NO3, 
        MAX(EDI.BIL_EDI_CTRL_SEQ) BIL_EDI_CTRL_SEQ, MAX(EDI.BKG_NO) BKG_NO,  
        MAX(DECODE(A.SUB_RAIL_SEQ, 1, DECODE(SUBSTR(A.RAIL_CRR_TP_CD, 1, 1), 'C' , 'CN', 'T' ,'CC'))) EQDESC_C, 
        MAX(A.FM_NOD_CD) FM_NOD_CD, MAX(A.TO_NOD_CD) TO_NOD_CD  
    FROM TRS_TRSP_RAIL_BIL_VNDR_SET A, MDM_VENDOR B, TRS_TRSP_RAIL_BIL_ORD C, TRS_TRSP_EDI_TMP TMP, TRS_TRSP_EDI_RAIL_ORD EDI, 
    TRS_AGMT_HDR AGMT, PRD_INLND_ROUT_DTL PRD , PRD_INLND_ROUT_MST MST   
    WHERE TMP.TRSP_EDI_SND_NO = @[strsp_edi_snd_no]
    AND A.TRSP_SO_OFC_CTY_CD = TMP.TRSP_SO_OFC_CTY_CD 
    AND A.TRSP_SO_SEQ = TMP.TRSP_SO_SEQ 
    AND A.VNDR_SEQ=B.VNDR_SEQ(+) 
    AND A.TRSP_SO_OFC_CTY_CD=C.TRSP_SO_OFC_CTY_CD 
    AND A.TRSP_SO_SEQ=C.TRSP_SO_SEQ 
    AND C.ROUT_ORG_NOD_CD = PRD.ROUT_ORG_NOD_CD 
    AND C.ROUT_DEST_NOD_CD = PRD.ROUT_DEST_NOD_CD 
    AND C.ROUT_SEQ = PRD.ROUT_SEQ 
    AND A.ROUT_DTL_SEQ = PRD.ROUT_DTL_SEQ 
    AND MST.ROUT_ORG_NOD_CD = PRD.ROUT_ORG_NOD_CD 
    AND MST.ROUT_DEST_NOD_CD = PRD.ROUT_DEST_NOD_CD 
    AND MST.ROUT_SEQ = PRD.ROUT_SEQ 
    AND A.TRSP_SO_OFC_CTY_CD=EDI.TRSP_SO_OFC_CTY_CD 
    AND A.TRSP_SO_SEQ=EDI.TRSP_SO_SEQ 
    AND A.TRSP_AGMT_OFC_CTY_CD = AGMT.TRSP_AGMT_OFC_CTY_CD(+) 
    AND A.TRSP_AGMT_SEQ = AGMT.TRSP_AGMT_SEQ(+) 
    AND B.VNDR_SEQ = EDI.VNDR_SEQ 
    AND C.RAIL_CMB_THRU_TP_CD IN ('S2R', 'S3R') 
    GROUP BY A.TRSP_SO_OFC_CTY_CD, A.TRSP_SO_SEQ, A.VNDR_SEQ, B.USA_EDI_CD, A.TO_NOD_CD, PRD.INLND_ROUT_JUNC_NM, MST.ROUT_PLN_CD, A.RAIL_CRR_TP_CD 
    ORDER BY TRSP_SO_SEQ 
) O, 
( 
        SELECT 
            A.TRSP_SO_OFC_CTY_CD, A.TRSP_SO_SEQ, MAX(FDA_DECL_FLG) FDA,
            MAX(DECODE(LADELINE, 1, LADELINE, '')) LADELINE1, MAX(DECODE(LADELINE, 2, LADELINE, '')) LADELINE2, 
            MAX(DECODE(LADELINE, 3, LADELINE, '')) LADELINE3, MAX(DECODE(LADELINE, 4, LADELINE, '')) LADELINE4, 
            MAX(DECODE(LADELINE, 5, LADELINE, '')) LADELINE5, 
            MAX(DECODE(LADELINE, 1, LADEDESC, '')) LADEDESC1, MAX(DECODE(LADELINE, 2, LADEDESC, '')) LADEDESC2, 
            MAX(DECODE(LADELINE, 3, LADEDESC, '')) LADEDESC3, MAX(DECODE(LADELINE, 4, LADEDESC, '')) LADEDESC4, 
            MAX(DECODE(LADELINE, 5, LADEDESC, '')) LADEDESC5, 
            MAX(DECODE(LADELINE, 1, COMMCODE, '')) COMMCODE1, MAX(DECODE(LADELINE, 2, COMMCODE, '')) COMMCODE2, 
            MAX(DECODE(LADELINE, 3, COMMCODE, '')) COMMCODE3, MAX(DECODE(LADELINE, 4, COMMCODE, '')) COMMCODE4, 
            MAX(DECODE(LADELINE, 5, COMMCODE, '')) COMMCODE5, 
            MAX(DECODE(LADELINE, 1, NISCOMM, '')) NISCOMM1, MAX(DECODE(LADELINE, 2, NISCOMM, '')) NISCOMM2, 
            MAX(DECODE(LADELINE, 3, NISCOMM, '')) NISCOMM3, MAX(DECODE(LADELINE, 4, NISCOMM, '')) NISCOMM4, 
            MAX(DECODE(LADELINE, 5, NISCOMM, '')) NISCOMM5, 
            MAX(DECODE(LADELINE, 1, NISRETP, '')) NISRETP1, MAX(DECODE(LADELINE, 2, NISRETP, '')) NISRETP2, 
            MAX(DECODE(LADELINE, 3, NISRETP, '')) NISRETP3, MAX(DECODE(LADELINE, 4, NISRETP, '')) NISRETP4, 
            MAX(DECODE(LADELINE, 5, NISRETP, '')) NISRETP5, 
            (
                MAX( DECODE( B.SEQ ,  1, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ ,  2, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ ,  3, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ ,  4, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ ,  5, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ ,  6, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ ,  7, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ ,  8, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ ,  9, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 10, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 11, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 12, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 13, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 14, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 15, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 16, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 17, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 18, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 19, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 20, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 21, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 22, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 23, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 24, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 25, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 26, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 27, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 28, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 29, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 30, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 31, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 32, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 33, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 34, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 35, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 36, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 37, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 38, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 39, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 40, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 41, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 42, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 43, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 44, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 45, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 46, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 47, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 48, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 49, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 50, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 51, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 52, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 53, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 54, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 55, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 56, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 57, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 58, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 59, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 60, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 61, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 62, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 63, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 64, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 65, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 66, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 67, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 68, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 69, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 70, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 71, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 72, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 73, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 74, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 75, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 76, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 77, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 78, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 79, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 80, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 81, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 82, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 83, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 84, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 85, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 86, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 87, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 88, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 89, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 90, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 91, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 92, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 93, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 94, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 95, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 96, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 97, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 98, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 99, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))||
                MAX( DECODE( B.SEQ , 100, '{BL'||CHR(10)||'BL_BLNO:'||B.BL_NO||CHR(10)||'BL_LADEQTY:'||B.PCK_QTY||CHR(10)||'BL_WEIGHT:'||B.CNTR_WGT||CHR(10)||'}BL'||CHR(10)))
            ) AS BL_NO1
        FROM (
            SELECT A.TRSP_SO_OFC_CTY_CD, A.TRSP_SO_SEQ,
            DECODE(A.TRSP_BND_CD, 'O', 1, RANK() OVER (PARTITION BY D.BKG_NO, D.CNTR_NO ORDER BY D.BKG_NO, D.CNTR_NO, D.CNTR_MF_SEQ)) AS LADELINE,
            DECODE( 
                A.CGO_TP_CD, 'F', DECODE(A.TRSP_BND_CD, 'O', NVL(F.CMDT_NM, E.REP_CMDT_NM), 
                DECODE(D.CNTR_MF_SEQ, '01', NVL(REPLACE(REPLACE(REPLACE(D.CNTR_MF_GDS_DESC, CHR(13), ' '), CHR(10), ' '), CHR(43), ''), 
                E.REP_CMDT_NM), REPLACE(REPLACE(D.CNTR_MF_GDS_DESC, CHR(13), ' '), CHR(10), ' '))), 'F.A.K' 
            ) LADEDESC, 
            DECODE( 
                A.CGO_TP_CD, 'F', DECODE(A.TRSP_BND_CD, 'I', DECODE(VD.USA_EDI_CD||B.SC_NO||B.REP_CMDT_CD, 
                'UPAEF2288867', '2541189', 'UPAEF2288862', '2541164',  
                'UPAEF2127162', '2541164', 'UPAEF2127167', '2541189', 'UPAEF2127169', '2541164', 'UPAEF2127161', '2541192', 'UPAEF2127168', '2541164', 
                'UPGLO9100167', '2541189', 'UPGLO9100169', '2541164', 'UPGLO9100162', '2541164', 'UPGLO9100173', '2541192', 'UPGLO9100126', '2541192', 'UPGLO9100170', '2541164',  
                'UPAEF2164186', '2541192', 'UPAEF2164126', '2541192',  
                'UPAEF2070662', '2541164', 'UPAEF2070685', '2541164', 'UPAEF2070669', '2541164', 'UPAEF2070626', '2541192',  
                'UPAEF2070262', '2541164', 'UPAEF2070285', '2541164', 'UPAEF2070269', '2541164', 'UPAEF2070226', '2541192',  
                'UPAEF2138467', '2541189', 'UPAEF2138462', '2541164', 'UPAEF2138469', '2541164',  
                'UPAEF2131062', '2541164', 'UPGLO9080146', '2541164', '4611110'), DECODE(B.SPCL_HIDE_FLG, 'Y', '2014116', '4611110')), '4221130' 
            ) COMMCODE, 
            B.CMDT_CD NISCOMM, B.REP_CMDT_CD NISRETP, TF.FDA_DECL_FLG
        FROM TRS_TRSP_RAIL_BIL_ORD A, TRS_TRSP_RAIL_BIL_VNDR_SET AB, BKG_BOOKING B, BKG_CONTAINER C, BKG_CNTR_MF_DESC D, MDM_REP_CMDT E, 
        MDM_COMMODITY F, BKG_RATE BRH, MDM_VENDOR VD, TRS_TRSP_EDI_TMP STMP, BKG_HAMO_TRF TF
        WHERE A.BKG_NO = B.BKG_NO(+)
        AND A.BKG_NO = C.BKG_NO(+)
        AND A.EQ_NO = C.CNTR_NO(+) 
        AND A.BKG_NO = D.BKG_NO(+)
        AND A.EQ_NO= D.CNTR_NO(+) 
        AND B.REP_CMDT_CD = E.REP_CMDT_CD(+) 
        AND B.CMDT_CD = F.CMDT_CD(+) 
        AND A.BKG_NO = BRH.BKG_NO(+)
        AND A.TRSP_SO_OFC_CTY_CD = AB.TRSP_SO_OFC_CTY_CD 
        AND A.TRSP_SO_SEQ = AB.TRSP_SO_SEQ 
        AND AB.SUB_RAIL_SEQ = 1 
        AND AB.VNDR_SEQ = VD.VNDR_SEQ(+) 
        AND D.CMDT_HS_CD = TF.HAMO_TRF_CD(+)
        AND STMP.TRSP_EDI_SND_NO = @[strsp_edi_snd_no]
        AND A.TRSP_SO_OFC_CTY_CD = STMP.TRSP_SO_OFC_CTY_CD 
        AND A.TRSP_SO_SEQ = STMP.TRSP_SO_SEQ 
    ) A, 
    (    
    SELECT     
    A.TRSP_SO_OFC_CTY_CD, A.TRSP_SO_SEQ,     
    RANK() OVER (PARTITION BY A.TRSP_SO_OFC_CTY_CD, A.TRSP_SO_SEQ  
                 ORDER BY BK.BKG_NO) SEQ,    
    BK.BKG_NO,
    BC.CNTR_NO,    
    BK.VSL_CD,    
    BK.SKD_VOY_NO,    
    BK.SKD_DIR_CD,    
    BK.POL_CD,    
    BK.POD_CD,    
    BK.BL_NO BL_NO,    
    BC.PCK_QTY,    
    DECODE(BC.WGT_UT_CD, 'KGS', NVL(BC.CNTR_WGT, 0) * 2.2,  NVL(BC.CNTR_WGT, 0 ) ) CNTR_WGT    
     FROM  BKG_CONTAINER BC , BKG_BOOKING BK ,TRS_TRSP_RAIL_BIL_ORD A ,TRS_TRSP_EDI_TMP STMP    
    WHERE    
        STMP.TRSP_EDI_SND_NO = @[strsp_edi_snd_no]
    AND STMP.TRSP_SO_OFC_CTY_CD = A.TRSP_SO_OFC_CTY_CD     
    AND STMP.TRSP_SO_SEQ = A.TRSP_SO_SEQ     
    AND A.VSL_CD = BK.VSL_CD    
    AND A.SKD_VOY_NO = BK.SKD_VOY_NO    
    AND A.SKD_DIR_CD =BK.SKD_DIR_CD    
    AND A.POL_CD= BK.POL_CD    
    AND A.POD_CD= BK.POD_CD    
    AND BK.BKG_STS_CD <> 'X'    
    AND BK.BKG_NO = BC.BKG_NO
    AND A.EQ_NO = BC.CNTR_NO    
    ) B    
    WHERE    
    A.TRSP_SO_OFC_CTY_CD = B.TRSP_SO_OFC_CTY_CD (+)    
    AND A.TRSP_SO_SEQ = B.TRSP_SO_SEQ (+)        
    GROUP BY A.TRSP_SO_OFC_CTY_CD, A.TRSP_SO_SEQ
) SP 
WHERE A.TRSP_SO_OFC_CTY_CD = O.TRSP_SO_OFC_CTY_CD 
AND A.TRSP_SO_SEQ = O.TRSP_SO_SEQ 
AND A.TRSP_SO_OFC_CTY_CD = SP.TRSP_SO_OFC_CTY_CD  
AND A.TRSP_SO_SEQ = SP.TRSP_SO_SEQ  
AND O.VNDR_SEQ = C.VNDR_SEQ(+) 
AND A.BKG_NO = D.BKG_NO(+)
AND A.EQ_NO = D.CNTR_NO(+) 
AND A.BL_NO = AI.BL_NO(+)
AND 'US' = AI.CNT_CD(+)
AND O.FM_NOD_CD = I.YD_CD 
AND O.TO_NOD_CD = K.YD_CD
AND I.LOC_CD  = LOC1.LOC_CD(+)
AND K.LOC_CD = LOC2.LOC_CD(+)
AND A.BKG_NO = J.BKG_NO(+)
AND J.BKG_CUST_TP_CD(+) = 'S' 
AND A.BKG_NO = L.BKG_NO(+)
AND L.BKG_CUST_TP_CD(+) = 'C' 
AND A.BKG_NO = N.BKG_NO(+)
AND N.BKG_CUST_TP_CD(+) = 'N' 
AND A.BKG_NO = BF.BKG_NO(+)
AND BF.BKG_CUST_TP_CD(+) = 'F'  
AND A.BKG_NO = BE.BKG_NO(+)
AND BE.BKG_CUST_TP_CD(+) = 'E'  
AND A.BKG_NO = M.BKG_NO(+)
AND A.EQ_NO = M.CNTR_NO(+) 
AND A.BKG_NO = P.BKG_NO(+)
AND A.VSL_CD = Q.VSL_CD(+) 
AND P.DCGO_SEQ(+)    = 1 
AND P.IMDG_UN_NO      = R.UN_CMDT_CD(+) 
AND P.IMDG_CLSS_CD||P.IMDG_COMP_GRP_CD = R.HZD_MTRL_CLSS_CD(+) 
AND    NVL(R.STCC_CD, 'N/A') = NVL((
                                SELECT 
                                    MIN(TST.STCC_CD)
                                FROM
                                    TRS_STCC TST
                                WHERE    TST.UN_CMDT_CD = P.IMDG_UN_NO
                                   AND        TST.HZD_MTRL_CLSS_CD = P.IMDG_CLSS_CD||P.IMDG_COMP_GRP_CD
                            ), 'N/A')
AND NVL(A.POL_NOD_CD,  A.FM_NOD_CD) = S.EDI_RCV_NOD_CD(+)  
AND NVL(A.POD_NOD_CD,  A.TO_NOD_CD) = T.EDI_RCV_NOD_CD(+)  
AND A.BKG_NO = BK.BKG_NO(+)
AND A.DELT_FLG = 'N' 
AND A.BL_NO = CND.BL_NO(+)
AND DECODE( A.TRSP_BND_CD, 'I', DECODE(SUBSTR(A.TO_NOD_CD,1,2), 'US', 'US', 'CA', 'CA', ''),
            'O', DECODE(SUBSTR(A.FM_NOD_CD,1,2), 'US', 'US', 'CA', 'CA', ''), '') = CND.CNT_CD(+)
AND CND.vsl_cd    =    CV.vsl_cd(+) 
AND CND.skd_voy_no = CV.skd_voy_no(+) 
AND CND.skd_dir_cd = CV.skd_dir_cd(+) 
AND SCST.CUST_CNT_CD(+) = J.CUST_CNT_CD 
AND SCST.CUST_SEQ(+) = J.CUST_SEQ 
AND SCST.PRMRY_CHK_FLG(+) = 'Y' 
AND SCST.DELT_FLG(+) = 'N' 
AND CCST.CUST_CNT_CD(+) = L.CUST_CNT_CD 
AND CCST.CUST_SEQ(+) = L.CUST_SEQ 
AND CCST.PRMRY_CHK_FLG(+) = 'Y' 
AND CCST.DELT_FLG(+) = 'N' 
AND NCST.CUST_CNT_CD(+) = N.CUST_CNT_CD 
AND NCST.CUST_SEQ(+) = N.CUST_SEQ 
AND NCST.PRMRY_CHK_FLG(+) = 'Y' 
AND NCST.DELT_FLG(+) = 'N' 
AND A.BKG_NO = DGP.BKG_NO(+)
AND DGP.DCGO_SEQ(+) = 2
AND DECODE(K.OFC_CD, 'VANBB', 'SLCSC', 'SEASC', 'SLCSC', 'PDXBB', 'SLCSC', 'LGBSC', 'PHXSA', 'SFOBB', 'PHXSA', 'HOUSC', 'SAVBO', 'DALSO', 'SAVBO', K.OFC_CD) = OFC.OFC_CD(+) 
ORDER BY C.USA_EDI_CD, A.TRSP_SO_SEQ			]]></sql>
			<params>
				<param name="strsp_edi_snd_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
