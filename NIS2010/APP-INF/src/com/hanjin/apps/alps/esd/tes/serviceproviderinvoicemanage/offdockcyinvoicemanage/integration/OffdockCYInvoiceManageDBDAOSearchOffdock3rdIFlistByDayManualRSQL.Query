<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="OffdockCYInvoiceManageDBDAOSearchOffdock3rdIFlistByDayManualRSQL">
			<desc><![CDATA[SearchOffdock3rdIFlistByDayManual]]></desc>
			<sql><![CDATA[
SELECT 
    ROWNUM TMP_TPB_SEQ,
    @[calc_tp_cd] CALC_TP_CD,
    @[calc_cost_grp_cd] CALC_COST_GRP_CD, 
    P.CNTR_NO, 
    P.TML_SO_OFC_CTY_CD, 
    P.TML_SO_SEQ,
    P.TML_SO_CNTR_LIST_SEQ, 
    P.TML_SO_DTL_SEQ,
    P.LGS_COST_CD, 
    P.CNTR_TPSZ_CD, 
    P.IO_BND_CD,
    CASE
    WHEN T.TML_IF_OFC_CD IS NOT NULL AND T.TML_IF_SEQ IS NOT NULL THEN 1
    ELSE 0
    END CHK,
    T.TML_IF_OFC_CD, T.TML_IF_SEQ, T.TML_N3PTY_TP_CD, T.TML_N3PTY_IF_STS_CD,
    T.INV_NO, T.VNDR_SEQ, T.YD_CD, T.ACCT_CD, T.CSR_NO,
    T.N3PTY_BIL_TP_CD, T.BKG_NO,
    T.BL_NO,
    T.FINC_VSL_CD, T.FINC_SKD_VOY_NO, T.FINC_SKD_DIR_CD, 
    T.REF_VNDR_SEQ, T.TML_CRR_CD, 
    CASE
    WHEN T.VNDR_CUST_DIV_CD = 'C' THEN T.CUST_CNT_CD||T.CUST_SEQ
    WHEN T.VNDR_CUST_DIV_CD = 'S' THEN T.N3PTY_OFC_CD
    WHEN T.VNDR_CUST_DIV_CD = 'V' THEN T.VNDR_CNT_CD||T.N3PTY_VNDR_SEQ
    END TRD_PARTY_VAL,
    T.VNDR_CUST_DIV_CD,
    T.VNDR_CNT_CD, T.N3PTY_VNDR_SEQ, T.CUST_CNT_CD, T.CUST_SEQ, T.N3PTY_OFC_CD,
    NVL(T.CURR_CD,P.CURR_CD) CURR_CD, T.IF_AMT, T.IF_RMK, T.N3PTY_INV_DT, T.N3PTY_TERM_DT,
    T.N3PTY_CSR_CURR_CD, T.N3PTY_AMT, T.N3PTY_DESC, T.CXL_FLG
FROM ( 	SELECT  H.CURR_CD,
            H.INV_OFC_CD,
            L.TML_RVIS_IND_FLG,
            L.TML_SO_OFC_CTY_CD,
            L.TML_SO_SEQ,
            L.TML_SO_CNTR_LIST_SEQ,
            @[tml_so_dtl_seq] TML_SO_DTL_SEQ,
            L.CNTR_NO,
            L.CNTR_TPSZ_CD,
            L.IO_BND_CD,
            @[param_lgs_cost_cd] LGS_COST_CD,
            L.BKG_NO
        FROM TES_TML_SO_HDR H, TES_TML_SO_CNTR_LIST L
        WHERE 1=1
        AND H.TML_SO_OFC_CTY_CD = L.TML_SO_OFC_CTY_CD
        AND H.TML_SO_SEQ        = L.TML_SO_SEQ
        AND H.TML_SO_OFC_CTY_CD = @[tml_so_ofc_cty_cd]
        AND H.TML_SO_SEQ = @[tml_so_seq]
        AND L.VRFY_RSLT_IND_CD = 'CO'
    ) P, TES_N3RD_PTY_IF T
WHERE P.TML_SO_OFC_CTY_CD = T.TML_SO_OFC_CTY_CD(+)
AND P.TML_SO_SEQ        = T.TML_SO_SEQ(+)
AND P.TML_SO_DTL_SEQ 	= T.TML_SO_DTL_SEQ(+)
AND P.CNTR_NO      = T.CNTR_NO(+)			]]></sql>
			<params>
				<param name="calc_tp_cd" type="12" value="" out="N"/>
				<param name="calc_cost_grp_cd" type="12" value="" out="N"/>
				<param name="tml_so_dtl_seq" type="12" value="" out="N"/>
				<param name="param_lgs_cost_cd" type="12" value="" out="N"/>
				<param name="tml_so_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="tml_so_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
