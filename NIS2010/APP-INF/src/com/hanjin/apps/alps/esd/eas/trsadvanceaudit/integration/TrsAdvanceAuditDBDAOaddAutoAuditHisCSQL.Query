<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TrsAdvanceAuditDBDAOaddAutoAuditHisCSQL">
			<desc><![CDATA[Auto Audit History 저장]]></desc>
			<sql><![CDATA[
INSERT INTO EAS_TRSP_AUD_HIS (
  INV_NO
, INV_VNDR_SEQ
, TRSP_SO_TP_CD
, AUD_HIS_SEQ
, EXPN_AUD_STS_CD
, EXPN_AUD_RSLT_RMK
, EXPN_AUD_RSLT_USR_ID
, EXPN_AUD_RSLT_CD
, ATCH_FILE_LNK_ID
, RHQ_CD
, INV_OFC_CD
, INV_CFM_DT
, AUTO_EXPN_AUD_STS_CD
, CURR_CD
, WO_AMT
, INV_AMT
, CURR_CNG_FLG
, INV_DIFF_AMT
, INV_DIFF_RTO
, AGMT_APLY_FLG
, OPTM_ROUT_FLG
, AVG_OVR_DIFF_AMT
, CRE_OFC_CD
, LOCL_CRE_DT
, INV_ISS_DT
, INV_ISS_USR_ID
, GEN_PAY_TERM_CD
, PAY_DUE_DT
, PAY_DT
, HJL_INV_NO
, HJL_INV_VNDR_SEQ
, INV_DIFF_FLG
, AVG_OVR_DIFF_FLG
, AUTO_AUD_CFM_DT
, AUTO_AUD_CFM_USR_ID
, EAC_NO_CTNT
, CRE_USR_ID
, CRE_DT
, UPD_USR_ID
, UPD_DT
)
SELECT INV_NO
, INV_VNDR_SEQ
, TRSP_SO_TP_CD
, NVL((SELECT /*+ INDEX_DESC(X XPKEAS_TRSP_AUD_HIS) */
              AUD_HIS_SEQ
         FROM EAS_TRSP_AUD_HIS X
        WHERE X.INV_NO = A.INV_NO
          AND X.INV_VNDR_SEQ  = A.INV_VNDR_SEQ
          AND X.TRSP_SO_TP_CD = A.TRSP_SO_TP_CD
          AND ROWNUM = 1
  ),0) + 1 AUD_HIS_SEQ
, EXPN_AUD_STS_CD
, EXPN_AUD_RSLT_RMK
, EXPN_AUD_RSLT_USR_ID
, EXPN_AUD_RSLT_CD
, ATCH_FILE_LNK_ID
, RHQ_CD
, INV_OFC_CD
, INV_CFM_DT
, AUTO_EXPN_AUD_STS_CD
, CURR_CD
, WO_AMT
, INV_AMT
, CURR_CNG_FLG
, INV_DIFF_AMT
, INV_DIFF_RTO
, AGMT_APLY_FLG
, OPTM_ROUT_FLG
, AVG_OVR_DIFF_AMT
, CRE_OFC_CD
, LOCL_CRE_DT
, INV_ISS_DT
, INV_ISS_USR_ID
, GEN_PAY_TERM_CD
, PAY_DUE_DT
, PAY_DT
, HJL_INV_NO
, HJL_INV_VNDR_SEQ
, INV_DIFF_FLG
, AVG_OVR_DIFF_FLG
, AUTO_AUD_CFM_DT
, AUTO_AUD_CFM_USR_ID
, (SELECT WM_CONCAT(X.EAC_NO)
     FROM EAS_TRSP_AUD_CHK X
    WHERE X.INV_NO = A.INV_NO
      AND X.INV_VNDR_SEQ  = A.INV_VNDR_SEQ
      AND X.TRSP_SO_TP_CD = A.TRSP_SO_TP_CD
  )
, CRE_USR_ID
, CRE_DT
, UPD_USR_ID
, UPD_DT
FROM EAS_TRSP_AUD A
WHERE INV_NO = @[inv_no]
  AND INV_VNDR_SEQ  = @[inv_vndr_seq]
  AND TRSP_SO_TP_CD = @[trsp_so_tp_cd]			]]></sql>
			<params>
				<param name="inv_no" type="12" value="" out="N"/>
				<param name="inv_vndr_seq" type="12" value="" out="N"/>
				<param name="trsp_so_tp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
