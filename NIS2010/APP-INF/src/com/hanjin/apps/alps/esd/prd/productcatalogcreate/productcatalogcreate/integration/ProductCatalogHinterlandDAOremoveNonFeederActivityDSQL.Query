<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ProductCatalogHinterlandDAOremoveNonFeederActivityDSQL">
			<desc><![CDATA[Feeder의 경우 Feeder의 앞 뒤 Node 와 Feeder만 제외하고는 모두 삭제
2012.07.18 정선용 [CHM-201217633] 구주 Hinterland, RF 추가,990번 act grp 살림]]></desc>
			<sql><![CDATA[
DELETE PRD_PROD_CTL_ACT_GRP_DTL
WHERE (PCTL_NO, COST_ACT_GRP_SEQ)
IN (
    SELECT PCTL_NO, COST_ACT_GRP_SEQ
      FROM (
            SELECT DECODE(VSL_SLAN_CD, 'FDR', 'Y', 'CAX', 'Y' --   NTST 앞, 뒤에 VESSEL A/G을 추가하여 before , after trans mode를 VD로 할 수 있도록 수정 20121204 전윤주씨 요청
                    ,NVL(DECODE(LEAD(VSL_SLAN_CD) OVER (PARTITION BY PCTL_NO ORDER BY COST_ACT_GRP_SEQ), 'FDR', 'Y')
                      , DECODE(LAG(VSL_SLAN_CD) OVER (PARTITION BY PCTL_NO ORDER BY COST_ACT_GRP_SEQ), 'FDR', 'Y'))
                      ) AS AROUND_FDR
                 , A.PCTL_NO, COST_ACT_GRP_SEQ
            FROM PRD_PROD_CTL_ACT_GRP_DTL A
            WHERE PCTL_NO LIKE DECODE(@[hd_pctl_no], NULL, NULL, @[hd_pctl_no] || '%')
           )
      WHERE AROUND_FDR IS NULL 
        AND COST_ACT_GRP_SEQ <> 990
   )			]]></sql>
			<params>
				<param name="hd_pctl_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
