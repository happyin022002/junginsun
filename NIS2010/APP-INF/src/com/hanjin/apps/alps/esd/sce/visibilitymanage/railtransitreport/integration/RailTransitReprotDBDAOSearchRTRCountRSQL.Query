<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RailTransitReprotDBDAOSearchRTRCountRSQL">
			<desc><![CDATA[select single]]></desc>
			<sql><![CDATA[
select count(*) tot_cnt
from (
    SELECT  TRSP_SO_OFC_CTY_CD
     ,TRSP_SO_SEQ
     ,EQ_NO                                                                           
         FROM SCE_RAIL_TZ_RPT RPT, BKG_BOOKING BKG                                                                             
         WHERE RPT.BKG_NO = BKG.BKG_NO (+) 
         AND NVL(RPT.DELT_FLG, 'N') = 'N'
         
				#if(${date_kind} != '')
					#if(${date_kind} == 'S')
      			#if(${fm_dt} != '' && ${to_dt} != '')
        			AND RPT.SO_CRE_DT BETWEEN TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
        		#end	
      		#elseif(${date_kind} == 'A')
      			#if(${fm_dt} != '' && ${to_dt} != '')
						  AND RPT.DEST_AVAL_DT BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
        		#end
      		#elseif(${date_kind} == 'O')
        		#if(${fm_dt} != '' && ${to_dt} != '')
        			AND (CASE WHEN(SELECT MAX(CASE WHEN (T.TRSP_BND_CD = 'O' AND T.POR_CD = T.POL_CD) OR (T.TRSP_BND_CD = 'I' AND T.POD_CD = T.DEL_CD)
        																THEN 'ON' ELSE 'OFF' END) CHKDOCK
        								FROM TRS_TRSP_RAIL_BIL_ORD T
        								WHERE T.TRSP_SO_OFC_CTY_CD = RPT.TRSP_SO_OFC_CTY_CD
        								AND T.TRSP_SO_SEQ = RPT.TRSP_SO_SEQ) = 'ON' THEN RPT.DEST_AVAL_DT
        						ELSE RPT.DEST_GATE_OUT_DT
        			END) BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
        		#end
      		#elseif(${date_kind} == 'I')
      			#if(${fm_dt} != '' && ${to_dt} != '')
						  AND RPT.ORG_GATE_IN_DT BETWEEN  TO_DATE(@[fm_dt]||' 00:00:00', 'YYYY-MM-DD HH24:MI:SS') AND TO_DATE(@[to_dt]||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
        		#end
			#end
		 #end	

	/* BKG No && BKG No Split */
	#if(${r_bkg_no} != '' || (${searchtype} == 'multi' && ${r_bkg_no} != ''))
		AND ((RPT.BKG_NO) IN (
	   	#if(${searchtype} == 'multi')
	    	/* condition - r_bkg_no */
			#if (${r_bkg_no} != '') 
				#foreach($ele IN ${r_bkg_no})
					#if($velocityCount == 1 ) 
						'$ele'
					#else 
						,'$ele' 
					#end 
				#end
			#end
		#end
    	#if(${bkg_no} != '')
      		#if($r_bkg_no.size() > 0 && ${searchtype} == 'multi')
      			,
      		#end
      		@[bkg_no]
      	#end
		))
    #else
		#if(${bkg_no} != '')
    		AND RPT.BKG_NO = @[bkg_no]
		#end
	#end
    
    /* Container No */
    #if(${eq_no} != '' || (${searchtype} == 'multi' && ${r_cntr_no} != ''))
		AND RPT.EQ_NO IN (
		#if(${searchtype} == 'multi')
			#if(${r_cntr_no} != '')
    			
    			#foreach($ele IN ${r_cntr_no})
					#if($velocityCount == 1 ) 
						'$ele'
					#else 
						,'$ele' 
					#end 
      			#end
      		#end
    	#end
    	#if(${eq_no} != '')
    		#if($r_cntr_no.size() > 0 && ${searchtype} == 'multi')
      			,
      		#end
      		@[eq_no]
      	#end
    	)
    #end	
        
	/* B/L No */
	#if(${bl_no} != '' || (${searchtype} == 'multi' && ${r_bl_no} != ''))
    	AND ((MST_BL_NO) IN (
    	#if(${searchtype} == 'multi')
    		#if(${r_bl_no} != '')
    		    #foreach($ele IN ${r_bl_no})
					#if($velocityCount == 1 ) 
						'$ele'
					#else 
						,'$ele' 
					#end 
      			#end   	
	    	#end
	    #end	
    	#if(${bl_no} != '')
    		#if($r_bl_no.size() > 0 && ${searchtype} == 'multi')
    			,
    		#end
    	  	@[bl_no]
      	#end
    	))
	#end
        
	/* VVD */
    #if(${vvd} != '' || (${searchtype} == 'multi' && ${r_vvd} != ''))
    	AND ( RPT.VVD_CD IN ( 
    	#if(${searchtype} == 'multi')
    		#if(${r_vvd} != '')
    			#foreach($ele IN ${r_vvd})
					#if($velocityCount == 1 ) 
						'$ele'
					#else 
						,'$ele' 
					#end 
      			#end
      		#end
      	#end
    	#if(${vvd} != '')
    		#if($r_vvd.size() > 0 && ${searchtype} == 'multi')
    			,
    		#end
      		@[vvd]
      	#end
    	) )
	#end
        
	/* POL , POD (MULTI) */
    #if(${searchtype} == 'multi' && ${r_polpod} != '')
    	AND ( RPT.NOD_CD IN (
    	#if(${searchtype} == 'multi')
    		#if(${r_polpod} != '')
    			#foreach($ele IN ${r_polpod})
					#if($velocityCount == 1 ) 
						'$ele'
					#else 
						,'$ele' 
					#end 
      			#end
    		#end
      	#end
    	) )
    #end
        
	/* ORIGIN (MULTI) */
    #if(${searchtype} == 'multi' && ${r_origin} != '')
    	AND 
    	#if(${r_origin} != '')
	    	( RPT.FM_NOD_CD IN (
	    	#foreach($ele IN ${r_origin})
				#if($velocityCount == 1 ) 
					'$ele'
				#else 
					,'$ele' 
				#end 
      		#end
      	#end
      	) )
    #end        
        
	/* DEST (MULTI) */
    #if(${searchtype} == 'multi' && ${r_dest} != '')
    	AND 
    	#if(${r_dest} != '')
    		( RPT.TO_NOD_CD IN (
    		#foreach($ele IN ${r_dest})
				#if($velocityCount == 1 ) 
					'$ele'
				#else 
					,'$ele' 
				#end 
    	  	#end
		#end
    	) )
    #end    
        
	/* SC NO (MULTI) */
    #if(${searchtype} == 'multi' && ${r_scno} != '')
    	AND 
    	#if(${r_scno} != '')
    		( RPT.SC_NO IN (
    		#foreach($ele IN ${r_scno})
				#if($velocityCount == 1 ) 
					'$ele'
				#else 
					,'$ele' 
				#end 
    	  	#end
      	#end
    	) )
    #end
       
	/* CUST_CNT_CD, CUST_SEQ (CUSTOMER CODE : MULTI) */
    #if(${searchtype} == 'multi' && ${r_cust_cnt_cd} != '')
      	AND 
      	#if(${searchtype} == 'multi')
      		#if(${r_cust_cnt_cd} != '')
      			( EXISTS (SELECT '1' FROM BKG_CUSTOMER WHERE BKG_NO = BKG.BKG_NO AND (CUST_CNT_CD, CUST_SEQ) IN (
						#foreach($ele IN ${r_cust_cnt_cd})
							#if($velocityCount == 1 ) 
								'$ele'
							#else 
								,'$ele' 
							#end 
				        #end
       		#end
   			)
   		#end 
   		) )
	#elseif(${cust_cnt_seq} != '')
		AND ( EXISTS (SELECT '1' FROM BKG_CUSTOMER WHERE BKG_NO = BKG.BKG_NO AND (CUST_CNT_CD, CUST_SEQ) IN ( (
    		@[cust_cnt_seq], @[cust_cnt_seq])) ) )
    #end

	#if(${fm_nod_cd} != '')
	   	AND  RPT.fm_nod_cd LIKE @[fm_nod_cd]||'%'
    #end
      
    #if(${to_nod_cd} != '')
    	AND  RPT.to_nod_cd LIKE @[to_nod_cd]||'%'
    #end

    /* BKG_OFC_CD */
    #if(${bkg_ofc_cd} != '')
      	AND BKG.BKG_OFC_CD IN (
			#foreach($ele IN ${bkg_ofc_cd})
				#if($velocityCount == 1 ) 
					'$ele'
				#else 
					,'$ele' 
				#end 
        	#end
		  	)
	#end
			
			
 	/* setConditionQuery(queryStr, dataSet, "cgo_tp_cd", "RPT", "AND") */
 		#if(${cgo_tp_cd} != '')
    		AND RPT.cgo_tp_cd = @[cgo_tp_cd]
	    #end
	    
	/* setConditionQuery(queryStr, dataSet, "trsp_bnd_cd", "RPT", "AND") */
	    #if(${trsp_bnd_cd} != '')
  			AND RPT.trsp_bnd_cd = @[trsp_bnd_cd]
	    #end
	    
	/* setConditionQuery(queryStr, dataSet, "sc_no", "RPT", "AND") */
 		#if(${sc_no} != '')
  			AND RPT.sc_no = @[sc_no]
	    #end
 			
 	/* setConditionQuery(queryStr, dataSet, "cstms_acpt_flg", "RPT", "AND") */
 		#if(${cstms_acpt_flg} != '')
  			AND RPT.cstms_acpt_flg = @[cstms_acpt_flg]
	    #end
	    
	/* C/Loc */
 		#if(${customer_loc} != '')
    	  	AND  RPT.IB_IPI_LOCL_IND_CD = @[customer_loc]
    	#end
      
    /* POD/POL */
      	#if(${pod_pol} != '')
      		AND  RPT.NOD_CD LIKE @[pod_pol]||'%'
      	#end
      
      	#if(${dwell_kind} != '' && ${dwell_time} != '')
      	#if(${dwell_kind} == 'T')
      		#if(${t_dep} != '')
        		#if(${t_dep} == 'Y')
        			AND RPT.TML_DEP_FLG = 'Y'
        		#elseif(${t_dep} == 'N')
        			AND RPT.TML_DEP_FLG = 'N'
        		#end
        	#end
      	#elseif(${dwell_kind} == 'O')
      		#if(${t_dep} != '')
        		#if(${t_dep} == 'Y')
        			AND RPT.ORG_DEP_FLG = 'Y'
        		#elseif(${t_dep} == 'N')
        			AND RPT.ORG_DEP_FLG = 'N'
        		#end
        	#end
      	#elseif(${dwell_kind} == 'I1')
      		#if(${t_dep} != '')
        		#if(${t_dep} == 'Y')
        			AND RPT.ITCHG_N1ST_DEP_FLG = 'Y'
        		#elseif(${t_dep} == 'N')
        			AND RPT.ITCHG_N1ST_DEP_FLG = 'N'
        		#end
        	#end
      	#elseif(${dwell_kind} == 'I2')
      		#if(${t_dep} != '')
        		#if(${t_dep} == 'Y')
        			AND RPT.ITCHG_N2ND_DEP_FLG = 'Y'
        		#elseif(${t_dep} == 'N')
        			AND RPT.ITCHG_N2ND_DEP_FLG = 'N'
        		#end
        	#end
      	#elseif(${dwell_kind} == 'D1')
      		#if(${t_dep} != '')
        		#if(${t_dep} == 'Y')
        			AND RPT.DEST_N1ST_DEP_FLG = 'Y'
        		#elseif(${t_dep} == 'N')
        			AND RPT.DEST_N1ST_DEP_FLG = 'N'
        		#end
        	#end
      	#elseif(${dwell_kind} == 'D2')
      		#if(${t_dep} != '')
        		#if(${t_dep} == 'Y')
        			AND RPT.DEST_N2ND_DEP_FLG = 'Y'
        		#elseif(${t_dep} == 'N')
        			AND RPT.DEST_N2ND_DEP_FLG = 'N'
        		#end
        	#end
      	#end
    #end  	
 				
 		AND RPT.RPT_UPD_STS_CD = 'N'
    	
    	/* RailCompany */
    	#if(${railcomp} != '')
    		AND (RPT.TRSP_SO_OFC_CTY_CD, RPT.TRSP_SO_SEQ) IN ( 
    			select VND.TRSP_SO_OFC_CTY_CD, VND.TRSP_SO_SEQ
    			from  TRS_TRSP_RAIL_BIL_VNDR_SET VND
				where VND.VNDR_SEQ = @[railcomp]
    			AND   VND.SUB_RAIL_SEQ = '1'
    			GROUP BY VND.TRSP_SO_OFC_CTY_CD, VND.TRSP_SO_SEQ )
    	#end
 
 		 
      		
    ) t1
                                                             
    #if(${dwell_kind} != '' && ${dwell_time} != '')
    	#if(${dwell_kind} == 'T')
    		#if(${dwell_time} == '1')
		  		where t1.TML_DWLL_TM_HRS between 0 and 24
		  	#elseif(${dwell_time} == '2')
		  		where t1.TML_DWLL_TM_HRS between 25 and 48
		  	#elseif(${dwell_time} == '3')
		  		where t1.TML_DWLL_TM_HRS between 49 and 72
		  	#elseif(${dwell_time} == '4')
		  		where t1.TML_DWLL_TM_HRS between 73 and 96
		  	#elseif(${dwell_time} == '5')
		  		where t1.TML_DWLL_TM_HRS > 24
		  	#elseif(${dwell_time} == '6')
		  		where t1.TML_DWLL_TM_HRS > 48
		  	#elseif(${dwell_time} == '7')
		  		where t1.TML_DWLL_TM_HRS > 72
		  	#elseif(${dwell_time} == '8')
		  		where t1.TML_DWLL_TM_HRS > 96
		  	#end    		                          
    	#elseif(${dwell_kind} == 'O')
    		#if(${dwell_time} == '1')
		  		where t1.ORG_DWLL_TM_HRS between 0 and 24
		  	#elseif(${dwell_time} == '2')
		  		where t1.ORG_DWLL_TM_HRS between 25 and 48
		  	#elseif(${dwell_time} == '3')
		  		where t1.ORG_DWLL_TM_HRS between 49 and 72
		  	#elseif(${dwell_time} == '4')
		  		where t1.ORG_DWLL_TM_HRS between 73 and 96
		  	#elseif(${dwell_time} == '5')
		  		where t1.ORG_DWLL_TM_HRS > 24
		  	#elseif(${dwell_time} == '6')
		  		where t1.ORG_DWLL_TM_HRS > 48
		  	#elseif(${dwell_time} == '7')
		  		where t1.ORG_DWLL_TM_HRS > 72
		  	#elseif(${dwell_time} == '8')
		  		where t1.ORG_DWLL_TM_HRS > 96
		  	#end 
    	#elseif(${dwell_kind} == 'I1')         
    		#if(${dwell_time} == '1')
		  		where t1.ITCHG_N1ST_DWLL_TM_HRS between 0 and 24
		  	#elseif(${dwell_time} == '2')
		  		where t1.ITCHG_N1ST_DWLL_TM_HRS between 25 and 48
		  	#elseif(${dwell_time} == '3')
		  		where t1.ITCHG_N1ST_DWLL_TM_HRS between 49 and 72
		  	#elseif(${dwell_time} == '4')
		  		where t1.ITCHG_N1ST_DWLL_TM_HRS between 73 and 96
		  	#elseif(${dwell_time} == '5')
		  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 24
		  	#elseif(${dwell_time} == '6')
		  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 48
		  	#elseif(${dwell_time} == '7')
		  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 72
		  	#elseif(${dwell_time} == '8')
		  		where t1.ITCHG_N1ST_DWLL_TM_HRS > 96
		  	#end                   
    	#elseif(${dwell_kind} == 'I2')          
    		#if(${dwell_time} == '1')
		  		where t1.ITCHG_N2ND_DWLL_TM_HRS between 0 and 24
		  	#elseif(${dwell_time} == '2')
		  		where t1.ITCHG_N2ND_DWLL_TM_HRS between 25 and 48
		  	#elseif(${dwell_time} == '3')
		  		where t1.ITCHG_N2ND_DWLL_TM_HRS between 49 and 72
		  	#elseif(${dwell_time} == '4')
		  		where t1.ITCHG_N2ND_DWLL_TM_HRS between 73 and 96
		  	#elseif(${dwell_time} == '5')
		  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 24
		  	#elseif(${dwell_time} == '6')
		  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 48
		  	#elseif(${dwell_time} == '7')
		  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 72
		  	#elseif(${dwell_time} == '8')
		  		where t1.ITCHG_N2ND_DWLL_TM_HRS > 96
		  	#end                    
    	#elseif(${dwell_kind} == 'D1')          
    		#if(${dwell_time} == '1')
		  		where t1.DEST_N1ST_DWLL_TM_HRS between 0 and 24
		  	#elseif(${dwell_time} == '2')
		  		where t1.DEST_N1ST_DWLL_TM_HRS between 25 and 48
		  	#elseif(${dwell_time} == '3')
		  		where t1.DEST_N1ST_DWLL_TM_HRS between 49 and 72
		  	#elseif(${dwell_time} == '4')
		  		where t1.DEST_N1ST_DWLL_TM_HRS between 73 and 96
		  	#elseif(${dwell_time} == '5')
		  		where t1.DEST_N1ST_DWLL_TM_HRS > 24
		  	#elseif(${dwell_time} == '6')
		  		where t1.DEST_N1ST_DWLL_TM_HRS > 48
		  	#elseif(${dwell_time} == '7')
		  		where t1.DEST_N1ST_DWLL_TM_HRS > 72
		  	#elseif(${dwell_time} == '8')
		  		where t1.DEST_N1ST_DWLL_TM_HRS > 96
		  	#end                     
    	#elseif(${dwell_kind} == 'D2')
    		#if(${dwell_time} == '1')
		  		where t1.DEST_N2ND_DWLL_TM_HRS between 0 and 24
		  	#elseif(${dwell_time} == '2')
		  		where t1.DEST_N2ND_DWLL_TM_HRS between 25 and 48
		  	#elseif(${dwell_time} == '3')
		  		where t1.DEST_N2ND_DWLL_TM_HRS between 49 and 72
		  	#elseif(${dwell_time} == '4')
		  		where t1.DEST_N2ND_DWLL_TM_HRS between 73 and 96
		  	#elseif(${dwell_time} == '5')
		  		where t1.DEST_N2ND_DWLL_TM_HRS > 24
		  	#elseif(${dwell_time} == '6')
		  		where t1.DEST_N2ND_DWLL_TM_HRS > 48
		  	#elseif(${dwell_time} == '7')
		  		where t1.DEST_N2ND_DWLL_TM_HRS > 72
		  	#elseif(${dwell_time} == '8')
		  		where t1.DEST_N2ND_DWLL_TM_HRS > 96
		  	#end                      
    	#elseif(${dwell_kind} == 'C')
    		#if(${dwell_time} == '1')
		  		where t1.CRNT_DWLL_TM_HRS between 0 and 24
		  	#elseif(${dwell_time} == '2')
		  		where t1.CRNT_DWLL_TM_HRS between 25 and 48
		  	#elseif(${dwell_time} == '3')
		  		where t1.CRNT_DWLL_TM_HRS between 49 and 72
		  	#elseif(${dwell_time} == '4')
		  		where t1.CRNT_DWLL_TM_HRS between 73 and 96
		  	#elseif(${dwell_time} == '5')
		  		where t1.CRNT_DWLL_TM_HRS > 24
		  	#elseif(${dwell_time} == '6')
		  		where t1.CRNT_DWLL_TM_HRS > 48
		  	#elseif(${dwell_time} == '7')
		  		where t1.CRNT_DWLL_TM_HRS > 72
		  	#elseif(${dwell_time} == '8')
		  		where t1.CRNT_DWLL_TM_HRS > 96
		  	#end                             
    	#end
    #end			]]></sql>
			<params>
				<param name="fm_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="eq_no" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="cust_cnt_seq" type="12" value="" out="N"/>
				<param name="fm_nod_cd" type="12" value="" out="N"/>
				<param name="to_nod_cd" type="12" value="" out="N"/>
				<param name="cgo_tp_cd" type="12" value="" out="N"/>
				<param name="trsp_bnd_cd" type="12" value="" out="N"/>
				<param name="sc_no" type="12" value="" out="N"/>
				<param name="cstms_acpt_flg" type="12" value="" out="N"/>
				<param name="customer_loc" type="12" value="" out="N"/>
				<param name="pod_pol" type="12" value="" out="N"/>
				<param name="railcomp" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
