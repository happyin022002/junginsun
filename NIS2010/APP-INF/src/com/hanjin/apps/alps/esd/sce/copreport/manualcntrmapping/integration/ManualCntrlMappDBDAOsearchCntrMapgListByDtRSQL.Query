<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ManualCntrlMappDBDAOsearchCntrMapgListByDtRSQL">
			<desc><![CDATA[searchCntrMapgList]]></desc>
			<sql><![CDATA[
SELECT /*+ index( hdr XAK4SCE_COP_HDR ) */					                                                								
 	   distinct(bkg.bkg_no) bkg_no                                                                          
 	  ,cntr.cntr_no cntr_no                                                                                   
 	  ,cntr.cntr_tpsz_cd cntr_tpsz_cd                                                                             
 	  ,to_char(bkg.bkg_cre_dt,'YYYY/MM/DD HH24:MI:SS') bkg_cre_dt                                           
     , '' AS nis_event_dt --TO_CHAR(cntr.NIS_EVNT_DT,'YYYY/MM/DD HH24:MI:SS') nis_evnt_dt       
     , cntr.cntr_vol_qty cntr_vol_qty                                      
     , cntr.rcv_term_cd cntr_rcv_term_cd                              
     , cntr.de_term_cd cntr_de_term_cd                                                                 
 	  ,'A' dist                                                                                                
  FROM bkg_booking bkg
     , bkg_container cntr
     , sce_cop_hdr hdr                                                   
 WHERE 1 = 1 
   AND    bkg.bkg_no=cntr.bkg_no                                                                               
   AND bkg.bkg_no=hdr.bkg_no                                                                               
   AND hdr.cop_sts_cd in ( 'C', 'T', 'F', 'X', 'O')                                                        
   AND bkg.bkg_sts_cd not in ( 'X' , 'S' )	                                                                
   AND bkg.bkg_cgo_tp_cd <> 'P'										                                    
   AND bkg.bkg_cre_dt between to_date(@[bkgcrt_fm_dt],'YYYY-MM-DD') and to_date(@[bkgcrt_to_dt],'YYYY-MM-DD') + 0.99999                                           
   AND NOT EXISTS (																		                
 	                SELECT /*+ index( bkg XAK2BKG_BOOKING) index(hdr XAK1SCE_COP_HDR) */                    
 	                       hdr.bkg_no bkg_no,                                                                      
 	                       --hdr.bkg_no_split bkg_no_split,                                                          
 	                       hdr.cntr_no cntr_no,                                                                    
 	                       hdr.cntr_tpsz_cd tpsz_cd                                                                
 	                  FROM bkg_booking bkg
 	                     , sce_cop_hdr hdr                                                   
 	                 WHERE bkg.bkg_no=hdr.bkg_no                                                             
 		               and bkg.bkg_sts_cd not in ( 'X' , 'S' )	                                            
 		               and bkg.bkg_cgo_tp_cd <> 'P'										                
 		               and bkg.bkg_cre_dt between to_date(@[bkgcrt_fm_dt],'YYYY-MM-DD') and to_date(@[bkgcrt_to_dt],'YYYY-MM-DD') + 0.99999                               
 		               and hdr.cop_sts_cd in ( 'C', 'T', 'F', 'X', 'O')                                    
 		               and hdr.cntr_no=cntr.cntr_no                                                        
 		               and hdr.cntr_no <> 'SMCU0000000'                                                    
 	                )			]]></sql>
			<params>
				<param name="bkgcrt_fm_dt" type="12" value="" out="N"/>
				<param name="bkgcrt_to_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
