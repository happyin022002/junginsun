<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccrualBatchExecuteResultDBDAOSearchAccrualAdjustmentListRSQL">
			<desc><![CDATA[조정계수을 조회한다.]]></desc>
			<sql><![CDATA[
#if (${date_sts} == '0')
SELECT  B.SEQ, 
		SUBSTR(B.EXE_YRMON,1,4) || '-' || SUBSTR(B.EXE_YRMON,5,2) AS EXE_YRMON, 
		SUBSTR(B.REV_YRMON,1,4) || '-' || SUBSTR(B.REV_YRMON,5,2) AS REV_YRMON, 
		B.ACCL_LGC_TP_CD, 
--        RTRIM(TO_CHAR(NVL(A.ACCL_ADJ_FCTR_RT,0), 'FM9990.0000000000'), '.') AS ACCL_ADJ_FCTR_RT,
        NVL(A.ACCL_ADJ_FCTR_RT,0) AS ACCL_ADJ_FCTR_RT,
		A.ACCL_ADJ_FCTR_CFM_FLG, 
		A.ACCL_ADJ_FCTR_APLY_PROC_CD, 
		A.ACCL_ADJ_FCTR_APLY_ST_DT,
        A.ACCL_ADJ_FCTR_APLY_END_DT, 
		A.DELT_FLG,
        A.ACCL_ADJ_FCTR_FNL_FLG
FROM LEA_ACCL_ADJ_FCTR A,
(
SELECT LEVEL SEQ, TO_CHAR(TO_DATE(@[exe_yrmon], 'YYYY-MM'),'YYYYMM') AS EXE_YRMON, 
TO_CHAR(ADD_MONTHS(TO_DATE(@[exe_yrmon], 'YYYY-MM'),TRUNC((LEVEL-1)/6,0)*-1),'YYYYMM') AS REV_YRMON,
DECODE(MOD(LEVEL,6),1,'LB',2,'LO',3,'NB',4,'NO',5,'LC',0,'NC') AS ACCL_LGC_TP_CD FROM DUAL CONNECT BY LEVEL <=30
) B
WHERE A.EXE_YRMON(+) = B.EXE_YRMON
AND A.REV_YRMON(+) = B.REV_YRMON
AND A.ACCL_LGC_TP_CD(+) = B.ACCL_LGC_TP_CD
ORDER BY B.SEQ ASC
#end

#if (${date_sts} == '1')
SELECT  B.SEQ,
SUBSTR(B.EXE_YRMON,1,4) || '-' || SUBSTR(B.EXE_YRMON,5,2) AS EXE_YRMON,
SUBSTR(B.REV_YRMON,1,4) || '-' || SUBSTR(B.REV_YRMON,5,2) AS REV_YRMON,
B.ACCL_LGC_TP_CD,
--        RTRIM(TO_CHAR(NVL(A.ACCL_ADJ_FCTR_RT,0), 'FM9990.0000000000'), '.') AS ACCL_ADJ_FCTR_RT,
NVL(A.ACCL_ADJ_FCTR_RT,0) AS ACCL_ADJ_FCTR_RT,
A.ACCL_ADJ_FCTR_CFM_FLG,
A.ACCL_ADJ_FCTR_APLY_PROC_CD,
A.ACCL_ADJ_FCTR_APLY_ST_DT,
A.ACCL_ADJ_FCTR_APLY_END_DT,
A.DELT_FLG,
A.ACCL_ADJ_FCTR_FNL_FLG
FROM LEA_ACCL_ADJ_FCTR A,
(
SELECT LEVEL SEQ, TO_CHAR(TO_DATE(@[exe_yrmon], 'YYYY-MM'),'YYYYMM') AS EXE_YRMON,
TO_CHAR(ADD_MONTHS(TO_DATE(@[exe_yrmon], 'YYYY-MM'),TRUNC((LEVEL-1)/6,0)*-1),'YYYYMM') AS REV_YRMON,
DECODE(MOD(LEVEL,6),1,'LB',2,'LO',3,'NB',4,'NO',5,'LC',0,'NC') AS ACCL_LGC_TP_CD FROM DUAL CONNECT BY LEVEL <=30
UNION ALL
SELECT LEVEL+30 SEQ, TO_CHAR(TO_DATE(@[exe_yrmon], 'YYYY-MM'),'YYYYMM') AS EXE_YRMON,
TO_CHAR(ADD_MONTHS(TO_DATE(CONCAT(SUBSTR(@[exe_yrmon],1,5),'01'),'YYYY-MM'),TRUNC((LEVEL-1)/2,0)), 'YYYYMM') AS REV_YRMON,
DECODE(MOD(LEVEL,2),1,'LC',0,'NC') AS ACCL_LGC_TP_CD FROM DUAL CONNECT BY LEVEL <=(TO_NUMBER(SUBSTR(@[exe_yrmon],6,2))-5)*2
) B
WHERE A.EXE_YRMON(+) = B.EXE_YRMON
AND A.REV_YRMON(+) = B.REV_YRMON
AND A.ACCL_LGC_TP_CD(+) = B.ACCL_LGC_TP_CD
ORDER BY SUBSTR(B.REV_YRMON,1,4) || '-' || SUBSTR(B.REV_YRMON,5,2) DESC, B.SEQ ASC
#end			]]></sql>
			<params>
				<param name="exe_yrmon" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
