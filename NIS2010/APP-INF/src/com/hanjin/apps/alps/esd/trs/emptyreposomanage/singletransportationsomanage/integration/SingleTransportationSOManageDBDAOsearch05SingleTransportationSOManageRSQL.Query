<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SingleTransportationSOManageDBDAOsearch05SingleTransportationSOManageRSQL">
			<desc><![CDATA[조회]]></desc>
			<sql><![CDATA[
SELECT                                                                                     
	EQ_NO,		 																			
	MAX( DECODE( RK,1, VERIFY_RESULT ) )||                                           		
	MAX( DECODE( RK,2, ' / '||VERIFY_RESULT ) )||                                           
	MAX( DECODE( RK,3, ' / '||VERIFY_RESULT ) )||                                           
	MAX( DECODE( RK,4, ' / '||VERIFY_RESULT ) )||                                           
	MAX( DECODE( RK,5, ' / '||VERIFY_RESULT ) )||                                           
	MAX( DECODE( RK,6, ' / '||VERIFY_RESULT ) )  VERIFY_RESULT,                                    
	MAX(VERIFY_YN) VERIFY_YN                                                                
FROM                                                                                       
(                                                                                          
	SELECT         /*+ USE_NL(A) INDEX(A XAK3TRS_TRSP_SVC_ORD) */                                                                         
	EQ_NO,                                                                                  
	RANK() OVER(ORDER BY A.CRE_DT DESC) RK,													
	DECODE( TRSP_SO_SEQ, NULL, '',  'SO_NO:'||TRSP_SO_OFC_CTY_CD||TRSP_SO_SEQ||' '|| TO_CHAR(A.LOCL_CRE_DT, 'RRRR-MM-DD') ||' '|| FM_NOD_CD || '->'|| TO_NOD_CD || ' '|| TRSP_CRR_MOD_CD || ' SO Created' || DECODE(B.CONTI_CD,'M',' (Dup within 30 days)',' (Dup within 2 days)') )  Verify_Result , 
	DECODE( SIGN( (SYSDATE - A.CRE_DT) -  DECODE(B.CONTI_CD, 'M', 30, 2) ) , -1, 'Y' , 'N') VERIFY_YN 
	FROM  TRS_TRSP_SVC_ORD A, MDM_LOCATION B 
	WHERE A.TRSP_COST_DTL_MOD_CD  IN ('ER','CF','CN' ) 
#if ($arr_eqno.size() > 0) 
   AND   A.EQ_NO   in ( 
#foreach($eqNokey IN ${arr_eqno}) 
	#if($velocityCount < $arr_eqno.size()) 
		'$eqNokey',
	#else 
		'$eqNokey'
	#end 
#end  
  )                             
#end 	

#if ($arr_frmnodecd.size() > 0) 
   AND A.FM_NOD_CD   in ( 
#foreach($frmkey IN ${arr_frmnodecd}) 
	#if($velocityCount < $arr_frmnodecd.size()) 
		'$frmkey',
	#else 
		'$frmkey'
	#end 
#end  
  )                             
#end 
	
	AND NVL(A.DELT_FLG, 'N')<>'Y'
	AND A.CRE_DT  BETWEEN (SYSDATE -  DECODE(B.CONTI_CD, 'M', 30, 2)  ) AND SYSDATE                                                                                   
  AND SUBSTR(A.FM_NOD_CD	,1,5) = B.LOC_CD   
  AND A.HJL_NO IS NULL   
)                               
GROUP BY EQ_NO			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
