<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ServiceProviderManageDBDAOSearchMdmVendorIndiaInfoRSQL">
			<desc><![CDATA[SearchMdmVendorIndiaInfo]]></desc>
			<sql><![CDATA[
SELECT
     MV.VNDR_SEQ IDA_VNDR_SEQ
    ,MV.VNDR_LGL_ENG_NM IDA_VNDR_NM
    , (SELECT MS.IDA_STE_CD FROM MDM_STATE MS WHERE MS.CNT_CD = 'IN' AND MS.STE_CD = ML.STE_CD AND ROWNUM = 1) IDA_STE_CD
    , (SELECT MS.STE_NM FROM MDM_STATE MS WHERE MS.CNT_CD = 'IN' AND MS.STE_CD = ML.STE_CD AND ROWNUM = 1) IDA_STE_NM
    ,IDA_PAN_NO
    ,IDA_GST_RGST_NO
    ,IDA_SPCL_ECN_ZN_UT_FLG
    ,IDA_CNTC_PSON_NM
    ,IDA_ALTN_RCVR_NM
    ,IDA_VNDR_EML 
	,IDA_SPCL_ECN_ZN_DOC_NO
	,IDA_SPCL_ECN_ZN_DOC_DESC
	,IDA_CO_TYPE_CD
	,IDA_GST_RGST_STS_CD
	,IDA_GST_RGST_TP_CD
FROM MDM_VENDOR MV         
    , MDM_LOCATION ML
    ,(   SELECT  X.VNDR_SEQ, 
                MAX(VNDR_EML) IDA_VNDR_EML
        FROM (
        	SELECT A.VNDR_SEQ,
               	    DECODE(CNTC_DIV_CD,'IDA',VNDR_EML,'') VNDR_EML
        	FROM MDM_VENDOR A, MDM_VNDR_CNTC_PNT B
        	WHERE A.VNDR_SEQ = B.VNDR_SEQ
            AND A.VNDR_SEQ = @[vndr_seq]
		) X
        GROUP BY X.VNDR_SEQ 
    ) CP
WHERE MV.LOC_CD = ML.LOC_CD
AND MV.VNDR_SEQ = CP.VNDR_SEQ(+)
AND MV.VNDR_SEQ = @[vndr_seq]
AND	MV.DELT_FLG = 'N'			]]></sql>
			<params>
				<param name="vndr_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
