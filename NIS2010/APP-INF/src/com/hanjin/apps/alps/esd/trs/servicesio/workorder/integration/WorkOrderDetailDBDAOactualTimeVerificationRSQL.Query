<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WorkOrderDetailDBDAOactualTimeVerificationRSQL">
			<desc><![CDATA[actualTimeVerification]]></desc>
			<sql><![CDATA[
SELECT COP_NO,
       COP_DTL_SEQ,
       CNTR_NO,
       ACT_CD,
       ACT_DT,
       PRE_ACT_CD,
       PRE_ACT_DT,
       TO_CHAR(PRE_ACT_DT, 'yyyy-MM-dd hh24:mi') AS PRE_ACT_DT_INFO,
       CASE
          WHEN PRE_ACT_CD IS NULL
          THEN
             'N'
          WHEN PRE_ACT_DT IS NULL
          THEN
             'N'
          WHEN     (   PRE_ACT_CD = 'FITMDO'
                    OR PRE_ACT_CD = 'FITRDO'
                    OR PRE_ACT_CD = 'FITYDO')
               AND PRE_ACT_DT <= TO_DATE (@[in_act_dt], 'yyyyMMddhh24mi')
          THEN
             'Y'
          ELSE
             'N'
       END
          AS RV
  FROM (SELECT D.COP_NO,
               D.COP_DTL_SEQ,
               H.CNTR_NO,
               D.ACT_CD,
               D.ACT_DT,
               LAG (D.ACT_CD) OVER (ORDER BY D.COP_NO, D.COP_DTL_SEQ)
                  AS PRE_ACT_CD,
               LAG (D.ACT_DT) OVER (ORDER BY D.COP_NO, D.COP_DTL_SEQ)
                  AS PRE_ACT_DT
          FROM SCE_COP_DTL D, SCE_COP_HDR H, MDM_ACTIVITY M
         WHERE     1 = 1
               AND D.ACT_CD = M.ACT_CD
               AND D.COP_NO = H.COP_NO
               AND H.BKG_NO = @[bkg_no]
               AND H.CNTR_NO = @[cntr_no])
 WHERE 1 = 1 AND ACT_CD = 'FITZAD'			]]></sql>
			<params>
				<param name="in_act_dt" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
