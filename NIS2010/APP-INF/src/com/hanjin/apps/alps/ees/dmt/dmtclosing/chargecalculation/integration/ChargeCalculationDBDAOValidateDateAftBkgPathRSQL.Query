<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChargeCalculationDBDAOValidateDateAftBkgPathRSQL">
			<desc><![CDATA[ChargeCalculationDBDAOValidateDateAftBkgPath]]></desc>
			<sql><![CDATA[
SELECT NVL(MAX(DT_FLG),'N') DT_FLG
	FROM (
	-- EFF DT 같은 경우 구분값  R >> 금액 검사 필요함
	SELECT 'R' DT_FLG FROM DMT_AFT_BKG_PATH_OFC_STUP
	WHERE RHQ_CD = @[rhq_cd]
	AND DELT_FLG = 'N'
	AND NVL(OFC_CD,'A') = NVL(@[ofc_cd],'A')
	AND EFF_DT = TO_DATE(@[eff_dt],'YYYYMMDD')
	AND NVL(EXP_DT, TO_DATE('99991231', 'YYYYMMDD') + 0.99999) = 
		NVL(TO_DATE(@[exp_dt],'YYYYMMDD'), TO_DATE('99991231', 'YYYYMMDD') + 0.99999)
#if(${ibflag}=='U' && ${update_seq_list} != '')
	AND AFT_BKG_PATH_STUP_SEQ NOT IN(
	#foreach( $update_seq in ${update_seq_list} )
		#if($velocityCount < $update_seq_list.size()) '$update_seq', #else '$update_seq' #end
	#end	
	)
#end
	UNION ALL

	SELECT 'E' DT_FLG FROM DMT_AFT_BKG_PATH_OFC_STUP
	WHERE RHQ_CD = @[rhq_cd]
	AND DELT_FLG = 'N'
	AND NVL(OFC_CD, 'A') = NVL(@[ofc_cd], 'A')
	AND TO_DATE(@[eff_dt], 'YYYYMMDD') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('99991231','YYYYMMDD') + 0.99999)
#if(${ibflag}=='U' && ${update_seq_list} != '')
	AND AFT_BKG_PATH_STUP_SEQ NOT IN(
	#foreach( $update_seq in ${update_seq_list} )
		#if($velocityCount < $update_seq_list.size()) '$update_seq', #else '$update_seq' #end
	#end	
	)
#end

	UNION ALL

	SELECT 'E' FROM DMT_AFT_BKG_PATH_OFC_STUP
	WHERE RHQ_CD = @[rhq_cd]
	AND DELT_FLG = 'N'
	AND NVL(OFC_CD,'A') = NVL(@[ofc_cd], 'A')
	AND NVL(TO_DATE(@[exp_dt], 'YYYYMMDD'), TO_DATE('99991231','YYYYMMDD')) + 0.99999 BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('99991231','YYYYMMDD') + 0.99999)
#if(${ibflag}=='U' && ${update_seq_list} != '')
	AND AFT_BKG_PATH_STUP_SEQ NOT IN(
	#foreach( $update_seq in ${update_seq_list} )
		#if($velocityCount < $update_seq_list.size()) '$update_seq', #else '$update_seq' #end
	#end	
	)
#end
	)			]]></sql>
			<params>
				<param name="rhq_cd" type="12" value="SELIB" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="eff_dt" type="12" value="20140101" out="N"/>
				<param name="exp_dt" type="12" value="20150501" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
