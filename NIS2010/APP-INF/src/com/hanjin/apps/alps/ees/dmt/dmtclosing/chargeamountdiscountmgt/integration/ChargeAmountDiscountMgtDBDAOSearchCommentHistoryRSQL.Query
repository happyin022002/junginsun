<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChargeAmountDiscountMgtDBDAOSearchCommentHistoryRSQL">
			<desc><![CDATA[DEM/DET Adjustment Request - After Booking Request 의 Comment History 정보를 조회하는 쿼리]]></desc>
			<sql><![CDATA[
SELECT	ADJ_PROG.PROG_SEQ
	,	CD_DTL.INTG_CD_VAL_DP_DESC STS_DESC
	,	TO_CHAR(ADJ_PROG.PROG_DT, 'YYYY-MM-DD') PROG_DT
	,	ADJ_PROG.PROG_OFC_CD
	,	COM_USER.USR_NM PROG_USR_NM
	,	DECODE(NVL(LENGTH(TRIM(ADJ_PROG.PROG_RMK)),0),0,'N','Y') PROG_RMK_FLG
	,	REPLACE(ADJ_PROG.PROG_RMK, '@*', chr(13) || chr(10)) PROG_RMK

FROM    DMT_AFT_BKG_ADJ_RQST ADJ_RQST
    ,   DMT_AFT_BKG_ADJ_PROG ADJ_PROG
   	,	COM_INTG_CD_DTL CD_DTL
	,	COM_USER
    
WHERE
	#if(${dar_no} != '')
        ADJ_RQST.AFT_EXPT_DAR_NO 		= @[dar_no]
	#elseif(${apvl_no} != '')
        ADJ_RQST.AFT_BKG_APRO_NO 		= @[apvl_no]
	#end
    AND ADJ_RQST.AFT_EXPT_DAR_NO 		= ADJ_PROG.AFT_EXPT_DAR_NO
    AND ADJ_PROG.DMDT_EXPT_RQST_STS_CD 	= CD_DTL.INTG_CD_VAL_CTNT
    AND CD_DTL.INTG_CD_ID 				= 'CD01971'        
    AND	ADJ_PROG.PROG_USR_ID 			= COM_USER.USR_ID(+)

ORDER BY ADJ_PROG.PROG_SEQ DESC			]]></sql>
			<params>
				<param name="dar_no" type="12" value="" out="N"/>
				<param name="apvl_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
