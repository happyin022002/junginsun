<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DemDetTariffMgtDBDAOSearchBasicTariffDetailListRSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
SELECT  A.DMDT_TRF_CD
		,CASE WHEN TRIM(A.CVRG_YD_CD) IS NULL THEN 
			(CASE WHEN TRIM(A.CVRG_LOC_CD) IS NULL THEN
				(CASE WHEN TRIM(A.CVRG_STE_CD) IS NULL THEN
					(CASE WHEN TRIM(A.CVRG_RGN_CD) IS NULL THEN A.CVRG_CNT_CD ELSE A.CVRG_RGN_CD END)
				ELSE A.CVRG_STE_CD
				END)
			ELSE A.CVRG_LOC_CD
			END)
		ELSE A.CVRG_YD_CD
		END COVRG
       ,A.DMDT_TRF_CD
       ,A.DMDT_DE_TERM_CD
       ,(
        SELECT  S.INTG_CD_VAL_DP_DESC
        FROM    COM_INTG_CD_DTL S
        WHERE   S.INTG_CD_ID        = 'CD03257'
        AND     S.INTG_CD_VAL_CTNT  = B.DMDT_DE_TERM_CD
        ) AS DMDT_DE_TERM_NM
       ,CASE WHEN TRIM(A.ORG_DEST_LOC_CD) IS NULL THEN 
			(CASE WHEN TRIM(A.ORG_DEST_STE_CD) IS NULL THEN
				(CASE WHEN TRIM(A.ORG_DEST_RGN_CD) IS NULL THEN 
					(CASE WHEN TRIM(A.ORG_DEST_CNT_CD) IS NULL THEN A.ORG_DEST_CONTI_CD ELSE A.ORG_DEST_CNT_CD END)
				ELSE A.ORG_DEST_RGN_CD
				END)
			ELSE A.ORG_DEST_STE_CD
			END)
		ELSE A.ORG_DEST_LOC_CD
		END ORG_DEST
	, B.TRF_GRP_SEQ
	, CASE WHEN B.DMDT_TRF_GRP_TP_CD = 'N' THEN 'Exempted'
              ELSE B.DMDT_BZC_TRF_GRP_NM END DMDT_BZC_TRF_GRP_NM
    ,TO_CHAR(B.EFF_DT,'YYYY-MM-DD') AS EFF_DT
    ,TO_CHAR(B.EXP_DT,'YYYY-MM-DD') AS EXP_DT
    ,(SELECT INTG_CD_VAL_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD01964' AND INTG_CD_VAL_CTNT = B.DMDT_CHG_CMNC_TP_CD ) AS DMDT_CHG_CMNC_TP_CD
	,F.INTG_CD_VAL_DP_DESC AS DMDT_CNTR_TP_CD
	,G.INTG_CD_VAL_DP_DESC AS DMDT_CGO_TP_CD
    ,B.XCLD_SAT_FLG
    ,B.XCLD_SUN_FLG
    ,B.XCLD_HOL_FLG
    ,D.FT_FM_QTY ||'-'|| DECODE(D.FT_TO_QTY,0,'',D.FT_TO_QTY ) AS FREE_TIME
    ,D.FT_DYS
    ,B.CURR_CD
    ,E.FT_OVR_DYS ||'-'|| DECODE(E.FT_UND_DYS,0,'',E.FT_UND_DYS) AS OVER_DAY
    ,E.CNTR_20FT_RT_AMT
    ,E.CNTR_40FT_RT_AMT
    ,E.CNTR_HC_RT_AMT
    ,E.CNTR_45FT_RT_AMT
    ,E.CNTR_R9_RT_AMT
	,CASE WHEN TO_CHAR(EXP_DT,'YYYYMMDD') <= TO_CHAR(SYSDATE,'YYYYMMDD') THEN 'Y'
      	ELSE 'N'
		END EXPIRE_CHK
	,CASE WHEN (SELECT WKND_TP_CD FROM DMT_WEEKEND WHERE CNT_CD = A.CVRG_CNT_CD) = 'TF' THEN 'THU'
          WHEN (SELECT WKND_TP_CD FROM DMT_WEEKEND WHERE CNT_CD = A.CVRG_CNT_CD) = 'FS' THEN 'FRI'
          ELSE 'SAT'
          END WKND1
	,CASE WHEN (SELECT WKND_TP_CD FROM DMT_WEEKEND WHERE CNT_CD = A.CVRG_CNT_CD) = 'TF' THEN 'FRI'
          WHEN (SELECT WKND_TP_CD FROM DMT_WEEKEND WHERE CNT_CD = A.CVRG_CNT_CD) = 'FS' THEN 'SAT'
          ELSE 'SUN'
          END WKND2
FROM    DMT_TRF_RGN         A,         
        DMT_TRF_GRP         B, 
        DMT_TRF_CMB         C, 
        DMT_TRF_FREE_TM     D, 
        DMT_TRF_RT          E,         
        COM_INTG_CD_DTL     F, 
        COM_INTG_CD_DTL     G
WHERE   A.SYS_AREA_GRP_ID   = B.SYS_AREA_GRP_ID
AND     A.DMDT_TRF_CD       = B.DMDT_TRF_CD
AND     A.TRF_SEQ           = B.TRF_SEQ
AND     B.SYS_AREA_GRP_ID   = C.SYS_AREA_GRP_ID
AND     B.DMDT_TRF_CD       = C.DMDT_TRF_CD
AND     B.TRF_SEQ           = C.TRF_SEQ
AND     B.DMDT_DE_TERM_CD   = C.DMDT_DE_TERM_CD
AND     B.TRF_GRP_SEQ       = C.TRF_GRP_SEQ
AND     B.SYS_AREA_GRP_ID   = D.SYS_AREA_GRP_ID (+)
AND     B.DMDT_TRF_CD       = D.DMDT_TRF_CD     (+)
AND     B.TRF_SEQ           = D.TRF_SEQ         (+)
AND     B.DMDT_DE_TERM_CD   = D.DMDT_DE_TERM_CD (+)
AND     B.TRF_GRP_SEQ       = D.TRF_GRP_SEQ     (+)
AND     B.SYS_AREA_GRP_ID   = E.SYS_AREA_GRP_ID (+)
AND     B.DMDT_TRF_CD       = E.DMDT_TRF_CD     (+)
AND     B.TRF_SEQ           = E.TRF_SEQ         (+)
AND     B.TRF_GRP_SEQ       = E.TRF_GRP_SEQ     (+)
AND     B.DMDT_DE_TERM_CD   = E.DMDT_DE_TERM_CD (+)
AND     F.INTG_CD_VAL_CTNT  = C.DMDT_CNTR_TP_CD
AND     G.INTG_CD_VAL_CTNT  = C.DMDT_CGO_TP_CD
AND     F.INTG_CD_ID        = 'CD02053'
AND     G.INTG_CD_ID        = 'CD01963'
AND     B.CFM_FLG           = 'Y'
#if (${ui_code} == '1004') 
AND A.SUTH_CHN_USE_FLG = 'N'
#elseif (${ui_code} == '4015') 
AND A.SUTH_CHN_USE_FLG = 'Y'
#end
#if (${cvrg_conti_cd} != '')
AND A.CVRG_CONTI_CD = @[cvrg_conti_cd]
#end
#if (${cvrg_cnt_cd} != '')
AND A.CVRG_CNT_CD = @[cvrg_cnt_cd]
#end
#if (${cvrg_cnt_cd} == 'US' || ${cvrg_cnt_cd} == 'CA')
	#if (${cvrg_rgn_cd} != '')
	AND A.CVRG_STE_CD = @[cvrg_rgn_cd]
	#end
#else 
	#if (${cvrg_rgn_cd} != '')
	AND A.CVRG_RGN_CD = @[cvrg_rgn_cd]
	#end
#end

#if (${cvrg_loc_cd} != '')
AND A.CVRG_LOC_CD = @[cvrg_loc_cd]
#end
#if (${cvrg_yd_cd} != '')
AND A.CVRG_YD_CD = @[cvrg_yd_cd]
#end
#if (${org_dest_conti_cd} != '')
AND A.ORG_DEST_CONTI_CD = @[org_dest_conti_cd]
#end
#if (${org_dest_cnt_cd} != '')
AND A.ORG_DEST_CNT_CD = @[org_dest_cnt_cd]
#end
#if (${org_dest_cnt_cd} == 'US' || ${org_dest_cnt_cd} == 'CA')
	#if (${org_dest_rgn_cd} != '')
	AND A.ORG_DEST_STE_CD = @[org_dest_rgn_cd]
	#end
#else 
	#if (${org_dest_rgn_cd} != '')
	AND A.ORG_DEST_RGN_CD = @[org_dest_rgn_cd]
	#end
#end
#if (${org_dest_loc_cd} != '')
AND A.ORG_DEST_LOC_CD = @[org_dest_loc_cd]
#end
#if (${dmdt_trf_cd_in} == 'Y')
AND A.DMDT_TRF_CD IN (
    #foreach( $dmdt_trf_cd in ${dmdt_trf_cd_list}) 
        #if($velocityCount < $dmdt_trf_cd_list.size()) 
           '$dmdt_trf_cd', 
        #else 
           '$dmdt_trf_cd' 
        #end 
    #end
    )
#end
#if (${dmdt_cntr_tp_cd_in} == 'Y')
AND C.DMDT_CNTR_TP_CD IN (
    #foreach( $dmdt_cntr_tp_cd in ${dmdt_cntr_tp_list}) 
        #if($velocityCount < $dmdt_cntr_tp_list.size()) 
           '$dmdt_cntr_tp_cd', 
        #else 
           '$dmdt_cntr_tp_cd' 
        #end 
    #end
    )
#end
#if (${dmdt_cgo_tp_cd_in} == 'Y')
AND C.DMDT_CGO_TP_CD IN (
    #foreach( $dmdt_cgo_tp_cd in ${dmdt_cgo_tp_list}) 
        #if($velocityCount < $dmdt_cgo_tp_list.size()) 
           '$dmdt_cgo_tp_cd', 
        #else 
           '$dmdt_cgo_tp_cd' 
        #end 
    #end
    )
#end
#if (${validity1} != '')
AND ( TO_CHAR(EFF_DT,'YYYYMMDD') <= TO_CHAR(SYSDATE,'YYYYMMDD')
      AND NVL(TO_CHAR(EXP_DT,'YYYYMMDD'),'99991231') >= TO_CHAR(SYSDATE,'YYYYMMDD')
    #if (${validity2} != '')
		OR (TO_CHAR(EFF_DT,'YYYYMMDD') > TO_CHAR(SYSDATE,'YYYYMMDD')
            AND NVL(TO_CHAR(EXP_DT,'YYYYMMDD'),'99991231') >= TO_CHAR(SYSDATE,'YYYYMMDD'))
        #if (${validity3} != '')
			OR (TO_CHAR(EXP_DT,'YYYYMMDD') <= TO_CHAR(SYSDATE,'YYYYMMDD'))
		#end
	#else
        #if (${validity3} != '')
			OR (TO_CHAR(EXP_DT,'YYYYMMDD') <= TO_CHAR(SYSDATE,'YYYYMMDD'))
		#end
    #end
	)
#else
AND (
    #if (${validity2} != '')
		TO_CHAR(EFF_DT,'YYYYMMDD') > TO_CHAR(SYSDATE,'YYYYMMDD')
        AND NVL(TO_CHAR(EXP_DT,'YYYYMMDD'),'99991231') >= TO_CHAR(SYSDATE,'YYYYMMDD')
		#if (${validity3} != '')
			OR (TO_CHAR(EXP_DT,'YYYYMMDD') <= TO_CHAR(SYSDATE,'YYYYMMDD'))
		#end
	#else
		TO_CHAR(EXP_DT,'YYYYMMDD') <= TO_CHAR(SYSDATE,'YYYYMMDD')
    #end
	)
#end
ORDER BY A.DMDT_TRF_CD, LENGTH(COVRG),COVRG, LENGTH(ORG_DEST), ORG_DEST, B.EFF_DT, B.EXP_DT, F.INTG_CD_VAL_DP_SEQ, G.INTG_CD_VAL_DP_SEQ			]]></sql>
			<params>
				<param name="cvrg_conti_cd" type="12" value="" out="N"/>
				<param name="cvrg_cnt_cd" type="12" value="" out="N"/>
				<param name="cvrg_rgn_cd" type="12" value="" out="N"/>
				<param name="cvrg_loc_cd" type="12" value="" out="N"/>
				<param name="cvrg_yd_cd" type="12" value="" out="N"/>
				<param name="org_dest_conti_cd" type="12" value="" out="N"/>
				<param name="org_dest_cnt_cd" type="12" value="" out="N"/>
				<param name="org_dest_rgn_cd" type="12" value="" out="N"/>
				<param name="org_dest_loc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
