<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RepairMgtDBDAOsearchLatestEstimateDataRSQL">
			<desc><![CDATA[searchLatestEstimateData]]></desc>
			<sql><![CDATA[
SELECT   C.RQST_EQ_NO
       , C.RPR_RQST_SEQ
       , C.RPR_RQST_VER_NO
       , C.EQ_KND_CD
       , C.RECENT_RPR_TP_CD
FROM     (
	       SELECT   ROW_NUMBER() OVER(ORDER BY B.UPD_DT DESC) ROWNM
                  , '3' AS RECENT_RPR_TP_CD
                  , B.RQST_EQ_NO
                  , B.RPR_RQST_SEQ
                  , B.RPR_RQST_VER_NO
                  , B.EQ_KND_CD
	       FROM     MNR_RPR_RQST_HDR B
                  , MNR_AGMT_HDR C
	       WHERE    1 = 1
           AND      B.RQST_EQ_NO = @[rqst_eqno]
	       AND      B.RPR_RQST_LST_VER_FLG = 'Y'
	       AND      B.RPR_STS_CD = 'HA'
	       AND      B.AGMT_OFC_CTY_CD = C.AGMT_OFC_CTY_CD
	       AND      B.AGMT_SEQ = C.AGMT_SEQ
	       AND      B.AGMT_VER_NO = C.AGMT_VER_NO
	       AND      B.UPD_DT BETWEEN ADD_MONTHS(SYSDATE, -3) AND SYSDATE
	       AND      B.RQST_EQ_NO || B.RPR_RQST_SEQ || B.RPR_RQST_VER_NO <> @[self_chk]
	       AND      C.VNDR_SEQ = @[vndr_seq]
	     ) C			]]></sql>
			<params>
				<param name="rqst_eqno" type="12" value="" out="N"/>
				<param name="self_chk" type="12" value="" out="N"/>
				<param name="vndr_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
