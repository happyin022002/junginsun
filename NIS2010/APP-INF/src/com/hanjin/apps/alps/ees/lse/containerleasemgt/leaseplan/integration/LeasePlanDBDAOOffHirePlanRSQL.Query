<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="LeasePlanDBDAOOffHirePlanRSQL">
			<desc><![CDATA[Lease Plan Off-Hire Plan by H/Q   ]]></desc>
			<sql><![CDATA[
SELECT XX.PLN_YR         
     , XX.OFFH_RGN_LOC_CD
     , XX.CNTR_TPSZ_CD   
     , XX.LSTM_CD        
     , XX.OFFH_VER_SEQ   
     , XX.OFFH_PLN_TP_CD 
     , XX.OFFH_LOC_TP_CD 
     , XX.MNTH_01
     , XX.MNTH_02
     , XX.MNTH_03
     , XX.MNTH_04
     , XX.MNTH_05
     , XX.MNTH_06
     , XX.MNTH_07
     , XX.MNTH_08
     , XX.MNTH_09
     , XX.MNTH_10
     , XX.MNTH_11
     , XX.MNTH_12
     , XX.YR_TOT
FROM   (
         SELECT 1 AS TYPE
              , X.PLN_YR
              , X.OFFH_RGN_LOC_CD
              , X.CNTR_TPSZ_CD
              , X.LSTM_CD
              , X.OFFH_VER_SEQ
              , X.OFFH_PLN_TP_CD
              , X.OFFH_LOC_TP_CD
              , Y.RPT_DP_SEQ
              , SUM(DECODE(X.DE_MON,'01',DE_QTY,0)) AS MNTH_01
              , SUM(DECODE(X.DE_MON,'02',DE_QTY,0)) AS MNTH_02
              , SUM(DECODE(X.DE_MON,'03',DE_QTY,0)) AS MNTH_03
              , SUM(DECODE(X.DE_MON,'04',DE_QTY,0)) AS MNTH_04
              , SUM(DECODE(X.DE_MON,'05',DE_QTY,0)) AS MNTH_05
              , SUM(DECODE(X.DE_MON,'06',DE_QTY,0)) AS MNTH_06
              , SUM(DECODE(X.DE_MON,'07',DE_QTY,0)) AS MNTH_07
              , SUM(DECODE(X.DE_MON,'08',DE_QTY,0)) AS MNTH_08
              , SUM(DECODE(X.DE_MON,'09',DE_QTY,0)) AS MNTH_09
              , SUM(DECODE(X.DE_MON,'10',DE_QTY,0)) AS MNTH_10
              , SUM(DECODE(X.DE_MON,'11',DE_QTY,0)) AS MNTH_11
              , SUM(DECODE(X.DE_MON,'12',DE_QTY,0)) AS MNTH_12
              , SUM(DECODE(X.DE_MON,'01',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'02',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'03',DE_QTY,0))
              + SUM(DECODE(X.DE_MON,'04',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'05',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'06',DE_QTY,0))
              + SUM(DECODE(X.DE_MON,'07',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'08',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'09',DE_QTY,0))
              + SUM(DECODE(X.DE_MON,'10',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'11',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'12',DE_QTY,0)) AS YR_TOT
         FROM   (
                  SELECT A.PLN_YR
                       , SUBSTR(A.OFFH_YRMON, 5, 2) AS DE_MON
                       , NVL(A.OFFH_QTY,0) AS DE_QTY
                       , A.OFFH_RGN_LOC_CD
                       , A.CNTR_TPSZ_CD
                       , A.LSTM_CD
                       , A.OFFH_VER_SEQ
                       , A.OFFH_PLN_TP_CD
                       , A.OFFH_LOC_TP_CD
                  FROM   LSE_OFFH_PLN A
                  WHERE  1 = 1
#if (${offh_loc_tp_cd} != "")
                  AND    A.OFFH_LOC_TP_CD = @[offh_loc_tp_cd]
#end

#if (${pln_yr} != "")
                  AND    A.PLN_YR = @[pln_yr]
#end

#if (${offh_pln_tp_cd} != "")
                  AND    A.OFFH_PLN_TP_CD = @[offh_pln_tp_cd]
#end

#if (${offh_ver_seq} != "")
                  AND    A.OFFH_VER_SEQ = @[offh_ver_seq]
#else
                  AND    A.OFFH_VER_SEQ = ( SELECT MAX(A.OFFH_VER_SEQ)
                                            FROM   LSE_OFFH_PLN A
                                            WHERE  1 = 1
#if (${pln_yr} != "")
                                            AND    A.PLN_YR = @[pln_yr]
#end

#if (${offh_pln_tp_cd} != "")
                                            AND    A.OFFH_PLN_TP_CD = @[offh_pln_tp_cd]
#end

#if (${offh_loc_tp_cd} != "")
                                            AND    A.OFFH_LOC_TP_CD = @[offh_loc_tp_cd]
#end
                                          )
#end

#if (${lstm_cd} != "")
                  AND    A.LSTM_CD = @[lstm_cd]
#end

#if (${offh_rgn_loc_cd} != "")
                  AND    A.OFFH_LOC_CD IN (
#foreach($key IN ${offh_rgn_loc_cd_seq})
#if($velocityCount < $offh_rgn_loc_cd_seq.size())
'$key',
#else
'$key'
#end
#end
                         )
#end

#if (${cntr_tpsz_cd} != "")
                  AND    A.CNTR_TPSZ_CD IN (
#foreach($key IN ${cntr_tpsz_cd_seq})
#if($velocityCount < $cntr_tpsz_cd_seq.size())
'$key',
#else
'$key'
#end
#end
                         )
#end
                ) X
              , MDM_CNTR_TP_SZ Y
         WHERE  X.CNTR_TPSZ_CD = Y.CNTR_TPSZ_CD
         GROUP  BY X.PLN_YR
              , X.OFFH_RGN_LOC_CD
              , X.CNTR_TPSZ_CD
              , X.LSTM_CD
              , X.OFFH_VER_SEQ
              , X.OFFH_PLN_TP_CD
              , X.OFFH_LOC_TP_CD
              , Y.RPT_DP_SEQ
         UNION ALL
         SELECT 2 AS TYPE
              , X.PLN_YR
              , 'G.TTL' AS OFFH_RGN_LOC_CD
              , X.CNTR_TPSZ_CD
              , X.LSTM_CD
              , X.OFFH_VER_SEQ
              , X.OFFH_PLN_TP_CD
              , X.OFFH_LOC_TP_CD
              , Y.RPT_DP_SEQ
              , SUM(DECODE(X.DE_MON,'01',DE_QTY,0)) AS MNTH_01
              , SUM(DECODE(X.DE_MON,'02',DE_QTY,0)) AS MNTH_02
              , SUM(DECODE(X.DE_MON,'03',DE_QTY,0)) AS MNTH_03
              , SUM(DECODE(X.DE_MON,'04',DE_QTY,0)) AS MNTH_04
              , SUM(DECODE(X.DE_MON,'05',DE_QTY,0)) AS MNTH_05
              , SUM(DECODE(X.DE_MON,'06',DE_QTY,0)) AS MNTH_06
              , SUM(DECODE(X.DE_MON,'07',DE_QTY,0)) AS MNTH_07
              , SUM(DECODE(X.DE_MON,'08',DE_QTY,0)) AS MNTH_08
              , SUM(DECODE(X.DE_MON,'09',DE_QTY,0)) AS MNTH_09
              , SUM(DECODE(X.DE_MON,'10',DE_QTY,0)) AS MNTH_10
              , SUM(DECODE(X.DE_MON,'11',DE_QTY,0)) AS MNTH_11
              , SUM(DECODE(X.DE_MON,'12',DE_QTY,0)) AS MNTH_12
              , SUM(DECODE(X.DE_MON,'01',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'02',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'03',DE_QTY,0))
              + SUM(DECODE(X.DE_MON,'04',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'05',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'06',DE_QTY,0))
              + SUM(DECODE(X.DE_MON,'07',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'08',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'09',DE_QTY,0))
              + SUM(DECODE(X.DE_MON,'10',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'11',DE_QTY,0)) + SUM(DECODE(X.DE_MON,'12',DE_QTY,0)) AS YR_TOT
         FROM   ( SELECT A.PLN_YR
                       , SUBSTR(A.OFFH_YRMON, 5, 2) AS DE_MON
                       , NVL(A.OFFH_QTY,0) AS DE_QTY
                       , A.OFFH_RGN_LOC_CD
                       , A.CNTR_TPSZ_CD
                       , A.LSTM_CD
                       , A.OFFH_VER_SEQ
                       , A.OFFH_PLN_TP_CD
                       , A.OFFH_LOC_TP_CD
                  FROM   LSE_OFFH_PLN A
                  WHERE  1 = 1
#if (${offh_loc_tp_cd} != "")
                  AND    A.OFFH_LOC_TP_CD = @[offh_loc_tp_cd]
#end

#if (${pln_yr} != "")
                  AND    A.PLN_YR = @[pln_yr]
#end

#if (${offh_pln_tp_cd} != "")
                  AND    A.OFFH_PLN_TP_CD = @[offh_pln_tp_cd]
#end

#if (${offh_ver_seq} != "")
                  AND    A.OFFH_VER_SEQ = @[offh_ver_seq]
#else
                  AND    A.OFFH_VER_SEQ = ( SELECT MAX(A.OFFH_VER_SEQ)
                                            FROM   LSE_OFFH_PLN A
                                            WHERE  1 = 1
#if (${pln_yr} != "")
                                            AND    A.PLN_YR = @[pln_yr]
#end

#if (${offh_pln_tp_cd} != "")
                                            AND    A.OFFH_PLN_TP_CD = @[offh_pln_tp_cd]
#end

#if (${offh_loc_tp_cd} != "")
                                            AND    A.OFFH_LOC_TP_CD = @[offh_loc_tp_cd]
#end
                                          )
#end

#if (${lstm_cd} != "")
                  AND    A.LSTM_CD = @[lstm_cd]
#end

#if (${offh_rgn_loc_cd} != "")
                  AND    A.OFFH_LOC_CD IN (
#foreach($key IN ${offh_rgn_loc_cd_seq})
#if($velocityCount < $offh_rgn_loc_cd_seq.size())
'$key',
#else
'$key'
#end
#end
                         )
#end

#if (${cntr_tpsz_cd} != "")
                  AND    A.CNTR_TPSZ_CD IN (
#foreach($key IN ${cntr_tpsz_cd_seq})
#if($velocityCount < $cntr_tpsz_cd_seq.size())
'$key',
#else
'$key'
#end
#end
                         )
#end
                ) X
              , MDM_CNTR_TP_SZ Y
         WHERE  X.CNTR_TPSZ_CD = Y.CNTR_TPSZ_CD
         GROUP  BY X.PLN_YR
              , X.CNTR_TPSZ_CD
              , X.LSTM_CD
              , X.OFFH_VER_SEQ
              , X.OFFH_PLN_TP_CD
              , X.OFFH_LOC_TP_CD
              , Y.RPT_DP_SEQ
       ) XX
ORDER  BY XX.TYPE
        , XX.OFFH_RGN_LOC_CD
        , XX.LSTM_CD
        , XX.RPT_DP_SEQ			]]></sql>
			<params>
				<param name="offh_loc_tp_cd" type="12" value="" out="N"/>
				<param name="pln_yr" type="12" value="" out="N"/>
				<param name="offh_pln_tp_cd" type="12" value="" out="N"/>
				<param name="offh_ver_seq" type="2" value="" out="N"/>
				<param name="lstm_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
