<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ScenarioDefaultManageDBDAOSearchShortTermOnHireInfoRSQL">
			<desc><![CDATA[DefaultManage의 S/T On Hire 정보 조회]]></desc>
			<sql><![CDATA[
SELECT  
    MAX(DECODE(RUMM, 1,ECC_CD)) ECC_CD
    #foreach( $key in ${arrtpszcd}) 
          ,MAX(DECODE(CNTR_TPSZ_CD, '$key', AVAL_CNTR_QTY ))   ${key}AVAL_CNTR_QTY
          ,MAX(DECODE(CNTR_TPSZ_CD, '$key', LFT_CHG_AMT))      ${key}LFT_CHG_AMT
          ,MAX(DECODE(CNTR_TPSZ_CD, '$key', PKUP_CHG_CR_AMT )) ${key}PKUP_CHG_CR_AMT
          ,MAX(DECODE(CNTR_TPSZ_CD, '$key', DRYG_AMT))         ${key}DRYG_AMT
          ,MAX(DECODE(CNTR_TPSZ_CD, '$key', PD_COST_AMT))      ${key}PD_COST_AMT
          ,MAX(DECODE(CNTR_TPSZ_CD, '$key', DFLT_USD_DYS))     ${key}AVG_USD_DYS
    #end
FROM
(
  SELECT  ECC_CD
          ,CNTR_TPSZ_CD
          ,AVAL_CNTR_QTY
          ,LFT_CHG_AMT
          ,DRYG_AMT
          ,PKUP_CHG_CR_AMT
          ,PD_COST_AMT
          ,DFLT_USD_DYS
          ,UPD_USR_ID
          ,UPD_DT
          ,ROW_NUMBER() OVER (PARTITION BY ECC_CD, CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM
   FROM EQR_SHRT_TERM_ONH_COND
   WHERE 1=1

#if ($arrlocation.size() > 0) 
  AND ECC_CD IN(
  #foreach( $key in ${arrlocation}) 
    #if($velocityCount < $arrlocation.size())
    '$key',
    #else 
    '$key'
    #end
  #end
)
#end

#if ($arrtpszcd.size() > 0) 
  AND CNTR_TPSZ_CD IN(
  #foreach( $key in ${arrtpszcd})
    #if($velocityCount < $arrtpszcd.size())
    '$key',
    #else 
    '$key'
    #end
  #end
  )
#end

)
GROUP BY RUMM, ECC_CD			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
