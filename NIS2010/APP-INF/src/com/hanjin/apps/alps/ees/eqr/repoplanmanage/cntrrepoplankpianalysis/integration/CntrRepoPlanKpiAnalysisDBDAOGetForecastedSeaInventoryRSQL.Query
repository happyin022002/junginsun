<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CntrRepoPlanKpiAnalysisDBDAOGetForecastedSeaInventoryRSQL">
			<desc><![CDATA[<EES_EQR_0136 Forecasted M/B>
Weekly Sea Inventory 조회

<Change History>
1	2009.09.23	Lee ByoungHun	최초작성]]></desc>
			<sql><![CDATA[
SELECT
    A.PLN_YRWK WEEK,
    A.ECC_CD PORT,
    A.VSL_LST_PORT_CD LASTPORT,
    TO_CHAR(A.VSL_ETD_DT,'YYYY-MM-DD HH24:MI:SS') ETD,
    A.VSL_SLAN_CD LAND,
    A.VSL_CD||SKD_VOY_NO||SKD_DIR_CD  VVD,
    A.VSL_BSA_SPC BSA,
    A.VSL_RSDL_SPC REDIUALSPC,
    A.USD_VSL_RSDL_SPC USEDSPC,
    (A.VSL_RSDL_SPC - A.USD_VSL_RSDL_SPC)  UNUSEDSPC,
    DECODE (A.VSL_RSDL_SPC ,'0','0',
    ROUND((A.USD_VSL_RSDL_SPC / A.VSL_RSDL_SPC * 100 ),2)) RATION
FROM 
    EQR_USD_RSDL_SPC A
    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
    #if ($arrFmEccCd.size() > 0)
        #if (${fmtype} == 'R')
            AND RCC_CD
        #elseif (${fmtype} == 'L')
            AND LCC_CD
        #else
            AND ECC_CD
        #end
        IN(
        #foreach ($key in ${arrFmEccCd})
            #if($velocityCount < $arrFmEccCd.size())
            '$key',
            #else
            '$key'
            #end
        #end
        )) B
    #else
        ) B
    #end
WHERE
    REPO_PLN_ID =	@[repo_pln_Id]
    AND A.PLN_YRWK BETWEEN @[fmPlnYrwk]  AND @[toPlnYrwk]
    AND A.ECC_CD  = B.ECC_CD
    AND A.VSL_LST_PORT_CD <>'ZZZZZ'
    AND A.ECC_CD <> 'XXXXX'
    #if ($arrVvd.size() > 0)
        AND A.VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN(
        #foreach ($key in ${arrVvd})
            #if($velocityCount < $arrVvd.size())
            '$key',
            #else
            '$key'
            #end
        #end
        )
    #end
    #if ($arrVslSlanCd.size() > 0)
        AND A.VSL_SLAN_CD IN(
        #foreach ($key in ${arrVslSlanCd})
            #if($velocityCount < $arrVslSlanCd.size())
            '$key',
            #else
            '$key'
            #end
        #end
        )
    #end
ORDER BY WEEK ,PORT ASC			]]></sql>
			<params>
				<param name="repo_pln_Id" type="12" value="" out="N"/>
				<param name="fmPlnYrwk" type="12" value="" out="N"/>
				<param name="toPlnYrwk" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
