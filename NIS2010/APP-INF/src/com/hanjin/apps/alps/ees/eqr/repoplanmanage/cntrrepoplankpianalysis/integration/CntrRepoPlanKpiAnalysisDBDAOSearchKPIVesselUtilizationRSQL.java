/*=========================================================
*Copyright(c) 2017 CyberLogitec
*@FileName : CntrRepoPlanKpiAnalysisDBDAOSearchKPIVesselUtilizationRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2017.01.24
*@LastModifier : 
*@LastVersion : 1.0
* 2017.01.24 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.ees.eqr.repoplanmanage.cntrrepoplankpianalysis.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class CntrRepoPlanKpiAnalysisDBDAOSearchKPIVesselUtilizationRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * VESSEL 활용도 조회
	  * </pre>
	  */
	public CntrRepoPlanKpiAnalysisDBDAOSearchKPIVesselUtilizationRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_week",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fr_week",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.ees.eqr.repoplanmanage.cntrrepoplankpianalysis.integration").append("\n"); 
		query.append("FileName : CntrRepoPlanKpiAnalysisDBDAOSearchKPIVesselUtilizationRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT ''" ).append("\n"); 
		query.append("       , DECODE(A.CO_CD,'H','SML','SEN')" ).append("\n"); 
		query.append("       , A.PORT" ).append("\n"); 
		query.append("       , A.RCC" ).append("\n"); 
		query.append("       , A.TRD " ).append("\n"); 
		query.append("       , A.LANE" ).append("\n"); 
		query.append("       , A.VSL " ).append("\n"); 
		query.append("       , TO_CHAR(C.VPS_ETD_DT,'YYYY-MM-DD') VPS_ETD_DT                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("       ,(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(C.VPS_ETD_DT,'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT) YRWK                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("       , SUM(A.F_LO_20), SUM(A.F_LO_40), SUM(A.F_LO_HC), SUM(A.F_LO_45)                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("       , SUM(A.F_LO_20 + A.F_LO_40 + A.F_LO_HC + A.F_LO_45) F_LO_BOX                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("       , SUM(A.E_LO_20), SUM(A.E_LO_40), SUM(A.E_LO_HC), SUM(A.E_LO_45)                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("       , SUM(A.E_LO_20 + A.E_LO_40 + A.E_LO_HC + A.E_LO_45) E_LO_BOX                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("       , SUM(A.F_LO_20 + A.F_LO_40 + A.F_LO_HC + A.F_LO_45 + A.E_LO_20 + A.E_LO_40 + A.E_LO_HC + A.E_LO_45) LO_BOX                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("       , SUM(A.F_LO_TEU + A.E_LO_TEU) LO_TEU                                                                                                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("       , SUM(A.F_DS_20), SUM(A.F_DS_40), SUM(A.F_DS_HC), SUM(A.F_DS_45)                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("       , SUM(A.F_DS_20 + A.F_DS_40 + A.F_DS_HC + A.F_DS_45) F_DS_BOX                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("       , SUM(A.E_DS_20), SUM(A.E_DS_40), SUM(A.E_DS_HC), SUM(A.E_DS_45)                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("       , SUM(A.E_DS_20 + A.E_DS_40 + A.E_DS_HC + A.E_DS_45) E_DS_BOX                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("       , SUM(A.F_DS_20 + A.F_DS_40 + A.F_DS_HC + A.F_DS_45 + A.E_DS_20 + A.E_DS_40 + A.E_DS_HC + A.E_DS_45) DS_BOX                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("       , SUM(A.F_DS_TEU + A.E_DS_TEU) DS_TEU                                                                                                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("       , SUM(A.F_ON_20), SUM(A.F_ON_40), SUM(A.F_ON_HC), SUM(A.F_ON_45),SUM(A.F_TEU)                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("       , SUM(A.E_ON_20), SUM(A.E_ON_40), SUM(A.E_ON_HC), SUM(A.E_ON_45),SUM(A.E_TEU)                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("       , SUM(A.F_ON_20 + A.F_ON_40 + A.F_ON_HC + A.F_ON_45 + A.E_ON_20 + A.E_ON_40 + A.E_ON_HC + A.E_ON_45) BOX                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("       , SUM(A.ON_TTL_TEU)                                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("       , SUM(BSA_SPACE), SUM(BSA_WGT)                                                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("       , SUM(B.DEAD_SLOT) , SUM(B.WEIGHT_TOTAL)* 0.001                                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("       , SUM(BSA_SPACE) - (SUM(A.ON_TTL_TEU)  + SUM(B.DEAD_SLOT)) RESD_SPACE                                                                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("       , ROUND(SUM(A.F_LO_TEU)/ DECODE(SUM(BSA_SPACE),0,1,SUM(BSA_SPACE)),1) VSL_UF_SPACE                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("       , ROUND((SUM(A.F_LO_TEU) + SUM(A.E_LO_TEU) )/ DECODE(SUM(BSA_SPACE),0,1,SUM(BSA_SPACE)),1) VSL_TOT_SPACE                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("       , ROUND(((SUM(B.WEIGHT_TOTAL)* 0.001)/DECODE(SUM(BSA_WGT),0,1,SUM(BSA_WGT)))*100,1) VSL_WGT_TTL                                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("       , DECODE(SUM(A.F_LO_20 + A.F_LO_40 + A.F_LO_HC + A.F_LO_45 + A.E_LO_20 + A.E_LO_40 + A.E_LO_HC + A.E_LO_45),                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("      	        GREATEST(SUM(A.F_LO_20 + A.F_LO_40 + A.F_LO_HC + A.F_LO_45 + A.E_LO_20 + A.E_LO_40 + A.E_LO_HC + A.E_LO_45),                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("      	        SUM(A.F_DS_20 + A.F_DS_40 + A.F_DS_HC + A.F_DS_45 + A.E_DS_20 + A.E_DS_40 + A.E_DS_HC + A.E_DS_45)),                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("      	        '-'|| (GREATEST(SUM(A.F_LO_20 + A.F_LO_40 + A.F_LO_HC + A.F_LO_45 + A.E_LO_20 + A.E_LO_40 + A.E_LO_HC + A.E_LO_45),                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("      	        SUM(A.F_DS_20 + A.F_DS_40 + A.F_DS_HC + A.F_DS_45 + A.E_DS_20 + A.E_DS_40 + A.E_DS_HC + A.E_DS_45))                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("      	        /DECODE( LEAST(SUM(A.F_LO_20 + A.F_LO_40 + A.F_LO_HC + A.F_LO_45 + A.E_LO_20 + A.E_LO_40 + A.E_LO_HC + A.E_LO_45),                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("      	        SUM(A.F_DS_20 + A.F_DS_40 + A.F_DS_HC + A.F_DS_45 + A.E_DS_20 + A.E_DS_40 + A.E_DS_HC + A.E_DS_45)),0,1,                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("      	        LEAST(SUM(A.F_LO_20 + A.F_LO_40 + A.F_LO_HC + A.F_LO_45 + A.E_LO_20 + A.E_LO_40 + A.E_LO_HC + A.E_LO_45),                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("      	        SUM(A.F_DS_20 + A.F_DS_40 + A.F_DS_HC + A.F_DS_45 + A.E_DS_20 + A.E_DS_40 + A.E_DS_HC + A.E_DS_45)))),                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("      	        (GREATEST(SUM(A.F_LO_20 + A.F_LO_40 + A.F_LO_HC + A.F_LO_45 + A.E_LO_20 + A.E_LO_40 + A.E_LO_HC + A.E_LO_45),                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("      	        SUM(A.F_DS_20 + A.F_DS_40 + A.F_DS_HC + A.F_DS_45 + A.E_DS_20 + A.E_DS_40 + A.E_DS_HC + A.E_DS_45)))                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("      	        /DECODE(LEAST(SUM(A.F_LO_20 + A.F_LO_40 + A.F_LO_HC + A.F_LO_45 + A.E_LO_20 + A.E_LO_40 + A.E_LO_HC + A.E_LO_45),                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("      	        SUM(A.F_DS_20 + A.F_DS_40 + A.F_DS_HC + A.F_DS_45 + A.E_DS_20 + A.E_DS_40 + A.E_DS_HC + A.E_DS_45)),0,1,                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("      	        LEAST(SUM(A.F_LO_20 + A.F_LO_40 + A.F_LO_HC + A.F_LO_45 + A.E_LO_20 + A.E_LO_40 + A.E_LO_HC + A.E_LO_45),                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("      	        SUM(A.F_DS_20 + A.F_DS_40 + A.F_DS_HC + A.F_DS_45 + A.E_DS_20 + A.E_DS_40 + A.E_DS_HC + A.E_DS_45))))MATCH_BACK                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("FROM( SELECT  CO_CD" ).append("\n"); 
		query.append("              , PORT" ).append("\n"); 
		query.append("              , RCC" ).append("\n"); 
		query.append("              , TRD" ).append("\n"); 
		query.append("              , VSL  " ).append("\n"); 
		query.append("              , VOY" ).append("\n"); 
		query.append("              , DIR" ).append("\n"); 
		query.append("              , LANE" ).append("\n"); 
		query.append("              , STUP_FLG" ).append("\n"); 
		query.append("              , CLPT_SEQ                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("              , SUM(F_LO_20) F_LO_20 , SUM(F_LO_40) F_LO_40 , SUM(F_LO_HC) F_LO_HC , SUM(F_LO_45) F_LO_45 , SUM(F_LO_TEU) F_LO_TEU                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("              , SUM(E_LO_20) E_LO_20 , SUM(E_LO_40) E_LO_40 , SUM(E_LO_HC) E_LO_HC , SUM(E_LO_45) E_LO_45 , SUM(E_LO_TEU) E_LO_TEU                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("              , SUM(F_DS_20) F_DS_20 , SUM(F_DS_40) F_DS_40 , SUM(F_DS_HC) F_DS_HC , SUM(F_DS_45) F_DS_45 , SUM(F_DS_TEU) F_DS_TEU                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("              , SUM(E_DS_20) E_DS_20 , SUM(E_DS_40) E_DS_40 , SUM(E_DS_HC) E_DS_HC , SUM(E_DS_45) E_DS_45 , SUM(E_DS_TEU) E_DS_TEU                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("              , SUM(F_ON_20) F_ON_20 , SUM(F_ON_40) F_ON_40 , SUM(F_ON_HC) F_ON_HC , SUM(F_ON_45) F_ON_45 , SUM(F_TEU) F_TEU                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("              , SUM(E_ON_20) E_ON_20 , SUM(E_ON_40) E_ON_40 , SUM(E_ON_HC) E_ON_HC , SUM(E_ON_45) E_ON_45 , SUM(E_TEU) E_TEU                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("              , SUM(ON_TTL_TEU) ON_TTL_TEU , SUM(BSA_SPACE) BSA_SPACE, SUM(BSA_WGT) BSA_WGT  " ).append("\n"); 
		query.append("    ---LOADING ----                                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("      FROM ( SELECT /*+ USE_HASH(ML) USE_HASH(MO) */                                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("                      SP.CO_CD" ).append("\n"); 
		query.append("                    , SL.VPS_PORT_CD PORT" ).append("\n"); 
		query.append("                    , (SELECT DISTINCT RCC_CD  " ).append("\n"); 
		query.append("                       FROM MDM_EQ_ORZ_CHT  " ).append("\n"); 
		query.append("                       WHERE ECC_CD = SL.VPS_PORT_CD) RCC " ).append("\n"); 
		query.append("                    , MD.TRD TRD" ).append("\n"); 
		query.append("                    , SP.VSL_CD  VSL" ).append("\n"); 
		query.append("                    , SP.SKD_VOY_NO VOY" ).append("\n"); 
		query.append("                    , SP.SKD_DIR_CD DIR" ).append("\n"); 
		query.append("                    , SP.VSL_SLAN_CD LANE                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("                    , CL.STUP_FLG STUP_FLG" ).append("\n"); 
		query.append("                    , CLPT_SEQ CLPT_SEQ                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD , 'D2', CNTR_QTY 					                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                       	 	 	                                              , 'R2', CNTR_QTY					                                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("                         	 		                                            , 'O2', CNTR_QTY					                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("                       	 		                                              , 'F2', CNTR_QTY, 0),0)),0) F_LO_20	                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD , 'D4', CNTR_QTY   				                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("           			                                                          , 'O4', CNTR_QTY	  				                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("           			                                                          , 'F5', CNTR_QTY	  				                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("            				                                                      , 'F4', CNTR_QTY , 0),0)),0) F_LO_40	                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD , 'D5', CNTR_QTY   				                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                           	                                              , 'R5', CNTR_QTY , 0),0)),0) F_LO_HC			                                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD , 'D7', CNTR_QTY , 0),0)),0) F_LO_45                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD,'D2', CNTR_QTY*1,                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("                                                                          'D4', CNTR_QTY*2,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'D5', CNTR_QTY*2,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'D7', CNTR_QTY*2.5,                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                                                                          'O2', CNTR_QTY*1,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'O4', CNTR_QTY*2,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'R2', CNTR_QTY*1,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'R5', CNTR_QTY*2,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'F2', CNTR_QTY*1,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'F5', CNTR_QTY*2,                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'F4', CNTR_QTY*2, 0),0)),0) F_LO_TEU                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',DECODE(CNTR_TPSZ_CD , 'D2', CNTR_QTY 					                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                       	 	 	                                          , 'R2', CNTR_QTY					                                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("                         	 		                                      , 'O2', CNTR_QTY					                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("                       	 		                                          , 'F2', CNTR_QTY , 0),0)),0) E_LO_20	                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',DECODE(CNTR_TPSZ_CD , 'D4', CNTR_QTY   				                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("           			                                                      , 'O4', CNTR_QTY	  				                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("           			                                                      , 'F5', CNTR_QTY	  				                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("            				                                              , 'F4', CNTR_QTY , 0),0)),0) E_LO_40	                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',DECODE(CNTR_TPSZ_CD , 'D5', CNTR_QTY   				                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                           	                                              , 'R5', CNTR_QTY , 0),0)),0) E_LO_HC			                                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',DECODE(CNTR_TPSZ_CD , 'D7', CNTR_QTY , 0),0)),0) E_LO_45                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',CNTR_QTY * (SELECT TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV TE WHERE SP.CNTR_TPSZ_CD = TE.CNTR_TPSZ_CD  AND TE.TEU_CMPU_TP_CD ='EB'),0)), 0) E_LO_TEU                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("                    , 0 F_DS_20" ).append("\n"); 
		query.append("                    , 0 F_DS_40" ).append("\n"); 
		query.append("                    , 0 F_DS_HC" ).append("\n"); 
		query.append("                    , 0 F_DS_45" ).append("\n"); 
		query.append("                    , 0 F_DS_TEU                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("                    , 0 E_DS_20" ).append("\n"); 
		query.append("                    , 0 E_DS_40" ).append("\n"); 
		query.append("                    , 0 E_DS_HC" ).append("\n"); 
		query.append("                    , 0 E_DS_45" ).append("\n"); 
		query.append("                    , 0 E_DS_TEU                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("                    , 0 F_ON_20" ).append("\n"); 
		query.append("                    , 0 F_ON_40" ).append("\n"); 
		query.append("                    , 0 F_ON_HC" ).append("\n"); 
		query.append("                    , 0 F_ON_45" ).append("\n"); 
		query.append("                    , 0 F_TEU                                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("                    , 0 E_ON_20" ).append("\n"); 
		query.append("                    , 0 E_ON_40" ).append("\n"); 
		query.append("                    , 0 E_ON_HC" ).append("\n"); 
		query.append("                    , 0 E_ON_45" ).append("\n"); 
		query.append("                    , 0 E_TEU" ).append("\n"); 
		query.append("                    , 0 ON_TTL_TEU                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("                    ,DECODE(CL.STUP_FLG,'Y', NVL((SELECT SUM(PORT_BSA_CAPA)                                                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                                                  FROM   BSA_VVD_PORT_DWN                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("                                                  WHERE  VSL_CD       = SP.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("                                                  AND    SKD_VOY_NO   = SP.SKD_VOY_NO                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("                                                  AND    SKD_DIR_CD   = SP.SKD_DIR_CD                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("                                                  AND    PORT_CD      = SL.VPS_PORT_CD                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                                                  AND    TRD_CD       = MD.TRD " ).append("\n"); 
		query.append("                                                #if (${vvd} !=\"\")" ).append("\n"); 
		query.append("                                                  AND VSL_CD ||SKD_VOY_NO || SKD_DIR_CD IN(${vvd})" ).append("\n"); 
		query.append("                                                #end                                                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("                                                  AND    BSA_OP_JB_CD = '007'                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("                                                  AND    CRR_CD IN ('SEN','SML')                                                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                                                ),0)                                                                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                                           , NVL((SELECT SUM(SPC_CTRL_SLT_CAPA)                                                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                                                 FROM   BSA_VVD_OTR_CRR                                                                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                                                 WHERE  VSL_CD       = SP.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("                                                 AND    SKD_VOY_NO   = SP.SKD_VOY_NO                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("                                                 AND    SKD_DIR_CD   = SP.SKD_DIR_CD                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("                                                 AND    TRD_CD       = MD.TRD" ).append("\n"); 
		query.append("                                                #if(${vvd} !=\"\")" ).append("\n"); 
		query.append("                                                 AND VSL_CD ||SKD_VOY_NO || SKD_DIR_CD IN(${vvd})" ).append("\n"); 
		query.append("                                                #end                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("                                                 AND    BSA_OP_JB_CD = '007'                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("                                                 AND    CRR_CD IN ('SEN','SML')                                                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                                                ) ,0)" ).append("\n"); 
		query.append("                           ) BSA_SPACE                                                                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("                    ,DECODE(CL.STUP_FLG,'Y', NVL(( SELECT SUM(PORT_BSA_CAPA)                                                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("                                                    FROM  BSA_VVD_PORT_DWN                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("                                                    WHERE  VSL_CD       = SP.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("                                                    AND    SKD_VOY_NO   = SP.SKD_VOY_NO                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("                                                    AND    SKD_DIR_CD   = SP.SKD_DIR_CD                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("                                                    AND    PORT_CD      = SL.VPS_PORT_CD                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                                                    AND    TRD_CD       = MD.TRD" ).append("\n"); 
		query.append("                                                #if (${vvd} !=\"\")" ).append("\n"); 
		query.append("                                                    AND VSL_CD ||SKD_VOY_NO || SKD_DIR_CD IN(${vvd})" ).append("\n"); 
		query.append("                                                #end                                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                    AND    BSA_OP_JB_CD = '016'                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("                                                    AND    CRR_CD IN ('SEN','SML')                                                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                                                  ) ,0)                                                                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                                            ,NVL(( SELECT DECODE(SUM(DECODE(BSA_OP_JB_CD, '007', CRR_BSA_CAPA)),0,0,ROUND(SUM(DECODE(BSA_OP_JB_CD, '009', CRR_BSA_CAPA )) / (SUM(DECODE(BSA_OP_JB_CD, '007',  CRR_BSA_CAPA ))) *                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                                                                 SUM(DECODE(BSA_OP_JB_CD, '007', SPC_CTRL_SLT_CAPA))*1000 ,2))  CRR_BSA_CAPA                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("                                                   FROM   BSA_VVD_OTR_CRR                                                                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                                                   WHERE  VSL_CD       = SP.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("                                                   AND    SKD_VOY_NO   = SP.SKD_VOY_NO                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("                                                   AND    SKD_DIR_CD   = SP.SKD_DIR_CD                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("                                                   AND    TRD_CD       = MD.TRD" ).append("\n"); 
		query.append("                                                #if (${vvd} !=\"\")" ).append("\n"); 
		query.append("                                                   AND VSL_CD ||SKD_VOY_NO || SKD_DIR_CD IN(${vvd})" ).append("\n"); 
		query.append("                                                #end                                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                   AND    BSA_OP_JB_CD = '009'                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("                                                   AND    CRR_CD IN ('SEN','SML')                                                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                                                                                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("                            ) ,0)) BSA_WGT                                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("             FROM EQR_SEA_INVT_SNAP_POL SP" ).append("\n"); 
		query.append("                , VSK_VSL_PORT_SKD SL " ).append("\n"); 
		query.append("                , MDM_LOCATION ML" ).append("\n"); 
		query.append("                , MDM_LOCATION MO                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("                , COA_LANE_RGST CL" ).append("\n"); 
		query.append("                , COA_MON_VVD CM " ).append("\n"); 
		query.append("                ,( SELECT DISTINCT RLANE_CD LANE" ).append("\n"); 
		query.append("                         , VSL_SLAN_DIR_CD DIR" ).append("\n"); 
		query.append("                         , FM_CONTI_CD CONTI" ).append("\n"); 
		query.append("                         , TO_CONTI_CD CONTI1" ).append("\n"); 
		query.append("                         , TRD_CD TRD                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                  FROM MDM_DTL_REV_LANE A                                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                  WHERE   A.DELT_FLG ='N'                                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                  AND SUB_TRD_CD NOT IN ('IP')                                                                                                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("                 ) MD                                                                                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("             WHERE  SNAP_DT =  TO_CHAR((SL.VPS_ETD_DT+0.99999) +1,'YYYYMMDD')                                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("             AND SL.VPS_ETD_DT " ).append("\n"); 
		query.append("             BETWEEN                                                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("              (SELECT TO_DATE(WK_ST_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fr_week])  		                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("             AND" ).append("\n"); 
		query.append("             (SELECT TO_DATE(WK_END_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_week])                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("             AND SP.VSL_CD           = SL.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("             AND SP.SKD_VOY_NO       = SL.SKD_VOY_NO                                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("             AND SP.SKD_DIR_CD       = SL.SKD_DIR_CD                                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("             AND SP.VSL_SLAN_CD      = SL.SLAN_CD                                                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("             AND SP.FM_ECC_CD        = SL.VPS_PORT_CD                                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("             AND SP.SKD_DIR_CD       = MD.DIR                                                                                                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("             AND SL.VPS_PORT_CD      = ML.LOC_CD                                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("             AND DECODE(SUBSTR(MD.LANE,1,3),'MIX',DECODE(ML.CONTI_CD,'F','E',ML.CONTI_CD),  ML.CONTI_CD)  = MD.CONTI                                                                                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("             AND DECODE(SUBSTR(MD.LANE,1,3),'MIX',DECODE(MO.CONTI_CD,'F','E',MO.CONTI_CD), MO.CONTI_CD)  = MD.CONTI1                                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("             AND SP.TO_ECC_CD  = MO.LOC_CD                                                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("             AND MD.LANE = CL.RLANE_CD                                                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("             AND MD.DIR = CL.DIR_CD                                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("             AND MD.TRD = CL.TRD_CD                                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("             AND MD.LANE = CM.RLANE_CD                                                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("             AND MD.TRD = CM.TRD_CD                                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("             AND SP.VSL_CD      = CM.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("             AND SP.SKD_VOY_NO  = CM.SKD_VOY_NO                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("             AND SP.SKD_DIR_CD  = CM.DIR_CD                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("             AND SUBSTR(MD.LANE,1,3)     = SL.SLAN_CD                                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("             AND CL.VSL_LANE_TP_CD IN ('SC','JO')                                                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("             AND  NVL(CM.DELT_FLG,'N') <> 'Y'" ).append("\n"); 
		query.append("         #if (${vvd} !=\"\")" ).append("\n"); 
		query.append("             AND SP.VSL_CD ||SP.SKD_VOY_NO || SP.SKD_DIR_CD IN(${vvd})" ).append("\n"); 
		query.append("         #end                                                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("              GROUP BY  SP.CO_CD" ).append("\n"); 
		query.append("                        , SL.VPS_PORT_CD" ).append("\n"); 
		query.append("                        , MD.TRD" ).append("\n"); 
		query.append("                        , SP.VSL_CD" ).append("\n"); 
		query.append("                        , SP.SKD_VOY_NO" ).append("\n"); 
		query.append("                        , SP.SKD_DIR_CD" ).append("\n"); 
		query.append("                        , SP.VSL_SLAN_CD" ).append("\n"); 
		query.append("                        , CL.STUP_FLG " ).append("\n"); 
		query.append("                        , CLPT_SEQ                                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("          ---DISCHARGING                                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("          UNION ALL                                                                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("          SELECT /*+ USE_HASH(ML) USE_HASH(MO) */                                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("                    SP.CO_CD" ).append("\n"); 
		query.append("                  , SL.VPS_PORT_CD PORT" ).append("\n"); 
		query.append("                  , (SELECT DISTINCT RCC_CD  " ).append("\n"); 
		query.append("                     FROM MDM_EQ_ORZ_CHT  " ).append("\n"); 
		query.append("                     WHERE ECC_CD = SL.VPS_PORT_CD) RCC" ).append("\n"); 
		query.append("                  , MD.TRD TRD" ).append("\n"); 
		query.append("                  , SP.VSL_CD  VSL" ).append("\n"); 
		query.append("                  , SP.SKD_VOY_NO VOY" ).append("\n"); 
		query.append("                  , SP.SKD_DIR_CD DIR" ).append("\n"); 
		query.append("                  , SP.VSL_SLAN_CD LANE                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("                  , CL.STUP_FLG STUP_FLG                                                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("                  , CLPT_SEQ CLPT_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                  , 0 F_LO_20" ).append("\n"); 
		query.append("                  , 0 F_LO_40" ).append("\n"); 
		query.append("                  , 0 F_LO_HC" ).append("\n"); 
		query.append("                  , 0 F_LO_45" ).append("\n"); 
		query.append("                  , 0 F_LO_TEU                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("                  , 0 E_LO_20" ).append("\n"); 
		query.append("                  , 0 E_LO_40" ).append("\n"); 
		query.append("                  , 0 E_LO_HC" ).append("\n"); 
		query.append("                  , 0 E_LO_45" ).append("\n"); 
		query.append("                  , 0 E_LO_TEU                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("                  , NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD , 'D2', CNTR_QTY 					                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                       	 	 	                                             , 'R2', CNTR_QTY					                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("                         	 	  	                                         , 'O2', CNTR_QTY					                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                       	 		                                             , 'F2', CNTR_QTY, 0),0)),0) F_DS_20	                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                  , NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD , 'D4', CNTR_QTY   				                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("           			                                                         , 'O4', CNTR_QTY	  				                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("           			                                                         , 'F5', CNTR_QTY	  				                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("            				                                                     , 'F4', CNTR_QTY , 0),0)),0) F_DS_40	                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                  ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD  , 'D5', CNTR_QTY   				                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                           	                                             , 'R5', CNTR_QTY , 0),0)),0) F_DS_HC			                                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                  ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD  , 'D7', CNTR_QTY , 0),0)),0) F_DS_45                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                  ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD,'D2', CNTR_QTY*1,                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("                                                                        'D4', CNTR_QTY*2,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                        'D5', CNTR_QTY*2,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                        'D7', CNTR_QTY*2.5,                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                                                                        'O2', CNTR_QTY*1,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                        'O4', CNTR_QTY*2,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                        'R2', CNTR_QTY*1,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                        'R5', CNTR_QTY*2,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                        'F2', CNTR_QTY*1,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                        'F5', CNTR_QTY*2,                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                        'F4', CNTR_QTY*2, 0),0)),0) F_DS_TEU                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                  ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',DECODE(CNTR_TPSZ_CD , 'D2', CNTR_QTY 					                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                       	 	 	                                            , 'R2', CNTR_QTY	 " ).append("\n"); 
		query.append("                       	 	 	                                            , 'O2', CNTR_QTY " ).append("\n"); 
		query.append("                       	 	 	                                            , 'F2', CNTR_QTY , 0),0)),0) E_DS_20	                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("                  ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',DECODE(CNTR_TPSZ_CD , 'D4', CNTR_QTY   				                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("            			                                                      , 'O4', CNTR_QTY	 " ).append("\n"); 
		query.append("            			                                                      , 'F4', CNTR_QTY " ).append("\n"); 
		query.append("            			                                                      , 'F5', CNTR_QTY, 0),0)),0) E_DS_40	                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("                  ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',DECODE(CNTR_TPSZ_CD , 'D5', CNTR_QTY " ).append("\n"); 
		query.append("                                                                        , 'R5', CNTR_QTY , 0),0)),0) E_DS_HC			                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                  ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',DECODE(CNTR_TPSZ_CD , 'D7', CNTR_QTY , 0),0)),0) E_DS_45                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                  ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N', CNTR_QTY * (SELECT TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV TE WHERE SP.CNTR_TPSZ_CD = TE.CNTR_TPSZ_CD  AND TE.TEU_CMPU_TP_CD ='EB'),0)), 0) E_DS_TEU                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                  , 0 F_ON_20" ).append("\n"); 
		query.append("                  , 0 F_ON_40" ).append("\n"); 
		query.append("                  , 0 F_ON_HC" ).append("\n"); 
		query.append("                  , 0 F_ON_45" ).append("\n"); 
		query.append("                  , 0 F_TEU                                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("                  , 0 E_ON_20" ).append("\n"); 
		query.append("                  , 0 E_ON_40" ).append("\n"); 
		query.append("                  , 0 E_ON_HC" ).append("\n"); 
		query.append("                  , 0 E_ON_45" ).append("\n"); 
		query.append("                  , 0 E_TEU" ).append("\n"); 
		query.append("                  , 0 ON_TTL_TEU                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("                  , 0 BSA_SPACE" ).append("\n"); 
		query.append("                  , 0 BSA_WGT                                                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("          FROM EQR_SEA_INVT_SNAP_POL SP" ).append("\n"); 
		query.append("              , VSK_VSL_PORT_SKD SL " ).append("\n"); 
		query.append("              , MDM_LOCATION ML                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("              , MDM_LOCATION MO                                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("              , COA_LANE_RGST CL" ).append("\n"); 
		query.append("              , COA_MON_VVD CM" ).append("\n"); 
		query.append("              , (SELECT DISTINCT RLANE_CD LANE" ).append("\n"); 
		query.append("                          , VSL_SLAN_DIR_CD DIR" ).append("\n"); 
		query.append("                          , FM_CONTI_CD CONTI" ).append("\n"); 
		query.append("                          , TO_CONTI_CD CONTI1" ).append("\n"); 
		query.append("                          ,TRD_CD TRD                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                 FROM MDM_DTL_REV_LANE A                                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                 WHERE   A.DELT_FLG ='N'                                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                 AND SUB_TRD_CD NOT IN ('IP')                                                                                                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("                ) MD                                                                                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("          WHERE  SNAP_DT =  TO_CHAR((SL.VPS_ETA_DT+0.99999) ,'YYYYMMDD')                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("          AND SL.VPS_ETA_DT " ).append("\n"); 
		query.append("              BETWEEN                                                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("               (SELECT TO_DATE(WK_ST_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fr_week])  		                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("              AND	" ).append("\n"); 
		query.append("               (SELECT TO_DATE(WK_END_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_week])                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("          AND SP.VSL_CD           = SL.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("          AND SP.SKD_VOY_NO       = SL.SKD_VOY_NO                                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("          AND SP.SKD_DIR_CD       = SL.SKD_DIR_CD                                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("          AND SP.VSL_SLAN_CD      = SL.SLAN_CD                                                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("          AND SP.TO_ECC_CD        = SL.VPS_PORT_CD                                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("          AND SP.SKD_DIR_CD       = MD.DIR                                                                                                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("          AND SL.VPS_PORT_CD      = ML.LOC_CD                                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("          AND DECODE(SUBSTR(MD.LANE,1,3),'MIX',DECODE(ML.CONTI_CD,'F','E',ML.CONTI_CD), ML.CONTI_CD) = MD.CONTI                                                                                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("          AND DECODE(SUBSTR(MD.LANE,1,3),'MIX',DECODE(MO.CONTI_CD,'F','E',MO.CONTI_CD), MO.CONTI_CD) = MD.CONTI1                                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("          AND SP.TO_ECC_CD  = MO.LOC_CD                                                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("          AND MD.LANE = CL.RLANE_CD                                                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("          AND MD.DIR = CL.DIR_CD                                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("          AND MD.TRD = CL.TRD_CD                                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("          AND MD.LANE = CM.RLANE_CD                                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("          AND MD.TRD = CM.TRD_CD                                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("          AND SP.VSL_CD      = CM.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("          AND SP.SKD_VOY_NO  = CM.SKD_VOY_NO                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("          AND SP.SKD_DIR_CD  = CM.DIR_CD                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("          AND CL.VSL_LANE_TP_CD IN ('SC','JO')                                                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("          AND SUBSTR(MD.LANE,1,3)     = SL.SLAN_CD                                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("          AND  NVL(CM.DELT_FLG,'N') <> 'Y' " ).append("\n"); 
		query.append("       #if (${vvd} !=\"\")" ).append("\n"); 
		query.append("          AND SP.VSL_CD ||SP.SKD_VOY_NO || SP.SKD_DIR_CD IN(${vvd})" ).append("\n"); 
		query.append("         #end                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("          GROUP BY   SP.CO_CD" ).append("\n"); 
		query.append("                   , SL.VPS_PORT_CD" ).append("\n"); 
		query.append("                   , MD.TRD" ).append("\n"); 
		query.append("                   , SP.VSL_CD" ).append("\n"); 
		query.append("                   , SP.SKD_VOY_NO" ).append("\n"); 
		query.append("                   , SP.SKD_DIR_CD" ).append("\n"); 
		query.append("                   , SP.VSL_SLAN_CD" ).append("\n"); 
		query.append("                   , CL.STUP_FLG " ).append("\n"); 
		query.append("                   , CLPT_SEQ                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("          UNION ALL                                                                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("          -- ON BOARD --                                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("          SELECT  AA.CO_CD" ).append("\n"); 
		query.append("                , BB.VPS_PORT_CD PORT" ).append("\n"); 
		query.append("                , (SELECT DISTINCT RCC_CD  FROM MDM_EQ_ORZ_CHT  WHERE ECC_CD = BB.VPS_PORT_CD) RCC" ).append("\n"); 
		query.append("                , AA.TRD TRD" ).append("\n"); 
		query.append("                , AA.VSL VSL" ).append("\n"); 
		query.append("                , AA.VOY VOY" ).append("\n"); 
		query.append("                , AA.DIR DIR" ).append("\n"); 
		query.append("                , AA.LANE LANE" ).append("\n"); 
		query.append("                , AA.STUP_FLG STUP_FLG" ).append("\n"); 
		query.append("                , BB.CLPT_SEQ CLPT_SEQ                                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("                , 0 F_LO_20" ).append("\n"); 
		query.append("                , 0 F_LO_40" ).append("\n"); 
		query.append("                , 0 F_LO_HC" ).append("\n"); 
		query.append("                , 0 F_LO_45" ).append("\n"); 
		query.append("                , 0 F_LO_TEU                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                , 0 E_LO_20" ).append("\n"); 
		query.append("                , 0 E_LO_40" ).append("\n"); 
		query.append("                , 0 E_LO_HC" ).append("\n"); 
		query.append("                , 0 E_LO_45" ).append("\n"); 
		query.append("                , 0 E_LO_TEU                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                , 0 F_DS_20" ).append("\n"); 
		query.append("                , 0 F_DS_40" ).append("\n"); 
		query.append("                , 0 F_DS_HC" ).append("\n"); 
		query.append("                , 0 F_DS_45" ).append("\n"); 
		query.append("                , 0 F_DS_TEU                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                , 0 E_DS_20" ).append("\n"); 
		query.append("                , 0 E_DS_40" ).append("\n"); 
		query.append("                , 0 E_DS_HC" ).append("\n"); 
		query.append("                , 0 E_DS_45" ).append("\n"); 
		query.append("                , 0 E_DS_TEU                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                , SUM(AA.F_ON_20) F_ON_20" ).append("\n"); 
		query.append("                , SUM(AA.F_ON_40) F_ON_40" ).append("\n"); 
		query.append("                , SUM(AA.F_ON_HC) F_ON_HC" ).append("\n"); 
		query.append("                , SUM(AA.F_ON_45) F_ON_45" ).append("\n"); 
		query.append("                , SUM(AA.F_TEU) F_TEU                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("                , SUM(AA.E_ON_20) E_ON_20" ).append("\n"); 
		query.append("                , SUM(AA.E_ON_40) E_ON_40" ).append("\n"); 
		query.append("                , SUM(AA.E_ON_HC) E_ON_HC" ).append("\n"); 
		query.append("                , SUM(AA.E_ON_45) E_ON_45" ).append("\n"); 
		query.append("                , SUM(AA.E_TEU) E_TEU                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("                , SUM(AA.E_TEU + AA.F_TEU) ON_TTL_TEU                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("                , 0 BSA_SPACE, 0 BSA_WGT                                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("          FROM (SELECT /*+ USE_HASH(ML) USE_HASH(MO) FULL(SP) */ " ).append("\n"); 
		query.append("                     SP.CO_CD" ).append("\n"); 
		query.append("                     , SP.VSL_CD VSL" ).append("\n"); 
		query.append("                     , SP.SKD_VOY_NO VOY" ).append("\n"); 
		query.append("                     , SP.SKD_DIR_CD DIR" ).append("\n"); 
		query.append("                     , SP.FM_ECC_CD FM_LOC" ).append("\n"); 
		query.append("                     , MAX(SL.CLPT_SEQ) FM_SEQ" ).append("\n"); 
		query.append("                     , SP.TO_ECC_CD TO_LOC" ).append("\n"); 
		query.append("                     , MIN(SD.CLPT_SEQ) TO_SEQ                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("                     , SP.VSL_SLAN_CD LANE                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("                     , MD.TRD TRD                                                                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                     , CL.STUP_FLG STUP_FLG                                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("                     ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD , 'D2', CNTR_QTY                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                              	 	 	                                       , 'R2', CNTR_QTY					                                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                                 	 	                                       , 'O2', CNTR_QTY					                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                               	 		                                       , 'F2', CNTR_QTY, 0),0)),0) F_ON_20	                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                     ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD , 'D4', CNTR_QTY   				                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("                   			                                                   , 'O4', CNTR_QTY	  				                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                   			                                                   , 'F5', CNTR_QTY	  				                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                    				                                               , 'F4', CNTR_QTY , 0),0)),0) F_ON_40	                                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD  , 'D5', CNTR_QTY   				                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("                                   	                                       , 'R5', CNTR_QTY , 0),0)),0) F_ON_HC			                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD  , 'D7', CNTR_QTY , 0),0)),0) F_ON_45                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                    ,NVL(SUM(DECODE(CNTR_FULL_FLG,'Y',DECODE(CNTR_TPSZ_CD,'D2', CNTR_QTY*1,                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                                                                          'D4', CNTR_QTY*2,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'D5', CNTR_QTY*2,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'D7', CNTR_QTY*2.5,                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("                                                                          'O2', CNTR_QTY*1,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'O4', CNTR_QTY*2,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'R2', CNTR_QTY*1,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'R5', CNTR_QTY*2,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'F2', CNTR_QTY*1,                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'F5', CNTR_QTY*2,                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                                                                          'F4', CNTR_QTY*2, 0),0)),0) F_TEU                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("                   ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',DECODE(CNTR_TPSZ_CD , 'D2', CNTR_QTY 					                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                               	 	 	                                     , 'R2', CNTR_QTY					                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("                                 	 		                                   , 'O2', CNTR_QTY					                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                               	 		                                     , 'F2', CNTR_QTY , 0),0)),0) E_ON_20	                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                   ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',DECODE(CNTR_TPSZ_CD , 'D4', CNTR_QTY   				                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                                                                         , 'O4', CNTR_QTY	  				                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("           			                                                         , 'F5', CNTR_QTY	  				                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("                    				                                             , 'F4', CNTR_QTY , 0),0)),0) E_ON_40	                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("                   ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',DECODE(CNTR_TPSZ_CD , 'D5', CNTR_QTY   				                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                                   	                                     , 'R5', CNTR_QTY , 0),0)),0) E_ON_HC			                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("                   ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N',DECODE(CNTR_TPSZ_CD , 'D7', CNTR_QTY , 0),0)),0) E_ON_45                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("                   ,NVL(SUM(DECODE(CNTR_FULL_FLG,'N', CNTR_QTY * (SELECT TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV TE WHERE SP.CNTR_TPSZ_CD = TE.CNTR_TPSZ_CD  AND TE.TEU_CMPU_TP_CD ='EB'),0)), 0) E_TEU                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("                   ,NVL(SUM(CNTR_QTY * (SELECT TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV TE WHERE SP.CNTR_TPSZ_CD = TE.CNTR_TPSZ_CD  AND TE.TEU_CMPU_TP_CD ='EB')), 0) ON_TTL_TEU                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("               FROM EQR_SEA_INVT_SNAP_POL SP" ).append("\n"); 
		query.append("                   , VSK_VSL_PORT_SKD SL" ).append("\n"); 
		query.append("                   , VSK_VSL_PORT_SKD SD" ).append("\n"); 
		query.append("                   , MDM_LOCATION ML " ).append("\n"); 
		query.append("                   , MDM_LOCATION MO" ).append("\n"); 
		query.append("                   , COA_LANE_RGST CL" ).append("\n"); 
		query.append("                   , COA_MON_VVD CM" ).append("\n"); 
		query.append("                   , (SELECT DISTINCT RLANE_CD LANE" ).append("\n"); 
		query.append("                               , VSL_SLAN_DIR_CD DIR" ).append("\n"); 
		query.append("                               , FM_CONTI_CD CONTI" ).append("\n"); 
		query.append("                               , TO_CONTI_CD CONTI1" ).append("\n"); 
		query.append("                               , TRD_CD TRD                                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("                      FROM MDM_DTL_REV_LANE A                                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("                      WHERE   A.DELT_FLG ='N'                                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("                      AND SUB_TRD_CD NOT IN ('IP')                                                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("                     ) MD                                                                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("              WHERE  SNAP_DT =  TO_CHAR((SL.VPS_ETD_DT+0.99999) +1,'YYYYMMDD')                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("              AND SL.VPS_ETD_DT " ).append("\n"); 
		query.append("              BETWEEN                                                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("                  (SELECT TO_DATE(WK_ST_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fr_week])  		                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("              AND	" ).append("\n"); 
		query.append("                  (SELECT TO_DATE(WK_END_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_week])                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("              AND SP.VSL_CD           = SL.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("              AND SP.SKD_VOY_NO       = SL.SKD_VOY_NO                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("              AND SP.SKD_DIR_CD       = SL.SKD_DIR_CD                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("              AND SP.FM_ECC_CD        = SL.VPS_PORT_CD                                                                                                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("              AND SP.VSL_CD           = SD.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("              AND SP.SKD_VOY_NO       = SD.SKD_VOY_NO                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("              AND SP.SKD_DIR_CD       = SD.SKD_DIR_CD                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("              AND SP.TO_ECC_CD        = SD.VPS_PORT_CD                                                                                                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("              AND SP.SKD_DIR_CD       = MD.DIR                                                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("              AND SL.SKD_DIR_CD       = MD.DIR                                                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("              AND SP.FM_ECC_CD        = ML.LOC_CD                                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("              AND SP.TO_ECC_CD        = MO.LOC_CD                                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("              AND DECODE(SUBSTR(MD.LANE,1,3),'MIX',DECODE(ML.CONTI_CD,'F','E',ML.CONTI_CD), ML.CONTI_CD)  = MD.CONTI                                                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("              AND DECODE(SUBSTR(MD.LANE,1,3),'MIX',DECODE(MO.CONTI_CD,'F','E',MO.CONTI_CD), MO.CONTI_CD)  = MD.CONTI1                                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("              AND MD.LANE = CL.RLANE_CD                                                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("              AND MD.DIR = CL.DIR_CD                                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("              AND MD.TRD = CL.TRD_CD                                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("              AND MD.LANE = CM.RLANE_CD                                                                                                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("              AND MD.TRD = CM.TRD_CD                                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("              AND SP.VSL_CD      = CM.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("              AND SP.SKD_VOY_NO  = CM.SKD_VOY_NO                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("              AND SP.SKD_DIR_CD  = CM.DIR_CD                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("              AND CL.VSL_LANE_TP_CD IN ('SC','JO')                                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("              AND SUBSTR(MD.LANE,1,3) = SP.VSL_SLAN_CD                                                                                                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("              AND  NVL(CM.DELT_FLG,'N') <> 'Y'" ).append("\n"); 
		query.append("         #if (${vvd} !=\"\")" ).append("\n"); 
		query.append("              AND SP.VSL_CD ||SP.SKD_VOY_NO || SP.SKD_DIR_CD IN(${vvd})" ).append("\n"); 
		query.append("         #end                                                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("             GROUP BY  SP.CO_CD" ).append("\n"); 
		query.append("                      , SP.VSL_CD" ).append("\n"); 
		query.append("                      , SP.SKD_VOY_NO" ).append("\n"); 
		query.append("                      , SP.SKD_DIR_CD" ).append("\n"); 
		query.append("                      , SP.FM_ECC_CD" ).append("\n"); 
		query.append("                      , SP.TO_ECC_CD " ).append("\n"); 
		query.append("                      , SP.VSL_SLAN_CD" ).append("\n"); 
		query.append("                      , MD.TRD " ).append("\n"); 
		query.append("                      , CL.STUP_FLG                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("          )AA" ).append("\n"); 
		query.append("          , VSK_VSL_PORT_SKD BB                                                                                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("          WHERE BB.VPS_ETD_DT " ).append("\n"); 
		query.append("          BETWEEN                                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("             (SELECT TO_DATE(WK_ST_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fr_week])  		                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append("          AND	" ).append("\n"); 
		query.append("             (SELECT TO_DATE(WK_END_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_week])                                                                                                                                                                                                                                                                                                                                               " ).append("\n"); 
		query.append("          AND AA.VSL = BB.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("          AND AA.VOY = BB.SKD_VOY_NO                                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("          AND AA.DIR = BB.SKD_DIR_CD                                                                                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("          AND AA.FM_SEQ <= BB.CLPT_SEQ                                                                                                                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("          AND BB.CLPT_SEQ < AA.TO_SEQ                                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("          AND BB.VPS_PORT_CD NOT IN ('EGSUZ','PAPAC')                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("          AND nvl(BB.SKD_CNG_STS_CD, 'S') <> 'S'                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("          GROUP BY   AA.CO_CD " ).append("\n"); 
		query.append("                   , BB.VPS_PORT_CD" ).append("\n"); 
		query.append("                   , AA.TRD " ).append("\n"); 
		query.append("                   , AA.VSL" ).append("\n"); 
		query.append("                   , AA.VOY" ).append("\n"); 
		query.append("                   , AA.DIR" ).append("\n"); 
		query.append("                   , AA.LANE" ).append("\n"); 
		query.append("                   , AA.STUP_FLG" ).append("\n"); 
		query.append("                   , BB.CLPT_SEQ                                                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("    )                                                                                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("    GROUP BY CO_CD" ).append("\n"); 
		query.append("             , PORT" ).append("\n"); 
		query.append("             , RCC" ).append("\n"); 
		query.append("             , TRD" ).append("\n"); 
		query.append("             , VSL" ).append("\n"); 
		query.append("             , VOY" ).append("\n"); 
		query.append("             , DIR" ).append("\n"); 
		query.append("             , LANE" ).append("\n"); 
		query.append("             , STUP_FLG" ).append("\n"); 
		query.append("             , CLPT_SEQ                                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("  ) A                                                                                                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("  , ( SELECT  VSL" ).append("\n"); 
		query.append("             , VOY" ).append("\n"); 
		query.append("             , DIR" ).append("\n"); 
		query.append("             , POL" ).append("\n"); 
		query.append("             , SUM(DEAD_SLOT) DEAD_SLOT" ).append("\n"); 
		query.append("             , SUM(NVL(CNTR_WGT,0)) WEIGHT_TOTAL                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("      FROM ( SELECT /*+ INDEX(BK XAK4BKG_BOOKING) */ " ).append("\n"); 
		query.append("                    BV.VSL_CD VSL" ).append("\n"); 
		query.append("                    , BV.SKD_VOY_NO VOY" ).append("\n"); 
		query.append("                    , BV.SKD_DIR_CD DIR" ).append("\n"); 
		query.append("                    , BV.POL_CD POL                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("          	        ,NVL(DECODE(BK.BKG_CGO_TP_CD,'F',(DECODE(BC.CNTR_TPSZ_CD,'D5',1,'R5',1,0)),                                                                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("          	                                     'P',(DECODE(BC.CNTR_TPSZ_CD,'D5',1,'R5',1,0)),                                                                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("          	                                         (DECODE(BC.AWK_CGO_FLG,'Y',1,0))),0) DEAD_SLOT                                                                                                                                                                                                                                                                                                                                             " ).append("\n"); 
		query.append("          	        ,BC.CNTR_WGT CNTR_WGT                                                                                                                                                                                                                                                                                                                                                                                                                 " ).append("\n"); 
		query.append("             FROM BKG_VVD BV, BKG_BOOKING BK, BKG_CONTAINER BC, VSK_VSL_PORT_SKD VS                                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("             WHERE  VS.VPS_ETD_DT" ).append("\n"); 
		query.append("             BETWEEN                                                                                                                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("                   (SELECT TO_DATE(WK_ST_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fr_week])  		                                                                                                                                                                                                                                                                                                                                            " ).append("\n"); 
		query.append("             AND" ).append("\n"); 
		query.append("                   (SELECT TO_DATE(WK_END_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_week])                                                                                                                                                                                                                                                                                                                                           " ).append("\n"); 
		query.append("             AND BV.VSL_CD     = BK.VSL_CD 								                                                                                                                                                                                                                                                                                                                                                                                          " ).append("\n"); 
		query.append("             AND BV.SKD_VOY_NO   = BK.SKD_VOY_NO						                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("             AND BV.SKD_DIR_CD   = BK.SKD_DIR_CD 	                                                                                                                                                                                                                                                                                                                                                                                                  " ).append("\n"); 
		query.append("             AND BV.POL_CD   = BK.POL_CD                                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("             AND BV.BKG_NO       = BK.BKG_NO 								                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("             AND BV.BKG_NO       = BC.BKG_NO 								                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("             AND BV.VSL_CD       = VS.VSL_CD 								                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("             AND BV.SKD_VOY_NO   = VS.SKD_VOY_NO 						                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("             AND BV.SKD_DIR_CD   = VS.SKD_DIR_CD                                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("             AND BV.SLAN_CD      = VS.SLAN_CD                                                                                                                                                                                                                                                                                                                                                                                                       " ).append("\n"); 
		query.append("             AND BK.BKG_STS_CD IN ('F','S')                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("             AND BV.POL_CD       = VS.VPS_PORT_CD" ).append("\n"); 
		query.append("            #if (${vvd} !=\"\")" ).append("\n"); 
		query.append("             AND BV.VSL_CD ||BV.SKD_VOY_NO || BV.SKD_DIR_CD IN(${vvd})" ).append("\n"); 
		query.append("            #end                                                                                                                                                                                                                                                                                                                                                                                                      " ).append("\n"); 
		query.append("      )                                                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("       GROUP BY  VSL" ).append("\n"); 
		query.append("                , VOY" ).append("\n"); 
		query.append("                , DIR" ).append("\n"); 
		query.append("                , POL                                                                                                                                                                                                                                                                                                                                                                                                              " ).append("\n"); 
		query.append("  ) B, VSK_VSL_PORT_SKD C                                                                                                                                                                                                                                                                                                                                                                                                                        " ).append("\n"); 
		query.append("  WHERE  C.VPS_ETD_DT " ).append("\n"); 
		query.append("  BETWEEN                                                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("     (SELECT TO_DATE(WK_ST_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fr_week])  		                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("  AND" ).append("\n"); 
		query.append("    	(SELECT TO_DATE(WK_END_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_week])                                                                                                                                                                                                                                                                                                                                                   " ).append("\n"); 
		query.append("  AND A.VSL   = B.VSL(+)                                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("  AND A.PORT  = B.POL(+)                                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("  AND A.VSL   = C.VSL_CD                                                                                                                                                                                                                                                                                                                                                                                                                         " ).append("\n"); 
		query.append("  AND A.PORT  = C.VPS_PORT_CD                                                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("  AND A.CLPT_SEQ = C.CLPT_SEQ                                                                                                                                                                                                                                                                                                                                                                                                                    " ).append("\n"); 
		query.append("  AND C.VPS_PORT_CD NOT IN ('EGSUZ','PAPAC')                                                                                                                                                                                                                                                                                                                                                                                                     " ).append("\n"); 
		query.append("  AND NVL(C.SKD_CNG_STS_CD, 'S') <> 'S'" ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("#if (${loccd} != \"\")" ).append("\n"); 
		query.append("  #if(${loctype} == \"R\")" ).append("\n"); 
		query.append("  AND A.PORT IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE RCC_CD IN (${loccd}))  " ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  #if(${loctype} == \"L\")" ).append("\n"); 
		query.append("  AND A.PORT IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE LCC_CD IN (${loccd}))  " ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  #if(${loctype} == \"E\")" ).append("\n"); 
		query.append("  AND A.PORT IN (${loccd})  " ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} !=\"\")" ).append("\n"); 
		query.append("  AND A.LANE IN(${lane})" ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("#if (${trade} !=\"\")" ).append("\n"); 
		query.append("  AND A.TRD IN(${trade})" ).append("\n"); 
		query.append("#end                                                                                                                                                                                                                                                                                                                                                                                                                " ).append("\n"); 
		query.append(" GROUP BY  A.CO_CD" ).append("\n"); 
		query.append("           , A.PORT" ).append("\n"); 
		query.append("           , A.RCC" ).append("\n"); 
		query.append("           , A.TRD" ).append("\n"); 
		query.append("           , A.VSL" ).append("\n"); 
		query.append("           , A.STUP_FLG" ).append("\n"); 
		query.append("           , A.LANE" ).append("\n"); 
		query.append("           , C.VPS_ETD_DT" ).append("\n"); 

	}
}