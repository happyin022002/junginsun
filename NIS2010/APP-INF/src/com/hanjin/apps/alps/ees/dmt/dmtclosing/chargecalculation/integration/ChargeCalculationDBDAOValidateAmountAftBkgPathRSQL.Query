<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChargeCalculationDBDAOValidateAmountAftBkgPathRSQL">
			<desc><![CDATA[ChargeCalculationDBDAOValidateAmountAftBkgPath]]></desc>
			<sql><![CDATA[
SELECT NVL(MAX(AMT_FLG), 'N') AMT_FLG
	FROM (
	SELECT 'E' AMT_FLG FROM DMT_AFT_BKG_PATH_OFC_STUP
	WHERE RHQ_CD = @[rhq_cd]
	AND DELT_FLG = 'N'
	AND NVL(OFC_CD,'A') = NVL(@[ofc_cd], 'A')
	AND (
        TO_DATE(@[eff_dt], 'YYYYMMDD') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('99991231','YYYYMMDD') + 0.99999)
        OR NVL(TO_DATE(@[exp_dt], 'YYYYMMDD'), TO_DATE('99991231','YYYYMMDD')) + 0.99999 BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('99991231','YYYYMMDD') + 0.99999)
        )
	AND NVL(TO_NUMBER(@[fm_dc_amt]), -999999999999) BETWEEN NVL(FM_DC_AMT, -999999999999) AND NVL(TO_DC_AMT, 999999999999)
#if(${ibflag}=='U' && ${update_seq_list} != '')
	AND AFT_BKG_PATH_STUP_SEQ NOT IN(
	#foreach( $update_seq in ${update_seq_list} )
		#if($velocityCount < $update_seq_list.size()) '$update_seq', #else '$update_seq' #end
	#end	
	)
#end

	UNION ALL

	SELECT 'E' AMT_FLG FROM DMT_AFT_BKG_PATH_OFC_STUP
	WHERE RHQ_CD = @[rhq_cd]
	AND DELT_FLG = 'N'
	AND NVL(OFC_CD,'A') = NVL(@[ofc_cd], 'A')
	AND (
        TO_DATE(@[eff_dt], 'YYYYMMDD') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('99991231','YYYYMMDD') + 0.99999)
        OR NVL(TO_DATE(@[exp_dt], 'YYYYMMDD'), TO_DATE('99991231','YYYYMMDD')) + 0.99999 BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('99991231','YYYYMMDD') + 0.99999)
        )
	AND NVL(TO_NUMBER(@[to_dc_amt]), 999999999999) BETWEEN NVL(FM_DC_AMT, -999999999999) AND NVL(TO_DC_AMT, 999999999999)
#if(${ibflag}=='U' && ${update_seq_list} != '')
	AND AFT_BKG_PATH_STUP_SEQ NOT IN(
	#foreach( $update_seq in ${update_seq_list} )
		#if($velocityCount < $update_seq_list.size()) '$update_seq', #else '$update_seq' #end
	#end	
	)
#end
	)			]]></sql>
			<params>
				<param name="rhq_cd" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="eff_dt" type="12" value="" out="N"/>
				<param name="exp_dt" type="12" value="" out="N"/>
				<param name="fm_dc_amt" type="12" value="" out="N"/>
				<param name="to_dc_amt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
