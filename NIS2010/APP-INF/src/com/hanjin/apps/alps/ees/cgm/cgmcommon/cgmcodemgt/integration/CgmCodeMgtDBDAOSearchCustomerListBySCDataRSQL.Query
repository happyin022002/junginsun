<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CgmCodeMgtDBDAOSearchCustomerListBySCDataRSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
SELECT	A.CUST_CNT_CD || LPAD(A.CUST_SEQ, 6, '0') CUST_CD
	,	B.CUST_LGL_ENG_NM CUST_NM

FROM	(
			SELECT	DISTINCT CUST_CNT_CD, CUST_SEQ
			FROM	PRI_SP_SCP_RT_ACT_CUST SP_ACT_CUST
			WHERE	1=1
			#if(${prop_no} == '')
			AND SP_ACT_CUST.PROP_NO = (SELECT DISTINCT PROP_NO
						 				FROM PRI_SP_HDR
										WHERE SC_NO = @[sc_no])
			#else
			AND SP_ACT_CUST.PROP_NO = @[prop_no]
			#end

			MINUS

			SELECT	CUST_CNT_CD, CUST_SEQ
			FROM	PRI_SP_CTRT_PTY	SP_PTY
			WHERE	1=1
			#if(${prop_no} == '')
				AND SP_PTY.PROP_NO = (SELECT DISTINCT PROP_NO
						 				FROM PRI_SP_HDR
										WHERE SC_NO = @[sc_no])
			#else
				AND SP_PTY.PROP_NO = @[prop_no]
			#end
				AND SP_PTY.AMDT_SEQ =
			    	(
			        	SELECT  /*+ INDEX_DESC(PRI_SP_CTRT_PTY XPKPRI_SP_CTRT_PTY) */ AMDT_SEQ
			        	FROM    PRI_SP_CTRT_PTY
			        	WHERE   PROP_NO = SP_PTY.PROP_NO
			            	AND ROWNUM 	= 1
			    	)
				AND SP_PTY.PRC_CTRT_PTY_TP_CD = 'C'
		) A
	, 	MDM_CUSTOMER B

WHERE	A.CUST_CNT_CD 	= B.CUST_CNT_CD
	AND	A.CUST_SEQ		= B.CUST_SEQ

ORDER BY CUST_CD			]]></sql>
			<params>
				<param name="sc_no" type="12" value="" out="N"/>
				<param name="prop_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
