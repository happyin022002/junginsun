<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="MTYRepositionPerformanceAnalysisDBDAOMTYCNTRPERFSummaryVORSQL">
			<desc><![CDATA[MTY Container PFMC Summary    
2011.03.07 남궁진호[CHM-201109244-01] DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19, 오타수정
2011.04.21 남궁진호[CHM-201110306-01] Week조건으로 조회할수 있도록 조건 추가함
2012.02.22 신자영 [CHM-201216310-01] mvmt pfmc by cy 기능 보완
2012.05.23 신자영 [CHM-201217983-01] MVMT PFMC BY CY 기능에 검색 가능 MVMT 추가
2013.02.08 이영두 [CHM-201322887-01] MG 조건 NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 조건 삭제
2013.07.30 이영두 [CHM-201325984] MVMT PFMC에 MO(MTY REPO OUT) 추가
2014.04.40 김창영 [CHM-201429600] Movement performance by CY Tab별 조회조건 추가]]></desc>
			<sql><![CDATA[
#if (${mtymvmt} == 'MTIDMG' || ${mtymvmt} == 'MTVDVD-MT' || ${mtymvmt} == 'MTOPOP-MT' || ${mtymvmt} == 'VLMTMT-VL' 
|| ${mtymvmt} == 'MTOCOC-MT' || ${mtymvmt} == 'OCIDID-OC'|| ${mtymvmt} == 'MTIDID-MT' ||${mtymvmt} == 'OPMTMT-OP'||${mtymvmt} == 'TNMTMT-TN'||
${mtymvmt} == 'ENMTMT-EN'||${mtymvmt} == 'IDICIC-ID'||${mtymvmt} == 'ENICIC-EN'||${mtymvmt} == 'TNICIC-TN')
SELECT 
	L.MOV_STS AS division,
	SUM(CNT) AS total,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40
FROM (
			SELECT	/*+ ORDERED USE_NL ( A S ) */
			        SUBSTR(@[mtymvmt],5)	MOV_STS,
					S.DP_SEQ				DSP_SEQ,
					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
					NVL(A.CNT,0)	        CNT
			FROM	(
						SELECT 	
								SUBSTR(@[mtymvmt],5)	MOV_STS			,
								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
								COUNT(M.CNTR_NO)        CNT             
						FROM 	CTM_MOVEMENT	     M,							
						       	MST_CONTAINER        C     
	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND 	M.MVMT_STS_CD = SUBSTR(@[mtymvmt],0,2)
	#end 
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end
  #if (${lstmcd} != '')
    AND C.LSTM_CD  IN (
    #foreach($cntrlstmcd in ${vel_lstm_cd})
      '$cntrlstmcd',
      #end
      '')
  #end 
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] 		/* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
          ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
		AND		SUBSTR(@[mtymvmt],3,2)	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */		
      AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	

    GROUP BY SUBSTR(@[mtymvmt],5),M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ S    
     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD
	) L
	GROUP BY L.MOV_STS 

#elseif(${mtymvmt} == 'VDMTVL')
SELECT 
	L.MOV_STS AS division,
	SUM(CNT) AS total,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40
FROM (
			SELECT	/*+ ORDERED USE_NL ( A S ) */
			        'VD-MT-VL'	MOV_STS,
					S.DP_SEQ				DSP_SEQ,
					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
					NVL(A.CNT,0)	        CNT
			FROM	(
                     SELECT 'VD-MT-VL' MOV_STS	
                            ,CNTR_TPSZ_CD
                            ,COUNT(CNTR_NO)        CNT
                       FROM (SELECT (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
										    MM.CNMV_YR  
								      FROM  CTM_MOVEMENT MM
								     WHERE  MM.CNTR_NO = M.CNTR_NO  
								       AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
								            M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
                                       AND ROWNUM = 1
                                      ) PRE_CNMV_YR,     
                                     (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
										     MM.CNMV_SEQ  
								        FROM  CTM_MOVEMENT MM
								       WHERE  MM.CNTR_NO = M.CNTR_NO  
								         AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
								              M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
                                         AND ROWNUM = 1
                                      ) PRE_CNMV_SEQ,   
                                     (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
										     MM.CNMV_SPLIT_NO  
								       FROM  CTM_MOVEMENT MM
								      WHERE  MM.CNTR_NO = M.CNTR_NO  
								        AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
								             M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
                                        AND ROWNUM = 1     
								      ) PRE_CNMV_SPLIT_NO,				
								      M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
                                      M.CNTR_NO               CNTR_NO           
						       FROM  CTM_MOVEMENT	     M,							
						       	     MST_CONTAINER        C     
	#if (${period} == 'W') 
		                      WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							                                     SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							                                       FROM   EQR_WK_PRD K
							                                      WHERE  K.PLN_YR||K.PLN_WK = @[from]
							                                     )	
			                                                AND	( 
							                                     SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							                                       FROM   EQR_WK_PRD K
							                                      WHERE  K.PLN_YR||K.PLN_WK = @[to]
							                                     ) 
	#elseif (${period} == 'D' || ${period} == 'M') 
    	                      WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	                        AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
      	                        AND 	M.MVMT_STS_CD = 'VL'
	#if (${tpsz} != '') 
		                        AND  M.CNTR_TPSZ_CD  IN ( 
		                       #foreach($cntrtpszcd in ${vel_tpsz_cd})  
			                                           '$cntrtpszcd',  
			                       #end  
			                            '') 
	#end
  #if (${lstmcd} != '')
                                AND C.LSTM_CD  IN (
                              #foreach($cntrlstmcd in ${vel_lstm_cd})
                                                        '$cntrlstmcd',
                                   #end
                                        '')
  #end 
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		                       AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		                       AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		                       AND 'OK' = (SELECT 'OK'
					                         FROM MDM_VSL_CNTR C
					                        WHERE M.CRNT_VSL_CD = C.VSL_CD
					                           AND C.FDR_DIV_CD  = 'O'
					                           AND C.DELT_FLG = 'N'
				                            )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
                               AND M.ORG_YD_CD = @[location]
	  #else
                               AND M.ORG_YD_CD IN (
                                                   SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				                                            Y.YD_CD
                                                     FROM 
          		                                           MDM_EQ_ORZ_CHT G,
          		                                           MDM_LOCATION L,
				                                           MDM_YARD Y
                                                     WHERE Y.LOC_CD = L.LOC_CD
                                                       AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
                                                       AND G.SCC_CD = @[location] 		/* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		                                               AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		                                               AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		                                               AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
                                                     ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
		                         AND 'MT'	=	(   		  
												                 SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														                 MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												                   FROM  CTM_MOVEMENT MM
												                  WHERE  MM.CNTR_NO = M.CNTR_NO  
												                    AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																         M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												                    AND  ROWNUM = 1
											                      )
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */		
                                AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
                                AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	                            AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	
                                ) A
                     WHERE  'VD'  = (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ 
                                           MM.MVMT_STS_CD  
                                      FROM CTM_MOVEMENT MM
                                     WHERE MM.CNTR_NO = A.CNTR_NO
                                       AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <
                                           A.PRE_CNMV_YR||TO_CHAR(A.PRE_CNMV_SEQ,'0000')||A.PRE_CNMV_SPLIT_NO
                                       AND ROWNUM = 1)
    GROUP BY 'VD-MT-VL',CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ S    
     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD
	) L
	GROUP BY L.MOV_STS
#elseif(${mtymvmt} == 'VDMTTNENMTVL')
SELECT 
	L.MOV_STS AS division,
	SUM(CNT) AS total,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40
FROM (
			SELECT	/*+ ORDERED USE_NL ( A S ) */
			        'VD-MT-(TN or EN)-MT-VL'	MOV_STS,
					S.DP_SEQ				DSP_SEQ,
					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
					NVL(A.CNT,0)	        CNT
			FROM	(
                     SELECT 'VD-MT-(TN or EN)-MT-VL' MOV_STS	
                            ,CNTR_TPSZ_CD
                            ,COUNT(CNTR_NO)        CNT
                       FROM (SELECT *
                               FROM (SELECT AA.*,
                                           (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ 
										           MM.CNMV_YR  
								             FROM  CTM_MOVEMENT MM
								            WHERE  MM.CNTR_NO = AA.CNTR_NO  
								              AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
								                   AA.APRE_CNMV_YR||TO_CHAR(AA.APRE_CNMV_SEQ,'0000')||AA.APRE_CNMV_SPLIT_NO
                                              AND ROWNUM = 1
                                            ) AAPRE_CNMV_YR,     
                                           (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ 
										           MM.CNMV_SEQ  
								             FROM  CTM_MOVEMENT MM
								            WHERE  MM.CNTR_NO = AA.CNTR_NO  
								              AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
								                   AA.APRE_CNMV_YR||TO_CHAR(AA.APRE_CNMV_SEQ,'0000')||AA.APRE_CNMV_SPLIT_NO
                                               AND ROWNUM = 1
                                            ) AAPRE_CNMV_SEQ,   
                                           (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ 
										           MM.CNMV_SPLIT_NO  
								             FROM  CTM_MOVEMENT MM
								            WHERE  MM.CNTR_NO = AA.CNTR_NO  
								              AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
								                   AA.APRE_CNMV_YR||TO_CHAR(AA.APRE_CNMV_SEQ,'0000')||AA.APRE_CNMV_SPLIT_NO
                                              AND ROWNUM = 1     
								            ) AAPRE_CNMV_SPLIT_NO
                                     FROM (SELECT A.*,
                                                 (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ 
										                 MM.CNMV_YR  
								                   FROM  CTM_MOVEMENT MM
								                  WHERE  MM.CNTR_NO = A.CNTR_NO  
								                    AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
								                         A.PRE_CNMV_YR||TO_CHAR(A.PRE_CNMV_SEQ,'0000')||A.PRE_CNMV_SPLIT_NO
                                                    AND ROWNUM = 1
                                                  ) APRE_CNMV_YR,     
                                                 (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ 
										                 MM.CNMV_SEQ  
								                   FROM  CTM_MOVEMENT MM
								                  WHERE  MM.CNTR_NO = A.CNTR_NO  
								                    AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
								                         A.PRE_CNMV_YR||TO_CHAR(A.PRE_CNMV_SEQ,'0000')||A.PRE_CNMV_SPLIT_NO
                                                    AND ROWNUM = 1
                                                  ) APRE_CNMV_SEQ,   
                                                 (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ 
										                 MM.CNMV_SPLIT_NO  
								                   FROM  CTM_MOVEMENT MM
								                  WHERE  MM.CNTR_NO = A.CNTR_NO  
								                    AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
								                         A.PRE_CNMV_YR||TO_CHAR(A.PRE_CNMV_SEQ,'0000')||A.PRE_CNMV_SPLIT_NO
                                                    AND ROWNUM = 1     
								                  ) APRE_CNMV_SPLIT_NO
                                          FROM (SELECT (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
										                       MM.CNMV_YR  
								                         FROM  CTM_MOVEMENT MM
								                        WHERE  MM.CNTR_NO = M.CNTR_NO  
								                          AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
								                               M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
                                                          AND ROWNUM = 1
                                                        ) PRE_CNMV_YR,     
                                                       (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
										                       MM.CNMV_SEQ  
								                          FROM CTM_MOVEMENT MM
								                         WHERE  MM.CNTR_NO = M.CNTR_NO  
								                           AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
								                                M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
                                                           AND ROWNUM = 1
                                                        ) PRE_CNMV_SEQ,   
                                                       (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
										                       MM.CNMV_SPLIT_NO  
								                         FROM  CTM_MOVEMENT MM
								                        WHERE  MM.CNTR_NO = M.CNTR_NO  
								                          AND  MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
								                               M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
                                                          AND ROWNUM = 1     
								                        ) PRE_CNMV_SPLIT_NO,				
								                       M.CNTR_TPSZ_CD CNTR_TPSZ_CD,
                                                       M.CNTR_NO CNTR_NO           
						                         FROM  CTM_MOVEMENT M,							
						       	                       MST_CONTAINER C     
	#if (${period} == 'W') 
		                                         WHERE M.CNMV_EVNT_DT	BETWEEN	( SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							                                                        FROM EQR_WK_PRD K
							                                                       WHERE K.PLN_YR||K.PLN_WK = @[from])	
			                                                                AND ( SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							                                                        FROM EQR_WK_PRD K
							                                                       WHERE K.PLN_YR||K.PLN_WK = @[to]) 
	#elseif (${period} == 'D' || ${period} == 'M') 
    	                                         WHERE M.CNMV_EVNT_DT BETWEEN TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	                                                                  AND TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
      	                                           AND M.MVMT_STS_CD = 'VL'
	#if (${tpsz} != '') 
		                                           AND M.CNTR_TPSZ_CD  IN ( 
		                       #foreach($cntrtpszcd in ${vel_tpsz_cd})  
			                                           '$cntrtpszcd',  
			                       #end  
			                                                               '') 
	#end
  #if (${lstmcd} != '')
                                                   AND C.LSTM_CD IN (
                              #foreach($cntrlstmcd in ${vel_lstm_cd})
                                                        '$cntrlstmcd',
                                   #end
                                                                      '')
  #end 
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		                                           AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		                                           AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		                                           AND 'OK' = (SELECT 'OK'
					                                             FROM MDM_VSL_CNTR C
					                                            WHERE M.CRNT_VSL_CD = C.VSL_CD
					                                              AND C.FDR_DIV_CD  = 'O'
					                                              AND C.DELT_FLG = 'N')
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
                               AND M.ORG_YD_CD = @[location]
	  #else
                               AND M.ORG_YD_CD IN (
                                                   SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				                                            Y.YD_CD
                                                     FROM 
          		                                           MDM_EQ_ORZ_CHT G,
          		                                           MDM_LOCATION L,
				                                           MDM_YARD Y
                                                     WHERE Y.LOC_CD = L.LOC_CD
                                                       AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
                                                       AND G.SCC_CD = @[location] 		/* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		                                               AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		                                               AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		                                               AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
                                                     ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
		                      AND 'MT'=(SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
											   MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
										  FROM CTM_MOVEMENT MM
						                 WHERE MM.CNTR_NO = M.CNTR_NO  
										   AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
											   M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
										   AND  ROWNUM = 1)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */		
                              AND M.CNTR_NO = C.CNTR_NO
	  #if (${soc} == 'E')
                              AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	                          AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	
                              ) A
                       WHERE  1=1
                        AND  ('TN'  = (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */  
                                           MM.MVMT_STS_CD  
                                      FROM CTM_MOVEMENT MM
                                     WHERE MM.CNTR_NO = A.CNTR_NO
                                       AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <
                                           A.PRE_CNMV_YR||TO_CHAR(A.PRE_CNMV_SEQ,'0000')||A.PRE_CNMV_SPLIT_NO
                                       AND ROWNUM = 1)
                              OR
                              'EN'  = (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */  
                                           MM.MVMT_STS_CD  
                                      FROM CTM_MOVEMENT MM
                                     WHERE MM.CNTR_NO = A.CNTR_NO
                                       AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <
                                           A.PRE_CNMV_YR||TO_CHAR(A.PRE_CNMV_SEQ,'0000')||A.PRE_CNMV_SPLIT_NO
                                       AND ROWNUM = 1))
                   ) AA
             WHERE  1=1
               AND  'MT'  = (SELECT  /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ 
                                     MM.MVMT_STS_CD  
                               FROM CTM_MOVEMENT MM
                              WHERE MM.CNTR_NO = AA.CNTR_NO
                                AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <
                                    AA.APRE_CNMV_YR||TO_CHAR(AA.APRE_CNMV_SEQ,'0000')||AA.APRE_CNMV_SPLIT_NO
                                AND ROWNUM = 1)
             ) AAA
       WHERE  1=1 
         AND  'VD'  = (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */  
                              MM.MVMT_STS_CD  
                         FROM CTM_MOVEMENT MM
                        WHERE MM.CNTR_NO = AAA.CNTR_NO
                          AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <
                              AAA.AAPRE_CNMV_YR||TO_CHAR(AAA.AAPRE_CNMV_SEQ,'0000')||AAA.AAPRE_CNMV_SPLIT_NO 
                          AND ROWNUM = 1)
      )
    GROUP BY 'VD-MT-(TN or EN)-MT-VL',CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ S    
     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD
	) L
	GROUP BY L.MOV_STS 
#elseif(${mtymvmt} == 'MP')
SELECT 
	L.MOV_STS AS division,
	SUM(CNT) AS total,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40
FROM (
			SELECT	'MP'			MOV_STS		,
					S.DP_SEQ		DSP_SEQ		,
					S.CNTR_TPSZ_CD	CNTR_TPSZ_CD,
					NVL(CNT,0)		CNT
			FROM	(
						SELECT	M.CNTR_TPSZ_CD		CNTR_TPSZ_CD,
								COUNT(M.CNTR_NO)	CNT
						FROM	(
									SELECT	
											M.CNTR_NO			CNTR_NO,
											M.CNTR_TPSZ_CD		CNTR_TPSZ_CD
									FROM	CTM_MOVEMENT M
	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND M.MVMT_STS_CD = 'MT'
	#end 
	#if (${tpsz} != '') 
		AND M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end
    
    AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
          ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
		AND		'XX'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */	
        UNION ALL
									SELECT 
											M.CNTR_NO			CNTR_NO,
											M.CNTR_TPSZ_CD		CNTR_TPSZ_CD
									FROM	CTM_MOVEMENT M
	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND M.MVMT_STS_CD = 'MT'
	#end 
	#if (${tpsz} != '') 
		AND M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 

		AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
		AND M.CNMV_CYC_NO = 1 
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */

	#if (${inquiryLevel} == 'Y')
    	AND M.ORG_YD_CD = @[location]
	#else
    	AND M.ORG_YD_CD IN (
						SELECT 	/*+ ORDERED USE_NL( G L Y )  */
								Y.YD_CD
						  FROM 
								MDM_EQ_ORZ_CHT G,
								MDM_LOCATION L,
								MDM_YARD Y
						 WHERE Y.LOC_CD = L.LOC_CD
						   AND L.SCC_CD = G.SCC_CD
						#if (${inquiryLevel} == 'S')
						   AND G.SCC_CD = @[location]		/* inquiryLevel = 'SCC'*/
						#elseif(${inquiryLevel} == 'L')
						   AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
						#elseif(${inquiryLevel} == 'E')
						   AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
						#elseif(${inquiryLevel} == 'R')
						   AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
						#end
							)
	  #end
		) M,
		MST_CONTAINER		C
		WHERE	M.CNTR_NO			= C.CNTR_NO
      #if (${lstmcd} != '')
       AND C.LSTM_CD  IN (
         #foreach($cntrlstmcd in ${vel_lstm_cd})
          '$cntrlstmcd',
         #end
         '')
      #end  
	  #if (${soc} == 'E')
		AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
		AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc */
	  #end
	GROUP BY M.CNTR_TPSZ_CD
	) A, CIM_TP_SZ_DP_SEQ S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
) L
GROUP BY L.MOV_STS

#elseif(${mtymvmt} == 'MR')

SELECT 
	L.MOV_STS AS division,
	SUM(CNT) AS total,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40
FROM (
			SELECT	'MR'				MOV_STS,
					S.DP_SEQ			DSP_SEQ,
					S.CNTR_TPSZ_CD      CNTR_TPSZ_CD,	
					NVL(CNT,0)			CNT
			FROM	(
						SELECT 
								'MR'					MOV_STS,
								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD,
								COUNT(M.CNTR_NO)		CNT
						FROM	CTM_MOVEMENT	M,
								MST_CONTAINER	C
	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND 	M.MVMT_STS_CD = 'MT'
	#end 
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
    #if (${lstmcd} != '')
    AND C.LSTM_CD  IN (
    #foreach($cntrlstmcd in ${vel_lstm_cd})
      '$cntrlstmcd',
      #end
      '')
  #end 

		AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
		SELECT 	/*+ ORDERED USE_NL( G L Y )  */
					Y.YD_CD
		FROM 
				MDM_EQ_ORZ_CHT G,
				MDM_LOCATION L,
					MDM_YARD Y
		WHERE Y.LOC_CD = L.LOC_CD
		  AND L.SCC_CD = G.SCC_CD
			#if (${inquiryLevel} == 'S')
			  AND G.SCC_CD = @[location]		/* inquiryLevel = 'SCC'*/
			#elseif(${inquiryLevel} == 'L')
			  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
			#elseif(${inquiryLevel} == 'E')
			  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
			#elseif(${inquiryLevel} == 'R')
			  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
			#end
		  ) 
	  #end
			/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
			AND		'OK'	=	(   		  
									SELECT /*+ ORDERED USE_NL(MM LL GG) INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
											#if (${inquiryLevel} == 'S')
											  DECODE(GG.SCC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'L')
											  DECODE(GG.LCC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'E')
											  DECODE(GG.ECC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'Y')
											  DECODE(MM.ORG_YD_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'R')
											  DECODE(GG.RCC_CD,@[location],'NO',	
											#end
											DECODE(MM.MVMT_STS_CD,'EN','OK',
											DECODE(MM.MVMT_STS_CD,'TN','OK','NO')))

									--		MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
									FROM    CTM_MOVEMENT	MM,
											MDM_LOCATION	LL,
											MDM_EQ_ORZ_CHT	GG
									WHERE   MM.CNTR_NO = M.CNTR_NO  
									AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
													M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
									AND		SUBSTR(MM.ORG_YD_CD, 1, 5)	= LL.LOC_CD
									AND		LL.SCC_CD	= GG.SCC_CD
									AND     ROWNUM		= 1
								)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */		

		AND		M.CNTR_NO	=	C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end
    GROUP BY 'MR', M.CNTR_TPSZ_CD )A,CIM_TP_SZ_DP_SEQ S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
) L
GROUP BY L.MOV_STS


#elseif(${mtymvmt} == 'MO')

SELECT 
	L.MOV_STS AS division,
	SUM(CNT) AS total,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40
FROM (
			SELECT	'MO'				MOV_STS,
					S.DP_SEQ			DSP_SEQ,
					S.CNTR_TPSZ_CD      CNTR_TPSZ_CD,	
					NVL(CNT,0)			CNT
			FROM	(
						SELECT 
								'MO'					MOV_STS,
								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD,
								COUNT(M.CNTR_NO)		CNT
						FROM	CTM_MOVEMENT	M,
							MST_CONTAINER	C
	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND 	M.MVMT_STS_CD IN ('TN', 'EN')
	#end 
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
    #if (${lstmcd} != '')
    AND C.LSTM_CD  IN (
    #foreach($cntrlstmcd in ${vel_lstm_cd})
      '$cntrlstmcd',
      #end
      '')
  #end 

      AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
      AND M.FCNTR_FLG = 'N'
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
		SELECT 	/*+ ORDERED USE_NL( G L Y )  */
					Y.YD_CD
		FROM 
				MDM_EQ_ORZ_CHT G,
				MDM_LOCATION L,
					MDM_YARD Y
		WHERE Y.LOC_CD = L.LOC_CD
		  AND L.SCC_CD = G.SCC_CD
			#if (${inquiryLevel} == 'S')
		  AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
			#elseif(${inquiryLevel} == 'L')
			  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
			#elseif(${inquiryLevel} == 'E')
			  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
			#elseif(${inquiryLevel} == 'R')
			  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
			#end
		  ) 
	  #end
			/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
			AND		'OK'	=	(   		  
									SELECT /*+ ORDERED USE_NL(MM LL GG) INDEX_ASC ( MM XFN1CTM_MOVEMENT ) */
											#if (${inquiryLevel} == 'S')
											  DECODE(GG.SCC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'L')
											  DECODE(GG.LCC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'E')
											  DECODE(GG.ECC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'Y')
											  DECODE(MM.ORG_YD_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'R')
											  DECODE(GG.RCC_CD,@[location],'NO',	
											#end
											DECODE(M.MVMT_STS_CD,'EN','OK',
                DECODE(M.MVMT_STS_CD,'TN','OK','NO')))
            FROM CTM_MOVEMENT  MM,
                MDM_LOCATION  LL,
                MDM_EQ_ORZ_CHT  GG
            WHERE MM.CNTR_NO = M.CNTR_NO
            AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO >
                M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
            AND SUBSTR(MM.ORG_YD_CD, 1, 5)  = LL.LOC_CD
            AND LL.SCC_CD = GG.SCC_CD
            AND MM.MVMT_STS_CD = 'MT'
            AND MM.CNMV_CYC_NO = M.CNMV_CYC_NO
            AND	MM.FCNTR_FLG = 'N'
            AND ROWNUM    = 1 
								)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */		

		AND		M.CNTR_NO	=	C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end

    GROUP BY 'MO', M.CNTR_TPSZ_CD )A,CIM_TP_SZ_DP_SEQ S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
) L
GROUP BY L.MOV_STS


#elseif(${mtymvmt} == 'MT')
SELECT 
	L.MOV_STS AS division,
	NVL(SUM(CNT),0) AS total,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40
FROM (
			SELECT	/*+ ORDERED USE_NL ( A S ) */
			        'MG'			MOV_STS,
					S.DP_SEQ		DSP_SEQ,
					S.CNTR_TPSZ_CD  CNTR_TPSZ_CD,
					NVL(A.CNT,0)	CNT
			FROM	(
						SELECT 	
								'MG'				MOV_STS			,
								M.CNTR_TPSZ_CD		CNTR_TPSZ_CD    ,
								COUNT(M.CNTR_NO)    CNT             
						FROM 	CTM_MOVEMENT	     M,
						       	MST_CONTAINER        C     

	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							)  
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND 	M.MVMT_STS_CD = 'MT'
	#end 
	#if (${tpsz} != '') 
		AND  	M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
    #if (${lstmcd} != '')
    AND C.LSTM_CD  IN (
    #foreach($cntrlstmcd in ${vel_lstm_cd})
      '$cntrlstmcd',
      #end
      '')
  #end 
      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
          ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
		AND		'ID'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */	
		AND	     M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end
    GROUP BY 'MG', M.CNTR_TPSZ_CD )A,CIM_TP_SZ_DP_SEQ S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
	UNION ALL
			SELECT	'MP'			MOV_STS		,
					S.DP_SEQ		DSP_SEQ		,
					S.CNTR_TPSZ_CD	CNTR_TPSZ_CD,
					NVL(CNT,0)		CNT
			FROM	(
						SELECT	M.CNTR_TPSZ_CD		CNTR_TPSZ_CD,
								COUNT(M.CNTR_NO)	CNT
						FROM	(
									SELECT	
											M.CNTR_NO			CNTR_NO,
											M.CNTR_TPSZ_CD		CNTR_TPSZ_CD
									FROM	CTM_MOVEMENT M

	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							)  
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      AND 	M.MVMT_STS_CD = 'MT'
	#end 
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
    AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
          ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
		AND		'XX'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */	
        UNION ALL
        SELECT 
          M.CNTR_NO CNTR_NO,
          M.CNTR_TPSZ_CD CNTR_TPSZ_CD
        FROM CTM_MOVEMENT M
	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							)  
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND 	M.MVMT_STS_CD = 'MT'
	#end 
	#if (${tpsz} != '') 
		AND  	M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
    
      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
      AND 	M.CNMV_CYC_NO = 1
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND 	M.ORG_YD_CD = @[location]
	  #else
      AND 	M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
          ) 
	  #end
		) M ,
      MST_CONTAINER		C
   	  WHERE	M.CNTR_NO			= C.CNTR_NO
      #if (${lstmcd} != '')
       AND C.LSTM_CD  IN (
          #foreach($cntrlstmcd in ${vel_lstm_cd})
           '$cntrlstmcd',
          #end
          '')
      #end

	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end    
	GROUP BY 'MP', M.CNTR_TPSZ_CD )A,CIM_TP_SZ_DP_SEQ S
WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD

UNION ALL

			SELECT	'MR'				MOV_STS,
					S.DP_SEQ			DSP_SEQ,
					S.CNTR_TPSZ_CD      CNTR_TPSZ_CD,	
					NVL(CNT,0)			CNT
			FROM	(
						SELECT 
								'MR'					MOV_STS,
								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD,
								COUNT(M.CNTR_NO)		CNT
						FROM	CTM_MOVEMENT	M,
								MST_CONTAINER	C
	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      AND 	M.MVMT_STS_CD = 'MT'
	#end 
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
    #if (${lstmcd} != '')
    AND C.LSTM_CD  IN (
    #foreach($cntrlstmcd in ${vel_lstm_cd})
      '$cntrlstmcd',
      #end
      '')
  #end 
      AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
          ) 
	  #end
			/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
			AND		'OK'	=	(   		  
									SELECT /*+ ORDERED USE_NL(MM LL GG) INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
											#if (${inquiryLevel} == 'S')
											  DECODE(GG.SCC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'L')
											  DECODE(GG.LCC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'E')
											  DECODE(GG.ECC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'Y')
											  DECODE(MM.ORG_YD_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'R')
											  DECODE(GG.RCC_CD,@[location],'NO',
											#end
											DECODE(MM.MVMT_STS_CD,'EN','OK',
											DECODE(MM.MVMT_STS_CD,'TN','OK','NO')))

									--		MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
									FROM    CTM_MOVEMENT	MM,
											MDM_LOCATION	LL,
											MDM_EQ_ORZ_CHT	GG
									WHERE   MM.CNTR_NO = M.CNTR_NO  
									AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
													M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
									AND		SUBSTR(MM.ORG_YD_CD, 1, 5)	= LL.LOC_CD
									AND		LL.SCC_CD	= GG.SCC_CD
									AND     ROWNUM		= 1
								)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */	
		AND	M.CNTR_NO	=	C.CNTR_NO
	  #if (${soc} == 'E')
      	AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
	  	AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end
    GROUP BY 'MR', M.CNTR_TPSZ_CD )A,CIM_TP_SZ_DP_SEQ S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
	UNION ALL
			SELECT	/*+ ORDERED USE_NL ( A S ) */
			        'VD-MT'			MOV_STS,
					S.DP_SEQ		DSP_SEQ,
					S.CNTR_TPSZ_CD  CNTR_TPSZ_CD,
					NVL(A.CNT,0)	CNT
			FROM	(
						SELECT 	
								'VD-MT'				MOV_STS			,
								M.CNTR_TPSZ_CD		CNTR_TPSZ_CD    ,
								COUNT(M.CNTR_NO)    CNT             
						FROM 	CTM_MOVEMENT	     M,
						       	MST_CONTAINER        C     

	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND 	M.MVMT_STS_CD = 'MT'
	#end 
	#if (${tpsz} != '') 
		AND  	M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
    #if (${lstmcd} != '')
    AND C.LSTM_CD  IN (
    #foreach($cntrlstmcd in ${vel_lstm_cd})
      '$cntrlstmcd',
      #end
      '')
  #end 
     -- AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
          ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
		AND		'VD'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */	
		AND	     M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end
    GROUP BY 'VD-MT', M.CNTR_TPSZ_CD )A,CIM_TP_SZ_DP_SEQ S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
) L
GROUP BY  L.MOV_STS 
ORDER BY division

#elseif(${mtymvmt} == 'VL')

SELECT 
	L.MOV_STS AS division,
	SUM(CNT) AS total,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40
FROM (
			SELECT	/*+ ORDERED USE_NL ( A S ) */
			        'OC-VL'					MOV_STS,
					S.DP_SEQ				DSP_SEQ,
					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
					NVL(A.CNT,0)	        CNT
			FROM	(
						SELECT 	
								'OC-VL'					MOV_STS			,
								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
								COUNT(M.CNTR_NO)        CNT             
						FROM 	CTM_MOVEMENT	     M,
						       	MST_CONTAINER        C     
	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							)  
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND 	M.MVMT_STS_CD = 'VL'
	#end 
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
    #if (${lstmcd} != '')
    AND C.LSTM_CD  IN (
    #foreach($cntrlstmcd in ${vel_lstm_cd})
      '$cntrlstmcd',
      #end
      '')
  #end 

	#if (${mtymvmt} == 'MTIDMG')
      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
          ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
		AND		'OC'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */		
      AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	
	#if (${bound} == 'N')
		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */
	#elseif(${bound} == 'Y')
		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */
	#end
    GROUP BY 'OC-VL',M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ S    
     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD
UNION ALL

			SELECT	/*+ ORDERED USE_NL ( A S ) */
			        'TS-VL'					MOV_STS,
					S.DP_SEQ				DSP_SEQ,
					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
					NVL(A.CNT,0)	        CNT
			FROM	(
						SELECT 	
								'TS-VL'					MOV_STS			,
								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
								COUNT(M.CNTR_NO)        CNT             
						FROM 	CTM_MOVEMENT	     M,
						       	MST_CONTAINER        C     
	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND 	M.MVMT_STS_CD = 'VL'
	#end 
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
    #if (${lstmcd} != '')
    AND C.LSTM_CD  IN (
    #foreach($cntrlstmcd in ${vel_lstm_cd})
      '$cntrlstmcd',
      #end
      '')
  #end 

	#if (${mtymvmt} == 'MTIDMG')
      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
          ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
		AND		'TS'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */		

      AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	
	#if (${bound} == 'N')
		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */
	#elseif(${bound} == 'Y')
		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */
	#end

    GROUP BY 'TS-VL',M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ S    
     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD
	) L
	GROUP BY L.MOV_STS 

#elseif(${mtymvmt} == 'VD')

SELECT 
	L.MOV_STS AS division,
	SUM(CNT) AS total,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40
FROM (
			SELECT	/*+ ORDERED USE_NL ( A S ) */
			        'VD-IC'					MOV_STS,
					S.DP_SEQ				DSP_SEQ,
					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
					NVL(A.CNT,0)	        CNT
			FROM	(
						SELECT 	
								'VD-IC'					MOV_STS			,
								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
								COUNT(M.CNTR_NO)        CNT             
						FROM 	CTM_MOVEMENT	     M,
						       	MST_CONTAINER        C     
	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND 	M.MVMT_STS_CD = 'IC'
	#end 
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
    #if (${lstmcd} != '')
    AND C.LSTM_CD  IN (
    #foreach($cntrlstmcd in ${vel_lstm_cd})
      '$cntrlstmcd',
      #end
      '')
  #end 

	#if (${mtymvmt} == 'MTIDMG')
      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
      AND @[vvd_nm] =     (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
                               MM.CRNT_VSL_CD||MM.CRNT_SKD_VOY_NO||MM.CRNT_SKD_DIR_CD
                          FROM CTM_MOVEMENT MM, MDM_VSL_CNTR C
                         WHERE MM.CNTR_NO = M.CNTR_NO
                           AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <
                               M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
                           AND MM.MVMT_STS_CD = 'VD' 
                           AND MM.CRNT_VSL_CD = C.VSL_CD
                           AND C.FDR_DIV_CD  = 'O' 
                           AND ROWNUM = 1
                        )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
          ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
		AND		'VD'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */		

      AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	
	#if (${bound} == 'N')
		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */
	#elseif(${bound} == 'Y')
		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */
	#end

    GROUP BY 'VD-IC',M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ S    
     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD
UNION ALL

			SELECT	/*+ ORDERED USE_NL ( A S ) */
			        'VD-TS'					MOV_STS,
					S.DP_SEQ				DSP_SEQ,
					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
					NVL(A.CNT,0)	        CNT
			FROM	(
						SELECT 	
								'VD-TS'					MOV_STS			,
								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
								COUNT(M.CNTR_NO)        CNT             
						FROM 	CTM_MOVEMENT	     M,
						       	MST_CONTAINER        C     
	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND 	M.MVMT_STS_CD = 'TS'
	#end 
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
    #if (${lstmcd} != '')
    AND C.LSTM_CD  IN (
    #foreach($cntrlstmcd in ${vel_lstm_cd})
      '$cntrlstmcd',
      #end
      '')
  #end 

	#if (${mtymvmt} == 'MTIDMG')
      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
		AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
		AND 'OK' = (SELECT 'OK'
					  FROM MDM_VSL_CNTR C
					 WHERE M.CRNT_VSL_CD = C.VSL_CD
					   AND C.FDR_DIV_CD  = 'O'
					   AND C.DELT_FLG = 'N'
				   )
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
          ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ????? */
		AND		'VD'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ????? */		

      AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	
	#if (${bound} == 'N')
		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */
	#elseif(${bound} == 'Y')
		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */
	#end

    GROUP BY 'VD-TS',M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ S    
     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD
	) L
	GROUP BY L.MOV_STS 

#else

SELECT 
	L.MOV_STS AS division,
	SUM(CNT) AS total,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39,
	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40
FROM (
			SELECT	/*+ ORDERED USE_NL ( A S ) */
			        SUBSTR(@[mtymvmt],0,2)	MOV_STS,
					S.DP_SEQ				DSP_SEQ,
					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
					NVL(A.CNT,0)	        CNT
			FROM	(
						SELECT 	
								SUBSTR(@[mtymvmt],0,2)	MOV_STS			,
								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
								COUNT(M.CNTR_NO)        CNT             
						FROM 	CTM_MOVEMENT	     M,
						       	MST_CONTAINER        C     
	#if (${period} == 'W') 
		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD K
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD K
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							)  
	#elseif (${period} == 'D' || ${period} == 'M') 
    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end 
	#if (${mtymvmt} != '') 
      	AND 	M.MVMT_STS_CD = SUBSTR(@[mtymvmt],0,2)
	#end 

	#if (${mtymvmt} == 'ENF' || ${mtymvmt} == 'TNF' || ${mtymvmt} == 'ENM' || ${mtymvmt} == 'TNM') 
		#if (${mtymvmt} == 'ENF' || ${mtymvmt} == 'TNF') 
			AND	M.FCNTR_FLG = 'Y'
		#else
			AND	M.FCNTR_FLG = 'N'
		#end
	#end 

	#if (${tpsz} != '') 
		AND  	M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
    #if (${lstmcd} != '')
    AND C.LSTM_CD  IN (
    #foreach($cntrlstmcd in ${vel_lstm_cd})
      '$cntrlstmcd',
      #end
      '')
  #end 
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (S) */
	#if (${vvd_tp} == 'T' && ${vvd_nm} != '')
		AND M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD = @[vvd_nm]
	#end
	#if (${vvd_tp} == 'O' && ${vvd_nm} != '')
      #if (${mtymvmt} == 'OP' || ${mtymvmt} == 'OC')
         AND @[vvd_nm] = 
              (SELECT /*+ INDEX_ASC( MM XFN1CTM_MOVEMENT ) */
                      MM.CRNT_VSL_CD||MM.CRNT_SKD_VOY_NO||MM.CRNT_SKD_DIR_CD
               FROM CTM_MOVEMENT MM, MDM_VSL_CNTR C
               WHERE MM.CNTR_NO = M.CNTR_NO
                AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO >
                   M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
                AND MM.MVMT_STS_CD = 'VL' 
                AND MM.CRNT_VSL_CD = C.VSL_CD
                AND C.FDR_DIV_CD  = 'O' 
                AND ROWNUM = 1
              )
        #else
	        AND M.CRNT_VSL_CD||M.CRNT_SKD_VOY_NO||M.CRNT_SKD_DIR_CD = @[vvd_nm]
	        AND 'OK' = (SELECT 'OK'
          				     FROM MDM_VSL_CNTR C
          				     WHERE M.CRNT_VSL_CD = C.VSL_CD
          				     AND C.FDR_DIV_CD  = 'O'
          				     AND C.DELT_FLG = 'N'
            		      )
        #end
	#end
	/* ----------------> 2014.05.07 by Chang Young Kim (AA Young Du Lee) : VVD Type & Name Condition Add (E) */
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] 		/* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#elseif(${inquiryLevel} == 'R')
		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/
		#end
          ) 
	  #end

      AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	
	#if (${bound} == 'N')
		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */
	#elseif(${bound} == 'Y')
		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */
	#end

    GROUP BY SUBSTR(@[mtymvmt],0,2),M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ S    
     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD
	) L
	GROUP BY L.MOV_STS 
#end			]]></sql>
			<params>
				<param name="tpsz" type="12" value="" out="N"/>
				<param name="mtymvmt" type="12" value="" out="N"/>
				<param name="from" type="12" value="" out="N"/>
				<param name="to" type="12" value="" out="N"/>
				<param name="vvd_nm" type="12" value="" out="N"/>
				<param name="location" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
