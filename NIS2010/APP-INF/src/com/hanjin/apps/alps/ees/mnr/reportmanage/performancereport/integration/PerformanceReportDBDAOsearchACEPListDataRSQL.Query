<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PerformanceReportDBDAOsearchACEPListDataRSQL">
			<desc><![CDATA[ACEP Candidate Cntr List 를 조회한다.
--------------------------------------------------------------------------------------------------------------------------------
2014.11.20 30개월 이상 조회 안되도록 ( 요청 정필성 부장님 ) by Chang Young Kim
Origin Condition (쿼리내 주석시 이상현상 발생)
--AND ESV.RPR_DT < TO_CHAR(ADD_MONTHS(TO_DATE(@[cur_dt],'YYYY-MM-DD'),-1*@[month]), 'YYYY-MM-DD')
--------------------------------------------------------------------------------------------------------------------------------]]></desc>
			<sql><![CDATA[
SELECT   ESV.EQ_NO
       , ESV.EQ_TPSZ_CD
       , ESV.LOC_CD
       , ESV.CRNT_YD_CD AS YD_CD
       , ESV.ONH_DT
       , ESV.RPR_DT
       , ESV.RPR_RSLT_DT
       , ROUND(MONTHS_BETWEEN(TO_DATE(@[cur_dt], 'YYYY-MM-DD'), TO_DATE(ESV.RPR_RSLT_DT, 'YYYY-MM-DD')),0) OVER_MONTH
       , TO_CHAR(ADD_MONTHS(TO_DATE(ESV.RPR_RSLT_DT, 'YYYY-MM-DD'),30),'YYYY-MM-DD') NEXT_AUDIT_DT
FROM     MNR_EQ_STS_V ESV
WHERE    1 = 1
AND      ESV.EQ_TYPE = 'U'
AND      ESV.ACT_IND = 'A'
AND      ESV.RPR_RSLT_DT >= TO_CHAR(ADD_MONTHS(TO_DATE(@[cur_dt],'YYYY-MM-DD'),-30), 'YYYY-MM-DD')
AND      ESV.RPR_RSLT_DT <= TO_CHAR(ADD_MONTHS(TO_DATE(@[cur_dt],'YYYY-MM-DD'),-1*@[month]), 'YYYY-MM-DD')
AND      ESV.MVMT_CD IN
         (
           'CD'
         , 'CE'
         , 'CI'
         , 'CM'
         , 'CO'
         , 'CP'
         , 'CT'
         , 'CX'
         , 'EN'
         , 'IC'
         , 'ID'
         , 'MT'
         , 'OC'
         , 'OP'
         , 'TN'
         , 'TS'
         )

#if (${term_type} == 'A') 
AND      ESV.LSTM_CD IN ('OW','OL','LP','LT','ST')
#elseif (${term_type} == 'OWN') 
AND      ESV.LSTM_CD IN ('OW','OL','LP')
#elseif (${term_type} == 'LSE') 
AND      ESV.LSTM_CD IN ('LT','ST')
#end

#if (${acep_type} == 'RCC') 
AND      ESV.RCC_CD = @[loc_cd]
#elseif (${acep_type} == 'LCC') 
AND      ESV.LCC_CD = @[loc_cd]
#elseif (${acep_type} == 'SCC')  
AND      ESV.SCC_CD = @[loc_cd]
#elseif (${acep_type} == 'YARD') 
AND      ESV.CRNT_YD_CD = @[loc_cd]
#end			]]></sql>
			<params>
				<param name="cur_dt" type="12" value="" out="N"/>
				<param name="month" type="12" value="" out="N"/>
				<param name="loc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
