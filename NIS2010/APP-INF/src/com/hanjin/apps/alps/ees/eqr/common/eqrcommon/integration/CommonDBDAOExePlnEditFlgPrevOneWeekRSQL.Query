<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CommonDBDAOExePlnEditFlgPrevOneWeekRSQL">
			<desc><![CDATA[execution plan 에서 plan 의 yrwk이 현재 local 의 yrwk 보다 한주이상 작으면edit 불가.(VD Add 버튼에 적용됨)]]></desc>
			<sql><![CDATA[
SELECT                            							
	CASE WHEN -->  (PLAN WK - LOCAL WK)  < EDIT FALSE...   	

-- 20090112 - 200853주차 문제로 보완 
--	    	TO_NUMBER((SELECT WK_ST_DT LOCALDATE         			          
--	                  FROM EQR_WK_PRD                   			
--	                  WHERE PLN_YR||PLN_WK = ?))					
		NVL(TO_NUMBER((
						SELECT 
							WK_ST_DT LOCALDATE         		          
              			FROM 
							EQR_WK_PRD                   			
              			WHERE PLN_YR||PLN_WK = @[yyyyww] 
					 )), 0)				

   		  - TO_NUMBER((    										

-- modified by shin yongchan - 20090107
-- CSR NO : N200901070038
-- 200902주차 PLAN 없이 200903주차 PLAN을 바로 생성하므로 0117일까지만 -2주 작업을 허용 
--		SELECT TO_CHAR(TO_DATE(WK_ST_DT, 'YYYYMMDD')-7, 'YYYYMMDD') LOCALDATE    
--		SELECT TO_CHAR(TO_DATE(WK_ST_DT, 'YYYYMMDD')-14, 'YYYYMMDD') LOCALDATE    

-- modified by shin yongchan - 20090120
-- CSR NO : R200901200003
-- -1주 작업으로 원상복귀 
						SELECT 
							TO_CHAR(TO_DATE(WK_ST_DT, 'YYYYMMDD')-7, 'YYYYMMDD') LOCALDATE
  						FROM 
							EQR_WK_PRD                               		
 						WHERE 
							@[localDate] BETWEEN WK_ST_DT AND WK_END_DT  			
 					 ))  < 0 THEN 
		'FALSE' 
	ELSE 
		'TRUE' 
	END EXEPLNEDITFLG  	
FROM DUAL  												

--		  MODIFIED BY Shin YongChan 20080102
--	    SELECT                            							
--	    	CASE WHEN -->  (PLAN WK - LOCAL WK)  < EDIT FALSE...   	
--	    	TO_NUMBER(?) - TO_NUMBER( (                          	
--	    		SELECT PLN_YR||PLN_WK LOCALDATE                     
--	      		FROM EQR_WK_PRD                               		
--	     		WHERE ? BETWEEN WK_ST_DT AND WK_END_DT  			
--	     	))  < -1 THEN 'FALSE' ELSE 'TRUE' END EXEPLNEDITFLG  	
--	     	FROM DUAL  
			]]></sql>
			<params>
				<param name="yyyyww" type="12" value="" out="N"/>
				<param name="localDate" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
