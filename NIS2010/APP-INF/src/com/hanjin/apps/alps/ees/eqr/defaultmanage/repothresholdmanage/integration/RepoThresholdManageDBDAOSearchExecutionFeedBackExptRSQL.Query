<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RepoThresholdManageDBDAOSearchExecutionFeedBackExptRSQL">
			<desc><![CDATA[EQR_REPO_EXE_PLN_FB_EXPT 테이블의 데이터 조회]]></desc>
			<sql><![CDATA[
SELECT
    MAX(DECODE ( RUMM , 1 ,LOC_GRP_CD, LOC_GRP_CD)) LOC_GRP_CD
    ,MAX(DECODE ( RUMM , 1 ,LOC_CD, LOC_CD))LOC_CD
    ,FB_ITM_CD
    ,FB_ITM_BSE_CD
#foreach( $key in ${tpszarr}) 
	,MAX(DECODE ( CNTR_TPSZ_CD , '$key' , FB_RTO ))    ${key}FB_RTO
	,MAX(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_VOL_QTY))       ${key}CNTR_VOL_QTY
#end
    ,MAX(DECODE(CRE_DT,UPD_DT, 'N', 'Y')) AS TIMEGAP
FROM (
    SELECT 
        LOC_GRP_CD
        , LOC_CD
        ,FB_ITM_CD
        ,FB_ITM_BSE_CD
        ,CNTR_TPSZ_CD
        ,FB_RTO
        ,CNTR_VOL_QTY
        ,UPD_USR_ID
        ,UPD_DT
        ,CRE_DT
        ,ROW_NUMBER() OVER (PARTITION BY FB_ITM_CD,FB_ITM_BSE_CD, CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM
    FROM (
        SELECT 
            LOC_GRP_CD
            ,LOC_CD 
            ,FB.FB_ITM_CD 
            ,FB.FB_ITM_BSE_CD
            ,FB.CNTR_TPSZ_CD
            ,FB.FB_RTO 
            ,FB.CNTR_VOL_QTY
            ,FB.UPD_USR_ID
            ,FB.UPD_DT  
            ,FB.CRE_DT
        FROM EQR_REPO_EXE_PLN_FB_EXPT FB
        ORDER BY LOC_GRP_CD DESC
    )
)
GROUP BY  RUMM , FB_ITM_CD, FB_ITM_BSE_CD
ORDER BY  FB_ITM_CD, FB_ITM_BSE_CD, LOC_GRP_CD DESC			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
