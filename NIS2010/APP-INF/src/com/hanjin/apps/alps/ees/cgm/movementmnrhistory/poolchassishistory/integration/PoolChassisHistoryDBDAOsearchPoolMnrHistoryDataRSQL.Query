<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PoolChassisHistoryDBDAOsearchPoolMnrHistoryDataRSQL">
			<desc><![CDATA[   ]]></desc>
			<sql><![CDATA[
SELECT  A.VNDR_NM
      , A.VNDR_LOC_NM
      , A.INV_NO 
      , TO_CHAR(A.INV_CRE_DT ,'YYYY-MM-DD') INV_CRE_DT 
      , A.CHSS_NO 
      , DECODE(B.EQ_NO,NULL,'N','Y') MST_CHK
      , TO_CHAR(A.RPR_RQST_DT,'YYYY-MM-DD') RPR_RQST_DT 
      , TO_CHAR(A.RPR_CMPL_DT,'YYYY-MM-DD') RPR_CMPL_DT
      , A.CHSS_CMPO_NM
      , A.CHSS_LOC_NM  
      , A.DMG_DESC 
      , A.RPR_DESC  
      , A.SPL_CMPO_TP_CD 
      , A.RPR_INSP_TP_DESC
      , A.RPR_HRS 
      , A.LBR_COST_AMT 
      , A.MTRL_COST_AMT
      , A.TAX_AMT
      , A.COST_TTL_AMT    
FROM CGM_POOL_MAINT_RPR_HIS A
    ,CGM_EQUIPMENT B  
 WHERE 1=1 
  AND A.CHSS_NO  = B.EQ_NO(+)
  AND ( A.CHSS_POOL_CD =  @[chss_pool_cd] OR   B.CHSS_POOL_CD =  @[chss_pool_cd] )

#if ( ${sort} == '0'  )
  AND A.INV_CRE_DT BETWEEN  TO_DATE(@[mvmt_dt_fr],'RRRR-MM' ) AND  ADD_MONTHS(TO_DATE(@[mvmt_dt_to]   ,'RRRR-MM' ),1) 
#else
  AND A.RPR_RQST_DT BETWEEN  TO_DATE(@[mvmt_dt_fr],'YYYY-MM-DD' ) AND  TO_DATE(@[mvmt_dt_to],'YYYY-MM-DD' )
#end			]]></sql>
			<params>
				<param name="chss_pool_cd" type="12" value="" out="N"/>
				<param name="mvmt_dt_fr" type="12" value="" out="N"/>
				<param name="mvmt_dt_to" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
