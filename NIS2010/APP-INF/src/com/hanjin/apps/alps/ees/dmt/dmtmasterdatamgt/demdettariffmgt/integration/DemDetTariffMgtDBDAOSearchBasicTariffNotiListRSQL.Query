<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DemDetTariffMgtDBDAOSearchBasicTariffNotiListRSQL">
			<desc><![CDATA[DemDetTariffMgtDBDAOSearchBasicTariffNotiListRSQL]]></desc>
			<sql><![CDATA[
SELECT DISTINCT COVRG, DMDT_TRF_CD, ORG_DEST, DMDT_DE_TERM_CD, DMDT_DE_TERM_NM 
     , DMDT_CNTR_TP_NM, DMDT_CGO_TP_NM, EXP_DT, PIC_TEAM, TRF_MNG_USR_ID
     , TO_CHAR(UPD_DT,'YYYY-MM-DD') UPD_DT, UPD_USR_NM, UPD_OFC_CD, 'Weekly' AS CYC_NOTI
     , SYS_AREA_GRP_ID, TRF_SEQ, TRF_GRP_SEQ, DMDT_CNTR_TP_CD, DMDT_CGO_TP_CD
     , EFF_DT, EXIST, ( SELECT USR_NM FROM COM_USER WHERE USR_ID = TRF_MNG_USR_ID AND ROWNUM = 1 ) AS TRF_MNG_USR_NM
FROM    (
        SELECT  A.DMDT_TRF_CD
                ,CASE WHEN TRIM(A.CVRG_YD_CD) IS NULL THEN 
                	(CASE WHEN TRIM(A.CVRG_LOC_CD) IS NULL THEN
                		(CASE WHEN TRIM(A.CVRG_STE_CD) IS NULL THEN
                			(CASE WHEN TRIM(A.CVRG_RGN_CD) IS NULL THEN A.CVRG_CNT_CD ELSE A.CVRG_RGN_CD END)
                		ELSE A.CVRG_STE_CD
                		END)
                	ELSE A.CVRG_LOC_CD
                	END)
                ELSE A.CVRG_YD_CD
                END COVRG
                ,CASE WHEN TRIM(A.ORG_DEST_LOC_CD) IS NULL THEN 
                	(CASE WHEN TRIM(A.ORG_DEST_STE_CD) IS NULL THEN
                		(CASE WHEN TRIM(A.ORG_DEST_RGN_CD) IS NULL THEN 
                			(CASE WHEN TRIM(A.ORG_DEST_CNT_CD) IS NULL THEN A.ORG_DEST_CONTI_CD ELSE A.ORG_DEST_CNT_CD END)
                		ELSE A.ORG_DEST_RGN_CD
                		END)
                	ELSE A.ORG_DEST_STE_CD
                	END)
                ELSE A.ORG_DEST_LOC_CD
                END ORG_DEST
                , B.TRF_GRP_SEQ
                , CASE WHEN B.DMDT_TRF_GRP_TP_CD = 'N' THEN 'Exempted'
                      ELSE B.DMDT_BZC_TRF_GRP_NM END DMDT_BZC_TRF_GRP_NM
                ,NVL( TO_CHAR(B.EFF_DT,'YYYY-MM-DD') , '-' ) AS EFF_DT
                ,NVL( TO_CHAR(B.EXP_DT,'YYYY-MM-DD') , '-' ) AS EXP_DT
                ,B.DMDT_DE_TERM_CD
                ,(
                SELECT  S.INTG_CD_VAL_DP_DESC
                FROM    COM_INTG_CD_DTL S
                WHERE   S.INTG_CD_ID        = 'CD03257'
                AND     S.INTG_CD_VAL_CTNT  = B.DMDT_DE_TERM_CD
                )                                            AS DMDT_DE_TERM_NM

                , NVL(( SELECT TRF_EXP_NTC_OFC_CD 
                        FROM DMT_TRF_EXP_NTC_OFC
                       WHERE IO_BND_CD = SUBSTR(A.DMDT_TRF_CD,3,1)
                         AND CVRG_LOC_CD = A.CVRG_LOC_CD
                         AND ORG_DEST_CONTI_CD = A.ORG_DEST_CONTI_CD ),
                    NVL(( SELECT TRF_EXP_NTC_OFC_CD 
                            FROM DMT_TRF_EXP_NTC_OFC
                           WHERE IO_BND_CD = SUBSTR(A.DMDT_TRF_CD,3,1)
                             AND CVRG_STE_CD = A.CVRG_STE_CD
                             AND CVRG_LOC_CD IS NULL
                             AND ORG_DEST_CONTI_CD = A.ORG_DEST_CONTI_CD ),
                        NVL(( SELECT TRF_EXP_NTC_OFC_CD 
                                FROM DMT_TRF_EXP_NTC_OFC
                               WHERE IO_BND_CD = SUBSTR(A.DMDT_TRF_CD,3,1)
                                 AND CVRG_RGN_CD = A.CVRG_RGN_CD
                                 AND CVRG_STE_CD IS NULL
                                 AND CVRG_LOC_CD IS NULL
                                 AND ORG_DEST_CONTI_CD = A.ORG_DEST_CONTI_CD ),
                            NVL(( SELECT TRF_EXP_NTC_OFC_CD 
                                    FROM DMT_TRF_EXP_NTC_OFC
                                   WHERE IO_BND_CD = SUBSTR(A.DMDT_TRF_CD,3,1)
                                     AND CVRG_CNT_CD = A.CVRG_CNT_CD
                                     AND CVRG_RGN_CD IS NULL
                                     AND CVRG_STE_CD IS NULL
                                     AND CVRG_LOC_CD IS NULL
                                     AND ORG_DEST_CONTI_CD = A.ORG_DEST_CONTI_CD ),
                                NVL(( SELECT TRF_EXP_NTC_OFC_CD 
                                        FROM DMT_TRF_EXP_NTC_OFC
                                       WHERE IO_BND_CD = SUBSTR(A.DMDT_TRF_CD,3,1)
                                         AND CVRG_CONTI_CD = CASE WHEN A.CVRG_CNT_CD IN ('DJ','SD','TZ','ZA' ) THEN 'A'
                                                                  ELSE A.CVRG_CONTI_CD END
                                         AND CVRG_CNT_CD IS NULL
                                         AND CVRG_RGN_CD IS NULL
                                         AND CVRG_STE_CD IS NULL
                                         AND CVRG_LOC_CD IS NULL
                                         AND ORG_DEST_CONTI_CD = A.ORG_DEST_CONTI_CD ),
                                'ERROR')
                            )
                        )
                    )
                ) AS PIC_TEAM
                , C.TRF_MNG_USR_ID
                , C.UPD_DT
                , ( SELECT USR_NM FROM COM_USER WHERE USR_ID = C.UPD_USR_ID ) AS UPD_USR_NM
                , C.UPD_OFC_CD
                , C.SYS_AREA_GRP_ID
                , C.TRF_SEQ
                , C.DMDT_CNTR_TP_CD
                , C.DMDT_CGO_TP_CD
                , F.INTG_CD_VAL_DP_DESC                                     AS DMDT_CNTR_TP_NM
                , G.INTG_CD_VAL_DP_DESC                                     AS DMDT_CGO_TP_NM
				, NVL(B.BZC_TRF_XTN_FLG, 'N') 								AS EXIST
        FROM    DMT_TRF_RGN     A, 
                DMT_TRF_GRP     B,
                DMT_TRF_CMB     C, 
                DMT_TRF_FREE_TM D, 
                DMT_TRF_RT      E,
                COM_INTG_CD_DTL F, 
                COM_INTG_CD_DTL G
        WHERE   A.SYS_AREA_GRP_ID   = B.SYS_AREA_GRP_ID
        AND     A.DMDT_TRF_CD       = B.DMDT_TRF_CD
        AND     A.TRF_SEQ           = B.TRF_SEQ
        AND     B.SYS_AREA_GRP_ID   = C.SYS_AREA_GRP_ID
        AND     B.DMDT_TRF_CD       = C.DMDT_TRF_CD
        AND     B.TRF_SEQ           = C.TRF_SEQ
        AND     B.DMDT_DE_TERM_CD   = C.DMDT_DE_TERM_CD
        AND     B.TRF_GRP_SEQ       = C.TRF_GRP_SEQ
        AND     B.SYS_AREA_GRP_ID   = D.SYS_AREA_GRP_ID     (+)
        AND     B.DMDT_TRF_CD       = D.DMDT_TRF_CD         (+)
        AND     B.TRF_SEQ           = D.TRF_SEQ             (+)
        AND     B.DMDT_DE_TERM_CD   = D.DMDT_DE_TERM_CD     (+)
        AND     B.TRF_GRP_SEQ       = D.TRF_GRP_SEQ         (+)
        AND     B.SYS_AREA_GRP_ID   = E.SYS_AREA_GRP_ID     (+)
        AND     B.DMDT_TRF_CD       = E.DMDT_TRF_CD         (+)
        AND     B.TRF_SEQ           = E.TRF_SEQ             (+)
        AND     B.DMDT_DE_TERM_CD   = E.DMDT_DE_TERM_CD     (+)
        AND     B.TRF_GRP_SEQ       = E.TRF_GRP_SEQ         (+)
        AND     F.INTG_CD_VAL_CTNT  = C.DMDT_CNTR_TP_CD
        AND     G.INTG_CD_VAL_CTNT  = C.DMDT_CGO_TP_CD
        AND     F.INTG_CD_ID        = 'CD02053'
        AND     G.INTG_CD_ID        = 'CD01963'
        AND     B.CFM_FLG           = 'Y'
        #if (${dmdt_de_term_cd} != 'A')
        AND     B.DMDT_DE_TERM_CD   = @[dmdt_de_term_cd]
        #end
        #if (${cvrg_conti_cd} != '')
        AND     A.CVRG_CONTI_CD         = @[cvrg_conti_cd]
        #end
        #if (${cvrg_cnt_cd} != '')
        AND     A.CVRG_CNT_CD       = @[cvrg_cnt_cd]
        #end
        #if (${cvrg_cnt_cd} == 'US' || ${cvrg_cnt_cd} == 'CA')
        	#if (${cvrg_rgn_cd} != '')
        AND     A.CVRG_STE_CD       = @[cvrg_rgn_cd]
        	#end
        #else 
        	#if (${cvrg_rgn_cd} != '')
        AND     A.CVRG_RGN_CD       = @[cvrg_rgn_cd]
        	#end
        #end
        
        #if (${cvrg_loc_cd} != '')
        AND     A.CVRG_LOC_CD       = @[cvrg_loc_cd]
        #end
        #if (${cvrg_yd_cd} != '')
        AND     A.CVRG_YD_CD        = @[cvrg_yd_cd]
        #end
        #if (${org_dest_conti_cd} != '')
        AND     A.ORG_DEST_CONTI_CD = @[org_dest_conti_cd]
        #end
        #if (${org_dest_cnt_cd} != '')
        AND     A.ORG_DEST_CNT_CD   = @[org_dest_cnt_cd]
        #end
        #if (${org_dest_cnt_cd} == 'US' || ${org_dest_cnt_cd} == 'CA')
        	#if (${org_dest_rgn_cd} != '')
        AND     A.ORG_DEST_STE_CD   = @[org_dest_rgn_cd]
        	#end
        #else 
        	#if (${org_dest_rgn_cd} != '')
        AND     A.ORG_DEST_RGN_CD = @[org_dest_rgn_cd]
        	#end
        #end
        #if (${org_dest_loc_cd} != '')
        AND A.ORG_DEST_LOC_CD = @[org_dest_loc_cd]
        #end
        #if (${dmdt_trf_cd_in} == 'Y')
        	AND A.DMDT_TRF_CD IN (
            	#foreach( $dmdt_trf_cd in ${dmdt_trf_cd_list}) 
                	#if($velocityCount < $dmdt_trf_cd_list.size()) 
                   		'$dmdt_trf_cd', 
                	#else 
                   		'$dmdt_trf_cd' 
                	#end 
            	#end
            )
        #end
        #if (${dmdt_cntr_cgo_cd_in} == 'Y')
        AND (
        	#if(${dmdt_cntr_cgo_cd_size} == '1')
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd1] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd1])
        	#elseif(${dmdt_cntr_cgo_cd_size} == '2')
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd1] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd1])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd2] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd2])
        	#elseif(${dmdt_cntr_cgo_cd_size} == '3')
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd1] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd1])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd2] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd2])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd3] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd3])
        	#elseif(${dmdt_cntr_cgo_cd_size} == '4')
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd1] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd1])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd2] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd2])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd3] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd3])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd4] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd4])
        	#elseif(${dmdt_cntr_cgo_cd_size} == '5')
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd1] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd1])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd2] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd2])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd3] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd3])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd4] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd4])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd5] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd5])
        	#elseif(${dmdt_cntr_cgo_cd_size} == '6')
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd1] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd1])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd2] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd2])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd3] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd3])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd4] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd4])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd5] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd5])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd6] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd6])
        	#elseif(${dmdt_cntr_cgo_cd_size} == '7')
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd1] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd1])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd2] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd2])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd3] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd3])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd4] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd4])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd5] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd5])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd6] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd6])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd7] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd7])
        	#elseif(${dmdt_cntr_cgo_cd_size} == '8')
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd1] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd1])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd2] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd2])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd3] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd3])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd4] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd4])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd5] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd5])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd6] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd6])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd7] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd7])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd8] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd8])
        	#elseif(${dmdt_cntr_cgo_cd_size} == '9')
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd1] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd1])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd2] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd2])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd3] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd3])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd4] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd4])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd5] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd5])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd6] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd6])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd7] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd7])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd8] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd8])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd9] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd9])
        	#elseif(${dmdt_cntr_cgo_cd_size} == '10')
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd1] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd1])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd2] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd2])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd3] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd3])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd4] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd4])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd5] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd5])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd6] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd6])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd7] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd7])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd8] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd8])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd9] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd9])
        		OR
        		(C.DMDT_CNTR_TP_CD = @[dmdt_cntr_tp_cd10] AND C.DMDT_CGO_TP_CD = @[dmdt_cgo_tp_cd10])
        	#end
        )
        #end
        
        #if (${validity1} != '')
        AND ( TO_CHAR(EFF_DT,'YYYYMMDD') <= TO_CHAR(SYSDATE,'YYYYMMDD')
              AND NVL(TO_CHAR(EXP_DT,'YYYYMMDD'),'99991231') >= TO_CHAR(SYSDATE,'YYYYMMDD')
            #if (${validity2} != '')
        		OR (TO_CHAR(EFF_DT,'YYYYMMDD') > TO_CHAR(SYSDATE,'YYYYMMDD')
                    AND NVL(TO_CHAR(EXP_DT,'YYYYMMDD'),'99991231') >= TO_CHAR(SYSDATE,'YYYYMMDD'))
                #if (${validity3} != '')
        			OR (TO_CHAR(EXP_DT,'YYYYMMDD') <= TO_CHAR(SYSDATE,'YYYYMMDD'))
        		#end
        	#else
                #if (${validity3} != '')
        			OR (TO_CHAR(EXP_DT,'YYYYMMDD') <= TO_CHAR(SYSDATE,'YYYYMMDD'))
        		#end
            #end
        	)
        #else
        AND (
            #if (${validity2} != '')
        		TO_CHAR(EFF_DT,'YYYYMMDD') > TO_CHAR(SYSDATE,'YYYYMMDD')
                AND NVL(TO_CHAR(EXP_DT,'YYYYMMDD'),'99991231') >= TO_CHAR(SYSDATE,'YYYYMMDD')
        		#if (${validity3} != '')
        			OR (TO_CHAR(EXP_DT,'YYYYMMDD') <= TO_CHAR(SYSDATE,'YYYYMMDD'))
        		#end
        	#else
        		TO_CHAR(EXP_DT,'YYYYMMDD') <= TO_CHAR(SYSDATE,'YYYYMMDD')
            #end
        	)
        #end        
        ) X
WHERE   1=1 
#if (${exp_ofc_cd} != 'All')
  AND   X.PIC_TEAM = @[exp_ofc_cd]
#end
#if (${exist} != 'A')
  AND   EXIST = @[exist]
#end
ORDER BY DMDT_TRF_CD, COVRG, ORG_DEST, DMDT_DE_TERM_CD, DMDT_DE_TERM_NM 
     , DMDT_CNTR_TP_NM, DMDT_CGO_TP_NM, EFF_DT, EXP_DT
--ORDER BY DMDT_TRF_CD, LENGTH(COVRG),COVRG,ORG_DEST, DMDT_DE_TERM_CD, TRF_GRP_SEQ, EFF_DT, EXP_DT			]]></sql>
			<params>
				<param name="dmdt_de_term_cd" type="12" value="" out="N"/>
				<param name="cvrg_conti_cd" type="12" value="" out="N"/>
				<param name="cvrg_cnt_cd" type="12" value="" out="N"/>
				<param name="cvrg_rgn_cd" type="12" value="" out="N"/>
				<param name="cvrg_loc_cd" type="12" value="" out="N"/>
				<param name="cvrg_yd_cd" type="12" value="" out="N"/>
				<param name="org_dest_conti_cd" type="12" value="" out="N"/>
				<param name="org_dest_cnt_cd" type="12" value="" out="N"/>
				<param name="org_dest_rgn_cd" type="12" value="" out="N"/>
				<param name="org_dest_loc_cd" type="12" value="" out="N"/>
				<param name="dmdt_cntr_tp_cd1" type="12" value="" out="N"/>
				<param name="dmdt_cgo_tp_cd1" type="12" value="" out="N"/>
				<param name="dmdt_cntr_tp_cd2" type="12" value="" out="N"/>
				<param name="dmdt_cgo_tp_cd2" type="12" value="" out="N"/>
				<param name="dmdt_cntr_tp_cd3" type="12" value="" out="N"/>
				<param name="dmdt_cgo_tp_cd3" type="12" value="" out="N"/>
				<param name="dmdt_cntr_tp_cd4" type="12" value="" out="N"/>
				<param name="dmdt_cgo_tp_cd4" type="12" value="" out="N"/>
				<param name="dmdt_cntr_tp_cd5" type="12" value="" out="N"/>
				<param name="dmdt_cgo_tp_cd5" type="12" value="" out="N"/>
				<param name="dmdt_cntr_tp_cd6" type="12" value="" out="N"/>
				<param name="dmdt_cgo_tp_cd6" type="12" value="" out="N"/>
				<param name="dmdt_cntr_tp_cd7" type="12" value="" out="N"/>
				<param name="dmdt_cgo_tp_cd7" type="12" value="" out="N"/>
				<param name="dmdt_cntr_tp_cd8" type="12" value="" out="N"/>
				<param name="dmdt_cgo_tp_cd8" type="12" value="" out="N"/>
				<param name="dmdt_cntr_tp_cd9" type="12" value="" out="N"/>
				<param name="dmdt_cgo_tp_cd9" type="12" value="" out="N"/>
				<param name="dmdt_cntr_tp_cd10" type="12" value="" out="N"/>
				<param name="dmdt_cgo_tp_cd10" type="12" value="" out="N"/>
				<param name="exp_ofc_cd" type="12" value="" out="N"/>
				<param name="exist" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
