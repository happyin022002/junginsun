<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChargeAmountDiscountMgtDBDAOModifyVirtualInvoiceToCancelUSQL">
			<desc><![CDATA[ChargeAmountDiscountMgtDBDAOModifyVirtualInvoiceToCancelUSQL]]></desc>
			<sql><![CDATA[
update  DMT_INV_MN
   set  DMDT_VT_INV_STS_CD = 'X'
       ,VT_INV_USR_ID = @[upd_usr_id]
       ,VT_INV_UPD_DT = nvl(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[upd_ofc_cd]), sysdate)
 where  DMDT_INV_NO in
		(
			select  DMDT_INV_NO
			  from  DMT_AFT_BKG_ADJ_RQST      T1
				   ,DMT_AFT_BKG_ADJ_RQST_DTL  T2
                   ,DMT_AFT_BKG_CNTR		  T3
				   ,DMT_INV_MN                T4
			 where  T1.AFT_EXPT_DAR_NO    = @[aft_expt_dar_no]
			   and  T1.AFT_EXPT_DAR_NO    = T2.AFT_EXPT_DAR_NO

			   and  T2.AFT_EXPT_DAR_NO    = T3.AFT_EXPT_DAR_NO
			   and  T2.AFT_EXPT_ADJ_SEQ   = T3.AFT_EXPT_ADJ_SEQ
			   and  T3.SYS_AREA_GRP_ID    IN ( 'KOR', 'USA', 'CHN' )

			   and  T2.DMDT_TRF_CD        = T4.DMDT_TRF_CD
			   and  T2.BKG_NO             = T4.BKG_NO
			   and  T4.DMDT_INV_STS_CD    = 'X'
			   and  T4.DMDT_VT_INV_STS_CD = 'C'
		)			]]></sql>
			<params>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="upd_ofc_cd" type="12" value="" out="N"/>
				<param name="aft_expt_dar_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
