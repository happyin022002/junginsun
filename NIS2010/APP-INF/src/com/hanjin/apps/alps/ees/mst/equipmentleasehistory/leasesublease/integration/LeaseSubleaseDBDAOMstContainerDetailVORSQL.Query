<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="LeaseSubleaseDBDAOMstContainerDetailVORSQL">
			<desc><![CDATA[MstContainerDetailVO]]></desc>
			<sql><![CDATA[
SELECT 
       A.CNTR_NO,
       SUBSTR(A.CNTR_NO,11) CHK_DGT,
       A.CNTR_TPSZ_CD,
       A.LSTM_CD,
       A.CRNT_YD_CD,
       A.CNTR_USE_CO_CD,
       C.CNTR_STS_CD,
       TO_CHAR(C.CNTR_STS_EVNT_DT,'YYYY-MM-DD') AS CNTR_STS_EVNT_DT,
       C.YD_CD,
	   MST_COMMON_PKG.MST_AGMT_NO_CONV_FNC(C.AGMT_CTY_CD, C.AGMT_SEQ) AGMT_NO,
       G.REF_NO,
	   CASE WHEN C.CNTR_STS_CD IN ('SLD') 
	        THEN DECODE(NVL(C.CUST_CNT_CD,'0'), '0', '', C.CUST_CNT_CD||C.CUST_SEQ)
	   ELSE MST_COMMON_PKG.MST_VNDR_SEQ_CONV_FNC(G.VNDR_SEQ) END VNDR_SEQ,
	   CASE WHEN C.CNTR_STS_CD IN ('SLD') 
	        THEN DECODE(NVL(C.CUST_CNT_CD,'0'), '0', C.CUST_NM, (SELECT CUST_LGL_ENG_NM FROM MDM_CUSTOMER WHERE CUST_CNT_CD = C.CUST_CNT_CD AND CUST_SEQ = C.CUST_SEQ))
	   ELSE H.VNDR_LGL_ENG_NM END VNDR_LGL_ENG_NM,
       H.VNDR_ABBR_NM,
       DECODE(C.CNTR_FULL_FLG, 'Y', 'F', 'N', 'M', '') AS CNTR_FULL_FLG,
       C.CNMV_STS_CD,
       CASE WHEN C.CNTR_DRFF_CR_AMT > 0 THEN
          C.CNTR_DRFF_CR_AMT 
       ELSE  0 END CNTR_DRFF_AMT,
       CASE WHEN C.CNTR_DRFF_CR_AMT < 0 THEN
          C.CNTR_DRFF_CR_AMT * (-1)
       ELSE 0 END CNTR_DRFF_CR_AMT,   
       C.CNTR_LFT_CHG_AMT,
       C.CNTR_DIR_ITCHG_FEE_AMT,
	   C.CNTR_MIN_ONH_DYS,
       C.RNTL_CHG_FREE_DYS,
       CASE WHEN C.CNTR_PKUP_CHG_AMT > 0 THEN
          C.CNTR_PKUP_CHG_AMT 
       ELSE  0 END CNTR_PKUP_CHG_AMT,
       CASE WHEN C.CNTR_PKUP_CHG_AMT < 0 THEN
          C.CNTR_PKUP_CHG_AMT * (-1)
       ELSE 0 END CNTR_PKUP_CHG_CR_AMT, 
       C.CRE_USR_ID,
       C.UPD_USR_ID,
       C.CNTR_STS_RMK,
       C.CNMV_STS_CD,
       C.CURR_CD,
       TO_CHAR(C.CRE_DT, 'YYYY-MM-DD HH24:MI') CRE_DT,
       TO_CHAR(C.UPD_DT, 'YYYY-MM-DD HH24:MI') UPD_DT,
       '' EVNT_DT1,
       '' LOC_CD1,
       '' EVNT_DT2,
       '' LOC_CD2,
       '' STAY_DAYS,
       C.CNTR_LSTM_CNG_FLG
FROM MST_CONTAINER A, 
     MST_CNTR_STS_HIS C,
     LSE_AGREEMENT G,
     MDM_VENDOR H
WHERE 1 = 1
 #if(${noExit} == 'A')
        #if (${chk_dgt} == '')
        AND  A.CNTR_NO = @[cntr_no]
        #end
        #if (${chk_dgt} != '') 
        AND  A.CNTR_NO = @[cntr_no] || @[chk_dgt]
        #end 
    #end
    #if(${noExit} == 'E')
        #if (${chk_dgt} == '')
        AND  A.CNTR_NO = MST_COMMON_PKG.MST_CNTR_NO_FNC(@[cntr_no])
        #end
        #if (${chk_dgt} != '') 
        AND  A.CNTR_NO = @[cntr_no] || @[chk_dgt]
        #end 
    #end 
AND C.CNTR_NO = A.CNTR_NO
AND G.AGMT_CTY_CD(+) = C.AGMT_CTY_CD
AND G.AGMT_SEQ(+) = C.AGMT_SEQ
AND G.VNDR_SEQ = H.VNDR_SEQ(+)
ORDER BY C.CNTR_STS_EVNT_DT, C.CNTR_STS_SEQ			]]></sql>
			<params>
				<param name="cntr_no" type="12" value="" out="N"/>
				<param name="chk_dgt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
