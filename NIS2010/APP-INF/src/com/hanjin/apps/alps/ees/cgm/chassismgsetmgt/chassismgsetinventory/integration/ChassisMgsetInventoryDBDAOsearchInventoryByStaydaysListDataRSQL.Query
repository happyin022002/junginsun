<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChassisMgsetInventoryDBDAOsearchInventoryByStaydaysListDataRSQL">
			<desc><![CDATA[chungpa 20090728 1092 popup add]]></desc>
			<sql><![CDATA[
SELECT
    A.EQ_NO,
    A.EQ_TPSZ_CD,
    A.AGMT_LSTM_CD,
    A.AGMT_OFC_CTY_CD || LPAD(A.AGMT_SEQ, 6, '0') AS AGMT_NO,
    B.VNDR_ABBR_NM,
    A.CHSS_MVMT_STS_CD,
    D.LCC_CD,
    C.SCC_CD,
    A.CRNT_YD_CD,
    A.ONH_DT,
    A.CHSS_MVMT_DT,
    TRUNC(SYSDATE - A.CHSS_MVMT_DT,0) AS LSDAYS
FROM    
	CGM_EQUIPMENT A,
    CGM_EQ_STS_HIS t2,
#if (${atch_bare} != '')
	( SELECT A.EQ_NO FROM  CGM_EQ_ATCH_DTCH_HIS A
    	WHERE A.DTCH_DT = TO_DATE('88881231','YYYYMMDD')
	    GROUP BY A.EQ_NO
	   ) T8,
#end
    MDM_VENDOR B,
    MDM_LOCATION C,
    MDM_EQ_ORZ_CHT D
WHERE A.VNDR_SEQ = B.VNDR_SEQ(+)
#if (${atch_bare} != '')
	  AND A.EQ_NO= T8.EQ_NO(+)
#end
      AND A.CRNT_LOC_CD = C.LOC_CD
	  AND A.EQ_NO = t2.EQ_NO
      AND A.eq_sts_seq= t2.eq_sts_seq
      AND C.SCC_CD = D.SCC_CD
      AND C.DELT_FLG = 'N'
      AND D.DELT_FLG = 'N'
	  AND A.EQ_KND_CD = @[eq_knd_cd]
#if (${location} == 'RCC')
	AND D.RCC_CD = @[crnt_loc_cd]
#elseif (${location} == 'LCC')
	AND D.LCC_CD = @[crnt_loc_cd]
#elseif (${location} == 'SCC')
	AND D.SCC_CD = @[crnt_loc_cd]
#end
#if (${crnt_yd_cd} != '')
	AND A.CRNT_YD_CD IN ($crnt_yd_cd)
#end
#if (${aciac_div_cd} != '')
	AND A.ACIAC_DIV_CD = @[aciac_div_cd]
#end
#if (${chss_pool_cd} != 'I')
	#if (${chss_pool_cd} == 'E')
		AND A.CHSS_POOL_CD IS NULL
	#elseif (${chss_pool_cd} == 'O')
		AND A.CHSS_POOL_CD IS NOT NULL
	#else
		AND A.CHSS_POOL_CD = @[chss_pool_cd]
	#end
#end
#if (${include_np} != 'Y')
	AND A.AGMT_LSTM_CD <>'NP'
#end
#if (${staying_days} != '' && ${s_group1} == 'TotalColumn')
	AND A.CHSS_MVMT_DT < SYSDATE - TO_NUMBER(${staying_days})
#end
#if (${inq_fm_dys} != '')
	#if(${inq_to_dys} != '')
        AND sysdate - A.CHSS_MVMT_DT between TO_NUMBER(${inq_fm_dys}) and TO_NUMBER(${inq_to_dys})+1
	#else
		AND sysdate - A.CHSS_MVMT_DT > TO_NUMBER(${inq_fm_dys})
	#end
#end
#if (${eq_tpsz_cd} != '')
	AND A.EQ_TPSZ_CD IN ($eq_tpsz_cd) 
#end
#if (${agmt_lstm_cd} != '')
	AND A.AGMT_LSTM_CD IN ($agmt_lstm_cd)
#end
#if (${vndr_seq} != '')
	AND A.VNDR_SEQ IN ($vndr_seq)
#end
#if (${chss_mvmt_sts_cd} != '')
	AND A.CHSS_MVMT_STS_CD IN ($chss_mvmt_sts_cd)
#end
#if (${include_status_lst} == 'Y')
	AND t2.EQ_ASET_STS_CD = 'LST' 
#end   
#if (${include_out_gated} == 'Y')
	AND A.GATE_IO_CD = 'O' 
#end

#if (${atch_bare} == 'ATTACHED')
	AND	T8.EQ_NO IS NOT NULL
#elseif (${atch_bare} == 'BARE')
	AND T8.EQ_NO IS NULL  
#end

#if (${dmg_snd} == 'DAMAGE')
AND A.DMG_FLG = 'Y'
#elseif (${dmg_snd} == 'SOUND')
AND ((A.DMG_FLG <> 'Y') or (A.DMG_FLG IS NULL))
#end


#if ( ${s3_gtotal} == 'GTOTAL' )

#else
#if ( ${group1} == '1')
	AND A.EQ_TPSZ_CD = @[group_value1]
#elseif (${group1} == '2') 
	AND D.LCC_CD = @[group_value1]
#elseif (${group1} == '3') 
	AND A.ONH_OFC_CD = @[group_value1]
#elseif (${group1} == '4') 
	AND C.SCC_CD = @[group_value1]
#elseif (${group1} == '5') 
	AND A.CRNT_YD_CD = @[group_value1]
#elseif (${group1} == '6') 
	AND A.AGMT_LSTM_CD = @[group_value1]
#elseif (${group1} == '7') 
	AND A.VNDR_SEQ = SUBSTR(@[group_value1], INSTR(@[group_value1],'(')+1, 6)
#elseif (${group1} == '8') 
	AND A.CHSS_MVMT_STS_CD = @[group_value1]
#end
#end			]]></sql>
			<params>
				<param name="eq_knd_cd" type="12" value="" out="N"/>
				<param name="crnt_loc_cd" type="12" value="" out="N"/>
				<param name="aciac_div_cd" type="12" value="" out="N"/>
				<param name="chss_pool_cd" type="12" value="" out="N"/>
				<param name="group_value1" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
