<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AgreementRegistrationDBDAOcalculationInterrstDataRSQL">
			<desc><![CDATA[Interest calculation 조회]]></desc>
			<sql><![CDATA[
WITH  LV_PARA AS
(SELECT REPLACE (@[i_rate], ',', '') RATE,
        REPLACE (@[principal], ',', '') PV,      
        REPLACE (@[n_payment], ',', '') NPER, 
        DECODE(@[payment_term],'4','3','1') TERM,
		NVL(@[i_type],0) TYPE
FROM DUAL	
)
, LV_FIRST_DATA AS
(
SELECT RATE,
       PV,
       NPER,
       TERM,
       LSE_PMT_FNC(RATE,TERM,NPER,PV,TYPE) INSTALLMENT
FROM LV_PARA  
)
SELECT SEQ,
       LSE_RTN_AMT_FNC(1,RATE,TERM,PV,INSTALLMENT,SEQ,@[i_type]) BAL,
       LSE_RTN_AMT_FNC(2,RATE,TERM,PV,INSTALLMENT,SEQ,@[i_type]) PRINCIPAL,
       LSE_RTN_AMT_FNC(3,RATE,TERM,PV,INSTALLMENT,SEQ,@[i_type]) INTEREST ,
       INSTALLMENT
FROM LV_FIRST_DATA A , (SELECT LEVEL  SEQ FROM LV_PARA CONNECT BY LEVEL <= NPER)			]]></sql>
			<params>
				<param name="i_rate" type="12" value="" out="N"/>
				<param name="principal" type="12" value="" out="N"/>
				<param name="n_payment" type="12" value="" out="N"/>
				<param name="payment_term" type="12" value="" out="N"/>
				<param name="i_type" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
