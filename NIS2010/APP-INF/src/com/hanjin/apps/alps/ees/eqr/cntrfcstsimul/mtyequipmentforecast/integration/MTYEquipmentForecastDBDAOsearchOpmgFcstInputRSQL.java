/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : MTYEquipmentForecastDBDAOsearchOpmgFcstInputRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.02.18
*@LastModifier : 
*@LastVersion : 1.0
* 2016.02.18 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.ees.eqr.cntrfcstsimul.mtyequipmentforecast.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class MTYEquipmentForecastDBDAOsearchOpmgFcstInputRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * searchOpmgFcstInput
	  * - 2015.11.24 주차확대 : -3~+4 --> -3 ~ +6, 신용찬
	  * </pre>
	  */
	public MTYEquipmentForecastDBDAOsearchOpmgFcstInputRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("repo_pln_yrwk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("loc_grp_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("loc_cd",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.ees.eqr.cntrfcstsimul.mtyequipmentforecast.integration").append("\n"); 
		query.append("FileName : MTYEquipmentForecastDBDAOsearchOpmgFcstInputRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("WITH DUMMY_WEEK AS" ).append("\n"); 
		query.append("( " ).append("\n"); 
		query.append("    SELECT    W0, W1, W2, W3, W4, W5, W6, W7, W8, W9" ).append("\n"); 
		query.append("           ,CASE WHEN W1-C0 >=0 THEN 'Y' ELSE 'N' END W1_F" ).append("\n"); 
		query.append("           ,CASE WHEN W2-C0 >=0 THEN 'Y' ELSE 'N' END W2_F" ).append("\n"); 
		query.append("           ,CASE WHEN W3-C0 >=0 THEN 'Y' ELSE 'N' END W3_F" ).append("\n"); 
		query.append("           ,CASE WHEN W4-C0 >=0 THEN 'Y' ELSE 'N' END W4_F" ).append("\n"); 
		query.append("           ,CASE WHEN W5-C0 >=0 THEN 'Y' ELSE 'N' END W5_F" ).append("\n"); 
		query.append("           ,CASE WHEN W6-C0 >=0 THEN 'Y' ELSE 'N' END W6_F" ).append("\n"); 
		query.append("           ,CASE WHEN W7-C0 >=0 THEN 'Y' ELSE 'N' END W7_F  " ).append("\n"); 
		query.append("           ,CASE WHEN W8-C0 >=0 THEN 'Y' ELSE 'N' END W8_F    " ).append("\n"); 
		query.append("           ,CASE WHEN W9-C0 >=0 THEN 'Y' ELSE 'N' END W9_F     " ).append("\n"); 
		query.append("    FROM    " ).append("\n"); 
		query.append("    ( " ).append("\n"); 
		query.append("        SELECT  LAG(PLN_YR||PLN_WK,4)        OVER (ORDER BY PLN_YR,PLN_WK)    W0," ).append("\n"); 
		query.append("                LAG(PLN_YR||PLN_WK,3)        OVER (ORDER BY PLN_YR,PLN_WK)    W1," ).append("\n"); 
		query.append("                LAG(PLN_YR||PLN_WK,2)        OVER (ORDER BY PLN_YR,PLN_WK)    W2," ).append("\n"); 
		query.append("                LAG(PLN_YR||PLN_WK,1)        OVER (ORDER BY PLN_YR,PLN_WK)    W3," ).append("\n"); 
		query.append("                PLN_YR||PLN_WK                                                W4," ).append("\n"); 
		query.append("                LEAD(PLN_YR||PLN_WK,1)        OVER (ORDER BY PLN_YR,PLN_WK)    W5," ).append("\n"); 
		query.append("                LEAD(PLN_YR||PLN_WK,2)        OVER (ORDER BY PLN_YR,PLN_WK)    W6," ).append("\n"); 
		query.append("                LEAD(PLN_YR||PLN_WK,3)        OVER (ORDER BY PLN_YR,PLN_WK)    W7," ).append("\n"); 
		query.append("                LEAD(PLN_YR||PLN_WK,4)        OVER (ORDER BY PLN_YR,PLN_WK)    W8," ).append("\n"); 
		query.append("                LEAD(PLN_YR||PLN_WK,5)        OVER (ORDER BY PLN_YR,PLN_WK)    W9," ).append("\n"); 
		query.append("                (SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(SYSDATE, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT) C0 -- 오늘기준 EQR WEEK" ).append("\n"); 
		query.append("        FROM    EQR_WK_PRD" ).append("\n"); 
		query.append("    )" ).append("\n"); 
		query.append("    WHERE   W4  = @[repo_pln_yrwk]     -- BALANCE REPO ID 입력값" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT A.DP_SEQ " ).append("\n"); 
		query.append("      ,A.TITLE" ).append("\n"); 
		query.append("      ,A.MTY_BAL_TP_CD" ).append("\n"); 
		query.append("      ,A.LOC_CD" ).append("\n"); 
		query.append("      ,A.LOC_GRP_CD" ).append("\n"); 
		query.append("      ,A.W1_WK" ).append("\n"); 
		query.append("      ,A.W2_WK" ).append("\n"); 
		query.append("      ,A.W3_WK" ).append("\n"); 
		query.append("      ,A.W4_WK" ).append("\n"); 
		query.append("      ,A.W5_WK" ).append("\n"); 
		query.append("      ,A.W6_WK" ).append("\n"); 
		query.append("      ,A.W7_WK" ).append("\n"); 
		query.append("      ,A.W8_WK" ).append("\n"); 
		query.append("      ,A.W9_WK     " ).append("\n"); 
		query.append("      ,A.W1_F" ).append("\n"); 
		query.append("      ,A.W2_F" ).append("\n"); 
		query.append("      ,A.W3_F" ).append("\n"); 
		query.append("      ,A.W4_F" ).append("\n"); 
		query.append("      ,A.W5_F" ).append("\n"); 
		query.append("      ,A.W6_F" ).append("\n"); 
		query.append("      ,A.W7_F" ).append("\n"); 
		query.append("      ,A.W8_F" ).append("\n"); 
		query.append("      ,A.W9_F     " ).append("\n"); 
		query.append("      ,NVL(B.W1_D2,0) W1_D2" ).append("\n"); 
		query.append("      ,NVL(B.W1_D4,0) W1_D4" ).append("\n"); 
		query.append("      ,NVL(B.W1_D5,0) W1_D5" ).append("\n"); 
		query.append("      ,NVL(B.W1_D7,0) W1_D7" ).append("\n"); 
		query.append("      ,NVL(B.W1_R2,0) W1_R2" ).append("\n"); 
		query.append("      ,NVL(B.W1_R5,0) W1_R5" ).append("\n"); 
		query.append("      ,NVL(B.W1_R9,0) W1_R9" ).append("\n"); 
		query.append("      ,NVL(B.W1_O2,0) W1_O2" ).append("\n"); 
		query.append("      ,NVL(B.W1_S2,0) W1_S2" ).append("\n"); 
		query.append("      ,NVL(B.W1_O4,0) W1_O4" ).append("\n"); 
		query.append("      ,NVL(B.W1_S4,0) W1_S4" ).append("\n"); 
		query.append("      ,NVL(B.W1_F2,0) W1_F2" ).append("\n"); 
		query.append("      ,NVL(B.W1_A2,0) W1_A2" ).append("\n"); 
		query.append("      ,NVL(B.W1_F4,0) W1_F4" ).append("\n"); 
		query.append("      ,NVL(B.W1_A4,0) W1_A4" ).append("\n"); 
		query.append("      ,NVL(B.W1_A5,0) W1_A5" ).append("\n"); 
		query.append("      ,NVL(B.W1_F5,0) W1_F5" ).append("\n"); 
		query.append("      ,NVL(B.W1_O5,0) W1_O5" ).append("\n"); 
		query.append("      ,NVL(B.W2_D2,0) W2_D2" ).append("\n"); 
		query.append("      ,NVL(B.W2_D4,0) W2_D4" ).append("\n"); 
		query.append("      ,NVL(B.W2_D5,0) W2_D5" ).append("\n"); 
		query.append("      ,NVL(B.W2_D7,0) W2_D7" ).append("\n"); 
		query.append("      ,NVL(B.W2_R2,0) W2_R2" ).append("\n"); 
		query.append("      ,NVL(B.W2_R5,0) W2_R5" ).append("\n"); 
		query.append("      ,NVL(B.W2_R9,0) W2_R9" ).append("\n"); 
		query.append("      ,NVL(B.W2_O2,0) W2_O2" ).append("\n"); 
		query.append("      ,NVL(B.W2_S2,0) W2_S2" ).append("\n"); 
		query.append("      ,NVL(B.W2_O4,0) W2_O4" ).append("\n"); 
		query.append("      ,NVL(B.W2_S4,0) W2_S4" ).append("\n"); 
		query.append("      ,NVL(B.W2_F2,0) W2_F2" ).append("\n"); 
		query.append("      ,NVL(B.W2_A2,0) W2_A2" ).append("\n"); 
		query.append("      ,NVL(B.W2_F4,0) W2_F4" ).append("\n"); 
		query.append("      ,NVL(B.W2_A4,0) W2_A4" ).append("\n"); 
		query.append("      ,NVL(B.W2_A5,0) W2_A5" ).append("\n"); 
		query.append("      ,NVL(B.W2_F5,0) W2_F5" ).append("\n"); 
		query.append("      ,NVL(B.W2_O5,0) W2_O5" ).append("\n"); 
		query.append("      ,NVL(B.W3_D2,0) W3_D2" ).append("\n"); 
		query.append("      ,NVL(B.W3_D4,0) W3_D4" ).append("\n"); 
		query.append("      ,NVL(B.W3_D5,0) W3_D5" ).append("\n"); 
		query.append("      ,NVL(B.W3_D7,0) W3_D7" ).append("\n"); 
		query.append("      ,NVL(B.W3_R2,0) W3_R2" ).append("\n"); 
		query.append("      ,NVL(B.W3_R5,0) W3_R5" ).append("\n"); 
		query.append("      ,NVL(B.W3_R9,0) W3_R9" ).append("\n"); 
		query.append("      ,NVL(B.W3_O2,0) W3_O2" ).append("\n"); 
		query.append("      ,NVL(B.W3_S2,0) W3_S2" ).append("\n"); 
		query.append("      ,NVL(B.W3_O4,0) W3_O4" ).append("\n"); 
		query.append("      ,NVL(B.W3_S4,0) W3_S4" ).append("\n"); 
		query.append("      ,NVL(B.W3_F2,0) W3_F2" ).append("\n"); 
		query.append("      ,NVL(B.W3_A2,0) W3_A2" ).append("\n"); 
		query.append("      ,NVL(B.W3_F4,0) W3_F4" ).append("\n"); 
		query.append("      ,NVL(B.W3_A4,0) W3_A4" ).append("\n"); 
		query.append("      ,NVL(B.W3_A5,0) W3_A5" ).append("\n"); 
		query.append("      ,NVL(B.W3_F5,0) W3_F5" ).append("\n"); 
		query.append("      ,NVL(B.W3_O5,0) W3_O5" ).append("\n"); 
		query.append("      ,NVL(B.W4_D2,0) W4_D2" ).append("\n"); 
		query.append("      ,NVL(B.W4_D4,0) W4_D4" ).append("\n"); 
		query.append("      ,NVL(B.W4_D5,0) W4_D5" ).append("\n"); 
		query.append("      ,NVL(B.W4_D7,0) W4_D7" ).append("\n"); 
		query.append("      ,NVL(B.W4_R2,0) W4_R2" ).append("\n"); 
		query.append("      ,NVL(B.W4_R5,0) W4_R5" ).append("\n"); 
		query.append("      ,NVL(B.W4_R9,0) W4_R9" ).append("\n"); 
		query.append("      ,NVL(B.W4_O2,0) W4_O2" ).append("\n"); 
		query.append("      ,NVL(B.W4_S2,0) W4_S2" ).append("\n"); 
		query.append("      ,NVL(B.W4_O4,0) W4_O4" ).append("\n"); 
		query.append("      ,NVL(B.W4_S4,0) W4_S4" ).append("\n"); 
		query.append("      ,NVL(B.W4_F2,0) W4_F2" ).append("\n"); 
		query.append("      ,NVL(B.W4_A2,0) W4_A2" ).append("\n"); 
		query.append("      ,NVL(B.W4_F4,0) W4_F4" ).append("\n"); 
		query.append("      ,NVL(B.W4_A4,0) W4_A4" ).append("\n"); 
		query.append("      ,NVL(B.W4_A5,0) W4_A5" ).append("\n"); 
		query.append("      ,NVL(B.W4_F5,0) W4_F5" ).append("\n"); 
		query.append("      ,NVL(B.W4_O5,0) W4_O5" ).append("\n"); 
		query.append("      ,NVL(B.W5_D2,0) W5_D2" ).append("\n"); 
		query.append("      ,NVL(B.W5_D4,0) W5_D4" ).append("\n"); 
		query.append("      ,NVL(B.W5_D5,0) W5_D5" ).append("\n"); 
		query.append("      ,NVL(B.W5_D7,0) W5_D7" ).append("\n"); 
		query.append("      ,NVL(B.W5_R2,0) W5_R2" ).append("\n"); 
		query.append("      ,NVL(B.W5_R5,0) W5_R5" ).append("\n"); 
		query.append("      ,NVL(B.W5_R9,0) W5_R9" ).append("\n"); 
		query.append("      ,NVL(B.W5_O2,0) W5_O2" ).append("\n"); 
		query.append("      ,NVL(B.W5_S2,0) W5_S2" ).append("\n"); 
		query.append("      ,NVL(B.W5_O4,0) W5_O4" ).append("\n"); 
		query.append("      ,NVL(B.W5_S4,0) W5_S4" ).append("\n"); 
		query.append("      ,NVL(B.W5_F2,0) W5_F2" ).append("\n"); 
		query.append("      ,NVL(B.W5_A2,0) W5_A2" ).append("\n"); 
		query.append("      ,NVL(B.W5_F4,0) W5_F4" ).append("\n"); 
		query.append("      ,NVL(B.W5_A4,0) W5_A4" ).append("\n"); 
		query.append("      ,NVL(B.W5_A5,0) W5_A5" ).append("\n"); 
		query.append("      ,NVL(B.W5_F5,0) W5_F5" ).append("\n"); 
		query.append("      ,NVL(B.W5_O5,0) W5_O5" ).append("\n"); 
		query.append("      ,NVL(B.W6_D2,0) W6_D2" ).append("\n"); 
		query.append("      ,NVL(B.W6_D4,0) W6_D4" ).append("\n"); 
		query.append("      ,NVL(B.W6_D5,0) W6_D5" ).append("\n"); 
		query.append("      ,NVL(B.W6_D7,0) W6_D7" ).append("\n"); 
		query.append("      ,NVL(B.W6_R2,0) W6_R2" ).append("\n"); 
		query.append("      ,NVL(B.W6_R5,0) W6_R5" ).append("\n"); 
		query.append("      ,NVL(B.W6_R9,0) W6_R9" ).append("\n"); 
		query.append("      ,NVL(B.W6_O2,0) W6_O2" ).append("\n"); 
		query.append("      ,NVL(B.W6_S2,0) W6_S2" ).append("\n"); 
		query.append("      ,NVL(B.W6_O4,0) W6_O4" ).append("\n"); 
		query.append("      ,NVL(B.W6_S4,0) W6_S4" ).append("\n"); 
		query.append("      ,NVL(B.W6_F2,0) W6_F2" ).append("\n"); 
		query.append("      ,NVL(B.W6_A2,0) W6_A2" ).append("\n"); 
		query.append("      ,NVL(B.W6_F4,0) W6_F4" ).append("\n"); 
		query.append("      ,NVL(B.W6_A4,0) W6_A4" ).append("\n"); 
		query.append("      ,NVL(B.W6_A5,0) W6_A5" ).append("\n"); 
		query.append("      ,NVL(B.W6_F5,0) W6_F5" ).append("\n"); 
		query.append("      ,NVL(B.W6_O5,0) W6_O5" ).append("\n"); 
		query.append("      ,NVL(B.W7_D2,0) W7_D2" ).append("\n"); 
		query.append("      ,NVL(B.W7_D4,0) W7_D4" ).append("\n"); 
		query.append("      ,NVL(B.W7_D5,0) W7_D5" ).append("\n"); 
		query.append("      ,NVL(B.W7_D7,0) W7_D7" ).append("\n"); 
		query.append("      ,NVL(B.W7_R2,0) W7_R2" ).append("\n"); 
		query.append("      ,NVL(B.W7_R5,0) W7_R5" ).append("\n"); 
		query.append("      ,NVL(B.W7_R9,0) W7_R9" ).append("\n"); 
		query.append("      ,NVL(B.W7_O2,0) W7_O2" ).append("\n"); 
		query.append("      ,NVL(B.W7_S2,0) W7_S2" ).append("\n"); 
		query.append("      ,NVL(B.W7_O4,0) W7_O4" ).append("\n"); 
		query.append("      ,NVL(B.W7_S4,0) W7_S4" ).append("\n"); 
		query.append("      ,NVL(B.W7_F2,0) W7_F2" ).append("\n"); 
		query.append("      ,NVL(B.W7_A2,0) W7_A2" ).append("\n"); 
		query.append("      ,NVL(B.W7_F4,0) W7_F4" ).append("\n"); 
		query.append("      ,NVL(B.W7_A4,0) W7_A4" ).append("\n"); 
		query.append("      ,NVL(B.W7_A5,0) W7_A5" ).append("\n"); 
		query.append("      ,NVL(B.W7_F5,0) W7_F5" ).append("\n"); 
		query.append("      ,NVL(B.W7_O5,0) W7_O5" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      ,NVL(B.W8_D2,0) W8_D2" ).append("\n"); 
		query.append("      ,NVL(B.W8_D4,0) W8_D4" ).append("\n"); 
		query.append("      ,NVL(B.W8_D5,0) W8_D5" ).append("\n"); 
		query.append("      ,NVL(B.W8_D7,0) W8_D7" ).append("\n"); 
		query.append("      ,NVL(B.W8_R2,0) W8_R2" ).append("\n"); 
		query.append("      ,NVL(B.W8_R5,0) W8_R5" ).append("\n"); 
		query.append("      ,NVL(B.W8_R9,0) W8_R9" ).append("\n"); 
		query.append("      ,NVL(B.W8_O2,0) W8_O2" ).append("\n"); 
		query.append("      ,NVL(B.W8_S2,0) W8_S2" ).append("\n"); 
		query.append("      ,NVL(B.W8_O4,0) W8_O4" ).append("\n"); 
		query.append("      ,NVL(B.W8_S4,0) W8_S4" ).append("\n"); 
		query.append("      ,NVL(B.W8_F2,0) W8_F2" ).append("\n"); 
		query.append("      ,NVL(B.W8_A2,0) W8_A2" ).append("\n"); 
		query.append("      ,NVL(B.W8_F4,0) W8_F4" ).append("\n"); 
		query.append("      ,NVL(B.W8_A4,0) W8_A4" ).append("\n"); 
		query.append("      ,NVL(B.W8_A5,0) W8_A5" ).append("\n"); 
		query.append("      ,NVL(B.W8_F5,0) W8_F5" ).append("\n"); 
		query.append("      ,NVL(B.W8_O5,0) W8_O5" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,NVL(B.W9_D2,0) W9_D2" ).append("\n"); 
		query.append("      ,NVL(B.W9_D4,0) W9_D4" ).append("\n"); 
		query.append("      ,NVL(B.W9_D5,0) W9_D5" ).append("\n"); 
		query.append("      ,NVL(B.W9_D7,0) W9_D7" ).append("\n"); 
		query.append("      ,NVL(B.W9_R2,0) W9_R2" ).append("\n"); 
		query.append("      ,NVL(B.W9_R5,0) W9_R5" ).append("\n"); 
		query.append("      ,NVL(B.W9_R9,0) W9_R9" ).append("\n"); 
		query.append("      ,NVL(B.W9_O2,0) W9_O2" ).append("\n"); 
		query.append("      ,NVL(B.W9_S2,0) W9_S2" ).append("\n"); 
		query.append("      ,NVL(B.W9_O4,0) W9_O4" ).append("\n"); 
		query.append("      ,NVL(B.W9_S4,0) W9_S4" ).append("\n"); 
		query.append("      ,NVL(B.W9_F2,0) W9_F2" ).append("\n"); 
		query.append("      ,NVL(B.W9_A2,0) W9_A2" ).append("\n"); 
		query.append("      ,NVL(B.W9_F4,0) W9_F4" ).append("\n"); 
		query.append("      ,NVL(B.W9_A4,0) W9_A4" ).append("\n"); 
		query.append("      ,NVL(B.W9_A5,0) W9_A5" ).append("\n"); 
		query.append("      ,NVL(B.W9_F5,0) W9_F5" ).append("\n"); 
		query.append("      ,NVL(B.W9_O5,0) W9_O5     " ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("    SELECT A.DP_SEQ" ).append("\n"); 
		query.append("          ,A.TITLE" ).append("\n"); 
		query.append("          ,A.MTY_BAL_TP_CD" ).append("\n"); 
		query.append("          ,@[loc_cd]     LOC_CD" ).append("\n"); 
		query.append("          ,@[loc_grp_cd] LOC_GRP_CD" ).append("\n"); 
		query.append("          ,C.W1 W1_WK" ).append("\n"); 
		query.append("          ,C.W2 W2_WK" ).append("\n"); 
		query.append("          ,C.W3 W3_WK" ).append("\n"); 
		query.append("          ,C.W4 W4_WK" ).append("\n"); 
		query.append("          ,C.W5 W5_WK" ).append("\n"); 
		query.append("          ,C.W6 W6_WK" ).append("\n"); 
		query.append("          ,C.W7 W7_WK" ).append("\n"); 
		query.append("          ,C.W8 W8_WK" ).append("\n"); 
		query.append("          ,C.W9 W9_WK" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("          ,C.W1_F" ).append("\n"); 
		query.append("          ,C.W2_F" ).append("\n"); 
		query.append("          ,C.W3_F" ).append("\n"); 
		query.append("          ,C.W4_F" ).append("\n"); 
		query.append("          ,C.W5_F" ).append("\n"); 
		query.append("          ,C.W6_F" ).append("\n"); 
		query.append("          ,C.W7_F" ).append("\n"); 
		query.append("          ,C.W8_F" ).append("\n"); 
		query.append("          ,C.W9_F     " ).append("\n"); 
		query.append("    FROM " ).append("\n"); 
		query.append("    (" ).append("\n"); 
		query.append("                  SELECT 1  DP_SEQ, 'Inventory'      TITLE, ''  MTY_BAL_TP_CD  FROM DUAL" ).append("\n"); 
		query.append("        UNION ALL SELECT 2  DP_SEQ, 'MG FCST'        TITLE, '1' MTY_BAL_TP_CD  FROM DUAL" ).append("\n"); 
		query.append("        UNION ALL SELECT 3  DP_SEQ, 'MG PFMC'        TITLE, ''  MTY_BAL_TP_CD  FROM DUAL" ).append("\n"); 
		query.append("        UNION ALL SELECT 4  DP_SEQ, 'Repo In'        TITLE, ''  MTY_BAL_TP_CD  FROM DUAL" ).append("\n"); 
		query.append("        UNION ALL SELECT 5  DP_SEQ, 'OW&On-hire'     TITLE, '6' MTY_BAL_TP_CD  FROM DUAL" ).append("\n"); 
		query.append("        UNION ALL SELECT 6  DP_SEQ, '+Others'        TITLE, '2' MTY_BAL_TP_CD  FROM DUAL" ).append("\n"); 
		query.append("        UNION ALL SELECT 7  DP_SEQ, 'OP FCST'        TITLE, '3' MTY_BAL_TP_CD  FROM DUAL" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        -- 2014-11-18 EQ Forecast 프로젝트 " ).append("\n"); 
		query.append("--        UNION ALL SELECT 8  DP_SEQ, 'OP PFMC'        TITLE, ''  MTY_BAL_TP_CD  FROM DUAL" ).append("\n"); 
		query.append("--        UNION ALL SELECT 9  DP_SEQ, 'Repo Out'       TITLE, ''  MTY_BAL_TP_CD  FROM DUAL" ).append("\n"); 
		query.append("        UNION ALL SELECT 8  DP_SEQ, 'OP FCST(Sales)' TITLE, ''  MTY_BAL_TP_CD  FROM DUAL" ).append("\n"); 
		query.append("        UNION ALL SELECT 9  DP_SEQ, 'OP PFMC'        TITLE, ''  MTY_BAL_TP_CD  FROM DUAL" ).append("\n"); 
		query.append("        UNION ALL SELECT 10 DP_SEQ, 'Repo Out'       TITLE, ''  MTY_BAL_TP_CD  FROM DUAL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    ) A " ).append("\n"); 
		query.append("    ,DUMMY_WEEK C " ).append("\n"); 
		query.append(") A  " ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("    SELECT A.DP_SEQ" ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(D2_QTY,0))) W1_D2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(D4_QTY,0))) W1_D4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(D5_QTY,0))) W1_D5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(D7_QTY,0))) W1_D7 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(R2_QTY,0))) W1_R2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(R5_QTY,0))) W1_R5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(R9_QTY,0))) W1_R9 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(O2_QTY,0))) W1_O2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(S2_QTY,0))) W1_S2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(O4_QTY,0))) W1_O4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(S4_QTY,0))) W1_S4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(F2_QTY,0))) W1_F2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(A2_QTY,0))) W1_A2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(F4_QTY,0))) W1_F4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(A4_QTY,0))) W1_A4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(A5_QTY,0))) W1_A5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(F5_QTY,0))) W1_F5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W1, NVL(O5_QTY,0))) W1_O5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(D2_QTY,0))) W2_D2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(D4_QTY,0))) W2_D4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(D5_QTY,0))) W2_D5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(D7_QTY,0))) W2_D7 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(R2_QTY,0))) W2_R2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(R5_QTY,0))) W2_R5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(R9_QTY,0))) W2_R9 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(O2_QTY,0))) W2_O2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(S2_QTY,0))) W2_S2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(O4_QTY,0))) W2_O4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(S4_QTY,0))) W2_S4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(F2_QTY,0))) W2_F2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(A2_QTY,0))) W2_A2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(F4_QTY,0))) W2_F4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(A4_QTY,0))) W2_A4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(A5_QTY,0))) W2_A5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(F5_QTY,0))) W2_F5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W2, NVL(O5_QTY,0))) W2_O5" ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(D2_QTY,0))) W3_D2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(D4_QTY,0))) W3_D4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(D5_QTY,0))) W3_D5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(D7_QTY,0))) W3_D7 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(R2_QTY,0))) W3_R2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(R5_QTY,0))) W3_R5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(R9_QTY,0))) W3_R9 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(O2_QTY,0))) W3_O2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(S2_QTY,0))) W3_S2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(O4_QTY,0))) W3_O4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(S4_QTY,0))) W3_S4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(F2_QTY,0))) W3_F2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(A2_QTY,0))) W3_A2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(F4_QTY,0))) W3_F4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(A4_QTY,0))) W3_A4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(A5_QTY,0))) W3_A5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(F5_QTY,0))) W3_F5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W3, NVL(O5_QTY,0))) W3_O5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(D2_QTY,0))) W4_D2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(D4_QTY,0))) W4_D4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(D5_QTY,0))) W4_D5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(D7_QTY,0))) W4_D7 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(R2_QTY,0))) W4_R2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(R5_QTY,0))) W4_R5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(R9_QTY,0))) W4_R9 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(O2_QTY,0))) W4_O2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(S2_QTY,0))) W4_S2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(O4_QTY,0))) W4_O4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(S4_QTY,0))) W4_S4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(F2_QTY,0))) W4_F2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(A2_QTY,0))) W4_A2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(F4_QTY,0))) W4_F4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(A4_QTY,0))) W4_A4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(A5_QTY,0))) W4_A5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(F5_QTY,0))) W4_F5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W4, NVL(O5_QTY,0))) W4_O5" ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(D2_QTY,0))) W5_D2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(D4_QTY,0))) W5_D4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(D5_QTY,0))) W5_D5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(D7_QTY,0))) W5_D7 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(R2_QTY,0))) W5_R2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(R5_QTY,0))) W5_R5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(R9_QTY,0))) W5_R9 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(O2_QTY,0))) W5_O2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(S2_QTY,0))) W5_S2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(O4_QTY,0))) W5_O4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(S4_QTY,0))) W5_S4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(F2_QTY,0))) W5_F2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(A2_QTY,0))) W5_A2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(F4_QTY,0))) W5_F4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(A4_QTY,0))) W5_A4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(A5_QTY,0))) W5_A5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(F5_QTY,0))) W5_F5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W5, NVL(O5_QTY,0))) W5_O5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(D2_QTY,0))) W6_D2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(D4_QTY,0))) W6_D4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(D5_QTY,0))) W6_D5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(D7_QTY,0))) W6_D7 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(R2_QTY,0))) W6_R2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(R5_QTY,0))) W6_R5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(R9_QTY,0))) W6_R9 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(O2_QTY,0))) W6_O2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(S2_QTY,0))) W6_S2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(O4_QTY,0))) W6_O4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(S4_QTY,0))) W6_S4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(F2_QTY,0))) W6_F2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(A2_QTY,0))) W6_A2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(F4_QTY,0))) W6_F4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(A4_QTY,0))) W6_A4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(A5_QTY,0))) W6_A5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(F5_QTY,0))) W6_F5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W6, NVL(O5_QTY,0))) W6_O5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(D2_QTY,0))) W7_D2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(D4_QTY,0))) W7_D4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(D5_QTY,0))) W7_D5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(D7_QTY,0))) W7_D7 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(R2_QTY,0))) W7_R2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(R5_QTY,0))) W7_R5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(R9_QTY,0))) W7_R9 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(O2_QTY,0))) W7_O2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(S2_QTY,0))) W7_S2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(O4_QTY,0))) W7_O4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(S4_QTY,0))) W7_S4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(F2_QTY,0))) W7_F2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(A2_QTY,0))) W7_A2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(F4_QTY,0))) W7_F4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(A4_QTY,0))) W7_A4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(A5_QTY,0))) W7_A5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(F5_QTY,0))) W7_F5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W7, NVL(O5_QTY,0))) W7_O5" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(D2_QTY,0))) W8_D2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(D4_QTY,0))) W8_D4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(D5_QTY,0))) W8_D5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(D7_QTY,0))) W8_D7 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(R2_QTY,0))) W8_R2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(R5_QTY,0))) W8_R5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(R9_QTY,0))) W8_R9 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(O2_QTY,0))) W8_O2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(S2_QTY,0))) W8_S2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(O4_QTY,0))) W8_O4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(S4_QTY,0))) W8_S4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(F2_QTY,0))) W8_F2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(A2_QTY,0))) W8_A2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(F4_QTY,0))) W8_F4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(A4_QTY,0))) W8_A4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(A5_QTY,0))) W8_A5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(F5_QTY,0))) W8_F5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W8, NVL(O5_QTY,0))) W8_O5" ).append("\n"); 
		query.append("          " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(D2_QTY,0))) W9_D2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(D4_QTY,0))) W9_D4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(D5_QTY,0))) W9_D5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(D7_QTY,0))) W9_D7 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(R2_QTY,0))) W9_R2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(R5_QTY,0))) W9_R5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(R9_QTY,0))) W9_R9 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(O2_QTY,0))) W9_O2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(S2_QTY,0))) W9_S2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(O4_QTY,0))) W9_O4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(S4_QTY,0))) W9_S4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(F2_QTY,0))) W9_F2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(A2_QTY,0))) W9_A2 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(F4_QTY,0))) W9_F4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(A4_QTY,0))) W9_A4 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(A5_QTY,0))) W9_A5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(F5_QTY,0))) W9_F5 " ).append("\n"); 
		query.append("          ,SUM(DECODE(A.WEEK, C.W9, NVL(O5_QTY,0))) W9_O5   " ).append("\n"); 
		query.append("    FROM DUMMY_WEEK C,    " ).append("\n"); 
		query.append("    (   " ).append("\n"); 
		query.append("        -- INVENTORY ----------------------------------------------------------------------------" ).append("\n"); 
		query.append("        SELECT 1 DP_SEQ" ).append("\n"); 
		query.append("              ,A.BSE_DT WEEK                  " ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'D2',CNTR_QTY,0)) D2_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'D4',CNTR_QTY,0)) D4_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'D5',CNTR_QTY,0)) D5_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'D7',CNTR_QTY,0)) D7_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'R2',CNTR_QTY,0)) R2_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'R5',CNTR_QTY,0)) R5_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'R9',CNTR_QTY,0)) R9_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'O2',CNTR_QTY,0)) O2_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'S2',CNTR_QTY,0)) S2_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'O4',CNTR_QTY,0)) O4_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'S4',CNTR_QTY,0)) S4_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'F2',CNTR_QTY,0)) F2_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'A2',CNTR_QTY,0)) A2_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'F4',CNTR_QTY,0)) F4_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'A4',CNTR_QTY,0)) A4_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'A5',CNTR_QTY,0)) A5_QTY" ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'F5',CNTR_QTY,0)) F5_QTY " ).append("\n"); 
		query.append("              ,SUM(DECODE(A.CNTR_TPSZ_CD,'O5',CNTR_QTY,0)) O5_QTY " ).append("\n"); 
		query.append("        FROM  CIM_ETC_INVT A" ).append("\n"); 
		query.append("             ,DUMMY_WEEK B" ).append("\n"); 
		query.append("        WHERE A.CO_CD          = 'H'  -- 하드코딩" ).append("\n"); 
		query.append("        AND   A.LOC_GRP_CD     = @[loc_grp_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("        AND   A.INVT_USE_TP_CD = '1'  -- 하드코딩" ).append("\n"); 
		query.append("        AND   A.BSE_DT         BETWEEN B.W1 AND B.W9  -- -3WEEK~+9WEEK" ).append("\n"); 
		query.append("        AND   A.LOC_CD         = @[loc_cd]" ).append("\n"); 
		query.append("        GROUP BY A.BSE_DT" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        -- MG FCST ----------------------------------------------------------------------------" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT 2 DP_SEQ" ).append("\n"); 
		query.append("              ,A.FCAST_YRWK WEEK                  " ).append("\n"); 
		query.append("              ,NVL(A.D2_FCAST_QTY,0) D2_QTY" ).append("\n"); 
		query.append("              ,NVL(A.D4_FCAST_QTY,0) D4_QTY" ).append("\n"); 
		query.append("              ,NVL(A.D5_FCAST_QTY,0) D5_QTY" ).append("\n"); 
		query.append("              ,NVL(A.D7_FCAST_QTY,0) D7_QTY" ).append("\n"); 
		query.append("              ,NVL(A.R2_FCAST_QTY,0) R2_QTY" ).append("\n"); 
		query.append("              ,NVL(A.R5_FCAST_QTY,0) R5_QTY" ).append("\n"); 
		query.append("              ,NVL(A.R9_FCAST_QTY,0) R9_QTY" ).append("\n"); 
		query.append("              ,NVL(A.O2_FCAST_QTY,0) O2_QTY" ).append("\n"); 
		query.append("              ,NVL(A.S2_FCAST_QTY,0) S2_QTY" ).append("\n"); 
		query.append("              ,NVL(A.O4_FCAST_QTY,0) O4_QTY" ).append("\n"); 
		query.append("              ,NVL(A.S4_FCAST_QTY,0) S4_QTY" ).append("\n"); 
		query.append("              ,NVL(A.F2_FCAST_QTY,0) F2_QTY" ).append("\n"); 
		query.append("              ,NVL(A.A2_FCAST_QTY,0) A2_QTY" ).append("\n"); 
		query.append("              ,NVL(A.F4_FCAST_QTY,0) F4_QTY" ).append("\n"); 
		query.append("              ,NVL(A.A4_FCAST_QTY,0) A4_QTY" ).append("\n"); 
		query.append("              ,NVL(A.A5_FCAST_QTY,0) A5_QTY" ).append("\n"); 
		query.append("              ,NVL(A.F5_FCAST_QTY,0) F5_QTY" ).append("\n"); 
		query.append("              ,NVL(A.O5_FCAST_QTY,0) O5_QTY" ).append("\n"); 
		query.append("        FROM  EQR_CTRL_MTY_BAL_RPT A" ).append("\n"); 
		query.append("             ,DUMMY_WEEK B" ).append("\n"); 
		query.append("        WHERE A.CO_CD          = 'H'" ).append("\n"); 
		query.append("        AND   A.LOC_GRP_CD     = @[loc_grp_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("        AND   A.LOC_CD         = @[loc_cd]        " ).append("\n"); 
		query.append("        AND   A.MTY_BAL_TP_CD  = '1'  -- MG FCST" ).append("\n"); 
		query.append("        AND   (" ).append("\n"); 
		query.append("                    A.INP_YRWK = B.W3  -- CURRENT WEEK ~ +5WEEK" ).append("\n"); 
		query.append("                 OR (A.INP_YRWK = B.W2 AND A.FCAST_YRWK = B.W3) -- -1WEEK" ).append("\n"); 
		query.append("                 OR (A.INP_YRWK = B.W1 AND A.FCAST_YRWK = B.W2) -- -2WEEK" ).append("\n"); 
		query.append("                 OR (A.INP_YRWK = B.W0 AND A.FCAST_YRWK = B.W1) -- -3WEEK" ).append("\n"); 
		query.append("              )" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        -- MG PFMC ----------------------------------------------------------------------------" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT 3 DP_SEQ" ).append("\n"); 
		query.append("              ,A.FCAST_YRWK WEEK " ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D2', A.CNTR_QTY) ,0)) D2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D4', A.CNTR_QTY) ,0)) D4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D5', A.CNTR_QTY) ,0)) D5_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D7', A.CNTR_QTY) ,0)) D7_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R2', A.CNTR_QTY) ,0)) R2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R5', A.CNTR_QTY) ,0)) R5_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R9', A.CNTR_QTY) ,0)) R9_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O2', A.CNTR_QTY) ,0)) O2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S2', A.CNTR_QTY) ,0)) S2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O4', A.CNTR_QTY) ,0)) O4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S4', A.CNTR_QTY) ,0)) S4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F2', A.CNTR_QTY) ,0)) F2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A2', A.CNTR_QTY) ,0)) A2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F4', A.CNTR_QTY) ,0)) F4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A4', A.CNTR_QTY) ,0)) A4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A5', A.CNTR_QTY) ,0)) A5_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F5', A.CNTR_QTY) ,0)) F5_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O5', A.CNTR_QTY) ,0)) O5_QTY" ).append("\n"); 
		query.append("        FROM EQR_CTRL_MTY_WKY_SIM A" ).append("\n"); 
		query.append("            ,DUMMY_WEEK B" ).append("\n"); 
		query.append("        WHERE A.LOC_GRP_CD     = @[loc_grp_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("        AND   A.LOC_CD         = @[loc_cd]" ).append("\n"); 
		query.append("        AND   A.FCAST_YRWK < (" ).append("\n"); 
		query.append("                                                SELECT PLN_YR||PLN_WK WEEK" ).append("\n"); 
		query.append("                                                FROM EQR_WK_PRD" ).append("\n"); 
		query.append("                                                WHERE WK_ST_DT  <= TO_CHAR(SYSDATE, 'YYYYMMDD')" ).append("\n"); 
		query.append("                                                AND   WK_END_DT >= TO_CHAR(SYSDATE, 'YYYYMMDD')" ).append("\n"); 
		query.append("                              )  -- SYSDATE 현재주차" ).append("\n"); 
		query.append("        AND   A.FCAST_YRWK  BETWEEN B.W1 AND B.W9 -- 화면주차" ).append("\n"); 
		query.append("        AND   A.WKY_SIM_TP_CD = 'IF'  -- MG FCST  " ).append("\n"); 
		query.append("        GROUP BY A.FCAST_YRWK" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("                      " ).append("\n"); 
		query.append("        -- REPO IN ---------------------------------------------------------------------------- " ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT 4 DP_SEQ" ).append("\n"); 
		query.append("              ,A.WEEK WEEK" ).append("\n"); 
		query.append("              ,SUM(NVL(A.D2_QTY,0)) D2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.D4_QTY,0)) D4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.D5_QTY,0)) D5_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.D7_QTY,0)) D7_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.R2_QTY,0)) R2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.R5_QTY,0)) R5_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.R9_QTY,0)) R9_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.O2_QTY,0)) O2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.S2_QTY,0)) S2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.O4_QTY,0)) O4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.S4_QTY,0)) S4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.F2_QTY,0)) F2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.A2_QTY,0)) A2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.F4_QTY,0)) F4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.A4_QTY,0)) A4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.A5_QTY,0)) A5_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.F5_QTY,0)) F5_QTY " ).append("\n"); 
		query.append("              ,SUM(NVL(A.O5_QTY,0)) O5_QTY " ).append("\n"); 
		query.append("       FROM" ).append("\n"); 
		query.append("       (    " ).append("\n"); 
		query.append("            SELECT ROW_NUMBER() OVER(PARTITION BY WEEK ORDER BY DP_SEQ ASC) RN" ).append("\n"); 
		query.append("                  ,WEEK" ).append("\n"); 
		query.append("                  ,D2_QTY" ).append("\n"); 
		query.append("                  ,D4_QTY" ).append("\n"); 
		query.append("                  ,D5_QTY" ).append("\n"); 
		query.append("                  ,D7_QTY" ).append("\n"); 
		query.append("                  ,R2_QTY" ).append("\n"); 
		query.append("                  ,R5_QTY" ).append("\n"); 
		query.append("                  ,R9_QTY" ).append("\n"); 
		query.append("                  ,O2_QTY" ).append("\n"); 
		query.append("                  ,S2_QTY" ).append("\n"); 
		query.append("                  ,O4_QTY" ).append("\n"); 
		query.append("                  ,S4_QTY" ).append("\n"); 
		query.append("                  ,F2_QTY" ).append("\n"); 
		query.append("                  ,A2_QTY" ).append("\n"); 
		query.append("                  ,F4_QTY" ).append("\n"); 
		query.append("                  ,A4_QTY" ).append("\n"); 
		query.append("                  ,A5_QTY" ).append("\n"); 
		query.append("                  ,F5_QTY" ).append("\n"); 
		query.append("                  ,O5_QTY" ).append("\n"); 
		query.append("            FROM" ).append("\n"); 
		query.append("            (" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                -- 과거주차는 EQR_CTRL_MTY_WKY_SIM( RI ) 추출 (진짜과거주차)" ).append("\n"); 
		query.append("                SELECT 1 DP_SEQ" ).append("\n"); 
		query.append("                      ,A.FCAST_YRWK WEEK " ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D2', A.CNTR_QTY) ,0)) D2_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D4', A.CNTR_QTY) ,0)) D4_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D5', A.CNTR_QTY) ,0)) D5_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D7', A.CNTR_QTY) ,0)) D7_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R2', A.CNTR_QTY) ,0)) R2_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R5', A.CNTR_QTY) ,0)) R5_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R9', A.CNTR_QTY) ,0)) R9_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O2', A.CNTR_QTY) ,0)) O2_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S2', A.CNTR_QTY) ,0)) S2_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O4', A.CNTR_QTY) ,0)) O4_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S4', A.CNTR_QTY) ,0)) S4_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F2', A.CNTR_QTY) ,0)) F2_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A2', A.CNTR_QTY) ,0)) A2_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F4', A.CNTR_QTY) ,0)) F4_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A4', A.CNTR_QTY) ,0)) A4_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A5', A.CNTR_QTY) ,0)) A5_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F5', A.CNTR_QTY) ,0)) F5_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O5', A.CNTR_QTY) ,0)) O5_QTY" ).append("\n"); 
		query.append("                      " ).append("\n"); 
		query.append("                FROM EQR_CTRL_MTY_WKY_SIM A" ).append("\n"); 
		query.append("                    ,DUMMY_WEEK B" ).append("\n"); 
		query.append("                WHERE A.LOC_GRP_CD     = @[loc_grp_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                AND   A.LOC_CD         = @[loc_cd]   " ).append("\n"); 
		query.append("                AND   A.FCAST_YRWK < (" ).append("\n"); 
		query.append("                                                    SELECT PLN_YR||PLN_WK WEEK" ).append("\n"); 
		query.append("                                                    FROM EQR_WK_PRD" ).append("\n"); 
		query.append("                                                    WHERE WK_ST_DT  <= TO_CHAR(SYSDATE, 'YYYYMMDD')" ).append("\n"); 
		query.append("                                                    AND   WK_END_DT >= TO_CHAR(SYSDATE, 'YYYYMMDD')" ).append("\n"); 
		query.append("                                      )  -- SYSDATE 현재주차" ).append("\n"); 
		query.append("                AND   A.FCAST_YRWK BETWEEN B.W1 AND B.W3 -- 과거3개주차 자리" ).append("\n"); 
		query.append("                AND   A.WKY_SIM_TP_CD  = 'RI'  -- REPO IN (VD만 해당)  " ).append("\n"); 
		query.append("                GROUP BY A.FCAST_YRWK   " ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("                -- -3W부터 +5W REPO IN SNAPSHOT" ).append("\n"); 
		query.append("                UNION ALL" ).append("\n"); 
		query.append("                SELECT 2 DP_SEQ" ).append("\n"); 
		query.append("                      ,A.WEEK WEEK                  " ).append("\n"); 
		query.append("                      ,SUM(NVL(A.D2_QTY,0)) D2_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.D4_QTY,0)) D4_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.D5_QTY,0)) D5_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.D7_QTY,0)) D7_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.R2_QTY,0)) R2_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.R5_QTY,0)) R5_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.R9_QTY,0)) R9_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.O2_QTY,0)) O2_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.S2_QTY,0)) S2_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.O4_QTY,0)) O4_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.S4_QTY,0)) S4_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.F2_QTY,0)) F2_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.A2_QTY,0)) A2_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.F4_QTY,0)) F4_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.A4_QTY,0)) A4_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.A5_QTY,0)) A5_QTY" ).append("\n"); 
		query.append("                      ,SUM(NVL(A.F5_QTY,0)) F5_QTY " ).append("\n"); 
		query.append("                      ,SUM(NVL(A.O5_QTY,0)) O5_QTY " ).append("\n"); 
		query.append("                   FROM" ).append("\n"); 
		query.append("                   (" ).append("\n"); 
		query.append("                    -- <-3W~-1W> -----------------------------------------------------------------------------------       " ).append("\n"); 
		query.append("                    SELECT A.VSL_LANE_CD" ).append("\n"); 
		query.append("                          ,A.VSL_CD" ).append("\n"); 
		query.append("                          ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("                          ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("                          ,A.YD_CD" ).append("\n"); 
		query.append("                          ,A.ETB_DT " ).append("\n"); 
		query.append("                          ,(" ).append("\n"); 
		query.append("                              SELECT PLN_YR||PLN_WK " ).append("\n"); 
		query.append("                              FROM EQR_WK_PRD " ).append("\n"); 
		query.append("                              WHERE WK_ST_DT <= TO_CHAR(A.ETB_DT + B.ADD_DYS, 'YYYYMMDD')" ).append("\n"); 
		query.append("                              AND   WK_END_DT >= TO_CHAR(A.ETB_DT + B.ADD_DYS, 'YYYYMMDD')" ).append("\n"); 
		query.append("                           ) WEEK -- 가중치 적용 WEEK환산" ).append("\n"); 
		query.append("                          ,NVL(A.D2_FCAST_QTY,0) D2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.D4_FCAST_QTY,0) D4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.D5_FCAST_QTY,0) D5_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.D7_FCAST_QTY,0) D7_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.R2_FCAST_QTY,0) R2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.R5_FCAST_QTY,0) R5_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.R9_FCAST_QTY,0) R9_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.O2_FCAST_QTY,0) O2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.S2_FCAST_QTY,0) S2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.O4_FCAST_QTY,0) O4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.S4_FCAST_QTY,0) S4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.F2_FCAST_QTY,0) F2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.A2_FCAST_QTY,0) A2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.F4_FCAST_QTY,0) F4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.A4_FCAST_QTY,0) A4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.A5_FCAST_QTY,0) A5_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.F5_FCAST_QTY,0) F5_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.O5_FCAST_QTY,0) O5_QTY" ).append("\n"); 
		query.append("                    FROM EQR_CTRL_REPO_SNAP A" ).append("\n"); 
		query.append("                        ,(" ).append("\n"); 
		query.append("                             SELECT REPO_ADD_DYS AS ADD_DYS" ).append("\n"); 
		query.append("                             FROM" ).append("\n"); 
		query.append("                             (" ).append("\n"); 
		query.append("                                 SELECT A.REPO_ADD_DYS" ).append("\n"); 
		query.append("                                 FROM EQR_WK_PRD_ADD_DY A," ).append("\n"); 
		query.append("                                      (" ).append("\n"); 
		query.append("                                          SELECT DISTINCT LCC_CD " ).append("\n"); 
		query.append("                                          FROM MDM_EQ_ORZ_CHT " ).append("\n"); 
		query.append("                                #if(${loc_grp_cd} == 'S')" ).append("\n"); 
		query.append("                                          WHERE SCC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                #elseif(${loc_grp_cd} == 'E')" ).append("\n"); 
		query.append("                                          WHERE ECC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                #elseif(${loc_grp_cd} == 'L')" ).append("\n"); 
		query.append("                                          WHERE LCC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                #end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                      ) B" ).append("\n"); 
		query.append("                                 WHERE A.LCC_CD = B.LCC_CD" ).append("\n"); 
		query.append("                                 UNION " ).append("\n"); 
		query.append("                                 SELECT 0 REPO_ADD_DYS FROM DUAL " ).append("\n"); 
		query.append("                                 ORDER BY REPO_ADD_DYS DESC  " ).append("\n"); 
		query.append("                             )" ).append("\n"); 
		query.append("                             WHERE ROWNUM=1     " ).append("\n"); 
		query.append("                        ) B" ).append("\n"); 
		query.append("                        ,(" ).append("\n"); 
		query.append("                             SELECT C.YD_CD" ).append("\n"); 
		query.append("                                  , A.SCC_CD" ).append("\n"); 
		query.append("                             FROM MDM_EQ_ORZ_CHT A" ).append("\n"); 
		query.append("                                 ,MDM_LOCATION B" ).append("\n"); 
		query.append("                                 ,MDM_YARD C                         " ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                        #if(${loc_grp_cd} == 'S')" ).append("\n"); 
		query.append("                             WHERE A.SCC_CD = @[loc_cd]     -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                        #elseif(${loc_grp_cd} == 'E')" ).append("\n"); 
		query.append("                             WHERE A.ECC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                        #elseif(${loc_grp_cd} == 'L')" ).append("\n"); 
		query.append("                             WHERE A.LCC_CD = @[loc_cd]     -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                        #end                                                   " ).append("\n"); 
		query.append("                             AND   A.SCC_CD = B.SCC_CD" ).append("\n"); 
		query.append("                             AND   B.LOC_CD = C.LOC_CD" ).append("\n"); 
		query.append("                        ) C" ).append("\n"); 
		query.append("                        ,DUMMY_WEEK D" ).append("\n"); 
		query.append("                    WHERE A.ETB_DT >= (SELECT TO_DATE(WK_ST_DT,  'YYYYMMDD') -B.ADD_DYS           FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = D.W1) -- 1번째 week" ).append("\n"); 
		query.append("                    AND   A.ETB_DT <= (SELECT TO_DATE(WK_END_DT, 'YYYYMMDD') -B.ADD_DYS +0.99999  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = D.W3) -- 3번째 week" ).append("\n"); 
		query.append("                    AND   A.YD_CD = C.YD_CD    " ).append("\n"); 
		query.append("                    AND   A.INTR_ASIA_FLG = 'N' --  WORLD VERSION, 2015-11-10, 신용찬, CHM-201537372" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    -- <Current Week> ----------------------------------------------------------------------------" ).append("\n"); 
		query.append("		#if(${curr_flag} =='T')      -- 입력주차 =현재주차" ).append("\n"); 
		query.append("                    -- 입력주차 =현재주차 : RI 수량 - VD 수량 빼기(결과값이 0보다 작으면 0처리)     " ).append("\n"); 
		query.append("                    UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    SELECT B.VSL_LANE_CD" ).append("\n"); 
		query.append("                          ,B.VSL_CD" ).append("\n"); 
		query.append("                          ,B.SKD_VOY_NO" ).append("\n"); 
		query.append("                          ,B.SKD_DIR_CD" ).append("\n"); 
		query.append("                          ,B.YD_CD " ).append("\n"); 
		query.append("                          ,B.ETB_DT    " ).append("\n"); 
		query.append("                          ,D.W4     WEEK                " ).append("\n"); 
		query.append("                           -- RI 수량 - VD 수량 빼기(결과값이 0보다 작으면 0처리)                                                                                     " ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.D2_QTY,0)-NVL(A.D2_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.D2_QTY,0)-NVL(A.D2_QTY,0)) END D2_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.D4_QTY,0)-NVL(A.D4_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.D4_QTY,0)-NVL(A.D4_QTY,0)) END D4_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.D5_QTY,0)-NVL(A.D5_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.D5_QTY,0)-NVL(A.D5_QTY,0)) END D5_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.D7_QTY,0)-NVL(A.D7_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.D7_QTY,0)-NVL(A.D7_QTY,0)) END D7_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.R2_QTY,0)-NVL(A.R2_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.R2_QTY,0)-NVL(A.R2_QTY,0)) END R2_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.R5_QTY,0)-NVL(A.R5_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.R5_QTY,0)-NVL(A.R5_QTY,0)) END R5_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.R9_QTY,0)-NVL(A.R9_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.R9_QTY,0)-NVL(A.R9_QTY,0)) END R9_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.O2_QTY,0)-NVL(A.O2_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.O2_QTY,0)-NVL(A.O2_QTY,0)) END O2_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.S2_QTY,0)-NVL(A.S2_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.S2_QTY,0)-NVL(A.S2_QTY,0)) END S2_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.O4_QTY,0)-NVL(A.O4_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.O4_QTY,0)-NVL(A.O4_QTY,0)) END O4_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.S4_QTY,0)-NVL(A.S4_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.S4_QTY,0)-NVL(A.S4_QTY,0)) END S4_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.F2_QTY,0)-NVL(A.F2_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.F2_QTY,0)-NVL(A.F2_QTY,0)) END F2_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.A2_QTY,0)-NVL(A.A2_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.A2_QTY,0)-NVL(A.A2_QTY,0)) END A2_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.F4_QTY,0)-NVL(A.F4_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.F4_QTY,0)-NVL(A.F4_QTY,0)) END F4_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.A4_QTY,0)-NVL(A.A4_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.A4_QTY,0)-NVL(A.A4_QTY,0)) END A4_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.A5_QTY,0)-NVL(A.A5_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.A5_QTY,0)-NVL(A.A5_QTY,0)) END A5_QTY" ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.F5_QTY,0)-NVL(A.F5_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.F5_QTY,0)-NVL(A.F5_QTY,0)) END F5_QTY                                   " ).append("\n"); 
		query.append("                          ,CASE WHEN SUM(NVL(B.O5_QTY,0)-NVL(A.O5_QTY,0)) < 0 THEN 0 ELSE SUM(NVL(B.O5_QTY,0)-NVL(A.O5_QTY,0)) END O5_QTY    " ).append("\n"); 
		query.append("				    FROM " ).append("\n"); 
		query.append("				    (" ).append("\n"); 
		query.append("					-- VD 수량" ).append("\n"); 
		query.append("                    SELECT A.VSL_LANE_CD" ).append("\n"); 
		query.append("                          ,A.VSL_CD" ).append("\n"); 
		query.append("                          ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("                          ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("                          ,A.YD_CD" ).append("\n"); 
		query.append("                          ,A.ETD_DT ETB_DT" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D2', A.CNTR_QTY) ,0)) D2_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D4', A.CNTR_QTY) ,0)) D4_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D5', A.CNTR_QTY) ,0)) D5_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D7', A.CNTR_QTY) ,0)) D7_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R2', A.CNTR_QTY) ,0)) R2_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R5', A.CNTR_QTY) ,0)) R5_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R9', A.CNTR_QTY) ,0)) R9_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O2', A.CNTR_QTY) ,0)) O2_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S2', A.CNTR_QTY) ,0)) S2_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O4', A.CNTR_QTY) ,0)) O4_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S4', A.CNTR_QTY) ,0)) S4_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F2', A.CNTR_QTY) ,0)) F2_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A2', A.CNTR_QTY) ,0)) A2_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F4', A.CNTR_QTY) ,0)) F4_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A4', A.CNTR_QTY) ,0)) A4_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A5', A.CNTR_QTY) ,0)) A5_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F5', A.CNTR_QTY) ,0)) F5_QTY" ).append("\n"); 
		query.append("                          ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O5', A.CNTR_QTY) ,0)) O5_QTY  " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    FROM EQR_CTRL_BAL_RPT_DCHG_SNAP A" ).append("\n"); 
		query.append("                        ,(" ).append("\n"); 
		query.append("                             SELECT REPO_ADD_DYS AS ADD_DYS" ).append("\n"); 
		query.append("                             FROM" ).append("\n"); 
		query.append("                             (" ).append("\n"); 
		query.append("                                 SELECT A.REPO_ADD_DYS" ).append("\n"); 
		query.append("                                 FROM EQR_WK_PRD_ADD_DY A," ).append("\n"); 
		query.append("                                      (" ).append("\n"); 
		query.append("                                          SELECT DISTINCT LCC_CD " ).append("\n"); 
		query.append("                                          FROM MDM_EQ_ORZ_CHT " ).append("\n"); 
		query.append("                                #if(${loc_grp_cd} == 'S')" ).append("\n"); 
		query.append("                                          WHERE SCC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                #elseif(${loc_grp_cd} == 'E')" ).append("\n"); 
		query.append("                                          WHERE ECC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                #elseif(${loc_grp_cd} == 'L')" ).append("\n"); 
		query.append("                                          WHERE LCC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                #end " ).append("\n"); 
		query.append("                                      ) B" ).append("\n"); 
		query.append("                                 WHERE A.LCC_CD = B.LCC_CD" ).append("\n"); 
		query.append("                                 UNION " ).append("\n"); 
		query.append("                                 SELECT 0 REPO_ADD_DYS FROM DUAL " ).append("\n"); 
		query.append("                                 ORDER BY REPO_ADD_DYS DESC  " ).append("\n"); 
		query.append("                             )" ).append("\n"); 
		query.append("                             WHERE ROWNUM=1     " ).append("\n"); 
		query.append("                        ) B" ).append("\n"); 
		query.append("                        ,(" ).append("\n"); 
		query.append("                             SELECT C.YD_CD, A.SCC_CD" ).append("\n"); 
		query.append("                             FROM MDM_EQ_ORZ_CHT A,MDM_LOCATION B,MDM_YARD C                         " ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                        #if(${loc_grp_cd} == 'S')" ).append("\n"); 
		query.append("                             WHERE A.SCC_CD = @[loc_cd]     -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                        #elseif(${loc_grp_cd} == 'E')" ).append("\n"); 
		query.append("                             WHERE A.ECC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                        #elseif(${loc_grp_cd} == 'L')" ).append("\n"); 
		query.append("                             WHERE A.LCC_CD = @[loc_cd]     -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                        #end                                                   " ).append("\n"); 
		query.append("                             AND   A.SCC_CD = B.SCC_CD" ).append("\n"); 
		query.append("                             AND   B.LOC_CD = C.LOC_CD" ).append("\n"); 
		query.append("                        ) C" ).append("\n"); 
		query.append("                        ,DUMMY_WEEK D" ).append("\n"); 
		query.append("                    WHERE A.ETD_DT >= (SELECT TO_DATE(WK_ST_DT,  'YYYYMMDD') -B.ADD_DYS           FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = D.W4) -- 4번째 week" ).append("\n"); 
		query.append("                    AND   A.ETD_DT <= (SELECT TO_DATE(WK_END_DT, 'YYYYMMDD') -B.ADD_DYS +0.99999  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = D.W4) -- 4번째 week" ).append("\n"); 
		query.append("                    AND   A.YD_CD = C.YD_CD  " ).append("\n"); 
		query.append("                    GROUP BY A.VSL_LANE_CD" ).append("\n"); 
		query.append("                            ,A.VSL_CD" ).append("\n"); 
		query.append("                            ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("                            ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("                            ,A.YD_CD" ).append("\n"); 
		query.append("                            ,A.ETD_DT " ).append("\n"); 
		query.append("				    ) A" ).append("\n"); 
		query.append("				   ,(" ).append("\n"); 
		query.append("                        -- RI수량" ).append("\n"); 
		query.append("                        SELECT A.VSL_LANE_CD" ).append("\n"); 
		query.append("                              ,A.VSL_CD" ).append("\n"); 
		query.append("                              ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("                              ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("                              ,A.YD_CD" ).append("\n"); 
		query.append("                              ,A.ETB_DT" ).append("\n"); 
		query.append("                              ,NVL(A.D2_FCAST_QTY,0) D2_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.D4_FCAST_QTY,0) D4_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.D5_FCAST_QTY,0) D5_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.D7_FCAST_QTY,0) D7_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.R2_FCAST_QTY,0) R2_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.R5_FCAST_QTY,0) R5_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.R9_FCAST_QTY,0) R9_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.O2_FCAST_QTY,0) O2_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.S2_FCAST_QTY,0) S2_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.O4_FCAST_QTY,0) O4_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.S4_FCAST_QTY,0) S4_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.F2_FCAST_QTY,0) F2_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.A2_FCAST_QTY,0) A2_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.F4_FCAST_QTY,0) F4_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.A4_FCAST_QTY,0) A4_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.A5_FCAST_QTY,0) A5_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.F5_FCAST_QTY,0) F5_QTY" ).append("\n"); 
		query.append("                              ,NVL(A.O5_FCAST_QTY,0) O5_QTY" ).append("\n"); 
		query.append("                        FROM EQR_CTRL_REPO_SNAP A" ).append("\n"); 
		query.append("                            ,(" ).append("\n"); 
		query.append("                                 SELECT REPO_ADD_DYS AS ADD_DYS" ).append("\n"); 
		query.append("                                 FROM" ).append("\n"); 
		query.append("                                 (" ).append("\n"); 
		query.append("                                     SELECT A.REPO_ADD_DYS" ).append("\n"); 
		query.append("                                     FROM EQR_WK_PRD_ADD_DY A," ).append("\n"); 
		query.append("                                          (" ).append("\n"); 
		query.append("                                              SELECT DISTINCT LCC_CD " ).append("\n"); 
		query.append("                                              FROM MDM_EQ_ORZ_CHT " ).append("\n"); 
		query.append("                                    #if(${loc_grp_cd} == 'S')" ).append("\n"); 
		query.append("                                              WHERE SCC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                    #elseif(${loc_grp_cd} == 'E')" ).append("\n"); 
		query.append("                                              WHERE ECC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                    #elseif(${loc_grp_cd} == 'L')" ).append("\n"); 
		query.append("                                              WHERE LCC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                    #end " ).append("\n"); 
		query.append("                            " ).append("\n"); 
		query.append("                                          ) B" ).append("\n"); 
		query.append("                                     WHERE A.LCC_CD = B.LCC_CD" ).append("\n"); 
		query.append("                                     UNION " ).append("\n"); 
		query.append("                                     SELECT 0 REPO_ADD_DYS FROM DUAL " ).append("\n"); 
		query.append("                                     ORDER BY REPO_ADD_DYS DESC  " ).append("\n"); 
		query.append("                                 )" ).append("\n"); 
		query.append("                                 WHERE ROWNUM=1     " ).append("\n"); 
		query.append("                            ) B" ).append("\n"); 
		query.append("                            ,(" ).append("\n"); 
		query.append("                                 SELECT C.YD_CD, A.SCC_CD" ).append("\n"); 
		query.append("                                 FROM MDM_EQ_ORZ_CHT A,MDM_LOCATION B,MDM_YARD C                         " ).append("\n"); 
		query.append("                                 " ).append("\n"); 
		query.append("                            #if(${loc_grp_cd} == 'S')" ).append("\n"); 
		query.append("                                 WHERE A.SCC_CD = @[loc_cd]     -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                            #elseif(${loc_grp_cd} == 'E')" ).append("\n"); 
		query.append("                                 WHERE A.ECC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                            #elseif(${loc_grp_cd} == 'L')" ).append("\n"); 
		query.append("                                 WHERE A.LCC_CD = @[loc_cd]     -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                            #end                                                   " ).append("\n"); 
		query.append("                                 AND   A.SCC_CD = B.SCC_CD" ).append("\n"); 
		query.append("                                 AND   B.LOC_CD = C.LOC_CD" ).append("\n"); 
		query.append("                            ) C" ).append("\n"); 
		query.append("                            ,DUMMY_WEEK D" ).append("\n"); 
		query.append("                        WHERE A.ETB_DT >= (SELECT TO_DATE(WK_ST_DT,  'YYYYMMDD') -B.ADD_DYS           FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = D.W4) -- 4번째 week" ).append("\n"); 
		query.append("                        AND   A.ETB_DT <= (SELECT TO_DATE(WK_END_DT, 'YYYYMMDD') -B.ADD_DYS +0.99999  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = D.W4) -- 4번째 week" ).append("\n"); 
		query.append("                        AND   A.YD_CD = C.YD_CD " ).append("\n"); 
		query.append("                        AND   A.INTR_ASIA_FLG = 'N' --  WORLD VERSION, 2015-11-10, 신용찬, CHM-201537372  " ).append("\n"); 
		query.append("				    ) B" ).append("\n"); 
		query.append("                    ,DUMMY_WEEK D " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    WHERE  A.VSL_CD     (+) = B.VSL_CD" ).append("\n"); 
		query.append("                    AND    A.SKD_VOY_NO (+) = B.SKD_VOY_NO" ).append("\n"); 
		query.append("                    AND    A.SKD_DIR_CD (+) = B.SKD_DIR_CD" ).append("\n"); 
		query.append("                    AND    A.VSL_LANE_CD(+) = B.VSL_LANE_CD" ).append("\n"); 
		query.append("                    AND    A.YD_CD      (+) = B.YD_CD" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("                    GROUP BY B.VSL_LANE_CD" ).append("\n"); 
		query.append("                          ,B.VSL_CD" ).append("\n"); 
		query.append("                          ,B.SKD_VOY_NO" ).append("\n"); 
		query.append("                          ,B.SKD_DIR_CD" ).append("\n"); 
		query.append("                          ,B.YD_CD " ).append("\n"); 
		query.append("                          ,B.ETB_DT" ).append("\n"); 
		query.append("                          ,D.W4  " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        #elseif(${curr_flag} =='F')  -- 입력주차<>현재주차" ).append("\n"); 
		query.append("                    -- 입력주차<>현재주차 : RI 수량 (EQR_CTRL_REPO_SNAP 에서만 추출)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    UNION ALL" ).append("\n"); 
		query.append("                    SELECT A.VSL_LANE_CD" ).append("\n"); 
		query.append("                          ,A.VSL_CD" ).append("\n"); 
		query.append("                          ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("                          ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("                          ,A.YD_CD" ).append("\n"); 
		query.append("                          ,A.ETB_DT    " ).append("\n"); 
		query.append("                          ,(" ).append("\n"); 
		query.append("                              SELECT PLN_YR||PLN_WK " ).append("\n"); 
		query.append("                              FROM EQR_WK_PRD " ).append("\n"); 
		query.append("                              WHERE WK_ST_DT <= TO_CHAR(A.ETB_DT + B.ADD_DYS, 'YYYYMMDD')" ).append("\n"); 
		query.append("                              AND   WK_END_DT >= TO_CHAR(A.ETB_DT + B.ADD_DYS, 'YYYYMMDD')" ).append("\n"); 
		query.append("                           ) WEEK -- 가중치 적용 WEEK환산" ).append("\n"); 
		query.append("                          ,NVL(A.D2_FCAST_QTY,0) D2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.D4_FCAST_QTY,0) D4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.D5_FCAST_QTY,0) D5_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.D7_FCAST_QTY,0) D7_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.R2_FCAST_QTY,0) R2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.R5_FCAST_QTY,0) R5_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.R9_FCAST_QTY,0) R9_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.O2_FCAST_QTY,0) O2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.S2_FCAST_QTY,0) S2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.O4_FCAST_QTY,0) O4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.S4_FCAST_QTY,0) S4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.F2_FCAST_QTY,0) F2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.A2_FCAST_QTY,0) A2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.F4_FCAST_QTY,0) F4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.A4_FCAST_QTY,0) A4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.A5_FCAST_QTY,0) A5_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.F5_FCAST_QTY,0) F5_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.O5_FCAST_QTY,0) O5_QTY" ).append("\n"); 
		query.append("                    FROM EQR_CTRL_REPO_SNAP A" ).append("\n"); 
		query.append("                        ,(" ).append("\n"); 
		query.append("                             SELECT REPO_ADD_DYS AS ADD_DYS" ).append("\n"); 
		query.append("                             FROM" ).append("\n"); 
		query.append("                             (" ).append("\n"); 
		query.append("                                 SELECT A.REPO_ADD_DYS" ).append("\n"); 
		query.append("                                 FROM EQR_WK_PRD_ADD_DY A," ).append("\n"); 
		query.append("                                      (" ).append("\n"); 
		query.append("                                          SELECT DISTINCT LCC_CD " ).append("\n"); 
		query.append("                                          FROM MDM_EQ_ORZ_CHT " ).append("\n"); 
		query.append("                                #if(${loc_grp_cd} == 'S')" ).append("\n"); 
		query.append("                                          WHERE SCC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                #elseif(${loc_grp_cd} == 'E')" ).append("\n"); 
		query.append("                                          WHERE ECC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                #elseif(${loc_grp_cd} == 'L')" ).append("\n"); 
		query.append("                                          WHERE LCC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                #end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                      ) B" ).append("\n"); 
		query.append("                                 WHERE A.LCC_CD = B.LCC_CD" ).append("\n"); 
		query.append("                                 UNION " ).append("\n"); 
		query.append("                                 SELECT 0 REPO_ADD_DYS FROM DUAL " ).append("\n"); 
		query.append("                                 ORDER BY REPO_ADD_DYS DESC  " ).append("\n"); 
		query.append("                             )" ).append("\n"); 
		query.append("                             WHERE ROWNUM=1     " ).append("\n"); 
		query.append("                        ) B" ).append("\n"); 
		query.append("                        ,(" ).append("\n"); 
		query.append("                             SELECT C.YD_CD, A.SCC_CD" ).append("\n"); 
		query.append("                             FROM MDM_EQ_ORZ_CHT A,MDM_LOCATION B,MDM_YARD C                         " ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                        #if(${loc_grp_cd} == 'S')" ).append("\n"); 
		query.append("                             WHERE A.SCC_CD = @[loc_cd]     -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                        #elseif(${loc_grp_cd} == 'E')" ).append("\n"); 
		query.append("                             WHERE A.ECC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                        #elseif(${loc_grp_cd} == 'L')" ).append("\n"); 
		query.append("                             WHERE A.LCC_CD = @[loc_cd]     -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                        #end                                                   " ).append("\n"); 
		query.append("                             AND   A.SCC_CD = B.SCC_CD" ).append("\n"); 
		query.append("                             AND   B.LOC_CD = C.LOC_CD" ).append("\n"); 
		query.append("                        ) C" ).append("\n"); 
		query.append("                        ,DUMMY_WEEK D" ).append("\n"); 
		query.append("                    WHERE A.ETB_DT >= (SELECT TO_DATE(WK_ST_DT,  'YYYYMMDD') -B.ADD_DYS           FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = D.W4) -- 4번째 week" ).append("\n"); 
		query.append("                    AND   A.ETB_DT <= (SELECT TO_DATE(WK_END_DT, 'YYYYMMDD') -B.ADD_DYS +0.99999  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = D.W4) -- 4번째 week" ).append("\n"); 
		query.append("                    AND   A.YD_CD = C.YD_CD  " ).append("\n"); 
		query.append("                    AND   A.INTR_ASIA_FLG = 'N' --  WORLD VERSION, 2015-11-10, 신용찬, CHM-201537372  " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    -- <1W~7W> -----------------------------------------------------------------------------------       " ).append("\n"); 
		query.append("                    UNION ALL" ).append("\n"); 
		query.append("                    SELECT A.VSL_LANE_CD" ).append("\n"); 
		query.append("                          ,A.VSL_CD" ).append("\n"); 
		query.append("                          ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("                          ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("                          ,A.YD_CD" ).append("\n"); 
		query.append("                          ,A.ETB_DT  " ).append("\n"); 
		query.append("                          ,(" ).append("\n"); 
		query.append("                              SELECT PLN_YR||PLN_WK " ).append("\n"); 
		query.append("                              FROM EQR_WK_PRD " ).append("\n"); 
		query.append("                              WHERE WK_ST_DT <= TO_CHAR(A.ETB_DT + B.ADD_DYS, 'YYYYMMDD')" ).append("\n"); 
		query.append("                              AND   WK_END_DT >= TO_CHAR(A.ETB_DT + B.ADD_DYS, 'YYYYMMDD')" ).append("\n"); 
		query.append("                           ) WEEK -- 가중치 적용 WEEK환산" ).append("\n"); 
		query.append("                          ,NVL(A.D2_FCAST_QTY,0) D2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.D4_FCAST_QTY,0) D4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.D5_FCAST_QTY,0) D5_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.D7_FCAST_QTY,0) D7_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.R2_FCAST_QTY,0) R2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.R5_FCAST_QTY,0) R5_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.R9_FCAST_QTY,0) R9_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.O2_FCAST_QTY,0) O2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.S2_FCAST_QTY,0) S2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.O4_FCAST_QTY,0) O4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.S4_FCAST_QTY,0) S4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.F2_FCAST_QTY,0) F2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.A2_FCAST_QTY,0) A2_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.F4_FCAST_QTY,0) F4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.A4_FCAST_QTY,0) A4_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.A5_FCAST_QTY,0) A5_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.F5_FCAST_QTY,0) F5_QTY" ).append("\n"); 
		query.append("                          ,NVL(A.O5_FCAST_QTY,0) O5_QTY" ).append("\n"); 
		query.append("                    FROM EQR_CTRL_REPO_SNAP A" ).append("\n"); 
		query.append("                        ,(" ).append("\n"); 
		query.append("                             SELECT REPO_ADD_DYS AS ADD_DYS" ).append("\n"); 
		query.append("                             FROM" ).append("\n"); 
		query.append("                             (" ).append("\n"); 
		query.append("                                 SELECT A.REPO_ADD_DYS" ).append("\n"); 
		query.append("                                 FROM EQR_WK_PRD_ADD_DY A," ).append("\n"); 
		query.append("                                      (" ).append("\n"); 
		query.append("                                          SELECT DISTINCT LCC_CD " ).append("\n"); 
		query.append("                                          FROM MDM_EQ_ORZ_CHT " ).append("\n"); 
		query.append("                                #if(${loc_grp_cd} == 'S')" ).append("\n"); 
		query.append("                                          WHERE SCC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                #elseif(${loc_grp_cd} == 'E')" ).append("\n"); 
		query.append("                                          WHERE ECC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                #elseif(${loc_grp_cd} == 'L')" ).append("\n"); 
		query.append("                                          WHERE LCC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("                                #end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                      ) B" ).append("\n"); 
		query.append("                                 WHERE A.LCC_CD = B.LCC_CD" ).append("\n"); 
		query.append("                                 UNION " ).append("\n"); 
		query.append("                                 SELECT 0 REPO_ADD_DYS FROM DUAL " ).append("\n"); 
		query.append("                                 ORDER BY REPO_ADD_DYS DESC  " ).append("\n"); 
		query.append("                             )" ).append("\n"); 
		query.append("                             WHERE ROWNUM=1     " ).append("\n"); 
		query.append("                        ) B" ).append("\n"); 
		query.append("                        ,(" ).append("\n"); 
		query.append("                             SELECT C.YD_CD, A.SCC_CD" ).append("\n"); 
		query.append("                             FROM MDM_EQ_ORZ_CHT A,MDM_LOCATION B,MDM_YARD C                         " ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                        #if(${loc_grp_cd} == 'S')" ).append("\n"); 
		query.append("                             WHERE A.SCC_CD = @[loc_cd]     -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                        #elseif(${loc_grp_cd} == 'E')" ).append("\n"); 
		query.append("                             WHERE A.ECC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                        #elseif(${loc_grp_cd} == 'L')" ).append("\n"); 
		query.append("                             WHERE A.LCC_CD = @[loc_cd]     -- E:ECC, L:LCC, S:SCC " ).append("\n"); 
		query.append("                        #end                                                   " ).append("\n"); 
		query.append("                             AND   A.SCC_CD = B.SCC_CD" ).append("\n"); 
		query.append("                             AND   B.LOC_CD = C.LOC_CD" ).append("\n"); 
		query.append("                        ) C" ).append("\n"); 
		query.append("                        ,DUMMY_WEEK D" ).append("\n"); 
		query.append("                    WHERE A.ETB_DT >= (SELECT TO_DATE(WK_ST_DT,  'YYYYMMDD') -B.ADD_DYS           FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = D.W5) -- 5번째 week" ).append("\n"); 
		query.append("                    AND   A.ETB_DT <= (SELECT TO_DATE(WK_END_DT, 'YYYYMMDD') -B.ADD_DYS +0.99999  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = D.W9) -- 7번째 week" ).append("\n"); 
		query.append("                    AND   A.YD_CD = C.YD_CD " ).append("\n"); 
		query.append("                    AND   A.INTR_ASIA_FLG = 'N' --  WORLD VERSION, 2015-11-10, 신용찬, CHM-201537372   " ).append("\n"); 
		query.append("                ) A" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("                GROUP BY A.WEEK" ).append("\n"); 
		query.append("            )" ).append("\n"); 
		query.append("        ) A" ).append("\n"); 
		query.append("        WHERE RN=1 -- W3,W2,W1 자리에 SNAP REPO IN + 과거실적이 중첩되면 실적우선" ).append("\n"); 
		query.append("        GROUP BY A.WEEK" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        -- OW & On hire ---------------------------------------------------------------------------- " ).append("\n"); 
		query.append("        -- 과거주차는 EQR_CTRL_MTY_WKY_SIM 추출, 현재-미래는 EQR_CTRL_MTY_BAL_RPT" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        UNION ALL       " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        SELECT 5 DP_SEQ" ).append("\n"); 
		query.append("              ,WEEK" ).append("\n"); 
		query.append("              ,D2_QTY" ).append("\n"); 
		query.append("              ,D4_QTY" ).append("\n"); 
		query.append("              ,D5_QTY" ).append("\n"); 
		query.append("              ,D7_QTY" ).append("\n"); 
		query.append("              ,R2_QTY" ).append("\n"); 
		query.append("              ,R5_QTY" ).append("\n"); 
		query.append("              ,R9_QTY" ).append("\n"); 
		query.append("              ,O2_QTY" ).append("\n"); 
		query.append("              ,S2_QTY" ).append("\n"); 
		query.append("              ,O4_QTY" ).append("\n"); 
		query.append("              ,S4_QTY" ).append("\n"); 
		query.append("              ,F2_QTY" ).append("\n"); 
		query.append("              ,A2_QTY" ).append("\n"); 
		query.append("              ,F4_QTY" ).append("\n"); 
		query.append("              ,A4_QTY" ).append("\n"); 
		query.append("              ,A5_QTY" ).append("\n"); 
		query.append("              ,F5_QTY" ).append("\n"); 
		query.append("              ,O5_QTY" ).append("\n"); 
		query.append("        FROM" ).append("\n"); 
		query.append("        (   " ).append("\n"); 
		query.append("            -- 과거주차는 EQR_CTRL_MTY_WKY_SIM 추출 (진짜과거주차)                   " ).append("\n"); 
		query.append("            SELECT A.FCAST_YRWK WEEK " ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D2', A.CNTR_QTY) ,0)) D2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D4', A.CNTR_QTY) ,0)) D4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D5', A.CNTR_QTY) ,0)) D5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D7', A.CNTR_QTY) ,0)) D7_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R2', A.CNTR_QTY) ,0)) R2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R5', A.CNTR_QTY) ,0)) R5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R9', A.CNTR_QTY) ,0)) R9_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O2', A.CNTR_QTY) ,0)) O2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S2', A.CNTR_QTY) ,0)) S2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O4', A.CNTR_QTY) ,0)) O4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S4', A.CNTR_QTY) ,0)) S4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F2', A.CNTR_QTY) ,0)) F2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A2', A.CNTR_QTY) ,0)) A2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F4', A.CNTR_QTY) ,0)) F4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A4', A.CNTR_QTY) ,0)) A4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A5', A.CNTR_QTY) ,0)) A5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F5', A.CNTR_QTY) ,0)) F5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O5', A.CNTR_QTY) ,0)) O5_QTY    " ).append("\n"); 
		query.append("                                  " ).append("\n"); 
		query.append("            FROM EQR_CTRL_MTY_WKY_SIM A" ).append("\n"); 
		query.append("                ,DUMMY_WEEK B" ).append("\n"); 
		query.append("            WHERE A.LOC_GRP_CD     = @[loc_grp_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("            AND   A.LOC_CD         = @[loc_cd]              " ).append("\n"); 
		query.append("            AND   A.FCAST_YRWK < (" ).append("\n"); 
		query.append("                                                SELECT PLN_YR||PLN_WK WEEK" ).append("\n"); 
		query.append("                                                FROM EQR_WK_PRD" ).append("\n"); 
		query.append("                                                WHERE WK_ST_DT  <= TO_CHAR(SYSDATE, 'YYYYMMDD')" ).append("\n"); 
		query.append("                                                AND   WK_END_DT >= TO_CHAR(SYSDATE, 'YYYYMMDD')" ).append("\n"); 
		query.append("                                  )  -- SYSDATE 현재주차                       " ).append("\n"); 
		query.append("            AND   A.FCAST_YRWK BETWEEN B.W1 AND B.W9 -- 모든주차" ).append("\n"); 
		query.append("            AND   A.WKY_SIM_TP_CD  = 'OT'  -- OTHER(LT/ST/OW)  " ).append("\n"); 
		query.append("            GROUP BY A.FCAST_YRWK   " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("            -- 현재-미래는 EQR_CTRL_MTY_BAL_RPT" ).append("\n"); 
		query.append("            UNION ALL                     " ).append("\n"); 
		query.append("            SELECT A.FCAST_YRWK WEEK" ).append("\n"); 
		query.append("                  ,NVL(A.D2_FCAST_QTY,0) D2_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.D4_FCAST_QTY,0) D4_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.D5_FCAST_QTY,0) D5_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.D7_FCAST_QTY,0) D7_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.R2_FCAST_QTY,0) R2_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.R5_FCAST_QTY,0) R5_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.R9_FCAST_QTY,0) R9_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.O2_FCAST_QTY,0) O2_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.S2_FCAST_QTY,0) S2_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.O4_FCAST_QTY,0) O4_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.S4_FCAST_QTY,0) S4_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.F2_FCAST_QTY,0) F2_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.A2_FCAST_QTY,0) A2_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.F4_FCAST_QTY,0) F4_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.A4_FCAST_QTY,0) A4_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.A5_FCAST_QTY,0) A5_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.F5_FCAST_QTY,0) F5_QTY" ).append("\n"); 
		query.append("                  ,NVL(A.O5_FCAST_QTY,0) O5_QTY" ).append("\n"); 
		query.append("            FROM  EQR_CTRL_MTY_BAL_RPT A" ).append("\n"); 
		query.append("                 ,DUMMY_WEEK B" ).append("\n"); 
		query.append("            WHERE A.CO_CD          = 'H'   -- 하드코딩" ).append("\n"); 
		query.append("            AND   A.LOC_GRP_CD     = @[loc_grp_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("            AND   A.LOC_CD         = @[loc_cd]" ).append("\n"); 
		query.append("            AND   A.MTY_BAL_TP_CD  = '6'   -- OW & On hire" ).append("\n"); 
		query.append("            AND   (" ).append("\n"); 
		query.append("                       A.INP_YRWK = B.W3  -- CURRENT WEEK ~ +3WEEK" ).append("\n"); 
		query.append("                     OR (A.INP_YRWK = B.W2 AND A.FCAST_YRWK = B.W3 AND B.W3_F = 'Y') -- -1WEEK" ).append("\n"); 
		query.append("                     OR (A.INP_YRWK = B.W1 AND A.FCAST_YRWK = B.W2 AND B.W2_F = 'Y') -- -2WEEK" ).append("\n"); 
		query.append("                     OR (A.INP_YRWK = B.W0 AND A.FCAST_YRWK = B.W1 AND B.W1_F = 'Y') -- -3WEEK" ).append("\n"); 
		query.append("                  )" ).append("\n"); 
		query.append("        )    " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        -- +OTHERS ---------------------------------------------------------------------------- " ).append("\n"); 
		query.append("        -- 과거주차는 EQR_CTRL_MTY_WKY_SIM 추출, 현재-미래는 EQR_CTRL_BAL_RPT_REPO_OUT" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        UNION ALL       " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        SELECT 6 DP_SEQ" ).append("\n"); 
		query.append("              ,WEEK" ).append("\n"); 
		query.append("              ,D2_QTY" ).append("\n"); 
		query.append("              ,D4_QTY" ).append("\n"); 
		query.append("              ,D5_QTY" ).append("\n"); 
		query.append("              ,D7_QTY" ).append("\n"); 
		query.append("              ,R2_QTY" ).append("\n"); 
		query.append("              ,R5_QTY" ).append("\n"); 
		query.append("              ,R9_QTY" ).append("\n"); 
		query.append("              ,O2_QTY" ).append("\n"); 
		query.append("              ,S2_QTY" ).append("\n"); 
		query.append("              ,O4_QTY" ).append("\n"); 
		query.append("              ,S4_QTY" ).append("\n"); 
		query.append("              ,F2_QTY" ).append("\n"); 
		query.append("              ,A2_QTY" ).append("\n"); 
		query.append("              ,F4_QTY" ).append("\n"); 
		query.append("              ,A4_QTY" ).append("\n"); 
		query.append("              ,A5_QTY" ).append("\n"); 
		query.append("              ,F5_QTY" ).append("\n"); 
		query.append("              ,O5_QTY" ).append("\n"); 
		query.append("        FROM" ).append("\n"); 
		query.append("        (" ).append("\n"); 
		query.append("            -- 과거주차는 EQR_CTRL_MTY_WKY_SIM 추출 (진짜 과거)" ).append("\n"); 
		query.append("            SELECT A.FCAST_YRWK WEEK " ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D2', A.CNTR_QTY) ,0)) D2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D4', A.CNTR_QTY) ,0)) D4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D5', A.CNTR_QTY) ,0)) D5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D7', A.CNTR_QTY) ,0)) D7_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R2', A.CNTR_QTY) ,0)) R2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R5', A.CNTR_QTY) ,0)) R5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R9', A.CNTR_QTY) ,0)) R9_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O2', A.CNTR_QTY) ,0)) O2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S2', A.CNTR_QTY) ,0)) S2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O4', A.CNTR_QTY) ,0)) O4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S4', A.CNTR_QTY) ,0)) S4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F2', A.CNTR_QTY) ,0)) F2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A2', A.CNTR_QTY) ,0)) A2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F4', A.CNTR_QTY) ,0)) F4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A4', A.CNTR_QTY) ,0)) A4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A5', A.CNTR_QTY) ,0)) A5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F5', A.CNTR_QTY) ,0)) F5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O5', A.CNTR_QTY) ,0)) O5_QTY" ).append("\n"); 
		query.append("                  " ).append("\n"); 
		query.append("            FROM EQR_CTRL_MTY_WKY_SIM A" ).append("\n"); 
		query.append("                ,DUMMY_WEEK B" ).append("\n"); 
		query.append("            WHERE A.LOC_GRP_CD     = @[loc_grp_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("            AND   A.LOC_CD         = @[loc_cd]" ).append("\n"); 
		query.append("            AND   A.FCAST_YRWK < (" ).append("\n"); 
		query.append("                                                SELECT PLN_YR||PLN_WK WEEK" ).append("\n"); 
		query.append("                                                FROM EQR_WK_PRD" ).append("\n"); 
		query.append("                                                WHERE WK_ST_DT  <= TO_CHAR(SYSDATE, 'YYYYMMDD')" ).append("\n"); 
		query.append("                                                AND   WK_END_DT >= TO_CHAR(SYSDATE, 'YYYYMMDD')" ).append("\n"); 
		query.append("                              )  -- SYSDATE 현재주차" ).append("\n"); 
		query.append("            AND   A.FCAST_YRWK BETWEEN B.W1 AND B.W3 -- 화면최소주차" ).append("\n"); 
		query.append("            AND   A.WKY_SIM_TP_CD  = 'MR'  -- MR (+OTHERS)" ).append("\n"); 
		query.append("            GROUP BY A.FCAST_YRWK " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("            UNION ALL  " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("            -- 현재-미래는 EQR_CTRL_MTY_BAL_RPT_OTR" ).append("\n"); 
		query.append("            SELECT A.FCAST_YRWK WEEK" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.D2_FCAST_QTY,0)) D2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.D4_FCAST_QTY,0)) D4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.D5_FCAST_QTY,0)) D5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.D7_FCAST_QTY,0)) D7_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.R2_FCAST_QTY,0)) R2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.R5_FCAST_QTY,0)) R5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.R9_FCAST_QTY,0)) R9_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.O2_FCAST_QTY,0)) O2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.S2_FCAST_QTY,0)) S2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.O4_FCAST_QTY,0)) O4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.S4_FCAST_QTY,0)) S4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.F2_FCAST_QTY,0)) F2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.A2_FCAST_QTY,0)) A2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.F4_FCAST_QTY,0)) F4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.A4_FCAST_QTY,0)) A4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.A5_FCAST_QTY,0)) A5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.F5_FCAST_QTY,0)) F5_QTY " ).append("\n"); 
		query.append("                  ,SUM(NVL(A.O5_FCAST_QTY,0)) O5_QTY" ).append("\n"); 
		query.append("            FROM  EQR_CTRL_MTY_BAL_RPT_OTR A" ).append("\n"); 
		query.append("                 ,DUMMY_WEEK B" ).append("\n"); 
		query.append("            WHERE A.LOC_GRP_CD     = @[loc_grp_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("            AND   A.LOC_CD         = @[loc_cd]" ).append("\n"); 
		query.append("            AND   (" ).append("\n"); 
		query.append("                        A.INP_YRWK = B.W3                         -- CURRENT WEEK ~ +3WEEK" ).append("\n"); 
		query.append("                     OR (A.INP_YRWK = B.W2 AND A.FCAST_YRWK = B.W3 AND B.W3_F = 'Y') -- -1WEEK" ).append("\n"); 
		query.append("                     OR (A.INP_YRWK = B.W1 AND A.FCAST_YRWK = B.W2 AND B.W2_F = 'Y') -- -2WEEK" ).append("\n"); 
		query.append("                     OR (A.INP_YRWK = B.W0 AND A.FCAST_YRWK = B.W1 AND B.W1_F = 'Y') -- -3WEEK" ).append("\n"); 
		query.append("                  )  " ).append("\n"); 
		query.append("            GROUP BY A.FCAST_YRWK" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        -- OP FCST ---------------------------------------------------------------------------- " ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT 7 DP_SEQ" ).append("\n"); 
		query.append("              ,A.FCAST_YRWK WEEK" ).append("\n"); 
		query.append("              ,NVL(A.D2_FCAST_QTY,0) D2_QTY" ).append("\n"); 
		query.append("              ,NVL(A.D4_FCAST_QTY,0) D4_QTY" ).append("\n"); 
		query.append("              ,NVL(A.D5_FCAST_QTY,0) D5_QTY" ).append("\n"); 
		query.append("              ,NVL(A.D7_FCAST_QTY,0) D7_QTY" ).append("\n"); 
		query.append("              ,NVL(A.R2_FCAST_QTY,0) R2_QTY" ).append("\n"); 
		query.append("              ,NVL(A.R5_FCAST_QTY,0) R5_QTY" ).append("\n"); 
		query.append("              ,NVL(A.R9_FCAST_QTY,0) R9_QTY" ).append("\n"); 
		query.append("              ,NVL(A.O2_FCAST_QTY,0) O2_QTY" ).append("\n"); 
		query.append("              ,NVL(A.S2_FCAST_QTY,0) S2_QTY" ).append("\n"); 
		query.append("              ,NVL(A.O4_FCAST_QTY,0) O4_QTY" ).append("\n"); 
		query.append("              ,NVL(A.S4_FCAST_QTY,0) S4_QTY" ).append("\n"); 
		query.append("              ,NVL(A.F2_FCAST_QTY,0) F2_QTY" ).append("\n"); 
		query.append("              ,NVL(A.A2_FCAST_QTY,0) A2_QTY" ).append("\n"); 
		query.append("              ,NVL(A.F4_FCAST_QTY,0) F4_QTY" ).append("\n"); 
		query.append("              ,NVL(A.A4_FCAST_QTY,0) A4_QTY" ).append("\n"); 
		query.append("              ,NVL(A.A5_FCAST_QTY,0) A5_QTY" ).append("\n"); 
		query.append("              ,NVL(A.F5_FCAST_QTY,0) F5_QTY" ).append("\n"); 
		query.append("              ,NVL(A.O5_FCAST_QTY,0) O5_QTY" ).append("\n"); 
		query.append("        FROM  EQR_CTRL_MTY_BAL_RPT A" ).append("\n"); 
		query.append("             ,DUMMY_WEEK B" ).append("\n"); 
		query.append("        WHERE A.CO_CD          = 'H'  -- 하드코딩" ).append("\n"); 
		query.append("        AND   A.LOC_GRP_CD     = @[loc_grp_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("        AND   A.LOC_CD         = @[loc_cd]        " ).append("\n"); 
		query.append("        AND   A.MTY_BAL_TP_CD  = '3'  -- OP FCST" ).append("\n"); 
		query.append("        AND   (" ).append("\n"); 
		query.append("                    A.INP_YRWK = B.W3  -- CURRENT WEEK ~ +3WEEK" ).append("\n"); 
		query.append("                 OR A.INP_YRWK = B.W2 AND A.FCAST_YRWK = B.W3 -- -1WEEK" ).append("\n"); 
		query.append("                 OR A.INP_YRWK = B.W1 AND A.FCAST_YRWK = B.W2 -- -2WEEK" ).append("\n"); 
		query.append("                 OR A.INP_YRWK = B.W0 AND A.FCAST_YRWK = B.W1 -- -3WEEK" ).append("\n"); 
		query.append("              )      " ).append("\n"); 
		query.append("              " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        -- 2014-11-18 EQ Forecast 프로젝트" ).append("\n"); 
		query.append("        -- OP FCST(Sales) ---------------------------------------------------------------------------- " ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT 8 DP_SEQ" ).append("\n"); 
		query.append("              ,A.FCAST_YRWK WEEK" ).append("\n"); 
		query.append("              ,SUM(NVL(A.D2_FCAST_QTY,0)) D2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.D4_FCAST_QTY,0)) D4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.D5_FCAST_QTY,0)) D5_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(A.D7_FCAST_QTY,0)) D7_QTY" ).append("\n"); 
		query.append("              ,0 R2_QTY" ).append("\n"); 
		query.append("              ,0 R5_QTY" ).append("\n"); 
		query.append("              ,0 R9_QTY" ).append("\n"); 
		query.append("              ,0 O2_QTY" ).append("\n"); 
		query.append("              ,0 S2_QTY" ).append("\n"); 
		query.append("              ,0 O4_QTY" ).append("\n"); 
		query.append("              ,0 S4_QTY" ).append("\n"); 
		query.append("              ,0 F2_QTY" ).append("\n"); 
		query.append("              ,0 A2_QTY" ).append("\n"); 
		query.append("              ,0 F4_QTY" ).append("\n"); 
		query.append("              ,0 A4_QTY" ).append("\n"); 
		query.append("              ,0 A5_QTY" ).append("\n"); 
		query.append("              ,0 F5_QTY" ).append("\n"); 
		query.append("              ,0 O5_QTY" ).append("\n"); 
		query.append("        FROM" ).append("\n"); 
		query.append("        (" ).append("\n"); 
		query.append("            --SELECT ROW_NUMBER() OVER(PARTITION BY A.FCAST_YRWK, A.RLANE_CD, A.SLS_OFC_CD, A.POL_ECC_CD, A.CNTR_PKUP_SCC_CD, A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD ORDER BY A.BSE_DT DESC  ) AS RN" ).append("\n"); 
		query.append("            SELECT /*+ NO_MERGE(B) */ DENSE_RANK() OVER(PARTITION BY A.RLANE_CD, A.SLS_OFC_CD, A.POL_ECC_CD, A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD ORDER BY A.BSE_DT DESC  ) AS RN" ).append("\n"); 
		query.append("                  ,A.FCAST_YRWK" ).append("\n"); 
		query.append("                  ,A.RLANE_CD" ).append("\n"); 
		query.append("                  ,A.SLS_OFC_CD" ).append("\n"); 
		query.append("                  ,A.POL_ECC_CD" ).append("\n"); 
		query.append("                  ,A.CNTR_PKUP_SCC_CD" ).append("\n"); 
		query.append("                  ,A.VSL_CD" ).append("\n"); 
		query.append("                  ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("                  ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("                  ,A.BSE_DT" ).append("\n"); 
		query.append("                  ,A.D2_FCAST_QTY" ).append("\n"); 
		query.append("                  ,A.D4_FCAST_QTY" ).append("\n"); 
		query.append("                  ,A.D5_FCAST_QTY" ).append("\n"); 
		query.append("                  ,A.D7_FCAST_QTY" ).append("\n"); 
		query.append("            FROM  EQR_CTRL_OB_FCAST_SNAP A" ).append("\n"); 
		query.append("                 ,DUMMY_WEEK B" ).append("\n"); 
		query.append("                 ,(" ).append("\n"); 
		query.append("                     SELECT DISTINCT A.RLANE_CD, A.SLS_OFC_CD, A.POL_ECC_CD, A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD" ).append("\n"); 
		query.append("                     FROM   EQR_CTRL_OB_FCAST_SNAP A" ).append("\n"); 
		query.append("                           ,DUMMY_WEEK B" ).append("\n"); 
		query.append("                     WHERE  A.FCAST_YRWK BETWEEN B.W1 AND B.W9" ).append("\n"); 
		query.append("                     AND    A.EQ_FCAST_RTO_LVL_CD NOT IN (0, 9)" ).append("\n"); 
		query.append("                  ) D" ).append("\n"); 
		query.append("		    WHERE A.RLANE_CD   = D.RLANE_CD" ).append("\n"); 
		query.append("		    AND   A.SLS_OFC_CD = D.SLS_OFC_CD" ).append("\n"); 
		query.append("		    AND   A.POL_ECC_CD = D.POL_ECC_CD" ).append("\n"); 
		query.append("		    AND   A.VSL_CD     = D.VSL_CD" ).append("\n"); 
		query.append("		    AND   A.SKD_VOY_NO = D.SKD_VOY_NO" ).append("\n"); 
		query.append("		    AND   A.SKD_DIR_CD = D.SKD_DIR_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		    AND   A.EQ_FCAST_RTO_LVL_CD NOT IN (0, 9) -- 0 은 RATIO와 연결되지 않음." ).append("\n"); 
		query.append("        ) A" ).append("\n"); 
		query.append("        ,DUMMY_WEEK B" ).append("\n"); 
		query.append("        ,(" ).append("\n"); 
		query.append("            SELECT DISTINCT A.SCC_CD" ).append("\n"); 
		query.append("            FROM MDM_EQ_ORZ_CHT A" ).append("\n"); 
		query.append("            #if(${loc_grp_cd} == 'S')" ).append("\n"); 
		query.append("               WHERE A.SCC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC" ).append("\n"); 
		query.append("            #elseif(${loc_grp_cd} == 'E')" ).append("\n"); 
		query.append("               WHERE A.ECC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC" ).append("\n"); 
		query.append("            #elseif(${loc_grp_cd} == 'L')" ).append("\n"); 
		query.append("               WHERE A.LCC_CD = @[loc_cd]  -- E:ECC, L:LCC, S:SCC" ).append("\n"); 
		query.append("            #end" ).append("\n"); 
		query.append("         ) C" ).append("\n"); 
		query.append("         WHERE A.RN = 1   -- 모든데이터가 같고 BSE_DT 만 다른 것중 마지막 BSE_DT 를 꺼냅니다." ).append("\n"); 
		query.append("         AND   A.FCAST_YRWK BETWEEN B.W1 AND B.W9 -- 화면주차" ).append("\n"); 
		query.append("         AND   A.CNTR_PKUP_SCC_CD = C.SCC_CD" ).append("\n"); 
		query.append("         GROUP BY A.FCAST_YRWK" ).append("\n"); 
		query.append("        -- OP PFMC ----------------------------------------------------------------------------" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("--        SELECT 8 DP_SEQ" ).append("\n"); 
		query.append("        SELECT 9 DP_SEQ  -- 8-->9 로 수정, 2014-11-18 EQ Forecast 프로젝트" ).append("\n"); 
		query.append("              ,A.FCAST_YRWK WEEK " ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D2', A.CNTR_QTY) ,0)) D2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D4', A.CNTR_QTY) ,0)) D4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D5', A.CNTR_QTY) ,0)) D5_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D7', A.CNTR_QTY) ,0)) D7_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R2', A.CNTR_QTY) ,0)) R2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R5', A.CNTR_QTY) ,0)) R5_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R9', A.CNTR_QTY) ,0)) R9_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O2', A.CNTR_QTY) ,0)) O2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S2', A.CNTR_QTY) ,0)) S2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O4', A.CNTR_QTY) ,0)) O4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S4', A.CNTR_QTY) ,0)) S4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F2', A.CNTR_QTY) ,0)) F2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A2', A.CNTR_QTY) ,0)) A2_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F4', A.CNTR_QTY) ,0)) F4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A4', A.CNTR_QTY) ,0)) A4_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A5', A.CNTR_QTY) ,0)) A5_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F5', A.CNTR_QTY) ,0)) F5_QTY" ).append("\n"); 
		query.append("              ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O5', A.CNTR_QTY) ,0)) O5_QTY" ).append("\n"); 
		query.append("        FROM EQR_CTRL_MTY_WKY_SIM A" ).append("\n"); 
		query.append("            ,DUMMY_WEEK B" ).append("\n"); 
		query.append("        WHERE A.LOC_GRP_CD     = @[loc_grp_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("        AND   A.LOC_CD         = @[loc_cd]              " ).append("\n"); 
		query.append("        AND   A.FCAST_YRWK < (" ).append("\n"); 
		query.append("                                                SELECT PLN_YR||PLN_WK WEEK" ).append("\n"); 
		query.append("                                                FROM EQR_WK_PRD" ).append("\n"); 
		query.append("                                                WHERE WK_ST_DT  <= TO_CHAR(SYSDATE, 'YYYYMMDD')" ).append("\n"); 
		query.append("                                                AND   WK_END_DT >= TO_CHAR(SYSDATE, 'YYYYMMDD')" ).append("\n"); 
		query.append("                              )  -- SYSDATE 현재주차" ).append("\n"); 
		query.append("        AND   A.FCAST_YRWK    BETWEEN B.W1 AND B.W9 -- 화면주차" ).append("\n"); 
		query.append("        AND   A.WKY_SIM_TP_CD = 'OF'  -- MG FCST  " ).append("\n"); 
		query.append("        GROUP BY A.FCAST_YRWK" ).append("\n"); 
		query.append("                      " ).append("\n"); 
		query.append("        -- REPO OUT ---------------------------------------------------------------------------- " ).append("\n"); 
		query.append("        -- 과거주차는 EQR_CTRL_MTY_WKY_SIM 추출, 현재-미래는 EQR_CTRL_BAL_RPT_REPO_OUT" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        UNION ALL       " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("--        SELECT 9 DP_SEQ" ).append("\n"); 
		query.append("        SELECT 10 DP_SEQ  -- 9-->10 로 수정, 2014-11-18 EQ Forecast 프로젝트" ).append("\n"); 
		query.append("              ,WEEK" ).append("\n"); 
		query.append("              ,D2_QTY" ).append("\n"); 
		query.append("              ,D4_QTY" ).append("\n"); 
		query.append("              ,D5_QTY" ).append("\n"); 
		query.append("              ,D7_QTY" ).append("\n"); 
		query.append("              ,R2_QTY" ).append("\n"); 
		query.append("              ,R5_QTY" ).append("\n"); 
		query.append("              ,R9_QTY" ).append("\n"); 
		query.append("              ,O2_QTY" ).append("\n"); 
		query.append("              ,S2_QTY" ).append("\n"); 
		query.append("              ,O4_QTY" ).append("\n"); 
		query.append("              ,S4_QTY" ).append("\n"); 
		query.append("              ,F2_QTY" ).append("\n"); 
		query.append("              ,A2_QTY" ).append("\n"); 
		query.append("              ,F4_QTY" ).append("\n"); 
		query.append("              ,A4_QTY" ).append("\n"); 
		query.append("              ,A5_QTY" ).append("\n"); 
		query.append("              ,F5_QTY" ).append("\n"); 
		query.append("              ,O5_QTY" ).append("\n"); 
		query.append("        FROM" ).append("\n"); 
		query.append("        (   " ).append("\n"); 
		query.append("            -- 과거주차는 EQR_CTRL_MTY_WKY_SIM 추출 (진짜 과거)                " ).append("\n"); 
		query.append("            SELECT A.FCAST_YRWK WEEK " ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D2', A.CNTR_QTY) ,0)) D2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D4', A.CNTR_QTY) ,0)) D4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D5', A.CNTR_QTY) ,0)) D5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'D7', A.CNTR_QTY) ,0)) D7_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R2', A.CNTR_QTY) ,0)) R2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R5', A.CNTR_QTY) ,0)) R5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'R9', A.CNTR_QTY) ,0)) R9_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O2', A.CNTR_QTY) ,0)) O2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S2', A.CNTR_QTY) ,0)) S2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O4', A.CNTR_QTY) ,0)) O4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'S4', A.CNTR_QTY) ,0)) S4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F2', A.CNTR_QTY) ,0)) F2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A2', A.CNTR_QTY) ,0)) A2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F4', A.CNTR_QTY) ,0)) F4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A4', A.CNTR_QTY) ,0)) A4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'A5', A.CNTR_QTY) ,0)) A5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'F5', A.CNTR_QTY) ,0)) F5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(DECODE(A.CNTR_TPSZ_CD, 'O5', A.CNTR_QTY) ,0)) O5_QTY    " ).append("\n"); 
		query.append("                                  " ).append("\n"); 
		query.append("            FROM EQR_CTRL_MTY_WKY_SIM A" ).append("\n"); 
		query.append("                ,DUMMY_WEEK B" ).append("\n"); 
		query.append("            WHERE A.LOC_GRP_CD     = @[loc_grp_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("            AND   A.LOC_CD         = @[loc_cd]              " ).append("\n"); 
		query.append("            AND   A.FCAST_YRWK < (" ).append("\n"); 
		query.append("                                                SELECT PLN_YR||PLN_WK WEEK" ).append("\n"); 
		query.append("                                                FROM EQR_WK_PRD" ).append("\n"); 
		query.append("                                                WHERE WK_ST_DT  <= TO_CHAR(SYSDATE, 'YYYYMMDD')" ).append("\n"); 
		query.append("                                                AND   WK_END_DT >= TO_CHAR(SYSDATE, 'YYYYMMDD')" ).append("\n"); 
		query.append("                              )  -- SYSDATE 현재주차" ).append("\n"); 
		query.append("            AND   A.FCAST_YRWK BETWEEN B.W1 AND B.W3 -- 과거주차" ).append("\n"); 
		query.append("            AND   A.WKY_SIM_TP_CD  = 'RO'  -- REPO OUT" ).append("\n"); 
		query.append("            GROUP BY A.FCAST_YRWK " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("            UNION ALL  " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("            -- 현재-미래는 EQR_CTRL_BAL_RPT_REPO_OUT" ).append("\n"); 
		query.append("            SELECT A.FCAST_YRWK WEEK" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.D2_FCAST_QTY,0)) D2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.D4_FCAST_QTY,0)) D4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.D5_FCAST_QTY,0)) D5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.D7_FCAST_QTY,0)) D7_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.R2_FCAST_QTY,0)) R2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.R5_FCAST_QTY,0)) R5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.R9_FCAST_QTY,0)) R9_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.O2_FCAST_QTY,0)) O2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.S2_FCAST_QTY,0)) S2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.O4_FCAST_QTY,0)) O4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.S4_FCAST_QTY,0)) S4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.F2_FCAST_QTY,0)) F2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.A2_FCAST_QTY,0)) A2_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.F4_FCAST_QTY,0)) F4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.A4_FCAST_QTY,0)) A4_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.A5_FCAST_QTY,0)) A5_QTY" ).append("\n"); 
		query.append("                  ,SUM(NVL(A.F5_FCAST_QTY,0)) F5_QTY " ).append("\n"); 
		query.append("                  ,SUM(NVL(A.O5_FCAST_QTY,0)) O5_QTY " ).append("\n"); 
		query.append("            FROM  EQR_CTRL_BAL_RPT_REPO_OUT A" ).append("\n"); 
		query.append("                 ,DUMMY_WEEK B" ).append("\n"); 
		query.append("            WHERE A.LOC_GRP_CD     = @[loc_grp_cd]  -- E:ECC, L:LCC, S:SCC (2012-05-22, ADDED BY SHIN YONGCHAN, CHM-201217713)" ).append("\n"); 
		query.append("            AND   A.LOC_CD         = @[loc_cd]        " ).append("\n"); 
		query.append("            AND   (" ).append("\n"); 
		query.append("                        A.INP_YRWK = B.W3                         -- CURRENT WEEK ~ +3WEEK" ).append("\n"); 
		query.append("                     OR (A.INP_YRWK = B.W2 AND A.FCAST_YRWK = B.W3 AND B.W3_F = 'Y') -- -1WEEK" ).append("\n"); 
		query.append("                     OR (A.INP_YRWK = B.W1 AND A.FCAST_YRWK = B.W2 AND B.W2_F = 'Y') -- -2WEEK" ).append("\n"); 
		query.append("                     OR (A.INP_YRWK = B.W0 AND A.FCAST_YRWK = B.W1 AND B.W1_F = 'Y') -- -3WEEK" ).append("\n"); 
		query.append("                  )  " ).append("\n"); 
		query.append("            GROUP BY A.FCAST_YRWK" ).append("\n"); 
		query.append("        )                       " ).append("\n"); 
		query.append("              " ).append("\n"); 
		query.append("    ) A        " ).append("\n"); 
		query.append("    GROUP BY A.DP_SEQ" ).append("\n"); 
		query.append(") B   " ).append("\n"); 
		query.append("WHERE A.DP_SEQ = B.DP_SEQ(+)" ).append("\n"); 
		query.append("ORDER BY A.DP_SEQ" ).append("\n"); 

	}
}