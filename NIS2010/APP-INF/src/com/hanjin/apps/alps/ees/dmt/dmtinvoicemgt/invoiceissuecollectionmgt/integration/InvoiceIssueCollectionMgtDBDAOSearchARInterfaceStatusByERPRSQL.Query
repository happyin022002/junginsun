<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceIssueCollectionMgtDBDAOSearchARInterfaceStatusByERPRSQL">
			<desc><![CDATA[InvoiceIssueCollectionMgtDBDAOSearchARInterfaceStatusByERPRSQL]]></desc>
			<sql><![CDATA[
select  A.DMDT_INV_NO
       ,INV_PAY_OFC_CD
       ,A.BKG_NO
       ,A.BL_NO
       ,A.INV_CURR_CD
       ,decode(DMDT_INV_PAY_TP_CD, 'M', INV_PAY_AMT)   	as INV_AMT
	   ,decode(DMDT_INV_PAY_TP_CD, 'V', INV_PAY_AMT)   	as TAX_AMT
       ,to_char(INV_PAY_LOCL_DT, 'YYYY-MM-DD HH24:MI')		as INV_PAY_DT
       ,to_char(UPD_LOCL_DT, 'YYYY-MM-DD HH24:MI')	as IF_DT
       ,case 
			when INV_PAY_RCV_SEQ < 2000000 then null
			else INV_PAY_RCV_SEQ
	    end												as IF_NO
	   ,B.DMDT_TRF_CD 
	   ,B.AR_IF_OFC_CD									AS DMDT_OFC_CD
       , CASE WHEN ACT_PAYR_CNT_CD IN ('00', 'TB') THEN LPAD(ACT_PAYR_SEQ, 6, 0) ELSE ACT_PAYR_CNT_CD || LPAD(ACT_PAYR_SEQ, 6, 0) END PAYER_CD
       , (SELECT CUST_LGL_ENG_NM FROM MDM_CUSTOMER WHERE CUST_CNT_CD = ACT_PAYR_CNT_CD AND CUST_SEQ = ACT_PAYR_SEQ AND ROWNUM = 1) PAYER_NM
  from  DMT_INV_OTS_PAY_RCV A, DMT_INV_MN B
  where 1 = 1   
  AND  A.DMDT_INV_NO = B.DMDT_INV_NO
 
   #if(${invoice_no} != '')
   and  A.DMDT_INV_NO in 
		(
			#foreach( $invoice_no in ${invoice_no_list} )
				#if($velocityCount < $invoice_no_list.size()) '$invoice_no', #else '$invoice_no' #end
			#end
		)
   #end
   #if(${ofc_cd} != '')
   
   #if(${erp_ofc} != 'coll')
   and  B.AR_IF_OFC_CD in 
		(
			#foreach( $ofc_cd in ${ofc_cd_list} )
				#if($velocityCount < $ofc_cd_list.size()) '$ofc_cd', #else '$ofc_cd' #end
			#end
		)
   #else
   and  A.INV_PAY_OFC_CD in 
		(
			#foreach( $ofc_cd in ${ofc_cd_list} )
				#if($velocityCount < $ofc_cd_list.size()) '$ofc_cd', #else '$ofc_cd' #end
			#end
		)
   #end
   #end
   #if(${bkg_no} != '')
   and  A.BKG_NO in 
		(
			#foreach( $bkg_no in ${bkg_no_list} )
				#if($velocityCount < $bkg_no_list.size()) '$bkg_no', #else '$bkg_no' #end
			#end
		)
   #end
	#if(${dmdt_trf_cd_t3} != '')
   and  B.DMDT_TRF_CD in 
		(
			#foreach( $trf_cd in ${dmdt_trf_cd_list} )
				#if($velocityCount < $dmdt_trf_cd_list.size()) '$trf_cd', #else '$trf_cd' #end
			#end
		)
   #end
   #if(${erp_dt} != 'if')
        AND A.INV_PAY_LOCL_DT BETWEEN to_date(@[fm_if_dt], 'YYYY-MM-DD') AND to_date(@[to_if_dt], 'YYYY-MM-DD') + 0.99999
   #else
   	    AND A.UPD_LOCL_DT BETWEEN to_date(@[fm_if_dt], 'YYYY-MM-DD') AND to_date(@[to_if_dt], 'YYYY-MM-DD') + 0.99999
   #end

order by A.UPD_DT desc			]]></sql>
			<params>
				<param name="fm_if_dt" type="12" value="" out="N"/>
				<param name="to_if_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
