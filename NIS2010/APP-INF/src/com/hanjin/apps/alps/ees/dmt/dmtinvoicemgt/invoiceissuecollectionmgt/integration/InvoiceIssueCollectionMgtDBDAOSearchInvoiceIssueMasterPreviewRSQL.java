/*=========================================================
*Copyright(c) 2017 CyberLogitec
*@FileName : InvoiceIssueCollectionMgtDBDAOSearchInvoiceIssueMasterPreviewRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2017.10.19
*@LastModifier : 
*@LastVersion : 1.0
* 2017.10.19 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.ees.dmt.dmtinvoicemgt.invoiceissuecollectionmgt.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class InvoiceIssueCollectionMgtDBDAOSearchInvoiceIssueMasterPreviewRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * EES_DMT_4003 RD MASTER
	  * </pre>
	  */
	public InvoiceIssueCollectionMgtDBDAOSearchInvoiceIssueMasterPreviewRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cre_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("invoice_no",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.ees.dmt.dmtinvoicemgt.invoiceissuecollectionmgt.integration").append("\n"); 
		query.append("FileName : InvoiceIssueCollectionMgtDBDAOSearchInvoiceIssueMasterPreviewRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if (${jspno} == '4002')" ).append("\n"); 
		query.append("-- General Invoice" ).append("\n"); 
		query.append("SELECT A.DMDT_INV_NO AS DMDT_INV_NO       " ).append("\n"); 
		query.append("       ,TO_CHAR(A.CRE_DT,'YYYYMMDD') AS ISSUE_DAY                                                                                                                             " ).append("\n"); 
		query.append("       ,DECODE(                              " ).append("\n"); 
		query.append("               (SELECT COUNT(*) FROM DMT_CR_TERM_OPT                                                                                  " ).append("\n"); 
		query.append("                WHERE OFC_CD = A.CRE_OFC_CD)                                                                                          " ).append("\n"); 
		query.append("                , 0                                                                                                                   " ).append("\n"); 
		query.append("                , TO_CHAR(A.CRE_DT,  'DDMonYY', 'NLS_DATE_LANGUAGE = American')                                                       " ).append("\n"); 
		query.append("                ,(SELECT CASE WHEN CR_TERM_DYS > 0 THEN TO_CHAR(A.CRE_DT + CR_TERM_DYS, 'DDMonYY', 'NLS_DATE_LANGUAGE = American')    " ).append("\n"); 
		query.append("                              WHEN CR_TERM_DYS = 0 THEN                                                                               " ).append("\n"); 
		query.append("                                 CASE WHEN ISS_DT_PRN_FLG = 'Y' THEN TO_CHAR(A.CRE_DT,  'DDMonYY', 'NLS_DATE_LANGUAGE = American')    " ).append("\n"); 
		query.append("                                 ELSE '*******'                                                                                       " ).append("\n"); 
		query.append("                                 END                                                                                                  " ).append("\n"); 
		query.append("                         END DUE_DATE                                                                                                 " ).append("\n"); 
		query.append("                  FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                " ).append("\n"); 
		query.append("                  WHERE OPT.OFC_CD = TRF_OPT.OFC_CD" ).append("\n"); 
		query.append("    			  AND OPT.CR_TERM_SEQ = TRF_OPT.CR_TERM_SEQ" ).append("\n"); 
		query.append("    			  AND OPT.OFC_CD = A.CRE_OFC_CD  " ).append("\n"); 
		query.append("				  AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD                                                                                     " ).append("\n"); 
		query.append("                 )                                                                                                                    " ).append("\n"); 
		query.append("         ) AS DUE_DATE                                                                                                                " ).append("\n"); 
		query.append("       ,DECODE(                                                                                                                       " ).append("\n"); 
		query.append("              (SELECT COUNT(*) FROM DMT_CR_TERM_OPT                                                                                   " ).append("\n"); 
		query.append("               WHERE OFC_CD = A.CRE_OFC_CD)                                                                                           " ).append("\n"); 
		query.append("              , 0                                                                                                                     " ).append("\n"); 
		query.append("              , 0                                                                                                                     " ).append("\n"); 
		query.append("              , (SELECT CASE WHEN OPT.CR_TERM_DYS > 0 THEN TO_CHAR(OPT.CR_TERM_DYS)                                                           " ).append("\n"); 
		query.append("                             WHEN OPT.CR_TERM_DYS = 0 THEN                                                                                " ).append("\n"); 
		query.append("                                  CASE WHEN OPT.ISS_DT_PRN_FLG = 'Y' THEN '0'                                                             " ).append("\n"); 
		query.append("                                  ELSE ''                                                                                             " ).append("\n"); 
		query.append("                                  END                                                                                                 " ).append("\n"); 
		query.append("                        END DUE_DAY                                                                                                   " ).append("\n"); 
		query.append("                 FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                 " ).append("\n"); 
		query.append("                 WHERE OPT.OFC_CD = TRF_OPT.OFC_CD" ).append("\n"); 
		query.append("				   AND OPT.CR_TERM_SEQ = TRF_OPT.CR_TERM_SEQ" ).append("\n"); 
		query.append("				   AND OPT.OFC_CD = A.CRE_OFC_CD" ).append("\n"); 
		query.append("				   AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD" ).append("\n"); 
		query.append("			)                                                                                         " ).append("\n"); 
		query.append("        ) AS DUE_DAY  " ).append("\n"); 
		query.append("		, DECODE(DECODE(                              " ).append("\n"); 
		query.append("			 		 (SELECT COUNT(*) FROM DMT_CR_TERM_OPT WHERE OFC_CD = A.CRE_OFC_CD)                                                                                          " ).append("\n"); 
		query.append("					, 0                                                                                                                   " ).append("\n"); 
		query.append("					, TO_CHAR(A.CRE_DT,  'YYYYMMDD')" ).append("\n"); 
		query.append("					,(SELECT CASE WHEN CR_TERM_DYS > 0 THEN TO_CHAR(A.CRE_DT + CR_TERM_DYS, 'YYYYMMDD')    " ).append("\n"); 
		query.append("			              		  WHEN CR_TERM_DYS = 0 THEN                                                                               " ).append("\n"); 
		query.append("			                       		CASE WHEN ISS_DT_PRN_FLG = 'Y' THEN TO_CHAR(A.CRE_DT,  'YYYYMMDD')    " ).append("\n"); 
		query.append("			                       		ELSE '*******'                                                                                       " ).append("\n"); 
		query.append("			                       		END                                                                                                  " ).append("\n"); 
		query.append("			         		 END DUE_DATE                                                                                                 " ).append("\n"); 
		query.append("			  		  FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                " ).append("\n"); 
		query.append("			  		  WHERE OPT.OFC_CD 		= TRF_OPT.OFC_CD" ).append("\n"); 
		query.append("			  		  AND OPT.CR_TERM_SEQ 	= TRF_OPT.CR_TERM_SEQ" ).append("\n"); 
		query.append("			  		  AND OPT.OFC_CD 		= A.CRE_OFC_CD  " ).append("\n"); 
		query.append("			  		  AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD)                                                                                                                    " ).append("\n"); 
		query.append("		    			)" ).append("\n"); 
		query.append("				, '*******'" ).append("\n"); 
		query.append("				, 'N'" ).append("\n"); 
		query.append("				, DECODE( DECODE(  " ).append("\n"); 
		query.append("							 (SELECT COUNT(*) FROM DMT_CR_TERM_OPT WHERE OFC_CD = A.CRE_OFC_CD)                                                                                          " ).append("\n"); 
		query.append("				  			, 0                                                                                                                   " ).append("\n"); 
		query.append("				  			, TO_CHAR(A.CRE_DT,  'YYYYMMDD')" ).append("\n"); 
		query.append("				  			,(SELECT CASE WHEN CR_TERM_DYS > 0 THEN TO_CHAR(A.CRE_DT + CR_TERM_DYS, 'YYYYMMDD')    " ).append("\n"); 
		query.append("				                	      WHEN CR_TERM_DYS = 0 THEN                                                                               " ).append("\n"); 
		query.append("				                   				CASE WHEN ISS_DT_PRN_FLG = 'Y' THEN TO_CHAR(A.CRE_DT,  'YYYYMMDD')    " ).append("\n"); 
		query.append("				                   				ELSE '*******'                                                                                       " ).append("\n"); 
		query.append("				                   				END                                                                                                  " ).append("\n"); 
		query.append("				           			 END DUE_DATE                                                                                                 " ).append("\n"); 
		query.append("				    		  FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                " ).append("\n"); 
		query.append("				    		  WHERE OPT.OFC_CD 		= TRF_OPT.OFC_CD" ).append("\n"); 
		query.append("				    		  AND OPT.CR_TERM_SEQ 	= TRF_OPT.CR_TERM_SEQ" ).append("\n"); 
		query.append("				   			  AND OPT.OFC_CD 		= A.CRE_OFC_CD  " ).append("\n"); 
		query.append("				    		  AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD)                                                                                                                    " ).append("\n"); 
		query.append("			     			)" ).append("\n"); 
		query.append("				 		, TO_CHAR(A.CRE_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("				 		, 'N'" ).append("\n"); 
		query.append("				 		, 'Y')" ).append("\n"); 
		query.append("		) AS DAYS_DISP" ).append("\n"); 
		query.append("       ,DECODE(A.NTC_KNT_CD, '1','1st NOTICE',2,'2nd NOTICE',3,'3rd NOTICE',9,'FINAL NOTICE','') AS NTC_KNT_CD                                                                " ).append("\n"); 
		query.append("       ,A.CRE_USR_ID AS CRE_USR_ID                                                                                                                                            " ).append("\n"); 
		query.append("       ,(SELECT USR_NM FROM COM_USER WHERE USR_ID = A.CRE_USR_ID) AS CRE_USR_NM" ).append("\n"); 
		query.append("	   ,(SELECT SUBSTR(LOC_CD,0,2) FROM MDM_ORGANIZATION WHERE OFC_CD = A.CRE_OFC_CD) AS CRE_CNT_CD                                                                                               " ).append("\n"); 
		query.append("       ,DECODE(A.ACT_PAYR_CNT_CD,'00','',A.ACT_PAYR_CNT_CD)||LPAD(A.ACT_PAYR_SEQ,6,'0') AS CUST_CD                                                                            " ).append("\n"); 
		query.append("       ,A.INV_REF_NO AS INV_REF_NO                                                                                                                                            " ).append("\n"); 
		query.append("       ,(SELECT CUST_RGST_NO                                                                                                                                                  " ).append("\n"); 
		query.append("         FROM MDM_CUSTOMER                                                                                                                                                    " ).append("\n"); 
		query.append("         WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                                                " ).append("\n"); 
		query.append("         AND CUST_SEQ = A.ACT_PAYR_SEQ) AS CUST_VAT_NO                                                                                                                      " ).append("\n"); 
		query.append("	   ,DECODE(                                                                                                                                                                " ).append("\n"); 
		query.append("              (SELECT DMDT_PAYR_NM                                                                                                                                            " ).append("\n"); 
		query.append("               FROM DMT_PAYR_INFO                                                                                                                                             " ).append("\n"); 
		query.append("               WHERE SYS_AREA_GRP_ID  = (SELECT SYS_AREA_GRP_ID                                                                                                               " ).append("\n"); 
		query.append("                                         FROM COM_SYS_AREA_GRP_ID                                                                                                             " ).append("\n"); 
		query.append("                                         WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                          " ).append("\n"); 
		query.append("                                                         FROM MDM_ORGANIZATION                                                                                                " ).append("\n"); 
		query.append("                                                         WHERE OFC_CD = A.CRE_OFC_CD)                                                                                         " ).append("\n"); 
		query.append("                                         AND CO_IND_CD = 'H')                                                                                                                 " ).append("\n"); 
		query.append("               AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                                            " ).append("\n"); 
		query.append("               AND CUST_SEQ  = A.ACT_PAYR_SEQ)" ).append("\n"); 
		query.append("			  , NULL" ).append("\n"); 
		query.append("			  ,(DECODE(                                                                                                                                                     " ).append("\n"); 
		query.append("                      (SELECT LOCL_NM                                                                                                                                     " ).append("\n"); 
		query.append("                       FROM MDM_CR_CUST                                                                                                                                   " ).append("\n"); 
		query.append("                       WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                              " ).append("\n"); 
		query.append("                       AND CUST_SEQ    = A.ACT_PAYR_SEQ                                                                                                                   " ).append("\n"); 
		query.append("                       AND LOCL_NM IS NOT NULL                                                                                                                            " ).append("\n"); 
		query.append("                      )" ).append("\n"); 
		query.append("					  ,NULL" ).append("\n"); 
		query.append("					  ,(SELECT CASE WHEN A.ACT_PAYR_CNT_CD = '00' THEN (SELECT VNDR_LGL_ENG_NM                                                                             " ).append("\n"); 
		query.append("                                                                        FROM MDM_VENDOR                                                                                                 " ).append("\n"); 
		query.append("                                                              			WHERE VNDR_SEQ = A.ACT_PAYR_SEQ                                                                                 " ).append("\n"); 
		query.append("                                                              			AND VNDR_LGL_ENG_NM IS NOT NULL)                                                                                " ).append("\n"); 
		query.append("                               ELSE                                                                                                                                        " ).append("\n"); 
		query.append("                                   (SELECT CUST_LGL_ENG_NM                                                                                                                " ).append("\n"); 
		query.append("                                    FROM MDM_CUSTOMER                                                                                                                     " ).append("\n"); 
		query.append("                                    WHERE CUST_CNT_CD 	= A.ACT_PAYR_CNT_CD                                                                                                 " ).append("\n"); 
		query.append("                                    AND CUST_SEQ     	= A.ACT_PAYR_SEQ                                                                                                     " ).append("\n"); 
		query.append("                                    AND CUST_LGL_ENG_NM IS NOT NULL)                                                                                                      " ).append("\n"); 
		query.append("                               END MDM_NAME                                                                                                                                " ).append("\n"); 
		query.append("                        FROM DUAL                                                                                                                                          " ).append("\n"); 
		query.append("                       )" ).append("\n"); 
		query.append("					  ,(SELECT LOCL_NM                                                                                                                                    " ).append("\n"); 
		query.append("                        FROM MDM_CR_CUST                                                                                                                                   " ).append("\n"); 
		query.append("                        WHERE CUST_CNT_CD 	= A.ACT_PAYR_CNT_CD                                                                                                              " ).append("\n"); 
		query.append("                        AND CUST_SEQ    	= A.ACT_PAYR_SEQ                                                                                                                   " ).append("\n"); 
		query.append("                        AND LOCL_NM IS NOT NULL                                                                                                                            " ).append("\n"); 
		query.append("                        )                                                                                                                                                  " ).append("\n"); 
		query.append("                      )                                                                                                                                                    " ).append("\n"); 
		query.append("              )" ).append("\n"); 
		query.append("			  ,(SELECT DMDT_PAYR_NM                                                                                                                                             " ).append("\n"); 
		query.append("                FROM DMT_PAYR_INFO                                                                                                                                              " ).append("\n"); 
		query.append("                WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID                                                                                                                " ).append("\n"); 
		query.append("                                         FROM COM_SYS_AREA_GRP_ID                                                                                                               " ).append("\n"); 
		query.append("                                         WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                            " ).append("\n"); 
		query.append("                                                         FROM MDM_ORGANIZATION                                                                                                  " ).append("\n"); 
		query.append("                                                         WHERE OFC_CD = A.CRE_OFC_CD)                                                                                           " ).append("\n"); 
		query.append("                                         AND CO_IND_CD = 'H')                                                                                                                   " ).append("\n"); 
		query.append("                AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                                             " ).append("\n"); 
		query.append("                AND CUST_SEQ  = A.ACT_PAYR_SEQ                                                                                                                                  " ).append("\n"); 
		query.append("               )                                                                                                                                                               " ).append("\n"); 
		query.append("            ) AS CUST_NM                                                                                                                                                        " ).append("\n"); 
		query.append("       ,DMDT_PAYR_CNTC_PNT_NM AS ATTN_NM                                                                                                                                      " ).append("\n"); 
		query.append("       ,DECODE((SELECT COUNT(*) FROM DMT_PAYR_CNTC_PNT  " ).append("\n"); 
		query.append("                WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID   " ).append("\n"); 
		query.append("                                         FROM COM_SYS_AREA_GRP_ID   " ).append("\n"); 
		query.append("                                         WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2) " ).append("\n"); 
		query.append("                                                         FROM MDM_ORGANIZATION  " ).append("\n"); 
		query.append("                                                         WHERE OFC_CD = A.CRE_OFC_CD) " ).append("\n"); 
		query.append("                                         AND CO_IND_CD = 'H')    " ).append("\n"); 
		query.append("                   AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD     " ).append("\n"); 
		query.append("                   AND CUST_SEQ = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("				   AND (" ).append("\n"); 
		query.append("						(A.CUST_CNTC_PNT_SEQ IS NULL AND ROWNUM = 1)" ).append("\n"); 
		query.append("						OR" ).append("\n"); 
		query.append("						(CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)" ).append("\n"); 
		query.append("					   )" ).append("\n"); 
		query.append("				)       " ).append("\n"); 
		query.append("                  ,0              " ).append("\n"); 
		query.append("                  ,DECODE(A.ACT_PAYR_CNT_CD , '00',      " ).append("\n"); 
		query.append("		         (SELECT V_CNTC.PHN_NO FROM MDM_VENDOR V_MDM, MDM_VNDR_CNTC_PNT V_CNTC  " ).append("\n"); 
		query.append("		          WHERE V_MDM.VNDR_SEQ = V_CNTC.VNDR_SEQ" ).append("\n"); 
		query.append("				  AND V_MDM.VNDR_SEQ = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("		          AND V_CNTC.PHN_NO IS NOT NULL" ).append("\n"); 
		query.append("				  AND ROWNUM = 1)        " ).append("\n"); 
		query.append("		          ,                " ).append("\n"); 
		query.append("		          DECODE(               " ).append("\n"); 
		query.append("		         (SELECT COUNT(*) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ AND DECODE(SUBSTR(A.DMDT_TRF_CD,2,3),'I',IB_PHN_NO,OB_PHN_NO) IS NOT NULL) " ).append("\n"); 
		query.append("		         ,0                " ).append("\n"); 
		query.append("                 ,(SELECT DISTINCT PHN_NO FROM MDM_CUSTOMER C_CUST, MDM_CUST_CNTC_PNT C_CNTC" ).append("\n"); 
		query.append("                   WHERE C_CUST.CUST_CNT_CD  = C_CNTC.CUST_CNT_CD" ).append("\n"); 
		query.append("                   AND C_CUST.CUST_SEQ   = C_CNTC.CUST_SEQ" ).append("\n"); 
		query.append("                   AND C_CUST.CUST_CNT_CD  = A.ACT_PAYR_CNT_CD" ).append("\n"); 
		query.append("                   AND C_CUST.CUST_SEQ   = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("                   AND C_CNTC.PHN_NO IS NOT NULL" ).append("\n"); 
		query.append("				   AND ROWNUM = 1)" ).append("\n"); 
		query.append("                 ,(SELECT DISTINCT DECODE(SUBSTR(A.DMDT_TRF_CD,2,3),'I',IB_PHN_NO,OB_PHN_NO) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ)" ).append("\n"); 
		query.append("				)                " ).append("\n"); 
		query.append("			)                 " ).append("\n"); 
		query.append("           ,(SELECT PAYR_CNTC_PNT_PHN_NO FROM DMT_PAYR_CNTC_PNT" ).append("\n"); 
		query.append("             WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("                                      FROM COM_SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("                                      WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)" ).append("\n"); 
		query.append("                                                      FROM MDM_ORGANIZATION" ).append("\n"); 
		query.append("                                                      WHERE OFC_CD = A.CRE_OFC_CD)" ).append("\n"); 
		query.append("                                      AND CO_IND_CD = 'H')" ).append("\n"); 
		query.append("             AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD" ).append("\n"); 
		query.append("             AND CUST_SEQ = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("             AND " ).append("\n"); 
		query.append("              ( " ).append("\n"); 
		query.append("                (A.CUST_CNTC_PNT_SEQ IS NULL AND  ROWNUM = 1)" ).append("\n"); 
		query.append("                 OR " ).append("\n"); 
		query.append("                (CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)" ).append("\n"); 
		query.append("              )" ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append("       ) AS PHN_NO             " ).append("\n"); 
		query.append("       ,DECODE((SELECT COUNT(*) FROM DMT_PAYR_CNTC_PNT  " ).append("\n"); 
		query.append("	            WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID  " ).append("\n"); 
		query.append("	                                   FROM COM_SYS_AREA_GRP_ID  " ).append("\n"); 
		query.append("	                                   WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2) " ).append("\n"); 
		query.append("	                                                                   FROM MDM_ORGANIZATION  " ).append("\n"); 
		query.append("	                                                                   WHERE OFC_CD = A.CRE_OFC_CD)  " ).append("\n"); 
		query.append("	                                   AND CO_IND_CD = 'H')   " ).append("\n"); 
		query.append("	             AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD " ).append("\n"); 
		query.append("	             AND CUST_SEQ = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("				 AND (" ).append("\n"); 
		query.append("					    (A.CUST_CNTC_PNT_SEQ IS NULL AND ROWNUM = 1)" ).append("\n"); 
		query.append("						OR" ).append("\n"); 
		query.append("						(CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)" ).append("\n"); 
		query.append("					 )" ).append("\n"); 
		query.append("				) " ).append("\n"); 
		query.append("				,0  " ).append("\n"); 
		query.append("				,DECODE(A.ACT_PAYR_CNT_CD , '00',  " ).append("\n"); 
		query.append("				   (SELECT V_CNTC.FAX_NO FROM MDM_VENDOR V_MDM, MDM_VNDR_CNTC_PNT V_CNTC " ).append("\n"); 
		query.append("				    WHERE V_MDM.VNDR_SEQ = V_CNTC.VNDR_SEQ  " ).append("\n"); 
		query.append("					AND V_MDM.VNDR_SEQ = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("				    AND V_CNTC.FAX_NO IS NOT NULL" ).append("\n"); 
		query.append("					AND ROWNUM = 1" ).append("\n"); 
		query.append("					)    " ).append("\n"); 
		query.append("				    ,   " ).append("\n"); 
		query.append("				    DECODE( " ).append("\n"); 
		query.append("				   (SELECT COUNT(*) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ AND DECODE(SUBSTR(A.DMDT_TRF_CD,2,3),'I',IB_FAX_NO,OB_FAX_NO) IS NOT NULL) " ).append("\n"); 
		query.append("				   ,0   " ).append("\n"); 
		query.append("				   ,(SELECT DISTINCT FAX_NO FROM MDM_CUSTOMER C_CUST, MDM_CUST_CNTC_PNT C_CNTC  " ).append("\n"); 
		query.append("				     WHERE C_CUST.CUST_CNT_CD  = C_CNTC.CUST_CNT_CD  " ).append("\n"); 
		query.append("				     AND C_CUST.CUST_SEQ   = C_CNTC.CUST_SEQ   " ).append("\n"); 
		query.append("				     AND C_CUST.CUST_CNT_CD  = A.ACT_PAYR_CNT_CD   " ).append("\n"); 
		query.append("				     AND C_CUST.CUST_SEQ   = A.ACT_PAYR_SEQ   " ).append("\n"); 
		query.append("				     AND C_CNTC.FAX_NO IS NOT NULL" ).append("\n"); 
		query.append("					 AND ROWNUM = 1)      " ).append("\n"); 
		query.append("				   ,(SELECT DISTINCT DECODE(SUBSTR(A.DMDT_TRF_CD,3,1),'I',IB_FAX_NO,OB_FAX_NO) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ)  " ).append("\n"); 
		query.append("				   )   " ).append("\n"); 
		query.append("				)" ).append("\n"); 
		query.append("         ,(SELECT PAYR_CNTC_PNT_FAX_NO FROM DMT_PAYR_CNTC_PNT " ).append("\n"); 
		query.append("           WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("                                    FROM COM_SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("                                    WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)" ).append("\n"); 
		query.append("                                                    FROM MDM_ORGANIZATION" ).append("\n"); 
		query.append("                                                    WHERE OFC_CD = A.CRE_OFC_CD)" ).append("\n"); 
		query.append("                                    AND CO_IND_CD = 'H')" ).append("\n"); 
		query.append("           AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD" ).append("\n"); 
		query.append("           AND CUST_SEQ = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("           AND " ).append("\n"); 
		query.append("              ( " ).append("\n"); 
		query.append("                (A.CUST_CNTC_PNT_SEQ IS NULL AND  ROWNUM = 1)" ).append("\n"); 
		query.append("                 OR " ).append("\n"); 
		query.append("                (CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)" ).append("\n"); 
		query.append("              )" ).append("\n"); 
		query.append("           )    " ).append("\n"); 
		query.append("		) FAX_NO    " ).append("\n"); 
		query.append("       , SH_ADDR1                                                                                                                                                             " ).append("\n"); 
		query.append("       , SH_ADDR2                                                                                                                                                             " ).append("\n"); 
		query.append("       , SH_ADDR3                                                                                                                                                             " ).append("\n"); 
		query.append("       , A.CRE_OFC_CD AS CRE_OFC_CD                                                                                                                                           " ).append("\n"); 
		query.append("       , A.DMDT_INV_STS_CD AS DMDT_INV_STS_CD                                                                                                                                 " ).append("\n"); 
		query.append("       , DECODE((SELECT TIT.CSTMZ_TIT_DESC                                                                                                                                    " ).append("\n"); 
		query.append("                         FROM DMT_CSTMZ_TIT_OPT TIT, DMT_CSTMZ_TIT_TRF_OPT TITTRF                                                                                             " ).append("\n"); 
		query.append("                         WHERE TIT.OFC_CD = TITTRF.OFC_CD                                                                                                                     " ).append("\n"); 
		query.append("                         AND TIT.CR_TERM_SEQ = TITTRF.CR_TERM_SEQ                                                                                                             " ).append("\n"); 
		query.append("                         AND TIT.OFC_CD = A.CRE_OFC_CD                                                                                                                        " ).append("\n"); 
		query.append("                         AND TITTRF.DMDT_TRF_CD = A.DMDT_TRF_CD                                                                                                               " ).append("\n"); 
		query.append("                         AND TIT.DMDT_SH_TP_CD = 'I'" ).append("\n"); 
		query.append("				   ), NULL" ).append("\n"); 
		query.append("				   ,(DECODE(A.DMDT_INV_STS_CD, 'C', '*** CREDIT NOTE ***', " ).append("\n"); 
		query.append("                                                    DECODE((SELECT SUBSTR(LOC_CD,0,2) " ).append("\n"); 
		query.append("                                                            FROM MDM_ORGANIZATION " ).append("\n"); 
		query.append("                                                            WHERE OFC_CD = A.CRE_OFC_CD), 'AU','*** TAX INVOICE ***', 'MY','*** TAX INVOICE ***', 'IN','*** TAX INVOICE ***'," ).append("\n"); 
		query.append("                                                                                               '*** INVOICE ***')))                                                                                                                          " ).append("\n"); 
		query.append("                   ,(SELECT DECODE(A.DMDT_INV_STS_CD, 'C', '*** CREDIT NOTE('||TIT.CSTMZ_TIT_DESC||') ***', " ).append("\n"); 
		query.append("                                                      DECODE((SELECT SUBSTR(LOC_CD,0,2) " ).append("\n"); 
		query.append("                                                              FROM MDM_ORGANIZATION " ).append("\n"); 
		query.append("                                                              WHERE OFC_CD = A.CRE_OFC_CD), 'AU','*** TAX INVOICE('||TIT.CSTMZ_TIT_DESC||') ***',  'MY','*** TAX INVOICE('||TIT.CSTMZ_TIT_DESC||') ***', 'IN','*** TAX INVOICE('||TIT.CSTMZ_TIT_DESC||') ***'," ).append("\n"); 
		query.append("                                                                                                      '*** INVOICE('||TIT.CSTMZ_TIT_DESC||') ***'))      " ).append("\n"); 
		query.append("				   FROM DMT_CSTMZ_TIT_OPT TIT, DMT_CSTMZ_TIT_TRF_OPT TITTRF                                                                                                    " ).append("\n"); 
		query.append("                   WHERE TIT.OFC_CD = TITTRF.OFC_CD                                                                                                                            " ).append("\n"); 
		query.append("                   AND TIT.CR_TERM_SEQ = TITTRF.CR_TERM_SEQ                                                                                                                    " ).append("\n"); 
		query.append("                   AND TIT.OFC_CD = A.CRE_OFC_CD                                                                                                                               " ).append("\n"); 
		query.append("                   AND TITTRF.DMDT_TRF_CD = A.DMDT_TRF_CD                                                                                                                      " ).append("\n"); 
		query.append("                   AND TIT.DMDT_SH_TP_CD = 'I'                                                                                                                                 " ).append("\n"); 
		query.append("                 )                                                                                                                                                            " ).append("\n"); 
		query.append("              ) AS INVOICE_TITLE                                                                                                                                                  " ).append("\n"); 
		query.append("       , DECODE(A.DMDT_INV_STS_CD, 'X','Cancelled', 'C', 'Ref: '||A.CR_INV_NO, ' ') AS CANCEL_NOTE                                                                                                        " ).append("\n"); 
		query.append("       , DECODE(                                                                                                                                                              " ).append("\n"); 
		query.append("			   (SELECT REPLACE(DMDT_PAYR_ADDR,'@*',CHR(13)||CHR(10))                                                                                                                    " ).append("\n"); 
		query.append("         	    FROM DMT_PAYR_INFO                                                                                                                                                   " ).append("\n"); 
		query.append("         	    WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID                                                                                                                      " ).append("\n"); 
		query.append("                                   		 FROM COM_SYS_AREA_GRP_ID                                                                                                                   " ).append("\n"); 
		query.append("                                   		 WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                                " ).append("\n"); 
		query.append("                                                   		 FROM MDM_ORGANIZATION                                                                                                      " ).append("\n"); 
		query.append("                                                   		 WHERE OFC_CD = A.CRE_OFC_CD)                                                                                               " ).append("\n"); 
		query.append("                                                   		 AND CO_IND_CD = 'H')                                                                                                       " ).append("\n"); 
		query.append("         		AND CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                                 " ).append("\n"); 
		query.append("         		AND CUST_SEQ   = A.ACT_PAYR_SEQ                                                                                                                                      " ).append("\n"); 
		query.append("               )" ).append("\n"); 
		query.append("			   ,NULL" ).append("\n"); 
		query.append("			   ,DECODE(                                                                                                                                                                 " ).append("\n"); 
		query.append("          			  (SELECT COUNT(*)     " ).append("\n"); 
		query.append("           			   FROM MDM_CR_CUST                                                                                                                                                   " ).append("\n"); 
		query.append("           			   WHERE CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                             " ).append("\n"); 
		query.append("           			   AND CUST_SEQ   = A.ACT_PAYR_SEQ " ).append("\n"); 
		query.append("					   AND TRIM(LOCL_ADDR1)||TRIM(LOCL_ADDR2)||TRIM(LOCL_ADDR3)||TRIM(LOCL_ADDR4) IS NOT NULL                                                                                                                                  " ).append("\n"); 
		query.append("          			  )" ).append("\n"); 
		query.append("					  , 0" ).append("\n"); 
		query.append("					  ,                                                                                                                                                            " ).append("\n"); 
		query.append("          			  (SELECT CASE WHEN A.ACT_PAYR_CNT_CD = '00' THEN ( SELECT ZIP_CD||','||REPLACE(ENG_ADDR,'@*',CHR(13)||CHR(10))                                                       " ).append("\n"); 
		query.append("                                                                        FROM MDM_VENDOR                                                                                                  " ).append("\n"); 
		query.append("                                                                        WHERE VNDR_SEQ = A.ACT_PAYR_SEQ)                                                                                 " ).append("\n"); 
		query.append("                              ELSE (SELECT CASE WHEN CN.BKG_ADDR_ORD_CD = 1 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.ZIP_CD                                            " ).append("\n"); 
		query.append("                                                WHEN CN.BKG_ADDR_ORD_CD = 2 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM                                       " ).append("\n"); 
		query.append("                                                WHEN CN.BKG_ADDR_ORD_CD = 3 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD                                    " ).append("\n"); 
		query.append("                                                WHEN CN.BKG_ADDR_ORD_CD = 4 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.STE_CD||' '||ADDR.ZIP_CD                  " ).append("\n"); 
		query.append("                                                WHEN CN.BKG_ADDR_ORD_CD = 5 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD                                    " ).append("\n"); 
		query.append("                                                WHEN CN.BKG_ADDR_ORD_CD = 6 THEN ADDR.CTY_NM||' '||REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.ZIP_CD                                    " ).append("\n"); 
		query.append("                                           ELSE REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD                                                                                           " ).append("\n"); 
		query.append("                                           END                                                                                                                                               " ).append("\n"); 
		query.append("                       				FROM MDM_CUST_ADDR ADDR, MDM_COUNTRY CN                                                                                                                " ).append("\n"); 
		query.append("                       				WHERE ADDR.CUST_CNT_CD = CN.CNT_CD(+)                                                                                                                  " ).append("\n"); 
		query.append("                       				AND ADDR.CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                              " ).append("\n"); 
		query.append("                       				AND ADDR.CUST_SEQ   = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("                       				AND ADDR.PRMRY_CHK_FLG = 'Y'" ).append("\n"); 
		query.append("                       				AND ROWNUM = 1                                                                                                                   " ).append("\n"); 
		query.append("                       			   )                                                                                                                                                      " ).append("\n"); 
		query.append("                   			  END                                                                                                                                                        " ).append("\n"); 
		query.append("            		   FROM DUAL                                                                                                                                                         " ).append("\n"); 
		query.append("          			  ),                                                                                                                                                                  " ).append("\n"); 
		query.append("          			  (SELECT TRIM(LOCL_ADDR1)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR2)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR3)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR4)||' '||LOCL_ZIP_CD AS ADDR     " ).append("\n"); 
		query.append("             		   FROM MDM_CR_CUST                                                                                                                                                 " ).append("\n"); 
		query.append("             		   WHERE CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                           " ).append("\n"); 
		query.append("             		   AND CUST_SEQ   = A.ACT_PAYR_SEQ                                                                                                                                  " ).append("\n"); 
		query.append("           			  )                                                                                                                                                                  " ).append("\n"); 
		query.append("       				  ),                                                                                                                                                                     " ).append("\n"); 
		query.append("       				  (SELECT REPLACE(DMDT_PAYR_ADDR,'@*',CHR(13)||CHR(10))                                                                                                                  " ).append("\n"); 
		query.append("         			   FROM DMT_PAYR_INFO                                                                                                                                                   " ).append("\n"); 
		query.append("         			   WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID                                                                                                                      " ).append("\n"); 
		query.append("                                   				FROM COM_SYS_AREA_GRP_ID                                                                                                                   " ).append("\n"); 
		query.append("                                   				WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                                " ).append("\n"); 
		query.append("                                                   				FROM MDM_ORGANIZATION                                                                                                      " ).append("\n"); 
		query.append("                                                   				WHERE OFC_CD = A.CRE_OFC_CD)                                                                                               " ).append("\n"); 
		query.append("                                                   				AND CO_IND_CD = 'H')                                                                                                       " ).append("\n"); 
		query.append("         										AND CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                                 " ).append("\n"); 
		query.append("         										AND CUST_SEQ   = A.ACT_PAYR_SEQ                                                                                                                                      " ).append("\n"); 
		query.append("      				  )                                                                                                                                                                       " ).append("\n"); 
		query.append("      				  )                                                                                                                                                                       " ).append("\n"); 
		query.append("    	  AS PAYR_ADDR                                                                                                                                                              " ).append("\n"); 
		query.append("        , B.SH_HD_N1ST_MSG AS SH_HD_N1ST_MSG                                                                                                                                  " ).append("\n"); 
		query.append("        , B.SH_HD_N2ND_MSG AS SH_HD_N2ND_MSG                                                                                                                                  " ).append("\n"); 
		query.append("        , B.SH_HD_N3RD_MSG AS SH_HD_N3RD_MSG                                                                                                                                  " ).append("\n"); 
		query.append("        , B.SH_HD_N4TH_MSG AS SH_HD_N4TH_MSG                                                                                                                                  " ).append("\n"); 
		query.append("        , B.SH_HD_N5TH_MSG AS SH_HD_N5TH_MSG                                                                                                                                  " ).append("\n"); 
		query.append("        , A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD AS VVD_CD                                                                                                                      " ).append("\n"); 
		query.append("        , (SELECT VSL_ENG_NM FROM MDM_VSL_CNTR WHERE VSL_CD = A.VSL_CD) AS VSL_ENG_NM                                                                                         " ).append("\n"); 
		query.append("        , (SELECT TO_CHAR(VPS_ETA_DT,'YYYYMMDD') FROM VSK_VSL_PORT_SKD                                                                                                        " ).append("\n"); 
		query.append("           WHERE VSL_CD = A.VSL_CD                                                                                                                                            " ).append("\n"); 
		query.append("             AND SKD_VOY_NO = A.SKD_VOY_NO                                                                                                                                    " ).append("\n"); 
		query.append("             AND SKD_DIR_CD = A.SKD_DIR_CD                                                                                                                                    " ).append("\n"); 
		query.append("             AND VPS_PORT_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                       " ).append("\n"); 
		query.append("                                ELSE A.POR_CD                                                                                                               " ).append("\n"); 
		query.append("                                END)                                                                                                                        " ).append("\n"); 
		query.append("             AND CLPT_IND_SEQ = 1                                                                                                                                             " ).append("\n"); 
		query.append("           ) AS ARR                                                                                                                                                           " ).append("\n"); 
		query.append("        , (SELECT TO_CHAR(VPS_ETD_DT,'YYYYMMDD') FROM VSK_VSL_PORT_SKD                                                                                                        " ).append("\n"); 
		query.append("           WHERE VSL_CD = A.VSL_CD                                                                                                                                            " ).append("\n"); 
		query.append("             AND SKD_VOY_NO = A.SKD_VOY_NO                                                                                                                                    " ).append("\n"); 
		query.append("             AND SKD_DIR_CD = A.SKD_DIR_CD                                                                                                                                    " ).append("\n"); 
		query.append("             AND VPS_PORT_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                       " ).append("\n"); 
		query.append("                                ELSE A.POR_CD                                                                                                              " ).append("\n"); 
		query.append("                                END)                                                                                                                       " ).append("\n"); 
		query.append("             AND CLPT_IND_SEQ = 1                                                                                                                                             " ).append("\n"); 
		query.append("           ) AS DEP                                                                                                                                                           " ).append("\n"); 
		query.append("        , A.BL_NO AS BL_NO                                                                                                                                                    " ).append("\n"); 
		query.append("        , A.BKG_NO AS BKG_NO                                                                                                                                                  " ).append("\n"); 
		query.append("        , (SELECT CMDT_CD FROM BKG_BOOKING" ).append("\n"); 
		query.append("		   WHERE BKG_NO = A.BKG_NO) AS CMDT_CD                                                                                                                                                        " ).append("\n"); 
		query.append("        , (SELECT CMDT_NM FROM MDM_COMMODITY                                                                                                                                  " ).append("\n"); 
		query.append("           WHERE CMDT_CD = (SELECT CMDT_CD FROM BKG_BOOKING" ).append("\n"); 
		query.append("							WHERE BKG_NO = A.BKG_NO)) AS CMDT_NM                                                                                                                    " ).append("\n"); 
		query.append("        , A.DMDT_TRF_CD AS DMDT_TRF_CD                                                                                                                                        " ).append("\n"); 
		query.append("        , (SELECT DMDT_TRF_NM FROM DMT_TRF_TP WHERE DMDT_TRF_CD = A.DMDT_TRF_CD) AS DMDT_TRF_NM  " ).append("\n"); 
		query.append("        , A.BKG_RCV_TERM_CD" ).append("\n"); 
		query.append("        , (SELECT INTG_CD_VAL_DP_DESC                                                                                                                                         " ).append("\n"); 
		query.append("           FROM COM_INTG_CD_DTL                                                                                                                                               " ).append("\n"); 
		query.append("           WHERE INTG_CD_VAL_CTNT = A.BKG_RCV_TERM_CD                                                   " ).append("\n"); 
		query.append("             AND INTG_CD_ID = 'CD00764'                                                                                                                                       " ).append("\n"); 
		query.append("          ) AS BKG_RCV_TERM_NM  " ).append("\n"); 
		query.append("        , A.BKG_DE_TERM_CD" ).append("\n"); 
		query.append("        , (SELECT INTG_CD_VAL_DP_DESC                                                                                                                                         " ).append("\n"); 
		query.append("           FROM COM_INTG_CD_DTL                                                                                                                                               " ).append("\n"); 
		query.append("           WHERE INTG_CD_VAL_CTNT = A.BKG_DE_TERM_CD                                                   " ).append("\n"); 
		query.append("             AND INTG_CD_ID = 'CD00765'                                                                                                                                       " ).append("\n"); 
		query.append("          ) AS BKG_DEL_TERM_NM                                                                                                                                            " ).append("\n"); 
		query.append("        , (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                                            " ).append("\n"); 
		query.append("           ELSE A.POR_CD                                                                                                                                                      " ).append("\n"); 
		query.append("           END) AS POD                                                                                                                                                        " ).append("\n"); 
		query.append("        , (SELECT LOC_NM                                                                                                                                                      " ).append("\n"); 
		query.append("           FROM MDM_LOCATION                                                                                                                                                  " ).append("\n"); 
		query.append("           WHERE LOC_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                            " ).append("\n"); 
		query.append("                                           ELSE A.POR_CD                                                                                                                      " ).append("\n"); 
		query.append("                                           END)                                                                                                                               " ).append("\n"); 
		query.append("          ) AS POD_NM                                                                                                                                                         " ).append("\n"); 
		query.append("        , (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.DEL_CD                                                                                                            " ).append("\n"); 
		query.append("           ELSE A.POL_CD                                                                                                                                                      " ).append("\n"); 
		query.append("           END) AS DEL                                                                                                                                                        " ).append("\n"); 
		query.append("        , (SELECT LOC_NM                                                                                                                                                      " ).append("\n"); 
		query.append("           FROM MDM_LOCATION                                                                                                                                                  " ).append("\n"); 
		query.append("           WHERE LOC_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.DEL_CD                                                                                            " ).append("\n"); 
		query.append("                           ELSE A.POL_CD                                                                                                                      " ).append("\n"); 
		query.append("                           END)                                                                                                                               " ).append("\n"); 
		query.append("          ) AS DEL_NM                                                                                                                                                         " ).append("\n"); 
		query.append("        ,   (                                                                                                                                                                   " ).append("\n"); 
		query.append("            SELECT    DECODE(S.VNDR_SEQ, 0, '',(SELECT VNDR_LGL_ENG_NM FROM MDM_VENDOR WHERE VNDR_SEQ = S.VNDR_SEQ))" ).append("\n"); 
		query.append("            FROM      DMT_CHG_CALC S" ).append("\n"); 
		query.append("            WHERE     1=1" ).append("\n"); 
		query.append("            AND       S.DMDT_INV_NO   = A.DMDT_INV_NO" ).append("\n"); 
		query.append("            AND       ROWNUM          = 1                                                                                                                                                      " ).append("\n"); 
		query.append("            )   AS TRUCKER_NM                                                                                                                                                     " ).append("\n"); 
		query.append("        , NVL(A.BIL_AMT,0) AS ORG_CHG_AMT" ).append("\n"); 
		query.append("        , A.CHG_CURR_CD AS ORG_CURR_CD                                                                                                                                        " ).append("\n"); 
		query.append("        , NVL(A.INV_XCH_RT,0) AS INV_XCH_RT                                                                                                                                          " ).append("\n"); 
		query.append("        , A.INV_CURR_CD AS INV_CURR_CD                                                                                                                                        " ).append("\n"); 
		query.append("        , (NVL(A.INV_CHG_AMT,0) + NVL(A.DC_AMT,0)) AS TOT_AMT                                                                                                                               " ).append("\n"); 
		query.append("        , NVL(A.DC_AMT,0) AS DC_AMT                                                                                                                                                  " ).append("\n"); 
		query.append("        , NVL(A.INV_CHG_AMT,0) AS INV_CHG_AMT                                                                                                                                        " ).append("\n"); 
		query.append("        , A.TAX_RTO AS TAX_RTO                                                                                                                                                " ).append("\n"); 
		query.append("        , NVL(A.TAX_AMT,0) AS TAX_AMT                                                                                                                                                " ).append("\n"); 
		query.append("        , NVL(A.INV_AMT,0) AS INV_AMT                                                                                                                                                " ).append("\n"); 
		query.append("        , CASE WHEN INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10), 1, 1) = 0 THEN                                                                                           " ).append("\n"); 
		query.append("                SUBSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10), -1, 1) + 1)                                                         " ).append("\n"); 
		query.append("          ELSE                                                                                                                                                                " ).append("\n"); 
		query.append("                SUBSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), 0, INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10),1,1))                                                             " ).append("\n"); 
		query.append("          END AS INV_RMK1                                                                                                                                                     " ).append("\n"); 
		query.append("        , CASE WHEN INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10), 1, 1) = 0 THEN                                                                                           " ).append("\n"); 
		query.append("                ''                                                                                                                                                          " ).append("\n"); 
		query.append("          ELSE                                                                                                                                                                " ).append("\n"); 
		query.append("                SUBSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10),-1,1)+1)                                                           " ).append("\n"); 
		query.append("          END AS INV_RMK2                                                                                                                                                     " ).append("\n"); 
		query.append("        , B.SH_RMK1 AS SH_RMK1                                                                                                                                                " ).append("\n"); 
		query.append("        , B.SH_RMK2 AS SH_RMK2                                                                                                                                                " ).append("\n"); 
		query.append("        , B.SH_RMK3 AS SH_RMK3                                                                                                                                                " ).append("\n"); 
		query.append("        , B.SH_RMK4 AS SH_RMK4                                                                                                                                                " ).append("\n"); 
		query.append("        , B.SH_RMK5 AS SH_RMK5                                                                                                                                                " ).append("\n"); 
		query.append("        , B.SH_RMK6 AS SH_RMK6                                                                                                                                                " ).append("\n"); 
		query.append("        , B.SH_RMK7 AS SH_RMK7                                                                                                                                                " ).append("\n"); 
		query.append("        , B.SH_RMK8 AS SH_RMK8                                                                                                                                                " ).append("\n"); 
		query.append("        , B.SH_RMK9 AS SH_RMK9                                                                                                                                                " ).append("\n"); 
		query.append("        , B.SH_RMK10 AS SH_RMK10                                                                                                                                              " ).append("\n"); 
		query.append("        , B.SH_RMK11 AS SH_RMK11                                                                                                                                              " ).append("\n"); 
		query.append("        , B.SH_RMK12 AS SH_RMK12                                                                                                                                              " ).append("\n"); 
		query.append("        , B.SH_RMK13 AS SH_RMK13                                                                                                                                              " ).append("\n"); 
		query.append("        , B.SH_RMK14 AS SH_RMK14                                                                                                                                              " ).append("\n"); 
		query.append("        , (SELECT TAX_AMT_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS TAX_AMT_PRN_FLG                                                                         " ).append("\n"); 
		query.append("        , (DECODE (A.DC_AMT, 0, 'N', (SELECT DC_AMT_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD))) AS DC_AMT_FLG                                                      " ).append("\n"); 
		query.append("        , (SELECT CUST_REF_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS CUST_REF_PRN_FLG                                                                       " ).append("\n"); 
		query.append("        , (SELECT CUST_VAT_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS CUST_VAT_PRN_FLG                                                                       " ).append("\n"); 
		query.append("        , (SELECT PHN_FAX_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS PHN_FAX_PRN_FLG  " ).append("\n"); 
		query.append("		, A.POD_CD" ).append("\n"); 
		query.append("		, A.POR_CD" ).append("\n"); 
		query.append("		, A.DEL_CD" ).append("\n"); 
		query.append("		, A.POL_CD" ).append("\n"); 
		query.append("		--// INDIA TAX 변경 전" ).append("\n"); 
		query.append("        , A.IDA_EXPN_TAX_RT" ).append("\n"); 
		query.append("        , A.IDA_EXPN_TAX   " ).append("\n"); 
		query.append("        , A.IDA_EDU_TAX_RT" ).append("\n"); 
		query.append("        , A.IDA_EDU_TAX    " ).append("\n"); 
		query.append("        , A.IDA_HIGH_EDU_TAX_RT" ).append("\n"); 
		query.append("        , A.IDA_HIGH_EDU_TAX" ).append("\n"); 
		query.append("        , A.IDA_LOCL_TAX_RT" ).append("\n"); 
		query.append("        , A.IDA_LOCL_TAX   " ).append("\n"); 
		query.append("        , A.IDA_N2ND_LOCL_TAX_RT" ).append("\n"); 
		query.append("		, A.IDA_N2ND_LOCL_TAX" ).append("\n"); 
		query.append("		--// INDIA TAX 변경 후" ).append("\n"); 
		query.append("		, A.IDA_CGST_RTO" ).append("\n"); 
		query.append("		, A.IDA_CGST_AMT" ).append("\n"); 
		query.append("		, A.IDA_SGST_RTO" ).append("\n"); 
		query.append("		, A.IDA_SGST_AMT" ).append("\n"); 
		query.append("		, A.IDA_IGST_RTO" ).append("\n"); 
		query.append("		, A.IDA_IGST_AMT" ).append("\n"); 
		query.append("		, A.IDA_UGST_RTO" ).append("\n"); 
		query.append("		, A.IDA_UGST_AMT" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("  FROM  DMT_INV_MN 	A" ).append("\n"); 
		query.append("       ,DMT_SH_SET  B" ).append("\n"); 
		query.append("	   " ).append("\n"); 
		query.append(" WHERE  A.CRE_OFC_CD    = B.OFC_CD                                                                                                                                              " ).append("\n"); 
		query.append("   AND  A.DMDT_TRF_CD   = B.DMDT_TRF_CD                                                                                                                                          " ).append("\n"); 
		query.append("   AND  B.DMDT_SH_TP_CD = 'I'                                                                                                                                                  " ).append("\n"); 
		query.append("   AND  A.DMDT_INV_NO   = @[invoice_no] " ).append("\n"); 
		query.append("   AND  A.CRE_OFC_CD    = @[cre_ofc_cd]                                                                                                          " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("-- Manual Invoice" ).append("\n"); 
		query.append("SELECT  A.DMDT_INV_NO AS DMDT_INV_NO       " ).append("\n"); 
		query.append("	, TO_CHAR(A.CRE_DT,'YYYYMMDD') AS ISSUE_DAY      " ).append("\n"); 
		query.append("    , DECODE((SELECT COUNT(*) FROM DMT_CR_TERM_OPT WHERE OFC_CD = A.CRE_OFC_CD)   " ).append("\n"); 
		query.append("              , 0                                 " ).append("\n"); 
		query.append("              , TO_CHAR(A.CRE_DT,  'DDMonYY', 'NLS_DATE_LANGUAGE = American')      " ).append("\n"); 
		query.append("              , (SELECT CASE WHEN CR_TERM_DYS > 0 THEN TO_CHAR(A.CRE_DT + CR_TERM_DYS, 'DDMonYY', 'NLS_DATE_LANGUAGE = American')    " ).append("\n"); 
		query.append("                             WHEN CR_TERM_DYS = 0 THEN                                                                               " ).append("\n"); 
		query.append("                                 CASE WHEN ISS_DT_PRN_FLG = 'Y' THEN TO_CHAR(A.CRE_DT,  'DDMonYY', 'NLS_DATE_LANGUAGE = American')    " ).append("\n"); 
		query.append("                                 ELSE '*******'                                                                                       " ).append("\n"); 
		query.append("                                 END                                                                                                  " ).append("\n"); 
		query.append("                        END DUE_DATE                                                                                                 " ).append("\n"); 
		query.append("                  FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                " ).append("\n"); 
		query.append("                  WHERE OPT.OFC_CD = TRF_OPT.OFC_CD" ).append("\n"); 
		query.append("    			  AND OPT.CR_TERM_SEQ = TRF_OPT.CR_TERM_SEQ" ).append("\n"); 
		query.append("    			  AND OPT.OFC_CD = A.CRE_OFC_CD" ).append("\n"); 
		query.append("				  AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD                                                                                     " ).append("\n"); 
		query.append("                 )                                                                                                                    " ).append("\n"); 
		query.append("           ) AS DUE_DATE                                                                                                                " ).append("\n"); 
		query.append("       ,DECODE(                                                                                                                       " ).append("\n"); 
		query.append("               (SELECT COUNT(*) FROM DMT_CR_TERM_OPT WHERE OFC_CD = A.CRE_OFC_CD)  " ).append("\n"); 
		query.append("                , 0                                                                                                                     " ).append("\n"); 
		query.append("                , 0                                                                                                                     " ).append("\n"); 
		query.append("                , (SELECT CASE WHEN OPT.CR_TERM_DYS > 0 THEN TO_CHAR(OPT.CR_TERM_DYS)                                                           " ).append("\n"); 
		query.append("                             WHEN OPT.CR_TERM_DYS = 0 THEN                                                                                " ).append("\n"); 
		query.append("                                  CASE WHEN OPT.ISS_DT_PRN_FLG = 'Y' THEN '0'                                                             " ).append("\n"); 
		query.append("                                  ELSE ''                                                                                             " ).append("\n"); 
		query.append("                                  END                                                                                                 " ).append("\n"); 
		query.append("                        END DUE_DAY                                                                                                   " ).append("\n"); 
		query.append("                 FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                 " ).append("\n"); 
		query.append("                 WHERE OPT.OFC_CD = TRF_OPT.OFC_CD" ).append("\n"); 
		query.append("				   AND OPT.CR_TERM_SEQ = TRF_OPT.CR_TERM_SEQ" ).append("\n"); 
		query.append("				   AND OPT.OFC_CD = A.CRE_OFC_CD" ).append("\n"); 
		query.append("				   AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD)                                                                                         " ).append("\n"); 
		query.append("        ) AS DUE_DAY                                                    " ).append("\n"); 
		query.append("		, DECODE(DECODE(                              " ).append("\n"); 
		query.append("			 		 (SELECT COUNT(*) FROM DMT_CR_TERM_OPT WHERE OFC_CD = A.CRE_OFC_CD)                                                                                          " ).append("\n"); 
		query.append("					, 0                                                                                                                   " ).append("\n"); 
		query.append("					, TO_CHAR(A.CRE_DT,  'YYYYMMDD')" ).append("\n"); 
		query.append("					,(SELECT CASE WHEN CR_TERM_DYS > 0 THEN TO_CHAR(A.CRE_DT + CR_TERM_DYS, 'YYYYMMDD')    " ).append("\n"); 
		query.append("			              		  WHEN CR_TERM_DYS = 0 THEN                                                                               " ).append("\n"); 
		query.append("			                       		CASE WHEN ISS_DT_PRN_FLG = 'Y' THEN TO_CHAR(A.CRE_DT,  'YYYYMMDD')    " ).append("\n"); 
		query.append("			                       		ELSE '*******'                                                                                       " ).append("\n"); 
		query.append("			                       		END                                                                                                  " ).append("\n"); 
		query.append("			         		 END DUE_DATE                                                                                                 " ).append("\n"); 
		query.append("			  		  FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                " ).append("\n"); 
		query.append("			  		  WHERE OPT.OFC_CD 		= TRF_OPT.OFC_CD" ).append("\n"); 
		query.append("			  		  AND OPT.CR_TERM_SEQ 	= TRF_OPT.CR_TERM_SEQ" ).append("\n"); 
		query.append("			  		  AND OPT.OFC_CD 		= A.CRE_OFC_CD  " ).append("\n"); 
		query.append("			  		  AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD)                                                                                                                    " ).append("\n"); 
		query.append("		    			)" ).append("\n"); 
		query.append("				, '*******'" ).append("\n"); 
		query.append("				, 'N'" ).append("\n"); 
		query.append("				, DECODE( DECODE(  " ).append("\n"); 
		query.append("							 (SELECT COUNT(*) FROM DMT_CR_TERM_OPT WHERE OFC_CD = A.CRE_OFC_CD)                                                                                          " ).append("\n"); 
		query.append("				  			, 0                                                                                                                   " ).append("\n"); 
		query.append("				  			, TO_CHAR(A.CRE_DT,  'YYYYMMDD')" ).append("\n"); 
		query.append("				  			,(SELECT CASE WHEN CR_TERM_DYS > 0 THEN TO_CHAR(A.CRE_DT + CR_TERM_DYS, 'YYYYMMDD')    " ).append("\n"); 
		query.append("				                	      WHEN CR_TERM_DYS = 0 THEN                                                                               " ).append("\n"); 
		query.append("				                   				CASE WHEN ISS_DT_PRN_FLG = 'Y' THEN TO_CHAR(A.CRE_DT,  'YYYYMMDD')    " ).append("\n"); 
		query.append("				                   				ELSE '*******'                                                                                       " ).append("\n"); 
		query.append("				                   				END                                                                                                  " ).append("\n"); 
		query.append("				           			 END DUE_DATE                                                                                                 " ).append("\n"); 
		query.append("				    		  FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                " ).append("\n"); 
		query.append("				    		  WHERE OPT.OFC_CD 		= TRF_OPT.OFC_CD" ).append("\n"); 
		query.append("				    		  AND OPT.CR_TERM_SEQ 	= TRF_OPT.CR_TERM_SEQ" ).append("\n"); 
		query.append("				   			  AND OPT.OFC_CD 		= A.CRE_OFC_CD  " ).append("\n"); 
		query.append("				    		  AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD)                                                                                                                    " ).append("\n"); 
		query.append("			     			)" ).append("\n"); 
		query.append("				 		, TO_CHAR(A.CRE_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("				 		, 'N'" ).append("\n"); 
		query.append("				 		, 'Y')" ).append("\n"); 
		query.append("		) AS DAYS_DISP" ).append("\n"); 
		query.append("       ,DECODE(A.NTC_KNT_CD, '1','1st NOTICE',2,'2nd NOTICE',3,'3rd NOTICE',9,'FINAL NOTICE','') AS NTC_KNT_CD                                                                " ).append("\n"); 
		query.append("       ,A.CRE_USR_ID AS CRE_USR_ID                                                                                                                                            " ).append("\n"); 
		query.append("       ,(SELECT USR_NM FROM COM_USER WHERE USR_ID = A.CRE_USR_ID) AS CRE_USR_NM                                                                                               " ).append("\n"); 
		query.append("	   ,(SELECT SUBSTR(LOC_CD,0,2) FROM MDM_ORGANIZATION WHERE OFC_CD = A.CRE_OFC_CD) AS CRE_CNT_CD                                                                                               " ).append("\n"); 
		query.append("       ,DECODE(A.ACT_PAYR_CNT_CD,'00','',A.ACT_PAYR_CNT_CD)||LPAD(A.ACT_PAYR_SEQ,6,'0') AS CUST_CD                                                                            " ).append("\n"); 
		query.append("       ,A.INV_REF_NO AS INV_REF_NO                                                                                                                                            " ).append("\n"); 
		query.append("       ,(SELECT CUST_RGST_NO                                                                                                                                                  " ).append("\n"); 
		query.append("         FROM MDM_CUSTOMER                                                                                                                                                    " ).append("\n"); 
		query.append("         WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                                                " ).append("\n"); 
		query.append("         AND CUST_SEQ = A.ACT_PAYR_SEQ) AS CUST_VAT_NO                                                                                                                      " ).append("\n"); 
		query.append("      ,DECODE((SELECT DMDT_PAYR_NM                                                                                                                                            " ).append("\n"); 
		query.append("               FROM DMT_PAYR_INFO                                                                                                                                             " ).append("\n"); 
		query.append("               WHERE SYS_AREA_GRP_ID  = (SELECT SYS_AREA_GRP_ID                                                                                                               " ).append("\n"); 
		query.append("                                         FROM COM_SYS_AREA_GRP_ID                                                                                                             " ).append("\n"); 
		query.append("                                         WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                          " ).append("\n"); 
		query.append("                                                         FROM MDM_ORGANIZATION                                                                                                " ).append("\n"); 
		query.append("                                                         WHERE OFC_CD = A.CRE_OFC_CD)                                                                                         " ).append("\n"); 
		query.append("                                         AND CO_IND_CD = 'H')                                                                                                                 " ).append("\n"); 
		query.append("               AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                                            " ).append("\n"); 
		query.append("               AND CUST_SEQ  = A.ACT_PAYR_SEQ)" ).append("\n"); 
		query.append("			  ,NULL" ).append("\n"); 
		query.append("			  ,(DECODE((SELECT LOCL_NM                                                                                                                                     " ).append("\n"); 
		query.append("                        FROM MDM_CR_CUST                                                                                                                                   " ).append("\n"); 
		query.append("                        WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                              " ).append("\n"); 
		query.append("                        AND CUST_SEQ    = A.ACT_PAYR_SEQ                                                                                                                   " ).append("\n"); 
		query.append("                        AND LOCL_NM IS NOT NULL)" ).append("\n"); 
		query.append("					   ,NULL" ).append("\n"); 
		query.append("					   ,(SELECT CASE WHEN A.ACT_PAYR_CNT_CD = '00' THEN (SELECT VNDR_LGL_ENG_NM                                                                             " ).append("\n"); 
		query.append("                                                              			 FROM MDM_VENDOR                                                                                                 " ).append("\n"); 
		query.append("                                                              			 WHERE VNDR_SEQ = A.ACT_PAYR_SEQ                                                                                 " ).append("\n"); 
		query.append("                                                              			 AND VNDR_LGL_ENG_NM IS NOT NULL)                                                                                " ).append("\n"); 
		query.append("                                ELSE (SELECT CUST_LGL_ENG_NM                                                                                                                " ).append("\n"); 
		query.append("                                      FROM MDM_CUSTOMER                                                                                                                     " ).append("\n"); 
		query.append("                                      WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                 " ).append("\n"); 
		query.append("                                      AND CUST_SEQ     = A.ACT_PAYR_SEQ                                                                                                     " ).append("\n"); 
		query.append("                                      AND CUST_LGL_ENG_NM IS NOT NULL)                                                                                                      " ).append("\n"); 
		query.append("                                END MDM_NAME                                                                                                                                " ).append("\n"); 
		query.append("                          FROM DUAL)" ).append("\n"); 
		query.append("						,(SELECT LOCL_NM                                                                                                                                    " ).append("\n"); 
		query.append("                          FROM MDM_CR_CUST                                                                                                                                   " ).append("\n"); 
		query.append("                          WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                              " ).append("\n"); 
		query.append("                          AND CUST_SEQ    = A.ACT_PAYR_SEQ                                                                                                                   " ).append("\n"); 
		query.append("                          AND LOCL_NM IS NOT NULL)                                                                                                                                                  " ).append("\n"); 
		query.append("                        )                                                                                                                                                    " ).append("\n"); 
		query.append("              		)" ).append("\n"); 
		query.append("			  ,(SELECT DMDT_PAYR_NM                                                                                                                                             " ).append("\n"); 
		query.append("                FROM DMT_PAYR_INFO                                                                                                                                              " ).append("\n"); 
		query.append("                WHERE SYS_AREA_GRP_ID  = (SELECT SYS_AREA_GRP_ID                                                                                                                " ).append("\n"); 
		query.append("                                          FROM COM_SYS_AREA_GRP_ID                                                                                                               " ).append("\n"); 
		query.append("                                          WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                            " ).append("\n"); 
		query.append("                                                          FROM MDM_ORGANIZATION                                                                                                  " ).append("\n"); 
		query.append("                                                          WHERE OFC_CD = A.CRE_OFC_CD)                                                                                           " ).append("\n"); 
		query.append("                                          AND CO_IND_CD = 'H')                                                                                                                   " ).append("\n"); 
		query.append("                AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                                             " ).append("\n"); 
		query.append("                AND CUST_SEQ  = A.ACT_PAYR_SEQ)                                                                                                                                                               " ).append("\n"); 
		query.append("           ) AS CUST_NM                                                                                                                                                        " ).append("\n"); 
		query.append("       ,DMDT_PAYR_CNTC_PNT_NM AS ATTN_NM                                                                                                                                      " ).append("\n"); 
		query.append("       ,DECODE((SELECT COUNT(*) FROM DMT_PAYR_CNTC_PNT  " ).append("\n"); 
		query.append("                WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID   " ).append("\n"); 
		query.append("                                         FROM COM_SYS_AREA_GRP_ID   " ).append("\n"); 
		query.append("                                         WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2) " ).append("\n"); 
		query.append("                                                         FROM MDM_ORGANIZATION  " ).append("\n"); 
		query.append("                                                         WHERE OFC_CD = A.CRE_OFC_CD) " ).append("\n"); 
		query.append("                                         AND CO_IND_CD = 'H')    " ).append("\n"); 
		query.append("                   AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD     " ).append("\n"); 
		query.append("                   AND CUST_SEQ = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("				   AND (" ).append("\n"); 
		query.append("						(A.CUST_CNTC_PNT_SEQ IS NULL AND ROWNUM = 1)" ).append("\n"); 
		query.append("						OR" ).append("\n"); 
		query.append("						(CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)" ).append("\n"); 
		query.append("					   )" ).append("\n"); 
		query.append("				  )       " ).append("\n"); 
		query.append("                  ,0              " ).append("\n"); 
		query.append("                  ,DECODE(A.ACT_PAYR_CNT_CD , '00',      " ).append("\n"); 
		query.append("		         (SELECT V_CNTC.PHN_NO FROM MDM_VENDOR V_MDM, MDM_VNDR_CNTC_PNT V_CNTC  " ).append("\n"); 
		query.append("		          WHERE V_MDM.VNDR_SEQ = V_CNTC.VNDR_SEQ       " ).append("\n"); 
		query.append("				  AND V_MDM.VNDR_SEQ = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("		          AND V_CNTC.PHN_NO IS NOT NULL" ).append("\n"); 
		query.append("				  AND ROWNUM = 1)        " ).append("\n"); 
		query.append("		          ,                " ).append("\n"); 
		query.append("		          DECODE(               " ).append("\n"); 
		query.append("		         (SELECT COUNT(*) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ AND DECODE(SUBSTR(A.DMDT_TRF_CD,2,3),'I',IB_PHN_NO,OB_PHN_NO) IS NOT NULL) " ).append("\n"); 
		query.append("		         ,0                " ).append("\n"); 
		query.append("                 ,(SELECT DISTINCT PHN_NO FROM MDM_CUSTOMER C_CUST, MDM_CUST_CNTC_PNT C_CNTC" ).append("\n"); 
		query.append("                   WHERE C_CUST.CUST_CNT_CD  = C_CNTC.CUST_CNT_CD" ).append("\n"); 
		query.append("                   AND C_CUST.CUST_SEQ   = C_CNTC.CUST_SEQ" ).append("\n"); 
		query.append("                   AND C_CUST.CUST_CNT_CD  = A.ACT_PAYR_CNT_CD" ).append("\n"); 
		query.append("                   AND C_CUST.CUST_SEQ   = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("                   AND C_CNTC.PHN_NO IS NOT NULL" ).append("\n"); 
		query.append("				   AND ROWNUM = 1)" ).append("\n"); 
		query.append("                 ,(SELECT DISTINCT DECODE(SUBSTR(A.DMDT_TRF_CD,2,3),'I',IB_PHN_NO,OB_PHN_NO) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ)" ).append("\n"); 
		query.append("				)                " ).append("\n"); 
		query.append("			)                 " ).append("\n"); 
		query.append("           ,(SELECT PAYR_CNTC_PNT_PHN_NO FROM DMT_PAYR_CNTC_PNT" ).append("\n"); 
		query.append("             WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("                                      FROM COM_SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("                                      WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)" ).append("\n"); 
		query.append("                                                      FROM MDM_ORGANIZATION" ).append("\n"); 
		query.append("                                                      WHERE OFC_CD = A.CRE_OFC_CD)" ).append("\n"); 
		query.append("                                      AND CO_IND_CD = 'H')" ).append("\n"); 
		query.append("             AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD" ).append("\n"); 
		query.append("             AND CUST_SEQ = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("             AND " ).append("\n"); 
		query.append("              ( " ).append("\n"); 
		query.append("                (A.CUST_CNTC_PNT_SEQ IS NULL AND  ROWNUM = 1)" ).append("\n"); 
		query.append("                 OR " ).append("\n"); 
		query.append("                (CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)" ).append("\n"); 
		query.append("              )" ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append("       ) AS PHN_NO                                                          " ).append("\n"); 
		query.append("       ,DECODE((SELECT COUNT(*) FROM DMT_PAYR_CNTC_PNT  " ).append("\n"); 
		query.append("	            WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID  " ).append("\n"); 
		query.append("	                                   FROM COM_SYS_AREA_GRP_ID  " ).append("\n"); 
		query.append("	                                   WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2) " ).append("\n"); 
		query.append("	                                                                   FROM MDM_ORGANIZATION  " ).append("\n"); 
		query.append("	                                                                   WHERE OFC_CD = A.CRE_OFC_CD)  " ).append("\n"); 
		query.append("	                                   AND CO_IND_CD = 'H')   " ).append("\n"); 
		query.append("	             AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD " ).append("\n"); 
		query.append("	             AND CUST_SEQ = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("				 AND (" ).append("\n"); 
		query.append("					    (A.CUST_CNTC_PNT_SEQ IS NULL AND ROWNUM = 1)" ).append("\n"); 
		query.append("						OR" ).append("\n"); 
		query.append("						(CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)" ).append("\n"); 
		query.append("					 )" ).append("\n"); 
		query.append("				) " ).append("\n"); 
		query.append("				,0  " ).append("\n"); 
		query.append("				,DECODE(A.ACT_PAYR_CNT_CD , '00',  " ).append("\n"); 
		query.append("				   (SELECT V_CNTC.FAX_NO FROM MDM_VENDOR V_MDM, MDM_VNDR_CNTC_PNT V_CNTC " ).append("\n"); 
		query.append("				    WHERE V_MDM.VNDR_SEQ = V_CNTC.VNDR_SEQ" ).append("\n"); 
		query.append("					AND V_MDM.VNDR_SEQ = A.ACT_PAYR_SEQ  " ).append("\n"); 
		query.append("				    AND V_CNTC.FAX_NO IS NOT NULL" ).append("\n"); 
		query.append("					AND ROWNUM = 1" ).append("\n"); 
		query.append("					)    " ).append("\n"); 
		query.append("				    ,   " ).append("\n"); 
		query.append("				    DECODE( " ).append("\n"); 
		query.append("				   (SELECT COUNT(*) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ AND DECODE(SUBSTR(A.DMDT_TRF_CD,2,3),'I',IB_FAX_NO,OB_FAX_NO) IS NOT NULL) " ).append("\n"); 
		query.append("				   ,0   " ).append("\n"); 
		query.append("				   ,(SELECT DISTINCT FAX_NO FROM MDM_CUSTOMER C_CUST, MDM_CUST_CNTC_PNT C_CNTC  " ).append("\n"); 
		query.append("				     WHERE C_CUST.CUST_CNT_CD  = C_CNTC.CUST_CNT_CD  " ).append("\n"); 
		query.append("				     AND C_CUST.CUST_SEQ   = C_CNTC.CUST_SEQ   " ).append("\n"); 
		query.append("				     AND C_CUST.CUST_CNT_CD  = A.ACT_PAYR_CNT_CD   " ).append("\n"); 
		query.append("				     AND C_CUST.CUST_SEQ   = A.ACT_PAYR_SEQ   " ).append("\n"); 
		query.append("				     AND C_CNTC.FAX_NO IS NOT NULL" ).append("\n"); 
		query.append("					 AND ROWNUM = 1)      " ).append("\n"); 
		query.append("				   ,(SELECT DISTINCT DECODE(SUBSTR(A.DMDT_TRF_CD,3,1),'I',IB_FAX_NO,OB_FAX_NO) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ)  " ).append("\n"); 
		query.append("				   )   " ).append("\n"); 
		query.append("				)" ).append("\n"); 
		query.append("         ,(SELECT PAYR_CNTC_PNT_FAX_NO FROM DMT_PAYR_CNTC_PNT " ).append("\n"); 
		query.append("           WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("                                    FROM COM_SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("                                    WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)" ).append("\n"); 
		query.append("                                                    FROM MDM_ORGANIZATION" ).append("\n"); 
		query.append("                                                    WHERE OFC_CD = A.CRE_OFC_CD)" ).append("\n"); 
		query.append("                                    AND CO_IND_CD = 'H')" ).append("\n"); 
		query.append("           AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD" ).append("\n"); 
		query.append("           AND CUST_SEQ = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("           AND " ).append("\n"); 
		query.append("              ( " ).append("\n"); 
		query.append("                (A.CUST_CNTC_PNT_SEQ IS NULL AND  ROWNUM = 1)" ).append("\n"); 
		query.append("                 OR " ).append("\n"); 
		query.append("                (CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)" ).append("\n"); 
		query.append("              )" ).append("\n"); 
		query.append("           )    " ).append("\n"); 
		query.append("		) FAX_NO                                                    " ).append("\n"); 
		query.append("      ,SH_ADDR1                                                    " ).append("\n"); 
		query.append("      ,SH_ADDR2                                                    " ).append("\n"); 
		query.append("      ,SH_ADDR3                                                    " ).append("\n"); 
		query.append("      ,A.CRE_OFC_CD AS CRE_OFC_CD                                           " ).append("\n"); 
		query.append("      ,A.DMDT_INV_STS_CD AS DMDT_INV_STS_CD  " ).append("\n"); 
		query.append("      ,DECODE(A.DMDT_MNL_INV_RSN_CD, 'SCM', DECODE(A.DMDT_INV_STS_CD, 'C', '*** CREDIT NOTE(DEMURRAGE) ***',  '*** INVOICE(DEMURRAGE) ***'),                             " ).append("\n"); 
		query.append("			DECODE(" ).append("\n"); 
		query.append("			  (SELECT  TIT.CSTMZ_TIT_DESC                                          " ).append("\n"); 
		query.append("               FROM    DMT_CSTMZ_TIT_OPT TIT, DMT_CSTMZ_TIT_TRF_OPT TITTRF                           " ).append("\n"); 
		query.append("               WHERE   TIT.OFC_CD          = TITTRF.OFC_CD                                    " ).append("\n"); 
		query.append("               AND TIT.CR_TERM_SEQ     = TITTRF.CR_TERM_SEQ                                 " ).append("\n"); 
		query.append("               AND TIT.OFC_CD          = A.CRE_OFC_CD                                     " ).append("\n"); 
		query.append("               AND TITTRF.DMDT_TRF_CD  = A.DMDT_TRF_CD                                  " ).append("\n"); 
		query.append("               AND TIT.DMDT_SH_TP_CD   = 'I'                                         " ).append("\n"); 
		query.append("				)                                                      " ).append("\n"); 
		query.append("               ,NULL" ).append("\n"); 
		query.append("			   ,(DECODE(A.DMDT_INV_STS_CD, 'C', '*** CREDIT NOTE ***', " ).append("\n"); 
		query.append("                                                DECODE((SELECT SUBSTR(LOC_CD,0,2) " ).append("\n"); 
		query.append("                                                        FROM MDM_ORGANIZATION " ).append("\n"); 
		query.append("                                                        WHERE OFC_CD = A.CRE_OFC_CD), 'AU','*** TAX INVOICE ***', " ).append("\n"); 
		query.append("																					  'MY','*** TAX INVOICE ***', " ).append("\n"); 
		query.append("																					  'IN','*** TAX INVOICE ***', " ).append("\n"); 
		query.append("                                                                                           '*** INVOICE ***')))                                                                                                                          " ).append("\n"); 
		query.append("               ,(SELECT DECODE(A.DMDT_INV_STS_CD, 'C', '*** CREDIT NOTE('||TIT.CSTMZ_TIT_DESC||') ***', " ).append("\n"); 
		query.append("                                                       DECODE((SELECT SUBSTR(LOC_CD,0,2) " ).append("\n"); 
		query.append("                                                               FROM MDM_ORGANIZATION " ).append("\n"); 
		query.append("                                                               WHERE OFC_CD = A.CRE_OFC_CD), 'AU','*** TAX INVOICE('||TIT.CSTMZ_TIT_DESC||') ***', " ).append("\n"); 
		query.append("																							 'MY','*** TAX INVOICE('||TIT.CSTMZ_TIT_DESC||') ***'," ).append("\n"); 
		query.append("																							 'IN','*** TAX INVOICE('||TIT.CSTMZ_TIT_DESC||') ***'," ).append("\n"); 
		query.append("                                                                                                  '*** INVOICE('||TIT.CSTMZ_TIT_DESC||') ***'))      " ).append("\n"); 
		query.append("                 FROM    DMT_CSTMZ_TIT_OPT TIT, DMT_CSTMZ_TIT_TRF_OPT TITTRF                          " ).append("\n"); 
		query.append("                 WHERE   TIT.OFC_CD      = TITTRF.OFC_CD                                   " ).append("\n"); 
		query.append("                 AND TIT.CR_TERM_SEQ     = TITTRF.CR_TERM_SEQ                                " ).append("\n"); 
		query.append("                 AND TIT.OFC_CD          = A.CRE_OFC_CD                                    " ).append("\n"); 
		query.append("                 AND TITTRF.DMDT_TRF_CD  = A.DMDT_TRF_CD                                 " ).append("\n"); 
		query.append("                 AND TIT.DMDT_SH_TP_CD   = 'I'                                        " ).append("\n"); 
		query.append("				)" ).append("\n"); 
		query.append("			)                                                     " ).append("\n"); 
		query.append("       ) AS INVOICE_TITLE                                                 " ).append("\n"); 
		query.append("	 ,DECODE(A.DMDT_INV_STS_CD, 'X','Cancelled','C','Ref: '||A.CR_INV_NO, ' ') AS CANCEL_NOTE                               " ).append("\n"); 
		query.append("     ,DECODE((SELECT REPLACE(DMDT_PAYR_ADDR,'@*',CHR(13)||CHR(10))                                                                                                                    " ).append("\n"); 
		query.append("              FROM DMT_PAYR_INFO                                                                                                                                                   " ).append("\n"); 
		query.append("              WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID                                                                                                                      " ).append("\n"); 
		query.append("                                       FROM COM_SYS_AREA_GRP_ID                                                                                                                   " ).append("\n"); 
		query.append("                                       WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                                " ).append("\n"); 
		query.append("                                                       FROM MDM_ORGANIZATION                                                                                                      " ).append("\n"); 
		query.append("                                                       WHERE OFC_CD = A.CRE_OFC_CD)                                                                                               " ).append("\n"); 
		query.append("                                       AND CO_IND_CD = 'H')                                                                                                       " ).append("\n"); 
		query.append("              AND CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                                 " ).append("\n"); 
		query.append("              AND CUST_SEQ   = A.ACT_PAYR_SEQ)" ).append("\n"); 
		query.append("             ,NULL" ).append("\n"); 
		query.append("			 ,DECODE((SELECT COUNT(*)      " ).append("\n"); 
		query.append("                      FROM MDM_CR_CUST                                                                                                                                                   " ).append("\n"); 
		query.append("                      WHERE CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                             " ).append("\n"); 
		query.append("                      AND CUST_SEQ   = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("					  AND TRIM(LOCL_ADDR1)||TRIM(LOCL_ADDR2)||TRIM(LOCL_ADDR3)||TRIM(LOCL_ADDR4) IS NOT NULL)" ).append("\n"); 
		query.append("                     ,0" ).append("\n"); 
		query.append("                     ,(SELECT CASE WHEN A.ACT_PAYR_CNT_CD = '00' THEN ( SELECT ZIP_CD||','||REPLACE(ENG_ADDR,'@*',CHR(13)||CHR(10))                                                       " ).append("\n"); 
		query.append("                                                                        FROM MDM_VENDOR                                                                                                  " ).append("\n"); 
		query.append("                                                                        WHERE VNDR_SEQ = A.ACT_PAYR_SEQ)                                                                                 " ).append("\n"); 
		query.append("                              ELSE (SELECT CASE WHEN CN.BKG_ADDR_ORD_CD = 1 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.ZIP_CD                                            " ).append("\n"); 
		query.append("                                                WHEN CN.BKG_ADDR_ORD_CD = 2 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM                                       " ).append("\n"); 
		query.append("                                                WHEN CN.BKG_ADDR_ORD_CD = 3 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD                                    " ).append("\n"); 
		query.append("                                                WHEN CN.BKG_ADDR_ORD_CD = 4 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.STE_CD||' '||ADDR.ZIP_CD                  " ).append("\n"); 
		query.append("                                                WHEN CN.BKG_ADDR_ORD_CD = 5 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD                                    " ).append("\n"); 
		query.append("                                                WHEN CN.BKG_ADDR_ORD_CD = 6 THEN ADDR.CTY_NM||' '||REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.ZIP_CD                                    " ).append("\n"); 
		query.append("                                           ELSE REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD                                                                                           " ).append("\n"); 
		query.append("                                           END                                                                                                                                               " ).append("\n"); 
		query.append("                                    FROM MDM_CUST_ADDR ADDR, MDM_COUNTRY CN                                                                                                                " ).append("\n"); 
		query.append("                                    WHERE ADDR.CUST_CNT_CD = CN.CNT_CD(+)                                                                                                                  " ).append("\n"); 
		query.append("                                    AND ADDR.CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                              " ).append("\n"); 
		query.append("                                    AND ADDR.CUST_SEQ   = A.ACT_PAYR_SEQ" ).append("\n"); 
		query.append("                                    AND ADDR.PRMRY_CHK_FLG = 'Y'" ).append("\n"); 
		query.append("									AND ROWNUM = 1" ).append("\n"); 
		query.append("                                    )                                                                                                                                                      " ).append("\n"); 
		query.append("                             END                                                                                                                                                        " ).append("\n"); 
		query.append("                      FROM DUAL)" ).append("\n"); 
		query.append("                    ,(SELECT TRIM(LOCL_ADDR1)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR2)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR3)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR4)||' '||LOCL_ZIP_CD AS ADDR     " ).append("\n"); 
		query.append("                      FROM MDM_CR_CUST                                                                                                                                                 " ).append("\n"); 
		query.append("                      WHERE CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                           " ).append("\n"); 
		query.append("                      AND CUST_SEQ   = A.ACT_PAYR_SEQ))" ).append("\n"); 
		query.append("             ,(SELECT REPLACE(DMDT_PAYR_ADDR,'@*',CHR(13)||CHR(10))                                                                                                                  " ).append("\n"); 
		query.append("               FROM DMT_PAYR_INFO                                                                                                                                                   " ).append("\n"); 
		query.append("               WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID                                                                                                                      " ).append("\n"); 
		query.append("                                        FROM COM_SYS_AREA_GRP_ID                                                                                                                   " ).append("\n"); 
		query.append("                                        WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                                " ).append("\n"); 
		query.append("                                                        FROM MDM_ORGANIZATION                                                                                                      " ).append("\n"); 
		query.append("                                                        WHERE OFC_CD = A.CRE_OFC_CD)                                                                                               " ).append("\n"); 
		query.append("                                        AND CO_IND_CD = 'H')                                                                                                       " ).append("\n"); 
		query.append("               AND CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                                 " ).append("\n"); 
		query.append("               AND CUST_SEQ   = A.ACT_PAYR_SEQ)                                                                                                                                                                       " ).append("\n"); 
		query.append("        ) AS PAYR_ADDR " ).append("\n"); 
		query.append("     ,B.SH_HD_N1ST_MSG AS SH_HD_N1ST_MSG                                       " ).append("\n"); 
		query.append("     ,B.SH_HD_N2ND_MSG AS SH_HD_N2ND_MSG                                       " ).append("\n"); 
		query.append("     ,B.SH_HD_N3RD_MSG AS SH_HD_N3RD_MSG                                       " ).append("\n"); 
		query.append("     ,B.SH_HD_N4TH_MSG AS SH_HD_N4TH_MSG                                       " ).append("\n"); 
		query.append("     ,B.SH_HD_N5TH_MSG AS SH_HD_N5TH_MSG                                       " ).append("\n"); 
		query.append("     ,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD AS VVD_CD                                                                                                                      " ).append("\n"); 
		query.append("     ,(SELECT VSL_ENG_NM FROM MDM_VSL_CNTR WHERE VSL_CD = A.VSL_CD) AS VSL_ENG_NM                                                                                         " ).append("\n"); 
		query.append("     ,(SELECT TO_CHAR(VPS_ETA_DT,'YYYYMMDD') FROM VSK_VSL_PORT_SKD                                                                                                        " ).append("\n"); 
		query.append("       WHERE VSL_CD = A.VSL_CD                                                                                                                                            " ).append("\n"); 
		query.append("       AND SKD_VOY_NO = A.SKD_VOY_NO                                                                                                                                    " ).append("\n"); 
		query.append("       AND SKD_DIR_CD = A.SKD_DIR_CD                                                                                                                                    " ).append("\n"); 
		query.append("       AND VPS_PORT_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                       " ).append("\n"); 
		query.append("                          ELSE A.POR_CD                                                                                                               " ).append("\n"); 
		query.append("                          END)                                                                                                                        " ).append("\n"); 
		query.append("       AND CLPT_IND_SEQ = 1                                                                                                                                             " ).append("\n"); 
		query.append("       ) AS ARR                                                                                                                                                           " ).append("\n"); 
		query.append("     ,(SELECT TO_CHAR(VPS_ETD_DT,'YYYYMMDD') FROM VSK_VSL_PORT_SKD                                                                                                        " ).append("\n"); 
		query.append("       WHERE VSL_CD = A.VSL_CD                                                                                                                                            " ).append("\n"); 
		query.append("       AND SKD_VOY_NO = A.SKD_VOY_NO                                                                                                                                    " ).append("\n"); 
		query.append("       AND SKD_DIR_CD = A.SKD_DIR_CD                                                                                                                                    " ).append("\n"); 
		query.append("       AND VPS_PORT_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                       " ).append("\n"); 
		query.append("                          ELSE A.POR_CD                                                                                                              " ).append("\n"); 
		query.append("                          END)                                                                                                                       " ).append("\n"); 
		query.append("       AND CLPT_IND_SEQ = 1                                                                                                                                             " ).append("\n"); 
		query.append("       ) AS DEP                                                                                                                                                           " ).append("\n"); 
		query.append("     ,A.BL_NO AS BL_NO                                                 " ).append("\n"); 
		query.append("     ,A.BKG_NO AS BKG_NO                                               " ).append("\n"); 
		query.append("     ,(SELECT CMDT_CD FROM BKG_BOOKING" ).append("\n"); 
		query.append("       WHERE BKG_NO = A.BKG_NO                                                                                                                                      " ).append("\n"); 
		query.append("       ) AS CMDT_CD                                                                                                                                                        " ).append("\n"); 
		query.append("     ,(SELECT CMDT_NM FROM MDM_COMMODITY                                                                                                                                  " ).append("\n"); 
		query.append("       WHERE CMDT_CD = (SELECT CMDT_CD FROM BKG_BOOKING" ).append("\n"); 
		query.append("                        WHERE BKG_NO = A.BKG_NO)" ).append("\n"); 
		query.append("       ) AS CMDT_NM                                                                                                                    " ).append("\n"); 
		query.append("      ,A.DMDT_TRF_CD AS DMDT_TRF_CD                                                                                                                                        " ).append("\n"); 
		query.append("      ,(SELECT DMDT_TRF_NM FROM DMT_TRF_TP WHERE DMDT_TRF_CD = A.DMDT_TRF_CD) AS DMDT_TRF_NM                                                                               " ).append("\n"); 
		query.append("      , A.BKG_RCV_TERM_CD" ).append("\n"); 
		query.append("      , (SELECT INTG_CD_VAL_DP_DESC                                                                                                                                         " ).append("\n"); 
		query.append("         FROM COM_INTG_CD_DTL                                                                                                                                               " ).append("\n"); 
		query.append("         WHERE INTG_CD_VAL_CTNT = A.BKG_RCV_TERM_CD                                                   " ).append("\n"); 
		query.append("           AND INTG_CD_ID = 'CD00764'                                                                                                                                       " ).append("\n"); 
		query.append("        ) AS BKG_RCV_TERM_NM  " ).append("\n"); 
		query.append("      , A.BKG_DE_TERM_CD" ).append("\n"); 
		query.append("      , (SELECT INTG_CD_VAL_DP_DESC                                                                                                                                         " ).append("\n"); 
		query.append("         FROM COM_INTG_CD_DTL                                                                                                                                               " ).append("\n"); 
		query.append("         WHERE INTG_CD_VAL_CTNT = A.BKG_DE_TERM_CD                                                   " ).append("\n"); 
		query.append("           AND INTG_CD_ID = 'CD00765'                                                                                                                                       " ).append("\n"); 
		query.append("        ) AS BKG_DEL_TERM_NM  " ).append("\n"); 
		query.append("      ,(CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                                            " ).append("\n"); 
		query.append("        ELSE A.POR_CD                                                                                                                                                      " ).append("\n"); 
		query.append("        END) AS POD                                                                                                                                                        " ).append("\n"); 
		query.append("      ,(SELECT LOC_NM                                                                                                                                                      " ).append("\n"); 
		query.append("        FROM MDM_LOCATION                                                                                                                                                  " ).append("\n"); 
		query.append("        WHERE LOC_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                            " ).append("\n"); 
		query.append("                        ELSE A.POR_CD                                                                                                                      " ).append("\n"); 
		query.append("                        END)                                                                                                                               " ).append("\n"); 
		query.append("        ) AS POD_NM                                                                                                                                                         " ).append("\n"); 
		query.append("      ,(CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.DEL_CD                                                                                                            " ).append("\n"); 
		query.append("        ELSE A.POL_CD                                                                                                                                                      " ).append("\n"); 
		query.append("        END) AS DEL                                                                                                                                                        " ).append("\n"); 
		query.append("      ,(SELECT LOC_NM                                                                                                                                                      " ).append("\n"); 
		query.append("        FROM MDM_LOCATION                                                                                                                                                  " ).append("\n"); 
		query.append("        WHERE LOC_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.DEL_CD                                                                                            " ).append("\n"); 
		query.append("                        ELSE A.POL_CD                                                                                                                      " ).append("\n"); 
		query.append("                        END)                                                                                                                               " ).append("\n"); 
		query.append("       ) AS DEL_NM                                                                                                                                                        " ).append("\n"); 
		query.append("      ,DECODE(A.VNDR_SEQ, 0, '', (SELECT VNDR_LGL_ENG_NM FROM MDM_VENDOR WHERE VNDR_SEQ = A.VNDR_SEQ)) AS TRUCKER_NM   " ).append("\n"); 
		query.append("	  , (SELECT NVL(SUM(RT_OVR_CHG_AMT),0) FROM DMT_INV_RT RT WHERE RT.DMDT_INV_NO = A.DMDT_INV_NO) AS ORG_CHG_AMT" ).append("\n"); 
		query.append("      ,A.CHG_CURR_CD AS ORG_CURR_CD                                       " ).append("\n"); 
		query.append("      ,A.INV_XCH_RT  AS INV_XCH_RT                                            " ).append("\n"); 
		query.append("      ,A.INV_CURR_CD AS INV_CURR_CD     " ).append("\n"); 
		query.append("                                      " ).append("\n"); 
		query.append("      , NVL(CASE WHEN A.INV_CURR_CD IN ( 'KRW','JPY' , 'BEF' ,'DJF' , 'ESP' ,'GRD' , 'ITL' ,'LAK' , 'MGF' ,'MRO' , 'MXP' ,'PTE' , 'SDD' ,'MXN' ) THEN" ).append("\n"); 
		query.append("                      TRUNC( A.BIL_AMT*A.INV_XCH_RT, 0)" ).append("\n"); 
		query.append("                 WHEN A.INV_CURR_CD IN ( 'TWD','IDR','VND' ) THEN" ).append("\n"); 
		query.append("                      ROUND( A.BIL_AMT*A.INV_XCH_RT, 0)" ).append("\n"); 
		query.append("                 ELSE" ).append("\n"); 
		query.append("                      ROUND( A.BIL_AMT*A.INV_XCH_RT, 2)" ).append("\n"); 
		query.append("                 END,0) AS TOT_AMT" ).append("\n"); 
		query.append("      ,NVL(CASE WHEN A.INV_CURR_CD IN ( 'KRW','JPY' , 'BEF' ,'DJF' , 'ESP' ,'GRD' , 'ITL' ,'LAK' , 'MGF' ,'MRO' , 'MXP' ,'PTE' , 'SDD' ,'MXN' ) THEN" ).append("\n"); 
		query.append("                     TRUNC( A.BIL_AMT*A.INV_XCH_RT, 0)" ).append("\n"); 
		query.append("                WHEN A.INV_CURR_CD IN ( 'TWD','IDR','VND' ) THEN" ).append("\n"); 
		query.append("                     ROUND( A.BIL_AMT*A.INV_XCH_RT, 0)" ).append("\n"); 
		query.append("                ELSE" ).append("\n"); 
		query.append("                     ROUND( A.BIL_AMT*A.INV_XCH_RT, 2)" ).append("\n"); 
		query.append("                END,0) - NVL(A.INV_CHG_AMT,0) AS DC_AMT  " ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append("      ,NVL(A.INV_CHG_AMT,0) AS INV_CHG_AMT                                           " ).append("\n"); 
		query.append("      ,A.TAX_RTO AS TAX_RTO                                               " ).append("\n"); 
		query.append("      ,NVL(A.TAX_AMT,0) AS TAX_AMT                                               " ).append("\n"); 
		query.append("      ,NVL(A.INV_AMT,0) AS INV_AMT                                               " ).append("\n"); 
		query.append("      ,CASE WHEN INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10), 1, 1) = 0 THEN SUBSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10), -1, 1) + 1)   " ).append("\n"); 
		query.append("       ELSE SUBSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), 0, INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10),1,1))                               " ).append("\n"); 
		query.append("       END AS INV_RMK1                                                 " ).append("\n"); 
		query.append("        ,CASE WHEN INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10), 1, 1) = 0 THEN '                          ' " ).append("\n"); 
		query.append("        ELSE SUBSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10),-1,1)+1)            " ).append("\n"); 
		query.append("        END AS INV_RMK2                                                 " ).append("\n"); 
		query.append("        , B.SH_RMK1  AS SH_RMK1                                              " ).append("\n"); 
		query.append("        , B.SH_RMK2  AS SH_RMK2                                              " ).append("\n"); 
		query.append("        , B.SH_RMK3  AS SH_RMK3                                              " ).append("\n"); 
		query.append("        , B.SH_RMK4  AS SH_RMK4                                              " ).append("\n"); 
		query.append("        , B.SH_RMK5  AS SH_RMK5                                              " ).append("\n"); 
		query.append("        , B.SH_RMK6  AS SH_RMK6                                              " ).append("\n"); 
		query.append("        , B.SH_RMK7  AS SH_RMK7                                              " ).append("\n"); 
		query.append("        , B.SH_RMK8  AS SH_RMK8                                              " ).append("\n"); 
		query.append("        , B.SH_RMK9  AS SH_RMK9                                              " ).append("\n"); 
		query.append("        , B.SH_RMK10 AS SH_RMK10                                              " ).append("\n"); 
		query.append("        , B.SH_RMK11 AS SH_RMK11                                              " ).append("\n"); 
		query.append("        , B.SH_RMK12 AS SH_RMK12                                              " ).append("\n"); 
		query.append("        , B.SH_RMK13 AS SH_RMK13                                              " ).append("\n"); 
		query.append("        , B.SH_RMK14 AS SH_RMK14                                              " ).append("\n"); 
		query.append("        , (SELECT TAX_AMT_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS TAX_AMT_PRN_FLG                                                                         " ).append("\n"); 
		query.append("        , (DECODE((NVL(A.BIL_AMT,0) - NVL(A.INV_CHG_AMT,0)) , 0, 'N', (SELECT DC_AMT_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD))) AS DC_AMT_FLG                                                     " ).append("\n"); 
		query.append("        , (SELECT CUST_REF_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS CUST_REF_PRN_FLG                                                                       " ).append("\n"); 
		query.append("        , (SELECT CUST_VAT_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS CUST_VAT_PRN_FLG                                                                       " ).append("\n"); 
		query.append("        , (SELECT PHN_FAX_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS PHN_FAX_PRN_FLG                                                                         " ).append("\n"); 
		query.append("        , A.POD_CD" ).append("\n"); 
		query.append("        , A.POR_CD" ).append("\n"); 
		query.append("        , A.DEL_CD" ).append("\n"); 
		query.append("        , A.POL_CD" ).append("\n"); 
		query.append("		--// INDIA TAX 변경 전" ).append("\n"); 
		query.append("        , A.IDA_EXPN_TAX_RT" ).append("\n"); 
		query.append("        , A.IDA_EXPN_TAX   " ).append("\n"); 
		query.append("        , A.IDA_EDU_TAX_RT" ).append("\n"); 
		query.append("        , A.IDA_EDU_TAX    " ).append("\n"); 
		query.append("        , A.IDA_HIGH_EDU_TAX_RT" ).append("\n"); 
		query.append("        , A.IDA_HIGH_EDU_TAX" ).append("\n"); 
		query.append("        , A.IDA_LOCL_TAX_RT" ).append("\n"); 
		query.append("        , A.IDA_LOCL_TAX   " ).append("\n"); 
		query.append("        , A.IDA_N2ND_LOCL_TAX_RT" ).append("\n"); 
		query.append("		, A.IDA_N2ND_LOCL_TAX" ).append("\n"); 
		query.append("		--// INDIA TAX 변경 후" ).append("\n"); 
		query.append("		, A.IDA_CGST_RTO" ).append("\n"); 
		query.append("		, A.IDA_CGST_AMT" ).append("\n"); 
		query.append("		, A.IDA_SGST_RTO" ).append("\n"); 
		query.append("		, A.IDA_SGST_AMT" ).append("\n"); 
		query.append("		, A.IDA_IGST_RTO" ).append("\n"); 
		query.append("		, A.IDA_IGST_AMT" ).append("\n"); 
		query.append("		, A.IDA_UGST_RTO" ).append("\n"); 
		query.append("		, A.IDA_UGST_AMT" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("  FROM  DMT_INV_MN 	A" ).append("\n"); 
		query.append("       ,DMT_SH_SET 	B" ).append("\n"); 
		query.append("	   " ).append("\n"); 
		query.append(" WHERE  A.CRE_OFC_CD    = B.OFC_CD                                                                                                                                              " ).append("\n"); 
		query.append("   AND  A.DMDT_TRF_CD   = B.DMDT_TRF_CD " ).append("\n"); 
		query.append("   AND  B.DMDT_SH_TP_CD = 'I'                                                                                                                                                  " ).append("\n"); 
		query.append("   AND  A.DMDT_INV_NO   = @[invoice_no]                                                                                                                                                   " ).append("\n"); 
		query.append("   AND  A.CRE_OFC_CD    = @[cre_ofc_cd]                                                                                                                                         " ).append("\n"); 
		query.append("                                                           " ).append("\n"); 
		query.append("#end" ).append("\n"); 

	}
}