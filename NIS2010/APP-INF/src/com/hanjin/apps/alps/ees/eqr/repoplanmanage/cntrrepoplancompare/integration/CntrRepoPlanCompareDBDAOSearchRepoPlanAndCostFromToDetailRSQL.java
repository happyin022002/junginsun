/*=========================================================
*Copyright(c) 2009 CyberLogitec
*@FileName : CntrRepoPlanCompareDBDAOSearchRepoPlanAndCostFromToDetailRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2009.11.26
*@LastModifier : 정은호
*@LastVersion : 1.0
* 2009.11.26 정은호
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.ees.eqr.repoplanmanage.cntrrepoplancompare.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author ChungEunHo
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class CntrRepoPlanCompareDBDAOSearchRepoPlanAndCostFromToDetailRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * mty bkg + s/o 의 plan 대비 실행의 from-to 비용 비교분석 조회
	  * </pre>
	  */
	public CntrRepoPlanCompareDBDAOSearchRepoPlanAndCostFromToDetailRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("nextWeek",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("repo_pln_Id",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("basicWeek",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fmtoall",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.ees.eqr.repoplanmanage.cntrrepoplancompare.integration").append("\n"); 
		query.append("FileName : CntrRepoPlanCompareDBDAOSearchRepoPlanAndCostFromToDetailRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT" ).append("\n"); 
		query.append("A.PLN_YRWK" ).append("\n"); 
		query.append(",B.INTG_CD_VAL_CTNT	## TRSP_MOD_CD" ).append("\n"); 
		query.append("##	   ,DECODE(TRSP_MOD_CD, 'O', '  ', FM_ECC_CD) FM_ECC_CD" ).append("\n"); 
		query.append("##	   ,DECODE(TRSP_MOD_CD, 'F', '  ', TO_ECC_CD) TO_ECC_CD" ).append("\n"); 
		query.append(",A.FM_ECC_CD" ).append("\n"); 
		query.append(",A.TO_ECC_CD" ).append("\n"); 
		query.append(",A.DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append("#if($velocityCount == 1)" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(A.FLAG , 'PLAN', A.QTY_${key} )), 0)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("+NVL(SUM(DECODE(A.FLAG , 'PLAN', A.QTY_${key} )), 0)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("PLA_TOTAL_QTY" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append("#if($velocityCount == 1)" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(A.FLAG , 'PLAN', A.AMT_${key} )), 0)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("+NVL(SUM(DECODE(A.FLAG , 'PLAN', A.AMT_${key} )), 0)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("PLA_TOTAL_AMT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append("#if($velocityCount == 1)" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(A.FLAG , 'EXE',  A.QTY_${key} )), 0)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("+NVL(SUM(DECODE(A.FLAG , 'EXE',  A.QTY_${key} )), 0)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("EXE_TOTAL_QTY" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append("#if($velocityCount == 1)" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(A.FLAG , 'EXE',  A.AMT_${key} )), 0)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("+NVL(SUM(DECODE(A.FLAG , 'EXE',  A.AMT_${key} )), 0)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("EXE_TOTAL_AMT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append("#if($velocityCount == 1)" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(A.FLAG , 'PLAN', A.QTY_${key} )), 0)-NVL(SUM(DECODE(A.FLAG , 'EXE', A.QTY_${key} )), 0))" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("+(NVL(SUM(DECODE(A.FLAG , 'PLAN', A.QTY_${key} )), 0)-NVL(SUM(DECODE(A.FLAG , 'EXE', A.QTY_${key} )), 0))" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GAP_TOTAL_QTY" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append("#if($velocityCount == 1)" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(A.FLAG , 'PLAN', A.AMT_${key} )), 0)-NVL(SUM(DECODE(A.FLAG , 'EXE', A.AMT_${key} )), 0))" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("+(NVL(SUM(DECODE(A.FLAG , 'PLAN', A.AMT_${key} )), 0)-NVL(SUM(DECODE(A.FLAG , 'EXE', A.AMT_${key} )), 0))" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GAP_TOTAL_AMT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(A.FLAG , 'PLAN', A.QTY_${key} )), 0) PLA_QTY_${key}" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(A.FLAG , 'PLAN', A.AMT_${key} )), 0) PLA_AMT_${key}" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(A.FLAG , 'EXE',  A.QTY_${key} )), 0) EXE_QTY_${key}" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(A.FLAG , 'EXE',  A.AMT_${key} )), 0) EXE_AMT_${key}" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(A.FLAG , 'PLAN', A.QTY_${key} )), 0)-NVL(SUM(DECODE(A.FLAG , 'EXE', A.QTY_${key} )), 0) GAP_QTY_${key}" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(A.FLAG , 'PLAN', A.AMT_${key} )), 0)-NVL(SUM(DECODE(A.FLAG , 'EXE', A.AMT_${key} )), 0) GAP_AMT_${key}" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",B.INTG_CD_VAL_DP_SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if(${fmtoat} == '1')" ).append("\n"); 
		query.append("## FM ECC TRANS" ).append("\n"); 
		query.append("#if(${fmByEcc} == 'E' || ${fmByEcc} == '')" ).append("\n"); 
		query.append("#set($transFmEcc = \"ECC_CD\")" ).append("\n"); 
		query.append("#elseif(${fmByEcc} == 'R')" ).append("\n"); 
		query.append("#set($transFmEcc = \"RCC_CD\")" ).append("\n"); 
		query.append("#elseif(${fmByEcc} == 'L')" ).append("\n"); 
		query.append("#set($transFmEcc = \"LCC_CD\")" ).append("\n"); 
		query.append("#elseif(${fmByEcc} == 'C')" ).append("\n"); 
		query.append("#set($transFmEcc = \"CNT_CD\")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("## TO ECC TRANS" ).append("\n"); 
		query.append("#if(${toByEcc} == 'E' || ${toByEcc} == '')" ).append("\n"); 
		query.append("#set($transToEcc = \"ECC_CD\")" ).append("\n"); 
		query.append("#elseif(${toByEcc} == 'R')" ).append("\n"); 
		query.append("#set($transToEcc = \"RCC_CD\")" ).append("\n"); 
		query.append("#elseif(${toByEcc} == 'L')" ).append("\n"); 
		query.append("#set($transToEcc = \"LCC_CD\")" ).append("\n"); 
		query.append("#elseif(${toByEcc} == 'C')" ).append("\n"); 
		query.append("#set($transToEcc = \"CNT_CD\")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("## FM ECC TRANS" ).append("\n"); 
		query.append("#if(${atByEcc} == 'E' || ${atByEcc} == '')" ).append("\n"); 
		query.append("#set($transFmEcc = \"ECC_CD\")" ).append("\n"); 
		query.append("#set($transToEcc = \"ECC_CD\")" ).append("\n"); 
		query.append("#elseif(${atByEcc} == 'R')" ).append("\n"); 
		query.append("#set($transFmEcc = \"RCC_CD\")" ).append("\n"); 
		query.append("#set($transToEcc = \"RCC_CD\")" ).append("\n"); 
		query.append("#elseif(${atByEcc} == 'L')" ).append("\n"); 
		query.append("#set($transFmEcc = \"LCC_CD\")" ).append("\n"); 
		query.append("#set($transToEcc = \"LCC_CD\")" ).append("\n"); 
		query.append("#elseif(${atByEcc} == 'C')" ).append("\n"); 
		query.append("#set($transFmEcc = \"CNT_CD\")" ).append("\n"); 
		query.append("#set($transToEcc = \"CNT_CD\")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("## VESSEL PLAN DATA ##########################-" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transFmEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("FM_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transToEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD , '${key}', QTY )) QTY_${key}" ).append("\n"); 
		query.append("## CSR NO : R200805266894" ).append("\n"); 
		query.append("## cost 집계 로직에서 qty=0인 cost는 집계에서 제외합니다." ).append("\n"); 
		query.append("## ,SUM(DECODE(CNTR_TPSZ_CD , '${key}', AMT )) AMT_${key}" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD , '${key}', DECODE(QTY, 0, 0, AMT) )) AMT_${key}" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",'PLAN' FLAG" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("A.PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",FM_ECC_CD" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",Q.CNTR_QTY  QTY" ).append("\n"); 
		query.append(",CASE WHEN A.PLN_YRWK =(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("'FM'" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("'TO'" ).append("\n"); 
		query.append("END DIRECTION" ).append("\n"); 
		query.append(",CASE WHEN A.PLN_YRWK=(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("Q.LODG_PORT_COST_AMT" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("Q.DCHG_PORT_COST_AMT" ).append("\n"); 
		query.append("END AMT" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN A" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY Q" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND A.PLN_YRWK  = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND A.PLN_SEQ   = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND A.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmtoat} == '1')   ## FROM TO" ).append("\n"); 
		query.append("AND   A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmStatus} != '')" ).append("\n"); 
		query.append("AND   FM_ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toStatus} != '')" ).append("\n"); 
		query.append("AND   TO_ECC_CD IN ( ${toLocStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else                    ## AT" ).append("\n"); 
		query.append("#if(${atStatus} != '')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND FM_ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(TO_ETB_DT, 'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(")  BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND TO_ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(TO_ETB_DT, 'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${tpsz} != ''  && ${tpsztype} != '')" ).append("\n"); 
		query.append("AND   Q.CNTR_TPSZ_CD IN ( ${tpszStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${itemname} != '')" ).append("\n"); 
		query.append("AND   TRSP_MOD_CD IN ( ${itemnameStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${lane} != '')" ).append("\n"); 
		query.append("AND   VSL_LANE_CD IN ( ${laneStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND   VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN ( ${vvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",FM_ECC_CD" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("## VESSEL EXECUTE DATA ########################-" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transFmEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("FM_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transToEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append("#if(${key} == 'O2')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S2', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S2', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'O4')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S4', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S4', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'F2')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A2', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A2', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'F4')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A4', QTY )), 0) + NVL(SUM(DECODE(CNTR_TPSZ_CD, 'F5', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A4', AMT )), 0) + NVL(SUM(DECODE(CNTR_TPSZ_CD, 'F5', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0) QTY_${key}" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0) AMT_${key}" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",'EXE' FLAG" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("A.PLN_YRWK" ).append("\n"); 
		query.append(",A.TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(A.FM_YD_CD, 0, 5)" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(A.TO_YD_CD, 0, 5)" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",A.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("##              		,A.CNTR_QTY  QTY" ).append("\n"); 
		query.append(",DECODE(A.SPLIT_REPO_PLN_FLG, 'N', B.CNTR_QTY, A.CNTR_QTY)  QTY" ).append("\n"); 
		query.append(",CASE WHEN A.REPO_MTY_BKG_FLG = 'Y' AND A.SPLIT_REPO_PLN_FLG = 'Y'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN (SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT)=(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETB_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("'ALL'" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("'TO'" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN A.REPO_MTY_BKG_FLG = 'Y'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("'FM'" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END DIRECTION" ).append("\n"); 
		query.append(",CASE WHEN A.REPO_MTY_BKG_FLG = 'Y' AND A.SPLIT_REPO_PLN_FLG = 'Y'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN (SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT)=(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETB_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT)" ).append("\n"); 
		query.append("##                       THEN A.LODG_PORT_UC_AMT * A.CNTR_QTY" ).append("\n"); 
		query.append("##                       ELSE A.DCHG_PORT_UC_AMT * A.CNTR_QTY" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("A.LODG_PORT_UC_AMT * DECODE(A.SPLIT_REPO_PLN_FLG, 'N', B.CNTR_QTY, A.CNTR_QTY)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("A.DCHG_PORT_UC_AMT * DECODE(A.SPLIT_REPO_PLN_FLG, 'N', B.CNTR_QTY, A.CNTR_QTY)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN A.REPO_MTY_BKG_FLG = 'Y'" ).append("\n"); 
		query.append("##                       THEN A.LODG_PORT_UC_AMT * A.CNTR_QTY" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("A.LODG_PORT_UC_AMT * DECODE(A.SPLIT_REPO_PLN_FLG, 'N', B.CNTR_QTY, A.CNTR_QTY)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END AMT" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("A0.REPO_PLN_ID" ).append("\n"); 
		query.append(",A0.PLN_YRWK" ).append("\n"); 
		query.append(",A0.PLN_SEQ" ).append("\n"); 
		query.append(",A0.REF_ID" ).append("\n"); 
		query.append(",A0.CO_CD" ).append("\n"); 
		query.append(",A0.TRSP_MOD_CD" ).append("\n"); 
		query.append(",A0.VSL_LANE_CD" ).append("\n"); 
		query.append(",A0.VSL_CD" ).append("\n"); 
		query.append(",A0.SKD_VOY_NO" ).append("\n"); 
		query.append(",A0.SKD_DIR_CD" ).append("\n"); 
		query.append(",A0.FM_YD_CD" ).append("\n"); 
		query.append(",A0.FM_ETD_DT" ).append("\n"); 
		query.append(",A0.TO_YD_CD" ).append("\n"); 
		query.append(",A0.TO_ETB_DT" ).append("\n"); 
		query.append(",A0.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append(",A0.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append(",A0.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append(",A0.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append(",A0.MTY_BKG_NO" ).append("\n"); 
		query.append(",A0.SPLIT_REPO_PLN_FLG" ).append("\n"); 
		query.append(",A0.PAST_REPO_PLN_FLG" ).append("\n"); 
		query.append(",A0.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",Q.CNTR_QTY" ).append("\n"); 
		query.append(",Q.LODG_DCHG_COST_AMT" ).append("\n"); 
		query.append(",Q.PLN_UC_AMT" ).append("\n"); 
		query.append(",Q.LODG_PORT_UC_AMT" ).append("\n"); 
		query.append(",Q.DCHG_PORT_UC_AMT" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN A0," ).append("\n"); 
		query.append("EQR_VSL_EXE_PLN_QTY Q" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A0.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND A0.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND A0.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND A0.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND A0.REPO_PLN_ID IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_EQ_REPO_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID LIKE 'REPO' || @[basicWeek] || '%'        	## EX) REPO200801" ).append("\n"); 
		query.append("AND   REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND   ROWNUM = 1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND   A0.REPO_MTY_BKG_FLG = 'Y'" ).append("\n"); 
		query.append(") A ," ).append("\n"); 
		query.append("##	    added by shin yongchan 20080325" ).append("\n"); 
		query.append("##	    T.VVD Plan Data 보완/수정 건" ).append("\n"); 
		query.append("##	    CSR NO : N200803110018" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("A.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append(",A.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",NVL(A.CNTR_QTY, 0) - NVL(B.CNTR_QTY, 0) CNTR_QTY  ## (original - split)" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("## original booking vol 집계" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT A.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(Q.CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN A," ).append("\n"); 
		query.append("EQR_VSL_EXE_PLN_QTY Q," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_EQ_REPO_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID LIKE 'REPO' || @[basicWeek] || '%'  	## EX) REPO200801" ).append("\n"); 
		query.append("AND REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND ROWNUM = 1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND   REPO_MTY_BKG_FLG = 'Y'" ).append("\n"); 
		query.append("## AND   TRIM(MTY_BKG_NO_SPLIT) IS NULL" ).append("\n"); 
		query.append("AND SPLIT_REPO_PLN_FLG = 'N'" ).append("\n"); 
		query.append(") B" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND A.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND A.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND A.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND A.OLD_BKG_GRP_NO = B.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("A.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") A," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("## split booking vol 집계" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT A.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(Q.CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN A," ).append("\n"); 
		query.append("EQR_VSL_EXE_PLN_QTY Q," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_EQ_REPO_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID LIKE 'REPO' || @[basicWeek] || '%'  	## EX) REPO200801" ).append("\n"); 
		query.append("AND   REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND   ROWNUM = 1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND   REPO_MTY_BKG_FLG = 'Y'" ).append("\n"); 
		query.append("##AND   TRIM(MTY_BKG_NO_SPLIT) IS NOT NULL" ).append("\n"); 
		query.append("AND SPLIT_REPO_PLN_FLG = 'Y'" ).append("\n"); 
		query.append(") B" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND A.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND A.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND A.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND A.OLD_BKG_GRP_NO = B.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("A.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") B" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A.OLD_BKG_GRP_NO = B.OLD_BKG_GRP_NO(+)" ).append("\n"); 
		query.append("AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)" ).append("\n"); 
		query.append(") B" ).append("\n"); 
		query.append("##        WHERE REPO_PLN_ID = '\"+repo_pln_Id+\"'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("## modified by shin yongchan - 20080118" ).append("\n"); 
		query.append("## 검색 REPO 주차의 DISTRIBUTE REPO PLAN ID 를 조건으로 사용" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A.OLD_BKG_GRP_NO   = B.OLD_BKG_GRP_NO(+)" ).append("\n"); 
		query.append("AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)" ).append("\n"); 
		query.append("AND   A.REPO_PLN_ID IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_EQ_REPO_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID LIKE 'REPO' || @[basicWeek] || '%'        	## EX) REPO200801" ).append("\n"); 
		query.append("AND   REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND   ROWNUM = 1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND   A.REPO_MTY_BKG_FLG = 'Y'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmtoat} == '1')   ## FROM TO" ).append("\n"); 
		query.append("AND   A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmStatus} != '')" ).append("\n"); 
		query.append("AND   SUBSTR(A.FM_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toStatus} != '')" ).append("\n"); 
		query.append("AND   SUBSTR(A.TO_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${toLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else                    ## AT" ).append("\n"); 
		query.append("#if(${atStatus} != '')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND SUBSTR(A.FM_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(A.TO_ETB_DT, 'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(")  BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND SUBSTR(A.TO_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(A.TO_ETB_DT, 'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${tpsz} != '' && ${tpsztype} != '')" ).append("\n"); 
		query.append("AND   A.CNTR_TPSZ_CD IN ( ${tpszStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${itemname} != '')" ).append("\n"); 
		query.append("AND   A.TRSP_MOD_CD IN ( ${itemnameStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${lane} != '')" ).append("\n"); 
		query.append("AND   A.VSL_LANE_CD IN ( ${laneStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND   A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD IN ( ${vvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",FM_ECC_CD" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("## INLAND PLAN DATA ##########################-" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("A.PLN_YRWK" ).append("\n"); 
		query.append(",A.TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transFmEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("FM_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transToEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",'FM' DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD , '${key}', CNTR_QTY ))        QTY_${key}" ).append("\n"); 
		query.append("## CSR NO : R200805266894" ).append("\n"); 
		query.append("## cost 집계 로직에서 qty=0인 cost는 집계에서 제외합니다." ).append("\n"); 
		query.append("##          ,SUM(DECODE(CNTR_TPSZ_CD , '${key}', FM_ECC_COST_AMT )) AMT_${key}" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD , '${key}', DECODE(CNTR_QTY, 0, 0, FM_ECC_COST_AMT) )) AMT_${key}" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",'PLAN' FLAG" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN A" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY Q" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND A.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND A.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND A.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmtoat} == '1')   ## FROM TO" ).append("\n"); 
		query.append("AND   A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmStatus} != '')" ).append("\n"); 
		query.append("AND   FM_ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toStatus} != '')" ).append("\n"); 
		query.append("AND   TO_ECC_CD IN ( ${toLocStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else                    ## AT" ).append("\n"); 
		query.append("#if(${atStatus} != '')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND FM_ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("TO_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND TO_ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("TO_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("## lane, vvd 를 통해서 plan 데이터 검색범위 축소" ).append("\n"); 
		query.append("#if(${lane} != ''  || ${vvd} != '')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("A.PLN_YRWK" ).append("\n"); 
		query.append(", TRSP_MOD_CD" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("IN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(FM_YD_CD, 0, 5)" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(TO_YD_CD, 0, 5)" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_EXE_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND   PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("#if(${lane} != '')" ).append("\n"); 
		query.append("AND   VSL_LANE_CD IN ( ${laneStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND   VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN ( ${vvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${tpsz} != '' && ${tpsztype} != '')" ).append("\n"); 
		query.append("AND   Q.CNTR_TPSZ_CD IN ( ${tpszStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${itemname} != '')" ).append("\n"); 
		query.append("AND   TRSP_MOD_CD IN ( ${itemnameStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("A.PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",FM_ECC_CD" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("## INLAND EXECUTE DATA ########################-" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transFmEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("FM_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transToEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append("#if(${key} == 'O2')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S2', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S2', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'O4')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S4', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S4', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'F2')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A2', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A2', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'F4')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A4', QTY )), 0) +NVL(SUM(DECODE(CNTR_TPSZ_CD, 'F5', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A4', AMT )), 0) +NVL(SUM(DECODE(CNTR_TPSZ_CD, 'F5', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0) QTY_${key}" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0) AMT_${key}" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",'EXE' FLAG" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",SO_IF_DIV_CD TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(FM_YD_CD, 0, 5)" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(TO_YD_CD, 0, 5)" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",1  QTY" ).append("\n"); 
		query.append(",'FM' DIRECTION" ).append("\n"); 
		query.append(",REPO_COST_AMT AMT" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_REPO_EXE_SO_IF" ).append("\n"); 
		query.append("## modiffied by shin yongchan - 20080118" ).append("\n"); 
		query.append("## 검색 REPO 주차의 DISTRIBUTE REPO PLAN ID 를 조건으로 사용" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_EQ_REPO_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID LIKE 'REPO' || @[basicWeek] || '%'   	## EX) REPO200801" ).append("\n"); 
		query.append("AND   REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND   ROWNUM = 1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND   WO_EXE_FLG  = 'Y'" ).append("\n"); 
		query.append("AND   SO_IF_DIV_CD IN ('W', 'R', 'T')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmtoat} == '1')   ## FROM TO" ).append("\n"); 
		query.append("AND   PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmStatus} != '')" ).append("\n"); 
		query.append("AND   SUBSTR(FM_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toStatus} != '')" ).append("\n"); 
		query.append("AND   SUBSTR(TO_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${toLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else                    ## AT" ).append("\n"); 
		query.append("#if(${atStatus} != '')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND SUBSTR(FM_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_DT BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(")  BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND SUBSTR(TO_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_DT BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${tpsz} != '' && ${tpsztype} != '')" ).append("\n"); 
		query.append("AND   CNTR_TPSZ_CD IN ( ${tpszStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${itemname} != '')" ).append("\n"); 
		query.append("AND   SO_IF_DIV_CD IN ( ${itemnameStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${lane} != '')" ).append("\n"); 
		query.append("AND   VSL_LANE_CD IN ( ${laneStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND   VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN ( ${vvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",FM_ECC_CD" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${lane} == '' && ${vvd} == '')" ).append("\n"); 
		query.append("## ON-OFF HIRE DATA      ##########################-" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",DECODE(TRSP_MOD_CD, 'O', '  ', FM_ECC_CD) FM_ECC_CD" ).append("\n"); 
		query.append(",DECODE(TRSP_MOD_CD, 'F', '  ', TO_ECC_CD) TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append(",SUM(QTY_${key})" ).append("\n"); 
		query.append(",SUM(AMT_${key})" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",FLAG" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("## ON-OFF HIRE PLAN DATA ##########################-" ).append("\n"); 
		query.append("##      UNION ALL" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transFmEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("FM_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transToEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD , '${key}', QTY )) QTY_${key}" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD , '${key}', AMT )) AMT_${key}" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",'PLAN' FLAG" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("A.PLN_YRWK" ).append("\n"); 
		query.append(",ONF_HIR_DIV_CD TRSP_MOD_CD" ).append("\n"); 
		query.append(",ECC_CD FM_ECC_CD" ).append("\n"); 
		query.append(",ECC_CD TO_ECC_CD" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",Q.CNTR_QTY  QTY" ).append("\n"); 
		query.append(",CASE WHEN ONF_HIR_DIV_CD='F'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("'FM'" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("'TO'" ).append("\n"); 
		query.append("END DIRECTION" ).append("\n"); 
		query.append(",CASE WHEN ONF_HIR_DIV_CD='F'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("FM_ECC_COST_AMT" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("TO_ECC_COST_AMT" ).append("\n"); 
		query.append("END AMT" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN A" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY Q" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND A.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND A.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND A.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmtoat} == '1')   ## FROM TO" ).append("\n"); 
		query.append("AND   A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmStatus} != '')" ).append("\n"); 
		query.append("AND   ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toStatus} != '')" ).append("\n"); 
		query.append("AND   ECC_CD IN ( ${toLocStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else                    ## AT" ).append("\n"); 
		query.append("#if(${atStatus} != '')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND   A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${tpsz} != '' && ${tpsztype} != '')" ).append("\n"); 
		query.append("AND   Q.CNTR_TPSZ_CD IN ( ${tpszStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${itemname} != '')" ).append("\n"); 
		query.append("AND   ONF_HIR_DIV_CD IN ( ${itemnameStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",FM_ECC_CD" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("## ON-OFF EXECUTE DATA ########################-" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transFmEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("FM_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transToEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append("#if(${key} == 'O2')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S2', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S2', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'O4')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S4', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S4', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'F2')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A2', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A2', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'F4')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A4', QTY )), 0) +NVL(SUM(DECODE(CNTR_TPSZ_CD, 'F5', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A4', AMT )), 0) +NVL(SUM(DECODE(CNTR_TPSZ_CD, 'F5', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0) QTY_${key}" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0) AMT_${key}" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",'EXE' FLAG" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",SO_IF_DIV_CD TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(FM_YD_CD, 0, 5)" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(TO_YD_CD, 0, 5)" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",1  QTY" ).append("\n"); 
		query.append(",CASE WHEN SO_IF_DIV_CD='F'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("'FM'" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("'TO'" ).append("\n"); 
		query.append("END DIRECTION" ).append("\n"); 
		query.append(",REPO_COST_AMT AMT" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_REPO_EXE_SO_IF" ).append("\n"); 
		query.append("## modiffied by shin yongchan - 20080118" ).append("\n"); 
		query.append("## 검색 REPO 주차의 DISTRIBUTE REPO PLAN ID 를 조건으로 사용" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_EQ_REPO_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID LIKE 'REPO' || @[basicWeek] || '%'   	## EX) REPO200801" ).append("\n"); 
		query.append("AND   REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND   ROWNUM = 1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND   WO_EXE_FLG  = 'Y'" ).append("\n"); 
		query.append("AND   SO_IF_DIV_CD IN ('O', 'F')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmtoat} == '1')   ## FROM TO" ).append("\n"); 
		query.append("AND PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmStatus} != '')" ).append("\n"); 
		query.append("AND   SUBSTR(FM_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toStatus} != '')" ).append("\n"); 
		query.append("AND   SUBSTR(TO_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${toLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else                    ## AT" ).append("\n"); 
		query.append("#if(${atStatus} != '')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND SUBSTR(FM_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_DT BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(")  BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND SUBSTR(TO_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_DT BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${tpsz} != '' && ${tpsztype} != '')" ).append("\n"); 
		query.append("AND   CNTR_TPSZ_CD IN ( ${tpszStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${itemname} != '')" ).append("\n"); 
		query.append("AND   SO_IF_DIV_CD IN ( ${itemnameStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${lane} != '')" ).append("\n"); 
		query.append("AND   VSL_LANE_CD IN ( ${laneStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND   VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN ( ${vvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",FM_ECC_CD" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",DECODE(TRSP_MOD_CD, 'O', '  ', FM_ECC_CD)" ).append("\n"); 
		query.append(",DECODE(TRSP_MOD_CD, 'F', '  ', TO_ECC_CD)" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append(",FLAG" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${itemname_ecc} == 'S' || ${itemname} == '')   ## ECC INTERNAL 만 봐야 하는 경우" ).append("\n"); 
		query.append("## ECC INTERNAL PLAN DATA ##########################-" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transFmEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("FM_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transToEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",'FM' DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append("#if(${key} == 'O2')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S2', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S2', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'O4')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S4', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S4', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'F2')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A2', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A2', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'F4')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A4', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'F5', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A4', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'F5', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0) QTY_${key}" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0) AMT_${key}" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",'PLAN' FLAG" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("A.PLN_YRWK" ).append("\n"); 
		query.append(",'S' TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(FM_YD_CD, 0, 5)" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(TO_YD_CD, 0, 5)" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",Q.CNTR_QTY  QTY" ).append("\n"); 
		query.append(",'FM' DIRECTION" ).append("\n"); 
		query.append(",TRSP_COST_AMT AMT" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_INTER_EXE_PLN A" ).append("\n"); 
		query.append(", EQR_ECC_INTER_EXE_PLN_QTY Q" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND A.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND A.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND A.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmtoat} == '1')   ## FROM TO" ).append("\n"); 
		query.append("AND   A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmStatus} != '')" ).append("\n"); 
		query.append("AND   SUBSTR(FM_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toStatus} != '')" ).append("\n"); 
		query.append("AND   SUBSTR(TO_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${toLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else                    ## AT" ).append("\n"); 
		query.append("#if(${atStatus} != '')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND SUBSTR(FM_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(TO_ETA_DT, 'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND SUBSTR(TO_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("A.PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(TO_ETA_DT, 'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${tpsz} != '' && ${tpsztype} != '')" ).append("\n"); 
		query.append("AND   Q.CNTR_TPSZ_CD IN ( ${tpszStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",FM_ECC_CD" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("## ECC INTERNAL EXECUTE DATA ####################-" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transFmEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("FM_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("${transToEcc}" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_ECC_CD = ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#foreach(${key} in ${tpszArr})" ).append("\n"); 
		query.append("#if(${key} == 'O2')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S2', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S2', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'O4')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S4', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'S4', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'F2')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A2', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A2', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#elseif(${key} == 'F4')" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A4', QTY )), 0) +NVL(SUM(DECODE(CNTR_TPSZ_CD, 'F5', QTY )), 0)) QTY_${key}" ).append("\n"); 
		query.append(",(NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0)+NVL(SUM(DECODE(CNTR_TPSZ_CD, 'A4', AMT )), 0) +NVL(SUM(DECODE(CNTR_TPSZ_CD, 'F5', AMT )), 0)) AMT_${key}" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', QTY )), 0) QTY_${key}" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(CNTR_TPSZ_CD, '${key}', AMT )), 0) AMT_${key}" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",'EXE' FLAG" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",'S' TRSP_MOD_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(FM_YD_CD, 0, 5)" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(TO_YD_CD, 0, 5)" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",1  QTY" ).append("\n"); 
		query.append(",'FM' DIRECTION" ).append("\n"); 
		query.append(",REPO_COST_AMT AMT" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_REPO_EXE_SO_IF" ).append("\n"); 
		query.append("## modiffied by shin yongchan - 20080118" ).append("\n"); 
		query.append("## 검색 REPO 주차의 DISTRIBUTE REPO PLAN ID 를 조건으로 사용" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_EQ_REPO_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID LIKE 'REPO' || @[basicWeek] || '%'   	## EX) REPO200801" ).append("\n"); 
		query.append("AND   REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND   ROWNUM = 1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND   WO_EXE_FLG  = 'Y'" ).append("\n"); 
		query.append("AND   SO_IF_DIV_CD = 'S'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmtoat} == '1')   ## FROM TO" ).append("\n"); 
		query.append("AND   PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${fmStatus} != '')" ).append("\n"); 
		query.append("AND   SUBSTR(FM_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toStatus} != '')" ).append("\n"); 
		query.append("AND   SUBSTR(TO_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${toLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else                    ## AT" ).append("\n"); 
		query.append("#if(${atStatus} != '')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND SUBSTR(FM_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_DT BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(")  BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append("AND SUBSTR(TO_YD_CD, 0, 5) IN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("SCC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD IN ( ${fromLocStr} )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("PLN_YRWK BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_DT BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") BETWEEN @[basicWeek] AND @[nextWeek]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${tpsz} != '' && ${tpsztype} != '')" ).append("\n"); 
		query.append("AND   CNTR_TPSZ_CD IN ( ${tpszStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${itemname} != '')" ).append("\n"); 
		query.append("AND   SO_IF_DIV_CD IN ( ${itemnameStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${lane} != '')" ).append("\n"); 
		query.append("AND   VSL_LANE_CD IN ( ${laneStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND   VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN ( ${vvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",TRSP_MOD_CD" ).append("\n"); 
		query.append(",FM_ECC_CD" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append(",DIRECTION" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end ## ECC INTERNAL 만 사용됨" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(") A," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("INTG_CD_VAL_CTNT" ).append("\n"); 
		query.append(",INTG_CD_VAL_DP_SEQ" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("COM_INTG_CD_DTL" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("INTG_CD_ID = 'CD00253'" ).append("\n"); 
		query.append(") B" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A.TRSP_MOD_CD = B.INTG_CD_VAL_CTNT" ).append("\n"); 
		query.append("#if(${fmtoall} != '')" ).append("\n"); 
		query.append("AND A.DIRECTION = @[fmtoall]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("A.PLN_YRWK" ).append("\n"); 
		query.append(",B.INTG_CD_VAL_CTNT  ##TRSP_MOD_CD" ).append("\n"); 
		query.append(",A.FM_ECC_CD" ).append("\n"); 
		query.append(",A.TO_ECC_CD" ).append("\n"); 
		query.append(",A.DIRECTION" ).append("\n"); 
		query.append(",B.INTG_CD_VAL_DP_SEQ" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append(", B.INTG_CD_VAL_DP_SEQ" ).append("\n"); 
		query.append(", 3" ).append("\n"); 
		query.append(", 4" ).append("\n"); 
		query.append(", 5" ).append("\n"); 

	}
}