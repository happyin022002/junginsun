<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChargeAmountDiscountMgtDBDAOSearchAfterBookingAproItmRSQL">
			<desc><![CDATA[ChargeAmountDiscountMgtDBDAOSearchAfterBookingAproItm]]></desc>
			<sql><![CDATA[
SELECT ATTR_CTNT1 SEQ, '1' NO
     , ATTR_CTNT2 AS RVW_ITM
     , ATTR_CTNT3 AS FOML_NM
     , ATTR_CTNT4 AS VALUE_1
     , ATTR_CTNT5 AS VALUE_2
     , '-1' AS VALUE_3
FROM dmt_hrd_cdg_ctnt
WHERE HRD_CDG_ID = 'AFT_BKG_APRO_ITME'
AND ATTR_CTNT1 != 4
UNION ALL
SELECT A.ATTR_CTNT1 SEQ, '2' NO
     , A.ATTR_CTNT2 AS RVW_ITM
     , A.ATTR_CTNT3 AS FOML_NM
     , CASE WHEN A.ATTR_CTNT1 = '5' THEN TRIM(TO_CHAR(B.AFT_BKG_ITM_CTNT1,'9,999,999,999,990'))
			ELSE CASE WHEN A.ATTR_CTNT1 IN ( '1','2','3' ) THEN '$ '||TRIM(TO_CHAR(B.AFT_BKG_ITM_CTNT1,'9,999,999,990.00')) 
					  WHEN A.ATTR_CTNT1 IN ( '6','7' ) THEN TRIM(TO_CHAR(B.AFT_BKG_ITM_CTNT1,'990.00'))|| ' %'
					  WHEN A.ATTR_CTNT1 = '4' THEN 
							( SELECT DECODE(NVL(UC_CGO_PSBL_FLG,' '),'Y','HIGH','N','LOW',' ')
                               FROM DMT_AFT_BKG_ADJ_RQST WHERE AFT_EXPT_DAR_NO = @[dar_no] AND ROWNUM = 1 )
                      ELSE B.AFT_BKG_ITM_CTNT1 END
			END

        AS VALUE_1
     , CASE WHEN A.ATTR_CTNT1 = '5' THEN TRIM(TO_CHAR(B.AFT_BKG_ITM_CTNT2,'9,999,999,999,990'))
			ELSE CASE WHEN A.ATTR_CTNT1 IN ( '1','2','3' ) THEN '$ '||TRIM(TO_CHAR(B.AFT_BKG_ITM_CTNT2,'9,999,999,990.00')) 
					  WHEN A.ATTR_CTNT1 IN ( '6','7' ) THEN TRIM(TO_CHAR(B.AFT_BKG_ITM_CTNT2,'990.00'))|| ' %'
					  WHEN A.ATTR_CTNT1 = '4' THEN 
							( SELECT DECODE(NVL(UC_CGO_PSBL_FLG,' '),'Y','HIGH','N','LOW',' ')
                               FROM DMT_AFT_BKG_ADJ_RQST WHERE AFT_EXPT_DAR_NO = @[dar_no] AND ROWNUM = 1 )
                      ELSE B.AFT_BKG_ITM_CTNT2 END
			END

        AS VALUE_2
     , CASE ATTR_CTNT1 WHEN '1' THEN 
                            CASE WHEN TO_NUMBER(B.AFT_BKG_ITM_CTNT1) > ROUND(TO_NUMBER(B.AFT_BKG_ITM_CTNT2) * 0.3,2) THEN '0'
                                 WHEN ROUND(TO_NUMBER(B.AFT_BKG_ITM_CTNT1),0) = ROUND(TO_NUMBER(B.AFT_BKG_ITM_CTNT2) * 0.3,0) THEN '1'
                                 ELSE '2' END
                       WHEN '2' THEN
                            CASE WHEN ROUND(TO_NUMBER(B.AFT_BKG_ITM_CTNT1),0) > ROUND(TO_NUMBER(B.AFT_BKG_ITM_CTNT2),0) THEN '0'
                                 WHEN ROUND(TO_NUMBER(B.AFT_BKG_ITM_CTNT1),0) = ROUND(TO_NUMBER(B.AFT_BKG_ITM_CTNT2),0) THEN '1'
                                 ELSE '2' END
                       WHEN '3' THEN
                            CASE WHEN TO_NUMBER(B.AFT_BKG_ITM_CTNT1) <= TO_NUMBER(B.AFT_BKG_ITM_CTNT2) THEN '0'
                                 ELSE '2' END
                       WHEN '4' THEN ( SELECT DECODE(NVL(UC_CGO_PSBL_FLG,' '),'Y','0','N','2',' ')
                               			 FROM DMT_AFT_BKG_ADJ_RQST WHERE AFT_EXPT_DAR_NO = @[dar_no] AND ROWNUM = 1 )
                       WHEN '5' THEN 
                            CASE WHEN NVL(TO_NUMBER(B.AFT_BKG_ITM_CTNT1),0) = 0 AND NVL(TO_NUMBER(B.AFT_BKG_ITM_CTNT2),0) = 0 THEN '0'
                                 WHEN NVL(TO_NUMBER(B.AFT_BKG_ITM_CTNT2),0) > 0 THEN '2'
                                 WHEN NVL(TO_NUMBER(B.AFT_BKG_ITM_CTNT1),0) > 0 THEN '1'
                                 END
                       WHEN '6' THEN
                            CASE WHEN ROUND(TO_NUMBER(B.AFT_BKG_ITM_CTNT1),0) > 90 THEN '0'
                                 WHEN ROUND(TO_NUMBER(B.AFT_BKG_ITM_CTNT1),0) = 90 THEN '1'
                                 ELSE '2'
                                 END
                       WHEN '7' THEN 
                            CASE WHEN ROUND(TO_NUMBER(B.AFT_BKG_ITM_CTNT1),0) < 50 THEN '0'
                                 WHEN ROUND(TO_NUMBER(B.AFT_BKG_ITM_CTNT1),0) = 50 THEN '1'
                                 ELSE '2'
                                 END
            END
       AS VALUE_3 






FROM DMT_HRD_CDG_CTNT A, DMT_AFT_BKG_APRO_ITM B
WHERE A.HRD_CDG_ID = 'AFT_BKG_APRO_ITME'
AND B.AFT_EXPT_DAR_NO(+) = @[dar_no]
AND A.ATTR_CTNT1 = B.AFT_BKG_ITM_LVL(+)
ORDER BY 1,2			]]></sql>
			<params>
				<param name="dar_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
