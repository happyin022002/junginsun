<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SCExceptionTariffMgtDBDAOIsDuplicateSCRSQL">
			<desc><![CDATA[입력한 S/C 가 기등록된 S/C 와 중복되는지를 조회하는쿼리]]></desc>
			<sql><![CDATA[
SELECT  COUNT(SC_GRP.SC_EXPT_GRP_SEQ)
  
FROM    DMT_SC_EXPT_GRP         SC_GRP
    ,   DMT_SC_EXPT_CVRG        SC_CVRG
    ,   DMT_SC_EXPT_ACT_CUST    SC_ACT_CUST
    ,   DMT_SC_EXPT_CMDT        SC_CMDT
    
WHERE   SC_GRP.PROP_NO          	= @[prop_no]
    AND SC_GRP.SC_EXPT_VER_SEQ  	= @[sc_expt_ver_seq]

	#if(${sc_expt_grp_seq} != '')
    AND SC_GRP.SC_EXPT_GRP_SEQ  	<> @[sc_expt_grp_seq]
	#end

    AND SC_GRP.DMDT_TRF_CD      	= @[dmdt_trf_cd]
    AND (
            (EFF_DT >= TO_DATE(@[eff_dt], 'YYYYMMDD') AND EFF_DT <= TO_DATE(@[exp_dt], 'YYYYMMDD'))
		OR
			(EFF_DT <= TO_DATE(@[eff_dt], 'YYYYMMDD') AND EXP_DT >= TO_DATE(@[eff_dt], 'YYYYMMDD'))
        )
    AND SC_GRP.DMDT_CNTR_CGO_TP_CD 	= @[dmdt_cntr_cgo_tp_cd]

	AND SC_GRP.SC_EXPT_FM_CONTI_CD	= NVL(@[sc_expt_fm_conti_cd], 	' ')
	AND SC_GRP.SC_EXPT_FM_CNT_CD	= NVL(@[sc_expt_fm_cnt_cd], 	' ')
	AND SC_GRP.SC_EXPT_FM_RGN_CD	= NVL(@[sc_expt_fm_rgn_cd], 	' ')
	AND SC_GRP.SC_EXPT_FM_STE_CD	= NVL(@[sc_expt_fm_ste_cd], 	' ')
	AND SC_GRP.SC_EXPT_FM_LOC_CD	= NVL(@[sc_expt_fm_loc_cd], 	' ')

	AND SC_GRP.FNL_DEST_CNT_CD		= NVL(@[fnl_dest_cnt_cd], 		' ')
	AND SC_GRP.FNL_DEST_RGN_CD		= NVL(@[fnl_dest_rgn_cd], 		' ')
	AND SC_GRP.FNL_DEST_STE_CD		= NVL(@[fnl_dest_ste_cd], 		' ')
	AND SC_GRP.FNL_DEST_LOC_CD		= NVL(@[fnl_dest_loc_cd], 		' ')

	#if(${rcv_de_term_cd} != '')
    AND SC_GRP.RCV_DE_TERM_CD 		= @[rcv_de_term_cd]
    #else
	AND SC_GRP.RCV_DE_TERM_CD 		IS NULL
	#end

    AND SC_GRP.PROP_NO          = SC_CVRG.PROP_NO
    AND SC_GRP.SC_EXPT_VER_SEQ  = SC_CVRG.SC_EXPT_VER_SEQ
    AND SC_GRP.SC_EXPT_GRP_SEQ  = SC_CVRG.SC_EXPT_GRP_SEQ

	AND (
			(SC_CVRG.CNT_CD, SC_CVRG.RGN_CD, SC_CVRG.STE_CD, SC_CVRG.LOC_CD) 
			IN
			(
				#foreach( $coverage in ${list_coverage} )
					#if($velocityCount < $list_coverage.size()) ($coverage), #else ($coverage) #end
				#end
			)
		)

    AND SC_GRP.PROP_NO          = SC_ACT_CUST.PROP_NO(+)
    AND SC_GRP.SC_EXPT_VER_SEQ  = SC_ACT_CUST.SC_EXPT_VER_SEQ(+)
    AND SC_GRP.SC_EXPT_GRP_SEQ  = SC_ACT_CUST.SC_EXPT_GRP_SEQ(+)

	#if(${act_cust_list} != '')
	AND (
			(SC_ACT_CUST.CUST_CNT_CD, SC_ACT_CUST.CUST_SEQ)
			IN
			(
				#foreach( $act_cust in ${list_act_cust} )
					#if($velocityCount < $list_act_cust.size()) ($act_cust), #else ($act_cust) #end
				#end
			)
		)
	#else
	AND SC_ACT_CUST.CUST_CNT_CD IS NULL AND SC_ACT_CUST.CUST_SEQ IS NULL
	#end

    AND SC_GRP.PROP_NO          = SC_CMDT.PROP_NO(+)
    AND SC_GRP.SC_EXPT_VER_SEQ  = SC_CMDT.SC_EXPT_VER_SEQ(+)
    AND SC_GRP.SC_EXPT_GRP_SEQ  = SC_CMDT.SC_EXPT_GRP_SEQ(+)

	#if(${cmdt_list} != '')
	AND SC_CMDT.CMDT_CD IN 
		(
			#foreach( $cmdt in ${list_cmdt} )
				#if($velocityCount < $list_cmdt.size()) '$cmdt', #else '$cmdt' #end
			#end
		)
	#else
	AND SC_CMDT.CMDT_CD IS NULL
	#end			]]></sql>
			<params>
				<param name="prop_no" type="12" value="" out="N"/>
				<param name="sc_expt_ver_seq" type="12" value="" out="N"/>
				<param name="sc_expt_grp_seq" type="12" value="" out="N"/>
				<param name="dmdt_trf_cd" type="12" value="" out="N"/>
				<param name="eff_dt" type="12" value="" out="N"/>
				<param name="exp_dt" type="12" value="" out="N"/>
				<param name="dmdt_cntr_cgo_tp_cd" type="12" value="" out="N"/>
				<param name="sc_expt_fm_conti_cd" type="12" value="" out="N"/>
				<param name="sc_expt_fm_cnt_cd" type="12" value="" out="N"/>
				<param name="sc_expt_fm_rgn_cd" type="12" value="" out="N"/>
				<param name="sc_expt_fm_ste_cd" type="12" value="" out="N"/>
				<param name="sc_expt_fm_loc_cd" type="12" value="" out="N"/>
				<param name="fnl_dest_cnt_cd" type="12" value="" out="N"/>
				<param name="fnl_dest_rgn_cd" type="12" value="" out="N"/>
				<param name="fnl_dest_ste_cd" type="12" value="" out="N"/>
				<param name="fnl_dest_loc_cd" type="12" value="" out="N"/>
				<param name="rcv_de_term_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
