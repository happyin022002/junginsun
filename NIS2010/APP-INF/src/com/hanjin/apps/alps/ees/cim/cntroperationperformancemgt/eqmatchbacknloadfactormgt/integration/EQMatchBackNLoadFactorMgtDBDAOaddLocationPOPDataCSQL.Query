<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EQMatchBackNLoadFactorMgtDBDAOaddLocationPOPDataCSQL">
			<desc><![CDATA[addLocationPOPData]]></desc>
			<sql><![CDATA[
INSERT INTO CIM_COA_MTCH_BAK_LOC(
       USR_ID
      ,RCC_CD
      ,ECC_CD
      ,ECC_LVL
      ,USE_FLG
      ,CRE_USR_ID
      ,CRE_DT
      ,UPD_USR_ID
      ,UPD_DT
)
SELECT
     USR_ID,
     RCC_CD,
     ECC_CD,
     ECC_LVL,
     USE_FLAG,
     @[rqst_usr_id] AS CRE_USR_ID,
     SYSDATE AS CRE_DT,
     @[rqst_usr_id] AS UPD_USR_ID,
     SYSDATE AS UPD_DT
FROM
(
  SELECT 
         @[rqst_usr_id] AS USR_ID,
         RCC_CD,
         DECODE(ECC_CD,'',RCC_CD,ECC_CD) AS ECC_CD,
         ECC_LVL,
         'N' AS USE_FLAG
  FROM
  (
      SELECT RCC_CD, 
           ECC_CD,
           DECODE(ECC_CD,'',0,1) ECC_LVL 
      FROM MDM_EQ_ORZ_CHT
      GROUP BY GROUPING SETS(RCC_CD,(RCC_CD,ECC_CD))
  )
  ORDER BY RCC_CD,ECC_LVL,ECC_CD
)			]]></sql>
			<params>
				<param name="rqst_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
