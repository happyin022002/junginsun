<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChargeCalculationReportDBDAODeleteInquiryByOfficeVORSQL">
			<desc><![CDATA[Delete Charge를 Summary조회한다.]]></desc>
			<sql><![CDATA[
select  #if (${ofc_flg} == 'O' && ${dt_flg} == 'F')
			/*+ ORDERED INDEX    (C XAK2DMT_CHG_CALC)*/
		#elseif (${ofc_flg} == 'R' && ${dt_flg} == 'F')
			/*+ ORDERED INDEX    (C XAK9DMT_CHG_CALC)*/
		#end
		decode(@[grp_flg], 'R', C.OFC_RHQ_CD, C.OFC_CD) 						as OFC_CD
	   ,C.DMDT_CHG_DELT_RSN_CD 													as DELT_RSN_CD
	   ,C.DMDT_CHG_DELT_SPEC_RSN_CD 											as DELT_SPEC_RSN_CD
	   ,decode(C.DMDT_CHG_DELT_RSN_CD, 'OTH', 'Other', R.INTG_CD_VAL_DP_DESC) 	as DELT_RSN_DESC
	   ,R.INTG_CD_VAL_DP_SEQ
	   ,sum(decode(C.DMDT_TRF_CD, 'DMIF', 1, 0)) 								as DMIF_SUM
	   ,sum(decode(C.DMDT_TRF_CD, 'DMOF', 1, 0)) 								as DMOF_SUM
	   ,sum(decode(C.DMDT_TRF_CD, 'DTIC', 1, 0)) 								as DTIC_SUM
	   ,sum(decode(C.DMDT_TRF_CD, 'DTOC', 1, 0)) 								as DTOC_SUM
	   ,sum(decode(C.DMDT_TRF_CD, 'CTIC', 1, 0)) 								as CTIC_SUM
	   ,sum(decode(C.DMDT_TRF_CD, 'CTOC', 1, 0)) 								as CTOC_SUM
	   ,count(1) 																as TTL_CNTR
  from  DMT_CHG_CALC	       C 
	   ,COM_INTG_CD_DTL	       R

 where  C.DMDT_CHG_STS_CD = 'D'
   and  C.FM_MVMT_DT between to_date(replace(@[fm_dt],'-',''),'YYYYMMDD') and to_date(replace(@[to_dt],'-',''),'YYYYMMDD') + .99999

#if (${ofc_flg} == 'O')
   and  C.OFC_CD in 
		(
			#foreach( $an_ofc in ${ofc_cd_list} )
				#if($velocityCount < $ofc_cd_list.size()) '$an_ofc', #else '$an_ofc' #end
			#end
		)
#elseif (${ofc_flg} == 'R' && ${ofc_cd} != 'All') 
   and  C.OFC_RHQ_CD = @[ofc_cd]
#end

#if (${del_cd} != 'All')
   and  C.DMDT_CHG_DELT_RSN_CD = @[del_cd]
#if (${spec_cd} != 'All')
   and  C.DMDT_CHG_DELT_SPEC_RSN_CD = @[spec_cd]
#end
#end

   and  C.DMDT_CHG_LOC_DIV_CD <> 'SZP'	-- 2010/03/19 추가
   and  R.INTG_CD_ID = 'CD01965'
   and  C.DMDT_CHG_DELT_RSN_CD  = R.INTG_CD_VAL_CTNT

group by decode(@[grp_flg], 'R', C.OFC_RHQ_CD, C.OFC_CD)
		,C.DMDT_CHG_DELT_RSN_CD, C.DMDT_CHG_DELT_SPEC_RSN_CD
		,decode(C.DMDT_CHG_DELT_RSN_CD, 'OTH', 'Other', R.INTG_CD_VAL_DP_DESC)
		,R.INTG_CD_VAL_DP_SEQ
order by 1
		,R.INTG_CD_VAL_DP_SEQ			]]></sql>
			<params>
				<param name="grp_flg" type="12" value="" out="N"/>
				<param name="fm_dt" type="12" value="20090816" out="N"/>
				<param name="to_dt" type="12" value="20090916" out="N"/>
				<param name="ofc_cd" type="12" value="HAMUR" out="N"/>
				<param name="del_cd" type="12" value="All" out="N"/>
				<param name="spec_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
