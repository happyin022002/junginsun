<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DemDetTariffMgtDBDAOAddApproSetupInfoListCSQL">
			<desc><![CDATA[DemDetTariffMgtDBDAOAddApproSetupInfoListCSQL]]></desc>
			<sql><![CDATA[
MERGE INTO DMT_APRO_STUP
USING DUAL
ON    (     DMDT_EXPT_APRO_TP_CD = @[dmdt_expt_apro_tp_cd]
      AND   OFC_LVL = @[ofc_lvl]
	  AND   DMDT_OFC_CD = @[dmdt_ofc_cd]
	  AND   DMDT_SEQ = @[dmdt_seq]
      )
WHEN MATCHED THEN
UPDATE SET     
         FT_ADD_DYS				= @[ft_add_dys]
        ,FT_TTL_DYS				= @[ft_ttl_dys]
        ,DC_FLG					= DECODE(@[dc_flg],'1','Y','N')
        ,DC_RTO					= @[dc_rto]
        ,DC_AMT					= @[dc_amt]
        ,DMDT_BRNC_FLG			=  DECODE(@[dmdt_brnc_flg],'1','Y','N')
        ,DMDT_BRNC_SUBST_ID		= @[dmdt_brnc_subst_id]
        ,DMDT_RHQ_PIC_FLG		=  DECODE(@[dmdt_rhq_pic_flg],'1','Y','N')
        ,DMDT_RHQ_FLG			=  DECODE(@[dmdt_rhq_flg],'1','Y','N')
        ,DMDT_RHQ_SUBST_ID		= @[dmdt_rhq_subst_id]
        ,DMDT_HO_FLG			=  DECODE(@[dmdt_ho_flg],'1','Y','N')
        ,DMDT_HO_SUBST_ID		= @[dmdt_ho_subst_id]
        ,UPD_DT       			= SYSDATE
        ,UPD_USR_ID   			= @[upd_usr_id]
WHEN NOT MATCHED THEN
INSERT
(
        DMDT_EXPT_APRO_TP_CD
        ,OFC_LVL
        ,DMDT_OFC_CD
        ,DMDT_SEQ
        ,CUST_CNT_CD
        ,CUST_SEQ
        ,FT_ADD_DYS
        ,FT_TTL_DYS
        ,DC_FLG
        ,DC_RTO
        ,DC_AMT
        ,DMDT_BRNC_FLG
        ,DMDT_BRNC_SUBST_ID
        ,DMDT_RHQ_PIC_FLG
        ,DMDT_RHQ_FLG
        ,DMDT_RHQ_SUBST_ID
        ,DMDT_HO_FLG
        ,DMDT_HO_SUBST_ID
        ,CRE_USR_ID
        ,CRE_DT
        ,UPD_USR_ID
        ,UPD_DT
)
VALUES
(
        @[dmdt_expt_apro_tp_cd]
        ,@[ofc_lvl]
        ,@[dmdt_ofc_cd]
        ,NVL(( SELECT MAX(DMDT_SEQ)+1 FROM DMT_APRO_STUP 
			WHERE DMDT_EXPT_APRO_TP_CD = @[dmdt_expt_apro_tp_cd]
      		  AND OFC_LVL = @[ofc_lvl]
	          AND DMDT_OFC_CD = @[dmdt_ofc_cd] ),1) 
        ,CASE WHEN TRIM(UPPER(@[cust_cd])) = 'ALL' THEN 'AL'
		 ELSE SUBSTR(@[cust_cd],1,2) END
		,CASE WHEN TRIM(UPPER(@[cust_cd])) = 'ALL' THEN 0
		 ELSE TO_NUMBER(SUBSTR(@[cust_cd],3)) END
        ,@[ft_add_dys]
        ,@[ft_ttl_dys]
        ,DECODE(@[dc_flg],'1','Y','N')
        ,@[dc_rto]
        ,@[dc_amt]
        ,DECODE(@[dmdt_brnc_flg],'1','Y','N')
        ,@[dmdt_brnc_subst_id]
        ,DECODE(@[dmdt_rhq_pic_flg],'1','Y','N')
        ,DECODE(@[dmdt_rhq_flg],'1','Y','N')
        ,@[dmdt_rhq_subst_id]
        ,DECODE(@[dmdt_ho_flg],'1','Y','N')
        ,@[dmdt_ho_subst_id]
        ,@[upd_usr_id]
        ,SYSDATE
        ,@[upd_usr_id]
        ,SYSDATE
)			]]></sql>
			<params>
				<param name="dmdt_expt_apro_tp_cd" type="12" value="" out="N"/>
				<param name="ofc_lvl" type="12" value="" out="N"/>
				<param name="dmdt_ofc_cd" type="12" value="" out="N"/>
				<param name="dmdt_seq" type="12" value="" out="N"/>
				<param name="ft_add_dys" type="12" value="" out="N"/>
				<param name="ft_ttl_dys" type="12" value="" out="N"/>
				<param name="dc_flg" type="12" value="" out="N"/>
				<param name="dc_rto" type="12" value="" out="N"/>
				<param name="dc_amt" type="12" value="" out="N"/>
				<param name="dmdt_brnc_flg" type="12" value="" out="N"/>
				<param name="dmdt_brnc_subst_id" type="12" value="" out="N"/>
				<param name="dmdt_rhq_pic_flg" type="12" value="" out="N"/>
				<param name="dmdt_rhq_flg" type="12" value="" out="N"/>
				<param name="dmdt_rhq_subst_id" type="12" value="" out="N"/>
				<param name="dmdt_ho_flg" type="12" value="" out="N"/>
				<param name="dmdt_ho_subst_id" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="cust_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
