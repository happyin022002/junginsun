<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChargeCollectionReportDBDAOSearchTmnlVvdLfdRSQL">
			<desc><![CDATA[ChargeCollectionReportDBDAOSearchTmnlVvdLfdRSQL]]></desc>
			<sql><![CDATA[
SELECT DISTINCT A.YD_CD AS TML_YD_CD,
  A.SLAN_CD TML_LAN_CD,
  A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD AS TML_VVD,
  B.VSL_ENG_NM AS TML_VSL_NM,
  B.CRR_CD AS TML_OPR,
  TO_CHAR(A.VPS_ETA_DT, 'YYYY-MM-DD') AS TML_VPS_ETA_DT,
  TO_CHAR(A.VPS_ETB_DT, 'YYYY-MM-DD') AS TML_VPS_ETB_DT,
  TO_CHAR(A.VPS_ETD_DT, 'YYYY-MM-DD') AS TML_VPS_ETD_DT,
  A.CLPT_IND_SEQ AS TML_CLPT_IND_SEQ
FROM VSK_VSL_PORT_SKD A, MDM_VSL_CNTR B
WHERE YD_CD LIKE @[s_tml_yd_cd]||'%'
  AND VPS_ETA_DT BETWEEN TO_DATE(REPLACE(@[s_fm_dt],'-',''), 'YYYYMMDD') AND TO_DATE(REPLACE(@[s_to_dt],'-',''), 'YYYYMMDD') + 0.99999
#if ( ${s_vvd} != '' )
  AND A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD LIKE @[s_vvd]||'%'
#end
  AND A.VSL_CD = B.VSL_CD(+) 
  AND EXISTS ( SELECT 'Y' FROM BKG_BOOKING BB, BKG_VVD BV, BKG_CONTAINER BC
                WHERE 1=1
                  AND BV.VSL_CD = A.VSL_CD
                  AND BV.SKD_VOY_NO = A.SKD_VOY_NO
                  AND BV.SKD_DIR_CD = A.SKD_DIR_CD
                  AND BV.POD_YD_CD = A.YD_CD
                  AND BV.POD_CLPT_IND_SEQ = A.CLPT_IND_SEQ 
                  AND BB.BKG_NO = BV.BKG_NO
                  AND BB.POD_CD = BV.POD_CD
				  AND BB.BKG_NO = BC.BKG_NO
				  AND BB.BKG_STS_CD = 'F'
				  AND BB.BKG_CGO_TP_CD = 'F'
                  AND ROWNUM = 1 )
ORDER BY TML_YD_CD, TML_VVD, TML_VPS_ETA_DT			]]></sql>
			<params>
				<param name="s_tml_yd_cd" type="12" value="" out="N"/>
				<param name="s_fm_dt" type="12" value="" out="N"/>
				<param name="s_to_dt" type="12" value="" out="N"/>
				<param name="s_vvd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
