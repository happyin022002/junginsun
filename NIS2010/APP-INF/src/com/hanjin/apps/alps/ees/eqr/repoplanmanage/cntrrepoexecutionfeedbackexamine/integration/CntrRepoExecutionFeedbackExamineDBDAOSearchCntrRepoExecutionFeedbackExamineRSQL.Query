<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CntrRepoExecutionFeedbackExamineDBDAOSearchCntrRepoExecutionFeedbackExamineRSQL">
			<desc><![CDATA[<EES_EQR_0063 컨테이너 이송실행 실적 및 Feedback 조회>
plan - execution 의 자동제어 examine 내용 조회

<Change History>
1	2009.10.09	Lee ByoungHun	최초작성]]></desc>
			<sql><![CDATA[
SELECT
    X.
    #if (${weekmonth} == '1')
        PLN_YRWK
    #else
        PLN_MON
    #end
    #if (${itemcd} == 'O' || ${itemcd} == 'F')
        , MAX(X.FM_ECC_CD) FM_ECC_CD, MAX(X.TO_ECC_CD) TO_ECC_CD
    #else
        , X.FM_ECC_CD FM_ECC_CD, X.TO_ECC_CD TO_ECC_CD
    #end
    , (SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_VAL_CTNT = X.CO_CD AND INTG_CD_ID = 'CD00264') CO_CD
    , (
        SELECT INTG_CD_VAL_DP_DESC
        FROM COM_INTG_CD_DTL
        WHERE INTG_CD_ID = 'CD00253'
        AND INTG_CD_VAL_CTNT = X.TRSP_MOD_CD
    ) TRSP_MOD_CD
    , X.VSL_LANE_CD
    , X.DIV
    #if (${ratiovolflag} == 'V')
        #if (${frequencycd} == 'F')
            , DECODE(X.SUMCNT,'3',COUNT(X.VOL),ROUND(SUM(X.VOL),2)) TOTAL_VOL
        #else
            , DECODE(X.SUMCNT,ROUND(SUM(X.VOL),2)) TOTAL_VOL
        #end
    #else
        #if (${frequencycd} == 'F')
            , DECODE(X.SUMCNT,'2',ROUND(SUM(X.VOL)*100,2),'3',COUNT(X.VOL),ROUND(SUM(X.VOL),2)) TOTAL_VOL
        #else
            , DECODE(X.SUMCNT,'2',ROUND(SUM(X.VOL)*100,2),ROUND(SUM(X.VOL),2)) TOTAL_VOL
        #end
    #end
    , ROUND(SUM (X.COST),2)TOTAL_COST
    #foreach ($key in ${arrHeadTitle})
        #if (${ratiovolflag} == 'V')
            #if (${frequencycd} == 'F')
                #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                    , DECODE(X.SUMCNT, '3', SUM (DECODE (X.CNTR_TPSZ_CD, '$key', 1,  0)), ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, '$key', X.VOL,  0)),2)) ${key}_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, '$key', X.COST, 0)),2) ${key}_COST
                #end
                #if (${key} == 'O2')
                    , DECODE(X.SUMCNT, '3', SUM (DECODE (X.CNTR_TPSZ_CD, 'O2', 1,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S2', 1,  0)),  ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O2', X.VOL,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S2', X.VOL,  0)),2)) O2_S2_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O2', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S2', X.COST, 0)),2) O2_S2_COST
                #end
                #if (${key} == 'O4')
                    , DECODE(X.SUMCNT, '3', SUM (DECODE (X.CNTR_TPSZ_CD, 'O4', 1,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S4', 1,  0)),  ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O4', X.VOL,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S4', X.VOL,  0)),2)) O4_S4_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O4', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S4', X.COST, 0)),2) O4_S4_COST
                #end
                #if (${key} == 'F2')
                    , DECODE(X.SUMCNT, '3', SUM (DECODE (X.CNTR_TPSZ_CD, 'F2', 1,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A2', 1,  0)),  ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F2', X.VOL,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A2', X.VOL,  0)),2)) F2_A2_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F2', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A2', X.COST, 0)),2) F2_A2_COST
                #end
                #if (${key} == 'F4')
                    , DECODE(X.SUMCNT, '3', SUM (DECODE (X.CNTR_TPSZ_CD, 'F4', 1,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A4', 1,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'F5', 1,  0)),  ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F4', X.VOL,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A4', X.VOL,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'F5', X.VOL,  0)),2)) F4_A4_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F4', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A4', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'F5', X.COST, 0)),2) F4_A4_COST
                #end
            #else
                #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                    , DECODE(X.SUMCNT, ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, '$key', X.VOL,  0)),2)) ${key}_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, '$key', X.COST, 0)),2) ${key}_COST
                #end
                #if (${key} == 'O2')
                    , DECODE(X.SUMCNT, ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O2', X.VOL,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S2', X.VOL,  0)),2)) O2_S2_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O2', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S2', X.COST, 0)),2) O2_S2_COST
                #end
                #if (${key} == 'O4')
                    , DECODE(X.SUMCNT, ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O4', X.VOL,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S4', X.VOL,  0)),2)) O4_S4_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O4', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S4', X.COST, 0)),2) O4_S4_COST
                #end
                #if (${key} == 'F2')
                    , DECODE(X.SUMCNT, ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F2', X.VOL,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A2', X.VOL,  0)),2)) F2_A2_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F2', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A2', X.COST, 0)),2) F2_A2_COST
                #end
                #if (${key} == 'F4')
                    , DECODE(X.SUMCNT, ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F4', X.VOL,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A4', X.VOL,  0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'F5', X.VOL,  0)),2)) F4_A4_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F4', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A4', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'F5', X.COST, 0)),2) F4_A4_COST
                #end
            #end
        #else
            #if (${frequencycd} == 'F')
                #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                    , DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, '$key', X.VOL,  0))*100,2),'3', SUM (DECODE (X.CNTR_TPSZ_CD, '$key', 1,  0)),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, '$key', X.VOL,  0)),2)) ${key}_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, '$key', X.COST, 0)),2) ${key}_COST
                #end
                #if (${key} == 'O2')
                    , DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O2', X.VOL,  0))*100,2),'3', SUM (DECODE (X.CNTR_TPSZ_CD, 'O2', 1,  0)),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O2', X.VOL,  0)),2))
                    + DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'S2', X.VOL,  0))*100,2),'3', SUM (DECODE (X.CNTR_TPSZ_CD, 'S2', 1,  0)),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'S2', X.VOL,  0)),2)) O2_S2_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O2', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S2', X.COST, 0)),2) O2_S2_COST
                #end
                #if (${key} == 'O4')
                    , DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O4', X.VOL,  0))*100,2),'3', SUM (DECODE (X.CNTR_TPSZ_CD, 'O4', 1,  0)),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O4', X.VOL,  0)),2))
                    + DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'S4', X.VOL,  0))*100,2),'3', SUM (DECODE (X.CNTR_TPSZ_CD, 'S4', 1,  0)),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'S4', X.VOL,  0)),2)) O4_S4_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O4', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S4', X.COST, 0)),2) O4_S4_COST
                #end
                #if (${key} == 'F2')
                    , DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F2', X.VOL,  0))*100,2),'3', SUM (DECODE (X.CNTR_TPSZ_CD, 'F2', 1,  0)),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F2', X.VOL,  0)),2))
                    + DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'A2', X.VOL,  0))*100,2),'3', SUM (DECODE (X.CNTR_TPSZ_CD, 'A2', 1,  0)),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'A2', X.VOL,  0)),2)) F2_A2_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F2', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A2', X.COST, 0)),2) F2_A2_COST
                #end
                #if (${key} == 'F4')
                    , DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F4', X.VOL,  0))*100,2),'3', SUM (DECODE (X.CNTR_TPSZ_CD, 'F4', 1,  0)),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F4', X.VOL,  0)),2))
                    + DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F5', X.VOL,  0))*100,2),'3', SUM (DECODE (X.CNTR_TPSZ_CD, 'F5', 1,  0)),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F5', X.VOL,  0)),2))
                    + DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'A4', X.VOL,  0))*100,2),'3', SUM (DECODE (X.CNTR_TPSZ_CD, 'A4', 1,  0)),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'A4', X.VOL,  0)),2)) F4_A4_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F4', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'F5', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A4', X.COST, 0)),2) F4_A4_COST
                #end
            #else
                #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                    , DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, '$key', X.VOL,  0))*100,2),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, '$key', X.VOL,  0)),2)) ${key}_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, '$key', X.COST, 0)),2) ${key}_COST
                #end
                #if (${key} == 'O2')
                    , DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O2', X.VOL,  0))*100,2),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O2', X.VOL,  0)),2))
                    + DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'S2', X.VOL,  0))*100,2),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'S2', X.VOL,  0)),2)) O2_S2_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O2', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S2', X.COST, 0)),2) O2_S2_COST
                #end
                #if (${key} == 'O4')
                    , DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O4', X.VOL,  0))*100,2),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O4', X.VOL,  0)),2))
                    + DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'S4', X.VOL,  0))*100,2),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'S4', X.VOL,  0)),2)) O4_S4_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'O4', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'S4', X.COST, 0)),2) O4_S4_COST
                #end
                #if (${key} == 'F2')
                    , DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F2', X.VOL,  0))*100,2),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F2', X.VOL,  0)),2))
                    + DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'A2', X.VOL,  0))*100,2),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'A2', X.VOL,  0)),2)) F2_A2_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F2', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A2', X.COST, 0)),2) F2_A2_COST
                #end
                #if (${key} == 'F4')
                    , DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F4', X.VOL,  0))*100,2),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F4', X.VOL,  0)),2))
                    + DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F5', X.VOL,  0))*100,2),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F5', X.VOL,  0)),2))
                    + DECODE(X.SUMCNT, '2',ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'A4', X.VOL,  0))*100,2),ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'A4', X.VOL,  0)),2)) F4_A4_VOL
                    , ROUND(SUM (DECODE (X.CNTR_TPSZ_CD, 'F4', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'F5', X.COST, 0)) + SUM (DECODE (X.CNTR_TPSZ_CD, 'A4', X.COST, 0)),2) F4_A4_COST
                #end
            #end
        #end
    #end
    , ''
FROM
(
    #if (${itemcd} == 'V')
        -- ITEM = T.VVD
        -- Plan ID 1_ONE : planStr1_one
        #if (${weekmonth} == '1')
            SELECT 
            (
                SELECT PLN_YR||'-'||PLN_WK  PLN_YRWK 
                FROM EQR_WK_PRD 
                WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
            )  PLN_YRWK
        #else
            SELECT 
            (
                SELECT PLN_YR||'-'||PLN_MON PLN_YRWK 
                FROM EQR_WK_PRD 
                WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
            )  PLN_MON
        #end
            ,(
                SELECT ${orgviewby}
                FROM EQR_ECC_MST 
                WHERE FM_ECC_CD = ECC_CD
            ) FM_ECC_CD
        #if (${adherencecd} == 'O')
            ,'ALL' TO_ECC_CD
        #else
            ,(
                SELECT ${dstviewby}
                FROM EQR_ECC_MST 
                WHERE TO_ECC_CD = ECC_CD
            ) TO_ECC_CD
        #end
            ,'' CO_CD
            ,TRSP_MOD_CD
            ,VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,SUM(CNTR_QTY)  VOL
            ,SUM(LODG_DCHG_COST_AMT)  COST
            -- Plan ID 1 : planDivStr
            ,'Plan' DIV
            ,'1' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- Plan ID 1_TWO : planStr1_two
        FROM
            EQR_VSL_LODG_DCHG_PLN A
            ,EQR_VSL_LODG_DCHG_PLN_QTY Q
            ,(
                SELECT REPO_PLN_ID
                FROM EQR_EQ_REPO_PLN
                WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                UNION ALL
                SELECT REPO_PLN_ID
                FROM EQR_EQ_REPO_PLN
                WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
            ) B
            ,(
                SELECT ECC_CD
                FROM EQR_ECC_MST
                WHERE ${orgviewby} = @[orgcd]
            ) c
            #if (${adherencecd} == 'Z')
                ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
            #else
                ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1=1) D
            #end
            ,EQR_WK_PRD E
        WHERE
            A.REPO_PLN_ID = Q.REPO_PLN_ID
            AND A.PLN_YRWK = Q.PLN_YRWK
            AND A.PLN_SEQ = Q.PLN_SEQ
            AND A.REPO_PLN_ID = B.REPO_PLN_ID
            AND FM_ECC_CD = C.ECC_CD
            AND TO_ECC_CD = D.ECC_CD
            AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
            #if (${weekmonth} == '1')
                AND A.PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            AND PAST_REPO_PLN_FLG NOT IN('Y')
            #if (${fmsyrwk} != '')
                AND TO_CHAR (FM_ETD_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
            #end
            #if (${tosyrwk} != '')
                AND TO_CHAR (TO_ETB_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
            #end
        #if (${weekmonth} == '1')
            GROUP BY A.FM_ETD_DT , TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
        #else
            GROUP BY A.FM_ETD_DT , PLN_MON, TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
        #end
        
        UNION ALL
        
        #if (${adherencecd} == 'O')
            -- ITEM = T.VVD
            -- Execultion 1_ONE : exeStr1_one
            #if (${weekmonth} == '1')
                SELECT
                (
                    SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                    FROM EQR_WK_PRD
                    WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                )  pln_yrwk
            #else
                SELECT
                (
                    SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                    FROM EQR_WK_PRD
                    WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                )  pln_mon
            #end
                ,(
                    SELECT B.${orgviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                ) FM_ECC_CD
                ,'ALL' TO_ECC_CD
                ,A.CO_CD
                ,A.TRSP_MOD_CD
                ,A.VSL_LANE_CD
                ,A.CNTR_TPSZ_CD
                ,B.CNTR_QTY VOL
                ,A.LODG_DCHG_COST_AMT COST
                ,'Execution' DIV
                ,'2' SORT
                ,'1' SUMCNT
                ,'${frequencycd}' FEED
            FROM
                (
                    SELECT
                        A.PLN_YRWK
                        , A.CO_CD
                        , A.TRSP_MOD_CD
                        , A.VSL_LANE_CD
                        , A.VSL_CD
                        , A.SKD_VOY_NO
                        , A.SKD_DIR_CD
                        , A.FM_YD_CD
                        , A.FM_ETD_DT
                        , A.TO_YD_CD
                        , A.TO_ETB_DT
                        , A.EQ_REPO_PURP_CD
                        , A.REPO_MTY_BKG_FLG
                        , A.REPO_PLN_FB_RSN_CD
                        , A.REPO_PLN_FB_RMK
                        , A.MTY_BKG_NO
                        , A.SPLIT_REPO_PLN_FLG
                        , A.PAST_REPO_PLN_FLG
                        , Q.CNTR_TPSZ_CD
                        , Q.CNTR_QTY
                        , Q.LODG_DCHG_COST_AMT
                        , Q.PLN_UC_AMT
                        , Q.LODG_PORT_UC_AMT
                        , Q.DCHG_PORT_UC_AMT
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        , EQR_VSL_EXE_PLN_QTY Q
                    WHERE
                        A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                ) A
                ,(
                    -- original booking vol 집계
                    SELECT
                        DISTINCT A.MTY_BKG_NO
                        ,Q.CNTR_TPSZ_CD
                        ,SUM(Q.CNTR_QTY) CNTR_QTY
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                        EQR_VSL_EXE_PLN_QTY Q,
                        (
                            SELECT
                                DISTINCT MTY_BKG_NO
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                (
                                    SELECT SCC_CD
                                    FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                    WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                ) c
                            WHERE
                                A.REPO_MTY_BKG_FLG = 'Y'
                                AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                #if (${weekmonth} == '1')
                                    AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                #else
                                    AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                #end
                                #if (${fmsyrwk} != '')
                                    AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                #end
                                #if (${tosyrwk} != '')
                                    AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                #end
                        ) B
                    WHERE
                        A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO = B.MTY_BKG_NO
                    GROUP BY
                        A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                ) B
                ,(
                    SELECT SCC_CD
                    FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                    WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                ) c
            WHERE
                A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                AND   A.MTY_BKG_NO IS NOT NULL
                AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                #if (${weekmonth} == '1')
                    AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                #else
                    AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                #end
                #if ($arroddtpszCd.size() > 0)
                    AND A.CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arroddtpszCd})
                        #if($velocityCount < $arroddtpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                    )
                #end
                #if (${fmsyrwk} != '')
                    AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                #end
                #if (${tosyrwk} != '')
                    AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                #end
        #else
            -- ITEM = T.VVD
            -- Execultion 1_ONE : exeStr1_one
            #if (${weekmonth} == '1')
                SELECT
                (
                    SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                    FROM EQR_WK_PRD
                    WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                )  PLN_YRWK
            #else
                SELECT
                (
                    SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                    FROM EQR_WK_PRD
                    WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                )  PLN_MON
            #end
                ,(
                    SELECT B.${orgviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                ) FM_ECC_CD
                ,(
                    SELECT B.${dstviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                ) TO_ECC_CD
                ,CO_CD
                ,TRSP_MOD_CD
                ,VSL_LANE_CD
                ,CNTR_TPSZ_CD
                ,CNTR_QTY VOL
                ,LODG_DCHG_COST_AMT COST
                ,'Execution' DIV
                ,'2' SORT
                ,'1' SUMCNT
                ,'${frequencycd}' FEED
            FROM
                EQR_VSL_LODG_DCHG_EXE_PLN A
                ,EQR_VSL_EXE_PLN_QTY Q
                ,(
                    SELECT SCC_CD
                    FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                    WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                ) C
                ,(
                    SELECT SCC_CD
                    FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                    WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                ) D
            WHERE
                1=1
                AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                AND A.PLN_YRWK = Q.PLN_YRWK
                AND A.PLN_SEQ = Q.PLN_SEQ
                AND A.REF_ID = Q.REF_ID
                AND A.MTY_BKG_NO IS NOT NULL
                AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                #if (${weekmonth} == '1')
                    AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                #else
                    AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                #end
                AND TRSP_MOD_CD = 'V'
                #if ($arroddtpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arroddtpszCd})
                        #if($velocityCount < $arroddtpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                    )
                #end
                #if (${fmsyrwk} != '')
                    AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                #end
                #if (${tosyrwk} != '')
                    AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                #end
        #end
        
        UNION ALL
        
        #if (${adherencecd} == 'O')
            -- ITEM = T.VVD
            -- Execultion 1_ONE : exeStr1_one
            #if (${weekmonth} == '1')
                SELECT
                (
                    SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                    FROM EQR_WK_PRD
                    WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                )  PLN_YRWK
            #else
                SELECT
                (
                    SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                    FROM EQR_WK_PRD
                    WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                )  PLN_MON
            #end
                ,(
                    SELECT B.${orgviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                ) FM_ECC_CD
                ,'ALL' TO_ECC_CD
                ,A.CO_CD
                ,A.TRSP_MOD_CD
                ,A.VSL_LANE_CD
                ,A.CNTR_TPSZ_CD
                ,B.CNTR_QTY VOL
                ,A.LODG_DCHG_COST_AMT COST
                -- W/O 1 : woDivStr
                ,'W/O' DIV
                ,'3' SORT
                ,'1' SUMCNT
                ,'${frequencycd}' FEED
            FROM
                (
                    SELECT
                        A.PLN_YRWK
                        , A.CO_CD
                        , A.TRSP_MOD_CD
                        , A.VSL_LANE_CD
                        , A.VSL_CD
                        , A.SKD_VOY_NO
                        , A.SKD_DIR_CD
                        , A.FM_YD_CD
                        , A.FM_ETD_DT
                        , A.TO_YD_CD
                        , A.TO_ETB_DT
                        , A.EQ_REPO_PURP_CD
                        , A.REPO_MTY_BKG_FLG
                        , A.REPO_PLN_FB_RSN_CD
                        , A.REPO_PLN_FB_RMK
                        , A.MTY_BKG_NO
                        , A.SPLIT_REPO_PLN_FLG
                        , A.PAST_REPO_PLN_FLG
                        , Q.CNTR_TPSZ_CD
                        , Q.CNTR_QTY
                        , Q.LODG_DCHG_COST_AMT
                        , Q.PLN_UC_AMT
                        , Q.LODG_PORT_UC_AMT
                        , Q.DCHG_PORT_UC_AMT
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        , EQR_VSL_EXE_PLN_QTY Q
                    WHERE
                        A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                ) A
                ,(
                    -- original booking vol 집계
                    SELECT
                        DISTINCT A.MTY_BKG_NO
                        ,Q.CNTR_TPSZ_CD
                        ,SUM(Q.CNTR_QTY) CNTR_QTY
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                        EQR_VSL_EXE_PLN_QTY Q,
                        (
                            SELECT
                                DISTINCT MTY_BKG_NO
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                (
                                    SELECT SCC_CD
                                    FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                    WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                ) c
                            WHERE
                                A.REPO_MTY_BKG_FLG = 'Y'
                                AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                #if (${weekmonth} == '1')
                                    AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                #else
                                    AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                #end
                                #if (${fmsyrwk} != '')
                                    AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                #end
                                #if (${tosyrwk} != '')
                                    AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                #end
                        ) B
                    WHERE
                        A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO = B.MTY_BKG_NO
                    GROUP BY
                        A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                ) B
                ,(
                    SELECT SCC_CD
                    FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                    WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                ) C
            WHERE
                A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                AND   A.MTY_BKG_NO IS NOT NULL
                AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                #if (${weekmonth} == '1')
                    AND (SELECT PLN_YR||PLN_WK  FROM eqr_wk_prd WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                #else
                    AND (SELECT PLN_YR||PLN_MON FROM eqr_wk_prd WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                #end
                #if ($arroddtpszCd.size() > 0)
                    AND A.CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arroddtpszCd})
                        #if($velocityCount < $arroddtpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                    )
                #end
                #if (${fmsyrwk} != '')
                    AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                #end
                #if (${tosyrwk} != '')
                    AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                #end
        #else
            -- ITEM = T.VVD
            -- Execultion 1_ONE : exeStr1_one
            #if (${weekmonth} == '1')
                SELECT
                (
                    SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                    FROM EQR_WK_PRD
                    WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                )  PLN_YRWK
            #else
                SELECT
                (
                    SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                    FROM EQR_WK_PRD
                    WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                )  PLN_MON
            #end
                ,(
                    SELECT B.${orgviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                ) FM_ECC_CD
                ,(
                    SELECT B.${dstviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                ) TO_ECC_CD
                ,CO_CD
                ,TRSP_MOD_CD
                ,VSL_LANE_CD
                ,CNTR_TPSZ_CD
                ,CNTR_QTY VOL
                ,LODG_DCHG_COST_AMT COST
                -- W/O 1 : woDivStr
                ,'W/O' DIV
                ,'3' SORT
                ,'1' SUMCNT
                ,'${frequencycd}' FEED
            FROM
                EQR_VSL_LODG_DCHG_EXE_PLN A
                ,EQR_VSL_EXE_PLN_QTY Q
                ,(
                    SELECT SCC_CD
                    FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                    WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                ) c
                ,(
                    SELECT SCC_CD
                    FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                    WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                ) d
            WHERE
                1=1
                AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                AND A.PLN_YRWK = Q.PLN_YRWK
                AND A.PLN_SEQ = Q.PLN_SEQ
                AND A.REF_ID = Q.REF_ID
                AND A.MTY_BKG_NO IS NOT NULL
                AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                #if (${weekmonth} == '1')
                    AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                #else
                    AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                #end
                AND TRSP_MOD_CD = 'V'
                #if ($arroddtpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arroddtpszCd})
                        #if($velocityCount < $arroddtpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                    )
                #end
                #if (${fmsyrwk} != '')
                    AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                #end
                #if (${tosyrwk} != '')
                    AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                #end
        #end
        
        UNION ALL
        
        -- ITEM = T.VVD
        -- Adherence Ratio : adherencdStr
        SELECT 
            y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.VSL_LANE_CD
            , Y.CNTR_TPSZ_CD
            #if (${ratiovolflag} == 'R')
                ,SUM(DECODE(Y.FLAG, '2', VOL,  '')) / DECODE(MAX(DECODE(Y.FLAG, '1', VOL,  '')), 0, '', MAX(DECODE(Y.FLAG, '1', VOL,  ''))) VOL
                ,SUM(DECODE(Y.FLAG, '2', COST, '')) / DECODE(MAX(DECODE(Y.FLAG, '1', COST, '')), 0, '', MAX(DECODE(Y.FLAG, '1', COST, ''))) COST
            #else
                ,MAX(DECODE(Y.FLAG, '1', VOL,  '')) - SUM(DECODE(Y.FLAG, '2', VOL,  '')) VOL
                ,MAX(DECODE(Y.FLAG, '1', COST, '')) - SUM(DECODE(Y.FLAG, '2', VOL,  '')) COST
            #end
            , 'Adherence' DIV
            , '4' SORT
            , '2' SUMCNT
            , '${frequencycd}' FEED
        FROM (
            #if (${itemcd} == 'V')
                -- ITEM = T.VVD
                -- Plan ID 1_ONE : planStr1_one
                #if (${weekmonth} == '1')
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_WK  PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_YRWK
                #else
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_MON PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_MON
                #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST 
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                #if (${adherencecd} == 'O')
                    ,'ALL' TO_ECC_CD
                #else
                    ,(
                        SELECT ${dstviewby}
                        FROM EQR_ECC_MST 
                        WHERE TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY)  VOL
                    ,SUM(LODG_DCHG_COST_AMT)  COST
                    ,'1' FLAG
                -- Plan ID 1_TWO : planStr1_two
                FROM
                    EQR_VSL_LODG_DCHG_PLN A
                    ,EQR_VSL_LODG_DCHG_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) b
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) c
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #else
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1=1) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    AND TO_ECC_CD = D.ECC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND PAST_REPO_PLN_FLG NOT IN('Y')
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR (FM_ETD_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR (TO_ETB_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
                #if (${weekmonth} == '1')
                    GROUP BY A.FM_ETD_DT , TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #else
                    GROUP BY A.FM_ETD_DT , PLN_MON, TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #end
                
                UNION ALL
                
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'2' flag
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) c
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) c
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'2' flag
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
            #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
                -- ITEM = Rail(R), Truck(), Water(W)
                -- Plan ID 3_ONE : planStr3_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${dstviewby}
                            FROM EQR_ECC_MST
                            WHERE TO_ECC_CD = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(TRSP_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 23TWO : planStr3_two
                FROM
                    EQR_INLND_TRSP_PLN A
                    ,EQR_INLND_TRSP_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #end
                    #if (${weekmonth} != '1')
                        ,EQR_WK_PRD E
                    #end
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    #if (${adherencecd} == 'Z')
                        AND TO_ECC_CD = D.ECC_CD
                    #end
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${weekmonth} != '1')
                        AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #end
                    AND TRSP_MOD_CD = @[itemcd]
                    #if (${fmsyrwk} != '')
                        AND FM_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_YRWK BETWEEN @[tosyrwk] AND @[toeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = Rail(R), Truck(T), Water(W)
                -- Execultion 3 : exeStr3_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,TRSP_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 3_TWO : exeStr3_two
                FROM
                    EQR_INLND_TRSP_EXE_PLN A
                    ,EQR_INLND_TRSP_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND TRSP_MOD_CD    = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
            #elseif (${itemcd} == 'O')
                -- ITEM = On-Hire(O)
                -- Plan ID 2_ONE => On-Hire : planStr2On_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => On-Hire : planStr2On_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #elseif (${itemcd} == 'F')
                -- ITEM = Off-Hire(F)
                -- Plan ID 2_ONE => Off-Hire : planStr2Off_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => Off-Hire : planStr2Off_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    , EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD  = 'F'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                
                UNION ALL
                
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #end
        ) Y
        GROUP BY 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CNTR_TPSZ_CD
            , Y.VSL_LANE_CD
        
        UNION ALL
        
        -- ITEM = T.VVD
        -- W/O Issued Ratio : woIssuedStr
        SELECT 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.VSL_LANE_CD
            , Y.CNTR_TPSZ_CD
            #if (${ratiovolflag} == 'R')
                ,MAX(DECODE(Y.FLAG, '3', VOL,  '')) / DECODE(SUM(DECODE(Y.FLAG, '2', VOL,  '')), 0, '', SUM(DECODE(Y.FLAG, '2', VOL,  ''))) VOL
                ,MAX(DECODE(Y.FLAG, '3', COST, '')) / DECODE(SUM(DECODE(Y.FLAG, '2', COST, '')), 0, '', SUM(DECODE(Y.FLAG, '2', COST, ''))) COST
            #else
                ,SUM(DECODE(Y.FLAG, '2', VOL,  '')) - SUM(DECODE(Y.FLAG, '3', VOL,  '')) SO_ISSUED_VOL
                ,SUM(DECODE(Y.FLAG, '2', COST, '')) - SUM(DECODE(Y.FLAG, '3', COST, '')) SO_ISSUED_COST
            #end
            , 'W/O Ratio' DIV
            , '6' SORT
            , '2' SUMCNT
            , '${frequencycd}' FEED
        FROM (
            #if (${itemcd} == 'V')
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) c
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
                
                UNION ALL
                
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
            #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
                -- ITEM = Rail(R), Truck(T), Water(W)
                -- Execultion 3 : exeStr3_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,TRSP_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 3_TWO : exeStr3_two
                FROM
                    EQR_INLND_TRSP_EXE_PLN A
                    ,EQR_INLND_TRSP_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND TRSP_MOD_CD    = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = T.VVD not etc
                -- W/O 1_one : woStr1_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
            #elseif (${itemcd} == 'O')
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- W/O 1_one : woStr1On_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1On_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND cntr_tpsz_cd IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #elseif (${itemcd} == 'F')
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = On-Hire(F)
                -- W/O 1_one : woStr1Off_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1Off_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD 
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B 
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = 'F'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #end
        ) Y
        GROUP BY 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CNTR_TPSZ_CD
            , Y.VSL_LANE_CD
        
        UNION ALL
        
        -- ITEM = T.VVD
        -- Perf. Ratio : perfRatioStr
        SELECT 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.VSL_LANE_CD
            , Y.CNTR_TPSZ_CD
            #if (${ratiovolflag} == 'R')
                ,MAX(DECODE(Y.FLAG, '3', VOL,  '')) / DECODE(MAX(DECODE(Y.FLAG, '1', VOL,  '')), 0, '', MAX(DECODE(Y.FLAG, '1', VOL,  ''))) VOL
                ,MAX(DECODE(Y.FLAG, '3', COST, '')) / DECODE(MAX(DECODE(Y.FLAG, '1', COST, '')), 0, '', MAX(DECODE(Y.FLAG, '1', COST, ''))) COST
            #else
                ,SUM(DECODE(Y.FLAG, '3', VOL,  '')) - SUM(DECODE(Y.FLAG, '1', VOL,  '')) PERF_RATIO_VOL
                ,SUM(DECODE(Y.FLAG, '3', COST, '')) - SUM(DECODE(Y.FLAG, '1', COST, '')) PERF_RATIO_COST
            #end
            , 'Perf. Ratio' DIV
            , '5' SORT
            , '2' SUMCNT
            , '${frequencycd}' FEED
        FROM (
            #if (${itemcd} == 'V')
                -- ITEM = T.VVD
                -- Plan ID 1_ONE : planStr1_one
                #if (${weekmonth} == '1')
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_WK  PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_YRWK
                #else
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_MON PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_MON
                #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST 
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                #if (${adherencecd} == 'O')
                    ,'ALL' TO_ECC_CD
                #else
                    ,(
                        SELECT ${dstviewby}
                        FROM EQR_ECC_MST 
                        WHERE TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY)  VOL
                    ,SUM(LODG_DCHG_COST_AMT)  COST
                    ,'1' FLAG
                -- Plan ID 1_TWO : planStr1_two
                FROM
                    EQR_VSL_LODG_DCHG_PLN A
                    ,EQR_VSL_LODG_DCHG_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #else
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1=1) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    AND TO_ECC_CD = D.ECC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND PAST_REPO_PLN_FLG NOT IN('Y')
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR (FM_ETD_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR (TO_ETB_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
                #if (${weekmonth} == '1')
                    GROUP BY A.FM_ETD_DT , TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #else
                    GROUP BY A.FM_ETD_DT , PLN_MON, TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #end
                
                UNION ALL
                
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
            #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
                -- ITEM = Rail(R), Truck(), Water(W)
                -- Plan ID 3_ONE : planStr3_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${dstviewby}
                            FROM EQR_ECC_MST
                            WHERE TO_ECC_CD = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(TRSP_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    -- Plan ID 1 : planDivStr
                    ,'1' FLAG
                -- Plan ID 23TWO : planStr3_two
                FROM
                    EQR_INLND_TRSP_PLN A
                    ,EQR_INLND_TRSP_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #end
                    #if (${weekmonth} != '1')
                        ,EQR_WK_PRD E
                    #end
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    #if (${adherencecd} == 'Z')
                        AND TO_ECC_CD = D.ECC_CD
                    #end
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${weekmonth} != '1')
                        AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #end
                    AND TRSP_MOD_CD = @[itemcd]
                    #if (${fmsyrwk} != '')
                        AND FM_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_YRWK BETWEEN @[tosyrwk] AND @[toeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = T.VVD not etc
                -- W/O 1_one : woStr1_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(repo_cost_amt) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
            #elseif (${itemcd} == 'O')
                -- ITEM = On-Hire(O)
                -- Plan ID 2_ONE => On-Hire : planStr2On_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => On-Hire : planStr2On_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) c
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #elseif (${itemcd} == 'F')
                -- ITEM = Off-Hire(F)
                -- Plan ID 2_ONE => Off-Hire : planStr2Off_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => Off-Hire : planStr2Off_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    , EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD  = 'F'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #end
        ) Y
        GROUP BY 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CNTR_TPSZ_CD
            , Y.VSL_LANE_CD
    #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
        -- ITEM = Rail(R), Truck(), Water(W)
        -- Plan ID 3_ONE : planStr3_one
        SELECT
            DISTINCT
            #if (${weekmonth} == '1')
                SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT ${orgviewby}
                FROM EQR_ECC_MST
                WHERE FM_ECC_CD = ECC_CD
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT ${dstviewby}
                    FROM EQR_ECC_MST
                    WHERE TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
            #end
            ,'' CO_CD
            ,TRSP_MOD_CD
            ,'' VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,SUM(CNTR_QTY) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    A.PLN_YRWK
                #else
                    PLN_MON
                #end
                , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
            ) VOL
            ,SUM(TRSP_COST_AMT) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    A.PLN_YRWK
                #else
                    PLN_MON
                #end
                , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
            ) COST
            -- Plan ID 1 : planDivStr
            ,'Plan' DIV
            ,'1' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- Plan ID 23TWO : planStr3_two
        FROM
            EQR_INLND_TRSP_PLN A
            ,EQR_INLND_TRSP_PLN_QTY Q
            ,(
                SELECT REPO_PLN_ID
                FROM EQR_EQ_REPO_PLN
                WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                UNION ALL
                SELECT REPO_PLN_ID
                FROM EQR_EQ_REPO_PLN
                WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
            ) B
            ,(
                SELECT ECC_CD
                FROM EQR_ECC_MST
                WHERE ${orgviewby} = @[orgcd]
            ) C
            #if (${adherencecd} == 'Z')
                ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
            #end
            #if (${weekmonth} != '1')
                ,EQR_WK_PRD E
            #end
        WHERE
            A.REPO_PLN_ID = Q.REPO_PLN_ID
            AND A.PLN_YRWK = Q.PLN_YRWK
            AND A.PLN_SEQ = Q.PLN_SEQ
            AND A.REPO_PLN_ID = B.REPO_PLN_ID
            AND FM_ECC_CD = C.ECC_CD
            #if (${adherencecd} == 'Z')
                AND TO_ECC_CD = D.ECC_CD
            #end
            #if (${weekmonth} == '1')
                AND A.PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            #if (${weekmonth} != '1')
                AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
            #end
            AND TRSP_MOD_CD = @[itemcd]
            #if (${fmsyrwk} != '')
                AND FM_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
            #end
            #if (${tosyrwk} != '')
                AND TO_YRWK BETWEEN @[tosyrwk] AND @[toeyrwk]
            #end
        
        UNION ALL
        
        -- ITEM = Rail(R), Truck(T), Water(W)
        -- Execultion 3 : exeStr3_one
        SELECT
            #if (${weekmonth} == '1')
                SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT B.${orgviewby}
                FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT B.${dstviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                ) TO_ECC_CD
            #end
            ,CO_CD
            ,TRSP_MOD_CD
            ,VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,CNTR_QTY VOL
            ,TRSP_COST_AMT COST
            ,'Execution' DIV
            ,'2' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- Execultion 3_TWO : exeStr3_two
        FROM
            EQR_INLND_TRSP_EXE_PLN A
            ,EQR_INLND_TRSP_EXE_PLN_QTY Q
            ,(
                SELECT SCC_CD
                FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
            ) C
            #if (${adherencecd} == 'Z')
                ,(
                    SELECT SCC_CD
                    FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                    WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                ) D
            #end
            ,EQR_WK_PRD E
        WHERE
            1=1
            AND A.REPO_PLN_ID = Q.REPO_PLN_ID
            AND A.PLN_YRWK = Q.PLN_YRWK
            AND A.PLN_SEQ = Q.PLN_SEQ
            AND A.REF_ID = Q.REF_ID
            AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
            #if (${adherencecd} == 'Z')
                AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
            #end
            AND TRSP_MOD_CD    = @[itemcd]
            #if ($arroddtpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                #foreach ($key in ${arroddtpszCd})
                    #if($velocityCount < $arroddtpszCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )
            #end
            AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
            #if (${weekmonth} == '1')
                AND A.PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            #if (${fmsyrwk} != '')
                AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
            #end
            #if (${tosyrwk} != '')
                AND TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
            #end
        
        UNION ALL
        
        -- ITEM = T.VVD not etc
        -- W/O 1_one : woStr1_one
        SELECT
            DISTINCT
            #if (${weekmonth} == '1')
                SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT B.${orgviewby}
                FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT B.${dstviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                ) TO_ECC_CD
            #end
            ,CO_CD
            ,SO_IF_DIV_CD TRSP_MOD_CD
            ,VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,COUNT(CNTR_TPSZ_CD) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    PLN_YRWK
                #else
                    PLN_MON
                #end
                , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
            ) VOL
            ,SUM(REPO_COST_AMT) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    PLN_YRWK
                #else
                    PLN_MON
                #end
                , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
            ) COST
            -- W/O 1 : woDivStr
            ,'W/O' DIV
            ,'3' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- W/O 3_TWO : woStr1_two
        FROM
            EQR_REPO_EXE_SO_IF A
            ,(
                SELECT SCC_CD
                FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
            ) C
            #if (${adherencecd} == 'Z')
                ,(
                    SELECT SCC_CD
                    FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                    WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                ) D
            #end
            ,EQR_WK_PRD E
        WHERE
            1=1
            AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
            #if (${adherencecd} == 'Z')
                AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
            #end
            AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
            #if (${weekmonth} == '1')
                AND PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            AND WO_EXE_FLG  = 'Y'
            AND SO_IF_DIV_CD   = @[itemcd]
            #if ($arroddtpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                #foreach ($key in ${arroddtpszCd})
                    #if($velocityCount < $arroddtpszCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )
            #end
        
        UNION ALL
        
        -- ITEM = T.VVD
        -- Adherence Ratio : adherencdStr
        SELECT 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.VSL_LANE_CD
            , Y.CNTR_TPSZ_CD
            #if (${ratiovolflag} == 'R')
                ,SUM(DECODE(Y.FLAG, '2', VOL,  '')) / DECODE(MAX(DECODE(Y.FLAG, '1', VOL,  '')), 0, '', MAX(DECODE(Y.FLAG, '1', VOL,  ''))) VOL
                ,SUM(DECODE(Y.FLAG, '2', COST, '')) / DECODE(MAX(DECODE(Y.FLAG, '1', COST, '')), 0, '', MAX(DECODE(Y.FLAG, '1', COST, ''))) COST
            #else
                ,MAX(DECODE(Y.FLAG, '1', VOL,  '')) - SUM(DECODE(Y.FLAG, '2', VOL,  '')) VOL
                ,MAX(DECODE(Y.FLAG, '1', COST, '')) - SUM(DECODE(Y.FLAG, '2', VOL,  '')) COST
            #end
            , 'Adherence' DIV
            , '4' SORT
            , '2' SUMCNT
            , '${frequencycd}' FEED
        FROM (
            #if (${itemcd} == 'V')
                -- ITEM = T.VVD
                -- Plan ID 1_ONE : planStr1_one
                #if (${weekmonth} == '1')
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_WK  PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_YRWK
                #else
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_MON PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_MON
                #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST 
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                #if (${adherencecd} == 'O')
                    ,'ALL' TO_ECC_CD
                #else
                    ,(
                        SELECT ${dstviewby}
                        FROM EQR_ECC_MST 
                        WHERE TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY)  VOL
                    ,SUM(LODG_DCHG_COST_AMT)  COST
                    ,'1' FLAG
                -- Plan ID 1_TWO : planStr1_two
                FROM
                    EQR_VSL_LODG_DCHG_PLN A
                    ,EQR_VSL_LODG_DCHG_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #else
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1=1) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    AND TO_ECC_CD = D.ECC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND PAST_REPO_PLN_FLG NOT IN('Y')
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR (FM_ETD_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR (TO_ETB_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
                #if (${weekmonth} == '1')
                    GROUP BY A.FM_ETD_DT , TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #else
                    GROUP BY A.FM_ETD_DT , PLN_MON, TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #end
                
                UNION ALL
                
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.fm_yd_cd ,0,5) = c.scc_cd
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
            #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
                -- ITEM = Rail(R), Truck(), Water(W)
                -- Plan ID 3_ONE : planStr3_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${dstviewby}
                            FROM EQR_ECC_MST
                            WHERE TO_ECC_CD = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(TRSP_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 23TWO : planStr3_two
                FROM
                    EQR_INLND_TRSP_PLN A
                    ,EQR_INLND_TRSP_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #end
                    #if (${weekmonth} != '1')
                        ,EQR_WK_PRD E
                    #end
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    #if (${adherencecd} == 'Z')
                        AND TO_ECC_CD = D.ECC_CD
                    #end
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${weekmonth} != '1')
                        AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #end
                    AND TRSP_MOD_CD = @[itemcd]
                    #if (${fmsyrwk} != '')
                        AND FM_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_YRWK BETWEEN @[tosyrwk] AND @[toeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = Rail(R), Truck(T), Water(W)
                -- Execultion 3 : exeStr3_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,TRSP_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 3_TWO : exeStr3_two
                FROM
                    EQR_INLND_TRSP_EXE_PLN A
                    ,EQR_INLND_TRSP_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND TRSP_MOD_CD    = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
            #elseif (${itemcd} == 'O')
                -- ITEM = On-Hire(O)
                -- Plan ID 2_ONE => On-Hire : planStr2On_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => On-Hire : planStr2On_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #elseif (${itemcd} == 'F')
                -- ITEM = Off-Hire(F)
                -- Plan ID 2_ONE => Off-Hire : planStr2Off_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => Off-Hire : planStr2Off_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) c
                    , EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD  = 'F'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                
                UNION ALL
                
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #end
        ) Y
        GROUP BY 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CNTR_TPSZ_CD
            , Y.VSL_LANE_CD
        
        UNION ALL
        
        -- ITEM = T.VVD
        -- W/O Issued Ratio : woIssuedStr
        SELECT 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.VSL_LANE_CD
            , Y.CNTR_TPSZ_CD
            #if (${ratiovolflag} == 'R')
                ,MAX(DECODE(Y.FLAG, '3', VOL,  '')) / DECODE(SUM(DECODE(Y.FLAG, '2', VOL,  '')), 0, '', SUM(DECODE(Y.FLAG, '2', VOL,  ''))) VOL
                ,MAX(DECODE(Y.FLAG, '3', COST, '')) / DECODE(SUM(DECODE(Y.FLAG, '2', COST, '')), 0, '', SUM(DECODE(Y.FLAG, '2', COST, ''))) COST
            #else
                ,SUM(DECODE(Y.FLAG, '2', VOL,  '')) - SUM(DECODE(Y.FLAG, '3', VOL,  '')) SO_ISSUED_VOL
                ,SUM(DECODE(Y.FLAG, '2', COST, '')) - SUM(DECODE(Y.FLAG, '3', COST, '')) SO_ISSUED_COST
            #end
            , 'W/O Ratio' DIV
            , '6' SORT
            , '2' SUMCNT
            , '${frequencycd}' FEED
        FROM (
            #if (${itemcd} == 'V')
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QYT Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
                
                UNION ALL
                
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
            #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
                -- ITEM = Rail(R), Truck(T), Water(W)
                -- Execultion 3 : exeStr3_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,TRSP_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 3_TWO : exeStr3_two
                FROM
                    EQR_INLND_TRSP_EXE_PLN A
                    ,EQR_INLND_TRSP_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND TRSP_MOD_CD    = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = T.VVD not etc
                -- W/O 1_one : woStr1_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
            #elseif (${itemcd} == 'O')
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- W/O 1_one : woStr1On_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1On_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #elseif (${itemcd} == 'F')
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = On-Hire(F)
                -- W/O 1_one : woStr1Off_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1Off_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD 
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B 
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = 'F'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #end
        ) Y
        GROUP BY 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CNTR_TPSZ_CD
            , Y.VSL_LANE_CD
        
        UNION ALL
        
        -- ITEM = T.VVD
        -- Perf. Ratio : perfRatioStr
        SELECT 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.VSL_LANE_CD
            , Y.CNTR_TPSZ_CD
            #if (${ratiovolflag} == 'R')
                ,MAX(DECODE(Y.FLAG, '3', VOL,  '')) / DECODE(MAX(DECODE(Y.FLAG, '1', VOL,  '')), 0, '', MAX(DECODE(Y.FLAG, '1', VOL,  ''))) VOL
                ,MAX(DECODE(Y.FLAG, '3', COST, '')) / DECODE(MAX(DECODE(Y.FLAG, '1', COST, '')), 0, '', MAX(DECODE(Y.FLAG, '1', COST, ''))) COST
            #else
                ,SUM(DECODE(Y.FLAG, '3', VOL,  '')) - SUM(DECODE(Y.FLAG, '1', VOL,  '')) PERF_RATIO_VOL
                ,SUM(DECODE(Y.FLAG, '3', COST, '')) - SUM(DECODE(Y.FLAG, '1', COST, '')) PERF_RATIO_COST
            #end
            , 'Perf. Ratio' DIV
            , '5' SORT
            , '2' SUMCNT
            , '${frequencycd}' FEED
        FROM (
            #if (${itemcd} == 'V')
                -- ITEM = T.VVD
                -- Plan ID 1_ONE : planStr1_one
                #if (${weekmonth} == '1')
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_WK  PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_YRWK
                #else
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_MON PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_MON
                #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST 
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                #if (${adherencecd} == 'O')
                    ,'ALL' TO_ECC_CD
                #else
                    ,(
                        SELECT ${dstviewby}
                        FROM EQR_ECC_MST 
                        WHERE TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY)  VOL
                    ,SUM(LODG_DCHG_COST_AMT)  COST
                    ,'1' FLAG
                -- Plan ID 1_TWO : planStr1_two
                FROM
                    EQR_VSL_LODG_DCHG_PLN A
                    ,EQR_VSL_LODG_DCHG_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #else
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1=1) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    AND TO_ECC_CD = D.ECC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND PAST_REPO_PLN_FLG NOT IN('Y')
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR (FM_ETD_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR (TO_ETB_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
                #if (${weekmonth} == '1')
                    GROUP BY A.FM_ETD_DT , TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #else
                    GROUP BY A.FM_ETD_DT , PLN_MON, TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #end
                
                UNION ALL
                
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
            #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
                -- ITEM = Rail(R), Truck(), Water(W)
                -- Plan ID 3_ONE : planStr3_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${dstviewby}
                            FROM EQR_ECC_MST
                            WHERE TO_ECC_CD = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(TRSP_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    -- Plan ID 1 : planDivStr
                    ,'1' FLAG
                -- Plan ID 23TWO : planStr3_two
                FROM
                    EQR_INLND_TRSP_PLN A
                    ,EQR_INLND_TRSP_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #end
                    #if (${weekmonth} != '1')
                        ,EQR_WK_PRD E
                    #end
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    #if (${adherencecd} == 'Z')
                        AND TO_ECC_CD = D.ECC_CD
                    #end
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${weekmonth} != '1')
                        AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #end
                    AND TRSP_MOD_CD = @[itemcd]
                    #if (${fmsyrwk} != '')
                        AND FM_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_YRWK BETWEEN @[tosyrwk] AND @[toeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = T.VVD not etc
                -- W/O 1_one : woStr1_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
            #elseif (${itemcd} == 'O')
                -- ITEM = On-Hire(O)
                -- Plan ID 2_ONE => On-Hire : planStr2On_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => On-Hire : planStr2On_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #elseif (${itemcd} == 'F')
                -- ITEM = Off-Hire(F)
                -- Plan ID 2_ONE => Off-Hire : planStr2Off_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => Off-Hire : planStr2Off_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    , EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD  = 'F'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #end
        ) Y
        GROUP BY 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CNTR_TPSZ_CD
            , Y.VSL_LANE_CD
    #elseif (${itemcd} == 'O')
        -- ITEM = On-Hire(O)
        -- Plan ID 2_ONE => On-Hire : planStr2On_one
        SELECT
            DISTINCT
            #if (${weekmonth} == '1')
                SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT ${orgviewby}
                FROM EQR_ECC_MST
                WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT ${orgviewby}
                    FROM EQR_ECC_MST
                    WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                ) TO_ECC_CD
            #end
            ,'' CO_CD
            ,ONF_HIR_DIV_CD TRSP_MOD_CD
            ,'' VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,SUM(CNTR_QTY) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    A.PLN_YRWK
                #else
                    PLN_MON
                #end
                , A.ECC_CD, CNTR_TPSZ_CD
            ) VOL
            ,SUM(ONF_HIR_COST_AMT) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    A.PLN_YRWK
                #else
                    PLN_MON
                #end
                , A.ECC_CD, CNTR_TPSZ_CD
            ) COST
            -- Plan ID 1 : planDivStr
            ,'Plan' DIV
            ,'1' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- Plan ID 2_TWO => On-Hire : planStr2On_two
        FROM
            EQR_ONF_HIR_PLN A
            ,EQR_ONF_HIR_PLN_QTY Q
            ,(
                SELECT REPO_PLN_ID
                FROM EQR_EQ_REPO_PLN
                WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                UNION ALL
                SELECT REPO_PLN_ID
                FROM EQR_EQ_REPO_PLN
                WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
            ) B
            ,(
                SELECT ECC_CD
                FROM EQR_ECC_MST
                WHERE ${orgviewby} = @[orgcd]
            ) C
            ,EQR_WK_PRD E
        WHERE
            A.REPO_PLN_ID = Q.REPO_PLN_ID
            AND A.PLN_YRWK = Q.PLN_YRWK
            AND A.PLN_SEQ = Q.PLN_SEQ
            AND A.REPO_PLN_ID = B.REPO_PLN_ID
            AND A.ECC_CD = C.ECC_CD
            #if (${weekmonth} == '1')
                AND A.PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
            AND ONF_HIR_DIV_CD = 'O'
            #if ($arroddtpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                #foreach ($key in ${arroddtpszCd})
                    #if($velocityCount < $arroddtpszCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )
            #end
            #if (${fmsyrwk} != '')
                AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
            #end
        
        UNION ALL
        
        -- ITEM = On-Hire(O)
        -- Execultion 2_ONE : exeStr2On_one
        SELECT
            #if (${weekmonth} == '1')
                SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT B.${orgviewby}
                FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT B.${orgviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                ) TO_ECC_CD
            #end
            ,CO_CD
            ,ONF_HIR_DIV_CD TRSP_MOD_CD
            ,'' VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,CNTR_QTY VOL
            ,ONF_HIR_COST_AMT COST
            ,'Execution' DIV
            ,'2' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- Execultion 1_TWO : exeStr2On_two
        FROM
            EQR_ONF_HIR_EXE_PLN A
            ,EQR_ONF_HIR_EXE_PLN_QTY Q
            ,(
                SELECT SCC_CD
                FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
            ) D
            ,EQR_WK_PRD E
        WHERE
            1=1
            AND A.REPO_PLN_ID = Q.REPO_PLN_ID
            AND A.PLN_YRWK = Q.PLN_YRWK
            AND A.PLN_SEQ = Q.PLN_SEQ
            AND A.REF_ID = Q.REF_ID
            AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
            AND ONF_HIR_DIV_CD = 'O'
            #if ($arroddtpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                #foreach ($key in ${arroddtpszCd})
                    #if($velocityCount < $arroddtpszCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )
            #end
            AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
            #if (${weekmonth} == '1')
                AND A.PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            #if (${fmsyrwk} != '')
                AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
            #end
        
        UNION ALL
        
        -- ITEM = On-Hire(O)
        -- W/O 1_one : woStr1On_one
        SELECT
            DISTINCT
            #if (${weekmonth} == '1')
                SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT B.${orgviewby}
                FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT B.${orgviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                ) TO_ECC_CD
            #end
            ,CO_CD
            ,SO_IF_DIV_CD TRSP_MOD_CD
            ,VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,COUNT(CNTR_TPSZ_CD) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    PLN_YRWK
                #else
                    PLN_MON
                #end
                , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
            ) VOL
            ,SUM(REPO_COST_AMT) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    PLN_YRWK
                #else
                    PLN_MON
                #end
                , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
            ) COST
            ,'W/O' DIV
            ,'3' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- W/O 3_TWO : woStr1On_two
        FROM
            EQR_REPO_EXE_SO_IF A
            ,(
                SELECT SCC_CD
                FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
            ) D
            ,EQR_WK_PRD E
        WHERE
            1=1
            AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
            AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
            #if (${weekmonth} == '1')
                AND PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            AND WO_EXE_FLG  = 'Y'
            AND SO_IF_DIV_CD   = 'O'
            #if ($arroddtpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                #foreach ($key in ${arroddtpszCd})
                    #if($velocityCount < $arroddtpszCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )
            #end
            #if (${fmsyrwk} != '')
                AND FM_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
            #end
        
        UNION ALL
        
        -- ITEM = On-Hire(O)
        -- Execultion 2_ONE : exeStr2On_one
        SELECT
            #if (${weekmonth} == '1')
                SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT B.${orgviewby}
                FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT B.${orgviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                ) TO_ECC_CD
            #end
            ,CO_CD
            ,ONF_HIR_DIV_CD TRSP_MOD_CD
            ,'' VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,CNTR_QTY VOL
            ,ONF_HIR_COST_AMT COST
            -- W/O 1 : WODIVSTR
            ,'W/O' DIV
            ,'3' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- Execultion 1_TWO : exeStr2On_two
        FROM
            EQR_ONF_HIR_EXE_PLN A
            ,EQR_ONF_HIR_EXE_PLN_QTY Q
            ,(
                SELECT SCC_CD
                FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
            ) D
            ,EQR_WK_PRD E
        WHERE
            1=1
            AND A.REPO_PLN_ID = Q.REPO_PLN_ID
            AND A.PLN_YRWK = Q.PLN_YRWK
            AND A.PLN_SEQ = Q.PLN_SEQ
            AND A.REF_ID = Q.REF_ID
            AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
            AND ONF_HIR_DIV_CD = 'O'
            #if ($arroddtpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                #foreach ($key in ${arroddtpszCd})
                    #if($velocityCount < $arroddtpszCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )
            #end
            AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
            #if (${weekmonth} == '1')
                AND A.PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            #if (${fmsyrwk} != '')
                AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
            #end
        
        UNION ALL
        
        -- ITEM = T.VVD
        -- Adherence Ratio : adherencdStr
        SELECT 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.VSL_LANE_CD
            , Y.CNTR_TPSZ_CD
            #if (${ratiovolflag} == 'R')
                ,SUM(DECODE(Y.FLAG, '2', VOL,  '')) / DECODE(MAX(DECODE(Y.FLAG, '1', VOL,  '')), 0, '', MAX(DECODE(Y.FLAG, '1', VOL,  ''))) VOL
                ,SUM(DECODE(Y.FLAG, '2', COST, '')) / DECODE(MAX(DECODE(Y.FLAG, '1', COST, '')), 0, '', MAX(DECODE(Y.FLAG, '1', COST, ''))) COST
            #else
                ,MAX(DECODE(Y.FLAG, '1', VOL,  '')) - SUM(DECODE(Y.FLAG, '2', VOL,  '')) VOL
                ,MAX(DECODE(Y.FLAG, '1', COST, '')) - SUM(DECODE(Y.FLAG, '2', VOL,  '')) COST
            #end
            , 'Adherence' DIV
            , '4' SORT
            , '2' SUMCNT
            , '${frequencycd}' FEED
        FROM (
            #if (${itemcd} == 'V')
                -- ITEM = T.VVD
                -- Plan ID 1_ONE : planStr1_one
                #if (${weekmonth} == '1')
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_WK  PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_YRWK
                #else
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_MON PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_MON
                #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST 
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                #if (${adherencecd} == 'O')
                    ,'ALL' TO_ECC_CD
                #else
                    ,(
                        SELECT ${dstviewby}
                        FROM EQR_ECC_MST 
                        WHERE TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY)  VOL
                    ,SUM(LODG_DCHG_COST_AMT)  COST
                    ,'1' FLAG
                -- Plan ID 1_TWO : planStr1_two
                FROM
                    EQR_VSL_LODG_DCHG_PLN A
                    ,EQR_VSL_LODG_DCHG_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #else
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1=1) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    AND TO_ECC_CD = D.ECC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND PAST_REPO_PLN_FLG NOT IN('Y')
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR (FM_ETD_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR (TO_ETB_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
                #if (${weekmonth} == '1')
                    GROUP BY A.FM_ETD_DT , TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #else
                    GROUP BY A.FM_ETD_DT , PLN_MON, TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #end
                
                UNION ALL
                
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
            #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
                -- ITEM = Rail(R), Truck(), Water(W)
                -- Plan ID 3_ONE : planStr3_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${dstviewby}
                            FROM EQR_ECC_MST
                            WHERE TO_ECC_CD = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(TRSP_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 23TWO : planStr3_two
                FROM
                    EQR_INLND_TRSP_PLN A
                    ,EQR_INLND_TRSP_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #end
                    #if (${weekmonth} != '1')
                        ,EQR_WK_PRD E
                    #end
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    #if (${adherencecd} == 'Z')
                        AND TO_ECC_CD = D.ECC_CD
                    #end
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${weekmonth} != '1')
                        AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #end
                    AND TRSP_MOD_CD = @[itemcd]
                    #if (${fmsyrwk} != '')
                        AND FM_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_YRWK BETWEEN @[tosyrwk] AND @[toeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = Rail(R), Truck(T), Water(W)
                -- Execultion 3 : exeStr3_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,TRSP_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 3_TWO : exeStr3_two
                FROM
                    EQR_INLND_TRSP_EXE_PLN A
                    ,EQR_INLND_TRSP_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND TRSP_MOD_CD    = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
            #elseif (${itemcd} == 'O')
                -- ITEM = On-Hire(O)
                -- Plan ID 2_ONE => On-Hire : planStr2On_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => On-Hire : planStr2On_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #elseif (${itemcd} == 'F')
                -- ITEM = Off-Hire(F)
                -- Plan ID 2_ONE => Off-Hire : planStr2Off_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => Off-Hire : planStr2Off_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    , EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD  = 'F'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                
                UNION ALL
                
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #end
        ) Y
        GROUP BY 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CNTR_TPSZ_CD
            , Y.VSL_LANE_CD
        
        UNION ALL
        
        -- ITEM = T.VVD
        -- W/O Issued Ratio : woIssuedStr
        SELECT 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.VSL_LANE_CD
            , Y.CNTR_TPSZ_CD
            #if (${ratiovolflag} == 'R')
                ,MAX(DECODE(Y.FLAG, '3', VOL,  '')) / DECODE(SUM(DECODE(Y.FLAG, '2', VOL,  '')), 0, '', SUM(DECODE(Y.FLAG, '2', VOL,  ''))) VOL
                ,MAX(DECODE(Y.FLAG, '3', COST, '')) / DECODE(SUM(DECODE(Y.FLAG, '2', COST, '')), 0, '', SUM(DECODE(Y.FLAG, '2', COST, ''))) COST
            #else
                ,SUM(DECODE(Y.FLAG, '2', VOL,  '')) - SUM(DECODE(Y.FLAG, '3', VOL,  '')) SO_ISSUED_VOL
                ,SUM(DECODE(Y.FLAG, '2', COST, '')) - SUM(DECODE(Y.FLAG, '3', COST, '')) SO_ISSUED_COST
            #end
            , 'W/O Ratio' DIV
            , '6' SORT
            , '2' SUMCNT
            , '${frequencycd}' FEED
        FROM (
            #if (${itemcd} == 'V')
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
                
                UNION ALL
                
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
            #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
                -- ITEM = Rail(R), Truck(T), Water(W)
                -- Execultion 3 : exeStr3_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,TRSP_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 3_TWO : exeStr3_two
                FROM
                    EQR_INLND_TRSP_EXE_PLN A
                    ,EQR_INLND_TRSP_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND TRSP_MOD_CD    = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = T.VVD not etc
                -- W/O 1_one : woStr1_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
            #elseif (${itemcd} == 'O')
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- W/O 1_one : woStr1On_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1On_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #elseif (${itemcd} == 'F')
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = On-Hire(F)
                -- W/O 1_one : woStr1Off_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1Off_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD 
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B 
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = 'F'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #end
        ) Y
        GROUP BY 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CNTR_TPSZ_CD
            , Y.VSL_LANE_CD
        
        UNION ALL
        
        -- ITEM = T.VVD
        -- Perf. Ratio : perfRatioStr
        SELECT 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.VSL_LANE_CD
            , Y.CNTR_TPSZ_CD
            #if (${ratiovolflag} == 'R')
                ,MAX(DECODE(Y.FLAG, '3', VOL,  '')) / DECODE(MAX(DECODE(Y.FLAG, '1', VOL,  '')), 0, '', MAX(DECODE(Y.FLAG, '1', VOL,  ''))) VOL
                ,MAX(DECODE(Y.FLAG, '3', COST, '')) / DECODE(MAX(DECODE(Y.FLAG, '1', COST, '')), 0, '', MAX(DECODE(Y.FLAG, '1', COST, ''))) COST
            #else
                ,SUM(DECODE(Y.FLAG, '3', VOL,  '')) - SUM(DECODE(Y.FLAG, '1', VOL,  '')) PERF_RATIO_VOL
                ,SUM(DECODE(Y.FLAG, '3', COST, '')) - SUM(DECODE(Y.FLAG, '1', COST, '')) PERF_RATIO_COST
            #end
            , 'Perf. Ratio' DIV
            , '5' SORT
            , '2' SUMCNT
            , '${frequencycd}' FEED
        FROM (
            #if (${itemcd} == 'V')
                -- ITEM = T.VVD
                -- Plan ID 1_ONE : planStr1_one
                #if (${weekmonth} == '1')
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_WK  PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_YRWK
                #else
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_MON PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_MON
                #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST 
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                #if (${adherencecd} == 'O')
                    ,'ALL' TO_ECC_CD
                #else
                    ,(
                        SELECT ${dstviewby}
                        FROM EQR_ECC_MST 
                        WHERE TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY)  VOL
                    ,SUM(LODG_DCHG_COST_AMT)  COST
                    ,'1' FLAG
                -- Plan ID 1_TWO : planStr1_two
                FROM
                    EQR_VSL_LODG_DCHG_PLN A
                    ,EQR_VSL_LODG_DCHG_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #else
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1=1) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    AND TO_ECC_CD = D.ECC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND PAST_REPO_PLN_FLG NOT IN('Y')
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR (FM_ETD_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR (TO_ETB_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
                #if (${weekmonth} == '1')
                    GROUP BY A.FM_ETD_DT , TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #else
                    GROUP BY A.FM_ETD_DT , PLN_MON, TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #end
                
                UNION ALL
                
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
            #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
                -- ITEM = Rail(R), Truck(), Water(W)
                -- Plan ID 3_ONE : planStr3_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${dstviewby}
                            FROM EQR_ECC_MST
                            WHERE TO_ECC_CD = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(TRSP_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    -- Plan ID 1 : planDivStr
                    ,'1' FLAG
                -- Plan ID 23TWO : planStr3_two
                FROM
                    EQR_INLND_TRSP_PLN A
                    ,EQR_INLND_TRSP_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #end
                    #if (${weekmonth} != '1')
                        ,EQR_WK_PRD E
                    #end
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    #if (${adherencecd} == 'Z')
                        AND TO_ECC_CD = D.ECC_CD
                    #end
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${weekmonth} != '1')
                        AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #end
                    AND TRSP_MOD_CD = @[itemcd]
                    #if (${fmsyrwk} != '')
                        AND FM_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_YRWK BETWEEN @[tosyrwk] AND @[toeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = T.VVD not etc
                -- W/O 1_one : woStr1_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
            #elseif (${itemcd} == 'O')
                -- ITEM = On-Hire(O)
                -- Plan ID 2_ONE => On-Hire : planStr2On_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => On-Hire : planStr2On_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #elseif (${itemcd} == 'F')
                -- ITEM = Off-Hire(F)
                -- Plan ID 2_ONE => Off-Hire : planStr2Off_one
                SELECT
                    distinct
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => Off-Hire : planStr2Off_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    , EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD  = 'F'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #end
        ) Y
        GROUP BY 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CNTR_TPSZ_CD
            , Y.VSL_LANE_CD
    #elseif (${itemcd} == 'F')
        -- ITEM = Off-Hire(F)
        -- Plan ID 2_ONE => Off-Hire : planStr2Off_one
        SELECT
            DISTINCT
            #if (${weekmonth} == '1')
                SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT ${orgviewby}
                FROM EQR_ECC_MST
                WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT ${orgviewby}
                    FROM EQR_ECC_MST
                    WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                ) TO_ECC_CD
            #end
            ,'' CO_CD
            ,ONF_HIR_DIV_CD TRSP_MOD_CD
            ,'' VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,SUM(CNTR_QTY) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    A.PLN_YRWK
                #else
                    PLN_MON
                #end
                , A.ECC_CD, CNTR_TPSZ_CD
            ) VOL
            ,SUM(ONF_HIR_COST_AMT) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    A.PLN_YRWK
                #else
                    PLN_MON
                #end
                , A.ECC_CD, CNTR_TPSZ_CD
            ) COST
            -- Plan ID 1 : planDivStr
            ,'Plan' DIV
            ,'1' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- Plan ID 2_TWO => Off-Hire : planStr2Off_two
        FROM
            EQR_ONF_HIR_PLN A
            ,EQR_ONF_HIR_PLN_QTY Q
            ,(
                SELECT REPO_PLN_ID
                FROM EQR_EQ_REPO_PLN
                WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                UNION ALL
                SELECT REPO_PLN_ID
                FROM EQR_EQ_REPO_PLN
                WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
            ) B
            ,(
                SELECT ECC_CD
                FROM EQR_ECC_MST
                WHERE ${orgviewby} = @[orgcd]
            ) C
            , EQR_WK_PRD E
        WHERE
            A.REPO_PLN_ID = Q.REPO_PLN_ID
            AND A.PLN_YRWK = Q.PLN_YRWK
            AND A.PLN_SEQ = Q.PLN_SEQ
            AND A.REPO_PLN_ID = B.REPO_PLN_ID
            AND A.ECC_CD = C.ECC_CD
            #if (${weekmonth} == '1')
                AND A.PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
            AND ONF_HIR_DIV_CD  = 'F'
            #if ($arroddtpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                #foreach ($key in ${arroddtpszCd})
                    #if($velocityCount < $arroddtpszCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )
            #end
            #if (${fmsyrwk} != '')
                AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
            #end
        
        UNION ALL
        
        -- ITEM = Off-Hire(F)
        -- Execultion 2_ONE : exeStr2Off_one
        SELECT
            #if (${weekmonth} == '1')
                SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT B.${orgviewby}
                FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT B.${orgviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                ) TO_ECC_CD
            #end
            ,CO_CD
            ,ONF_HIR_DIV_CD TRSP_MOD_CD
            ,'' VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,CNTR_QTY VOL
            ,ONF_HIR_COST_AMT COST
            ,'Execution' DIV
            ,'2' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- Execultion 1_TWO : exeStr2Off_two
        FROM
            EQR_ONF_HIR_EXE_PLN A
            ,EQR_ONF_HIR_EXE_PLN_QTY Q
            ,(
                SELECT SCC_CD
                FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
            ) C
            ,EQR_WK_PRD E
        WHERE
            1=1
            AND A.REPO_PLN_ID = Q.REPO_PLN_ID
            AND A.PLN_YRWK = Q.PLN_YRWK
            AND A.PLN_SEQ = Q.PLN_SEQ
            AND A.REF_ID = Q.REF_ID
            AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
            AND ONF_HIR_DIV_CD = @[itemcd]
            #if ($arroddtpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                #foreach ($key in ${arroddtpszCd})
                    #if($velocityCount < $arroddtpszCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )
            #end
            AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
            #if (${weekmonth} == '1')
                AND A.PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            #if (${fmsyrwk} != '')
                AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
            #end
        
        UNION ALL
        
        -- ITEM = On-Hire(F)
        -- W/O 1_one : woStr1Off_one
        SELECT
            DISTINCT
            #if (${weekmonth} == '1')
                SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT B.${orgviewby}
                FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT B.${orgviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                ) TO_ECC_CD
            #end
            ,CO_CD
            ,SO_IF_DIV_CD TRSP_MOD_CD
            ,VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,COUNT(CNTR_TPSZ_CD) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    PLN_YRWK
                #else
                    PLN_MON
                #end
                , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
            ) VOL
            ,SUM(REPO_COST_AMT) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    PLN_YRWK
                #else
                    PLN_MON
                #end
                , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
            ) COST
            ,'W/O' DIV
            ,'3' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- W/O 3_TWO : woStr1Off_two
        FROM
            EQR_REPO_EXE_SO_IF A
            ,(
                SELECT SCC_CD 
                FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B 
                WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
            ) C
            ,EQR_WK_PRD E
        WHERE
            1=1
            AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
            AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
            #if (${weekmonth} == '1')
                AND PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            AND WO_EXE_FLG  = 'Y'
            AND SO_IF_DIV_CD   = 'F'
            #if ($arroddtpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                #foreach ($key in ${arroddtpszCd})
                    #if($velocityCount < $arroddtpszCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )
            #end
            #if (${fmsyrwk} != '')
                AND FM_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
            #end
        
        UNION ALL
        
        -- ITEM = Off-Hire(O)
        -- Execultion 2_ONE : exeStr2On_one
        SELECT
            #if (${weekmonth} == '1')
                SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT B.${orgviewby}
                FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT B.${orgviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                ) TO_ECC_CD
            #end
            ,CO_CD
            ,ONF_HIR_DIV_CD TRSP_MOD_CD
            ,'' VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,CNTR_QTY VOL
            ,ONF_HIR_COST_AMT COST
            -- W/O 1 : woDivStr
            ,'W/O' DIV
            ,'3' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- Execultion 1_TWO : exeStr2On_two
        FROM
            EQR_ONF_HIR_EXE_PLN A
            ,EQR_ONF_HIR_EXE_PLN_QTY Q
            ,(
                SELECT SCC_CD
                FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
            ) D
            ,EQR_WK_PRD E
        WHERE
            1=1
            AND A.REPO_PLN_ID = Q.REPO_PLN_ID
            AND A.PLN_YRWK = Q.PLN_YRWK
            AND A.PLN_SEQ = Q.PLN_SEQ
            AND A.REF_ID = Q.REF_ID
            AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
            AND ONF_HIR_DIV_CD = 'F'
            #if ($arroddtpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                #foreach ($key in ${arroddtpszCd})
                    #if($velocityCount < $arroddtpszCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )
            #end
            AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
            #if (${weekmonth} == '1')
                AND A.PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            #if (${fmsyrwk} != '')
                AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
            #end
        
        UNION ALL
        
        -- ITEM = T.VVD
        -- Adherence Ratio : adherencdStr
        SELECT 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.VSL_LANE_CD
            , Y.CNTR_TPSZ_CD
            #if (${ratiovolflag} == 'R')
                ,SUM(DECODE(Y.FLAG, '2', VOL,  '')) / DECODE(MAX(DECODE(Y.FLAG, '1', VOL,  '')), 0, '', MAX(DECODE(Y.FLAG, '1', VOL,  ''))) VOL
                ,SUM(DECODE(Y.FLAG, '2', COST, '')) / DECODE(MAX(DECODE(Y.FLAG, '1', COST, '')), 0, '', MAX(DECODE(Y.FLAG, '1', COST, ''))) COST
            #else
                ,MAX(DECODE(Y.FLAG, '1', VOL,  '')) - SUM(DECODE(Y.FLAG, '2', VOL,  '')) VOL
                ,MAX(DECODE(Y.FLAG, '1', COST, '')) - SUM(DECODE(Y.FLAG, '2', VOL,  '')) COST
            #end
            , 'Adherence' DIV
            , '4' SORT
            , '2' SUMCNT
            , '${frequencycd}' FEED
        FROM (
            #if (${itemcd} == 'V')
                -- ITEM = T.VVD
                -- Plan ID 1_ONE : planStr1_one
                #if (${weekmonth} == '1')
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_WK  PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_YRWK
                #else
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_MON PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_MON
                #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST 
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                #if (${adherencecd} == 'O')
                    ,'ALL' TO_ECC_CD
                #else
                    ,(
                        SELECT ${dstviewby}
                        FROM EQR_ECC_MST 
                        WHERE TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY)  VOL
                    ,SUM(LODG_DCHG_COST_AMT)  COST
                    ,'1' FLAG
                -- Plan ID 1_TWO : planStr1_two
                FROM
                    EQR_VSL_LODG_DCHG_PLN A
                    ,EQR_VSL_LODG_DCHG_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #else
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1=1) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    AND TO_ECC_CD = D.ECC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND PAST_REPO_PLN_FLG NOT IN('Y')
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR (FM_ETD_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR (TO_ETB_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
                #if (${weekmonth} == '1')
                    GROUP BY A.FM_ETD_DT , TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #else
                    GROUP BY A.FM_ETD_DT , PLN_MON, TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #end
                
                UNION ALL
                
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
            #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
                -- ITEM = Rail(R), Truck(), Water(W)
                -- Plan ID 3_ONE : planStr3_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${dstviewby}
                            FROM EQR_ECC_MST
                            WHERE TO_ECC_CD = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(TRSP_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 23TWO : planStr3_two
                FROM
                    EQR_INLND_TRSP_PLN A
                    ,EQR_INLND_TRSP_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #end
                    #if (${weekmonth} != '1')
                        ,EQR_WK_PRD E
                    #end
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    #if (${adherencecd} == 'Z')
                        AND TO_ECC_CD = D.ECC_CD
                    #end
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${weekmonth} != '1')
                        AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #end
                    AND TRSP_MOD_CD = @[itemcd]
                    #if (${fmsyrwk} != '')
                        AND FM_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_YRWK BETWEEN @[tosyrwk] AND @[toeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = Rail(R), Truck(T), Water(W)
                -- Execultion 3 : exeStr3_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,TRSP_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 3_TWO : exeStr3_two
                FROM
                    EQR_INLND_TRSP_EXE_PLN A
                    ,EQR_INLND_TRSP_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND TRSP_MOD_CD    = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
            #elseif (${itemcd} == 'O')
                -- ITEM = On-Hire(O)
                -- Plan ID 2_ONE => On-Hire : planStr2On_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => On-Hire : planStr2On_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #elseif (${itemcd} == 'F')
                -- ITEM = Off-Hire(F)
                -- Plan ID 2_ONE => Off-Hire : planStr2Off_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(onf_hir_cost_amt) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => Off-Hire : planStr2Off_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    , EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD  = 'F'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                
                UNION ALL
                
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #end
        ) Y
        GROUP BY 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CNTR_TPSZ_CD
            , Y.VSL_LANE_CD
        
        UNION ALL
        
        -- ITEM = T.VVD
        -- W/O Issued Ratio : woIssuedStr
        SELECT 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.VSL_LANE_CD
            , Y.CNTR_TPSZ_CD
            #if (${ratiovolflag} == 'R')
                ,MAX(DECODE(Y.FLAG, '3', VOL,  '')) / DECODE(SUM(DECODE(Y.FLAG, '2', VOL,  '')), 0, '', SUM(DECODE(Y.FLAG, '2', VOL,  ''))) VOL
                ,MAX(DECODE(Y.FLAG, '3', COST, '')) / DECODE(SUM(DECODE(Y.FLAG, '2', COST, '')), 0, '', SUM(DECODE(Y.FLAG, '2', COST, ''))) COST
            #else
                ,SUM(DECODE(Y.FLAG, '2', VOL,  '')) - SUM(DECODE(Y.FLAG, '3', VOL,  '')) SO_ISSUED_VOL
                ,SUM(DECODE(Y.FLAG, '2', COST, '')) - SUM(DECODE(Y.FLAG, '3', COST, '')) SO_ISSUED_COST
            #end
            , 'W/O Ratio' DIV
            , '6' SORT
            , '2' SUMCNT
            , '${frequencycd}' FEED
        FROM (
            #if (${itemcd} == 'V')
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'2' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
                
                UNION ALL
                
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
            #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
                -- ITEM = Rail(R), Truck(T), Water(W)
                -- Execultion 3 : exeStr3_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,TRSP_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 3_TWO : exeStr3_two
                FROM
                    EQR_INLND_TRSP_EXE_PLN A
                    ,EQR_INLND_TRSP_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND TRSP_MOD_CD    = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = T.VVD not etc
                -- W/O 1_one : woStr1_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
            #elseif (${itemcd} == 'O')
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- W/O 1_one : woStr1On_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1On_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #elseif (${itemcd} == 'F')
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'2' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = On-Hire(F)
                -- W/O 1_one : woStr1Off_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1Off_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD 
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B 
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = 'F'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    
                UNION ALL
                
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #end
        ) Y
        GROUP BY 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CNTR_TPSZ_CD
            , Y.VSL_LANE_CD
        
        UNION ALL
        
        -- ITEM = T.VVD
        -- Perf. Ratio : perfRatioStr
        SELECT 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.VSL_LANE_CD
            , Y.CNTR_TPSZ_CD
            #if (${ratiovolflag} == 'R')
                ,MAX(DECODE(Y.FLAG, '3', VOL,  '')) / DECODE(MAX(DECODE(Y.FLAG, '1', VOL,  '')), 0, '', MAX(DECODE(Y.FLAG, '1', VOL,  ''))) VOL
                ,MAX(DECODE(Y.FLAG, '3', COST, '')) / DECODE(MAX(DECODE(Y.FLAG, '1', COST, '')), 0, '', MAX(DECODE(Y.FLAG, '1', COST, ''))) COST
            #else
                ,SUM(DECODE(Y.FLAG, '3', VOL,  '')) - SUM(DECODE(Y.FLAG, '1', VOL,  '')) PERF_RATIO_VOL
                ,SUM(DECODE(Y.FLAG, '3', COST, '')) - SUM(DECODE(Y.FLAG, '1', COST, '')) PERF_RATIO_COST
            #end
            , 'Perf. Ratio' DIV
            , '5' SORT
            , '2' SUMCNT
            , '${frequencycd}' FEED
        FROM (
            #if (${itemcd} == 'V')
                -- ITEM = T.VVD
                -- Plan ID 1_ONE : planStr1_one
                #if (${weekmonth} == '1')
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_WK  PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_YRWK
                #else
                    SELECT 
                    (
                        SELECT PLN_YR||'-'||PLN_MON PLN_YRWK 
                        FROM EQR_WK_PRD 
                        WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT 
                    )  PLN_MON
                #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST 
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                #if (${adherencecd} == 'O')
                    ,'ALL' TO_ECC_CD
                #else
                    ,(
                        SELECT ${dstviewby}
                        FROM EQR_ECC_MST 
                        WHERE TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY)  VOL
                    ,SUM(LODG_DCHG_COST_AMT)  COST
                    ,'1' FLAG
                -- Plan ID 1_TWO : planStr1_two
                FROM
                    EQR_VSL_LODG_DCHG_PLN A
                    ,EQR_VSL_LODG_DCHG_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #else
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1=1) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    AND TO_ECC_CD = D.ECC_CD
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND PAST_REPO_PLN_FLG NOT IN('Y')
                    #if (${fmsyrwk} != '')
                        AND TO_CHAR (FM_ETD_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_CHAR (TO_ETB_DT, 'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                    #end
                #if (${weekmonth} == '1')
                    GROUP BY A.FM_ETD_DT , TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #else
                    GROUP BY A.FM_ETD_DT , PLN_MON, TRSP_MOD_CD,  FM_ECC_CD , TO_ECC_CD, VSL_LANE_CD, CNTR_TPSZ_CD
                #end
                
                UNION ALL
                
                #if (${adherencecd} == 'O')
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(A.FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,'ALL' TO_ECC_CD
                        ,A.CO_CD
                        ,A.TRSP_MOD_CD
                        ,A.VSL_LANE_CD
                        ,A.CNTR_TPSZ_CD
                        ,B.CNTR_QTY VOL
                        ,A.LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        (
                            SELECT
                                A.PLN_YRWK
                                , A.CO_CD
                                , A.TRSP_MOD_CD
                                , A.VSL_LANE_CD
                                , A.VSL_CD
                                , A.SKD_VOY_NO
                                , A.SKD_DIR_CD
                                , A.FM_YD_CD
                                , A.FM_ETD_DT
                                , A.TO_YD_CD
                                , A.TO_ETB_DT
                                , A.EQ_REPO_PURP_CD
                                , A.REPO_MTY_BKG_FLG
                                , A.REPO_PLN_FB_RSN_CD
                                , A.REPO_PLN_FB_RMK
                                , A.MTY_BKG_NO
                                , A.SPLIT_REPO_PLN_FLG
                                , A.PAST_REPO_PLN_FLG
                                , Q.CNTR_TPSZ_CD
                                , Q.CNTR_QTY
                                , Q.LODG_DCHG_COST_AMT
                                , Q.PLN_UC_AMT
                                , Q.LODG_PORT_UC_AMT
                                , Q.DCHG_PORT_UC_AMT
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A
                                , EQR_VSL_EXE_PLN_QTY Q
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                        ) A
                        ,(
                            -- original booking vol 집계
                            SELECT
                                DISTINCT A.MTY_BKG_NO
                                ,Q.CNTR_TPSZ_CD
                                ,SUM(Q.CNTR_QTY) CNTR_QTY
                            FROM
                                EQR_VSL_LODG_DCHG_EXE_PLN A,
                                EQR_VSL_EXE_PLN_QTY Q,
                                (
                                    SELECT
                                        DISTINCT MTY_BKG_NO
                                    FROM
                                        EQR_VSL_LODG_DCHG_EXE_PLN A,
                                        (
                                            SELECT SCC_CD
                                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                                        ) C
                                    WHERE
                                        A.REPO_MTY_BKG_FLG = 'Y'
                                        AND   TRIM(A.MTY_BKG_NO) IS NOT NULL
                                        AND SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                                        #if (${weekmonth} == '1')
                                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #else
                                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                                        #end
                                        #if (${fmsyrwk} != '')
                                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                                        #end
                                        #if (${tosyrwk} != '')
                                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                                        #end
                                ) B
                            WHERE
                                A.REPO_PLN_ID = Q.REPO_PLN_ID
                                AND A.PLN_YRWK = Q.PLN_YRWK
                                AND A.PLN_SEQ = Q.PLN_SEQ
                                AND A.REF_ID = Q.REF_ID
                                AND A.MTY_BKG_NO = B.MTY_BKG_NO
                            GROUP BY
                                A.MTY_BKG_NO ,Q.CNTR_TPSZ_CD
                        ) B
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                    WHERE
                        A.MTY_BKG_NO   = B.MTY_BKG_NO(+)
                        AND   A.MTY_BKG_NO IS NOT NULL
                        AND   A.SPLIT_REPO_PLN_FLG = 'N'  -- 매우중요
                        AND   A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)
                        AND   SUBSTR(A.FM_YD_CD ,0,5) = C.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        #if ($arroddtpszCd.size() > 0)
                            AND A.CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(A.FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(A.TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #else
                    -- ITEM = T.VVD
                    -- Execultion 1_ONE : exeStr1_one
                    #if (${weekmonth} == '1')
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_WK PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_YRWK
                    #else
                        SELECT
                        (
                            SELECT PLN_YR||'-'||PLN_MON PLN_YRWK
                            FROM EQR_WK_PRD
                            WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT
                        )  PLN_MON
                    #end
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) FM_ECC_CD
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                        ,CO_CD
                        ,TRSP_MOD_CD
                        ,VSL_LANE_CD
                        ,CNTR_TPSZ_CD
                        ,CNTR_QTY VOL
                        ,LODG_DCHG_COST_AMT COST
                        ,'3' FLAG
                    FROM
                        EQR_VSL_LODG_DCHG_EXE_PLN A
                        ,EQR_VSL_EXE_PLN_QTY Q
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                        ) C
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    WHERE
                        1=1
                        AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                        AND A.PLN_YRWK = Q.PLN_YRWK
                        AND A.PLN_SEQ = Q.PLN_SEQ
                        AND A.REF_ID = Q.REF_ID
                        AND A.MTY_BKG_NO IS NOT NULL
                        AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                        #if (${weekmonth} == '1')
                            AND (SELECT PLN_YR||PLN_WK  FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #else
                            AND (SELECT PLN_YR||PLN_MON FROM EQR_WK_PRD WHERE TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT ) = @[plnYrWk]
                        #end
                        AND TRSP_MOD_CD = 'V'
                        #if ($arroddtpszCd.size() > 0)
                            AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arroddtpszCd})
                                #if($velocityCount < $arroddtpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )
                        #end
                        #if (${fmsyrwk} != '')
                            AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                        #end
                        #if (${tosyrwk} != '')
                            AND TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk]) AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
                        #end
                #end
            #elseif (${itemcd} == 'W' || ${itemcd} == 'R' || ${itemcd} == 'T')
                -- ITEM = Rail(R), Truck(), Water(W)
                -- Plan ID 3_ONE : planStr3_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${dstviewby}
                            FROM EQR_ECC_MST
                            WHERE TO_ECC_CD = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(TRSP_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , FM_ECC_CD, TO_ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    -- Plan ID 1 : planDivStr
                    ,'1' FLAG
                -- Plan ID 23TWO : planStr3_two
                FROM
                    EQR_INLND_TRSP_PLN A
                    ,EQR_INLND_TRSP_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[toeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE ${dstviewby} = @[dstcd] ) D
                    #end
                    #if (${weekmonth} != '1')
                        ,EQR_WK_PRD E
                    #end
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND FM_ECC_CD = C.ECC_CD
                    #if (${adherencecd} == 'Z')
                        AND TO_ECC_CD = D.ECC_CD
                    #end
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${weekmonth} != '1')
                        AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #end
                    AND TRSP_MOD_CD = @[itemcd]
                    #if (${fmsyrwk} != '')
                        AND FM_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    #if (${tosyrwk} != '')
                        AND TO_YRWK BETWEEN @[tosyrwk] AND @[toeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = T.VVD not etc
                -- W/O 1_one : woStr1_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${dstviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,SO_IF_DIV_CD TRSP_MOD_CD
                    ,VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,COUNT(CNTR_TPSZ_CD) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(REPO_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
                    ) COST
                    ,'3' FLAG
                -- W/O 3_TWO : woStr1_two
                FROM
                    EQR_REPO_EXE_SO_IF A
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    #if (${adherencecd} == 'Z')
                        ,(
                            SELECT SCC_CD
                            FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                            WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                        ) D
                    #end
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    #if (${adherencecd} == 'Z')
                        AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND WO_EXE_FLG  = 'Y'
                    AND SO_IF_DIV_CD   = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
            #elseif (${itemcd} == 'O')
                -- ITEM = On-Hire(O)
                -- Plan ID 2_ONE => On-Hire : planStr2On_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'O', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => On-Hire : planStr2On_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = On-Hire(O)
                -- Execultion 2_ONE : exeStr2On_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2On_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) D
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
                    AND ONF_HIR_DIV_CD = 'O'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #elseif (${itemcd} == 'F')
                -- ITEM = Off-Hire(F)
                -- Plan ID 2_ONE => Off-Hire : planStr2Off_one
                SELECT
                    DISTINCT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT ${orgviewby}
                        FROM EQR_ECC_MST
                        WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT ${orgviewby}
                            FROM EQR_ECC_MST
                            WHERE DECODE(ONF_HIR_DIV_CD , 'F', A.ECC_CD) = ECC_CD
                        ) TO_ECC_CD
                    #end
                    ,'' CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,SUM(CNTR_QTY) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) VOL
                    ,SUM(ONF_HIR_COST_AMT) OVER (
                        PARTITION BY
                        #if (${weekmonth} == '1')
                            A.PLN_YRWK
                        #else
                            PLN_MON
                        #end
                        , A.ECC_CD, CNTR_TPSZ_CD
                    ) COST
                    ,'1' FLAG
                -- Plan ID 2_TWO => Off-Hire : planStr2Off_two
                FROM
                    EQR_ONF_HIR_PLN A
                    ,EQR_ONF_HIR_PLN_QTY Q
                    ,(
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                        UNION ALL
                        SELECT REPO_PLN_ID
                        FROM EQR_EQ_REPO_PLN
                        WHERE REPO_PLN_DTRB_FLG = 'Y' AND SUBSTR(REPO_PLN_ID ,5,6) = @[beforePlnSYrWk]
                    ) B
                    ,(
                        SELECT ECC_CD
                        FROM EQR_ECC_MST
                        WHERE ${orgviewby} = @[orgcd]
                    ) C
                    , EQR_WK_PRD E
                WHERE
                    A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.ECC_CD = C.ECC_CD
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    AND E.PLN_YR || E.PLN_WK = A.PLN_YRWK
                    AND ONF_HIR_DIV_CD  = 'F'
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    #if (${fmsyrwk} != '')
                        AND A.PLN_YRWK BETWEEN @[fmsyrwk] AND @[fmeyrwk]
                    #end
                    
                UNION ALL
                
                -- ITEM = Off-Hire(F)
                -- Execultion 2_ONE : exeStr2Off_one
                SELECT
                    #if (${weekmonth} == '1')
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
                    #else
                        SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
                    #end
                    ,(
                        SELECT B.${orgviewby}
                        FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                        WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                    ) FM_ECC_CD
                    #if (${adherencecd} == 'O')
                        ,'ALL' TO_ECC_CD
                    #else
                        ,(
                            SELECT B.${orgviewby}
                            FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                            WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
                        ) TO_ECC_CD
                    #end
                    ,CO_CD
                    ,ONF_HIR_DIV_CD TRSP_MOD_CD
                    ,'' VSL_LANE_CD
                    ,CNTR_TPSZ_CD
                    ,CNTR_QTY VOL
                    ,ONF_HIR_COST_AMT COST
                    ,'3' FLAG
                -- Execultion 1_TWO : exeStr2Off_two
                FROM
                    EQR_ONF_HIR_EXE_PLN A
                    ,EQR_ONF_HIR_EXE_PLN_QTY Q
                    ,(
                        SELECT SCC_CD
                        FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                        WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
                    ) C
                    ,EQR_WK_PRD E
                WHERE
                    1=1
                    AND A.REPO_PLN_ID = Q.REPO_PLN_ID
                    AND A.PLN_YRWK = Q.PLN_YRWK
                    AND A.PLN_SEQ = Q.PLN_SEQ
                    AND A.REF_ID = Q.REF_ID
                    AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
                    AND ONF_HIR_DIV_CD = @[itemcd]
                    #if ($arroddtpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arroddtpszCd})
                            #if($velocityCount < $arroddtpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                        )
                    #end
                    AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
                    #if (${weekmonth} == '1')
                        AND A.PLN_YRWK = @[plnYrWk]
                    #else
                        AND PLN_YR||PLN_MON = @[plnYrWk]
                    #end
                    #if (${fmsyrwk} != '')
                        AND FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                        AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
                    #end
            #end
        ) Y
        GROUP BY 
            Y.
            #if (${weekmonth} == '1')
                PLN_YRWK
            #else
                PLN_MON
            #end
            , Y.CO_CD
            , Y.TRSP_MOD_CD
            , Y.FM_ECC_CD
            , Y.TO_ECC_CD
            , Y.CNTR_TPSZ_CD
            , Y.VSL_LANE_CD
    #elseif (${itemcd} == 'S')
        -- ITEM = Shuttle(S)
        -- Execultion 4 : exeStr4_one
        SELECT
            DISTINCT
            #if (${weekmonth} == '1')
                SUBSTR(A.PLN_YRWK,0,4)||'-'||SUBSTR(A.PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(A.PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT B.${orgviewby}
                FROM MDM_EQ_ORZ_CHT B
                WHERE B.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT B.${dstviewby}
                    FROM MDM_EQ_ORZ_CHT B
                    WHERE B.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                ) TO_ECC_CD
            #end
            ,CO_CD
            ,'S' TRSP_MOD_CD
            ,'' VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,SUM (CNTR_QTY) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    A.PLN_YRWK
                #else
                    PLN_MON
                #end
                , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
            ) VOL
            ,SUM (TRSP_COST_AMT) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    A.PLN_YRWK
                #else
                    PLN_MON
                #end
                , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
            ) COST
            ,'Execution' DIV
            ,'2' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- Execultion 3_TWO : exeStr4_two
        FROM
            EQR_ECC_INTER_EXE_PLN A
            ,EQR_ECC_INTER_EXE_PLN_QTY Q
            ,(
                SELECT SCC_CD
                FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
            ) C
            #if (${adherencecd} == 'Z')
                ,(
                    SELECT SCC_CD
                    FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                    WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                ) D
            #end
            ,EQR_WK_PRD E
        WHERE
            1=1
            AND A.REPO_PLN_ID = Q.REPO_PLN_ID
            AND A.PLN_YRWK = Q.PLN_YRWK
            AND A.REF_ID = Q.REF_ID
            AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
            #if (${adherencecd} == 'Z')
                AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
            #end
            AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
            #if (${weekmonth} == '1')
                AND A.PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            #if (${fmsyrwk} != '')
                AND TO_CHAR(FM_ETD_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmsyrwk])
                AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fmeyrwk])
            #end
            #if (${tosyrwk} != '')
                AND TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[tosyrwk])
                AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[toeyrwk])
            #end
        
        UNION ALL
        
        -- ITEM = T.VVD not etc
        -- W/O 1_one : woStr1_one
        SELECT
            DISTINCT
            #if (${weekmonth} == '1')
                SUBSTR(PLN_YRWK,0,4)||'-'||SUBSTR(PLN_YRWK,5,6) PLN_YRWK
            #else
                SUBSTR(PLN_YRWK,0,4)||'-'||PLN_MON PLN_MON
            #end
            ,(
                SELECT B.${orgviewby}
                FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(FM_YD_CD ,0,5)
            ) FM_ECC_CD
            #if (${adherencecd} == 'O')
                ,'ALL' TO_ECC_CD
            #else
                ,(
                    SELECT B.${dstviewby}
                    FROM EQR_ECC_MST B, MDM_EQ_ORZ_CHT C
                    WHERE B.ECC_CD = C.ECC_CD AND C.SCC_CD = SUBSTR(TO_YD_CD ,0,5)
                ) TO_ECC_CD
            #end
            ,CO_CD
            ,SO_IF_DIV_CD TRSP_MOD_CD
            ,VSL_LANE_CD
            ,CNTR_TPSZ_CD
            ,COUNT(CNTR_TPSZ_CD) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    PLN_YRWK
                #else
                    PLN_MON
                #end
                , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
            ) VOL
            ,SUM(REPO_COST_AMT) OVER (
                PARTITION BY
                #if (${weekmonth} == '1')
                    PLN_YRWK
                #else
                    PLN_MON
                #end
                , CO_CD, SUBSTR(FM_YD_CD ,0,5), SUBSTR(TO_YD_CD ,0,5), CNTR_TPSZ_CD
            ) COST
            -- W/O 1 : woDivStr
            ,'W/O' DIV
            ,'3' SORT
            ,'1' SUMCNT
            ,'${frequencycd}' FEED
        -- W/O 3_TWO : woStr1_two
        FROM
            EQR_REPO_EXE_SO_IF A
            ,(
                SELECT SCC_CD
                FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                WHERE A.ECC_CD = B.ECC_CD AND B.${orgviewby} = @[orgcd]
            ) C
            #if (${adherencecd} == 'Z')
                ,(
                    SELECT SCC_CD
                    FROM EQR_ECC_MST A, MDM_EQ_ORZ_CHT B
                    WHERE A.ECC_CD = B.ECC_CD AND B.${dstviewby} = @[dstcd]
                ) D
            #end
            ,EQR_WK_PRD E
        WHERE
            1=1
            AND SUBSTR(FM_YD_CD ,0,5) = C.SCC_CD
            #if (${adherencecd} == 'Z')
                AND SUBSTR(TO_YD_CD ,0,5) = D.SCC_CD
            #end
            AND A.PLN_YRWK = E.PLN_YR || E.PLN_WK
            #if (${weekmonth} == '1')
                AND PLN_YRWK = @[plnYrWk]
            #else
                AND PLN_YR||PLN_MON = @[plnYrWk]
            #end
            AND WO_EXE_FLG  = 'Y'
            AND SO_IF_DIV_CD   = @[itemcd]
            #if ($arroddtpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                #foreach ($key in ${arroddtpszCd})
                    #if($velocityCount < $arroddtpszCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )
            #end
    #end
)X
GROUP BY
    X.
    #if (${weekmonth} == '1')
        PLN_YRWK
    #else
        PLN_MON
    #end
    #if (${itemcd} == 'O')
        , TO_ECC_CD
    #elseif (${itemcd} == 'F')
        , FM_ECC_CD
    #else
        , FM_ECC_CD, TO_ECC_CD
    #end
    , CO_CD
    , X.TRSP_MOD_CD
    , X.DIV
    , X.SORT
    , X.SUMCNT
    , X.VSL_LANE_CD
ORDER BY
    X.
    #if (${weekmonth} == '1')
        PLN_YRWK
    #else
        PLN_MON
    #end
    , CO_CD
    , X.TRSP_MOD_CD
    , X.VSL_LANE_CD
    , X.SORT			]]></sql>
			<params>
				<param name="fmsyrwk" type="12" value="" out="N"/>
				<param name="toeyrwk" type="12" value="" out="N"/>
				<param name="beforePlnSYrWk" type="12" value="" out="N"/>
				<param name="orgcd" type="12" value="" out="N"/>
				<param name="dstcd" type="12" value="" out="N"/>
				<param name="plnYrWk" type="12" value="" out="N"/>
				<param name="fmeyrwk" type="12" value="" out="N"/>
				<param name="tosyrwk" type="12" value="" out="N"/>
				<param name="itemcd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
