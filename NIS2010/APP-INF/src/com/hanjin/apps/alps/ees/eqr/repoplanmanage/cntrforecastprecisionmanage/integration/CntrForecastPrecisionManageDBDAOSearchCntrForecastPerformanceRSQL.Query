<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CntrForecastPrecisionManageDBDAOSearchCntrForecastPerformanceRSQL">
			<desc><![CDATA[<EES_EQR_0037 컨테이너 수급 예측실적 및 정확도 조회>
Forecast Performance & Match Ratio   데이터 조회

<Change History>
1	2009.10.15	Lee ByoungHun	최초작성]]></desc>
			<sql><![CDATA[
#if (${dataselect2} == '')
    #if (${weekmonth} == 'W')
        SELECT
            WEEK
            , COMPANY CO_CD
            , DIV
            , FM_ECC_CD
            , TO_ECC_CD
            , SUM(TOTAL) TOTAL
            #foreach ($key in ${arrCntrTpszCd})
                , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_QTY
            #end
            , SEQ
        FROM  (
    #else
        #if (${dataselect1} != '' && ${dataselect2} != '')
            #if (${orgdst} == 'FM')
                SELECT
                    WEEK
                    , COMPANY
                    , DIV
                    , FM_ECC_CD
                    , '' TO_ECC_CD
                    , SUM(TOTAL) TOTAL
                    #foreach ($key in ${arrCntrTpszCd})
                        , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                    #end
                    , SEQ
                FROM  (
            #elseif (${orgdst} == 'TO')
                SELECT
                    WEEK
                    , COMPANY
                    , DIV
                    , '' FM_ECC_CD
                    , TO_ECC_CD
                    , SUM(TOTAL) TOTAL
                    #foreach ($key in ${arrCntrTpszCd})
                        , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                    #end
                    , SEQ
                FROM  (
            #elseif (${orgdst} == 'FMTO')
                SELECT
                    WEEK
                    , COMPANY
                    , DIV
                    , FM_ECC_CD
                    , TO_ECC_CD
                    , SUM(TOTAL) TOTAL
                    #foreach ($key in ${arrCntrTpszCd})
                        , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                    #end
                    , SEQ
                FROM  (
            #end
        #elseif (${dataselect1} == 'P' && ${dataselect2} == '')
            #if (${orgdst} == 'FM')
                SELECT
                    WEEK
                    , COMPANY
                    , DIV
                    , FM_ECC_CD
                    , '' TO_ECC_CD
                    , SUM(TOTAL) TOTAL
                    #foreach ($key in ${arrCntrTpszCd})
                        , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                    #end
                    , SEQ
                FROM  (
            #elseif (${orgdst} == 'TO')
                SELECT
                    WEEK
                    , COMPANY
                    , DIV
                    , '' FM_ECC_CD
                    , TO_ECC_CD
                    , SUM(TOTAL) TOTAL
                    #foreach ($key in ${arrCntrTpszCd})
                        , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                    #end
                    , SEQ
                FROM  (
            #elseif (${orgdst} == 'FMTO')
                SELECT
                    WEEK
                    , COMPANY
                    , DIV
                    , FM_ECC_CD
                    , TO_ECC_CD
                    , SUM(TOTAL) TOTAL
                    #foreach ($key in ${arrCntrTpszCd})
                        , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                    #end
                    , SEQ
                FROM  (
            #end
        #elseif (${dataselect1} != 'P' && ${dataselect2} == '')
            SELECT
                WEEK
                , COMPANY
                , DIV
                , FM_ECC_CD
                , '' TO_ECC_CD
                , SUM(TOTAL) TOTAL
                #foreach ($key in ${arrCntrTpszCd})
                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                #end
                , SEQ
            FROM  (
        #end
    #end
    ------4wk union all 의 최외곽 START
    #foreach ($key in ${arrWkResult})
        #if (${weekmonth} == 'W')
            SELECT
                WEEK
                , COMPANY
                , DIV
                , FM_ECC_CD
                , TO_ECC_CD
                , SUM(TOTAL) TOTAL
                #foreach ($key in ${arrCntrTpszCd})
                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                #end
                , SEQ
            FROM  (
        #else
            #if (${dataselect1} != '' && ${dataselect2} != '')
                #if (${orgdst} == 'FM')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , FM_ECC_CD
                        , '' TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #elseif (${orgdst} == 'TO')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , '' FM_ECC_CD
                        , TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #elseif (${orgdst} == 'FMTO')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , FM_ECC_CD
                        , TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #end
            #elseif (${dataselect1} == 'P' && ${dataselect2} == '')
                #if (${orgdst} == 'FM')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , FM_ECC_CD
                        , '' TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #elseif (${orgdst} == 'TO')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , '' FM_ECC_CD
                        , TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #elseif (${orgdst} == 'FMTO')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , FM_ECC_CD
                        , TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #end
            #elseif (${dataselect1} != 'P' && ${dataselect2} == '')
                SELECT
                    WEEK
                    , COMPANY
                    , DIV
                    , FM_ECC_CD
                    , '' TO_ECC_CD
                    , SUM(TOTAL) TOTAL
                    #foreach ($key in ${arrCntrTpszCd})
                        , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                    #end
                    , SEQ
                FROM  (
            #end
        #end
        #if (${dataselect1} == 'P')
            #if (${weekmonth} == 'W')
                SELECT  T.YRWK WEEK
            #else
                SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK
            #end
        #else
            SELECT 
            #if (${weekmonth} == 'W')
                #if (${weeklygubun} == 'Weekly4')
                    MIN(T.FCAST_YRWK) WEEK
                #else
                    T.FCAST_YRWK WEEK
                #end
            #else
                (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK
            #end
        #end
        ,DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY
        #if (${dataselect1} == 'P')
            ,'Performance' DIV
        #elseif (${dataselect1} == 'D')
            ,'Demand Forcast' DIV
        #elseif (${dataselect1} == 'S')
            ,'Sales Input' DIV
        #elseif (${dataselect1} == 'T')
            ,'Statistical' DIV
        #elseif (${dataselect1} == 'W')
            ,'4WK Avrg Vol' DIV
        #end
        #if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')
            #if (${orgdst} == 'FM')
                ,(
                    SELECT 
                    #if (${fmtoat} == '1')
                        #if (${fmtypeby} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby} == 'R')
                            RCC_CD
                        #elseif (${attypeby} == 'C')
                            CNT_CD
                        #elseif (${attypeby} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM EQR_ECC_MST 
                    WHERE ECC_CD = T.ECC_CD
                ) FM_ECC_CD
                ,'' TO_ECC_CD
            #else
                ,'' FM_ECC_CD
                ,(
                    SELECT 
                    #if (${fmtoat} == '1')
                        #if (${fmtypeby} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby} == 'R')
                            RCC_CD
                        #elseif (${attypeby} == 'C')
                            CNT_CD
                        #elseif (${attypeby} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM EQR_ECC_MST 
                    WHERE ECC_CD = T.ECC_CD
                ) TO_ECC_CD
            #end
        #elseif (${dataselect1} == 'P' && ${orgdst} == 'FMTO')
            ,(
                SELECT 
                #if (${fmtoat} == '1')
                    #if (${fmtypeby} == 'R')
                        RCC_CD
                    #elseif (${fmtypeby} == 'C')
                        CNT_CD
                    #elseif (${fmtypeby} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby} == 'R')
                        RCC_CD
                    #elseif (${attypeby} == 'C')
                        CNT_CD
                    #elseif (${attypeby} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM EQR_ECC_MST 
                WHERE ECC_CD = T.FM_ECC_CD
            ) FM_ECC_CD
            ,(
                SELECT 
                #if (${fmtoat} == '1')
                    #if (${fmtypeby} == 'R')
                        RCC_CD
                    #elseif (${fmtypeby} == 'C')
                        CNT_CD
                    #elseif (${fmtypeby} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby} == 'R')
                        RCC_CD
                    #elseif (${attypeby} == 'C')
                        CNT_CD
                    #elseif (${attypeby} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM EQR_ECC_MST 
                WHERE ECC_CD = T.TO_ECC_CD
            ) TO_ECC_CD
        #else
            ,(
                SELECT 
                #if (${fmtoat} == '1')
                    #if (${fmtypeby} == 'R')
                        RCC_CD
                    #elseif (${fmtypeby} == 'C')
                        CNT_CD
                    #elseif (${fmtypeby} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby} == 'R')
                        RCC_CD
                    #elseif (${attypeby} == 'C')
                        CNT_CD
                    #elseif (${attypeby} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM EQR_ECC_MST 
                WHERE ECC_CD = T.FM_ECC_CD
            ) FM_ECC_CD
            ,'' TO_ECC_CD
        #end
        #if (${dataselect1} == 'P')
            , SUM(T.CNTR_QTY) TOTAL
            #foreach ($key in ${arrCntrTpszCd})
                #if (${weeklygubun} != 'Weekly4')
                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                        , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                    #else
                        #if (${key} == 'O2')
                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                        #elseif (${key} == 'O4')
                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                        #elseif (${key} == 'F2')
                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                        #elseif (${key} == 'F4')
                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                        #end
                    #end
                #else
                    #if (${dataselect1} == 'P')
                        #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                            , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                        #else
                            #if (${key} == 'O2')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                            #elseif (${key} == 'O4')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                            #elseif (${key} == 'F2')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                            #elseif (${key} == 'F4')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                            #end
                        #end
                    #elseif (${dataselect2} == 'P')
                        #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                            , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                        #else
                            #if (${key} == 'O2')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                            #elseif (${key} == 'O4')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                            #elseif (${key} == 'F2')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                            #elseif (${key} == 'F4')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                            #end
                        #end
                    #else
                        #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                            , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                        #else
                            #if (${key} == 'O2')
                                , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY
                            #elseif (${key} == 'O4')
                                , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY
                            #elseif (${key} == 'F2')
                                , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY
                            #elseif (${key} == 'F4')
                                , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY
                            #end
                        #end
                    #end
                #end
            #end
        #else
            #if (${weeklygubun} != 'Weekly4')
                , SUM(T.CNTR_VOL_QTY) TOTAL
            #else
                , NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL
            #end
            #foreach ($key in ${arrCntrTpszCd})
                #if (${weeklygubun} != 'Weekly4')
                    , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY
                #else
                    , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                #end
            #end
        #end
        , '1' SEQ
        FROM 
        #if (${dataselect1} == 'P')
            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                EQR_FULL_CNTR_PERF
            #else
                EQR_FULL_CNTR_FM_TO_PERF
            #end
        #elseif (${dataselect1} == 'D')
            EQR_OB_FCAST
        #elseif (${dataselect1} == 'S')
            EQR_SLS_INP_FCAST
        #elseif (${dataselect1} == 'T')
            EQR_SLS_STAT_FCAST
        #elseif (${dataselect1} == 'W')
            EQR_AVG_FCAST
        #end
        T
        #if (${fmtoat} == '1')
            ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
            #if ($arrFmEccCd.size() > 0)
                #if (${fmtype} == 'R')
                    AND RCC_CD
                #elseif (${fmtype} == 'L')
                    AND LCC_CD
                #else
                    AND ECC_CD
                #end
                IN(
                #foreach ($key in ${arrFmEccCd})
                    #if($velocityCount < $arrFmEccCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )) C
            #else
                ) C
            #end
        #else
            #if (${attype} != '')
                ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if (${attype} == 'R')
                    AND RCC_CD
                #elseif (${attype} == 'L')
                    AND LCC_CD
                #else
                    AND ECC_CD
                #end
                IN(
                #foreach ($key in ${arrAtEccCd})
                    #if($velocityCount < $arrAtEccCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )) C
            #end
        #end
        #if (${fmtoat} == '1')
            , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
            #if ($arrToEccCd.size() > 0)
                #if (${totype} == 'R')
                    AND RCC_CD
                #elseif (${totype} == 'L')
                    AND LCC_CD
                #else
                    AND ECC_CD
                #end
                IN(
                #foreach ($key in ${arrToEccCd})
                    #if($velocityCount < $arrToEccCd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
                )) D
            #else
                ) D
            #end
        #end
        WHERE 
        #if (${dataselect1} == 'D')
            T.SCNR_ID = '$key.get(2)'
        #else
            #if (${dataselect1} != 'P')
                T.YRWK = '$key.get(0)'
            #else
                T.YRWK = '$key.get(1)'
            #end
        #end
        #if (${dataselect1} != 'P')
            #if (${weeklygubun} == 'Weekly4')
                AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'
            #else
                AND T.FCAST_YRWK = '$key.get(1)'
            #end
        #end
        #if (${dataselect1} == 'P')
            #if (${fmtoat} == '1')
                #if (${orgdst} == 'FMTO')
                    AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)
                #else
                    AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)
                #end
            #else
                #if (${attype} != '')
                    #if (${orgdst} == 'FMTO')
                        AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                    #else
                        AND (T.ECC_CD = C.ECC_CD)
                    #end
                #end
            #end
        #else
            #if (${fmtoat} == '1')
                AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD
            #else
                #if (${dataselect2} == '')
                    #if (${attype} != '')
                        AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)
                    #end
                #else
                    #if (${attype} != '')
                        #if (${orgdst} == 'FMTO')
                            AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                        #else
                            AND (T.TO_ECC_CD = C.ECC_CD)
                        #end
                    #end
                #end
            #end
        #end
        #if ($arrCntrTpszCd.size() > 0)
            AND T.CNTR_TPSZ_CD IN(
            #foreach ($key in ${arrCntrTpszCd})
                '$key',
            #end
            'F5','S2','S4','A2','A4' )
        #end
        #if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')
            AND IO_BND_CD = 
            #if (${orgdst} == 'FM')
                'O'
            #else
                'I'
            #end
            AND (SELECT ECC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.ECC_CD) IS NOT NULL
            GROUP BY YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD
        #elseif (${dataselect1} == 'P' && ${orgdst} == 'FMTO')
            AND (SELECT ECC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.FM_ECC_CD) IS NOT NULL
            AND (SELECT ECC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.TO_ECC_CD) IS NOT NULL
            GROUP BY YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), FM_ECC_CD, TO_ECC_CD
        #else
            AND (SELECT ECC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.FM_ECC_CD) IS NOT NULL
            #if (${weeklygubun} != 'Weekly4')
                GROUP BY FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), FM_ECC_CD
            #else
                GROUP BY  DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), FM_ECC_CD
            #end
        #end
        #if (${weekmonth} == 'W')
            )
            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
        #else
            #if (${dataselect1} != '' && ${dataselect2} != '')
                #if (${orgdst} == 'FM')
                    )
                    GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
                #elseif (${orgdst} == 'TO')
                    )
                    GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ
                #elseif (${orgdst} == 'FMTO')
                    )
                    GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
                #end
            #elseif (${dataselect1} == 'P' && ${dataselect2} == '')
                #if (${orgdst} == 'FM')
                    )
                    GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
                #elseif (${orgdst} == 'TO')
                    )
                    GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ
                #elseif (${orgdst} == 'FMTO')
                    )
                    GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
                #end
            #elseif (${dataselect1} != 'P' && ${dataselect2} == '')
                )
                GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
            #end
        #end
        #if($velocityCount < $arrWkResult.size())
            UNION ALL
        #end
    #end
    ------4wk union all 의 최외곽 END
    #if (${weekmonth} == 'W')
        )
        GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
    #else
        #if (${dataselect1} != '' && ${dataselect2} != '')
            #if (${orgdst} == 'FM')
                )
                GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
            #elseif (${orgdst} == 'TO')
                )
                GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ
            #elseif (${orgdst} == 'FMTO')
                )
                GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
            #end
        #elseif (${dataselect1} == 'P' && ${dataselect2} == '')
            #if (${orgdst} == 'FM')
                )
                GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
            #elseif (${orgdst} == 'TO')
                )
                GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ
            #elseif (${orgdst} == 'FMTO')
                )
                GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
            #end
        #elseif (${dataselect1} != 'P' && ${dataselect2} == '')
            )
            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
        #end
    #end
    ORDER BY WEEK, FM_ECC_CD, TO_ECC_CD
#else
    SELECT 
        WEEK
        , COMPANY CO_CD
        , DIV
        , FM_ECC_CD
        , TO_ECC_CD
        , SUM(TOTAL) TOTAL
        #foreach ($key in ${arrCntrTpszCd})
            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_QTY
        #end
        , SEQ
    FROM (
        #if (${weekmonth} == 'W')
            SELECT
                WEEK
                , COMPANY
                , DIV
                , FM_ECC_CD
                , TO_ECC_CD
                , SUM(TOTAL) TOTAL
                #foreach ($key in ${arrCntrTpszCd})
                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                #end
                , SEQ
            FROM  (
        #else
            #if (${dataselect1} != '' && ${dataselect2} != '')
                #if (${orgdst} == 'FM')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , FM_ECC_CD
                        , '' TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #elseif (${orgdst} == 'TO')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , '' FM_ECC_CD
                        , TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #elseif (${orgdst} == 'FMTO')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , FM_ECC_CD
                        , TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #end
            #elseif (${dataselect1} == 'P' && ${dataselect2} == '')
                #if (${orgdst} == 'FM')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , FM_ECC_CD
                        , '' TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #elseif (${orgdst} == 'TO')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , '' FM_ECC_CD
                        , TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #elseif (${orgdst} == 'FMTO')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , FM_ECC_CD
                        , TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #end
            #elseif (${dataselect1} != 'P' && ${dataselect2} == '')
                SELECT
                    WEEK
                    , COMPANY
                    , DIV
                    , FM_ECC_CD
                    , '' TO_ECC_CD
                    , SUM(TOTAL) TOTAL
                    #foreach ($key in ${arrCntrTpszCd})
                        , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                    #end
                    , SEQ
                FROM  (
            #end
        #end
        --DATA SELECT 1 START--------------------------------------
        #foreach ($key in ${arrWkResult})
            #if (${dataselect1} == 'P')
                #if (${weekmonth} == 'W')
                    SELECT  T.YRWK WEEK
                #else
                    SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK
                #end
            #else
                SELECT 
                #if (${weekmonth} == 'W')
                    #if (${weeklygubun} == 'Weekly4')
                        MIN(T.FCAST_YRWK) WEEK
                    #else
                        T.FCAST_YRWK WEEK
                    #end
                #else
                    (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK
                #end
            #end
            ,DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY
            #if (${dataselect1} == 'P')
                ,'Performance' DIV
            #elseif (${dataselect1} == 'D')
                ,'Demand Forcast' DIV
            #elseif (${dataselect1} == 'S')
                ,'Sales Input' DIV
            #elseif (${dataselect1} == 'T')
                ,'Statistical' DIV
            #elseif (${dataselect1} == 'W')
                ,'4WK Avrg Vol' DIV
            #end
            #if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')
                #if (${orgdst} == 'FM')
                    ,(
                        SELECT 
                        #if (${fmtoat} == '1')
                            #if (${fmtypeby} == 'R')
                                RCC_CD
                            #elseif (${fmtypeby} == 'C')
                                CNT_CD
                            #elseif (${fmtypeby} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby} == 'R')
                                RCC_CD
                            #elseif (${attypeby} == 'C')
                                CNT_CD
                            #elseif (${attypeby} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM EQR_ECC_MST 
                        WHERE ECC_CD = T.ECC_CD
                    ) FM_ECC_CD
                    , '' TO_ECC_CD
                #else
                    , '' FM_ECC_CD
                    ,(
                        SELECT 
                        #if (${fmtoat} == '1')
                            #if (${fmtypeby} == 'R')
                                RCC_CD
                            #elseif (${fmtypeby} == 'C')
                                CNT_CD
                            #elseif (${fmtypeby} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby} == 'R')
                                RCC_CD
                            #elseif (${attypeby} == 'C')
                                CNT_CD
                            #elseif (${attypeby} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM EQR_ECC_MST 
                        WHERE ECC_CD = T.ECC_CD
                    ) TO_ECC_CD
                #end
            #else
                #if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')
                    , T.FM_ECC_CD
                #else
                    ,'' FM_ECC_CD
                #end
                #if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')
                    ,T.TO_ECC_CD
                #else
                    ,'' TO_ECC_CD
                #end
            #end
            #if (${dataselect1} == 'P')
                , SUM(T.CNTR_QTY) TOTAL
                #foreach ($key in ${arrCntrTpszCd})
                    #if (${weeklygubun} != 'Weekly4')
                        #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                            , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                        #else
                            #if (${key} == 'O2')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                            #elseif (${key} == 'O4')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                            #elseif (${key} == 'F2')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                            #elseif (${key} == 'F4')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                            #end
                        #end
                    #else
                        #if (${dataselect1} == 'P')
                            #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                            #else
                                #if (${key} == 'O2')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                #elseif (${key} == 'O4')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                #elseif (${key} == 'F2')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                #elseif (${key} == 'F4')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                #end
                            #end
                        #elseif (${dataselect2} == 'P')
                            #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                            #else
                                #if (${key} == 'O2')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                #elseif (${key} == 'O4')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                #elseif (${key} == 'F2')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                #elseif (${key} == 'F4')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                #end
                            #end
                        #else
                            #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                            #else
                                #if (${key} == 'O2')
                                    , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY
                                #elseif (${key} == 'O4')
                                    , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY
                                #elseif (${key} == 'F2')
                                    , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY
                                #elseif (${key} == 'F4')
                                    , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY
                                #end
                            #end
                        #end
                    #end
                #end
            #else
                #if (${weeklygubun} != 'Weekly4')
                    , SUM(T.CNTR_VOL_QTY) TOTAL
                #else
                    , NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL
                #end
                #foreach ($key in ${arrCntrTpszCd})
                    #if (${weeklygubun} != 'Weekly4')
                        , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY
                    #else
                        , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                    #end
                #end
            #end
            , '1' SEQ
            #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                FROM 
                #if (${dataselect1} == 'P')
                    #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                        EQR_FULL_CNTR_PERF
                    #else
                        EQR_FULL_CNTR_FM_TO_PERF
                    #end
                #elseif (${dataselect1} == 'D')
                    EQR_OB_FCAST
                #elseif (${dataselect1} == 'S')
                    EQR_SLS_INP_FCAST
                #elseif (${dataselect1} == 'T')
                    EQR_SLS_STAT_FCAST
                #elseif (${dataselect1} == 'W')
                    EQR_AVG_FCAST
                #end
                T,
                #if (${dataselect2} == 'P')
                    #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                        EQR_FULL_CNTR_PERF
                    #else
                        EQR_FULL_CNTR_FM_TO_PERF
                    #end
                #elseif (${dataselect2} == 'D')
                    EQR_OB_FCAST
                #elseif (${dataselect2} == 'S')
                    EQR_SLS_INP_FCAST
                #elseif (${dataselect2} == 'T')
                    EQR_SLS_STAT_FCAST
                #elseif (${dataselect2} == 'W')
                    EQR_AVG_FCAST
                #end
                T2
            #else
                FROM 
                #if (${dataselect1} == 'P')
                    #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                        EQR_FULL_CNTR_PERF
                    #else
                        EQR_FULL_CNTR_FM_TO_PERF
                    #end
                #elseif (${dataselect1} == 'D')
                    EQR_OB_FCAST
                #elseif (${dataselect1} == 'S')
                    EQR_SLS_INP_FCAST
                #elseif (${dataselect1} == 'T')
                    EQR_SLS_STAT_FCAST
                #elseif (${dataselect1} == 'W')
                    EQR_AVG_FCAST
                #end
                T
            #end
            #if (${fmtoat} == '1')
                ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrFmEccCd.size() > 0)
                    #if (${fmtype} == 'R')
                        AND RCC_CD
                    #elseif (${fmtype} == 'L')
                        AND LCC_CD
                    #else
                        AND ECC_CD
                    #end
                    IN(
                    #foreach ($key in ${arrFmEccCd})
                        #if($velocityCount < $arrFmEccCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                    )) C
                #else
                    ) C
                #end
            #else
                #if (${attype} != '')
                    ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if (${attype} == 'R')
                        AND RCC_CD
                    #elseif (${attype} == 'L')
                        AND LCC_CD
                    #else
                        AND ECC_CD
                    #end
                    IN(
                    #foreach ($key in ${arrAtEccCd})
                        #if($velocityCount < $arrAtEccCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                    )) C
                #end
            #end
            #if (${fmtoat} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrToEccCd.size() > 0)
                    #if (${totype} == 'R')
                        AND RCC_CD
                    #elseif (${totype} == 'L')
                        AND LCC_CD
                    #else
                        AND ECC_CD
                    #end
                    IN(
                    #foreach ($key in ${arrToEccCd})
                        #if($velocityCount < $arrToEccCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                    )) D
                #else
                    ) D
                #end
            #end
            WHERE 
            #if (${dataselect1} == 'D')
                T.SCNR_ID = '$key.get(2)'
            #else
                #if (${dataselect1} != 'P')
                    T.YRWK = '$key.get(0)'
                #else
                    T.YRWK = '$key.get(1)'
                #end
            #end
            #if (${dataselect1} != 'P')
                #if (${weeklygubun} == 'Weekly4')
                    AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'
                #else
                    AND T.FCAST_YRWK = '$key.get(1)'
                #end
            #end
            #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                #if (${dataselect1} == 'D')
                    AND T2.YRWK = '$key.get(0)'
                #end
                #if (${dataselect2} == 'D')
                    AND T2.SCNR_ID = '$key.get(2)'
                #end
            #end
            #if (${dataselect1} == 'P')
                #if (${fmtoat} == '1')
                    #if (${orgdst} == 'FMTO')
                        AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)
                    #else
                        AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)
                    #end
                #else
                    #if (${attype} != '')
                        #if (${orgdst} == 'FMTO')
                            AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                        #else
                            AND (T.ECC_CD = C.ECC_CD)
                        #end
                    #end
                #end
            #else
                #if (${fmtoat} == '1')
                    AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${dataselect2} == '')
                        #if (${attype} != '')
                            AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)
                        #end
                    #else
                        #if (${attype} != '')
                            #if (${orgdst} == 'FMTO')
                                AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                            #else
                                AND (T.TO_ECC_CD = C.ECC_CD)
                            #end
                        #end
                    #end
                #end
            #end
            #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                #if (${dataselect1} != 'D' && ${dataselect2} != 'D')
                    AND T.FM_ECC_CD = T2.FM_ECC_CD
                    AND T.TO_ECC_CD = T2.TO_ECC_CD
                    AND T.CO_CD = T2.CO_CD
                    AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                    AND T.YRWK = T2.YRWK
                    AND T.FCAST_YRWK = T2.FCAST_YRWK
                    AND T.FCAST_DT = T2.FCAST_DT
                #else
                    #if (${dataselect1} == 'D')
                        AND T.FM_ECC_CD = T2.FM_ECC_CD
                        AND T.TO_ECC_CD = T2.TO_ECC_CD
                        AND T.CO_CD = T2.CO_CD
                        AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                        AND SUBSTR(T.SCNR_ID,5,6) = T2.YRWK
                        AND T.FCAST_YRWK = T2.FCAST_YRWK
                        AND T.FCAST_DT = T2.FCAST_DT
                    #end
                    #if (${dataselect2} == 'D')
                        AND T.FM_ECC_CD = T2.FM_ECC_CD
                        AND T.TO_ECC_CD = T2.TO_ECC_CD
                        AND T.CO_CD = T2.CO_CD
                        AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                        AND T.YRWK = SUBSTR(T2.SCNR_ID,5,6)
                        AND T.FCAST_YRWK = T2.FCAST_YRWK
                        AND T.FCAST_DT = T2.FCAST_DT
                    #end
                #end
            #end
            #if (${inclmatch} == '1')
                -- 20070814 ChangHo Chae  조건 변경 추가
                -- 기존 아래의 것을 AND T.CNTR_VOL_QTY > 0 아래의 형태로 변경
                #if (${dataselect1} != 'P')
                    AND T.CNTR_VOL_QTY > 0
                #else
                    AND T.CNTR_QTY > 0
                #end
            #end
            #if ($arrCntrTpszCd.size() > 0)
                AND T.CNTR_TPSZ_CD IN(
                #foreach ($key in ${arrCntrTpszCd})
                    '$key',
                #end
                'F5','S2','S4','A2','A4' )
            #end
            #if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')
                AND T.IO_BND_CD = 
                #if (${orgdst} == 'FM')
                    'O'
                #else
                    'I'
                #end
                GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD
            #elseif (${dataselect1} == 'P' && ${orgdst} == 'FMTO')
                GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
            #else
                #if (${orgdst} == 'FM')
                    #if (${weeklygubun} == 'Weekly4')
                        #if (${weekmonth} != 'W')
                            GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                        #else
                            GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                        #end
                    #else
                        GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                    #end
                #elseif (${orgdst} == 'TO')
                    #if (${weeklygubun} == 'Weekly4')
                        #if (${weekmonth} != 'W')
                            GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                        #else
                            GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                        #end
                    #else
                        GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                    #end
                #else
                    #if (${weeklygubun} == 'Weekly4')
                        #if (${weekmonth} != 'W')
                            GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                        #else
                            GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                        #end
                    #else
                        GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                    #end
                #end
            #end
            #if($velocityCount < $arrWkResult.size())
                UNION ALL
            #end
        #end
        --DATA SELECT 2 START--------------------------------------
        UNION ALL
        #foreach ($key in ${arrWkResult})
            #if (${dataselect2} == 'P')
                #if(${weekmonth} == 'W')
                    SELECT  T.YRWK WEEK
                #else
                    SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK
                #end
            #else
                SELECT 
                #if (${weekmonth} == 'W')
                    #if (${weeklygubun} == 'Weekly4')
                        MIN(T.FCAST_YRWK) WEEK
                    #else
                        T.FCAST_YRWK WEEK
                    #end
                #else
                    (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK
                #end
            #end
            ,DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY
            #if (${dataselect2} == 'P')
                ,'Performance' DIV
            #elseif (${dataselect2} == 'D')
                ,'Demand Forcast' DIV
            #elseif (${dataselect2} == 'S')
                ,'Sales Input' DIV
            #elseif (${dataselect2} == 'T')
                ,'Statistical' DIV
            #elseif (${dataselect2} == 'W')
                ,'4WK Avrg Vol' DIV
            #end
            #if (${dataselect2} == 'P' && ${orgdst} != 'FMTO')
                #if (${orgdst} == 'FM')
                    ,(
                        SELECT 
                        #if (${fmtoat} == '1')
                            #if (${fmtypeby} == 'R')
                                RCC_CD
                            #elseif (${fmtypeby} == 'C')
                                CNT_CD
                            #elseif (${fmtypeby} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby} == 'R')
                                RCC_CD
                            #elseif (${attypeby} == 'C')
                                CNT_CD
                            #elseif (${attypeby} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM EQR_ECC_MST 
                        WHERE ECC_CD = T.ECC_CD
                    ) FM_ECC_CD
                    , '' TO_ECC_CD
                #else
                    , '' FM_ECC_CD
                    ,(
                        SELECT 
                        #if (${fmtoat} == '1')
                            #if (${fmtypeby} == 'R')
                                RCC_CD
                            #elseif (${fmtypeby} == 'C')
                                CNT_CD
                            #elseif (${fmtypeby} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby} == 'R')
                                RCC_CD
                            #elseif (${attypeby} == 'C')
                                CNT_CD
                            #elseif (${attypeby} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM EQR_ECC_MST 
                        WHERE ECC_CD = T.ECC_CD
                    ) TO_ECC_CD
                #end
            #else
                #if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')
                    ,(
                        SELECT
                        #if (${fmtoat} == '1')
                            #if (${fmtypeby} == 'R')
                                RCC_CD
                            #elseif (${fmtypeby} == 'C')
                                CNT_CD
                            #elseif (${fmtypeby} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby} == 'R')
                                RCC_CD
                            #elseif (${attypeby} == 'C')
                                CNT_CD
                            #elseif (${attypeby} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM EQR_ECC_MST
                        WHERE ECC_CD = T.FM_ECC_CD
                    ) FM_ECC_CD
                #else
                    ,'' FM_ECC_CD
                #end
                #if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')
                    ,(
                        SELECT
                        #if (${fmtoat} == '1')
                            #if (${totypeby} == 'R')
                                RCC_CD
                            #elseif (${totypeby} == 'C')
                                CNT_CD
                            #elseif (${totypeby} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby} == 'R')
                                RCC_CD
                            #elseif (${attypeby} == 'C')
                                CNT_CD
                            #elseif (${attypeby} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM EQR_ECC_MST
                        WHERE ECC_CD = T.TO_ECC_CD
                    ) TO_ECC_CD
                #else
                    ,'' TO_ECC_CD
                #end
            #end
            #if (${dataselect2} == 'P')
                , SUM(T.CNTR_QTY) TOTAL
                #foreach ($key in ${arrCntrTpszCd})
                    #if (${weeklygubun} != 'Weekly4')
                        #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                            , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                        #else
                            #if (${key} == 'O2')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                            #elseif (${key} == 'O4')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                            #elseif (${key} == 'F2')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                            #elseif (${key} == 'F4')
                                , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                            #end
                        #end
                    #else
                        #if (${dataselect1} == 'P')
                            #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                            #else
                                #if (${key} == 'O2')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                #elseif (${key} == 'O4')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                #elseif (${key} == 'F2')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                #elseif (${key} == 'F4')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                #end
                            #end
                        #elseif (${dataselect2} == 'P')
                            #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                            #else
                                #if (${key} == 'O2')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                #elseif (${key} == 'O4')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                #elseif (${key} == 'F2')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                #elseif (${key} == 'F4')
                                    , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                #end
                            #end
                        #else
                            #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                            #else
                                #if (${key} == 'O2')
                                    , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY
                                #elseif (${key} == 'O4')
                                    , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY
                                #elseif (${key} == 'F2')
                                    , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY
                                #elseif (${key} == 'F4')
                                    , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY
                                #end
                            #end
                        #end
                    #end
                #end
            #else
                #if (${weeklygubun} != 'Weekly4')
                    , SUM(T.CNTR_VOL_QTY) TOTAL
                #else
                    , NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL
                #end
                #foreach ($key in ${arrCntrTpszCd})
                    #if (${weeklygubun} != 'Weekly4')
                        , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY
                    #else
                        , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                    #end
                #end
            #end
            , '2' SEQ
            #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                FROM 
                #if (${dataselect2} == 'P')
                    #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                        EQR_FULL_CNTR_PERF
                    #else
                        EQR_FULL_CNTR_FM_TO_PERF
                    #end
                #elseif (${dataselect2} == 'D')
                    EQR_OB_FCAST
                #elseif (${dataselect2} == 'S')
                    EQR_SLS_INP_FCAST
                #elseif (${dataselect2} == 'T')
                    EQR_SLS_STAT_FCAST
                #elseif (${dataselect2} == 'W')
                    EQR_AVG_FCAST
                #end
                T ,
                #if (${dataselect1} == 'P')
                    #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                        EQR_FULL_CNTR_PERF
                    #else
                        EQR_FULL_CNTR_FM_TO_PERF
                    #end
                #elseif (${dataselect1} == 'D')
                    EQR_OB_FCAST
                #elseif (${dataselect1} == 'S')
                    EQR_SLS_INP_FCAST
                #elseif (${dataselect1} == 'T')
                    EQR_SLS_STAT_FCAST
                #elseif (${dataselect1} == 'W')
                    EQR_AVG_FCAST
                #end
                T2
            #else
                FROM 
                #if (${dataselect2} == 'P')
                    #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                        EQR_FULL_CNTR_PERF
                    #else
                        EQR_FULL_CNTR_FM_TO_PERF
                    #end
                #elseif (${dataselect2} == 'D')
                    EQR_OB_FCAST
                #elseif (${dataselect2} == 'S')
                    EQR_SLS_INP_FCAST
                #elseif (${dataselect2} == 'T')
                    EQR_SLS_STAT_FCAST
                #elseif (${dataselect2} == 'W')
                    EQR_AVG_FCAST
                #end
                T
            #end
            #if (${fmtoat} == '1')
                ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrFmEccCd.size() > 0)
                    #if (${fmtype} == 'R')
                        AND RCC_CD
                    #elseif (${fmtype} == 'L')
                        AND LCC_CD
                    #else
                        AND ECC_CD
                    #end
                    IN(
                    #foreach ($key in ${arrFmEccCd})
                        #if($velocityCount < $arrFmEccCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                    )) C
                #else
                    ) C
                #end
            #else
                #if (${attype} != '')
                    ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if (${attype} == 'R')
                        AND RCC_CD
                    #elseif (${attype} == 'L')
                        AND LCC_CD
                    #else
                        AND ECC_CD
                    #end
                    IN(
                    #foreach ($key in ${arrAtEccCd})
                        #if($velocityCount < $arrAtEccCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                    )) C
                #end
            #end
            #if (${fmtoat} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrToEccCd.size() > 0)
                    #if (${totype} == 'R')
                        AND RCC_CD
                    #elseif (${totype} == 'L')
                        AND LCC_CD
                    #else
                        AND ECC_CD
                    #end
                    IN(
                    #foreach ($key in ${arrToEccCd})
                        #if($velocityCount < $arrToEccCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                    )) D
                #else
                    ) D
                #end
            #end
            WHERE 
            #if (${dataselect2} == 'D')
                T.SCNR_ID = '$key.get(2)'
            #else
                #if (${dataselect2} != 'P')
                    T.YRWK = '$key.get(0)'
                #else
                    T.YRWK = '$key.get(1)'
                #end
            #end
            #if (${dataselect2} != 'P')
                #if (${weeklygubun} == 'Weekly4')
                    AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'
                #else
                    AND T.FCAST_YRWK = '$key.get(1)'
                #end
            #end
            #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                #if (${dataselect2} == 'D')
                    AND T2.YRWK = '$key.get(0)'
                #end
                #if (${dataselect1} == 'D')
                    AND T2.SCNR_ID = '$key.get(2)'
                #end
            #end
            #if (${dataselect2} == 'P')
                #if (${fmtoat} == '1')
                    #if (${orgdst} == 'FMTO')
                        AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)
                    #else
                        AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)
                    #end
                #else
                    #if (${attype} != '')
                        #if (${orgdst} == 'FMTO')
                            AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                        #else
                            AND (T.ECC_CD = C.ECC_CD)
                        #end
                    #end
                #end
            #else
                #if (${fmtoat} == '1')
                    AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${dataselect2} == '')
                        #if (${attype} != '')
                            AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)
                        #end
                    #else
                        #if (${attype} != '')
                            #if (${orgdst} == 'FMTO')
                                AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                            #else
                                AND (T.TO_ECC_CD = C.ECC_CD)
                            #end
                        #end
                    #end
                #end
            #end
            #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                #if (${dataselect1} != 'D' && ${dataselect2} != 'D')
                    AND T.FM_ECC_CD = T2.FM_ECC_CD
                    AND T.TO_ECC_CD = T2.TO_ECC_CD
                    AND T.CO_CD = T2.CO_CD
                    AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                    AND T.YRWK = T2.YRWK
                    AND T.FCAST_YRWK = T2.FCAST_YRWK
                    AND T.FCAST_DT = T2.FCAST_DT
                #else
                    #if (${dataselect1} == 'D')
                        AND T.FM_ECC_CD = T2.FM_ECC_CD
                        AND T.TO_ECC_CD = T2.TO_ECC_CD
                        AND T.CO_CD = T2.CO_CD
                        AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                        AND T.YRWK = SUBSTR(T2.SCNR_ID,5,6)
                        AND T.FCAST_YRWK = T2.FCAST_YRWK
                        AND T.FCAST_DT = T2.FCAST_DT
                    #end
                    #if (${dataselect2} == 'D')
                        AND T.FM_ECC_CD = T2.FM_ECC_CD
                        AND T.TO_ECC_CD = T2.TO_ECC_CD
                        AND T.CO_CD = T2.CO_CD
                        AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                        AND SUBSTR(T.SCNR_ID,5,6) = T2.YRWK
                        AND T.FCAST_YRWK = T2.FCAST_YRWK
                        AND T.FCAST_DT = T2.FCAST_DT
                    #end
                #end
            #end
            #if ($arrCntrTpszCd.size() > 0)
                AND T.CNTR_TPSZ_CD IN(
                #foreach ($key in ${arrCntrTpszCd})
                    '$key',
                #end
                'F5','S2','S4','A2','A4' )
            #end
            #if (${dataselect1} == 'P')
                #if (${orgdst} == 'FM')
                    #if (${weeklygubun} == 'Weekly4')
                        #if (${weekmonth} != 'W')
                            GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                        #else
                            GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                        #end
                    #else
                        GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                    #end
                #elseif (${orgdst} == 'TO')
                    #if (${weeklygubun} == 'Weekly4')
                        #if (${weekmonth} != 'W')
                            GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                        #else
                            GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                        #end
                    #else
                        GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                    #end
                #else
                    #if (${weeklygubun} == 'Weekly4')
                        #if (${weekmonth} != 'W')
                            GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                        #else
                            GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                        #end
                    #else
                        GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                    #end
                #end
            #elseif (${dataselect2} == 'P' && ${orgdst} != 'FMTO')
                AND T.IO_BND_CD = 
                #if (${orgdst} == 'FM')
                    'O'
                #else
                    'I'
                #end
                GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD
            #elseif (${dataselect2} == 'P' && ${orgdst} == 'FMTO')
                GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
            #else
                #if (${orgdst} == 'FM')
                    #if (${weeklygubun} == 'Weekly4')
                        #if (${weekmonth} != 'W')
                            GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                        #else
                            GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                        #end
                    #else
                        GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                    #end
                #elseif (${orgdst} == 'TO')
                    #if (${weeklygubun} == 'Weekly4')
                        #if (${weekmonth} != 'W')
                            GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                        #else
                            GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                        #end
                    #else
                        GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                    #end
                #else
                    #if (${weeklygubun} == 'Weekly4')
                        #if (${weekmonth} != 'W')
                            GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                        #else
                            GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                        #end
                    #else
                        GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                    #end
                #end
            #end
            #if($velocityCount < $arrWkResult.size())
                UNION ALL
            #end
        #end
        --DATA SELECT 2 END--------------------------------------
        #if (${weekmonth} == 'W')
            )
            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
        #else
            #if (${dataselect1} != '' && ${dataselect2} != '')
                #if (${orgdst} == 'FM')
                    )
                    GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
                #elseif (${orgdst} == 'TO')
                    )
                    GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ
                #elseif (${orgdst} == 'FMTO')
                    )
                    GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
                #end
            #elseif (${dataselect1} == 'P' && ${dataselect2} == '')
                #if (${orgdst} == 'FM')
                    )
                    GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
                #elseif (${orgdst} == 'TO')
                    )
                    GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ
                #elseif (${orgdst} == 'FMTO')
                    )
                    GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
                #end
            #elseif (${dataselect1} != 'P' && ${dataselect2} == '')
                )
                GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
            #end
        #end
    )
    GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD , TO_ECC_CD, SEQ
    
    #if (${inclunmatch} == '1')
        --UNMATCH START--------------------------------------
        UNION ALL
        SELECT 
            WEEK 
            ,COMPANY CO_CD
            ,'Unmatch Vol' DIV
            #if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')
                , FM_ECC_CD
            #else
                ,'' FM_ECC_CD 
            #end
            #if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')
                ,TO_ECC_CD
            #else
                ,'' TO_ECC_CD
            #end
            , SUM(DECODE ( SEQ , '2' , NVL(TOTAL,0) ))  - SUM(DECODE ( SEQ , '1' , NVL(TOTAL,0) )) TOTAL
            #foreach ($key in ${arrCntrTpszCd})
                , SUM(DECODE ( SEQ , '2' , NVL(${key}CNTR_VOL_QTY,0) )) - SUM(DECODE ( SEQ , '1' , NVL(${key}CNTR_VOL_QTY,0) )) ${key}CNTR_VOL_QTY
            #end
            , '3' SEQ
        FROM
        (
            SELECT 
                WEEK
                , COMPANY
                , DIV
                , FM_ECC_CD
                , TO_ECC_CD
                , SUM(TOTAL) TOTAL
                #foreach ($key in ${arrCntrTpszCd})
                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                #end
                , SEQ
            FROM (
                #if (${weekmonth} == 'W')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , FM_ECC_CD
                        , TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #else
                    #if (${dataselect1} != '' && ${dataselect2} != '')
                        #if (${orgdst} == 'FM')
                            SELECT
                                WEEK
                                , COMPANY
                                , DIV
                                , FM_ECC_CD
                                , '' TO_ECC_CD
                                , SUM(TOTAL) TOTAL
                                #foreach ($key in ${arrCntrTpszCd})
                                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                                #end
                                , SEQ
                            FROM  (
                        #elseif (${orgdst} == 'TO')
                            SELECT
                                WEEK
                                , COMPANY
                                , DIV
                                , '' FM_ECC_CD
                                , TO_ECC_CD
                                , SUM(TOTAL) TOTAL
                                #foreach ($key in ${arrCntrTpszCd})
                                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                                #end
                                , SEQ
                            FROM  (
                        #elseif (${orgdst} == 'FMTO')
                            SELECT
                                WEEK
                                , COMPANY
                                , DIV
                                , FM_ECC_CD
                                , TO_ECC_CD
                                , SUM(TOTAL) TOTAL
                                #foreach ($key in ${arrCntrTpszCd})
                                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                                #end
                                , SEQ
                            FROM  (
                        #end
                    #elseif (${dataselect1} == 'P' && ${dataselect2} == '')
                        #if (${orgdst} == 'FM')
                            SELECT
                                WEEK
                                , COMPANY
                                , DIV
                                , FM_ECC_CD
                                , '' TO_ECC_CD
                                , SUM(TOTAL) TOTAL
                                #foreach ($key in ${arrCntrTpszCd})
                                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                                #end
                                , SEQ
                            FROM  (
                        #elseif (${orgdst} == 'TO')
                            SELECT
                                WEEK
                                , COMPANY
                                , DIV
                                , '' FM_ECC_CD
                                , TO_ECC_CD
                                , SUM(TOTAL) TOTAL
                                #foreach ($key in ${arrCntrTpszCd})
                                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                                #end
                                , SEQ
                            FROM  (
                        #elseif (${orgdst} == 'FMTO')
                            SELECT
                                WEEK
                                , COMPANY
                                , DIV
                                , FM_ECC_CD
                                , TO_ECC_CD
                                , SUM(TOTAL) TOTAL
                                #foreach ($key in ${arrCntrTpszCd})
                                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                                #end
                                , SEQ
                            FROM  (
                        #end
                    #elseif (${dataselect1} != 'P' && ${dataselect2} == '')
                        SELECT
                            WEEK
                            , COMPANY
                            , DIV
                            , FM_ECC_CD
                            , '' TO_ECC_CD
                            , SUM(TOTAL) TOTAL
                            #foreach ($key in ${arrCntrTpszCd})
                                , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                            #end
                            , SEQ
                        FROM  (
                    #end
                #end
                --DATA SELECT 1 START--------------------------------------
                #foreach ($key in ${arrWkResult})
                    #if (${dataselect1} == 'P')
                        #if (${weekmonth} == 'W')
                            SELECT  T.YRWK WEEK
                        #else
                            SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK
                        #end
                    #else
                        SELECT 
                        #if (${weekmonth} == 'W')
                            #if (${weeklygubun} == 'Weekly4')
                                MIN(T.FCAST_YRWK) WEEK
                            #else
                                T.FCAST_YRWK WEEK
                            #end
                        #else
                            (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK
                        #end
                    #end
                    ,DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY
                    #if (${dataselect1} == 'P')
                        ,'Performance' DIV
                    #elseif (${dataselect1} == 'D')
                        ,'Demand Forcast' DIV
                    #elseif (${dataselect1} == 'S')
                        ,'Sales Input' DIV
                    #elseif (${dataselect1} == 'T')
                        ,'Statistical' DIV
                    #elseif (${dataselect1} == 'W')
                        ,'4WK Avrg Vol' DIV
                    #end
                    #if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')
                        #if (${orgdst} == 'FM')
                            ,(
                                SELECT 
                                #if (${fmtoat} == '1')
                                    #if (${fmtypeby} == 'R')
                                        RCC_CD
                                    #elseif (${fmtypeby} == 'C')
                                        CNT_CD
                                    #elseif (${fmtypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #else
                                    #if (${attypeby} == 'R')
                                        RCC_CD
                                    #elseif (${attypeby} == 'C')
                                        CNT_CD
                                    #elseif (${attypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #end
                                FROM EQR_ECC_MST 
                                WHERE ECC_CD = T.ECC_CD
                            ) FM_ECC_CD
                            , '' TO_ECC_CD
                        #else
                            , '' FM_ECC_CD
                            ,(
                                SELECT 
                                #if (${fmtoat} == '1')
                                    #if (${fmtypeby} == 'R')
                                        RCC_CD
                                    #elseif (${fmtypeby} == 'C')
                                        CNT_CD
                                    #elseif (${fmtypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #else
                                    #if (${attypeby} == 'R')
                                        RCC_CD
                                    #elseif (${attypeby} == 'C')
                                        CNT_CD
                                    #elseif (${attypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #end
                                FROM EQR_ECC_MST 
                                WHERE ECC_CD = T.ECC_CD
                            ) TO_ECC_CD
                        #end
                    #else
                        #if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')
                            , T.FM_ECC_CD
                        #else
                            ,'' FM_ECC_CD
                        #end
                        #if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')
                            ,T.TO_ECC_CD
                        #else
                            ,'' TO_ECC_CD
                        #end
                    #end
                    #if (${dataselect1} == 'P')
                        , SUM(T.CNTR_QTY) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            #if (${weeklygubun} != 'Weekly4')
                                #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                    , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                                #else
                                    #if (${key} == 'O2')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                    #elseif (${key} == 'O4')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                    #elseif (${key} == 'F2')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                    #elseif (${key} == 'F4')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                    #end
                                #end
                            #else
                                #if (${dataselect1} == 'P')
                                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                        , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                                    #else
                                        #if (${key} == 'O2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                        #elseif (${key} == 'O4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                        #elseif (${key} == 'F2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                        #elseif (${key} == 'F4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                        #end
                                    #end
                                #elseif (${dataselect2} == 'P')
                                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                        , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                                    #else
                                        #if (${key} == 'O2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                        #elseif (${key} == 'O4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                        #elseif (${key} == 'F2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                        #elseif (${key} == 'F4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                        #end
                                    #end
                                #else
                                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                        , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                                    #else
                                        #if (${key} == 'O2')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY
                                        #elseif (${key} == 'O4')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY
                                        #elseif (${key} == 'F2')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY
                                        #elseif (${key} == 'F4')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY
                                        #end
                                    #end
                                #end
                            #end
                        #end
                    #else
                        #if (${weeklygubun} != 'Weekly4')
                            , SUM(T.CNTR_VOL_QTY) TOTAL
                        #else
                            , NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL
                        #end
                        #foreach ($key in ${arrCntrTpszCd})
                            #if (${weeklygubun} != 'Weekly4')
                                , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY
                            #else
                                , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                            #end
                        #end
                    #end
                    , '1' SEQ
                    #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                        FROM 
                        #if (${dataselect1} == 'P')
                            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                                EQR_FULL_CNTR_PERF
                            #else
                                EQR_FULL_CNTR_FM_TO_PERF
                            #end
                        #elseif (${dataselect1} == 'D')
                            EQR_OB_FCAST
                        #elseif (${dataselect1} == 'S')
                            EQR_SLS_INP_FCAST
                        #elseif (${dataselect1} == 'T')
                            EQR_SLS_STAT_FCAST
                        #elseif (${dataselect1} == 'W')
                            EQR_AVG_FCAST
                        #end
                        T,
                        #if (${dataselect2} == 'P')
                            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                                EQR_FULL_CNTR_PERF
                            #else
                                EQR_FULL_CNTR_FM_TO_PERF
                            #end
                        #elseif (${dataselect2} == 'D')
                            EQR_OB_FCAST
                        #elseif (${dataselect2} == 'S')
                            EQR_SLS_INP_FCAST
                        #elseif (${dataselect2} == 'T')
                            EQR_SLS_STAT_FCAST
                        #elseif (${dataselect2} == 'W')
                            EQR_AVG_FCAST
                        #end
                        T2
                    #else
                        FROM 
                        #if (${dataselect1} == 'P')
                            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                                EQR_FULL_CNTR_PERF
                            #else
                                EQR_FULL_CNTR_FM_TO_PERF
                            #end
                        #elseif (${dataselect1} == 'D')
                            EQR_OB_FCAST
                        #elseif (${dataselect1} == 'S')
                            EQR_SLS_INP_FCAST
                        #elseif (${dataselect1} == 'T')
                            EQR_SLS_STAT_FCAST
                        #elseif (${dataselect1} == 'W')
                            EQR_AVG_FCAST
                        #end
                        T
                    #end
                    #if (${fmtoat} == '1')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrFmEccCd.size() > 0)
                            #if (${fmtype} == 'R')
                                AND RCC_CD
                            #elseif (${fmtype} == 'L')
                                AND LCC_CD
                            #else
                                AND ECC_CD
                            #end
                            IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )) C
                        #else
                            ) C
                        #end
                    #else
                        #if (${attype} != '')
                            ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                            #if (${attype} == 'R')
                                AND RCC_CD
                            #elseif (${attype} == 'L')
                                AND LCC_CD
                            #else
                                AND ECC_CD
                            #end
                            IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )) C
                        #end
                    #end
                    #if (${fmtoat} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrToEccCd.size() > 0)
                            #if (${totype} == 'R')
                                AND RCC_CD
                            #elseif (${totype} == 'L')
                                AND LCC_CD
                            #else
                                AND ECC_CD
                            #end
                            IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )) D
                        #else
                            ) D
                        #end
                    #end
                    WHERE 
                    #if (${dataselect1} == 'D')
                        T.SCNR_ID = '$key.get(2)'
                    #else
                        #if (${dataselect1} != 'P')
                            T.YRWK = '$key.get(0)'
                        #else
                            T.YRWK = '$key.get(1)'
                        #end
                    #end
                    #if (${dataselect1} != 'P')
                        #if (${weeklygubun} == 'Weekly4')
                            AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'
                        #else
                            AND T.FCAST_YRWK = '$key.get(1)'
                        #end
                    #end
                    #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                        #if (${dataselect1} == 'D')
                            AND T2.YRWK = '$key.get(0)'
                        #end
                        #if (${dataselect2} == 'D')
                            AND T2.SCNR_ID = '$key.get(2)'
                        #end
                    #end
                    #if (${dataselect1} == 'P')
                        #if (${fmtoat} == '1')
                            #if (${orgdst} == 'FMTO')
                                AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)
                            #else
                                AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)
                            #end
                        #else
                            #if (${attype} != '')
                                #if (${orgdst} == 'FMTO')
                                    AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                                #else
                                    AND (T.ECC_CD = C.ECC_CD)
                                #end
                            #end
                        #end
                    #else
                        #if (${fmtoat} == '1')
                            AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD
                        #else
                            #if (${dataselect2} == '')
                                #if (${attype} != '')
                                    AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)
                                #end
                            #else
                                #if (${attype} != '')
                                    #if (${orgdst} == 'FMTO')
                                        AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                                    #else
                                        AND (T.TO_ECC_CD = C.ECC_CD)
                                    #end
                                #end
                            #end
                        #end
                    #end
                    #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                        #if (${dataselect1} != 'D' && ${dataselect2} != 'D')
                            AND T.FM_ECC_CD = T2.FM_ECC_CD
                            AND T.TO_ECC_CD = T2.TO_ECC_CD
                            AND T.CO_CD = T2.CO_CD
                            AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                            AND T.YRWK = T2.YRWK
                            AND T.FCAST_YRWK = T2.FCAST_YRWK
                            AND T.FCAST_DT = T2.FCAST_DT
                        #else
                            #if (${dataselect1} == 'D')
                                AND T.FM_ECC_CD = T2.FM_ECC_CD
                                AND T.TO_ECC_CD = T2.TO_ECC_CD
                                AND T.CO_CD = T2.CO_CD
                                AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                                AND SUBSTR(T.SCNR_ID,5,6) = T2.YRWK
                                AND T.FCAST_YRWK = T2.FCAST_YRWK
                                AND T.FCAST_DT = T2.FCAST_DT
                            #end
                            #if (${dataselect2} == 'D')
                                AND T.FM_ECC_CD = T2.FM_ECC_CD
                                AND T.TO_ECC_CD = T2.TO_ECC_CD
                                AND T.CO_CD = T2.CO_CD
                                AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                                AND T.YRWK = SUBSTR(T2.SCNR_ID,5,6)
                                AND T.FCAST_YRWK = T2.FCAST_YRWK
                                AND T.FCAST_DT = T2.FCAST_DT
                            #end
                        #end
                    #end
                    #if (${inclmatch} == '1')
                        -- 20070814 ChangHo Chae  조건 변경 추가
                        -- 기존 아래의 것을 AND T.CNTR_VOL_QTY > 0 아래의 형태로 변경
                        #if (${dataselect1} != 'P')
                            AND T.CNTR_VOL_QTY > 0
                        #else
                            AND T.CNTR_QTY > 0
                        #end
                    #end
                    #if ($arrCntrTpszCd.size() > 0)
                        AND T.CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            '$key',
                        #end
                        'F5','S2','S4','A2','A4' )
                    #end
                    #if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')
                        AND T.IO_BND_CD = 
                        #if (${orgdst} == 'FM')
                            'O'
                        #else
                            'I'
                        #end
                        GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD
                    #elseif (${dataselect1} == 'P' && ${orgdst} == 'FMTO')
                        GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                    #else
                        #if (${orgdst} == 'FM')
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                            #end
                        #elseif (${orgdst} == 'TO')
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                            #end
                        #else
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                            #end
                        #end
                    #end
                    #if($velocityCount < $arrWkResult.size())
                        UNION ALL
                    #end
                #end
                --DATA SELECT 2 START--------------------------------------
                UNION ALL
                #foreach ($key in ${arrWkResult})
                    #if (${dataselect2} == 'P')
                        #if(${weekmonth} == 'W')
                            SELECT  T.YRWK WEEK
                        #else
                            SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK
                        #end
                    #else
                        SELECT 
                        #if (${weekmonth} == 'W')
                            #if (${weeklygubun} == 'Weekly4')
                                MIN(T.FCAST_YRWK) WEEK
                            #else
                                T.FCAST_YRWK WEEK
                            #end
                        #else
                            (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK
                        #end
                    #end
                    ,DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY
                    #if (${dataselect2} == 'P')
                        ,'Performance' DIV
                    #elseif (${dataselect2} == 'D')
                        ,'Demand Forcast' DIV
                    #elseif (${dataselect2} == 'S')
                        ,'Sales Input' DIV
                    #elseif (${dataselect2} == 'T')
                        ,'Statistical' DIV
                    #elseif (${dataselect2} == 'W')
                        ,'4WK Avrg Vol' DIV
                    #end
                    #if (${dataselect2} == 'P' && ${orgdst} != 'FMTO')
                        #if (${orgdst} == 'FM')
                            ,(
                                SELECT 
                                #if (${fmtoat} == '1')
                                    #if (${fmtypeby} == 'R')
                                        RCC_CD
                                    #elseif (${fmtypeby} == 'C')
                                        CNT_CD
                                    #elseif (${fmtypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #else
                                    #if (${attypeby} == 'R')
                                        RCC_CD
                                    #elseif (${attypeby} == 'C')
                                        CNT_CD
                                    #elseif (${attypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #end
                                FROM EQR_ECC_MST 
                                WHERE ECC_CD = T.ECC_CD
                            ) FM_ECC_CD
                            , '' TO_ECC_CD
                        #else
                            , '' FM_ECC_CD
                            ,(
                                SELECT 
                                #if (${fmtoat} == '1')
                                    #if (${fmtypeby} == 'R')
                                        RCC_CD
                                    #elseif (${fmtypeby} == 'C')
                                        CNT_CD
                                    #elseif (${fmtypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #else
                                    #if (${attypeby} == 'R')
                                        RCC_CD
                                    #elseif (${attypeby} == 'C')
                                        CNT_CD
                                    #elseif (${attypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #end
                                FROM EQR_ECC_MST 
                                WHERE ECC_CD = T.ECC_CD
                            ) TO_ECC_CD
                        #end
                    #else
                        #if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')
                            ,(
                                SELECT
                                #if (${fmtoat} == '1')
                                    #if (${fmtypeby} == 'R')
                                        RCC_CD
                                    #elseif (${fmtypeby} == 'C')
                                        CNT_CD
                                    #elseif (${fmtypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #else
                                    #if (${attypeby} == 'R')
                                        RCC_CD
                                    #elseif (${attypeby} == 'C')
                                        CNT_CD
                                    #elseif (${attypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #end
                                FROM EQR_ECC_MST
                                WHERE ECC_CD = T.FM_ECC_CD
                            ) FM_ECC_CD
                        #else
                            ,'' FM_ECC_CD
                        #end
                        #if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')
                            ,(
                                SELECT
                                #if (${fmtoat} == '1')
                                    #if (${totypeby} == 'R')
                                        RCC_CD
                                    #elseif (${totypeby} == 'C')
                                        CNT_CD
                                    #elseif (${totypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #else
                                    #if (${attypeby} == 'R')
                                        RCC_CD
                                    #elseif (${attypeby} == 'C')
                                        CNT_CD
                                    #elseif (${attypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #end
                                FROM EQR_ECC_MST
                                WHERE ECC_CD = T.TO_ECC_CD
                            ) TO_ECC_CD
                        #else
                            ,'' TO_ECC_CD
                        #end
                    #end
                    #if (${dataselect2} == 'P')
                        , SUM(T.CNTR_QTY) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            #if (${weeklygubun} != 'Weekly4')
                                #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                    , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                                #else
                                    #if (${key} == 'O2')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                    #elseif (${key} == 'O4')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                    #elseif (${key} == 'F2')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                    #elseif (${key} == 'F4')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                    #end
                                #end
                            #else
                                #if (${dataselect1} == 'P')
                                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                        , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                                    #else
                                        #if (${key} == 'O2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                        #elseif (${key} == 'O4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                        #elseif (${key} == 'F2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                        #elseif (${key} == 'F4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                        #end
                                    #end
                                #elseif (${dataselect2} == 'P')
                                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                        , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                                    #else
                                        #if (${key} == 'O2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                        #elseif (${key} == 'O4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                        #elseif (${key} == 'F2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                        #elseif (${key} == 'F4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                        #end
                                    #end
                                #else
                                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                        , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                                    #else
                                        #if (${key} == 'O2')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY
                                        #elseif (${key} == 'O4')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY
                                        #elseif (${key} == 'F2')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY
                                        #elseif (${key} == 'F4')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY
                                        #end
                                    #end
                                #end
                            #end
                        #end
                    #else
                        #if (${weeklygubun} != 'Weekly4')
                            , SUM(T.CNTR_VOL_QTY) TOTAL
                        #else
                            , NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL
                        #end
                        #foreach ($key in ${arrCntrTpszCd})
                            #if (${weeklygubun} != 'Weekly4')
                                , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY
                            #else
                                , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                            #end
                        #end
                    #end
                    , '2' SEQ
                    #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                        FROM 
                        #if (${dataselect2} == 'P')
                            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                                EQR_FULL_CNTR_PERF
                            #else
                                EQR_FULL_CNTR_FM_TO_PERF
                            #end
                        #elseif (${dataselect2} == 'D')
                            EQR_OB_FCAST
                        #elseif (${dataselect2} == 'S')
                            EQR_SLS_INP_FCAST
                        #elseif (${dataselect2} == 'T')
                            EQR_SLS_STAT_FCAST
                        #elseif (${dataselect2} == 'W')
                            EQR_AVG_FCAST
                        #end
                        T ,
                        #if (${dataselect1} == 'P')
                            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                                EQR_FULL_CNTR_PERF
                            #else
                                EQR_FULL_CNTR_FM_TO_PERF
                            #end
                        #elseif (${dataselect1} == 'D')
                            EQR_OB_FCAST
                        #elseif (${dataselect1} == 'S')
                            EQR_SLS_INP_FCAST
                        #elseif (${dataselect1} == 'T')
                            EQR_SLS_STAT_FCAST
                        #elseif (${dataselect1} == 'W')
                            EQR_AVG_FCAST
                        #end
                        T2
                    #else
                        FROM 
                        #if (${dataselect2} == 'P')
                            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                                EQR_FULL_CNTR_PERF
                            #else
                                EQR_FULL_CNTR_FM_TO_PERF
                            #end
                        #elseif (${dataselect2} == 'D')
                            EQR_OB_FCAST
                        #elseif (${dataselect2} == 'S')
                            EQR_SLS_INP_FCAST
                        #elseif (${dataselect2} == 'T')
                            EQR_SLS_STAT_FCAST
                        #elseif (${dataselect2} == 'W')
                            EQR_AVG_FCAST
                        #end
                        T
                    #end
                    #if (${fmtoat} == '1')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrFmEccCd.size() > 0)
                            #if (${fmtype} == 'R')
                                AND RCC_CD
                            #elseif (${fmtype} == 'L')
                                AND LCC_CD
                            #else
                                AND ECC_CD
                            #end
                            IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )) C
                        #else
                            ) C
                        #end
                    #else
                        #if (${attype} != '')
                            ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                            #if (${attype} == 'R')
                                AND RCC_CD
                            #elseif (${attype} == 'L')
                                AND LCC_CD
                            #else
                                AND ECC_CD
                            #end
                            IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )) C
                        #end
                    #end
                    #if (${fmtoat} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrToEccCd.size() > 0)
                            #if (${totype} == 'R')
                                AND RCC_CD
                            #elseif (${totype} == 'L')
                                AND LCC_CD
                            #else
                                AND ECC_CD
                            #end
                            IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )) D
                        #else
                            ) D
                        #end
                    #end
                    WHERE 
                    #if (${dataselect2} == 'D')
                        T.SCNR_ID = '$key.get(2)'
                    #else
                        #if (${dataselect2} != 'P')
                            T.YRWK = '$key.get(0)'
                        #else
                            T.YRWK = '$key.get(1)'
                        #end
                    #end
                    #if (${dataselect2} != 'P')
                        #if (${weeklygubun} == 'Weekly4')
                            AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'
                        #else
                            AND T.FCAST_YRWK = '$key.get(1)'
                        #end
                    #end
                    #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                        #if (${dataselect2} == 'D')
                            AND T2.YRWK = '$key.get(0)'
                        #end
                        #if (${dataselect1} == 'D')
                            AND T2.SCNR_ID = '$key.get(2)'
                        #end
                    #end
                    #if (${dataselect2} == 'P')
                        #if (${fmtoat} == '1')
                            #if (${orgdst} == 'FMTO')
                                AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)
                            #else
                                AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)
                            #end
                        #else
                            #if (${attype} != '')
                                #if (${orgdst} == 'FMTO')
                                    AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                                #else
                                    AND (T.ECC_CD = C.ECC_CD)
                                #end
                            #end
                        #end
                    #else
                        #if (${fmtoat} == '1')
                            AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD
                        #else
                            #if (${dataselect2} == '')
                                #if (${attype} != '')
                                    AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)
                                #end
                            #else
                                #if (${attype} != '')
                                    #if (${orgdst} == 'FMTO')
                                        AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                                    #else
                                        AND (T.TO_ECC_CD = C.ECC_CD)
                                    #end
                                #end
                            #end
                        #end
                    #end
                    #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                        #if (${dataselect1} != 'D' && ${dataselect2} != 'D')
                            AND T.FM_ECC_CD = T2.FM_ECC_CD
                            AND T.TO_ECC_CD = T2.TO_ECC_CD
                            AND T.CO_CD = T2.CO_CD
                            AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                            AND T.YRWK = T2.YRWK
                            AND T.FCAST_YRWK = T2.FCAST_YRWK
                            AND T.FCAST_DT = T2.FCAST_DT
                        #else
                            #if (${dataselect1} == 'D')
                                AND T.FM_ECC_CD = T2.FM_ECC_CD
                                AND T.TO_ECC_CD = T2.TO_ECC_CD
                                AND T.CO_CD = T2.CO_CD
                                AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                                AND T.YRWK = SUBSTR(T2.SCNR_ID,5,6)
                                AND T.FCAST_YRWK = T2.FCAST_YRWK
                                AND T.FCAST_DT = T2.FCAST_DT
                            #end
                            #if (${dataselect2} == 'D')
                                AND T.FM_ECC_CD = T2.FM_ECC_CD
                                AND T.TO_ECC_CD = T2.TO_ECC_CD
                                AND T.CO_CD = T2.CO_CD
                                AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                                AND SUBSTR(T.SCNR_ID,5,6) = T2.YRWK
                                AND T.FCAST_YRWK = T2.FCAST_YRWK
                                AND T.FCAST_DT = T2.FCAST_DT
                            #end
                        #end
                    #end
                    #if ($arrCntrTpszCd.size() > 0)
                        AND T.CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            '$key',
                        #end
                        'F5','S2','S4','A2','A4' )
                    #end
                    #if (${dataselect1} == 'P')
                        #if (${orgdst} == 'FM')
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                            #end
                        #elseif (${orgdst} == 'TO')
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                            #end
                        #else
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                            #end
                        #end
                    #elseif (${dataselect2} == 'P' && ${orgdst} != 'FMTO')
                        AND T.IO_BND_CD = 
                        #if (${orgdst} == 'FM')
                            'O'
                        #else
                            'I'
                        #end
                        GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD
                    #elseif (${dataselect2} == 'P' && ${orgdst} == 'FMTO')
                        GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                    #else
                        #if (${orgdst} == 'FM')
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                            #end
                        #elseif (${orgdst} == 'TO')
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                            #end
                        #else
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                            #end
                        #end
                    #end
                    #if($velocityCount < $arrWkResult.size())
                        UNION ALL
                    #end
                #end
                --DATA SELECT 2 END--------------------------------------
                #if (${weekmonth} == 'W')
                    )
                    GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
                #else
                    #if (${dataselect1} != '' && ${dataselect2} != '')
                        #if (${orgdst} == 'FM')
                            )
                            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
                        #elseif (${orgdst} == 'TO')
                            )
                            GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ
                        #elseif (${orgdst} == 'FMTO')
                            )
                            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
                        #end
                    #elseif (${dataselect1} == 'P' && ${dataselect2} == '')
                        #if (${orgdst} == 'FM')
                            )
                            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
                        #elseif (${orgdst} == 'TO')
                            )
                            GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ
                        #elseif (${orgdst} == 'FMTO')
                            )
                            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
                        #end
                    #elseif (${dataselect1} != 'P' && ${dataselect2} == '')
                        )
                        GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
                    #end
                #end
            )
            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD , TO_ECC_CD, SEQ
        )
        GROUP BY WEEK, COMPANY, FM_ECC_CD, TO_ECC_CD
        --UNMATCH END--------------------------------------
    #end
    #if (${inclmatch} == '1')
        --MATCH START--------------------------------------
        UNION ALL
        SELECT 
            WEEK 
            ,COMPANY CO_CD
            ,'Match Ratio(%)' DIV
            #if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')
                , FM_ECC_CD
            #else
                ,'' FM_ECC_CD
            #end
            #if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')
                ,TO_ECC_CD
            #else
                ,'' TO_ECC_CD
            #end
            #if (${weeklygubun} != 'Weekly4')
                , ROUND((1- ( ABS(SUM(DECODE(SEQ,'2', TOTAL )) - SUM(DECODE ( SEQ , '1' , TOTAL ))) /  SUM(DECODE ( SEQ , '1' , TOTAL )))) * 100,2) TOTAL
            #else
                , ROUND((1- ( ABS(SUM(DECODE(SEQ,'2', TOTAL )) - SUM(DECODE ( SEQ , '1' , TOTAL ))) /  DECODE(SUM(DECODE ( SEQ , '1' , TOTAL )),0,NULL,SUM(DECODE ( SEQ , '1' , TOTAL ))))) * 100,2) TOTAL
            #end
            #foreach ($key in ${arrCntrTpszCd})
                #if (${weeklygubun} != 'Weekly4')
                    , ROUND((1- ( ABS(SUM(DECODE(SEQ,'2', ${key}CNTR_VOL_QTY )) - SUM(DECODE ( SEQ , '1' , ${key}CNTR_VOL_QTY ))) / SUM(DECODE ( SEQ , '1' , ${key}CNTR_VOL_QTY )))) * 100,2) ${key}CNTR_VOL_QTY
                #else
                    , ROUND((1- ( ABS(SUM(DECODE(SEQ,'2', ${key}CNTR_VOL_QTY )) - SUM(DECODE ( SEQ , '1' , ${key}CNTR_VOL_QTY ))) / DECODE(SUM(DECODE ( SEQ , '1' , ${key}CNTR_VOL_QTY )),0,NULL ,SUM(DECODE ( SEQ , '1' , ${key}CNTR_VOL_QTY ))))) * 100,2) ${key}CNTR_VOL_QTY
                #end
            #end
            , '4' SEQ
        FROM
        (
            SELECT 
                WEEK
                , COMPANY
                , DIV
                , FM_ECC_CD
                , TO_ECC_CD
                , SUM(TOTAL) TOTAL
                #foreach ($key in ${arrCntrTpszCd})
                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                #end
                , SEQ
            FROM (
                #if (${weekmonth} == 'W')
                    SELECT
                        WEEK
                        , COMPANY
                        , DIV
                        , FM_ECC_CD
                        , TO_ECC_CD
                        , SUM(TOTAL) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                        #end
                        , SEQ
                    FROM  (
                #else
                    #if (${dataselect1} != '' && ${dataselect2} != '')
                        #if (${orgdst} == 'FM')
                            SELECT
                                WEEK
                                , COMPANY
                                , DIV
                                , FM_ECC_CD
                                , '' TO_ECC_CD
                                , SUM(TOTAL) TOTAL
                                #foreach ($key in ${arrCntrTpszCd})
                                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                                #end
                                , SEQ
                            FROM  (
                        #elseif (${orgdst} == 'TO')
                            SELECT
                                WEEK
                                , COMPANY
                                , DIV
                                , '' FM_ECC_CD
                                , TO_ECC_CD
                                , SUM(TOTAL) TOTAL
                                #foreach ($key in ${arrCntrTpszCd})
                                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                                #end
                                , SEQ
                            FROM  (
                        #elseif (${orgdst} == 'FMTO')
                            SELECT
                                WEEK
                                , COMPANY
                                , DIV
                                , FM_ECC_CD
                                , TO_ECC_CD
                                , SUM(TOTAL) TOTAL
                                #foreach ($key in ${arrCntrTpszCd})
                                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                                #end
                                , SEQ
                            FROM  (
                        #end
                    #elseif (${dataselect1} == 'P' && ${dataselect2} == '')
                        #if (${orgdst} == 'FM')
                            SELECT
                                WEEK
                                , COMPANY
                                , DIV
                                , FM_ECC_CD
                                , '' TO_ECC_CD
                                , SUM(TOTAL) TOTAL
                                #foreach ($key in ${arrCntrTpszCd})
                                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                                #end
                                , SEQ
                            FROM  (
                        #elseif (${orgdst} == 'TO')
                            SELECT
                                WEEK
                                , COMPANY
                                , DIV
                                , '' FM_ECC_CD
                                , TO_ECC_CD
                                , SUM(TOTAL) TOTAL
                                #foreach ($key in ${arrCntrTpszCd})
                                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                                #end
                                , SEQ
                            FROM  (
                        #elseif (${orgdst} == 'FMTO')
                            SELECT
                                WEEK
                                , COMPANY
                                , DIV
                                , FM_ECC_CD
                                , TO_ECC_CD
                                , SUM(TOTAL) TOTAL
                                #foreach ($key in ${arrCntrTpszCd})
                                    , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                                #end
                                , SEQ
                            FROM  (
                        #end
                    #elseif (${dataselect1} != 'P' && ${dataselect2} == '')
                        SELECT
                            WEEK
                            , COMPANY
                            , DIV
                            , FM_ECC_CD
                            , '' TO_ECC_CD
                            , SUM(TOTAL) TOTAL
                            #foreach ($key in ${arrCntrTpszCd})
                                , SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY
                            #end
                            , SEQ
                        FROM  (
                    #end
                #end
                --DATA SELECT 1 START--------------------------------------
                #foreach ($key in ${arrWkResult})
                    #if (${dataselect1} == 'P')
                        #if (${weekmonth} == 'W')
                            SELECT  T.YRWK WEEK
                        #else
                            SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK
                        #end
                    #else
                        SELECT 
                        #if (${weekmonth} == 'W')
                            #if (${weeklygubun} == 'Weekly4')
                                MIN(T.FCAST_YRWK) WEEK
                            #else
                                T.FCAST_YRWK WEEK
                            #end
                        #else
                            (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK
                        #end
                    #end
                    ,DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY
                    #if (${dataselect1} == 'P')
                        ,'Performance' DIV
                    #elseif (${dataselect1} == 'D')
                        ,'Demand Forcast' DIV
                    #elseif (${dataselect1} == 'S')
                        ,'Sales Input' DIV
                    #elseif (${dataselect1} == 'T')
                        ,'Statistical' DIV
                    #elseif (${dataselect1} == 'W')
                        ,'4WK Avrg Vol' DIV
                    #end
                    #if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')
                        #if (${orgdst} == 'FM')
                            ,(
                                SELECT 
                                #if (${fmtoat} == '1')
                                    #if (${fmtypeby} == 'R')
                                        RCC_CD
                                    #elseif (${fmtypeby} == 'C')
                                        CNT_CD
                                    #elseif (${fmtypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #else
                                    #if (${attypeby} == 'R')
                                        RCC_CD
                                    #elseif (${attypeby} == 'C')
                                        CNT_CD
                                    #elseif (${attypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #end
                                FROM EQR_ECC_MST 
                                WHERE ECC_CD = T.ECC_CD
                            ) FM_ECC_CD
                            , '' TO_ECC_CD
                        #else
                            , '' FM_ECC_CD
                            ,(
                                SELECT 
                                #if (${fmtoat} == '1')
                                    #if (${fmtypeby} == 'R')
                                        RCC_CD
                                    #elseif (${fmtypeby} == 'C')
                                        CNT_CD
                                    #elseif (${fmtypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #else
                                    #if (${attypeby} == 'R')
                                        RCC_CD
                                    #elseif (${attypeby} == 'C')
                                        CNT_CD
                                    #elseif (${attypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #end
                                FROM EQR_ECC_MST 
                                WHERE ECC_CD = T.ECC_CD
                            ) TO_ECC_CD
                        #end
                    #else
                        #if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')
                            , T.FM_ECC_CD
                        #else
                            ,'' FM_ECC_CD
                        #end
                        #if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')
                            ,T.TO_ECC_CD
                        #else
                            ,'' TO_ECC_CD
                        #end
                    #end
                    #if (${dataselect1} == 'P')
                        , SUM(T.CNTR_QTY) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            #if (${weeklygubun} != 'Weekly4')
                                #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                    , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                                #else
                                    #if (${key} == 'O2')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                    #elseif (${key} == 'O4')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                    #elseif (${key} == 'F2')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                    #elseif (${key} == 'F4')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                    #end
                                #end
                            #else
                                #if (${dataselect1} == 'P')
                                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                        , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                                    #else
                                        #if (${key} == 'O2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                        #elseif (${key} == 'O4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                        #elseif (${key} == 'F2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                        #elseif (${key} == 'F4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                        #end
                                    #end
                                #elseif (${dataselect2} == 'P')
                                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                        , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                                    #else
                                        #if (${key} == 'O2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                        #elseif (${key} == 'O4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                        #elseif (${key} == 'F2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                        #elseif (${key} == 'F4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                        #end
                                    #end
                                #else
                                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                        , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                                    #else
                                        #if (${key} == 'O2')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY
                                        #elseif (${key} == 'O4')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY
                                        #elseif (${key} == 'F2')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY
                                        #elseif (${key} == 'F4')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY
                                        #end
                                    #end
                                #end
                            #end
                        #end
                    #else
                        #if (${weeklygubun} != 'Weekly4')
                            , SUM(T.CNTR_VOL_QTY) TOTAL
                        #else
                            , NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL
                        #end
                        #foreach ($key in ${arrCntrTpszCd})
                            #if (${weeklygubun} != 'Weekly4')
                                , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY
                            #else
                                , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                            #end
                        #end
                    #end
                    , '1' SEQ
                    #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                        FROM 
                        #if (${dataselect1} == 'P')
                            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                                EQR_FULL_CNTR_PERF
                            #else
                                EQR_FULL_CNTR_FM_TO_PERF
                            #end
                        #elseif (${dataselect1} == 'D')
                            EQR_OB_FCAST
                        #elseif (${dataselect1} == 'S')
                            EQR_SLS_INP_FCAST
                        #elseif (${dataselect1} == 'T')
                            EQR_SLS_STAT_FCAST
                        #elseif (${dataselect1} == 'W')
                            EQR_AVG_FCAST
                        #end
                        T,
                        #if (${dataselect2} == 'P')
                            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                                EQR_FULL_CNTR_PERF
                            #else
                                EQR_FULL_CNTR_FM_TO_PERF
                            #end
                        #elseif (${dataselect2} == 'D')
                            EQR_OB_FCAST
                        #elseif (${dataselect2} == 'S')
                            EQR_SLS_INP_FCAST
                        #elseif (${dataselect2} == 'T')
                            EQR_SLS_STAT_FCAST
                        #elseif (${dataselect2} == 'W')
                            EQR_AVG_FCAST
                        #end
                        T2
                    #else
                        FROM 
                        #if (${dataselect1} == 'P')
                            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                                EQR_FULL_CNTR_PERF
                            #else
                                EQR_FULL_CNTR_FM_TO_PERF
                            #end
                        #elseif (${dataselect1} == 'D')
                            EQR_OB_FCAST
                        #elseif (${dataselect1} == 'S')
                            EQR_SLS_INP_FCAST
                        #elseif (${dataselect1} == 'T')
                            EQR_SLS_STAT_FCAST
                        #elseif (${dataselect1} == 'W')
                            EQR_AVG_FCAST
                        #end
                        T
                    #end
                    #if (${fmtoat} == '1')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrFmEccCd.size() > 0)
                            #if (${fmtype} == 'R')
                                AND RCC_CD
                            #elseif (${fmtype} == 'L')
                                AND LCC_CD
                            #else
                                AND ECC_CD
                            #end
                            IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )) C
                        #else
                            ) C
                        #end
                    #else
                        #if (${attype} != '')
                            ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                            #if (${attype} == 'R')
                                AND RCC_CD
                            #elseif (${attype} == 'L')
                                AND LCC_CD
                            #else
                                AND ECC_CD
                            #end
                            IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )) C
                        #end
                    #end
                    #if (${fmtoat} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrToEccCd.size() > 0)
                            #if (${totype} == 'R')
                                AND RCC_CD
                            #elseif (${totype} == 'L')
                                AND LCC_CD
                            #else
                                AND ECC_CD
                            #end
                            IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )) D
                        #else
                            ) D
                        #end
                    #end
                    WHERE 
                    #if (${dataselect1} == 'D')
                        T.SCNR_ID = '$key.get(2)'
                    #else
                        #if (${dataselect1} != 'P')
                            T.YRWK = '$key.get(0)'
                        #else
                            T.YRWK = '$key.get(1)'
                        #end
                    #end
                    #if (${dataselect1} != 'P')
                        #if (${weeklygubun} == 'Weekly4')
                            AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'
                        #else
                            AND T.FCAST_YRWK = '$key.get(1)'
                        #end
                    #end
                    #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                        #if (${dataselect1} == 'D')
                            AND T2.YRWK = '$key.get(0)'
                        #end
                        #if (${dataselect2} == 'D')
                            AND T2.SCNR_ID = '$key.get(2)'
                        #end
                    #end
                    #if (${dataselect1} == 'P')
                        #if (${fmtoat} == '1')
                            #if (${orgdst} == 'FMTO')
                                AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)
                            #else
                                AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)
                            #end
                        #else
                            #if (${attype} != '')
                                #if (${orgdst} == 'FMTO')
                                    AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                                #else
                                    AND (T.ECC_CD = C.ECC_CD)
                                #end
                            #end
                        #end
                    #else
                        #if (${fmtoat} == '1')
                            AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD
                        #else
                            #if (${dataselect2} == '')
                                #if (${attype} != '')
                                    AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)
                                #end
                            #else
                                #if (${attype} != '')
                                    #if (${orgdst} == 'FMTO')
                                        AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                                    #else
                                        AND (T.TO_ECC_CD = C.ECC_CD)
                                    #end
                                #end
                            #end
                        #end
                    #end
                    #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                        #if (${dataselect1} != 'D' && ${dataselect2} != 'D')
                            AND T.FM_ECC_CD = T2.FM_ECC_CD
                            AND T.TO_ECC_CD = T2.TO_ECC_CD
                            AND T.CO_CD = T2.CO_CD
                            AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                            AND T.YRWK = T2.YRWK
                            AND T.FCAST_YRWK = T2.FCAST_YRWK
                            AND T.FCAST_DT = T2.FCAST_DT
                        #else
                            #if (${dataselect1} == 'D')
                                AND T.FM_ECC_CD = T2.FM_ECC_CD
                                AND T.TO_ECC_CD = T2.TO_ECC_CD
                                AND T.CO_CD = T2.CO_CD
                                AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                                AND SUBSTR(T.SCNR_ID,5,6) = T2.YRWK
                                AND T.FCAST_YRWK = T2.FCAST_YRWK
                                AND T.FCAST_DT = T2.FCAST_DT
                            #end
                            #if (${dataselect2} == 'D')
                                AND T.FM_ECC_CD = T2.FM_ECC_CD
                                AND T.TO_ECC_CD = T2.TO_ECC_CD
                                AND T.CO_CD = T2.CO_CD
                                AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                                AND T.YRWK = SUBSTR(T2.SCNR_ID,5,6)
                                AND T.FCAST_YRWK = T2.FCAST_YRWK
                                AND T.FCAST_DT = T2.FCAST_DT
                            #end
                        #end
                    #end
                    #if (${inclmatch} == '1')
                        -- 20070814 ChangHo Chae  조건 변경 추가
                        -- 기존 아래의 것을 AND T.CNTR_VOL_QTY > 0 아래의 형태로 변경
                        #if (${dataselect1} != 'P')
                            AND T.CNTR_VOL_QTY > 0
                        #else
                            AND T.CNTR_QTY > 0
                        #end
                    #end
                    #if ($arrCntrTpszCd.size() > 0)
                        AND T.CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            '$key',
                        #end
                        'F5','S2','S4','A2','A4' )
                    #end
                    #if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')
                        AND T.IO_BND_CD = 
                        #if (${orgdst} == 'FM')
                            'O'
                        #else
                            'I'
                        #end
                        GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD
                    #elseif (${dataselect1} == 'P' && ${orgdst} == 'FMTO')
                        GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                    #else
                        #if (${orgdst} == 'FM')
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                            #end
                        #elseif (${orgdst} == 'TO')
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                            #end
                        #else
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                            #end
                        #end
                    #end
                    #if($velocityCount < $arrWkResult.size())
                        UNION ALL
                    #end
                #end
                --DATA SELECT 2 START--------------------------------------
                UNION ALL
                #foreach ($key in ${arrWkResult})
                    #if (${dataselect2} == 'P')
                        #if(${weekmonth} == 'W')
                            SELECT  T.YRWK WEEK
                        #else
                            SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK
                        #end
                    #else
                        SELECT 
                        #if (${weekmonth} == 'W')
                            #if (${weeklygubun} == 'Weekly4')
                                MIN(T.FCAST_YRWK) WEEK
                            #else
                                T.FCAST_YRWK WEEK
                            #end
                        #else
                            (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK
                        #end
                    #end
                    ,DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY
                    #if (${dataselect2} == 'P')
                        ,'Performance' DIV
                    #elseif (${dataselect2} == 'D')
                        ,'Demand Forcast' DIV
                    #elseif (${dataselect2} == 'S')
                        ,'Sales Input' DIV
                    #elseif (${dataselect2} == 'T')
                        ,'Statistical' DIV
                    #elseif (${dataselect2} == 'W')
                        ,'4WK Avrg Vol' DIV
                    #end
                    #if (${dataselect2} == 'P' && ${orgdst} != 'FMTO')
                        #if (${orgdst} == 'FM')
                            ,(
                                SELECT 
                                #if (${fmtoat} == '1')
                                    #if (${fmtypeby} == 'R')
                                        RCC_CD
                                    #elseif (${fmtypeby} == 'C')
                                        CNT_CD
                                    #elseif (${fmtypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #else
                                    #if (${attypeby} == 'R')
                                        RCC_CD
                                    #elseif (${attypeby} == 'C')
                                        CNT_CD
                                    #elseif (${attypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #end
                                FROM EQR_ECC_MST 
                                WHERE ECC_CD = T.ECC_CD
                            ) FM_ECC_CD
                            , '' TO_ECC_CD
                        #else
                            , '' FM_ECC_CD
                            ,(
                                SELECT 
                                #if (${fmtoat} == '1')
                                    #if (${fmtypeby} == 'R')
                                        RCC_CD
                                    #elseif (${fmtypeby} == 'C')
                                        CNT_CD
                                    #elseif (${fmtypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #else
                                    #if (${attypeby} == 'R')
                                        RCC_CD
                                    #elseif (${attypeby} == 'C')
                                        CNT_CD
                                    #elseif (${attypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #end
                                FROM EQR_ECC_MST 
                                WHERE ECC_CD = T.ECC_CD
                            ) TO_ECC_CD
                        #end
                    #else
                        #if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')
                            ,(
                                SELECT
                                #if (${fmtoat} == '1')
                                    #if (${fmtypeby} == 'R')
                                        RCC_CD
                                    #elseif (${fmtypeby} == 'C')
                                        CNT_CD
                                    #elseif (${fmtypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #else
                                    #if (${attypeby} == 'R')
                                        RCC_CD
                                    #elseif (${attypeby} == 'C')
                                        CNT_CD
                                    #elseif (${attypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #end
                                FROM EQR_ECC_MST
                                WHERE ECC_CD = T.FM_ECC_CD
                            ) FM_ECC_CD
                        #else
                            ,'' FM_ECC_CD
                        #end
                        #if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')
                            ,(
                                SELECT
                                #if (${fmtoat} == '1')
                                    #if (${totypeby} == 'R')
                                        RCC_CD
                                    #elseif (${totypeby} == 'C')
                                        CNT_CD
                                    #elseif (${totypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #else
                                    #if (${attypeby} == 'R')
                                        RCC_CD
                                    #elseif (${attypeby} == 'C')
                                        CNT_CD
                                    #elseif (${attypeby} == 'L')
                                        LCC_CD
                                    #else
                                        ECC_CD
                                    #end
                                #end
                                FROM EQR_ECC_MST
                                WHERE ECC_CD = T.TO_ECC_CD
                            ) TO_ECC_CD
                        #else
                            ,'' TO_ECC_CD
                        #end
                    #end
                    #if (${dataselect2} == 'P')
                        , SUM(T.CNTR_QTY) TOTAL
                        #foreach ($key in ${arrCntrTpszCd})
                            #if (${weeklygubun} != 'Weekly4')
                                #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                    , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                                #else
                                    #if (${key} == 'O2')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                    #elseif (${key} == 'O4')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                    #elseif (${key} == 'F2')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                    #elseif (${key} == 'F4')
                                        , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                    #end
                                #end
                            #else
                                #if (${dataselect1} == 'P')
                                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                        , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                                    #else
                                        #if (${key} == 'O2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                        #elseif (${key} == 'O4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                        #elseif (${key} == 'F2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                        #elseif (${key} == 'F4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                        #end
                                    #end
                                #elseif (${dataselect2} == 'P')
                                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                        , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY
                                    #else
                                        #if (${key} == 'O2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY
                                        #elseif (${key} == 'O4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY
                                        #elseif (${key} == 'F2')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY
                                        #elseif (${key} == 'F4')
                                            , SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY
                                        #end
                                    #end
                                #else
                                    #if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')
                                        , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                                    #else
                                        #if (${key} == 'O2')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY
                                        #elseif (${key} == 'O4')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY
                                        #elseif (${key} == 'F2')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY
                                        #elseif (${key} == 'F4')
                                            , NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY
                                        #end
                                    #end
                                #end
                            #end
                        #end
                    #else
                        #if (${weeklygubun} != 'Weekly4')
                            , SUM(T.CNTR_VOL_QTY) TOTAL
                        #else
                            , NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL
                        #end
                        #foreach ($key in ${arrCntrTpszCd})
                            #if (${weeklygubun} != 'Weekly4')
                                , SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY
                            #else
                                , NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY
                            #end
                        #end
                    #end
                    , '2' SEQ
                    #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                        FROM 
                        #if (${dataselect2} == 'P')
                            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                                EQR_FULL_CNTR_PERF
                            #else
                                EQR_FULL_CNTR_FM_TO_PERF
                            #end
                        #elseif (${dataselect2} == 'D')
                            EQR_OB_FCAST
                        #elseif (${dataselect2} == 'S')
                            EQR_SLS_INP_FCAST
                        #elseif (${dataselect2} == 'T')
                            EQR_SLS_STAT_FCAST
                        #elseif (${dataselect2} == 'W')
                            EQR_AVG_FCAST
                        #end
                        T ,
                        #if (${dataselect1} == 'P')
                            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                                EQR_FULL_CNTR_PERF
                            #else
                                EQR_FULL_CNTR_FM_TO_PERF
                            #end
                        #elseif (${dataselect1} == 'D')
                            EQR_OB_FCAST
                        #elseif (${dataselect1} == 'S')
                            EQR_SLS_INP_FCAST
                        #elseif (${dataselect1} == 'T')
                            EQR_SLS_STAT_FCAST
                        #elseif (${dataselect1} == 'W')
                            EQR_AVG_FCAST
                        #end
                        T2
                    #else
                        FROM 
                        #if (${dataselect2} == 'P')
                            #if (${orgdst} == 'FM' || ${orgdst} == 'TO')
                                EQR_FULL_CNTR_PERF
                            #else
                                EQR_FULL_CNTR_FM_TO_PERF
                            #end
                        #elseif (${dataselect2} == 'D')
                            EQR_OB_FCAST
                        #elseif (${dataselect2} == 'S')
                            EQR_SLS_INP_FCAST
                        #elseif (${dataselect2} == 'T')
                            EQR_SLS_STAT_FCAST
                        #elseif (${dataselect2} == 'W')
                            EQR_AVG_FCAST
                        #end
                        T
                    #end
                    #if (${fmtoat} == '1')
                        ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrFmEccCd.size() > 0)
                            #if (${fmtype} == 'R')
                                AND RCC_CD
                            #elseif (${fmtype} == 'L')
                                AND LCC_CD
                            #else
                                AND ECC_CD
                            #end
                            IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )) C
                        #else
                            ) C
                        #end
                    #else
                        #if (${attype} != '')
                            ,(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                            #if (${attype} == 'R')
                                AND RCC_CD
                            #elseif (${attype} == 'L')
                                AND LCC_CD
                            #else
                                AND ECC_CD
                            #end
                            IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )) C
                        #end
                    #end
                    #if (${fmtoat} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrToEccCd.size() > 0)
                            #if (${totype} == 'R')
                                AND RCC_CD
                            #elseif (${totype} == 'L')
                                AND LCC_CD
                            #else
                                AND ECC_CD
                            #end
                            IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                            )) D
                        #else
                            ) D
                        #end
                    #end
                    WHERE 
                    #if (${dataselect2} == 'D')
                        T.SCNR_ID = '$key.get(2)'
                    #else
                        #if (${dataselect2} != 'P')
                            T.YRWK = '$key.get(0)'
                        #else
                            T.YRWK = '$key.get(1)'
                        #end
                    #end
                    #if (${dataselect2} != 'P')
                        #if (${weeklygubun} == 'Weekly4')
                            AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'
                        #else
                            AND T.FCAST_YRWK = '$key.get(1)'
                        #end
                    #end
                    #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                        #if (${dataselect2} == 'D')
                            AND T2.YRWK = '$key.get(0)'
                        #end
                        #if (${dataselect1} == 'D')
                            AND T2.SCNR_ID = '$key.get(2)'
                        #end
                    #end
                    #if (${dataselect2} == 'P')
                        #if (${fmtoat} == '1')
                            #if (${orgdst} == 'FMTO')
                                AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)
                            #else
                                AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)
                            #end
                        #else
                            #if (${attype} != '')
                                #if (${orgdst} == 'FMTO')
                                    AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                                #else
                                    AND (T.ECC_CD = C.ECC_CD)
                                #end
                            #end
                        #end
                    #else
                        #if (${fmtoat} == '1')
                            AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD
                        #else
                            #if (${dataselect2} == '')
                                #if (${attype} != '')
                                    AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)
                                #end
                            #else
                                #if (${attype} != '')
                                    #if (${orgdst} == 'FMTO')
                                        AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)
                                    #else
                                        AND (T.TO_ECC_CD = C.ECC_CD)
                                    #end
                                #end
                            #end
                        #end
                    #end
                    #if (${dataselect1} != 'P' && ${dataselect2} != 'P')
                        #if (${dataselect1} != 'D' && ${dataselect2} != 'D')
                            AND T.FM_ECC_CD = T2.FM_ECC_CD
                            AND T.TO_ECC_CD = T2.TO_ECC_CD
                            AND T.CO_CD = T2.CO_CD
                            AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                            AND T.YRWK = T2.YRWK
                            AND T.FCAST_YRWK = T2.FCAST_YRWK
                            AND T.FCAST_DT = T2.FCAST_DT
                        #else
                            #if (${dataselect1} == 'D')
                                AND T.FM_ECC_CD = T2.FM_ECC_CD
                                AND T.TO_ECC_CD = T2.TO_ECC_CD
                                AND T.CO_CD = T2.CO_CD
                                AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                                AND T.YRWK = SUBSTR(T2.SCNR_ID,5,6)
                                AND T.FCAST_YRWK = T2.FCAST_YRWK
                                AND T.FCAST_DT = T2.FCAST_DT
                            #end
                            #if (${dataselect2} == 'D')
                                AND T.FM_ECC_CD = T2.FM_ECC_CD
                                AND T.TO_ECC_CD = T2.TO_ECC_CD
                                AND T.CO_CD = T2.CO_CD
                                AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD
                                AND SUBSTR(T.SCNR_ID,5,6) = T2.YRWK
                                AND T.FCAST_YRWK = T2.FCAST_YRWK
                                AND T.FCAST_DT = T2.FCAST_DT
                            #end
                        #end
                    #end
                    #if ($arrCntrTpszCd.size() > 0)
                        AND T.CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            '$key',
                        #end
                        'F5','S2','S4','A2','A4' )
                    #end
                    #if (${dataselect1} == 'P')
                        #if (${orgdst} == 'FM')
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                            #end
                        #elseif (${orgdst} == 'TO')
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                            #end
                        #else
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                            #end
                        #end
                    #elseif (${dataselect2} == 'P' && ${orgdst} != 'FMTO')
                        AND T.IO_BND_CD = 
                        #if (${orgdst} == 'FM')
                            'O'
                        #else
                            'I'
                        #end
                        GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD
                    #elseif (${dataselect2} == 'P' && ${orgdst} == 'FMTO')
                        GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                    #else
                        #if (${orgdst} == 'FM')
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD
                            #end
                        #elseif (${orgdst} == 'TO')
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD
                            #end
                        #else
                            #if (${weeklygubun} == 'Weekly4')
                                #if (${weekmonth} != 'W')
                                    GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                                #else
                                    GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                                #end
                            #else
                                GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD
                            #end
                        #end
                    #end
                    #if($velocityCount < $arrWkResult.size())
                        UNION ALL
                    #end
                #end
                --DATA SELECT 2 END--------------------------------------
                #if (${weekmonth} == 'W')
                    )
                    GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
                #else
                    #if (${dataselect1} != '' && ${dataselect2} != '')
                        #if (${orgdst} == 'FM')
                            )
                            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
                        #elseif (${orgdst} == 'TO')
                            )
                            GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ
                        #elseif (${orgdst} == 'FMTO')
                            )
                            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
                        #end
                    #elseif (${dataselect1} == 'P' && ${dataselect2} == '')
                        #if (${orgdst} == 'FM')
                            )
                            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
                        #elseif (${orgdst} == 'TO')
                            )
                            GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ
                        #elseif (${orgdst} == 'FMTO')
                            )
                            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ
                        #end
                    #elseif (${dataselect1} != 'P' && ${dataselect2} == '')
                        )
                        GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ
                    #end
                #end
            )
            GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD , TO_ECC_CD, SEQ
        )
        GROUP BY WEEK, COMPANY, FM_ECC_CD, TO_ECC_CD
        --MATCH END--------------------------------------
    #end
    ORDER BY WEEK, FM_ECC_CD, TO_ECC_CD, SEQ
#end			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
