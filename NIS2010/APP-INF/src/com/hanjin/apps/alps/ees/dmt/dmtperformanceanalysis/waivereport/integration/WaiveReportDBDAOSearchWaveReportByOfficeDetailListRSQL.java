/*=========================================================
*Copyright(c) 2010 CyberLogitec
*@FileName : WaiveReportDBDAOSearchWaveReportByOfficeDetailListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2010.03.25
*@LastModifier : 황효근
*@LastVersion : 1.0
* 2010.03.25 황효근
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.ees.dmt.dmtperformanceanalysis.waivereport.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author Hwang HyoKeun
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class WaiveReportDBDAOSearchWaveReportByOfficeDetailListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * WAIVE REPORT
	  * EES_DMT_6010
	  * Waive Report by Office - Detail(s)
	  * </pre>
	  */
	public WaiveReportDBDAOSearchWaveReportByOfficeDetailListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ofc_cd2",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fm_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("curr_flg",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ofc_flg2",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("reqapp",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("dmdt_cntr_tp_cd",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.ees.dmt.dmtperformanceanalysis.waivereport.integration").append("\n"); 
		query.append("FileName : WaiveReportDBDAOSearchWaveReportByOfficeDetailListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT" ).append("\n"); 
		query.append("X.SC_NO AS SCNO," ).append("\n"); 
		query.append("X.RFA_NO AS RFANO," ).append("\n"); 
		query.append("X.CUST_CNT_CD||LPAD(X.CUST_SEQ,6,'0') AS CUSTCODE," ).append("\n"); 
		query.append("(   SELECT  CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("FROM  MDM_CUSTOMER" ).append("\n"); 
		query.append("WHERE  CUST_CNT_CD     = X.CUST_CNT_CD" ).append("\n"); 
		query.append("AND  CUST_SEQ        = X.CUST_SEQ" ).append("\n"); 
		query.append(") AS CUSTNAME," ).append("\n"); 
		query.append("X.PROG_OFC_CD AS CTRTOFC," ).append("\n"); 
		query.append("( SELECT XX.OFC_RHQ_CD FROM DMT_CHG_CALC XX" ).append("\n"); 
		query.append("WHERE XX.SYS_AREA_GRP_ID = X.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("AND XX.CNTR_NO = X.CNTR_NO" ).append("\n"); 
		query.append("AND XX.CNTR_CYC_NO = X.CNTR_CYC_NO" ).append("\n"); 
		query.append("AND XX.DMDT_TRF_CD = X.DMDT_TRF_CD" ).append("\n"); 
		query.append("AND XX.DMDT_CHG_LOC_DIV_CD = X.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("AND XX.CHG_SEQ = X.CHG_SEQ" ).append("\n"); 
		query.append("AND XX.OFC_CD = X.OFC_CD" ).append("\n"); 
		query.append(") AS OFCRHQCD," ).append("\n"); 
		query.append("X.DMDT_TRF_CD AS TARIFF" ).append("\n"); 
		query.append(",X.DMDT_CHG_STS_CD AS STS" ).append("\n"); 
		query.append(",X.CNTR_NO AS CNTRNO" ).append("\n"); 
		query.append(",DB.CNTR_TPSZ_CD AS TS" ).append("\n"); 
		query.append(",X.OFC_CD AS DMTOFC" ).append("\n"); 
		query.append(",X.FM_MVMT_YD_CD AS FROMYARD" ).append("\n"); 
		query.append(",X.TO_MVMT_YD_CD AS TOYARD" ).append("\n"); 
		query.append(",X.FM_MVMT_STS_CD AS FM" ).append("\n"); 
		query.append(",X.TO_MVMT_STS_CD AS TOO" ).append("\n"); 
		query.append(",X.FT_DYS AS FT" ).append("\n"); 
		query.append(",X.FX_FT_OVR_DYS AS OVER" ).append("\n"); 
		query.append(",TO_CHAR ( X.FM_MVMT_DT , 'YYYY-MM-DD' ) AS FROMDATE" ).append("\n"); 
		query.append(",TO_CHAR ( X.TO_MVMT_DT , 'YYYY-MM-DD' ) AS TODATE" ).append("\n"); 
		query.append(",TO_CHAR ( X.FT_CMNC_DT , 'YYYY-MM-DD' ) AS FTCMNC" ).append("\n"); 
		query.append(",TO_CHAR ( X.FT_END_DT  , 'YYYY-MM-DD' ) AS FTEND" ).append("\n"); 
		query.append(",X.BZC_TRF_CURR_CD AS CUR" ).append("\n"); 
		query.append(",X.ORG_CHG_AMT AS INCURRED" ).append("\n"); 
		query.append(",X.SC_RFA_EXPT_AMT AS EXCEPTIONN" ).append("\n"); 
		query.append(",X.AFT_EXPT_DC_AMT AS DCAMT" ).append("\n"); 
		query.append(",X.BIL_AMT AS BILLABLE" ).append("\n"); 
		query.append(",  (          SELECT DISTINCT  IM.INV_CURR_CD          INV_CURR_CD" ).append("\n"); 
		query.append("FROM    DMT_INV_MN  IM," ).append("\n"); 
		query.append("DMT_INV_DTL ID" ).append("\n"); 
		query.append("WHERE   IM.DMDT_INV_NO      = X.DMDT_INV_NO" ).append("\n"); 
		query.append("AND     IM.DMDT_INV_NO      = ID.DMDT_INV_NO" ).append("\n"); 
		query.append("AND     IM.CRE_OFC_CD       = ID.CRE_OFC_CD" ).append("\n"); 
		query.append("AND     IM.DMDT_INV_STS_CD  = 'I'" ).append("\n"); 
		query.append("AND X.SYS_AREA_GRP_ID = ID.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("AND X.CNTR_NO = ID.CNTR_NO" ).append("\n"); 
		query.append("AND X.CNTR_CYC_NO = ID.CNTR_CYC_NO" ).append("\n"); 
		query.append("AND X.DMDT_TRF_CD = ID.DMDT_TRF_CD" ).append("\n"); 
		query.append("AND X.DMDT_CHG_LOC_DIV_CD = ID.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("AND X.CHG_SEQ = ID.CHG_SEQ" ).append("\n"); 
		query.append(") AS CUR2" ).append("\n"); 
		query.append(",  (          SELECT DISTINCT ID.CNTR_INV_AMT         CNTR_INV_AMT" ).append("\n"); 
		query.append("FROM    DMT_INV_MN  IM," ).append("\n"); 
		query.append("DMT_INV_DTL ID" ).append("\n"); 
		query.append("WHERE   IM.DMDT_INV_NO      = X.DMDT_INV_NO" ).append("\n"); 
		query.append("AND     IM.DMDT_INV_NO      = ID.DMDT_INV_NO" ).append("\n"); 
		query.append("AND     IM.CRE_OFC_CD       = ID.CRE_OFC_CD" ).append("\n"); 
		query.append("AND     IM.DMDT_INV_STS_CD  = 'I'" ).append("\n"); 
		query.append("AND X.SYS_AREA_GRP_ID = ID.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("AND X.CNTR_NO = ID.CNTR_NO" ).append("\n"); 
		query.append("AND X.CNTR_CYC_NO = ID.CNTR_CYC_NO" ).append("\n"); 
		query.append("AND X.DMDT_TRF_CD = ID.DMDT_TRF_CD" ).append("\n"); 
		query.append("AND X.DMDT_CHG_LOC_DIV_CD = ID.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("AND X.CHG_SEQ = ID.CHG_SEQ" ).append("\n"); 
		query.append(") AS INVOICED" ).append("\n"); 
		query.append(",  (          SELECT DISTINCT DMDT_AR_IF_CD" ).append("\n"); 
		query.append("FROM    DMT_INV_MN  IM," ).append("\n"); 
		query.append("DMT_INV_DTL ID" ).append("\n"); 
		query.append("WHERE   IM.DMDT_INV_NO      = X.DMDT_INV_NO" ).append("\n"); 
		query.append("AND     IM.DMDT_INV_NO      = ID.DMDT_INV_NO" ).append("\n"); 
		query.append("AND     IM.CRE_OFC_CD       = ID.CRE_OFC_CD" ).append("\n"); 
		query.append("AND     IM.DMDT_INV_STS_CD  = 'I'" ).append("\n"); 
		query.append("AND X.SYS_AREA_GRP_ID = ID.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("AND X.CNTR_NO = ID.CNTR_NO" ).append("\n"); 
		query.append("AND X.CNTR_CYC_NO = ID.CNTR_CYC_NO" ).append("\n"); 
		query.append("AND X.DMDT_TRF_CD = ID.DMDT_TRF_CD" ).append("\n"); 
		query.append("AND X.DMDT_CHG_LOC_DIV_CD = ID.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("AND X.CHG_SEQ = ID.CHG_SEQ" ).append("\n"); 
		query.append(") AS AR" ).append("\n"); 
		query.append(",DB.BKG_NO AS BKGNO" ).append("\n"); 
		query.append(",DB.BL_NO AS BLNO" ).append("\n"); 
		query.append(",DB.VSL_CD||DB.SKD_VOY_NO||DB.SKD_DIR_CD AS VVD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT  V.VSL_SLAN_CD LANE" ).append("\n"); 
		query.append("FROM    VSK_VSL_SKD V" ).append("\n"); 
		query.append("WHERE   DB.VSL_CD             =   V.VSL_CD" ).append("\n"); 
		query.append("AND     DB.SKD_VOY_NO         =   V.SKD_VOY_NO" ).append("\n"); 
		query.append("AND     DB.SKD_DIR_CD         =   V.SKD_DIR_CD" ).append("\n"); 
		query.append(") AS LANE" ).append("\n"); 
		query.append(",DB.POR_CD AS POR" ).append("\n"); 
		query.append(",DB.POL_CD AS POL" ).append("\n"); 
		query.append(",DB.POD_CD AS POD" ).append("\n"); 
		query.append(",DB.DEL_CD AS DEL" ).append("\n"); 
		query.append(",DB.BKG_RCV_TERM_CD AS R" ).append("\n"); 
		query.append(",DB.BKG_DE_TERM_CD AS D" ).append("\n"); 
		query.append(",X.DMDT_INV_NO AS INVNO" ).append("\n"); 
		query.append(",  (          SELECT DISTINCT TO_CHAR(IM.CRE_DT, 'YYYY-MM-DD' ) ISS_DT" ).append("\n"); 
		query.append("FROM    DMT_INV_MN  IM," ).append("\n"); 
		query.append("DMT_INV_DTL ID" ).append("\n"); 
		query.append("WHERE   IM.DMDT_INV_NO      = X.DMDT_INV_NO" ).append("\n"); 
		query.append("AND     IM.DMDT_INV_NO      = ID.DMDT_INV_NO" ).append("\n"); 
		query.append("AND     IM.CRE_OFC_CD       = ID.CRE_OFC_CD" ).append("\n"); 
		query.append("AND     IM.DMDT_INV_STS_CD  = 'I'" ).append("\n"); 
		query.append("AND X.SYS_AREA_GRP_ID = ID.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("AND X.CNTR_NO = ID.CNTR_NO" ).append("\n"); 
		query.append("AND X.CNTR_CYC_NO = ID.CNTR_CYC_NO" ).append("\n"); 
		query.append("AND X.DMDT_TRF_CD = ID.DMDT_TRF_CD" ).append("\n"); 
		query.append("AND X.DMDT_CHG_LOC_DIV_CD = ID.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("AND X.CHG_SEQ = ID.CHG_SEQ" ).append("\n"); 
		query.append(") AS ISSDT" ).append("\n"); 
		query.append(",DECODE(X.CHG_SEQ, 1, 'G', 'B') AS GB" ).append("\n"); 
		query.append(",APPR_NO AS DARAPPRNO" ).append("\n"); 
		query.append(", R_DATE AS DATE1" ).append("\n"); 
		query.append(", R_OFC_CD AS OFFICE1" ).append("\n"); 
		query.append(", R_NAME AS NAME1" ).append("\n"); 
		query.append(", A_DATE AS DATE2" ).append("\n"); 
		query.append(", A_OFC_CD AS OFFICE2" ).append("\n"); 
		query.append(", A_NAME AS NAME2" ).append("\n"); 
		query.append(",X.SYS_AREA_GRP_ID AS GRPID" ).append("\n"); 
		query.append(",X.CNTR_CYC_NO AS CYCNO" ).append("\n"); 
		query.append(",X.CHG_SEQ AS CHGSEQ" ).append("\n"); 
		query.append(",X.DMDT_CHG_LOC_DIV_CD AS DIVCD" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT  /*+ LEADING(SC) */" ).append("\n"); 
		query.append("SC.SC_NO," ).append("\n"); 
		query.append("'' RFA_NO," ).append("\n"); 
		query.append("SC.PROP_NO," ).append("\n"); 
		query.append("CUST.CUST_CNT_CD    CUST_CNT_CD," ).append("\n"); 
		query.append("CUST.CUST_SEQ       CUST_SEQ," ).append("\n"); 
		query.append("SC.PROG_OFC_CD    PROG_OFC_CD," ).append("\n"); 
		query.append("(   SELECT  TO_CHAR(DMT_SC_EXPT_VER_PROG.PROG_DT, 'YYYY-MM-DD' )" ).append("\n"); 
		query.append("FROM    DMT_SC_EXPT_VER_PROG," ).append("\n"); 
		query.append("DMT_SC_EXPT_VER" ).append("\n"); 
		query.append("WHERE   DMT_SC_EXPT_VER_PROG.DMDT_EXPT_VER_STS_CD = 'R'" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.PROP_NO     =   SC.PROP_NO" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER_PROG.PROP_NO=   SC.PROP_NO" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.SC_EXPT_VER_SEQ = DMT_SC_EXPT_VER_PROG.SC_EXPT_VER_SEQ" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.DMDT_EXPT_VER_STS_CD = 'L'" ).append("\n"); 
		query.append(") R_DATE," ).append("\n"); 
		query.append("(   SELECT  DMT_SC_EXPT_VER_PROG.PROG_OFC_CD" ).append("\n"); 
		query.append("FROM    DMT_SC_EXPT_VER_PROG," ).append("\n"); 
		query.append("DMT_SC_EXPT_VER" ).append("\n"); 
		query.append("WHERE   DMT_SC_EXPT_VER_PROG.DMDT_EXPT_VER_STS_CD = 'R'" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.PROP_NO     =   SC.PROP_NO" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER_PROG.PROP_NO=   SC.PROP_NO" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.SC_EXPT_VER_SEQ = DMT_SC_EXPT_VER_PROG.SC_EXPT_VER_SEQ" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.DMDT_EXPT_VER_STS_CD = 'L'" ).append("\n"); 
		query.append(")R_OFC_CD," ).append("\n"); 
		query.append("(   SELECT  USR_NM" ).append("\n"); 
		query.append("FROM    DMT_SC_EXPT_VER_PROG," ).append("\n"); 
		query.append("DMT_SC_EXPT_VER," ).append("\n"); 
		query.append("COM_USER" ).append("\n"); 
		query.append("WHERE   DMT_SC_EXPT_VER_PROG.DMDT_EXPT_VER_STS_CD = 'R'" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.PROP_NO     =   SC.PROP_NO" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER_PROG.PROP_NO=   SC.PROP_NO" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.SC_EXPT_VER_SEQ = DMT_SC_EXPT_VER_PROG.SC_EXPT_VER_SEQ" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.DMDT_EXPT_VER_STS_CD = 'L'" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER_PROG.PROG_USR_ID = USR_ID" ).append("\n"); 
		query.append(") R_NAME," ).append("\n"); 
		query.append("(   SELECT  TO_CHAR(DMT_SC_EXPT_VER_PROG.PROG_DT, 'YYYY-MM-DD' )" ).append("\n"); 
		query.append("FROM    DMT_SC_EXPT_VER_PROG," ).append("\n"); 
		query.append("DMT_SC_EXPT_VER" ).append("\n"); 
		query.append("WHERE   DMT_SC_EXPT_VER_PROG.DMDT_EXPT_VER_STS_CD = 'A'" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.PROP_NO     =   SC.PROP_NO" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER_PROG.PROP_NO=   SC.PROP_NO" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.SC_EXPT_VER_SEQ = DMT_SC_EXPT_VER_PROG.SC_EXPT_VER_SEQ" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.DMDT_EXPT_VER_STS_CD = 'L'" ).append("\n"); 
		query.append(") A_DATE," ).append("\n"); 
		query.append("(   SELECT  DMT_SC_EXPT_VER_PROG.PROG_OFC_CD" ).append("\n"); 
		query.append("FROM    DMT_SC_EXPT_VER_PROG," ).append("\n"); 
		query.append("DMT_SC_EXPT_VER" ).append("\n"); 
		query.append("WHERE   DMT_SC_EXPT_VER_PROG.DMDT_EXPT_VER_STS_CD = 'A'" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.PROP_NO     =   SC.PROP_NO" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER_PROG.PROP_NO=   SC.PROP_NO" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.SC_EXPT_VER_SEQ = DMT_SC_EXPT_VER_PROG.SC_EXPT_VER_SEQ" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.DMDT_EXPT_VER_STS_CD = 'L'" ).append("\n"); 
		query.append(") A_OFC_CD," ).append("\n"); 
		query.append("(   SELECT  USR_NM" ).append("\n"); 
		query.append("FROM    DMT_SC_EXPT_VER_PROG," ).append("\n"); 
		query.append("DMT_SC_EXPT_VER," ).append("\n"); 
		query.append("COM_USER" ).append("\n"); 
		query.append("WHERE   DMT_SC_EXPT_VER_PROG.DMDT_EXPT_VER_STS_CD = 'A'" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.PROP_NO     =   SC.PROP_NO" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER_PROG.PROP_NO=   SC.PROP_NO" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.SC_EXPT_VER_SEQ = DMT_SC_EXPT_VER_PROG.SC_EXPT_VER_SEQ" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER.DMDT_EXPT_VER_STS_CD = 'L'" ).append("\n"); 
		query.append("AND     DMT_SC_EXPT_VER_PROG.PROG_USR_ID = USR_ID" ).append("\n"); 
		query.append(") A_NAME," ).append("\n"); 
		query.append("'' APPR_NO," ).append("\n"); 
		query.append("DC.SYS_AREA_GRP_ID, DC.CNTR_NO, DC.CNTR_CYC_NO, DC.DMDT_TRF_CD," ).append("\n"); 
		query.append("DC.BZC_TRF_CURR_CD, DC.ORG_CHG_AMT, DC.CMDT_EXPT_AMT, DC.SC_RFA_EXPT_AMT, DC.AFT_EXPT_DC_AMT, DC.BIL_AMT, DC.TO_MVMT_DT" ).append("\n"); 
		query.append(",DC.DMDT_CHG_STS_CD" ).append("\n"); 
		query.append(",DC.OFC_CD" ).append("\n"); 
		query.append(",DC.FM_MVMT_YD_CD" ).append("\n"); 
		query.append(",DC.TO_MVMT_YD_CD" ).append("\n"); 
		query.append(",DC.FM_MVMT_STS_CD" ).append("\n"); 
		query.append(",DC.TO_MVMT_STS_CD" ).append("\n"); 
		query.append(",DC.FT_DYS" ).append("\n"); 
		query.append(",DC.FX_FT_OVR_DYS" ).append("\n"); 
		query.append(",DC.FM_MVMT_DT" ).append("\n"); 
		query.append(",DC.FT_CMNC_DT" ).append("\n"); 
		query.append(",DC.FT_END_DT" ).append("\n"); 
		query.append(",DC.CHG_SEQ" ).append("\n"); 
		query.append(",DC.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append(",DC.DMDT_INV_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM  DMT_CHG_CALC        DC," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT PROP_NO, AMDT_SEQ, SC_NO, PROG_OFC_CD" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT SCH.PROP_NO, SC.AMDT_SEQ, SCH.SC_NO, SC_EXP.PROG_OFC_CD  PROG_OFC_CD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("DENSE_RANK() OVER(PARTITION BY SCH.SC_NO ORDER BY SC.AMDT_SEQ DESC) AMDT_SEQ_FILTER" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT DISTINCT PROP_NO, PROG_OFC_CD" ).append("\n"); 
		query.append("FROM DMT_SC_EXPT_VER_PROG" ).append("\n"); 
		query.append("WHERE (" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("@[ofc_flg2]   =   'O'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("PROG_OFC_CD  IN 	(" ).append("\n"); 
		query.append("#foreach( $waive_off_cd_p in ${tempWaiveOFFList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempWaiveOFFList.size())" ).append("\n"); 
		query.append("'$waive_off_cd_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$waive_off_cd_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR   (" ).append("\n"); 
		query.append("@[ofc_flg2]   =   'R'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("@[ofc_cd2] <> 'All'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("PROG_OFC_CD   IN  (" ).append("\n"); 
		query.append("SELECT OFC_CD" ).append("\n"); 
		query.append("FROM   MDM_ORGANIZATION" ).append("\n"); 
		query.append("START WITH OFC_CD = @[ofc_cd2]" ).append("\n"); 
		query.append("CONNECT BY NOCYCLE PRIOR OFC_CD = PRNT_OFC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND DMDT_EXPT_VER_STS_CD = DECODE(@[reqapp], 'R', 'R', 'A', 'L')" ).append("\n"); 
		query.append(") SC_EXP, PRI_SP_HDR SCH," ).append("\n"); 
		query.append("PRI_SP_MN SC" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("WHERE SC_EXP.PROP_NO   = SCH.PROP_NO" ).append("\n"); 
		query.append("AND SCH.PROP_NO      = SC.PROP_NO" ).append("\n"); 
		query.append("--						   AND SCH.SC_NO IN ('AEN23719')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( ${slctscno} != '' )" ).append("\n"); 
		query.append("AND		SCH.SC_NO IN (" ).append("\n"); 
		query.append("#foreach( $sc_no_p in ${tempSCNOList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempSCNOList.size())" ).append("\n"); 
		query.append("'$sc_no_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$sc_no_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("WHERE AMDT_SEQ_FILTER = 1" ).append("\n"); 
		query.append(") SC, PRI_SP_CTRT_PTY CUST" ).append("\n"); 
		query.append("WHERE SC.PROP_NO  = CUST.PROP_NO" ).append("\n"); 
		query.append("AND SC.AMDT_SEQ = CUST.AMDT_SEQ" ).append("\n"); 
		query.append("AND CUST.PRC_CTRT_PTY_TP_CD = 'C'" ).append("\n"); 
		query.append("AND DC.SC_NO = SC.SC_NO" ).append("\n"); 
		query.append("AND DC.TO_MVMT_DT BETWEEN TO_DATE (REPLACE (@[fm_dt], '-', ''), 'YYYYMMDD') + .0" ).append("\n"); 
		query.append("AND TO_DATE (REPLACE (@[to_dt], '-', ''), 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("AND DC.DMDT_TRF_CD IN (" ).append("\n"); 
		query.append("#foreach( $trf_cd_p in ${tempTRFCDList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempTRFCDList.size())" ).append("\n"); 
		query.append("'$trf_cd_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$trf_cd_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND DC.DMDT_CHG_STS_CD IN ('F', 'C', 'I', 'N')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND DC.SC_NO = SC.SC_NO" ).append("\n"); 
		query.append("AND DC.SYS_AREA_GRP_ID =" ).append("\n"); 
		query.append("(SELECT SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("FROM COM_SYS_AREA_GRP_ID S, MDM_ORGANIZATION M" ).append("\n"); 
		query.append("WHERE CNT_CD = SUBSTR (LOC_CD, 1, 2)" ).append("\n"); 
		query.append("AND CO_IND_CD = 'H'" ).append("\n"); 
		query.append("AND M.OFC_CD = DC.OFC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#if ( ${slctscno} != '' )" ).append("\n"); 
		query.append("AND		DC.SC_NO IN (" ).append("\n"); 
		query.append("#foreach( $sc_no_p in ${tempSCNOList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempSCNOList.size())" ).append("\n"); 
		query.append("'$sc_no_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$sc_no_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("'' SC_NO," ).append("\n"); 
		query.append("REQ_APP.RFA_NO," ).append("\n"); 
		query.append("REQ_APP.PROP_NO," ).append("\n"); 
		query.append("REQ_APP.CTRT_CUST_CNT_CD    CUST_CNT_CD," ).append("\n"); 
		query.append("REQ_APP.CTRT_CUST_SEQ       CUST_SEQ," ).append("\n"); 
		query.append("REQ_APP.PROG_OFC_CD         PROG_OFC_CD," ).append("\n"); 
		query.append("R_DATE, R_OFC_CD, R_NAME, A_DATE, A_OFC_CD, A_NAME," ).append("\n"); 
		query.append("REQ_APP.RFA_EXPT_APRO_NO    APPR_NO," ).append("\n"); 
		query.append("DC.SYS_AREA_GRP_ID, DC.CNTR_NO, DC.CNTR_CYC_NO, DC.DMDT_TRF_CD," ).append("\n"); 
		query.append("DC.BZC_TRF_CURR_CD, DC.ORG_CHG_AMT, DC.CMDT_EXPT_AMT, DC.SC_RFA_EXPT_AMT, DC.AFT_EXPT_DC_AMT, DC.BIL_AMT, DC.TO_MVMT_DT" ).append("\n"); 
		query.append(",DC.DMDT_CHG_STS_CD" ).append("\n"); 
		query.append(",DC.OFC_CD" ).append("\n"); 
		query.append(",DC.FM_MVMT_YD_CD" ).append("\n"); 
		query.append(",DC.TO_MVMT_YD_CD" ).append("\n"); 
		query.append(",DC.FM_MVMT_STS_CD" ).append("\n"); 
		query.append(",DC.TO_MVMT_STS_CD" ).append("\n"); 
		query.append(",DC.FT_DYS" ).append("\n"); 
		query.append(",DC.FX_FT_OVR_DYS" ).append("\n"); 
		query.append(",DC.FM_MVMT_DT" ).append("\n"); 
		query.append(",DC.FT_CMNC_DT" ).append("\n"); 
		query.append(",DC.FT_END_DT" ).append("\n"); 
		query.append(",DC.CHG_SEQ" ).append("\n"); 
		query.append(",DC.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append(",DC.DMDT_INV_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM  DMT_CHG_CALC        DC," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT RFH.RFA_NO, RFH.PROP_NO, RFA.CTRT_CUST_CNT_CD, RFA.CTRT_CUST_SEQ, RFA_EXP.PROG_OFC_CD, RFA_EXP.RFA_EXPT_APRO_NO, RFA_EXP.RFA_EXPT_DAR_NO," ).append("\n"); 
		query.append("R_DATE, R_OFC_CD, R_NAME, A_DATE, A_OFC_CD, A_NAME," ).append("\n"); 
		query.append("DENSE_RANK() OVER(PARTITION BY RFH.RFA_NO ORDER BY RFA.AMDT_SEQ DESC) AMDT_SEQ_FILTER" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT DISTINCT PROP_NO, RFA_EXPT_DAR_NO, DECODE(@[reqapp], 'R', RQST_OFC_CD, 'A', APRO_OFC_CD)   PROG_OFC_CD, RFA_EXPT_APRO_NO," ).append("\n"); 
		query.append("TO_CHAR(RM.RQST_DT, 'YYYY-MM-DD' )   R_DATE," ).append("\n"); 
		query.append("RM.RQST_OFC_CD                      R_OFC_CD," ).append("\n"); 
		query.append("(SELECT USR_NM FROM COM_USER WHERE USR_ID = RM.RQST_USR_ID)  AS R_NAME," ).append("\n"); 
		query.append("TO_CHAR(RM.APRO_DT, 'YYYY-MM-DD' )   A_DATE," ).append("\n"); 
		query.append("RM.APRO_OFC_CD                      A_OFC_CD," ).append("\n"); 
		query.append("(SELECT USR_NM FROM COM_USER WHERE USR_ID = RM.APRO_USR_ID)  AS A_NAME" ).append("\n"); 
		query.append("FROM DMT_RFA_EXPT_TRF RM" ).append("\n"); 
		query.append("WHERE (" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("@[ofc_flg2]   =   'O'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("DECODE(@[reqapp], 'R', RQST_OFC_CD, APRO_OFC_CD)  IN 	(" ).append("\n"); 
		query.append("#foreach( $waive_off_cd_p in ${tempWaiveOFFList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempWaiveOFFList.size())" ).append("\n"); 
		query.append("'$waive_off_cd_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$waive_off_cd_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR   (" ).append("\n"); 
		query.append("@[ofc_flg2]   =   'R'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("@[ofc_cd2] <> 'All'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("DECODE(@[reqapp], 'R', RQST_OFC_CD, APRO_OFC_CD)   IN  (" ).append("\n"); 
		query.append("SELECT OFC_CD" ).append("\n"); 
		query.append("FROM   MDM_ORGANIZATION" ).append("\n"); 
		query.append("START WITH OFC_CD = @[ofc_cd2]" ).append("\n"); 
		query.append("CONNECT BY NOCYCLE PRIOR OFC_CD = PRNT_OFC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(") RFA_EXP, PRI_RP_HDR RFH, PRI_RP_MN RFA" ).append("\n"); 
		query.append("WHERE RFA_EXP.PROP_NO  = RFH.PROP_NO" ).append("\n"); 
		query.append("AND RFH.PROP_NO      = RFA.PROP_NO" ).append("\n"); 
		query.append(")   REQ_APP" ).append("\n"); 
		query.append("WHERE AMDT_SEQ_FILTER = 1" ).append("\n"); 
		query.append("AND DC.TO_MVMT_DT BETWEEN TO_DATE (REPLACE (@[fm_dt], '-', ''), 'YYYYMMDD') + .0" ).append("\n"); 
		query.append("AND TO_DATE (REPLACE (@[to_dt], '-', ''), 'YYYYMMDD')" ).append("\n"); 
		query.append("+ .99999" ).append("\n"); 
		query.append("AND DC.DMDT_TRF_CD IN (" ).append("\n"); 
		query.append("#foreach( $trf_cd_p in ${tempTRFCDList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempTRFCDList.size())" ).append("\n"); 
		query.append("'$trf_cd_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$trf_cd_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND DC.DMDT_CHG_STS_CD IN ('F', 'C', 'I', 'N')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND DC.RFA_EXPT_DAR_NO   =  REQ_APP.RFA_EXPT_DAR_NO" ).append("\n"); 
		query.append("AND DC.SYS_AREA_GRP_ID =" ).append("\n"); 
		query.append("(SELECT SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("FROM COM_SYS_AREA_GRP_ID S, MDM_ORGANIZATION M" ).append("\n"); 
		query.append("WHERE CNT_CD = SUBSTR (LOC_CD, 1, 2)" ).append("\n"); 
		query.append("AND CO_IND_CD = 'H'" ).append("\n"); 
		query.append("AND M.OFC_CD = DC.OFC_CD)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- 2010/03/25 추가" ).append("\n"); 
		query.append("AND DC.DMDT_CHG_LOC_DIV_CD <> 'SZP'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(DC.DUL_TP_EXPT_FLG = 'Y' AND SUBSTR(DC.DMDT_TRF_CD, 1, 1) = 'C')" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(DC.DUL_TP_EXPT_FLG = 'N')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("AFT_BKG#.SC_NO," ).append("\n"); 
		query.append("AFT_BKG#.RFA_NO," ).append("\n"); 
		query.append("SC.PROP_NO," ).append("\n"); 
		query.append("CUST.CUST_CNT_CD    CUST_CNT_CD," ).append("\n"); 
		query.append("CUST.CUST_SEQ       CUST_SEQ," ).append("\n"); 
		query.append("AFT_BKG#.PROG_OFC_CD     PROG_OFC_CD," ).append("\n"); 
		query.append("AFT_BKG#.R_DATE," ).append("\n"); 
		query.append("AFT_BKG#.R_OFC_CD," ).append("\n"); 
		query.append("AFT_BKG#.R_NAME," ).append("\n"); 
		query.append("AFT_BKG#.A_DATE," ).append("\n"); 
		query.append("AFT_BKG#.A_OFC_CD," ).append("\n"); 
		query.append("AFT_BKG#.A_NAME," ).append("\n"); 
		query.append("AFT_BKG#.AFT_BKG_APRO_NO   APPR_NO," ).append("\n"); 
		query.append("DC.SYS_AREA_GRP_ID, DC.CNTR_NO, DC.CNTR_CYC_NO, DC.DMDT_TRF_CD," ).append("\n"); 
		query.append("DC.BZC_TRF_CURR_CD, DC.ORG_CHG_AMT, DC.CMDT_EXPT_AMT, DC.SC_RFA_EXPT_AMT, DC.AFT_EXPT_DC_AMT, DC.BIL_AMT, DC.TO_MVMT_DT" ).append("\n"); 
		query.append(",DC.DMDT_CHG_STS_CD" ).append("\n"); 
		query.append(",DC.OFC_CD" ).append("\n"); 
		query.append(",DC.FM_MVMT_YD_CD" ).append("\n"); 
		query.append(",DC.TO_MVMT_YD_CD" ).append("\n"); 
		query.append(",DC.FM_MVMT_STS_CD" ).append("\n"); 
		query.append(",DC.TO_MVMT_STS_CD" ).append("\n"); 
		query.append(",DC.FT_DYS" ).append("\n"); 
		query.append(",DC.FX_FT_OVR_DYS" ).append("\n"); 
		query.append(",DC.FM_MVMT_DT" ).append("\n"); 
		query.append(",DC.FT_CMNC_DT" ).append("\n"); 
		query.append(",DC.FT_END_DT" ).append("\n"); 
		query.append(",DC.CHG_SEQ" ).append("\n"); 
		query.append(",DC.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append(",DC.DMDT_INV_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM  DMT_CHG_CALC        DC," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT DB.SC_NO, DB.RFA_NO," ).append("\n"); 
		query.append("CASE" ).append("\n"); 
		query.append("WHEN DB.SC_NO IS NOT NULL AND DB.RFA_NO IS NULL THEN 'S'" ).append("\n"); 
		query.append("ELSE 'R'" ).append("\n"); 
		query.append("END CTRT_TP," ).append("\n"); 
		query.append("R_DATE, R_OFC_CD, R_NAME, A_DATE, A_OFC_CD, A_NAME," ).append("\n"); 
		query.append("AFT_EXP.PROG_OFC_CD, AFT_EXP.AFT_EXPT_DAR_NO, AFT_EXP.AFT_BKG_APRO_NO," ).append("\n"); 
		query.append("DB.SYS_AREA_GRP_ID, DB.CNTR_NO, DB.CNTR_CYC_NO, AFT_EXP.DMDT_TRF_CD" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT /*+ USE_NL(AM AD) FULL(AM) */" ).append("\n"); 
		query.append("DISTINCT AM.AFT_EXPT_DAR_NO," ).append("\n"); 
		query.append("DECODE(@[reqapp], 'R', AM.RQST_OFC_CD, 'A', AM.APRO_OFC_CD)   PROG_OFC_CD," ).append("\n"); 
		query.append("AD.BKG_NO," ).append("\n"); 
		query.append("AD.DMDT_TRF_CD," ).append("\n"); 
		query.append("AM.AFT_BKG_APRO_NO," ).append("\n"); 
		query.append("TO_CHAR(AM.RQST_DT, 'YYYY-MM-DD' )   R_DATE," ).append("\n"); 
		query.append("AM.RQST_OFC_CD                      R_OFC_CD," ).append("\n"); 
		query.append("(SELECT USR_NM FROM COM_USER WHERE USR_ID = AM.RQST_USR_ID)  AS R_NAME," ).append("\n"); 
		query.append("TO_CHAR(AM.APRO_DT, 'YYYY-MM-DD' )   A_DATE," ).append("\n"); 
		query.append("AM.APRO_OFC_CD                      A_OFC_CD," ).append("\n"); 
		query.append("(SELECT USR_NM FROM COM_USER WHERE USR_ID = AM.APRO_USR_ID)  AS A_NAME" ).append("\n"); 
		query.append("FROM  DMT_AFT_BKG_ADJ_RQST        AM," ).append("\n"); 
		query.append("DMT_AFT_BKG_ADJ_RQST_DTL    AD" ).append("\n"); 
		query.append("WHERE (" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("@[ofc_flg2]   =   'O'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("DECODE(@[reqapp], 'R', AM.RQST_OFC_CD, AM.APRO_OFC_CD) IN 	(" ).append("\n"); 
		query.append("#foreach( $waive_off_cd_p in ${tempWaiveOFFList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempWaiveOFFList.size())" ).append("\n"); 
		query.append("'$waive_off_cd_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$waive_off_cd_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR   (" ).append("\n"); 
		query.append("@[ofc_flg2]   =   'R'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("@[ofc_cd2] <> 'All'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("DECODE(@[reqapp], 'R', AM.RQST_OFC_CD, AM.APRO_OFC_CD)   IN  (" ).append("\n"); 
		query.append("SELECT OFC_CD" ).append("\n"); 
		query.append("FROM   MDM_ORGANIZATION" ).append("\n"); 
		query.append("START WITH OFC_CD = @[ofc_cd2]" ).append("\n"); 
		query.append("CONNECT BY NOCYCLE PRIOR OFC_CD = PRNT_OFC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND AM.AFT_EXPT_DAR_NO = AD.AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("AND AM.DMDT_EXPT_RQST_STS_CD = 'A'" ).append("\n"); 
		query.append(") AFT_EXP , DMT_CHG_BKG_CNTR DB" ).append("\n"); 
		query.append("WHERE DB.BKG_NO        = AFT_EXP.BKG_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( ${slctscno} != '' && ${slctrfano} == '' )" ).append("\n"); 
		query.append("AND		DB.SC_NO IN (" ).append("\n"); 
		query.append("#foreach( $sc_no_p in ${tempSCNOList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempSCNOList.size())" ).append("\n"); 
		query.append("'$sc_no_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$sc_no_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( ${slctscno} == '' && ${slctrfano} != '' )" ).append("\n"); 
		query.append("AND		DB.RFA_NO IN (" ).append("\n"); 
		query.append("#foreach( $rfa_no_p in ${tempRFANOList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempRFANOList.size())" ).append("\n"); 
		query.append("'$rfa_no_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$rfa_no_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND   ROWNUM >=1" ).append("\n"); 
		query.append(") AFT_BKG#," ).append("\n"); 
		query.append("PRI_SP_CTRT_PTY CUST," ).append("\n"); 
		query.append("PRI_SP_HDR       SCH," ).append("\n"); 
		query.append("PRI_SP_MN        SC" ).append("\n"); 
		query.append("WHERE DC.SYS_AREA_GRP_ID   = AFT_BKG#.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("AND DC.CNTR_NO           = AFT_BKG#.CNTR_NO" ).append("\n"); 
		query.append("AND DC.CNTR_CYC_NO       = AFT_BKG#.CNTR_CYC_NO" ).append("\n"); 
		query.append("AND SC.PROP_NO  = CUST.PROP_NO" ).append("\n"); 
		query.append("AND SC.AMDT_SEQ = CUST.AMDT_SEQ" ).append("\n"); 
		query.append("AND CUST.PRC_CTRT_PTY_TP_CD = 'C'" ).append("\n"); 
		query.append("AND DC.TO_MVMT_DT BETWEEN TO_DATE (REPLACE (@[fm_dt], '-', ''), 'YYYYMMDD') + .0" ).append("\n"); 
		query.append("AND TO_DATE (REPLACE (@[to_dt], '-', ''), 'YYYYMMDD')" ).append("\n"); 
		query.append("+ .99999" ).append("\n"); 
		query.append("AND DC.DMDT_TRF_CD IN (" ).append("\n"); 
		query.append("#foreach( $trf_cd_p in ${tempTRFCDList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempTRFCDList.size())" ).append("\n"); 
		query.append("'$trf_cd_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$trf_cd_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND DC.DMDT_TRF_CD       = AFT_BKG#.DMDT_TRF_CD" ).append("\n"); 
		query.append("AND SCH.PROP_NO          = SC.PROP_NO" ).append("\n"); 
		query.append("AND SCH.SC_NO            = AFT_BKG#.SC_NO" ).append("\n"); 
		query.append("AND SC.AMDT_SEQ          = (" ).append("\n"); 
		query.append("SELECT MAX(AMDT_SEQ)" ).append("\n"); 
		query.append("FROM   PRI_SP_MN" ).append("\n"); 
		query.append("WHERE  PRI_SP_MN.PROP_NO          = SCH.PROP_NO" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND AFT_BKG#.CTRT_TP     = 'S'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND DC.DMDT_CHG_STS_CD IN ('F', 'C', 'I', 'N')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND DC.AFT_EXPT_DAR_NO   =  AFT_BKG#.AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("AND DC.SYS_AREA_GRP_ID =" ).append("\n"); 
		query.append("(SELECT SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("FROM COM_SYS_AREA_GRP_ID S, MDM_ORGANIZATION M" ).append("\n"); 
		query.append("WHERE CNT_CD = SUBSTR (LOC_CD, 1, 2)" ).append("\n"); 
		query.append("AND CO_IND_CD = 'H'" ).append("\n"); 
		query.append("AND M.OFC_CD = DC.OFC_CD)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- 2010/03/25 추가" ).append("\n"); 
		query.append("AND DC.DMDT_CHG_LOC_DIV_CD <> 'SZP'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(DC.DUL_TP_EXPT_FLG = 'Y' AND SUBSTR(DC.DMDT_TRF_CD, 1, 1) = 'C')" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(DC.DUL_TP_EXPT_FLG = 'N')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( ${slctscno} != '' )" ).append("\n"); 
		query.append("AND		SCH.SC_NO IN (" ).append("\n"); 
		query.append("#foreach( $sc_no_p in ${tempSCNOList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempSCNOList.size())" ).append("\n"); 
		query.append("'$sc_no_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$sc_no_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("AFT_BKG#.SC_NO," ).append("\n"); 
		query.append("AFT_BKG#.RFA_NO," ).append("\n"); 
		query.append("RFA.PROP_NO," ).append("\n"); 
		query.append("RFA.CTRT_CUST_CNT_CD    CUST_CNT_CD," ).append("\n"); 
		query.append("RFA.CTRT_CUST_SEQ       CUST_SEQ," ).append("\n"); 
		query.append("AFT_BKG#.PROG_OFC_CD     PROG_OFC_CD," ).append("\n"); 
		query.append("AFT_BKG#.R_DATE," ).append("\n"); 
		query.append("AFT_BKG#.R_OFC_CD," ).append("\n"); 
		query.append("AFT_BKG#.R_NAME," ).append("\n"); 
		query.append("AFT_BKG#.A_DATE," ).append("\n"); 
		query.append("AFT_BKG#.A_OFC_CD," ).append("\n"); 
		query.append("AFT_BKG#.A_NAME," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AFT_BKG#.AFT_BKG_APRO_NO   APPR_NO," ).append("\n"); 
		query.append("DC.SYS_AREA_GRP_ID, DC.CNTR_NO, DC.CNTR_CYC_NO, DC.DMDT_TRF_CD," ).append("\n"); 
		query.append("DC.BZC_TRF_CURR_CD, DC.ORG_CHG_AMT, DC.CMDT_EXPT_AMT, DC.SC_RFA_EXPT_AMT, DC.AFT_EXPT_DC_AMT, DC.BIL_AMT, DC.TO_MVMT_DT" ).append("\n"); 
		query.append(",DC.DMDT_CHG_STS_CD" ).append("\n"); 
		query.append(",DC.OFC_CD" ).append("\n"); 
		query.append(",DC.FM_MVMT_YD_CD" ).append("\n"); 
		query.append(",DC.TO_MVMT_YD_CD" ).append("\n"); 
		query.append(",DC.FM_MVMT_STS_CD" ).append("\n"); 
		query.append(",DC.TO_MVMT_STS_CD" ).append("\n"); 
		query.append(",DC.FT_DYS" ).append("\n"); 
		query.append(",DC.FX_FT_OVR_DYS" ).append("\n"); 
		query.append(",DC.FM_MVMT_DT" ).append("\n"); 
		query.append(",DC.FT_CMNC_DT" ).append("\n"); 
		query.append(",DC.FT_END_DT" ).append("\n"); 
		query.append(",DC.CHG_SEQ" ).append("\n"); 
		query.append(",DC.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append(",DC.DMDT_INV_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM  DMT_CHG_CALC        DC," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT DB.SC_NO, DB.RFA_NO," ).append("\n"); 
		query.append("CASE" ).append("\n"); 
		query.append("WHEN DB.SC_NO IS NOT NULL AND DB.RFA_NO IS NULL THEN 'S'" ).append("\n"); 
		query.append("ELSE 'R'" ).append("\n"); 
		query.append("END CTRT_TP," ).append("\n"); 
		query.append("R_DATE, R_OFC_CD, R_NAME, A_DATE, A_OFC_CD, A_NAME," ).append("\n"); 
		query.append("AFT_EXP.PROG_OFC_CD, AFT_EXP.AFT_EXPT_DAR_NO, AFT_EXP.AFT_BKG_APRO_NO," ).append("\n"); 
		query.append("DB.SYS_AREA_GRP_ID, DB.CNTR_NO, DB.CNTR_CYC_NO, AFT_EXP.DMDT_TRF_CD" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT /*+ USE_NL(AM AD) FULL(AM) */" ).append("\n"); 
		query.append("DISTINCT AM.AFT_EXPT_DAR_NO," ).append("\n"); 
		query.append("DECODE(@[reqapp], 'R', AM.RQST_OFC_CD, 'A', AM.APRO_OFC_CD)   PROG_OFC_CD," ).append("\n"); 
		query.append("AD.BKG_NO," ).append("\n"); 
		query.append("AD.DMDT_TRF_CD," ).append("\n"); 
		query.append("AM.AFT_BKG_APRO_NO," ).append("\n"); 
		query.append("TO_CHAR(AM.RQST_DT, 'YYYY-MM-DD' )   R_DATE," ).append("\n"); 
		query.append("AM.RQST_OFC_CD                      R_OFC_CD," ).append("\n"); 
		query.append("(SELECT USR_NM FROM COM_USER WHERE USR_ID = AM.RQST_USR_ID)  AS R_NAME," ).append("\n"); 
		query.append("TO_CHAR(AM.APRO_DT, 'YYYY-MM-DD' )   A_DATE," ).append("\n"); 
		query.append("AM.APRO_OFC_CD                      A_OFC_CD," ).append("\n"); 
		query.append("(SELECT USR_NM FROM COM_USER WHERE USR_ID = AM.APRO_USR_ID)  AS A_NAME" ).append("\n"); 
		query.append("FROM  DMT_AFT_BKG_ADJ_RQST        AM," ).append("\n"); 
		query.append("DMT_AFT_BKG_ADJ_RQST_DTL    AD" ).append("\n"); 
		query.append("WHERE (" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("@[ofc_flg2]   =   'O'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("DECODE(@[reqapp], 'R', AM.RQST_OFC_CD, AM.APRO_OFC_CD) IN 	(" ).append("\n"); 
		query.append("#foreach( $waive_off_cd_p in ${tempWaiveOFFList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempWaiveOFFList.size())" ).append("\n"); 
		query.append("'$waive_off_cd_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$waive_off_cd_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR   (" ).append("\n"); 
		query.append("@[ofc_flg2]   =   'R'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("@[ofc_cd2] <> 'All'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("DECODE(@[reqapp], 'R', AM.RQST_OFC_CD, AM.APRO_OFC_CD)   IN  (" ).append("\n"); 
		query.append("SELECT OFC_CD" ).append("\n"); 
		query.append("FROM   MDM_ORGANIZATION" ).append("\n"); 
		query.append("START WITH OFC_CD = @[ofc_cd2]" ).append("\n"); 
		query.append("CONNECT BY NOCYCLE PRIOR OFC_CD = PRNT_OFC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND AM.AFT_EXPT_DAR_NO = AD.AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("AND AM.DMDT_EXPT_RQST_STS_CD = 'A'" ).append("\n"); 
		query.append(") AFT_EXP , DMT_CHG_BKG_CNTR DB" ).append("\n"); 
		query.append("WHERE DB.BKG_NO        = AFT_EXP.BKG_NO" ).append("\n"); 
		query.append("#if ( ${slctscno} != '' && ${slctrfano} == '' )" ).append("\n"); 
		query.append("AND		DB.SC_NO IN (" ).append("\n"); 
		query.append("#foreach( $sc_no_p in ${tempSCNOList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempSCNOList.size())" ).append("\n"); 
		query.append("'$sc_no_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$sc_no_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( ${slctscno} == '' && ${slctrfano} != '' )" ).append("\n"); 
		query.append("AND		DB.RFA_NO IN (" ).append("\n"); 
		query.append("#foreach( $rfa_no_p in ${tempRFANOList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempRFANOList.size())" ).append("\n"); 
		query.append("'$rfa_no_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$rfa_no_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND   ROWNUM >=1" ).append("\n"); 
		query.append(") AFT_BKG#," ).append("\n"); 
		query.append("PRI_RP_HDR       RFH," ).append("\n"); 
		query.append("PRI_RP_MN        RFA" ).append("\n"); 
		query.append("WHERE DC.SYS_AREA_GRP_ID   = AFT_BKG#.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("AND DC.CNTR_NO           = AFT_BKG#.CNTR_NO" ).append("\n"); 
		query.append("AND DC.CNTR_CYC_NO       = AFT_BKG#.CNTR_CYC_NO" ).append("\n"); 
		query.append("AND DC.TO_MVMT_DT BETWEEN TO_DATE (REPLACE (@[fm_dt], '-', ''), 'YYYYMMDD') + .0" ).append("\n"); 
		query.append("AND TO_DATE (REPLACE (@[to_dt], '-', ''), 'YYYYMMDD')" ).append("\n"); 
		query.append("+ .99999" ).append("\n"); 
		query.append("AND DC.DMDT_TRF_CD IN (" ).append("\n"); 
		query.append("#foreach( $trf_cd_p in ${tempTRFCDList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempTRFCDList.size())" ).append("\n"); 
		query.append("'$trf_cd_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$trf_cd_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND DC.DMDT_TRF_CD       = AFT_BKG#.DMDT_TRF_CD" ).append("\n"); 
		query.append("AND RFH.PROP_NO          = RFA.PROP_NO" ).append("\n"); 
		query.append("AND RFH.RFA_NO            = AFT_BKG#.RFA_NO" ).append("\n"); 
		query.append("AND RFA.AMDT_SEQ          = (" ).append("\n"); 
		query.append("SELECT MAX(AMDT_SEQ)" ).append("\n"); 
		query.append("FROM   PRI_RP_MN" ).append("\n"); 
		query.append("WHERE  PRI_RP_MN.PROP_NO          = RFH.PROP_NO" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND AFT_BKG#.CTRT_TP     = 'R'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND DC.DMDT_CHG_STS_CD IN ('F', 'C', 'I', 'N')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND DC.AFT_EXPT_DAR_NO   =  AFT_BKG#.AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("AND DC.SYS_AREA_GRP_ID =" ).append("\n"); 
		query.append("(SELECT SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("FROM COM_SYS_AREA_GRP_ID S, MDM_ORGANIZATION M" ).append("\n"); 
		query.append("WHERE CNT_CD = SUBSTR (LOC_CD, 1, 2)" ).append("\n"); 
		query.append("AND CO_IND_CD = 'H'" ).append("\n"); 
		query.append("AND M.OFC_CD = DC.OFC_CD)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- 2010/03/25 추가" ).append("\n"); 
		query.append("AND DC.DMDT_CHG_LOC_DIV_CD <> 'SZP'" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(DC.DUL_TP_EXPT_FLG = 'Y' AND SUBSTR(DC.DMDT_TRF_CD, 1, 1) = 'C')" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("(DC.DUL_TP_EXPT_FLG = 'N')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")   X," ).append("\n"); 
		query.append("DMT_CHG_BKG_CNTR    DB" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("WHERE   DB.SYS_AREA_GRP_ID   = X.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("AND     DB.CNTR_NO           = X.CNTR_NO" ).append("\n"); 
		query.append("AND     DB.CNTR_CYC_NO       = X.CNTR_CYC_NO" ).append("\n"); 
		query.append("AND     X.BZC_TRF_CURR_CD = NVL( @[curr_flg] , X.BZC_TRF_CURR_CD )" ).append("\n"); 
		query.append("AND     (X.SC_RFA_EXPT_AMT  >   0   OR  X.AFT_EXPT_DC_AMT > 0)" ).append("\n"); 
		query.append("AND     X.ORG_CHG_AMT > 0" ).append("\n"); 
		query.append("AND     DB.DMDT_CNTR_TP_CD  IN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT 'D' FROM DUAL WHERE DECODE(@[dmdt_cntr_tp_cd], 'A', 'Y', 'D', 'Y', 'N') = 'Y'" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT 'R' FROM DUAL WHERE DECODE(@[dmdt_cntr_tp_cd], 'A', 'Y', 'R', 'Y', 'N') = 'Y'" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT 'F' FROM DUAL WHERE DECODE(@[dmdt_cntr_tp_cd], 'A', 'Y', 'S', 'Y', 'N') = 'Y'" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT 'O' FROM DUAL WHERE DECODE(@[dmdt_cntr_tp_cd], 'A', 'Y', 'S', 'Y', 'N') = 'Y'" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT 'T' FROM DUAL WHERE DECODE(@[dmdt_cntr_tp_cd], 'A', 'Y', 'S', 'Y', 'N') = 'Y'" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT 'P' FROM DUAL WHERE DECODE(@[dmdt_cntr_tp_cd], 'A', 'Y', 'S', 'Y', 'N') = 'Y'" ).append("\n"); 
		query.append("UNION ALL                  /* Sliding Open Top, Adjustable Flatrack 추가 - #add 2008.10.09 */" ).append("\n"); 
		query.append("SELECT 'S' FROM DUAL WHERE DECODE(@[dmdt_cntr_tp_cd], 'A', 'Y', 'S', 'Y', 'N') = 'Y'" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT 'A' FROM DUAL WHERE DECODE(@[dmdt_cntr_tp_cd], 'A', 'Y', 'S', 'Y', 'N') = 'Y'" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( ${slctscno} != '' && ${slctrfano} != '' )" ).append("\n"); 
		query.append("AND		X.SC_NO IN (" ).append("\n"); 
		query.append("#foreach( $sc_no_p in ${tempSCNOList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempSCNOList.size())" ).append("\n"); 
		query.append("'$sc_no_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$sc_no_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR		X.RFA_NO IN (" ).append("\n"); 
		query.append("#foreach( $rfa_no_p in ${tempRFANOList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempRFANOList.size())" ).append("\n"); 
		query.append("'$rfa_no_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$rfa_no_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( ${slctscno} != '' && ${slctrfano} == '' )" ).append("\n"); 
		query.append("AND		TRIM(X.SC_NO) IN (" ).append("\n"); 
		query.append("#foreach( $sc_no_p in ${tempSCNOList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempSCNOList.size())" ).append("\n"); 
		query.append("'$sc_no_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$sc_no_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( ${slctscno} == '' && ${slctrfano} != '' )" ).append("\n"); 
		query.append("AND		TRIM(X.RFA_NO) IN (" ).append("\n"); 
		query.append("#foreach( $rfa_no_p in ${tempRFANOList})" ).append("\n"); 
		query.append("#if($velocityCount < $tempRFANOList.size())" ).append("\n"); 
		query.append("'$rfa_no_p'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$rfa_no_p'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 

	}
}