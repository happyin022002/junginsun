<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ContainerMovementMgtDBDAOSearchN1stN2ndMvmtStsInfoRSQL">
			<desc><![CDATA[ContainerMovementMgtDBDAOSearchN1stN2ndMvmtStsInfoRSQL]]></desc>
			<sql><![CDATA[
SELECT  /*+ INDEX_DESC( T1 XUK1CTM_MOVEMENT ) */
        T1.CNTR_NO
       ,T1.BKG_CGO_TP_CD
       ,T1.ORG_YD_CD
       ,RTRIM(T1.DEST_YD_CD) 						AS DESC_YD_CD
       ,T1.CNMV_SPLIT_NO
       ,T1.CNMV_LVL_NO
       ,T1.TRNK_VSL_CD
       ,T1.TRNK_SKD_VOY_NO
       ,T1.TRNK_SKD_DIR_CD
       ,T1.OB_CNTR_FLG
       ,T1.FCNTR_FLG
       ,T1.CNTR_SEAL_NO
       ,TO_CHAR(T1.CNMV_EVNT_DT, 'YYYYMMDD') 		AS CNTR_EVNT_DT

       ,T1.BKG_NO
       ,T1.BKG_KNT
       ,TO_CHAR(T1.CNMV_EVNT_DT, 'YYYYMMDD')        AS EVNT_DT
       ,'' 											AS CM_MSG_ID
       ,T1.SYS_AREA_GRP_ID 							AS CNTR_SVR_ID
       ,T1.CNTR_ACT_CD 								AS ACIAC_DIV_CD
       ,T1.MVMT_CRE_TP_CD
       ,T1.BL_NO
       ,T1.CNMV_YR
       ,T1.CNMV_ID_NO
       ,T1.CNMV_SEQ
       ,T1.MVMT_INP_TP_CD
       ,TO_CHAR(T1.CNMV_EVNT_DT, 'YYYYMMDDHH24MI') 	AS CNMV_EVNT_DT
       ,T1.DEST_YD_CD
       ,T1.CRNT_VSL_CD
       ,T1.CRNT_SKD_VOY_NO
       ,T1.CRNT_SKD_DIR_CD
       ,'' 											AS NEW_FLG
       ,T1.UPD_USR_ID
       ,T1.IMDT_EXT_FLG
       ,T1.CNTR_RFUB_FLG
       ,T1.CNTR_HNGR_RCK_FLG
       ,T1.CNTR_DMG_FLG
       ,T1.CNTR_DISP_FLG
       ,T1.CNTR_ACT_CD
       ,T1.PRE_STS_FLG

       ,'Y' 										AS CTM_UI_YN
	   ,T1.CNMV_CYC_NO
	   ,T2.CNMV_CYC_NO  							AS N2ND_CNMV_CYC_NO
	   ,T1.MVMT_STS_CD
	   ,T2.MVMT_STS_CD  							AS N2ND_MVMT_STS_CD
	   
	   
  FROM  CTM_MOVEMENT  T1		--// 1번째 MVMT STS
		
       ,(
			SELECT  *
			  FROM  (
						SELECT  /*+ INDEX_DESC( CTM_MOVEMENT XUK1CTM_MOVEMENT ) */
								CNTR_NO
							   ,CNMV_CYC_NO
							   ,MVMT_STS_CD
							   ,ROWNUM       AS RNUM
						  FROM  CTM_MOVEMENT
						 WHERE  CNTR_NO = @[cntr_no]
						   AND  ROWNUM <= 2
					)
			 WHERE  RNUM = 2
	    ) T2					--// 2번째 MVMT STS
		
 WHERE  T1.CNTR_NO = @[cntr_no]
   AND  ROWNUM = 1			]]></sql>
			<params>
				<param name="cntr_no" type="12" value="1" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
