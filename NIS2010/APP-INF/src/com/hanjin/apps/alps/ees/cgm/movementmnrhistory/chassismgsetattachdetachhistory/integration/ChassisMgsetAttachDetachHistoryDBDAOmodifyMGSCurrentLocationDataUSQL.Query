<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChassisMgsetAttachDetachHistoryDBDAOmodifyMGSCurrentLocationDataUSQL">
			<desc><![CDATA[ChassisMgsetAttachDetachHistoryDBDAOmodifyMGSCurrentLocationDataUSQL]]></desc>
			<sql><![CDATA[
UPDATE CGM_EQUIPMENT A
SET (CRNT_LOC_CD, A.CRNT_YD_CD)=
        (
        SELECT SUBSTR(CURR_YD,1,5),CURR_YD FROM (
            SELECT
            /*+ INDEX_DESC(A XPKCGM_EQ_ATCH_DTCH_HIS) */
            DECODE( DTCH_YD_CD, NULL, ATCH_YD_CD,DTCH_YD_CD ) CURR_YD
            ,DECODE( DTCH_YD_CD, NULL, ATCH_DT,DTCH_DT ) CURR_DT
             FROM CGM_EQ_ATCH_DTCH_HIS A
            WHERE EQ_NO = @[eq_no]
            AND ROWNUM=1
            UNION ALL
            SELECT /*+ INDEX_DESC(A XAK4CGM_EQ_STS_HIS) */
            STS_EVNT_YD_CD,STS_EVNT_DT  FROM CGM_EQ_STS_HIS A
            WHERE EQ_NO = @[eq_no]
            AND ROWNUM = 1
            ORDER BY  CURR_DT DESC
        )
        WHERE ROWNUM=1
        )
,UPD_DT = SYSDATE
,UPD_USR_ID = @[upd_usr_id]
WHERE EQ_NO = @[eq_no]			]]></sql>
			<params>
				<param name="eq_no" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
