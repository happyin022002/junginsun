<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CntrRepoPlanSensitivityAnalysisDBDAOSearchPlanSensivityCompareRSQL">
			<desc><![CDATA[EQR_VSL_LODG_DCHG_PLN, EQR_INLND_TRSP_PLN, EQR_ONF_HIR_PLN   EQR Plan의 민감도 분석 (비교버젼)]]></desc>
			<sql><![CDATA[
SELECT PLN_YRWK                                                                                                            
       , CD_DESC                                                                                               			
       , ID1_VOL                                                                                                           
       , ID1_COST                                                                                                          
       , ID2_VOL                                                                                                           
       , ID2_COST                                                                                                          
       , DIF_VOL                                                                                                           
       , DIF_COST                                                                                                          
       , COST_TYPE                                                                                                         
 FROM (SELECT SUBSTR(PLN_YRWK,1,4) || '-' || SUBSTR(PLN_YRWK,5,2) PLN_YRWK     											
		         , DECODE(GROUPING(COST_TYPE),1,'Total', COST_TYPE) COST_TYPE                                                
		         , SUM(ID1_VOL) ID1_VOL                                                                                      
		         , SUM(ID1_COST) ID1_COST                                                                                    
		         , SUM(ID2_VOL) ID2_VOL                                                                                      
		         , SUM(ID2_COST) ID2_COST                                                                                    
		         , SUM(ID1_VOL) - SUM(ID2_VOL) DIF_VOL                                                                       
		         , SUM(ID1_COST) - SUM(ID2_COST) DIF_COST  
--  Load Start --		                                                                           
		   FROM ( SELECT PLN_YRWK                                                                                            
		                , 'L' COST_TYPE                                                                                     
		                , CNTR_QTY ID1_VOL                                                                             		
		                , LODG_DCHG_COST_AMT ID1_COST                                                                  		
		                , 0 ID2_VOL                                                                                         
		                , 0 ID2_COST                                                                                        
		          FROM ( SELECT REPO_PLN_ID
		                        , PLN_YRWK                                                                       
		                        , FM_ECC_CD
		                        , FM_DT
		                        , FM_WK                                                                   
		                        , TO_ECC_CD
		                        , TO_DT
		                        , TO_WK                                                                   
		                        , CNTR_TPSZ_CD
		                        , CNTR_QTY
		                        , LODG_DCHG_COST_AMT                                                
		                 FROM ( SELECT A.REPO_PLN_ID
		                               , B.PLN_YRWK                                                             
		                               , B.FM_ECC_CD
		                               , B.FM_ETD_DT
		                               , TO_CHAR(B.FM_ETD_DT, 'YYYYMMDD') FM_DT                        
		                               , B.TO_ECC_CD
		                               , B.TO_ETB_DT
		                               , TO_CHAR(B.TO_ETB_DT, 'YYYYMMDD') TO_DT          				
		                               , E.CNTR_TPSZ_CD
		                               , E.CNTR_QTY
		                               , E.LODG_DCHG_COST_AMT                                        
		                        FROM EQR_EQ_REPO_PLN A                                                                     
		                             , EQR_VSL_LODG_DCHG_PLN B                                                             
		                             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C
		                             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) D
		                             , EQR_VSL_LODG_DCHG_PLN_QTY E
		                        WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                        
		                        AND B.FM_ECC_CD = C.ECC_CD                                                           
		                        AND B.TO_ECC_CD = D.ECC_CD                                                           
		                        AND B.REPO_PLN_ID = @[repo_pln_id]                                                 				
		                        AND E.CNTR_TPSZ_CD IN (${arrtpszcd})
		                        AND B.REPO_PLN_ID = E.REPO_PLN_ID
		                        AND B.PLN_YRWK    = E.PLN_YRWK
		                        AND B.PLN_SEQ     = E.PLN_SEQ	            							
		                     #if (${fmecccd} != '') 
  	                        #if (${fmtype} == 'R')
                            AND C.RCC_CD IN (${arrfmecccd}) 
                            #end
   	                        #if (${fmtype} == 'L')
                            AND C.LCC_CD IN (${arrfmecccd})
                            #end
   	                        #if (${fmtype} == 'E')
                            AND C.ECC_CD IN (${arrfmecccd})
                            #end
                         #end
                         #if (${toecccd} != '') 
 	                          #if (${totype} == 'R')
                            AND D.RCC_CD IN (${arrtoecccd}) 
	                          #end
   	                        #if (${totype} == 'L')
                            AND D.LCC_CD IN (${arrtoecccd})
	                          #end
   	                        #if (${totype} == 'E')
                            AND D.ECC_CD IN (${arrtoecccd})
	                          #end
                        #end  
		                    ) L                                                                                            
                       , (SELECT PLN_YR || PLN_WK FM_WK, WK_ST_DT, WK_END_DT FROM EQR_WK_PRD) M                       
	                     , (SELECT PLN_YR || PLN_WK TO_WK, WK_ST_DT, WK_END_DT FROM EQR_WK_PRD) N                       
	                   WHERE L.FM_DT BETWEEN M.WK_ST_DT AND M.WK_END_DT          											
                     AND L.TO_DT BETWEEN N.WK_ST_DT AND N.WK_END_DT    											
	                   AND M.FM_WK BETWEEN @[fmstartprd] AND @[fmendprd]
	                   #if (${fmtype} != '' && ${totype} != '') 
	                   AND N.TO_WK BETWEEN @[tostartprd] AND @[toendprd]
	                   #end
		            ) 
		#if (${repo_pln_id2} != '')                                                                                                                 
		       UNION ALL                                                                                                  
		       SELECT PLN_YRWK                                                                                            
		              , 'L' COST_TYPE                                                                                     
		              , 0 ID1_VOL                                                                                         
		              , 0 ID1_COST                                                                                        
		              , CNTR_QTY ID2_VOL                                                                             		
		              , LODG_DCHG_COST_AMT ID2_COST                                                                  		
		       FROM ( SELECT REPO_PLN_ID
		                     , PLN_YRWK 
		                     , FM_ECC_CD
		                     , FM_DT
		                     , FM_WK                                                                
		                     , TO_ECC_CD
		                     , TO_DT, TO_WK                                                                   
		                     , CNTR_TPSZ_CD
		                     , CNTR_QTY
		                     , LODG_DCHG_COST_AMT                                                
		              FROM ( SELECT A.REPO_PLN_ID
		                           , B.PLN_YRWK                                                             
		                           , B.FM_ECC_CD
		                           , B.FM_ETD_DT
		                           , TO_CHAR(B.FM_ETD_DT, 'YYYYMMDD') FM_DT                        
		                           , B.TO_ECC_CD
		                           , B.TO_ETB_DT
		                           , TO_CHAR(B.TO_ETB_DT, 'YYYYMMDD') TO_DT             			
		                           , E.CNTR_TPSZ_CD
		                           , E.CNTR_QTY
		                           , E.LODG_DCHG_COST_AMT                                        
		                     FROM EQR_EQ_REPO_PLN A                                                                     
		                          , EQR_VSL_LODG_DCHG_PLN B                                                             
		                          , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C	                                
		                          , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) D
		                          , EQR_VSL_LODG_DCHG_PLN_QTY E	                                
		                     WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                        
		                           AND B.FM_ECC_CD = C.ECC_CD                                                           
		                           AND B.TO_ECC_CD = D.ECC_CD                                                           
		                           AND B.REPO_PLN_ID = @[repo_pln_id2] 
		                           AND E.CNTR_TPSZ_CD IN (${arrtpszcd})
		                           AND B.REPO_PLN_ID = E.REPO_PLN_ID
		                           AND B.PLN_YRWK    = E.PLN_YRWK
		                           AND B.PLN_SEQ     = E.PLN_SEQ	 
		                        #if (${fmecccd} != '') 
  	                           #if (${fmtype} == 'R')
                               AND C.RCC_CD IN (${arrfmecccd}) 
                               #end
   	                           #if (${fmtype} == 'L')
                               AND C.LCC_CD IN (${arrfmecccd})
                               #end
   	                           #if (${fmtype} == 'E')
                               AND C.ECC_CD IN (${arrfmecccd})
                               #end
                            #end
                            #if (${toecccd} != '') 
 	                             #if (${totype} == 'R')
                               AND D.RCC_CD IN (${arrtoecccd}) 
	                             #end
   	                           #if (${totype} == 'L')
                               AND D.LCC_CD IN (${arrtoecccd})
	                             #end
   	                           #if (${totype} == 'E')
                               AND D.ECC_CD IN (${arrtoecccd})
	                             #end
                            #end    
		                  ) L                                                                                            
		                   , (SELECT PLN_YR || PLN_WK FM_WK, WK_ST_DT, WK_END_DT FROM EQR_WK_PRD) M                       
		                   , (SELECT PLN_YR || PLN_WK TO_WK, WK_ST_DT, WK_END_DT FROM EQR_WK_PRD) N                       
		                 WHERE L.FM_DT BETWEEN M.WK_ST_DT AND M.WK_END_DT          											
		                 AND L.TO_DT BETWEEN N.WK_ST_DT AND N.WK_END_DT    											
		                 AND M.FM_WK BETWEEN @[fmstartprd] AND @[fmendprd]
		                  #if (${fmtype} != '' && ${totype} != '') 
	                   AND N.TO_WK BETWEEN @[tostartprd] AND @[toendprd]
	                   #end                                                    				  
		          )                                                                                                      
	#end
		-- Load End -------
		        UNION ALL                                                                                                  
		---- Discharge Start -----
		        SELECT PLN_YRWK                                                                                            
		              , 'D' COST_TYPE                                                                                     
		              , CNTR_QTY ID1_VOL                                                                             		
		              , LODG_DCHG_COST_AMT ID1_COST                                                                  		
		              , 0 ID2_VOL                                                                                         
		              , 0 ID2_COST                                                                                        
		                 FROM ( SELECT REPO_PLN_ID
		                              , PLN_YRWK                                                                       
		                              , FM_ECC_CD
		                              , FM_DT
		                              , FM_WK                                                                   
		                              , TO_ECC_CD
		                              , TO_DT
		                              , TO_WK                                                                   
		                              , CNTR_TPSZ_CD
		                              , CNTR_QTY
		                              , LODG_DCHG_COST_AMT                                                
		                         FROM ( SELECT A.REPO_PLN_ID
		                                       , B.PLN_YRWK                                                             
		                                       , B.FM_ECC_CD
		                                       , B.FM_ETD_DT
		                                       , TO_CHAR(B.FM_ETD_DT, 'YYYYMMDD') FM_DT                        
		                                       , B.TO_ECC_CD
		                                       , B.TO_ETB_DT
		                                       , TO_CHAR(B.TO_ETB_DT, 'YYYYMMDD') TO_DT            			
		                                       , E.CNTR_TPSZ_CD
		                                       , E.CNTR_QTY
		                                       , E.LODG_DCHG_COST_AMT                                        
		                                 FROM EQR_EQ_REPO_PLN A                                                                     
		                                      , EQR_VSL_LODG_DCHG_PLN B                                                             
		                                      , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C	
		                                      , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) D
		                                      , EQR_VSL_LODG_DCHG_PLN_QTY E	
		                                 WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                        
		                                 AND B.FM_ECC_CD = C.ECC_CD                                                           
		                                 AND B.TO_ECC_CD = D.ECC_CD                                                           
		                                 AND B.REPO_PLN_ID = @[repo_pln_id] 
		                                 AND E.CNTR_TPSZ_CD IN (${arrtpszcd})
		                                 AND B.REPO_PLN_ID = E.REPO_PLN_ID
		                                 AND B.PLN_YRWK    = E.PLN_YRWK
		                                 AND B.PLN_SEQ     = E.PLN_SEQ
		                              #if (${fmecccd} != '')             
                                      #if (${fmtype} == 'R')          
                                     AND C.RCC_CD IN (${arrfmecccd}) 
                                     #end                            
                                     #if (${fmtype} == 'L')          
                                     AND C.LCC_CD IN (${arrfmecccd}) 
                                     #end                            
                                     #if (${fmtype} == 'E')          
                                     AND C.ECC_CD IN (${arrfmecccd}) 
                                     #end                            
                                  #end                               
                                  #if (${toecccd} != '')             
                                     #if (${totype} == 'R')          
                                     AND D.RCC_CD IN (${arrtoecccd}) 
                                     #end                            
                                     #if (${totype} == 'L')          
                                     AND D.LCC_CD IN (${arrtoecccd}) 
                                     #end                            
                                     #if (${totype} == 'E')          
                                     AND D.ECC_CD IN (${arrtoecccd}) 
                                     #end                            
                                  #end                               
                            ) L                                                                                            
		                       , (SELECT PLN_YR || PLN_WK FM_WK, WK_ST_DT, WK_END_DT FROM EQR_WK_PRD) M                       
		                       , (SELECT PLN_YR || PLN_WK TO_WK, WK_ST_DT, WK_END_DT FROM EQR_WK_PRD) N                       
		                       WHERE L.FM_DT BETWEEN M.WK_ST_DT AND M.WK_END_DT          											
		                       AND L.TO_DT BETWEEN N.WK_ST_DT AND N.WK_END_DT    											
		                       #if (${fmtype} != '' && ${totype} != '')
			                     AND M.FM_WK BETWEEN @[fmstartprd] AND @[fmendprd]                                              
		                       #end
		                       AND N.TO_WK BETWEEN @[tostartprd] AND @[toendprd]                                              
		                   )
		#if (${repo_pln_id2} != '')                                                                                                                         
		        UNION ALL                                                                                                  
		        SELECT PLN_YRWK                                                                                            
		               , 'D' COST_TYPE                                                                                     
		               , 0 ID1_VOL                                                                                         
		               , 0 ID1_COST                                                                                        
		               , CNTR_QTY ID2_VOL                                                                             		
		               , LODG_DCHG_COST_AMT ID2_COST                                                                  		 
		        FROM ( SELECT REPO_PLN_ID
		                      , PLN_YRWK                                                                       
		                      , FM_ECC_CD
		                      , FM_DT, FM_WK                                                                   
		                      , TO_ECC_CD
		                      , TO_DT
		                      , TO_WK                                                                   
		                      , CNTR_TPSZ_CD
		                      , CNTR_QTY
		                      , LODG_DCHG_COST_AMT                                                
		                FROM ( SELECT A.REPO_PLN_ID
		                              , B.PLN_YRWK                                                             
		                              , B.FM_ECC_CD
		                              , B.FM_ETD_DT
		                              , TO_CHAR(B.FM_ETD_DT, 'YYYYMMDD') FM_DT                        
		                              , B.TO_ECC_CD
		                              , B.TO_ETB_DT
		                              , TO_CHAR(B.TO_ETB_DT, 'YYYYMMDD') TO_DT            			
		                              , E.CNTR_TPSZ_CD
		                              , E.CNTR_QTY
		                              , E.LODG_DCHG_COST_AMT                                        
		                       FROM EQR_EQ_REPO_PLN A                                                                     
		                           , EQR_VSL_LODG_DCHG_PLN B                                                             
		                           , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C	 
		                           , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) D	 
		                           , EQR_VSL_LODG_DCHG_PLN_QTY E
		                       WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                        
		                       AND B.FM_ECC_CD = C.ECC_CD                                                           
		                       AND B.TO_ECC_CD = D.ECC_CD                                                           
		                       AND B.REPO_PLN_ID = @[repo_pln_id2]             
		                       AND E.CNTR_TPSZ_CD IN (${arrtpszcd})
		                       AND B.REPO_PLN_ID = E.REPO_PLN_ID
		                       AND B.PLN_YRWK    = E.PLN_YRWK
		                       AND B.PLN_SEQ     = E.PLN_SEQ
		                    #if (${fmecccd} != '')             
                            #if (${fmtype} == 'R')          
                           AND C.RCC_CD IN (${arrfmecccd}) 
                           #end                            
                           #if (${fmtype} == 'L')          
                           AND C.LCC_CD IN (${arrfmecccd}) 
                           #end                            
                           #if (${fmtype} == 'E')          
                           AND C.ECC_CD IN (${arrfmecccd}) 
                           #end                            
                        #end                               
                        #if (${toecccd} != '')             
                           #if (${totype} == 'R')          
                           AND D.RCC_CD IN (${arrtoecccd}) 
                           #end                            
                           #if (${totype} == 'L')          
                           AND D.LCC_CD IN (${arrtoecccd}) 
                           #end                            
                           #if (${totype} == 'E')          
                           AND D.ECC_CD IN (${arrtoecccd}) 
                           #end                            
                        #end                               
                       ) L                                                                                            
		                  , (SELECT PLN_YR || PLN_WK FM_WK, WK_ST_DT, WK_END_DT FROM EQR_WK_PRD) M                       
		                  , (SELECT PLN_YR || PLN_WK TO_WK, WK_ST_DT, WK_END_DT FROM EQR_WK_PRD) N                       
		                     WHERE L.FM_DT BETWEEN M.WK_ST_DT AND M.WK_END_DT         											
		                     AND L.TO_DT BETWEEN N.WK_ST_DT AND N.WK_END_DT    											
	                       #if (${fmtype} != '' && ${totype} != '')
			                   AND M.FM_WK BETWEEN @[fmstartprd] AND @[fmendprd]                                              
		                     #end
		                     AND N.TO_WK BETWEEN @[tostartprd] AND @[toendprd]   
		            )                                                                                                      
		#end
		--- Discharge End -----
		        UNION ALL                                                                                                  
		---- Rail Start ---------
		        SELECT B.PLN_YRWK                                                                                            
		               , 'R' COST_TYPE                                                                                     
		               , E.CNTR_QTY ID1_VOL                                                                             		
		               , E.TRSP_COST_AMT ID1_COST                                                                       		
		               , 0 ID2_VOL                                                                                         
		               , 0 ID2_COST                                                                                        
		        FROM EQR_EQ_REPO_PLN A                                                                                     
		             , EQR_INLND_TRSP_PLN B                                                                                
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C	                                               
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) D	
		             , EQR_INLND_TRSP_PLN_QTY E                                              
		        WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                                        
		              AND B.FM_ECC_CD = C.ECC_CD                                                                           
		              AND B.TO_ECC_CD = D.ECC_CD                                                                           
		              AND B.REPO_PLN_ID = @[repo_pln_id]                                                                 				
		              AND E.CNTR_TPSZ_CD IN (${arrtpszcd})  
		              AND TRSP_MOD_CD = 'R'                 
		              AND FM_YRWK BETWEEN @[fmstartprd] AND @[fmendprd]	
		              #if (${fmtype} != '' && ${totype} != '')
			            AND TO_YRWK BETWEEN @[tostartprd] AND @[toendprd]	                  
		              #end 
		              AND B.REPO_PLN_ID = E.REPO_PLN_ID
		              AND B.PLN_YRWK    = E.PLN_YRWK
		              AND B.PLN_SEQ     = E.PLN_SEQ       
               #if (${fmecccd} != '')             
                   #if (${fmtype} == 'R')          
                  AND C.RCC_CD IN (${arrfmecccd}) 
                  #end                            
                  #if (${fmtype} == 'L')          
                  AND C.LCC_CD IN (${arrfmecccd}) 
                  #end                            
                  #if (${fmtype} == 'E')          
                  AND C.ECC_CD IN (${arrfmecccd}) 
                  #end                            
               #end                               
               #if (${toecccd} != '')             
                  #if (${totype} == 'R')          
                  AND D.RCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'L')          
                  AND D.LCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'E')          
                  AND D.ECC_CD IN (${arrtoecccd}) 
                  #end                            
               #end 
    #if (${repo_pln_id2} != '')              
		        UNION ALL                                                                                                  
		        SELECT B.PLN_YRWK                                                                                            
		               , 'R' COST_TYPE                                                                                     
		               , 0 ID1_VOL                                                                                         
		               , 0 ID1_COST                                                                                        
		               , E.CNTR_QTY ID2_VOL                                                                             		
		               , E.TRSP_COST_AMT ID2_COST                                                                       		
		        FROM EQR_EQ_REPO_PLN A                                                                                     
		             , EQR_INLND_TRSP_PLN B                                                                                
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C	                
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) D	
		             , EQR_INLND_TRSP_PLN_QTY E                
		        WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                                        
		              AND B.FM_ECC_CD = C.ECC_CD                                                                           
		              AND B.TO_ECC_CD = D.ECC_CD                                                                           
		              AND B.REPO_PLN_ID = @[repo_pln_id2]                                                                 				
		              AND E.CNTR_TPSZ_CD IN (${arrtpszcd}) 
		              AND B.TRSP_MOD_CD = 'R'
		              AND B.REPO_PLN_ID = E.REPO_PLN_ID
		              AND B.PLN_YRWK    = E.PLN_YRWK
		              AND B.PLN_SEQ     = E.PLN_SEQ                
		              AND FM_YRWK BETWEEN @[fmstartprd] AND @[fmendprd]	
		              #if (${fmtype} != '' && ${totype} != '')
			            AND TO_YRWK BETWEEN @[tostartprd] AND @[toendprd]	                  
		              #end
               #if (${fmecccd} != '')             
                  #if (${fmtype} == 'R')          
                  AND C.RCC_CD IN (${arrfmecccd}) 
                  #end                            
                  #if (${fmtype} == 'L')          
                  AND C.LCC_CD IN (${arrfmecccd}) 
                  #end                            
                  #if (${fmtype} == 'E')          
                  AND C.ECC_CD IN (${arrfmecccd}) 
                  #end                            
               #end                               
               #if (${toecccd} != '')             
                  #if (${totype} == 'R')          
                  AND D.RCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'L')          
                  AND D.LCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'E')          
                  AND D.ECC_CD IN (${arrtoecccd}) 
                  #end                            
               #end 	     
		#end
		----- Rail End -----
		        UNION ALL                                                                                                  
		---- Water Start ---
		        SELECT B.PLN_YRWK                                                                                            
		               , 'W' COST_TYPE                                                                                     
		               , E.CNTR_QTY ID1_VOL                                                                             		
		               , E.TRSP_COST_AMT ID1_COST                                                                       		
		               , 0 ID2_VOL                                                                                         
		               , 0 ID2_COST                                                                                        
		        FROM EQR_EQ_REPO_PLN A                                                                                     
		             , EQR_INLND_TRSP_PLN B                                                                                
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C	
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) D	
		             , EQR_INLND_TRSP_PLN_QTY E
		        WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                                        
		              AND B.FM_ECC_CD = C.ECC_CD                                                                           
		              AND B.TO_ECC_CD = D.ECC_CD                                                                           
		              AND B.REPO_PLN_ID = @[repo_pln_id]                                                                 				
		              AND E.CNTR_TPSZ_CD IN (${arrtpszcd})                       
		              AND B.TRSP_MOD_CD = 'W'
		              AND B.REPO_PLN_ID = E.REPO_PLN_ID
		              AND B.PLN_YRWK    = E.PLN_YRWK
		              AND B.PLN_SEQ     = E.PLN_SEQ  
		              AND FM_YRWK BETWEEN @[fmstartprd] AND @[fmendprd]	
		              #if (${fmtype} != '' && ${totype} != '')
			            AND TO_YRWK BETWEEN @[tostartprd] AND @[toendprd]	                  
		              #end
		           #if (${fmecccd} != '')             
                  #if (${fmtype} == 'R')          
                  AND C.RCC_CD IN (${arrfmecccd}) 
                  #end                            
                  #if (${fmtype} == 'L')          
                  AND C.LCC_CD IN (${arrfmecccd}) 
                  #end                            
                  #if (${fmtype} == 'E')          
                  AND C.ECC_CD IN (${arrfmecccd}) 
                  #end                            
               #end                               
               #if (${toecccd} != '')             
                  #if (${totype} == 'R')          
                  AND D.RCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'L')          
                  AND D.LCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'E')          
                  AND D.ECC_CD IN (${arrtoecccd}) 
                  #end                            
               #end 	                                         
     #if (${repo_pln_id2} != '')
		        UNION ALL                                                                                                  
		        SELECT B.PLN_YRWK                                                                                            
		               , 'W' COST_TYPE                                                                                     
		               , 0 ID1_VOL                                                                                         
		               , 0 ID1_COST                                                                                        
		               , E.CNTR_QTY ID2_VOL                                                                             		
		               , E.TRSP_COST_AMT ID2_COST                                                                       		
		        FROM EQR_EQ_REPO_PLN A                                                                                     
		             , EQR_INLND_TRSP_PLN B                                                                                
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C	                       
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) D	
		             , EQR_INLND_TRSP_PLN_QTY E                       
		        WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                                        
		              AND B.FM_ECC_CD = C.ECC_CD                                                                           
		              AND B.TO_ECC_CD = D.ECC_CD                                                                           
		              AND B.REPO_PLN_ID = @[repo_pln_id2]                                                                 				
		              AND E.CNTR_TPSZ_CD IN (${arrtpszcd})                              	
		              AND B.TRSP_MOD_CD = 'W'
		              AND B.REPO_PLN_ID = E.REPO_PLN_ID
		              AND B.PLN_YRWK    = E.PLN_YRWK
		              AND B.PLN_SEQ     = E.PLN_SEQ    
		              AND FM_YRWK BETWEEN @[fmstartprd] AND @[fmendprd]	
		              #if (${fmtype} != '' && ${totype} != '')
			            AND TO_YRWK BETWEEN @[tostartprd] AND @[toendprd]	                  
		              #end 
		           #if (${fmecccd} != '')             
                  #if (${fmtype} == 'R')          
                  AND C.RCC_CD IN (${arrfmecccd}) 
                  #end                            
                  #if (${fmtype} == 'L')          
                  AND C.LCC_CD IN (${arrfmecccd}) 
                  #end                            
                  #if (${fmtype} == 'E')          
                  AND C.ECC_CD IN (${arrfmecccd}) 
                  #end                            
               #end                               
               #if (${toecccd} != '')             
                  #if (${totype} == 'R')          
                  AND D.RCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'L')          
                  AND D.LCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'E')          
                  AND D.ECC_CD IN (${arrtoecccd}) 
                  #end                            
               #end 	                                             
			#end
		---- Water End ---
		        UNION ALL                                                                                                  
		---- Truck Start ---
		        SELECT B.PLN_YRWK                                                                                            
		               , 'T' COST_TYPE                                                                                     
		               , E.CNTR_QTY ID1_VOL                                                                             		
		               , E.TRSP_COST_AMT ID1_COST                                                                       		
		               , 0 ID2_VOL                                                                                         
		               , 0 ID2_COST                                                                                        
		        FROM EQR_EQ_REPO_PLN A                                                                                     
		             , EQR_INLND_TRSP_PLN B                                                                                
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C	           
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) D	
		             , EQR_INLND_TRSP_PLN_QTY E            
		        WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                                        
		              AND B.FM_ECC_CD = C.ECC_CD                                                                           
		              AND B.TO_ECC_CD = D.ECC_CD                                                                           
		              AND B.REPO_PLN_ID = @[repo_pln_id]                                                                 				
		              AND E.CNTR_TPSZ_CD IN (${arrtpszcd})                         
		              AND B.TRSP_MOD_CD = 'T'
		              AND B.REPO_PLN_ID = E.REPO_PLN_ID
		              AND B.PLN_YRWK    = E.PLN_YRWK
		              AND B.PLN_SEQ     = E.PLN_SEQ 
		              AND FM_YRWK BETWEEN @[fmstartprd] AND @[fmendprd]	
		              #if (${fmtype} != '' && ${totype} != '')
			            AND TO_YRWK BETWEEN @[tostartprd] AND @[toendprd]	                  
		              #end                                      
	             #if (${fmecccd} != '')             
                  #if (${fmtype} == 'R')          
                  AND C.RCC_CD IN (${arrfmecccd}) 
                  #end                            
                  #if (${fmtype} == 'L')          
                  AND C.LCC_CD IN (${arrfmecccd}) 
                  #end                            
                  #if (${fmtype} == 'E')          
                  AND C.ECC_CD IN (${arrfmecccd}) 
                  #end                            
               #end                               
               #if (${toecccd} != '')             
                  #if (${totype} == 'R')          
                  AND D.RCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'L')          
                  AND D.LCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'E')          
                  AND D.ECC_CD IN (${arrtoecccd}) 
                  #end                            
               #end 	                   
	  #if (${repo_pln_id2} != '')
		        UNION ALL                                                                                                  
		        SELECT B.PLN_YRWK                                                                                            
		               , 'T' COST_TYPE                                                                                     
		               , 0 ID1_VOL                                                                                         
		               , 0 ID1_COST                                                                                        
		               , E.CNTR_QTY ID2_VOL                                                                             		
		               , E.TRSP_COST_AMT ID2_COST                                                                       		
		        FROM EQR_EQ_REPO_PLN A                                                                                     
		             , EQR_INLND_TRSP_PLN B                                                                                
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C	
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) D	
		             , EQR_INLND_TRSP_PLN_QTY E
		        WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                                        
		              AND B.FM_ECC_CD = C.ECC_CD                                                                           
		              AND B.TO_ECC_CD = D.ECC_CD                                                                           
		              AND B.REPO_PLN_ID = @[repo_pln_id2]                                                                 				
		              AND E.CNTR_TPSZ_CD IN (${arrtpszcd}) 
		              AND B.TRSP_MOD_CD = 'T'
		              AND B.REPO_PLN_ID = E.REPO_PLN_ID
		              AND B.PLN_YRWK    = E.PLN_YRWK
		              AND B.PLN_SEQ     = E.PLN_SEQ 
		              AND FM_YRWK BETWEEN @[fmstartprd] AND @[fmendprd]	
		              #if (${fmtype} != '' && ${totype} != '')
			            AND TO_YRWK BETWEEN @[tostartprd] AND @[toendprd]	                  
		              #end                                                        
		            #if (${fmecccd} != '')             
                  #if (${fmtype} == 'R')          
                  AND C.RCC_CD IN (${arrfmecccd}) 
                  #end                            
                  #if (${fmtype} == 'L')          
                  AND C.LCC_CD IN (${arrfmecccd}) 
                  #end                            
                  #if (${fmtype} == 'E')          
                  AND C.ECC_CD IN (${arrfmecccd}) 
                  #end                            
               #end                               
               #if (${toecccd} != '')             
                  #if (${totype} == 'R')          
                  AND D.RCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'L')          
                  AND D.LCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'E')          
                  AND D.ECC_CD IN (${arrtoecccd}) 
                  #end                            
               #end 	
		#end
		------ Truck End ----
		        UNION ALL                                                                                                  
		------ On-Hire Start -----
		        SELECT B.PLN_YRWK                                                                                            
		               , 'O' COST_TYPE                                                                                     
		               , D.CNTR_QTY ID1_VOL                                                                             		
		               , D.ONF_HIR_COST_AMT ID1_COST                                                                    		
		               , 0 ID2_VOL                                                                                                                                                                     
		               , 0 ID2_COST                                                                                        
		        FROM EQR_EQ_REPO_PLN A                                                                                     
		             , EQR_ONF_HIR_PLN B                                                                                   
		             , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C	
		             , EQR_ONF_HIR_PLN_QTY D                                            
		        WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                                        
		              AND B.ECC_CD = C.ECC_CD                                                                              
		              AND B.REPO_PLN_ID = @[repo_pln_id]                                                                 				
		              AND B.ONF_HIR_DIV_CD = 'O'	           
		              AND D.CNTR_TPSZ_CD IN (${arrtpszcd})
		              AND B.REPO_PLN_ID = D.REPO_PLN_ID
		              AND B.PLN_YRWK    = D.PLN_YRWK
		              AND B.PLN_SEQ     = D.PLN_SEQ 
		              AND B.PLN_YRWK BETWEEN @[tostartprd] AND @[toendprd]
		           #if (${toecccd} != '')             
                  #if (${totype} == 'R')          
                  AND C.RCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'L')          
                  AND C.LCC_CD IN (${arrtoecccd}) 
                  #end                            
                  #if (${totype} == 'E')          
                  AND C.ECC_CD IN (${arrtoecccd}) 
                  #end                            
               #end 	
		#if (${repo_pln_id2} != '')
		       UNION ALL                                                                                                  
		       SELECT B.PLN_YRWK                                                                                            
		              , 'O' COST_TYPE                                                                                     
		              , 0 ID1_VOL                                                                                         
		              , 0 ID1_COST                                                                                        
		              , D.CNTR_QTY ID2_VOL                                                                             		                                                                                    
		              , D.ONF_HIR_COST_AMT ID2_COST                                                                    		
		       FROM EQR_EQ_REPO_PLN A                                                                                     
		            , EQR_ONF_HIR_PLN B                                                                                   
		            , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C	
		            , EQR_ONF_HIR_PLN_QTY D  
		       WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                                        
		             AND B.ECC_CD = C.ECC_CD                                                                              
		             AND B.REPO_PLN_ID = @[repo_pln_id2]                                                                 				
		             AND ONF_HIR_DIV_CD = 'O'	                   
		             AND D.CNTR_TPSZ_CD IN (${arrtpszcd}) 
		             AND B.REPO_PLN_ID = D.REPO_PLN_ID
		             AND B.PLN_YRWK    = D.PLN_YRWK
		             AND B.PLN_SEQ     = D.PLN_SEQ 
		             AND B.PLN_YRWK BETWEEN @[tostartprd] AND @[toendprd]
		       #if (${toecccd} != '')             
                 #if (${totype} == 'R')          
                 AND C.RCC_CD IN (${arrtoecccd}) 
                 #end                            
                 #if (${totype} == 'L')          
                 AND C.LCC_CD IN (${arrtoecccd}) 
                 #end                            
                 #if (${totype} == 'E')          
                 AND C.ECC_CD IN (${arrtoecccd}) 
                 #end                            
               #end 	     
		#end
		----- On-Hire End -----
		       UNION ALL                                                                                                  
		---- Off-Hire Start -----
		       SELECT B.PLN_YRWK                                                                                            
		              , 'F' COST_TYPE                                                                                     
		              , D.CNTR_QTY ID1_VOL                                                                             		
		              , D.ONF_HIR_COST_AMT ID1_COST                                                                    		
		              , 0 ID2_VOL                                                                                                                                                                           
		              , 0 ID2_COST                                                                                        
		       FROM EQR_EQ_REPO_PLN A                                                                                     
		            , EQR_ONF_HIR_PLN B                                                                                   
		            , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C
		            , EQR_ONF_HIR_PLN_QTY D	      
		       WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                                        
		             AND B.ECC_CD = C.ECC_CD                                                                              
		             AND B.REPO_PLN_ID = @[repo_pln_id]                                                                 				
		             AND ONF_HIR_DIV_CD = 'F'	         
		             AND CNTR_TPSZ_CD IN (${arrtpszcd})
		             AND B.REPO_PLN_ID = D.REPO_PLN_ID
		             AND B.PLN_YRWK    = D.PLN_YRWK
		             AND B.PLN_SEQ     = D.PLN_SEQ 
		             AND B.PLN_YRWK BETWEEN @[fmstartprd] AND @[fmendprd] 
		           #if (${fmecccd} != '')             
                 #if (${fmtype} == 'R')          
                 AND C.RCC_CD IN (${arrfmecccd}) 
                 #end                            
                 #if (${fmtype} == 'L')          
                 AND C.LCC_CD IN (${arrfmecccd}) 
                 #end                            
                 #if (${fmtype} == 'E')          
                 AND C.ECC_CD IN (${arrfmecccd}) 
                 #end                            
               #end 
    #if (${repo_pln_id2} != '')                    
           UNION ALL                                                                                                  
		       SELECT B.PLN_YRWK                                                                                            
		              , 'F' COST_TYPE                                                                                     
		              , 0 ID1_VOL                                                                                         
		              , 0 ID1_COST                                                                                        
		              , CNTR_QTY ID2_VOL                                                                             		                                                                                   
		              , ONF_HIR_COST_AMT ID2_COST                                                                    		
		       FROM EQR_EQ_REPO_PLN A                                                                                     
		            , EQR_ONF_HIR_PLN B                                                                                   
		            , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C
		            , EQR_ONF_HIR_PLN_QTY D	   
		       WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                                                        
		             AND B.ECC_CD = C.ECC_CD                                                                              
		             AND B.REPO_PLN_ID = @[repo_pln_id2]                                                                 				
		             AND ONF_HIR_DIV_CD = 'F'
                     AND B.REPO_PLN_ID = D.REPO_PLN_ID
		             AND B.PLN_YRWK    = D.PLN_YRWK
		             AND B.PLN_SEQ     = D.PLN_SEQ 	           
		             AND CNTR_TPSZ_CD IN (${arrtpszcd})  
		             AND B.PLN_YRWK BETWEEN @[fmstartprd] AND @[fmendprd]   
		           #if (${fmecccd} != '')             
                 #if (${fmtype} == 'R')          
                 AND C.RCC_CD IN (${arrfmecccd}) 
                 #end                            
                 #if (${fmtype} == 'L')          
                 AND C.LCC_CD IN (${arrfmecccd}) 
                 #end                            
                 #if (${fmtype} == 'E')          
                 AND C.ECC_CD IN (${arrfmecccd}) 
                 #end                            
               #end 
		#end
		--- Off-Hire End ----
		    )                                                                                                              
		  GROUP BY PLN_YRWK, CUBE(COST_TYPE)                                                                               	
	) A,                                                                                                                   
	(SELECT INTG_CD_VAL_CTNT CD_VAL
	        , INTG_CD_VAL_DP_DESC CD_DESC
	        , INTG_CD_VAL_DP_SEQ SORT_SEQ                             	
	 FROM COM_INTG_CD_DTL                                                                                                  
	 WHERE INTG_CD_ID = 'CD00838'		                                                                                    
	 UNION ALL                                                                                       						
	 SELECT 'Total' CD_VAL
	      , 'Total' CD_DESC
	      , 0 SORT_SEQ                                                                   	
	 FROM DUAL) B                                                                                       					
	WHERE A.COST_TYPE = B.CD_VAL					                                                                         	
	ORDER BY PLN_YRWK, SORT_SEQ			]]></sql>
			<params>
				<param name="repo_pln_id" type="12" value="" out="N"/>
				<param name="fmstartprd" type="12" value="" out="N"/>
				<param name="fmendprd" type="12" value="" out="N"/>
				<param name="tostartprd" type="12" value="" out="N"/>
				<param name="toendprd" type="12" value="" out="N"/>
				<param name="repo_pln_id2" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
