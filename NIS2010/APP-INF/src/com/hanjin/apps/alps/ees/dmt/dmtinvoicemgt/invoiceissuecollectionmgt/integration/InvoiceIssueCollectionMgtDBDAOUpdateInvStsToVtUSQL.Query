<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceIssueCollectionMgtDBDAOUpdateInvStsToVtUSQL">
			<desc><![CDATA[InvoiceIssueCollectionMgtDBDAOUpdateInvStsToVtUSQL]]></desc>
			<sql><![CDATA[
UPDATE  DMT_INV_MN T1
   SET  T1.DMDT_VT_INV_STS_CD = 'C'
       ,T1.VT_INV_USR_ID      = @[upd_usr_id]
       ,T1.VT_INV_UPD_DT      = NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[upd_ofc_cd]), SYSDATE)   
 WHERE  T1.DMDT_INV_NO = @[dmdt_inv_no]
   AND  EXISTS(
			SELECT  1
			  FROM  DMT_INV_MN		A1   
				   ,DMT_INV_DTL   	A2
				   ,DMT_CHG_CALC  	A3
			 WHERE  A1.DMDT_INV_NO         = T1.DMDT_INV_NO
			   AND  A1.CRE_OFC_CD          = T1.CRE_OFC_CD
			   AND  A1.DMDT_INV_NO         = A2.DMDT_INV_NO
			   AND  A1.CRE_OFC_CD          = A2.CRE_OFC_CD
			   AND  A2.SYS_AREA_GRP_ID     = A3.SYS_AREA_GRP_ID
			   AND  A2.CNTR_NO             = A3.CNTR_NO
			   AND  A2.CNTR_CYC_NO		   = A3.CNTR_CYC_NO
			   AND  A2.DMDT_TRF_CD		   = A3.DMDT_TRF_CD
			   AND  A2.DMDT_CHG_LOC_DIV_CD = A3.DMDT_CHG_LOC_DIV_CD
			   AND  A2.CHG_SEQ 			   = A3.CHG_SEQ
			   AND  A3.DMDT_CHG_STS_CD    IN ('C', 'F')  
		)			]]></sql>
			<params>
				<param name="upd_usr_id" type="12" value="1" out="N"/>
				<param name="upd_ofc_cd" type="12" value="1" out="N"/>
				<param name="dmdt_inv_no" type="12" value="1" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
