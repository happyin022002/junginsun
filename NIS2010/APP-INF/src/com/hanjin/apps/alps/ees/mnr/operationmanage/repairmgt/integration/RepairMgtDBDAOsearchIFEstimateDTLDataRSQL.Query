<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RepairMgtDBDAOsearchIFEstimateDTLDataRSQL">
			<desc><![CDATA[searchIFEstimateDTLData
-- COST CODE 추출로직 보강, 2014-07-15, 신용찬]]></desc>
			<sql><![CDATA[
SELECT   MRD.RQST_EQ_NO
       , MRD.RPR_RQST_SEQ
       , MRD.RPR_RQST_VER_NO
       , MRD.RPR_RQST_DTL_SEQ
       , MRD.RPR_RQST_LST_VER_FLG
       , MRD.EQ_LOC_CD
       , MRD.EQ_LOC_CD_CHK_FLG
       , MRD.EQ_CMPO_CD
       , MRD.EQ_CMPO_CD_CHK_FLG
       , MRD.EQ_DMG_CD
       , MRD.EQ_DMG_CD_CHK_FLG
       , MRD.EQ_RPR_CD
       , MRD.EQ_RPR_CD_CHK_FLG
       , MRD.TRF_DIV_CD
       , MRD.TRF_OPT_CD
       , MRD.VOL_TP_CD
       , MRD.RPR_QTY
       , MRD.RPR_SZ_NO
       , MRD.RPR_LEN_NO
       , MRD.RPR_WDT_NO
       , MRD.RPR_LBR_HRS
       , MRD.RPR_LBR_RT
       , MRD.RPR_LBR_BZC_HRS
       , MRD.RPR_LBR_BZC_RT
       , MRD.MNR_LBR_BZC_AMT
       , MRD.LBR_MTRL_BZC_AMT
       , MRD.LBR_COST_AMT
       , MRD.MTRL_COST_AMT
       , MRD.XCH_MTRL_COST_AMT
       , MRD.MTRL_RECO_AMT
       , MRD.MNR_LR_ACCT_FLG
       , MRD.N3PTY_FLG
       , MRD.N3PTY_BIL_LBR_HRS
       , MRD.N3PTY_BIL_LBR_RT
       , MRD.N3PTY_BIL_LBR_COST_AMT
       , MRD.N3PTY_BIL_MTRL_COST_AMT
       , MRD.MNR_AGMT_AMT
       , MRD.MNR_WRK_AMT
       , MNR_COMMON_PKG.MNR_CAL_CURR_RATE_FNC (TO_CHAR(SYSDATE, 'YYYYMM'), MRH.CURR_CD, 'USD', MRD.MNR_WRK_AMT) AS MNR_WRK_USD_AMT
       , MRD.N3PTY_BIL_AMT
       , MRD.RPR_DTL_RMK
       , MRD.MNR_VRFY_TP_CD
       , MRD.CRE_USR_ID
       , TO_CHAR(MRD.CRE_DT, 'yyyy-mm-dd') CRE_DT
       , MRD.UPD_USR_ID
       , TO_CHAR(MRD.UPD_DT, 'yyyy-mm-dd') UPD_DT
       , CASE WHEN MRH.EQ_KND_CD = 'G' THEN 'MRGSRC'
              WHEN MRH.EQ_KND_CD = 'Z' THEN 'MRZSRC'
              WHEN MRH.EQ_KND_CD = 'U' THEN (
                                              SELECT   DECODE(SUBSTR(MRH.EQ_TPSZ_CD , 1, 1) ,'D', 'MRDRRC'         
                                                                                            ,'R',  DECODE(MECD_2.EQ_PRNT_CMPO_CD, 'K6', 'MRRURC', 'MRRFRC')
                                                                                                  ,'MRDSRC') AS COST_CD
                                              FROM     MNR_EQ_CMPO_CD MECD_1
                                                     , MNR_EQ_CMPO_CD MECD_2
                                              WHERE    1 = 1
                                              AND      MECD_1.EQ_CMPO_GRP_TP_CD = 3
                                              AND      MECD_1.EQ_PRNT_CMPO_GRP_TP_CD = MECD_2.EQ_CMPO_GRP_TP_CD
                                              AND      MECD_1.EQ_PRNT_CMPO_CD = MECD_2.EQ_CMPO_CD
                                              AND      MECD_1.EQ_CMPO_CD = MRD.EQ_CMPO_CD
                                              AND      SUBSTR(MECD_1.EQ_PRNT_CMPO_CD,1,2) IN ('K1','K4','K5','K6','K7') -- Container Cost Code 만 조회하도록 수정, 2014-07-15, 신용찬
                                              AND      ROWNUM = 1                                     
                                            )
         END COST_CD 
       , 'NR' AS COST_DTL_CD
FROM     MNR_RPR_RQST_DTL MRD
       , MNR_RPR_RQST_HDR MRH
WHERE    1 = 1
AND      MRH.RQST_EQ_NO = MRD.RQST_EQ_NO
AND      MRH.RPR_RQST_SEQ = MRD.RPR_RQST_SEQ
AND      MRH.RPR_RQST_VER_NO = MRD.RPR_RQST_VER_NO
AND      MRD.RQST_EQ_NO      = @[rqst_eq_no]
AND      MRD.RPR_RQST_SEQ    = @[rpr_rqst_seq]
AND      MRD.RPR_RQST_VER_NO = @[rpr_rqst_ver_no]			]]></sql>
			<params>
				<param name="rqst_eq_no" type="12" value="" out="N"/>
				<param name="rpr_rqst_seq" type="12" value="" out="N"/>
				<param name="rpr_rqst_ver_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
