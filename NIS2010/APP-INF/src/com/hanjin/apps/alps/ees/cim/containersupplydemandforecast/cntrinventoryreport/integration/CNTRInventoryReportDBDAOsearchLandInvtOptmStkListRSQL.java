/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : CNTRInventoryReportDBDAOsearchLandInvtOptmStkListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.02.17
*@LastModifier : 
*@LastVersion : 1.0
* 2016.02.17 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.ees.cim.containersupplydemandforecast.cntrinventoryreport.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class CNTRInventoryReportDBDAOsearchLandInvtOptmStkListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * 2016-01-21
	  * Equipment Management > CNTR Inventory > Inventory Status > Land Inventory > Land Inventory with Optimum Stock 조회
	  * </pre>
	  */
	public CNTRInventoryReportDBDAOsearchLandInvtOptmStkListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("loc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("dmg_flg",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.ees.cim.containersupplydemandforecast.cntrinventoryreport.integration").append("\n"); 
		query.append("FileName : CNTRInventoryReportDBDAOsearchLandInvtOptmStkListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("WITH TMP_EQ_ORZ_CHT AS" ).append("\n"); 
		query.append("(SELECT " ).append("\n"); 
		query.append("   RCC_CD, LCC_CD, ECC_CD " ).append("\n"); 
		query.append("   FROM MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3' || ${loc_type_code} == '8')" ).append("\n"); 
		query.append("   WHERE RCC_CD = @[loc_cd]" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '4')" ).append("\n"); 
		query.append("   WHERE LCC_CD = @[loc_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  GROUP BY  RCC_CD, LCC_CD, ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", CRT_MT AS" ).append("\n"); 
		query.append("(SELECT " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("       LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("       ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	   RCC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("       ,1 SEL_NO" ).append("\n"); 
		query.append("       ,'Inventory (MT)' SEL_NM" ).append("\n"); 
		query.append("#if (${tp_cd} == '1')" ).append("\n"); 
		query.append("       ,TO_NUMBER((NVL(QTY1, 0) +NVL(QTY2, 0) +NVL(QTY3, 0) +NVL(QTY4, 0) +NVL(QTY5, 0) +NVL(QTY6, 0) +NVL(QTY7, 0) +NVL(O2, 0) +NVL(S2, 0) +NVL(O4, 0) +NVL(O5, 0) +NVL(S4, 0) +NVL(F2, 0) +NVL(F4, 0) +NVL(F5, 0) +NVL(A4, 0))) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '2')" ).append("\n"); 
		query.append("       ,TO_NUMBER((NVL(QTY1, 0) +NVL(QTY2, 0) +NVL(QTY3, 0) +NVL(QTY4, 0))) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '3')" ).append("\n"); 
		query.append("       ,TO_NUMBER((NVL(QTY5, 0) +NVL(QTY6, 0) +NVL(QTY7, 0))) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '4')" ).append("\n"); 
		query.append("       ,TO_NUMBER((NVL(O2, 0) +NVL(S2, 0) +NVL(O4, 0) +NVL(O5, 0) +NVL(S4, 0) +NVL(F2, 0) +NVL(F4, 0) +NVL(F5, 0) +NVL(A4, 0))) TOTAL_CNT" ).append("\n"); 
		query.append("#end       " ).append("\n"); 
		query.append("       ,TO_NUMBER(QTY1) QTY1" ).append("\n"); 
		query.append("       ,TO_NUMBER(QTY2) QTY2" ).append("\n"); 
		query.append("       ,TO_NUMBER(QTY3) QTY3" ).append("\n"); 
		query.append("       ,TO_NUMBER(QTY4) QTY4" ).append("\n"); 
		query.append("       ,TO_NUMBER(QTY5) QTY5" ).append("\n"); 
		query.append("       ,TO_NUMBER(QTY6) QTY6" ).append("\n"); 
		query.append("       ,TO_NUMBER(QTY7) QTY7" ).append("\n"); 
		query.append("       ,TO_NUMBER(O2 + S2) QTY8" ).append("\n"); 
		query.append("       ,TO_NUMBER(O4 + O5 + S4) QTY9" ).append("\n"); 
		query.append("       ,TO_NUMBER(F2) QTY10" ).append("\n"); 
		query.append("       ,TO_NUMBER(F4 + F5 + A4) QTY11" ).append("\n"); 
		query.append("  FROM  (SELECT  " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                 LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                 ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	             RCC_CD " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'D2' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'D2' , VOL, 0))) QTY1 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'D4' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'D4' , VOL, 0))) QTY2 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'D5' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'D5' , VOL, 0))) QTY3 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'D7' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'D7' , VOL, 0))) QTY4 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'R2' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'R2' , VOL, 0))) QTY5 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'R5' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'R5' , VOL, 0))) QTY6 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'R9' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'R9' , VOL, 0))) QTY7 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'O2' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'O2' , VOL, 0))) O2 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'S2' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'S2' , VOL, 0))) S2 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'O4' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'O4' , VOL, 0))) O4 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'O5' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'O5' , VOL, 0))) O5 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'S4' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'S4' , VOL, 0))) S4 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'F2' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'F2' , VOL, 0))) F2 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'F4' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'F4' , VOL, 0))) F4 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'F5' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'F5' , VOL, 0))) F5 " ).append("\n"); 
		query.append("                ,DECODE(INSTR(null, 'A4' ), 0, NULL, SUM(DECODE(CNTR_TPSZ_CD, 'A4' , VOL, 0))) A4 " ).append("\n"); 
		query.append("          FROM (SELECT  " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                        LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                        ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	                    RCC_CD " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                       ,CNMV_STS_CD" ).append("\n"); 
		query.append("                       ,CNTR_TPSZ_CD" ).append("\n"); 
		query.append("                       ,COUNT(1) VOL" ).append("\n"); 
		query.append("                  FROM MST_CONTAINER" ).append("\n"); 
		query.append("                 WHERE ACIAC_DIV_CD='A'" ).append("\n"); 
		query.append("                   AND CNMV_STS_CD = 'MT'" ).append("\n"); 
		query.append("                   AND CNTR_USE_CO_CD = 'H'" ).append("\n"); 
		query.append("#if (${dmg_flg} != '')" ).append("\n"); 
		query.append("	    	       AND DMG_FLG = @[dmg_flg]" ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3' || ${loc_type_code} == '8')" ).append("\n"); 
		query.append("                   AND RCC_CD = @[loc_cd]" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '4')" ).append("\n"); 
		query.append("                   AND LCC_CD = @[loc_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                   AND LSTM_CD <> 'SH'" ).append("\n"); 
		query.append("                 GROUP BY " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                          LCC_CD," ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                          ECC_CD," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	                      RCC_CD, " ).append("\n"); 
		query.append("#end                          " ).append("\n"); 
		query.append("                          CNMV_STS_CD ," ).append("\n"); 
		query.append("                          CNTR_TPSZ_CD) " ).append("\n"); 
		query.append("          GROUP BY " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("            LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("            ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	        RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append(" ORDER BY " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", OPT_ST_T AS" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT  B.RCC_CD" ).append("\n"); 
		query.append("        ,B.LCC_CD" ).append("\n"); 
		query.append("        ,A.ECC_CD" ).append("\n"); 
		query.append("        ,A.DMG_FLG" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'D2',A.CNTR_QTY) D2" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'D4',A.CNTR_QTY) D4" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'D5',A.CNTR_QTY) D5" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'D7',A.CNTR_QTY) D7" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'R2',A.CNTR_QTY) R2" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'R5',A.CNTR_QTY) R5" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'R9',A.CNTR_QTY) R9" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'O2',A.CNTR_QTY) O2" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'S2',A.CNTR_QTY) S2" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'O4',A.CNTR_QTY) O4" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'O5',A.CNTR_QTY) O5" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'S4',A.CNTR_QTY) S4" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'F2',A.CNTR_QTY) F2" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'F4',A.CNTR_QTY) F4" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'F5',A.CNTR_QTY) F5" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'A4',A.CNTR_QTY) A4" ).append("\n"); 
		query.append("  FROM CIM_OPTM_STK_SMRY A," ).append("\n"); 
		query.append("       TMP_EQ_ORZ_CHT B" ).append("\n"); 
		query.append(" WHERE OPTM_STK_MNG_TP_CD = 'M'" ).append("\n"); 
		query.append("   AND A.ECC_CD = B.ECC_CD" ).append("\n"); 
		query.append("   AND TGT_YRWK = (SELECT MAX(TGT_YRWK) " ).append("\n"); 
		query.append("                    FROM CIM_OPTM_STK_SMRY" ).append("\n"); 
		query.append("                   WHERE OPTM_STK_MNG_TP_CD = 'M')" ).append("\n"); 
		query.append("#if (${dmg_flg} == '')" ).append("\n"); 
		query.append("   AND DMG_FLG = 'A'" ).append("\n"); 
		query.append("#end  " ).append("\n"); 
		query.append("#if (${dmg_flg} != '')" ).append("\n"); 
		query.append("   AND DMG_FLG = @[dmg_flg]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", OPT_ST_F AS" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT  B.RCC_CD" ).append("\n"); 
		query.append("        ,B.LCC_CD" ).append("\n"); 
		query.append("        ,A.ECC_CD" ).append("\n"); 
		query.append("        ,A.DMG_FLG" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'D2',A.CNTR_QTY) D2" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'D4',A.CNTR_QTY) D4" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'D5',A.CNTR_QTY) D5" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'D7',A.CNTR_QTY) D7" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'R2',A.CNTR_QTY) R2" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'R5',A.CNTR_QTY) R5" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'R9',A.CNTR_QTY) R9" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'O2',A.CNTR_QTY) O2" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'S2',A.CNTR_QTY) S2" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'O4',A.CNTR_QTY) O4" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'O5',A.CNTR_QTY) O5" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'S4',A.CNTR_QTY) S4" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'F2',A.CNTR_QTY) F2" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'F4',A.CNTR_QTY) F4" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'F5',A.CNTR_QTY) F5" ).append("\n"); 
		query.append("        ,DECODE(A.CNTR_TPSZ_CD,'A4',A.CNTR_QTY) A4" ).append("\n"); 
		query.append("  FROM CIM_OPTM_STK_SMRY A," ).append("\n"); 
		query.append("       TMP_EQ_ORZ_CHT B" ).append("\n"); 
		query.append(" WHERE OPTM_STK_MNG_TP_CD = 'F'" ).append("\n"); 
		query.append("   AND A.ECC_CD = B.ECC_CD" ).append("\n"); 
		query.append("   AND TGT_YRWK = (SELECT MAX(TGT_YRWK) " ).append("\n"); 
		query.append("                    FROM CIM_OPTM_STK_SMRY" ).append("\n"); 
		query.append("                   WHERE OPTM_STK_MNG_TP_CD = 'F')" ).append("\n"); 
		query.append("#if (${dmg_flg} == '')" ).append("\n"); 
		query.append("   AND DMG_FLG = 'A'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dmg_flg} != '')" ).append("\n"); 
		query.append("   AND DMG_FLG = @[dmg_flg]" ).append("\n"); 
		query.append("#end    " ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", OPT_ST AS" ).append("\n"); 
		query.append("(SELECT" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("       LCC_CD LOC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("       ECC_CD LOC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	   RCC_CD LOC_CD " ).append("\n"); 
		query.append("#end  " ).append("\n"); 
		query.append("      ,SEL_NO" ).append("\n"); 
		query.append("      ,SEL_NM DIVISION" ).append("\n"); 
		query.append("      ,TOTAL_CNT" ).append("\n"); 
		query.append("      ,QTY1" ).append("\n"); 
		query.append("      ,QTY2" ).append("\n"); 
		query.append("      ,QTY3" ).append("\n"); 
		query.append("      ,QTY4" ).append("\n"); 
		query.append("      ,QTY5" ).append("\n"); 
		query.append("      ,QTY6" ).append("\n"); 
		query.append("      ,QTY7" ).append("\n"); 
		query.append("      ,QTY8" ).append("\n"); 
		query.append("      ,QTY9" ).append("\n"); 
		query.append("      ,QTY10" ).append("\n"); 
		query.append("      ,QTY11" ).append("\n"); 
		query.append(" FROM (" ).append("\n"); 
		query.append("       SELECT " ).append("\n"); 
		query.append("           *" ).append("\n"); 
		query.append("       FROM CRT_MT" ).append("\n"); 
		query.append("       UNION ALL" ).append("\n"); 
		query.append("       SELECT" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("              LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("              ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	          RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("             ,2 SEL_NO" ).append("\n"); 
		query.append("             ,'Optimum Stock (t-Dist)' SEL_NM" ).append("\n"); 
		query.append("#if (${tp_cd} == '1')" ).append("\n"); 
		query.append("             ,TO_NUMBER((NVL(D2, 0) +NVL(D4, 0) +NVL(D5, 0) +NVL(D7, 0) +NVL(R2, 0) +NVL(R5, 0) +NVL(R9, 0) +NVL(O2, 0) +NVL(O4, 0) +NVL(F2, 0) +NVL(F4, 0))) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '2')" ).append("\n"); 
		query.append("             ,TO_NUMBER((NVL(D2, 0) +NVL(D4, 0) +NVL(D5, 0) +NVL(D7, 0))) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '3')" ).append("\n"); 
		query.append("             ,TO_NUMBER((NVL(R2, 0) +NVL(R5, 0) +NVL(R9, 0))) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '4')" ).append("\n"); 
		query.append("             ,TO_NUMBER((NVL(O2, 0) +NVL(O4, 0) +NVL(F2, 0) +NVL(F4, 0))) TOTAL_CNT" ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("             ,TO_NUMBER(D2) QTY1" ).append("\n"); 
		query.append("             ,TO_NUMBER(D4) QTY2" ).append("\n"); 
		query.append("             ,TO_NUMBER(D5) QTY3" ).append("\n"); 
		query.append("             ,TO_NUMBER(D7) QTY4" ).append("\n"); 
		query.append("             ,TO_NUMBER(R2) QTY5" ).append("\n"); 
		query.append("             ,TO_NUMBER(R5) QTY6" ).append("\n"); 
		query.append("             ,TO_NUMBER(R9) QTY7" ).append("\n"); 
		query.append("             ,TO_NUMBER(O2) QTY8" ).append("\n"); 
		query.append("             ,TO_NUMBER(O4) QTY9" ).append("\n"); 
		query.append("             ,TO_NUMBER(F2) QTY10" ).append("\n"); 
		query.append("             ,TO_NUMBER(F4) QTY11" ).append("\n"); 
		query.append("       FROM  " ).append("\n"); 
		query.append("             (SELECT " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                     LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                     ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	                 RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("                    ,SUM(NVL(D2, 0)) D2" ).append("\n"); 
		query.append("                    ,SUM(NVL(D4, 0)) D4" ).append("\n"); 
		query.append("                    ,SUM(NVL(D5, 0)) D5" ).append("\n"); 
		query.append("                    ,SUM(NVL(D7, 0)) D7" ).append("\n"); 
		query.append("                    ,SUM(NVL(R2, 0)) R2" ).append("\n"); 
		query.append("                    ,SUM(NVL(R5, 0)) R5" ).append("\n"); 
		query.append("                    ,SUM(NVL(R9, 0)) R9" ).append("\n"); 
		query.append("                    ,SUM(NVL(O2, 0)) + SUM(NVL(S2, 0)) O2" ).append("\n"); 
		query.append("                    ,SUM(NVL(O4, 0)) + SUM(NVL(O5, 0)) + SUM(NVL(S4, 0)) O4" ).append("\n"); 
		query.append("                    ,SUM(NVL(F2, 0)) F2" ).append("\n"); 
		query.append("                    ,SUM(NVL(F4, 0)) + SUM(NVL(F5, 0)) + SUM(NVL(A4, 0)) F4" ).append("\n"); 
		query.append("               FROM  OPT_ST_T" ).append("\n"); 
		query.append("               GROUP BY " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                  LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                  ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	              RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("               )" ).append("\n"); 
		query.append("       UNION ALL        " ).append("\n"); 
		query.append("       SELECT" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("              LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("              ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	          RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("             ,3 SEL_NO" ).append("\n"); 
		query.append("             ,'Optimum Stock (Final)' SEL_NM" ).append("\n"); 
		query.append("#if (${tp_cd} == '1')" ).append("\n"); 
		query.append("             ,TO_NUMBER((NVL(D2, 0) +NVL(D4, 0) +NVL(D5, 0) +NVL(D7, 0) +NVL(R2, 0) +NVL(R5, 0) +NVL(R9, 0) +NVL(O2, 0) +NVL(O4, 0) +NVL(F2, 0) +NVL(F4, 0))) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '2')" ).append("\n"); 
		query.append("             ,TO_NUMBER((NVL(D2, 0) +NVL(D4, 0) +NVL(D5, 0) +NVL(D7, 0))) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '3')" ).append("\n"); 
		query.append("             ,TO_NUMBER((NVL(R2, 0) +NVL(R5, 0) +NVL(R9, 0))) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '4')" ).append("\n"); 
		query.append("             ,TO_NUMBER((NVL(O2, 0) +NVL(O4, 0) +NVL(F2, 0) +NVL(F4, 0))) TOTAL_CNT" ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("             ,TO_NUMBER(D2) QTY1" ).append("\n"); 
		query.append("             ,TO_NUMBER(D4) QTY2" ).append("\n"); 
		query.append("             ,TO_NUMBER(D5) QTY3" ).append("\n"); 
		query.append("             ,TO_NUMBER(D7) QTY4" ).append("\n"); 
		query.append("             ,TO_NUMBER(R2) QTY5" ).append("\n"); 
		query.append("             ,TO_NUMBER(R5) QTY6" ).append("\n"); 
		query.append("             ,TO_NUMBER(R9) QTY7" ).append("\n"); 
		query.append("             ,TO_NUMBER(O2) QTY8" ).append("\n"); 
		query.append("             ,TO_NUMBER(O4) QTY9" ).append("\n"); 
		query.append("             ,TO_NUMBER(F2) QTY10" ).append("\n"); 
		query.append("             ,TO_NUMBER(F4) QTY11" ).append("\n"); 
		query.append("       FROM  " ).append("\n"); 
		query.append("             (SELECT " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                     LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                     ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	                 RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("                    ,SUM(NVL(D2, 0)) D2" ).append("\n"); 
		query.append("                    ,SUM(NVL(D4, 0)) D4" ).append("\n"); 
		query.append("                    ,SUM(NVL(D5, 0)) D5" ).append("\n"); 
		query.append("                    ,SUM(NVL(D7, 0)) D7" ).append("\n"); 
		query.append("                    ,SUM(NVL(R2, 0)) R2" ).append("\n"); 
		query.append("                    ,SUM(NVL(R5, 0)) R5" ).append("\n"); 
		query.append("                    ,SUM(NVL(R9, 0)) R9" ).append("\n"); 
		query.append("                    ,SUM(NVL(O2, 0)) + SUM(NVL(S2, 0)) O2" ).append("\n"); 
		query.append("                    ,SUM(NVL(O4, 0)) + SUM(NVL(O5, 0)) + SUM(NVL(S4, 0)) O4" ).append("\n"); 
		query.append("                    ,SUM(NVL(F2, 0)) F2" ).append("\n"); 
		query.append("                    ,SUM(NVL(F4, 0)) + SUM(NVL(F5, 0)) + SUM(NVL(A4, 0)) F4" ).append("\n"); 
		query.append("               FROM  OPT_ST_F" ).append("\n"); 
		query.append("               GROUP BY " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                  LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                  ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	              RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("               )" ).append("\n"); 
		query.append("       UNION ALL        " ).append("\n"); 
		query.append("       SELECT" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("              A.LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("              A.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	          A.RCC_CD" ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("             ,4 SEL_NO" ).append("\n"); 
		query.append("             ,'Diff. (Invt vs Optimum Final)' SEL_NM" ).append("\n"); 
		query.append("#if (${tp_cd} == '1')" ).append("\n"); 
		query.append("             ,TO_NUMBER(((NVL(A.QTY1, 0) -NVL(B.QTY1, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY2, 0) -NVL(B.QTY2, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY3, 0) -NVL(B.QTY3, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY4, 0) -NVL(B.QTY4, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY5, 0) -NVL(B.QTY5, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY6, 0) -NVL(B.QTY6, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY7, 0) -NVL(B.QTY7, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY8, 0) -NVL(B.QTY8, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY9, 0) -NVL(B.QTY9, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY10, 0) -NVL(B.QTY10, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY11, 0) -NVL(B.QTY11, 0)))) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '2')" ).append("\n"); 
		query.append("             ,TO_NUMBER(((NVL(A.QTY1, 0) -NVL(B.QTY1, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY2, 0) -NVL(B.QTY2, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY3, 0) -NVL(B.QTY3, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY4, 0) -NVL(B.QTY4, 0)))) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '3')" ).append("\n"); 
		query.append("             ,TO_NUMBER(((NVL(A.QTY5, 0) -NVL(B.QTY5, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY6, 0) -NVL(B.QTY6, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY7, 0) -NVL(B.QTY7, 0)))) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '4')" ).append("\n"); 
		query.append("             ,TO_NUMBER(((NVL(A.QTY8, 0) -NVL(B.QTY8, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY9, 0) -NVL(B.QTY9, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY10, 0) -NVL(B.QTY10, 0))" ).append("\n"); 
		query.append("              +(NVL(A.QTY11, 0) -NVL(B.QTY11, 0)))) TOTAL_CNT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("             ,TO_NUMBER(A.QTY1 - B.QTY1) QTY1" ).append("\n"); 
		query.append("             ,TO_NUMBER(A.QTY2 - B.QTY2) QTY2" ).append("\n"); 
		query.append("             ,TO_NUMBER(A.QTY3 - B.QTY3) QTY3" ).append("\n"); 
		query.append("             ,TO_NUMBER(A.QTY4 - B.QTY4) QTY4" ).append("\n"); 
		query.append("             ,TO_NUMBER(A.QTY5 - B.QTY5) QTY5" ).append("\n"); 
		query.append("             ,TO_NUMBER(A.QTY6 - B.QTY6) QTY6" ).append("\n"); 
		query.append("             ,TO_NUMBER(A.QTY7 - B.QTY7) QTY7" ).append("\n"); 
		query.append("             ,TO_NUMBER(A.QTY8 - B.QTY8) QTY8" ).append("\n"); 
		query.append("             ,TO_NUMBER(A.QTY9 - B.QTY9) QTY9" ).append("\n"); 
		query.append("             ,TO_NUMBER(A.QTY10 - B.QTY10) QTY10" ).append("\n"); 
		query.append("             ,TO_NUMBER(A.QTY11 - B.QTY11) QTY11" ).append("\n"); 
		query.append("       FROM  CRT_MT A," ).append("\n"); 
		query.append("             (SELECT " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                     LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                     ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	                 RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("                    ,SUM(NVL(D2, 0)) QTY1" ).append("\n"); 
		query.append("                    ,SUM(NVL(D4, 0)) QTY2" ).append("\n"); 
		query.append("                    ,SUM(NVL(D5, 0)) QTY3" ).append("\n"); 
		query.append("                    ,SUM(NVL(D7, 0)) QTY4" ).append("\n"); 
		query.append("                    ,SUM(NVL(R2, 0)) QTY5" ).append("\n"); 
		query.append("                    ,SUM(NVL(R5, 0)) QTY6" ).append("\n"); 
		query.append("                    ,SUM(NVL(R9, 0)) QTY7" ).append("\n"); 
		query.append("                    ,SUM(NVL(O2, 0)) + SUM(NVL(S2, 0)) QTY8" ).append("\n"); 
		query.append("                    ,SUM(NVL(O4, 0)) + SUM(NVL(O5, 0)) + SUM(NVL(S4, 0)) QTY9" ).append("\n"); 
		query.append("                    ,SUM(NVL(F2, 0)) QTY10" ).append("\n"); 
		query.append("                    ,SUM(NVL(F4, 0)) + SUM(NVL(F5, 0)) + SUM(NVL(A4, 0)) QTY11" ).append("\n"); 
		query.append("               FROM OPT_ST_F" ).append("\n"); 
		query.append("               GROUP BY " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                  LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                  ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	              RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("             ) B" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("       WHERE A.LCC_CD = B.LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("       WHERE A.ECC_CD = B.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	   WHERE A.RCC_CD = B.RCC_CD" ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("       UNION ALL        " ).append("\n"); 
		query.append("       SELECT" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("              A.LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("              A.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	          A.RCC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("             ,5 SEL_NO" ).append("\n"); 
		query.append("             ,'Ratio (Invt/Optimum Final)' SEL_NM" ).append("\n"); 
		query.append("#if (${tp_cd} == '1')" ).append("\n"); 
		query.append("             ,ROUND((NVL(A.QTY1, 0)+NVL(A.QTY2, 0)+NVL(A.QTY3, 0)+NVL(A.QTY4, 0)+NVL(A.QTY5, 0)+NVL(A.QTY6, 0)+NVL(A.QTY7, 0)+NVL(A.QTY8, 0)+NVL(A.QTY9, 0)+NVL(A.QTY10, 0)+NVL(A.QTY11, 0))/" ).append("\n"); 
		query.append("              (NULLIF((NVL(B.QTY1, 0)+NVL(B.QTY2, 0)+NVL(B.QTY3, 0)+NVL(B.QTY4, 0)+NVL(B.QTY5, 0)+NVL(B.QTY6, 0)+NVL(B.QTY7, 0)+NVL(B.QTY8, 0)+NVL(B.QTY9, 0)+NVL(B.QTY10, 0)+NVL(B.QTY11, 0)), 0)),1) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '2')" ).append("\n"); 
		query.append("             ,ROUND((NVL(A.QTY1, 0)+NVL(A.QTY2, 0)+NVL(A.QTY3, 0)+NVL(A.QTY4, 0))/" ).append("\n"); 
		query.append("              (NULLIF((NVL(B.QTY1, 0)+NVL(B.QTY2, 0)+NVL(B.QTY3, 0)+NVL(B.QTY4, 0)), 0)),1) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '3')" ).append("\n"); 
		query.append("             ,ROUND((NVL(A.QTY5, 0)+NVL(A.QTY6, 0)+NVL(A.QTY7, 0))/" ).append("\n"); 
		query.append("              (NULLIF((NVL(B.QTY5, 0)+NVL(B.QTY6, 0)+NVL(B.QTY7, 0)), 0)),1) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '4')" ).append("\n"); 
		query.append("             ,ROUND((NVL(A.QTY8, 0)+NVL(A.QTY9, 0)+NVL(A.QTY10, 0)+NVL(A.QTY11, 0))/" ).append("\n"); 
		query.append("              (NULLIF((NVL(B.QTY8, 0)+NVL(B.QTY9, 0)+NVL(B.QTY10, 0)+NVL(B.QTY11, 0)), 0)),1) TOTAL_CNT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY1 / NULLIF(B.QTY1, 0),1)), 0) QTY1" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY2 / NULLIF(B.QTY2, 0),1)), 0) QTY2" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY3 / NULLIF(B.QTY3, 0),1)), 0) QTY3" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY4 / NULLIF(B.QTY4, 0),1)), 0) QTY4" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY5 / NULLIF(B.QTY5, 0),1)), 0) QTY5" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY6 / NULLIF(B.QTY6, 0),1)), 0) QTY6" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY7 / NULLIF(B.QTY7, 0),1)), 0) QTY7" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY8 / NULLIF(B.QTY8, 0),1)), 0) QTY8" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY9 / NULLIF(B.QTY9, 0),1)), 0) QTY9" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY10 / NULLIF(B.QTY10, 0),1)), 0) QTY10" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY11 / NULLIF(B.QTY11, 0),1)), 0) QTY11" ).append("\n"); 
		query.append("       FROM  CRT_MT A," ).append("\n"); 
		query.append("             (SELECT " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                     LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                     ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	                 RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("                    ,SUM(NVL(D2, 0)) QTY1" ).append("\n"); 
		query.append("                    ,SUM(NVL(D4, 0)) QTY2" ).append("\n"); 
		query.append("                    ,SUM(NVL(D5, 0)) QTY3" ).append("\n"); 
		query.append("                    ,SUM(NVL(D7, 0)) QTY4" ).append("\n"); 
		query.append("                    ,SUM(NVL(R2, 0)) QTY5" ).append("\n"); 
		query.append("                    ,SUM(NVL(R5, 0)) QTY6" ).append("\n"); 
		query.append("                    ,SUM(NVL(R9, 0)) QTY7" ).append("\n"); 
		query.append("                    ,SUM(NVL(O2, 0)) + SUM(NVL(S2, 0)) QTY8" ).append("\n"); 
		query.append("                    ,SUM(NVL(O4, 0)) + SUM(NVL(O5, 0)) + SUM(NVL(S4, 0)) QTY9" ).append("\n"); 
		query.append("                    ,SUM(NVL(F2, 0)) QTY10" ).append("\n"); 
		query.append("                    ,SUM(NVL(F4, 0)) + SUM(NVL(F5, 0)) + SUM(NVL(A4, 0)) QTY11" ).append("\n"); 
		query.append("               FROM OPT_ST_F" ).append("\n"); 
		query.append("               GROUP BY" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                  LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                  ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	              RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("             ) B" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("       WHERE A.LCC_CD = B.LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("       WHERE A.ECC_CD = B.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	   WHERE A.RCC_CD = B.RCC_CD" ).append("\n"); 
		query.append("#end        " ).append("\n"); 
		query.append("       UNION ALL        " ).append("\n"); 
		query.append("       SELECT" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("              A.LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("              A.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	          A.RCC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("             ,6 SEL_NO" ).append("\n"); 
		query.append("             ,'Signal' SEL_NM" ).append("\n"); 
		query.append("#if (${tp_cd} == '1')" ).append("\n"); 
		query.append("             ,ROUND((NVL(A.QTY1, 0)+NVL(A.QTY2, 0)+NVL(A.QTY3, 0)+NVL(A.QTY4, 0)+NVL(A.QTY5, 0)+NVL(A.QTY6, 0)+NVL(A.QTY7, 0)+NVL(A.QTY8, 0)+NVL(A.QTY9, 0)+NVL(A.QTY10, 0)+NVL(A.QTY11, 0))/" ).append("\n"); 
		query.append("              (NULLIF((NVL(B.QTY1, 0)+NVL(B.QTY2, 0)+NVL(B.QTY3, 0)+NVL(B.QTY4, 0)+NVL(B.QTY5, 0)+NVL(B.QTY6, 0)+NVL(B.QTY7, 0)+NVL(B.QTY8, 0)+NVL(B.QTY9, 0)+NVL(B.QTY10, 0)+NVL(B.QTY11, 0)), 0)),1) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '2')" ).append("\n"); 
		query.append("             ,ROUND((NVL(A.QTY1, 0)+NVL(A.QTY2, 0)+NVL(A.QTY3, 0)+NVL(A.QTY4, 0))/" ).append("\n"); 
		query.append("              (NULLIF((NVL(B.QTY1, 0)+NVL(B.QTY2, 0)+NVL(B.QTY3, 0)+NVL(B.QTY4, 0)), 0)),1) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '3')" ).append("\n"); 
		query.append("             ,ROUND((NVL(A.QTY5, 0)+NVL(A.QTY6, 0)+NVL(A.QTY7, 0))/" ).append("\n"); 
		query.append("              (NULLIF((NVL(B.QTY5, 0)+NVL(B.QTY6, 0)+NVL(B.QTY7, 0)), 0)),1) TOTAL_CNT" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '4')" ).append("\n"); 
		query.append("             ,ROUND((NVL(A.QTY8, 0)+NVL(A.QTY9, 0)+NVL(A.QTY10, 0)+NVL(A.QTY11, 0))/" ).append("\n"); 
		query.append("              (NULLIF((NVL(B.QTY8, 0)+NVL(B.QTY9, 0)+NVL(B.QTY10, 0)+NVL(B.QTY11, 0)), 0)),1) TOTAL_CNT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY1 / NULLIF(B.QTY1, 0),1)), 0) QTY1" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY2 / NULLIF(B.QTY2, 0),1)), 0) QTY2" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY3 / NULLIF(B.QTY3, 0),1)), 0) QTY3" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY4 / NULLIF(B.QTY4, 0),1)), 0) QTY4" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY5 / NULLIF(B.QTY5, 0),1)), 0) QTY5" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY6 / NULLIF(B.QTY6, 0),1)), 0) QTY6" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY7 / NULLIF(B.QTY7, 0),1)), 0) QTY7" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY8 / NULLIF(B.QTY8, 0),1)), 0) QTY8" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY9 / NULLIF(B.QTY9, 0),1)), 0) QTY9" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY10 / NULLIF(B.QTY10, 0),1)), 0) QTY10" ).append("\n"); 
		query.append("             ,NVL(TO_NUMBER(ROUND(A.QTY11 / NULLIF(B.QTY11, 0),1)), 0) QTY11" ).append("\n"); 
		query.append("       FROM  CRT_MT A," ).append("\n"); 
		query.append("             (SELECT " ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                     LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                     ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	                 RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("                    ,SUM(NVL(D2, 0)) QTY1" ).append("\n"); 
		query.append("                    ,SUM(NVL(D4, 0)) QTY2" ).append("\n"); 
		query.append("                    ,SUM(NVL(D5, 0)) QTY3" ).append("\n"); 
		query.append("                    ,SUM(NVL(D7, 0)) QTY4" ).append("\n"); 
		query.append("                    ,SUM(NVL(R2, 0)) QTY5" ).append("\n"); 
		query.append("                    ,SUM(NVL(R5, 0)) QTY6" ).append("\n"); 
		query.append("                    ,SUM(NVL(R9, 0)) QTY7" ).append("\n"); 
		query.append("                    ,SUM(NVL(O2, 0)) + SUM(NVL(S2, 0)) QTY8" ).append("\n"); 
		query.append("                    ,SUM(NVL(O4, 0)) + SUM(NVL(O5, 0)) + SUM(NVL(S4, 0)) QTY9" ).append("\n"); 
		query.append("                    ,SUM(NVL(F2, 0)) QTY10" ).append("\n"); 
		query.append("                    ,SUM(NVL(F4, 0)) + SUM(NVL(F5, 0)) + SUM(NVL(A4, 0)) QTY11" ).append("\n"); 
		query.append("               FROM OPT_ST_F" ).append("\n"); 
		query.append("               GROUP BY" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("                  LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("                  ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	              RCC_CD " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("             ) B" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append("       WHERE A.LCC_CD = B.LCC_CD" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append("       WHERE A.ECC_CD = B.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	   WHERE A.RCC_CD = B.RCC_CD" ).append("\n"); 
		query.append("#end             " ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("#if (${loc_type_code} == '3')" ).append("\n"); 
		query.append(" ORDER BY LCC_CD,SEL_NO" ).append("\n"); 
		query.append("#elseif (${loc_type_code} == '8' || ${loc_type_code} == '4')" ).append("\n"); 
		query.append(" ORDER BY ECC_CD,SEL_NO" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(" ORDER BY RCC_CD,SEL_NO" ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append(" )" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("       LOC_CD" ).append("\n"); 
		query.append("      ,SEL_NO" ).append("\n"); 
		query.append("      ,DIVISION" ).append("\n"); 
		query.append("      ,TOTAL_CNT" ).append("\n"); 
		query.append("#if (${tp_cd} == '1')" ).append("\n"); 
		query.append("      ,QTY1" ).append("\n"); 
		query.append("      ,QTY2" ).append("\n"); 
		query.append("      ,QTY3" ).append("\n"); 
		query.append("      ,QTY4" ).append("\n"); 
		query.append("      ,QTY5" ).append("\n"); 
		query.append("      ,QTY6" ).append("\n"); 
		query.append("      ,QTY7" ).append("\n"); 
		query.append("      ,QTY8" ).append("\n"); 
		query.append("      ,QTY9" ).append("\n"); 
		query.append("      ,QTY10" ).append("\n"); 
		query.append("      ,QTY11" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '2')" ).append("\n"); 
		query.append("      ,QTY1 QTY1" ).append("\n"); 
		query.append("      ,QTY2 QTY2" ).append("\n"); 
		query.append("      ,QTY3 QTY3" ).append("\n"); 
		query.append("      ,QTY4 QTY4" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '3')" ).append("\n"); 
		query.append("      ,QTY5 QTY1" ).append("\n"); 
		query.append("      ,QTY6 QTY2" ).append("\n"); 
		query.append("      ,QTY7 QTY3" ).append("\n"); 
		query.append("#elseif (${tp_cd} == '4')" ).append("\n"); 
		query.append("      ,QTY8 QTY1" ).append("\n"); 
		query.append("      ,QTY9 QTY2" ).append("\n"); 
		query.append("      ,QTY10 QTY3" ).append("\n"); 
		query.append("      ,QTY11 QTY4" ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(SELECT *" ).append("\n"); 
		query.append("  FROM OPT_ST" ).append("\n"); 
		query.append("UNION ALL  " ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("       'TOTAL' LOC_CD" ).append("\n"); 
		query.append("      ,1 SEL_NO" ).append("\n"); 
		query.append("      ,'Inventory (MT)' DIVISION" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,1,TOTAL_CNT,0)) TOTAL_CNT " ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,1,QTY1,0)) QTY1" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,1,QTY2,0)) QTY2" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,1,QTY3,0)) QTY3" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,1,QTY4,0)) QTY4" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,1,QTY5,0)) QTY5" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,1,QTY6,0)) QTY6" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,1,QTY7,0)) QTY7" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,1,QTY8,0)) QTY8" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,1,QTY9,0)) QTY9" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,1,QTY10,0)) QTY10" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,1,QTY11,0)) QTY11" ).append("\n"); 
		query.append("  FROM OPT_ST" ).append("\n"); 
		query.append("UNION ALL  " ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("       'TOTAL' LOC_CD" ).append("\n"); 
		query.append("      ,2 SEL_NO" ).append("\n"); 
		query.append("      ,'Optimum Stock (t-Dist)' DIVISION" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,2,TOTAL_CNT,0)) TOTAL_CNT " ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,2,QTY1,0)) QTY1" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,2,QTY2,0)) QTY2" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,2,QTY3,0)) QTY3" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,2,QTY4,0)) QTY4" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,2,QTY5,0)) QTY5" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,2,QTY6,0)) QTY6" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,2,QTY7,0)) QTY7" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,2,QTY8,0)) QTY8" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,2,QTY9,0)) QTY9" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,2,QTY10,0)) QTY10" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,2,QTY11,0)) QTY11" ).append("\n"); 
		query.append("  FROM OPT_ST" ).append("\n"); 
		query.append("UNION ALL  " ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("       'TOTAL' LOC_CD" ).append("\n"); 
		query.append("      ,3 SEL_NO" ).append("\n"); 
		query.append("      ,'Optimum Stock (Final)' DIVISION" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,3,TOTAL_CNT,0)) TOTAL_CNT " ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,3,QTY1,0)) QTY1" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,3,QTY2,0)) QTY2" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,3,QTY3,0)) QTY3" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,3,QTY4,0)) QTY4" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,3,QTY5,0)) QTY5" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,3,QTY6,0)) QTY6" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,3,QTY7,0)) QTY7" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,3,QTY8,0)) QTY8" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,3,QTY9,0)) QTY9" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,3,QTY10,0)) QTY10" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,3,QTY11,0)) QTY11" ).append("\n"); 
		query.append("  FROM OPT_ST" ).append("\n"); 
		query.append("UNION ALL  " ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("       'TOTAL' LOC_CD" ).append("\n"); 
		query.append("      ,4 SEL_NO" ).append("\n"); 
		query.append("      ,'Diff. (Invt vs Optimum Final)' DIVISION" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,4,TOTAL_CNT,0)) TOTAL_CNT " ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,4,QTY1,0)) QTY1" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,4,QTY2,0)) QTY2" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,4,QTY3,0)) QTY3" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,4,QTY4,0)) QTY4" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,4,QTY5,0)) QTY5" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,4,QTY6,0)) QTY6" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,4,QTY7,0)) QTY7" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,4,QTY8,0)) QTY8" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,4,QTY9,0)) QTY9" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,4,QTY10,0)) QTY10" ).append("\n"); 
		query.append("      ,SUM(DECODE(SEL_NO,4,QTY11,0)) QTY11" ).append("\n"); 
		query.append("  FROM OPT_ST" ).append("\n"); 
		query.append("UNION ALL  " ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("       DISTINCT 'TOTAL' LOC_CD" ).append("\n"); 
		query.append("      ,5 SEL_NO" ).append("\n"); 
		query.append("      ,'Ratio (Invt/Optimum Final)' DIVISION" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,TOTAL_CNT,0))/NULLIF(SUM(DECODE(SEL_NO,3,TOTAL_CNT,0)),0),1),0) TOTAL_CNT" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY1,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY1,0)),0),1),0) QTY1" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY2,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY2,0)),0),1),0) QTY2" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY3,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY3,0)),0),1),0) QTY3" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY4,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY4,0)),0),1),0) QTY4" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY5,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY5,0)),0),1),0) QTY5" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY6,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY6,0)),0),1),0) QTY6" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY7,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY7,0)),0),1),0) QTY7" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY8,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY8,0)),0),1),0) QTY8" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY9,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY9,0)),0),1),0) QTY9" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY10,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY10,0)),0),1),0) QTY10" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY11,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY11,0)),0),1),0) QTY11" ).append("\n"); 
		query.append("  FROM OPT_ST" ).append("\n"); 
		query.append(" UNION ALL  " ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("       DISTINCT  'TOTAL' LOC_CD" ).append("\n"); 
		query.append("      ,6 SEL_NO" ).append("\n"); 
		query.append("      ,'Signal' DIVISION" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,TOTAL_CNT,0))/NULLIF(SUM(DECODE(SEL_NO,3,TOTAL_CNT,0)),0),1),0) TOTAL_CNT" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY1,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY1,0)),0),1),0) QTY1" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY2,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY2,0)),0),1),0) QTY2" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY3,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY3,0)),0),1),0) QTY3" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY4,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY4,0)),0),1),0) QTY4" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY5,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY5,0)),0),1),0) QTY5" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY6,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY6,0)),0),1),0) QTY6" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY7,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY7,0)),0),1),0) QTY7" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY8,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY8,0)),0),1),0) QTY8" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY9,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY9,0)),0),1),0) QTY9" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY10,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY10,0)),0),1),0) QTY10" ).append("\n"); 
		query.append("      ,NVL(ROUND(SUM(DECODE(SEL_NO,1,QTY11,0))/NULLIF(SUM(DECODE(SEL_NO,3,QTY11,0)),0),1),0) QTY11" ).append("\n"); 
		query.append("  FROM OPT_ST)" ).append("\n"); 

	}
}