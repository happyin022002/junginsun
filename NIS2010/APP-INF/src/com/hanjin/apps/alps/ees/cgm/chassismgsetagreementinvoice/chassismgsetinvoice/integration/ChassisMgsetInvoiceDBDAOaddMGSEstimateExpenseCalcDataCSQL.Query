<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChassisMgsetInvoiceDBDAOaddMGSEstimateExpenseCalcDataCSQL">
			<desc><![CDATA[chungpa 20091012 2206 start]]></desc>
			<sql><![CDATA[
INSERT INTO GL_ESTM_IF_ERP (
    EXE_YRMON
    , SYS_SRC_ID
    , REV_YRMON
    , ACCT_CD
	, AGMT_NO
	, CNTR_TPSZ_CD
	, LOC_CD
    , ESTM_SEQ_NO
    , VSL_CD
    , SKD_VOY_NO
    , SKD_DIR_CD
    , REV_DIR_CD
	, WO_NO
    , ESTM_AMT
    , ACT_AMT
    , ACCL_AMT
    , CRE_USR_ID
    , CRE_DT
    , UPD_USR_ID
    , UPD_DT
	, ESTM_VVD_TP_CD
	, ESTM_IOC_DIV_CD
	, ESTM_VVD_HDR_ID
	, ESTM_BC_DIV_CD
	, BIZ_UT_ID
	, VNDR_INV_NO
) VALUES (
    @[exe_yrmon]
    , 'MGS'
    , @[rev_yrmon]
    , @[acct_cd]
	, @[agmt_no]
	, @[agmt_lstm_cd]
	, @[chss_pool_cd]
    , (SELECT NVL(MAX(ESTM_SEQ_NO),0)+1 
		FROM GL_ESTM_IF_ERP 
		WHERE EXE_YRMON = @[exe_yrmon] 
			AND SYS_SRC_ID = 'MGS'
			AND REV_YRMON = @[rev_yrmon]
			AND ACCT_CD = @[acct_cd])
    , 'CNTC'
    , SUBSTR(@[rev_yrmon], 3, 4)
    , 'M'
    , 'M'
	, @[rev_vvd]
    , @[estm_amt]
    , @[act_amt]
    , @[accl_amt]
    , @[cre_usr_id]
    , TO_DATE(REPLACE(@[cre_dt],'-',''),'YYYYMMDD')
    , @[upd_usr_id]
    , SYSDATE
	, 'RV'
	, 'XX'
	, (SELECT ESTM_VVD_HDR_ID
        FROM GL_ESTM_REV_VVD
        WHERE EXE_YRMON = @[exe_yrmon]
           AND REV_YRMON = @[rev_yrmon]
           AND VSL_CD = 'CNTC'
           AND SKD_VOY_NO = SUBSTR(@[rev_yrmon], 3, 4)
           AND SKD_DIR_CD = 'M'
           AND REV_DIR_CD = 'M')
	, 'M'
	, 'CNTR'
	, @[invo_no]
)			]]></sql>
			<params>
				<param name="exe_yrmon" type="12" value="" out="N"/>
				<param name="rev_yrmon" type="12" value="" out="N"/>
				<param name="acct_cd" type="12" value="" out="N"/>
				<param name="agmt_no" type="12" value="" out="N"/>
				<param name="agmt_lstm_cd" type="12" value="" out="N"/>
				<param name="chss_pool_cd" type="12" value="" out="N"/>
				<param name="rev_vvd" type="12" value="" out="N"/>
				<param name="estm_amt" type="12" value="" out="N"/>
				<param name="act_amt" type="12" value="" out="N"/>
				<param name="accl_amt" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="cre_dt" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="invo_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
