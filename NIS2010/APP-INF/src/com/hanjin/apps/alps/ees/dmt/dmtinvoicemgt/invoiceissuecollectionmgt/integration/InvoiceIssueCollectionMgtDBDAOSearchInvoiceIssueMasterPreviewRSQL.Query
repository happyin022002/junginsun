<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceIssueCollectionMgtDBDAOSearchInvoiceIssueMasterPreviewRSQL">
			<desc><![CDATA[EES_DMT_4003 RD MASTER]]></desc>
			<sql><![CDATA[
#if (${jspno} == '4002')
-- General Invoice
SELECT A.DMDT_INV_NO AS DMDT_INV_NO       
       ,TO_CHAR(A.CRE_DT,'YYYYMMDD') AS ISSUE_DAY                                                                                                                             
       ,DECODE(                              
               (SELECT COUNT(*) FROM DMT_CR_TERM_OPT                                                                                  
                WHERE OFC_CD = A.CRE_OFC_CD)                                                                                          
                , 0                                                                                                                   
                , TO_CHAR(A.CRE_DT,  'DDMonYY', 'NLS_DATE_LANGUAGE = American')                                                       
                ,(SELECT CASE WHEN CR_TERM_DYS > 0 THEN TO_CHAR(A.CRE_DT + CR_TERM_DYS, 'DDMonYY', 'NLS_DATE_LANGUAGE = American')    
                              WHEN CR_TERM_DYS = 0 THEN                                                                               
                                 CASE WHEN ISS_DT_PRN_FLG = 'Y' THEN TO_CHAR(A.CRE_DT,  'DDMonYY', 'NLS_DATE_LANGUAGE = American')    
                                 ELSE '*******'                                                                                       
                                 END                                                                                                  
                         END DUE_DATE                                                                                                 
                  FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                
                  WHERE OPT.OFC_CD = TRF_OPT.OFC_CD
    			  AND OPT.CR_TERM_SEQ = TRF_OPT.CR_TERM_SEQ
    			  AND OPT.OFC_CD = A.CRE_OFC_CD  
				  AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD                                                                                     
                 )                                                                                                                    
         ) AS DUE_DATE                                                                                                                
       ,DECODE(                                                                                                                       
              (SELECT COUNT(*) FROM DMT_CR_TERM_OPT                                                                                   
               WHERE OFC_CD = A.CRE_OFC_CD)                                                                                           
              , 0                                                                                                                     
              , 0                                                                                                                     
              , (SELECT CASE WHEN OPT.CR_TERM_DYS > 0 THEN TO_CHAR(OPT.CR_TERM_DYS)                                                           
                             WHEN OPT.CR_TERM_DYS = 0 THEN                                                                                
                                  CASE WHEN OPT.ISS_DT_PRN_FLG = 'Y' THEN '0'                                                             
                                  ELSE ''                                                                                             
                                  END                                                                                                 
                        END DUE_DAY                                                                                                   
                 FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                 
                 WHERE OPT.OFC_CD = TRF_OPT.OFC_CD
				   AND OPT.CR_TERM_SEQ = TRF_OPT.CR_TERM_SEQ
				   AND OPT.OFC_CD = A.CRE_OFC_CD
				   AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD
			)                                                                                         
        ) AS DUE_DAY  
		, DECODE(DECODE(                              
			 		 (SELECT COUNT(*) FROM DMT_CR_TERM_OPT WHERE OFC_CD = A.CRE_OFC_CD)                                                                                          
					, 0                                                                                                                   
					, TO_CHAR(A.CRE_DT,  'YYYYMMDD')
					,(SELECT CASE WHEN CR_TERM_DYS > 0 THEN TO_CHAR(A.CRE_DT + CR_TERM_DYS, 'YYYYMMDD')    
			              		  WHEN CR_TERM_DYS = 0 THEN                                                                               
			                       		CASE WHEN ISS_DT_PRN_FLG = 'Y' THEN TO_CHAR(A.CRE_DT,  'YYYYMMDD')    
			                       		ELSE '*******'                                                                                       
			                       		END                                                                                                  
			         		 END DUE_DATE                                                                                                 
			  		  FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                
			  		  WHERE OPT.OFC_CD 		= TRF_OPT.OFC_CD
			  		  AND OPT.CR_TERM_SEQ 	= TRF_OPT.CR_TERM_SEQ
			  		  AND OPT.OFC_CD 		= A.CRE_OFC_CD  
			  		  AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD)                                                                                                                    
		    			)
				, '*******'
				, 'N'
				, DECODE( DECODE(  
							 (SELECT COUNT(*) FROM DMT_CR_TERM_OPT WHERE OFC_CD = A.CRE_OFC_CD)                                                                                          
				  			, 0                                                                                                                   
				  			, TO_CHAR(A.CRE_DT,  'YYYYMMDD')
				  			,(SELECT CASE WHEN CR_TERM_DYS > 0 THEN TO_CHAR(A.CRE_DT + CR_TERM_DYS, 'YYYYMMDD')    
				                	      WHEN CR_TERM_DYS = 0 THEN                                                                               
				                   				CASE WHEN ISS_DT_PRN_FLG = 'Y' THEN TO_CHAR(A.CRE_DT,  'YYYYMMDD')    
				                   				ELSE '*******'                                                                                       
				                   				END                                                                                                  
				           			 END DUE_DATE                                                                                                 
				    		  FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                
				    		  WHERE OPT.OFC_CD 		= TRF_OPT.OFC_CD
				    		  AND OPT.CR_TERM_SEQ 	= TRF_OPT.CR_TERM_SEQ
				   			  AND OPT.OFC_CD 		= A.CRE_OFC_CD  
				    		  AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD)                                                                                                                    
			     			)
				 		, TO_CHAR(A.CRE_DT,'YYYYMMDD')
				 		, 'N'
				 		, 'Y')
		) AS DAYS_DISP
       ,DECODE(A.NTC_KNT_CD, '1','1st NOTICE',2,'2nd NOTICE',3,'3rd NOTICE',9,'FINAL NOTICE','') AS NTC_KNT_CD                                                                
       ,A.CRE_USR_ID AS CRE_USR_ID                                                                                                                                            
       ,(SELECT USR_NM FROM COM_USER WHERE USR_ID = A.CRE_USR_ID) AS CRE_USR_NM
	   ,(SELECT SUBSTR(LOC_CD,0,2) FROM MDM_ORGANIZATION WHERE OFC_CD = A.CRE_OFC_CD) AS CRE_CNT_CD                                                                                               
       ,DECODE(A.ACT_PAYR_CNT_CD,'00','',A.ACT_PAYR_CNT_CD)||LPAD(A.ACT_PAYR_SEQ,6,'0') AS CUST_CD                                                                            
       ,A.INV_REF_NO AS INV_REF_NO                                                                                                                                            
       ,(SELECT CUST_RGST_NO                                                                                                                                                  
         FROM MDM_CUSTOMER                                                                                                                                                    
         WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                                                
         AND CUST_SEQ = A.ACT_PAYR_SEQ) AS CUST_VAT_NO                                                                                                                      
	   ,DECODE(                                                                                                                                                                
              (SELECT DMDT_PAYR_NM                                                                                                                                            
               FROM DMT_PAYR_INFO                                                                                                                                             
               WHERE SYS_AREA_GRP_ID  = (SELECT SYS_AREA_GRP_ID                                                                                                               
                                         FROM COM_SYS_AREA_GRP_ID                                                                                                             
                                         WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                          
                                                         FROM MDM_ORGANIZATION                                                                                                
                                                         WHERE OFC_CD = A.CRE_OFC_CD)                                                                                         
                                         AND CO_IND_CD = 'H')                                                                                                                 
               AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                                            
               AND CUST_SEQ  = A.ACT_PAYR_SEQ)
			  , NULL
			  ,(DECODE(                                                                                                                                                     
                      (SELECT LOCL_NM                                                                                                                                     
                       FROM MDM_CR_CUST                                                                                                                                   
                       WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                              
                       AND CUST_SEQ    = A.ACT_PAYR_SEQ                                                                                                                   
                       AND LOCL_NM IS NOT NULL                                                                                                                            
                      )
					  ,NULL
					  ,(SELECT CASE WHEN A.ACT_PAYR_CNT_CD = '00' THEN (SELECT VNDR_LGL_ENG_NM                                                                             
                                                                        FROM MDM_VENDOR                                                                                                 
                                                              			WHERE VNDR_SEQ = A.ACT_PAYR_SEQ                                                                                 
                                                              			AND VNDR_LGL_ENG_NM IS NOT NULL)                                                                                
                               ELSE                                                                                                                                        
                                   (SELECT CUST_LGL_ENG_NM                                                                                                                
                                    FROM MDM_CUSTOMER                                                                                                                     
                                    WHERE CUST_CNT_CD 	= A.ACT_PAYR_CNT_CD                                                                                                 
                                    AND CUST_SEQ     	= A.ACT_PAYR_SEQ                                                                                                     
                                    AND CUST_LGL_ENG_NM IS NOT NULL)                                                                                                      
                               END MDM_NAME                                                                                                                                
                        FROM DUAL                                                                                                                                          
                       )
					  ,(SELECT LOCL_NM                                                                                                                                    
                        FROM MDM_CR_CUST                                                                                                                                   
                        WHERE CUST_CNT_CD 	= A.ACT_PAYR_CNT_CD                                                                                                              
                        AND CUST_SEQ    	= A.ACT_PAYR_SEQ                                                                                                                   
                        AND LOCL_NM IS NOT NULL                                                                                                                            
                        )                                                                                                                                                  
                      )                                                                                                                                                    
              )
			  ,(SELECT DMDT_PAYR_NM                                                                                                                                             
                FROM DMT_PAYR_INFO                                                                                                                                              
                WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID                                                                                                                
                                         FROM COM_SYS_AREA_GRP_ID                                                                                                               
                                         WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                            
                                                         FROM MDM_ORGANIZATION                                                                                                  
                                                         WHERE OFC_CD = A.CRE_OFC_CD)                                                                                           
                                         AND CO_IND_CD = 'H')                                                                                                                   
                AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                                             
                AND CUST_SEQ  = A.ACT_PAYR_SEQ                                                                                                                                  
               )                                                                                                                                                               
            ) AS CUST_NM                                                                                                                                                        
       ,DMDT_PAYR_CNTC_PNT_NM AS ATTN_NM                                                                                                                                      
       ,DECODE((SELECT COUNT(*) FROM DMT_PAYR_CNTC_PNT  
                WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID   
                                         FROM COM_SYS_AREA_GRP_ID   
                                         WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2) 
                                                         FROM MDM_ORGANIZATION  
                                                         WHERE OFC_CD = A.CRE_OFC_CD) 
                                         AND CO_IND_CD = 'H')    
                   AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD     
                   AND CUST_SEQ = A.ACT_PAYR_SEQ
				   AND (
						(A.CUST_CNTC_PNT_SEQ IS NULL AND ROWNUM = 1)
						OR
						(CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)
					   )
				)       
                  ,0              
                  ,DECODE(A.ACT_PAYR_CNT_CD , '00',      
		         (SELECT V_CNTC.PHN_NO FROM MDM_VENDOR V_MDM, MDM_VNDR_CNTC_PNT V_CNTC  
		          WHERE V_MDM.VNDR_SEQ = V_CNTC.VNDR_SEQ
				  AND V_MDM.VNDR_SEQ = A.ACT_PAYR_SEQ
		          AND V_CNTC.PHN_NO IS NOT NULL
				  AND ROWNUM = 1)        
		          ,                
		          DECODE(               
		         (SELECT COUNT(*) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ AND DECODE(SUBSTR(A.DMDT_TRF_CD,2,3),'I',IB_PHN_NO,OB_PHN_NO) IS NOT NULL) 
		         ,0                
                 ,(SELECT DISTINCT PHN_NO FROM MDM_CUSTOMER C_CUST, MDM_CUST_CNTC_PNT C_CNTC
                   WHERE C_CUST.CUST_CNT_CD  = C_CNTC.CUST_CNT_CD
                   AND C_CUST.CUST_SEQ   = C_CNTC.CUST_SEQ
                   AND C_CUST.CUST_CNT_CD  = A.ACT_PAYR_CNT_CD
                   AND C_CUST.CUST_SEQ   = A.ACT_PAYR_SEQ
                   AND C_CNTC.PHN_NO IS NOT NULL
				   AND ROWNUM = 1)
                 ,(SELECT DISTINCT DECODE(SUBSTR(A.DMDT_TRF_CD,2,3),'I',IB_PHN_NO,OB_PHN_NO) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ)
				)                
			)                 
           ,(SELECT PAYR_CNTC_PNT_PHN_NO FROM DMT_PAYR_CNTC_PNT
             WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID
                                      FROM COM_SYS_AREA_GRP_ID
                                      WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)
                                                      FROM MDM_ORGANIZATION
                                                      WHERE OFC_CD = A.CRE_OFC_CD)
                                      AND CO_IND_CD = 'H')
             AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD
             AND CUST_SEQ = A.ACT_PAYR_SEQ
             AND 
              ( 
                (A.CUST_CNTC_PNT_SEQ IS NULL AND  ROWNUM = 1)
                 OR 
                (CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)
              )
           )
       ) AS PHN_NO             
       ,DECODE((SELECT COUNT(*) FROM DMT_PAYR_CNTC_PNT  
	            WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID  
	                                   FROM COM_SYS_AREA_GRP_ID  
	                                   WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2) 
	                                                                   FROM MDM_ORGANIZATION  
	                                                                   WHERE OFC_CD = A.CRE_OFC_CD)  
	                                   AND CO_IND_CD = 'H')   
	             AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD 
	             AND CUST_SEQ = A.ACT_PAYR_SEQ
				 AND (
					    (A.CUST_CNTC_PNT_SEQ IS NULL AND ROWNUM = 1)
						OR
						(CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)
					 )
				) 
				,0  
				,DECODE(A.ACT_PAYR_CNT_CD , '00',  
				   (SELECT V_CNTC.FAX_NO FROM MDM_VENDOR V_MDM, MDM_VNDR_CNTC_PNT V_CNTC 
				    WHERE V_MDM.VNDR_SEQ = V_CNTC.VNDR_SEQ  
					AND V_MDM.VNDR_SEQ = A.ACT_PAYR_SEQ
				    AND V_CNTC.FAX_NO IS NOT NULL
					AND ROWNUM = 1
					)    
				    ,   
				    DECODE( 
				   (SELECT COUNT(*) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ AND DECODE(SUBSTR(A.DMDT_TRF_CD,2,3),'I',IB_FAX_NO,OB_FAX_NO) IS NOT NULL) 
				   ,0   
				   ,(SELECT DISTINCT FAX_NO FROM MDM_CUSTOMER C_CUST, MDM_CUST_CNTC_PNT C_CNTC  
				     WHERE C_CUST.CUST_CNT_CD  = C_CNTC.CUST_CNT_CD  
				     AND C_CUST.CUST_SEQ   = C_CNTC.CUST_SEQ   
				     AND C_CUST.CUST_CNT_CD  = A.ACT_PAYR_CNT_CD   
				     AND C_CUST.CUST_SEQ   = A.ACT_PAYR_SEQ   
				     AND C_CNTC.FAX_NO IS NOT NULL
					 AND ROWNUM = 1)      
				   ,(SELECT DISTINCT DECODE(SUBSTR(A.DMDT_TRF_CD,3,1),'I',IB_FAX_NO,OB_FAX_NO) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ)  
				   )   
				)
         ,(SELECT PAYR_CNTC_PNT_FAX_NO FROM DMT_PAYR_CNTC_PNT 
           WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID
                                    FROM COM_SYS_AREA_GRP_ID
                                    WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)
                                                    FROM MDM_ORGANIZATION
                                                    WHERE OFC_CD = A.CRE_OFC_CD)
                                    AND CO_IND_CD = 'H')
           AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD
           AND CUST_SEQ = A.ACT_PAYR_SEQ
           AND 
              ( 
                (A.CUST_CNTC_PNT_SEQ IS NULL AND  ROWNUM = 1)
                 OR 
                (CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)
              )
           )    
		) FAX_NO    
       , SH_ADDR1                                                                                                                                                             
       , SH_ADDR2                                                                                                                                                             
       , SH_ADDR3                                                                                                                                                             
       , A.CRE_OFC_CD AS CRE_OFC_CD                                                                                                                                           
       , A.DMDT_INV_STS_CD AS DMDT_INV_STS_CD                                                                                                                                 
       , DECODE((SELECT TIT.CSTMZ_TIT_DESC                                                                                                                                    
                         FROM DMT_CSTMZ_TIT_OPT TIT, DMT_CSTMZ_TIT_TRF_OPT TITTRF                                                                                             
                         WHERE TIT.OFC_CD = TITTRF.OFC_CD                                                                                                                     
                         AND TIT.CR_TERM_SEQ = TITTRF.CR_TERM_SEQ                                                                                                             
                         AND TIT.OFC_CD = A.CRE_OFC_CD                                                                                                                        
                         AND TITTRF.DMDT_TRF_CD = A.DMDT_TRF_CD                                                                                                               
                         AND TIT.DMDT_SH_TP_CD = 'I'
				   ), NULL
				   ,(DECODE(A.DMDT_INV_STS_CD, 'C', '*** CREDIT NOTE ***', 
                                                    DECODE((SELECT SUBSTR(LOC_CD,0,2) 
                                                            FROM MDM_ORGANIZATION 
                                                            WHERE OFC_CD = A.CRE_OFC_CD), 'AU','*** TAX INVOICE ***', 'MY','*** TAX INVOICE ***', 'IN','*** TAX INVOICE ***',
                                                                                               '*** INVOICE ***')))                                                                                                                          
                   ,(SELECT DECODE(A.DMDT_INV_STS_CD, 'C', '*** CREDIT NOTE('||TIT.CSTMZ_TIT_DESC||') ***', 
                                                      DECODE((SELECT SUBSTR(LOC_CD,0,2) 
                                                              FROM MDM_ORGANIZATION 
                                                              WHERE OFC_CD = A.CRE_OFC_CD), 'AU','*** TAX INVOICE('||TIT.CSTMZ_TIT_DESC||') ***',  'MY','*** TAX INVOICE('||TIT.CSTMZ_TIT_DESC||') ***', 'IN','*** TAX INVOICE('||TIT.CSTMZ_TIT_DESC||') ***',
                                                                                                      '*** INVOICE('||TIT.CSTMZ_TIT_DESC||') ***'))      
				   FROM DMT_CSTMZ_TIT_OPT TIT, DMT_CSTMZ_TIT_TRF_OPT TITTRF                                                                                                    
                   WHERE TIT.OFC_CD = TITTRF.OFC_CD                                                                                                                            
                   AND TIT.CR_TERM_SEQ = TITTRF.CR_TERM_SEQ                                                                                                                    
                   AND TIT.OFC_CD = A.CRE_OFC_CD                                                                                                                               
                   AND TITTRF.DMDT_TRF_CD = A.DMDT_TRF_CD                                                                                                                      
                   AND TIT.DMDT_SH_TP_CD = 'I'                                                                                                                                 
                 )                                                                                                                                                            
              ) AS INVOICE_TITLE                                                                                                                                                  
       , DECODE(A.DMDT_INV_STS_CD, 'X','Cancelled', 'C', 'Ref: '||A.CR_INV_NO, ' ') AS CANCEL_NOTE                                                                                                        
       , DECODE(                                                                                                                                                              
			   (SELECT REPLACE(DMDT_PAYR_ADDR,'@*',CHR(13)||CHR(10))                                                                                                                    
         	    FROM DMT_PAYR_INFO                                                                                                                                                   
         	    WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID                                                                                                                      
                                   		 FROM COM_SYS_AREA_GRP_ID                                                                                                                   
                                   		 WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                                
                                                   		 FROM MDM_ORGANIZATION                                                                                                      
                                                   		 WHERE OFC_CD = A.CRE_OFC_CD)                                                                                               
                                                   		 AND CO_IND_CD = 'H')                                                                                                       
         		AND CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                                 
         		AND CUST_SEQ   = A.ACT_PAYR_SEQ                                                                                                                                      
               )
			   ,NULL
			   ,DECODE(                                                                                                                                                                 
          			  (SELECT COUNT(*)     
           			   FROM MDM_CR_CUST                                                                                                                                                   
           			   WHERE CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                             
           			   AND CUST_SEQ   = A.ACT_PAYR_SEQ 
					   AND TRIM(LOCL_ADDR1)||TRIM(LOCL_ADDR2)||TRIM(LOCL_ADDR3)||TRIM(LOCL_ADDR4) IS NOT NULL                                                                                                                                  
          			  )
					  , 0
					  ,                                                                                                                                                            
          			  (SELECT CASE WHEN A.ACT_PAYR_CNT_CD = '00' THEN ( SELECT ZIP_CD||','||REPLACE(ENG_ADDR,'@*',CHR(13)||CHR(10))                                                       
                                                                        FROM MDM_VENDOR                                                                                                  
                                                                        WHERE VNDR_SEQ = A.ACT_PAYR_SEQ)                                                                                 
                              ELSE (SELECT CASE WHEN CN.BKG_ADDR_ORD_CD = 1 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.ZIP_CD                                            
                                                WHEN CN.BKG_ADDR_ORD_CD = 2 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM                                       
                                                WHEN CN.BKG_ADDR_ORD_CD = 3 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD                                    
                                                WHEN CN.BKG_ADDR_ORD_CD = 4 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.STE_CD||' '||ADDR.ZIP_CD                  
                                                WHEN CN.BKG_ADDR_ORD_CD = 5 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD                                    
                                                WHEN CN.BKG_ADDR_ORD_CD = 6 THEN ADDR.CTY_NM||' '||REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.ZIP_CD                                    
                                           ELSE REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD                                                                                           
                                           END                                                                                                                                               
                       				FROM MDM_CUST_ADDR ADDR, MDM_COUNTRY CN                                                                                                                
                       				WHERE ADDR.CUST_CNT_CD = CN.CNT_CD(+)                                                                                                                  
                       				AND ADDR.CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                              
                       				AND ADDR.CUST_SEQ   = A.ACT_PAYR_SEQ
                       				AND ADDR.PRMRY_CHK_FLG = 'Y'
                       				AND ROWNUM = 1                                                                                                                   
                       			   )                                                                                                                                                      
                   			  END                                                                                                                                                        
            		   FROM DUAL                                                                                                                                                         
          			  ),                                                                                                                                                                  
          			  (SELECT TRIM(LOCL_ADDR1)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR2)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR3)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR4)||' '||LOCL_ZIP_CD AS ADDR     
             		   FROM MDM_CR_CUST                                                                                                                                                 
             		   WHERE CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                           
             		   AND CUST_SEQ   = A.ACT_PAYR_SEQ                                                                                                                                  
           			  )                                                                                                                                                                  
       				  ),                                                                                                                                                                     
       				  (SELECT REPLACE(DMDT_PAYR_ADDR,'@*',CHR(13)||CHR(10))                                                                                                                  
         			   FROM DMT_PAYR_INFO                                                                                                                                                   
         			   WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID                                                                                                                      
                                   				FROM COM_SYS_AREA_GRP_ID                                                                                                                   
                                   				WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                                
                                                   				FROM MDM_ORGANIZATION                                                                                                      
                                                   				WHERE OFC_CD = A.CRE_OFC_CD)                                                                                               
                                                   				AND CO_IND_CD = 'H')                                                                                                       
         										AND CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                                 
         										AND CUST_SEQ   = A.ACT_PAYR_SEQ                                                                                                                                      
      				  )                                                                                                                                                                       
      				  )                                                                                                                                                                       
    	  AS PAYR_ADDR                                                                                                                                                              
        , B.SH_HD_N1ST_MSG AS SH_HD_N1ST_MSG                                                                                                                                  
        , B.SH_HD_N2ND_MSG AS SH_HD_N2ND_MSG                                                                                                                                  
        , B.SH_HD_N3RD_MSG AS SH_HD_N3RD_MSG                                                                                                                                  
        , B.SH_HD_N4TH_MSG AS SH_HD_N4TH_MSG                                                                                                                                  
        , B.SH_HD_N5TH_MSG AS SH_HD_N5TH_MSG                                                                                                                                  
        , A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD AS VVD_CD                                                                                                                      
        , (SELECT VSL_ENG_NM FROM MDM_VSL_CNTR WHERE VSL_CD = A.VSL_CD) AS VSL_ENG_NM                                                                                         
        , (SELECT TO_CHAR(VPS_ETA_DT,'YYYYMMDD') FROM VSK_VSL_PORT_SKD                                                                                                        
           WHERE VSL_CD = A.VSL_CD                                                                                                                                            
             AND SKD_VOY_NO = A.SKD_VOY_NO                                                                                                                                    
             AND SKD_DIR_CD = A.SKD_DIR_CD                                                                                                                                    
             AND VPS_PORT_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                       
                                ELSE A.POR_CD                                                                                                               
                                END)                                                                                                                        
             AND CLPT_IND_SEQ = 1                                                                                                                                             
           ) AS ARR                                                                                                                                                           
        , (SELECT TO_CHAR(VPS_ETD_DT,'YYYYMMDD') FROM VSK_VSL_PORT_SKD                                                                                                        
           WHERE VSL_CD = A.VSL_CD                                                                                                                                            
             AND SKD_VOY_NO = A.SKD_VOY_NO                                                                                                                                    
             AND SKD_DIR_CD = A.SKD_DIR_CD                                                                                                                                    
             AND VPS_PORT_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                       
                                ELSE A.POR_CD                                                                                                              
                                END)                                                                                                                       
             AND CLPT_IND_SEQ = 1                                                                                                                                             
           ) AS DEP                                                                                                                                                           
        , A.BL_NO AS BL_NO                                                                                                                                                    
        , A.BKG_NO AS BKG_NO                                                                                                                                                  
        , (SELECT CMDT_CD FROM BKG_BOOKING
		   WHERE BKG_NO = A.BKG_NO) AS CMDT_CD                                                                                                                                                        
        , (SELECT CMDT_NM FROM MDM_COMMODITY                                                                                                                                  
           WHERE CMDT_CD = (SELECT CMDT_CD FROM BKG_BOOKING
							WHERE BKG_NO = A.BKG_NO)) AS CMDT_NM                                                                                                                    
        , A.DMDT_TRF_CD AS DMDT_TRF_CD                                                                                                                                        
        , (SELECT DMDT_TRF_NM FROM DMT_TRF_TP WHERE DMDT_TRF_CD = A.DMDT_TRF_CD) AS DMDT_TRF_NM  
        , A.BKG_RCV_TERM_CD
        , (SELECT INTG_CD_VAL_DP_DESC                                                                                                                                         
           FROM COM_INTG_CD_DTL                                                                                                                                               
           WHERE INTG_CD_VAL_CTNT = A.BKG_RCV_TERM_CD                                                   
             AND INTG_CD_ID = 'CD00764'                                                                                                                                       
          ) AS BKG_RCV_TERM_NM  
        , A.BKG_DE_TERM_CD
        , (SELECT INTG_CD_VAL_DP_DESC                                                                                                                                         
           FROM COM_INTG_CD_DTL                                                                                                                                               
           WHERE INTG_CD_VAL_CTNT = A.BKG_DE_TERM_CD                                                   
             AND INTG_CD_ID = 'CD00765'                                                                                                                                       
          ) AS BKG_DEL_TERM_NM                                                                                                                                            
        , (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                                            
           ELSE A.POR_CD                                                                                                                                                      
           END) AS POD                                                                                                                                                        
        , (SELECT LOC_NM                                                                                                                                                      
           FROM MDM_LOCATION                                                                                                                                                  
           WHERE LOC_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                            
                                           ELSE A.POR_CD                                                                                                                      
                                           END)                                                                                                                               
          ) AS POD_NM                                                                                                                                                         
        , (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.DEL_CD                                                                                                            
           ELSE A.POL_CD                                                                                                                                                      
           END) AS DEL                                                                                                                                                        
        , (SELECT LOC_NM                                                                                                                                                      
           FROM MDM_LOCATION                                                                                                                                                  
           WHERE LOC_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.DEL_CD                                                                                            
                           ELSE A.POL_CD                                                                                                                      
                           END)                                                                                                                               
          ) AS DEL_NM                                                                                                                                                         
        ,   (                                                                                                                                                                   
            SELECT    DECODE(S.VNDR_SEQ, 0, '',(SELECT VNDR_LGL_ENG_NM FROM MDM_VENDOR WHERE VNDR_SEQ = S.VNDR_SEQ))
            FROM      DMT_CHG_CALC S
            WHERE     1=1
            AND       S.DMDT_INV_NO   = A.DMDT_INV_NO
            AND       ROWNUM          = 1                                                                                                                                                      
            )   AS TRUCKER_NM                                                                                                                                                     
        , NVL(A.BIL_AMT,0) AS ORG_CHG_AMT
        , A.CHG_CURR_CD AS ORG_CURR_CD                                                                                                                                        
        , NVL(A.INV_XCH_RT,0) AS INV_XCH_RT                                                                                                                                          
        , A.INV_CURR_CD AS INV_CURR_CD                                                                                                                                        
        , (NVL(A.INV_CHG_AMT,0) + NVL(A.DC_AMT,0)) AS TOT_AMT                                                                                                                               
        , NVL(A.DC_AMT,0) AS DC_AMT                                                                                                                                                  
        , NVL(A.INV_CHG_AMT,0) AS INV_CHG_AMT                                                                                                                                        
        , A.TAX_RTO AS TAX_RTO                                                                                                                                                
        , NVL(A.TAX_AMT,0) AS TAX_AMT                                                                                                                                                
        , NVL(A.INV_AMT,0) AS INV_AMT                                                                                                                                                
        , CASE WHEN INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10), 1, 1) = 0 THEN                                                                                           
                SUBSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10), -1, 1) + 1)                                                         
          ELSE                                                                                                                                                                
                SUBSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), 0, INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10),1,1))                                                             
          END AS INV_RMK1                                                                                                                                                     
        , CASE WHEN INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10), 1, 1) = 0 THEN                                                                                           
                ''                                                                                                                                                          
          ELSE                                                                                                                                                                
                SUBSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10),-1,1)+1)                                                           
          END AS INV_RMK2                                                                                                                                                     
        , B.SH_RMK1 AS SH_RMK1                                                                                                                                                
        , B.SH_RMK2 AS SH_RMK2                                                                                                                                                
        , B.SH_RMK3 AS SH_RMK3                                                                                                                                                
        , B.SH_RMK4 AS SH_RMK4                                                                                                                                                
        , B.SH_RMK5 AS SH_RMK5                                                                                                                                                
        , B.SH_RMK6 AS SH_RMK6                                                                                                                                                
        , B.SH_RMK7 AS SH_RMK7                                                                                                                                                
        , B.SH_RMK8 AS SH_RMK8                                                                                                                                                
        , B.SH_RMK9 AS SH_RMK9                                                                                                                                                
        , B.SH_RMK10 AS SH_RMK10                                                                                                                                              
        , B.SH_RMK11 AS SH_RMK11                                                                                                                                              
        , B.SH_RMK12 AS SH_RMK12                                                                                                                                              
        , B.SH_RMK13 AS SH_RMK13                                                                                                                                              
        , B.SH_RMK14 AS SH_RMK14                                                                                                                                              
        , (SELECT TAX_AMT_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS TAX_AMT_PRN_FLG                                                                         
        , (DECODE (A.DC_AMT, 0, 'N', (SELECT DC_AMT_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD))) AS DC_AMT_FLG                                                      
        , (SELECT CUST_REF_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS CUST_REF_PRN_FLG                                                                       
        , (SELECT CUST_VAT_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS CUST_VAT_PRN_FLG                                                                       
        , (SELECT PHN_FAX_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS PHN_FAX_PRN_FLG  
		, A.POD_CD
		, A.POR_CD
		, A.DEL_CD
		, A.POL_CD
		--// INDIA TAX  
        , A.IDA_EXPN_TAX_RT
        , A.IDA_EXPN_TAX   
        , A.IDA_EDU_TAX_RT
        , A.IDA_EDU_TAX    
        , A.IDA_HIGH_EDU_TAX_RT
        , A.IDA_HIGH_EDU_TAX
        , A.IDA_LOCL_TAX_RT
        , A.IDA_LOCL_TAX   
        , A.IDA_N2ND_LOCL_TAX_RT
		, A.IDA_N2ND_LOCL_TAX
		--// INDIA TAX  
		, A.IDA_CGST_RTO
		, A.IDA_CGST_AMT
		, A.IDA_SGST_RTO
		, A.IDA_SGST_AMT
		, A.IDA_IGST_RTO
		, A.IDA_IGST_AMT
		, A.IDA_UGST_RTO
		, A.IDA_UGST_AMT
		
  FROM  DMT_INV_MN 	A
       ,DMT_SH_SET  B
	   
 WHERE  A.CRE_OFC_CD    = B.OFC_CD                                                                                                                                              
   AND  A.DMDT_TRF_CD   = B.DMDT_TRF_CD                                                                                                                                          
   AND  B.DMDT_SH_TP_CD = 'I'                                                                                                                                                  
   AND  A.DMDT_INV_NO   = @[invoice_no] 
   AND  A.CRE_OFC_CD    = @[cre_ofc_cd]                                                                                                          

#else
-- Manual Invoice
SELECT  A.DMDT_INV_NO AS DMDT_INV_NO       
	, TO_CHAR(A.CRE_DT,'YYYYMMDD') AS ISSUE_DAY      
    , DECODE((SELECT COUNT(*) FROM DMT_CR_TERM_OPT WHERE OFC_CD = A.CRE_OFC_CD)   
              , 0                                 
              , TO_CHAR(A.CRE_DT,  'DDMonYY', 'NLS_DATE_LANGUAGE = American')      
              , (SELECT CASE WHEN CR_TERM_DYS > 0 THEN TO_CHAR(A.CRE_DT + CR_TERM_DYS, 'DDMonYY', 'NLS_DATE_LANGUAGE = American')    
                             WHEN CR_TERM_DYS = 0 THEN                                                                               
                                 CASE WHEN ISS_DT_PRN_FLG = 'Y' THEN TO_CHAR(A.CRE_DT,  'DDMonYY', 'NLS_DATE_LANGUAGE = American')    
                                 ELSE '*******'                                                                                       
                                 END                                                                                                  
                        END DUE_DATE                                                                                                 
                  FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                
                  WHERE OPT.OFC_CD = TRF_OPT.OFC_CD
    			  AND OPT.CR_TERM_SEQ = TRF_OPT.CR_TERM_SEQ
    			  AND OPT.OFC_CD = A.CRE_OFC_CD
				  AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD                                                                                     
                 )                                                                                                                    
           ) AS DUE_DATE                                                                                                                
       ,DECODE(                                                                                                                       
               (SELECT COUNT(*) FROM DMT_CR_TERM_OPT WHERE OFC_CD = A.CRE_OFC_CD)  
                , 0                                                                                                                     
                , 0                                                                                                                     
                , (SELECT CASE WHEN OPT.CR_TERM_DYS > 0 THEN TO_CHAR(OPT.CR_TERM_DYS)                                                           
                             WHEN OPT.CR_TERM_DYS = 0 THEN                                                                                
                                  CASE WHEN OPT.ISS_DT_PRN_FLG = 'Y' THEN '0'                                                             
                                  ELSE ''                                                                                             
                                  END                                                                                                 
                        END DUE_DAY                                                                                                   
                 FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                 
                 WHERE OPT.OFC_CD = TRF_OPT.OFC_CD
				   AND OPT.CR_TERM_SEQ = TRF_OPT.CR_TERM_SEQ
				   AND OPT.OFC_CD = A.CRE_OFC_CD
				   AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD)                                                                                         
        ) AS DUE_DAY                                                    
		, DECODE(DECODE(                              
			 		 (SELECT COUNT(*) FROM DMT_CR_TERM_OPT WHERE OFC_CD = A.CRE_OFC_CD)                                                                                          
					, 0                                                                                                                   
					, TO_CHAR(A.CRE_DT,  'YYYYMMDD')
					,(SELECT CASE WHEN CR_TERM_DYS > 0 THEN TO_CHAR(A.CRE_DT + CR_TERM_DYS, 'YYYYMMDD')    
			              		  WHEN CR_TERM_DYS = 0 THEN                                                                               
			                       		CASE WHEN ISS_DT_PRN_FLG = 'Y' THEN TO_CHAR(A.CRE_DT,  'YYYYMMDD')    
			                       		ELSE '*******'                                                                                       
			                       		END                                                                                                  
			         		 END DUE_DATE                                                                                                 
			  		  FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                
			  		  WHERE OPT.OFC_CD 		= TRF_OPT.OFC_CD
			  		  AND OPT.CR_TERM_SEQ 	= TRF_OPT.CR_TERM_SEQ
			  		  AND OPT.OFC_CD 		= A.CRE_OFC_CD  
			  		  AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD)                                                                                                                    
		    			)
				, '*******'
				, 'N'
				, DECODE( DECODE(  
							 (SELECT COUNT(*) FROM DMT_CR_TERM_OPT WHERE OFC_CD = A.CRE_OFC_CD)                                                                                          
				  			, 0                                                                                                                   
				  			, TO_CHAR(A.CRE_DT,  'YYYYMMDD')
				  			,(SELECT CASE WHEN CR_TERM_DYS > 0 THEN TO_CHAR(A.CRE_DT + CR_TERM_DYS, 'YYYYMMDD')    
				                	      WHEN CR_TERM_DYS = 0 THEN                                                                               
				                   				CASE WHEN ISS_DT_PRN_FLG = 'Y' THEN TO_CHAR(A.CRE_DT,  'YYYYMMDD')    
				                   				ELSE '*******'                                                                                       
				                   				END                                                                                                  
				           			 END DUE_DATE                                                                                                 
				    		  FROM DMT_CR_TERM_OPT OPT, DMT_CR_TERM_TRF_OPT TRF_OPT                                                                                                
				    		  WHERE OPT.OFC_CD 		= TRF_OPT.OFC_CD
				    		  AND OPT.CR_TERM_SEQ 	= TRF_OPT.CR_TERM_SEQ
				   			  AND OPT.OFC_CD 		= A.CRE_OFC_CD  
				    		  AND TRF_OPT.DMDT_TRF_CD = A.DMDT_TRF_CD)                                                                                                                    
			     			)
				 		, TO_CHAR(A.CRE_DT,'YYYYMMDD')
				 		, 'N'
				 		, 'Y')
		) AS DAYS_DISP
       ,DECODE(A.NTC_KNT_CD, '1','1st NOTICE',2,'2nd NOTICE',3,'3rd NOTICE',9,'FINAL NOTICE','') AS NTC_KNT_CD                                                                
       ,A.CRE_USR_ID AS CRE_USR_ID                                                                                                                                            
       ,(SELECT USR_NM FROM COM_USER WHERE USR_ID = A.CRE_USR_ID) AS CRE_USR_NM                                                                                               
	   ,(SELECT SUBSTR(LOC_CD,0,2) FROM MDM_ORGANIZATION WHERE OFC_CD = A.CRE_OFC_CD) AS CRE_CNT_CD                                                                                               
       ,DECODE(A.ACT_PAYR_CNT_CD,'00','',A.ACT_PAYR_CNT_CD)||LPAD(A.ACT_PAYR_SEQ,6,'0') AS CUST_CD                                                                            
       ,A.INV_REF_NO AS INV_REF_NO                                                                                                                                            
       ,(SELECT CUST_RGST_NO                                                                                                                                                  
         FROM MDM_CUSTOMER                                                                                                                                                    
         WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                                                
         AND CUST_SEQ = A.ACT_PAYR_SEQ) AS CUST_VAT_NO                                                                                                                      
      ,DECODE((SELECT DMDT_PAYR_NM                                                                                                                                            
               FROM DMT_PAYR_INFO                                                                                                                                             
               WHERE SYS_AREA_GRP_ID  = (SELECT SYS_AREA_GRP_ID                                                                                                               
                                         FROM COM_SYS_AREA_GRP_ID                                                                                                             
                                         WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                          
                                                         FROM MDM_ORGANIZATION                                                                                                
                                                         WHERE OFC_CD = A.CRE_OFC_CD)                                                                                         
                                         AND CO_IND_CD = 'H')                                                                                                                 
               AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                                            
               AND CUST_SEQ  = A.ACT_PAYR_SEQ)
			  ,NULL
			  ,(DECODE((SELECT LOCL_NM                                                                                                                                     
                        FROM MDM_CR_CUST                                                                                                                                   
                        WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                              
                        AND CUST_SEQ    = A.ACT_PAYR_SEQ                                                                                                                   
                        AND LOCL_NM IS NOT NULL)
					   ,NULL
					   ,(SELECT CASE WHEN A.ACT_PAYR_CNT_CD = '00' THEN (SELECT VNDR_LGL_ENG_NM                                                                             
                                                              			 FROM MDM_VENDOR                                                                                                 
                                                              			 WHERE VNDR_SEQ = A.ACT_PAYR_SEQ                                                                                 
                                                              			 AND VNDR_LGL_ENG_NM IS NOT NULL)                                                                                
                                ELSE (SELECT CUST_LGL_ENG_NM                                                                                                                
                                      FROM MDM_CUSTOMER                                                                                                                     
                                      WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                 
                                      AND CUST_SEQ     = A.ACT_PAYR_SEQ                                                                                                     
                                      AND CUST_LGL_ENG_NM IS NOT NULL)                                                                                                      
                                END MDM_NAME                                                                                                                                
                          FROM DUAL)
						,(SELECT LOCL_NM                                                                                                                                    
                          FROM MDM_CR_CUST                                                                                                                                   
                          WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                              
                          AND CUST_SEQ    = A.ACT_PAYR_SEQ                                                                                                                   
                          AND LOCL_NM IS NOT NULL)                                                                                                                                                  
                        )                                                                                                                                                    
              		)
			  ,(SELECT DMDT_PAYR_NM                                                                                                                                             
                FROM DMT_PAYR_INFO                                                                                                                                              
                WHERE SYS_AREA_GRP_ID  = (SELECT SYS_AREA_GRP_ID                                                                                                                
                                          FROM COM_SYS_AREA_GRP_ID                                                                                                               
                                          WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                            
                                                          FROM MDM_ORGANIZATION                                                                                                  
                                                          WHERE OFC_CD = A.CRE_OFC_CD)                                                                                           
                                          AND CO_IND_CD = 'H')                                                                                                                   
                AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD                                                                                                                             
                AND CUST_SEQ  = A.ACT_PAYR_SEQ)                                                                                                                                                               
           ) AS CUST_NM                                                                                                                                                        
       ,DMDT_PAYR_CNTC_PNT_NM AS ATTN_NM                                                                                                                                      
       ,DECODE((SELECT COUNT(*) FROM DMT_PAYR_CNTC_PNT  
                WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID   
                                         FROM COM_SYS_AREA_GRP_ID   
                                         WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2) 
                                                         FROM MDM_ORGANIZATION  
                                                         WHERE OFC_CD = A.CRE_OFC_CD) 
                                         AND CO_IND_CD = 'H')    
                   AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD     
                   AND CUST_SEQ = A.ACT_PAYR_SEQ
				   AND (
						(A.CUST_CNTC_PNT_SEQ IS NULL AND ROWNUM = 1)
						OR
						(CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)
					   )
				  )       
                  ,0              
                  ,DECODE(A.ACT_PAYR_CNT_CD , '00',      
		         (SELECT V_CNTC.PHN_NO FROM MDM_VENDOR V_MDM, MDM_VNDR_CNTC_PNT V_CNTC  
		          WHERE V_MDM.VNDR_SEQ = V_CNTC.VNDR_SEQ       
				  AND V_MDM.VNDR_SEQ = A.ACT_PAYR_SEQ
		          AND V_CNTC.PHN_NO IS NOT NULL
				  AND ROWNUM = 1)        
		          ,                
		          DECODE(               
		         (SELECT COUNT(*) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ AND DECODE(SUBSTR(A.DMDT_TRF_CD,2,3),'I',IB_PHN_NO,OB_PHN_NO) IS NOT NULL) 
		         ,0                
                 ,(SELECT DISTINCT PHN_NO FROM MDM_CUSTOMER C_CUST, MDM_CUST_CNTC_PNT C_CNTC
                   WHERE C_CUST.CUST_CNT_CD  = C_CNTC.CUST_CNT_CD
                   AND C_CUST.CUST_SEQ   = C_CNTC.CUST_SEQ
                   AND C_CUST.CUST_CNT_CD  = A.ACT_PAYR_CNT_CD
                   AND C_CUST.CUST_SEQ   = A.ACT_PAYR_SEQ
                   AND C_CNTC.PHN_NO IS NOT NULL
				   AND ROWNUM = 1)
                 ,(SELECT DISTINCT DECODE(SUBSTR(A.DMDT_TRF_CD,2,3),'I',IB_PHN_NO,OB_PHN_NO) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ)
				)                
			)                 
           ,(SELECT PAYR_CNTC_PNT_PHN_NO FROM DMT_PAYR_CNTC_PNT
             WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID
                                      FROM COM_SYS_AREA_GRP_ID
                                      WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)
                                                      FROM MDM_ORGANIZATION
                                                      WHERE OFC_CD = A.CRE_OFC_CD)
                                      AND CO_IND_CD = 'H')
             AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD
             AND CUST_SEQ = A.ACT_PAYR_SEQ
             AND 
              ( 
                (A.CUST_CNTC_PNT_SEQ IS NULL AND  ROWNUM = 1)
                 OR 
                (CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)
              )
           )
       ) AS PHN_NO                                                          
       ,DECODE((SELECT COUNT(*) FROM DMT_PAYR_CNTC_PNT  
	            WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID  
	                                   FROM COM_SYS_AREA_GRP_ID  
	                                   WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2) 
	                                                                   FROM MDM_ORGANIZATION  
	                                                                   WHERE OFC_CD = A.CRE_OFC_CD)  
	                                   AND CO_IND_CD = 'H')   
	             AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD 
	             AND CUST_SEQ = A.ACT_PAYR_SEQ
				 AND (
					    (A.CUST_CNTC_PNT_SEQ IS NULL AND ROWNUM = 1)
						OR
						(CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)
					 )
				) 
				,0  
				,DECODE(A.ACT_PAYR_CNT_CD , '00',  
				   (SELECT V_CNTC.FAX_NO FROM MDM_VENDOR V_MDM, MDM_VNDR_CNTC_PNT V_CNTC 
				    WHERE V_MDM.VNDR_SEQ = V_CNTC.VNDR_SEQ
					AND V_MDM.VNDR_SEQ = A.ACT_PAYR_SEQ  
				    AND V_CNTC.FAX_NO IS NOT NULL
					AND ROWNUM = 1
					)    
				    ,   
				    DECODE( 
				   (SELECT COUNT(*) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ AND DECODE(SUBSTR(A.DMDT_TRF_CD,2,3),'I',IB_FAX_NO,OB_FAX_NO) IS NOT NULL) 
				   ,0   
				   ,(SELECT DISTINCT FAX_NO FROM MDM_CUSTOMER C_CUST, MDM_CUST_CNTC_PNT C_CNTC  
				     WHERE C_CUST.CUST_CNT_CD  = C_CNTC.CUST_CNT_CD  
				     AND C_CUST.CUST_SEQ   = C_CNTC.CUST_SEQ   
				     AND C_CUST.CUST_CNT_CD  = A.ACT_PAYR_CNT_CD   
				     AND C_CUST.CUST_SEQ   = A.ACT_PAYR_SEQ   
				     AND C_CNTC.FAX_NO IS NOT NULL
					 AND ROWNUM = 1)      
				   ,(SELECT DISTINCT DECODE(SUBSTR(A.DMDT_TRF_CD,3,1),'I',IB_FAX_NO,OB_FAX_NO) FROM MDM_CR_CUST WHERE CUST_CNT_CD = A.ACT_PAYR_CNT_CD AND CUST_SEQ = A.ACT_PAYR_SEQ)  
				   )   
				)
         ,(SELECT PAYR_CNTC_PNT_FAX_NO FROM DMT_PAYR_CNTC_PNT 
           WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID
                                    FROM COM_SYS_AREA_GRP_ID
                                    WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)
                                                    FROM MDM_ORGANIZATION
                                                    WHERE OFC_CD = A.CRE_OFC_CD)
                                    AND CO_IND_CD = 'H')
           AND CUST_CNT_CD = A.ACT_PAYR_CNT_CD
           AND CUST_SEQ = A.ACT_PAYR_SEQ
           AND 
              ( 
                (A.CUST_CNTC_PNT_SEQ IS NULL AND  ROWNUM = 1)
                 OR 
                (CUST_CNTC_PNT_SEQ = A.CUST_CNTC_PNT_SEQ)
              )
           )    
		) FAX_NO                                                    
      ,SH_ADDR1                                                    
      ,SH_ADDR2                                                    
      ,SH_ADDR3                                                    
      ,A.CRE_OFC_CD AS CRE_OFC_CD                                           
      ,A.DMDT_INV_STS_CD AS DMDT_INV_STS_CD  
      ,DECODE(A.DMDT_MNL_INV_RSN_CD, 'SCM', DECODE(A.DMDT_INV_STS_CD, 'C', '*** CREDIT NOTE(DEMURRAGE) ***',  '*** INVOICE(DEMURRAGE) ***'),                             
			DECODE(
			  (SELECT  TIT.CSTMZ_TIT_DESC                                          
               FROM    DMT_CSTMZ_TIT_OPT TIT, DMT_CSTMZ_TIT_TRF_OPT TITTRF                           
               WHERE   TIT.OFC_CD          = TITTRF.OFC_CD                                    
               AND TIT.CR_TERM_SEQ     = TITTRF.CR_TERM_SEQ                                 
               AND TIT.OFC_CD          = A.CRE_OFC_CD                                     
               AND TITTRF.DMDT_TRF_CD  = A.DMDT_TRF_CD                                  
               AND TIT.DMDT_SH_TP_CD   = 'I'                                         
				)                                                      
               ,NULL
			   ,(DECODE(A.DMDT_INV_STS_CD, 'C', '*** CREDIT NOTE ***', 
                                                DECODE((SELECT SUBSTR(LOC_CD,0,2) 
                                                        FROM MDM_ORGANIZATION 
                                                        WHERE OFC_CD = A.CRE_OFC_CD), 'AU','*** TAX INVOICE ***', 
																					  'MY','*** TAX INVOICE ***', 
																					  'IN','*** TAX INVOICE ***', 
                                                                                           '*** INVOICE ***')))                                                                                                                          
               ,(SELECT DECODE(A.DMDT_INV_STS_CD, 'C', '*** CREDIT NOTE('||TIT.CSTMZ_TIT_DESC||') ***', 
                                                       DECODE((SELECT SUBSTR(LOC_CD,0,2) 
                                                               FROM MDM_ORGANIZATION 
                                                               WHERE OFC_CD = A.CRE_OFC_CD), 'AU','*** TAX INVOICE('||TIT.CSTMZ_TIT_DESC||') ***', 
																							 'MY','*** TAX INVOICE('||TIT.CSTMZ_TIT_DESC||') ***',
																							 'IN','*** TAX INVOICE('||TIT.CSTMZ_TIT_DESC||') ***',
                                                                                                  '*** INVOICE('||TIT.CSTMZ_TIT_DESC||') ***'))      
                 FROM    DMT_CSTMZ_TIT_OPT TIT, DMT_CSTMZ_TIT_TRF_OPT TITTRF                          
                 WHERE   TIT.OFC_CD      = TITTRF.OFC_CD                                   
                 AND TIT.CR_TERM_SEQ     = TITTRF.CR_TERM_SEQ                                
                 AND TIT.OFC_CD          = A.CRE_OFC_CD                                    
                 AND TITTRF.DMDT_TRF_CD  = A.DMDT_TRF_CD                                 
                 AND TIT.DMDT_SH_TP_CD   = 'I'                                        
				)
			)                                                     
       ) AS INVOICE_TITLE                                                 
	 ,DECODE(A.DMDT_INV_STS_CD, 'X','Cancelled','C','Ref: '||A.CR_INV_NO, ' ') AS CANCEL_NOTE                               
     ,DECODE((SELECT REPLACE(DMDT_PAYR_ADDR,'@*',CHR(13)||CHR(10))                                                                                                                    
              FROM DMT_PAYR_INFO                                                                                                                                                   
              WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID                                                                                                                      
                                       FROM COM_SYS_AREA_GRP_ID                                                                                                                   
                                       WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                                
                                                       FROM MDM_ORGANIZATION                                                                                                      
                                                       WHERE OFC_CD = A.CRE_OFC_CD)                                                                                               
                                       AND CO_IND_CD = 'H')                                                                                                       
              AND CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                                 
              AND CUST_SEQ   = A.ACT_PAYR_SEQ)
             ,NULL
			 ,DECODE((SELECT COUNT(*)      
                      FROM MDM_CR_CUST                                                                                                                                                   
                      WHERE CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                             
                      AND CUST_SEQ   = A.ACT_PAYR_SEQ
					  AND TRIM(LOCL_ADDR1)||TRIM(LOCL_ADDR2)||TRIM(LOCL_ADDR3)||TRIM(LOCL_ADDR4) IS NOT NULL)
                     ,0
                     ,(SELECT CASE WHEN A.ACT_PAYR_CNT_CD = '00' THEN ( SELECT ZIP_CD||','||REPLACE(ENG_ADDR,'@*',CHR(13)||CHR(10))                                                       
                                                                        FROM MDM_VENDOR                                                                                                  
                                                                        WHERE VNDR_SEQ = A.ACT_PAYR_SEQ)                                                                                 
                              ELSE (SELECT CASE WHEN CN.BKG_ADDR_ORD_CD = 1 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.ZIP_CD                                            
                                                WHEN CN.BKG_ADDR_ORD_CD = 2 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM                                       
                                                WHEN CN.BKG_ADDR_ORD_CD = 3 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD                                    
                                                WHEN CN.BKG_ADDR_ORD_CD = 4 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.STE_CD||' '||ADDR.ZIP_CD                  
                                                WHEN CN.BKG_ADDR_ORD_CD = 5 THEN REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD                                    
                                                WHEN CN.BKG_ADDR_ORD_CD = 6 THEN ADDR.CTY_NM||' '||REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.ZIP_CD                                    
                                           ELSE REPLACE(ADDR.BZET_ADDR,'@*',CHR(13)||CHR(10))||' '||ADDR.CTY_NM||' '||ADDR.ZIP_CD                                                                                           
                                           END                                                                                                                                               
                                    FROM MDM_CUST_ADDR ADDR, MDM_COUNTRY CN                                                                                                                
                                    WHERE ADDR.CUST_CNT_CD = CN.CNT_CD(+)                                                                                                                  
                                    AND ADDR.CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                              
                                    AND ADDR.CUST_SEQ   = A.ACT_PAYR_SEQ
                                    AND ADDR.PRMRY_CHK_FLG = 'Y'
									AND ROWNUM = 1
                                    )                                                                                                                                                      
                             END                                                                                                                                                        
                      FROM DUAL)
                    ,(SELECT TRIM(LOCL_ADDR1)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR2)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR3)||CHR(13)||CHR(10)||TRIM(LOCL_ADDR4)||' '||LOCL_ZIP_CD AS ADDR     
                      FROM MDM_CR_CUST                                                                                                                                                 
                      WHERE CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                           
                      AND CUST_SEQ   = A.ACT_PAYR_SEQ))
             ,(SELECT REPLACE(DMDT_PAYR_ADDR,'@*',CHR(13)||CHR(10))                                                                                                                  
               FROM DMT_PAYR_INFO                                                                                                                                                   
               WHERE SYS_AREA_GRP_ID = (SELECT SYS_AREA_GRP_ID                                                                                                                      
                                        FROM COM_SYS_AREA_GRP_ID                                                                                                                   
                                        WHERE CNT_CD = (SELECT SUBSTR(LOC_CD, 1, 2)                                                                                                
                                                        FROM MDM_ORGANIZATION                                                                                                      
                                                        WHERE OFC_CD = A.CRE_OFC_CD)                                                                                               
                                        AND CO_IND_CD = 'H')                                                                                                       
               AND CUST_CNT_CD  = A.ACT_PAYR_CNT_CD                                                                                                                                 
               AND CUST_SEQ   = A.ACT_PAYR_SEQ)                                                                                                                                                                       
        ) AS PAYR_ADDR 
     ,B.SH_HD_N1ST_MSG AS SH_HD_N1ST_MSG                                       
     ,B.SH_HD_N2ND_MSG AS SH_HD_N2ND_MSG                                       
     ,B.SH_HD_N3RD_MSG AS SH_HD_N3RD_MSG                                       
     ,B.SH_HD_N4TH_MSG AS SH_HD_N4TH_MSG                                       
     ,B.SH_HD_N5TH_MSG AS SH_HD_N5TH_MSG                                       
     ,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD AS VVD_CD                                                                                                                      
     ,(SELECT VSL_ENG_NM FROM MDM_VSL_CNTR WHERE VSL_CD = A.VSL_CD) AS VSL_ENG_NM                                                                                         
     ,(SELECT TO_CHAR(VPS_ETA_DT,'YYYYMMDD') FROM VSK_VSL_PORT_SKD                                                                                                        
       WHERE VSL_CD = A.VSL_CD                                                                                                                                            
       AND SKD_VOY_NO = A.SKD_VOY_NO                                                                                                                                    
       AND SKD_DIR_CD = A.SKD_DIR_CD                                                                                                                                    
       AND VPS_PORT_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                       
                          ELSE A.POR_CD                                                                                                               
                          END)                                                                                                                        
       AND CLPT_IND_SEQ = 1                                                                                                                                             
       ) AS ARR                                                                                                                                                           
     ,(SELECT TO_CHAR(VPS_ETD_DT,'YYYYMMDD') FROM VSK_VSL_PORT_SKD                                                                                                        
       WHERE VSL_CD = A.VSL_CD                                                                                                                                            
       AND SKD_VOY_NO = A.SKD_VOY_NO                                                                                                                                    
       AND SKD_DIR_CD = A.SKD_DIR_CD                                                                                                                                    
       AND VPS_PORT_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                       
                          ELSE A.POR_CD                                                                                                              
                          END)                                                                                                                       
       AND CLPT_IND_SEQ = 1                                                                                                                                             
       ) AS DEP                                                                                                                                                           
     ,A.BL_NO AS BL_NO                                                 
     ,A.BKG_NO AS BKG_NO                                               
     ,(SELECT CMDT_CD FROM BKG_BOOKING
       WHERE BKG_NO = A.BKG_NO                                                                                                                                      
       ) AS CMDT_CD                                                                                                                                                        
     ,(SELECT CMDT_NM FROM MDM_COMMODITY                                                                                                                                  
       WHERE CMDT_CD = (SELECT CMDT_CD FROM BKG_BOOKING
                        WHERE BKG_NO = A.BKG_NO)
       ) AS CMDT_NM                                                                                                                    
      ,A.DMDT_TRF_CD AS DMDT_TRF_CD                                                                                                                                        
      ,(SELECT DMDT_TRF_NM FROM DMT_TRF_TP WHERE DMDT_TRF_CD = A.DMDT_TRF_CD) AS DMDT_TRF_NM                                                                               
      , A.BKG_RCV_TERM_CD
      , (SELECT INTG_CD_VAL_DP_DESC                                                                                                                                         
         FROM COM_INTG_CD_DTL                                                                                                                                               
         WHERE INTG_CD_VAL_CTNT = A.BKG_RCV_TERM_CD                                                   
           AND INTG_CD_ID = 'CD00764'                                                                                                                                       
        ) AS BKG_RCV_TERM_NM  
      , A.BKG_DE_TERM_CD
      , (SELECT INTG_CD_VAL_DP_DESC                                                                                                                                         
         FROM COM_INTG_CD_DTL                                                                                                                                               
         WHERE INTG_CD_VAL_CTNT = A.BKG_DE_TERM_CD                                                   
           AND INTG_CD_ID = 'CD00765'                                                                                                                                       
        ) AS BKG_DEL_TERM_NM  
      ,(CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                                            
        ELSE A.POR_CD                                                                                                                                                      
        END) AS POD                                                                                                                                                        
      ,(SELECT LOC_NM                                                                                                                                                      
        FROM MDM_LOCATION                                                                                                                                                  
        WHERE LOC_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.POD_CD                                                                                            
                        ELSE A.POR_CD                                                                                                                      
                        END)                                                                                                                               
        ) AS POD_NM                                                                                                                                                         
      ,(CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.DEL_CD                                                                                                            
        ELSE A.POL_CD                                                                                                                                                      
        END) AS DEL                                                                                                                                                        
      ,(SELECT LOC_NM                                                                                                                                                      
        FROM MDM_LOCATION                                                                                                                                                  
        WHERE LOC_CD = (CASE WHEN SUBSTR(A.DMDT_TRF_CD,3,1) = 'I' THEN A.DEL_CD                                                                                            
                        ELSE A.POL_CD                                                                                                                      
                        END)                                                                                                                               
       ) AS DEL_NM                                                                                                                                                        
      ,DECODE(A.VNDR_SEQ, 0, '', (SELECT VNDR_LGL_ENG_NM FROM MDM_VENDOR WHERE VNDR_SEQ = A.VNDR_SEQ)) AS TRUCKER_NM   
	  , (SELECT NVL(SUM(RT_OVR_CHG_AMT),0) FROM DMT_INV_RT RT WHERE RT.DMDT_INV_NO = A.DMDT_INV_NO) AS ORG_CHG_AMT
      ,A.CHG_CURR_CD AS ORG_CURR_CD                                       
      ,A.INV_XCH_RT  AS INV_XCH_RT                                            
      ,A.INV_CURR_CD AS INV_CURR_CD     
                                      
      , NVL(CASE WHEN A.INV_CURR_CD IN ( 'KRW','JPY' , 'BEF' ,'DJF' , 'ESP' ,'GRD' , 'ITL' ,'LAK' , 'MGF' ,'MRO' , 'MXP' ,'PTE' , 'SDD' ,'MXN' ) THEN
                      TRUNC( A.BIL_AMT*A.INV_XCH_RT, 0)
                 WHEN A.INV_CURR_CD IN ( 'TWD','IDR','VND' ) THEN
                      ROUND( A.BIL_AMT*A.INV_XCH_RT, 0)
                 ELSE
                      ROUND( A.BIL_AMT*A.INV_XCH_RT, 2)
                 END,0) AS TOT_AMT
      ,NVL(CASE WHEN A.INV_CURR_CD IN ( 'KRW','JPY' , 'BEF' ,'DJF' , 'ESP' ,'GRD' , 'ITL' ,'LAK' , 'MGF' ,'MRO' , 'MXP' ,'PTE' , 'SDD' ,'MXN' ) THEN
                     TRUNC( A.BIL_AMT*A.INV_XCH_RT, 0)
                WHEN A.INV_CURR_CD IN ( 'TWD','IDR','VND' ) THEN
                     ROUND( A.BIL_AMT*A.INV_XCH_RT, 0)
                ELSE
                     ROUND( A.BIL_AMT*A.INV_XCH_RT, 2)
                END,0) - NVL(A.INV_CHG_AMT,0) AS DC_AMT  
 
      ,NVL(A.INV_CHG_AMT,0) AS INV_CHG_AMT                                           
      ,A.TAX_RTO AS TAX_RTO                                               
      ,NVL(A.TAX_AMT,0) AS TAX_AMT                                               
      ,NVL(A.INV_AMT,0) AS INV_AMT                                               
      ,CASE WHEN INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10), 1, 1) = 0 THEN SUBSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10), -1, 1) + 1)   
       ELSE SUBSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), 0, INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10),1,1))                               
       END AS INV_RMK1                                                 
        ,CASE WHEN INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10), 1, 1) = 0 THEN '                          ' 
        ELSE SUBSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), INSTRB(REPLACE(A.INV_RMK,'@*',CHR(10)), chr(10),-1,1)+1)            
        END AS INV_RMK2                                                 
        , B.SH_RMK1  AS SH_RMK1                                              
        , B.SH_RMK2  AS SH_RMK2                                              
        , B.SH_RMK3  AS SH_RMK3                                              
        , B.SH_RMK4  AS SH_RMK4                                              
        , B.SH_RMK5  AS SH_RMK5                                              
        , B.SH_RMK6  AS SH_RMK6                                              
        , B.SH_RMK7  AS SH_RMK7                                              
        , B.SH_RMK8  AS SH_RMK8                                              
        , B.SH_RMK9  AS SH_RMK9                                              
        , B.SH_RMK10 AS SH_RMK10                                              
        , B.SH_RMK11 AS SH_RMK11                                              
        , B.SH_RMK12 AS SH_RMK12                                              
        , B.SH_RMK13 AS SH_RMK13                                              
        , B.SH_RMK14 AS SH_RMK14                                              
        , (SELECT TAX_AMT_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS TAX_AMT_PRN_FLG                                                                         
        , (DECODE((NVL(A.BIL_AMT,0) - NVL(A.INV_CHG_AMT,0)) , 0, 'N', (SELECT DC_AMT_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD))) AS DC_AMT_FLG                                                     
        , (SELECT CUST_REF_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS CUST_REF_PRN_FLG                                                                       
        , (SELECT CUST_VAT_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS CUST_VAT_PRN_FLG                                                                       
        , (SELECT PHN_FAX_PRN_FLG FROM DMT_OFC_SH_OPT WHERE OFC_CD = A.CRE_OFC_CD) AS PHN_FAX_PRN_FLG                                                                         
        , A.POD_CD
        , A.POR_CD
        , A.DEL_CD
        , A.POL_CD
		--// INDIA TAX  
        , A.IDA_EXPN_TAX_RT
        , A.IDA_EXPN_TAX   
        , A.IDA_EDU_TAX_RT
        , A.IDA_EDU_TAX    
        , A.IDA_HIGH_EDU_TAX_RT
        , A.IDA_HIGH_EDU_TAX
        , A.IDA_LOCL_TAX_RT
        , A.IDA_LOCL_TAX   
        , A.IDA_N2ND_LOCL_TAX_RT
		, A.IDA_N2ND_LOCL_TAX
		--// INDIA TAX  
		, A.IDA_CGST_RTO
		, A.IDA_CGST_AMT
		, A.IDA_SGST_RTO
		, A.IDA_SGST_AMT
		, A.IDA_IGST_RTO
		, A.IDA_IGST_AMT
		, A.IDA_UGST_RTO
		, A.IDA_UGST_AMT
		
  FROM  DMT_INV_MN 	A
       ,DMT_SH_SET 	B
	   
 WHERE  A.CRE_OFC_CD    = B.OFC_CD                                                                                                                                              
   AND  A.DMDT_TRF_CD   = B.DMDT_TRF_CD 
   AND  B.DMDT_SH_TP_CD = 'I'                                                                                                                                                  
   AND  A.DMDT_INV_NO   = @[invoice_no]                                                                                                                                                   
   AND  A.CRE_OFC_CD    = @[cre_ofc_cd]                                                                                                                                         
                                                           
#end			]]></sql>
			<params>
				<param name="invoice_no" type="12" value="" out="N"/>
				<param name="cre_ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
