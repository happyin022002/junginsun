<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UncollectedCargoDBDAOModifyMasterContainerUSQL">
			<desc><![CDATA[Uncollected Cargo 와 관련된 Master Container 를 Update 한다. ]]></desc>
			<sql><![CDATA[
UPDATE	MST_CONTAINER a
SET 
	    uclm_ls_div_cd = @[uclm_ls_div_cd]
	    , uclm_dt = TO_DATE(REPLACE(@[uclm_dt],'-',''),'YYYYMMDD')
		#if (${type} == 'REOPEN')
	      	, uc_rsn_cd =	(	SELECT  d.uc_rsn_cd
	        					FROM	CIM_UC_CGO_DTL D, CIM_UC_CGO_CNTR C
	        					WHERE	1 = 1
                                        AND c.cntr_no = a.cntr_no
                                        AND d.uc_cs_no = c.uc_cs_no
                                        AND d.bl_no = c.bl_no )
            , uclm_rsn =    (   SELECT  (   SELECT	INTG_CD_VAL_DP_DESC
                                            FROM	COM_INTG_CD_DTL
                                            WHERE	INTG_CD_ID = 'CD03293' AND INTG_CD_VAL_CTNT = d.uc_rsn_cd)
                                 FROM	CIM_UC_CGO_DTL D, CIM_UC_CGO_CNTR C
                                 WHERE	1 = 1
                                        AND c.cntr_no = a.cntr_no
                                        AND d.uc_cs_no = c.uc_cs_no
                                        AND d.bl_no = c.bl_no ) 
		#else
			, uclm_rsn = @[uclm_rsn] 
			, uc_rsn_cd = @[uc_rsn_cd]
		#end 

	    , uclm_end_dt = TO_DATE(REPLACE(@[uclm_end_dt],'-',''),'YYYYMMDD')
		, upd_dt = SYSDATE
		, upd_usr_id = @[temp1]
WHERE 	
		1 = 1

		#if (${type} == 'OLD')
			AND cntr_no IN (
	        					SELECT  cntr_no 	
	        					FROM	CIM_UC_CGO_CNTR
	        					WHERE	1 = 1
	                					AND uc_cs_no = @[uc_cs_no]
	                					AND bl_no = @[bl_no]
	        				)
		#end
		#if (${type} == 'NEW')
	    	AND cntr_no = @[cntr_no]
		#end
		#if (${type} == 'ALL' || ${type} == 'REOPEN')
			AND cntr_no IN (
	        					SELECT  cntr_no 	
	        					FROM	CIM_UC_CGO_CNTR
	        					WHERE	1 = 1
	                					AND uc_cs_no = @[uc_cs_no]
	        				)
		#end			]]></sql>
			<params>
				<param name="uclm_ls_div_cd" type="12" value="" out="N"/>
				<param name="uclm_dt" type="12" value="" out="N"/>
				<param name="uclm_rsn" type="12" value="" out="N"/>
				<param name="uc_rsn_cd" type="12" value="" out="N"/>
				<param name="uclm_end_dt" type="12" value="" out="N"/>
				<param name="temp1" type="12" value="" out="N"/>
				<param name="uc_cs_no" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
