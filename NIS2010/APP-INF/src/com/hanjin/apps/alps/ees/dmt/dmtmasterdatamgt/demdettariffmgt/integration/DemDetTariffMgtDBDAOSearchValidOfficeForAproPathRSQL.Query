<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DemDetTariffMgtDBDAOSearchValidOfficeForAproPathRSQL">
			<desc><![CDATA[DemDetTariffMgtDBDAOSearchValidOfficeForAproPathRSQL]]></desc>
			<sql><![CDATA[
select  case 
			when @[srch_apro_path_cd] = 'HDO' then (
                                        select  case when count(1) > 0 then 'Y' else 'N' end
                                          from  MDM_ORGANIZATION
                                         where  OFC_TP_CD in ('HT')
                                           and  DELT_FLG = 'N'
                                           and  OFC_CD = @[srch_apro_ofc_cd]
                                     )
			when @[srch_apro_path_cd] = 'V.P' then (
                                        select  case when count(1) > 0 then 'Y' else 'N' end
                                          from  (
                                                    select  OFC_CD
                                                      from  COM_USER
                                                     where  PSN_ENG_NM = 'Managing Director(RHQ)'
                                                       and  USE_FLG ='Y'
                                                    
                                                    union all
                                                    
                                                    select  decode(OFC_CD,'SELSC','SELIB','TYOSC','TYOIB','VVOBA','VVOIA','') as OFC_CD
                                                      from  COM_USER
                                                     where  PSN_ENG_NM IN ('Branch Manager','Branch MGR')
                                                       and  USE_FLG ='Y'  
                                                       and  OFC_CD IN ('SELSC', 'TYOSC', 'VVOBA')                                                       
                                                )
                                         where  OFC_CD = @[srch_apro_ofc_cd]
                                    )

			when @[srch_apro_path_cd] = 'BBG' then (
										select  case when count(1) > 0 then 'Y' else 'N' end
										  from  (  
													select  OFC_CD 
													  from  COM_USER 
													 where  PSN_ENG_NM = 'Country Manager' 
													   and  substr(OFC_CD, 4, 2) = 'BB' 
													   and  USE_FLG = 'Y' 
															
													union all
														 
													select  OFC_CD 
													  from  COM_USER 
													 where  PSN_ENG_NM = 'Branch MGR' 
													   and  USE_FLG = 'Y'			 
													   and  ( 
																OFC_CD in ('SELSC','TYOSC','VVOIA')  
															 or OFC_CD in  
																( 
																	select  OFC_CD 
																	  from  MDM_ORGANIZATION  
																	 where  REP_CUST_CNT_CD IN ('CN','US')   
																	   and  OFC_TP_CD = 'BB' 
                                                                       and  DELT_FLG = 'N'
																) 
															) 										  
												)
										 where  OFC_CD = @[srch_apro_ofc_cd]
									)
		else 'N'
		end		
  from  dual			]]></sql>
			<params>
				<param name="srch_apro_path_cd" type="12" value="1" out="N"/>
				<param name="srch_apro_ofc_cd" type="12" value="1" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
