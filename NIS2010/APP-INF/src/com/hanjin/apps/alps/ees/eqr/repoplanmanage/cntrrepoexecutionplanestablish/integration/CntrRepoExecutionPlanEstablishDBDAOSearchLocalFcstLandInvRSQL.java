/*=========================================================
*Copyright(c) 2010 CyberLogitec
*@FileName : CntrRepoExecutionPlanEstablishDBDAOSearchLocalFcstLandInvRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2010.04.29
*@LastModifier : 
*@LastVersion : 1.0
* 2010.04.29 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.ees.eqr.repoplanmanage.cntrrepoexecutionplanestablish.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class CntrRepoExecutionPlanEstablishDBDAOSearchLocalFcstLandInvRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * EES_EQR_0112
	  * 
	  * 
	  * 
	  * //////////////////////////////////////////////////////////////////////////////////
	  * //이하 SQL 생성부분이 실제로 트리를 구성한다.
	  * //XX 가 업무로직을 구현한 SQL : initialStr, outFlowStr, inFlowStr, safetyStr, etcStr
	  * //YY 가 TREE를 만들기 위한 SQL
	  * //INFLOW, OUTFLOW 를 구성하기 위해서 동일한 SQL이 3번 반복된다.
	  * //DB의 NLS_LANGUAGE 가 AMERICA 로 된후 요일을 영문으로 바꿔줘야 한다.
	  * //////////////////////////////////////////////////////////////////////////////////
	  * </pre>
	  */
	public CntrRepoExecutionPlanEstablishDBDAOSearchLocalFcstLandInvRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fm_plnyrwk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_plnyrwk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("repo_pln_id",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.ees.eqr.repoplanmanage.cntrrepoexecutionplanestablish.integration").append("\n"); 
		query.append("FileName : CntrRepoExecutionPlanEstablishDBDAOSearchLocalFcstLandInvRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT	 YY.ECC_CD" ).append("\n"); 
		query.append(",YY.PLN_YRWK" ).append("\n"); 
		query.append(",DECODE(SUBSTR(YY.ITEM,1,1)," ).append("\n"); 
		query.append("'0','('|| (SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD') ,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM	EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE PLN_YR||PLN_WK  = YY.PLN_YRWK) ||')'," ).append("\n"); 
		query.append("'6','('|| (SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD') ,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE PLN_YR||PLN_WK  = YY.PLN_YRWK) ||')'," ).append("\n"); 
		query.append("'7',' '," ).append("\n"); 
		query.append("'8',' '," ).append("\n"); 
		query.append("'9',' ',YY.FLOW) FLOW" ).append("\n"); 
		query.append(",SUBSTR(YY.ITEM,3) ITEM" ).append("\n"); 
		query.append(",'' TOTAL" ).append("\n"); 
		query.append(",DECODE(SUBSTR(YY.ITEM,1,1),'3',1,'5',1,0) LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("-- Initial(EQR_INVT_SNAP)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'00Initial' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = E.ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE SNAP_DT BETWEEN WK_ST_DT  AND WK_END_DT) PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_INVT_SNAP PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	SNAP_DT = (SELECT WK_ST_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY SNAP_DT, PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM, REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Demand(EQR_OB_FCAST)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'10Demand Vol' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 @[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",FCAST_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(",FM_ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ecc_cd FROM eqr_ecc_mst WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id] 	)" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND	(PLN.FM_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND	FCAST_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY FCAST_YRWK, fm_ecc_cd, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY FCAST_YRWK" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- RepoOut : EQR_VSL_LODG_DCHG_PLN, EQR_INLND_TRSP_PLN(FM_ECC_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'20Repo Out' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("-- EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",PLN.FM_ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(",EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ecc_cd FROM eqr_ecc_mst WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID		= @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vvd} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_CD||PLN.SKD_VOY_NO||PLN.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (PLN.FM_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",PLN.FM_ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(",EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID	= @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( (${item} != '' && ${lane} != '' ) || (${item} != '' && ${vvd} != '') )" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (PLN.FM_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND	PLN.FM_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Excution(RepoOut) : EQR_VSL_LODG_DCHG_EXE_PLN(FM_YD_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'30Execution' ITEM" ).append("\n"); 
		query.append(",'1' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("-- EQR_VSL_LODG_DCHG_EXE_PLN" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(FM_YD_CD,0,5)) AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_VSL_LODG_DCHG_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_VSL_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND	${type} IN ( ${eccText} ) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK    = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ    = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vvd} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_CD||PLN.SKD_VOY_NO||PLN.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND	(SUBSTR(PLN.FM_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk] )" ).append("\n"); 
		query.append("AND	(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- EQR_INLND_TRSP_EXE_PLN" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(FM_YD_CD,0,5)) AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_INLND_TRSP_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_INLND_TRSP_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND	${type} IN ( ${eccText} ) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if ( (${item} != '' && ${lane} != '' ) || (${item} != '' && ${vvd} != '') )" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND	(SUBSTR(PLN.FM_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("AND	(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Off-Hire : EQR_ONF_HIR_PLN(ONF_HIR_DIV_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'40Off-Hire' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY )) ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(",EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND	PLN.ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("-- item  : F(조회조건을 선택시)" ).append("\n"); 
		query.append("#if (${itemOffExist} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif ( ${item} != '' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- 	Excution(Off-Hire) : EQR_ONF_HIR_EXE_PLN(ONF_HIR_DIV_CD, FM_YD_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'50Execution' ITEM" ).append("\n"); 
		query.append(",'1' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY )) ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",FM_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(FM_YD_CD,0,5)) FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_ONF_HIR_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_ONF_HIR_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND ${type} IN ( ${eccText} ) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("-- item  : F(조회조건을 선택시)" ).append("\n"); 
		query.append("#if (${itemOffExist} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif ( ${item} != '' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.FM_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN_YRWK, FM_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- 	I/B Generation : EQR_IB_BKG_FCAST(TO_ECC_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'11I/B Generation' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD, CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   @[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",FCAST_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(",TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_IB_BKG_FCAST PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id]	)" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY FCAST_YRWK, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY FCAST_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append("-- 20070602  (황영신 수석님 추가 요청 반영)" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   @[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",fcast_del_yrwk AS PLN_YRWK" ).append("\n"); 
		query.append(",TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id] 	)" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND fcast_del_yrwk BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY fcast_del_yrwk, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY fcast_del_yrwk DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append("-- 20070602  (황영신 수석님 추가 요청 반영) 추가 끝" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- RepoIn : EQR_VSL_LODG_DCHG_PLN, EQR_INLND_TRSP_PLN(TO_ECC_CD)" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'22Repo In' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("--EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(PLN.TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT) AS PLN_YRWK" ).append("\n"); 
		query.append(",PLN.TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM     EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(",EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vvd} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_CD||PLN.SKD_VOY_NO||PLN.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk]  )" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.TO_ETB_DT, PLN.TO_ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("--EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.TO_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(",PLN.TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(",EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( (${item} != '' && ${lane} != '' ) || (${item} != '' && ${vvd} != '') )" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.TO_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.TO_YRWK, PLN.TO_ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Excution(RepoIn) : EQR_VSL_LODG_DCHG_EXE_PLN(TO_YD_CD)" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'33Execution' ITEM" ).append("\n"); 
		query.append(",'1' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT) AS PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(TO_YD_CD,0,5)) AS TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM     EQR_VSL_LODG_DCHG_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_VSL_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1	AND ${type} IN ( ${eccText}) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vvd} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_CD||PLN.SKD_VOY_NO||PLN.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '' )" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.TO_YD_CD,0,5) = c.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.TO_ETB_DT, PLN.TO_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT) AS PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(TO_YD_CD,0,5)) AS TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_INLND_TRSP_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_INLND_TRSP_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND ${type} IN ( ${eccText} ) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( (${item} != '' && ${lane} != '' ) || (${item} != '' && ${vvd} != '') )" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.TO_YD_CD,0,5) = c.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.TO_ETA_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.TO_ETA_DT, PLN.TO_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Off-Hire: EQR_ONF_HIR_PLN(ONF_HIR_DIV_CD)" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'44On-Hire' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD, CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM     EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(",EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND PLN.ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("--item  : O(조회조건을 선택시)" ).append("\n"); 
		query.append("#if (${itemOnExist} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif ( ${item} != '' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Excution(Off-Hire) : EQR_ONF_HIR_EXE_PLN(ONF_HIR_DIV_CD, TO_YD_CD)" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'55Execution' ITEM" ).append("\n"); 
		query.append(",'1' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(TO_YD_CD,0,5)) TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM     EQR_ONF_HIR_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_ONF_HIR_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND ${type} IN ( ${eccText} ) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("--item  : O(조회조건을 선택시)" ).append("\n"); 
		query.append("#if (${itemOnExist} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif ( ${item} != '' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.TO_YD_CD,0,5) = c.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.TO_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN_YRWK, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Safety Stock" ).append("\n"); 
		query.append("SELECT   TO_CHAR(BB.PLN_YRWK) PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'88Safety Stock' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(", ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'88Safety Stock' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   @[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",'' PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(SFSTK_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_SCNR_ECC_SFT_STK PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id] )" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY ECC_CD, REPO_PLN_ID" ).append("\n"); 
		query.append(")aa," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT  PLN_YR||PLN_WK AS PLN_YRWK" ).append("\n"); 
		query.append("FROM    EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE	PLN_YR||PLN_WK	BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append(") bb" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- ETC : EQR_ADD_PLN" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'66+/- ETC' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_ADD_PLN PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = c.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN_YRWK, PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append(") XX," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' FLOW" ).append("\n"); 
		query.append(",ITEM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 DISTINCT PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("-- Initial(EQR_INVT_SNAP)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'00Initial' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = E.ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE SNAP_DT BETWEEN WK_ST_DT  AND WK_END_DT) PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_INVT_SNAP PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	SNAP_DT = (SELECT WK_ST_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY SNAP_DT, PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM, REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Demand(EQR_OB_FCAST)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'10Demand Vol' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 @[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",FCAST_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(",FM_ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ecc_cd FROM eqr_ecc_mst WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id] 	)" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND	(PLN.FM_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND	FCAST_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY FCAST_YRWK, fm_ecc_cd, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY FCAST_YRWK" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- RepoOut : EQR_VSL_LODG_DCHG_PLN, EQR_INLND_TRSP_PLN(FM_ECC_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'20Repo Out' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("-- EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",PLN.FM_ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(",EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ecc_cd FROM eqr_ecc_mst WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID		= @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vvd} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_CD||PLN.SKD_VOY_NO||PLN.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (PLN.FM_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",PLN.FM_ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(",EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID	= @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( (${item} != '' && ${lane} != '' ) || (${item} != '' && ${vvd} != '') )" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (PLN.FM_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND	PLN.FM_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Excution(RepoOut) : EQR_VSL_LODG_DCHG_EXE_PLN(FM_YD_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'30Execution' ITEM" ).append("\n"); 
		query.append(",'1' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("-- EQR_VSL_LODG_DCHG_EXE_PLN" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(FM_YD_CD,0,5)) AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_VSL_LODG_DCHG_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_VSL_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND	${type} IN ( ${eccText} ) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK    = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ    = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vvd} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_CD||PLN.SKD_VOY_NO||PLN.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND	(SUBSTR(PLN.FM_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk] )" ).append("\n"); 
		query.append("AND	(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- EQR_INLND_TRSP_EXE_PLN" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(FM_YD_CD,0,5)) AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_INLND_TRSP_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_INLND_TRSP_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND	${type} IN ( ${eccText} ) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if ( (${item} != '' && ${lane} != '' ) || (${item} != '' && ${vvd} != '') )" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND	(SUBSTR(PLN.FM_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("AND	(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Off-Hire : EQR_ONF_HIR_PLN(ONF_HIR_DIV_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'40Off-Hire' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY )) ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(",EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND	PLN.ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("-- item  : F(조회조건을 선택시)" ).append("\n"); 
		query.append("#if (${itemOffExist} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif ( ${item} != '' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- 	Excution(Off-Hire) : EQR_ONF_HIR_EXE_PLN(ONF_HIR_DIV_CD, FM_YD_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'50Execution' ITEM" ).append("\n"); 
		query.append(",'1' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY )) ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",FM_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(FM_YD_CD,0,5)) FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_ONF_HIR_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_ONF_HIR_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND ${type} IN ( ${eccText} ) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("-- item  : F(조회조건을 선택시)" ).append("\n"); 
		query.append("#if (${itemOffExist} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif ( ${item} != '' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.FM_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN_YRWK, FM_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- 	I/B Generation : EQR_IB_BKG_FCAST(TO_ECC_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'11I/B Generation' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD, CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   @[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",FCAST_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(",TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_IB_BKG_FCAST PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id]	)" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY FCAST_YRWK, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY FCAST_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append("-- 20070602  (황영신 수석님 추가 요청 반영)" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   @[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",fcast_del_yrwk AS PLN_YRWK" ).append("\n"); 
		query.append(",TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id] 	)" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND fcast_del_yrwk BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY fcast_del_yrwk, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY fcast_del_yrwk DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append("-- 20070602  (황영신 수석님 추가 요청 반영) 추가 끝" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- RepoIn : EQR_VSL_LODG_DCHG_PLN, EQR_INLND_TRSP_PLN(TO_ECC_CD)" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'22Repo In' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("--EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(PLN.TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT) AS PLN_YRWK" ).append("\n"); 
		query.append(",PLN.TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM     EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(",EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vvd} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_CD||PLN.SKD_VOY_NO||PLN.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk]  )" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.TO_ETB_DT, PLN.TO_ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("--EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.TO_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(",PLN.TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(",EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( (${item} != '' && ${lane} != '' ) || (${item} != '' && ${vvd} != '') )" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.TO_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.TO_YRWK, PLN.TO_ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Excution(RepoIn) : EQR_VSL_LODG_DCHG_EXE_PLN(TO_YD_CD)" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'33Execution' ITEM" ).append("\n"); 
		query.append(",'1' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT) AS PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(TO_YD_CD,0,5)) AS TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM     EQR_VSL_LODG_DCHG_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_VSL_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1	AND ${type} IN ( ${eccText}) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vvd} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_CD||PLN.SKD_VOY_NO||PLN.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '' )" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.TO_YD_CD,0,5) = c.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.TO_ETB_DT, PLN.TO_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT) AS PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(TO_YD_CD,0,5)) AS TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_INLND_TRSP_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_INLND_TRSP_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND ${type} IN ( ${eccText} ) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( (${item} != '' && ${lane} != '' ) || (${item} != '' && ${vvd} != '') )" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.TO_YD_CD,0,5) = c.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.TO_ETA_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.TO_ETA_DT, PLN.TO_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Off-Hire: EQR_ONF_HIR_PLN(ONF_HIR_DIV_CD)" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'44On-Hire' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD, CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM     EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(",EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND PLN.ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("--item  : O(조회조건을 선택시)" ).append("\n"); 
		query.append("#if (${itemOnExist} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif ( ${item} != '' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Excution(Off-Hire) : EQR_ONF_HIR_EXE_PLN(ONF_HIR_DIV_CD, TO_YD_CD)" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'55Execution' ITEM" ).append("\n"); 
		query.append(",'1' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(TO_YD_CD,0,5)) TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM     EQR_ONF_HIR_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_ONF_HIR_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND ${type} IN ( ${eccText} ) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("--item  : O(조회조건을 선택시)" ).append("\n"); 
		query.append("#if (${itemOnExist} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif ( ${item} != '' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.TO_YD_CD,0,5) = c.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.TO_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN_YRWK, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Safety Stock" ).append("\n"); 
		query.append("SELECT   TO_CHAR(BB.PLN_YRWK) PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'88Safety Stock' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(", ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'88Safety Stock' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   @[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",'' PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(SFSTK_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_SCNR_ECC_SFT_STK PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id] )" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY ECC_CD, REPO_PLN_ID" ).append("\n"); 
		query.append(")aa," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT  PLN_YR||PLN_WK AS PLN_YRWK" ).append("\n"); 
		query.append("FROM    EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE	PLN_YR||PLN_WK	BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append(") bb" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- ETC : EQR_ADD_PLN" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'66+/- ETC' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_ADD_PLN PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = c.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN_YRWK, PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(") X," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT	'11I/B Generation'	item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'22Repo In'			item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'33Execution'		item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'44On-Hire'			item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'55Execution'		item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'66+/- ETC'			item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'77Balance'			item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'88Safety Stock'	item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'99* Variance'		item FROM DUAL" ).append("\n"); 
		query.append(") Y" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' FLOW" ).append("\n"); 
		query.append(",ITEM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 DISTINCT PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("-- Initial(EQR_INVT_SNAP)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'00Initial' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = E.ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE SNAP_DT BETWEEN WK_ST_DT  AND WK_END_DT) PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_INVT_SNAP PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	SNAP_DT = (SELECT WK_ST_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY SNAP_DT, PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM, REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Demand(EQR_OB_FCAST)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'10Demand Vol' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 @[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",FCAST_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(",FM_ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ecc_cd FROM eqr_ecc_mst WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id] 	)" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND	(PLN.FM_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND	FCAST_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY FCAST_YRWK, fm_ecc_cd, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY FCAST_YRWK" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- RepoOut : EQR_VSL_LODG_DCHG_PLN, EQR_INLND_TRSP_PLN(FM_ECC_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'20Repo Out' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("-- EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",PLN.FM_ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(",EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ecc_cd FROM eqr_ecc_mst WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID		= @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vvd} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_CD||PLN.SKD_VOY_NO||PLN.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (PLN.FM_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",PLN.FM_ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(",EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID	= @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( (${item} != '' && ${lane} != '' ) || (${item} != '' && ${vvd} != '') )" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (PLN.FM_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND	PLN.FM_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Excution(RepoOut) : EQR_VSL_LODG_DCHG_EXE_PLN(FM_YD_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'30Execution' ITEM" ).append("\n"); 
		query.append(",'1' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("-- EQR_VSL_LODG_DCHG_EXE_PLN" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(FM_YD_CD,0,5)) AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_VSL_LODG_DCHG_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_VSL_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND	${type} IN ( ${eccText} ) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK    = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ    = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vvd} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_CD||PLN.SKD_VOY_NO||PLN.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND	(SUBSTR(PLN.FM_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk] )" ).append("\n"); 
		query.append("AND	(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- EQR_INLND_TRSP_EXE_PLN" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(FM_YD_CD,0,5)) AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_INLND_TRSP_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_INLND_TRSP_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND	${type} IN ( ${eccText} ) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if ( (${item} != '' && ${lane} != '' ) || (${item} != '' && ${vvd} != '') )" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND	(SUBSTR(PLN.FM_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("AND	(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Off-Hire : EQR_ONF_HIR_PLN(ONF_HIR_DIV_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'40Off-Hire' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY )) ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(",EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND	PLN.ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("-- item  : F(조회조건을 선택시)" ).append("\n"); 
		query.append("#if (${itemOffExist} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif ( ${item} != '' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- 	Excution(Off-Hire) : EQR_ONF_HIR_EXE_PLN(ONF_HIR_DIV_CD, FM_YD_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(",'50Execution' ITEM" ).append("\n"); 
		query.append(",'1' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY )) ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",FM_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("SELECT	 PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(FM_YD_CD,0,5)) FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM	EQR_ONF_HIR_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_ONF_HIR_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND ${type} IN ( ${eccText} ) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("-- item  : F(조회조건을 선택시)" ).append("\n"); 
		query.append("#if (${itemOffExist} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif ( ${item} != '' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '')" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.FM_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.FM_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN_YRWK, FM_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- 	I/B Generation : EQR_IB_BKG_FCAST(TO_ECC_CD)" ).append("\n"); 
		query.append("SELECT	 PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'11I/B Generation' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD, CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   @[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",FCAST_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(",TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_IB_BKG_FCAST PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id]	)" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY FCAST_YRWK, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY FCAST_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append("-- 20070602  (황영신 수석님 추가 요청 반영)" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   @[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",fcast_del_yrwk AS PLN_YRWK" ).append("\n"); 
		query.append(",TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id] 	)" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND fcast_del_yrwk BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY fcast_del_yrwk, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY fcast_del_yrwk DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append("-- 20070602  (황영신 수석님 추가 요청 반영) 추가 끝" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- RepoIn : EQR_VSL_LODG_DCHG_PLN, EQR_INLND_TRSP_PLN(TO_ECC_CD)" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'22Repo In' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("--EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(PLN.TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT) AS PLN_YRWK" ).append("\n"); 
		query.append(",PLN.TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM     EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(",EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vvd} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_CD||PLN.SKD_VOY_NO||PLN.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk]  )" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.TO_ETB_DT, PLN.TO_ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("--EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.TO_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(",PLN.TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(",EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( (${item} != '' && ${lane} != '' ) || (${item} != '' && ${vvd} != '') )" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.TO_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.TO_YRWK, PLN.TO_ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Excution(RepoIn) : EQR_VSL_LODG_DCHG_EXE_PLN(TO_YD_CD)" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'33Execution' ITEM" ).append("\n"); 
		query.append(",'1' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT) AS PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(TO_YD_CD,0,5)) AS TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM     EQR_VSL_LODG_DCHG_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_VSL_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1	AND ${type} IN ( ${eccText}) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${lane} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${vvd} != '' )" ).append("\n"); 
		query.append("AND PLN.VSL_CD||PLN.SKD_VOY_NO||PLN.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '' )" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.TO_YD_CD,0,5) = c.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.TO_ETB_DT, PLN.TO_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT) AS PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(TO_YD_CD,0,5)) AS TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_INLND_TRSP_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_INLND_TRSP_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND ${type} IN ( ${eccText} ) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE	PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if (${item} != '' )" ).append("\n"); 
		query.append("AND	PLN.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( (${item} != '' && ${lane} != '' ) || (${item} != '' && ${vvd} != '') )" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.TO_YD_CD,0,5) = c.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(PLN.TO_ETA_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.TO_ETA_DT, PLN.TO_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Off-Hire: EQR_ONF_HIR_PLN(ONF_HIR_DIV_CD)" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'44On-Hire' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD, CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM     EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(",EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND PLN.ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("--item  : O(조회조건을 선택시)" ).append("\n"); 
		query.append("#if (${itemOnExist} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif ( ${item} != '' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.ECC_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Excution(Off-Hire) : EQR_ONF_HIR_EXE_PLN(ONF_HIR_DIV_CD, TO_YD_CD)" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'55Execution' ITEM" ).append("\n"); 
		query.append(",'1' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN.PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(TO_YD_CD,0,5)) TO_ECC_CD" ).append("\n"); 
		query.append(",QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(QTY.CNTR_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM     EQR_ONF_HIR_EXE_PLN PLN" ).append("\n"); 
		query.append(",EQR_ONF_HIR_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND ${type} IN ( ${eccText} ) ) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   PLN.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND	PLN.PLN_YRWK	= QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("AND	PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("--item  : O(조회조건을 선택시)" ).append("\n"); 
		query.append("#if (${itemOnExist} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif ( ${item} != '' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.TO_YD_CD,0,5) = c.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("#if ( ${inclExecPlan} == '0' )" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.TO_YD_CD, QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN_YRWK, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- Safety Stock" ).append("\n"); 
		query.append("SELECT   TO_CHAR(BB.PLN_YRWK) PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'88Safety Stock' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(", ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'88Safety Stock' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = TO_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   @[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",'' PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(SFSTK_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_SCNR_ECC_SFT_STK PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id] )" ).append("\n"); 
		query.append("#if (${item} != '' || ${lane} != '' || ${vvd} != '')" ).append("\n"); 
		query.append("AND	1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY ECC_CD, REPO_PLN_ID" ).append("\n"); 
		query.append(")aa," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT  PLN_YR||PLN_WK AS PLN_YRWK" ).append("\n"); 
		query.append("FROM    EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE	PLN_YR||PLN_WK	BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append(") bb" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- ETC : EQR_ADD_PLN" ).append("\n"); 
		query.append("SELECT   PLN_YRWK" ).append("\n"); 
		query.append(",ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(",'66+/- ETC' ITEM" ).append("\n"); 
		query.append(",'0' LVL" ).append("\n"); 
		query.append("#foreach( $key in ${arrtpsz})" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD, '$key' , CNTR_QTY ))  ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",(SELECT ${typeByStr} FROM EQR_ECC_MST WHERE ECC_CD = FM_ECC_CD) ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("SELECT   REPO_PLN_ID" ).append("\n"); 
		query.append(",PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(",CNTR_TPSZ_CD" ).append("\n"); 
		query.append(",SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM    EQR_ADD_PLN PLN" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND ${type} IN ( ${eccText}) )C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE   REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("#if ( ${type} != '' )" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = c.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd} != '')" ).append("\n"); 
		query.append("AND	CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN_YRWK, PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(") X," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT	'00Initial'		item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'10Demand Vol'	item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'20Repo Out'	item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'30Execution'	item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'40Off-Hire'	item FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT	'50Execution'	item FROM DUAL" ).append("\n"); 
		query.append(") Y" ).append("\n"); 
		query.append(") YY" ).append("\n"); 
		query.append("WHERE   XX.PLN_YRWK (+)	= YY.PLN_YRWK" ).append("\n"); 
		query.append("AND XX.ECC_CD (+)	= YY.ECC_CD" ).append("\n"); 
		query.append("AND XX.FLOW (+)	    = YY.FLOW" ).append("\n"); 
		query.append("AND XX.item (+)	    = YY.ITEM" ).append("\n"); 
		query.append("ORDER BY  ECC_CD, PLN_YRWK,  YY.FLOW  DESC, YY.ITEM" ).append("\n"); 

	}
}