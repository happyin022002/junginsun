<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CntrForecastPrecisionManageDBDAOSearchWeekBefore4WkRSQL">
			<desc><![CDATA[<EES_EQR_0037 컨테이너 수급 예측실적 및 정확도 조회>
EQR_WK_PRD 데이터 조회 (4주전)

<Change History>
1	2009.10.15	Lee ByoungHun	최초작성
2	2010.01.21	Lee ByoungHun	연도가 넘어가는 경우 에러 수정 (YYYYIW -> IYYYIW)]]></desc>
			<sql><![CDATA[
SELECT 
    YRWK_BEF
    , YRWK_CUR 
FROM
(
    SELECT 
        PLN_YR||PLN_WK YRWK_BEF
        , ROWNUM RNUM
    FROM 
        EQR_WK_PRD
    WHERE 
        PLN_YR||PLN_WK BETWEEN
        (
            SELECT 
                TO_CHAR(TO_DATE(
                (
                    SELECT WK_END_DT
                    FROM EQR_WK_PRD
                    WHERE PLN_YR||PLN_WK = @[fmPlnYrWk]
                ), 'YYYYMMDD')-3*7, 'IYYYIW')YRWK
            FROM DUAL
        )
        AND
        (
            SELECT 
                TO_CHAR(TO_DATE(
                (
                    SELECT WK_END_DT
                    FROM EQR_WK_PRD
                    WHERE PLN_YR||PLN_WK = @[toPlnYrWk]
                ), 'YYYYMMDD')-3*7, 'IYYYIW')YRWK
            FROM DUAL
        )
    ORDER BY 
        PLN_YR||PLN_WK
) A,
(
    SELECT 
        PLN_YR||PLN_WK YRWK_CUR 
        , ROWNUM RNUM
    FROM 
        EQR_WK_PRD
    WHERE 
        PLN_YR||PLN_WK BETWEEN  @[fmPlnYrWk] AND @[toPlnYrWk]
    ORDER BY 
        PLN_YR||PLN_WK
) B
WHERE A.RNUM = B.RNUM			]]></sql>
			<params>
				<param name="fmPlnYrWk" type="12" value="" out="N"/>
				<param name="toPlnYrWk" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
