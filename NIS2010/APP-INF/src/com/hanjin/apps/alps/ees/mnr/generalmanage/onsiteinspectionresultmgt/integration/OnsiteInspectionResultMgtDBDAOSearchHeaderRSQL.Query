<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="OnsiteInspectionResultMgtDBDAOSearchHeaderRSQL">
			<desc><![CDATA[M&R Onsite Inspection Result Inquiry 화면에 출력될 Header 결과값들을 조회]]></desc>
			<sql><![CDATA[
SELECT A.VNDR_SEQ,
       (SELECT VNDR_LGL_ENG_NM
          FROM MDM_VENDOR
         WHERE VNDR_SEQ = A.VNDR_SEQ) VNDR_NM,
       A.YD_CD,
       TO_CHAR(A.FLD_INSP_DT, 'YYYY-MM-DD') FLD_INSP_DT,
       A.INSP_OFC_CD,
       A.UPD_USR_ID,
       A.BRNC_INSP_FLG,
       A.HDBRN_INSP_FLG
  FROM MNR_ONSITE_INSP_RSLT A
 WHERE 1=1
   AND (A.BRNC_INSP_FLG = 'Y' OR A.HDBRN_INSP_FLG = 'Y')
#if(${vndr_seq} != '')
   AND A.VNDR_SEQ = @[vndr_seq] 
#end  
#if(${rhq_ofc_cd} != '')
#if(${insp_ofc_cd} != '')
   AND A.INSP_OFC_CD IN
						(SELECT DISTINCT OFC_CD
    		              FROM MDM_ORGANIZATION A
            		     WHERE A.DELT_FLG != 'Y' START WITH A.OFC_CD = @[insp_ofc_cd] CONNECT BY PRIOR A.OFC_CD = A.PRNT_OFC_CD )
#else
   AND A.INSP_OFC_CD IN (SELECT OFC_CD FROM MDM_ORGANIZATION WHERE AR_HD_QTR_OFC_CD IN (SUBSTR(@[rhq_ofc_cd],1, 5)))
#end
#else
#if(${insp_ofc_cd} != '')
   AND A.INSP_OFC_CD IN
						(SELECT DISTINCT OFC_CD
    		              FROM MDM_ORGANIZATION A
            		     WHERE A.DELT_FLG != 'Y' START WITH A.OFC_CD = @[insp_ofc_cd] CONNECT BY PRIOR A.OFC_CD = A.PRNT_OFC_CD )
#end
#end
#if(${insp_yr} != '')
   AND TO_CHAR(A.FLD_INSP_DT, 'YYYY') IN (@[insp_yr])
#end
ORDER BY FLD_INSP_DT, INSP_OFC_CD			]]></sql>
			<params>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="insp_ofc_cd" type="12" value="" out="N"/>
				<param name="rhq_ofc_cd" type="12" value="" out="N"/>
				<param name="insp_yr" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
