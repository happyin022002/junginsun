<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AvailableOffHireDBDAOAvailableOffHireContainerStatusCSQL">
			<desc><![CDATA[20160920 HongSeongPil 최초생성]]></desc>
			<sql><![CDATA[
INSERT INTO LSE_AVAL_OFFH
(
       AGMT_CTY_CD
       , AGMT_SEQ
       , OFFH_SEQ
       , CNTR_NO
       , OFFH_YD_CD                                                     -- 05
       , OFFH_DUE_DT
       , VNDR_SEQ
       , LSTM_CD
       , CNTR_TPSZ_CD
       , RMN_QTY                                                        -- 10
       , CNTR_FULL_FLG
       , MVMT_STS_CD
       , ONH_DT
       , USD_DYS
       , MNR_COST_AMT                                                   -- 15
       , MTY_RTN_YD_CD
       , LSE_CO_RTN_YD_CD
       , OFFH_STS_CD
       , LSE_CO_RTN_FLG
       , RQST_OFC_CD                                                    -- 20
       , CRE_USR_ID
       , CRE_DT
       , UPD_USR_ID
       , UPD_DT
       , SND_USR_ID
)
SELECT  m.agmt_cty_cd
      , m.agmt_seq
      , ( SELECT  NVL(MAX(OFFH_SEQ), 0) + 1
        FROM    LSE_AVAL_OFFH
        WHERE   AGMT_CTY_CD = m.agmt_cty_cd
        AND     AGMT_SEQ    = m.agmt_seq )
      , m.cntr_no
      , @[lse_co_rtn_yd_cd]      
      , '20301231' off_hire_due_date       -- 필수
      , m.vndr_seq
      , m.lstm_cd
      , m.cntr_tpsz_cd
      , 0 -- rem_qty                                                     -- 10
      , DECODE(m.full_flg,'F','Y','N') AS FULL_FLG
      , m.cnmv_sts_cd
      , m.onh_dt
      , ROUND(SYSDATE - m.ONH_DT) AS USED_DAYS   -- used_days
      , (SELECT  /*+ USE_NL( S02 S03 ) */
                  MNR_COMMON_PKG.MNR_GET_RPRCOST_FNC('U', m.CNTR_NO)
          FROM    MNR_ORD_DTL   S02
                , MNR_ORD_HDR   S03
          WHERE   1=1
          AND     m.CNTR_NO              = S02.EQ_NO
          AND     S02.MNR_ORD_OFC_CTY_CD = S03.MNR_ORD_OFC_CTY_CD
          AND     S02.MNR_ORD_SEQ        = S03.MNR_ORD_SEQ
          GROUP BY m.CNTR_NO
          ) AS MNR_COST                                                   -- 15
      , NVL((SELECT NOD_CD 
               FROM SCE_COP_HDR         H
                  , SCE_COP_DTL         D
             WHERE   1 = 1
             AND    H.BKG_NO = M.BKG_NO
             AND    H.CNTR_NO = M.CNTR_NO
             AND    H.COP_NO = D.COP_NO
             AND    D.ACT_CD = 'MITYAD'
             AND    H.COP_STS_CD <> 'X'), M.CRNT_YD_CD)  AS mty_rtn_yd_cd
      , ''
      , @[offh_sts_cd]
      , 'N'
      , (SELECT LST_LGIN_OFC_CD FROM COM_USER WHERE USR_ID = @[upd_usr_id]) LOGIN_OFC_CD  -- 20
      , @[upd_usr_id]
      , SYSDATE
      , @[upd_usr_id]
      , SYSDATE
      , @[upd_usr_id]
FROM mst_container m
WHERE cntr_no = @[cntr_no]			]]></sql>
			<params>
				<param name="lse_co_rtn_yd_cd" type="12" value="" out="N"/>
				<param name="offh_sts_cd" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
