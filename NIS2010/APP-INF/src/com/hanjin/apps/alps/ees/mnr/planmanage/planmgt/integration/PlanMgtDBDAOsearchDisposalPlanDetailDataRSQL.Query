<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PlanMgtDBDAOsearchDisposalPlanDetailDataRSQL">
			<desc><![CDATA[조회 - Disposal Planning Detail]]></desc>
			<sql><![CDATA[
SELECT A.MNR_PLN_SEQ                         
		   , A.MNR_PLN_YR                          
		   , B.CTRL_OFC_CD                         
		   , A.MNR_PLN_OFC_CD                      
		   , A.CRE_USR_ID                          
		   , TO_CHAR(A.UPD_DT, 'YYYY-MM-DD') CRE_DT
           , A.MNR_PLN_FLG 
           , B.CTRL_OFC_CD                          
		   , B.CTRL_OFC_CD  AS OFFICE
		   
		   #foreach($key IN ${cntr_tpsz_cd_seqs})
               #set ($col_name1="CNTR"+$velocityCount+"_CHG_VAL")
           , SUM(DECODE(B.EQ_TPSZ_CD, '$key', B.EQ_QTY)) AS $col_name1
           #end
           
		   , SUM(B.EQ_QTY) TOTAL
           , 'sheet2' AS SHEET_GUBN
	    FROM MNR_PLN_HDR A
		   , MNR_PLN_DTL B
	   WHERE A.MNR_PLN_SEQ = B.MNR_PLN_SEQ(+)
		 AND A.MNR_PLN_OFC_CD <> B.CTRL_OFC_CD
		 AND A.MNR_GRP_TP_CD = 'DSP'
		 AND A.MNR_PLN_OFC_CD = @[mnr_pln_ofc_cd]
		 AND A.EQ_KND_CD = @[eq_knd_cd]
		 AND A.MNR_PLN_YR = @[mnr_pln_yr]

         #if (${mnr_pln_grp_no} != 'A') 
		 AND A.MNR_PLN_GRP_NO = @[mnr_pln_grp_no]
		 #end

	   GROUP BY A.MNR_PLN_SEQ                         
		   , A.MNR_PLN_YR                          
		   , B.CTRL_OFC_CD                         
		   , A.MNR_PLN_OFC_CD                      
		   , A.CRE_USR_ID                          
		   , TO_CHAR(A.UPD_DT, 'YYYY-MM-DD')
           , A.MNR_PLN_FLG			]]></sql>
			<params>
				<param name="mnr_pln_ofc_cd" type="12" value="" out="N"/>
				<param name="eq_knd_cd" type="12" value="" out="N"/>
				<param name="mnr_pln_yr" type="12" value="" out="N"/>
				<param name="mnr_pln_grp_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
