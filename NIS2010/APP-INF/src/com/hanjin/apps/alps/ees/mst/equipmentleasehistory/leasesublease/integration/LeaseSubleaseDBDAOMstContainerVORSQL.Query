<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="LeaseSubleaseDBDAOMstContainerVORSQL">
			<desc><![CDATA[Container Status Inquiry]]></desc>
			<sql><![CDATA[
SELECT 
       A.CNTR_NO,   
       SUBSTR(A.CNTR_NO,11) CHK_DGT, 
       DECODE(A.ACIAC_DIV_CD, 'I', 'Inactive','A','Active') ACIAC_DIV_CD, 
       A.CNTR_TPSZ_CD,
       A.LSTM_CD, 
       B.CNTR_TPSZ_ISO_CD, 
       DECODE(C.CNTR_OLD_VAN_FLG,'Y', 'Old', 'New') CNTR_OLD_VAN_FLG,
       D.OWNR_CO_CD,
       F.CNTR_USE_CO_CD,
	   CASE WHEN A.ACIAC_DIV_CD = 'A' THEN
            --Active 상태인데, MNR/Sold('Y') 가 있다는 의미는 Manual Sold Cancel를 했다는 의미
            NVL (
                (
                SELECT  'Y'
                FROM    MNR_DISP_HDR    T1,
                        MNR_DISP_DTL    T2
                WHERE   T1.DISP_NO  = T2.DISP_NO
                AND     T2.EQ_NO    = A.CNTR_NO                
                AND     T1.DISP_STS_CD <> 'HD'
                AND     T2.DISP_SOLD_DT IS NOT NULL
                ), 'N')
       ELSE
            'N'
       END      AS MNR_SLD_CHK
FROM MST_CONTAINER A, 
     MDM_CNTR_TP_SZ B,
     MST_CNTR_STS_HIS C,
     (SELECT DECODE(INTG_CD_VAL_CTNT,'H','SM Line',INTG_CD_VAL_DP_DESC) OWNR_CO_CD, INTG_CD_VAL_CTNT
      FROM COM_INTG_CD_DTL
      WHERE INTG_CD_ID ='CD01047') D,
     (SELECT DECODE(INTG_CD_VAL_CTNT,'H','SM Line',INTG_CD_VAL_DP_DESC) CNTR_USE_CO_CD, INTG_CD_VAL_CTNT
      FROM COM_INTG_CD_DTL
      WHERE INTG_CD_ID ='CD01020') F
WHERE 1 = 1
 #if(${noExit} == 'A')
        #if (${chk_dgt} == '')
        AND  A.CNTR_NO = @[cntr_no]
        #end
        #if (${chk_dgt} != '') 
        AND  A.CNTR_NO = @[cntr_no] || @[chk_dgt]
        #end 
    #end
    #if(${noExit} == 'E')
        #if (${chk_dgt} == '')
        AND  A.CNTR_NO = MST_COMMON_PKG.MST_CNTR_NO_FNC(@[cntr_no])
        #end
        #if (${chk_dgt} != '') 
        AND  A.CNTR_NO = @[cntr_no] || @[chk_dgt]
        #end 
    #end        
AND B.CNTR_TPSZ_CD = A.CNTR_TPSZ_CD
AND C.CNTR_NO(+) = A.CNTR_NO
AND D.INTG_CD_VAL_CTNT(+) = A.OWNR_CO_CD
AND F.INTG_CD_VAL_CTNT(+) = A.CNTR_USE_CO_CD
AND ROWNUM = 1			]]></sql>
			<params>
				<param name="cntr_no" type="12" value="" out="N"/>
				<param name="chk_dgt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
