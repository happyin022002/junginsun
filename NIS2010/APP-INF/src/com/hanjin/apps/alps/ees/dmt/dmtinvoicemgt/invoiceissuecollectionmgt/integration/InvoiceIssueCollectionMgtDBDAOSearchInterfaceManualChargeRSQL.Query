<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceIssueCollectionMgtDBDAOSearchInterfaceManualChargeRSQL">
			<desc><![CDATA[Manual Detail 이 존재하지 않을때 Interface Charge 데이터 생성]]></desc>
			<sql><![CDATA[
SELECT  '' 								AS SRC_IF_DT
	   ,'' 								AS SRC_IF_SEQ
	   ,1  								AS CHG_SEQ
       ,T1.INV_CURR_CD 					AS CURR_CD
	   ,DECODE(SUBSTR(T1.DMDT_TRF_CD, 1, 2), 'DM', 'DMR', 'DT', 'DTC', 'CT', 'CDD', '')	AS CHG_CD
       ,'' 								AS PER_TP_CD		--container type size cd
	   ,T1.INV_CHG_AMT 					AS TRF_RT_AMT
       ,1 								AS RAT_AS_CNTR_QTY
	   ,T1.INV_CHG_AMT 					AS CHG_AMT
       ,'' AS TRF_NO		--container no
	   ,DECODE(T1.TAX_AMT, 0, 'N', 'Y') AS TVA_FLG
       ,T1.CRE_USR_ID
       ,TO_CHAR(T1.CRE_DT,'yyyymmdd') 	AS CRE_DT
       ,T1.UPD_USR_ID
       ,TO_CHAR(T1.UPD_DT,'yyyymmdd') 	AS UPD_DT
	   ,CASE 
			-- 인도 TAX 변경 후에는 SBC AMOUNT 가 존재하지 않음.
			WHEN @[ida_tax_appl_tm] = 'A'
				THEN 'N'
			ELSE
				CASE 
					WHEN NVL(T1.IDA_LOCL_TAX,0) <> 0 
						THEN 'Y'
					ELSE 'N'
				END
		END 							AS SBC_FLG
	   ,CASE 
			-- 인도 TAX 변경 후에는 KKC AMOUNT 가 존재하지 않음.
			WHEN @[ida_tax_appl_tm] = 'A'
				THEN 'N'
			ELSE
				CASE 
					WHEN NVL(T1.IDA_N2ND_LOCL_TAX,0) <> 0 
						THEN 'Y'
					ELSE 'N'
				END
		END 							AS KKC_FLG
		
  FROM  DMT_INV_MN 			T1
	   
 WHERE  T1.DMDT_INV_NO = @[invoice_no]
   AND  T1.CRE_OFC_CD  = @[cre_ofc_cd]			]]></sql>
			<params>
				<param name="ida_tax_appl_tm" type="12" value="" out="N"/>
				<param name="invoice_no" type="12" value="" out="N"/>
				<param name="cre_ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
