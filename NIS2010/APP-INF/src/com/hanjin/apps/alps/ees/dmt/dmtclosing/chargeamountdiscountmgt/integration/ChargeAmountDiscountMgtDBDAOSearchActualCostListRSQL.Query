<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChargeAmountDiscountMgtDBDAOSearchActualCostListRSQL">
			<desc><![CDATA[ChargeAmountDiscountMgtDBDAOSearchActualCostList]]></desc>
			<sql><![CDATA[
#if(${sts_desc} == 'Reason' )
SELECT '1' SEQ,
		AFT_BKG_ACT_COST_ITM_NM, 
		AFT_BKG_ACT_COST_CURR_CD, 
		AFT_BKG_ACT_COST_AMT, 
		AFT_BKG_ACT_COST_RMK, 
		AFT_BKG_ACT_COST_ITM_LVL
   FROM DMT_AFT_BKG_ACT_COST_RQST A
  WHERE A.AFT_EXPT_DAR_NO = @[dar_no]
    AND AFT_BKG_ACT_COST_ITM_LVL in ( 8, 9 )

#else
SELECT AFT_BKG_ACT_COST_ITM_NM,
AFT_BKG_ACT_COST_CURR_CD,
AFT_BKG_ACT_COST_AMT,
AFT_BKG_ACT_COST_RMK,
AFT_BKG_ACT_COST_ITM_LVL
FROM (
    SELECT RANK () OVER (PARTITION BY AFT_BKG_ACT_COST_ITM_LVL ORDER BY SEQ) AS A_RANK
    , AA.*
    FROM (
        SELECT '1' SEQ,AFT_BKG_ACT_COST_ITM_NM, AFT_BKG_ACT_COST_CURR_CD, AFT_BKG_ACT_COST_AMT, AFT_BKG_ACT_COST_RMK, B.HRD_CDG_ID_SEQ AFT_BKG_ACT_COST_ITM_LVL
        FROM DMT_AFT_BKG_ACT_COST_RQST A, DMT_HRD_CDG_CTNT B
        WHERE A.AFT_EXPT_DAR_NO = @[dar_no]
        AND B.HRD_CDG_ID LIKE 'AFT_BKG_ACTUAL_COST'
        AND B.ATTR_CTNT1 = A.AFT_BKG_ACT_COST_ITM_NM
        
        UNION ALL
        
        SELECT '2' SEQ,ATTR_CTNT1, ATTR_CTNT2, 0, '', HRD_CDG_ID_SEQ
         FROM DMT_HRD_CDG_CTNT 
        WHERE HRD_CDG_ID LIKE 'AFT_BKG_ACTUAL_COST'
        ) AA
    )
WHERE A_RANK = 1
ORDER BY AFT_BKG_ACT_COST_ITM_LVL
#end			]]></sql>
			<params>
				<param name="dar_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
