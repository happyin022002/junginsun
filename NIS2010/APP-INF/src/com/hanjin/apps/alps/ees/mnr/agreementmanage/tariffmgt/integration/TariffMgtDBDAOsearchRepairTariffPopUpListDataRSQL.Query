<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TariffMgtDBDAOsearchRepairTariffPopUpListDataRSQL">
			<desc><![CDATA[   ]]></desc>
			<sql><![CDATA[
SELECT A.TRF_NO
	 , A.MNR_TRF_KND_CD
     , MNR_COMMON_PKG.MNR_CONV_PARTNER_CD_FNC(A.VNDR_SEQ) AS VNDR_SEQ
     , (SELECT B.VNDR_LGL_ENG_NM FROM MDM_VENDOR B WHERE B.VNDR_SEQ = A.VNDR_SEQ) VNDR_NM
	 , A.EQ_KND_CD
	 , TO_CHAR(A.EFF_DT,'YYYY-MM-DD') EFF_DT
 	 , A.MNR_MEAS_UT_CD
	 , A.CURR_CD
	 , TO_CHAR(A.CRE_DT,'YYYY-MM-DD') CRE_DT
     , A.RQST_OFC_CD
	 , A.CRE_USR_ID
	 , MNR_COMMON_PKG.MNR_GET_USR_NM_FNC(A.CRE_USR_ID)  CRE_USR_NM
     , MNR_COMMON_PKG.MNR_CONV_AGMT_NO_FNC(C.AGMT_OFC_CTY_CD,C.AGMT_SEQ)  AGMT_NO
     , A.MNR_TRF_STS_CD
	 , (SELECT C.MNR_CD_DESC FROM MNR_GEN_CD C WHERE C.MNR_CD_ID = A.MNR_TRF_KND_CD AND PRNT_CD_ID = 'CD00011') AS MNR_TRF_KND_NM
	 , (SELECT C.MNR_CD_DESC FROM MNR_GEN_CD C WHERE C.MNR_CD_ID = A.EQ_KND_CD AND PRNT_CD_ID = 'CD00002') AS EQ_KND_NM
	 , (SELECT C.MNR_CD_DESC FROM MNR_GEN_CD C WHERE C.MNR_CD_ID = A.MNR_TRF_STS_CD AND PRNT_CD_ID = 'CD00007') AS MNR_TRF_STS_NM
	 , (SELECT C.MNR_CD_DESC FROM MNR_GEN_CD C WHERE C.MNR_CD_ID = A.MNR_MEAS_UT_CD AND PRNT_CD_ID = 'CD00010') AS MNR_MEAS_UT_NM
  FROM MNR_RPR_TRF_HDR A
     , MNR_AGMT_HDR C
 WHERE A.RQST_OFC_CD = @[ofc_cd]

   #if (${mnr_trf_knd_cd} != 'All') 
   AND A.MNR_TRF_KND_CD = @[mnr_trf_knd_cd]
   #end

   AND A.TRF_NO = C.TRF_NO(+)
   AND NVL(C.AGMT_LST_VER_FLG(+),'Y') = 'Y'
   AND A.CRE_DT BETWEEN GLOBALDATE_PKG.TIME_CONV_OFC_FNC(@[user_ofc_cd],TO_DATE(@[cre_dt_fr],'YYYY-MM-DD'), MNR_COMMON_PKG.MNR_GET_HOOFC_FNC()) 
					AND GLOBALDATE_PKG.TIME_CONV_OFC_FNC(@[user_ofc_cd],TO_DATE(@[cre_dt_to]||'23:59:59','YYYY-MM-DD HH24:MI:SS'), MNR_COMMON_PKG.MNR_GET_HOOFC_FNC())
   
   #if (${access_system} == 'ALP') 
   AND A.MNR_TRF_STS_CD NOT IN ('SD','HD','SS')
   #else 
   AND A.MNR_TRF_STS_CD NOT IN ('SD','HD','HS')
   --AND A.MNR_INP_TP_CD = 'W'
   #end

   #if (${eq_knd_cd} != '') 
   AND A.EQ_KND_CD = @[eq_knd_cd]
   #end

   #if (${mnr_trf_sts_cd} != '') 
   AND A.MNR_TRF_STS_CD = @[mnr_trf_sts_cd]
   #end

   #if (${vndr_seq} != '') 
   AND A.VNDR_SEQ = @[vndr_seq]
   #end

  ORDER BY A.EFF_DT DESC			]]></sql>
			<params>
				<param name="ofc_cd" type="12" value="1" out="N"/>
				<param name="mnr_trf_knd_cd" type="12" value="STD" out="N"/>
				<param name="user_ofc_cd" type="12" value="" out="N"/>
				<param name="cre_dt_fr" type="12" value="20080601" out="N"/>
				<param name="cre_dt_to" type="12" value="20090601" out="N"/>
				<param name="eq_knd_cd" type="12" value="U" out="N"/>
				<param name="mnr_trf_sts_cd" type="12" value="HR" out="N"/>
				<param name="vndr_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
