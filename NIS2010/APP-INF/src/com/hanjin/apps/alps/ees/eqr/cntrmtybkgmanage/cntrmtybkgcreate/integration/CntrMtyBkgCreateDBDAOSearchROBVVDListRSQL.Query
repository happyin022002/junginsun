<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CntrMtyBkgCreateDBDAOSearchROBVVDListRSQL">
			<desc><![CDATA[ROB 의 다음 항차의 VVD 들을 조회합니다. (최대 5개)]]></desc>
			<sql><![CDATA[
SELECT A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD VVD_CD
      ,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD VVD_NM
      ,A.N1ST_PORT_BRTH_DT
FROM VSK_VSL_SKD A
    ,(
        -- 기준 VVD
        SELECT VSL_CD
              ,SKD_VOY_NO
              ,SKD_DIR_CD
              ,N1ST_PORT_BRTH_DT 
        FROM VSK_VSL_SKD
        WHERE VSL_CD      = SUBSTR(@[vvd], 0, 4)
        AND   SKD_VOY_NO  = SUBSTR(@[vvd], 5, 4)
        AND   SKD_DIR_CD  = SUBSTR(@[vvd], 9, 1)                
     ) B
WHERE A.VSL_CD = B.VSL_CD
AND   A.N1ST_PORT_BRTH_DT > B.N1ST_PORT_BRTH_DT -- B보다 큰 SKD 찾기(SKD 선후관계 따짐)
AND   ROWNUM <=5                                -- 5개까지 조회
ORDER BY A.N1ST_PORT_BRTH_DT			]]></sql>
			<params>
				<param name="vvd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
