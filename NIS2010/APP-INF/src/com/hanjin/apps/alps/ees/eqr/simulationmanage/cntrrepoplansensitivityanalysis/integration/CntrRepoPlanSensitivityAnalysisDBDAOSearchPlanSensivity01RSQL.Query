<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CntrRepoPlanSensitivityAnalysisDBDAOSearchPlanSensivity01RSQL">
			<desc><![CDATA[Cost내에서의 Rail/Water/Truck 구하기]]></desc>
			<sql><![CDATA[
SELECT SUBSTR(B.PLN_YRWK,1,4) || '-' || SUBSTR(B.PLN_YRWK,5,2) WEEK        
		, @[sens_typ] SENSITY                                                       	
		, @[obj_txt] OBJ                                                        	
		, B.FM_ECC_CD  FM_LOC                                                     
		, B.TO_ECC_CD  TO_LOC                                                     
		, F.CNTR_TPSZ_CD  TS_TYPE                                                    
		, SUM(F.CNTR_QTY) VOL                                       		
		, (select DECODE(SUBSTR(CNTR_TPSZ_CD,2,2)  , '2',TZ_20FT_COST_AMT                     
		                                           , '4',TZ_40FT_COST_AMT                     
		                                           , '5',TZ_40FT_COST_AMT                     
		                                           , '7',TZ_45FT_COST_AMT)
           FROM EQR_ECC_LNK   
		   WHERE FM_ECC_CD = B.FM_ECC_CD                      
		   AND TO_ECC_CD= B.TO_ECC_CD                       
		   AND TRSP_MOD_CD = B.TRSP_MOD_CD) CURR_COST                                                         
		 , RNG_MIN_QTY COST_RANGE 
         , RNG_MAX_QTY COST_RANGE1                             
 FROM EQR_EQ_REPO_PLN A                                                     
     , EQR_INLND_TRSP_PLN B                                                
     , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C	              	
     , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) D	              	
     , EQR_TRSP_COST_RNG E
     , EQR_INLND_TRSP_PLN_QTY F                                                 
 WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                        
 AND B.FM_ECC_CD = C.ECC_CD                                           
 AND B.TO_ECC_CD = D.ECC_CD                                           
 AND B.REPO_PLN_ID 	= E.REPO_PLN_ID                                 
 AND B.FM_ECC_CD 		= E.FM_ECC_CD                                   
 AND B.TO_ECC_CD 		= E.TO_ECC_CD                                   
 AND F.CNTR_TPSZ_CD 	= E.CNTR_SZ_CD                                	
 AND B.PLN_YRWK 		= E.PLN_YRWK                                    
 AND B.TRSP_MOD_CD 	= E.TRSP_MOD_CD                                 
 AND A.REPO_PLN_ID = @[repo_pln_id]				                                
 AND F.CNTR_TPSZ_CD IN (${arrtpszcd})                           
 AND B.TRSP_MOD_CD = @[costobj]	                                         
 AND FM_YRWK BETWEEN @[fmstartprd] AND @[fmendprd]	 
 AND B.REPO_PLN_ID = F.REPO_PLN_ID
 AND B.PLN_YRWK    = F.PLN_YRWK
 AND B.PLN_SEQ     = F.PLN_SEQ				                   
#if (${fmecccd} != '') 
  	#if (${fmtype} == 'R')
 AND C.RCC_CD IN (${arrfmecccd}) 
    #end
   	#if (${fmtype} == 'L')
 AND C.LCC_CD IN (${arrfmecccd})
    #end
   	#if (${fmtype} == 'E')
 AND C.ECC_CD IN (${arrfmecccd})
    #end
#end 				
#if (${fmtype} != '' && ${totype} != '') 				
 AND TO_YRWK BETWEEN @[tostartprd] AND @[toendprd]						              		
#end
#if (${toecccd} != '') 
 	#if (${totype} == 'R')
 AND C.RCC_CD IN (${arrtoecccd}) 
	#end
   	#if (${totype} == 'L')
 AND C.LCC_CD IN (${arrtoecccd})
	#end
   	#if (${totype} == 'E')
 AND C.ECC_CD IN (${arrtoecccd})
	#end
#end   		
 GROUP BY B.PLN_YRWK, B.FM_ECC_CD, B.TO_ECC_CD, F.CNTR_TPSZ_CD ,B.TRSP_MOD_CD, RNG_MIN_QTY, RNG_MAX_QTY     
 ORDER BY B.PLN_YRWK, B.FM_ECC_CD, B.TO_ECC_CD, F.CNTR_TPSZ_CD ,B.TRSP_MOD_CD			]]></sql>
			<params>
				<param name="sens_typ" type="12" value="" out="N"/>
				<param name="obj_txt" type="12" value="" out="N"/>
				<param name="repo_pln_id" type="12" value="" out="N"/>
				<param name="costobj" type="12" value="" out="N"/>
				<param name="fmstartprd" type="12" value="" out="N"/>
				<param name="fmendprd" type="12" value="" out="N"/>
				<param name="tostartprd" type="12" value="" out="N"/>
				<param name="toendprd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
