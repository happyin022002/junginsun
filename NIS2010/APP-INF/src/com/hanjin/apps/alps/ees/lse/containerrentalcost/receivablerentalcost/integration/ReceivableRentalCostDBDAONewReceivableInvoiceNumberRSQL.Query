<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ReceivableRentalCostDBDAONewReceivableInvoiceNumberRSQL">
			<desc><![CDATA[신규 Receivable Rental Invoice Number를 조회합니다.]]></desc>
			<sql><![CDATA[
SELECT  CASE WHEN MAX_INV_NO IS NULL 
             THEN PRE_FIX_NO||TRIM(TO_CHAR(1,'000'))
             ELSE PRE_FIX_NO||TRIM(TO_CHAR(NEXT_INV_SEQ,'000')) 
        END  INV_NO
FROM   (SELECT  MAX(NVL(A.INV_NO, A.CXL_INV_NO)) AS MAX_INV_NO,
                'SML'||TO_CHAR(SYSDATE, 'RRRRMM') AS PRE_FIX_NO, 
                TO_NUMBER(SUBSTR(MAX(NVL(A.INV_NO, A.CXL_INV_NO)),10,3)) +1 AS NEXT_INV_SEQ                
        FROM    LSE_RCV_RNTL_CHG A                                                                              
        WHERE   TO_CHAR(SYSDATE, 'YYYYMM') = SUBSTR(NVL(A.INV_NO, A.CXL_INV_NO), 4,6)
)			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
