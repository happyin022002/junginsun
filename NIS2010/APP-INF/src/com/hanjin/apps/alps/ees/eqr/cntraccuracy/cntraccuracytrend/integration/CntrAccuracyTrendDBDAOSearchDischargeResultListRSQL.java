/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : CntrAccuracyTrendDBDAOSearchDischargeResultListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.03.07
*@LastModifier : 
*@LastVersion : 1.0
* 2016.03.07 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.ees.eqr.cntraccuracy.cntraccuracytrend.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class CntrAccuracyTrendDBDAOSearchDischargeResultListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * Search Discharge Result List
	  * - 2014-01-15, AFRICA PORT 를 EUROPE 으로 병합, 신용찬
	  * - 2014-02-03, SKIP PORT 제거, MT LOADING PORT IND SEQ 조건 추가, 신용찬
	  * </pre>
	  */
	public CntrAccuracyTrendDBDAOSearchDischargeResultListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("loc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rcc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fm_wk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_wk",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.ees.eqr.cntraccuracy.cntraccuracytrend.integration").append("\n"); 
		query.append("FileName : CntrAccuracyTrendDBDAOSearchDischargeResultListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("WITH DUMMY_HEAD AS" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("    SELECT DISTINCT " ).append("\n"); 
		query.append("           A.TRD_CD" ).append("\n"); 
		query.append("          ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("          ,A.RLANE_CD" ).append("\n"); 
		query.append("          ,A.SLAN_CD" ).append("\n"); 
		query.append("          ,SUBSTR(A.SLS_YRMON, 0, 4)||A.COST_WK WEEK" ).append("\n"); 
		query.append("          ,A.VSL_CD||A.SKD_VOY_NO||A.DIR_CD VVD " ).append("\n"); 
		query.append("          ,A.VSL_CD" ).append("\n"); 
		query.append("          ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("          ,A.DIR_CD" ).append("\n"); 
		query.append("          ,D.YD_CD " ).append("\n"); 
		query.append("          ,D.VPS_PORT_CD " ).append("\n"); 
		query.append("          ,D.CLPT_SEQ" ).append("\n"); 
		query.append("          ,D.CLPT_IND_SEQ" ).append("\n"); 
		query.append("          ,E.CONTI_CD" ).append("\n"); 
		query.append("          ,D.VPS_ETA_DT" ).append("\n"); 
		query.append("          ,D.VPS_ETB_DT " ).append("\n"); 
		query.append("          ,D.VPS_ETD_DT" ).append("\n"); 
		query.append("    FROM MAS_MON_VVD A" ).append("\n"); 
		query.append("        ,VSK_VSL_PORT_SKD D" ).append("\n"); 
		query.append("        ,MDM_LOCATION E" ).append("\n"); 
		query.append("    WHERE A.VSL_CD     = D.VSL_CD" ).append("\n"); 
		query.append("    AND   A.SKD_VOY_NO = D.SKD_VOY_NO" ).append("\n"); 
		query.append("    AND   A.DIR_CD     = D.SKD_DIR_CD " ).append("\n"); 
		query.append("    AND   D.VPS_PORT_CD= E.LOC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    AND   A.DELT_FLG = 'N'" ).append("\n"); 
		query.append("    AND   NVL(D.VPS_PORT_CD, ' ') NOT IN ('PAPAC', 'EGSUZ')" ).append("\n"); 
		query.append("    AND   NVL(D.SKD_CNG_STS_CD, 'X') <> 'S'  -- SKIP PORT 제외(20140203)" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    AND   (" ).append("\n"); 
		query.append("              --수정전 원본(2014-01-15)" ).append("\n"); 
		query.append("              --(SUBSTR(A.TRD_CD, 0, 1) <> 'I' AND (SELECT X.CONTI_CD FROM MDM_LOCATION X WHERE X.LOC_CD = A.LST_LODG_PORT_CD) <> E.CONTI_CD)  --'I' 로 시작하지 않는 TRD 는 MAS MON VVD의 LAST CALLING LOADING PORT 대륙의 PORT는 제외(DISCHARGING만 조회)" ).append("\n"); 
		query.append("              -- 수정후 (2014-01-15, AFRICA PORT 를 EUROPE 으로 병합, 신용찬)" ).append("\n"); 
		query.append("              (SUBSTR(A.TRD_CD, 0, 1) <> 'I' AND (SELECT DECODE(X.CONTI_CD, 'F', 'E', X.CONTI_CD) FROM MDM_LOCATION X WHERE X.LOC_CD = A.LST_LODG_PORT_CD) <> DECODE(E.CONTI_CD, 'F', 'E', E.CONTI_CD))  --'I' 로 시작하지 않는 TRD 는 MAS MON VVD의 LAST CALLING LOADING PORT 대륙의 PORT는 제외(DISCHARGING만 조회)" ).append("\n"); 
		query.append("              OR" ).append("\n"); 
		query.append("              (SUBSTR(A.TRD_CD, 0, 1) = 'I' )  -- 'I' 로 시작하는 TRD 는 모든 PORT 조회" ).append("\n"); 
		query.append("          )    " ).append("\n"); 
		query.append("	-- 기본적으로 ASIA PORT 만 추출" ).append("\n"); 
		query.append("    -- 단 'I' 로 시작하는 TRD 는 모든 PORT 조회" ).append("\n"); 
		query.append("--    AND (" ).append("\n"); 
		query.append("--           (SUBSTR(A.TRD_CD, 0, 1) <> 'I' AND E.CONTI_CD = 'A')  -- 'I' 로 시작하지 않는 TRD 는 ASIA PORT만 조회" ).append("\n"); 
		query.append("--           OR" ).append("\n"); 
		query.append("--           (SUBSTR(A.TRD_CD, 0, 1) = 'I' )  -- 'I' 로 시작하는 TRD 는 모든 PORT 조회" ).append("\n"); 
		query.append("--        )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    -- 검색조건 " ).append("\n"); 
		query.append("  #if (${vvd_cd} != '') " ).append("\n"); 
		query.append("    -- VVD" ).append("\n"); 
		query.append("    AND   A.VSL_CD     = SUBSTR(@[vvd_cd], 0, 4)" ).append("\n"); 
		query.append("    AND   A.SKD_VOY_NO = SUBSTR(@[vvd_cd], 5, 4)" ).append("\n"); 
		query.append("    AND   A.DIR_CD     = SUBSTR(@[vvd_cd], 9, 1)" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("  #if (${fm_wk} != '' && ${to_wk} != '') " ).append("\n"); 
		query.append("      -- WEEK" ).append("\n"); 
		query.append("      AND   SUBSTR(A.SLS_YRMON, 0, 4)||A.COST_WK BETWEEN @[fm_wk] AND @[to_wk]" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("  #if (${trade} != '')" ).append("\n"); 
		query.append("      -- TRADE CD" ).append("\n"); 
		query.append("  	AND   A.TRD_CD IN (" ).append("\n"); 
		query.append("  		 #foreach($key IN ${arr_trd_cd})" ).append("\n"); 
		query.append("  		  	#if($velocityCount < $arr_trd_cd.size())" ).append("\n"); 
		query.append("  				'$key', " ).append("\n"); 
		query.append("  			#else " ).append("\n"); 
		query.append("  				'$key' " ).append("\n"); 
		query.append("  			#end " ).append("\n"); 
		query.append("  		#end " ).append("\n"); 
		query.append("  			           )" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("  #if (${subtrade} != '')" ).append("\n"); 
		query.append("      -- SUB TRADE CD" ).append("\n"); 
		query.append("  	AND (" ).append("\n"); 
		query.append("  		#foreach($key IN ${arr_sub_trd_cd})" ).append("\n"); 
		query.append("  			#if($velocityCount == 1 )" ).append("\n"); 
		query.append("  			     (A.TRD_CD = SUBSTR('$key',1,3) AND A.SUB_TRD_CD = SUBSTR('$key',4,2))" ).append("\n"); 
		query.append("  			#else " ).append("\n"); 
		query.append("  			  OR (A.TRD_CD = SUBSTR('$key',1,3) AND A.SUB_TRD_CD = SUBSTR('$key',4,2))" ).append("\n"); 
		query.append("  			#end " ).append("\n"); 
		query.append("  		#end " ).append("\n"); 
		query.append("  		 )" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("  #if (${lane} != '') " ).append("\n"); 
		query.append("  	-- LANE CD" ).append("\n"); 
		query.append("  	AND (" ).append("\n"); 
		query.append("  		#foreach($key IN ${arr_lane})" ).append("\n"); 
		query.append("  		  #if($velocityCount == 1 ) " ).append("\n"); 
		query.append("  			--   (A.TRD_CD = SUBSTR('$key',1,3) AND A.SUB_TRD_CD = SUBSTR('$key',4,2) AND A.SLAN_CD = SUBSTR('$key',6))" ).append("\n"); 
		query.append("                A.SLAN_CD = '$key' " ).append("\n"); 
		query.append("  		  #else " ).append("\n"); 
		query.append("  			--OR (A.TRD_CD = SUBSTR('$key',1,3) AND A.SUB_TRD_CD = SUBSTR('$key',4,2) AND A.SLAN_CD = SUBSTR('$key',6))" ).append("\n"); 
		query.append("                OR A.SLAN_CD = '$key' " ).append("\n"); 
		query.append("  		  #end " ).append("\n"); 
		query.append("  		#end " ).append("\n"); 
		query.append("  		)" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("  #if (${rcc_cd} != '' || ${loc_tp_cd} != ''|| ${loc_cd} != '')" ).append("\n"); 
		query.append("      -- LOCATION" ).append("\n"); 
		query.append("      AND   D.VPS_PORT_CD IN " ).append("\n"); 
		query.append("      (" ).append("\n"); 
		query.append("          SELECT DISTINCT B.LOC_CD " ).append("\n"); 
		query.append("          FROM MDM_EQ_ORZ_CHT A" ).append("\n"); 
		query.append("              ,MDM_LOCATION B" ).append("\n"); 
		query.append("          WHERE A.SCC_CD   = B.SCC_CD            " ).append("\n"); 
		query.append("          AND   A.DELT_FLG = 'N'" ).append("\n"); 
		query.append("  	#if (${rcc_cd} != '') " ).append("\n"); 
		query.append("          AND   A.RCC_CD = @[rcc_cd]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("  	#if (${loc_tp_cd} == 'L')" ).append("\n"); 
		query.append("  	  #if (${loc_cd} != '') " ).append("\n"); 
		query.append("          AND A.LCC_CD  = @[loc_cd]" ).append("\n"); 
		query.append("  	  #end" ).append("\n"); 
		query.append("  	#elseif (${loc_tp_cd} == 'S')" ).append("\n"); 
		query.append("  	  #if (${loc_cd} != '') " ).append("\n"); 
		query.append("  		AND A.SCC_CD  = @[loc_cd]" ).append("\n"); 
		query.append("  	  #end" ).append("\n"); 
		query.append("  	#elseif (${loc_tp_cd} == 'E') " ).append("\n"); 
		query.append("  	  #if (${loc_cd} != '') " ).append("\n"); 
		query.append("  	    AND A.ECC_CD  = @[loc_cd]" ).append("\n"); 
		query.append("  	  #end" ).append("\n"); 
		query.append("  	#end" ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",DUMMY_DSCH AS" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("    SELECT VSL_CD" ).append("\n"); 
		query.append("          ,SKD_VOY_NO" ).append("\n"); 
		query.append("          ,SKD_DIR_CD" ).append("\n"); 
		query.append("          ,VSL_LANE_CD" ).append("\n"); 
		query.append("          ,POD_YD_CD" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("          ,NVL(SUM(CNTR_QTY), 0) QTY_TTL" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D2', CNTR_QTY)), '') QTY_D2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D4', CNTR_QTY)), '') QTY_D4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D5', CNTR_QTY)), '') QTY_D5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D7', CNTR_QTY)), '') QTY_D7" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R2', CNTR_QTY)), '') QTY_R2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R5', CNTR_QTY)), '') QTY_R5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R9', CNTR_QTY)), '') QTY_R9" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'O2', CNTR_QTY)), '') QTY_O2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'O4', CNTR_QTY)), '') QTY_O4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'S2', CNTR_QTY)), '') QTY_S2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'S4', CNTR_QTY)), '') QTY_S4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F2', CNTR_QTY)), '') QTY_F2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F4', CNTR_QTY)), '') QTY_F4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F5', CNTR_QTY)), '') QTY_F5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A2', CNTR_QTY)), '') QTY_A2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A4', CNTR_QTY)), '') QTY_A4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A5', CNTR_QTY)), '') QTY_A5" ).append("\n"); 
		query.append("          ,POD_CLPT_IND_SEQ CLPT_IND_SEQ   " ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("    FROM" ).append("\n"); 
		query.append("    (" ).append("\n"); 
		query.append("        /*" ).append("\n"); 
		query.append("        SELECT A.VSL_CD" ).append("\n"); 
		query.append("              ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("              ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("              ,A.VSL_LANE_CD" ).append("\n"); 
		query.append("              ,A.POD_YD_CD" ).append("\n"); 
		query.append("              ,B.BKG_NO" ).append("\n"); 
		query.append("              ,B.CNTR_TPSZ_CD TPSZ_CD" ).append("\n"); 
		query.append("              ,B.OP_CNTR_QTY CNTR_QTY" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("        FROM EQR_CTRL_MTY_BKG_EXE A" ).append("\n"); 
		query.append("            ,BKG_QUANTITY B" ).append("\n"); 
		query.append("            ,DUMMY_HEAD Z" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("        WHERE A.VSL_CD      = Z.VSL_CD" ).append("\n"); 
		query.append("        AND   A.SKD_VOY_NO  = Z.SKD_VOY_NO" ).append("\n"); 
		query.append("        AND   A.SKD_DIR_CD  = Z.DIR_CD   " ).append("\n"); 
		query.append("        AND   A.POD_YD_CD   = Z.YD_CD " ).append("\n"); 
		query.append("        AND  ( " ).append("\n"); 
		query.append("               (A.TRSP_MOD_CD = 'V' AND A.MTY_BKG_FLG = 'Y' AND A.MTY_BKG_SPLIT_FLG = 'Y') -- TRUNK 는 SPLIT 만 대상" ).append("\n"); 
		query.append("               OR" ).append("\n"); 
		query.append("               (A.TRSP_MOD_CD = 'W' AND A.MTY_BKG_FLG = 'Y' )  -- WATER 는 SPLIT 없음" ).append("\n"); 
		query.append("             )" ).append("\n"); 
		query.append("        AND   A.MTY_BKG_NO  = B.BKG_NO" ).append("\n"); 
		query.append("        AND   NVL(A.BKG_STS_CD, ' ') <> 'X' --BKG CANCEL 제외" ).append("\n"); 
		query.append("        */" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        SELECT A.VSL_CD" ).append("\n"); 
		query.append("              ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("              ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("              ,A.SLAN_CD VSL_LANE_CD" ).append("\n"); 
		query.append("              ,A.POD_YD_CD" ).append("\n"); 
		query.append("              ,B.BKG_NO" ).append("\n"); 
		query.append("              ,B.CNTR_TPSZ_CD TPSZ_CD" ).append("\n"); 
		query.append("              ,B.OP_CNTR_QTY CNTR_QTY" ).append("\n"); 
		query.append("              ,A.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("        FROM BKG_VVD A" ).append("\n"); 
		query.append("            ,BKG_QUANTITY B" ).append("\n"); 
		query.append("            ,BKG_BOOKING D" ).append("\n"); 
		query.append("            ,DUMMY_HEAD Z" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("        WHERE D.VSL_CD          = Z.VSL_CD" ).append("\n"); 
		query.append("        AND   D.SKD_VOY_NO      = Z.SKD_VOY_NO" ).append("\n"); 
		query.append("        AND   D.SKD_DIR_CD      = Z.DIR_CD   " ).append("\n"); 
		query.append("        AND   D.POD_NOD_CD      = Z.YD_CD " ).append("\n"); 
		query.append("        AND   D.BKG_CGO_TP_CD   = 'P'  -- EMPTY BKG 만 추출        " ).append("\n"); 
		query.append("        AND   D.SPLIT_FLG       = 'Y'  -- SPLIT 된것만 추출" ).append("\n"); 
		query.append("        AND   D.BKG_NO          = A.BKG_NO" ).append("\n"); 
		query.append("        AND   A.POD_CLPT_IND_SEQ= Z.CLPT_IND_SEQ" ).append("\n"); 
		query.append("        AND   A.BKG_NO          = B.BKG_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    )" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    GROUP BY VSL_CD" ).append("\n"); 
		query.append("          ,SKD_VOY_NO" ).append("\n"); 
		query.append("          ,SKD_DIR_CD" ).append("\n"); 
		query.append("          ,VSL_LANE_CD" ).append("\n"); 
		query.append("          ,POD_YD_CD" ).append("\n"); 
		query.append("          ,POD_CLPT_IND_SEQ          " ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",DUMMY_LOAD AS " ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("    SELECT VSL_CD" ).append("\n"); 
		query.append("          ,SKD_VOY_NO" ).append("\n"); 
		query.append("          ,SKD_DIR_CD" ).append("\n"); 
		query.append("          ,VSL_LANE_CD" ).append("\n"); 
		query.append("          ,POD_YD_CD" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("          ,NVL(SUM(CNTR_QTY), 0) QTY_TTL" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D2', CNTR_QTY)), '') QTY_D2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D4', CNTR_QTY)), '') QTY_D4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D5', CNTR_QTY)), '') QTY_D5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D7', CNTR_QTY)), '') QTY_D7" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R2', CNTR_QTY)), '') QTY_R2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R5', CNTR_QTY)), '') QTY_R5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R9', CNTR_QTY)), '') QTY_R9" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'O2', CNTR_QTY)), '') QTY_O2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'O4', CNTR_QTY)), '') QTY_O4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'S2', CNTR_QTY)), '') QTY_S2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'S4', CNTR_QTY)), '') QTY_S4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F2', CNTR_QTY)), '') QTY_F2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F4', CNTR_QTY)), '') QTY_F4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F5', CNTR_QTY)), '') QTY_F5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A2', CNTR_QTY)), '') QTY_A2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A4', CNTR_QTY)), '') QTY_A4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A5', CNTR_QTY)), '') QTY_A5" ).append("\n"); 
		query.append("          ,POD_CLPT_IND_SEQ CLPT_IND_SEQ " ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("    FROM" ).append("\n"); 
		query.append("    (" ).append("\n"); 
		query.append("        /*" ).append("\n"); 
		query.append("        SELECT A.VSL_CD" ).append("\n"); 
		query.append("              ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("              ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("              ,A.VSL_LANE_CD" ).append("\n"); 
		query.append("              ,A.POD_YD_CD" ).append("\n"); 
		query.append("              ,B.BKG_NO" ).append("\n"); 
		query.append("              ,B.CNTR_TPSZ_CD TPSZ_CD" ).append("\n"); 
		query.append("              ,B.OP_CNTR_QTY CNTR_QTY" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("        FROM EQR_CTRL_MTY_BKG_EXE A" ).append("\n"); 
		query.append("            ,BKG_QUANTITY B" ).append("\n"); 
		query.append("            ,DUMMY_HEAD Z" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("        WHERE A.VSL_CD      = Z.VSL_CD" ).append("\n"); 
		query.append("        AND   A.SKD_VOY_NO  = Z.SKD_VOY_NO" ).append("\n"); 
		query.append("        AND   A.SKD_DIR_CD  = Z.DIR_CD   " ).append("\n"); 
		query.append("        AND   A.POD_YD_CD   = Z.YD_CD " ).append("\n"); 
		query.append("        AND  ( " ).append("\n"); 
		query.append("               (A.TRSP_MOD_CD = 'V' AND A.MTY_BKG_FLG = 'Y' AND A.MTY_BKG_SPLIT_FLG = 'N' ) -- TRUNK VL 대상" ).append("\n"); 
		query.append("               OR" ).append("\n"); 
		query.append("               (A.TRSP_MOD_CD = 'W' AND A.MTY_BKG_FLG = 'Y' )  -- WATER 는 SPLIT 없음" ).append("\n"); 
		query.append("             )" ).append("\n"); 
		query.append("        AND   A.MTY_BKG_NO  = B.BKG_NO" ).append("\n"); 
		query.append("        AND   NVL(A.BKG_STS_CD, ' ') <> 'X' --BKG CANCEL 제외" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        -- SPLIT BKG 집계(POD를 VL BKG 으로 변환)" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        SELECT A.VSL_CD" ).append("\n"); 
		query.append("              ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("              ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("              ,A.VSL_LANE_CD" ).append("\n"); 
		query.append("              ,A.POD_YD_CD" ).append("\n"); 
		query.append("              ,B.BKG_NO" ).append("\n"); 
		query.append("              ,B.CNTR_TPSZ_CD TPSZ_CD" ).append("\n"); 
		query.append("              ,B.OP_CNTR_QTY CNTR_QTY" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("                SELECT DISTINCT A.VSL_CD" ).append("\n"); 
		query.append("                      ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("                      ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("                      ,A.VSL_LANE_CD " ).append("\n"); 
		query.append("                      ,A.POD_YD_CD" ).append("\n"); 
		query.append("                       " ).append("\n"); 
		query.append("                      ,B.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("                      ,B.MTY_BKG_NO" ).append("\n"); 
		query.append("                FROM EQR_CTRL_MTY_BKG_EXE A" ).append("\n"); 
		query.append("                    ,(" ).append("\n"); 
		query.append("                        SELECT A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD, A.VSL_LANE_CD, A.POD_YD_CD, A.MTY_BKG_NO, A.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("                        FROM EQR_CTRL_MTY_BKG_EXE A" ).append("\n"); 
		query.append("                            ,DUMMY_HEAD Z    " ).append("\n"); 
		query.append("                        WHERE A.VSL_CD      = Z.VSL_CD" ).append("\n"); 
		query.append("                        AND   A.SKD_VOY_NO  = Z.SKD_VOY_NO" ).append("\n"); 
		query.append("                        AND   A.SKD_DIR_CD  = Z.DIR_CD   " ).append("\n"); 
		query.append("                        AND   A.POD_YD_CD   = Z.YD_CD                                                " ).append("\n"); 
		query.append("                        AND   A.MTY_BKG_FLG       = 'Y'" ).append("\n"); 
		query.append("                        AND   A.MTY_BKG_SPLIT_FLG = 'Y'" ).append("\n"); 
		query.append("                        AND   NVL(A.BKG_STS_CD, ' ') <> 'X' --BKG CANCEL 제외" ).append("\n"); 
		query.append("                    ) B" ).append("\n"); 
		query.append("                WHERE   A.MTY_BKG_NO = B.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("             ) A" ).append("\n"); 
		query.append("            ,BKG_QUANTITY B" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("        WHERE A.MTY_BKG_NO  = B.BKG_NO        " ).append("\n"); 
		query.append("        */" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        SELECT A.VSL_CD" ).append("\n"); 
		query.append("              ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("              ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("              ,A.VSL_LANE_CD" ).append("\n"); 
		query.append("              ,A.POD_YD_CD" ).append("\n"); 
		query.append("              ,B.BKG_NO" ).append("\n"); 
		query.append("              ,B.CNTR_TPSZ_CD TPSZ_CD" ).append("\n"); 
		query.append("              ,B.OP_CNTR_QTY CNTR_QTY" ).append("\n"); 
		query.append("              ,C.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("        FROM EQR_CTRL_MTY_BKG_EXE A" ).append("\n"); 
		query.append("            ,BKG_QUANTITY B" ).append("\n"); 
		query.append("            ,BKG_VVD C" ).append("\n"); 
		query.append("            ,DUMMY_HEAD Z" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("        WHERE A.VSL_CD      = Z.VSL_CD" ).append("\n"); 
		query.append("        AND   A.SKD_VOY_NO  = Z.SKD_VOY_NO" ).append("\n"); 
		query.append("        AND   A.SKD_DIR_CD  = Z.DIR_CD   " ).append("\n"); 
		query.append("        AND   A.POD_YD_CD   = Z.YD_CD " ).append("\n"); 
		query.append("        AND  ( " ).append("\n"); 
		query.append("               (A.TRSP_MOD_CD = 'V' AND A.MTY_BKG_FLG = 'Y' AND A.MTY_BKG_SPLIT_FLG = 'N' ) -- TRUNK VL 대상" ).append("\n"); 
		query.append("               OR" ).append("\n"); 
		query.append("               (A.TRSP_MOD_CD = 'W' AND A.MTY_BKG_FLG = 'Y' )  -- WATER 는 SPLIT 없음" ).append("\n"); 
		query.append("             )" ).append("\n"); 
		query.append("        AND   A.MTY_BKG_NO  = B.BKG_NO" ).append("\n"); 
		query.append("        AND   A.MTY_BKG_NO  = C.BKG_NO" ).append("\n"); 
		query.append("        AND   NVL(A.BKG_STS_CD, ' ') <> 'X' --BKG CANCEL 제외" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        -- SPLIT BKG 집계(POD를 VL BKG 으로 변환)" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        SELECT A.VSL_CD" ).append("\n"); 
		query.append("              ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("              ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("              ,A.VSL_LANE_CD" ).append("\n"); 
		query.append("              ,A.POD_YD_CD" ).append("\n"); 
		query.append("              ,B.BKG_NO" ).append("\n"); 
		query.append("              ,B.CNTR_TPSZ_CD TPSZ_CD" ).append("\n"); 
		query.append("              ,B.OP_CNTR_QTY CNTR_QTY" ).append("\n"); 
		query.append("              ,A.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("                SELECT DISTINCT A.VSL_CD" ).append("\n"); 
		query.append("                      ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("                      ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("                      ,A.VSL_LANE_CD " ).append("\n"); 
		query.append("                      ,A.POD_YD_CD  -- SPLIT BKG POD --> ORG BKG POD 로 취환" ).append("\n"); 
		query.append("                       " ).append("\n"); 
		query.append("                      ,B.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("                      ,B.MTY_BKG_NO" ).append("\n"); 
		query.append("                      ,C.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                FROM EQR_CTRL_MTY_BKG_EXE A " ).append("\n"); 
		query.append("                    ,(" ).append("\n"); 
		query.append("                        SELECT A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD, A.VSL_LANE_CD, A.POD_YD_CD, A.MTY_BKG_NO, A.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("                        FROM EQR_CTRL_MTY_BKG_EXE A" ).append("\n"); 
		query.append("                            ,DUMMY_HEAD Z    " ).append("\n"); 
		query.append("                        WHERE A.VSL_CD      = Z.VSL_CD" ).append("\n"); 
		query.append("                        AND   A.SKD_VOY_NO  = Z.SKD_VOY_NO" ).append("\n"); 
		query.append("                        AND   A.SKD_DIR_CD  = Z.DIR_CD   " ).append("\n"); 
		query.append("                        AND   A.POD_YD_CD   = Z.YD_CD                                                " ).append("\n"); 
		query.append("                        AND   A.MTY_BKG_FLG       = 'Y'" ).append("\n"); 
		query.append("                        AND   A.MTY_BKG_SPLIT_FLG = 'Y'" ).append("\n"); 
		query.append("                        AND   NVL(A.BKG_STS_CD, ' ') <> 'X' --BKG CANCEL 제외" ).append("\n"); 
		query.append("                    ) B" ).append("\n"); 
		query.append("                    ,BKG_VVD C" ).append("\n"); 
		query.append("                WHERE   A.MTY_BKG_NO = B.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("                AND     A.MTY_BKG_NO = C.BKG_NO" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("             ) A" ).append("\n"); 
		query.append("            ,BKG_QUANTITY B" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("        WHERE A.MTY_BKG_NO  = B.BKG_NO " ).append("\n"); 
		query.append("    )" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    GROUP BY VSL_CD" ).append("\n"); 
		query.append("          ,SKD_VOY_NO" ).append("\n"); 
		query.append("          ,SKD_DIR_CD" ).append("\n"); 
		query.append("          ,VSL_LANE_CD" ).append("\n"); 
		query.append("          ,POD_YD_CD" ).append("\n"); 
		query.append("          ,POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append(")        " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",DUMMY_PLAN AS" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("    SELECT VSL_CD" ).append("\n"); 
		query.append("          ,SKD_VOY_NO" ).append("\n"); 
		query.append("          ,SKD_DIR_CD" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("          ,POD_YD_CD" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("          ,NVL(SUM(CNTR_QTY), 0) QTY_TTL" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D2', CNTR_QTY)), '') QTY_D2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D4', CNTR_QTY)), '') QTY_D4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D5', CNTR_QTY)), '') QTY_D5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D7', CNTR_QTY)), '') QTY_D7" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R2', CNTR_QTY)), '') QTY_R2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R5', CNTR_QTY)), '') QTY_R5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R9', CNTR_QTY)), '') QTY_R9" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'O2', CNTR_QTY)), '') QTY_O2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'O4', CNTR_QTY)), '') QTY_O4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'S2', CNTR_QTY)), '') QTY_S2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'S4', CNTR_QTY)), '') QTY_S4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F2', CNTR_QTY)), '') QTY_F2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F4', CNTR_QTY)), '') QTY_F4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F5', CNTR_QTY)), '') QTY_F5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A2', CNTR_QTY)), '') QTY_A2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A4', CNTR_QTY)), '') QTY_A4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A5', CNTR_QTY)), '') QTY_A5" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("    FROM" ).append("\n"); 
		query.append("    (" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("        SELECT A.VSL_CD" ).append("\n"); 
		query.append("              ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("              ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("              ,A.POD_YD_CD" ).append("\n"); 
		query.append("              ,B.CNTR_TPSZ_CD TPSZ_CD " ).append("\n"); 
		query.append("              ,B.CNTR_QTY " ).append("\n"); 
		query.append("        FROM EQR_CTRL_MTY_DCHG_PLN A" ).append("\n"); 
		query.append("            ,EQR_CTRL_MTY_DCHG_PLN_QTY B" ).append("\n"); 
		query.append("            ,DUMMY_HEAD Z" ).append("\n"); 
		query.append("        WHERE A.VSL_CD     = B.VSL_CD" ).append("\n"); 
		query.append("        AND   A.SKD_VOY_NO = B.SKD_VOY_NO" ).append("\n"); 
		query.append("        AND   A.SKD_DIR_CD = B.SKD_DIR_CD" ).append("\n"); 
		query.append("        AND   A.POL_YD_CD  = B.POL_YD_CD" ).append("\n"); 
		query.append("        AND   A.POD_YD_CD  = B.POD_YD_CD" ).append("\n"); 
		query.append("        AND   A.VSL_CD     = Z.VSL_CD" ).append("\n"); 
		query.append("        AND   A.SKD_VOY_NO = Z.SKD_VOY_NO" ).append("\n"); 
		query.append("        AND   A.SKD_DIR_CD = Z.DIR_CD   " ).append("\n"); 
		query.append("        AND   A.POD_YD_CD  = Z.YD_CD  -- 양하지역 PORT YARD 일치 여부" ).append("\n"); 
		query.append("        --AND   A.MTY_PLN_SHW_FLG = 'Y' (조건제거, 2013-10-16, 신용찬)       " ).append("\n"); 
		query.append("    )" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    GROUP BY VSL_CD" ).append("\n"); 
		query.append("          ,SKD_VOY_NO" ).append("\n"); 
		query.append("          ,SKD_DIR_CD" ).append("\n"); 
		query.append("          ,POD_YD_CD" ).append("\n"); 
		query.append("          " ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- NORMAL 쿼리 ---------------------------------------" ).append("\n"); 
		query.append("SELECT A.TRD_CD" ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("      ,A.SLAN_CD" ).append("\n"); 
		query.append("      ,A.WEEK" ).append("\n"); 
		query.append("      ,A.VVD" ).append("\n"); 
		query.append("      ,A.YD_CD  " ).append("\n"); 
		query.append("      ,NVL(B.QTY_TTL,0) D_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,NVL(B.QTY_D2,0)  D_D2" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D4,0)  D_D4" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D5,0)  D_D5" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D7,0)  D_D7" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R2,0)  D_R2" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R5,0)  D_R5" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R9,0)  D_R9" ).append("\n"); 
		query.append("      ,NVL(B.QTY_O2,0)  D_O2" ).append("\n"); 
		query.append("      ,NVL(B.QTY_O4,0)  D_O4" ).append("\n"); 
		query.append("      ,NVL(B.QTY_S2,0)  D_S2" ).append("\n"); 
		query.append("      ,NVL(B.QTY_S4,0)  D_S4" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F2,0)  D_F2" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F4,0)  D_F4" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F5,0)  D_F5" ).append("\n"); 
		query.append("      ,NVL(B.QTY_A2,0)  D_A2" ).append("\n"); 
		query.append("      ,NVL(B.QTY_A4,0)  D_A4" ).append("\n"); 
		query.append("      ,NVL(B.QTY_A5,0)  D_A5" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,NVL(C.QTY_TTL,0) L_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,NVL(C.QTY_D2,0)  L_D2" ).append("\n"); 
		query.append("      ,NVL(C.QTY_D4,0)  L_D4" ).append("\n"); 
		query.append("      ,NVL(C.QTY_D5,0)  L_D5" ).append("\n"); 
		query.append("      ,NVL(C.QTY_D7,0)  L_D7" ).append("\n"); 
		query.append("      ,NVL(C.QTY_R2,0)  L_R2" ).append("\n"); 
		query.append("      ,NVL(C.QTY_R5,0)  L_R5" ).append("\n"); 
		query.append("      ,NVL(C.QTY_R9,0)  L_R9" ).append("\n"); 
		query.append("      ,NVL(C.QTY_O2,0)  L_O2" ).append("\n"); 
		query.append("      ,NVL(C.QTY_O4,0)  L_O4" ).append("\n"); 
		query.append("      ,NVL(C.QTY_S2,0)  L_S2" ).append("\n"); 
		query.append("      ,NVL(C.QTY_S4,0)  L_S4" ).append("\n"); 
		query.append("      ,NVL(C.QTY_F2,0)  L_F2" ).append("\n"); 
		query.append("      ,NVL(C.QTY_F4,0)  L_F4" ).append("\n"); 
		query.append("      ,NVL(C.QTY_F5,0)  L_F5" ).append("\n"); 
		query.append("      ,NVL(C.QTY_A2,0)  L_A2" ).append("\n"); 
		query.append("      ,NVL(C.QTY_A4,0)  L_A4    " ).append("\n"); 
		query.append("      ,NVL(C.QTY_A5,0)  L_A5    " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,NVL(B.QTY_TTL, 0) - NVL(C.QTY_TTL, 0) DF_TTL_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D2,  0) - NVL(C.QTY_D2,  0) DF_D2_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D4,  0) - NVL(C.QTY_D4,  0) DF_D4_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D5,  0) - NVL(C.QTY_D5,  0) DF_D5_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D7,  0) - NVL(C.QTY_D7,  0) DF_D7_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R2,  0) - NVL(C.QTY_R2,  0) DF_R2_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R5,  0) - NVL(C.QTY_R5,  0) DF_R5_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R9,  0) - NVL(C.QTY_R9,  0) DF_R9_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_O2,  0) - NVL(C.QTY_O2,  0) DF_O2_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_O4,  0) - NVL(C.QTY_O4,  0) DF_O4_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_S2,  0) - NVL(C.QTY_S2,  0) DF_S2_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_S4,  0) - NVL(C.QTY_S4,  0) DF_S4_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F2,  0) - NVL(C.QTY_F2,  0) DF_F2_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F4,  0) - NVL(C.QTY_F4,  0) DF_F4_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F5,  0) - NVL(C.QTY_F5,  0) DF_F5_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_A2,  0) - NVL(C.QTY_A2,  0) DF_A2_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_A4,  0) - NVL(C.QTY_A4,  0) DF_A4_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_A5,  0) - NVL(C.QTY_A5,  0) DF_A5_A" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,NVL(D.QTY_TTL,0) P_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,NVL(D.QTY_D2,0)  P_D2" ).append("\n"); 
		query.append("      ,NVL(D.QTY_D4,0)  P_D4" ).append("\n"); 
		query.append("      ,NVL(D.QTY_D5,0)  P_D5" ).append("\n"); 
		query.append("      ,NVL(D.QTY_D7,0)  P_D7" ).append("\n"); 
		query.append("      ,NVL(D.QTY_R2,0)  P_R2" ).append("\n"); 
		query.append("      ,NVL(D.QTY_R5,0)  P_R5" ).append("\n"); 
		query.append("      ,NVL(D.QTY_R9,0)  P_R9" ).append("\n"); 
		query.append("      ,NVL(D.QTY_O2,0)  P_O2" ).append("\n"); 
		query.append("      ,NVL(D.QTY_O4,0)  P_O4" ).append("\n"); 
		query.append("      ,NVL(D.QTY_S2,0)  P_S2" ).append("\n"); 
		query.append("      ,NVL(D.QTY_S4,0)  P_S4" ).append("\n"); 
		query.append("      ,NVL(D.QTY_F2,0)  P_F2" ).append("\n"); 
		query.append("      ,NVL(D.QTY_F4,0)  P_F4" ).append("\n"); 
		query.append("      ,NVL(D.QTY_F5,0)  P_F5" ).append("\n"); 
		query.append("      ,NVL(D.QTY_A2,0)  P_A2" ).append("\n"); 
		query.append("      ,NVL(D.QTY_A4,0)  P_A4   " ).append("\n"); 
		query.append("      ,NVL(D.QTY_A5,0)  P_A5 " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,NVL(B.QTY_TTL, 0) - NVL(D.QTY_TTL, 0) DF_TTL_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D2,  0) - NVL(D.QTY_D2,  0) DF_D2_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D4,  0) - NVL(D.QTY_D4,  0) DF_D4_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D5,  0) - NVL(D.QTY_D5,  0) DF_D5_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D7,  0) - NVL(D.QTY_D7,  0) DF_D7_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R2,  0) - NVL(D.QTY_R2,  0) DF_R2_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R5,  0) - NVL(D.QTY_R5,  0) DF_R5_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R9,  0) - NVL(D.QTY_R9,  0) DF_R9_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_O2,  0) - NVL(D.QTY_O2,  0) DF_O2_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_O4,  0) - NVL(D.QTY_O4,  0) DF_O4_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_S2,  0) - NVL(D.QTY_S2,  0) DF_S2_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_S4,  0) - NVL(D.QTY_S4,  0) DF_S4_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F2,  0) - NVL(D.QTY_F2,  0) DF_F2_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F4,  0) - NVL(D.QTY_F4,  0) DF_F4_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F5,  0) - NVL(D.QTY_F5,  0) DF_F5_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_A2,  0) - NVL(D.QTY_A2,  0) DF_A2_B" ).append("\n"); 
		query.append("      ,NVL(B.QTY_A4,  0) - NVL(D.QTY_A4,  0) DF_A4_B    " ).append("\n"); 
		query.append("      ,NVL(B.QTY_A5,  0) - NVL(D.QTY_A5,  0) DF_A5_B    " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,A.CLPT_SEQ     " ).append("\n"); 
		query.append("      ,1 SORT_FLAG" ).append("\n"); 
		query.append("FROM DUMMY_HEAD A" ).append("\n"); 
		query.append("    ,DUMMY_DSCH B" ).append("\n"); 
		query.append("    ,DUMMY_LOAD C" ).append("\n"); 
		query.append("    ,DUMMY_PLAN D" ).append("\n"); 
		query.append("WHERE A.VSL_CD     = B.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = B.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = B.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = B.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = B.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = C.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = C.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = C.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = C.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = C.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = D.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = D.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = D.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = D.POD_YD_CD(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- VVD TOTAL (YARD 없음) ---------------------------------------" ).append("\n"); 
		query.append("SELECT A.TRD_CD" ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("      ,A.SLAN_CD" ).append("\n"); 
		query.append("      ,A.WEEK" ).append("\n"); 
		query.append("      ,A.VVD " ).append("\n"); 
		query.append("      ,'TTL' YD_CD  " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL,0)) D_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,0))  D_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,0))  D_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,0))  D_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,0))  D_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,0))  D_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,0))  D_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,0))  D_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,0))  D_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,0))  D_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,0))  D_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,0))  D_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,0))  D_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,0))  D_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,0))  D_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,0))  D_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,0))  D_A4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,0))  D_A5" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_TTL,0)) L_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D2,0))  L_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D4,0))  L_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D5,0))  L_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D7,0))  L_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R2,0))  L_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R5,0))  L_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R9,0))  L_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_O2,0))  L_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_O4,0))  L_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_S2,0))  L_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_S4,0))  L_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F2,0))  L_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F4,0))  L_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F5,0))  L_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A2,0))  L_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A4,0))  L_A4    " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A5,0))  L_A5   " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL, 0) - NVL(C.QTY_TTL, 0)) DF_TTL_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,  0) - NVL(C.QTY_D2,  0)) DF_D2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,  0) - NVL(C.QTY_D4,  0)) DF_D4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,  0) - NVL(C.QTY_D5,  0)) DF_D5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,  0) - NVL(C.QTY_D7,  0)) DF_D7_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,  0) - NVL(C.QTY_R2,  0)) DF_R2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,  0) - NVL(C.QTY_R5,  0)) DF_R5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,  0) - NVL(C.QTY_R9,  0)) DF_R9_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,  0) - NVL(C.QTY_O2,  0)) DF_O2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,  0) - NVL(C.QTY_O4,  0)) DF_O4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,  0) - NVL(C.QTY_S2,  0)) DF_S2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,  0) - NVL(C.QTY_S4,  0)) DF_S4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,  0) - NVL(C.QTY_F2,  0)) DF_F2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,  0) - NVL(C.QTY_F4,  0)) DF_F4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,  0) - NVL(C.QTY_F5,  0)) DF_F5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,  0) - NVL(C.QTY_A2,  0)) DF_A2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,  0) - NVL(C.QTY_A4,  0)) DF_A4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,  0) - NVL(C.QTY_A5,  0)) DF_A5_A" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_TTL,0)) P_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D2,0))  P_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D4,0))  P_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D5,0))  P_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D7,0))  P_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R2,0))  P_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R5,0))  P_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R9,0))  P_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_O2,0))  P_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_O4,0))  P_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_S2,0))  P_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_S4,0))  P_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F2,0))  P_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F4,0))  P_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F5,0))  P_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A2,0))  P_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A4,0))  P_A4   " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A5,0))  P_A5   " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL, 0) - NVL(D.QTY_TTL, 0)) DF_TTL_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,  0) - NVL(D.QTY_D2,  0)) DF_D2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,  0) - NVL(D.QTY_D4,  0)) DF_D4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,  0) - NVL(D.QTY_D5,  0)) DF_D5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,  0) - NVL(D.QTY_D7,  0)) DF_D7_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,  0) - NVL(D.QTY_R2,  0)) DF_R2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,  0) - NVL(D.QTY_R5,  0)) DF_R5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,  0) - NVL(D.QTY_R9,  0)) DF_R9_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,  0) - NVL(D.QTY_O2,  0)) DF_O2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,  0) - NVL(D.QTY_O4,  0)) DF_O4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,  0) - NVL(D.QTY_S2,  0)) DF_S2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,  0) - NVL(D.QTY_S4,  0)) DF_S4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,  0) - NVL(D.QTY_F2,  0)) DF_F2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,  0) - NVL(D.QTY_F4,  0)) DF_F4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,  0) - NVL(D.QTY_F5,  0)) DF_F5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,  0) - NVL(D.QTY_A2,  0)) DF_A2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,  0) - NVL(D.QTY_A4,  0)) DF_A4_B " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,  0) - NVL(D.QTY_A5,  0)) DF_A5_B " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,100 CLPT_SEQ             " ).append("\n"); 
		query.append("      ,2 SORT_FLAG" ).append("\n"); 
		query.append("FROM DUMMY_HEAD A" ).append("\n"); 
		query.append("    ,DUMMY_DSCH B" ).append("\n"); 
		query.append("    ,DUMMY_LOAD C" ).append("\n"); 
		query.append("    ,DUMMY_PLAN D" ).append("\n"); 
		query.append("WHERE A.VSL_CD     = B.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = B.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = B.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = B.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = B.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = C.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = C.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = C.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = C.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = C.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = D.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = D.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = D.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = D.POD_YD_CD(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY A.TRD_CD" ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("      ,A.SLAN_CD" ).append("\n"); 
		query.append("      ,A.WEEK" ).append("\n"); 
		query.append("      ,A.VVD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- ===============================================" ).append("\n"); 
		query.append("-- VVD 검색조건인 경우 아래 SQL 은 제외(G.TTL, LANE TTL)" ).append("\n"); 
		query.append("-- ===============================================" ).append("\n"); 
		query.append("#if (${vvd_cd} == '') " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- LANE AVERAGE  TOTAL (YARD 국분) ---------------------------------------" ).append("\n"); 
		query.append("SELECT A.TRD_CD" ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("      ,A.SLAN_CD" ).append("\n"); 
		query.append("      ,'AVG PFMC' WEEK" ).append("\n"); 
		query.append("      ,' ' VVD" ).append("\n"); 
		query.append("      ,A.YD_CD  " ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_TTL,0)) D_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_D2,0))  D_D2" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_D4,0))  D_D4" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_D5,0))  D_D5" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_D7,0))  D_D7" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_R2,0))  D_R2" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_R5,0))  D_R5" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_R9,0))  D_R9" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_O2,0))  D_O2" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_O4,0))  D_O4" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_S2,0))  D_S2" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_S4,0))  D_S4" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_F2,0))  D_F2" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_F4,0))  D_F4" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_F5,0))  D_F5" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_A2,0))  D_A2" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_A4,0))  D_A4" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_A5,0))  D_A5" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_TTL,0)) L_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_D2,0))  L_D2" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_D4,0))  L_D4" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_D5,0))  L_D5" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_D7,0))  L_D7" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_R2,0))  L_R2" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_R5,0))  L_R5" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_R9,0))  L_R9" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_O2,0))  L_O2" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_O4,0))  L_O4" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_S2,0))  L_S2" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_S4,0))  L_S4" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_F2,0))  L_F2" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_F4,0))  L_F4" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_F5,0))  L_F5" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_A2,0))  L_A2" ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_A4,0))  L_A4    " ).append("\n"); 
		query.append("      ,AVG(NVL(C.QTY_A5,0))  L_A5    " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_TTL, 0) - NVL(C.QTY_TTL, 0)) DF_TTL_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_D2,  0) - NVL(C.QTY_D2,  0)) DF_D2_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_D4,  0) - NVL(C.QTY_D4,  0)) DF_D4_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_D5,  0) - NVL(C.QTY_D5,  0)) DF_D5_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_D7,  0) - NVL(C.QTY_D7,  0)) DF_D7_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_R2,  0) - NVL(C.QTY_R2,  0)) DF_R2_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_R5,  0) - NVL(C.QTY_R5,  0)) DF_R5_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_R9,  0) - NVL(C.QTY_R9,  0)) DF_R9_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_O2,  0) - NVL(C.QTY_O2,  0)) DF_O2_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_O4,  0) - NVL(C.QTY_O4,  0)) DF_O4_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_S2,  0) - NVL(C.QTY_S2,  0)) DF_S2_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_S4,  0) - NVL(C.QTY_S4,  0)) DF_S4_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_F2,  0) - NVL(C.QTY_F2,  0)) DF_F2_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_F4,  0) - NVL(C.QTY_F4,  0)) DF_F4_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_F5,  0) - NVL(C.QTY_F5,  0)) DF_F5_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_A2,  0) - NVL(C.QTY_A2,  0)) DF_A2_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_A4,  0) - NVL(C.QTY_A4,  0)) DF_A4_A" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_A5,  0) - NVL(C.QTY_A5,  0)) DF_A5_A" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_TTL,0)) P_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_D2,0))  P_D2" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_D4,0))  P_D4" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_D5,0))  P_D5" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_D7,0))  P_D7" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_R2,0))  P_R2" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_R5,0))  P_R5" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_R9,0))  P_R9" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_O2,0))  P_O2" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_O4,0))  P_O4" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_S2,0))  P_S2" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_S4,0))  P_S4" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_F2,0))  P_F2" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_F4,0))  P_F4" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_F5,0))  P_F5" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_A2,0))  P_A2" ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_A4,0))  P_A4   " ).append("\n"); 
		query.append("      ,AVG(NVL(D.QTY_A5,0))  P_A5   " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_TTL, 0) - NVL(D.QTY_TTL, 0)) DF_TTL_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_D2,  0) - NVL(D.QTY_D2,  0)) DF_D2_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_D4,  0) - NVL(D.QTY_D4,  0)) DF_D4_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_D5,  0) - NVL(D.QTY_D5,  0)) DF_D5_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_D7,  0) - NVL(D.QTY_D7,  0)) DF_D7_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_R2,  0) - NVL(D.QTY_R2,  0)) DF_R2_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_R5,  0) - NVL(D.QTY_R5,  0)) DF_R5_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_R9,  0) - NVL(D.QTY_R9,  0)) DF_R9_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_O2,  0) - NVL(D.QTY_O2,  0)) DF_O2_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_O4,  0) - NVL(D.QTY_O4,  0)) DF_O4_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_S2,  0) - NVL(D.QTY_S2,  0)) DF_S2_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_S4,  0) - NVL(D.QTY_S4,  0)) DF_S4_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_F2,  0) - NVL(D.QTY_F2,  0)) DF_F2_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_F4,  0) - NVL(D.QTY_F4,  0)) DF_F4_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_F5,  0) - NVL(D.QTY_F5,  0)) DF_F5_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_A2,  0) - NVL(D.QTY_A2,  0)) DF_A2_B" ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_A4,  0) - NVL(D.QTY_A4,  0)) DF_A4_B    " ).append("\n"); 
		query.append("      ,AVG(NVL(B.QTY_A5,  0) - NVL(D.QTY_A5,  0)) DF_A5_B    " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,0 CLPT_SEQ                " ).append("\n"); 
		query.append("      ,3 SORT_FLAG" ).append("\n"); 
		query.append("FROM DUMMY_HEAD A" ).append("\n"); 
		query.append("    ,DUMMY_DSCH B" ).append("\n"); 
		query.append("    ,DUMMY_LOAD C" ).append("\n"); 
		query.append("    ,DUMMY_PLAN D" ).append("\n"); 
		query.append("WHERE A.VSL_CD     = B.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = B.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = B.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = B.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = B.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = C.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = C.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = C.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = C.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = C.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = D.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = D.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = D.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = D.POD_YD_CD(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY A.TRD_CD" ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("      ,A.SLAN_CD " ).append("\n"); 
		query.append("      ,A.YD_CD    " ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- LANE AVERAGE  TOTAL (YARD 없음) ---------------------------------------" ).append("\n"); 
		query.append("SELECT A.TRD_CD" ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("      ,A.SLAN_CD" ).append("\n"); 
		query.append("      ,'AVG PFMC' WEEK" ).append("\n"); 
		query.append("      ,'' VVD" ).append("\n"); 
		query.append("      ,'TTL' YD_CD   " ).append("\n"); 
		query.append("      ,SUM(D_TTL)" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(D_D2 ) " ).append("\n"); 
		query.append("      ,SUM(D_D4 )" ).append("\n"); 
		query.append("      ,SUM(D_D5 )" ).append("\n"); 
		query.append("      ,SUM(D_D7 )" ).append("\n"); 
		query.append("      ,SUM(D_R2 )" ).append("\n"); 
		query.append("      ,SUM(D_R5 )" ).append("\n"); 
		query.append("      ,SUM(D_R9 )" ).append("\n"); 
		query.append("      ,SUM(D_O2 )" ).append("\n"); 
		query.append("      ,SUM(D_O4 )" ).append("\n"); 
		query.append("      ,SUM(D_S2 )" ).append("\n"); 
		query.append("      ,SUM(D_S4 )" ).append("\n"); 
		query.append("      ,SUM(D_F2 )" ).append("\n"); 
		query.append("      ,SUM(D_F4 )" ).append("\n"); 
		query.append("      ,SUM(D_F5 )" ).append("\n"); 
		query.append("      ,SUM(D_A2 )" ).append("\n"); 
		query.append("      ,SUM(D_A4 )" ).append("\n"); 
		query.append("      ,SUM(D_A5 )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      ,SUM(L_TTL)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      ,SUM(L_D2 )" ).append("\n"); 
		query.append("      ,SUM(L_D4 )" ).append("\n"); 
		query.append("      ,SUM(L_D5 )" ).append("\n"); 
		query.append("      ,SUM(L_D7 )" ).append("\n"); 
		query.append("      ,SUM(L_R2 )" ).append("\n"); 
		query.append("      ,SUM(L_R5 )" ).append("\n"); 
		query.append("      ,SUM(L_R9 )" ).append("\n"); 
		query.append("      ,SUM(L_O2 )" ).append("\n"); 
		query.append("      ,SUM(L_O4 )" ).append("\n"); 
		query.append("      ,SUM(L_S2 )" ).append("\n"); 
		query.append("      ,SUM(L_S4 )" ).append("\n"); 
		query.append("      ,SUM(L_F2 )" ).append("\n"); 
		query.append("      ,SUM(L_F4 )" ).append("\n"); 
		query.append("      ,SUM(L_F5 )" ).append("\n"); 
		query.append("      ,SUM(L_A2 )" ).append("\n"); 
		query.append("      ,SUM(L_A4 )   " ).append("\n"); 
		query.append("      ,SUM(L_A5 )" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(DF_TTL_A)" ).append("\n"); 
		query.append("      ,SUM(DF_D2_A)" ).append("\n"); 
		query.append("      ,SUM(DF_D4_A)" ).append("\n"); 
		query.append("      ,SUM(DF_D5_A)" ).append("\n"); 
		query.append("      ,SUM(DF_D7_A)" ).append("\n"); 
		query.append("      ,SUM(DF_R2_A)" ).append("\n"); 
		query.append("      ,SUM(DF_R5_A)" ).append("\n"); 
		query.append("      ,SUM(DF_R9_A)" ).append("\n"); 
		query.append("      ,SUM(DF_O2_A)" ).append("\n"); 
		query.append("      ,SUM(DF_O4_A)" ).append("\n"); 
		query.append("      ,SUM(DF_S2_A)" ).append("\n"); 
		query.append("      ,SUM(DF_S4_A)" ).append("\n"); 
		query.append("      ,SUM(DF_F2_A)" ).append("\n"); 
		query.append("      ,SUM(DF_F4_A)" ).append("\n"); 
		query.append("      ,SUM(DF_F5_A)" ).append("\n"); 
		query.append("      ,SUM(DF_A2_A)" ).append("\n"); 
		query.append("      ,SUM(DF_A4_A)" ).append("\n"); 
		query.append("      ,SUM(DF_A5_A)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(P_TTL)" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(P_D2)" ).append("\n"); 
		query.append("      ,SUM(P_D4)" ).append("\n"); 
		query.append("      ,SUM(P_D5)" ).append("\n"); 
		query.append("      ,SUM(P_D7)" ).append("\n"); 
		query.append("      ,SUM(P_R2)" ).append("\n"); 
		query.append("      ,SUM(P_R5)" ).append("\n"); 
		query.append("      ,SUM(P_R9)" ).append("\n"); 
		query.append("      ,SUM(P_O2)" ).append("\n"); 
		query.append("      ,SUM(P_O4)" ).append("\n"); 
		query.append("      ,SUM(P_S2)" ).append("\n"); 
		query.append("      ,SUM(P_S4)" ).append("\n"); 
		query.append("      ,SUM(P_F2)" ).append("\n"); 
		query.append("      ,SUM(P_F4)" ).append("\n"); 
		query.append("      ,SUM(P_F5)" ).append("\n"); 
		query.append("      ,SUM(P_A2)" ).append("\n"); 
		query.append("      ,SUM(P_A4)   " ).append("\n"); 
		query.append("      ,SUM(P_A5)" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(DF_TTL_B)" ).append("\n"); 
		query.append("      ,SUM(DF_D2_B)" ).append("\n"); 
		query.append("      ,SUM(DF_D4_B)" ).append("\n"); 
		query.append("      ,SUM(DF_D5_B)" ).append("\n"); 
		query.append("      ,SUM(DF_D7_B)" ).append("\n"); 
		query.append("      ,SUM(DF_R2_B)" ).append("\n"); 
		query.append("      ,SUM(DF_R5_B)" ).append("\n"); 
		query.append("      ,SUM(DF_R9_B)" ).append("\n"); 
		query.append("      ,SUM(DF_O2_B)" ).append("\n"); 
		query.append("      ,SUM(DF_O4_B)" ).append("\n"); 
		query.append("      ,SUM(DF_S2_B)" ).append("\n"); 
		query.append("      ,SUM(DF_S4_B)" ).append("\n"); 
		query.append("      ,SUM(DF_F2_B)" ).append("\n"); 
		query.append("      ,SUM(DF_F4_B)" ).append("\n"); 
		query.append("      ,SUM(DF_F5_B)" ).append("\n"); 
		query.append("      ,SUM(DF_A2_B)" ).append("\n"); 
		query.append("      ,SUM(DF_A4_B)    " ).append("\n"); 
		query.append("      ,SUM(DF_A5_B)    " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,100 CLPT_SEQ                " ).append("\n"); 
		query.append("      ,4 SORT_FLAG" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(      " ).append("\n"); 
		query.append("    SELECT A.TRD_CD" ).append("\n"); 
		query.append("          ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("          ,A.SLAN_CD" ).append("\n"); 
		query.append("          ,'' WEEK" ).append("\n"); 
		query.append("          ,'' VVD" ).append("\n"); 
		query.append("          ,A.YD_CD  " ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_TTL,0)) D_TTL" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_D2,0))  D_D2" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_D4,0))  D_D4" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_D5,0))  D_D5" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_D7,0))  D_D7" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_R2,0))  D_R2" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_R5,0))  D_R5" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_R9,0))  D_R9" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_O2,0))  D_O2" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_O4,0))  D_O4" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_S2,0))  D_S2" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_S4,0))  D_S4" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_F2,0))  D_F2" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_F4,0))  D_F4" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_F5,0))  D_F5" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_A2,0))  D_A2" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_A4,0))  D_A4" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_A5,0))  D_A5" ).append("\n"); 
		query.append("          " ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_TTL,0)) L_TTL" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_D2,0))  L_D2" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_D4,0))  L_D4" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_D5,0))  L_D5" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_D7,0))  L_D7" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_R2,0))  L_R2" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_R5,0))  L_R5" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_R9,0))  L_R9" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_O2,0))  L_O2" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_O4,0))  L_O4" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_S2,0))  L_S2" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_S4,0))  L_S4" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_F2,0))  L_F2" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_F4,0))  L_F4" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_F5,0))  L_F5" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_A2,0))  L_A2" ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_A4,0))  L_A4    " ).append("\n"); 
		query.append("          ,AVG(NVL(C.QTY_A5,0))  L_A5   " ).append("\n"); 
		query.append("          " ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_TTL, 0) - NVL(C.QTY_TTL, 0)) DF_TTL_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_D2,  0) - NVL(C.QTY_D2,  0)) DF_D2_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_D4,  0) - NVL(C.QTY_D4,  0)) DF_D4_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_D5,  0) - NVL(C.QTY_D5,  0)) DF_D5_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_D7,  0) - NVL(C.QTY_D7,  0)) DF_D7_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_R2,  0) - NVL(C.QTY_R2,  0)) DF_R2_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_R5,  0) - NVL(C.QTY_R5,  0)) DF_R5_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_R9,  0) - NVL(C.QTY_R9,  0)) DF_R9_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_O2,  0) - NVL(C.QTY_O2,  0)) DF_O2_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_O4,  0) - NVL(C.QTY_O4,  0)) DF_O4_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_S2,  0) - NVL(C.QTY_S2,  0)) DF_S2_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_S4,  0) - NVL(C.QTY_S4,  0)) DF_S4_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_F2,  0) - NVL(C.QTY_F2,  0)) DF_F2_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_F4,  0) - NVL(C.QTY_F4,  0)) DF_F4_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_F5,  0) - NVL(C.QTY_F5,  0)) DF_F5_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_A2,  0) - NVL(C.QTY_A2,  0)) DF_A2_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_A4,  0) - NVL(C.QTY_A4,  0)) DF_A4_A" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_A5,  0) - NVL(C.QTY_A5,  0)) DF_A5_A" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("          " ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_TTL,0)) P_TTL" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_D2,0))  P_D2" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_D4,0))  P_D4" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_D5,0))  P_D5" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_D7,0))  P_D7" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_R2,0))  P_R2" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_R5,0))  P_R5" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_R9,0))  P_R9" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_O2,0))  P_O2" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_O4,0))  P_O4" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_S2,0))  P_S2" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_S4,0))  P_S4" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_F2,0))  P_F2" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_F4,0))  P_F4" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_F5,0))  P_F5" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_A2,0))  P_A2" ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_A4,0))  P_A4   " ).append("\n"); 
		query.append("          ,AVG(NVL(D.QTY_A5,0))  P_A5" ).append("\n"); 
		query.append("          " ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_TTL, 0) - NVL(D.QTY_TTL, 0)) DF_TTL_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_D2,  0) - NVL(D.QTY_D2,  0)) DF_D2_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_D4,  0) - NVL(D.QTY_D4,  0)) DF_D4_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_D5,  0) - NVL(D.QTY_D5,  0)) DF_D5_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_D7,  0) - NVL(D.QTY_D7,  0)) DF_D7_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_R2,  0) - NVL(D.QTY_R2,  0)) DF_R2_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_R5,  0) - NVL(D.QTY_R5,  0)) DF_R5_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_R9,  0) - NVL(D.QTY_R9,  0)) DF_R9_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_O2,  0) - NVL(D.QTY_O2,  0)) DF_O2_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_O4,  0) - NVL(D.QTY_O4,  0)) DF_O4_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_S2,  0) - NVL(D.QTY_S2,  0)) DF_S2_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_S4,  0) - NVL(D.QTY_S4,  0)) DF_S4_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_F2,  0) - NVL(D.QTY_F2,  0)) DF_F2_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_F4,  0) - NVL(D.QTY_F4,  0)) DF_F4_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_F5,  0) - NVL(D.QTY_F5,  0)) DF_F5_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_A2,  0) - NVL(D.QTY_A2,  0)) DF_A2_B" ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_A4,  0) - NVL(D.QTY_A4,  0)) DF_A4_B    " ).append("\n"); 
		query.append("          ,AVG(NVL(B.QTY_A5,  0) - NVL(D.QTY_A5,  0)) DF_A5_B    " ).append("\n"); 
		query.append("          " ).append("\n"); 
		query.append("          ,0 CLPT_SEQ                " ).append("\n"); 
		query.append("          ,3 SORT_FLAG" ).append("\n"); 
		query.append("    FROM DUMMY_HEAD A" ).append("\n"); 
		query.append("        ,DUMMY_DSCH B" ).append("\n"); 
		query.append("        ,DUMMY_LOAD C" ).append("\n"); 
		query.append("        ,DUMMY_PLAN D" ).append("\n"); 
		query.append("    WHERE A.VSL_CD     = B.VSL_CD(+)" ).append("\n"); 
		query.append("    AND   A.SKD_VOY_NO = B.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("    AND   A.DIR_CD     = B.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("    AND   A.YD_CD      = B.POD_YD_CD(+)" ).append("\n"); 
		query.append("    AND   A.CLPT_IND_SEQ = B.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("    AND   A.VSL_CD     = C.VSL_CD(+)" ).append("\n"); 
		query.append("    AND   A.SKD_VOY_NO = C.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("    AND   A.DIR_CD     = C.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("    AND   A.YD_CD      = C.POD_YD_CD(+)" ).append("\n"); 
		query.append("    AND   A.CLPT_IND_SEQ = C.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("    AND   A.VSL_CD     = D.VSL_CD(+)" ).append("\n"); 
		query.append("    AND   A.SKD_VOY_NO = D.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("    AND   A.DIR_CD     = D.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("    AND   A.YD_CD      = D.POD_YD_CD(+)" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    GROUP BY A.TRD_CD" ).append("\n"); 
		query.append("          ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("          ,A.SLAN_CD " ).append("\n"); 
		query.append("          ,A.YD_CD    " ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append(") A" ).append("\n"); 
		query.append("GROUP BY  A.TRD_CD" ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("      ,A.SLAN_CD      " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- SUB TRADE TOTAL (YARD  구분) ---------------------------------------" ).append("\n"); 
		query.append("SELECT A.TRD_CD" ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("      ,'ZTTL' SLAN_CD" ).append("\n"); 
		query.append("      ,'' WEEK" ).append("\n"); 
		query.append("      ,'' VVD" ).append("\n"); 
		query.append("      ,A.YD_CD  " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL,0)) D_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,0))  D_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,0))  D_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,0))  D_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,0))  D_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,0))  D_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,0))  D_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,0))  D_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,0))  D_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,0))  D_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,0))  D_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,0))  D_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,0))  D_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,0))  D_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,0))  D_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,0))  D_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,0))  D_A4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,0))  D_A5" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_TTL,0)) L_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D2,0))  L_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D4,0))  L_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D5,0))  L_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D7,0))  L_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R2,0))  L_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R5,0))  L_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R9,0))  L_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_O2,0))  L_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_O4,0))  L_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_S2,0))  L_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_S4,0))  L_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F2,0))  L_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F4,0))  L_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F5,0))  L_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A2,0))  L_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A4,0))  L_A4    " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A5,0))  L_A5 " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL, 0) - NVL(C.QTY_TTL, 0)) DF_TTL_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,  0) - NVL(C.QTY_D2,  0)) DF_D2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,  0) - NVL(C.QTY_D4,  0)) DF_D4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,  0) - NVL(C.QTY_D5,  0)) DF_D5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,  0) - NVL(C.QTY_D7,  0)) DF_D7_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,  0) - NVL(C.QTY_R2,  0)) DF_R2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,  0) - NVL(C.QTY_R5,  0)) DF_R5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,  0) - NVL(C.QTY_R9,  0)) DF_R9_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,  0) - NVL(C.QTY_O2,  0)) DF_O2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,  0) - NVL(C.QTY_O4,  0)) DF_O4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,  0) - NVL(C.QTY_S2,  0)) DF_S2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,  0) - NVL(C.QTY_S4,  0)) DF_S4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,  0) - NVL(C.QTY_F2,  0)) DF_F2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,  0) - NVL(C.QTY_F4,  0)) DF_F4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,  0) - NVL(C.QTY_F5,  0)) DF_F5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,  0) - NVL(C.QTY_A2,  0)) DF_A2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,  0) - NVL(C.QTY_A4,  0)) DF_A4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,  0) - NVL(C.QTY_A5,  0)) DF_A5_A" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_TTL,0)) P_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D2,0))  P_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D4,0))  P_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D5,0))  P_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D7,0))  P_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R2,0))  P_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R5,0))  P_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R9,0))  P_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_O2,0))  P_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_O4,0))  P_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_S2,0))  P_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_S4,0))  P_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F2,0))  P_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F4,0))  P_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F5,0))  P_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A2,0))  P_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A4,0))  P_A4   " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A5,0))  P_A5   " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL, 0) - NVL(D.QTY_TTL, 0)) DF_TTL_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,  0) - NVL(D.QTY_D2,  0)) DF_D2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,  0) - NVL(D.QTY_D4,  0)) DF_D4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,  0) - NVL(D.QTY_D5,  0)) DF_D5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,  0) - NVL(D.QTY_D7,  0)) DF_D7_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,  0) - NVL(D.QTY_R2,  0)) DF_R2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,  0) - NVL(D.QTY_R5,  0)) DF_R5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,  0) - NVL(D.QTY_R9,  0)) DF_R9_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,  0) - NVL(D.QTY_O2,  0)) DF_O2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,  0) - NVL(D.QTY_O4,  0)) DF_O4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,  0) - NVL(D.QTY_S2,  0)) DF_S2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,  0) - NVL(D.QTY_S4,  0)) DF_S4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,  0) - NVL(D.QTY_F2,  0)) DF_F2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,  0) - NVL(D.QTY_F4,  0)) DF_F4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,  0) - NVL(D.QTY_F5,  0)) DF_F5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,  0) - NVL(D.QTY_A2,  0)) DF_A2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,  0) - NVL(D.QTY_A4,  0)) DF_A4_B " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,  0) - NVL(D.QTY_A5,  0)) DF_A5_B " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,0 CLPT_SEQ             " ).append("\n"); 
		query.append("      ,5 SORT_FLAG" ).append("\n"); 
		query.append("FROM DUMMY_HEAD A" ).append("\n"); 
		query.append("    ,DUMMY_DSCH B" ).append("\n"); 
		query.append("    ,DUMMY_LOAD C" ).append("\n"); 
		query.append("    ,DUMMY_PLAN D" ).append("\n"); 
		query.append("WHERE A.VSL_CD     = B.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = B.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = B.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = B.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = B.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = C.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = C.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = C.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = C.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = C.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = D.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = D.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = D.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = D.POD_YD_CD(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY A.TRD_CD" ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD " ).append("\n"); 
		query.append("      ,A.YD_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- SUB TRADE TOTAL (YARD 없음) ---------------------------------------" ).append("\n"); 
		query.append("SELECT A.TRD_CD" ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD " ).append("\n"); 
		query.append("      ,'' SLAN_CD" ).append("\n"); 
		query.append("      ,'' WEEK" ).append("\n"); 
		query.append("      ,'' VVD" ).append("\n"); 
		query.append("      ,'TTL' YD_CD  " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL,0)) D_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,0))  D_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,0))  D_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,0))  D_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,0))  D_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,0))  D_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,0))  D_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,0))  D_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,0))  D_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,0))  D_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,0))  D_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,0))  D_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,0))  D_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,0))  D_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,0))  D_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,0))  D_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,0))  D_A4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,0))  D_A5" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_TTL,0)) L_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D2,0))  L_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D4,0))  L_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D5,0))  L_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D7,0))  L_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R2,0))  L_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R5,0))  L_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R9,0))  L_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_O2,0))  L_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_O4,0))  L_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_S2,0))  L_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_S4,0))  L_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F2,0))  L_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F4,0))  L_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F5,0))  L_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A2,0))  L_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A4,0))  L_A4    " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A5,0))  L_A5    " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL, 0) - NVL(C.QTY_TTL, 0)) DF_TTL_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,  0) - NVL(C.QTY_D2,  0)) DF_D2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,  0) - NVL(C.QTY_D4,  0)) DF_D4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,  0) - NVL(C.QTY_D5,  0)) DF_D5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,  0) - NVL(C.QTY_D7,  0)) DF_D7_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,  0) - NVL(C.QTY_R2,  0)) DF_R2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,  0) - NVL(C.QTY_R5,  0)) DF_R5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,  0) - NVL(C.QTY_R9,  0)) DF_R9_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,  0) - NVL(C.QTY_O2,  0)) DF_O2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,  0) - NVL(C.QTY_O4,  0)) DF_O4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,  0) - NVL(C.QTY_S2,  0)) DF_S2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,  0) - NVL(C.QTY_S4,  0)) DF_S4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,  0) - NVL(C.QTY_F2,  0)) DF_F2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,  0) - NVL(C.QTY_F4,  0)) DF_F4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,  0) - NVL(C.QTY_F5,  0)) DF_F5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,  0) - NVL(C.QTY_A2,  0)) DF_A2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,  0) - NVL(C.QTY_A4,  0)) DF_A4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,  0) - NVL(C.QTY_A5,  0)) DF_A5_A" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_TTL,0)) P_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D2,0))  P_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D4,0))  P_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D5,0))  P_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D7,0))  P_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R2,0))  P_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R5,0))  P_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R9,0))  P_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_O2,0))  P_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_O4,0))  P_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_S2,0))  P_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_S4,0))  P_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F2,0))  P_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F4,0))  P_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F5,0))  P_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A2,0))  P_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A4,0))  P_A4   " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A5,0))  P_A5  " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL, 0) - NVL(D.QTY_TTL, 0)) DF_TTL_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,  0) - NVL(D.QTY_D2,  0)) DF_D2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,  0) - NVL(D.QTY_D4,  0)) DF_D4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,  0) - NVL(D.QTY_D5,  0)) DF_D5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,  0) - NVL(D.QTY_D7,  0)) DF_D7_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,  0) - NVL(D.QTY_R2,  0)) DF_R2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,  0) - NVL(D.QTY_R5,  0)) DF_R5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,  0) - NVL(D.QTY_R9,  0)) DF_R9_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,  0) - NVL(D.QTY_O2,  0)) DF_O2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,  0) - NVL(D.QTY_O4,  0)) DF_O4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,  0) - NVL(D.QTY_S2,  0)) DF_S2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,  0) - NVL(D.QTY_S4,  0)) DF_S4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,  0) - NVL(D.QTY_F2,  0)) DF_F2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,  0) - NVL(D.QTY_F4,  0)) DF_F4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,  0) - NVL(D.QTY_F5,  0)) DF_F5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,  0) - NVL(D.QTY_A2,  0)) DF_A2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,  0) - NVL(D.QTY_A4,  0)) DF_A4_B " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,  0) - NVL(D.QTY_A5,  0)) DF_A5_B " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,100 CLPT_SEQ             " ).append("\n"); 
		query.append("      ,6 SORT_FLAG" ).append("\n"); 
		query.append("FROM DUMMY_HEAD A" ).append("\n"); 
		query.append("    ,DUMMY_DSCH B" ).append("\n"); 
		query.append("    ,DUMMY_LOAD C" ).append("\n"); 
		query.append("    ,DUMMY_PLAN D" ).append("\n"); 
		query.append("WHERE A.VSL_CD     = B.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = B.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = B.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = B.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = B.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = C.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = C.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = C.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = C.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = C.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = D.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = D.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = D.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = D.POD_YD_CD(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY  A.TRD_CD" ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD  " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-- GRAND TOTAL (YARD 구분) ---------------------------------------" ).append("\n"); 
		query.append("SELECT 'ZTTL' TRD_CD" ).append("\n"); 
		query.append("      ,'' SUB_TRD_CD" ).append("\n"); 
		query.append("      ,'' SLAN_CD" ).append("\n"); 
		query.append("      ,'' WEEK" ).append("\n"); 
		query.append("      ,'' VVD" ).append("\n"); 
		query.append("      ,A.YD_CD  " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL,0)) D_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,0))  D_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,0))  D_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,0))  D_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,0))  D_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,0))  D_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,0))  D_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,0))  D_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,0))  D_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,0))  D_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,0))  D_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,0))  D_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,0))  D_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,0))  D_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,0))  D_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,0))  D_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,0))  D_A4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,0))  D_A5" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_TTL,0)) L_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D2,0))  L_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D4,0))  L_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D5,0))  L_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D7,0))  L_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R2,0))  L_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R5,0))  L_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R9,0))  L_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_O2,0))  L_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_O4,0))  L_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_S2,0))  L_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_S4,0))  L_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F2,0))  L_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F4,0))  L_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F5,0))  L_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A2,0))  L_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A4,0))  L_A4    " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A5,0))  L_A5" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL, 0) - NVL(C.QTY_TTL, 0)) DF_TTL_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,  0) - NVL(C.QTY_D2,  0)) DF_D2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,  0) - NVL(C.QTY_D4,  0)) DF_D4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,  0) - NVL(C.QTY_D5,  0)) DF_D5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,  0) - NVL(C.QTY_D7,  0)) DF_D7_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,  0) - NVL(C.QTY_R2,  0)) DF_R2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,  0) - NVL(C.QTY_R5,  0)) DF_R5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,  0) - NVL(C.QTY_R9,  0)) DF_R9_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,  0) - NVL(C.QTY_O2,  0)) DF_O2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,  0) - NVL(C.QTY_O4,  0)) DF_O4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,  0) - NVL(C.QTY_S2,  0)) DF_S2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,  0) - NVL(C.QTY_S4,  0)) DF_S4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,  0) - NVL(C.QTY_F2,  0)) DF_F2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,  0) - NVL(C.QTY_F4,  0)) DF_F4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,  0) - NVL(C.QTY_F5,  0)) DF_F5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,  0) - NVL(C.QTY_A2,  0)) DF_A2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,  0) - NVL(C.QTY_A4,  0)) DF_A4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,  0) - NVL(C.QTY_A5,  0)) DF_A5_A" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_TTL,0)) P_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D2,0))  P_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D4,0))  P_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D5,0))  P_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D7,0))  P_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R2,0))  P_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R5,0))  P_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R9,0))  P_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_O2,0))  P_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_O4,0))  P_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_S2,0))  P_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_S4,0))  P_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F2,0))  P_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F4,0))  P_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F5,0))  P_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A2,0))  P_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A4,0))  P_A4   " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A5,0))  P_A5  " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL, 0) - NVL(D.QTY_TTL, 0)) DF_TTL_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,  0) - NVL(D.QTY_D2,  0)) DF_D2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,  0) - NVL(D.QTY_D4,  0)) DF_D4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,  0) - NVL(D.QTY_D5,  0)) DF_D5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,  0) - NVL(D.QTY_D7,  0)) DF_D7_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,  0) - NVL(D.QTY_R2,  0)) DF_R2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,  0) - NVL(D.QTY_R5,  0)) DF_R5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,  0) - NVL(D.QTY_R9,  0)) DF_R9_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,  0) - NVL(D.QTY_O2,  0)) DF_O2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,  0) - NVL(D.QTY_O4,  0)) DF_O4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,  0) - NVL(D.QTY_S2,  0)) DF_S2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,  0) - NVL(D.QTY_S4,  0)) DF_S4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,  0) - NVL(D.QTY_F2,  0)) DF_F2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,  0) - NVL(D.QTY_F4,  0)) DF_F4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,  0) - NVL(D.QTY_F5,  0)) DF_F5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,  0) - NVL(D.QTY_A2,  0)) DF_A2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,  0) - NVL(D.QTY_A4,  0)) DF_A4_B " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,  0) - NVL(D.QTY_A5,  0)) DF_A5_B " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,0 CLPT_SEQ             " ).append("\n"); 
		query.append("      ,7 SORT_FLAG" ).append("\n"); 
		query.append("FROM DUMMY_HEAD A" ).append("\n"); 
		query.append("    ,DUMMY_DSCH B" ).append("\n"); 
		query.append("    ,DUMMY_LOAD C" ).append("\n"); 
		query.append("    ,DUMMY_PLAN D" ).append("\n"); 
		query.append("WHERE A.VSL_CD     = B.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = B.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = B.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = B.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = B.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = C.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = C.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = C.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = C.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = C.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = D.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = D.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = D.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = D.POD_YD_CD(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY A.YD_CD" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- GRAND TOTAL (YARD 없음) ---------------------------------------" ).append("\n"); 
		query.append("SELECT 'ZTTL' TRD_CD" ).append("\n"); 
		query.append("      ,'' SUB_TRD_CD" ).append("\n"); 
		query.append("      ,'' SLAN_CD" ).append("\n"); 
		query.append("      ,'' WEEK" ).append("\n"); 
		query.append("      ,'' VVD" ).append("\n"); 
		query.append("      ,'TTL' YD_CD  " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL,0)) D_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,0))  D_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,0))  D_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,0))  D_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,0))  D_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,0))  D_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,0))  D_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,0))  D_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,0))  D_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,0))  D_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,0))  D_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,0))  D_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,0))  D_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,0))  D_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,0))  D_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,0))  D_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,0))  D_A4" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,0))  D_A5" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_TTL,0)) L_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D2,0))  L_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D4,0))  L_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D5,0))  L_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_D7,0))  L_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R2,0))  L_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R5,0))  L_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_R9,0))  L_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_O2,0))  L_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_O4,0))  L_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_S2,0))  L_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_S4,0))  L_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F2,0))  L_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F4,0))  L_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_F5,0))  L_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A2,0))  L_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A4,0))  L_A4    " ).append("\n"); 
		query.append("      ,SUM(NVL(C.QTY_A5,0))  L_A5" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL, 0) - NVL(C.QTY_TTL, 0)) DF_TTL_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,  0) - NVL(C.QTY_D2,  0)) DF_D2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,  0) - NVL(C.QTY_D4,  0)) DF_D4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,  0) - NVL(C.QTY_D5,  0)) DF_D5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,  0) - NVL(C.QTY_D7,  0)) DF_D7_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,  0) - NVL(C.QTY_R2,  0)) DF_R2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,  0) - NVL(C.QTY_R5,  0)) DF_R5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,  0) - NVL(C.QTY_R9,  0)) DF_R9_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,  0) - NVL(C.QTY_O2,  0)) DF_O2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,  0) - NVL(C.QTY_O4,  0)) DF_O4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,  0) - NVL(C.QTY_S2,  0)) DF_S2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,  0) - NVL(C.QTY_S4,  0)) DF_S4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,  0) - NVL(C.QTY_F2,  0)) DF_F2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,  0) - NVL(C.QTY_F4,  0)) DF_F4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,  0) - NVL(C.QTY_F5,  0)) DF_F5_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,  0) - NVL(C.QTY_A2,  0)) DF_A2_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,  0) - NVL(C.QTY_A4,  0)) DF_A4_A" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,  0) - NVL(C.QTY_A5,  0)) DF_A5_A" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_TTL,0)) P_TTL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D2,0))  P_D2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D4,0))  P_D4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D5,0))  P_D5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_D7,0))  P_D7" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R2,0))  P_R2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R5,0))  P_R5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_R9,0))  P_R9" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_O2,0))  P_O2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_O4,0))  P_O4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_S2,0))  P_S2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_S4,0))  P_S4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F2,0))  P_F2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F4,0))  P_F4" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_F5,0))  P_F5" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A2,0))  P_A2" ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A4,0))  P_A4   " ).append("\n"); 
		query.append("      ,SUM(NVL(D.QTY_A5,0))  P_A5   " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_TTL, 0) - NVL(D.QTY_TTL, 0)) DF_TTL_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D2,  0) - NVL(D.QTY_D2,  0)) DF_D2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D4,  0) - NVL(D.QTY_D4,  0)) DF_D4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D5,  0) - NVL(D.QTY_D5,  0)) DF_D5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_D7,  0) - NVL(D.QTY_D7,  0)) DF_D7_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R2,  0) - NVL(D.QTY_R2,  0)) DF_R2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R5,  0) - NVL(D.QTY_R5,  0)) DF_R5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_R9,  0) - NVL(D.QTY_R9,  0)) DF_R9_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O2,  0) - NVL(D.QTY_O2,  0)) DF_O2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_O4,  0) - NVL(D.QTY_O4,  0)) DF_O4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S2,  0) - NVL(D.QTY_S2,  0)) DF_S2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_S4,  0) - NVL(D.QTY_S4,  0)) DF_S4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F2,  0) - NVL(D.QTY_F2,  0)) DF_F2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F4,  0) - NVL(D.QTY_F4,  0)) DF_F4_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_F5,  0) - NVL(D.QTY_F5,  0)) DF_F5_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A2,  0) - NVL(D.QTY_A2,  0)) DF_A2_B" ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A4,  0) - NVL(D.QTY_A4,  0)) DF_A4_B " ).append("\n"); 
		query.append("      ,SUM(NVL(B.QTY_A5,  0) - NVL(D.QTY_A5,  0)) DF_A5_B " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,100 CLPT_SEQ             " ).append("\n"); 
		query.append("      ,8 SORT_FLAG" ).append("\n"); 
		query.append("FROM DUMMY_HEAD A" ).append("\n"); 
		query.append("    ,DUMMY_DSCH B" ).append("\n"); 
		query.append("    ,DUMMY_LOAD C" ).append("\n"); 
		query.append("    ,DUMMY_PLAN D" ).append("\n"); 
		query.append("WHERE A.VSL_CD     = B.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = B.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = B.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = B.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = B.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = C.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = C.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = C.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = C.POD_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = C.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = D.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = D.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = D.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = D.POD_YD_CD(+)" ).append("\n"); 
		query.append("-- [종료]VVD 검색조건인 경우 아래 SQL 은 제외(G.TTL, LANE TTL)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("ORDER BY TRD_CD" ).append("\n"); 
		query.append("        ,SUB_TRD_CD" ).append("\n"); 
		query.append("        ,SLAN_CD" ).append("\n"); 
		query.append("        ,WEEK" ).append("\n"); 
		query.append("        ,VVD" ).append("\n"); 
		query.append("        ,CLPT_SEQ" ).append("\n"); 
		query.append("        ,YD_CD" ).append("\n"); 

	}
}