<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CntrRepoPlanSensitivityAnalysisDBDAOSearchPlanSensivity02RSQL">
			<desc><![CDATA[ON/Off Hire 민감도 조회 쿼리]]></desc>
			<sql><![CDATA[
SELECT SUBSTR(B.PLN_YRWK,1,4) || '-' || SUBSTR(B.PLN_YRWK,5,2) WEEK      
	    , @[sens_typ] SENSITY        
	    , @[obj_txt] OBJ 
#if (${costobj} == 'O') 
 	--	, '' FM_LOC	                                           	
		, B.ECC_CD FM_LOC
#elseif (${costobj} == 'F') 
 		, B.ECC_CD FM_LOC	                                      	
     --   , '' FM_LOC	       
#end                                                       	
        , D.CNTR_TPSZ_CD TS_TYPE                                                    
        , SUM(D.CNTR_QTY) VOL                                          	
        , SUM(D.ONF_HIR_COST_AMT) CURR_COST                                  
        , '' COST_RANGE
        , '' COST_RANGE1 
FROM EQR_EQ_REPO_PLN A                                                    
     , EQR_ONF_HIR_PLN B                                                  
     , (SELECT ECC_CD, LCC_CD, RCC_CD FROM EQR_ECC_MST) C
     , EQR_ONF_HIR_PLN_QTY D	             	
WHERE A.REPO_PLN_ID = B.REPO_PLN_ID                                       
AND B.ECC_CD = C.ECC_CD                                             
AND A.REPO_PLN_ID = @[repo_pln_id]                                 				
AND B.ONF_HIR_DIV_CD = @[costobj]
AND D.CNTR_TPSZ_CD IN (${arrtpszcd})	                                           	
AND B.REPO_PLN_ID = D.REPO_PLN_ID
AND B.PLN_YRWK    = D.PLN_YRWK
AND B.PLN_SEQ     = D.PLN_SEQ
#if (${costobj} == 'O') 
AND B.PLN_YRWK BETWEEN @[tostartprd] AND @[toendprd]	
#elseif (${costobj} == 'F') 
AND B.PLN_YRWK BETWEEN @[fmstartprd] AND @[fmendprd]	
#end                            	
#if (${costobj} == 'O') 
#if (${toecccd} != '') 
	#if (${totype} == 'R')
AND C.RCC_CD IN (${arrtoecccd}) 
	#end
   	#if (${totype} == 'L')
AND C.LCC_CD IN (${arrtoecccd})
	#end
   	#if (${totype} == 'E')
AND C.ECC_CD IN (${arrtoecccd})
	#end
#end
#elseif (${costobj} == 'F') 
#if (${fmecccd} != '') 
  	#if (${fmtype} == 'R')
 AND C.RCC_CD IN (${arrfmecccd}) 
    #end
   	#if (${fmtype} == 'L')
 AND C.LCC_CD IN (${arrfmecccd})
    #end
   	#if (${fmtype} == 'E')
 AND C.ECC_CD IN (${arrfmecccd})
    #end
#end 
#end			                         	
 GROUP BY B.PLN_YRWK, B.ECC_CD, CNTR_TPSZ_CD								
 ORDER BY B.PLN_YRWK, B.ECC_CD, CNTR_TPSZ_CD			]]></sql>
			<params>
				<param name="sens_typ" type="12" value="0" out="N"/>
				<param name="obj_txt" type="12" value="O" out="N"/>
				<param name="repo_pln_id" type="12" value="REPO200920W001" out="N"/>
				<param name="costobj" type="12" value="O" out="N"/>
				<param name="tostartprd" type="12" value="200920" out="N"/>
				<param name="toendprd" type="12" value="200928" out="N"/>
				<param name="fmstartprd" type="12" value="200920" out="N"/>
				<param name="fmendprd" type="12" value="200928" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
