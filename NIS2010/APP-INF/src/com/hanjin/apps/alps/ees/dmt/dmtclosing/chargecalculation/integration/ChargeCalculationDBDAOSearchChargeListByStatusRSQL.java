/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : ChargeCalculationDBDAOSearchChargeListByStatusRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.06.15
*@LastModifier : 
*@LastVersion : 1.0
* 2016.06.15 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.ees.dmt.dmtclosing.chargecalculation.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class ChargeCalculationDBDAOSearchChargeListByStatusRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * ChargeCalculationDBDAOChargeCalculationContainerVORSQL
	  * </pre>
	  */
	public ChargeCalculationDBDAOSearchChargeListByStatusRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_bzc_trf_aply_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("uclm_flg",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fm_mvmt_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pol_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_mvmt_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("dmdt_ar_if_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fm_bzc_trf_aply_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_loc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fx_ft_ovr_dys",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_mvmt_yd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fm_mvmt_yd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sc_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fm_loc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pod_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ofc_trns_rhq_cng_flg",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("svc_provdr",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rfa_no",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.ees.dmt.dmtclosing.chargecalculation.integration").append("\n"); 
		query.append("FileName : ChargeCalculationDBDAOSearchChargeListByStatusRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT   SVR_ID" ).append("\n"); 
		query.append("       , DMDT_CHG_STS_CD" ).append("\n"); 
		query.append("	   , AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("       , DMDT_EXPT_RQST_STS_CD" ).append("\n"); 
		query.append("       , DECODE(TRIM(DMDT_EXPT_RQST_STS_CD), NULL, NULL, '', NULL, DECODE(DMDT_EXPT_RQST_STS_CD, 'R', 'BLUE', 'J', 'RED', 'O', 'RED', 'A', 'BLACK', 'PINK')) DMDT_EXPT_RQST_STS_COLOR" ).append("\n"); 
		query.append("	   , CASE WHEN DMDT_EXPT_RQST_STS_CD = 'O' THEN " ).append("\n"); 
		query.append("				   (SELECT DECODE(MAX(AFT_BKG_PATH_LVL), 1, 'SCO PIC ', 2, 'SSZ/BAG ', 3, 'RHQ PIC ', 4, 'RHQ MGR ', 5, 'HO PIC ', 6, 'HO MGR ', '') || 'Counter-Offer'" ).append("\n"); 
		query.append("					  FROM DMT_AFT_BKG_APRO_PATH" ).append("\n"); 
		query.append(" 			         WHERE AFT_EXPT_DAR_NO = T.AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("					   AND DMDT_EXPT_RQST_STS_CD IS NOT NULL" ).append("\n"); 
		query.append("	 		           AND AFT_BKG_PATH_CPLS_FLG = 'Y')" ).append("\n"); 
		query.append("			 ELSE  (SELECT INTG_CD_VAL_DP_DESC " ).append("\n"); 
		query.append("			          FROM COM_INTG_CD_DTL" ).append("\n"); 
		query.append("		             WHERE INTG_CD_ID = 'CD01971'" ).append("\n"); 
		query.append("	    	           AND INTG_CD_VAL_CTNT = DMDT_EXPT_RQST_STS_CD)" ).append("\n"); 
		query.append("			 END DMDT_EXPT_RQST_STS_CD_DESC" ).append("\n"); 
		query.append("	   , (" ).append("\n"); 
		query.append("			SELECT  CASE " ).append("\n"); 
		query.append("						WHEN NVL(MAX(DD.DMDT_DELT_RQST_STS_CD), 'N') IN ('C', 'N') THEN 'N'" ).append("\n"); 
		query.append("						WHEN 0 < MAX((	" ).append("\n"); 
		query.append("									SELECT  COUNT(1)" ).append("\n"); 
		query.append("									  FROM  DMT_CHG_DELT_PATH " ).append("\n"); 
		query.append("									 WHERE  SYS_AREA_GRP_ID     = DD.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("									   AND  CNTR_NO             = DD.CNTR_NO" ).append("\n"); 
		query.append("									   AND  CNTR_CYC_NO         = DD.CNTR_CYC_NO" ).append("\n"); 
		query.append("									   AND  DMDT_TRF_CD         = DD.DMDT_TRF_CD" ).append("\n"); 
		query.append("									   AND  DMDT_CHG_LOC_DIV_CD = DD.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("									   AND  CHG_SEQ             = DD.CHG_SEQ" ).append("\n"); 
		query.append("									   AND  CHG_OFC_CD          = DD.CHG_OFC_CD" ).append("\n"); 
		query.append("									   AND  DELT_SEQ            = DD.DELT_SEQ" ).append("\n"); 
		query.append("									   AND  CHG_DELT_PATH_LVL  >=" ).append("\n"); 
		query.append("											(" ).append("\n"); 
		query.append("												SELECT  max(CHG_DELT_PATH_LVL)" ).append("\n"); 
		query.append("												  FROM  DMT_CHG_DELT_PATH" ).append("\n"); 
		query.append("												 WHERE  SYS_AREA_GRP_ID        = DD.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("												   AND  CNTR_NO                = DD.CNTR_NO" ).append("\n"); 
		query.append("												   AND  CNTR_CYC_NO            = DD.CNTR_CYC_NO" ).append("\n"); 
		query.append("												   AND  DMDT_TRF_CD            = DD.DMDT_TRF_CD" ).append("\n"); 
		query.append("												   AND  DMDT_CHG_LOC_DIV_CD    = DD.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("												   AND  CHG_SEQ                = DD.CHG_SEQ" ).append("\n"); 
		query.append("												   AND  CHG_OFC_CD             = DD.CHG_OFC_CD" ).append("\n"); 
		query.append("												   AND  DELT_SEQ               = DD.DELT_SEQ" ).append("\n"); 
		query.append("												   AND  CHG_DELT_PATH_CPLS_FLG = 'Y'" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("									   and  CHG_DELT_STS_CD = 'A'" ).append("\n"); 
		query.append("								 )) THEN 'X'		--// Charge Deletion 요청 불가, Charge Deletion Cancel 불가" ).append("\n"); 
		query.append("						ELSE MAX(DD.DMDT_DELT_RQST_STS_CD)" ).append("\n"); 
		query.append("					END" ).append("\n"); 
		query.append("						" ).append("\n"); 
		query.append("			  FROM  DMT_CHG_DELT_RQST_APRO DD" ).append("\n"); 
		query.append("			 WHERE  DD.SYS_AREA_GRP_ID     = T.SVR_ID" ).append("\n"); 
		query.append("			   AND	DD.CNTR_NO		       = T.CNTR_NO" ).append("\n"); 
		query.append("			   AND	DD.CNTR_CYC_NO		   = T.CNTR_CYC_NO" ).append("\n"); 
		query.append("			   AND	DD.DMDT_TRF_CD		   = T.DMDT_TRF_CD" ).append("\n"); 
		query.append("			   AND	DD.DMDT_CHG_LOC_DIV_CD = T.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("			   AND	DD.CHG_SEQ			   = T.CHG_SEQ" ).append("\n"); 
		query.append("			   AND  DD.DELT_SEQ            = " ).append("\n"); 
		query.append("					( " ).append("\n"); 
		query.append("						SELECT  NVL(MAX(DS.DELT_SEQ), 0) " ).append("\n"); 
		query.append("						  FROM  DMT_CHG_DELT_RQST_APRO DS" ).append("\n"); 
		query.append("						 WHERE  DS.SYS_AREA_GRP_ID     = DD.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("						   AND  DS.CNTR_NO	           = DD.CNTR_NO" ).append("\n"); 
		query.append("						   AND  DS.CNTR_CYC_NO	       = DD.CNTR_CYC_NO" ).append("\n"); 
		query.append("						   AND  DS.DMDT_TRF_CD	       = DD.DMDT_TRF_CD" ).append("\n"); 
		query.append("						   AND  DS.DMDT_CHG_LOC_DIV_CD = DD.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("						   AND  DS.CHG_SEQ		       = DD.CHG_SEQ" ).append("\n"); 
		query.append("						   AND  DS.CHG_OFC_CD          = DD.CHG_OFC_CD  " ).append("\n"); 
		query.append("						   AND  DS.DMDT_DELT_RQST_STS_CD != 'C'" ).append("\n"); 
		query.append("					)  " ).append("\n"); 
		query.append("		 ) AS DMDT_DELT_RQST_STS_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	   , (" ).append("\n"); 
		query.append("			SELECT  ( SELECT INTG_CD_VAL_DP_DESC " ).append("\n"); 
		query.append("                        FROM COM_INTG_CD_DTL " ).append("\n"); 
		query.append("                       WHERE INTG_CD_ID = 'CD03382' " ).append("\n"); 
		query.append("                         AND INTG_CD_VAL_CTNT = DD.DMDT_DELT_RQST_STS_CD ) AS INACT_STS_NM" ).append("\n"); 
		query.append("			  FROM  DMT_CHG_DELT_RQST_APRO DD" ).append("\n"); 
		query.append("			 WHERE  DD.SYS_AREA_GRP_ID     = T.SVR_ID" ).append("\n"); 
		query.append("			   AND	DD.CNTR_NO		       = T.CNTR_NO" ).append("\n"); 
		query.append("			   AND	DD.CNTR_CYC_NO		   = T.CNTR_CYC_NO" ).append("\n"); 
		query.append("			   AND	DD.DMDT_TRF_CD		   = T.DMDT_TRF_CD" ).append("\n"); 
		query.append("			   AND	DD.DMDT_CHG_LOC_DIV_CD = T.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("			   AND	DD.CHG_SEQ			   = T.CHG_SEQ" ).append("\n"); 
		query.append("			   AND  DD.DELT_SEQ            =" ).append("\n"); 
		query.append("					( " ).append("\n"); 
		query.append("						SELECT  NVL(MAX(DS.DELT_SEQ), 0) " ).append("\n"); 
		query.append("						  FROM  DMT_CHG_DELT_RQST_APRO DS" ).append("\n"); 
		query.append("						 WHERE  DS.SYS_AREA_GRP_ID     = DD.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("						   AND  DS.CNTR_NO	           = DD.CNTR_NO" ).append("\n"); 
		query.append("						   AND  DS.CNTR_CYC_NO	       = DD.CNTR_CYC_NO" ).append("\n"); 
		query.append("						   AND  DS.DMDT_TRF_CD	       = DD.DMDT_TRF_CD" ).append("\n"); 
		query.append("						   AND  DS.DMDT_CHG_LOC_DIV_CD = DD.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("						   AND  DS.CHG_SEQ		       = DD.CHG_SEQ" ).append("\n"); 
		query.append("						   AND  DS.CHG_OFC_CD          = DD.CHG_OFC_CD  " ).append("\n"); 
		query.append("						   AND  DS.DMDT_DELT_RQST_STS_CD != 'C'" ).append("\n"); 
		query.append("					)  " ).append("\n"); 
		query.append("		 ) AS INACT_STS_MN" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	   , (" ).append("\n"); 
		query.append("			SELECT  INACT_RQST_NO" ).append("\n"); 
		query.append("			  FROM  DMT_CHG_DELT_RQST_APRO DD" ).append("\n"); 
		query.append("			 WHERE  DD.SYS_AREA_GRP_ID     = T.SVR_ID" ).append("\n"); 
		query.append("			   AND	DD.CNTR_NO		       = T.CNTR_NO" ).append("\n"); 
		query.append("			   AND	DD.CNTR_CYC_NO		   = T.CNTR_CYC_NO" ).append("\n"); 
		query.append("			   AND	DD.DMDT_TRF_CD		   = T.DMDT_TRF_CD" ).append("\n"); 
		query.append("			   AND	DD.DMDT_CHG_LOC_DIV_CD = T.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("			   AND	DD.CHG_SEQ			   = T.CHG_SEQ" ).append("\n"); 
		query.append("			   AND  DD.DELT_SEQ            =" ).append("\n"); 
		query.append("					( " ).append("\n"); 
		query.append("						SELECT  NVL(MAX(DS.DELT_SEQ), 0) " ).append("\n"); 
		query.append("						  FROM  DMT_CHG_DELT_RQST_APRO DS" ).append("\n"); 
		query.append("						 WHERE  DS.SYS_AREA_GRP_ID     = DD.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("						   AND  DS.CNTR_NO	           = DD.CNTR_NO" ).append("\n"); 
		query.append("						   AND  DS.CNTR_CYC_NO	       = DD.CNTR_CYC_NO" ).append("\n"); 
		query.append("						   AND  DS.DMDT_TRF_CD	       = DD.DMDT_TRF_CD" ).append("\n"); 
		query.append("						   AND  DS.DMDT_CHG_LOC_DIV_CD = DD.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("						   AND  DS.CHG_SEQ		       = DD.CHG_SEQ" ).append("\n"); 
		query.append("						   AND  DS.CHG_OFC_CD          = DD.CHG_OFC_CD  " ).append("\n"); 
		query.append("						   AND  DS.DMDT_DELT_RQST_STS_CD != 'C'" ).append("\n"); 
		query.append("					)  " ).append("\n"); 
		query.append("		 ) AS INACT_RQST_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("       , CNTR_NO" ).append("\n"); 
		query.append("       , CNTR_TPSZ_CD" ).append("\n"); 
		query.append("       , OFC_CD" ).append("\n"); 
		query.append("       , FM_MVMT_YD_CD" ).append("\n"); 
		query.append("       , TO_MVMT_YD_CD" ).append("\n"); 
		query.append("       , FM_MVMT_STS_CD" ).append("\n"); 
		query.append("       , TO_MVMT_STS_CD" ).append("\n"); 
		query.append("       , DMDT_TRF_CD" ).append("\n"); 
		query.append("       , FT_DYS" ).append("\n"); 
		query.append("       , FX_FT_OVR_DYS" ).append("\n"); 
		query.append("	   -- 조건추가(S) 2013.12.13" ).append("\n"); 
		query.append("       , OVR_DUE" ).append("\n"); 
		query.append("	   -- 조건추가(E)" ).append("\n"); 
		query.append("       , FM_MVMT_DT" ).append("\n"); 
		query.append("       , TO_MVMT_DT" ).append("\n"); 
		query.append("       , MT_DT" ).append("\n"); 
		query.append("       , FT_CMNC_DT" ).append("\n"); 
		query.append("       , FT_END_DT" ).append("\n"); 
		query.append("       , BZC_TRF_CURR_CD" ).append("\n"); 
		query.append("       , ORG_CHG_AMT" ).append("\n"); 
		query.append("       , SC_RFA_EXPT_AMT" ).append("\n"); 
		query.append("       , AFT_EXPT_DC_AMT" ).append("\n"); 
		query.append("       , BIL_AMT" ).append("\n"); 
		query.append("       , BKG_NO" ).append("\n"); 
		query.append("       , BL_NO" ).append("\n"); 
		query.append("       , VVD_CD" ).append("\n"); 
		query.append("       , LANE" ).append("\n"); 
		query.append("       , POR_CD" ).append("\n"); 
		query.append("       , POL_CD" ).append("\n"); 
		query.append("       , POD_CD" ).append("\n"); 
		query.append("       , DEL_CD" ).append("\n"); 
		query.append("       , BKG_RCV_TERM_CD" ).append("\n"); 
		query.append("       , BKG_DE_TERM_CD" ).append("\n"); 
		query.append("       , SC_NO" ).append("\n"); 
		query.append("       , RFA_NO" ).append("\n"); 
		query.append("       , ACUST" ).append("\n"); 
		query.append("       , CHG_TYPE" ).append("\n"); 
		query.append("       , CHG_SEQ" ).append("\n"); 
		query.append("        , UCLM_FLG" ).append("\n"); 
		query.append("#if (${bkg_info} != '')" ).append("\n"); 
		query.append("       , SOC_FLG" ).append("\n"); 
		query.append("       , LI" ).append("\n"); 
		query.append("       , CH" ).append("\n"); 
		query.append("       , D_O" ).append("\n"); 
		query.append("       , RLSE_OFC" ).append("\n"); 
		query.append("       , CLT_OFC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("       , OFC_TRNS_FLG" ).append("\n"); 
		query.append("       , ROLL_OVR" ).append("\n"); 
		query.append("       , WEB_IND_FLG" ).append("\n"); 
		query.append("       , CNTR_CYC_NO" ).append("\n"); 
		query.append("       , DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("#if (${corr_info} != '')" ).append("\n"); 
		query.append("       , CORR_RMK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("       , DMDT_INV_NO" ).append("\n"); 
		query.append("       , SUBSTR( DMT_INV_DATA, INSTR(DMT_INV_DATA, '|', 1, 1) + 1, INSTR(DMT_INV_DATA, '|', 1, 1+1) - INSTR(DMT_INV_DATA, '|', 1, 1) - 1) AS ISS_DT" ).append("\n"); 
		query.append("       , SUBSTR( DMT_INV_DATA, INSTR(DMT_INV_DATA, '|', 1, 2) + 1, INSTR(DMT_INV_DATA, '|', 1, 2+1) - INSTR(DMT_INV_DATA, '|', 1, 2) - 1) AS INV_CURR_CD" ).append("\n"); 
		query.append("       , SUBSTR( DMT_INV_DATA, INSTR(DMT_INV_DATA, '|', 1, 3) + 1, INSTR(DMT_INV_DATA, '|', 1, 3+1) - INSTR(DMT_INV_DATA, '|', 1, 3) - 1) AS INV_CHG_AMT" ).append("\n"); 
		query.append("       , SUBSTR( DMT_INV_DATA, INSTR(DMT_INV_DATA, '|', 1, 4) + 1, INSTR(DMT_INV_DATA, '|', 1, 4+1) - INSTR(DMT_INV_DATA, '|', 1, 4) - 1) AS DMDT_AR_IF_CD" ).append("\n"); 
		query.append("       , SUBSTR( DMT_INV_DATA, INSTR(DMT_INV_DATA, '|', 1, 5) + 1, INSTR(DMT_INV_DATA, '|', 1, 5+1) - INSTR(DMT_INV_DATA, '|', 1, 5) - 1) AS AR_IF_DT       -- 2012.11.26 Add" ).append("\n"); 
		query.append("       , WEB_CRE_DT" ).append("\n"); 
		query.append("       , WEB_MTY_DT" ).append("\n"); 
		query.append("       , WEB_NTFY_PIC_NM" ).append("\n"); 
		query.append("#if (${cust_info} != '')" ).append("\n"); 
		query.append("       , PAYER_CD" ).append("\n"); 
		query.append("       , PAYER_NM" ).append("\n"); 
		query.append("       , SHIPPER_CD" ).append("\n"); 
		query.append("       , SHIPPER_NM" ).append("\n"); 
		query.append("       , CNEE_CD" ).append("\n"); 
		query.append("       , CNEE_NM" ).append("\n"); 
		query.append("       , NTFY_CD" ).append("\n"); 
		query.append("       , NTFY_NM" ).append("\n"); 
		query.append("       , AR_ACT_CD" ).append("\n"); 
		query.append("       , AR_ACT_NM" ).append("\n"); 
		query.append("       , SVC_PROVDR_CD" ).append("\n"); 
		query.append("       , SVC_PROVDR_NM" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${op_bkg_info} != '')" ).append("\n"); 
		query.append("       , OP_BKG_NO" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${us_ofc_yn} == 'Y')	-- 2014.09.17 Add" ).append("\n"); 
		query.append("	   , CASE WHEN SUBSTR(DMDT_TRF_CD, 2, 3) = 'TIC' THEN X1_DT ELSE '' END AS X1_DT -- 2014.09.17 Add" ).append("\n"); 
		query.append("	   , CASE WHEN SUBSTR(DMDT_TRF_CD, 2, 3) = 'TIC' THEN CD_DT ELSE '' END AS CD_DT -- 2014.09.17 Add" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	   ,'' AS X1_DT" ).append("\n"); 
		query.append("	   ,'' AS CD_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("	   , BKG_CNTR_CYC_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM    (" ).append("\n"); 
		query.append("        SELECT    C.SYS_AREA_GRP_ID AS SVR_ID" ).append("\n"); 
		query.append("                , C.DMDT_CHG_STS_CD" ).append("\n"); 
		query.append("                , (SELECT AA.AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("                          FROM DMT_AFT_BKG_ADJ_RQST_DTL CC" ).append("\n"); 
		query.append("                             , DMT_AFT_BKG_CNTR BB" ).append("\n"); 
		query.append("                             , DMT_AFT_BKG_ADJ_RQST AA" ).append("\n"); 
		query.append("                         WHERE 1=1" ).append("\n"); 
		query.append("                           AND CC.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                           AND CC.AFT_EXPT_DAR_NO = BB.AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("                           AND CC.AFT_EXPT_ADJ_SEQ = BB.AFT_EXPT_ADJ_SEQ" ).append("\n"); 
		query.append("                           AND CC.DMDT_TRF_CD = C.DMDT_TRF_CD" ).append("\n"); 
		query.append("                           AND BB.SYS_AREA_GRP_ID = C.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("                           AND BB.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("                           AND BB.CNTR_CYC_NO = C.CNTR_CYC_NO" ).append("\n"); 
		query.append("                           AND BB.DMDT_TRF_CD = C.DMDT_TRF_CD" ).append("\n"); 
		query.append("                           AND BB.DMDT_CHG_LOC_DIV_CD = C.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("                           AND BB.CHG_SEQ = C.CHG_SEQ" ).append("\n"); 
		query.append("                           AND AA.AFT_EXPT_DAR_NO = BB.AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("                           AND AA.RQST_DT = (SELECT MAX(RQST_DT)" ).append("\n"); 
		query.append("                                  FROM DMT_AFT_BKG_ADJ_RQST A1" ).append("\n"); 
		query.append("                                     , DMT_AFT_BKG_ADJ_RQST_DTL B1" ).append("\n"); 
		query.append("                                 WHERE A1.AFT_EXPT_DAR_NO=B1.AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("                                   AND B1.BKG_NO=CC.BKG_NO )" ).append("\n"); 
		query.append("						   AND DMDT_EXPT_RQST_STS_CD != 'T'" ).append("\n"); 
		query.append("                ) AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("                , (SELECT DMDT_EXPT_RQST_STS_CD" ).append("\n"); 
		query.append("                          FROM DMT_AFT_BKG_ADJ_RQST_DTL CC" ).append("\n"); 
		query.append("                             , DMT_AFT_BKG_CNTR BB" ).append("\n"); 
		query.append("                             , DMT_AFT_BKG_ADJ_RQST AA" ).append("\n"); 
		query.append("                         WHERE 1=1" ).append("\n"); 
		query.append("                           AND CC.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                           AND CC.AFT_EXPT_DAR_NO = BB.AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("                           AND CC.AFT_EXPT_ADJ_SEQ = BB.AFT_EXPT_ADJ_SEQ" ).append("\n"); 
		query.append("                           AND CC.DMDT_TRF_CD = C.DMDT_TRF_CD" ).append("\n"); 
		query.append("                           AND BB.SYS_AREA_GRP_ID = C.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("                           AND BB.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("                           AND BB.CNTR_CYC_NO = C.CNTR_CYC_NO" ).append("\n"); 
		query.append("                           AND BB.DMDT_TRF_CD = C.DMDT_TRF_CD" ).append("\n"); 
		query.append("                           AND BB.DMDT_CHG_LOC_DIV_CD = C.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("                           AND BB.CHG_SEQ = C.CHG_SEQ" ).append("\n"); 
		query.append("                           AND AA.AFT_EXPT_DAR_NO = BB.AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("                           AND AA.RQST_DT = (SELECT MAX(RQST_DT)" ).append("\n"); 
		query.append("                                  FROM DMT_AFT_BKG_ADJ_RQST A1" ).append("\n"); 
		query.append("                                     , DMT_AFT_BKG_ADJ_RQST_DTL B1" ).append("\n"); 
		query.append("                                 WHERE A1.AFT_EXPT_DAR_NO=B1.AFT_EXPT_DAR_NO" ).append("\n"); 
		query.append("                                   AND B1.BKG_NO=CC.BKG_NO )" ).append("\n"); 
		query.append("						   AND DMDT_EXPT_RQST_STS_CD != 'T'" ).append("\n"); 
		query.append("                ) DMDT_EXPT_RQST_STS_CD" ).append("\n"); 
		query.append("                , C.CNTR_NO    " ).append("\n"); 
		query.append("                , B.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("                , C.OFC_CD" ).append("\n"); 
		query.append("                , C.FM_MVMT_YD_CD" ).append("\n"); 
		query.append("                , C.TO_MVMT_YD_CD" ).append("\n"); 
		query.append("                , C.FM_MVMT_STS_CD" ).append("\n"); 
		query.append("                , C.TO_MVMT_STS_CD" ).append("\n"); 
		query.append("                , C.DMDT_TRF_CD" ).append("\n"); 
		query.append("                , C.FT_DYS" ).append("\n"); 
		query.append("                , C.FX_FT_OVR_DYS" ).append("\n"); 
		query.append("				-- 조건추가(S) 2013.12.13" ).append("\n"); 
		query.append(" 				, TO_DATE(TO_CHAR(SYSDATE, 'YYYYMMDD'), 'YYYYMMDD') - TO_DATE(TO_CHAR(NVL(C.TO_MVMT_DT, C.FT_END_DT), 'YYYYMMDD'), 'YYYYMMDD') AS OVR_DUE" ).append("\n"); 
		query.append("                -- 조건추가(E)" ).append("\n"); 
		query.append("				, TO_CHAR(C.FM_MVMT_DT, 'yyyymmdd') FM_MVMT_DT" ).append("\n"); 
		query.append("                , TO_CHAR(C.TO_MVMT_DT, 'yyyymmdd') TO_MVMT_DT     " ).append("\n"); 
		query.append("                , " ).append("\n"); 
		query.append("                (" ).append("\n"); 
		query.append("                SELECT TO_CHAR(CM.CNMV_EVNT_DT, 'YYYYMMDD')" ).append("\n"); 
		query.append("                FROM   CTM_MOVEMENT CM" ).append("\n"); 
		query.append("                WHERE  CM.CNTR_NO     = C.CNTR_NO" ).append("\n"); 
		query.append("                AND    CM.CNMV_CYC_NO = C.CNTR_CYC_NO" ).append("\n"); 
		query.append("                AND    CM.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("                AND    ROWNUM         = 1" ).append("\n"); 
		query.append("                ) AS MT_DT" ).append("\n"); 
		query.append("                , TO_CHAR(C.FT_CMNC_DT, 'yyyymmdd') FT_CMNC_DT" ).append("\n"); 
		query.append("                , TO_CHAR(C.FT_END_DT, 'yyyymmdd') FT_END_DT" ).append("\n"); 
		query.append("                , C.BZC_TRF_CURR_CD" ).append("\n"); 
		query.append("                , C.ORG_CHG_AMT" ).append("\n"); 
		query.append("                , C.SC_RFA_EXPT_AMT" ).append("\n"); 
		query.append("                , C.AFT_EXPT_DC_AMT" ).append("\n"); 
		query.append("                , C.BIL_AMT" ).append("\n"); 
		query.append("                , B.BKG_NO" ).append("\n"); 
		query.append("                , B.BL_NO" ).append("\n"); 
		query.append("                , B.VSL_CD || B.SKD_VOY_NO || B.SKD_DIR_CD AS VVD_CD" ).append("\n"); 
		query.append("                ," ).append("\n"); 
		query.append("                (" ).append("\n"); 
		query.append("                SELECT  V.VSL_SLAN_CD" ).append("\n"); 
		query.append("                FROM    VSK_VSL_SKD V" ).append("\n"); 
		query.append("                WHERE   B.VSL_CD        = V.VSL_CD " ).append("\n"); 
		query.append("                AND     B.SKD_VOY_NO    = V.SKD_VOY_NO " ).append("\n"); 
		query.append("                AND     B.SKD_DIR_CD    = V.SKD_DIR_CD " ).append("\n"); 
		query.append("                )                                                                                                           AS LANE" ).append("\n"); 
		query.append("                , B.POR_CD" ).append("\n"); 
		query.append("                , B.POL_CD" ).append("\n"); 
		query.append("                , B.POD_CD" ).append("\n"); 
		query.append("                , B.DEL_CD" ).append("\n"); 
		query.append("                , B.BKG_RCV_TERM_CD" ).append("\n"); 
		query.append("                , B.BKG_DE_TERM_CD" ).append("\n"); 
		query.append("                , B.SC_NO" ).append("\n"); 
		query.append("                , B.RFA_NO" ).append("\n"); 
		query.append("                , DECODE( BK.AGMT_ACT_CNT_CD||TRIM(TO_CHAR(BK.AGMT_ACT_CUST_SEQ, '000000')),'000000', NULL" ).append("\n"); 
		query.append("                                                   , BK.AGMT_ACT_CNT_CD||TRIM(TO_CHAR(BK.AGMT_ACT_CUST_SEQ, '000000')) )    AS ACUST" ).append("\n"); 
		query.append("                , DECODE(C.CHG_SEQ, 1, 'G', 'B') AS CHG_TYPE" ).append("\n"); 
		query.append("                , C.CHG_SEQ" ).append("\n"); 
		query.append("                , NVL(UCLM_FLG, 'N')                                                                                        AS UCLM_FLG" ).append("\n"); 
		query.append("#if (${bkg_info} != '')" ).append("\n"); 
		query.append("                , NVL(B.SOC_FLG, 'N') AS SOC_FLG" ).append("\n"); 
		query.append("                ," ).append("\n"); 
		query.append("                CASE" ).append("\n"); 
		query.append("                WHEN C.DMDT_TRF_CD='DMIF' AND C.TO_MVMT_STS_CD ='ID'                    THEN 'L'" ).append("\n"); 
		query.append("                WHEN C.DMDT_TRF_CD='DMIF' AND C.TO_MVMT_STS_CD NOT IN ('ID','CS','DR')  THEN 'I'" ).append("\n"); 
		query.append("                WHEN C.DMDT_TRF_CD='DMOF' AND C.DMDT_CHG_LOC_DIV_CD <> 'POL'            THEN 'L'" ).append("\n"); 
		query.append("                WHEN C.DMDT_TRF_CD='DMOF' AND C.DMDT_CHG_LOC_DIV_CD ='POL'              THEN 'I'" ).append("\n"); 
		query.append("                END                                                                                                         AS LI" ).append("\n"); 
		query.append("                , " ).append("\n"); 
		query.append("                (" ).append("\n"); 
		query.append("                SELECT  NVL(HLG_TP_CD, 'N')" ).append("\n"); 
		query.append("                FROM    BKG_EUR_TRO" ).append("\n"); 
		query.append("                WHERE   BKG_NO              = B.BKG_NO" ).append("\n"); 
		query.append("                AND     IO_BND_CD           = SUBSTR(C.DMDT_TRF_CD, 3, 1)" ).append("\n"); 
		query.append("                AND     NVL(CXL_FLG, 'N')   = 'N'" ).append("\n"); 
		query.append("                AND     CNTR_NO             = C.CNTR_NO" ).append("\n"); 
		query.append("                AND     ROWNUM              = 1" ).append("\n"); 
		query.append("                )                                                                                                           AS CH" ).append("\n"); 
		query.append("                ," ).append("\n"); 
		query.append("                (" ).append("\n"); 
		query.append("                SELECT  'Y'" ).append("\n"); 
		query.append("                FROM    DUAL      " ).append("\n"); 
		query.append("                WHERE   EXISTS  (" ).append("\n"); 
		query.append("                                SELECT  BDD.RLSE_STS_CD" ).append("\n"); 
		query.append("                                FROM    BKG_DO     BDO," ).append("\n"); 
		query.append("                                        BKG_DO_DTL BDD" ).append("\n"); 
		query.append("                                WHERE   BDO.BKG_NO        = BDD.BKG_NO" ).append("\n"); 
		query.append("                                AND     BDO.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                AND     BDD.RLSE_STS_CD IN ('R', 'I')" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                )                                                                                                           AS D_O" ).append("\n"); 
		query.append("                ," ).append("\n"); 
		query.append("                (" ).append("\n"); 
		query.append("                SELECT  BDD.EVNT_OFC_CD" ).append("\n"); 
		query.append("                FROM    BKG_DO     BDO," ).append("\n"); 
		query.append("                        BKG_DO_DTL BDD" ).append("\n"); 
		query.append("                WHERE   BDO.BKG_NO      = BDD.BKG_NO   " ).append("\n"); 
		query.append("                AND     BDO.BKG_NO      = B.BKG_NO   " ).append("\n"); 
		query.append("                AND     BDD.RLSE_STS_CD IN ('R', 'I')" ).append("\n"); 
		query.append("                AND     ROWNUM          =1" ).append("\n"); 
		query.append("                )                                                                                                           AS RLSE_OFC" ).append("\n"); 
		query.append("                , BR.CLT_OFC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                , NVL(C.OFC_TRNS_FLG, 'N')                                                                                  AS OFC_TRNS_FLG" ).append("\n"); 
		query.append("                ," ).append("\n"); 
		query.append("                (" ).append("\n"); 
		query.append("                SELECT  'C'" ).append("\n"); 
		query.append("                FROM    DUAL" ).append("\n"); 
		query.append("                WHERE   EXISTS  (" ).append("\n"); 
		query.append("                                SELECT  1" ).append("\n"); 
		query.append("                                FROM    BKG_ROLL_OVR R" ).append("\n"); 
		query.append("                                WHERE   R.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                AND     R.ROLL_OVR_RSN_CD IN ( 'C','H' )" ).append("\n"); 
		query.append("                                ) " ).append("\n"); 
		query.append("                )                                                                                                           AS ROLL_OVR" ).append("\n"); 
		query.append("                , C.CNTR_CYC_NO" ).append("\n"); 
		query.append("                , C.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("#if (${corr_info} != '')" ).append("\n"); 
		query.append("                , C.CORR_RMK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                , C.DMDT_INV_NO" ).append("\n"); 
		query.append("                ," ).append("\n"); 
		query.append("                (" ).append("\n"); 
		query.append("                SELECT  '|'|| TO_CHAR(IM.CRE_DT, 'YYYYMMDD') ||'|'|| IM.INV_CURR_CD ||'|'|| ID.CNTR_INV_AMT ||'|'|| IM.DMDT_AR_IF_CD ||'|'|| TO_CHAR(IM.AR_IF_DT, 'YYYYMMDD') ||'|'" ).append("\n"); 
		query.append("                FROM    DMT_INV_MN  IM," ).append("\n"); 
		query.append("                        DMT_INV_DTL ID" ).append("\n"); 
		query.append("                WHERE   1=1" ).append("\n"); 
		query.append("                AND     IM.DMDT_INV_NO          = ID.DMDT_INV_NO" ).append("\n"); 
		query.append("                AND     IM.CRE_OFC_CD           = ID.CRE_OFC_CD" ).append("\n"); 
		query.append("                AND     IM.DMDT_INV_STS_CD      = 'I'" ).append("\n"); 
		query.append("                AND     C.SYS_AREA_GRP_ID       = ID.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("                AND     C.CNTR_NO               = ID.CNTR_NO" ).append("\n"); 
		query.append("                AND     C.CNTR_CYC_NO           = ID.CNTR_CYC_NO" ).append("\n"); 
		query.append("                AND     C.DMDT_TRF_CD           = ID.DMDT_TRF_CD" ).append("\n"); 
		query.append("                AND     C.DMDT_CHG_LOC_DIV_CD   = ID.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("                AND     C.CHG_SEQ               = ID.CHG_SEQ " ).append("\n"); 
		query.append("                AND     ROWNUM                  = 1" ).append("\n"); 
		query.append("                )                                                                                                           AS DMT_INV_DATA" ).append("\n"); 
		query.append("                , C.WEB_IND_FLG" ).append("\n"); 
		query.append("                , DECODE(C.WEB_IND_FLG, 'Y', TO_CHAR(NVL(C.WEB_MTY_DT, C.TO_MVMT_DT), 'YYYY-MM-DD'), TO_CHAR(C.WEB_MTY_DT, 'YYYY-MM-DD')) AS WEB_CRE_DT" ).append("\n"); 
		query.append("                , DECODE(C.WEB_IND_FLG, 'Y', TO_CHAR(NVL(C.FT_END_DT, C.TO_MVMT_DT) + 7, 'YYYY-MM-DD'), TO_CHAR(C.FT_END_DT + 7, 'YYYY-MM-DD')) AS WEB_MTY_DT" ).append("\n"); 
		query.append("                , C.WEB_NTFY_PIC_NM" ).append("\n"); 
		query.append("#if (${cust_info} != '')" ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append(", (" ).append("\n"); 
		query.append("            CASE WHEN (C.DMDT_TRF_CD IN ('DTIC', 'CTIC') AND SUBSTR(BK.DEL_CD,1,2) = 'US' AND BK.DE_TERM_CD = 'Y') " ).append("\n"); 
		query.append("                    OR (C.DMDT_TRF_CD IN ('DTOC', 'CTOC') AND SUBSTR(BK.POR_CD,1,2) = 'US' AND BK.RCV_TERM_CD = 'Y') " ).append("\n"); 
		query.append("                    THEN " ).append("\n"); 
		query.append("                        (SELECT	LPAD(VNDR_SEQ,6,'0') AS VNDR_CD FROM	MDM_VENDOR WHERE	VNDR_SEQ = C.VNDR_SEQ AND	DELT_FLG <> 'Y')" ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                    ELSE CASE WHEN SUBSTR(C.DMDT_TRF_CD,3,1) = 'I' AND SUBSTR(BK.DEL_CD,1,2) IN ('US', 'CA') THEN  " ).append("\n"); 
		query.append("                                            NVL(( SELECT CUST_CNT_CD||LPAD(CUST_SEQ,6,'0') " ).append("\n"); 
		query.append("                                                                 FROM BKG_CUSTOMER " ).append("\n"); 
		query.append("                                                                WHERE BKG_NO = BK.BKG_NO " ).append("\n"); 
		query.append("                                                                  AND BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("																  AND CUST_CNT_CD IS NOT NULL AND CUST_SEQ IS NOT NULL)," ).append("\n"); 
		query.append("                                                             ( SELECT CUST_CNT_CD||LPAD(CUST_SEQ,6,'0')" ).append("\n"); 
		query.append("                                                                 FROM BKG_CUSTOMER " ).append("\n"); 
		query.append("                                                                WHERE BKG_NO = BK.BKG_NO " ).append("\n"); 
		query.append("                                                                  AND BKG_CUST_TP_CD = 'N'))" ).append("\n"); 
		query.append("                                                                  " ).append("\n"); 
		query.append("                                    WHEN SUBSTR(C.DMDT_TRF_CD,3,1) = 'O' AND SUBSTR(BK.POR_CD,1,2) IN ('US', 'CA') THEN  " ).append("\n"); 
		query.append("                                            ( SELECT CUST_CNT_CD||LPAD(CUST_SEQ,6,'0') " ).append("\n"); 
		query.append("                                                                 FROM BKG_CUSTOMER " ).append("\n"); 
		query.append("                                                                WHERE BKG_NO = BK.BKG_NO " ).append("\n"); 
		query.append("                                                                  AND BKG_CUST_TP_CD = 'S')" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("                                    ELSE " ).append("\n"); 
		query.append("                                          NVL(" ).append("\n"); 
		query.append("											   (SELECT ACT_CUST_CNT_CD || LPAD(ACT_CUST_SEQ, 6, '0')" ).append("\n"); 
		query.append("													FROM INV_AR_MN AR" ).append("\n"); 
		query.append("													WHERE BKG_NO = BK.BKG_NO" ).append("\n"); 
		query.append("													AND IO_BND_CD = SUBSTR(C.DMDT_TRF_CD,3,1)" ).append("\n"); 
		query.append("													AND AR_IF_NO = (SELECT MAX(AR_IF_NO)" ).append("\n"); 
		query.append("																			FROM INV_AR_MN" ).append("\n"); 
		query.append("																			WHERE BKG_NO = BK.BKG_NO" ).append("\n"); 
		query.append("																			AND   IO_BND_CD = SUBSTR(C.DMDT_TRF_CD,3,1)" ).append("\n"); 
		query.append("																	)" ).append("\n"); 
		query.append("												), NVL(DECODE(C.ACT_CNT_CD, '00', '', C.ACT_CNT_CD)|| DECODE(C.ACT_CUST_SEQ,NULL,'',0,'',LPAD(C.ACT_CUST_SEQ, 6, '0')), '')" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("                                    END" ).append("\n"); 
		query.append("                   END )	AS PAYER_CD" ).append("\n"); 
		query.append("    , (" ).append("\n"); 
		query.append("            CASE WHEN (C.DMDT_TRF_CD IN ('DTIC', 'CTIC') AND SUBSTR(BK.DEL_CD,1,2) = 'US' AND BK.DE_TERM_CD = 'Y') " ).append("\n"); 
		query.append("                    OR (C.DMDT_TRF_CD IN ('DTOC', 'CTOC') AND SUBSTR(BK.POR_CD,1,2) = 'US' AND BK.RCV_TERM_CD = 'Y') " ).append("\n"); 
		query.append("                    THEN " ).append("\n"); 
		query.append("                        (SELECT	VNDR_LGL_ENG_NM FROM MDM_VENDOR WHERE VNDR_SEQ = C.VNDR_SEQ AND DELT_FLG <> 'Y' AND ROWNUM = 1)" ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                    ELSE CASE WHEN SUBSTR(C.DMDT_TRF_CD,3,1) = 'I' AND SUBSTR(BK.DEL_CD,1,2) IN ('US', 'CA') THEN  " ).append("\n"); 
		query.append("                                            NVL(( SELECT CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("                                                                 FROM BKG_CUSTOMER A, MDM_CUSTOMER B" ).append("\n"); 
		query.append("                                                                WHERE A.BKG_NO = BK.BKG_NO " ).append("\n"); 
		query.append("                                                                  AND A.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("																  AND A.CUST_CNT_CD IS NOT NULL AND A.CUST_SEQ IS NOT NULL" ).append("\n"); 
		query.append("                                                                  AND A.CUST_CNT_CD = B.CUST_CNT_CD" ).append("\n"); 
		query.append("                                                                  AND A.CUST_SEQ = B.CUST_SEQ " ).append("\n"); 
		query.append("                                                                  AND ROWNUM = 1 )," ).append("\n"); 
		query.append("                                                             ( SELECT CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("                                                                 FROM BKG_CUSTOMER A, MDM_CUSTOMER B" ).append("\n"); 
		query.append("                                                                WHERE A.BKG_NO = BK.BKG_NO " ).append("\n"); 
		query.append("                                                                  AND A.BKG_CUST_TP_CD = 'N'" ).append("\n"); 
		query.append("                                                                  AND A.CUST_CNT_CD = B.CUST_CNT_CD" ).append("\n"); 
		query.append("                                                                  AND A.CUST_SEQ = B.CUST_SEQ " ).append("\n"); 
		query.append("                                                                  AND ROWNUM = 1 ))" ).append("\n"); 
		query.append("                                                                  " ).append("\n"); 
		query.append("                                    WHEN SUBSTR(C.DMDT_TRF_CD,3,1) = 'O' AND SUBSTR(BK.POR_CD,1,2) IN ('US', 'CA') THEN  " ).append("\n"); 
		query.append("                                            ( SELECT CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("                                                                 FROM BKG_CUSTOMER A, MDM_CUSTOMER B" ).append("\n"); 
		query.append("                                                                WHERE A.BKG_NO = BK.BKG_NO " ).append("\n"); 
		query.append("                                                                  AND A.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("                                                                  AND A.CUST_CNT_CD = B.CUST_CNT_CD" ).append("\n"); 
		query.append("                                                                  AND A.CUST_SEQ = B.CUST_SEQ " ).append("\n"); 
		query.append("                                                                  AND ROWNUM = 1 )" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("                                    ELSE " ).append("\n"); 
		query.append("                                          NVL((SELECT CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("											FROM MDM_CUSTOMER" ).append("\n"); 
		query.append("                                            WHERE (CUST_SEQ, CUST_CNT_CD) = (" ).append("\n"); 
		query.append("												SELECT ACT_CUST_SEQ, ACT_CUST_CNT_CD" ).append("\n"); 
		query.append("												FROM INV_AR_MN AR" ).append("\n"); 
		query.append("												WHERE BKG_NO = BK.BKG_NO" ).append("\n"); 
		query.append("												AND IO_BND_CD = SUBSTR(C.DMDT_TRF_CD,3,1)" ).append("\n"); 
		query.append("												AND AR_IF_NO = (" ).append("\n"); 
		query.append("                                                	SELECT MAX(AR_IF_NO)" ).append("\n"); 
		query.append("													FROM INV_AR_MN" ).append("\n"); 
		query.append("													WHERE BKG_NO = BK.BKG_NO" ).append("\n"); 
		query.append("													AND IO_BND_CD = SUBSTR(C.DMDT_TRF_CD,3,1)" ).append("\n"); 
		query.append("												)" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("											AND ROWNUM = 1" ).append("\n"); 
		query.append("										), (SELECT CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("											FROM MDM_CUSTOMER" ).append("\n"); 
		query.append("                                            WHERE CUST_CNT_CD = C.ACT_CNT_CD " ).append("\n"); 
		query.append("											AND CUST_SEQ = C.ACT_CUST_SEQ))" ).append("\n"); 
		query.append("                                    END" ).append("\n"); 
		query.append("                   END )	AS PAYER_NM" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                , BS.CUST_CNT_CD || TRIM(TO_CHAR(BS.CUST_SEQ, '000000'))                            AS SHIPPER_CD " ).append("\n"); 
		query.append("                , REPLACE(BS.CUST_NM, CHR(13) || CHR(10), ' ')                                      AS SHIPPER_NM   " ).append("\n"); 
		query.append("                , DECODE(BC.CUST_CNT_CD || TRIM(TO_CHAR(BC.CUST_SEQ, '000000')), '000000', NULL, BC.CUST_CNT_CD || TRIM(TO_CHAR(BC.CUST_SEQ, '000000'))) AS CNEE_CD" ).append("\n"); 
		query.append("                , REPLACE(BC.CUST_NM, CHR(13) || CHR(10), ' ')                                      AS CNEE_NM" ).append("\n"); 
		query.append("                , DECODE(BN.CUST_CNT_CD || TRIM(TO_CHAR(BN.CUST_SEQ, '000000')), '000000', NULL, BN.CUST_CNT_CD || TRIM(TO_CHAR(BN.CUST_SEQ, '000000'))) AS NTFY_CD" ).append("\n"); 
		query.append("                , NVL(RTRIM(REPLACE(REPLACE(BN.CUST_NM, CHR(34), ''), CHR(13)||CHR(10), ' ')), '-') AS NTFY_NM" ).append("\n"); 
		query.append("                ," ).append("\n"); 
		query.append("                (" ).append("\n"); 
		query.append("                SELECT  I.ACT_CUST_CNT_CD || TO_CHAR(I.ACT_CUST_SEQ, 'FM000000')" ).append("\n"); 
		query.append("                FROM    INV_AR_MN I" ).append("\n"); 
		query.append("                WHERE   I.BKG_NO    = B.BKG_NO" ).append("\n"); 
		query.append("                AND     I.IO_BND_CD = SUBSTR(C.DMDT_TRF_CD, 3, 1)" ).append("\n"); 
		query.append("                AND     AR_IF_NO    =   (" ).append("\n"); 
		query.append("                                        SELECT  MAX(AR_IF_NO) " ).append("\n"); 
		query.append("                                        FROM    INV_AR_MN" ).append("\n"); 
		query.append("                                        WHERE   BKG_NO      = B.BKG_NO" ).append("\n"); 
		query.append("                                        AND     IO_BND_CD   = SUBSTR(C.DMDT_TRF_CD, 3, 1)" ).append("\n"); 
		query.append("                                        )" ).append("\n"); 
		query.append("                AND     ROWNUM      = 1" ).append("\n"); 
		query.append("                )                                                                                                   AS AR_ACT_CD" ).append("\n"); 
		query.append("                ," ).append("\n"); 
		query.append("                (" ).append("\n"); 
		query.append("                SELECT  MC.CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("                FROM    MDM_CUSTOMER    MC," ).append("\n"); 
		query.append("                        INV_AR_MN       I" ).append("\n"); 
		query.append("                WHERE   MC.CUST_CNT_CD  = I.ACT_CUST_CNT_CD" ).append("\n"); 
		query.append("                AND     MC.CUST_SEQ     = I.ACT_CUST_SEQ" ).append("\n"); 
		query.append("                AND     I.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                AND     I.IO_BND_CD     = SUBSTR(C.DMDT_TRF_CD, 3, 1)" ).append("\n"); 
		query.append("                AND     AR_IF_NO        =   (" ).append("\n"); 
		query.append("                                            SELECT  MAX(AR_IF_NO) " ).append("\n"); 
		query.append("                                            FROM    INV_AR_MN" ).append("\n"); 
		query.append("                                            WHERE   BKG_NO      = B.BKG_NO" ).append("\n"); 
		query.append("                                            AND     IO_BND_CD   = SUBSTR(C.DMDT_TRF_CD, 3, 1)" ).append("\n"); 
		query.append("                                            )" ).append("\n"); 
		query.append("                AND     ROWNUM  = 1" ).append("\n"); 
		query.append("                )                                                                                                   AS AR_ACT_NM" ).append("\n"); 
		query.append("                , DECODE(TRIM(TO_CHAR(C.VNDR_SEQ, '000000')), '000000', NULL, TRIM(TO_CHAR(C.VNDR_SEQ, '000000')))  AS SVC_PROVDR_CD     " ).append("\n"); 
		query.append("                ," ).append("\n"); 
		query.append("                (" ).append("\n"); 
		query.append("                SELECT  MV.VNDR_LGL_ENG_NM" ).append("\n"); 
		query.append("                FROM    MDM_VENDOR MV" ).append("\n"); 
		query.append("                WHERE   MV.VNDR_SEQ = C.VNDR_SEQ" ).append("\n"); 
		query.append("                )                                                                                                   AS SVC_PROVDR_NM" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("             , B.DMDT_BKG_CGO_TP_CD ||" ).append("\n"); 
		query.append("                 CASE" ).append("\n"); 
		query.append("                 WHEN B.DMDT_BKG_CGO_TP_CD= 'AWK' THEN" ).append("\n"); 
		query.append("                     (" ).append("\n"); 
		query.append("                     SELECT DECODE (SIGN (OVR_FWRD_LEN" ).append("\n"); 
		query.append("                             + OVR_BKWD_LEN" ).append("\n"); 
		query.append("                             + OVR_HGT" ).append("\n"); 
		query.append("                             + OVR_LF_LEN" ).append("\n"); 
		query.append("                             + OVR_RT_LEN)" ).append("\n"); 
		query.append("                             , 0, 'I'" ).append("\n"); 
		query.append("                             ,    'O'" ).append("\n"); 
		query.append("                             )" ).append("\n"); 
		query.append("                     FROM    BKG_AWK_CGO S" ).append("\n"); 
		query.append("                     WHERE   1=1" ).append("\n"); 
		query.append("                     AND     S.BKG_NO    = B.BKG_NO" ).append("\n"); 
		query.append("                     AND     S.CNTR_NO   = B.CNTR_NO" ).append("\n"); 
		query.append("                     )" ).append("\n"); 
		query.append("                 ELSE" ).append("\n"); 
		query.append("                     'A'" ).append("\n"); 
		query.append("                 END                                                                                                AS DMDT_BKG_CGO_TP_CD_GUBUN" ).append("\n"); 
		query.append("#if (${op_bkg_info} != '')" ).append("\n"); 
		query.append("            ," ).append("\n"); 
		query.append("            CASE" ).append("\n"); 
		query.append("            WHEN  ( SUBSTR ( C.DMDT_TRF_CD, 3, 1 ) = 'O' AND DMDT_CHG_STS_CD <> 'N' ) THEN" ).append("\n"); 
		query.append("                (" ).append("\n"); 
		query.append("                SELECT  /*+ INDEX_DESC( M XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                        CASE" ).append("\n"); 
		query.append("                        WHEN ( M.CNMV_CYC_NO <> C.CNTR_CYC_NO AND M.BKG_NO <> B.BKG_NO AND" ).append("\n"); 
		query.append("                                (" ).append("\n"); 
		query.append("                                SELECT  COUNT(*)" ).append("\n"); 
		query.append("                                FROM    CTM_MOVEMENT S" ).append("\n"); 
		query.append("                                WHERE   S.CNTR_NO       = M.CNTR_NO" ).append("\n"); 
		query.append("                                AND     S.CNMV_CYC_NO   = M.CNMV_CYC_NO " ).append("\n"); 
		query.append("                                AND     S.MVMT_STS_CD   IN ( 'VL', 'MT')" ).append("\n"); 
		query.append("                                ) = 0" ).append("\n"); 
		query.append("                        ) THEN" ).append("\n"); 
		query.append("                            M.BKG_NO" ).append("\n"); 
		query.append("                        ELSE" ).append("\n"); 
		query.append("                            B.BKG_NO" ).append("\n"); 
		query.append("                        END" ).append("\n"); 
		query.append("                FROM    CTM_MOVEMENT   M" ).append("\n"); 
		query.append("                WHERE   1=1" ).append("\n"); 
		query.append("                AND     M.MVMT_STS_CD    = 'OP'" ).append("\n"); 
		query.append("                AND     M.CNTR_NO        = C.CNTR_NO" ).append("\n"); 
		query.append("                AND     M.CNMV_YR || TO_CHAR(M.CNMV_SEQ, 'FM0000') || M.CNMV_SPLIT_NO < C.TO_MVMT_YR || TO_CHAR( C.TO_MVMT_SEQ, 'FM0000') || C.TO_MVMT_SPLIT_NO  " ).append("\n"); 
		query.append("                AND     ROWNUM           = 1" ).append("\n"); 
		query.append("                )" ).append("\n"); 
		query.append("           ELSE" ).append("\n"); 
		query.append("                    NULL" ).append("\n"); 
		query.append("           END                                                                                                      AS OP_BKG_NO" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${us_ofc_yn} == 'Y')	-- 2014.09.17 Add" ).append("\n"); 
		query.append("		  ,T2.X1_DT" ).append("\n"); 
		query.append("		  ,T2.CD_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		  , ( SELECT CNMV_CYC_NO FROM BKG_CONTAINER WHERE BKG_NO = B.BKG_NO AND CNTR_NO = B.CNTR_NO AND ROWNUM = 1 ) AS BKG_CNTR_CYC_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        FROM      DMT_CHG_BKG_CNTR       B" ).append("\n"); 
		query.append("                 , DMT_CHG_CALC          C" ).append("\n"); 
		query.append("                 , BKG_BOOKING           BK" ).append("\n"); 
		query.append("                 , BKG_RATE              BR" ).append("\n"); 
		query.append("                 , BKG_CUSTOMER          BS" ).append("\n"); 
		query.append("                 , BKG_CUSTOMER          BC" ).append("\n"); 
		query.append("                 , BKG_CUSTOMER          BN" ).append("\n"); 
		query.append("                 , DMT_INV_MN            T1" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${us_ofc_yn} == 'Y')	-- 2014.09.17 Add" ).append("\n"); 
		query.append("				 , (" ).append("\n"); 
		query.append("					SELECT  BKG_NO" ).append("\n"); 
		query.append("                           ,CNTR_NO" ).append("\n"); 
		query.append("                           ,MAX(X1_DT) as X1_DT" ).append("\n"); 
		query.append("                           ,MAX(CD_DT) as CD_DT" ).append("\n"); 
		query.append("				  	FROM  (" ).append("\n"); 
		query.append("				            SELECT  BKG_NO, CNTR_NO, max(ACT_RCV_DT) as X1_DT, '' as CD_DT" ).append("\n"); 
		query.append("				              FROM  EDI_214_MSG" ).append("\n"); 
		query.append("				             WHERE  SHP_STS_CD = 'X1'" ).append("\n"); 
		query.append("				            GROUP BY BKG_NO, CNTR_NO " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("				            UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("				            SELECT  BKG_NO, CNTR_NO, '' as X1_DT, max(ACT_RCV_DT) as CD_DT" ).append("\n"); 
		query.append("				              FROM  EDI_214_MSG" ).append("\n"); 
		query.append("				             WHERE  SHP_STS_CD = 'CD'" ).append("\n"); 
		query.append("				            GROUP BY BKG_NO, CNTR_NO " ).append("\n"); 
		query.append("				        )           " ).append("\n"); 
		query.append("					GROUP BY BKG_NO, CNTR_NO" ).append("\n"); 
		query.append("				   )                     T2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("         WHERE  1=1" ).append("\n"); 
		query.append("         AND    B.SYS_AREA_GRP_ID    =   C.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("         AND    B.CNTR_NO            =   C.CNTR_NO" ).append("\n"); 
		query.append("         AND    B.CNTR_CYC_NO        =   C.CNTR_CYC_NO" ).append("\n"); 
		query.append("         AND    B.BKG_NO             =   BK.BKG_NO" ).append("\n"); 
		query.append("         AND    B.BKG_NO             =   BR.BKG_NO(+)" ).append("\n"); 
		query.append("         AND    C.OFC_CD             IN (" ).append("\n"); 
		query.append("                        #foreach( $ofc_cd in ${ofc_cd_list} )" ).append("\n"); 
		query.append("                             #if($velocityCount < $ofc_cd_list.size()) '$ofc_cd', #else '$ofc_cd' #end" ).append("\n"); 
		query.append("                        #end" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("         AND    C.DMDT_TRF_CD        IN (" ).append("\n"); 
		query.append("                        #foreach( $trf_cd in ${trf_cd_list} )" ).append("\n"); 
		query.append("                             #if($velocityCount < $trf_cd_list.size()) '$trf_cd', #else '$trf_cd' #end" ).append("\n"); 
		query.append("                        #end" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("         AND    NOT (C.DUL_TP_EXPT_FLG  = 'Y' AND SUBSTR(C.DMDT_TRF_CD, 1, 1) = 'D')" ).append("\n"); 
		query.append("         AND    C.DMDT_CHG_LOC_DIV_CD     <> 'SZP'" ).append("\n"); 
		query.append("#if (${cs} == 'Y' || ${web_mt} == 'Y')" ).append("\n"); 
		query.append("         AND    C.SYS_AREA_GRP_ID = 'USA'         " ).append("\n"); 
		query.append("    #if (${cs} == 'Y')" ).append("\n"); 
		query.append("        AND     C.TO_MVMT_STS_CD = 'CS'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${web_mt} == 'Y') " ).append("\n"); 
		query.append("        AND     C.WEB_IND_FLG = 'Y'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("        AND    B.BKG_NO             = BS.BKG_NO(+)" ).append("\n"); 
		query.append("        AND    BS.BKG_CUST_TP_CD(+) = 'S'" ).append("\n"); 
		query.append("        AND    B.BKG_NO             = BC.BKG_NO(+)" ).append("\n"); 
		query.append("        AND    BC.BKG_CUST_TP_CD(+) = 'C'" ).append("\n"); 
		query.append("        AND    B.BKG_NO             = BN.BKG_NO(+)" ).append("\n"); 
		query.append("        AND    BN.BKG_CUST_TP_CD(+) = 'N'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${us_ofc_yn} == 'Y')	-- 2014.09.17 Add" ).append("\n"); 
		query.append("        AND    B.BKG_NO = T2.BKG_NO(+)" ).append("\n"); 
		query.append("        AND    B.CNTR_NO = T2.CNTR_NO(+)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${cond_type} != 'date')" ).append("\n"); 
		query.append("        AND     C.DMDT_CHG_STS_CD IN (" ).append("\n"); 
		query.append("                    #foreach( $chg_sts_cd in ${chg_sts_cd_list} )" ).append("\n"); 
		query.append("                         #if($velocityCount < $chg_sts_cd_list.size()) '$chg_sts_cd', #else '$chg_sts_cd' #end" ).append("\n"); 
		query.append("                    #end" ).append("\n"); 
		query.append("                )" ).append("\n"); 
		query.append("         #else" ).append("\n"); 
		query.append("             #if (${opt_date} == 'MVMT_DT')" ).append("\n"); 
		query.append("        AND     (1=0" ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   #if($chg_sts_cd_list1.size() > 0)" ).append("\n"); 
		query.append("                        OR (" ).append("\n"); 
		query.append("                             C.DMDT_CHG_STS_CD IN (" ).append("\n"); 
		query.append("                                  #foreach( $chg_sts_cd in ${chg_sts_cd_list1} )" ).append("\n"); 
		query.append("                                       #if($velocityCount < $chg_sts_cd_list1.size()) '$chg_sts_cd', #else '$chg_sts_cd' #end" ).append("\n"); 
		query.append("                                  #end" ).append("\n"); 
		query.append("                             )" ).append("\n"); 
		query.append("                             AND ( C.TO_MVMT_DT BETWEEN TO_DATE(@[fm_mvmt_dt], 'YYYYMMDD') " ).append("\n"); 
		query.append("                                                      AND TO_DATE(@[to_mvmt_dt], 'YYYYMMDD') + 0.99999 )" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("                   #end" ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   #if($chg_sts_cd_list2.size() > 0)" ).append("\n"); 
		query.append("                        OR (" ).append("\n"); 
		query.append("                             C.DMDT_CHG_STS_CD IN (" ).append("\n"); 
		query.append("                                  #foreach( $chg_sts_cd in ${chg_sts_cd_list2} )" ).append("\n"); 
		query.append("                                       #if($velocityCount < $chg_sts_cd_list2.size()) '$chg_sts_cd', #else '$chg_sts_cd' #end" ).append("\n"); 
		query.append("                                  #end" ).append("\n"); 
		query.append("                             )" ).append("\n"); 
		query.append("                             AND ( C.FM_MVMT_DT BETWEEN TO_DATE(@[fm_mvmt_dt], 'YYYYMMDD') " ).append("\n"); 
		query.append("                                                      AND TO_DATE(@[to_mvmt_dt], 'YYYYMMDD') + 0.99999 )" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("                   #end" ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("                 #if($chg_sts_cd_list3.size() > 0)" ).append("\n"); 
		query.append("                        OR (" ).append("\n"); 
		query.append("                             C.DMDT_CHG_STS_CD IN (" ).append("\n"); 
		query.append("                                  #foreach( $chg_sts_cd in ${chg_sts_cd_list3} )" ).append("\n"); 
		query.append("                                       #if($velocityCount < $chg_sts_cd_list3.size()) '$chg_sts_cd', #else '$chg_sts_cd' #end" ).append("\n"); 
		query.append("                                  #end" ).append("\n"); 
		query.append("                             )" ).append("\n"); 
		query.append("                             AND (( C.FM_MVMT_DT BETWEEN TO_DATE(@[fm_mvmt_dt], 'YYYYMMDD') " ).append("\n"); 
		query.append("                                                      AND TO_DATE(@[to_mvmt_dt], 'YYYYMMDD') + 0.99999 )" ).append("\n"); 
		query.append("                              OR (C.TO_MVMT_DT BETWEEN TO_DATE(@[fm_mvmt_dt], 'YYYYMMDD') " ).append("\n"); 
		query.append("                                                      AND TO_DATE(@[to_mvmt_dt], 'YYYYMMDD') + 0.99999 ))" ).append("\n"); 
		query.append("                         )" ).append("\n"); 
		query.append("                   #end" ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   #if (${all_long_stay_flg} == 'Y')" ).append("\n"); 
		query.append("                        OR C.DMDT_CHG_STS_CD = 'L'" ).append("\n"); 
		query.append("                   #end" ).append("\n"); 
		query.append("              )" ).append("\n"); 
		query.append("              #elseif (${opt_date} == 'APP_DT')" ).append("\n"); 
		query.append("         AND     C.DMDT_CHG_STS_CD IN (" ).append("\n"); 
		query.append("                        #foreach( $chg_sts_cd in ${chg_sts_cd_list} )" ).append("\n"); 
		query.append("                             #if($velocityCount < $chg_sts_cd_list.size()) '$chg_sts_cd', #else '$chg_sts_cd' #end" ).append("\n"); 
		query.append("                        #end" ).append("\n"); 
		query.append("                   )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("         AND     C.BZC_TRF_APLY_DT  BETWEEN TO_DATE(@[fm_bzc_trf_aply_dt], 'YYYYMMDD') " ).append("\n"); 
		query.append("                                    AND     TO_DATE(@[to_bzc_trf_aply_dt], 'YYYYMMDD') + 0.99999" ).append("\n"); 
		query.append("             #end" ).append("\n"); 
		query.append("         #end" ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("#if (${chg_type} == 'G') " ).append("\n"); 
		query.append("        AND     C.CHG_SEQ = 1" ).append("\n"); 
		query.append("#elseif (${chg_type} == 'B') " ).append("\n"); 
		query.append("        AND     C.CHG_SEQ > 1" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("        AND     C.DMDT_INV_NO   = T1.DMDT_INV_NO (+)" ).append("\n"); 
		query.append("#if(${dmdt_ar_if_cd} == 'Y')" ).append("\n"); 
		query.append("        AND     NVL(T1.DMDT_AR_IF_CD, 'N') IN (@[dmdt_ar_if_cd], 'H')" ).append("\n"); 
		query.append("#elseif(${dmdt_ar_if_cd} == 'N')" ).append("\n"); 
		query.append("        AND     NVL(T1.DMDT_AR_IF_CD, 'N') =  @[dmdt_ar_if_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${uclm_flg} != 'ALL')          " ).append("\n"); 
		query.append("        AND     NVL(C.UCLM_FLG, 'N') =  @[uclm_flg]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '0') " ).append("\n"); 
		query.append("        AND     C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#end  " ).append("\n"); 
		query.append("#if (${cond_type} == 'date')" ).append("\n"); 
		query.append("  #if (${fm_mvmt_yd_cd} != '')" ).append("\n"); 
		query.append("       #if ($fm_mvmt_yd_cd.length() == 5)" ).append("\n"); 
		query.append("        AND SUBSTR(C.FM_MVMT_YD_CD, 1, 5) = @[fm_mvmt_yd_cd]" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        AND C.FM_MVMT_YD_CD LIKE @[fm_mvmt_yd_cd] || '%'    -- 2012.11.26 Modify" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("  #elseif (${to_mvmt_yd_cd} != '')" ).append("\n"); 
		query.append("       #if ($to_mvmt_yd_cd.length() == 5)" ).append("\n"); 
		query.append("        AND SUBSTR(C.TO_MVMT_YD_CD,1, 5) = @[to_mvmt_yd_cd]" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        AND C.TO_MVMT_YD_CD LIKE @[to_mvmt_yd_cd] || '%'    -- 2012.11.26 Modify" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${cond_type} == 'vvd_cd')" ).append("\n"); 
		query.append("  #if (${vvd_cd} != '')" ).append("\n"); 
		query.append("        AND     (           B.VSL_CD     = SUBSTR(@[vvd_cd],1,4) " ).append("\n"); 
		query.append("                        AND B.SKD_VOY_NO = SUBSTR(@[vvd_cd],5,4) " ).append("\n"); 
		query.append("                        AND B.SKD_DIR_CD = SUBSTR(@[vvd_cd],9) " ).append("\n"); 
		query.append("                )" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  #if (${pod_cd} != '' || ${pol_cd} != '')" ).append("\n"); 
		query.append("          AND   (1=0" ).append("\n"); 
		query.append("    #if (${pod_cd} != '')" ).append("\n"); 
		query.append("               OR B.POD_CD = @[pod_cd]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${pol_cd} != '')" ).append("\n"); 
		query.append("               OR B.POL_CD = @[pol_cd]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("                )" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  #if (${dem_type} == 'I') " ).append("\n"); 
		query.append("  AND (  (C.DMDT_TRF_CD='DMIF' AND C.TO_MVMT_STS_CD NOT IN ('ID','CS','DR'))" ).append("\n"); 
		query.append("       OR (C.DMDT_TRF_CD='DMOF' AND C.DMDT_CHG_LOC_DIV_CD='POL')" ).append("\n"); 
		query.append("       OR (C.DMDT_TRF_CD IN ('CTOC','CTIC','DTOC','DTIC'))" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("  #elseif (${dem_type} == 'L') " ).append("\n"); 
		query.append("  AND ((C.DMDT_TRF_CD='DMIF' AND C.TO_MVMT_STS_CD='ID')" ).append("\n"); 
		query.append("       OR (C.DMDT_TRF_CD='DMOF' AND C.DMDT_CHG_LOC_DIV_CD<>'POL')" ).append("\n"); 
		query.append("       OR (C.DMDT_TRF_CD IN ('CTOC','CTIC','DTOC','DTIC'))" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("         #if (${cond_type} == 'cntr')" ).append("\n"); 
		query.append("              #if (${bkg_no} != '')     " ).append("\n"); 
		query.append("              AND B.BKG_NO IN (" ).append("\n"); 
		query.append("                   #foreach( $bkg_cd in ${bkg_no_list} )" ).append("\n"); 
		query.append("                        #if($velocityCount < $bkg_no_list.size()) '$bkg_cd', #else '$bkg_cd' #end" ).append("\n"); 
		query.append("                   #end" ).append("\n"); 
		query.append("                   )" ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("              #if (${bl_no} != '')" ).append("\n"); 
		query.append("              AND B.BL_NO IN (" ).append("\n"); 
		query.append("                   #foreach( $bl_cd in ${bl_no_list} )" ).append("\n"); 
		query.append("                        #if($velocityCount < $bl_no_list.size()) '$bl_cd', #else '$bl_cd' #end" ).append("\n"); 
		query.append("                   #end" ).append("\n"); 
		query.append("                   )" ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("              #if (${cntr_no} != '')" ).append("\n"); 
		query.append("              AND C.CNTR_NO IN (" ).append("\n"); 
		query.append("                   #foreach( $cntr_cd in ${cntr_no_list} )" ).append("\n"); 
		query.append("                        #if($velocityCount < $cntr_no_list.size()) '$cntr_cd', #else '$cntr_cd' #end" ).append("\n"); 
		query.append("                   #end" ).append("\n"); 
		query.append("                   )" ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("         #end" ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("#if (${cust_cd} != '')" ).append("\n"); 
		query.append("    #if (${cust_type} == '')" ).append("\n"); 
		query.append("        AND     (" ).append("\n"); 
		query.append("                        C.ACT_CNT_CD     = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("                AND     C.ACT_CUST_SEQ     = LTRIM(SUBSTR(@[cust_cd],3), '0')" ).append("\n"); 
		query.append("                OR      BS.CUST_CNT_CD     = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("                AND     BS.CUST_SEQ        = LTRIM(SUBSTR(@[cust_cd],3), '0')" ).append("\n"); 
		query.append("                OR      BC.CUST_CNT_CD     = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("                AND     BC.CUST_SEQ        = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("                OR      BN.CUST_CNT_CD     = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("                AND     BN.CUST_SEQ        = LTRIM(SUBSTR(@[cust_cd],3), '0')" ).append("\n"); 
		query.append("                OR      (" ).append("\n"); 
		query.append("                        EXISTS  (" ).append("\n"); 
		query.append("                                SELECT  'X'" ).append("\n"); 
		query.append("                                FROM    INV_AR_MN I" ).append("\n"); 
		query.append("                                WHERE   I.BKG_NO     = B.BKG_NO" ).append("\n"); 
		query.append("                                AND     I.IO_BND_CD  = SUBSTR(C.DMDT_TRF_CD, 3, 1)" ).append("\n"); 
		query.append("                                AND     AR_IF_NO     =  (" ).append("\n"); 
		query.append("                                                        SELECT  MAX(AR_IF_NO)" ).append("\n"); 
		query.append("                                                        FROM    INV_AR_MN" ).append("\n"); 
		query.append("                                                        WHERE   BKG_NO    = B.BKG_NO" ).append("\n"); 
		query.append("                                                        AND     IO_BND_CD = SUBSTR(C.DMDT_TRF_CD, 3, 1)" ).append("\n"); 
		query.append("                                                        )" ).append("\n"); 
		query.append("                                AND     I.ACT_CUST_CNT_CD   = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("                                AND     I.ACT_CUST_SEQ      = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("                                AND     ROWNUM  = 1" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("                )" ).append("\n"); 
		query.append("    #elseif (${cust_type} == 'P')" ).append("\n"); 
		query.append("        AND     C.ACT_CNT_CD        = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("        AND     C.ACT_CUST_SEQ      = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("    #elseif (${cust_type} == 'S') " ).append("\n"); 
		query.append("        AND     BS.CUST_CNT_CD      = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("        AND     BS.CUST_SEQ         = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("    #elseif (${cust_type} == 'C') " ).append("\n"); 
		query.append("        AND     BC.CUST_CNT_CD      = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("        AND     BC.CUST_SEQ         = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("    #elseif (${cust_type} == 'N') " ).append("\n"); 
		query.append("        AND     BN.CUST_CNT_CD      = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("        AND     BN.CUST_SEQ         = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("    #elseif (${cust_type} == 'A')" ).append("\n"); 
		query.append("        AND     EXISTS  (" ).append("\n"); 
		query.append("                        SELECT  'X'" ).append("\n"); 
		query.append("                        FROM    INV_AR_MN I" ).append("\n"); 
		query.append("                        WHERE   I.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                        AND     I.IO_BND_CD     = SUBSTR(C.DMDT_TRF_CD, 3, 1)" ).append("\n"); 
		query.append("                        AND     AR_IF_NO        =   (" ).append("\n"); 
		query.append("                                                    SELECT  MAX(AR_IF_NO) " ).append("\n"); 
		query.append("                                                    FROM    INV_AR_MN" ).append("\n"); 
		query.append("                                                    WHERE   BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                    AND     IO_BND_CD = SUBSTR(C.DMDT_TRF_CD, 3, 1)" ).append("\n"); 
		query.append("                                                    )" ).append("\n"); 
		query.append("                        AND     I.ACT_CUST_CNT_CD   = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("                        AND     I.ACT_CUST_SEQ      = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("                        AND     ROWNUM      = 1" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end         " ).append("\n"); 
		query.append("#if (${svc_provdr} != '') " ).append("\n"); 
		query.append("        AND     C.VNDR_SEQ      = LTRIM(@[svc_provdr],'0')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${sc_no} != '') " ).append("\n"); 
		query.append("        AND     B.SC_NO         = @[sc_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${rfa_no} != '') " ).append("\n"); 
		query.append("        AND     B.RFA_NO        = @[rfa_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dmdt_cntr_tp_cd_list} != '')" ).append("\n"); 
		query.append("        AND     B.DMDT_CNTR_TP_CD   IN (" ).append("\n"); 
		query.append("                #foreach($dmdt_cntr_tp_cd in ${dmdt_cntr_tp_cd_list} )" ).append("\n"); 
		query.append("                    #if($velocityCount < $dmdt_cntr_tp_cd_list.size()) '$dmdt_cntr_tp_cd', #else '$dmdt_cntr_tp_cd' #end" ).append("\n"); 
		query.append("                #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_rcv_term_cd_list} != '')" ).append("\n"); 
		query.append("        AND     B.BKG_RCV_TERM_CD   IN (" ).append("\n"); 
		query.append("                #foreach($bkg_rcv_term_cd in ${bkg_rcv_term_cd_list} )" ).append("\n"); 
		query.append("                    #if($velocityCount < $bkg_rcv_term_cd_list.size()) '$bkg_rcv_term_cd', #else '$bkg_rcv_term_cd' #end" ).append("\n"); 
		query.append("                #end" ).append("\n"); 
		query.append("         )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_de_term_cd_list} != '')" ).append("\n"); 
		query.append("        AND     B.BKG_DE_TERM_CD    IN (" ).append("\n"); 
		query.append("                #foreach($bkg_de_term_cd in ${bkg_de_term_cd_list} )" ).append("\n"); 
		query.append("                    #if($velocityCount < $bkg_de_term_cd_list.size()) '$bkg_de_term_cd', #else '$bkg_de_term_cd' #end" ).append("\n"); 
		query.append("                #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fm_mvmt_sts_cd_list} != '')" ).append("\n"); 
		query.append("        AND NVL(C.FM_MVMT_STS_CD, 'N/A')    IN (" ).append("\n"); 
		query.append("                #foreach($fm_mvmt_sts_cd in ${fm_mvmt_sts_cd_list} )" ).append("\n"); 
		query.append("                     #if($velocityCount < $fm_mvmt_sts_cd_list.size()) '$fm_mvmt_sts_cd', #else '$fm_mvmt_sts_cd' #end" ).append("\n"); 
		query.append("                #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${to_mvmt_sts_cd_list} != '')" ).append("\n"); 
		query.append("        AND     NVL(C.TO_MVMT_STS_CD, 'N/A') IN (" ).append("\n"); 
		query.append("                #foreach($to_mvmt_sts_cd in ${to_mvmt_sts_cd_list} )" ).append("\n"); 
		query.append("                     #if($velocityCount < $to_mvmt_sts_cd_list.size()) '$to_mvmt_sts_cd', #else '$to_mvmt_sts_cd' #end" ).append("\n"); 
		query.append("                #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("#end  " ).append("\n"); 
		query.append("#if (${ofc_trns_rhq_cng_flg} != 'ALL')" ).append("\n"); 
		query.append("         AND   C.OFC_TRNS_RHQ_CNG_FLG = @[ofc_trns_rhq_cng_flg]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("        )            T" ).append("\n"); 
		query.append("#if ( ( ${org_gubun_cd} != '') && (${fm_loc_cd} != '') )" ).append("\n"); 
		query.append("        , MDM_LOCATION T1" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ( (${dest_gubun_cd} != '' ) && ( ${to_loc_cd} != ''))" ).append("\n"); 
		query.append("        , MDM_LOCATION T2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("WHERE   1=1" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${org_gubun_cd} != '')" ).append("\n"); 
		query.append("  #if ( (${org_gubun_cd} == 'CONTI_CD' || ${org_gubun_cd} == 'POL_CD') && (${fm_loc_cd} != '') )" ).append("\n"); 
		query.append("AND     T.POL_CD        = T1.LOC_CD" ).append("\n"); 
		query.append("  #elseif ( ( ${org_gubun_cd} == 'POR_CD') && (${fm_loc_cd} != '') )" ).append("\n"); 
		query.append("AND    T.POR_CD  = T1.LOC_CD" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("  #if ( ${fm_loc_cd} != '')" ).append("\n"); 
		query.append("     #if (${org_gubun_cd} == 'CONTI_CD')" ).append("\n"); 
		query.append("AND    T1.CONTI_CD LIKE @[fm_loc_cd] || '%'" ).append("\n"); 
		query.append("     #elseif (${org_gubun_cd} == 'POL_CD')" ).append("\n"); 
		query.append("AND    T1.LOC_CD   LIKE @[fm_loc_cd] || '%'" ).append("\n"); 
		query.append("     #elseif (${org_gubun_cd} == 'POR_CD')" ).append("\n"); 
		query.append("AND    T1.LOC_CD   LIKE @[fm_loc_cd] || '%'" ).append("\n"); 
		query.append("     #end" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${dest_gubun_cd} != '' )" ).append("\n"); 
		query.append("  #if ((${dest_gubun_cd} == 'CONTI_CD' || ${dest_gubun_cd} == 'POD_CD') && (${to_loc_cd} != '') )" ).append("\n"); 
		query.append("AND    T.POD_CD     = T2.LOC_CD" ).append("\n"); 
		query.append("  #elseif ( ( ${dest_gubun_cd} == 'DEL_CD') && (${to_loc_cd} != '') )" ).append("\n"); 
		query.append("AND    T.DEL_CD     = T2.LOC_CD" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  #if ( ${to_loc_cd} != '')" ).append("\n"); 
		query.append("     #if (${dest_gubun_cd} == 'CONTI_CD')" ).append("\n"); 
		query.append("AND     T2.CONTI_CD = @[to_loc_cd]" ).append("\n"); 
		query.append("     #elseif (${dest_gubun_cd} == 'POD_CD')" ).append("\n"); 
		query.append("AND     T2.LOC_CD   LIKE @[to_loc_cd] || '%'" ).append("\n"); 
		query.append("     #elseif (${dest_gubun_cd} == 'DEL_CD')" ).append("\n"); 
		query.append("AND     T2.LOC_CD   LIKE @[to_loc_cd] || '%'" ).append("\n"); 
		query.append("     #end" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${dmdt_bkg_cgo_tp_cd_list} != '')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND     DMDT_BKG_CGO_TP_CD_GUBUN IN (" ).append("\n"); 
		query.append("               #foreach($dmdt_bkg_cgo_tp_cd in ${dmdt_bkg_cgo_tp_cd_list} )" ).append("\n"); 
		query.append("                    #if($velocityCount < $dmdt_bkg_cgo_tp_cd_list.size()) '$dmdt_bkg_cgo_tp_cd', #else '$dmdt_bkg_cgo_tp_cd' #end" ).append("\n"); 
		query.append("               #end" ).append("\n"); 
		query.append("               )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${inact_sts_cd} != '')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND (" ).append("\n"); 
		query.append("			SELECT  CASE " ).append("\n"); 
		query.append("						WHEN NVL(MAX(DD.DMDT_DELT_RQST_STS_CD), 'N') IN ('C', 'N') THEN 'N'" ).append("\n"); 
		query.append("						WHEN 0 < MAX((	" ).append("\n"); 
		query.append("									SELECT  COUNT(1)" ).append("\n"); 
		query.append("									  FROM  DMT_CHG_DELT_PATH " ).append("\n"); 
		query.append("									 WHERE  SYS_AREA_GRP_ID     = DD.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("									   AND  CNTR_NO             = DD.CNTR_NO" ).append("\n"); 
		query.append("									   AND  CNTR_CYC_NO         = DD.CNTR_CYC_NO" ).append("\n"); 
		query.append("									   AND  DMDT_TRF_CD         = DD.DMDT_TRF_CD" ).append("\n"); 
		query.append("									   AND  DMDT_CHG_LOC_DIV_CD = DD.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("									   AND  CHG_SEQ             = DD.CHG_SEQ" ).append("\n"); 
		query.append("									   AND  CHG_OFC_CD          = DD.CHG_OFC_CD" ).append("\n"); 
		query.append("									   AND  DELT_SEQ            = DD.DELT_SEQ" ).append("\n"); 
		query.append("									   AND  CHG_DELT_PATH_LVL  >=" ).append("\n"); 
		query.append("											(" ).append("\n"); 
		query.append("												SELECT  max(CHG_DELT_PATH_LVL)" ).append("\n"); 
		query.append("												  FROM  DMT_CHG_DELT_PATH" ).append("\n"); 
		query.append("												 WHERE  SYS_AREA_GRP_ID        = DD.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("												   AND  CNTR_NO                = DD.CNTR_NO" ).append("\n"); 
		query.append("												   AND  CNTR_CYC_NO            = DD.CNTR_CYC_NO" ).append("\n"); 
		query.append("												   AND  DMDT_TRF_CD            = DD.DMDT_TRF_CD" ).append("\n"); 
		query.append("												   AND  DMDT_CHG_LOC_DIV_CD    = DD.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("												   AND  CHG_SEQ                = DD.CHG_SEQ" ).append("\n"); 
		query.append("												   AND  CHG_OFC_CD             = DD.CHG_OFC_CD" ).append("\n"); 
		query.append("												   AND  DELT_SEQ               = DD.DELT_SEQ" ).append("\n"); 
		query.append("												   AND  CHG_DELT_PATH_CPLS_FLG = 'Y'" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("									   and  CHG_DELT_STS_CD = 'A'" ).append("\n"); 
		query.append("								 )) THEN 'H'		--// Charge Deletion 요청 불가, Charge Deletion Cancel 불가" ).append("\n"); 
		query.append("						ELSE MAX(DD.DMDT_DELT_RQST_STS_CD)" ).append("\n"); 
		query.append("					END" ).append("\n"); 
		query.append("						" ).append("\n"); 
		query.append("			  FROM  DMT_CHG_DELT_RQST_APRO DD" ).append("\n"); 
		query.append("			 WHERE  DD.SYS_AREA_GRP_ID     = T.SVR_ID" ).append("\n"); 
		query.append("			   AND	DD.CNTR_NO		       = T.CNTR_NO" ).append("\n"); 
		query.append("			   AND	DD.CNTR_CYC_NO		   = T.CNTR_CYC_NO" ).append("\n"); 
		query.append("			   AND	DD.DMDT_TRF_CD		   = T.DMDT_TRF_CD" ).append("\n"); 
		query.append("			   AND	DD.DMDT_CHG_LOC_DIV_CD = T.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("			   AND	DD.CHG_SEQ			   = T.CHG_SEQ" ).append("\n"); 
		query.append("			   AND  DD.CHG_OFC_CD          = T.OFC_CD" ).append("\n"); 
		query.append("			   AND  DD.DELT_SEQ            = " ).append("\n"); 
		query.append("					( " ).append("\n"); 
		query.append("						SELECT  NVL(MAX(DS.DELT_SEQ), 0) " ).append("\n"); 
		query.append("						  FROM  DMT_CHG_DELT_RQST_APRO DS" ).append("\n"); 
		query.append("						 WHERE  DS.SYS_AREA_GRP_ID     = DD.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("						   AND  DS.CNTR_NO	           = DD.CNTR_NO" ).append("\n"); 
		query.append("						   AND  DS.CNTR_CYC_NO	       = DD.CNTR_CYC_NO" ).append("\n"); 
		query.append("						   AND  DS.DMDT_TRF_CD	       = DD.DMDT_TRF_CD" ).append("\n"); 
		query.append("						   AND  DS.DMDT_CHG_LOC_DIV_CD = DD.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append("						   AND  DS.CHG_SEQ		       = DD.CHG_SEQ" ).append("\n"); 
		query.append("						   AND  DS.CHG_OFC_CD          = DD.CHG_OFC_CD  " ).append("\n"); 
		query.append("						   AND  DS.DMDT_DELT_RQST_STS_CD != 'C'" ).append("\n"); 
		query.append("					)  " ).append("\n"); 
		query.append("		 )IN (" ).append("\n"); 
		query.append("               #foreach($inact_sts_cd in ${inact_sts_cd_list} )" ).append("\n"); 
		query.append("                    #if($velocityCount < $inact_sts_cd_list.size()) '$inact_sts_cd', #else '$inact_sts_cd' #end" ).append("\n"); 
		query.append("               #end" ).append("\n"); 
		query.append("               )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${aft_dar_sts_cd_list} != '')" ).append("\n"); 
		query.append("	#if (${aft_dar_sts_all_flg} != '')" ).append("\n"); 
		query.append("		AND (DMDT_EXPT_RQST_STS_CD IS NOT NULL AND DMDT_EXPT_RQST_STS_CD <>'T')" ).append("\n"); 
		query.append("	#else" ).append("\n"); 
		query.append("		AND (1=0" ).append("\n"); 
		query.append("		#if (${aft_dar_sts_process_flg} != '')" ).append("\n"); 
		query.append("			OR DMDT_EXPT_RQST_STS_CD NOT IN ('A', 'R', 'J', 'O', 'T')" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("			OR DMDT_EXPT_RQST_STS_CD IN (" ).append("\n"); 
		query.append("			#foreach($aft_dar_sts_cd in ${aft_dar_sts_cd_list} )" ).append("\n"); 
		query.append("				#if($velocityCount < $aft_dar_sts_cd_list.size())" ).append("\n"); 
		query.append("					'$aft_dar_sts_cd', " ).append("\n"); 
		query.append("				#else " ).append("\n"); 
		query.append("					'$aft_dar_sts_cd' " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			)" ).append("\n"); 
		query.append("		)" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("ORDER BY CNTR_NO, FM_MVMT_DT" ).append("\n"); 

	}
}