<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="VslResidualSpaceManageDBDAOSearchVslRsdlSpaceRSQL">
			<desc><![CDATA[Vessel R.Capa. [ EES_EQR_0060 ]
EQR_SCNR_VSL_RSDL_CAPA 테이블에서 데이터 조회]]></desc>
			<sql><![CDATA[
SELECT	 DECODE(CO_CD,'H','SML','S','SEN') AS CO_CD
		,FCAST_YRWK
		,ECC_CD
		,VSL_LANE_CD
		,VVD
		,SUM(VSL_BSA_SPC)  AS VSL_BSA_SPC
		,SUM(VSL_FULL_SPC) AS VSL_FULL_SPC
		,SUM(VSL_DEAD_SPC) AS VSL_DEAD_SPC
		,SUM(VSL_RSDL_SPC) AS VSL_RSDL_SPC
		,SUM(VSL_SPC)      AS VSL_SPC
		,SUM(TTL_RSDL_SPC) AS TTL_RSDL_SPC
		,MAX(SCNR_ID)      AS SCNR_ID
FROM	(
		SELECT	FCAST_YRWK
				,(SELECT	${typeby} 
				  FROM		EQR_ECC_MST
				  WHERE		CA.ECC_CD = ECC_CD) ECC_CD
				,VSL_LANE_CD
				,VSL_CD|| SKD_VOY_NO||SKD_DIR_CD  VVD
				,VSL_BSA_SPC
				,VSL_FULL_SPC
				,VSL_DEAD_SPC
				,VSL_BSA_SPC - ( VSL_FULL_SPC + VSL_DEAD_SPC )  VSL_RSDL_SPC
				,VSL_SPC
				,TTL_RSDL_SPC
				,CO_CD
				,SCNR_ID	-- key : hidden
		FROM	 EQR_SCNR_VSL_RSDL_CAPA CA
				,EQR_ECC_MST EM
		WHERE	CA.ECC_CD = EM.ECC_CD
			AND SCNR_ID = @[scnr_id]
			AND	CA.FCAST_YRWK BETWEEN @[frweek] AND @[toweek]
	#if (${status} != '')
		#if (${status} == 'R') 
			AND EM.RCC_CD IN (
			#foreach( $key in ${arrlocation}) 
				#if($velocityCount < $arrlocation.size()) 
					'$key', 
				#else 
					'$key' 
				#end 
			#end
						)
		#elseif (${status} == 'L') 
			AND EM.LCC_CD IN (
			#foreach( $key in ${arrlocation}) 
				#if($velocityCount < $arrlocation.size()) 
					'$key', 
				#else 
					'$key' 
				#end 
			#end
						)
		#elseif (${status} == 'E') 
			AND EM.ECC_CD IN (
			#foreach( $key in ${arrlocation}) 
				#if($velocityCount < $arrlocation.size()) 
					'$key', 
				#else 
					'$key' 
				#end 
			#end
					)
		#end
	#end

		#if ( $arrlane.size() > 0 ) 
			AND CA.VSL_LANE_CD IN(
			#foreach( $key in ${arrlane}) 
				#if($velocityCount < $arrlane.size()) 
					'$key', 
				#else 
					'$key' 
				#end 
			#end
			)
		#end
		#if ( $arrvvd.size() > 0 )
			AND CA.VSL_CD||CA.SKD_VOY_NO||CA.SKD_DIR_CD IN (
			#foreach( $key in ${arrvvd}) 
				#if($velocityCount < $arrvvd.size()) 
					'$key', 
				#else 
					'$key' 
				#end 
			#end
			)
		#end
		)
GROUP BY	FCAST_YRWK
		,	ECC_CD
		,	VSL_LANE_CD
		,	VVD
		,	CO_CD
ORDER BY	FCAST_YRWK
		,	ECC_CD
		,	VSL_LANE_CD
		,	VVD			]]></sql>
			<params>
				<param name="scnr_id" type="12" value="" out="N"/>
				<param name="frweek" type="12" value="" out="N"/>
				<param name="toweek" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
