<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="OnhireBalanceDBDAOsearchPlanAndApprovalRequestNoRSQL">
			<desc><![CDATA[EQR_CTRL_ONH_PLN_APRO 에서 새로운 LSE_RQST_NO 를 채번한다.]]></desc>
			<sql><![CDATA[
-- LSE_RQST_NO 
-- Request No. 구조 : R-(LCC_CD뒷 세자리)(TERM 두 자리)(YYYYMMDD)-001

SELECT 'R-'||SUBSTR(@[lcc_cd],3,3)||@[eq_lstm_cd]||TO_CHAR(SYSDATE,'YYYYMMDD')||'-'||LPAD(NVL(MAX(SUBSTR(LSE_RQST_NO,17,3)),0)+1,3,'0') LSE_RQST_NO
FROM   EQR_CTRL_ONH_PLN_APRO  
WHERE  SUBSTR(LSE_RQST_NO,1,16) = 'R-'||SUBSTR(@[lcc_cd],3,3)||@[eq_lstm_cd]||TO_CHAR(SYSDATE,'YYYYMMDD')||'-'			]]></sql>
			<params>
				<param name="lcc_cd" type="12" value="" out="N"/>
				<param name="eq_lstm_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
