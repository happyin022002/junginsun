<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DemandNoteSendDBDAOSearchDemandNoteIssueMstPreviewRSQL">
			<desc><![CDATA[SearchDemandNoteIssueMstPreview]]></desc>
			<sql><![CDATA[
#if (${call_to_rd_tp} == 'group') 

SELECT MAX (CUST_VAT) AS CUST_VAT
      ,MAX (ADDRESS01) AS ADDRESS01
      ,MAX (OFC_ADD01) AS OFC_ADD01
      ,MAX (OFC_ADD02) AS OFC_ADD02
      ,MAX (OFC_ADD03) AS OFC_ADD03
      ,MAX (HEADER01) AS HEADER01
      ,MAX (HEADER02) AS HEADER02
      ,MAX (HEADER03) AS HEADER03
      ,MAX (HEADER04) AS HEADER04
      ,MAX (HEADER05) AS HEADER05
      ,MAX (HEADER06) AS HEADER06
      ,MAX (HEADER07) AS HEADER07
      ,MAX (HEADER08) AS HEADER08
      ,MAX (HEADER09) AS HEADER09
      ,MAX (HEADER10) AS HEADER10
      ,MAX (SH_NUM) AS SH_NUM
      ,MAX (HJS_REF) AS HJS_REF
      ,MAX (PRINT_DATE) AS PRINT_DATE
      ,MAX (DMDT_TRF_NM) AS DMDT_TRF_NM
      ,MAX (TITLE) AS TITLE
	  ,MAX (TAX_NM) AS TAX_NM
  FROM (SELECT CUST.CUST_RGST_NO AS CUST_VAT
              ,'' AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS HEADER06
              ,'' AS HEADER07
              ,'' AS HEADER08
              ,'' AS HEADER09
              ,'' AS HEADER10
              ,'' AS SH_NUM
              ,'' AS HJS_REF
              ,'' AS PRINT_DATE
              ,'' AS DMDT_TRF_NM
			  ,'' AS TITLE
              ,'' AS TAX_NM
          FROM MDM_CUSTOMER CUST
         WHERE CUST.CUST_CNT_CD = SUBSTR (@[payer_cd]
                                         ,1
                                         ,2
                                         )
           AND CUST.CUST_SEQ = SUBSTR (@[payer_cd]
                                      ,3
                                      ,6
                                      )
        UNION ALL
        SELECT '' AS CUST_VAT
			  , (
                SELECT CUST_NM || '|' || ADDRESS01 
                FROM (
                    SELECT DMDT_PAYR_NM AS CUST_NM
                          ,REPLACE (DMDT_PAYR_ADDR
                                   ,'@*'
                                   , CHR (13)
                                     || CHR (10)
                                   ) AS ADDRESS01
                          , 1 AS SORT         
                      FROM DMT_PAYR_INFO
                     WHERE SYS_AREA_GRP_ID =
                                 (SELECT SYS_AREA_GRP_ID
                                    FROM COM_SYS_AREA_GRP_ID
                                   WHERE CNT_CD = (SELECT SUBSTR (LOC_CD
                                                                 ,1
                                                                 ,2
                                                                 )
                                                     FROM MDM_ORGANIZATION
                                                    WHERE OFC_CD = @[session_ofc_cd])
                                     AND CO_IND_CD = 'H')
                       AND CUST_CNT_CD = SUBSTR (@[payer_cd] ,1 ,2)
                       AND CUST_SEQ = SUBSTR (@[payer_cd] ,3 ,6)
                    UNION ALL
                    SELECT LOCL_NM AS CUST_NM
                            ,TRIM (LOCL_ADDR1)
                           || CHR (13)
                           || CHR (10)
                           || TRIM (LOCL_ADDR2)
                           || CHR (13)
                           || CHR (10)
                           || TRIM (LOCL_ADDR3)
                           || CHR (13)
                           || CHR (10)
                           || TRIM (LOCL_ADDR4)
                           || ' '
                           || LOCL_ZIP_CD AS ADDRESS01
                           , 2 AS SORT 
                      FROM MDM_CR_CUST
                     WHERE CUST_CNT_CD = SUBSTR (@[payer_cd] ,1 ,2)
                       AND CUST_SEQ = SUBSTR (@[payer_cd] ,3 ,6)
                       AND LOCL_NM IS NOT NULL
                    UNION ALL   
                    SELECT CASE
                              WHEN SUBSTR (@[payer_cd] ,1 ,2) = '00'
                                 THEN (SELECT VNDR_LGL_ENG_NM
                                         FROM MDM_VENDOR
                                        WHERE VNDR_SEQ = SUBSTR (@[payer_cd] ,3 ,6)
                                          AND VNDR_LGL_ENG_NM IS NOT NULL)
                              ELSE (SELECT CUST_LGL_ENG_NM
                                      FROM MDM_CUSTOMER
                                     WHERE CUST_CNT_CD = SUBSTR (@[payer_cd] ,1 ,2)
                                       AND CUST_SEQ = SUBSTR (@[payer_cd] ,3 ,6)
                                       AND CUST_LGL_ENG_NM IS NOT NULL)
                           END AS CUST_NM
                          ,CASE
                              WHEN SUBSTR (@[payer_cd] ,1 ,2) = '00'
                                 THEN (SELECT ZIP_CD
                                              || ','
                                              || REPLACE (ENG_ADDR
                                                         ,'@*'
                                                         , CHR (13)
                                                           || CHR (10)
                                                         )
                                         FROM MDM_VENDOR
                                        WHERE VNDR_SEQ = SUBSTR (@[payer_cd] ,3 ,6))
                              ELSE (SELECT CASE
                                              WHEN CN.BKG_ADDR_ORD_CD = 1
                                                 THEN REPLACE (ADDR.BZET_ADDR
                                                              ,'@*'
                                                              , CHR (13)
                                                                || CHR (10)
                                                              )
                                                      || ' '
                                                      || ADDR.ZIP_CD
                                              WHEN CN.BKG_ADDR_ORD_CD = 2
                                                 THEN REPLACE (ADDR.BZET_ADDR
                                                              ,'@*'
                                                              , CHR (13)
                                                                || CHR (10)
                                                              )
                                                      || ' '
                                                      || ADDR.CTY_NM
                                              WHEN CN.BKG_ADDR_ORD_CD = 3
                                                 THEN REPLACE (ADDR.BZET_ADDR
                                                              ,'@*'
                                                              , CHR (13)
                                                                || CHR (10)
                                                              )
                                                      || ' '
                                                      || ADDR.CTY_NM
                                                      || ' '
                                                      || ADDR.ZIP_CD
                                              WHEN CN.BKG_ADDR_ORD_CD = 4
                                                 THEN REPLACE (ADDR.BZET_ADDR
                                                              ,'@*'
                                                              , CHR (13)
                                                                || CHR (10)
                                                              )
                                                      || ' '
                                                      || ADDR.CTY_NM
                                                      || ' '
                                                      || ADDR.STE_CD
                                                      || ' '
                                                      || ADDR.ZIP_CD
                                              WHEN CN.BKG_ADDR_ORD_CD = 5
                                                 THEN REPLACE (ADDR.BZET_ADDR
                                                              ,'@*'
                                                              , CHR (13)
                                                                || CHR (10)
                                                              )
                                                      || ' '
                                                      || ADDR.CTY_NM
                                                      || ' '
                                                      || ADDR.ZIP_CD
                                              WHEN CN.BKG_ADDR_ORD_CD = 6
                                                 THEN ADDR.CTY_NM
                                                      || ' '
                                                      || REPLACE (ADDR.BZET_ADDR
                                                                 ,'@*'
                                                                 , CHR (13)
                                                                   || CHR (10)
                                                                 )
                                                      || ' '
                                                      || ADDR.ZIP_CD
                                              ELSE REPLACE (ADDR.BZET_ADDR
                                                                 ,'@*'
                                                                 , CHR (13)
                                                                   || CHR (10)
                                                                 ) 
                                                   || ' '
                                                   || ADDR.CTY_NM
                                                   || ' '
                                                   || ADDR.ZIP_CD
                                           END
                                      FROM MDM_CUST_ADDR ADDR
                                          ,MDM_COUNTRY CN
                                     WHERE ADDR.CUST_CNT_CD = CN.CNT_CD(+)
									   AND ADDR.PRMRY_CHK_FLG = 'Y'
                                       AND ADDR.CUST_CNT_CD = SUBSTR (@[payer_cd] ,1 ,2)
                                       AND ADDR.CUST_SEQ = SUBSTR (@[payer_cd] ,3 ,6)
									   AND ROWNUM = 1 )
                           END AS ADDRESS01
                           , 3 AS SORT 
                      FROM DUAL
                      ORDER BY SORT   
                    ) 
                    WHERE ROWNUM < 2
                )  AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS HEADER06
              ,'' AS HEADER07
              ,'' AS HEADER08
              ,'' AS HEADER09
              ,'' AS HEADER10
              ,'' AS SH_NUM
              ,'' AS HJS_REF
              ,'' AS PRINT_DATE
              ,'' AS DMDT_TRF_NM
			  ,'' AS TITLE
			  ,'' AS TAX_NM
          FROM DUAL
        UNION ALL
        SELECT '' AS CUST_VAT      
			  ,'' AS ADDRESS01        
              ,REPLACE(B.SH_ADDR1,'@*',CHR(13)||CHR(10)) AS OFC_ADD01
              ,REPLACE(B.SH_ADDR2,'@*',CHR(13)||CHR(10)) AS OFC_ADD02
              ,REPLACE(B.SH_ADDR3,'@*',CHR(13)||CHR(10)) AS OFC_ADD03
              ,B.SH_HD_N1ST_MSG AS HEADER01
              ,B.SH_HD_N2ND_MSG AS HEADER02
              ,B.SH_HD_N3RD_MSG AS HEADER03
              ,B.SH_HD_N4TH_MSG AS HEADER04
              ,B.SH_HD_N5TH_MSG AS HEADER05
              ,B.SH_HD_N6TH_MSG AS HEADER06
              ,B.SH_HD_N7TH_MSG AS HEADER07
              ,B.SH_HD_N8TH_MSG AS HEADER08
              ,B.SH_HD_N9TH_MSG AS HEADER09
              ,B.SH_HD_N10TH_MSG AS HEADER10
              ,'' AS SH_NUM
              ,'' AS HJS_REF
              ,'' AS PRINT_DATE
              ,'' AS DMDT_TRF_NM
			  ,'' AS TITLE
			  ,'' AS TAX_NM
          FROM DMT_SH_SET B
         WHERE B.OFC_CD = @[session_ofc_cd]
           AND B.DMDT_TRF_CD = @[dmdt_trf_cd]
           AND B.DMDT_SH_TP_CD = 'G'
        UNION ALL
        SELECT '' AS CUST_VAT
              ,'' AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS HEADER06
              ,'' AS HEADER07
              ,'' AS HEADER08
              ,'' AS HEADER09
              ,'' AS HEADER10
              ,SH.BIL_TO_LOC_DIV_CD||'|'||SH.CUST_REF_PRN_FLG||'|'||SH.PHN_FAX_PRN_FLG||'|'||SH.CUST_VAT_PRN_FLG||'|'||SH.TAX_AMT_PRN_FLG||'|'||SH.DC_AMT_FLG AS SH_NUM
              ,'' AS HJS_REF
              ,'' AS PRINT_DATE
              ,'' AS DMDT_TRF_NM
			  ,'' AS TITLE
			  ,'' AS TAX_NM
          FROM DMT_OFC_SH_OPT SH
         WHERE SH.OFC_CD = @[session_ofc_cd]
        UNION ALL
        SELECT '' AS CUST_VAT
              ,'' AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS HEADER06
              ,'' AS HEADER07
              ,'' AS HEADER08
              ,'' AS HEADER09
              ,'' AS HEADER10
              ,'' AS SH_NUM
              ,USR_NM AS HJS_REF
              ,'' AS PRINT_DATE
              ,'' AS DMDT_TRF_NM
			  ,'' AS TITLE
			  ,'' AS TAX_NM
          FROM COM_USER
         WHERE USR_ID = @[session_usr_id]
        UNION ALL
        SELECT '' AS CUST_VAT
              ,'' AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS HEADER06
              ,'' AS HEADER07
              ,'' AS HEADER08
              ,'' AS HEADER09
              ,'' AS HEADER10
              ,'' AS SH_NUM
              ,'' AS HJS_REF
              ,TO_CHAR (NVL (GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC (@[session_ofc_cd])
                            ,SYSDATE)
                       ,'DDMonYY', 'NLS_DATE_LANGUAGE = American') AS PRINT_DATE
              ,'' AS DMDT_TRF_NM
			  ,'' AS TITLE
			  ,'' AS TAX_NM
          FROM DUAL
          UNION ALL
          SELECT '' AS CUST_VAT
              ,'' AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS HEADER06
              ,'' AS HEADER07
              ,'' AS HEADER08
              ,'' AS HEADER09
              ,'' AS HEADER10
              ,'' AS SH_NUM
              ,'' AS HJS_REF
              ,'' AS PRINT_DATE
              ,DMDT_TRF_NM AS DMDT_TRF_NM 
			  ,'' AS TITLE
			  ,'' AS TAX_NM
           FROM DMT_TRF_TP
          WHERE DMDT_TRF_CD = @[dmdt_trf_cd]
		  UNION ALL
		SELECT '' AS CUST_VAT
		      ,'' AS ADDRESS01
		      ,'' AS OFC_ADD01
		      ,'' AS OFC_ADD02
		      ,'' AS OFC_ADD03
		      ,'' AS HEADER01
		      ,'' AS HEADER02
		      ,'' AS HEADER03
		      ,'' AS HEADER04
		      ,'' AS HEADER05
		      ,'' AS HEADER06
		      ,'' AS HEADER07
		      ,'' AS HEADER08
		      ,'' AS HEADER09
		      ,'' AS HEADER10
		      ,'' AS SH_NUM
		      ,'' AS HJS_REF
		      ,'' AS PRINT_DATE
		      ,'' AS DMDT_TRF_NM
		      ,NVL ((SELECT AA.CSTMZ_TIT_DESC
		               FROM DMT_CSTMZ_TIT_OPT AA
		                   ,DMT_CSTMZ_TIT_TRF_OPT BB
		              WHERE AA.OFC_CD = BB.OFC_CD(+)
		                AND AA.CR_TERM_SEQ = BB.CR_TERM_SEQ(+)
		                AND AA.OFC_CD = @[session_ofc_cd]
		                AND BB.DMDT_TRF_CD = @[dmdt_trf_cd]
		                AND AA.DMDT_SH_TP_CD = 'G')
		           ,'DEMAND') AS TITLE
			  ,'' AS TAX_NM
		  FROM DUAL 
		 UNION ALL
		SELECT '' AS CUST_VAT
		      ,'' AS ADDRESS01
		      ,'' AS OFC_ADD01
		      ,'' AS OFC_ADD02
		      ,'' AS OFC_ADD03
		      ,'' AS HEADER01
		      ,'' AS HEADER02
		      ,'' AS HEADER03
		      ,'' AS HEADER04
		      ,'' AS HEADER05
		      ,'' AS HEADER06
		      ,'' AS HEADER07
		      ,'' AS HEADER08
		      ,'' AS HEADER09
		      ,'' AS HEADER10
		      ,'' AS SH_NUM
		      ,'' AS HJS_REF
		      ,'' AS PRINT_DATE
		      ,'' AS DMDT_TRF_NM
		      ,'' TITLE			  
              ,( SELECT DECODE(SUBSTR(LOC_CD,1,2), 'AU' , 'GST' ,'IN' ,'TAX', 'VAT') AS TAX_NM
                  FROM MDM_ORGANIZATION
                 WHERE OFC_CD = @[session_ofc_cd] ) AS TAX_NM
		  FROM DUAL 
)

#else

SELECT MAX (CUST_VAT) AS CUST_VAT
      ,MAX (ADDRESS01) AS ADDRESS01
      ,MAX (OFC_ADD01) AS OFC_ADD01
      ,MAX (OFC_ADD02) AS OFC_ADD02
      ,MAX (OFC_ADD03) AS OFC_ADD03
      ,MAX (HEADER01) AS HEADER01
      ,MAX (HEADER02) AS HEADER02
      ,MAX (HEADER03) AS HEADER03
      ,MAX (HEADER04) AS HEADER04
      ,MAX (HEADER05) AS HEADER05
      ,MAX (SHEET_REMARK01) AS SHEET_REMARK01
      ,MAX (SHEET_REMARK02) AS SHEET_REMARK02
      ,MAX (SHEET_REMARK03) AS SHEET_REMARK03
      ,MAX (SHEET_REMARK04) AS SHEET_REMARK04
      ,MAX (SHEET_REMARK05) AS SHEET_REMARK05
      ,MAX (SHEET_REMARK06) AS SHEET_REMARK06
      ,MAX (SHEET_REMARK07) AS SHEET_REMARK07
      ,MAX (SHEET_REMARK08) AS SHEET_REMARK08
      ,MAX (SHEET_REMARK09) AS SHEET_REMARK09
      ,MAX (SHEET_REMARK10) AS SHEET_REMARK10
      ,MAX (SHEET_REMARK11) AS SHEET_REMARK11
      ,MAX (SHEET_REMARK12) AS SHEET_REMARK12
      ,MAX (SHEET_REMARK13) AS SHEET_REMARK13
      ,MAX (SHEET_REMARK14) AS SHEET_REMARK14
      ,MAX (SH_NUM) AS SH_NUM
      ,MAX (HJS_REF) AS HJS_REF
      ,MAX (PRINT_DATE) AS PRINT_DATE  
      ,MAX (TITLE) AS TITLE    
	  ,MAX (TAX_NM) AS TAX_NM
  FROM (SELECT CUST.CUST_RGST_NO AS CUST_VAT
              ,'' AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS SHEET_REMARK01
              ,'' AS SHEET_REMARK02
              ,'' AS SHEET_REMARK03
              ,'' AS SHEET_REMARK04
              ,'' AS SHEET_REMARK05
              ,'' AS SHEET_REMARK06
              ,'' AS SHEET_REMARK07
              ,'' AS SHEET_REMARK08
              ,'' AS SHEET_REMARK09
              ,'' AS SHEET_REMARK10
              ,'' AS SHEET_REMARK11
              ,'' AS SHEET_REMARK12
              ,'' AS SHEET_REMARK13
              ,'' AS SHEET_REMARK14
              ,'' AS SH_NUM
              ,'' AS HJS_REF
              ,'' AS PRINT_DATE
			  ,'' AS TITLE
			  ,'' AS TAX_NM
          FROM MDM_CUSTOMER CUST
         WHERE CUST.CUST_CNT_CD = SUBSTR (@[payer_cd]
                                         ,1
                                         ,2
                                         )
           AND CUST.CUST_SEQ = SUBSTR (@[payer_cd]
                                      ,3
                                      ,6
                                      )
        UNION ALL
        SELECT '' AS CUST_VAT
              , (
                SELECT CUST_NM || '|' || ADDRESS01 
                FROM (
                    SELECT DMDT_PAYR_NM AS CUST_NM
                          ,REPLACE (DMDT_PAYR_ADDR
                                   ,'@*'
                                   , CHR (13)
                                     || CHR (10)
                                   ) AS ADDRESS01
                          , 1 AS SORT         
                      FROM DMT_PAYR_INFO
                     WHERE SYS_AREA_GRP_ID =
                                 (SELECT SYS_AREA_GRP_ID
                                    FROM COM_SYS_AREA_GRP_ID
                                   WHERE CNT_CD = (SELECT SUBSTR (LOC_CD
                                                                 ,1
                                                                 ,2
                                                                 )
                                                     FROM MDM_ORGANIZATION
                                                    WHERE OFC_CD = @[session_ofc_cd])
                                     AND CO_IND_CD = 'H')
                       AND CUST_CNT_CD = SUBSTR (@[payer_cd] ,1 ,2)
                       AND CUST_SEQ = SUBSTR (@[payer_cd] ,3 ,6)
                    UNION ALL
                    SELECT LOCL_NM AS CUST_NM
                            ,TRIM (LOCL_ADDR1)
                           || CHR (13)
                           || CHR (10)
                           || TRIM (LOCL_ADDR2)
                           || CHR (13)
                           || CHR (10)
                           || TRIM (LOCL_ADDR3)
                           || CHR (13)
                           || CHR (10)
                           || TRIM (LOCL_ADDR4)
                           || ' '
                           || LOCL_ZIP_CD AS ADDRESS01
                           , 2 AS SORT 
                      FROM MDM_CR_CUST
                     WHERE CUST_CNT_CD = SUBSTR (@[payer_cd] ,1 ,2)
                       AND CUST_SEQ = SUBSTR (@[payer_cd] ,3 ,6)
                       AND LOCL_NM IS NOT NULL
                    UNION ALL   
                    SELECT CASE
                              WHEN SUBSTR (@[payer_cd] ,1 ,2) = '00'
                                 THEN (SELECT VNDR_LGL_ENG_NM
                                         FROM MDM_VENDOR
                                        WHERE VNDR_SEQ = SUBSTR (@[payer_cd] ,3 ,6)
                                          AND VNDR_LGL_ENG_NM IS NOT NULL)
                              ELSE (SELECT CUST_LGL_ENG_NM
                                      FROM MDM_CUSTOMER
                                     WHERE CUST_CNT_CD = SUBSTR (@[payer_cd] ,1 ,2)
                                       AND CUST_SEQ = SUBSTR (@[payer_cd] ,3 ,6)
                                       AND CUST_LGL_ENG_NM IS NOT NULL)
                           END AS CUST_NM
                          ,CASE
                              WHEN SUBSTR (@[payer_cd] ,1 ,2) = '00'
                                 THEN (SELECT ZIP_CD
                                              || ','
                                              || REPLACE (ENG_ADDR
                                                         ,'@*'
                                                         , CHR (13)
                                                           || CHR (10)
                                                         )
                                         FROM MDM_VENDOR
                                        WHERE VNDR_SEQ = SUBSTR (@[payer_cd] ,3 ,6))
                              ELSE (SELECT CASE
                                              WHEN CN.BKG_ADDR_ORD_CD = 1
                                                 THEN REPLACE (ADDR.BZET_ADDR
                                                              ,'@*'
                                                              , CHR (13)
                                                                || CHR (10)
                                                              )
                                                      || ' '
                                                      || ADDR.ZIP_CD
                                              WHEN CN.BKG_ADDR_ORD_CD = 2
                                                 THEN REPLACE (ADDR.BZET_ADDR
                                                              ,'@*'
                                                              , CHR (13)
                                                                || CHR (10)
                                                              )
                                                      || ' '
                                                      || ADDR.CTY_NM
                                              WHEN CN.BKG_ADDR_ORD_CD = 3
                                                 THEN REPLACE (ADDR.BZET_ADDR
                                                              ,'@*'
                                                              , CHR (13)
                                                                || CHR (10)
                                                              )
                                                      || ' '
                                                      || ADDR.CTY_NM
                                                      || ' '
                                                      || ADDR.ZIP_CD
                                              WHEN CN.BKG_ADDR_ORD_CD = 4
                                                 THEN REPLACE (ADDR.BZET_ADDR
                                                              ,'@*'
                                                              , CHR (13)
                                                                || CHR (10)
                                                              )
                                                      || ' '
                                                      || ADDR.CTY_NM
                                                      || ' '
                                                      || ADDR.STE_CD
                                                      || ' '
                                                      || ADDR.ZIP_CD
                                              WHEN CN.BKG_ADDR_ORD_CD = 5
                                                 THEN REPLACE (ADDR.BZET_ADDR
                                                              ,'@*'
                                                              , CHR (13)
                                                                || CHR (10)
                                                              )
                                                      || ' '
                                                      || ADDR.CTY_NM
                                                      || ' '
                                                      || ADDR.ZIP_CD
                                              WHEN CN.BKG_ADDR_ORD_CD = 6
                                                 THEN ADDR.CTY_NM
                                                      || ' '
                                                      || REPLACE (ADDR.BZET_ADDR
                                                                 ,'@*'
                                                                 , CHR (13)
                                                                   || CHR (10)
                                                                 )
                                                      || ' '
                                                      || ADDR.ZIP_CD
                                              ELSE REPLACE (ADDR.BZET_ADDR
                                                                 ,'@*'
                                                                 , CHR (13)
                                                                   || CHR (10)
                                                                 )
                                                   || ' '
                                                   || ADDR.CTY_NM
                                                   || ' '
                                                   || ADDR.ZIP_CD
                                           END
                                      FROM MDM_CUST_ADDR ADDR
                                          ,MDM_COUNTRY CN
                                     WHERE ADDR.CUST_CNT_CD = CN.CNT_CD(+)
									   AND ADDR.PRMRY_CHK_FLG = 'Y'
                                       AND ADDR.CUST_CNT_CD = SUBSTR (@[payer_cd] ,1 ,2)
                                       AND ADDR.CUST_SEQ = SUBSTR (@[payer_cd] ,3 ,6)
									   AND ROWNUM = 1)
                           END AS ADDRESS01
                           , 3 AS SORT 
                      FROM DUAL
                      ORDER BY SORT   
                    ) 
                    WHERE ROWNUM < 2
                )  AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS SHEET_REMARK01
              ,'' AS SHEET_REMARK02
              ,'' AS SHEET_REMARK03
              ,'' AS SHEET_REMARK04
              ,'' AS SHEET_REMARK05
              ,'' AS SHEET_REMARK06
              ,'' AS SHEET_REMARK07
              ,'' AS SHEET_REMARK08
              ,'' AS SHEET_REMARK09
              ,'' AS SHEET_REMARK10
              ,'' AS SHEET_REMARK11
              ,'' AS SHEET_REMARK12
              ,'' AS SHEET_REMARK13
              ,'' AS SHEET_REMARK14
              ,'' AS SH_NUM
              ,'' AS HJS_REF
              ,'' AS PRINT_DATE
			  ,'' AS TITLE
			  ,'' AS TAX_NM
          FROM DUAL
        UNION ALL
        SELECT '' AS CUST_VAT
              ,'' AS ADDRESS01
              ,REPLACE(B.SH_ADDR1,'@*',CHR(13)||CHR(10)) AS OFC_ADD01
              ,REPLACE(B.SH_ADDR2,'@*',CHR(13)||CHR(10)) AS OFC_ADD02
              ,REPLACE(B.SH_ADDR3,'@*',CHR(13)||CHR(10)) AS OFC_ADD03
              ,B.SH_HD_N1ST_MSG AS HEADER01
              ,B.SH_HD_N2ND_MSG AS HEADER02
              ,B.SH_HD_N3RD_MSG AS HEADER03
              ,B.SH_HD_N4TH_MSG AS HEADER04
              ,B.SH_HD_N5TH_MSG AS HEADER05
              ,B.SH_RMK1 AS SHEET_REMARK01
              ,B.SH_RMK2 AS SHEET_REMARK02
              ,B.SH_RMK3 AS SHEET_REMARK03
              ,B.SH_RMK4 AS SHEET_REMARK04
              ,B.SH_RMK5 AS SHEET_REMARK05
              ,B.SH_RMK6 AS SHEET_REMARK06
              ,B.SH_RMK7 AS SHEET_REMARK07
              ,B.SH_RMK8 AS SHEET_REMARK08
              ,B.SH_RMK9 AS SHEET_REMARK09
              ,B.SH_RMK10 AS SHEET_REMARK10
              ,B.SH_RMK11 AS SHEET_REMARK11
              ,B.SH_RMK12 AS SHEET_REMARK12
              ,B.SH_RMK13 AS SHEET_REMARK13
              ,B.SH_RMK14 AS SHEET_REMARK14
              ,'' AS SH_NUM
              ,'' AS HJS_REF
              ,'' AS PRINT_DATE
			  ,'' AS TITLE
			  ,'' AS TAX_NM
          FROM DMT_SH_SET B
         WHERE B.OFC_CD = @[session_ofc_cd]
           AND B.DMDT_TRF_CD = @[dmdt_trf_cd]
           AND B.DMDT_SH_TP_CD = 'D'
        UNION ALL
        SELECT '' AS CUST_VAT
              ,'' AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS SHEET_REMARK01
              ,'' AS SHEET_REMARK02
              ,'' AS SHEET_REMARK03
              ,'' AS SHEET_REMARK04
              ,'' AS SHEET_REMARK05
              ,'' AS SHEET_REMARK06
              ,'' AS SHEET_REMARK07
              ,'' AS SHEET_REMARK08
              ,'' AS SHEET_REMARK09
              ,'' AS SHEET_REMARK10
              ,'' AS SHEET_REMARK11
              ,'' AS SHEET_REMARK12
              ,'' AS SHEET_REMARK13
              ,'' AS SHEET_REMARK14
              ,SH.BIL_TO_LOC_DIV_CD||'|'||SH.CUST_REF_PRN_FLG||'|'||SH.PHN_FAX_PRN_FLG||'|'||SH.CUST_VAT_PRN_FLG||'|'||SH.TAX_AMT_PRN_FLG||'|'||SH.DC_AMT_FLG AS SH_NUM
              ,'' AS HJS_REF
              ,'' AS PRINT_DATE
			  ,'' AS TITLE
			  ,'' AS TAX_NM
          FROM DMT_OFC_SH_OPT SH
         WHERE SH.OFC_CD = @[session_ofc_cd]
        UNION ALL
        SELECT '' AS CUST_VAT
              ,'' AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS SHEET_REMARK01
              ,'' AS SHEET_REMARK02
              ,'' AS SHEET_REMARK03
              ,'' AS SHEET_REMARK04
              ,'' AS SHEET_REMARK05
              ,'' AS SHEET_REMARK06
              ,'' AS SHEET_REMARK07
              ,'' AS SHEET_REMARK08
              ,'' AS SHEET_REMARK09
              ,'' AS SHEET_REMARK10
              ,'' AS SHEET_REMARK11
              ,'' AS SHEET_REMARK12
              ,'' AS SHEET_REMARK13
              ,'' AS SHEET_REMARK14
              ,'' AS SH_NUM
              ,USR_NM AS HJS_REF
              ,'' AS PRINT_DATE
			  ,'' AS TITLE
			  ,'' AS TAX_NM
          FROM COM_USER
         WHERE USR_ID = @[session_usr_id]
        UNION ALL
        SELECT '' AS CUST_VAT
              ,'' AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS SHEET_REMARK01
              ,'' AS SHEET_REMARK02
              ,'' AS SHEET_REMARK03
              ,'' AS SHEET_REMARK04
              ,'' AS SHEET_REMARK05
              ,'' AS SHEET_REMARK06
              ,'' AS SHEET_REMARK07
              ,'' AS SHEET_REMARK08
              ,'' AS SHEET_REMARK09
              ,'' AS SHEET_REMARK10
              ,'' AS SHEET_REMARK11
              ,'' AS SHEET_REMARK12
              ,'' AS SHEET_REMARK13
              ,'' AS SHEET_REMARK14
              ,'' AS SH_NUM
              ,'' AS HJS_REF
              ,TO_CHAR (NVL (GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC (@[session_ofc_cd])
                            ,SYSDATE)
                       ,'DDMonYY', 'NLS_DATE_LANGUAGE = American') AS PRINT_DATE
			  ,'' AS TITLE
			  ,'' AS TAX_NM
          FROM DUAL
		  UNION ALL
		SELECT '' AS CUST_VAT
              ,'' AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS SHEET_REMARK01
              ,'' AS SHEET_REMARK02
              ,'' AS SHEET_REMARK03
              ,'' AS SHEET_REMARK04
              ,'' AS SHEET_REMARK05
              ,'' AS SHEET_REMARK06
              ,'' AS SHEET_REMARK07
              ,'' AS SHEET_REMARK08
              ,'' AS SHEET_REMARK09
              ,'' AS SHEET_REMARK10
              ,'' AS SHEET_REMARK11
              ,'' AS SHEET_REMARK12
              ,'' AS SHEET_REMARK13
              ,'' AS SHEET_REMARK14
              ,'' AS SH_NUM
              ,'' AS HJS_REF
			  ,'' AS PRINT_DATE
		      ,NVL ((SELECT AA.CSTMZ_TIT_DESC
		               FROM DMT_CSTMZ_TIT_OPT AA
		                   ,DMT_CSTMZ_TIT_TRF_OPT BB
		              WHERE AA.OFC_CD = BB.OFC_CD(+)
		                AND AA.CR_TERM_SEQ = BB.CR_TERM_SEQ(+)
		                AND AA.OFC_CD = @[session_ofc_cd]
		                AND BB.DMDT_TRF_CD = @[dmdt_trf_cd]
		                AND AA.DMDT_SH_TP_CD = 'D')
		           ,'DEMAND') AS TITLE
			  ,'' AS TAX_NM
		  FROM DUAL 
		  UNION ALL
		SELECT '' AS CUST_VAT
              ,'' AS ADDRESS01
              ,'' AS OFC_ADD01
              ,'' AS OFC_ADD02
              ,'' AS OFC_ADD03
              ,'' AS HEADER01
              ,'' AS HEADER02
              ,'' AS HEADER03
              ,'' AS HEADER04
              ,'' AS HEADER05
              ,'' AS SHEET_REMARK01
              ,'' AS SHEET_REMARK02
              ,'' AS SHEET_REMARK03
              ,'' AS SHEET_REMARK04
              ,'' AS SHEET_REMARK05
              ,'' AS SHEET_REMARK06
              ,'' AS SHEET_REMARK07
              ,'' AS SHEET_REMARK08
              ,'' AS SHEET_REMARK09
              ,'' AS SHEET_REMARK10
              ,'' AS SHEET_REMARK11
              ,'' AS SHEET_REMARK12
              ,'' AS SHEET_REMARK13
              ,'' AS SHEET_REMARK14
              ,'' AS SH_NUM
              ,'' AS HJS_REF
			  ,'' AS PRINT_DATE
		      ,'' AS TITLE
              ,( SELECT DECODE(SUBSTR(LOC_CD,1,2), 'AU' , 'GST' ,'IN' ,'TAX', 'VAT') AS TAX_NM
                  FROM MDM_ORGANIZATION
                 WHERE OFC_CD = @[session_ofc_cd] ) AS TAX_NM
		  FROM DUAL
)

#end

## finish			]]></sql>
			<params>
				<param name="payer_cd" type="12" value="" out="N"/>
				<param name="session_ofc_cd" type="12" value="" out="N"/>
				<param name="dmdt_trf_cd" type="12" value="" out="N"/>
				<param name="session_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
