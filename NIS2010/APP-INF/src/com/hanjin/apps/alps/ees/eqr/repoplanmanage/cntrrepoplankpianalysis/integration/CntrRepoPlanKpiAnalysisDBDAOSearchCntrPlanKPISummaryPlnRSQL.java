/*=========================================================
*Copyright(c) 2009 CyberLogitec
*@FileName : CntrRepoPlanKpiAnalysisDBDAOSearchCntrPlanKPISummaryPlnRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2009.11.11
*@LastModifier : 
*@LastVersion : 1.0
* 2009.11.11 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.ees.eqr.repoplanmanage.cntrrepoplankpianalysis.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class CntrRepoPlanKpiAnalysisDBDAOSearchCntrPlanKPISummaryPlnRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * <EES_EQR_0071 컨테이너 이송 계획 KPI 요약 조회>
	  * PORT별 재고대비 운송모드별 실행 KPI 데이터 조회 (Pln)
	  * 
	  * <Change History>
	  * 1	2009.09.21	Lee ByoungHun	최초작성
	  * </pre>
	  */
	public CntrRepoPlanKpiAnalysisDBDAOSearchCntrPlanKPISummaryPlnRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("weekStrArr_1_0",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.NUMERIC + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("data0",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("plnTo",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("repo_pln_id",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("weekStrArr_1_1",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("weekStrArr_1_2",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("plnFrom",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.ees.eqr.repoplanmanage.cntrrepoplankpianalysis.integration").append("\n"); 
		query.append("FileName : CntrRepoPlanKpiAnalysisDBDAOSearchCntrPlanKPISummaryPlnRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if (${radiototrcc} == 'T')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("'' ECC_CD" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append(", SUM(UTILIZATION) UTILIZATION" ).append("\n"); 
		query.append(", SUM(MTY) MTY" ).append("\n"); 
		query.append(", SUM(ONHIRE) ONHIRE" ).append("\n"); 
		query.append(", SUM(OFFHIRE) OFFHIRE" ).append("\n"); 
		query.append(", SUM(LF) LF" ).append("\n"); 
		query.append(", SUM(MB) MB" ).append("\n"); 
		query.append(", SUM(RCOST) RCOST" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("RCC_CD ECC_CD" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append(",'' UTILIZATION" ).append("\n"); 
		query.append(",SUM(DECODE ( DIV , 'MTY' , CNTR_QTY ))   MTY" ).append("\n"); 
		query.append(",SUM(DECODE ( DIV , 'ONH' , CNTR_QTY ))   ONHIRE" ).append("\n"); 
		query.append(",SUM(DECODE ( DIV , 'OFH' , CNTR_QTY ))   OFFHIRE" ).append("\n"); 
		query.append(",'' LF" ).append("\n"); 
		query.append(",'' MB" ).append("\n"); 
		query.append(",SUM(DECODE ( DIV , 'COST' , CNTR_QTY )) RCOST" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("-- planwk = fmwk and planwk = towk 이면 EQR_INVT_SNAP 만 조회" ).append("\n"); 
		query.append("-- towk <> plan wk : queryPlnMty3 실행.(단. 항상 planwk = fmwk 임. 화면단에서 수정불가로 처리.)" ).append("\n"); 
		query.append("#if (${yyyyww} == ${plnFrom} && ${yyyyww} == ${plnTo})" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", @[repo_pln_id]  REPO_PLN_ID" ).append("\n"); 
		query.append(", SUM(T.CNTR_VOL_QTY)  CNTR_QTY" ).append("\n"); 
		query.append(", 'MTY' DIV" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INVT_SNAP T" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("T.SNAP_DT BETWEEN (SELECT WK_ST_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[plnFrom])" ).append("\n"); 
		query.append("AND (SELECT WK_END_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[plnFrom])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${yyyyww} != ${plnTo})" ).append("\n"); 
		query.append("--------------------------------------------------------------------------------<MTY>" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append(", TRUNC(SUM(CNTR_QTY) / @[data0],1) CNTR_QTY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(--------------------- MTY 최외곽." ).append("\n"); 
		query.append("--//[plan wk] plan 주차는 EQR_INVT_SNAP를 읽고," ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append("FROM(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", @[repo_pln_id]  REPO_PLN_ID" ).append("\n"); 
		query.append(", SUM(T.CNTR_VOL_QTY)  CNTR_QTY" ).append("\n"); 
		query.append(", 'MTY' DIV" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INVT_SNAP T" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("T.SNAP_DT = (SELECT WK_ST_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[plnFrom])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY RCC_CD, REPO_PLN_ID, DIV" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--//[planWk+1] plan 주차이후주차는 전주차의 balance값을 계산." ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("RCC_CD --AS ECC_CD" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(ITEM, 'InitialVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'DemandVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'RepoOutVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'OffHireVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'IBGenerationVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'RepoInVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'OnHireVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'ETCVol',CNTR_QTY)),0) CNTR_QTY" ).append("\n"); 
		query.append(",'MTY' DIV" ).append("\n"); 
		query.append("FROM(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", ITEM" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY RCC_CD, ITEM ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'InitialVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INVT_SNAP PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SNAP_DT = (SELECT WK_ST_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[plnFrom])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'DemandVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id])" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.FM_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'RepoOutVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("-------EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_CHAR(FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_0])" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_0])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, FM_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-------EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND FM_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, FM_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'OffHireVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'IBGenerationVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_IB_BKG_FCAST PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id])" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'RepoInVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("--EQR_VSL_LODG_DCHG_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_CHAR(TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_0])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_0])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, TO_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--EQR_INLND_TRSP_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'OnHireVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'ETCVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ADD_PLN PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND PLN_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("WHERE RCC_CD IS NOT NULL -- 8개 RCC 만 출력." ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM , REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${weekStrArrSize} >= 2)" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--//[planWk+2] plan 주차이후주차는 전주차의 balance값을 계산." ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("RCC_CD --AS ECC_CD" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(ITEM, 'InitialVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'DemandVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'RepoOutVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'OffHireVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'IBGenerationVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'RepoInVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'OnHireVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'ETCVol',CNTR_QTY)),0) CNTR_QTY" ).append("\n"); 
		query.append(",'MTY' DIV" ).append("\n"); 
		query.append("FROM(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", ITEM" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY RCC_CD, ITEM ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'InitialVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("--> 전주차[planWk+1] balance Start ----------------------------" ).append("\n"); 
		query.append("--//[planWk+1] plan 주차이후주차는 전주차의 balance값을 계산." ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("RCC_CD --AS ECC_CD" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(ITEM, 'InitialVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'DemandVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'RepoOutVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'OffHireVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'IBGenerationVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'RepoInVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'OnHireVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'ETCVol',CNTR_QTY)),0) CNTR_QTY" ).append("\n"); 
		query.append(",'MTY' DIV" ).append("\n"); 
		query.append("FROM(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", ITEM" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY RCC_CD, ITEM ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'InitialVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INVT_SNAP PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SNAP_DT = (SELECT WK_ST_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[plnFrom])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'DemandVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id])" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.FM_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'RepoOutVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("-------EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_CHAR(FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_0])" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_0])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, FM_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-------EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND FM_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, FM_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'OffHireVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'IBGenerationVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_IB_BKG_FCAST PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id])" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'RepoInVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("--EQR_VSL_LODG_DCHG_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_CHAR(TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_0])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_0])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, TO_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--EQR_INLND_TRSP_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'OnHireVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'ETCVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ADD_PLN PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND PLN_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("WHERE RCC_CD IS NOT NULL -- 8개 RCC 만 출력." ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM , REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("--> 전주차[planWk+1] balance End   ----------------------------" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'DemandVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id])" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.FM_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'RepoOutVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("-------EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_CHAR(FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_1])" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(SELECT  TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_1])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, FM_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-------EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND FM_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, FM_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'OffHireVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'IBGenerationVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_IB_BKG_FCAST PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id])" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'RepoInVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("--EQR_VSL_LODG_DCHG_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_CHAR(TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_1])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_1])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, TO_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--EQR_INLND_TRSP_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'OnHireVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'ETCVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ADD_PLN PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND PLN_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("WHERE RCC_CD IS NOT NULL -- 8개 RCC 만 출력." ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM , REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("--//[planWk+2]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${weekStrArrSize} >= 3)" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--//[planWk+3] plan 주차이후주차는 전주차의 balance값을 계산." ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("RCC_CD --AS ECC_CD" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(ITEM, 'InitialVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'DemandVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'RepoOutVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'OffHireVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'IBGenerationVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'RepoInVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'OnHireVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'ETCVol',CNTR_QTY)),0) CNTR_QTY" ).append("\n"); 
		query.append(",'MTY' DIV" ).append("\n"); 
		query.append("FROM(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", ITEM" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY RCC_CD, ITEM ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'InitialVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("--> 전주차[planWk+2] balance Start ----------------------------" ).append("\n"); 
		query.append("--//[planWk+2] plan 주차이후주차는 전주차의 balance값을 계산." ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("RCC_CD --AS ECC_CD" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(ITEM, 'InitialVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'DemandVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'RepoOutVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'OffHireVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'IBGenerationVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'RepoInVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'OnHireVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'ETCVol',CNTR_QTY)),0) CNTR_QTY" ).append("\n"); 
		query.append(",'MTY' DIV" ).append("\n"); 
		query.append("FROM(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", ITEM" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY RCC_CD, ITEM ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'InitialVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("--> 전주차[planWk+1] balance Start ----------------------------" ).append("\n"); 
		query.append("--//[planWk+1] plan 주차이후주차는 전주차의 balance값을 계산." ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("RCC_CD --AS ECC_CD" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append(",NVL(SUM(DECODE(ITEM, 'InitialVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'DemandVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'RepoOutVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("- NVL(SUM(DECODE(ITEM, 'OffHireVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'IBGenerationVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'RepoInVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'OnHireVol',CNTR_QTY)),0)" ).append("\n"); 
		query.append("+ NVL(SUM(DECODE(ITEM, 'ETCVol',CNTR_QTY)),0) CNTR_QTY" ).append("\n"); 
		query.append(",'MTY' DIV" ).append("\n"); 
		query.append("FROM(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", ITEM" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(",ROW_NUMBER() OVER (PARTITION BY RCC_CD, ITEM ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'InitialVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INVT_SNAP PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SNAP_DT = (SELECT WK_ST_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[plnFrom])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'DemandVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id])" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.FM_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'RepoOutVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("-------EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_CHAR(FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_0])" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_0])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, FM_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-------EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND FM_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, FM_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'OffHireVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'IBGenerationVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_IB_BKG_FCAST PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id])" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'RepoInVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("--EQR_VSL_LODG_DCHG_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_CHAR(TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_0])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_0])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, TO_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--EQR_INLND_TRSP_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'OnHireVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'ETCVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ADD_PLN PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND PLN_YRWK BETWEEN @[weekStrArr_1_0] AND @[weekStrArr_1_0]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("WHERE RCC_CD IS NOT NULL -- 8개 RCC 만 출력." ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM , REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("--> 전주차[planWk+1] balance End   ----------------------------" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'DemandVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id])" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.FM_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'RepoOutVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("-------EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_CHAR(FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_1])" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(SELECT  TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_1])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, FM_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-------EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND FM_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, FM_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'OffHireVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'IBGenerationVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_IB_BKG_FCAST PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id])" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'RepoInVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("--EQR_VSL_LODG_DCHG_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_CHAR(TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_1])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_1])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, TO_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--EQR_INLND_TRSP_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'OnHireVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'ETCVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ADD_PLN PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND PLN_YRWK BETWEEN @[weekStrArr_1_1] AND @[weekStrArr_1_1]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("WHERE RCC_CD IS NOT NULL -- 8개 RCC 만 출력." ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM , REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("--//[planWk+2]" ).append("\n"); 
		query.append("--> 전주차[planWk+2] balance End   ----------------------------" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'DemandVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id])" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[weekStrArr_1_2] AND @[weekStrArr_1_2]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.FM_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'RepoOutVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("-------EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_CHAR(FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_2])" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_2])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, FM_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-------EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND FM_YRWK BETWEEN @[weekStrArr_1_2] AND @[weekStrArr_1_2]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, FM_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'OffHireVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[weekStrArr_1_2] AND @[weekStrArr_1_2]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'IBGenerationVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_id] REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_IB_BKG_FCAST PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_id])" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN @[weekStrArr_1_2] AND @[weekStrArr_1_2]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'RepoInVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("--EQR_VSL_LODG_DCHG_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_CHAR(TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_2])" ).append("\n"); 
		query.append("AND (SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = @[weekStrArr_1_2])" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, TO_ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--EQR_INLND_TRSP_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.TO_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND TO_YRWK BETWEEN @[weekStrArr_1_2] AND @[weekStrArr_1_2]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, TO_ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'OnHireVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN @[weekStrArr_1_2] AND @[weekStrArr_1_2]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY PLN.REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append(", 'ETCVol' ITEM" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = PLN.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ADD_PLN PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("AND PLN_YRWK BETWEEN @[weekStrArr_1_2] AND @[weekStrArr_1_2]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN.ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("WHERE RCC_CD IS NOT NULL -- 8개 RCC 만 출력." ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM , REPO_PLN_ID, RCC_CD" ).append("\n"); 
		query.append("--//[planWk+3]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")--------------------- MTY 최외곽." ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("RCC_CD, REPO_PLN_ID, DIV" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--------------------------------------------------------------------------------<ONH>" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${radioopr} == '0')" ).append("\n"); 
		query.append("#if (${typeBy} == 'R')" ).append("\n"); 
		query.append("A.RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeBy} == 'C')" ).append("\n"); 
		query.append("A.CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeBy} == 'L')" ).append("\n"); 
		query.append("A.LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("A.ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") RCC_CD" ).append("\n"); 
		query.append(", T.REPO_PLN_ID" ).append("\n"); 
		query.append(", SUM(Q.CNTR_QTY)  CNTR_QTY" ).append("\n"); 
		query.append(", 'ONH' DIV" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN T" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY Q" ).append("\n"); 
		query.append(", EQR_EQ_REPO_PLN M" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("T.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND T.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND T.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND T.ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("AND T.REPO_PLN_ID = M.REPO_PLN_ID" ).append("\n"); 
		query.append("AND M.REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND T.PLN_YRWK BETWEEN @[plnFrom] AND  @[plnTo]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("AND T.REPO_PLN_ID =  @[repo_pln_id]" ).append("\n"); 
		query.append("GROUP BY T.ECC_CD, T.REPO_PLN_ID" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--------------------------------------------------------------------------------<OFF>" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${radioopr} == '0')" ).append("\n"); 
		query.append("#if (${typeBy} == 'R')" ).append("\n"); 
		query.append("A.RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeBy} == 'C')" ).append("\n"); 
		query.append("A.CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeBy} == 'L')" ).append("\n"); 
		query.append("A.LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("A.ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") RCC_CD" ).append("\n"); 
		query.append(", T.REPO_PLN_ID" ).append("\n"); 
		query.append(", SUM(Q.CNTR_QTY)  CNTR_QTY" ).append("\n"); 
		query.append(", 'OFH' DIV" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN T" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY Q" ).append("\n"); 
		query.append(", EQR_EQ_REPO_PLN M" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("T.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND T.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND T.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND T.ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("AND T.REPO_PLN_ID = M.REPO_PLN_ID" ).append("\n"); 
		query.append("AND M.REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND T.PLN_YRWK BETWEEN @[plnFrom] AND  @[plnTo]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("AND T.REPO_PLN_ID =  @[repo_pln_id]" ).append("\n"); 
		query.append("GROUP BY T.ECC_CD, T.REPO_PLN_ID" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--------------------------------------------------------------------------------<COST>" ).append("\n"); 
		query.append("------RepoOut" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", T.REPO_PLN_ID" ).append("\n"); 
		query.append(", SUM(Q.LODG_DCHG_COST_AMT)  CNTR_QTY" ).append("\n"); 
		query.append(", 'COST' DIV" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN T" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY Q" ).append("\n"); 
		query.append(", EQR_EQ_REPO_PLN M" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("T.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND T.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND T.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND T.REPO_PLN_ID = M.REPO_PLN_ID" ).append("\n"); 
		query.append("AND M.REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND T.PLN_YRWK  BETWEEN @[plnFrom] AND @[plnTo]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("#if (${transshippln} == 'E')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG <> 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${transshippln} == 'O')" ).append("\n"); 
		query.append("AND LDIS_TS_FLG = 'Y'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND T.REPO_PLN_ID =  @[repo_pln_id]" ).append("\n"); 
		query.append("GROUP BY T.FM_ECC_CD, T.REPO_PLN_ID" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.FM_ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", T.REPO_PLN_ID" ).append("\n"); 
		query.append(", SUM(Q.TRSP_COST_AMT)  CNTR_QTY" ).append("\n"); 
		query.append(", 'COST' DIV" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN T" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY Q" ).append("\n"); 
		query.append(", EQR_EQ_REPO_PLN M" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("T.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND T.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND T.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND T.REPO_PLN_ID = M.REPO_PLN_ID" ).append("\n"); 
		query.append("AND M.REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND FM_YRWK  BETWEEN @[plnFrom] AND @[plnTo]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("AND T.REPO_PLN_ID =  @[repo_pln_id]" ).append("\n"); 
		query.append("GROUP BY T.FM_ECC_CD, T.REPO_PLN_ID" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("------OnHire" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", T.REPO_PLN_ID" ).append("\n"); 
		query.append(", SUM(Q.ONF_HIR_COST_AMT)  CNTR_QTY" ).append("\n"); 
		query.append(", 'COST' DIV" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN T" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY Q" ).append("\n"); 
		query.append(", EQR_EQ_REPO_PLN M" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("T.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND T.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND T.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND T.ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("AND T.REPO_PLN_ID = M.REPO_PLN_ID" ).append("\n"); 
		query.append("AND M.REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND T.PLN_YRWK BETWEEN @[plnFrom] AND  @[plnTo]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("AND T.REPO_PLN_ID =  @[repo_pln_id]" ).append("\n"); 
		query.append("GROUP BY T.ECC_CD, T.REPO_PLN_ID" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("------OffHire" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(SELECT RCC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.ECC_CD) RCC_CD" ).append("\n"); 
		query.append(", T.REPO_PLN_ID" ).append("\n"); 
		query.append(", SUM(Q.ONF_HIR_COST_AMT)  CNTR_QTY" ).append("\n"); 
		query.append(", 'COST' DIV" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN T" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY Q" ).append("\n"); 
		query.append(", EQR_EQ_REPO_PLN M" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("T.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND T.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND T.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND T.ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("AND T.REPO_PLN_ID = M.REPO_PLN_ID" ).append("\n"); 
		query.append("AND M.REPO_PLN_DTRB_FLG = 'Y'" ).append("\n"); 
		query.append("AND T.PLN_YRWK BETWEEN @[plnFrom] AND  @[plnTo]" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN (SELECT INTG_CD_VAL_CTNT FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00244' )" ).append("\n"); 
		query.append("AND T.REPO_PLN_ID =  @[repo_pln_id]" ).append("\n"); 
		query.append("GROUP BY T.ECC_CD, T.REPO_PLN_ID" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("WHERE RCC_CD IS NOT NULL" ).append("\n"); 
		query.append("GROUP BY RCC_CD , REPO_PLN_ID" ).append("\n"); 
		query.append("#if (${radiototrcc} == 'T')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("ORDER BY ECC_CD , REPO_PLN_ID" ).append("\n"); 

	}
}