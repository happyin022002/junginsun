<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PayableRentalCostDBDAOSearchGwApprAgmtAttach2RSQLRSQL">
			<desc><![CDATA[G/W 연동을 위해서 vendor no, csr_no, inv_no등 조회해오는 쿼리]]></desc>
			<sql><![CDATA[
WITH LV_DATA0 AS ( 
     SELECT DISTINCT A.VNDR_NO, D.ATTR_CTNT1 INV_NO ,A.CSR_NO
           FROM
            AP_INV_HDR A,   AP_INV_DTRB D,   AP_PAY_INV P
            WHERE 1=1
            AND A.CSR_NO = D.CSR_NO
            AND A.CSR_NO = @[csr_no] 
            AND A.CSR_NO = P.CSR_NO
            AND A.VNDR_NO = P.VNDR_SEQ
            AND D.ATTR_CTNT1 = P.INV_NO
            AND NVL(P.DELT_FLG, 'N') <> 'Y' 
),
LV_INV_NO AS
(
     SELECT DISTINCT AA.AGMT_CTY_CD , AA.AGMT_SEQ , BB.INV_NO , BB.CSR_NO
        FROM LSE_PAY_RNTL_CHG AA,
             LV_DATA0 BB
        WHERE AA.VNDR_SEQ = BB.VNDR_NO
        AND   AA.INV_NO   = BB.INV_NO
)
SELECT  AA.VNDR_SEQ AS VNDR_SEQ,
        BB.INV_NO AS INV_NO,
        BB.CSR_NO AS CSR_NO ,
        AA.LSE_AGMT_DOC_NO L_ASSETCD ,
        AA.LSE_AGMT_DOC_DESC L_DOCUMENT_TITLE 
FROM   LSE_AGREEMENT AA,
       LV_INV_NO BB
WHERE AA.AGMT_CTY_CD = BB.AGMT_CTY_CD
AND   AA.AGMT_SEQ = BB.AGMT_SEQ			]]></sql>
			<params>
				<param name="csr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
