/*=========================================================
*Copyright(c) 2009 CyberLogitec
*@FileName : CntrForecastPrecisionManageDBDAOSearchCntrForecastPerformanceRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2009.11.26
*@LastModifier : 
*@LastVersion : 1.0
* 2009.11.26 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.ees.eqr.repoplanmanage.cntrforecastprecisionmanage.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class CntrForecastPrecisionManageDBDAOSearchCntrForecastPerformanceRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * <EES_EQR_0037 컨테이너 수급 예측실적 및 정확도 조회>
	  * Forecast Performance & Match Ratio   데이터 조회
	  * 
	  * <Change History>
	  * 1	2009.10.15	Lee ByoungHun	최초작성
	  * </pre>
	  */
	public CntrForecastPrecisionManageDBDAOSearchCntrForecastPerformanceRSQL(){
		setQuery();
		setQuery2();
		params = new HashMap<String,String[]>();
		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.ees.eqr.repoplanmanage.cntrforecastprecisionmanage.integration").append("\n"); 
		query.append("FileName : CntrForecastPrecisionManageDBDAOSearchCntrForecastPerformanceRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if (${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY CO_CD" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != '' && ${dataselect2} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} != 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("------4wk union all 의 최외곽 START" ).append("\n"); 
		query.append("#foreach ($key in ${arrWkResult})" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != '' && ${dataselect2} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} != 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("SELECT  T.YRWK WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("MIN(T.FCAST_YRWK) WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.FCAST_YRWK WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("(SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append(",'Performance' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append(",'Demand Forcast' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append(",'Sales Input' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append(",'Statistical' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append(",'4WK Avrg Vol' DIV" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",'' TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.FM_ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.TO_ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.FM_ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(",'' TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append(", SUM(T.CNTR_QTY) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(T.CNTR_VOL_QTY) TOTAL" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", '1' SEQ" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrFmEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${fmtype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrFmEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrFmEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${attype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${attype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrAtEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrAtEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrToEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${totype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${totype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrToEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrToEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) D" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") D" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("T.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P')" ).append("\n"); 
		query.append("T.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("'F5','S2','S4','A2','A4' )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("AND IO_BND_CD =" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("'O'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'I'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND (SELECT ECC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.ECC_CD) IS NOT NULL" ).append("\n"); 
		query.append("GROUP BY YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (SELECT ECC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.FM_ECC_CD) IS NOT NULL" ).append("\n"); 
		query.append("AND (SELECT ECC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.TO_ECC_CD) IS NOT NULL" ).append("\n"); 
		query.append("GROUP BY YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), FM_ECC_CD, TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (SELECT ECC_CD FROM EQR_ECC_MST WHERE ECC_CD = T.FM_ECC_CD) IS NOT NULL" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append("GROUP BY FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY  DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != '' && ${dataselect2} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} != 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($velocityCount < $arrWkResult.size())" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("------4wk union all 의 최외곽 END" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != '' && ${dataselect2} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} != 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("ORDER BY WEEK, FM_ECC_CD, TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY CO_CD" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != '' && ${dataselect2} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} != 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("--DATA SELECT 1 START--------------------------------------" ).append("\n"); 
		query.append("#foreach ($key in ${arrWkResult})" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("SELECT  T.YRWK WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("MIN(T.FCAST_YRWK) WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.FCAST_YRWK WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("(SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append(",'Performance' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append(",'Demand Forcast' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append(",'Sales Input' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append(",'Statistical' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append(",'4WK Avrg Vol' DIV" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(", T.FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(",T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append(", SUM(T.CNTR_QTY) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(T.CNTR_VOL_QTY) TOTAL" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", '1' SEQ" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T," ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T2" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrFmEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${fmtype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrFmEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrFmEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${attype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${attype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrAtEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrAtEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrToEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${totype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${totype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrToEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrToEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) D" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") D" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("T.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P')" ).append("\n"); 
		query.append("T.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("AND T2.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("AND T2.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${dataselect1} != 'D' && ${dataselect2} != 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND T.YRWK = T2.YRWK" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND SUBSTR(T.SCNR_ID,5,6) = T2.YRWK" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND T.YRWK = SUBSTR(T2.SCNR_ID,5,6)" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${inclmatch} == '1')" ).append("\n"); 
		query.append("-- 20070814 ChangHo Chae  조건 변경 추가" ).append("\n"); 
		query.append("-- 기존 아래의 것을 AND T.CNTR_VOL_QTY > 0 아래의 형태로 변경" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P')" ).append("\n"); 
		query.append("AND T.CNTR_VOL_QTY > 0" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND T.CNTR_QTY > 0" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("'F5','S2','S4','A2','A4' )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("AND T.IO_BND_CD =" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("'O'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'I'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($velocityCount < $arrWkResult.size())" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("--DATA SELECT 2 START--------------------------------------" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("#foreach ($key in ${arrWkResult})" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if(${weekmonth} == 'W')" ).append("\n"); 
		query.append("SELECT  T.YRWK WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("MIN(T.FCAST_YRWK) WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.FCAST_YRWK WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("(SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append(",'Performance' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'D')" ).append("\n"); 
		query.append(",'Demand Forcast' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'S')" ).append("\n"); 
		query.append(",'Sales Input' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'T')" ).append("\n"); 
		query.append(",'Statistical' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'W')" ).append("\n"); 
		query.append(",'4WK Avrg Vol' DIV" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.FM_ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${totypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${totypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${totypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.TO_ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append(", SUM(T.CNTR_QTY) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(T.CNTR_VOL_QTY) TOTAL" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", '2' SEQ" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T ," ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T2" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrFmEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${fmtype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrFmEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrFmEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${attype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${attype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrAtEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrAtEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrToEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${totype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${totype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrToEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrToEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) D" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") D" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("T.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect2} != 'P')" ).append("\n"); 
		query.append("T.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("AND T2.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("AND T2.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${dataselect1} != 'D' && ${dataselect2} != 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND T.YRWK = T2.YRWK" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND T.YRWK = SUBSTR(T2.SCNR_ID,5,6)" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND SUBSTR(T.SCNR_ID,5,6) = T2.YRWK" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("'F5','S2','S4','A2','A4' )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("AND T.IO_BND_CD =" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("'O'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'I'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P' && ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($velocityCount < $arrWkResult.size())" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("--DATA SELECT 2 END--------------------------------------" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != '' && ${dataselect2} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} != 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD , TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${inclunmatch} == '1')" ).append("\n"); 
		query.append("--UNMATCH START--------------------------------------" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(",COMPANY CO_CD" ).append("\n"); 
		query.append(",'Unmatch Vol' DIV" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SUM(DECODE ( SEQ , '2' , NVL(TOTAL,0) ))  - SUM(DECODE ( SEQ , '1' , NVL(TOTAL,0) )) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( SEQ , '2' , NVL(${key}CNTR_VOL_QTY,0) )) - SUM(DECODE ( SEQ , '1' , NVL(${key}CNTR_VOL_QTY,0) )) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", '3' SEQ" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != '' && ${dataselect2} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} != 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("--DATA SELECT 1 START--------------------------------------" ).append("\n"); 
		query.append("#foreach ($key in ${arrWkResult})" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("SELECT  T.YRWK WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("MIN(T.FCAST_YRWK) WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.FCAST_YRWK WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("(SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append(",'Performance' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append(",'Demand Forcast' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append(",'Sales Input' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append(",'Statistical' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append(",'4WK Avrg Vol' DIV" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(", T.FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(",T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append(", SUM(T.CNTR_QTY) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(T.CNTR_VOL_QTY) TOTAL" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", '1' SEQ" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T," ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T2" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrFmEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${fmtype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrFmEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrFmEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${attype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${attype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrAtEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrAtEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrToEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${totype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${totype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrToEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrToEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) D" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") D" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("T.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P')" ).append("\n"); 
		query.append("T.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("AND T2.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("AND T2.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${dataselect1} != 'D' && ${dataselect2} != 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND T.YRWK = T2.YRWK" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND SUBSTR(T.SCNR_ID,5,6) = T2.YRWK" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND T.YRWK = SUBSTR(T2.SCNR_ID,5,6)" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${inclmatch} == '1')" ).append("\n"); 
		query.append("-- 20070814 ChangHo Chae  조건 변경 추가" ).append("\n"); 
		query.append("-- 기존 아래의 것을 AND T.CNTR_VOL_QTY > 0 아래의 형태로 변경" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P')" ).append("\n"); 
		query.append("AND T.CNTR_VOL_QTY > 0" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND T.CNTR_QTY > 0" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("'F5','S2','S4','A2','A4' )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("AND T.IO_BND_CD =" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("'O'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'I'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($velocityCount < $arrWkResult.size())" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("--DATA SELECT 2 START--------------------------------------" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("#foreach ($key in ${arrWkResult})" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if(${weekmonth} == 'W')" ).append("\n"); 
		query.append("SELECT  T.YRWK WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("MIN(T.FCAST_YRWK) WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.FCAST_YRWK WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("(SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append(",'Performance' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'D')" ).append("\n"); 
		query.append(",'Demand Forcast' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'S')" ).append("\n"); 
		query.append(",'Sales Input' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'T')" ).append("\n"); 
		query.append(",'Statistical' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'W')" ).append("\n"); 
		query.append(",'4WK Avrg Vol' DIV" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.FM_ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${totypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${totypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${totypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.TO_ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append(", SUM(T.CNTR_QTY) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(T.CNTR_VOL_QTY) TOTAL" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", '2' SEQ" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T ," ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T2" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrFmEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${fmtype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrFmEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrFmEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${attype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${attype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrAtEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrAtEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrToEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${totype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${totype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrToEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrToEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) D" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") D" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("T.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect2} != 'P')" ).append("\n"); 
		query.append("T.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("AND T2.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("AND T2.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${dataselect1} != 'D' && ${dataselect2} != 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND T.YRWK = T2.YRWK" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND T.YRWK = SUBSTR(T2.SCNR_ID,5,6)" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND SUBSTR(T.SCNR_ID,5,6) = T2.YRWK" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("'F5','S2','S4','A2','A4' )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("AND T.IO_BND_CD =" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("'O'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'I'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P' && ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($velocityCount < $arrWkResult.size())" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("--DATA SELECT 2 END--------------------------------------" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != '' && ${dataselect2} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} != 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD , TO_ECC_CD, SEQ" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, FM_ECC_CD, TO_ECC_CD" ).append("\n"); 
		query.append("--UNMATCH END--------------------------------------" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${inclmatch} == '1')" ).append("\n"); 
		query.append("--MATCH START--------------------------------------" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(",COMPANY CO_CD" ).append("\n"); 
		query.append(",'Match Ratio(%)' DIV" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(",TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", ROUND((1- ( ABS(SUM(DECODE(SEQ,'2', TOTAL )) - SUM(DECODE ( SEQ , '1' , TOTAL ))) /  SUM(DECODE ( SEQ , '1' , TOTAL )))) * 100,2) TOTAL" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", ROUND((1- ( ABS(SUM(DECODE(SEQ,'2', TOTAL )) - SUM(DECODE ( SEQ , '1' , TOTAL ))) /  DECODE(SUM(DECODE ( SEQ , '1' , TOTAL )),0,NULL,SUM(DECODE ( SEQ , '1' , TOTAL ))))) * 100,2) TOTAL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", ROUND((1- ( ABS(SUM(DECODE(SEQ,'2', ${key}CNTR_VOL_QTY )) - SUM(DECODE ( SEQ , '1' , ${key}CNTR_VOL_QTY ))) / SUM(DECODE ( SEQ , '1' , ${key}CNTR_VOL_QTY )))) * 100,2) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", ROUND((1- ( ABS(SUM(DECODE(SEQ,'2', ${key}CNTR_VOL_QTY )) - SUM(DECODE ( SEQ , '1' , ${key}CNTR_VOL_QTY ))) / DECODE(SUM(DECODE ( SEQ , '1' , ${key}CNTR_VOL_QTY )),0,NULL ,SUM(DECODE ( SEQ , '1' , ${key}CNTR_VOL_QTY ))))) * 100,2) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", '4' SEQ" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != '' && ${dataselect2} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} != 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("WEEK" ).append("\n"); 
		query.append(", COMPANY" ).append("\n"); 
		query.append(", DIV" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append(", SUM(TOTAL) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(${key}CNTR_VOL_QTY ) ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("FROM  (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("--DATA SELECT 1 START--------------------------------------" ).append("\n"); 
		query.append("#foreach ($key in ${arrWkResult})" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("SELECT  T.YRWK WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("MIN(T.FCAST_YRWK) WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.FCAST_YRWK WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("(SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append(",'Performance' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append(",'Demand Forcast' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append(",'Sales Input' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append(",'Statistical' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append(",'4WK Avrg Vol' DIV" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(", T.FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(",T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append(", SUM(T.CNTR_QTY) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(T.CNTR_VOL_QTY) TOTAL" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", '1' SEQ" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T," ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T2" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrFmEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${fmtype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrFmEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrFmEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${attype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${attype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrAtEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrAtEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrToEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${totype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${totype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrToEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrToEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) D" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") D" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("T.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P')" ).append("\n"); 
		query.append("T.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("AND T2.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("AND T2.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${dataselect1} != 'D' && ${dataselect2} != 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND T.YRWK = T2.YRWK" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND SUBSTR(T.SCNR_ID,5,6) = T2.YRWK" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND T.YRWK = SUBSTR(T2.SCNR_ID,5,6)" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${inclmatch} == '1')" ).append("\n"); 
		query.append("-- 20070814 ChangHo Chae  조건 변경 추가" ).append("\n"); 
		query.append("-- 기존 아래의 것을 AND T.CNTR_VOL_QTY > 0 아래의 형태로 변경" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P')" ).append("\n"); 
		query.append("AND T.CNTR_VOL_QTY > 0" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND T.CNTR_QTY > 0" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("'F5','S2','S4','A2','A4' )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("AND T.IO_BND_CD =" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("'O'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'I'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 

	}
	/**
	 * Query 생성
	 */
	public void setQuery2(){
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($velocityCount < $arrWkResult.size())" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("--DATA SELECT 2 START--------------------------------------" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("#foreach ($key in ${arrWkResult})" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if(${weekmonth} == 'W')" ).append("\n"); 
		query.append("SELECT  T.YRWK WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT (SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("MIN(T.FCAST_YRWK) WEEK" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.FCAST_YRWK WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("(SELECT PLN_MON FROM EQR_WK_PRD	WHERE PLN_YR||PLN_WK = T.FCAST_YRWK) AS WEEK" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator') COMPANY" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append(",'Performance' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'D')" ).append("\n"); 
		query.append(",'Demand Forcast' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'S')" ).append("\n"); 
		query.append(",'Sales Input' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'T')" ).append("\n"); 
		query.append(",'Statistical' DIV" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'W')" ).append("\n"); 
		query.append(",'4WK Avrg Vol' DIV" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append(", '' TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", '' FM_ECC_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${fmtypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${fmtypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.FM_ECC_CD" ).append("\n"); 
		query.append(") FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${orgdst} == 'TO' || ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${totypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${totypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${totypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attypeby} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${attypeby} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = T.TO_ECC_CD" ).append("\n"); 
		query.append(") TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(",'' TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append(", SUM(T.CNTR_QTY) TOTAL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY ))    O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY ))    O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY ))    F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY ))    F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} != 'O2' && ${key} != 'O4' && ${key} != 'F2' && ${key} != 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${key} == 'O2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S2','O2','O2','O2') , 'O2' , T.CNTR_QTY )) / 4),0)   O2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'O4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'S4','O4','O4','O4') , 'O4' , T.CNTR_QTY )) / 4),0)   O4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F2')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A2','F2','F2','F2') , 'F2' , T.CNTR_QTY )) / 4),0)   F2CNTR_VOL_QTY" ).append("\n"); 
		query.append("#elseif (${key} == 'F4')" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( DECODE(T.CNTR_TPSZ_CD,'A4','F4','F4','F4','F5','F4') , 'F4' , T.CNTR_QTY )) / 4),0)   F4CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(T.CNTR_VOL_QTY) TOTAL" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(T.CNTR_VOL_QTY) / 4),0) TOTAL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if (${weeklygubun} != 'Weekly4')" ).append("\n"); 
		query.append(", SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY ))    ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(", NVL(ROUND(SUM(DECODE ( T.CNTR_TPSZ_CD , '$key' , T.CNTR_VOL_QTY )) / 4) ,0)   ${key}CNTR_VOL_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", '2' SEQ" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T ," ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T2" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM' || ${orgdst} == 'TO')" ).append("\n"); 
		query.append("EQR_FULL_CNTR_PERF" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("EQR_FULL_CNTR_FM_TO_PERF" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'D')" ).append("\n"); 
		query.append("EQR_OB_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'S')" ).append("\n"); 
		query.append("EQR_SLS_INP_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'T')" ).append("\n"); 
		query.append("EQR_SLS_STAT_FCAST" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'W')" ).append("\n"); 
		query.append("EQR_AVG_FCAST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("T" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrFmEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${fmtype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${fmtype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrFmEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrFmEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${attype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${attype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrAtEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrAtEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if ($arrToEccCd.size() > 0)" ).append("\n"); 
		query.append("#if (${totype} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${totype} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrToEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrToEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")) D" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(") D" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("T.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect2} != 'P')" ).append("\n"); 
		query.append("T.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("T.YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("AND T.FCAST_YRWK BETWEEN '$key.get(1)' AND '$key.get(3)'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = '$key.get(1)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("AND T2.YRWK = '$key.get(0)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("AND T2.SCNR_ID = '$key.get(2)'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'P')" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD AND T.ECC_CD = D.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${fmtoat} == '1')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = D.ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD OR T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${attype} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("AND (T.FM_ECC_CD = C.ECC_CD AND T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND (T.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} != 'P' && ${dataselect2} != 'P')" ).append("\n"); 
		query.append("#if (${dataselect1} != 'D' && ${dataselect2} != 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND T.YRWK = T2.YRWK" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} == 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND T.YRWK = SUBSTR(T2.SCNR_ID,5,6)" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect2} == 'D')" ).append("\n"); 
		query.append("AND T.FM_ECC_CD = T2.FM_ECC_CD" ).append("\n"); 
		query.append("AND T.TO_ECC_CD = T2.TO_ECC_CD" ).append("\n"); 
		query.append("AND T.CO_CD = T2.CO_CD" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD = T2.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("AND SUBSTR(T.SCNR_ID,5,6) = T2.YRWK" ).append("\n"); 
		query.append("AND T.FCAST_YRWK = T2.FCAST_YRWK" ).append("\n"); 
		query.append("AND T.FCAST_DT = T2.FCAST_DT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND T.CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("'F5','S2','S4','A2','A4' )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${dataselect1} == 'P')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P' && ${orgdst} != 'FMTO')" ).append("\n"); 
		query.append("AND T.IO_BND_CD =" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("'O'" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'I'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.ECC_CD" ).append("\n"); 
		query.append("#elseif (${dataselect2} == 'P' && ${orgdst} == 'FMTO')" ).append("\n"); 
		query.append("GROUP BY T.YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${weeklygubun} == 'Weekly4')" ).append("\n"); 
		query.append("#if (${weekmonth} != 'W')" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("GROUP BY T.FCAST_YRWK, DECODE(T.CO_CD, 'H', 'Hanjin', 'S', 'Senator'), T.FM_ECC_CD, T.TO_ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($velocityCount < $arrWkResult.size())" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("--DATA SELECT 2 END--------------------------------------" ).append("\n"); 
		query.append("#if (${weekmonth} == 'W')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if (${dataselect1} != '' && ${dataselect2} != '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} == 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append("#if (${orgdst} == 'FM')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'TO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#elseif (${orgdst} == 'FMTO')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${dataselect1} != 'P' && ${dataselect2} == '')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, DIV, FM_ECC_CD , TO_ECC_CD, SEQ" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY WEEK, COMPANY, FM_ECC_CD, TO_ECC_CD" ).append("\n"); 
		query.append("--MATCH END--------------------------------------" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("ORDER BY WEEK, FM_ECC_CD, TO_ECC_CD, SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 

	}
}