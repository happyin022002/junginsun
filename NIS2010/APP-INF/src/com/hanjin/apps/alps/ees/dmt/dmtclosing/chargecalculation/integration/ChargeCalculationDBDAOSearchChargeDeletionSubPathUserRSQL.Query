<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChargeCalculationDBDAOSearchChargeDeletionSubPathUserRSQL">
			<desc><![CDATA[ChargeCalculationDBDAOSearchChargeDeletionSubPathUserRSQL]]></desc>
			<sql><![CDATA[
select  case 
            when count(1) = 0 then 'N' 
            when max(T1.CHG_DELT_STS_CD) <> @[chg_delt_sts_cd] then 'Y'
            else 'N'
        end
  from  DMT_CHG_DELT_CNG_HIS  T1 
 where  T1.SYS_AREA_GRP_ID     = @[svr_id]
   and  T1.CNTR_NO        	   = @[cntr_no]
   and  T1.CNTR_CYC_NO 		   = to_number(@[cntr_cyc_no])
   and  T1.DMDT_TRF_CD 		   = @[dmdt_trf_cd]
   and  T1.DMDT_CHG_LOC_DIV_CD = @[dmdt_chg_loc_div_cd]
   and  T1.CHG_SEQ 			   = to_number(@[chg_seq])
   and  T1.CHG_OFC_CD 		   = @[ofc_cd]
   and  T1.DELT_SEQ 		   = to_number(@[delt_seq])  
   and  T1.DELT_CNG_HIS_SEQ =
		(
			select  max(DELT_CNG_HIS_SEQ)
			  from  DMT_CHG_DELT_CNG_HIS
			 where  SYS_AREA_GRP_ID     = T1.SYS_AREA_GRP_ID
			   and  CNTR_NO        	    = T1.CNTR_NO
			   and  CNTR_CYC_NO 		= T1.CNTR_CYC_NO
			   and  DMDT_TRF_CD 		= T1.DMDT_TRF_CD
			   and  DMDT_CHG_LOC_DIV_CD = T1.DMDT_CHG_LOC_DIV_CD
			   and  CHG_SEQ 			= T1.CHG_SEQ
			   and  CHG_OFC_CD 		    = T1.CHG_OFC_CD
			   and  DELT_SEQ 		    = T1.DELT_SEQ
		)
   and  exists
		(
			select  1
			  from  DMT_CHG_DELT_PATH
			 where  SYS_AREA_GRP_ID     = T1.SYS_AREA_GRP_ID
			   and  CNTR_NO        	    = T1.CNTR_NO
			   and  CNTR_CYC_NO 		= T1.CNTR_CYC_NO
			   and  DMDT_TRF_CD 		= T1.DMDT_TRF_CD
			   and  DMDT_CHG_LOC_DIV_CD = T1.DMDT_CHG_LOC_DIV_CD
			   and  CHG_SEQ 			= T1.CHG_SEQ
			   and  CHG_OFC_CD 		    = T1.CHG_OFC_CD
			   and  DELT_SEQ 		    = T1.DELT_SEQ
			   and  CHG_DELT_PATH_LVL   < decode(T1.CHG_DELT_PATH_CD, 'BBG', 1, 'RHQ', 2, 'HDO', 3, 0)
			   and  CHG_DELT_STS_CD     in ('A', 'J')
		)			]]></sql>
			<params>
				<param name="chg_delt_sts_cd" type="12" value="" out="N"/>
				<param name="svr_id" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
				<param name="cntr_cyc_no" type="12" value="" out="N"/>
				<param name="dmdt_trf_cd" type="12" value="" out="N"/>
				<param name="dmdt_chg_loc_div_cd" type="12" value="" out="N"/>
				<param name="chg_seq" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="delt_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
