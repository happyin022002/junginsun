<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CNTRInventoryReportDBDAOsearchYearWeekListRSQL">
			<desc><![CDATA[2016-02-12
Equipment Management > CNTR Inventory > Inventory Status > Land Inventory > Land Inventory with Optimum Stock 
조회를 위한 week list]]></desc>
			<sql><![CDATA[
WITH EQR_WK AS
(SELECT ROWNUM NUM
       ,A.*
  FROM (SELECT * 
          FROM EQR_WK_PRD
        ORDER BY PLN_YR, PLN_WK) A
)
, B_WK AS
(SELECT E.PLN_YR||E.PLN_WK TGT_YRWK
       ,E.NUM NUM
       ,E.PLN_YR
       ,E.PLN_WK
   FROM EQR_WK E, (SELECT TGT_BSE_DT FROM CIM_OPTM_STK_SMRY
                    WHERE OPTM_STK_MNG_TP_CD = 'B') B
  WHERE TO_DATE(B.TGT_BSE_DT,'YYYYMMDD') BETWEEN TO_DATE(E.WK_ST_DT,'YYYYMMDD') AND TO_DATE(E.WK_END_DT,'YYYYMMDD')
)
SELECT 'T' WK_FLG 
        ,PLN_YR||PLN_WK YRWK
   FROM EQR_WK_PRD 
  WHERE SYSDATE BETWEEN TO_DATE(WK_ST_DT,'YYYY/MM/DD HH24:MI:SS') AND TO_DATE(WK_END_DT,'YYYY/MM/DD HH24:MI:SS')
UNION ALL
SELECT 'B' WK_FLG
       ,E.PLN_YR || E.PLN_WK YRWK
  FROM EQR_WK E, B_WK B
 WHERE E.NUM = B.NUM-3
UNION ALL
SELECT 'PB' WK_FLG
       ,E.PLN_YR || E.PLN_WK YRWK
  FROM EQR_WK E, B_WK B
 WHERE E.NUM = B.NUM-7
UNION ALL
SELECT 'NB' WK_FLG
       ,E.PLN_YR || E.PLN_WK YRWK
  FROM EQR_WK E, B_WK B
 WHERE E.NUM = B.NUM+1			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
