<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceIssueCollectionMgtDBDAOSearchIssuedInvoiceSumByPayerRSQL">
			<desc><![CDATA[EES_DMT_4008 Payer에 대한 currency별 Normal Inv. Total, Manual Inv. Total
--  InvoiceIssueCollectionMgtDBDAOSearchIssuedInvoiceListRSQL와 동일한 조건절 사용함]]></desc>
			<sql><![CDATA[
#if (${inv_flg} == 'N')
	SELECT  'Normal Inv. Total' AS T_NAME 
		    ,T.T_CURR
		    ,T.T_CHARGES
		    ,T.T_INCURRED_AMT
		    ,T.T_EXPT_AMT
		    ,T.T_DC_AMT
		    ,T.T_BIL_AMT
		    ,S.T_INV_CURR
		    ,S.T_CHR_CNT
		    ,S.T_INV_CHG_AMT
		    ,S.T_TAX_AMT
		    ,S.T_INV_AMT
	  FROM  (
				SELECT  A.CHG_CURR_CD 					AS T_CURR
					   ,COUNT( B.CNTR_NO) 				AS T_CHARGES
					   ,SUM(NVL(B.ORG_CHG_AMT, 0)) 		AS T_INCURRED_AMT
					   ,SUM(NVL(B.SC_RFA_EXPT_AMT, 0)) 	AS T_EXPT_AMT
					   ,SUM(NVL(B.AFT_EXPT_DC_AMT, 0)) 	AS T_DC_AMT
					   ,SUM(NVL(B.BIL_AMT, 0)) 			AS T_BIL_AMT
					   
				  FROM  DMT_INV_MN 		A
				       ,DMT_INV_DTL 	B
					   
				 WHERE  1 = 1
				   --AND  ('R' = SUBSTR(A.DMDT_INV_NO,3,1) OR 'T' = SUBSTR(A.DMDT_INV_NO,3,1))
				   AND  (
							CASE 
								-- INDIA 일 경우, INVOICE NO 자리수가 다름.
								WHEN (SELECT SUBSTR(LOC_CD, 0, 2) FROM MDM_ORGANIZATION WHERE OFC_CD = A.CRE_OFC_CD) = 'IN'  AND A.CRE_DT >= (SELECT TO_DATE(ATTR_CTNT1, 'YYYYMMDDHH24MI') FROM DMT_HRD_CDG_CTNT WHERE HRD_CDG_ID = 'IDA_TAX_APPL_DT') THEN
									SUBSTR(A.DMDT_INV_NO, 4, 1)
								ELSE
									SUBSTR(A.DMDT_INV_NO, 3, 1)
							END
						) IN ('R', 'T')
				   AND  A.DMDT_INV_NO = B.DMDT_INV_NO(+)
				   AND  A.CRE_OFC_CD  = B.CRE_OFC_CD(+)
		
				## Tariff Type
				   #if (${s_dmdt_trf_cd} != '')
				   AND  A.DMDT_TRF_CD IN (
						#foreach($dmdt_trf_no in ${dmdt_trf_cd_list}) 
							#if($velocityCount < $dmdt_trf_cd_list.size()) 
								'$dmdt_trf_no', 
							#else 
								'$dmdt_trf_no' 
							#end 
						#end
						)
				   #end
		
				## AR/IF = (N, Y, H, H and LIT)
				   #if (${s_dmdt_ar_if_cd} != '')
				   AND  
						#if(${ar_if_cnt} > 0)
						(A.DMDT_AR_IF_CD IN (
							#foreach($dmdt_ar_if_no in ${dmdt_ar_if_list}) 
								#if($velocityCount < $dmdt_ar_if_list.size()) 
								'$dmdt_ar_if_no', 
								#else 
								'$dmdt_ar_if_no' 
								#end 
							#end
							)
								
							## AR/IF = L
							#if (${s_ar_if_l_yn} != '')	
							OR (A.DMDT_AR_IF_CD = 'H' AND A.INV_HLD_RSN_CD = 'LIT')
							#end
						)
						#else
							## AR/IF = L
							#if (${s_ar_if_l_yn} != '')	
							(A.DMDT_AR_IF_CD = 'H' AND A.INV_HLD_RSN_CD = 'LIT')
							#end
					    #end
				   #end
		
				## INVOICE STATUS
				   #if (${s_dmdt_inv_sts_cd} != '')
				   AND  A.DMDT_INV_STS_CD IN (
						#foreach($dmdt_inv_sts_no in ${dmdt_inv_sts_list}) 
							#if($velocityCount < $dmdt_inv_sts_list.size()) 
							'$dmdt_inv_sts_no', 
							#else 
							'$dmdt_inv_sts_no' 
							#end 
						#end
						)
				   #end
		
				## OFC radio box
				   #if (${s_inv_check} == 'N')
				   AND  A.CRE_OFC_CD IN (
						#foreach($s_issue_ofc in ${ofc_cd_list})
							#if($velocityCount < $ofc_cd_list.size()) '$s_issue_ofc', #else '$s_issue_ofc' #end
						#end
						)
				   AND TO_CHAR(A.CRE_DT,'YYYYMMDD') BETWEEN @[s_issue_fm] AND @[s_issue_to]
				   #end
		
				## INV radio box
				#if (${s_inv_check} == 'Y')
				   
				   #if (${session_rhq_ofc_cd} != 'SELHO')
				   AND  A.CRE_OFC_CD IN (SELECT OFC_CD FROM MDM_ORGANIZATION WHERE AR_HD_QTR_OFC_CD = @[session_rhq_ofc_cd])
				   #end
				   
				   #if (${s_invoice_no} != '')	
				   AND  A.DMDT_INV_NO IN (
						#foreach($invoice_cd in ${invoice_no_list})
							#if($velocityCount < $invoice_no_list.size()) 
							'$invoice_cd', 
							#else 
							'$invoice_cd' 
							#end
						#end
						)
				   #end
				   
				   #if (${s_bkg_no} != '')	
				   AND  A.BKG_NO IN (
						#foreach($bkg_cd in ${bkg_no_list})
							#if($velocityCount < $bkg_no_list.size()) 
							'$bkg_cd', 
							#else 
							'$bkg_cd' 
							#end
						#end
						)
				   #end
				   
				   #if (${s_bl_no} != '')	
				   AND  A.BL_NO IN (
						#foreach($bl_cd in ${bl_no_list})
							#if($velocityCount < $bl_no_list.size()) 
							'$bl_cd', 
							#else 
							'$bl_cd' 
							#end
						#end
						)
				   #end
				   
				#end
		
				## OVER DAYS
				   #if (${s_inv_over_to} != '')
				   AND  (TO_DATE(TO_CHAR(NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(A.CRE_OFC_CD),SYSDATE), 'YYYYMMDD'), 'YYYYMMDD') - TO_DATE(TO_CHAR(A.CRE_DT, 'YYYYMMDD'), 'YYYYMMDD')) BETWEEN @[s_inv_over_fm] AND @[s_inv_over_to]
				   #end
		
				## ISSUE ID
				   #if (${s_issue_usr_id} != '')
				   AND  A.CRE_USR_ID = @[s_issue_usr_id]
				   #end
		
				## PAYER
				#if (${s_payer_cd} != '')
				   #if (${s_cust_gubun} == '1')
				   AND  LPAD(A.ACT_PAYR_SEQ,6,'0') = LPAD(@[s_cust_cd],6,'0')
				   #elseif (${s_cust_gubun} == '2') 
				   AND  A.ACT_PAYR_CNT_CD = SUBSTR(@[s_cust_cd],1,2)
				   AND  LPAD(A.ACT_PAYR_SEQ,6,'0') = SUBSTR(@[s_cust_cd],3)
				   #end
				#end
		
				## SC NO
				   #if(${s_sc_no} != '')
				   AND A.SC_NO = @[s_sc_no]
				   #end
		
				## RFA NO
				   #if(${s_rfa_no} != '')
				   AND A.RFA_NO = @[s_rfa_no]
				   #end
				   
				GROUP BY A.CHG_CURR_CD	
	
			) T
		   ,(
				SELECT  A.CHG_CURR_CD 									AS T_CURR
					   ,A.INV_CURR_CD 									AS T_INV_CURR
					   ,COUNT( B.CNTR_NO) 								AS T_CHR_CNT
					   ,SUM(NVL(B.CNTR_INV_AMT, 0)) 					AS T_INV_CHG_AMT
					   ,SUM(NVL(B.TAX_AMT, 0)) 							AS T_TAX_AMT
					   ,SUM(NVL(B.CNTR_INV_AMT, 0) + NVL(B.TAX_AMT, 0)) AS T_INV_AMT
					   
				  FROM  DMT_INV_MN 		A
				       ,DMT_INV_DTL 	B
					   
				 WHERE  1 = 1
				 --AND  ('R' = SUBSTR(A.DMDT_INV_NO,3,1) OR 'T' = SUBSTR(A.DMDT_INV_NO,3,1))				 
				   AND  (
							CASE 
								-- INDIA 일 경우, INVOICE NO 자리수가 다름.
								WHEN (SELECT SUBSTR(LOC_CD, 0, 2) FROM MDM_ORGANIZATION WHERE OFC_CD = A.CRE_OFC_CD) = 'IN'  AND A.CRE_DT >= (SELECT TO_DATE(ATTR_CTNT1, 'YYYYMMDDHH24MI') FROM DMT_HRD_CDG_CTNT WHERE HRD_CDG_ID = 'IDA_TAX_APPL_DT') THEN
									SUBSTR(A.DMDT_INV_NO, 4, 1)
								ELSE
									SUBSTR(A.DMDT_INV_NO, 3, 1)
							END
						) IN ('R', 'T')
				   AND  A.DMDT_INV_NO = B.DMDT_INV_NO(+)
				   AND  A.CRE_OFC_CD  = B.CRE_OFC_CD(+)
		
				## Tariff Type
				   #if (${s_dmdt_trf_cd} != '')
				   AND  A.DMDT_TRF_CD IN (
						#foreach($dmdt_trf_no in ${dmdt_trf_cd_list}) 
							#if($velocityCount < $dmdt_trf_cd_list.size()) 
								'$dmdt_trf_no', 
							#else 
								'$dmdt_trf_no' 
							#end 
						#end
						)
				   #end

				## AR/IF = (N, Y, H, H and LIT)
				   #if (${s_dmdt_ar_if_cd} != '')
				   AND  
						#if(${ar_if_cnt} > 0)
						(A.DMDT_AR_IF_CD IN (
							#foreach($dmdt_ar_if_no in ${dmdt_ar_if_list}) 
								#if($velocityCount < $dmdt_ar_if_list.size()) 
								'$dmdt_ar_if_no', 
								#else 
								'$dmdt_ar_if_no' 
								#end 
							#end
							)
								
							## AR/IF = L
							#if (${s_ar_if_l_yn} != '')	
							OR (A.DMDT_AR_IF_CD = 'H' AND A.INV_HLD_RSN_CD = 'LIT')
							#end
						)
						#else
							## AR/IF = L
							#if (${s_ar_if_l_yn} != '')	
							(A.DMDT_AR_IF_CD = 'H' AND A.INV_HLD_RSN_CD = 'LIT')
							#end
					    #end
				   #end
				   
				## INVOICE STATUS
				   #if (${s_dmdt_inv_sts_cd} != '')
				   AND  A.DMDT_INV_STS_CD IN (
						#foreach($dmdt_inv_sts_no in ${dmdt_inv_sts_list}) 
							#if($velocityCount < $dmdt_inv_sts_list.size()) 
							'$dmdt_inv_sts_no', 
							#else 
							'$dmdt_inv_sts_no' 
							#end 
						#end
						)
				   #end
		
				## OFC radio box
				   #if (${s_inv_check} == 'N')
				   AND  A.CRE_OFC_CD IN (
						#foreach($s_issue_ofc in ${ofc_cd_list})
							#if($velocityCount < $ofc_cd_list.size()) '$s_issue_ofc', #else '$s_issue_ofc' #end
						#end
						)
				   AND TO_CHAR(A.CRE_DT,'YYYYMMDD') BETWEEN @[s_issue_fm] AND @[s_issue_to]
				   #end				   

				## INV radio box
				#if (${s_inv_check} == 'Y')
				   
				   #if (${session_rhq_ofc_cd} != 'SELHO')
				   AND  A.CRE_OFC_CD IN (SELECT OFC_CD FROM MDM_ORGANIZATION WHERE AR_HD_QTR_OFC_CD = @[session_rhq_ofc_cd])
				   #end
				   
				   #if (${s_invoice_no} != '')	
				   AND  A.DMDT_INV_NO IN (
						#foreach($invoice_cd in ${invoice_no_list})
							#if($velocityCount < $invoice_no_list.size()) 
							'$invoice_cd', 
							#else 
							'$invoice_cd' 
							#end
						#end
						)
				   #end
				   
				   #if (${s_bkg_no} != '')	
				   AND  A.BKG_NO IN (
						#foreach($bkg_cd in ${bkg_no_list})
							#if($velocityCount < $bkg_no_list.size()) 
							'$bkg_cd', 
							#else 
							'$bkg_cd' 
							#end
						#end
						)
				   #end
				   
				   #if (${s_bl_no} != '')	
				   AND  A.BL_NO IN (
						#foreach($bl_cd in ${bl_no_list})
							#if($velocityCount < $bl_no_list.size()) 
							'$bl_cd', 
							#else 
							'$bl_cd' 
							#end
						#end
						)
				   #end
				   
				#end

				## OVER DAYS
				   #if (${s_inv_over_to} != '')
				   AND  (TO_DATE(TO_CHAR(NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(A.CRE_OFC_CD),SYSDATE), 'YYYYMMDD'), 'YYYYMMDD') - TO_DATE(TO_CHAR(A.CRE_DT, 'YYYYMMDD'), 'YYYYMMDD')) BETWEEN @[s_inv_over_fm] AND @[s_inv_over_to]
				   #end
		
				## ISSUE ID
				   #if (${s_issue_usr_id} != '')
				   AND  A.CRE_USR_ID = @[s_issue_usr_id]
				   #end
		
				## PAYER
				#if (${s_payer_cd} != '')
				   #if (${s_cust_gubun} == '1')
				   AND  LPAD(A.ACT_PAYR_SEQ,6,'0') = LPAD(@[s_cust_cd],6,'0')
				   #elseif (${s_cust_gubun} == '2') 
				   AND  A.ACT_PAYR_CNT_CD = SUBSTR(@[s_cust_cd],1,2)
				   AND  LPAD(A.ACT_PAYR_SEQ,6,'0') = SUBSTR(@[s_cust_cd],3)
				   #end
				#end
		
				## SC NO
				   #if(${s_sc_no} != '')
				   AND A.SC_NO = @[s_sc_no]
				   #end
		
				## RFA NO
				   #if(${s_rfa_no} != '')
				   AND A.RFA_NO = @[s_rfa_no]
				   #end				
				
				
				GROUP BY A.CHG_CURR_CD, A.INV_CURR_CD
			) S
	
	 WHERE  S.T_CURR = T.T_CURR
	ORDER BY S.T_CURR, S.T_INV_CURR
	
#else

	SELECT  'Manual Inv. Total' AS T_NAME 
			,T.T_CURR
			,T.T_CHARGES
			,T.T_INCURRED_AMT
			,T.T_EXPT_AMT
			,T.T_DC_AMT
			,T.T_BIL_AMT
			,S.T_INV_CURR
			,S.T_CHR_CNT
			,S.T_INV_CHG_AMT
			,S.T_TAX_AMT
			,S.T_INV_AMT
	  FROM  (
				SELECT  A.CHG_CURR_CD 					AS T_CURR
					   ,COUNT( A.DMDT_INV_NO) 			AS T_CHARGES
					   ,SUM(NVL(A.ORG_CHG_AMT,0))  		AS T_INCURRED_AMT
					   ,SUM(NVL(A.DMDT_EXPT_AMT,0)) 	AS T_EXPT_AMT
					   ,SUM(NVL(A.DC_AMT,0)) 			AS T_DC_AMT
					   ,SUM(NVL(A.BIL_AMT, 0)) 			AS T_BIL_AMT
					   
				  FROM  DMT_INV_MN A
				 WHERE  1 = 1
				 --AND  'M' = SUBSTR(DMDT_INV_NO,3,1)
				   AND  (
							CASE 
								-- INDIA 일 경우, INVOICE NO 자리수가 다름.
								WHEN (SELECT SUBSTR(LOC_CD, 0, 2) FROM MDM_ORGANIZATION WHERE OFC_CD = A.CRE_OFC_CD) = 'IN'  AND A.CRE_DT >= (SELECT TO_DATE(ATTR_CTNT1, 'YYYYMMDDHH24MI') FROM DMT_HRD_CDG_CTNT WHERE HRD_CDG_ID = 'IDA_TAX_APPL_DT') THEN
									SUBSTR(A.DMDT_INV_NO, 4, 1)
								ELSE
									SUBSTR(A.DMDT_INV_NO, 3, 1)
							END
						) = 'M'		   
				   
				## Tariff Type
				   #if (${s_dmdt_trf_cd} != '')
				   AND  A.DMDT_TRF_CD IN (
						#foreach($dmdt_trf_no in ${dmdt_trf_cd_list}) 
							#if($velocityCount < $dmdt_trf_cd_list.size()) 
								'$dmdt_trf_no', 
							#else 
								'$dmdt_trf_no' 
							#end 
						#end
						)
				   #end
		
				## AR/IF = (N, Y, H, H and LIT)
				   #if (${s_dmdt_ar_if_cd} != '')
				   AND  
						#if(${ar_if_cnt} > 0)
						(A.DMDT_AR_IF_CD IN (
							#foreach($dmdt_ar_if_no in ${dmdt_ar_if_list}) 
								#if($velocityCount < $dmdt_ar_if_list.size()) 
								'$dmdt_ar_if_no', 
								#else 
								'$dmdt_ar_if_no' 
								#end 
							#end
							)
								
							## AR/IF = L
							#if (${s_ar_if_l_yn} != '')	
							OR (A.DMDT_AR_IF_CD = 'H' AND A.INV_HLD_RSN_CD = 'LIT')
							#end
						)
						#else
							## AR/IF = L
							#if (${s_ar_if_l_yn} != '')	
							(A.DMDT_AR_IF_CD = 'H' AND A.INV_HLD_RSN_CD = 'LIT')
							#end
					    #end
				   #end
				   
				## INVOICE STATUS
				   #if (${s_dmdt_inv_sts_cd} != '')
				   AND  A.DMDT_INV_STS_CD IN (
						#foreach($dmdt_inv_sts_no in ${dmdt_inv_sts_list}) 
							#if($velocityCount < $dmdt_inv_sts_list.size()) 
							'$dmdt_inv_sts_no', 
							#else 
							'$dmdt_inv_sts_no' 
							#end 
						#end
						)
				   #end
		
				## OFC radio box
				   #if (${s_inv_check} == 'N')
				   AND  A.CRE_OFC_CD IN (
						#foreach($s_issue_ofc in ${ofc_cd_list})
							#if($velocityCount < $ofc_cd_list.size()) '$s_issue_ofc', #else '$s_issue_ofc' #end
						#end
						)
				   AND TO_CHAR(A.CRE_DT,'YYYYMMDD') BETWEEN @[s_issue_fm] AND @[s_issue_to]
				   #end					   

				## INV radio box
				#if (${s_inv_check} == 'Y')
				   
				   #if (${session_rhq_ofc_cd} != 'SELHO')
				   AND  A.CRE_OFC_CD IN (SELECT OFC_CD FROM MDM_ORGANIZATION WHERE AR_HD_QTR_OFC_CD = @[session_rhq_ofc_cd])
				   #end
				   
				   #if (${s_invoice_no} != '')	
				   AND  A.DMDT_INV_NO IN (
						#foreach($invoice_cd in ${invoice_no_list})
							#if($velocityCount < $invoice_no_list.size()) 
							'$invoice_cd', 
							#else 
							'$invoice_cd' 
							#end
						#end
						)
				   #end
				   
				   #if (${s_bkg_no} != '')	
				   AND  A.BKG_NO IN (
						#foreach($bkg_cd in ${bkg_no_list})
							#if($velocityCount < $bkg_no_list.size()) 
							'$bkg_cd', 
							#else 
							'$bkg_cd' 
							#end
						#end
						)
				   #end
				   
				   #if (${s_bl_no} != '')	
				   AND  A.BL_NO IN (
						#foreach($bl_cd in ${bl_no_list})
							#if($velocityCount < $bl_no_list.size()) 
							'$bl_cd', 
							#else 
							'$bl_cd' 
							#end
						#end
						)
				   #end
				   
				#end

				## OVER DAYS
				   #if (${s_inv_over_to} != '')
				   AND  (TO_DATE(TO_CHAR(NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(A.CRE_OFC_CD),SYSDATE), 'YYYYMMDD'), 'YYYYMMDD') - TO_DATE(TO_CHAR(A.CRE_DT, 'YYYYMMDD'), 'YYYYMMDD')) BETWEEN @[s_inv_over_fm] AND @[s_inv_over_to]
				   #end
		
				## ISSUE ID
				   #if (${s_issue_usr_id} != '')
				   AND  A.CRE_USR_ID = @[s_issue_usr_id]
				   #end
		
				## PAYER
				#if (${s_payer_cd} != '')
				   #if (${s_cust_gubun} == '1')
				   AND  LPAD(A.ACT_PAYR_SEQ,6,'0') = LPAD(@[s_cust_cd],6,'0')
				   #elseif (${s_cust_gubun} == '2') 
				   AND  A.ACT_PAYR_CNT_CD = SUBSTR(@[s_cust_cd],1,2)
				   AND  LPAD(A.ACT_PAYR_SEQ,6,'0') = SUBSTR(@[s_cust_cd],3)
				   #end
				#end
		
				## SC NO
				   #if(${s_sc_no} != '')
				   AND A.SC_NO = @[s_sc_no]
				   #end
		
				## RFA NO
				   #if(${s_rfa_no} != '')
				   AND A.RFA_NO = @[s_rfa_no]
				   #end				
				
				GROUP BY A.CHG_CURR_CD, A.INV_CURR_CD
			) T
		   ,(
				SELECT  A.CHG_CURR_CD 				AS T_CURR
			           ,A.INV_CURR_CD 				AS T_INV_CURR
	      	           ,COUNT( A.DMDT_INV_NO) 		AS T_CHR_CNT
	      	           ,SUM(NVL(A.INV_CHG_AMT, 0)) 	AS T_INV_CHG_AMT
	      	           ,SUM(NVL(A.TAX_AMT, 0)) 		AS T_TAX_AMT
	      	           ,SUM(NVL(A.INV_AMT, 0)) 		AS T_INV_AMT
					   
				  FROM  DMT_INV_MN A
				 WHERE  1 = 1
				 --AND  'M' = SUBSTR(A.DMDT_INV_NO,3,1)
				   AND  (
							CASE 
								-- INDIA 일 경우, INVOICE NO 자리수가 다름.
								WHEN (SELECT SUBSTR(LOC_CD, 0, 2) FROM MDM_ORGANIZATION WHERE OFC_CD = A.CRE_OFC_CD) = 'IN'  AND A.CRE_DT >= (SELECT TO_DATE(ATTR_CTNT1, 'YYYYMMDDHH24MI') FROM DMT_HRD_CDG_CTNT WHERE HRD_CDG_ID = 'IDA_TAX_APPL_DT') THEN
									SUBSTR(A.DMDT_INV_NO, 4, 1)
								ELSE
									SUBSTR(A.DMDT_INV_NO, 3, 1)
							END
						) = 'M'		   
				   
				## Tariff Type
				   #if (${s_dmdt_trf_cd} != '')
				   AND  A.DMDT_TRF_CD IN (
						#foreach($dmdt_trf_no in ${dmdt_trf_cd_list}) 
							#if($velocityCount < $dmdt_trf_cd_list.size()) 
								'$dmdt_trf_no', 
							#else 
								'$dmdt_trf_no' 
							#end 
						#end
						)
				   #end
		
				## AR/IF = (N, Y, H, H and LIT)
				   #if (${s_dmdt_ar_if_cd} != '')
				   AND  
						#if(${ar_if_cnt} > 0)
						(A.DMDT_AR_IF_CD IN (
							#foreach($dmdt_ar_if_no in ${dmdt_ar_if_list}) 
								#if($velocityCount < $dmdt_ar_if_list.size()) 
								'$dmdt_ar_if_no', 
								#else 
								'$dmdt_ar_if_no' 
								#end 
							#end
							)
								
							## AR/IF = L
							#if (${s_ar_if_l_yn} != '')	
							OR (A.DMDT_AR_IF_CD = 'H' AND A.INV_HLD_RSN_CD = 'LIT')
							#end
						)
						#else
							## AR/IF = L
							#if (${s_ar_if_l_yn} != '')	
							(A.DMDT_AR_IF_CD = 'H' AND A.INV_HLD_RSN_CD = 'LIT')
							#end
					    #end
				   #end
				   
				## INVOICE STATUS
				   #if (${s_dmdt_inv_sts_cd} != '')
				   AND  A.DMDT_INV_STS_CD IN (
						#foreach($dmdt_inv_sts_no in ${dmdt_inv_sts_list}) 
							#if($velocityCount < $dmdt_inv_sts_list.size()) 
							'$dmdt_inv_sts_no', 
							#else 
							'$dmdt_inv_sts_no' 
							#end 
						#end
						)
				   #end
		
				## OFC radio box
				   #if (${s_inv_check} == 'N')
				   AND  A.CRE_OFC_CD IN (
						#foreach($s_issue_ofc in ${ofc_cd_list})
							#if($velocityCount < $ofc_cd_list.size()) '$s_issue_ofc', #else '$s_issue_ofc' #end
						#end
						)
				   AND TO_CHAR(A.CRE_DT,'YYYYMMDD') BETWEEN @[s_issue_fm] AND @[s_issue_to]
				   #end		

				## INV radio box
				#if (${s_inv_check} == 'Y')
				   
				   #if (${session_rhq_ofc_cd} != 'SELHO')
				   AND  A.CRE_OFC_CD IN (SELECT OFC_CD FROM MDM_ORGANIZATION WHERE AR_HD_QTR_OFC_CD = @[session_rhq_ofc_cd])
				   #end
				   
				   #if (${s_invoice_no} != '')	
				   AND  A.DMDT_INV_NO IN (
						#foreach($invoice_cd in ${invoice_no_list})
							#if($velocityCount < $invoice_no_list.size()) 
							'$invoice_cd', 
							#else 
							'$invoice_cd' 
							#end
						#end
						)
				   #end
				   
				   #if (${s_bkg_no} != '')	
				   AND  A.BKG_NO IN (
						#foreach($bkg_cd in ${bkg_no_list})
							#if($velocityCount < $bkg_no_list.size()) 
							'$bkg_cd', 
							#else 
							'$bkg_cd' 
							#end
						#end
						)
				   #end
				   
				   #if (${s_bl_no} != '')	
				   AND  A.BL_NO IN (
						#foreach($bl_cd in ${bl_no_list})
							#if($velocityCount < $bl_no_list.size()) 
							'$bl_cd', 
							#else 
							'$bl_cd' 
							#end
						#end
						)
				   #end
				   
				#end

				## OVER DAYS
				   #if (${s_inv_over_to} != '')
				   AND  (TO_DATE(TO_CHAR(NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(A.CRE_OFC_CD),SYSDATE), 'YYYYMMDD'), 'YYYYMMDD') - TO_DATE(TO_CHAR(A.CRE_DT, 'YYYYMMDD'), 'YYYYMMDD')) BETWEEN @[s_inv_over_fm] AND @[s_inv_over_to]
				   #end
		
				## ISSUE ID
				   #if (${s_issue_usr_id} != '')
				   AND  A.CRE_USR_ID = @[s_issue_usr_id]
				   #end
		
				## PAYER
				#if (${s_payer_cd} != '')
				   #if (${s_cust_gubun} == '1')
				   AND  LPAD(A.ACT_PAYR_SEQ,6,'0') = LPAD(@[s_cust_cd],6,'0')
				   #elseif (${s_cust_gubun} == '2') 
				   AND  A.ACT_PAYR_CNT_CD = SUBSTR(@[s_cust_cd],1,2)
				   AND  LPAD(A.ACT_PAYR_SEQ,6,'0') = SUBSTR(@[s_cust_cd],3)
				   #end
				#end
		
				## SC NO
				   #if(${s_sc_no} != '')
				   AND A.SC_NO = @[s_sc_no]
				   #end
		
				## RFA NO
				   #if(${s_rfa_no} != '')
				   AND A.RFA_NO = @[s_rfa_no]
				   #end				
				
				GROUP BY A.CHG_CURR_CD, A.INV_CURR_CD	
			) S
	
	 WHERE  S.T_CURR = T.T_CURR
	ORDER BY S.T_CURR, S.T_INV_CURR

#end			]]></sql>
			<params>
				<param name="s_issue_fm" type="12" value="" out="N"/>
				<param name="s_issue_to" type="12" value="" out="N"/>
				<param name="session_rhq_ofc_cd" type="12" value="" out="N"/>
				<param name="s_inv_over_fm" type="12" value="" out="N"/>
				<param name="s_inv_over_to" type="12" value="" out="N"/>
				<param name="s_issue_usr_id" type="12" value="" out="N"/>
				<param name="s_cust_cd" type="12" value="" out="N"/>
				<param name="s_sc_no" type="12" value="" out="N"/>
				<param name="s_rfa_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
