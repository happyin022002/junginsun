/*=========================================================
*Copyright(c) 2010 CyberLogitec
*@FileName : CntrRepoPlanKpiAnalysisDBDAOSearchForecastedMatchBackInfoRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2010.05.13
*@LastModifier : 
*@LastVersion : 1.0
* 2010.05.13 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.ees.eqr.repoplanmanage.cntrrepoplankpianalysis.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class CntrRepoPlanKpiAnalysisDBDAOSearchForecastedMatchBackInfoRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * forecast MatchBack 데이터 조회
	  * </pre>
	  */
	public CntrRepoPlanKpiAnalysisDBDAOSearchForecastedMatchBackInfoRSQL(){
		setQuery();
		setQuery2();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fmPlnYrWk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("toPlnYrWk",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.ees.eqr.repoplanmanage.cntrrepoplankpianalysis.integration").append("\n"); 
		query.append("FileName : CntrRepoPlanKpiAnalysisDBDAOSearchForecastedMatchBackInfoRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if(${atStatus} != '')" ).append("\n"); 
		query.append("## RCC" ).append("\n"); 
		query.append("#if(${atStatus} == 'R')" ).append("\n"); 
		query.append("--RCC" ).append("\n"); 
		query.append("#set($typeStr = \"rcc_cd\")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("## LCC" ).append("\n"); 
		query.append("#if(${atStatus} == 'L')" ).append("\n"); 
		query.append("-- LCC" ).append("\n"); 
		query.append("#set($typeStr = \"lcc_cd\")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("## ECC" ).append("\n"); 
		query.append("#if(${atStatus} == 'E')" ).append("\n"); 
		query.append("-- ECC" ).append("\n"); 
		query.append("#set($typeStr = \"ecc_cd\")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if( ${locOrTrade} == '1' && ${byLocation} == 'P' )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${report} == 'P')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("''	##AAAA##" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1' && ${byLocation} == 'P')" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",VSL_LANE_CD" ).append("\n"); 
		query.append(",VVD" ).append("\n"); 
		query.append(",TRADE" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",SUM(LOFUL_20) LOFUL_20" ).append("\n"); 
		query.append(",SUM(LOFUL_40) LOFUL_40" ).append("\n"); 
		query.append(",SUM(LOFUL_HC) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(LOFUL_45) LOFUL_45" ).append("\n"); 
		query.append(",SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45) LOFUL_TTL" ).append("\n"); 
		query.append(",SUM(LOEMP_20) LOEMP_20" ).append("\n"); 
		query.append(",SUM(LOEMP_40) LOEMP_40" ).append("\n"); 
		query.append(",SUM(LOEMP_HC) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(LOEMP_45) LOEMP_45" ).append("\n"); 
		query.append(",SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) LOEMP_TTL" ).append("\n"); 
		query.append(",SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45" ).append("\n"); 
		query.append("+ LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45)   LO_TOTAL" ).append("\n"); 
		query.append(",SUM(CNTR_TEU_LOFUL+CNTR_TEU_LOEMP)    LO_TEU" ).append("\n"); 
		query.append(",SUM(DCFUL_20) DCFUL_20" ).append("\n"); 
		query.append(",SUM(DCFUL_40) DCFUL_40" ).append("\n"); 
		query.append(",SUM(DCFUL_HC) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(DCFUL_45) DCFUL_45" ).append("\n"); 
		query.append(",SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45) DCFUL_TTL" ).append("\n"); 
		query.append(",SUM(DCEMP_20) DCEMP_20" ).append("\n"); 
		query.append(",SUM(DCEMP_40) DCEMP_40" ).append("\n"); 
		query.append(",SUM(DCEMP_HC) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(DCEMP_45) DCEMP_45" ).append("\n"); 
		query.append(",SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45) DCEMP_TTL" ).append("\n"); 
		query.append(",SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45" ).append("\n"); 
		query.append("+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)    DC_TOTAL" ).append("\n"); 
		query.append(",SUM(CNTR_TEU_DCFUL+CNTR_TEU_DCEMP)    DC_TEU" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOFUL_20) = SUM(DCFUL_20)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_20) = 0  AND SUM(DCFUL_20) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_20) > SUM(DCFUL_20)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(DCFUL_20) / SUM(LOFUL_20) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOFUL_20) /  SUM(DCFUL_20)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATFUL20" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOFUL_40) = SUM(DCFUL_40)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_40) = 0  AND SUM(LOFUL_40) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_40) > SUM(DCFUL_40)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(DCFUL_40) / SUM(LOFUL_40) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOFUL_40) /  SUM(DCFUL_40))* 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATFUL40" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOFUL_HC) = SUM(DCFUL_HC)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_HC) = 0  AND SUM(DCFUL_HC) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_HC) > SUM(DCFUL_HC)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(DCFUL_HC) / SUM(LOFUL_HC)* 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOFUL_HC) / SUM(DCFUL_HC)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATFULHC" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOFUL_45) = SUM(DCFUL_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_45) = 0  AND SUM(DCFUL_45) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_45) > SUM(DCFUL_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(DCFUL_45) / SUM(LOFUL_45) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOFUL_45) / SUM(DCFUL_45)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATFUL45" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45) = SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45) = 0  AND SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45) > SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45) / SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45) / SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45) * 100),1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATFULTTL" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOEMP_20) = SUM(DCEMP_20)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_20) = 0  AND SUM(DCEMP_20) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_20) > SUM(DCEMP_20)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(DCEMP_20) / SUM(LOEMP_20) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOEMP_20) /  SUM(DCEMP_20)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATEMP20" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOEMP_40) = SUM(DCEMP_40)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_40) = 0  AND SUM(DCEMP_40) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_40) > SUM(DCEMP_40)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(DCEMP_40) / SUM(LOEMP_40) * 100 ,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOEMP_40) /  SUM(DCEMP_40)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATEMP40" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOEMP_HC) = SUM(DCEMP_HC)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_HC) = 0  AND SUM(DCEMP_HC) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_HC) > SUM(DCEMP_HC)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(DCEMP_HC) / SUM(LOEMP_HC) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOEMP_HC) / SUM(DCEMP_HC)* 100),1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATEMPHC" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOEMP_45) = SUM(DCEMP_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_45) = 0  AND SUM(DCEMP_45) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_45) > SUM(DCEMP_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(DCEMP_45) / SUM(LOEMP_45) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOEMP_45) / SUM(DCEMP_45)* 100 ),1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATEMP45" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) = SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) = 0  AND SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) > SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45) / SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) *100 ,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) / SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATEMPTTL" ).append("\n"); 
		query.append("## 2007.11.20 류문필 부장님 요청으로 (%)로 구하는 로직으로 변경" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45 + LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) = SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45	+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45 + LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) = 0  AND SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45	+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45 + LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) > SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45	+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45) / SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45 + LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) *100 ,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45 + LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) / SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATBOXTOTAL" ).append("\n"); 
		query.append(",CASE WHEN SUM(CNTR_TEU_LOFUL+CNTR_TEU_LOEMP) = SUM(CNTR_TEU_DCFUL+CNTR_TEU_DCEMP)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(CNTR_TEU_LOFUL+CNTR_TEU_LOEMP) = 0  AND SUM(CNTR_TEU_DCFUL+CNTR_TEU_DCEMP) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(CNTR_TEU_LOFUL+CNTR_TEU_LOEMP) > SUM(CNTR_TEU_DCFUL+CNTR_TEU_DCEMP)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(CNTR_TEU_DCFUL+CNTR_TEU_DCEMP) / SUM(CNTR_TEU_LOFUL+CNTR_TEU_LOEMP) *100 ,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(CNTR_TEU_LOFUL+CNTR_TEU_LOEMP) / SUM(CNTR_TEU_DCFUL+CNTR_TEU_DCEMP)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATTEUTOTAL" ).append("\n"); 
		query.append(",''" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("## (1)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",VSL_LANE_CD" ).append("\n"); 
		query.append(",LST_PORT" ).append("\n"); 
		query.append(",VVD" ).append("\n"); 
		query.append(",TRADE" ).append("\n"); 
		query.append("##project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_FULL , 0)) LOFUL_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_FULL , 0)) LOFUL_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_FULL , 0)) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D7', CNTR_QTY_FULL , 0)) LOFUL_45" ).append("\n"); 
		query.append(",SUM(0) LOEMP_20" ).append("\n"); 
		query.append(",SUM(0) LOEMP_40" ).append("\n"); 
		query.append(",SUM(0) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(0) LOEMP_45" ).append("\n"); 
		query.append(",SUM(0) DCFUL_20" ).append("\n"); 
		query.append(",SUM(0) DCFUL_40" ).append("\n"); 
		query.append(",SUM(0) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(0) DCFUL_45" ).append("\n"); 
		query.append(",SUM(0) DCEMP_20" ).append("\n"); 
		query.append(",SUM(0) DCEMP_40" ).append("\n"); 
		query.append(",SUM(0) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(0) DCEMP_45" ).append("\n"); 
		query.append(",SUM(CNTR_QTY_TEU_LOFULL) CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(0)                  CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SUM(0)                  CNTR_TEU_DCFUL" ).append("\n"); 
		query.append(",SUM(0)                  CNTR_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(PL.FM_ETD_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD		    CO_CD" ).append("\n"); 
		query.append(",CM.TRD_CD		  	TRADE" ).append("\n"); 
		query.append(",PL.VSL_LANE_CD  	VSL_LANE_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.FM_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD  VVD" ).append("\n"); 
		query.append(",CM.LST_LODG_PORT_CD LST_PORT" ).append("\n"); 
		query.append(",BC.CNTR_TPSZ_CD  	CNTR_TPSZ_CD_FULL" ).append("\n"); 
		query.append(",BC.CNTR_VOL_QTY	CNTR_QTY_FULL" ).append("\n"); 
		query.append(",DECODE(BC.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", 'D2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'R2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'O2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'F2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S2', BC.CNTR_VOL_QTY" ).append("\n"); 
		query.append(", 'D4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'O4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append("##				project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'A4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'S4', ( BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'R5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D7', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(",    0" ).append("\n"); 
		query.append(") CNTR_QTY_TEU_LOFULL" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("BKG_BOOKING BK" ).append("\n"); 
		query.append(", BKG_VVD BV" ).append("\n"); 
		query.append(", BKG_CONTAINER BC" ).append("\n"); 
		query.append(", COA_MON_VVD CM" ).append("\n"); 
		query.append("," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT VSL_CD" ).append("\n"); 
		query.append(",SKD_VOY_NO" ).append("\n"); 
		query.append(", SKD_DIR_CD" ).append("\n"); 
		query.append(", FM_YD_CD" ).append("\n"); 
		query.append(", FM_ETD_DT" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("FM_ETD_DT BETWEEN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'yyyymmdd')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")    PL" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PL.VSL_CD = CM.VSL_CD" ).append("\n"); 
		query.append("AND PL.SKD_VOY_NO = CM.SKD_VOY_NO" ).append("\n"); 
		query.append("AND PL.SKD_DIR_CD = CM.DIR_CD" ).append("\n"); 
		query.append("AND CM.DELT_FLG = 'N'" ).append("\n"); 
		query.append("AND PL.VSL_LANE_CD = CM.SLAN_CD" ).append("\n"); 
		query.append("#if(${locOrTrade} == '2' || ( ${locOrTrade} == '1' && ${byLocation} == 'P') )" ).append("\n"); 
		query.append("#if(${vslSlanCd} != '')" ).append("\n"); 
		query.append("AND CM.SLAN_CD IN( ${arrVslSlanCdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD IN( ${arrVvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("## from loc 검색조건" ).append("\n"); 
		query.append("#if(${atStatus} != ''  && ${atLocation} != '')" ).append("\n"); 
		query.append("#if(${report} == 'R')" ).append("\n"); 
		query.append("AND PL.FM_YD_CD IN (SELECT ECC_CD FROM NISADM.EQR_ECC_MST WHERE DELT_FLG='N' AND $typeStr IN (" ).append("\n"); 
		query.append("#elseif(${report} == 'P')" ).append("\n"); 
		query.append("AND SUBSTR(PL.FM_YD_CD,1,5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("${fromEccArrStr}" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND BK.BKG_NO = BV.BKG_NO" ).append("\n"); 
		query.append("AND BK.BKG_NO = BC.BKG_NO" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BV.BKG_NO_SPLIT" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BC.BKG_NO_SPLIT" ).append("\n"); 
		query.append("AND BK.BKG_CGO_TP_CD = 'F'" ).append("\n"); 
		query.append("AND BV.VSL_CD = PL.VSL_CD" ).append("\n"); 
		query.append("AND BV.SKD_VOY_NO = PL.SKD_VOY_NO" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD = PL.SKD_DIR_CD" ).append("\n"); 
		query.append("AND BV.POL_CD = SUBSTR(PL.FM_YD_CD,0,5) 	## loading" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD, TRADE" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append(", LST_PORT" ).append("\n"); 
		query.append("UNION ALL 	## (2)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",VSL_LANE_CD" ).append("\n"); 
		query.append(",LST_PORT" ).append("\n"); 
		query.append(",VVD" ).append("\n"); 
		query.append(",TRADE" ).append("\n"); 
		query.append(",SUM(0) LOFUL_20" ).append("\n"); 
		query.append(",SUM(0) LOFUL_40" ).append("\n"); 
		query.append(",SUM(0) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(0) LOFUL_45" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_EMP , 0)) LOEMP_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_EMP" ).append("\n"); 
		query.append("##				project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_EMP , 0)) LOEMP_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_EMP , 0)) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D7', CNTR_QTY_EMP , 0)) LOEMP_45" ).append("\n"); 
		query.append(",SUM(0) DCFUL_20" ).append("\n"); 
		query.append(",SUM(0) DCFUL_40" ).append("\n"); 
		query.append(",SUM(0) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(0) DCFUL_45" ).append("\n"); 
		query.append(",SUM(0) DCEMP_20" ).append("\n"); 
		query.append(",SUM(0) DCEMP_40" ).append("\n"); 
		query.append(",SUM(0) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(0) DCEMP_45" ).append("\n"); 
		query.append(",SUM(0) CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(CNTR_QTY_TEU_DCEMP) CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SUM(0)                  CNTR_TEU_DCFUL" ).append("\n"); 
		query.append(",SUM(0)                  CNTR_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(PL.FM_ETD_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD			CO_CD" ).append("\n"); 
		query.append(",CM.TRD_CD		  	TRADE" ).append("\n"); 
		query.append(",PL.VSL_LANE_CD  	VSL_LANE_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.FM_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD  VVD" ).append("\n"); 
		query.append(",CM.LST_LODG_PORT_CD LST_PORT" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD   	CNTR_TPSZ_CD_EMP" ).append("\n"); 
		query.append(",Q.CNTR_QTY  		CNTR_QTY_EMP" ).append("\n"); 
		query.append(",DECODE(Q.CNTR_TPSZ_CD , 'D2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'R2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'O2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'F2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S2', Q.CNTR_QTY	* (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'O4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'A4',  Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S4',  Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'R5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D7', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(",    0" ).append("\n"); 
		query.append(") CNTR_QTY_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN PL" ).append("\n"); 
		query.append(", EQR_VSL_EXE_PLN_QTY Q" ).append("\n"); 
		query.append(", COA_MON_VVD CM" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PL.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PL.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND PL.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND PL.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND PL.FM_ETD_DT BETWEEN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'yyyymmdd')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD = CM.VSL_CD||CM.SKD_VOY_NO||CM.DIR_CD" ).append("\n"); 
		query.append("AND CM.DELT_FLG = 'N'" ).append("\n"); 
		query.append("AND PL.VSL_LANE_CD = CM.SLAN_CD" ).append("\n"); 
		query.append("#if(${locOrTrade} == '2' || ( ${locOrTrade} == '1' && ${byLocation} == 'P') )" ).append("\n"); 
		query.append("#if(${vslSlanCd} != '')" ).append("\n"); 
		query.append("AND CM.SLAN_CD IN( ${arrVslSlanCdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD IN( ${arrVvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("## from loc 검색조건" ).append("\n"); 
		query.append("#if(${atStatus} != ''  && ${atLocation} != '')" ).append("\n"); 
		query.append("#if(${report} == 'R')" ).append("\n"); 
		query.append("AND PL.FM_YD_CD IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#elseif(${report} == 'P')" ).append("\n"); 
		query.append("AND SUBSTR(PL.FM_YD_CD,1,5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("${fromEccArrStr}" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD, TRADE" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append(", LST_PORT" ).append("\n"); 
		query.append("UNION ALL 	## (3)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",VSL_LANE_CD" ).append("\n"); 
		query.append(",LST_PORT" ).append("\n"); 
		query.append(",VVD" ).append("\n"); 
		query.append(",TRADE" ).append("\n"); 
		query.append(",SUM(0) LOFUL_20" ).append("\n"); 
		query.append(",SUM(0) LOFUL_40" ).append("\n"); 
		query.append(",SUM(0) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(0) LOFUL_45" ).append("\n"); 
		query.append(",SUM(0) LOEMP_20" ).append("\n"); 
		query.append(",SUM(0) LOEMP_40" ).append("\n"); 
		query.append(",SUM(0) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(0) LOEMP_45" ).append("\n"); 
		query.append("##project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_FULL , 0)) DCFUL_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_FULL , 0)) DCFUL_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_FULL , 0)) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D7', CNTR_QTY_FULL , 0)) DCFUL_45" ).append("\n"); 
		query.append(",SUM(0) DCEMP_20" ).append("\n"); 
		query.append(",SUM(0) DCEMP_40" ).append("\n"); 
		query.append(",SUM(0) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(0) DCEMP_45" ).append("\n"); 
		query.append(",SUM(0) CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(0) CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SUM(CNTR_QTY_TEU_DCFULL) CNTR_TEU_DCFUL" ).append("\n"); 
		query.append(",SUM(0)                   CNTR_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(PL.TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD		    CO_CD" ).append("\n"); 
		query.append(",CM.TRD_CD		  	TRADE" ).append("\n"); 
		query.append(",PL.VSL_LANE_CD  	VSL_LANE_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.TO_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD  VVD" ).append("\n"); 
		query.append(",CM.LST_LODG_PORT_CD LST_PORT" ).append("\n"); 
		query.append(",BC.CNTR_TPSZ_CD  	CNTR_TPSZ_CD_FULL" ).append("\n"); 
		query.append(",BC.CNTR_VOL_QTY	CNTR_QTY_FULL" ).append("\n"); 
		query.append(",DECODE(BC.CNTR_TPSZ_CD , 'D2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'R2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'O2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'F2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'O4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append("##               project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'A4',  BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S4',  BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'R5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D7', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))  ,    0" ).append("\n"); 
		query.append(") CNTR_QTY_TEU_DCFULL" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("BKG_BOOKING BK" ).append("\n"); 
		query.append(", BKG_VVD BV" ).append("\n"); 
		query.append(", BKG_CONTAINER BC" ).append("\n"); 
		query.append(", COA_MON_VVD CM" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT VSL_CD" ).append("\n"); 
		query.append(", SKD_VOY_NO" ).append("\n"); 
		query.append(", SKD_DIR_CD" ).append("\n"); 
		query.append(", TO_YD_CD" ).append("\n"); 
		query.append(", TO_ETB_DT" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_ETB_DT BETWEEN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")    PL" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD = CM.VSL_CD||CM.SKD_VOY_NO||CM.DIR_CD" ).append("\n"); 
		query.append("AND CM.DELT_FLG = 'N'" ).append("\n"); 
		query.append("AND PL.VSL_LANE_CD = CM.SLAN_CD" ).append("\n"); 
		query.append("#if(${locOrTrade} == '2' || ( ${locOrTrade} == '1' && ${byLocation} == 'P') )" ).append("\n"); 
		query.append("#if(${vslSlanCd} != '')" ).append("\n"); 
		query.append("AND CM.SLAN_CD IN( ${arrVslSlanCdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD IN( ${arrVvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("## to loc 검색조건" ).append("\n"); 
		query.append("#if(${atStatus} != ''  && ${atLocation} != '')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${report} == 'R')" ).append("\n"); 
		query.append("AND PL.TO_YD_CD IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#elseif(${report} == 'P')" ).append("\n"); 
		query.append("AND SUBSTR(PL.TO_YD_CD,1,5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("${toEccArrStr}" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND BK.BKG_NO = BV.BKG_NO" ).append("\n"); 
		query.append("AND BK.BKG_NO = BC.BKG_NO" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BV.BKG_NO_SPLIT" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BC.BKG_NO_SPLIT" ).append("\n"); 
		query.append("AND BK.BKG_CGO_TP_CD = 'F'" ).append("\n"); 
		query.append("AND BV.VSL_CD = PL.VSL_CD" ).append("\n"); 
		query.append("AND BV.SKD_VOY_NO = PL.SKD_VOY_NO" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD = PL.SKD_DIR_CD" ).append("\n"); 
		query.append("AND BV.POD_CD = SUBSTR(PL.TO_YD_CD,0,5) 	## DISCHARGING" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD" ).append("\n"); 
		query.append(", TRADE" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append(", LST_PORT" ).append("\n"); 
		query.append("UNION ALL 	 ## (4)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",VSL_LANE_CD" ).append("\n"); 
		query.append(",LST_PORT" ).append("\n"); 
		query.append(",VVD" ).append("\n"); 
		query.append(",TRADE" ).append("\n"); 
		query.append(",SUM(0) LOFUL_20" ).append("\n"); 
		query.append(",SUM(0) LOFUL_40" ).append("\n"); 
		query.append(",SUM(0) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(0) LOFUL_45" ).append("\n"); 
		query.append(",SUM(0) LOEMP_20" ).append("\n"); 
		query.append(",SUM(0) LOEMP_40" ).append("\n"); 
		query.append(",SUM(0) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(0) LOEMP_45" ).append("\n"); 
		query.append(",SUM(0) DCFUL_20" ).append("\n"); 
		query.append(",SUM(0) DCFUL_40" ).append("\n"); 
		query.append(",SUM(0) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(0) DCFUL_45" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_EMP , 0)) DCEMP_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_EMP" ).append("\n"); 
		query.append("##				project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_EMP , 0)) DCEMP_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_EMP , 0)) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D7', CNTR_QTY_EMP , 0)) DCEMP_45" ).append("\n"); 
		query.append(",SUM(0) CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(0) CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SUM(0) CNTR_TEU_DCFUL" ).append("\n"); 
		query.append(",SUM(CNTR_QTY_TEU_DCEMP) CNTR_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(PL.TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD		    CO_CD" ).append("\n"); 
		query.append(",CM.TRD_CD  		TRADE" ).append("\n"); 
		query.append(",PL.VSL_LANE_CD  	VSL_LANE_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.TO_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD  VVD" ).append("\n"); 
		query.append(",CM.LST_LODG_PORT_CD LST_PORT" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD  	CNTR_TPSZ_CD_EMP" ).append("\n"); 
		query.append(",Q.CNTR_QTY  		CNTR_QTY_EMP" ).append("\n"); 
		query.append(",DECODE(Q.CNTR_TPSZ_CD , 'D2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'R2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'O2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'F2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'O4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append("##				project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'A4',  Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S4',  Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'R5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D7', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))  ,    0" ).append("\n"); 
		query.append(") CNTR_QTY_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN PL" ).append("\n"); 
		query.append(", EQR_VSL_EXE_PLN_QTY Q" ).append("\n"); 
		query.append(", COA_MON_VVD CM" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PL.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PL.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND PL.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND PL.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND PL.TO_ETB_DT BETWEEN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD = CM.VSL_CD||CM.SKD_VOY_NO||CM.DIR_CD" ).append("\n"); 
		query.append("AND CM.DELT_FLG = 'N'" ).append("\n"); 
		query.append("AND PL.VSL_LANE_CD = CM.SLAN_CD" ).append("\n"); 
		query.append("#if(${locOrTrade} == '2' || ( ${locOrTrade} == '1' && ${byLocation} == 'P') )" ).append("\n"); 
		query.append("#if(${vslSlanCd} != '')" ).append("\n"); 
		query.append("AND CM.SLAN_CD IN( ${arrVslSlanCdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD IN( ${arrVvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("## to loc 검색조건" ).append("\n"); 
		query.append("#if(${atStatus} != ''  && ${atLocation} != '')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${report} == 'R')" ).append("\n"); 
		query.append("AND PL.TO_YD_CD IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#elseif(${report} == 'P')" ).append("\n"); 
		query.append("AND SUBSTR(PL.TO_YD_CD,1,5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("${toEccArrStr}" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD" ).append("\n"); 
		query.append(", TRADE" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append(", LST_PORT" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1' && ${byLocation} == 'P')" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD" ).append("\n"); 
		query.append(", TRADE" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", VVD" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", TRADE" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif(${locOrTrade} == '2')" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD" ).append("\n"); 
		query.append(", TRADE" ).append("\n"); 
		query.append(", LST_PORT" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", VVD" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", TRADE" ).append("\n"); 
		query.append(", LST_PORT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("## ECC 계열 선택일 경우" ).append("\n"); 
		query.append("#if(${report} == 'P')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("''			####B######" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",(SELECT RCC_CD FROM MDM_EQ_ORZ_CHT  WHERE SCC_CD = PORT  ) RCC" ).append("\n"); 
		query.append(",(SELECT LCC_CD FROM MDM_EQ_ORZ_CHT  WHERE SCC_CD = PORT  ) LCC" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT  WHERE SCC_CD = PORT  ) ECC" ).append("\n"); 
		query.append(",SUM(LOFUL_20) LOFUL_20" ).append("\n"); 
		query.append(",SUM(LOFUL_40) LOFUL_40" ).append("\n"); 
		query.append(",SUM(LOFUL_HC) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(LOFUL_45) LOFUL_45" ).append("\n"); 
		query.append(",SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45) LOFUL_TTL" ).append("\n"); 
		query.append(",SUM(LOEMP_20) LOEMP_20" ).append("\n"); 
		query.append(",SUM(LOEMP_40) LOEMP_40" ).append("\n"); 
		query.append(",SUM(LOEMP_HC) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(LOEMP_45) LOEMP_45" ).append("\n"); 
		query.append(",SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) LOEMP_TTL" ).append("\n"); 
		query.append(",SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45" ).append("\n"); 
		query.append("+ LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45)   LO_TOTAL" ).append("\n"); 
		query.append(",SUM(CNTR_TEU_LOFUL+CNTR_TEU_LOEMP)    LO_TEU" ).append("\n"); 
		query.append(",SUM(DCFUL_20) DCFUL_20" ).append("\n"); 
		query.append(",SUM(DCFUL_40) DCFUL_40" ).append("\n"); 
		query.append(",SUM(DCFUL_HC) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(DCFUL_45) DCFUL_45" ).append("\n"); 
		query.append(",SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45) DCFUL_TTL" ).append("\n"); 
		query.append(",SUM(DCEMP_20) DCEMP_20" ).append("\n"); 
		query.append(",SUM(DCEMP_40) DCEMP_40" ).append("\n"); 
		query.append(",SUM(DCEMP_HC) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(DCEMP_45) DCEMP_45" ).append("\n"); 
		query.append(",SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45) DCEMP_TTL" ).append("\n"); 
		query.append(",SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45" ).append("\n"); 
		query.append("+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)    DC_TOTAL" ).append("\n"); 
		query.append(",SUM(CNTR_TEU_DCFUL+CNTR_TEU_DCEMP)    DC_TEU" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOFUL_20) = SUM(DCFUL_20)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_20) = 0  AND SUM(DCFUL_20) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_20) > SUM(DCFUL_20)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND((SUM(DCFUL_20) / SUM(LOFUL_20)) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOFUL_20) /  SUM(DCFUL_20)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATFUL20" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOFUL_40) = SUM(DCFUL_40)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_40) = 0  AND SUM(LOFUL_40) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_40) > SUM(DCFUL_40)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND((SUM(DCFUL_40) / SUM(LOFUL_40)) *100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOFUL_40) /  SUM(DCFUL_40)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATFUL40" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOFUL_HC) = SUM(DCFUL_HC)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_HC) = 0  AND SUM(DCFUL_HC) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_HC) > SUM(DCFUL_HC)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND((SUM(DCFUL_HC) / SUM(LOFUL_HC))*100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOFUL_HC) / SUM(DCFUL_HC)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATFULHC" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOFUL_45) = SUM(DCFUL_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_45) = 0  AND SUM(DCFUL_45) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_45) > SUM(DCFUL_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND((SUM(DCFUL_45) / SUM(LOFUL_45)) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOFUL_45) / SUM(DCFUL_45)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATFUL45" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45) = SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45) = 0  AND SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45) > SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND((SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45) / SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45)) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45) / SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATFULTTL" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOEMP_20) = SUM(DCEMP_20)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_20) = 0  AND SUM(DCEMP_20) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_20) > SUM(DCEMP_20)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND((SUM(DCEMP_20) / SUM(LOEMP_20)) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOEMP_20) /  SUM(DCEMP_20)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATEMP20" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOEMP_40) = SUM(DCEMP_40)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_40) = 0  AND SUM(DCEMP_40) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_40) > SUM(DCEMP_40)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND((SUM(DCEMP_40) / SUM(LOEMP_40)) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOEMP_40) /  SUM(DCEMP_40)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATEMP40" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOEMP_HC) = SUM(DCEMP_HC)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_HC) = 0  AND SUM(DCEMP_HC) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_HC) > SUM(DCEMP_HC)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND((SUM(DCEMP_HC) / SUM(LOEMP_HC)) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOEMP_HC) / SUM(DCEMP_HC)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATEMPHC" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOEMP_45) = SUM(DCEMP_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_45) = 0  AND SUM(DCEMP_45) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_45) > SUM(DCEMP_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND((SUM(DCEMP_45) / SUM(LOEMP_45)) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOEMP_45) / SUM(DCEMP_45)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATEMP45" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) = SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) = 0  AND SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) > SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND((SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45) / SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45)) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) / SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)) * 100 ,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATEMPTTL" ).append("\n"); 
		query.append(",CASE WHEN SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45 + LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) = SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45	+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45 + LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) = 0  AND SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45	+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45 + LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) > SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45	+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45) / SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45 + LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) *100 ,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45 + LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) / SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATBOXTOTAL" ).append("\n"); 
		query.append(",CASE WHEN SUM(CNTR_TEU_LOFUL+CNTR_TEU_LOEMP) = SUM(CNTR_TEU_DCFUL+CNTR_TEU_DCEMP)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("CASE WHEN SUM(CNTR_TEU_LOFUL+CNTR_TEU_LOEMP) = 0  AND SUM(CNTR_TEU_DCFUL+CNTR_TEU_DCEMP) = 0" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("0" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("1" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("CASE WHEN SUM(CNTR_TEU_LOFUL+CNTR_TEU_LOEMP) > SUM(CNTR_TEU_DCFUL+CNTR_TEU_DCEMP)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("ROUND(SUM(CNTR_TEU_DCFUL+CNTR_TEU_DCEMP) / SUM(CNTR_TEU_LOFUL+CNTR_TEU_LOEMP) *100 ,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("-ROUND((SUM(CNTR_TEU_LOFUL+CNTR_TEU_LOEMP) / SUM(CNTR_TEU_DCFUL+CNTR_TEU_DCEMP)) * 100,1)" ).append("\n"); 
		query.append("END" ).append("\n"); 
		query.append("END   MATTEUTOTAL" ).append("\n"); 
		query.append(",''" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("## (1)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append("##project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_FULL , 0)) LOFUL_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_FULL , 0)) LOFUL_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_FULL , 0)) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D7', CNTR_QTY_FULL , 0)) LOFUL_45" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",SUM(0) LOEMP_20" ).append("\n"); 
		query.append(",SUM(0) LOEMP_40" ).append("\n"); 
		query.append(",SUM(0) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(0) LOEMP_45" ).append("\n"); 
		query.append(",SUM(0) DCFUL_20" ).append("\n"); 
		query.append(",SUM(0) DCFUL_40" ).append("\n"); 
		query.append(",SUM(0) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(0) DCFUL_45" ).append("\n"); 
		query.append(",SUM(0) DCEMP_20" ).append("\n"); 
		query.append(",SUM(0) DCEMP_40" ).append("\n"); 
		query.append(",SUM(0) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(0) DCEMP_45" ).append("\n"); 
		query.append(",SUM(CNTR_QTY_TEU_LOFULL) CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(0)                  CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SUM(0)                  CNTR_TEU_DCFUL" ).append("\n"); 
		query.append(",SUM(0)                  CNTR_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(PL.FM_ETD_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD		    CO_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.FM_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",BC.CNTR_TPSZ_CD  	CNTR_TPSZ_CD_FULL" ).append("\n"); 
		query.append(",BC.CNTR_VOL_QTY	CNTR_QTY_FULL" ).append("\n"); 
		query.append(",DECODE(BC.CNTR_TPSZ_CD , 'D2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'R2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'O2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'F2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'O4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append("##project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'A4',  BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S4',  BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'R5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D7', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))  ,    0) CNTR_QTY_TEU_LOFULL" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("BKG_BOOKING BK" ).append("\n"); 
		query.append(", BKG_VVD BV" ).append("\n"); 
		query.append(", BKG_CONTAINER BC" ).append("\n"); 
		query.append(", (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT VSL_CD" ).append("\n"); 
		query.append(", SKD_VOY_NO" ).append("\n"); 
		query.append(", SKD_DIR_CD" ).append("\n"); 
		query.append(", FM_YD_CD" ).append("\n"); 
		query.append(", FM_ETD_DT" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("FM_ETD_DT BETWEEN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")    PL" ).append("\n"); 
		query.append("WHERE 1=1" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("## from loc 검색조건" ).append("\n"); 
		query.append("#if(${atStatus} != ''  && ${atLocation} != '')" ).append("\n"); 
		query.append("#if(${report} == 'R')" ).append("\n"); 
		query.append("AND PL.FM_YD_CD IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#elseif(${report} == 'P')" ).append("\n"); 
		query.append("AND SUBSTR(PL.FM_YD_CD,1,5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("${fromEccArrStr}" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND BK.BKG_NO = BV.BKG_NO" ).append("\n"); 
		query.append("AND BK.BKG_NO = BC.BKG_NO" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BV.BKG_NO_SPLIT" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BC.BKG_NO_SPLIT" ).append("\n"); 
		query.append("AND BK.BKG_CGO_TP_CD = 'F'" ).append("\n"); 
		query.append("AND BV.VSL_CD = PL.VSL_CD" ).append("\n"); 
		query.append("AND BV.SKD_VOY_NO = PL.SKD_VOY_NO" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD = PL.SKD_DIR_CD" ).append("\n"); 
		query.append("AND BV.POL_CD = SUBSTR(PL.FM_YD_CD,0,5) 	## LOADING" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(",  PORT" ).append("\n"); 
		query.append("UNION ALL 	## (2)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",SUM(0) LOFUL_20" ).append("\n"); 
		query.append(",SUM(0) LOFUL_40" ).append("\n"); 
		query.append(",SUM(0) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(0) LOFUL_45" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_EMP , 0)) LOEMP_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_EMP" ).append("\n"); 
		query.append("##    				project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_EMP , 0)) LOEMP_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_EMP , 0)) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D7', CNTR_QTY_EMP , 0)) LOEMP_45" ).append("\n"); 
		query.append(",SUM(0) DCFUL_20" ).append("\n"); 
		query.append(",SUM(0) DCFUL_40" ).append("\n"); 
		query.append(",SUM(0) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(0) DCFUL_45" ).append("\n"); 
		query.append(",SUM(0) DCEMP_20" ).append("\n"); 
		query.append(",SUM(0) DCEMP_40" ).append("\n"); 
		query.append(",SUM(0) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(0) DCEMP_45" ).append("\n"); 
		query.append(",SUM(0) CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(CNTR_QTY_TEU_DCEMP) CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SUM(0)                  CNTR_TEU_DCFUL" ).append("\n"); 
		query.append(",SUM(0)                  CNTR_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(PL.FM_ETD_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD			CO_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.FM_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD   	CNTR_TPSZ_CD_EMP" ).append("\n"); 
		query.append(",Q.CNTR_QTY  		CNTR_QTY_EMP" ).append("\n"); 
		query.append(",DECODE(Q.CNTR_TPSZ_CD , 'D2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'R2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'O2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'F2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A2', Q.CNTR_QTY  * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S2', Q.CNTR_QTY  * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'O4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append("##project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'A4',  Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S4',  Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'R5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D7', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))  ,    0) CNTR_QTY_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN PL" ).append("\n"); 
		query.append(", EQR_VSL_EXE_PLN_QTY Q" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PL.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PL.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND PL.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND PL.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND PL.FM_ETD_DT BETWEEN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE PLN_YR || PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#if(${locOrTrade} == '2' || ( ${locOrTrade} == '1' && ${byLocation} == 'P') ) ## 사용되지 않음 로직상 구현되지 않음" ).append("\n"); 
		query.append("#if(${vslSlanCd} != '')" ).append("\n"); 
		query.append("AND CM.SLAN_CD IN( ${arrVslSlanCdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD IN( ${arrVvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')	## 사용되지 않음 로직상 구현되지 않음" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("## from loc 검색조건" ).append("\n"); 
		query.append("#if(${atStatus} != ''  && ${atLocation} != '')" ).append("\n"); 
		query.append("#if(${report} == 'R')" ).append("\n"); 
		query.append("AND PL.FM_YD_CD IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#elseif(${report} == 'P')" ).append("\n"); 
		query.append("AND SUBSTR(PL.FM_YD_CD,1,5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("${fromEccArrStr}" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(",  PORT" ).append("\n"); 
		query.append("UNION ALL 	## (3)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",SUM(0) LOFUL_20" ).append("\n"); 
		query.append(",SUM(0) LOFUL_40" ).append("\n"); 
		query.append(",SUM(0) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(0) LOFUL_45" ).append("\n"); 
		query.append(",SUM(0) LOEMP_20" ).append("\n"); 
		query.append(",SUM(0) LOEMP_40" ).append("\n"); 
		query.append(",SUM(0) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(0) LOEMP_45" ).append("\n"); 
		query.append("##project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_FULL , 0)) DCFUL_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_FULL , 0)) DCFUL_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_FULL , 0)) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D7', CNTR_QTY_FULL , 0)) DCFUL_45" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",SUM(0) DCEMP_20" ).append("\n"); 
		query.append(",SUM(0) DCEMP_40" ).append("\n"); 
		query.append(",SUM(0) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(0) DCEMP_45" ).append("\n"); 
		query.append(",SUM(0) CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(0) CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SUM(CNTR_QTY_TEU_DCFULL) CNTR_TEU_DCFUL" ).append("\n"); 
		query.append(",SUM(0)                   CNTR_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(PL.TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD		    CO_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.TO_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",BC.CNTR_TPSZ_CD  	CNTR_TPSZ_CD_FULL" ).append("\n"); 
		query.append(",BC.CNTR_VOL_QTY	CNTR_QTY_FULL" ).append("\n"); 
		query.append(",DECODE(BC.CNTR_TPSZ_CD , 'D2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'R2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'O2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'F2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A2', BC.CNTR_VOL_QTY  * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S2', BC.CNTR_VOL_QTY  * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'O4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F4',  BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append("##project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5',  BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A4',  BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'R5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D7', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))  ,    0) CNTR_QTY_TEU_DCFULL" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("BKG_BOOKING BK" ).append("\n"); 
		query.append(", BKG_VVD BV" ).append("\n"); 
		query.append(", BKG_CONTAINER BC" ).append("\n"); 
		query.append("," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT  VSL_CD" ).append("\n"); 
		query.append(",SKD_VOY_NO" ).append("\n"); 
		query.append(", SKD_DIR_CD" ).append("\n"); 
		query.append(", TO_YD_CD" ).append("\n"); 
		query.append(", TO_ETB_DT" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_ETB_DT BETWEEN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")    PL" ).append("\n"); 
		query.append("WHERE 1=1" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("## to loc 검색조건" ).append("\n"); 
		query.append("#if(${atStatus} != ''  && ${atLocation} != '')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${report} == 'R')" ).append("\n"); 
		query.append("AND PL.TO_YD_CD IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#elseif(${report} == 'P')" ).append("\n"); 
		query.append("AND SUBSTR(PL.TO_YD_CD,1,5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("${toEccArrStr}" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND BK.BKG_NO = BV.BKG_NO" ).append("\n"); 
		query.append("AND BK.BKG_NO = BC.BKG_NO" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BV.BKG_NO_SPLIT" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BC.BKG_NO_SPLIT" ).append("\n"); 
		query.append("AND BK.BKG_CGO_TP_CD = 'F'" ).append("\n"); 
		query.append("AND BV.VSL_CD = PL.VSL_CD" ).append("\n"); 
		query.append("AND BV.SKD_VOY_NO = PL.SKD_VOY_NO" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD = PL.SKD_DIR_CD" ).append("\n"); 
		query.append("AND BV.POD_CD = SUBSTR(PL.TO_YD_CD,0,5) 	## DISCHARGING" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(",  PORT" ).append("\n"); 
		query.append("UNION ALL 	 ## (4)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",SUM(0) LOFUL_20" ).append("\n"); 
		query.append(",SUM(0) LOFUL_40" ).append("\n"); 
		query.append(",SUM(0) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(0) LOFUL_45" ).append("\n"); 
		query.append(",SUM(0) LOEMP_20" ).append("\n"); 
		query.append(",SUM(0) LOEMP_40" ).append("\n"); 
		query.append(",SUM(0) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(0) LOEMP_45" ).append("\n"); 
		query.append(",SUM(0) DCFUL_20" ).append("\n"); 
		query.append(",SUM(0) DCFUL_40" ).append("\n"); 
		query.append(",SUM(0) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(0) DCFUL_45" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_EMP , 0)) DCEMP_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_EMP" ).append("\n"); 
		query.append("##    				project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_EMP , 0)) DCEMP_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_EMP , 0)) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D7', CNTR_QTY_EMP , 0)) DCEMP_45" ).append("\n"); 
		query.append(",SUM(0) CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(0) CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SUM(0) CNTR_TEU_DCFUL" ).append("\n"); 
		query.append(",SUM(CNTR_QTY_TEU_DCEMP) CNTR_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(PL.TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD		    CO_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.TO_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD  	CNTR_TPSZ_CD_EMP" ).append("\n"); 
		query.append(",Q.CNTR_QTY  		CNTR_QTY_EMP" ).append("\n"); 
		query.append(",DECODE(Q.CNTR_TPSZ_CD , 'D2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'R2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'O2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'F2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'O4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append("##project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'A4',  Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S4',  Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'R5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D7', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))  ,    0) CNTR_QTY_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN PL" ).append("\n"); 
		query.append(", EQR_VSL_EXE_PLN_QTY Q" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PL.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PL.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND PL.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND PL.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND PL.TO_ETB_DT BETWEEN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#if(${locOrTrade} == '2' || ( ${locOrTrade} == '1' && ${byLocation} == 'P') )" ).append("\n"); 
		query.append("#if(${vslSlanCd} != '')  ## 사용하지 않음" ).append("\n"); 
		query.append("AND CM.SLAN_CD IN( ${arrVslSlanCdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD IN( ${arrVvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')	## 사용하지 않음 로직상 구현되지 않음" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("## to loc 검색조건" ).append("\n"); 
		query.append("#if(${atStatus} != ''  && ${atLocation} != '')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${report} == 'R')" ).append("\n"); 
		query.append("AND PL.TO_YD_CD IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#elseif(${report} == 'P')" ).append("\n"); 
		query.append("AND SUBSTR(PL.TO_YD_CD,1,5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("${toEccArrStr}" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(",  PORT" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${report} == 'R')     	## 현재 로직을 수행하지 않음 report P 로 고정되어 있음 R 인 경우 기존로직에 에러 발생함" ).append("\n"); 
		query.append("SELECT 					######C######" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",VSL_LANE_CD" ).append("\n"); 
		query.append(",VVD" ).append("\n"); 
		query.append(",TRADE" ).append("\n"); 
		query.append(",SUM(LOFUL_20) LOFUL_20" ).append("\n"); 
		query.append(",SUM(LOFUL_40) LOFUL_40" ).append("\n"); 
		query.append(",SUM(LOFUL_HC) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(LOFUL_45) LOFUL_45" ).append("\n"); 
		query.append(",SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45) LOFUL_TTL" ).append("\n"); 
		query.append(",SUM(LOEMP_20) LOEMP_20" ).append("\n"); 
		query.append(",SUM(LOEMP_40) LOEMP_40" ).append("\n"); 
		query.append(",SUM(LOEMP_HC) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(LOEMP_45) LOEMP_45" ).append("\n"); 
		query.append(",SUM(LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45) LOEMP_TTL" ).append("\n"); 
		query.append(",SUM(LOFUL_20 + LOFUL_40 + LOFUL_HC + LOFUL_45" ).append("\n"); 
		query.append("+ LOEMP_20 + LOEMP_40 + LOEMP_HC + LOEMP_45)   LO_TOTAL" ).append("\n"); 
		query.append(",''" ).append("\n"); 
		query.append(",SUM(DCFUL_20) DCFUL_20" ).append("\n"); 
		query.append(",SUM(DCFUL_40) DCFUL_40" ).append("\n"); 
		query.append(",SUM(DCFUL_HC) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(DCFUL_45) DCFUL_45" ).append("\n"); 
		query.append(",SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45) DCFUL_TTL" ).append("\n"); 
		query.append(",SUM(DCEMP_20) DCEMP_20" ).append("\n"); 
		query.append(",SUM(DCEMP_40) DCEMP_40" ).append("\n"); 
		query.append(",SUM(DCEMP_HC) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(DCEMP_45) DCEMP_45" ).append("\n"); 
		query.append(",SUM(DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45) DCEMP_TTL" ).append("\n"); 
		query.append(",SUM(DCFUL_20 + DCFUL_40 + DCFUL_HC + DCFUL_45" ).append("\n"); 
		query.append("+ DCEMP_20 + DCEMP_40 + DCEMP_HC + DCEMP_45)    DC_TOTAL" ).append("\n"); 
		query.append(",''" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("## (1)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",VSL_LANE_CD" ).append("\n"); 
		query.append(",VVD" ).append("\n"); 
		query.append(",TRADE" ).append("\n"); 
		query.append("##project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_FULL , 0)) LOFUL_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_FULL , 0)) LOFUL_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_FULL , 0)) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D7', CNTR_QTY_FULL , 0)) LOFUL_45" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",SUM(0) LOEMP_20" ).append("\n"); 
		query.append(",SUM(0) LOEMP_40" ).append("\n"); 
		query.append(",SUM(0) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(0) LOEMP_45" ).append("\n"); 
		query.append(",SUM(0) DCFUL_20" ).append("\n"); 
		query.append(",SUM(0) DCFUL_40" ).append("\n"); 
		query.append(",SUM(0) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(0) DCFUL_45" ).append("\n"); 
		query.append(",SUM(0) DCEMP_20" ).append("\n"); 
		query.append(",SUM(0) DCEMP_40" ).append("\n"); 
		query.append(",SUM(0) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(0) DCEMP_45" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(PL.FM_ETD_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD		    CO_CD" ).append("\n"); 
		query.append(",ML.REP_TRD_CD  	TRADE" ).append("\n"); 
		query.append(",PL.VSL_LANE_CD  	VSL_LANE_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.FM_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD  VVD" ).append("\n"); 
		query.append(",PL.CNTR_TPSZ_CD   	CNTR_TPSZ_CD_EMP" ).append("\n"); 
		query.append(",PL.CNTR_QTY  		CNTR_QTY_EMP" ).append("\n"); 
		query.append(",BC.CNTR_TPSZ_CD  	CNTR_TPSZ_CD_FULL" ).append("\n"); 
		query.append(",BC.CNTR_VOL_QTY	CNTR_QTY_FULL" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("BKG_BOOKING BK" ).append("\n"); 
		query.append(", BKG_VVD BV" ).append("\n"); 
		query.append(", BKG_CONTAINER BC" ).append("\n"); 
		query.append(", COA_MON_VVD CM" ).append("\n"); 
		query.append(", MDM_REV_LANE ML ## 구문 오류 수정 AS-IS 에는 빠져 있음 09.10.06 modify by ChungEunHo" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT A.VSL_CD" ).append("\n"); 
		query.append(", A.SKD_VOY_NO" ).append("\n"); 
		query.append(", A.SKD_DIR_CD" ).append("\n"); 
		query.append(", A.FM_YD_CD" ).append("\n"); 
		query.append(", A.FM_ETD_DT" ).append("\n"); 
		query.append(", A.VSL_LANE_CD" ).append("\n"); 
		query.append(", A.CO_CD" ).append("\n"); 
		query.append(", Q.CNTR_QTY" ).append("\n"); 
		query.append(", Q.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN A" ).append("\n"); 
		query.append(",EQR_VSL_EXE_PLN_QTY Q" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND A.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND A.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND A.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND A.FM_ETD_DT BETWEEN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")    PL" ).append("\n"); 
		query.append("WHERE 1=1 ## AS-IS 구문오류 구문 추가 09.10.05 Add By ChungEunHo 로직상 현재 구문을 타지 않음" ).append("\n"); 
		query.append("AND PL.VSL_LANE_CD = ML.VSL_SLAN_CD" ).append("\n"); 
		query.append("#if(${locOrTrade} == '2' || ( ${locOrTrade} == '1' && ${byLocation} == 'P') )" ).append("\n"); 
		query.append("#if(${vslSlanCd} != '')" ).append("\n"); 
		query.append("AND CM.SLAN_CD IN( ${arrVslSlanCdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD IN( ${arrVvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("## from loc 검색조건" ).append("\n"); 
		query.append("#if(${atStatus} != ''  && ${atLocation} != '')" ).append("\n"); 
		query.append("#if(${report} == 'R')" ).append("\n"); 
		query.append("AND PL.FM_YD_CD IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#elseif(${report} == 'P')" ).append("\n"); 
		query.append("AND SUBSTR(PL.FM_YD_CD,1,5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("${fromEccArrStr}" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND BK.BKG_NO = BV.BKG_NO" ).append("\n"); 
		query.append("AND BK.BKG_NO = BC.BKG_NO" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BV.BKG_NO_SPLIT" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BC.BKG_NO_SPLIT" ).append("\n"); 
		query.append("AND BK.BKG_CGO_TP_CD = 'F'" ).append("\n"); 
		query.append("AND BV.VSL_CD = PL.VSL_CD" ).append("\n"); 
		query.append("AND BV.SKD_VOY_NO = PL.SKD_VOY_NO" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD = PL.SKD_DIR_CD" ).append("\n"); 
		query.append("AND BV.POL_CD = (SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(PL.FM_YD_CD,0,5) AND DELT_FLG = 'N') 	## LOADING" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD" ).append("\n"); 
		query.append(", TRADE" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append("UNION 	## (2)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",VSL_LANE_CD" ).append("\n"); 
		query.append(",VVD" ).append("\n"); 
		query.append(",TRADE" ).append("\n"); 
		query.append(",SUM(0) LOFUL_20" ).append("\n"); 
		query.append(",SUM(0) LOFUL_40" ).append("\n"); 
		query.append(",SUM(0) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(0) LOFUL_45" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_EMP , 0)" ).append("\n"); 
		query.append(") LOEMP_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_EMP" ).append("\n"); 
		query.append("##    				project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_EMP , 0)" ).append("\n"); 
		query.append(") LOEMP_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_EMP , 0)) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D7', CNTR_QTY_EMP , 0)) LOEMP_45" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",SUM(0) DCFUL_20" ).append("\n"); 
		query.append(",SUM(0) DCFUL_40" ).append("\n"); 
		query.append(",SUM(0) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(0) DCFUL_45" ).append("\n"); 
		query.append(",SUM(0) DCEMP_20" ).append("\n"); 
		query.append(",SUM(0) DCEMP_40" ).append("\n"); 
		query.append(",SUM(0) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(0) DCEMP_45" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(PL.FM_ETD_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD			CO_CD" ).append("\n"); 
		query.append(",ML.REP_TRD_CD  	TRADE" ).append("\n"); 
		query.append(",PL.VSL_LANE_CD  	VSL_LANE_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.FM_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD  VVD" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD   	CNTR_TPSZ_CD_EMP" ).append("\n"); 
		query.append(",Q.CNTR_QTY  		CNTR_QTY_EMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN PL" ).append("\n"); 
		query.append(", EQR_VSL_EXE_PLN_QTY Q" ).append("\n"); 
		query.append(", MDM_REV_LANE ML" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PL.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PL.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND PL.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND PL.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND PL.FM_ETD_DT BETWEEN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND PL.VSL_LANE_CD = ML.VSL_SLAN_CD" ).append("\n"); 
		query.append("#if(${locOrTrade} == '2' || ( ${locOrTrade} == '1' && ${byLocation} == 'P') ) ## 사용되지 않음 로직상 구현되지 않음" ).append("\n"); 
		query.append("#if(${vslSlanCd} != '')" ).append("\n"); 
		query.append("AND CM.SLAN_CD IN( ${arrVslSlanCdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD IN( ${arrVvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')	## 사용되지 않음 로직상 구현되지 않음" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("## from loc 검색조건" ).append("\n"); 
		query.append("#if(${atStatus} != ''  && ${atLocation} != '')" ).append("\n"); 
		query.append("#if(${report} == 'R')" ).append("\n"); 
		query.append("AND PL.FM_YD_CD IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#elseif(${report} == 'P')" ).append("\n"); 
		query.append("AND SUBSTR(PL.FM_YD_CD,1,5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("${fromEccArrStr}" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD" ).append("\n"); 
		query.append(", TRADE" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append("UNION 	## (3)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",VSL_LANE_CD" ).append("\n"); 
		query.append(",VVD" ).append("\n"); 
		query.append(",TRADE" ).append("\n"); 
		query.append(",SUM(0) LOFUL_20" ).append("\n"); 
		query.append(",SUM(0) LOFUL_40" ).append("\n"); 
		query.append(",SUM(0) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(0) LOFUL_45" ).append("\n"); 
		query.append(",SUM(0) LOEMP_20" ).append("\n"); 
		query.append(",SUM(0) LOEMP_40" ).append("\n"); 
		query.append(",SUM(0) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(0) LOEMP_45" ).append("\n"); 
		query.append("##project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_FULL , 0)) DCFUL_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_FULL , 0)) DCFUL_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_FULL , 0)) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL , 'D7', CNTR_QTY_FULL , 0)) DCFUL_45" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(",SUM(0) DCEMP_20" ).append("\n"); 
		query.append(",SUM(0) DCEMP_40" ).append("\n"); 
		query.append(",SUM(0) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(0) DCEMP_45" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(PL.TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD		    CO_CD" ).append("\n"); 
		query.append(",ML.REP_TRD_CD  	TRADE" ).append("\n"); 
		query.append(",PL.VSL_LANE_CD  	VSL_LANE_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.TO_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD  VVD" ).append("\n"); 
		query.append(",PL.CNTR_TPSZ_CD  	CNTR_TPSZ_CD_EMP" ).append("\n"); 
		query.append(",PL.CNTR_QTY  		CNTR_QTY_EMP" ).append("\n"); 
		query.append(",BC.CNTR_TPSZ_CD  	CNTR_TPSZ_CD_FULL" ).append("\n"); 
		query.append(",BC.CNTR_VOL_QTY	CNTR_QTY_FULL" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("BKG_BOOKING BK" ).append("\n"); 
		query.append(", BKG_VVD BV" ).append("\n"); 
		query.append(", BKG_CONTAINER BC" ).append("\n"); 
		query.append(", COA_MON_VVD CM" ).append("\n"); 
		query.append(", MDM_REV_LANE ML ## 구문 오류 수정 AS-IS 에는 빠져 있음 09.10.06 modify by ChungEunHo" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT A.VSL_CD" ).append("\n"); 
		query.append(", A.SKD_VOY_NO" ).append("\n"); 
		query.append(", A.SKD_DIR_CD" ).append("\n"); 
		query.append(", A.FM_YD_CD" ).append("\n"); 
		query.append(", A.FM_ETD_DT" ).append("\n"); 
		query.append(", A.TO_YD_CD" ).append("\n"); 
		query.append(", A.VSL_LANE_CD" ).append("\n"); 
		query.append(", A.CO_CD" ).append("\n"); 
		query.append(", A.TO_ETB_DT" ).append("\n"); 
		query.append(", Q.CNTR_QTY" ).append("\n"); 
		query.append(", Q.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN A" ).append("\n"); 
		query.append(", EQR_VSL_EXE_PLN_QTY Q" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND A.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND A.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND A.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND TO_ETB_DT BETWEEN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")    PL" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("PL.VSL_LANE_CD = ML.VSL_SLAN_CD" ).append("\n"); 
		query.append("#if(${locOrTrade} == '2' || ( ${locOrTrade} == '1' && ${byLocation} == 'P') )" ).append("\n"); 
		query.append("#if(${vslSlanCd} != '')" ).append("\n"); 
		query.append("AND CM.SLAN_CD IN( ${arrVslSlanCdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD IN( ${arrVvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("## to loc 검색조건" ).append("\n"); 
		query.append("#if(${atStatus} != ''  && ${atLocation} != '')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${report} == 'R')" ).append("\n"); 
		query.append("AND PL.TO_YD_CD IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#elseif(${report} == 'P')" ).append("\n"); 
		query.append("AND SUBSTR(PL.TO_YD_CD,1,5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("${toEccArrStr}" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND BK.BKG_NO = BV.BKG_NO" ).append("\n"); 
		query.append("AND BK.BKG_NO = BC.BKG_NO" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BV.BKG_NO_SPLIT" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BC.BKG_NO_SPLIT" ).append("\n"); 
		query.append("AND BK.BKG_CGO_TP_CD = 'F'" ).append("\n"); 
		query.append("AND BV.VSL_CD = PL.VSL_CD" ).append("\n"); 
		query.append("AND BV.SKD_VOY_NO = PL.SKD_VOY_NO" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD = PL.SKD_DIR_CD" ).append("\n"); 
		query.append("AND BV.POD_CD = (SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(PL.TO_YD_CD,0,5) AND DELT_FLG = 'N') 	## DISCHARGING" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD" ).append("\n"); 
		query.append(", TRADE" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append("UNION 	 ## (4)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",CO_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",VSL_LANE_CD" ).append("\n"); 
		query.append(",VVD" ).append("\n"); 
		query.append(",TRADE" ).append("\n"); 
		query.append(",SUM(0) LOFUL_20" ).append("\n"); 
		query.append(",SUM(0) LOFUL_40" ).append("\n"); 
		query.append(",SUM(0) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(0) LOFUL_45" ).append("\n"); 
		query.append(",SUM(0) LOEMP_20" ).append("\n"); 
		query.append(",SUM(0) LOEMP_40" ).append("\n"); 
		query.append(",SUM(0) LOEMP_HC" ).append("\n"); 
		query.append(",SUM(0) LOEMP_45" ).append("\n"); 
		query.append(",SUM(0) DCFUL_20" ).append("\n"); 
		query.append(",SUM(0) DCFUL_40" ).append("\n"); 
		query.append(",SUM(0) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(0) DCFUL_45" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_EMP , 0)) DCEMP_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_EMP" ).append("\n"); 
		query.append("##    				project_name : 신규 장비(F5-40ft H/C Flat rack) 발주에 따른 NIS 상에 F5 등록" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_EMP , 0)) DCEMP_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_EMP , 0)) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D7', CNTR_QTY_EMP , 0)) DCEMP_45" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(PL.TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD		    CO_CD" ).append("\n"); 
		query.append(",ML.REP_TRD_CD  	TRADE" ).append("\n"); 
		query.append(",PL.VSL_LANE_CD  	VSL_LANE_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.TO_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD  VVD" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD  	CNTR_TPSZ_CD_EMP" ).append("\n"); 
		query.append(",Q.CNTR_QTY  		CNTR_QTY_EMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN PL" ).append("\n"); 
		query.append(", EQR_VSL_EXE_PLN_QTY Q" ).append("\n"); 
		query.append(", MDM_REV_LANE ML" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PL.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PL.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND PL.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND PL.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND PL.TO_ETB_DT BETWEEN" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE PLN_YR || PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR || PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND PL.VSL_LANE_CD = ML.VSL_SLAN_CD" ).append("\n"); 
		query.append("#if(${locOrTrade} == '2' || ( ${locOrTrade} == '1' && ${byLocation} == 'P') ) ## 사용되지 않음 로직상 구현되지 않음" ).append("\n"); 
		query.append("#if(${vslSlanCd} != '')" ).append("\n"); 
		query.append("AND CM.SLAN_CD IN( ${arrVslSlanCdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("AND PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD IN( ${arrVvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')	## 사용되지 않음 로직상 구현되지 않음" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${locOrTrade} == '1')" ).append("\n"); 
		query.append("## to loc 검색조건" ).append("\n"); 
		query.append("#if(${atStatus} != ''  && ${atLocation} != '')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${report} == 'R')" ).append("\n"); 
		query.append("AND PL.TO_YD_CD IN (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#elseif(${report} == 'P')" ).append("\n"); 
		query.append("AND SUBSTR(PL.TO_YD_CD,1,5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1 AND $typeStr IN (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("${toEccArrStr}" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD, TRADE" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", CO_CD" ).append("\n"); 
		query.append(", PORT" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD" ).append("\n"); 
		query.append(", TRADE" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("##  CSRNO : N200806030017 의거 추가  시작" ).append("\n"); 
		query.append("WITH TGT_OUTBOUND AS(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT  '1' LD_DS" ).append("\n"); 
		query.append(", SLAN_CD" ).append("\n"); 
		query.append(", VSL_CD" ).append("\n"); 
		query.append(", SKD_VOY_NO" ).append("\n"); 
		query.append(", SKD_DIR_CD" ).append("\n"); 
		query.append(", FROM_RGN" ).append("\n"); 
		query.append(", TO_RGN" ).append("\n"); 
		query.append(",(ROWNUM)SEQ" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("VPS1.VSL_CD" ).append("\n"); 
		query.append(", VPS1.SKD_VOY_NO" ).append("\n"); 
		query.append(", VPS1.SKD_DIR_CD" ).append("\n"); 
		query.append(", VPS1.VPS_PORT_CD" ).append("\n"); 
		query.append(", VPS1.CLPT_IND_SEQ" ).append("\n"); 
		query.append(", VPS1.CLPT_SEQ" ).append("\n"); 
		query.append(", VPS1.VPS_ETD_DT" ).append("\n"); 
		query.append(", VPS1.SLAN_CD" ).append("\n"); 
		query.append(", MD.TRD_CD" ).append("\n"); 
		query.append(", DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD) FROM_RGN" ).append("\n"); 
		query.append(", SUBSTR(MIN(LPAD(vps2.CLPT_SEQ, 4)||DECODE(cnt2.CONTI_CD, 'F', 'E', CNT2.CONTI_CD)), 5, 1) TO_RGN" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("VSK_VSL_PORT_SKD VPS1" ).append("\n"); 
		query.append(", MDM_LOCATION CNT1" ).append("\n"); 
		query.append(", VSK_VSL_PORT_SKD VPS2" ).append("\n"); 
		query.append(", MDM_LOCATION CNT2" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT VSL_CD" ).append("\n"); 
		query.append(", SKD_VOY_NO" ).append("\n"); 
		query.append(", DIR_CD" ).append("\n"); 
		query.append(",  SLAN_CD" ).append("\n"); 
		query.append(", TRD_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("COA_MON_VVD  ## , MDM_VSL_SVC_LANE_DIR MV" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("DELT_FLG ='N'" ).append("\n"); 
		query.append("AND IOC_CD =  DECODE(TRD_CD,'IAS',DECODE(SUB_TRD_CD,'IA','I','O'), 'IMS', 'I', 'O')" ).append("\n"); 
		query.append("AND IOC_CD ='O'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT VSL_CD" ).append("\n"); 
		query.append(", SKD_VOY_NO" ).append("\n"); 
		query.append(", DIR_CD" ).append("\n"); 
		query.append(",  SLAN_CD" ).append("\n"); 
		query.append(", TRD_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("COA_MON_VVD CV" ).append("\n"); 
		query.append(", MDM_VSL_SVC_LANE_DIR MV" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("CV.DELT_FLG ='N'" ).append("\n"); 
		query.append("AND MV.DELT_FLG='N'" ).append("\n"); 
		query.append("AND CV.SLAN_CD = MV.VSL_SLAN_CD" ).append("\n"); 
		query.append("AND CV.DIR_CD = MV.VSL_SLAN_DIR_CD" ).append("\n"); 
		query.append("AND MV.VSL_SLAN_DIR_SEQ =2" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND IOC_CD =  DECODE(TRD_CD,'IAS',DECODE(SUB_TRD_CD,'IA','I','O'), 'IMS', 'I', 'O')" ).append("\n"); 
		query.append("AND IOC_CD ='I'" ).append("\n"); 
		query.append(") CM" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT SUBSTR(A.RLANE_CD, 1, 3) LANE" ).append("\n"); 
		query.append(", VSL_SLAN_DIR_CD DIR_CD" ).append("\n"); 
		query.append(", FM_CONTI_CD FM_CONTI" ).append("\n"); 
		query.append(", TO_CONTI_CD TO_CONTI" ).append("\n"); 
		query.append(", DECODE(SUBSTR(A.RLANE_CD,1,3),  'MIX', DECODE(A.FM_CONTI_CD,'M','TAS','A','AES', B.REP_TRD_CD)," ).append("\n"); 
		query.append("'MAP', DECODE(A.FM_CONTI_CD,'M','TPS','A','AES', B.REP_TRD_CD)," ).append("\n"); 
		query.append("'KPM', DECODE(A.FM_CONTI_CD,'M','TPS','A','AES', B.REP_TRD_CD)," ).append("\n"); 
		query.append("'AEC','AES', B.REP_TRD_CD" ).append("\n"); 
		query.append(") TRD_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_DTL_REV_LANE A" ).append("\n"); 
		query.append(", MDM_REV_LANE B" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("A.DELT_FLG ='N'" ).append("\n"); 
		query.append("AND  A.RLANE_CD =B.RLANE_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(") MD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("NVL(VPS1.VPS_PORT_CD, ' ') NOT IN ('PAPAC', 'EGSUZ')" ).append("\n"); 
		query.append("AND NVL(VPS1.TURN_PORT_IND_CD, ' ') NOT IN ('D', 'F', 'V')" ).append("\n"); 
		query.append("AND NVL(VPS1.SKD_CNG_STS_CD, ' ') <> 'S'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND VPS1.VPS_ETD_DT BETWEEN (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_ST_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR||PLN_WK = @[fmPlnYrWk]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_DATE(WK_END_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR||PLN_WK = @[toPlnYrWk]" ).append("\n"); 
		query.append(") +0.99999" ).append("\n"); 
		query.append("AND VPS2.VSL_CD = VPS1.VSL_CD" ).append("\n"); 
		query.append("AND VPS2.SKD_VOY_NO = VPS1.SKD_VOY_NO" ).append("\n"); 
		query.append("AND VPS2.SKD_DIR_CD = VPS1.SKD_DIR_CD" ).append("\n"); 
		query.append("AND VPS2.CLPT_SEQ > VPS1.CLPT_SEQ" ).append("\n"); 
		query.append("AND NVL(VPS2.VPS_PORT_CD, ' ') NOT IN ('PAPAC', 'EGSUZ')" ).append("\n"); 
		query.append("AND NVL(VPS2.SKD_CNG_STS_CD, ' ') <> 'S'" ).append("\n"); 
		query.append("AND CNT1.LOC_CD = VPS1.VPS_PORT_CD" ).append("\n"); 
		query.append("AND CNT2.LOC_CD = VPS2.VPS_PORT_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND VPS1.SLAN_CD = MD.LANE" ).append("\n"); 
		query.append("AND VPS1.SKD_DIR_CD = MD.DIR_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND VPS1.VSL_CD = CM.VSL_CD" ).append("\n"); 
		query.append("AND VPS1.SKD_VOY_NO = CM.SKD_VOY_NO" ).append("\n"); 
		query.append("AND VPS1.SKD_DIR_CD = CM.DIR_CD" ).append("\n"); 
		query.append("AND VPS1.SLAN_CD = CM.SLAN_CD" ).append("\n"); 
		query.append("AND CM.TRD_CD = MD.TRD_CD" ).append("\n"); 
		query.append("#if(${locOrTrade} == '2' || ( ${locOrTrade} == '1' && ${byLocation} == 'P') )" ).append("\n"); 
		query.append("#if(${vslSlanCd} != '')" ).append("\n"); 
		query.append("## CSRNO : N200806030017에 의거 추가" ).append("\n"); 
		query.append("AND VPS1.SLAN_CD IN ( ${arrVslSlanCdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${vvd} != '')" ).append("\n"); 
		query.append("## CSRNO : N200806030017에 의거 추가" ).append("\n"); 
		query.append("AND VPS1.VSL_CD||VPS1.SKD_VOY_NO||VPS1.SKD_DIR_CD IN ( ${arrVvdStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("## CSRNO : N200806030017에 의거 추가" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND DECODE( MD.LANE," ).append("\n"); 
		query.append("'MIX',DECODE(CNT1.CONTI_CD,'F','E',CNT1.CONTI_CD)," ).append("\n"); 
		query.append("'NMX',DECODE(CNT1.CONTI_CD,'F','E',CNT1.CONTI_CD)," ).append("\n"); 
		query.append("'CMX',DECODE(CNT1.CONTI_CD,'F','E',CNT1.CONTI_CD)," ).append("\n"); 
		query.append("'JES',DECODE(CNT1.CONTI_CD,'F','E',CNT1.CONTI_CD)," ).append("\n"); 
		query.append("'JMS',DECODE(CNT1.CONTI_CD,'F','E',CNT1.CONTI_CD)," ).append("\n"); 
		query.append("'INX',DECODE(CNT1.CONTI_CD,'F','A',CNT1.CONTI_CD)," ).append("\n"); 
		query.append("'GIX',DECODE(CNT1.CNT_CD,'IL','E',CNT1.CONTI_CD),CNT1.CONTI_CD) = MD.FM_CONTI" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND (" ).append("\n"); 
		query.append("(CM.TRD_CD = 'TPS' AND DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD) = 'M')" ).append("\n"); 
		query.append("OR (CM.TRD_CD = 'TPS' AND DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD) = 'A')" ).append("\n"); 
		query.append("OR (CM.TRD_CD = 'TAS' AND DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD) = 'M')" ).append("\n"); 
		query.append("OR (CM.TRD_CD = 'TAS' AND DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD) = 'E')" ).append("\n"); 
		query.append("OR (CM.TRD_CD = 'IAS' AND DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD) = 'A')" ).append("\n"); 
		query.append("OR (CM.TRD_CD = 'AES' AND DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD) = 'E')" ).append("\n"); 
		query.append("OR (CM.TRD_CD = 'AES' AND DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD) = 'A')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("VPS1.VSL_CD" ).append("\n"); 
		query.append(", VPS1.SKD_VOY_NO" ).append("\n"); 
		query.append(", VPS1.SKD_DIR_CD" ).append("\n"); 
		query.append(", VPS1.VPS_PORT_CD" ).append("\n"); 
		query.append(", VPS1.CLPT_IND_SEQ" ).append("\n"); 
		query.append(", VPS1.CLPT_SEQ" ).append("\n"); 
		query.append(", VPS1.VPS_ETD_DT" ).append("\n"); 
		query.append(", VPS1.SLAN_CD, MD.TRD_CD," ).append("\n"); 
		query.append("DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD)" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("where" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("(TRD_CD = 'TPS' AND FROM_RGN = 'M' AND TO_RGN = 'A')" ).append("\n"); 
		query.append("OR (TRD_CD = 'TAS' AND FROM_RGN = 'M' AND TO_RGN = 'E')" ).append("\n"); 
		query.append("OR (TRD_CD = 'TAS' AND FROM_RGN = 'E' AND TO_RGN = 'M')" ).append("\n"); 
		query.append("OR (TRD_CD = 'IAS' AND FROM_RGN = 'A' AND TO_RGN = 'A')" ).append("\n"); 
		query.append("OR (TRD_CD = 'IMS' AND FROM_RGN = 'M' AND TO_RGN = 'M')" ).append("\n"); 
		query.append("OR (TRD_CD = 'AES' AND FROM_RGN = 'E' AND TO_RGN = 'A')" ).append("\n"); 
		query.append("OR (TRD_CD = 'TPS' AND FROM_RGN = 'M' AND TO_RGN = DECODE(SLAN_CD, 'INX', 'E','X'))" ).append("\n"); 
		query.append("OR (TRD_CD = 'TPS' AND FROM_RGN = DECODE(SLAN_CD, 'INX','E','X') AND TO_RGN = 'M')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("), ## WITH TGT_OUTBOUND END" ).append("\n"); 
		query.append("TGT_INBOUND AS (" ).append("\n"); 
		query.append("##    SELECT  DISTINCT  '1' LD_DS  ,slan_cd ,VSL_CD, SKD_VOY_NO, SKD_DIR_CD , from_rgn, to_rgn , '' from_rgn1, '' to_rgn1,seq" ).append("\n"); 
		query.append("##            FROM tgt_outbound" ).append("\n"); 
		query.append("##    union all" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT '2' LD_DS" ).append("\n"); 
		query.append(", SLAN_CD" ).append("\n"); 
		query.append(",  VSL_CD" ).append("\n"); 
		query.append(", SKD_VOY_NO" ).append("\n"); 
		query.append(", SKD_DIR_CD" ).append("\n"); 
		query.append(", FROM_RGN" ).append("\n"); 
		query.append(", TO_RGN" ).append("\n"); 
		query.append(", FROM1" ).append("\n"); 
		query.append(", TO1" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("VPS1.VSL_CD" ).append("\n"); 
		query.append(", VPS1.SKD_VOY_NO" ).append("\n"); 
		query.append(", VPS1.SKD_DIR_CD" ).append("\n"); 
		query.append(", VPS1.VPS_PORT_CD" ).append("\n"); 
		query.append(", VPS1.CLPT_IND_SEQ" ).append("\n"); 
		query.append(", VPS1.CLPT_SEQ" ).append("\n"); 
		query.append(", VPS1.VPS_ETD_DT" ).append("\n"); 
		query.append(", VPS1.SLAN_CD" ).append("\n"); 
		query.append(", DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD) FROM_RGN" ).append("\n"); 
		query.append(", SUBSTR(MIN(LPAD(VPS2.CLPT_SEQ, 4)||" ).append("\n"); 
		query.append("DECODE(CNT2.CONTI_CD, 'F', 'E', CNT2.CONTI_CD)), 5, 1) TO_RGN" ).append("\n"); 
		query.append(", BASE.FROM_RGN FROM1" ).append("\n"); 
		query.append(", BASE.TO_RGN TO1" ).append("\n"); 
		query.append(", BASE.SEQ" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("VSK_VSL_PORT_SKD VPS" ).append("\n"); 
		query.append(", VSK_VSL_PORT_SKD VPS1" ).append("\n"); 
		query.append(", MDM_LOCATION CNT1" ).append("\n"); 
		query.append(", VSK_VSL_PORT_SKD VPS2" ).append("\n"); 
		query.append(", MDM_LOCATION CNT2" ).append("\n"); 
		query.append(", TGT_OUTBOUND BASE" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("NVL(VPS1.VPS_PORT_CD, ' ') NOT IN ('PAPAC', 'EGSUZ')" ).append("\n"); 
		query.append("AND NVL(VPS1.TURN_PORT_IND_CD, ' ') NOT IN ('D', 'F', 'V')" ).append("\n"); 
		query.append("AND NVL(VPS1.SKD_CNG_STS_CD, ' ') <> 'S'" ).append("\n"); 
		query.append("AND CNT1.LOC_CD = VPS1.VPS_PORT_CD" ).append("\n"); 
		query.append("##  AND vps1.vps_etd_dt BETWEEN (SELECT TO_DATE(WK_ST_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = '200814')" ).append("\n"); 
		query.append("##  AND (SELECT TO_DATE(WK_END_DT,'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = '200821') +0.99999" ).append("\n"); 
		query.append("AND VPS1.VSL_CD = VPS.VSL_CD" ).append("\n"); 
		query.append("AND VPS1.SKD_VOY_NO = VPS.TURN_SKD_VOY_NO" ).append("\n"); 
		query.append("AND VPS1.SKD_DIR_CD = VPS.TURN_SKD_DIR_CD" ).append("\n"); 
		query.append("AND VPS2.VSL_CD = VPS1.VSL_CD" ).append("\n"); 
		query.append("AND VPS2.SKD_VOY_NO = VPS1.SKD_VOY_NO" ).append("\n"); 
		query.append("AND VPS2.SKD_DIR_CD = VPS1.SKD_DIR_CD" ).append("\n"); 
		query.append("AND VPS2.CLPT_SEQ > VPS1.CLPT_SEQ" ).append("\n"); 
		query.append("AND NVL(VPS2.VPS_PORT_CD, ' ') NOT IN ('PAPAC', 'EGSUZ')" ).append("\n"); 
		query.append("AND NVL(VPS2.SKD_CNG_STS_CD, ' ') <> 'S'" ).append("\n"); 
		query.append("AND CNT2.LOC_CD = VPS2.VPS_PORT_CD" ).append("\n"); 
		query.append("AND VPS.SLAN_CD = BASE.SLAN_CD" ).append("\n"); 
		query.append("AND VPS.VSL_CD = BASE.VSL_CD" ).append("\n"); 
		query.append("AND VPS.SKD_VOY_NO = BASE.SKD_VOY_NO" ).append("\n"); 
		query.append("AND VPS.SKD_DIR_CD = BASE.SKD_DIR_CD" ).append("\n"); 
		query.append("AND VPS.CLPT_SEQ = 1" ).append("\n"); 
		query.append("AND DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD) = BASE.TO_RGN" ).append("\n"); 
		query.append("##    AND DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD) = 'A'" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("VPS1.VSL_CD" ).append("\n"); 
		query.append(", VPS1.SKD_VOY_NO" ).append("\n"); 
		query.append(", VPS1.SKD_DIR_CD" ).append("\n"); 
		query.append(", VPS1.VPS_PORT_CD" ).append("\n"); 
		query.append(", VPS1.CLPT_IND_SEQ" ).append("\n"); 
		query.append(", VPS1.CLPT_SEQ" ).append("\n"); 
		query.append(", VPS1.VPS_ETD_DT" ).append("\n"); 
		query.append(", VPS1.SLAN_CD" ).append("\n"); 
		query.append(", DECODE(CNT1.CONTI_CD, 'F', 'E', CNT1.CONTI_CD)" ).append("\n"); 
		query.append(", BASE.FROM_RGN" ).append("\n"); 
		query.append(", BASE.TO_RGN" ).append("\n"); 
		query.append(", BASE.SEQ" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("##WHERE (from_rgn = 'A' AND to_rgn = 'E')" ).append("\n"); 
		query.append("##WHERE (from_rgn = to_rgn AND to_rgn = from_rgn)" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("FROM_RGN = TO1" ).append("\n"); 
		query.append("AND TO_RGN = FROM1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("SEQ" ).append("\n"); 
		query.append(", SLAN_CD" ).append("\n"); 
		query.append(", VSL_CD" ).append("\n"); 
		query.append(", SKD_VOY_NO" ).append("\n"); 
		query.append(", SKD_DIR_CD" ).append("\n"); 
		query.append(", FROM_RGN" ).append("\n"); 
		query.append(", TO_RGN" ).append("\n"); 
		query.append(", FROM1" ).append("\n"); 
		query.append(", TO1" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("SEQ" ).append("\n"); 
		query.append(", LD_DS" ).append("\n"); 
		query.append(", SLAN_CD" ).append("\n"); 
		query.append(", VSL_CD" ).append("\n"); 
		query.append(", SKD_VOY_NO" ).append("\n"); 
		query.append(", SKD_DIR_CD" ).append("\n"); 
		query.append(")   ## WITH TGT_INBOUND END" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("'' SEQ" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_TRADE" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_TRADE" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_TRADE" ).append("\n"); 
		query.append("END TRADE" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_VSL_LANE_CD" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_VSL_LANE_CD" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_VSL_LANE_CD" ).append("\n"); 
		query.append("END AS VSL_LANE_CD" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_LAST_PORT_CD" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_LAST_PORT_CD" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_LAST_PORT_CD" ).append("\n"); 
		query.append("END AS VVD" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_VVD" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_VVD" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_VVD" ).append("\n"); 
		query.append("END AS VVD" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("'LD'" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("'DS'" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("'Match Back(%)'" ).append("\n"); 
		query.append("END AS FLG" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_LAST_PORT_YRWK" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_LAST_PORT_YRWK" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_LAST_PORT_YRWK" ).append("\n"); 
		query.append("END AS LAST_PORT_YRWK" ).append("\n"); 
		query.append("## FULL" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_FULL_20" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_FULL_20" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_LDFULL_20" ).append("\n"); 
		query.append("END AS FULL_20" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_FULL_40" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_FULL_40" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_LDFULL_40" ).append("\n"); 
		query.append("END AS FULL_40" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_FULL_HC" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_FULL_HC" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_LDFULL_HC" ).append("\n"); 
		query.append("END AS FULL_HC" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_FULL_45" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_FULL_45" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_LDFULL_45" ).append("\n"); 
		query.append("END AS FULL_45" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_FULL_TTL" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_FULL_TTL" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_LDFULL_TTL" ).append("\n"); 
		query.append("END AS FULL_TTL" ).append("\n"); 
		query.append("## empty" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_EMPTY_20" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_EMPTY_20" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_LDEMPTY_20" ).append("\n"); 
		query.append("END AS EMPTY_20" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_EMPTY_40" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_EMPTY_40" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_LDEMPTY_40" ).append("\n"); 
		query.append("END AS EMPTY_40" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_EMPTY_HC" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_EMPTY_HC" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_LDEMPTY_HC" ).append("\n"); 
		query.append("END AS EMPTY_HC" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_EMPTY_45" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_EMPTY_45" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_LDEMPTY_45" ).append("\n"); 
		query.append("END AS EMPTY_45" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_EMPTY_TTL" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_EMPTY_TTL" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_LDEMPTY_TTL" ).append("\n"); 
		query.append("END AS EMPTY_TTL" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_TOTAL" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_TOTAL" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_TOTAL" ).append("\n"); 
		query.append("END AS TOTAL" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN NO = '1'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("LD_TEU" ).append("\n"); 
		query.append("WHEN NO = '2'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("DS_TEU" ).append("\n"); 
		query.append("WHEN NO = '3'" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("MATCH_TEU" ).append("\n"); 
		query.append("END AS TOTAL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("OUTBOUND.TRADE          LD_TRADE" ).append("\n"); 
		query.append(",OUTBOUND.VSL_LANE_CD    LD_VSL_LANE_CD" ).append("\n"); 
		query.append(",OUTBOUND.LST_PORT       LD_LAST_PORT_CD" ).append("\n"); 
		query.append(",OUTBOUND.VVD            LD_VVD" ).append("\n"); 
		query.append(",OUTBOUND.PLN_YRWK       LD_LAST_PORT_YRWK" ).append("\n"); 
		query.append(",OUTBOUND.LD_DS          FLG_1" ).append("\n"); 
		query.append(",MAX(LD_LOFUL_20)  LD_FULL_20" ).append("\n"); 
		query.append(",MAX(LD_LOFUL_40) LD_FULL_40" ).append("\n"); 
		query.append(",MAX(LD_LOFUL_HC) LD_FULL_HC" ).append("\n"); 
		query.append(",MAX(LD_LOFUL_45) LD_FULL_45" ).append("\n"); 
		query.append(",MAX(LD_LOFUL_20 + LD_LOFUL_40 + LD_LOFUL_HC + LD_LOFUL_45) LD_FULL_TTL" ).append("\n"); 
		query.append(",MAX(LD_LOEMP_20) LD_EMPTY_20" ).append("\n"); 
		query.append(",MAX(LD_LOEMP_40) LD_EMPTY_40" ).append("\n"); 
		query.append(",MAX(LD_LOEMP_HC) LD_EMPTY_HC" ).append("\n"); 
		query.append(",MAX(LD_LOEMP_45) LD_EMPTY_45" ).append("\n"); 
		query.append(",MAX(LD_LOEMP_20) + MAX(LD_LOEMP_40) + MAX(LD_LOEMP_HC) + MAX(LD_LOEMP_45) LD_EMPTY_TTL" ).append("\n"); 
		query.append(",MAX(LD_LOFUL_20) + MAX(LD_LOFUL_40) + MAX(LD_LOFUL_HC) + MAX(LD_LOFUL_45)" ).append("\n"); 
		query.append("+ MAX(LD_LOEMP_20) + MAX(LD_LOEMP_40) + MAX(LD_LOEMP_HC) + MAX(LD_LOEMP_45)   LD_TOTAL" ).append("\n"); 
		query.append(",MAX(OUTBOUND.LD_CNTR_TEU_LOFUL)+MAX(OUTBOUND.LD_CNTR_TEU_LOEMP)    LD_TEU" ).append("\n"); 
		query.append(",MAX(OUTBOUND.SEQ)" ).append("\n"); 
		query.append("############## inbound ################################-" ).append("\n"); 
		query.append(",INBOUND.DS_TRADE          DS_TRADE" ).append("\n"); 
		query.append(",INBOUND.DS_VSL_LANE_CD    DS_VSL_LANE_CD" ).append("\n"); 
		query.append(",INBOUND.DS_LST_PORT       DS_LAST_PORT_CD" ).append("\n"); 
		query.append(",INBOUND.DS_VVD            DS_VVD" ).append("\n"); 
		query.append(",INBOUND.DS_PLN_YRWK       DS_LAST_PORT_YRWK" ).append("\n"); 
		query.append(",INBOUND.DS_LD_DS          FLG_2" ).append("\n"); 
		query.append(",MAX(INBOUND.DS_LOFUL_20) DS_FULL_20" ).append("\n"); 
		query.append(",MAX(INBOUND.DS_LOFUL_40) DS_FULL_40" ).append("\n"); 
		query.append(",MAX(INBOUND.DS_LOFUL_HC) DS_FULL_HC" ).append("\n"); 
		query.append(",MAX(INBOUND.DS_LOFUL_45) DS_FULL_45" ).append("\n"); 
		query.append(",MAX(INBOUND.DS_LOFUL_20 + INBOUND.DS_LOFUL_40 + INBOUND.DS_LOFUL_HC + INBOUND.DS_LOFUL_45) DS_FULL_TTL" ).append("\n"); 
		query.append(",MAX(DS_LOEMP_20) DS_EMPTY_20" ).append("\n"); 
		query.append(",MAX(DS_LOEMP_40) DS_EMPTY_40" ).append("\n"); 
		query.append(",MAX(DS_LOEMP_HC) DS_EMPTY_HC" ).append("\n"); 
		query.append(",MAX(DS_LOEMP_45) DS_EMPTY_45" ).append("\n"); 
		query.append(",MAX(DS_LOEMP_20) +MAX(DS_LOEMP_40) + MAX(DS_LOEMP_HC) + MAX(DS_LOEMP_45) DS_EMPTY_TTL" ).append("\n"); 
		query.append(",MAX(INBOUND.DS_LOFUL_20) + MAX(INBOUND.DS_LOFUL_40) + MAX(INBOUND.DS_LOFUL_HC) + MAX(INBOUND.DS_LOFUL_45)" ).append("\n"); 
		query.append("+ MAX(DS_LOEMP_20) + MAX(DS_LOEMP_40) + MAX(DS_LOEMP_HC) + MAX(DS_LOEMP_45)   DS_TOTAL" ).append("\n"); 
		query.append(",MAX(INBOUND.DS_CNTR_TEU_LOFUL)+ MAX(INBOUND.DS_CNTR_TEU_LOEMP)    DS_TEU" ).append("\n"); 
		query.append(",MAX(INBOUND.SEQ)" ).append("\n"); 
		query.append(",''                        MATCH_TRADE" ).append("\n"); 
		query.append(",''                        MATCH_VSL_LANE_CD" ).append("\n"); 
		query.append(",''                        MATCH_LAST_PORT_CD" ).append("\n"); 
		query.append(",''                        MATCH_VVD" ).append("\n"); 
		query.append(",''                        MATCH_LAST_PORT_YRWK" ).append("\n"); 
		query.append(",'3'                       FLG_3" ).append("\n"); 
		query.append("###################### match full 계산   ##########################" ).append("\n"); 
		query.append(",CASE WHEN NVL(MAX(LD_LOFUL_20),0) >  NVL(MAX(INBOUND.DS_LOFUL_20),0)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("- ROUND((NVL(MAX(INBOUND.DS_LOFUL_20),0) / DECODE(NVL(MAX(LD_LOFUL_20),1),0,1,MAX(LD_LOFUL_20)) )* 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("ROUND((NVL(MAX(LD_LOFUL_20),0)         / DECODE(NVL(MAX(INBOUND.DS_LOFUL_20),1),0,1,MAX(INBOUND.DS_LOFUL_20)) ) * 100,1)" ).append("\n"); 
		query.append("END MATCH_LDFULL_20" ).append("\n"); 
		query.append(",CASE WHEN NVL(MAX(LD_LOFUL_40),0) >  NVL(MAX(INBOUND.DS_LOFUL_40),0)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("-  ROUND((NVL(MAX(INBOUND.DS_LOFUL_40),0)  / DECODE(NVL(MAX(LD_LOFUL_40),1),0,1,MAX(LD_LOFUL_40))) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("ROUND((NVL(MAX(LD_LOFUL_40),0)          / DECODE(NVL(MAX(INBOUND.DS_LOFUL_40),1),0,1,MAX(INBOUND.DS_LOFUL_40)) ) * 100,1)" ).append("\n"); 
		query.append("END MATCH_LDFULL_40" ).append("\n"); 
		query.append(",CASE WHEN  NVL(MAX(LD_LOFUL_HC),0) >  NVL(MAX(INBOUND.DS_LOFUL_HC),0)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("-    ROUND((NVL(MAX(INBOUND.DS_LOFUL_HC),0) / DECODE(NVL(MAX(LD_LOFUL_HC),1),0,1,MAX(LD_LOFUL_HC)) ) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("ROUND((NVL(MAX(LD_LOFUL_HC),0)        /  DECODE(NVL(MAX(INBOUND.DS_LOFUL_HC),1),0,1,MAX(INBOUND.DS_LOFUL_HC)) ) * 100,1)" ).append("\n"); 
		query.append("END MATCH_LDFULL_HC" ).append("\n"); 
		query.append(",CASE WHEN NVL(MAX(LD_LOFUL_45),0) >  NVL(MAX(INBOUND.DS_LOFUL_45),0)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("-    ROUND((NVL(MAX(INBOUND.DS_LOFUL_45),0) / DECODE(NVL(MAX(LD_LOFUL_45),1),0,1,MAX(LD_LOFUL_45)) ) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("ROUND((NVL(MAX(LD_LOFUL_45),0)         / DECODE(NVL(MAX(INBOUND.DS_LOFUL_45),1),0,1,MAX(INBOUND.DS_LOFUL_45)) ) * 100,1)" ).append("\n"); 
		query.append("END MATCH_LDFULL_45" ).append("\n"); 
		query.append(", CASE WHEN NVL(MAX(LD_LOFUL_20) + MAX(LD_LOFUL_40) + MAX(LD_LOFUL_HC) + MAX(LD_LOFUL_45),0) >  NVL(MAX(INBOUND.DS_LOFUL_20) + MAX(INBOUND.DS_LOFUL_40) + MAX(INBOUND.DS_LOFUL_HC) + MAX(INBOUND.DS_LOFUL_45),0)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("-   ROUND(NVL(MAX(INBOUND.DS_LOFUL_20) + MAX(INBOUND.DS_LOFUL_40) + MAX(INBOUND.DS_LOFUL_HC) + MAX(INBOUND.DS_LOFUL_45),0) / DECODE(NVL(MAX(LD_LOFUL_20) + MAX(LD_LOFUL_40) + MAX(LD_LOFUL_HC) + MAX(LD_LOFUL_45),1),0,1,MAX(LD_LOFUL_20) + MAX(LD_LOFUL_40) + MAX(LD_LOFUL_HC) + MAX(LD_LOFUL_45) )* 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("ROUND(NVL(MAX(LD_LOFUL_20) + MAX(LD_LOFUL_40) + MAX(LD_LOFUL_HC) + MAX(LD_LOFUL_45),0) / DECODE(NVL( MAX(INBOUND.DS_LOFUL_20) + MAX(INBOUND.DS_LOFUL_40) + MAX(INBOUND.DS_LOFUL_HC) + MAX(INBOUND.DS_LOFUL_45),1),0,1,MAX(INBOUND.DS_LOFUL_20) + MAX(INBOUND.DS_LOFUL_40) + MAX(INBOUND.DS_LOFUL_HC) + MAX(INBOUND.DS_LOFUL_45) )* 100,1)" ).append("\n"); 
		query.append("END MATCH_LDFULL_TTL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  MATCH EMPTY  계산식 시작" ).append("\n"); 
		query.append(",CASE WHEN NVL(MAX(LD_LOEMP_20),0) >  NVL(MAX(DS_LOEMP_20),0)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("-   ROUND((NVL(MAX(DS_LOEMP_20),0) / DECODE(NVL(MAX(LD_LOEMP_20),1),0,1,MAX(LD_LOEMP_20)) ) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("ROUND((NVL(MAX(LD_LOEMP_20),0) / DECODE(NVL(MAX(DS_LOEMP_20),1),0,1,MAX(DS_LOEMP_20)) ) * 100,1)" ).append("\n"); 
		query.append("END MATCH_LDEMPTY_20" ).append("\n"); 
		query.append(",CASE WHEN NVL(MAX(LD_LOEMP_40),0) >  NVL(MAX(DS_LOEMP_40),0)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("-   ROUND((NVL(MAX(DS_LOEMP_40),0) / DECODE(NVL(MAX(LD_LOEMP_40),1),0,1,MAX(LD_LOEMP_40)) ) * 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("ROUND((NVL(MAX(LD_LOEMP_40),0) / DECODE(NVL(MAX(DS_LOEMP_40),1),0,1,MAX(DS_LOEMP_40)) ) * 100,1)" ).append("\n"); 
		query.append("END MATCH_LDEMPTY_40" ).append("\n"); 
		query.append(",CASE WHEN NVL(MAX(LD_LOEMP_HC),0) >  NVL(MAX(DS_LOEMP_HC),0)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("-   ROUND((NVL(MAX(DS_LOEMP_HC),0) / DECODE(NVL(MAX(LD_LOEMP_HC),1),0,1,MAX(LD_LOEMP_HC)) )* 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("ROUND((NVL(MAX(LD_LOEMP_HC),0) / DECODE(NVL(MAX(DS_LOEMP_HC),1),0,1,MAX(DS_LOEMP_HC)) )* 100,1)" ).append("\n"); 
		query.append("END MATCH_LDEMPTY_HC" ).append("\n"); 
		query.append(",CASE WHEN NVL(MAX(LD_LOEMP_45),0) >  NVL(MAX(DS_LOEMP_45),0)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("-    ROUND((NVL(MAX(DS_LOEMP_45),0) / DECODE(NVL(MAX(LD_LOEMP_45),1),0,1,MAX(LD_LOEMP_45)) )* 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("ROUND((NVL(MAX(LD_LOEMP_45),0) / DECODE(NVL(MAX(DS_LOEMP_45),1),0,1,MAX(DS_LOEMP_45)) ) * 100,1)" ).append("\n"); 
		query.append("END MATCH_LDEMPTY_45" ).append("\n"); 
		query.append(", CASE WHEN      NVL(MAX(LD_LOEMP_20 + LD_LOEMP_40 + LD_LOEMP_HC + LD_LOEMP_45),0) >  NVL(MAX(DS_LOEMP_20 + DS_LOEMP_40 + DS_LOEMP_HC + DS_LOEMP_45),0)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("-    ROUND((NVL(MAX(DS_LOEMP_20 + DS_LOEMP_40 + DS_LOEMP_HC + DS_LOEMP_45),0) / DECODE(NVL(MAX(LD_LOEMP_20 + LD_LOEMP_40 + LD_LOEMP_HC + LD_LOEMP_45),1),0,1,MAX(LD_LOEMP_20 + LD_LOEMP_40 + LD_LOEMP_HC + LD_LOEMP_45)) )* 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("ROUND((NVL(MAX(LD_LOEMP_20 + LD_LOEMP_40 + LD_LOEMP_HC + LD_LOEMP_45),0) / DECODE(NVL(MAX(DS_LOEMP_20 + DS_LOEMP_40 + DS_LOEMP_HC + DS_LOEMP_45),1),0,1,MAX(DS_LOEMP_20 + DS_LOEMP_40 + DS_LOEMP_HC + DS_LOEMP_45)) )* 100,1)" ).append("\n"); 
		query.append("END MATCH_LDEMPTY_TTL" ).append("\n"); 
		query.append("## TOTAL , TEU 계산 로직" ).append("\n"); 
		query.append(", CASE WHEN NVL(MAX(LD_LOFUL_20) + MAX(LD_LOFUL_40) + MAX(LD_LOFUL_HC) + MAX(LD_LOFUL_45)+ MAX(LD_LOEMP_20) + MAX(LD_LOEMP_40) + MAX(LD_LOEMP_HC) + MAX(LD_LOEMP_45),0) >  NVL(MAX(INBOUND.DS_LOFUL_20) + MAX(INBOUND.DS_LOFUL_40) + MAX(INBOUND.DS_LOFUL_HC) + MAX(INBOUND.DS_LOFUL_45) + MAX(DS_LOEMP_20) + MAX(DS_LOEMP_40) + MAX(DS_LOEMP_HC) + MAX(DS_LOEMP_45),0)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("-    ROUND((NVL(MAX(INBOUND.DS_LOFUL_20) + MAX(INBOUND.DS_LOFUL_40) + MAX(INBOUND.DS_LOFUL_HC) + MAX(INBOUND.DS_LOFUL_45) + MAX(DS_LOEMP_20) + MAX(DS_LOEMP_40) + MAX(DS_LOEMP_HC) + MAX(DS_LOEMP_45),0) / DECODE(NVL(MAX(LD_LOFUL_20) + MAX(LD_LOFUL_40) + MAX(LD_LOFUL_HC) + MAX(LD_LOFUL_45)+ MAX(LD_LOEMP_20) + MAX(LD_LOEMP_40) + MAX(LD_LOEMP_HC) + MAX(LD_LOEMP_45),1),0,1,MAX(LD_LOFUL_20) + MAX(LD_LOFUL_40) + MAX(LD_LOFUL_HC) + MAX(LD_LOFUL_45) + MAX(LD_LOEMP_20) + MAX(LD_LOEMP_40) + MAX(LD_LOEMP_HC) + MAX(LD_LOEMP_45)) )* 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("ROUND((NVL(MAX(LD_LOFUL_20) + MAX(LD_LOFUL_40) + MAX(LD_LOFUL_HC) + MAX(LD_LOFUL_45)+ MAX(LD_LOEMP_20) + MAX(LD_LOEMP_40) + MAX(LD_LOEMP_HC) + MAX(LD_LOEMP_45),0) / DECODE(NVL(MAX(INBOUND.DS_LOFUL_20) + MAX(INBOUND.DS_LOFUL_40) + MAX(INBOUND.DS_LOFUL_HC) + MAX(INBOUND.DS_LOFUL_45) + MAX(DS_LOEMP_20) + MAX(DS_LOEMP_40) + MAX(DS_LOEMP_HC) + MAX(DS_LOEMP_45),1),0,1,MAX(INBOUND.DS_LOFUL_20) + MAX(INBOUND.DS_LOFUL_40) + MAX(INBOUND.DS_LOFUL_HC) + MAX(INBOUND.DS_LOFUL_45) + MAX(DS_LOEMP_20) + MAX(DS_LOEMP_40) + MAX(DS_LOEMP_HC) + MAX(DS_LOEMP_45)) )* 100,1)" ).append("\n"); 
		query.append("END MATCH_TOTAL" ).append("\n"); 
		query.append(",CASE WHEN NVL(MAX(OUTBOUND.LD_CNTR_TEU_LOFUL)+MAX(OUTBOUND.LD_CNTR_TEU_LOEMP),0) >  NVL(MAX(INBOUND.DS_CNTR_TEU_LOFUL)+MAX(INBOUND.DS_CNTR_TEU_LOEMP),0)" ).append("\n"); 
		query.append("THEN" ).append("\n"); 
		query.append("-    ROUND((NVL(MAX(INBOUND.DS_CNTR_TEU_LOFUL)+MAX(INBOUND.DS_CNTR_TEU_LOEMP),0) / DECODE(NVL(MAX(OUTBOUND.LD_CNTR_TEU_LOFUL)+MAX(OUTBOUND.LD_CNTR_TEU_LOEMP),1),0,1,MAX(OUTBOUND.LD_CNTR_TEU_LOFUL)+MAX(OUTBOUND.LD_CNTR_TEU_LOEMP)) )* 100,1)" ).append("\n"); 
		query.append("ELSE" ).append("\n"); 
		query.append("ROUND((NVL(MAX(OUTBOUND.LD_CNTR_TEU_LOFUL)+MAX(OUTBOUND.LD_CNTR_TEU_LOEMP),0) / DECODE(NVL(MAX(INBOUND.DS_CNTR_TEU_LOFUL)+MAX(INBOUND.DS_CNTR_TEU_LOEMP),1),0,1,MAX(INBOUND.DS_CNTR_TEU_LOFUL)+MAX(INBOUND.DS_CNTR_TEU_LOEMP)) ) * 100,1)" ).append("\n"); 
		query.append("END MATCH_TEU" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("## (1)" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("## outbound fULL 물량 구하기" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(",VSL_LANE_CD" ).append("\n"); 
		query.append(",LST_PORT" ).append("\n"); 
		query.append(",VVD" ).append("\n"); 
		query.append(",TRADE" ).append("\n"); 
		query.append(",LD_DS" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL 	, 'D2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_FULL , 0)) LD_LOFUL_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL 	, 'D4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_FULL , 0)) LD_LOFUL_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL 	, 'D5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_FULL , 0)) LD_LOFUL_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL 	, 'D7', CNTR_QTY_FULL , 0)) LD_LOFUL_45" ).append("\n"); 
		query.append(",SUM(0) LD_LOEMP_20" ).append("\n"); 
		query.append(",SUM(0) LD_LOEMP_40" ).append("\n"); 
		query.append(",SUM(0) LD_LOEMP_HC" ).append("\n"); 
		query.append(",SUM(0) LD_LOEMP_45" ).append("\n"); 
		query.append(",SUM(0) DS_LOFUL_20" ).append("\n"); 
		query.append(",SUM(0) DS_LOFUL_40" ).append("\n"); 
		query.append(",SUM(0) DS_LOFUL_HC" ).append("\n"); 
		query.append(",SUM(0) DS_LOFUL_45" ).append("\n"); 
		query.append(",SUM(0) DS_LOEMP_20" ).append("\n"); 
		query.append(",SUM(0) DS_LOEMP_40" ).append("\n"); 
		query.append(",SUM(0) DS_LOEMP_HC" ).append("\n"); 
		query.append(",SUM(0) DS_LOEMP_45" ).append("\n"); 
		query.append(",SUM(CNTR_QTY_TEU_LOFULL) LD_CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(0)                  LD_CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SUM(0)                  DS_CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(0)                  DS_CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT /*+ FULL(ML) FULL(MO) */DISTINCT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(CM.LST_LODG_PORT_ETD_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",CM.TRD_CD              TRADE" ).append("\n"); 
		query.append(",BV.SLAN_CD      VSL_LANE_CD" ).append("\n"); 
		query.append(",BV.POD_CD ##, BV.VSL_POD_CD" ).append("\n"); 
		query.append(",BV.VSL_CD||BV.SKD_VOY_NO||BV.SKD_DIR_CD  VVD" ).append("\n"); 
		query.append(",CM.LST_LODG_PORT_CD LST_PORT" ).append("\n"); 
		query.append(",BC.CNTR_TPSZ_CD      CNTR_TPSZ_CD_FULL" ).append("\n"); 
		query.append(",BC.CNTR_VOL_QTY    CNTR_QTY_FULL" ).append("\n"); 
		query.append(",TGT_BASE.LD_DS" ).append("\n"); 
		query.append(",TGT_BASE.SEQ" ).append("\n"); 
		query.append(",BC.CNTR_NO ##    , BC.BKG_NO" ).append("\n"); 
		query.append(",DECODE(BC.CNTR_TPSZ_CD , 'D2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'R2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'O2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'F2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='F2' AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S2', BC.CNTR_VOL_QTY *  (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='O2' AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'O4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='F4' AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'A4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='F4' AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'S4', ( BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='O4' AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'R5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D7', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))  ,    0) CNTR_QTY_TEU_LOFULL" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("BKG_BOOKING BK" ).append("\n"); 
		query.append(", BKG_VVD BV" ).append("\n"); 
		query.append(", BKG_CONTAINER BC" ).append("\n"); 
		query.append(", COA_MON_VVD CM" ).append("\n"); 
		query.append(", MDM_LOCATION ML" ).append("\n"); 
		query.append(", MDM_LOCATION MO" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT SUBSTR(RLANE_CD,1,3) LANE" ).append("\n"); 
		query.append(", VSL_SLAN_DIR_CD DIR_CD" ).append("\n"); 
		query.append(", FM_CONTI_CD FM_CONTI" ).append("\n"); 
		query.append(", TO_CONTI_CD TO_CONTI" ).append("\n"); 
		query.append(", TRD_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_DTL_REV_LANE" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("DELT_FLG='N'" ).append("\n"); 
		query.append("AND SUB_TRD_CD NOT IN ('IP')" ).append("\n"); 
		query.append(") MD" ).append("\n"); 
		query.append(", VSK_VSL_PORT_SKD VP" ).append("\n"); 
		query.append(", TGT_OUTBOUND TGT_BASE" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("CM.DELT_FLG = 'N'" ).append("\n"); 
		query.append("##CSRNO : R200807047819로 의거 조건 추가" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND BK.BKG_NO = BV.BKG_NO" ).append("\n"); 
		query.append("AND BK.BKG_NO = BC.BKG_NO" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BV.BKG_NO_SPLIT" ).append("\n"); 
		query.append("##AND BK.BKG_NO_SPLIT = BC.BKG_NO_SPLIT" ).append("\n"); 
		query.append("AND BK.BKG_CGO_TP_CD IN ('F')" ).append("\n"); 
		query.append("AND CM.VSL_CD = BV.VSL_CD" ).append("\n"); 
		query.append("AND CM.SKD_VOY_NO = BV.SKD_VOY_NO" ).append("\n"); 
		query.append("AND CM.DIR_CD  = BV.SKD_DIR_CD" ).append("\n"); 
		query.append("AND CM.SLAN_CD = BV.SLAN_CD" ).append("\n"); 
		query.append("AND VP.VSL_CD  = TGT_BASE.VSL_CD" ).append("\n"); 
		query.append("AND VP.SKD_VOY_NO = TGT_BASE.SKD_VOY_NO" ).append("\n"); 
		query.append("AND VP.SKD_DIR_CD = TGT_BASE.SKD_DIR_CD" ).append("\n"); 
		query.append("AND VP.SLAN_CD =  TGT_BASE.SLAN_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND BV.VSL_CD = CM.VSL_CD" ).append("\n"); 
		query.append("AND BV.SKD_VOY_NO = CM.SKD_VOY_NO" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD = CM.DIR_CD" ).append("\n"); 
		query.append("AND BV.SLAN_CD  = CM.SLAN_CD" ).append("\n"); 
		query.append("AND BV.VSL_CD = VP.VSL_CD" ).append("\n"); 
		query.append("AND BV.SKD_VOY_NO = VP.SKD_VOY_NO" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD = VP.SKD_DIR_CD" ).append("\n"); 
		query.append("AND BV.POL_CD = VP.VPS_PORT_CD" ).append("\n"); 
		query.append("AND BV.SLAN_CD    = VP.SLAN_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##AND VSL_PRE_PST_CD ='T'" ).append("\n"); 
		query.append("AND BV.VSL_CD =TGT_BASE.VSL_CD" ).append("\n"); 
		query.append("AND BV.SKD_VOY_NO =TGT_BASE.SKD_VOY_NO" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD =TGT_BASE.SKD_DIR_CD" ).append("\n"); 
		query.append("AND BV.SLAN_CD    =TGT_BASE.SLAN_CD" ).append("\n"); 
		query.append("AND BV.POL_CD = ML.LOC_CD" ).append("\n"); 
		query.append("AND BV.POD_CD = MO.LOC_CD" ).append("\n"); 
		query.append("AND MD.TRD_CD = CM.TRD_CD" ).append("\n"); 
		query.append("AND BV.SLAN_CD  = MD.LANE" ).append("\n"); 
		query.append("AND BV.SLAN_CD  = CM.SLAN_CD" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD = MD.DIR_CD" ).append("\n"); 
		query.append("AND MD.FM_CONTI = ML.CONTI_CD" ).append("\n"); 
		query.append("AND MD.TO_CONTI = MO.CONTI_CD" ).append("\n"); 
		query.append("AND BK.BKG_STS_CD NOT IN 'X'" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", TRADE" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD" ).append("\n"); 
		query.append(", LST_PORT" ).append("\n"); 
		query.append(", LD_DS" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("UNION ALL     ## OUTBOUND EMPTY 물량 구하기" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(",LST_PORT" ).append("\n"); 
		query.append(",VVD" ).append("\n"); 
		query.append(",TRADE" ).append("\n"); 
		query.append(",LD_DS" ).append("\n"); 
		query.append(",SUM(0) LOFUL_20" ).append("\n"); 
		query.append(",SUM(0) LOFUL_40" ).append("\n"); 
		query.append(",SUM(0) LOFUL_HC" ).append("\n"); 
		query.append(",SUM(0) LOFUL_45" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP 	, 'D2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_EMP , 0)) LD_LOEMP_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP 	, 'D4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_EMP , 0)) LD_LOEMP_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP 	, 'D5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_EMP , 0)) LD_LOEMP_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP , 'D7', CNTR_QTY_EMP , 0)) LD_LOEMP_45" ).append("\n"); 
		query.append(",SUM(0) DCFUL_20" ).append("\n"); 
		query.append(",SUM(0) DCFUL_40" ).append("\n"); 
		query.append(",SUM(0) DCFUL_HC" ).append("\n"); 
		query.append(",SUM(0) DCFUL_45" ).append("\n"); 
		query.append(",SUM(0) DCEMP_20" ).append("\n"); 
		query.append(",SUM(0) DCEMP_40" ).append("\n"); 
		query.append(",SUM(0) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(0) DCEMP_45" ).append("\n"); 
		query.append(",SUM(0) LD_CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(CNTR_QTY_TEU_DCEMP) LD_CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SUM(0)                  DS_CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(0)                  DS_CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SEQ" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(CM.LST_LODG_PORT_ETD_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD            	CO_CD" ).append("\n"); 
		query.append(",CM.TRD_CD              TRADE" ).append("\n"); 
		query.append(",PL.VSL_LANE_CD      	VSL_LANE_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.FM_YD_CD,0,5) AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") PORT" ).append("\n"); 
		query.append(",PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD  VVD" ).append("\n"); 
		query.append(",CM.LST_LODG_PORT_CD 	LST_PORT" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD       	CNTR_TPSZ_CD_EMP" ).append("\n"); 
		query.append(",Q.CNTR_QTY          	CNTR_QTY_EMP" ).append("\n"); 
		query.append(",TGT_BASE.LD_DS" ).append("\n"); 
		query.append(",TGT_BASE.SEQ" ).append("\n"); 
		query.append(",DECODE(Q.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", 'D2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'R2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'O2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'F2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='F2' AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='O2' AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'O4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='F4' AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'A4',  Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='F4' AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S4',  Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='O4' AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'R5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D7', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))  ,    0) CNTR_QTY_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN PL" ).append("\n"); 
		query.append(", EQR_VSL_EXE_PLN_QTY Q" ).append("\n"); 
		query.append(", COA_MON_VVD CM" ).append("\n"); 
		query.append(", MDM_LOCATION ML" ).append("\n"); 
		query.append(", MDM_LOCATION MO" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT SUBSTR(RLANE_CD,1,3) LANE" ).append("\n"); 
		query.append(", VSL_SLAN_DIR_CD DIR_CD" ).append("\n"); 
		query.append(", FM_CONTI_CD FM_CONTI" ).append("\n"); 
		query.append(", TO_CONTI_CD TO_CONTI" ).append("\n"); 
		query.append(", TRD_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_DTL_REV_LANE" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("DELT_FLG='N'" ).append("\n"); 
		query.append("AND SUB_TRD_CD NOT IN ('IP')" ).append("\n"); 
		query.append(") MD" ).append("\n"); 
		query.append(", TGT_OUTBOUND TGT_BASE" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PL.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PL.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND PL.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND PL.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND PL.VSL_CD =TGT_BASE.VSL_CD" ).append("\n"); 
		query.append("AND PL.SKD_VOY_NO =TGT_BASE.SKD_VOY_NO" ).append("\n"); 
		query.append("AND PL.SKD_DIR_CD =TGT_BASE.SKD_DIR_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  AND pl.vsl_lane_cd = cm.slan_cd" ).append("\n"); 
		query.append("##  AND cm.trd_cd IN ('TPS')" ).append("\n"); 
		query.append("##  AND pl.co_cd = 'H'" ).append("\n"); 
		query.append("##  AND cm.trd_cd IN ('TPS')" ).append("\n"); 
		query.append("##    		CSRNO : R200807047819로 의거 조건 추가" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND	CM.VSL_CD = PL.VSL_CD" ).append("\n"); 
		query.append("AND	CM.SKD_VOY_NO = PL.SKD_VOY_NO" ).append("\n"); 
		query.append("AND	CM.DIR_CD  = PL.SKD_DIR_CD" ).append("\n"); 
		query.append("AND	CM.SLAN_CD = PL.VSL_LANE_CD" ).append("\n"); 
		query.append("AND	CM.DELT_FLG = 'N'" ).append("\n"); 
		query.append("AND	MD.TRD_CD = CM.TRD_CD" ).append("\n"); 
		query.append("AND	PL.VSL_LANE_CD  = MD.LANE" ).append("\n"); 
		query.append("AND	PL.SKD_DIR_CD = MD.DIR_CD" ).append("\n"); 
		query.append("AND	SUBSTR(PL.FM_YD_CD,0,5) = ML.LOC_CD" ).append("\n"); 
		query.append("AND	(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(PL.FM_YD_CD,0,5) AND DELT_FLG = 'N' ) = ML.LOC_CD" ).append("\n"); 
		query.append("AND	(SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(PL.TO_YD_CD,0,5) AND DELT_FLG = 'N' ) = MO.LOC_CD" ).append("\n"); 
		query.append("AND	MD.FM_CONTI = ML.CONTI_CD" ).append("\n"); 
		query.append("AND	MD.TO_CONTI = MO.CONTI_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", VSL_LANE_CD" ).append("\n"); 
		query.append(", VVD" ).append("\n"); 
		query.append(", TRADE" ).append("\n"); 
		query.append(", LST_PORT" ).append("\n"); 
		query.append(", LD_DS" ).append("\n"); 
		query.append(",SEQ" ).append("\n"); 
		query.append(")   OUTBOUND" ).append("\n"); 
		query.append("," ).append("\n"); 
		query.append("## INBOUND  FULL구하기" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DS_PLN_YRWK" ).append("\n"); 
		query.append(",DS_VSL_LANE_CD" ).append("\n"); 
		query.append(",DS_LST_PORT" ).append("\n"); 
		query.append(",DS_VVD" ).append("\n"); 
		query.append(",DS_TRADE" ).append("\n"); 
		query.append(",DS_LD_DS" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL 	, 'D2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_FULL , 0)) DS_LOFUL_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL 	, 'D4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_FULL , 0)) DS_LOFUL_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL 	, 'D5', CNTR_QTY_FULL" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_FULL , 0)) DS_LOFUL_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_FULL 	, 'D7', CNTR_QTY_FULL , 0)) DS_LOFUL_45" ).append("\n"); 
		query.append(",SUM(0) DCEMP_20" ).append("\n"); 
		query.append(",SUM(0) DCEMP_40" ).append("\n"); 
		query.append(",SUM(0) DCEMP_HC" ).append("\n"); 
		query.append(",SUM(0) DCEMP_45" ).append("\n"); 
		query.append(",SUM(0) LD_CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(0)                  LD_CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SUM(CNTR_QTY_TEU_LOFULL)   DS_CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(0)                  DS_CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SEQ" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT /*+ FULL(ML) FULL(MO) */" ).append("\n"); 
		query.append("DISTINCT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(CM.LST_LODG_PORT_ETD_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") DS_PLN_YRWK" ).append("\n"); 
		query.append(",CM.TRD_CD              DS_TRADE" ).append("\n"); 
		query.append(",BV.SLAN_CD      DS_VSL_LANE_CD" ).append("\n"); 
		query.append(",BV.POL_CD      ##, BV.VSL_POD_CD" ).append("\n"); 
		query.append(",BV.VSL_CD||BV.SKD_VOY_NO||BV.SKD_DIR_CD  DS_VVD" ).append("\n"); 
		query.append(",CM.LST_LODG_PORT_CD DS_LST_PORT" ).append("\n"); 
		query.append(",BC.CNTR_TPSZ_CD     CNTR_TPSZ_CD_FULL" ).append("\n"); 
		query.append(",BC.CNTR_VOL_QTY    CNTR_QTY_FULL" ).append("\n"); 
		query.append(",TGT_BASE.LD_DS     DS_LD_DS" ).append("\n"); 
		query.append(",TGT_BASE.SEQ" ).append("\n"); 
		query.append(",BC.CNTR_NO     ##    , BC.BKG_NO" ).append("\n"); 
		query.append(",DECODE(BC.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", 'D2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'R2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'O2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'F2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A2', BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='F2' AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S2', BC.CNTR_VOL_QTY *  (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='O2' AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'O4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='F4' AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'A4', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='F4' AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'S4', ( BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='O4' AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'R5', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D7', (BC.CNTR_VOL_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =BC.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))  ,    0) CNTR_QTY_TEU_LOFULL" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("BKG_BOOKING BK" ).append("\n"); 
		query.append(", BKG_VVD BV" ).append("\n"); 
		query.append(", BKG_CONTAINER BC" ).append("\n"); 
		query.append(", COA_MON_VVD CM" ).append("\n"); 
		query.append(", MDM_LOCATION ML" ).append("\n"); 
		query.append(", MDM_LOCATION MO" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT SUBSTR(RLANE_CD,1,3) LANE" ).append("\n"); 
		query.append(", VSL_SLAN_DIR_CD DIR_CD" ).append("\n"); 
		query.append(", FM_CONTI_CD FM_CONTI" ).append("\n"); 
		query.append(", TO_CONTI_CD TO_CONTI" ).append("\n"); 
		query.append(", TRD_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_DTL_REV_LANE" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("DELT_FLG='N'" ).append("\n"); 
		query.append("AND SUB_TRD_CD NOT IN ('IP')" ).append("\n"); 
		query.append(") MD" ).append("\n"); 
		query.append(", VSK_VSL_PORT_SKD VP" ).append("\n"); 
		query.append(", TGT_INBOUND TGT_BASE" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("CM.DELT_FLG = 'N'" ).append("\n"); 
		query.append("##  AND cm.trd_cd IN ('TPS')" ).append("\n"); 
		query.append("##    		CSRNO : R200807047819로 의거 조건 추가" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND BK.BKG_NO = BV.BKG_NO" ).append("\n"); 
		query.append("AND BK.BKG_NO = BC.BKG_NO" ).append("\n"); 
		query.append("##AND bk.bkg_no_split = bv.bkg_no_split" ).append("\n"); 
		query.append("##AND bk.bkg_no_split = bc.bkg_no_split" ).append("\n"); 
		query.append("AND BK.BKG_CGO_TP_CD IN ('F')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND CM.VSL_CD = BV.VSL_CD" ).append("\n"); 
		query.append("AND CM.SKD_VOY_NO = BV.SKD_VOY_NO" ).append("\n"); 
		query.append("AND CM.DIR_CD  = BV.SKD_DIR_CD" ).append("\n"); 
		query.append("AND CM.SLAN_CD = BV.SLAN_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND VP.VSL_CD  = TGT_BASE.VSL_CD" ).append("\n"); 
		query.append("AND VP.SKD_VOY_NO = TGT_BASE.SKD_VOY_NO" ).append("\n"); 
		query.append("AND VP.SKD_DIR_CD = TGT_BASE.SKD_DIR_CD" ).append("\n"); 
		query.append("AND VP.SLAN_CD =  TGT_BASE.SLAN_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("AND BV.VSL_CD = CM.VSL_CD" ).append("\n"); 
		query.append("AND BV.SKD_VOY_NO = CM.SKD_VOY_NO" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD = CM.DIR_CD" ).append("\n"); 
		query.append("AND BV.SLAN_CD  = CM.SLAN_CD" ).append("\n"); 
		query.append("AND BV.VSL_CD = VP.VSL_CD" ).append("\n"); 
		query.append("AND BV.SKD_VOY_NO = VP.SKD_VOY_NO" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD = VP.SKD_DIR_CD" ).append("\n"); 
		query.append("AND BV.POL_CD = VP.VPS_PORT_CD" ).append("\n"); 
		query.append("AND BV.SLAN_CD    = VP.SLAN_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##      and VSL_PRE_PST_CD ='T'" ).append("\n"); 
		query.append("AND BV.VSL_CD =TGT_BASE.VSL_CD" ).append("\n"); 
		query.append("AND BV.SKD_VOY_NO =TGT_BASE.SKD_VOY_NO" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD =TGT_BASE.SKD_DIR_CD" ).append("\n"); 
		query.append("AND BV.SLAN_CD    =TGT_BASE.SLAN_CD" ).append("\n"); 
		query.append("AND BV.POL_CD = ML.LOC_CD" ).append("\n"); 
		query.append("AND BV.POD_CD = MO.LOC_CD" ).append("\n"); 
		query.append("AND MD.TRD_CD = CM.TRD_CD" ).append("\n"); 
		query.append("AND BV.SLAN_CD  = MD.LANE" ).append("\n"); 
		query.append("AND BV.SLAN_CD  = CM.SLAN_CD" ).append("\n"); 
		query.append("AND BV.SKD_DIR_CD = MD.DIR_CD" ).append("\n"); 
		query.append("AND MD.FM_CONTI = ML.CONTI_CD" ).append("\n"); 
		query.append("AND MD.TO_CONTI = MO.CONTI_CD" ).append("\n"); 
		query.append("AND BK.BKG_STS_CD NOT IN 'X'" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("DS_PLN_YRWK" ).append("\n"); 
		query.append(", DS_TRADE" ).append("\n"); 
		query.append(", DS_VSL_LANE_CD" ).append("\n"); 
		query.append(", DS_VVD" ).append("\n"); 
		query.append(", DS_LST_PORT" ).append("\n"); 
		query.append(", DS_LD_DS" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("UNION ALL     ## (4)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DS_PLN_YRWK" ).append("\n"); 
		query.append(",DS_VSL_LANE_CD" ).append("\n"); 
		query.append(",DS_LST_PORT" ).append("\n"); 
		query.append(",DS_VVD" ).append("\n"); 
		query.append(",DS_TRADE" ).append("\n"); 
		query.append(",DS_LD_DS" ).append("\n"); 
		query.append(",SUM(0) DS_LOFUL_20" ).append("\n"); 
		query.append(",SUM(0) DS_LOFUL_40" ).append("\n"); 
		query.append(",SUM(0) DS_LOFUL_HC" ).append("\n"); 
		query.append(",SUM(0) DS_LOFUL_45" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP 	, 'D2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S2', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A2', CNTR_QTY_EMP , 0)) DS_LOEMP_20" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP 	, 'D4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'O4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'A4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'S4', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'F4', CNTR_QTY_EMP , 0)) DS_LOEMP_40" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP 	, 'D5', CNTR_QTY_EMP" ).append("\n"); 
		query.append(", 'R5', CNTR_QTY_EMP , 0)) DS_LOEMP_HC" ).append("\n"); 
		query.append(",SUM(DECODE(CNTR_TPSZ_CD_EMP 	, 'D7', CNTR_QTY_EMP , 0)) DS_LOEMP_45" ).append("\n"); 
		query.append(",SUM(0) LD_CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(0) LD_CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SUM(0) DS_CNTR_TEU_LOFUL" ).append("\n"); 
		query.append(",SUM(CNTR_QTY_TEU_DCEMP)   DS_CNTR_TEU_LOEMP" ).append("\n"); 
		query.append(",SEQ" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("TO_CHAR(CM.LST_LODG_PORT_ETD_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT" ).append("\n"); 
		query.append(") DS_PLN_YRWK" ).append("\n"); 
		query.append(",PL.CO_CD            DS_CO_CD" ).append("\n"); 
		query.append(",CM.TRD_CD              DS_TRADE" ).append("\n"); 
		query.append(",PL.VSL_LANE_CD      DS_VSL_LANE_CD" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_EQ_ORZ_CHT" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCC_CD = SUBSTR(PL.FM_YD_CD,0,5)" ).append("\n"); 
		query.append("AND DELT_FLG = 'N'" ).append("\n"); 
		query.append(") DS_PORT" ).append("\n"); 
		query.append(",PL.VSL_CD||PL.SKD_VOY_NO||PL.SKD_DIR_CD  DS_VVD" ).append("\n"); 
		query.append(",CM.LST_LODG_PORT_CD DS_LST_PORT" ).append("\n"); 
		query.append(",Q.CNTR_TPSZ_CD       CNTR_TPSZ_CD_EMP" ).append("\n"); 
		query.append(",Q.CNTR_QTY          CNTR_QTY_EMP" ).append("\n"); 
		query.append(",TGT_BASE.LD_DS      DS_LD_DS" ).append("\n"); 
		query.append(",TGT_BASE.SEQ" ).append("\n"); 
		query.append(",DECODE(Q.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", 'D2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'R2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'O2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'F2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'A2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='F2' AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S2', Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='O2' AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'O4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='F4' AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'F4', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'A4',  Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='F4' AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'S4',  Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD ='O4' AND TEU_CMPU_TP_CD='EB')" ).append("\n"); 
		query.append(", 'D5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'R5', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))" ).append("\n"); 
		query.append(", 'D7', (Q.CNTR_QTY * (SELECT  TEU_FCTR_RT FROM EQR_ENG_INP_TEU_EQV WHERE CNTR_TPSZ_CD =Q.CNTR_TPSZ_CD AND TEU_CMPU_TP_CD='EB'))  ,    0) CNTR_QTY_TEU_DCEMP" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN PL" ).append("\n"); 
		query.append(", EQR_VSL_EXE_PLN_QTY Q" ).append("\n"); 
		query.append(", COA_MON_VVD CM" ).append("\n"); 
		query.append(", MDM_LOCATION ML" ).append("\n"); 
		query.append(", MDM_LOCATION MO" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT SUBSTR(RLANE_CD,1,3) LANE" ).append("\n"); 
		query.append(", VSL_SLAN_DIR_CD DIR_CD" ).append("\n"); 
		query.append(", FM_CONTI_CD FM_CONTI" ).append("\n"); 
		query.append(", TO_CONTI_CD TO_CONTI" ).append("\n"); 
		query.append(", TRD_CD" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("MDM_DTL_REV_LANE" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("DELT_FLG='N'" ).append("\n"); 
		query.append("AND SUB_TRD_CD NOT IN ('IP')" ).append("\n"); 
		query.append(") MD" ).append("\n"); 
		query.append(", TGT_INBOUND TGT_BASE" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PL.REPO_PLN_ID = Q.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PL.PLN_YRWK = Q.PLN_YRWK" ).append("\n"); 
		query.append("AND PL.PLN_SEQ = Q.PLN_SEQ" ).append("\n"); 
		query.append("AND PL.REF_ID = Q.REF_ID" ).append("\n"); 
		query.append("AND PL.VSL_CD =TGT_BASE.VSL_CD" ).append("\n"); 
		query.append("AND PL.SKD_VOY_NO =TGT_BASE.SKD_VOY_NO" ).append("\n"); 
		query.append("AND PL.SKD_DIR_CD =TGT_BASE.SKD_DIR_CD" ).append("\n"); 
		query.append("##  AND pl.vsl_lane_cd = cm.slan_cd ##AND cm.trd_cd IN ('TPS')  ##  AND pl.co_cd = 'H'     AND cm.trd_cd IN ('TPS')" ).append("\n"); 
		query.append("##    		CSRNO : R200807047819로 의거 조건 추가" ).append("\n"); 
		query.append("#if(${locOrTrade} != '1')" ).append("\n"); 
		query.append("#if(${trade} != '')" ).append("\n"); 
		query.append("AND CM.TRD_CD IN( ${arrTradeStr} )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND CM.VSL_CD = PL.VSL_CD" ).append("\n"); 
		query.append("AND CM.SKD_VOY_NO = PL.SKD_VOY_NO" ).append("\n"); 
		query.append("AND CM.DIR_CD  = PL.SKD_DIR_CD" ).append("\n"); 
		query.append("AND CM.SLAN_CD = PL.VSL_LANE_CD" ).append("\n"); 
		query.append("AND CM.DELT_FLG = 'N'" ).append("\n"); 
		query.append("AND MD.TRD_CD = CM.TRD_CD" ).append("\n"); 
		query.append("AND PL.VSL_LANE_CD  = MD.LANE" ).append("\n"); 
		query.append("AND PL.SKD_DIR_CD = MD.DIR_CD" ).append("\n"); 
		query.append("AND SUBSTR(PL.FM_YD_CD,0,5) = ML.LOC_CD" ).append("\n"); 
		query.append("AND (SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(PL.FM_YD_CD,0,5) AND DELT_FLG = 'N' ) = ML.LOC_CD" ).append("\n"); 
		query.append("AND (SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(PL.TO_YD_CD,0,5) AND DELT_FLG = 'N' ) = MO.LOC_CD" ).append("\n"); 
		query.append("AND MD.FM_CONTI = ML.CONTI_CD" ).append("\n"); 
		query.append("AND MD.TO_CONTI = MO.CONTI_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("DS_PLN_YRWK" ).append("\n"); 
		query.append(", DS_VSL_LANE_CD" ).append("\n"); 
		query.append(", DS_VVD, DS_TRADE" ).append("\n"); 
		query.append(", DS_LST_PORT" ).append("\n"); 
		query.append(", DS_LD_DS" ).append("\n"); 
		query.append(", SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")  INBOUND" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("OUTBOUND.SEQ = INBOUND.SEQ(+)" ).append("\n"); 
		query.append("AND OUTBOUND.TRADE = INBOUND.DS_TRADE(+)" ).append("\n"); 
		query.append("AND OUTBOUND.VSL_LANE_CD = INBOUND.DS_VSL_LANE_CD(+)" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("OUTBOUND.TRADE" ).append("\n"); 
		query.append(",OUTBOUND.VSL_LANE_CD" ).append("\n"); 
		query.append(",OUTBOUND.LST_PORT" ).append("\n"); 
		query.append(",OUTBOUND.VVD" ).append("\n"); 
		query.append(",OUTBOUND.PLN_YRWK" ).append("\n"); 
		query.append(",OUTBOUND.LD_DS" ).append("\n"); 
		query.append(",INBOUND.DS_TRADE" ).append("\n"); 
		query.append(",INBOUND.DS_VSL_LANE_CD" ).append("\n"); 
		query.append(",INBOUND.DS_LST_PORT" ).append("\n"); 
		query.append(",INBOUND.DS_VVD" ).append("\n"); 
		query.append(",INBOUND.DS_PLN_YRWK" ).append("\n"); 
		query.append(",INBOUND.DS_LD_DS" ).append("\n"); 

	}
	/**
	 * Query 생성
	 */
	public void setQuery2(){
		query.append("" ).append("\n"); 
		query.append(") MATCH_DATA" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT '1' NO FROM DUAL" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT '2' NO FROM DUAL" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT '3' NO FROM DUAL" ).append("\n"); 
		query.append(") X" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  CSRNO : N200806030017 의거 추가  끝" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end ##" ).append("\n"); 

	}
}