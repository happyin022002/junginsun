<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="VslResidualSpaceManageDBDAOSearchBSPortInfoRSQL">
			<desc><![CDATA[EQR_SCNR_BSA_PORT 테이블에서 scnr bsa port정보 조회]]></desc>
			<sql><![CDATA[
#if(${st_key} == 'Y')
    SELECT  	
        MAX(DECODE ( rumm , 1 ,VSL_PORT_CALL_SEQ)) VESSEL_PORT_CALL_SEQUENCE ,                                        
        MAX(DECODE (CO_CD , @[company_code] ,VSL_PORT_CD))   VESSEL_PORT_CODE,                                   
        MAX(DECODE (CO_CD , @[company_code] ,VSL_PORT_SPC))  VESSEL_PORT_SPACE,                                      
        MAX(DECODE (CO_CD , @[company_code] ,VSL_PORT_AVG_WGT)) VESSEL_PORT_AVERAGE_WEIGHT,      
        MAX(DECODE (CO_CD , @[company_code1] ,VSL_PORT_CD))   VESSEL_PORT_CODE1,                                     
        MAX(DECODE (CO_CD , @[company_code1] ,VSL_PORT_SPC))  VESSEL_PORT_SPACE1,                                        
        MAX(DECODE (CO_CD , @[company_code1] ,VSL_PORT_AVG_WGT)) VESSEL_PORT_AVERAGE_WEIGHT1,                                   
        SCNR_ID,                               
        FM_YRWK FROM_YEAR_WEEK ,                                
        TO_YRWK TO_YEAR_WEEK,                                
        VSL_CD,                                  
        SKD_VOY_NO,                               
        SKD_DIR_CD,                                  
        MAX(DECODE (CO_CD , @[company_code] ,CO_CD)) COMPANY_CODE ,    
		TRD_CD TRADE_CODE ,
        @[st_key] V                             		 
    FROM                                         
        (
        SELECT                                                                               
            VSL_PORT_CALL_SEQ,                                               
            VSL_PORT_CD,                                                     
            VSL_PORT_SPC,                            
            VSL_PORT_AVG_WGT,                                 
            SCNR_ID,                                          
            FM_YRWK,                                          
            TO_YRWK,                                          
            VSL_CD,                                           
            SKD_VOY_NO,                                       
            SKD_DIR_CD,                                       
            CO_CD,           
			TRD_CD ,                                 
            ROW_NUMBER() OVER (PARTITION BY CO_CD ,VSL_PORT_CALL_SEQ  ORDER BY ROWNUM) RUMM                                         
        FROM 
            EQR_SCNR_BSA_PORT                                 
        WHERE                                              
            SCNR_ID = @[scnr_id]                                        
            AND FM_YRWK    = @[fm_yrwk]                                 
            AND TO_YRWK    = @[to_yrwk]                                   
            AND VSL_CD     = @[vsl_cd]                                     
            AND SKD_VOY_NO = @[skd_voy_no]                                      
            AND SKD_DIR_CD = @[skd_dir_cd]                                       
            AND TRD_CD     = @[trade_code]                                       
            AND CO_CD      = @[co_cd]                             
        )                                                                     
    GROUP BY 
        rumm 
        ,VSL_PORT_CALL_SEQ
        , FM_YRWK,TO_YRWK
        , VSL_CD
        , SKD_VOY_NO
        , SKD_DIR_CD
        , SKD_DIR_CD
        , SCNR_ID    
		, TRD_CD                                                       
    ORDER BY 
        TO_NUMBER(VSL_PORT_CALL_SEQ)                              
#else

    SELECT                                                 
        VSL_PORT_CALL_SEQ VESSEL_PORT_CALL_SEQUENCE,                               
        VSL_PORT_CD VESSEL_PORT_CODE,                                     
        VSL_PORT_SPC VESSEL_PORT_SPACE,                                    
        VSL_PORT_AVG_WGT VESSEL_PORT_AVERAGE_WEIGHT,                                
        '' VESSEL_PORT_CODE1,                                     
        '' VESSEL_PORT_SPACE1,                                    
        '' VESSEL_PORT_AVERAGE_WEIGHT1,                                
        SCNR_ID,                                         
        FM_YRWK FROM_YEAR_WEEK,                                         
        TO_YRWK TO_YEAR_WEEK,                                         
        VSL_CD,                                          
        SKD_VOY_NO,                                      
        SKD_DIR_CD,                                      
        CO_CD COMPANY_CODE,   
		TRD_CD TRADE_CODE ,                                        
        @[st_key] CHECKED                               
    FROM 
        EQR_SCNR_BSA_PORT                                
    WHERE 
        SCNR_ID = @[scnr_id]                                
        AND FM_YRWK    = @[fm_yrwk]                         
        AND TO_YRWK    = @[to_yrwk]                         
        AND VSL_CD     = @[vsl_cd]                         
        AND SKD_VOY_NO = @[skd_voy_no]                         
        AND SKD_DIR_CD = @[skd_dir_cd]                         
        AND TRD_CD     = @[trade_code]                                      
        AND CO_CD      = @[co_cd]          
    ORDER BY 
        TO_NUMBER(VSL_PORT_CALL_SEQ) ASC             
#end			]]></sql>
			<params>
				<param name="company_code" type="12" value="" out="N"/>
				<param name="company_code1" type="12" value="" out="N"/>
				<param name="st_key" type="12" value="" out="N"/>
				<param name="scnr_id" type="12" value="" out="N"/>
				<param name="fm_yrwk" type="12" value="" out="N"/>
				<param name="to_yrwk" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="trade_code" type="12" value="" out="N"/>
				<param name="co_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
