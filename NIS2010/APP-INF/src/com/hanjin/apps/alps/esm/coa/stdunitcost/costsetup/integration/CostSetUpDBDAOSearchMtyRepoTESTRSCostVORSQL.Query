<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CostSetUpDBDAOSearchMtyRepoTESTRSCostVORSQL">
			<desc><![CDATA[MtyRepoTESTRSCostVO 생성]]></desc>
			<sql><![CDATA[
SELECT A.COST_YRMON
     , A.COST_WK                -- WK
     , B.APLY_ADJ_PL_FLG       -- Apply to adjusted P&L
     , B.MTY_TML_MNL_AMT
     , B.MTY_TRSP_MNL_AMT
     , NVL(B.MTY_TML_MNL_AMT,0) + NVL(B.MTY_TRSP_MNL_AMT,0) MTY_TTL_MNL_AMT
     , B.MTY_TML_IF_AMT
     , B.MTY_TRSP_IF_AMT
     , NVL(B.MTY_TML_IF_AMT,0) + NVL(B.MTY_TRSP_IF_AMT,0) MTY_TTL_IF_AMT
     , '' AS SEL_FLG
     , '' AS USER_ID
     , A.SLS_FM_DT
     , B.MTY_TML_CRE_BSE_IF_AMT
     , B.MTY_TRSP_CRE_BSE_IF_AMT
     , NVL(B.MTY_TML_CRE_BSE_IF_AMT,0) + NVL(B.MTY_TRSP_CRE_BSE_IF_AMT,0) MTY_TTL_CRE_IF_AMT
  FROM (
         SELECT DISTINCT A.COST_YRMON
              , A.COST_WK
              , B.SLS_FM_DT
           FROM COA_MON_VVD A
              , (
                 SELECT COST_WK
                      , SLS_FM_DT
                   FROM COA_WK_PRD
                  WHERE SLS_FM_DT BETWEEN TO_CHAR(TO_DATE(@[f_cost_yrmon], 'YYYYMM') - 90, 'YYYYMMDD') AND TO_CHAR(TO_DATE(@[f_cost_yrmon], 'YYYYMM') + 210, 'YYYYMMDD')
                  AND COST_YR BETWEEN SUBSTR(@[f_cost_yrmon],1,4)-1 AND SUBSTR(@[f_cost_yrmon],1,4)+1
                ) B
          WHERE A.COST_YRMON = @[f_cost_yrmon]
            AND A.DELT_FLG   = 'N'
            AND a.COST_WK    = B.COST_WK
      ) A
      , COA_MTY_REPO_COST_DTL B
  WHERE A.COST_YRMON = B.COST_YRMON(+)
    AND A.COST_WK = B.COST_WK(+)
ORDER BY A.SLS_FM_DT			]]></sql>
			<params>
				<param name="f_cost_yrmon" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
