<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DubaiCustomsTransmissionDBDAOsearchFlatFileVvdInfoRSQL">
			<desc><![CDATA[두바이 FlatFile 배정보 조회]]></desc>
			<sql><![CDATA[
SELECT 
	VSL_CD
,	SKD_VOY_NO
,	SKD_DIR_CD

#if (${pod_cd} == 'AEAUH' || ${pod_cd} == 'AEJEA' || ${pod_cd} == 'AESHJ') 	 
	  ,(SELECT NVL(UN_LOC_CD, POL_CD) FROM MDM_LOCATION WHERE LOC_CD = POL_CD) POL_CD 
	  ,(SELECT NVL(UN_LOC_CD, POD_CD) FROM MDM_LOCATION WHERE LOC_CD = POD_CD) POD_CD  
#else 
	  ,	POL_CD
	  ,	POD_CD
#end
,	CLPT_SEQ
,	SUBSTR(VSL_NM, 1, 30) AS VSL_NM
,	DU_LINE_ID
,	DU_VOY_AGN_ID
,	DU_ROTN_NO
#if (${pod_cd} != 'AEAUH') 
,	TO_CHAR(ETA_DT, 'DD-MON-YYYY', 'NLS_DATE_LANGUAGE = American') AS ETA_DT
#else 
,	TO_CHAR(ETA_DT, 'DD-MM-YYYY', 'NLS_DATE_LANGUAGE = American') AS ETA_DT
#end
,	DU_MSG_TP_ID
,	DU_INSTL_NO
,	DU_MF_SEQ_NO
,	CRE_USR_ID
,	CRE_DT
,	UPD_USR_ID
,	UPD_DT
FROM BKG_CSTMS_DU_VVD
WHERE	VSL_CD = @[vsl_cd]
AND	SKD_VOY_NO = @[skd_voy_no]
AND	SKD_DIR_CD = @[skd_dir_cd]
AND	POD_CD = @[pod_cd]
AND CLPT_SEQ = (
                    SELECT MAX(CLPT_SEQ)
                      FROM BKG_CSTMS_DU_VVD
                     WHERE VSL_CD = @[vsl_cd]
                       AND SKD_VOY_NO = @[skd_voy_no]
                       AND SKD_DIR_CD = @[skd_dir_cd]
                       AND POD_CD = @[pod_cd]
                ) 			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
