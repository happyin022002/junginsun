<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="NetworkCostDBDAOSearchFixCostByVVDListRSQL">
			<desc><![CDATA[archFixCostByVVDList SELECT
History ----------------------------
2011.02.21 김상수 [CHM-201108827-01] 1. R.month/Week 및 OPR/OPR2 정보 보여주는 컬럼 추가
                                     2. Re-Assignment by bound, Re-Assignment by bound(OP4)
                                        화면상에서 틀고정 기능 추가
                                     3. js상의 validation함수 정리 및  coMas.js로 소스이동
2015.03.05 김시몬 [CHM-201533657] '72100000' Interest 계정 추가]]></desc>
			<sql><![CDATA[
SELECT
#if (${f_chkprd} == 'M')
       A1.COST_YRMON||A1.COST_WK||A1.TRD_CD||A1.RLANE_CD||A1.IOC_CD||A1.VSL_CD||A1.SKD_VOY_NO||A1.DIR_CD AS SUBSUM_CODE,
#elseif (${f_chkprd} == 'W')
       A1.SLS_YRMON||A1.COST_WK||A1.TRD_CD||A1.RLANE_CD||A1.IOC_CD||A1.VSL_CD||A1.SKD_VOY_NO||A1.DIR_CD AS SUBSUM_CODE,
#end
       A1.SLS_YRMON,
       A1.COST_YRMON,
       A1.COST_WK,
       CV.VOP_CD,
       CV.VSL_OSHP_CD,
       A1.TRD_CD,
       A1.RLANE_CD,
       A1.IOC_CD,
       A1.VSL_CD,
       A1.SKD_VOY_NO,
	   CV.VSL_CLSS_CAPA,
       A1.DIR_CD,
	  (SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD03217' AND INTG_CD_VAL_CTNT = D.HUL_BND_CD) HUL_BND_CD,
       NVL ( (SELECT Y.CONTI_NM
                FROM MDM_LOCATION X,
                     MDM_CONTINENT Y
               WHERE X.CONTI_CD = Y.CONTI_CD
                 AND X.LOC_CD = A2.LOC_CD),
            '') AS CONTI_NM,
       A2.LOC_CD,    /* Port */
       A2.VSL_DBL_CALL_SEQ,    /* Call IND */
       A2.CLPT_SEQ,    /* Call SEQ */
       A2.APLY_VOY_RTO,    /* Apply(%) */
       SUM (CASE WHEN (A2.STND_COST_CD = '53101000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_01,                /* Port Expense */
       SUM (CASE WHEN (A2.STND_COST_CD = '53102000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_02,                /* Canal Transit Fee */
       A2.PORT_DYS,    /* Port Days */
       A2.SEA_DYS,    /* Sea Days */
       A2.TTL_TZ_DYS,    /* Total Days */
       SUM (CASE WHEN (A2.STND_COST_CD = '53200000') THEN A2.FOIL_CSM * A2.TTL_TZ_DYS ELSE 0 END) AS AMT_13,    /* FO Cons.*/
       SUM (CASE WHEN (A2.STND_COST_CD = '53200000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_03,                /* Bunker */
       SUM (CASE WHEN (A2.STND_COST_CD = '54100000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_04,                /* Crew Expense */
       SUM (CASE WHEN (A2.STND_COST_CD = '54250000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_05,                /* Insurance */
       SUM (CASE WHEN (A2.STND_COST_CD = '54300000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_06,                /* Lubricant Expense */
       SUM (CASE WHEN (A2.STND_COST_CD = '54200000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_07,                /* Store Supply Expense */
       SUM (CASE WHEN (A2.STND_COST_CD = '54150000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_08,                /* Vessel MnR */
       SUM (CASE WHEN (A2.STND_COST_CD = '54450000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_09,                /* Deprecations */
       SUM (CASE WHEN (A2.STND_COST_CD = '54180000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_10,                /* Telecom Expense */
       SUM (CASE WHEN (A2.STND_COST_CD = '54550000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_11,                /* Other Operation Fixed Exp */
       SUM (CASE WHEN (A2.STND_COST_CD = '54350000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_12,                /* Time Charterage */
       SUM (CASE WHEN (A2.STND_COST_CD = '72100000') THEN A2.VSL_COST_AMT ELSE 0 END) AS AMT_14                 /* Interest */
  FROM MAS_MON_VVD A1,
       MAS_MON_VVD_PORT_COST A2,
       MAS_VSL_RGST CV,
	   (SELECT TRD_CD, RLANE_CD, IOC_CD, DIR_CD, HUL_BND_CD FROM MAS_LANE_RGST) D
 WHERE A1.TRD_CD = A2.TRD_CD    /* A2 */
   AND A1.RLANE_CD = A2.RLANE_CD
   AND A1.IOC_CD = A2.IOC_CD
   AND A1.VSL_CD = A2.VSL_CD
   AND A1.SKD_VOY_NO = A2.SKD_VOY_NO
   AND A1.DIR_CD = A2.DIR_CD
   AND NVL (A1.DELT_FLG, 'N') = 'N'
	AND A1.TRD_CD          = D.TRD_CD
	AND A1.RLANE_CD        = D.RLANE_CD
    AND A1.IOC_CD          = D.IOC_CD
    AND A1.DIR_CD          = D.DIR_CD
#if (${f_seltrade} != '')
   AND A1.TRD_CD = @[f_seltrade]
#end
#if (${f_selrlane} != '')
   AND A1.RLANE_CD = @[f_selrlane]
#end
#if (${f_selioc} != '')
   AND A1.IOC_CD = @[f_selioc]
#end
#if (${f_vsl_cd} != '')
   AND A1.VSL_CD = @[f_vsl_cd]
#end
#if (${f_skd_voy_no} != '')
   AND A1.SKD_VOY_NO = @[f_skd_voy_no]
#end
#if (${f_dir_cd} != '')
   AND A1.DIR_CD = @[f_dir_cd]
#end
#if (${f_chkprd} == 'M')
   #if (${f_year} != '')
        AND A1.COST_YRMON BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]
   #else
        AND A1.COST_YRMON LIKE @[f_year]||'%'
   #end
#elseif (${f_chkprd} == 'W')
   AND A1.SLS_YRMON LIKE @[f_year]||'%'
   #if (${f_fm_wk} != '')
        AND A1.COST_WK BETWEEN @[f_fm_wk] AND @[f_to_wk]
   #end
#end
   AND CV.VSL_CD = A1.VSL_CD
   AND A1.N1ST_LODG_PORT_ETD_DT BETWEEN TO_DATE (TO_CHAR (CV.VSL_APLY_FM_DT, 'YYYY-MM-DD'), 'YYYY-MM-DD') AND TO_DATE (TO_CHAR (CV.VSL_APLY_TO_DT, 'YYYY-MM-DD'), 'YYYY-MM-DD')
GROUP BY A1.SLS_YRMON,
         A1.COST_YRMON,
         A1.COST_WK,
         CV.VOP_CD,
         CV.VSL_OSHP_CD,
         A1.TRD_CD,
         A1.RLANE_CD,
         A1.IOC_CD,
         A1.VSL_CD,
         A1.SKD_VOY_NO,
         A1.DIR_CD,
		 d.HUL_BND_CD,
		 CV.VSL_CLSS_CAPA,
         A2.LOC_CD,
         A2.VSL_DBL_CALL_SEQ,
         A2.CLPT_SEQ,
         A2.APLY_VOY_RTO,
         A2.SEA_DYS,
         A2.PORT_DYS,
         A2.TTL_TZ_DYS
ORDER BY
#if (${f_chkprd} == 'M')
         A1.COST_YRMON,
#elseif (${f_chkprd} == 'W')
         A1.SLS_YRMON,
#end
         A1.COST_WK,
         A1.TRD_CD,
         A1.RLANE_CD,
         A1.IOC_CD,
         A1.VSL_CD,
         A1.SKD_VOY_NO,
         A1.DIR_CD,
         A2.CLPT_SEQ			]]></sql>
			<params>
				<param name="f_seltrade" type="12" value="" out="N"/>
				<param name="f_selrlane" type="12" value="" out="N"/>
				<param name="f_selioc" type="12" value="" out="N"/>
				<param name="f_vsl_cd" type="12" value="" out="N"/>
				<param name="f_skd_voy_no" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_year" type="12" value="" out="N"/>
				<param name="f_fm_mon" type="12" value="" out="N"/>
				<param name="f_to_mon" type="12" value="" out="N"/>
				<param name="f_fm_wk" type="12" value="" out="N"/>
				<param name="f_to_wk" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
