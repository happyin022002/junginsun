<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SpecialCargoReceiptDBDAOBkgBbCgoVORSQL">
			<desc><![CDATA[BkgBbCgoVO]]></desc>
			<sql><![CDATA[
#if (${ca_flg}== 'Y')

SELECT 
	a.BKG_NO
,	a.BB_CGO_SEQ
,	a.RCV_TERM_CD
,	a.DE_TERM_CD
,	a.PCK_QTY
,	a.PCK_TP_CD
,	a.GRS_WGT
,	a.NET_WGT
,	a.WGT_UT_CD
,	a.DIM_LEN
,	a.DIM_WDT
,	a.DIM_HGT
,	a.CGO_WGT
,	a.STWG_INSTR_DESC
,	a.BB_DCGO_SEQ
,	a.CMDT_CD
,	b.CMDT_NM
,	a.SLNG_PNT_FLG
,	a.GRAV_CTR_DESC
,	a.PCK_DTL_DESC
,	a.CGO_LODG_MZD_CD
,	a.SCR_DNG_CTNT
,	a.SPCL_RQST_DESC
,	a.DIFF_RMK
,	a.RQST_DT
,	a.RQST_USR_ID
,	a.SPCL_CGO_APRO_CD
,	a.CRE_USR_ID
,	a.CRE_DT
,	a.UPD_USR_ID
,	a.UPD_DT
,   a.CGO_DCHG_MZD_CD
,	a.CGO_DCHG_SD_CD
,	a.CGO_LODG_SD_CD
,   c.POR_CD
,   c.DEL_CD
,	(SELECT CNTR_CGO_SEQ FROM BKG_DG_CGO_HIS WHERE BKG_NO = @[bkg_no] AND CORR_NO = 'TMP0000001' AND DCGO_SEQ = BB_DCGO_SEQ) CNTR_CGO_SEQ
      ,(SELECT M.APRO_REF_NO 
          FROM SCG_AUTHORIZATION M 
              ,(SELECT MAX(SPCL_CGO_APRO_RQST_SEQ) SPCL_CGO_APRO_RQST_SEQ
                     , MIN(VSL_PRE_PST_CD||VSL_SEQ) VSL_PRE_PST_CD
                     , MAX(SPCL_CGO_AUTH_SEQ) AS SPCL_CGO_AUTH_SEQ
                     , BB_CGO_SEQ
                 FROM SCG_AUTHORIZATION 
                WHERE BKG_NO = @[bkg_no]
                  AND SPCL_CGO_CATE_CD = 'BB'
                GROUP BY BB_CGO_SEQ) N 
         WHERE M.SPCL_CGO_APRO_RQST_SEQ = N.SPCL_CGO_APRO_RQST_SEQ 
           AND M.VSL_PRE_PST_CD||M.VSL_SEQ = N.VSL_PRE_PST_CD 
           AND M.SPCL_CGO_AUTH_SEQ = N.SPCL_CGO_AUTH_SEQ
           AND M.BB_CGO_SEQ = N.BB_CGO_SEQ
           AND M.BKG_NO = @[bkg_no]
           AND M.BB_CGO_SEQ = A.BB_CGO_SEQ) APLY_NO 
FROM BKG_BB_CGO_HIS a,  MDM_COMMODITY b, BKG_BKG_HIS c
WHERE	a.BKG_NO = @[bkg_no]
AND 	a.CORR_NO = 'TMP0000001'
AND		a.CORR_NO = c.CORR_NO
AND		a.BKG_NO = c.BKG_NO
AND		a.CMDT_CD = b.CMDT_CD
ORDER BY A.BB_CGO_SEQ
#else

SELECT 
	a.BKG_NO
,	a.BB_CGO_SEQ
,	a.RCV_TERM_CD
,	a.DE_TERM_CD
,	a.PCK_QTY
,	a.PCK_TP_CD
,	a.GRS_WGT
,	a.NET_WGT
,	a.WGT_UT_CD
,	a.DIM_LEN
,	a.DIM_WDT
,	a.DIM_HGT
,	a.CGO_WGT
,	a.STWG_INSTR_DESC
,	a.BB_DCGO_SEQ
,	a.CMDT_CD
,	b.CMDT_NM
,	a.SLNG_PNT_FLG
,	a.GRAV_CTR_DESC
,	a.PCK_DTL_DESC
,	a.CGO_LODG_MZD_CD
,	a.SCR_DNG_CTNT
,	a.SPCL_RQST_DESC
,	a.DIFF_RMK
,	a.RQST_DT
,	a.RQST_USR_ID
,	a.SPCL_CGO_APRO_CD 
,	a.CRE_USR_ID
,	a.CRE_DT
,	a.UPD_USR_ID
,   a.CGO_DCHG_MZD_CD
,	a.CGO_DCHG_SD_CD
,	a.CGO_LODG_SD_CD
,	a.UPD_DT
,   c.POR_CD
,   c.DEL_CD
,	(SELECT CNTR_CGO_SEQ FROM BKG_DG_CGO WHERE BKG_NO = @[bkg_no] AND DCGO_SEQ = BB_DCGO_SEQ) CNTR_CGO_SEQ
      ,(SELECT M.APRO_REF_NO 
          FROM SCG_AUTHORIZATION M 
              ,(SELECT MAX(SPCL_CGO_APRO_RQST_SEQ) SPCL_CGO_APRO_RQST_SEQ
                     , MIN(VSL_PRE_PST_CD||VSL_SEQ) VSL_PRE_PST_CD
                     , MAX(SPCL_CGO_AUTH_SEQ) AS SPCL_CGO_AUTH_SEQ
                     , BB_CGO_SEQ
                 FROM SCG_AUTHORIZATION 
                WHERE BKG_NO = @[bkg_no]
                  AND SPCL_CGO_CATE_CD = 'BB'
                GROUP BY BB_CGO_SEQ) N 
         WHERE M.SPCL_CGO_APRO_RQST_SEQ = N.SPCL_CGO_APRO_RQST_SEQ 
           AND M.VSL_PRE_PST_CD||M.VSL_SEQ = N.VSL_PRE_PST_CD 
           AND M.SPCL_CGO_AUTH_SEQ = N.SPCL_CGO_AUTH_SEQ
           AND M.BB_CGO_SEQ = N.BB_CGO_SEQ
           AND M.BKG_NO = @[bkg_no]
           AND M.BB_CGO_SEQ = A.BB_CGO_SEQ) APLY_NO 
FROM BKG_BB_CGO a,  MDM_COMMODITY b, BKG_BOOKING c
WHERE	a.BKG_NO = @[bkg_no]
AND		a.BKG_NO = c.BKG_NO
AND		a.CMDT_CD = b.CMDT_CD
ORDER BY A.BB_CGO_SEQ

#end			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
