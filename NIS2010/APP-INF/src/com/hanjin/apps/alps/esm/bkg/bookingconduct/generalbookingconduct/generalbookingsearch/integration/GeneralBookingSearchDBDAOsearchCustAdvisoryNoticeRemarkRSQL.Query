<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralBookingSearchDBDAOsearchCustAdvisoryNoticeRemarkRSQL">
			<desc><![CDATA[VVD 별로 기 등록된 Advisory Notice 텍스트 Remark 정보를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT VSL_CD
      ,SKD_VOY_NO
      ,SKD_DIR_CD
      ,VVD
      ,IMPT_NTC_RMK
      ,EML_SUBJ_CTNT
      ,DELT_FLG
      ,CRE_USR_ID
      ,CRE_DT
      ,UPD_USR_ID
      ,UPD_DT
      ,EML_SUBJ_CTNT_SEQ
      ,RMK_USE_FLG
	  ,(SELECT FILE_UPLD_NM FROM COM_UPLD_FILE WHERE FILE_SAV_ID = A.FILE_SAV_ID) FILE_NM
      ,FILE_PATH_RMK
      ,FILE_SAV_ID
      ,FILE_DESC
FROM   (
          SELECT VSL_CD
                ,SKD_VOY_NO
                ,SKD_DIR_CD
                ,VSL_CD || SKD_VOY_NO VVD
                ,IMPT_NTC_RMK
                ,EML_SUBJ_CTNT
                ,DELT_FLG
                ,CRE_USR_ID
                ,TO_CHAR(CRE_DT, 'YYYY-MM-DD') CRE_DT
                ,UPD_USR_ID
                ,UPD_DT
                ,EML_SUBJ_CTNT_SEQ
                ,RMK_USE_FLG
				,FILE_NM
                ,FILE_PATH_RMK
                ,FILE_SAV_ID
                ,FILE_DESC
          FROM   BKG_CUST_AVC_NTC_RMK
          WHERE  VSL_CD     = SUBSTR(@[vvd], 1,4)
          AND    SKD_VOY_NO = SUBSTR(@[vvd], 5,4)
          AND    SKD_DIR_CD = SUBSTR(@[vvd], 9,1)
          AND    OFC_CD = @[ofc_cd]          
       ) A
WHERE  1 = 1

#if (${rmk_use_flg} != '') 
	AND	RMK_USE_FLG = @[rmk_use_flg]
#end


#if (${eml_subj_ctnt_seq} != '') 
	AND EML_SUBJ_CTNT_SEQ = @[eml_subj_ctnt_seq]
#end			]]></sql>
			<params>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="rmk_use_flg" type="12" value="" out="N"/>
				<param name="eml_subj_ctnt_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
