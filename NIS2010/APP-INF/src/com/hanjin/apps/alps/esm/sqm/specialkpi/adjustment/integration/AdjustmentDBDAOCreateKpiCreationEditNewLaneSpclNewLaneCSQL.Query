<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AdjustmentDBDAOCreateKpiCreationEditNewLaneSpclNewLaneCSQL">
			<desc><![CDATA[CreateKpiCreationEditNewLaneSpclNewLane

* 2014.09.17 이혜민 [CHM-201431755-01] New Lane Add시 Bound 삽입]]></desc>
			<sql><![CDATA[
INSERT INTO  SQM_SPCL_NEW_LANE(
         BSE_TP_CD
        ,BSE_YR
        ,BSE_QTR_CD
        ,SPCL_TGT_CD
        ,TRD_CD
        ,RLANE_CD
        ,DIR_CD
        ,RGN_OFC_CD
        ,CONV_DIR_CD
        ,SRC_TRD_CD
        ,SRC_RLANE_CD
        ,LOD_QTY
        ,GRS_RPB_REV
        ,PA_CM_UC_AMT
        ,RA_CM_UC_AMT
        ,CRE_USR_ID
        ,CRE_DT
        ,UPD_USR_ID
        ,UPD_DT
        )
SELECT BSE_TP_CD
      ,BSE_YR
      ,BSE_QTR_CD
      ,SPCL_TGT_CD
      ,TRD_CD                    -- NEW TRADE
      ,@[f_rlane_cd] AS RLANE_CD -- NEW RLANE
      ,DIR_CD
      ,RGN_OFC_CD
      ,CONV_DIR_CD
      ,TRD_CD AS SRC_TRD_CD      -- SOURCE TRADE
      ,RLANE_CD AS SRC_RLANE_CD  -- SOURCE RLANE
      ,AVG(LOD_QTY)
      ,AVG(GRS_RPB_REV)
      ,AVG(PA_CM_UC_AMT)
      ,AVG(RA_CM_UC_AMT)
      ,@[usr_id] AS CRE_USR_ID
      ,SYSDATE   AS CRE_DT
      ,@[usr_id] AS UPD_USR_ID
      ,SYSDATE   AS UPD_DT
  FROM SQM_SPCL_CFM_QTA A1
 WHERE 1=1
   AND TRD_CD      = @[f_trd_cd]        -- SOURCE TRADE
   AND RLANE_CD    = @[f_src_rlane_cd]  -- SOURCE RLANE
   AND BSE_TP_CD   = @[f_bse_tp_cd]     -- Q, Y 필수
   AND BSE_YR      = @[f_bse_yr]        -- 필수
   AND SPCL_TGT_CD = @[f_spcl_tgt_cd]  -- S, R 필수
#if(${f_dir_cd} != '')
   AND DIR_CD      = @[f_dir_cd]
#end
#if(${f_bse_tp_cd} == 'Q')
   AND BSE_QTR_CD  = @[f_bse_qtr_cd] --Quartely일때 필수
#end
GROUP BY BSE_TP_CD
        ,BSE_YR
        ,BSE_QTR_CD --분기 오피스 평균
        ,SPCL_TGT_CD
        ,TRD_CD
        ,RLANE_CD
        ,DIR_CD
        ,RGN_OFC_CD
        ,CONV_DIR_CD			]]></sql>
			<params>
				<param name="f_rlane_cd" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="f_trd_cd" type="12" value="" out="N"/>
				<param name="f_src_rlane_cd" type="12" value="" out="N"/>
				<param name="f_bse_tp_cd" type="12" value="" out="N"/>
				<param name="f_bse_yr" type="12" value="" out="N"/>
				<param name="f_spcl_tgt_cd" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_bse_qtr_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
