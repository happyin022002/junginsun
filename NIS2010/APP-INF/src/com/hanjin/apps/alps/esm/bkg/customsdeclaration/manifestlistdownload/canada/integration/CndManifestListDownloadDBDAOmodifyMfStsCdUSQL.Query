<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CndManifestListDownloadDBDAOmodifyMfStsCdUSQL">
			<desc><![CDATA[modifyMfStsCd]]></desc>
			<sql><![CDATA[
UPDATE  BKG_CSTMS_ADV_BL A
   SET  UPD_USR_ID = @[upd_usr_id]
       ,UPD_DT = SYSDATE
#if (${mf_sts_cd} != '')  
       ,MF_STS_CD  = @[mf_sts_cd]
#end
#if (${cstms_trsm_sts_cd} != '') 
       ,CSTMS_MF_TP_CD = CASE WHEN FULL_MTY_CD = 'M' THEN 'E10'
                              WHEN MF_NO > ' ' THEN 'S10'
                              ELSE 'A6A' END
       ,CSTMS_TRSM_STS_CD = CASE WHEN CSTMS_TRSM_STS_CD IS NULL THEN '00'
                                 WHEN MF_STS_CD = 'D' THEN '03'
                                 WHEN CSTMS_TRSM_STS_CD = '03' AND MF_STS_CD = 'A' THEN '00'
                                 WHEN EXISTS(
                                             SELECT 'X' 
                                               FROM BKG_CSTMS_ADV_RCV_LOG 
                                              WHERE BL_NO  = A.BL_NO
                                                AND CNT_CD = A.CNT_CD
                                                AND CND_ACK_RCV_ID IN ('A', 'E')
                                            ) THEN '04'
                                 ELSE '00' END
       ,MF_SND_DT = DECODE(@[cstms_trsm_sts_cd], '00', TO_DATE(@[upd_dt],'YYYYMMDDHH24MISS'), MF_SND_DT)
       ,AMDT_SND_DT = CASE WHEN @[cstms_trsm_sts_cd] IN('00','03','04') THEN TO_DATE(@[upd_dt],'YYYYMMDDHH24MISS')
                           ELSE AMDT_SND_DT END
       ,CSTMS_ACK_KEY_NO = DECODE(CSTMS_ACK_KEY_NO, NULL, TO_CHAR(SYSDATE,'YMM')||LTRIM(TO_CHAR(BKG_CSTM_EDI_SEQ.NEXTVAL,'000009'),' '), CSTMS_ACK_KEY_NO)
#end 
 WHERE  CNT_CD = 'CA'
   AND  BL_NO  = @[bl_no]			]]></sql>
			<params>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="mf_sts_cd" type="12" value="" out="N"/>
				<param name="cstms_trsm_sts_cd" type="12" value="" out="N"/>
				<param name="upd_dt" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
