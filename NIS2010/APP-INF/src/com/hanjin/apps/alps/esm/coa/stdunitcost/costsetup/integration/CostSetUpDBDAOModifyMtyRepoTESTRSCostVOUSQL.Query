<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CostSetUpDBDAOModifyMtyRepoTESTRSCostVOUSQL">
			<desc><![CDATA[데이터 수정]]></desc>
			<sql><![CDATA[
--================================
-- SAVE - SEL 미 체크시 업데이트
--================================
MERGE INTO COA_MTY_REPO_COST_DTL A USING
(
        SELECT @[cost_yrmon] AS COST_YRMON
             , @[cost_wk] AS COST_WK
             , DECODE(@[aply_adj_pl_flg], '1', 'Y', 'N') AS APLY_ADJ_PL_FLG
             , NVL(@[mty_tml_mnl_amt], 0) AS MTY_TML_MNL_AMT
             , NVL(@[mty_trsp_mnl_amt], 0) AS MTY_TRSP_MNL_AMT
          FROM DUAL      
) B ON ( A.COST_YRMON = B.COST_YRMON 
        AND A.COST_WK = B.COST_WK )
WHEN MATCHED THEN
      UPDATE
         SET A.MTY_TML_MNL_AMT  = B.MTY_TML_MNL_AMT
           , A.MTY_TRSP_MNL_AMT = B.MTY_TRSP_MNL_AMT
           , A.APLY_ADJ_PL_FLG  = B.APLY_ADJ_PL_FLG
           , A.UPD_USR_ID       = @[user_id]
           , A.UPD_DT           = SYSDATE
WHEN NOT MATCHED THEN
    INSERT (
          A.COST_YRMON
        , A.COST_WK
        , A.APLY_ADJ_PL_FLG
        , A.MTY_TML_MNL_AMT
        , A.MTY_TRSP_MNL_AMT
        , A.CRE_USR_ID
        , A.CRE_DT
        , A.UPD_USR_ID
        , A.UPD_DT
    )
    VALUES (
          B.COST_YRMON
        , B.COST_WK
        , B.APLY_ADJ_PL_FLG
        , B.MTY_TML_MNL_AMT
        , B.MTY_TRSP_MNL_AMT
        , @[user_id]
        , SYSDATE
        , @[user_id]
        , SYSDATE
    )

			]]></sql>
			<params>
				<param name="cost_yrmon" type="12" value="" out="N"/>
				<param name="cost_wk" type="12" value="" out="N"/>
				<param name="aply_adj_pl_flg" type="12" value="" out="N"/>
				<param name="mty_tml_mnl_amt" type="12" value="" out="N"/>
				<param name="mty_trsp_mnl_amt" type="12" value="" out="N"/>
				<param name="user_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
