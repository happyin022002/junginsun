<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RFAQuotationMainDBDAORsltPriRqMnVOReportRSQLRSQL">
			<desc><![CDATA[Report Main quiry]]></desc>
			<sql><![CDATA[
SELECT 
	B.QTTN_NO
,	B.QTTN_VER_NO
,	TO_CHAR(B.EFF_DT,'YYYY-MM-DD') AS EFF_DT
,	TO_CHAR(B.EXP_DT, 'YYYY-MM-DD') AS EXP_DT
,	B.SVC_SCP_CD
,	B.CUST_CNT_CD
,	DECODE(LENGTH(B.CUST_SEQ),1,'00000' || B.CUST_SEQ,
							  2,'0000' || B.CUST_SEQ,
							  3,'000' || B.CUST_SEQ,
		 					  4,'00' || B.CUST_SEQ,
 							  5,'0' || B.CUST_SEQ,
 							  6,B.CUST_SEQ) AS CUST_SEQ
,	(SELECT CUST_LGL_ENG_NM 
	FROM MDM_CUSTOMER
	WHERE CUST_CNT_CD   = B.CUST_CNT_CD
	AND   CUST_SEQ      = B.CUST_SEQ
	AND   DELT_FLG		= 'N') AS CUST_NM
--,	B.CNTR_LOD_UT_CD
,	TO_CHAR(DECODE(B.CNTR_LOD_UT_CD, 'F', NVL(B.ESTM_MQC_QTY,0)*0.5, B.ESTM_MQC_QTY),'999,999,999') AS ESTM_MQC_QTY
--,	TO_CHAR(NVL(B.ESTM_CM_AMT,0),'999,999,999.99') AS ESTM_CM_AMT	
,	TO_NUMBER(ROUND(NVL(B.ESTM_CM_AMT,0),0)) AS ESTM_CM_AMT
--,	B.PRC_CUST_TP_CD
,   (SELECT INTG_CD_VAL_DESC
	 FROM   COM_INTG_CD_DTL
	 WHERE  INTG_CD_ID = 'CD02085'
	 AND    INTG_CD_VAL_CTNT = B.PRC_CUST_TP_CD) AS PRC_CUST_TP_CD          --PRC_CUST_TP_CD 명
,	B.QTTN_SREP_CD
,	B.PROP_NO
,	B.PRS_XCH_RT_YRMON
,	A.QTTN_OFC_CD
,	A.QTTN_STS_CD
,   (SELECT INTG_CD_VAL_DESC                         
     FROM   COM_INTG_CD_DTL
     WHERE  INTG_CD_ID = 'CD02195'
     AND    INTG_CD_VAL_CTNT = A.QTTN_STS_CD) AS QTTN_STS_NM              --QUOTATION 상태명
,	B.CRE_USR_ID
,	TO_CHAR(B.CRE_DT, 'YYYY-MM-DD') AS CRE_DT
,	B.UPD_USR_ID
,	B.UPD_DT
,	DECODE(NVL(B.PROP_NO,''),'','No','Yes') AS ISCOPY
,	'' AS QTTN_NO_HIDDEN
,	'' AS QTTN_VER_NO_HIDDEN
,	(SELECT SREP_NM 
	FROM MDM_SLS_REP
	WHERE SREP_CD   = B.QTTN_SREP_CD) AS QTTN_SREP_NM
,	(SELECT SVC_SCP_NM 
	FROM MDM_SVC_SCP
	WHERE SVC_SCP_CD   = B.SVC_SCP_CD
	AND   DELT_FLG	= 'N') AS SVC_SCP_NM
,	'' AS CRE_DT_FROM
,	'' AS CRE_DT_TO
,	'' AS QTTN_STATUS
,   (SELECT INTG_CD_VAL_DESC                         
     FROM   COM_INTG_CD_DTL
     WHERE  INTG_CD_ID = 'CD00897'
     AND    INTG_CD_VAL_CTNT = B.CNTR_LOD_UT_CD) AS CNTR_LOD_UT_CD             --teu, feu
,   SUBSTR(B.QTTN_NO,0,3) AS ORDER1
,   SUBSTR(B.QTTN_NO,4,7) AS ORDER2
FROM PRI_RQ_HDR A
,	 PRI_RQ_MN B
WHERE A.QTTN_NO = B.QTTN_NO
#if (${qttn_no} != '')
AND	B.QTTN_NO = @[qttn_no]
#end
#if (${qttn_ver_no} != '')
AND	B.QTTN_VER_NO = @[qttn_ver_no]
#end
#if (${qttn_ofc_cd} != '')
AND	A.QTTN_OFC_CD = @[qttn_ofc_cd]
#end
#if (${qttn_srep_cd} != '')
AND	B.QTTN_SREP_CD = @[qttn_srep_cd]
#end
#if (${cre_dt_from} != '' && ${cre_dt_to} != '')
AND TO_CHAR(B.CRE_DT, 'YYYY-MM-DD') BETWEEN @[cre_dt_from] AND @[cre_dt_to]
#elseif( ${cre_dt_from} != '' )
AND TO_CHAR(B.CRE_DT, 'YYYY-MM-DD') >   @[cre_dt_from] 
#end
#if (${svc_scp_cd} != '')
AND B.SVC_SCP_CD = @[svc_scp_cd]
#end
#if (${cust_cnt_cd} != '')
AND B.CUST_CNT_CD = @[cust_cnt_cd]
#end
#if (${cust_seq} != '')
AND B.CUST_SEQ = @[cust_seq]
#end
#if (${prc_cust_tp_cd} != '' && ${prc_cust_tp_cd} != 'M')
AND B.PRC_CUST_TP_CD = @[prc_cust_tp_cd]
#end
#if (${qttn_status} != '')
AND A.QTTN_STS_CD = @[qttn_status]
#end
ORDER BY ORDER1, ORDER2 DESC, B.QTTN_VER_NO DESC			]]></sql>
			<params>
				<param name="qttn_no" type="12" value="" out="N"/>
				<param name="qttn_ver_no" type="12" value="" out="N"/>
				<param name="qttn_ofc_cd" type="12" value="" out="N"/>
				<param name="qttn_srep_cd" type="12" value="" out="N"/>
				<param name="cre_dt_from" type="12" value="" out="N"/>
				<param name="cre_dt_to" type="12" value="" out="N"/>
				<param name="svc_scp_cd" type="12" value="" out="N"/>
				<param name="cust_cnt_cd" type="12" value="" out="N"/>
				<param name="cust_seq" type="12" value="" out="N"/>
				<param name="prc_cust_tp_cd" type="12" value="" out="N"/>
				<param name="qttn_status" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
