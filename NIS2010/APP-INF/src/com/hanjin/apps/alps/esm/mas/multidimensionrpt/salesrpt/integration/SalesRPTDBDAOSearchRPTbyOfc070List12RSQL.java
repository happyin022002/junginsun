/*=========================================================
*Copyright(c) 2015 CyberLogitec
*@FileName : SalesRPTDBDAOSearchRPTbyOfc070List12RSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2015.09.18
*@LastModifier : 
*@LastVersion : 1.0
* 2015.09.18 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esm.mas.multidimensionrpt.salesrpt.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class SalesRPTDBDAOSearchRPTbyOfc070List12RSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * Office Report-vs QTA
	  * [CHM-201109841-01] 기존 IF문 중 불필요한 부분 삭제, ABC/STP 쿼리 중 Hint 삭제
	  * AND A2.BKG_CGO_TP_CD       <> 'P' 조건 삭제 : MT BKG은 COP가 생성되지 않아 SMRY 테이블에
	  * MT BKG은 생성되지 않아 해당 조건이 필요 없음 
	  * AND A2.BSE_QTR_CD       IN ('1Q', '2Q', '3Q', '4Q') 조건 삭제
	  * [CHM-201109966-01] SAQ Union 쿼리에 힌트 추가
	  * 2011.06.16 이행지 [CHM-201111643-01] 달성율 산식의 일괄 변경 => 목표값(QTA) < = 0, 1+(목표 - 실적) / 목표. [1+{목표 - (+-실적)}/목표] * 100 
	  * 2012.02.10 김종준 [CHM-201216123-01] Office Report vs QTA에서 선택 옵션에서, "Special Only"를 "Reefer Only" 옆에 추가 생성 요청
	  * 2012.04.24 이석준 [CHM-201217454] Office report vs QTA 메뉴의 Special 적용 대상 변경
	  * 2012.12.14 최윤성 [CHM-201222075-01] [MAS] Account별 QTA 조회 기능 추가
	  * 2013.06.03 성미영 [CHM-201324894] Split 01-[MAS] MAS Report내 "IAS Region " / "Bound2" 추가
	  * 2013.07.10 성미영 [CHM-201325516] Split 01-[MAS] Customer Segmentation 관련 변경사항 MDM DB 변경
	  * 2015.04.16 김시몬 튜닝에 의한 인덱스 변경
	  * </pre>
	  */
	public SalesRPTDBDAOSearchRPTbyOfc070List12RSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_hul_bnd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_year",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_pro_vw",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_skd_dir_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_skd_voy_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_fm_wk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_sub_trd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_dir_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ofc_vw",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_rlane_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ofc_lvl1",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ias_rgn_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ofc_sts",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_trd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_vsl_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_fm_mon",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_to_wk",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esm.mas.multidimensionrpt.salesrpt.integration").append("\n"); 
		query.append("FileName : SalesRPTDBDAOSearchRPTbyOfc070List12RSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT '' " ).append("\n"); 
		query.append("  ,OFC_CD1" ).append("\n"); 
		query.append("  ,OFC_CD2" ).append("\n"); 
		query.append("  ,COST_YRMON" ).append("\n"); 
		query.append("  ,COST_WK" ).append("\n"); 
		query.append("  ,TRD_CD" ).append("\n"); 
		query.append("  ,DECODE(IAS_RGN_CD,NULL,NULL,MAS_GET_CD_NM_FNC('CD03218', IAS_RGN_CD)) IAS_RGN_CD" ).append("\n"); 
		query.append("  ,DECODE(HUL_BND_CD,NULL,NULL,MAS_GET_CD_NM_FNC('CD03217', HUL_BND_CD)) HUL_BND_CD" ).append("\n"); 
		query.append("  ,SUB_TRD_CD" ).append("\n"); 
		query.append("  ,RLANE_CD" ).append("\n"); 
		query.append("  ,VSL_CD" ).append("\n"); 
		query.append("  ,SKD_VOY_NO" ).append("\n"); 
		query.append("  ,DIR_CD" ).append("\n"); 
		query.append("  ,CUST_GRP_ID" ).append("\n"); 
		query.append("  ,CUST_GRP_NM" ).append("\n"); 
		query.append("  ,MAS_LOAD " ).append("\n"); 
		query.append("  ,QTA_LOAD " ).append("\n"); 
		query.append("  ,ROUND(MAS_REV,10)                                    AS MAS_REV " ).append("\n"); 
		query.append("  ,ROUND(QTA_REV,10)                                    AS QTA_REV " ).append("\n"); 
		query.append("  ,ROUND(MAS_CM ,10)                                    AS MAS_CM" ).append("\n"); 
		query.append("  ,ROUND(QTA_CM,10)                                     AS QTA_CM " ).append("\n"); 
		query.append("  ,ROUND(DECODE(MAS_LOAD,0,0,MAS_REV/MAS_LOAD),10)      AS MAS_RPB      " ).append("\n"); 
		query.append("  ,ROUND(DECODE(QTA_LOAD,0,0,QTA_REV/QTA_LOAD),10)      AS QTA_RPB " ).append("\n"); 
		query.append("  ,ROUND(DECODE(MAS_LOAD,0,0,MAS_CM/MAS_LOAD),10)       AS MAS_CMB      " ).append("\n"); 
		query.append("  ,ROUND(DECODE(QTA_LOAD,0,0,QTA_CM/QTA_LOAD),10)       AS QTA_CMB " ).append("\n"); 
		query.append("  ,ROUND(MAS_BSA,10)                                    AS MAS_BSA_CAPA " ).append("\n"); 
		query.append("  ,ROUND(QTA_BSA,10)                                    AS QTA_BSA" ).append("\n"); 
		query.append("  ,ROUND(DECODE(MAS_BSA,0,0,(MAS_LOAD/MAS_BSA)*100),10) AS MAS_LF " ).append("\n"); 
		query.append("  ,ROUND(DECODE(QTA_BSA,0,0,(QTA_LOAD/QTA_BSA)*100),10) AS QTA_LF " ).append("\n"); 
		query.append("  ,ROUND(DECODE(SIGN(QTA_LOAD), -1,DECODE(SIGN(MAS_LOAD),-1,DECODE(QTA_LOAD,0,0,1+(QTA_LOAD-MAS_LOAD)/QTA_LOAD)),DECODE(SIGN(MAS_LOAD),1,DECODE(QTA_LOAD,0,0,MAS_LOAD/QTA_LOAD)))*100,10)               AS LOAD_CHNG " ).append("\n"); 
		query.append("  ,ROUND(DECODE(SIGN(QTA_REV),  -1,DECODE(SIGN(MAS_REV), -1,DECODE(QTA_REV, 0,0,1+(QTA_REV-MAS_REV)/QTA_REV)),   DECODE(SIGN(MAS_REV), 1,DECODE(QTA_REV, 0,0,MAS_REV/QTA_REV)))*100,10)                 AS REV_CHNG " ).append("\n"); 
		query.append("  ,ROUND(DECODE(SIGN(QTA_CM),   -1,DECODE(SIGN(MAS_CM),  -1,DECODE(QTA_CM,  0,0,1+(QTA_CM-MAS_CM)/QTA_CM)),      DECODE(SIGN(MAS_CM),  1,DECODE(QTA_CM,  0,0,MAS_CM/QTA_CM)))*100,10)                   AS BKG_CM_CHNG " ).append("\n"); 
		query.append("  ,ROUND((DECODE(MAS_LOAD,0,0,MAS_REV/MAS_LOAD) - DECODE(QTA_LOAD,0,0,QTA_REV/QTA_LOAD)),10)                       AS RPB_CHNG " ).append("\n"); 
		query.append("  ,ROUND(DECODE(MAS_LOAD,0,0,MAS_CM/MAS_LOAD)-DECODE(QTA_LOAD,0,0,QTA_CM/QTA_LOAD),10)                             AS CMB_CHNG " ).append("\n"); 
		query.append("  ,ROUND(MAS_BSA - QTA_BSA,10)                                                                                     AS BSA_CHNG " ).append("\n"); 
		query.append("  ,ROUND(DECODE(MAS_BSA,0,0,(MAS_LOAD/MAS_BSA)*100)-DECODE(QTA_BSA,0,0,(QTA_LOAD/QTA_BSA)*100),10)                 AS MAS_LF_CHNG " ).append("\n"); 
		query.append("  ,ROUND((MAS_LOAD - QTA_LOAD) * DECODE(QTA_LOAD,0,0,QTA_REV/QTA_LOAD),10)                                         AS BY_LOAD_GREV " ).append("\n"); 
		query.append("  ,ROUND((DECODE(MAS_LOAD,0,0,MAS_REV/MAS_LOAD) - DECODE(QTA_LOAD,0,0,QTA_REV/QTA_LOAD))*MAS_LOAD,10)              AS BY_RPB_GREV " ).append("\n"); 
		query.append("  ,ROUND((MAS_LOAD - QTA_LOAD) * (DECODE(QTA_LOAD,0,0,QTA_CM_COST/QTA_LOAD)),10)                                   AS BY_LOAD_COST " ).append("\n"); 
		query.append("  ,ROUND(((DECODE(MAS_LOAD,0,0,MAS_CM_COST/MAS_LOAD)) -  (DECODE(QTA_LOAD,0,0,QTA_CM_COST/QTA_LOAD)))*MAS_LOAD,10) AS BY_CPB_COST " ).append("\n"); 
		query.append("  ,ROUND(DECODE(QTA_LOAD,  0,0,NVL(RATIO_TO_REPORT(QTA_LOAD)   OVER(),0)* 100),5)                                 AS QTA_LOAD_SHARE " ).append("\n"); 
		query.append("  ,ROUND(DECODE(MAS_LOAD,  0,0,NVL(RATIO_TO_REPORT(MAS_LOAD)   OVER(),0)* 100),5)                                 AS MAS_LOAD_SHARE " ).append("\n"); 
		query.append("  ,ROUND(DECODE(QTA_CM,    0,0,NVL(RATIO_TO_REPORT(QTA_CM)     OVER(),0)* 100),5)                                 AS QTA_CM_SHARE " ).append("\n"); 
		query.append("  ,ROUND(DECODE(MAS_CM,    0,0,NVL(RATIO_TO_REPORT(MAS_CM)     OVER(),0)* 100),5)                                 AS MAS_CM_SHARE " ).append("\n"); 
		query.append("FROM ( " ).append("\n"); 
		query.append("    SELECT '' " ).append("\n"); 
		query.append("      ,OFC_CD1 " ).append("\n"); 
		query.append("      ,OFC_CD2" ).append("\n"); 
		query.append("#if(${f_r_month_sts} =='Y'||${f_rpt_item} =='4')              " ).append("\n"); 
		query.append("      ,COST_YRMON " ).append("\n"); 
		query.append("#else                " ).append("\n"); 
		query.append("      ,NULL AS COST_YRMON " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_wk_sts} =='Y'||${f_rpt_item} =='4')              " ).append("\n"); 
		query.append("      ,COST_WK " ).append("\n"); 
		query.append("#else                " ).append("\n"); 
		query.append("      ,NULL AS COST_WK " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("      ,TRD_CD" ).append("\n"); 
		query.append("#if( ${f_ias_rgn_sts} =='Y')" ).append("\n"); 
		query.append("      ,IAS_RGN_CD " ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("      ,NULL AS IAS_RGN_CD " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if( ${f_hul_bnd_sts} =='Y')" ).append("\n"); 
		query.append("      ,HUL_BND_CD " ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("      ,NULL AS HUL_BND_CD " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rpt_item} =='1')" ).append("\n"); 
		query.append("      ,NULL AS SUB_TRD_CD " ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("      ,SUB_TRD_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rpt_item} =='1' ||${f_rpt_item} =='2')" ).append("\n"); 
		query.append("      ,NULL AS RLANE_CD " ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("      ,RLANE_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rpt_item} =='1' ||${f_rpt_item} =='2'||${f_rpt_item} =='3')" ).append("\n"); 
		query.append("      ,NULL AS VSL_CD " ).append("\n"); 
		query.append("      ,NULL AS SKD_VOY_NO" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("      ,VSL_CD " ).append("\n"); 
		query.append("      ,SKD_VOY_NO" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if( ${f_dir_sts} =='Y'||${f_rpt_item}=='4')       " ).append("\n"); 
		query.append("      ,DIR_CD " ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("      ,NULL AS DIR_CD " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("      ,CUST_GRP_ID" ).append("\n"); 
		query.append("      ,CUST_GRP_NM" ).append("\n"); 
		query.append("      ,NVL(SUM(VVD_BSA_CAPA),0)            AS MAS_BSA " ).append("\n"); 
		query.append("      ,NVL(SUM(MAS_QTY),0)                 AS MAS_LOAD " ).append("\n"); 
		query.append("      ,NVL(SUM(FR_REV),0)                  AS MAS_REV " ).append("\n"); 
		query.append("      ,NVL(SUM(TOT_REV-CM_COST+DMDT),0)    AS MAS_CM " ).append("\n"); 
		query.append("      ,NVL(SUM(CM_COST),0)                 AS MAS_CM_COST " ).append("\n"); 
		query.append("      ,NVL(SUM(OP_COST),0)                 AS OP_COST " ).append("\n"); 
		query.append("      ,NVL(SUM(QTA_LOAD),0)                AS QTA_LOAD " ).append("\n"); 
		query.append("      ,NVL(SUM(QTA_REV),0)                 AS QTA_REV " ).append("\n"); 
		query.append("      ,NVL(SUM(QTA_BKG_CM),0)              AS QTA_CM " ).append("\n"); 
		query.append("      ,NVL(SUM(QTA_CM_COST),0)             AS QTA_CM_COST " ).append("\n"); 
		query.append("      ,NVL(SUM(QTA_BSA),0)                 AS QTA_BSA " ).append("\n"); 
		query.append("    FROM ( " ).append("\n"); 
		query.append("        SELECT /*+ use_hash(a2 a3) */" ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("        '' " ).append("\n"); 
		query.append("#if(${f_ofc_sts} =='Y')" ).append("\n"); 
		query.append("    #if(${f_ofc_lvl1} =='1') " ).append("\n"); 
		query.append("          ,A4.OFC_N1ST_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='2')" ).append("\n"); 
		query.append("          ,A4.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='3')" ).append("\n"); 
		query.append("          ,A4.OFC_N3RD_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='4')" ).append("\n"); 
		query.append("          ,A4.OFC_N4TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='5')" ).append("\n"); 
		query.append("          ,A4.OFC_N5TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='6')" ).append("\n"); 
		query.append("          ,A4.OFC_N6TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='7')" ).append("\n"); 
		query.append("          ,A4.OFC_N7TH_LVL_CD" ).append("\n"); 
		query.append("    #end OFC_CD1" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if(${f_ofc_lvl2} =='1') " ).append("\n"); 
		query.append("          ,A4.OFC_N1ST_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='2')" ).append("\n"); 
		query.append("          ,A4.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='3')" ).append("\n"); 
		query.append("          ,A4.OFC_N3RD_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='4')" ).append("\n"); 
		query.append("          ,A4.OFC_N4TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='5')" ).append("\n"); 
		query.append("          ,A4.OFC_N5TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='6')" ).append("\n"); 
		query.append("          ,A4.OFC_N6TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='7')" ).append("\n"); 
		query.append("          ,A4.OFC_N7TH_LVL_CD" ).append("\n"); 
		query.append("    #end OFC_CD2" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("          ,NULL AS OFC_CD1 " ).append("\n"); 
		query.append("          ,NULL AS OFC_CD2 " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		  ,A1.COST_YRMON" ).append("\n"); 
		query.append("          ,A1.COST_WK " ).append("\n"); 
		query.append("          ,A1.TRD_CD " ).append("\n"); 
		query.append("          ,A3.IAS_RGN_CD" ).append("\n"); 
		query.append("          ,A3.HUL_BND_CD" ).append("\n"); 
		query.append("          ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("          ,A1.RLANE_CD " ).append("\n"); 
		query.append("          ,A1.VSL_CD " ).append("\n"); 
		query.append("          ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("    #if(${f_view_cust} == 'Y')" ).append("\n"); 
		query.append("          ,NVL(CONV.CONV_DIR_CD,A1.DIR_CD) DIR_CD" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("          ,A1.DIR_CD" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#if((${f_view_cust} == 'Y') && ${f_gcust_sts} == 'Y')" ).append("\n"); 
		query.append("          ,A2.CUST_GRP_ID" ).append("\n"); 
		query.append("          ,A2.CUST_GRP_NM" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("          ,NULL CUST_GRP_ID" ).append("\n"); 
		query.append("          ,NULL CUST_GRP_NM" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("          ,NVL(A3.LOD_SPL_CNG_FLG,'N') AS LOD_SPL_CNG_FLG " ).append("\n"); 
		query.append("          ,DECODE(NVL(A3.LOD_SPL_CNG_FLG,'N'), 'Y', SUM(DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1,1),'2',NVL(A2.BKG_QTY,0),'3',NVL(A2.BKG_QTY,0),NVL(A2.BKG_QTY,0)*2)) " ).append("\n"); 
		query.append("                                             , 'N', MAX(A1.VVD_BSA_CAPA))                      AS VVD_BSA_CAPA " ).append("\n"); 
		query.append("          ,SUM(DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1,1),'2',NVL(A2.BKG_QTY,0),'3',NVL(A2.BKG_QTY,0),NVL(A2.BKG_QTY,0)*2)) AS MAS_QTY " ).append("\n"); 
		query.append("          ,SUM(A2.BKG_REV+A2.BKG_OFT_REV)                                                      AS FR_REV " ).append("\n"); 
		query.append("          ,SUM(A2.BKG_REV+A2.BKG_OFT_REV+A2.BKG_MISC_REV+A2.SCR_CHG_REV)                       AS TOT_REV " ).append("\n"); 
		query.append("          ,SUM(A2.DMDT_COM_AMT)                                                                AS DMDT " ).append("\n"); 
		query.append("          ,SUM(DECODE(@[f_pro_vw],'P', A2.PA_CM_COST_TTL_AMT,'R',A2.RA_CM_COST_TTL_AMT))       AS CM_COST  " ).append("\n"); 
		query.append("          ,SUM(DECODE(@[f_pro_vw],'P', 0,'R',A2.RA_OP_COST_TTL_AMT))                           AS OP_COST  " ).append("\n"); 
		query.append("          ,NULL AS QTA_BSA " ).append("\n"); 
		query.append("          ,NULL AS QTA_LOAD " ).append("\n"); 
		query.append("          ,NULL AS QTA_REV " ).append("\n"); 
		query.append("          ,NULL AS QTA_BKG_CM " ).append("\n"); 
		query.append("          ,NULL AS QTA_CM_COST " ).append("\n"); 
		query.append("          ,NULL AS OFC_CD " ).append("\n"); 
		query.append("       FROM        " ).append("\n"); 
		query.append("      #if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("           MAS_BKG_EXPN_DTL A2" ).append("\n"); 
		query.append("      #elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("           MAS_BKG_EXPN_DTL_WK A2 " ).append("\n"); 
		query.append("      #end           " ).append("\n"); 
		query.append("          ,MAS_MON_VVD   A1 " ).append("\n"); 
		query.append("          ,MAS_LANE_RGST A3 " ).append("\n"); 
		query.append("          ,MAS_OFC_LVL   A4" ).append("\n"); 
		query.append("#if ((${f_view_cust} == 'Y') && ((${f_key_acct_group_cd} != '' && ${f_key_acct_group_cd} != 'All') || ${f_otr_key_acct} != ''))" ).append("\n"); 
		query.append("          ,MDM_CUSTOMER F" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ((${f_view_cust} == 'Y') &&  ${f_otr_local_acct} != '')" ).append("\n"); 
		query.append("          ,MDM_CUSTOMER LCL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ((${f_view_cust} == 'Y') && ((${f_ra_acct_group_cd} != '' && ${f_ra_acct_group_cd} != 'All') || ${f_otr_regional_acct} != ''))" ).append("\n"); 
		query.append("          ,MDM_CUSTOMER RGN" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${f_view_cust} == 'Y' && (${f_ofc_team_cd} != '' && ${f_ofc_team_cd} != 'All') || ${f_rhq_cd} != '' && ${f_rhq_cd} != 'All')" ).append("\n"); 
		query.append("          ,MDM_CUST_PERF_GRP  GRP_C" ).append("\n"); 
		query.append("          ,MDM_CUSTOMER       IND_C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${f_view_cust} == 'Y')" ).append("\n"); 
		query.append("          ,(SELECT BSE_TP_CD, BSE_YR, BSE_QTR_CD, TRD_CD, RLANE_CD, DIR_CD, CONV_DIR_CD" ).append("\n"); 
		query.append("              FROM SQM_DIR_CONV " ).append("\n"); 
		query.append("             WHERE 1=1" ).append("\n"); 
		query.append("               AND BSE_TP_CD = 'Q'" ).append("\n"); 
		query.append("               AND BSE_YR = @[f_year]" ).append("\n"); 
		query.append("               AND BSE_QTR_CD       = DECODE(@[f_fm_mon], '01', '1Q', '02', '1Q', '03', '1Q'" ).append("\n"); 
		query.append("                                                                , '04', '2Q', '05', '2Q', '06', '2Q'" ).append("\n"); 
		query.append("                                                                , '07', '3Q', '08', '3Q', '09', '3Q'" ).append("\n"); 
		query.append("                                                                , '10', '4Q', '11', '4Q', '12', '4Q')" ).append("\n"); 
		query.append("          )CONV" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("      WHERE A1.TRD_CD              = A2.TRD_CD " ).append("\n"); 
		query.append("        AND A1.RLANE_CD            = A2.RLANE_CD " ).append("\n"); 
		query.append("        AND A1.IOC_CD              = A2.IOC_CD " ).append("\n"); 
		query.append("        AND A1.VSL_CD              = A2.VSL_CD " ).append("\n"); 
		query.append("        AND A1.SKD_VOY_NO          = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("        AND A1.DIR_CD              = A2.DIR_CD " ).append("\n"); 
		query.append("        AND A1.TRD_CD              = A3.TRD_CD " ).append("\n"); 
		query.append("        AND A1.RLANE_CD            = A3.RLANE_CD " ).append("\n"); 
		query.append("        AND A1.IOC_CD              = A3.IOC_CD " ).append("\n"); 
		query.append("        AND A1.DIR_CD              = A3.DIR_CD" ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')      " ).append("\n"); 
		query.append("        AND A1.COST_YRMON = A2.COST_YRMON" ).append("\n"); 
		query.append("        AND A2.COST_YRMON          BETWEEN '${f_year}'||'${f_fm_mon}' AND '${f_year}'||'${f_to_mon}'" ).append("\n"); 
		query.append("        AND A1.COST_YRMON          BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W') " ).append("\n"); 
		query.append("        AND SUBSTR(A1.SLS_YRMON, 1, 4)||A1.COST_WK BETWEEN @[f_year]||@[f_fm_wk] AND @[f_year]||@[f_to_wk]" ).append("\n"); 
		query.append("        AND SUBSTR(A1.SLS_YRMON, 1, 4)||A1.COST_WK = SUBSTR(A2.SLS_YRMON, 1, 4)||A2.COST_WK     " ).append("\n"); 
		query.append("        AND A1.SLS_YRMON           BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON      " ).append("\n"); 
		query.append("#end      " ).append("\n"); 
		query.append("#if(${f_ofc_vw} =='C')" ).append("\n"); 
		query.append("        AND A2.AGMT_SGN_OFC_CD = A4.OFC_CD" ).append("\n"); 
		query.append("#elseif (${f_ofc_vw} =='L')" ).append("\n"); 
		query.append("        AND A2.SLS_OFC_CD = A4.OFC_CD      " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("        AND NVL(A1.DELT_FLG,'N')   = 'N'      " ).append("\n"); 
		query.append("#if(${f_bkg_sts} =='Y')                  " ).append("\n"); 
		query.append("        AND A2.BKG_STS_CD          IN ('F','S','W') " ).append("\n"); 
		query.append("#else                                         " ).append("\n"); 
		query.append("        AND A2.BKG_STS_CD          IN ('F','S') " ).append("\n"); 
		query.append("#end       " ).append("\n"); 
		query.append("        AND A2.BL_NO_TP            IN ('M','0')             " ).append("\n"); 
		query.append("#if(${f_ofc_cd} !='')" ).append("\n"); 
		query.append("    #if(${f_excl_sts} =='')" ).append("\n"); 
		query.append("        AND DECODE(@[f_ofc_lvl1], '1', A4.OFC_N1ST_LVL_CD, '2', A4.OFC_N2ND_LVL_CD, '3', A4.OFC_N3RD_LVL_CD, '4', A4.OFC_N4TH_LVL_CD, '5', A4.OFC_N5TH_LVL_CD, '6', A4.OFC_N6TH_LVL_CD, '7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]       " ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        AND A4.OFC_CD = @[f_ofc_cd]  " ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ofc_lvl1}=='6' || ${f_ofc_lvl1}=='7')" ).append("\n"); 
		query.append("        AND A4.OFC_LVL = @[f_ofc_lvl1]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	-------------------------------------------------------------------------------" ).append("\n"); 
		query.append("        AND A4.OFC_LVL < '9'" ).append("\n"); 
		query.append("	-------------------------------------------------------------------------------" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_trd_cd} !='')                       " ).append("\n"); 
		query.append("        AND A1.TRD_CD   = @[f_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='')                       " ).append("\n"); 
		query.append("        AND A1.SUB_TRD_CD   = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ias_rgn_cd} !='')                       " ).append("\n"); 
		query.append("        AND A3.IAS_RGN_CD   = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_hul_bnd_cd} !='')                       " ).append("\n"); 
		query.append("        AND A3.HUL_BND_CD   = @[f_hul_bnd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rlane_cd} !='')" ).append("\n"); 
		query.append("        AND A1.RLANE_CD = @[f_rlane_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_cd} !='')" ).append("\n"); 
		query.append("    #if(${f_view_cust} == 'Y')" ).append("\n"); 
		query.append("        AND NVL(CONV.CONV_DIR_CD,A1.DIR_CD)   = @[f_dir_cd] " ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        AND A1.DIR_CD   = @[f_dir_cd] " ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_vsl_cd} !='')" ).append("\n"); 
		query.append("        AND A1.VSL_CD   = @[f_vsl_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_voy_no} !='')" ).append("\n"); 
		query.append("        AND A1.SKD_VOY_NO = @[f_skd_voy_no] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='')" ).append("\n"); 
		query.append("        AND A1.DIR_CD   = @[f_skd_dir_cd]     " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rf_sts} !='')" ).append("\n"); 
		query.append("        AND A2.SPCL_RC_FLG = 'Y'    " ).append("\n"); 
		query.append("#end    " ).append("\n"); 
		query.append("#if(${f_sc_sts} !='')" ).append("\n"); 
		query.append("--	    AND ((A2.SPCL_DG_CGO_FLG = 'Y' OR A2.SPCL_BB_CGO_FLG = 'Y' OR A2.SPCL_AWK_CGO_FLG = 'Y')" ).append("\n"); 
		query.append("--                OR (A2.CNTR_TPSZ_CD IN ('T2','T3','T4','T5','T6','T7','DW','DX')))  " ).append("\n"); 
		query.append("        AND (   (A2.SPCL_DG_CGO_FLG = 'Y' AND A2.CNTR_TPSZ_CD IN ('D2','D4','D5'))" ).append("\n"); 
		query.append("             OR (A2.CNTR_TPSZ_CD IN ('DW','DX','A2','A4','F2','F4','F5','O2','O4','O5','Q2','Q4','Q5','S2','S4','T2','T4'))" ).append("\n"); 
		query.append("             )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ((${f_view_cust} == 'Y') && ((${f_key_acct_group_cd} != '' && ${f_key_acct_group_cd} != 'All') || ${f_otr_key_acct} != ''))" ).append("\n"); 
		query.append("        AND A2.AGMT_CNT_CD     = F.CUST_CNT_CD" ).append("\n"); 
		query.append("        AND A2.AGMT_CUST_SEQ   = F.CUST_SEQ" ).append("\n"); 
		query.append("        --AND A2.SHPR_CNT_CD     = F.CUST_CNT_CD" ).append("\n"); 
		query.append("        --AND A2.SHPR_CUST_SEQ   = F.CUST_SEQ" ).append("\n"); 
		query.append("        AND F.NEW_KEY_ACCT_FLG = 'Y'" ).append("\n"); 
		query.append("        AND F.CNTR_DIV_FLG     = 'Y'" ).append("\n"); 
		query.append("        AND F.DELT_FLG         = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ((${f_view_cust} == 'Y') && (${f_otr_local_acct} != ''))" ).append("\n"); 
		query.append("        AND A2.AGMT_CNT_CD     = LCL.CUST_CNT_CD" ).append("\n"); 
		query.append("        AND A2.AGMT_CUST_SEQ   = LCL.CUST_SEQ" ).append("\n"); 
		query.append("        --AND A2.SHPR_CNT_CD     = LCL.CUST_CNT_CD" ).append("\n"); 
		query.append("        --AND A2.SHPR_CUST_SEQ   = LCL.CUST_SEQ" ).append("\n"); 
		query.append("        AND NVL(LCL.NEW_KEY_ACCT_FLG ,'N') = 'N' " ).append("\n"); 
		query.append("        AND NVL(LCL.RGN_ACCT_FLG ,'N') = 'N'" ).append("\n"); 
		query.append("        AND LCL.CNTR_DIV_FLG    = 'Y'" ).append("\n"); 
		query.append("        AND LCL.DELT_FLG        = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ((${f_view_cust} == 'Y') && ((${f_ra_acct_group_cd} != '' && ${f_ra_acct_group_cd} != 'All') || ${f_otr_regional_acct} != ''))" ).append("\n"); 
		query.append("        AND A2.AGMT_CNT_CD     = RGN.CUST_CNT_CD" ).append("\n"); 
		query.append("        AND A2.AGMT_CUST_SEQ   = RGN.CUST_SEQ" ).append("\n"); 
		query.append("        --AND A2.SHPR_CNT_CD     = RGN.CUST_CNT_CD" ).append("\n"); 
		query.append("        --AND A2.SHPR_CUST_SEQ   = RGN.CUST_SEQ" ).append("\n"); 
		query.append("        AND RGN.RGN_ACCT_FLG   = 'Y'" ).append("\n"); 
		query.append("        AND RGN.CNTR_DIV_FLG   = 'Y'" ).append("\n"); 
		query.append("        AND RGN.DELT_FLG       = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${f_view_cust} == 'Y' && ${f_key_acct_group_cd} != '' && ${f_key_acct_group_cd} != 'All')" ).append("\n"); 
		query.append("        AND F.CUST_GRP_ID      = '${f_key_acct_group_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${f_view_cust} == 'Y' && ${f_ra_acct_group_cd} != '' && ${f_ra_acct_group_cd} != 'All')" ).append("\n"); 
		query.append("        AND RGN.CUST_GRP_ID    = '${f_ra_acct_group_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${f_view_cust} == 'Y' && (${f_ofc_team_cd} != '' && ${f_ofc_team_cd} != 'All') || ${f_rhq_cd} != '' && ${f_rhq_cd} != 'All')" ).append("\n"); 
		query.append("        AND A2.AGMT_CNT_CD     = IND_C.CUST_CNT_CD" ).append("\n"); 
		query.append("        AND A2.AGMT_CUST_SEQ   = IND_C.CUST_SEQ" ).append("\n"); 
		query.append("        --AND A2.SHPR_CNT_CD     = IND_C.CUST_CNT_CD" ).append("\n"); 
		query.append("        --AND A2.SHPR_CUST_SEQ   = IND_C.CUST_SEQ" ).append("\n"); 
		query.append("        AND GRP_C.CUST_GRP_ID =  IND_C.CUST_GRP_ID" ).append("\n"); 
		query.append("        AND IND_C.CNTR_DIV_FLG   = 'Y'" ).append("\n"); 
		query.append("        AND IND_C.DELT_FLG       = 'N'" ).append("\n"); 
		query.append("        AND GRP_C.DELT_FLG       = 'N'        " ).append("\n"); 
		query.append("        AND GRP_C.OFC_TEAM_CD    LIKE '${f_ofc_team_cd}'||'%'" ).append("\n"); 
		query.append("        AND GRP_C.RHQ_CD         LIKE '${f_rhq_cd}'||'%'        " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${f_view_cust} == 'Y')" ).append("\n"); 
		query.append("        AND A1.TRD_CD = CONV.TRD_CD(+)" ).append("\n"); 
		query.append("        AND A1.RLANE_CD = CONV.RLANE_CD(+)" ).append("\n"); 
		query.append("        AND A1.DIR_CD = CONV.DIR_CD(+)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("   GROUP BY '' " ).append("\n"); 
		query.append("#if(${f_ofc_sts} =='Y')" ).append("\n"); 
		query.append("    #if(${f_ofc_lvl1} =='1') " ).append("\n"); 
		query.append("          ,A4.OFC_N1ST_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='2')" ).append("\n"); 
		query.append("          ,A4.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='3')" ).append("\n"); 
		query.append("          ,A4.OFC_N3RD_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='4')" ).append("\n"); 
		query.append("          ,A4.OFC_N4TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='5')" ).append("\n"); 
		query.append("          ,A4.OFC_N5TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='6')" ).append("\n"); 
		query.append("          ,A4.OFC_N6TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='7')" ).append("\n"); 
		query.append("          ,A4.OFC_N7TH_LVL_CD" ).append("\n"); 
		query.append("    #end          " ).append("\n"); 
		query.append("    #if(${f_ofc_lvl2} =='1') " ).append("\n"); 
		query.append("          ,A4.OFC_N1ST_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='2')" ).append("\n"); 
		query.append("          ,A4.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='3')" ).append("\n"); 
		query.append("          ,A4.OFC_N3RD_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='4')" ).append("\n"); 
		query.append("          ,A4.OFC_N4TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='5')" ).append("\n"); 
		query.append("          ,A4.OFC_N5TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='6')" ).append("\n"); 
		query.append("          ,A4.OFC_N6TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='7')" ).append("\n"); 
		query.append("          ,A4.OFC_N7TH_LVL_CD" ).append("\n"); 
		query.append("    #end " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		  ,A1.COST_YRMON" ).append("\n"); 
		query.append("          ,A1.COST_WK " ).append("\n"); 
		query.append("          ,A1.TRD_CD " ).append("\n"); 
		query.append("          ,A3.IAS_RGN_CD " ).append("\n"); 
		query.append("          ,A3.HUL_BND_CD " ).append("\n"); 
		query.append("          ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("          ,A1.RLANE_CD " ).append("\n"); 
		query.append("          ,A1.VSL_CD " ).append("\n"); 
		query.append("          ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("    #if(${f_view_cust} == 'Y')" ).append("\n"); 
		query.append("          ,NVL(CONV.CONV_DIR_CD,A1.DIR_CD)" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("          ,A1.DIR_CD" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#if((${f_view_cust} == 'Y') && ${f_gcust_sts} == 'Y')" ).append("\n"); 
		query.append("          ,A2.CUST_GRP_ID" ).append("\n"); 
		query.append("          ,A2.CUST_GRP_NM" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("          ,A3.LOD_SPL_CNG_FLG          " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("#if(${f_view_cust} == 'N')" ).append("\n"); 
		query.append("      /*--STP(Office Profit) start -------*/" ).append("\n"); 
		query.append("#if(${f_pro_vw} =='R')" ).append("\n"); 
		query.append("      /* STE REV, ABC OTH SVC */" ).append("\n"); 
		query.append("        UNION ALL " ).append("\n"); 
		query.append("        SELECT /*+ ordered */" ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("           '' " ).append("\n"); 
		query.append("#if(${f_ofc_sts} =='Y')" ).append("\n"); 
		query.append("    #if(${f_ofc_lvl1} =='1') " ).append("\n"); 
		query.append("          ,A3.OFC_N1ST_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='2')" ).append("\n"); 
		query.append("          ,A3.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='3')" ).append("\n"); 
		query.append("          ,A3.OFC_N3RD_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='4')" ).append("\n"); 
		query.append("          ,A3.OFC_N4TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='5')" ).append("\n"); 
		query.append("          ,A3.OFC_N5TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='6')" ).append("\n"); 
		query.append("          ,A3.OFC_N6TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='7')" ).append("\n"); 
		query.append("          ,A3.OFC_N7TH_LVL_CD" ).append("\n"); 
		query.append("    #end OFC_CD1" ).append("\n"); 
		query.append("          " ).append("\n"); 
		query.append("    #if(${f_ofc_lvl2} =='1') " ).append("\n"); 
		query.append("          ,A3.OFC_N1ST_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='2')" ).append("\n"); 
		query.append("          ,A3.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='3')" ).append("\n"); 
		query.append("          ,A3.OFC_N3RD_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='4')" ).append("\n"); 
		query.append("          ,A3.OFC_N4TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='5')" ).append("\n"); 
		query.append("          ,A3.OFC_N5TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='6')" ).append("\n"); 
		query.append("          ,A3.OFC_N6TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='7')" ).append("\n"); 
		query.append("          ,A3.OFC_N7TH_LVL_CD" ).append("\n"); 
		query.append("    #end OFC_CD2" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("          ,NULL AS OFC_CD1 " ).append("\n"); 
		query.append("          ,NULL AS OFC_CD2 " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		  ,A1.COST_YRMON" ).append("\n"); 
		query.append("          ,A1.COST_WK " ).append("\n"); 
		query.append("          ,A1.TRD_CD " ).append("\n"); 
		query.append("          ,A4.IAS_RGN_CD" ).append("\n"); 
		query.append("          ,A4.HUL_BND_CD" ).append("\n"); 
		query.append("          ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("          ,A1.RLANE_CD " ).append("\n"); 
		query.append("          ,A1.VSL_CD " ).append("\n"); 
		query.append("          ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("          ,A1.DIR_CD " ).append("\n"); 
		query.append("          ,NULL AS CUST_GRP_ID" ).append("\n"); 
		query.append("          ,NULL AS CUST_GRP_NM" ).append("\n"); 
		query.append("          ,NULL AS LOD_SPL_CNG_FLG " ).append("\n"); 
		query.append("          ,NULL AS VVD_BSA_CAPA " ).append("\n"); 
		query.append("          ,NULL AS MAS_QTY " ).append("\n"); 
		query.append("          ,NULL AS FR_REV " ).append("\n"); 
		query.append("          ,NULL AS TOT_REV " ).append("\n"); 
		query.append("          ,NULL AS DMDT " ).append("\n"); 
		query.append("          ,NULL AS CM_COST " ).append("\n"); 
		query.append("          ,NULL AS OP_COST " ).append("\n"); 
		query.append("          ,NULL AS QTA_BSA " ).append("\n"); 
		query.append("          ,NULL AS QTA_LOAD " ).append("\n"); 
		query.append("          ,NULL AS QTA_REV " ).append("\n"); 
		query.append("          ,NULL AS QTA_BKG_CM " ).append("\n"); 
		query.append("          ,NULL AS QTA_CM_COST " ).append("\n"); 
		query.append("          ,NULL AS OFC_CD " ).append("\n"); 
		query.append("       FROM MAS_MON_VVD A1 " ).append("\n"); 
		query.append("          ,MAS_BKG_SVC_TRNS_SMRY A2 " ).append("\n"); 
		query.append("          ,MAS_OFC_LVL A3 " ).append("\n"); 
		query.append("          ,MAS_LANE_RGST A4" ).append("\n"); 
		query.append("      WHERE A1.VSL_CD        = A2.VSL_CD " ).append("\n"); 
		query.append("        AND A1.SKD_VOY_NO    = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("        AND A1.DIR_CD        = A2.DIR_CD " ).append("\n"); 
		query.append("        AND A1.TRD_CD        = A2.TRD_CD " ).append("\n"); 
		query.append("        AND A1.RLANE_CD      = A2.RLANE_CD " ).append("\n"); 
		query.append("        AND A1.IOC_CD        = A2.IOC_CD " ).append("\n"); 
		query.append("        AND A1.RLANE_CD      = A4.RLANE_CD " ).append("\n"); 
		query.append("        AND A1.DIR_CD        = A4.DIR_CD" ).append("\n"); 
		query.append("        AND A1.TRD_CD        = A4.TRD_CD " ).append("\n"); 
		query.append("        AND A1.IOC_CD        = A4.IOC_CD " ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("        AND A1.DELT_FLG      = 'N'      " ).append("\n"); 
		query.append("        AND A2.BL_NO_TP      IN ('M','0') " ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("        AND A1.COST_YRMON    BETWEEN A3.OFC_APLY_FM_YRMON AND A3.OFC_APLY_TO_YRMON    " ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("        AND A1.SLS_YRMON     BETWEEN A3.OFC_APLY_FM_YRMON AND A3.OFC_APLY_TO_YRMON     " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_bkg_sts} =='Y')                    " ).append("\n"); 
		query.append("        AND A2.BKG_STS_CD    IN ('F','S','W') " ).append("\n"); 
		query.append("#else                                         " ).append("\n"); 
		query.append("        AND A2.BKG_STS_CD    IN ('F','S') " ).append("\n"); 
		query.append("#end      " ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("        AND A1.COST_YRMON    BETWEEN '${f_year}'||'${f_fm_mon}' AND '${f_year}'||'${f_to_mon}' " ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("        AND SUBSTR(A1.SLS_YRMON, 1, 4)||A1.COST_WK BETWEEN @[f_year]||@[f_fm_wk] AND @[f_year]||@[f_to_wk]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("        AND A2.COND_OFC_CD   = A3.OFC_CD      " ).append("\n"); 
		query.append("#if(${f_ofc_cd} !='')" ).append("\n"); 
		query.append("    #if(${f_excl_sts} =='')" ).append("\n"); 
		query.append("        AND DECODE(@[f_ofc_lvl1], '1', A3.OFC_N1ST_LVL_CD, '2', A3.OFC_N2ND_LVL_CD, '3', A3.OFC_N3RD_LVL_CD, '4', A3.OFC_N4TH_LVL_CD, '5', A3.OFC_N5TH_LVL_CD, '6', A3.OFC_N6TH_LVL_CD, '7', A3.OFC_N7TH_LVL_CD) = @[f_ofc_cd] " ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        AND A3.OFC_CD = @[f_ofc_cd]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ofc_lvl1}=='6' || ${f_ofc_lvl1}=='7')" ).append("\n"); 
		query.append("        AND A3.OFC_LVL = @[f_ofc_lvl1]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("        AND A3.OFC_LVL < '9'" ).append("\n"); 
		query.append("#end      " ).append("\n"); 
		query.append("#if(${f_trd_cd} !='')                       " ).append("\n"); 
		query.append("        AND A1.TRD_CD   = @[f_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='')                       " ).append("\n"); 
		query.append("        AND A1.SUB_TRD_CD   = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ias_rgn_cd} !='')                       " ).append("\n"); 
		query.append("        AND A4.IAS_RGN_CD   = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_hul_bnd_cd} !='')                       " ).append("\n"); 
		query.append("        AND A4.HUL_BND_CD   = @[f_hul_bnd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rlane_cd} !='')" ).append("\n"); 
		query.append("        AND A1.RLANE_CD = @[f_rlane_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_cd} !='')" ).append("\n"); 
		query.append("        AND A1.DIR_CD   = @[f_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_vsl_cd} !='')" ).append("\n"); 
		query.append("        AND A1.VSL_CD   = @[f_vsl_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_voy_no} !='')" ).append("\n"); 
		query.append("        AND A1.SKD_VOY_NO = @[f_skd_voy_no] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='')" ).append("\n"); 
		query.append("        AND A1.DIR_CD   = @[f_skd_dir_cd]     " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("   GROUP BY ''" ).append("\n"); 
		query.append("#if(${f_ofc_sts} =='Y')" ).append("\n"); 
		query.append("    #if(${f_ofc_lvl1} =='1') " ).append("\n"); 
		query.append("          ,A3.OFC_N1ST_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='2')" ).append("\n"); 
		query.append("          ,A3.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='3')" ).append("\n"); 
		query.append("          ,A3.OFC_N3RD_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='4')" ).append("\n"); 
		query.append("          ,A3.OFC_N4TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='5')" ).append("\n"); 
		query.append("          ,A3.OFC_N5TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='6')" ).append("\n"); 
		query.append("          ,A3.OFC_N6TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='7')" ).append("\n"); 
		query.append("          ,A3.OFC_N7TH_LVL_CD" ).append("\n"); 
		query.append("    #end          " ).append("\n"); 
		query.append("    #if(${f_ofc_lvl2} =='1') " ).append("\n"); 
		query.append("          ,A3.OFC_N1ST_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='2')" ).append("\n"); 
		query.append("          ,A3.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='3')" ).append("\n"); 
		query.append("          ,A3.OFC_N3RD_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='4')" ).append("\n"); 
		query.append("          ,A3.OFC_N4TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='5')" ).append("\n"); 
		query.append("          ,A3.OFC_N5TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='6')" ).append("\n"); 
		query.append("          ,A3.OFC_N6TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='7')" ).append("\n"); 
		query.append("          ,A3.OFC_N7TH_LVL_CD" ).append("\n"); 
		query.append("    #end " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		  ,A1.COST_YRMON" ).append("\n"); 
		query.append("          ,A1.COST_WK " ).append("\n"); 
		query.append("          ,A1.TRD_CD " ).append("\n"); 
		query.append("          ,A4.IAS_RGN_CD" ).append("\n"); 
		query.append("          ,A4.HUL_BND_CD" ).append("\n"); 
		query.append("          ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("          ,A1.RLANE_CD " ).append("\n"); 
		query.append("          ,A1.VSL_CD " ).append("\n"); 
		query.append("          ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("          ,A1.DIR_CD            " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    /* -- STP end  ----*/" ).append("\n"); 
		query.append("#if((${f_pro_vw} =='P' && ${f_ofc_lvl1} =='1') " ).append("\n"); 
		query.append("   ||${f_pro_vw} =='R')" ).append("\n"); 
		query.append("        UNION ALL " ).append("\n"); 
		query.append("        SELECT '' " ).append("\n"); 
		query.append("          ,OFC_CD1 " ).append("\n"); 
		query.append("          ,OFC_CD2" ).append("\n"); 
		query.append("          ,COST_YRMON " ).append("\n"); 
		query.append("          ,COST_WK " ).append("\n"); 
		query.append("          ,TRD_CD " ).append("\n"); 
		query.append("          ,IAS_RGN_CD" ).append("\n"); 
		query.append("          ,HUL_BND_CD" ).append("\n"); 
		query.append("          ,SUB_TRD_CD " ).append("\n"); 
		query.append("          ,RLANE_CD " ).append("\n"); 
		query.append("          ,VSL_CD " ).append("\n"); 
		query.append("          ,SKD_VOY_NO " ).append("\n"); 
		query.append("          ,DIR_CD " ).append("\n"); 
		query.append("          ,NULL AS CUST_GRP_ID" ).append("\n"); 
		query.append("          ,NULL AS CUST_GRP_NM" ).append("\n"); 
		query.append("          ,NULL AS LOD_SPL_CNG_FLG " ).append("\n"); 
		query.append("          ,NULL AS VVD_BSA_CAPA " ).append("\n"); 
		query.append("          ,NULL AS MAS_QTY " ).append("\n"); 
		query.append("          ,NULL AS FR_REV " ).append("\n"); 
		query.append("          ,NULL AS TOT_REV " ).append("\n"); 
		query.append("          ,NULL AS DMDT " ).append("\n"); 
		query.append("          ,NULL AS CM_COST " ).append("\n"); 
		query.append("          ,NULL AS OP_COST " ).append("\n"); 
		query.append("          ,NULL AS QTA_BSA " ).append("\n"); 
		query.append("          ,SUM(DECODE(RLANE_CD, 'RBCCO' , DECODE(IOC_CD, 'O', 0 ,LOD_QTY), LOD_QTY)) QTA_LOAD " ).append("\n"); 
		query.append("          ,SUM(DECODE(RLANE_CD, 'RBCCO' , DECODE(IOC_CD, 'O', 0 ,LOD_QTY), LOD_QTY) * GRS_RPB_REV) QTA_REV " ).append("\n"); 
		query.append("          ,SUM(DECODE(RLANE_CD, 'RBCCO' , DECODE(IOC_CD, 'O', 0 ,LOD_QTY), LOD_QTY) * GRS_RPB_REV) - " ).append("\n"); 
		query.append("           SUM(DECODE(RLANE_CD, 'RBCCO' , DECODE(IOC_CD, 'O', 0 ,LOD_QTY), LOD_QTY) * DECODE(@[f_pro_vw], 'P', PA_CM_UC_AMT, RA_CM_UC_AMT)) QTA_BKG_CM  " ).append("\n"); 
		query.append("          ,SUM(DECODE(RLANE_CD, 'RBCCO' , DECODE(IOC_CD, 'O', 0 ,LOD_QTY), LOD_QTY) * DECODE(@[f_pro_vw], 'P', PA_CM_UC_AMT, RA_CM_UC_AMT)) QTA_CM_COST  " ).append("\n"); 
		query.append("          ,NULL AS OFC_CD " ).append("\n"); 
		query.append("       FROM(" ).append("\n"); 
		query.append("           SELECT " ).append("\n"); 
		query.append("              /*+ ordered use_hash(a4 a5 a3) */ -- TUN : 힌트변경 ordered use_hash(a4 a5) " ).append("\n"); 
		query.append("              '' " ).append("\n"); 
		query.append("#if(${f_ofc_sts} =='Y')" ).append("\n"); 
		query.append("    #if(${f_ofc_lvl1} =='1') " ).append("\n"); 
		query.append("             ,A4.OFC_N1ST_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='2')" ).append("\n"); 
		query.append("             ,A4.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='3')" ).append("\n"); 
		query.append("             ,A4.OFC_N3RD_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='4')" ).append("\n"); 
		query.append("             ,A4.OFC_N4TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='5')" ).append("\n"); 
		query.append("             ,A4.OFC_N5TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='6')" ).append("\n"); 
		query.append("             ,A4.OFC_N6TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl1} =='7')" ).append("\n"); 
		query.append("             ,A4.OFC_N7TH_LVL_CD" ).append("\n"); 
		query.append("    #end OFC_CD1              " ).append("\n"); 
		query.append("    #if(${f_ofc_lvl2} =='1') " ).append("\n"); 
		query.append("             ,A4.OFC_N1ST_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='2')" ).append("\n"); 
		query.append("             ,A4.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='3')" ).append("\n"); 
		query.append("             ,A4.OFC_N3RD_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='4')" ).append("\n"); 
		query.append("             ,A4.OFC_N4TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='5')" ).append("\n"); 
		query.append("             ,A4.OFC_N5TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='6')" ).append("\n"); 
		query.append("             ,A4.OFC_N6TH_LVL_CD" ).append("\n"); 
		query.append("    #elseif (${f_ofc_lvl2} =='7')" ).append("\n"); 
		query.append("             ,A4.OFC_N7TH_LVL_CD" ).append("\n"); 
		query.append("    #end OFC_CD2" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("             ,NULL AS OFC_CD1 " ).append("\n"); 
		query.append("             ,NULL AS OFC_CD2 " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("			 ,A1.COST_YRMON" ).append("\n"); 
		query.append("             ,A1.COST_WK " ).append("\n"); 
		query.append("             ,A1.TRD_CD " ).append("\n"); 
		query.append("             ,A5.IAS_RGN_CD" ).append("\n"); 
		query.append("             ,A5.HUL_BND_CD" ).append("\n"); 
		query.append("             ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("             ,A1.RLANE_CD " ).append("\n"); 
		query.append("             ,A1.VSL_CD " ).append("\n"); 
		query.append("             ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("             ,A1.DIR_CD " ).append("\n"); 
		query.append("             ,A1.IOC_CD " ).append("\n"); 
		query.append("             ,ROUND(A3.LOD_QTY,9) AS LOD_QTY" ).append("\n"); 
		query.append("             ,A3.GRS_RPB_REV " ).append("\n"); 
		query.append("             ,A3.PA_CM_UC_AMT " ).append("\n"); 
		query.append("             ,A3.RA_CM_UC_AMT " ).append("\n"); 
		query.append("             ,A3.BSE_QTR_CD " ).append("\n"); 
		query.append("        #if(${f_rf_sts} !='' || ${f_sc_sts} !='')" ).append("\n"); 
		query.append("             ,A3.BSE_YR" ).append("\n"); 
		query.append("             ,MAX(A3.BSE_YR) OVER (PARTITION BY A3.TRD_CD, A3.RLANE_CD, A3.DIR_CD, A3.VSL_CD, A3.SKD_VOY_NO, A3.SKD_DIR_CD) BSE_YR_CHK " ).append("\n"); 
		query.append("        #else" ).append("\n"); 
		query.append("             ,A3.QTA_RLSE_VER_NO" ).append("\n"); 
		query.append("             ,MAX(A3.QTA_RLSE_VER_NO) OVER (PARTITION BY A3.TRD_CD, A3.RLANE_CD, A3.DIR_CD, A3.VSL_CD, A3.SKD_VOY_NO, A3.SKD_DIR_CD) QTA_VER_NO" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("             ,MAX(A3.BSE_QTR_CD) OVER (PARTITION BY A3.BSE_YR, A3.TRD_CD, A3.RLANE_CD, A3.DIR_CD, A3.VSL_CD, A3.SKD_VOY_NO, A3.SKD_DIR_CD) QTR_CD " ).append("\n"); 
		query.append("           FROM MAS_MON_VVD A1 " ).append("\n"); 
		query.append("        #if(${f_rf_sts} !='' || ${f_sc_sts} !='')" ).append("\n"); 
		query.append("             ,SQM_SPCL_CFM_QTA A3" ).append("\n"); 
		query.append("        #else" ).append("\n"); 
		query.append("             ,SQM_CFM_QTA A3" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("             ,SQM_QTA_RLSE_VER A2" ).append("\n"); 
		query.append("             ,MAS_OFC_LVL A4" ).append("\n"); 
		query.append("             ,MAS_LANE_RGST A5 " ).append("\n"); 
		query.append("          WHERE 1=1 " ).append("\n"); 
		query.append("            AND A1.TRD_CD           = A3.TRD_CD " ).append("\n"); 
		query.append("            AND A1.RLANE_CD         = A3.RLANE_CD " ).append("\n"); 
		query.append("            AND A1.VSL_CD           = A3.VSL_CD " ).append("\n"); 
		query.append("            AND A1.SKD_VOY_NO       = A3.SKD_VOY_NO " ).append("\n"); 
		query.append("            AND A1.DIR_CD           = A3.SKD_DIR_CD " ).append("\n"); 
		query.append("            AND A1.RLANE_CD         = A5.RLANE_CD " ).append("\n"); 
		query.append("            AND A1.DIR_CD           = A5.DIR_CD" ).append("\n"); 
		query.append("            AND A1.TRD_CD           = A5.TRD_CD " ).append("\n"); 
		query.append("            AND A1.IOC_CD           = A5.IOC_CD " ).append("\n"); 
		query.append("            AND A3.BSE_TP_CD        = 'Q'" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("            AND A1.COST_YRMON       BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("            AND A1.SLS_YRMON        BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_rf_sts} =='' && ${f_sc_sts} =='')" ).append("\n"); 
		query.append("            AND A2.QTA_RLSE_VER_NO  = A3.QTA_RLSE_VER_NO " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("            AND A2.BSE_YR           = A3.BSE_YR" ).append("\n"); 
		query.append("            AND A2.BSE_QTR_CD       = A3.BSE_QTR_CD" ).append("\n"); 
		query.append("			AND A2.BSE_TP_CD		= A3.BSE_TP_CD" ).append("\n"); 
		query.append("            AND A2.SQM_VER_STS_CD  = 'R'" ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("#if(${f_rf_sts} !='')                      " ).append("\n"); 
		query.append("            AND A3.SPCL_TGT_CD       = 'R'  " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("#elseif(${f_sc_sts} !='') " ).append("\n"); 
		query.append("            AND A3.SPCL_TGT_CD       = 'S'  " ).append("\n"); 
		query.append("#else                             " ).append("\n"); 
		query.append("            AND A3.OFC_VW_CD       = @[f_ofc_vw]  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("            AND A1.COST_YRMON       BETWEEN '${f_year}'||'${f_fm_mon}' AND '${f_year}'||'${f_to_mon}' " ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("            AND SUBSTR(A1.SLS_YRMON, 1, 4)||A1.COST_WK BETWEEN @[f_year]||@[f_fm_wk] AND @[f_year]||@[f_to_wk] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("            AND A1.DELT_FLG         = 'N' " ).append("\n"); 
		query.append("            AND A3.RGN_OFC_CD       = A4.OFC_CD        " ).append("\n"); 
		query.append("#if(${f_ofc_cd} !='')" ).append("\n"); 
		query.append("    #if(${f_excl_sts} =='')" ).append("\n"); 
		query.append("            AND DECODE(@[f_ofc_lvl1], '1', a4.ofc_n1st_lvl_cd, '2', a4.ofc_n2nd_lvl_cd, '3', a4.ofc_n3rd_lvl_cd, '4', a4.ofc_n4th_lvl_cd, '5', a4.ofc_n5th_lvl_cd, '6', a4.ofc_n6th_lvl_cd, '7', a4.ofc_n7th_lvl_cd) = @[f_ofc_cd]       " ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("            AND A4.ofc_cd = @[f_ofc_cd] " ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ofc_lvl1}=='6' || ${f_ofc_lvl1}=='7')" ).append("\n"); 
		query.append("            AND A4.OFC_LVL = @[f_ofc_lvl1]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	-------------------------------------------------------------------------------" ).append("\n"); 
		query.append("            AND A4.OFC_LVL < '9'" ).append("\n"); 
		query.append("	-------------------------------------------------------------------------------" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_trd_cd} !='')                       " ).append("\n"); 
		query.append("            AND A1.TRD_CD   = @[f_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='')                       " ).append("\n"); 
		query.append("            AND A1.SUB_TRD_CD   = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ias_rgn_cd} !='')                       " ).append("\n"); 
		query.append("            AND A5.IAS_RGN_CD   = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_hul_bnd_cd} !='')                       " ).append("\n"); 
		query.append("            AND A5.HUL_BND_CD   = @[f_hul_bnd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rlane_cd} !='')" ).append("\n"); 
		query.append("            AND A1.RLANE_CD = @[f_rlane_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_cd} !='')" ).append("\n"); 
		query.append("            AND A1.DIR_CD   = @[f_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_vsl_cd} !='')" ).append("\n"); 
		query.append("            AND A1.VSL_CD   = @[f_vsl_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_voy_no} !='')" ).append("\n"); 
		query.append("            AND A1.SKD_VOY_NO = @[f_skd_voy_no] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='')" ).append("\n"); 
		query.append("            AND A1.DIR_CD   = @[f_skd_dir_cd]     " ).append("\n"); 
		query.append("#end         " ).append("\n"); 
		query.append("            ) " ).append("\n"); 
		query.append("       WHERE 1=1 " ).append("\n"); 
		query.append("#if(${f_rf_sts} !='' || ${f_sc_sts} !='')" ).append("\n"); 
		query.append("         AND BSE_YR = BSE_YR_CHK " ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("         AND QTA_RLSE_VER_NO = QTA_VER_NO " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("         AND BSE_QTR_CD = QTR_CD " ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("      GROUP BY '' " ).append("\n"); 
		query.append("            ,OFC_CD1 " ).append("\n"); 
		query.append("            ,OFC_CD2" ).append("\n"); 
		query.append("			,COST_YRMON " ).append("\n"); 
		query.append("            ,COST_WK " ).append("\n"); 
		query.append("            ,TRD_CD " ).append("\n"); 
		query.append("            ,IAS_RGN_CD" ).append("\n"); 
		query.append("            ,HUL_BND_CD" ).append("\n"); 
		query.append("            ,SUB_TRD_CD " ).append("\n"); 
		query.append("            ,RLANE_CD " ).append("\n"); 
		query.append("            ,VSL_CD " ).append("\n"); 
		query.append("            ,SKD_VOY_NO " ).append("\n"); 
		query.append("            ,DIR_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ofc_lvl1} =='1')         " ).append("\n"); 
		query.append("       UNION ALL" ).append("\n"); 
		query.append("         SELECT '' " ).append("\n"); 
		query.append("            ,NULL AS OFC_CD1 " ).append("\n"); 
		query.append("            ,NULL AS OFC_CD2 " ).append("\n"); 
		query.append("			,COST_YRMON" ).append("\n"); 
		query.append("            ,COST_WK " ).append("\n"); 
		query.append("            ,TRD_CD " ).append("\n"); 
		query.append("            ,IAS_RGN_CD" ).append("\n"); 
		query.append("            ,HUL_BND_CD" ).append("\n"); 
		query.append("            ,SUB_TRD_CD " ).append("\n"); 
		query.append("            ,RLANE_CD " ).append("\n"); 
		query.append("            ,VSL_CD " ).append("\n"); 
		query.append("            ,SKD_VOY_NO " ).append("\n"); 
		query.append("            ,DIR_CD " ).append("\n"); 
		query.append("            ,NULL AS CUST_GRP_ID" ).append("\n"); 
		query.append("            ,NULL AS CUST_GRP_NM" ).append("\n"); 
		query.append("            ,NULL AS LOD_SPL_CNG_FLG " ).append("\n"); 
		query.append("            ,NULL AS VVD_BSA_CAPA " ).append("\n"); 
		query.append("            ,NULL AS MAS_QTY " ).append("\n"); 
		query.append("            ,NULL AS FR_REV " ).append("\n"); 
		query.append("            ,NULL AS TOT_REV " ).append("\n"); 
		query.append("            ,NULL AS DMDT " ).append("\n"); 
		query.append("            ,NULL AS CM_COST " ).append("\n"); 
		query.append("            ,NULL AS OP_COST " ).append("\n"); 
		query.append("            ,MAX(DECODE(RLANE_CD, 'RBCCO' , DECODE(IOC_CD, 'O', 0 ,FNL_BSA_CAPA), FNL_BSA_CAPA)) QTA_BSA " ).append("\n"); 
		query.append("            ,NULL AS QTA_LOAD " ).append("\n"); 
		query.append("            ,NULL AS QTA_REV " ).append("\n"); 
		query.append("            ,NULL AS QTA_BKG_CM " ).append("\n"); 
		query.append("            ,NULL AS QTA_CM_COST " ).append("\n"); 
		query.append("            ,NULL AS OFC_CD " ).append("\n"); 
		query.append("         FROM (" ).append("\n"); 
		query.append("              SELECT " ).append("\n"); 
		query.append("                  ''" ).append("\n"); 
		query.append("				 ,A1.COST_YRMON " ).append("\n"); 
		query.append("                 ,A1.COST_WK " ).append("\n"); 
		query.append("                 ,A1.TRD_CD " ).append("\n"); 
		query.append("                 ,A4.IAS_RGN_CD" ).append("\n"); 
		query.append("                 ,A4.HUL_BND_CD" ).append("\n"); 
		query.append("                 ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("                 ,A1.RLANE_CD " ).append("\n"); 
		query.append("                 ,A1.VSL_CD " ).append("\n"); 
		query.append("                 ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("                 ,A1.DIR_CD " ).append("\n"); 
		query.append("                 ,A1.IOC_CD " ).append("\n"); 
		query.append("                 ,A3.FNL_BSA_CAPA " ).append("\n"); 
		query.append("                 ,A3.BSE_QTR_CD " ).append("\n"); 
		query.append("             #if(${f_rf_sts} !='' || ${f_sc_sts} !='') " ).append("\n"); 
		query.append("                 ,A3.BSE_YR" ).append("\n"); 
		query.append("                 ,MAX(A3.BSE_YR) OVER (PARTITION BY A3.TRD_CD, A3.RLANE_CD, A3.DIR_CD, A3.VSL_CD, A3.SKD_VOY_NO, A3.SKD_DIR_CD) BSE_YR_CHK" ).append("\n"); 
		query.append("             #else" ).append("\n"); 
		query.append("                 ,A3.QTA_RLSE_VER_NO" ).append("\n"); 
		query.append("                 ,MAX(A3.QTA_RLSE_VER_NO) OVER (PARTITION BY A3.TRD_CD, A3.RLANE_CD, A3.DIR_CD, A3.VSL_CD, A3.SKD_VOY_NO, A3.SKD_DIR_CD) QTA_VER_NO" ).append("\n"); 
		query.append("             #end" ).append("\n"); 
		query.append("                 ,MAX(A3.BSE_QTR_CD) OVER (PARTITION BY A3.BSE_YR, A3.TRD_CD, A3.RLANE_CD, A3.DIR_CD, A3.VSL_CD, A3.SKD_VOY_NO, A3.SKD_DIR_CD) QTR_CD " ).append("\n"); 
		query.append("              FROM MAS_MON_VVD A1 " ).append("\n"); 
		query.append("                 " ).append("\n"); 
		query.append("             #if(${f_rf_sts} !='' || ${f_sc_sts} !='') " ).append("\n"); 
		query.append("                 ,SQM_SPCL_TGT_VVD A3 " ).append("\n"); 
		query.append("             #else" ).append("\n"); 
		query.append("                 ,SQM_CFM_TGT_VVD A3" ).append("\n"); 
		query.append("             #end" ).append("\n"); 
		query.append("                 ,SQM_QTA_RLSE_VER A2" ).append("\n"); 
		query.append("                 ,MAS_LANE_RGST A4 " ).append("\n"); 
		query.append("              WHERE 1=1 " ).append("\n"); 
		query.append("                AND A1.TRD_CD             = A3.TRD_CD " ).append("\n"); 
		query.append("                AND A1.RLANE_CD           = A3.RLANE_CD " ).append("\n"); 
		query.append("                AND A1.VSL_CD             = A3.VSL_CD " ).append("\n"); 
		query.append("                AND A1.SKD_VOY_NO         = A3.SKD_VOY_NO " ).append("\n"); 
		query.append("                AND A1.DIR_CD             = A3.DIR_CD " ).append("\n"); 
		query.append("                AND A1.RLANE_CD           = A4.RLANE_CD " ).append("\n"); 
		query.append("                AND A1.DIR_CD             = A4.DIR_CD" ).append("\n"); 
		query.append("                AND A1.TRD_CD             = A4.TRD_CD " ).append("\n"); 
		query.append("                AND A1.IOC_CD             = A4.IOC_CD" ).append("\n"); 
		query.append("                AND A3.BSE_TP_CD          = 'Q'" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("#if(${f_rf_sts} =='' && ${f_sc_sts} =='') " ).append("\n"); 
		query.append("                AND A2.QTA_RLSE_VER_NO   = A3.QTA_RLSE_VER_NO " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                AND A2.BSE_YR             = A3.BSE_YR" ).append("\n"); 
		query.append("                AND A2.BSE_QTR_CD         = A3.BSE_QTR_CD" ).append("\n"); 
		query.append("				AND A2.BSE_TP_CD		= A3.BSE_TP_CD" ).append("\n"); 
		query.append("                AND A2.SQM_VER_STS_CD    = 'R'" ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("                AND A1.COST_YRMON   BETWEEN '${f_year}'||'${f_fm_mon}' AND '${f_year}'||'${f_to_mon}'     " ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("                AND SUBSTR(A1.SLS_YRMON, 1, 4)||A1.COST_WK BETWEEN @[f_year]||@[f_fm_wk] AND @[f_year]||@[f_to_wk]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                AND NVL(A1.DELT_FLG,'N')  = 'N'                    " ).append("\n"); 
		query.append("                AND NVL(@[f_ofc_cd],'N')  = 'N'  " ).append("\n"); 
		query.append("                AND NVL(@[f_ofc_sts],'N') = 'N'      " ).append("\n"); 
		query.append("#if(${f_trd_cd} !='')                       " ).append("\n"); 
		query.append("                AND A1.TRD_CD   = @[f_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='')                       " ).append("\n"); 
		query.append("                AND A1.SUB_TRD_CD= @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ias_rgn_cd} !='')                       " ).append("\n"); 
		query.append("                AND A4.IAS_RGN_CD   = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_hul_bnd_cd} !='')                       " ).append("\n"); 
		query.append("                AND A4.HUL_BND_CD   = @[f_hul_bnd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rlane_cd} !='')" ).append("\n"); 
		query.append("                AND A1.RLANE_CD = @[f_rlane_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_cd} !='')" ).append("\n"); 
		query.append("                AND A1.DIR_CD   = @[f_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_vsl_cd} !='')" ).append("\n"); 
		query.append("                AND A1.VSL_CD   = @[f_vsl_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_voy_no} !='')" ).append("\n"); 
		query.append("                AND A1.SKD_VOY_NO = @[f_skd_voy_no] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='')" ).append("\n"); 
		query.append("                AND A1.DIR_CD   = @[f_skd_dir_cd]     " ).append("\n"); 
		query.append("#end  " ).append("\n"); 
		query.append("               ) " ).append("\n"); 
		query.append("         WHERE 1=1 " ).append("\n"); 
		query.append("#if(${f_rf_sts} !='' || ${f_sc_sts} !='')" ).append("\n"); 
		query.append("           AND BSE_YR = BSE_YR_CHK " ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("           AND QTA_RLSE_VER_NO = QTA_VER_NO " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("           AND BSE_QTR_CD = QTR_CD " ).append("\n"); 
		query.append("      GROUP BY ''" ).append("\n"); 
		query.append("			  ,COST_YRMON " ).append("\n"); 
		query.append("              ,COST_WK " ).append("\n"); 
		query.append("              ,TRD_CD " ).append("\n"); 
		query.append("              ,IAS_RGN_CD" ).append("\n"); 
		query.append("              ,HUL_BND_CD" ).append("\n"); 
		query.append("              ,SUB_TRD_CD " ).append("\n"); 
		query.append("              ,RLANE_CD " ).append("\n"); 
		query.append("              ,VSL_CD " ).append("\n"); 
		query.append("              ,SKD_VOY_NO " ).append("\n"); 
		query.append("              ,DIR_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_view_cust} == 'Y')" ).append("\n"); 
		query.append("       UNION ALL" ).append("\n"); 
		query.append("       SELECT ''" ).append("\n"); 
		query.append("             ,OFC_CD1 " ).append("\n"); 
		query.append("             ,OFC_CD2" ).append("\n"); 
		query.append("			 ,COST_YRMON" ).append("\n"); 
		query.append("             ,COST_WK " ).append("\n"); 
		query.append("             ,TRD_CD " ).append("\n"); 
		query.append("             ,IAS_RGN_CD" ).append("\n"); 
		query.append("             ,HUL_BND_CD" ).append("\n"); 
		query.append("             ,SUB_TRD_CD " ).append("\n"); 
		query.append("             ,RLANE_CD " ).append("\n"); 
		query.append("             ,VSL_CD " ).append("\n"); 
		query.append("             ,SKD_VOY_NO " ).append("\n"); 
		query.append("             ,DIR_CD " ).append("\n"); 
		query.append("             ,CUST_GRP_ID" ).append("\n"); 
		query.append("             ,CUST_GRP_NM" ).append("\n"); 
		query.append("             ,NULL AS LOD_SPL_CNG_FLG " ).append("\n"); 
		query.append("             ,NULL AS VVD_BSA_CAPA " ).append("\n"); 
		query.append("             ,NULL AS MAS_QTY " ).append("\n"); 
		query.append("             ,NULL AS FR_REV " ).append("\n"); 
		query.append("             ,NULL AS TOT_REV " ).append("\n"); 
		query.append("             ,NULL AS DMDT " ).append("\n"); 
		query.append("             ,NULL AS CM_COST " ).append("\n"); 
		query.append("             ,NULL AS OP_COST " ).append("\n"); 
		query.append("             ,NULL AS QTA_BSA " ).append("\n"); 
		query.append("             ,SUM(LOD_QTY) QTA_LOAD " ).append("\n"); 
		query.append("             ,NULL AS QTA_REV " ).append("\n"); 
		query.append("             ,NULL AS QTA_BKG_CM  " ).append("\n"); 
		query.append("             ,SUM(LOD_QTY * RA_CMPB_AMT) QTA_CM_COST  " ).append("\n"); 
		query.append("             ,NULL AS OFC_CD " ).append("\n"); 
		query.append("         FROM (     " ).append("\n"); 
		query.append("                SELECT DISTINCT" ).append("\n"); 
		query.append("                        ''" ).append("\n"); 
		query.append("                       ,NULL AS OFC_CD1 " ).append("\n"); 
		query.append("                       ,NULL AS OFC_CD2 " ).append("\n"); 
		query.append("					   ,NULL AS COST_YRMON" ).append("\n"); 
		query.append("                       ,NULL AS COST_WK" ).append("\n"); 
		query.append("                       ,A3.TRD_CD" ).append("\n"); 
		query.append("                       ,NULL AS IAS_RGN_CD" ).append("\n"); 
		query.append("                       ,NULL AS HUL_BND_CD                       " ).append("\n"); 
		query.append("                       ,A3.SUB_TRD_CD" ).append("\n"); 
		query.append("                       ,NULL AS RLANE_CD" ).append("\n"); 
		query.append("                       ,NULL AS VSL_CD" ).append("\n"); 
		query.append("                       ,NULL AS SKD_VOY_NO" ).append("\n"); 
		query.append("                       ,A3.DIR_CD" ).append("\n"); 
		query.append("#if(${f_gcust_sts} == 'Y')" ).append("\n"); 
		query.append("                       ,A3.CUST_GRP_ID" ).append("\n"); 
		query.append("                       ,(SELECT G.CUST_GRP_NM" ).append("\n"); 
		query.append("                           FROM MDM_CUST_PERF_GRP G" ).append("\n"); 
		query.append("                          WHERE A3.CUST_GRP_ID = G.CUST_GRP_ID (+)" ).append("\n"); 
		query.append("                        ) CUST_GRP_NM" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("                       ,NULL CUST_GRP_ID" ).append("\n"); 
		query.append("                       ,NULL CUST_GRP_NM" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                       ,NULL AS IOC_CD" ).append("\n"); 
		query.append("                       ,ROUND(A3.LOD_QTY,9) AS LOD_QTY" ).append("\n"); 
		query.append("                       ,NULL AS GRS_RPB_REV" ).append("\n"); 
		query.append("                       ,NULL AS CM_UC_AMT" ).append("\n"); 
		query.append("                       ,NULL AS RA_CM_UC_AMT" ).append("\n"); 
		query.append("                       ,NULL AS BSE_QTR_CD" ).append("\n"); 
		query.append("                       ,NULL AS OPFIT_UC_AMT" ).append("\n"); 
		query.append("                       ,NULL AS RA_OPFIT_UC_AMT" ).append("\n"); 
		query.append("                       ,NULL AS MQTA_RLSE_VER_NO" ).append("\n"); 
		query.append("                       ,RA_CMPB_AMT" ).append("\n"); 
		query.append("                   FROM SQM_KEY_ACCT_CFM_QTA A3" ).append("\n"); 
		query.append("                  WHERE 1=1 " ).append("\n"); 
		query.append("                    AND A3.BSE_TP_CD        = 'Q'" ).append("\n"); 
		query.append("                    AND A3.BSE_MON          = @[f_fm_mon] " ).append("\n"); 
		query.append("                    AND A3.BSE_YR           = @[f_year]" ).append("\n"); 
		query.append("                    AND A3.BSE_QTR_CD       = DECODE(@[f_fm_mon], '01', '1Q', '02', '1Q', '03', '1Q'" ).append("\n"); 
		query.append("                                                                , '04', '2Q', '05', '2Q', '06', '2Q'" ).append("\n"); 
		query.append("                                                                , '07', '3Q', '08', '3Q', '09', '3Q'" ).append("\n"); 
		query.append("                                                                , '10', '4Q', '11', '4Q', '12', '4Q')" ).append("\n"); 
		query.append("#if ((${f_key_acct_group_cd} != '' && ${f_key_acct_group_cd} != 'All') || ${f_otr_key_acct} != '')" ).append("\n"); 
		query.append("                    AND A3.ACCT_TGT_CD       = 'C'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${f_otr_local_acct} != '')" ).append("\n"); 
		query.append("                    AND EXISTS (" ).append("\n"); 
		query.append("                        SELECT 1" ).append("\n"); 
		query.append("                          FROM MDM_CUST_PERF_GRP GRP_C" ).append("\n"); 
		query.append("                         WHERE GRP_C.DELT_FLG                   = 'N' " ).append("\n"); 
		query.append("                           AND NVL(GRP_C.NEW_KEY_ACCT_FLG ,'N') = 'N'" ).append("\n"); 
		query.append("                           AND NVL(GRP_C.RGN_ACCT_FLG,'N')      = 'N'" ).append("\n"); 
		query.append("                           AND A3.CUST_GRP_ID                   = GRP_C.CUST_GRP_ID" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("                    )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${f_view_cust} == 'Y' && (${f_ofc_team_cd} != '' && ${f_ofc_team_cd} != 'All') || ${f_rhq_cd} != '' && ${f_rhq_cd} != 'All')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    AND  EXISTS (" ).append("\n"); 
		query.append("                        SELECT 1" ).append("\n"); 
		query.append("                          FROM MDM_CUST_PERF_GRP GRP_C" ).append("\n"); 
		query.append("                         WHERE GRP_C.DELT_FLG       = 'N' " ).append("\n"); 
		query.append("                           AND GRP_C.OFC_TEAM_CD    LIKE '${f_ofc_team_cd}'||'%'" ).append("\n"); 
		query.append("                           AND GRP_C.RHQ_CD         LIKE '${f_rhq_cd}'||'%'                                 " ).append("\n"); 
		query.append("                           AND A3.CUST_GRP_ID       = GRP_C.CUST_GRP_ID" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("                    )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ((${f_ra_acct_group_cd} != '' && ${f_ra_acct_group_cd} != 'All') || ${f_otr_regional_acct} != '')" ).append("\n"); 
		query.append("                    AND A3.ACCT_TGT_CD       = 'R'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${f_key_acct_group_cd} != '' && ${f_key_acct_group_cd} != 'All')" ).append("\n"); 
		query.append("                    AND A3.CUST_GRP_ID      = '${f_key_acct_group_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${f_ra_acct_group_cd} != '' && ${f_ra_acct_group_cd} != 'All')" ).append("\n"); 
		query.append("                    AND A3.CUST_GRP_ID      = '${f_ra_acct_group_cd}'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_trd_cd} !='')                       " ).append("\n"); 
		query.append("                    AND A3.TRD_CD           = @[f_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='')                       " ).append("\n"); 
		query.append("                    AND A3.SUB_TRD_CD       = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='')" ).append("\n"); 
		query.append("                    AND A3.DIR_CD           = @[f_skd_dir_cd]     " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append("     GROUP BY '' " ).append("\n"); 
		query.append("             ,OFC_CD1 " ).append("\n"); 
		query.append("             ,OFC_CD2" ).append("\n"); 
		query.append("			 ,COST_YRMON " ).append("\n"); 
		query.append("             ,COST_WK " ).append("\n"); 
		query.append("             ,TRD_CD " ).append("\n"); 
		query.append("             ,IAS_RGN_CD" ).append("\n"); 
		query.append("             ,HUL_BND_CD" ).append("\n"); 
		query.append("             ,SUB_TRD_CD " ).append("\n"); 
		query.append("             ,RLANE_CD " ).append("\n"); 
		query.append("             ,VSL_CD " ).append("\n"); 
		query.append("             ,SKD_VOY_NO " ).append("\n"); 
		query.append("             ,DIR_CD" ).append("\n"); 
		query.append("             ,CUST_GRP_ID" ).append("\n"); 
		query.append("             ,CUST_GRP_NM" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("              ) " ).append("\n"); 
		query.append(" GROUP BY '' " ).append("\n"); 
		query.append("          ,OFC_CD1 " ).append("\n"); 
		query.append("          ,OFC_CD2" ).append("\n"); 
		query.append("#if(${f_r_month_sts} =='Y'||${f_rpt_item} =='4')              " ).append("\n"); 
		query.append("          ,COST_YRMON " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("#if(${f_wk_sts} =='Y'||${f_rpt_item} =='4')              " ).append("\n"); 
		query.append("          ,COST_WK " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("          ,TRD_CD" ).append("\n"); 
		query.append("#if( ${f_ias_rgn_sts} =='Y')" ).append("\n"); 
		query.append("          ,IAS_RGN_CD " ).append("\n"); 
		query.append("#end          " ).append("\n"); 
		query.append("#if( ${f_hul_bnd_sts} =='Y')" ).append("\n"); 
		query.append("          ,HUL_BND_CD " ).append("\n"); 
		query.append("#end          " ).append("\n"); 
		query.append("#if(${f_rpt_item} !='1')" ).append("\n"); 
		query.append("          ,SUB_TRD_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rpt_item} =='3'||${f_rpt_item} =='4')" ).append("\n"); 
		query.append("          ,RLANE_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rpt_item} =='4')" ).append("\n"); 
		query.append("          ,VSL_CD " ).append("\n"); 
		query.append("          ,SKD_VOY_NO" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_sts} =='Y'||${f_rpt_item}=='4')       " ).append("\n"); 
		query.append("          ,DIR_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("          ,CUST_GRP_ID" ).append("\n"); 
		query.append("          ,CUST_GRP_NM" ).append("\n"); 
		query.append("  ) " ).append("\n"); 
		query.append("WHERE QTA_LOAD + MAS_LOAD <> 0--'0'" ).append("\n"); 
		query.append("ORDER BY       " ).append("\n"); 
		query.append("   OFC_CD1 " ).append("\n"); 
		query.append("  ,OFC_CD2" ).append("\n"); 
		query.append("  ,COST_YRMON" ).append("\n"); 
		query.append("  ,COST_WK" ).append("\n"); 
		query.append("  ,TRD_CD" ).append("\n"); 
		query.append("  ,IAS_RGN_CD" ).append("\n"); 
		query.append("  ,HUL_BND_CD" ).append("\n"); 
		query.append("  ,SUB_TRD_CD" ).append("\n"); 
		query.append("  ,RLANE_CD" ).append("\n"); 
		query.append("  ,VSL_CD " ).append("\n"); 
		query.append("  ,SKD_VOY_NO" ).append("\n"); 
		query.append("  ,DIR_CD" ).append("\n"); 

	}
}