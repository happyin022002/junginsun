<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CommonDBDAOSearchTradeComboListRSQL">
			<desc><![CDATA[김종준 CHM-201110708-01 ESM_SPC_0029의 Trade COMBO DATA 조회]]></desc>
			<sql><![CDATA[
/* Trade List를  가져 온다 */
   SELECT B.TRD_CD TRD_CD
		, B.TRD_NM TRD_NM
     FROM (
             SELECT DISTINCT
                    B.TRD_CD
               FROM MDM_REV_LANE     A,
                    MDM_DTL_REV_LANE B,
                    MDM_VSL_SVC_LANE C
#if(${isPus} == 'true')
                    ,(SELECT DISTINCT P.VSL_SLAN_CD, P.SKD_DIR_CD
                      FROM VSK_PF_SKD S,
                           VSK_PF_SKD_DTL P,
                           VSK_VSL_SKD V
                     WHERE S.SLAN_STND_FLG = 'Y'
                       AND S.VSL_SLAN_CD = P.VSL_SLAN_CD
                       AND S.PF_SVC_TP_CD = P.PF_SVC_TP_CD
                       AND P.PORT_CD = 'KRPUS'
                       AND TURN_PORT_IND_CD <> 'F'
                       AND V.VSL_SLAN_CD = S.VSL_SLAN_CD
                       AND V.PF_SKD_TP_CD = S.PF_SVC_TP_CD
                       AND V.SKD_STS_CD <> 'CLO') P
#end
              WHERE A.RLANE_CD    = B.RLANE_CD
                AND A.VSL_TP_CD   = 'C'
#if (${is_rep_trade} == 'true')
                /* Rep Trade 경우 추가 option 조건 */
                AND A.REP_TRD_CD  = B.TRD_CD
#end
                AND B.DELT_FLG   IN ('N', @[del])
                AND B.TRD_CD     <> 'COM'
                AND A.VSL_SLAN_CD = C.VSL_SLAN_CD
                AND DECODE(C.VSL_SVC_TP_CD, 'I', C.CO_CD, '1') = DECODE(C.VSL_SVC_TP_CD, 'I', 'H', '1')
                AND C.VSL_SVC_TP_CD <> 'O'
#if(${isPus} == 'true')
                AND A.VSL_SLAN_CD = P.VSL_SLAN_CD
                AND B.VSL_SLAN_DIR_CD = P.SKD_DIR_CD
                AND B.FM_CONTI_CD = 'A'
                AND B.TO_CONTI_CD IN ('E', 'M')
                AND EXISTS (SELECT 'A' 
                              FROM MAS_MON_VVD M
                             WHERE SUBSTR(M.SLS_YRMON, 1, 4) = TO_CHAR(SYSDATE, 'YYYY')
                               AND CEIL(TO_NUMBER(SUBSTR(M.SLS_YRMON, 5, 2)) / 3)||'Q' = CEIL(TO_NUMBER(TO_CHAR(SYSDATE, 'MM')) / 3)||'Q'
                               AND M.DELT_FLG = 'N'
                               AND M.TRD_CD = B.TRD_CD
                               AND M.RLANE_CD = B.RLANE_CD)
#end
         ) A,
         MDM_TRADE B
   WHERE A.TRD_CD = B.TRD_CD
ORDER BY B.TRD_CD			]]></sql>
			<params>
				<param name="del" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
