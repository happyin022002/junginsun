<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="IndiaCustomsReportDBDAOSearchExportAdvanceInfoRSQL">
			<desc><![CDATA[searchExportAdvanceInfo를 조회하기 위해 생성]]></desc>
			<sql><![CDATA[
SELECT 'CTR' CTR, 
       '' BAY_LOC, 
       BC.CNTR_NO, 
       BC.MEAS_QTY, 
       (SELECT CNTR_TPSZ_ISO_CD 
        FROM MDM_CNTR_TP_SZ
        WHERE BC.CNTR_TPSZ_CD = CNTR_TPSZ_CD) ISO_CD, 
       DECODE(BB.BKG_CGO_TP_CD, 'F', 'F', 'E') STS, 
       (SELECT DISTINCT IMDG_CLSS_CD 
        FROM BKG_DG_CGO BDC
        WHERE BC.BKG_NO = BDC.BKG_NO 
        AND BC.CNTR_NO = BDC.CNTR_NO 
        AND ROWNUM = 1) IMO,
       'NSA' POL, 
       SUBSTR(BV.POD_CD, 3, 5) POD,
       'E' CATE,
       NVL(BB.ORG_TRNS_MOD_CD, ' ') KIND,
       DECODE(@[terminal_val], 'JNPT', 'SML1', 'SML') LINE,
       DECODE(BC.RC_FLG, 'Y', 'Y', 'N') RF_FLG,
       (SELECT DISTINCT CDO_TEMP FROM BKG_RF_CGO BRC
        WHERE BC.BKG_NO = BRC.BKG_NO
        AND   BC.CNTR_NO = BRC.CNTR_NO
        AND   ROWNUM = 1) TEMP, 
       DECODE(BC.RC_FLG, 'Y', 'C', '') UNIT   
FROM VSK_VSL_PORT_SKD VPS, BKG_BOOKING BB, BKG_CONTAINER BC, BKG_VVD BV
WHERE 1=1 
--1. 기간 조건(M)
AND VPS_ETD_DT BETWEEN TO_DATE(@[from_dt], 'YYYY-MM-DD') AND TO_DATE(@[to_dt], 'YYYY-MM-DD') + 0.99999
--2. VVD 조건(O)
AND VPS.VSL_CD 		= SUBSTR(@[export_vvd], 1, 4)
AND	VPS.SKD_VOY_NO 	= SUBSTR(@[export_vvd], 5, 4)
AND	VPS.SKD_DIR_CD 	= SUBSTR(@[export_vvd], 9, 1)
--3. POL 조건(M)
AND BV.POL_CD LIKE @[pol]||'%'
--4. 터미널 선택 조건(M)은 select시 사용

AND VPS.VSL_CD 		= BV.VSL_CD
AND	VPS.SKD_VOY_NO 	= BV.SKD_VOY_NO
AND	VPS.SKD_DIR_CD 	= BV.SKD_DIR_CD
AND VPS.VPS_PORT_CD = BV.POL_CD
AND BB.BKG_NO = BC.BKG_NO
AND BB.BKG_NO = BV.BKG_NO
AND	BB.BKG_STS_CD	   <>  'X'			]]></sql>
			<params>
				<param name="terminal_val" type="12" value="" out="N"/>
				<param name="from_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
				<param name="export_vvd" type="12" value="" out="N"/>
				<param name="pol" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
