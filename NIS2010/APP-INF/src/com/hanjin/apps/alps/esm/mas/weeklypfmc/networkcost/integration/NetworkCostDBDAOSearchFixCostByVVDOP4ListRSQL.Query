<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="NetworkCostDBDAOSearchFixCostByVVDOP4ListRSQL">
			<desc><![CDATA[NetworkCost의 데이타 모델에 해당되는 값을 불러온다
History ----------------------------
2011.02.21 김상수 [CHM-201108827-01] 1. R.month/Week 및 OPR/OPR2 정보 보여주는 컬럼 추가
                                     2. Re-Assignment by bound, Re-Assignment by bound(OP4)
                                        화면상에서 틀고정 기능 추가
                                     3. js상의 validation함수 정리 및  coMas.js로 소스이동
2015.03.05 김시몬 [CHM-201533657] '72100000' Interest 계정 추가]]></desc>
			<sql><![CDATA[
SELECT SLS_YRMON,
       COST_YRMON,
       COST_WK,
       TRD_CD,
       RLANE_CD,
       OP_LANE_TP_CD AS LANE_TP_CD,
       VSL_CD||SKD_VOY_NO||DIR_CD AS VVD,
	   (SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD03217' AND INTG_CD_VAL_CTNT = HUL_BND_CD) HUL_BND_CD,
       FNL_HJS_BSA_CAPA BSA,
       SUM (DECODE (STND_COST_CD, '54100000', N4TH_NTWK_COST_AMT, 0)) AS AMT_01,
       SUM (DECODE (STND_COST_CD, '54250000', N4TH_NTWK_COST_AMT, 0)) AS AMT_02,
       SUM (DECODE (STND_COST_CD, '54200000', N4TH_NTWK_COST_AMT, 0)) AS AMT_03,
       SUM (DECODE (STND_COST_CD, '54300000', N4TH_NTWK_COST_AMT, 0)) AS AMT_04,
       SUM (DECODE (STND_COST_CD, '54150000', N4TH_NTWK_COST_AMT, 0)) AS AMT_05,
       SUM (DECODE (STND_COST_CD, '54450000', N4TH_NTWK_COST_AMT, 0)) AS AMT_06,
       SUM (DECODE (STND_COST_CD, '54180000', N4TH_NTWK_COST_AMT, 0)) AS AMT_07,
       SUM (DECODE (STND_COST_CD, '54550000', N4TH_NTWK_COST_AMT, 0)) AS AMT_08,
       SUM (DECODE (STND_COST_CD, '54350000', N4TH_NTWK_COST_AMT, 0)) AS AMT_09,
       SUM (DECODE (STND_COST_CD, '54400000', N4TH_NTWK_COST_AMT, 0)) AS AMT_10,
       SUM (DECODE (STND_COST_CD, '43102011', N4TH_NTWK_COST_AMT, 0)) AS AMT_11,
       SUM (DECODE (STND_COST_CD, '53101000', N4TH_NTWK_COST_AMT, 0)) AS AMT_12,
       SUM (DECODE (STND_COST_CD, '53102000', N4TH_NTWK_COST_AMT, 0)) AS AMT_13,
       SUM (DECODE (STND_COST_CD, '53200000', N4TH_NTWK_COST_AMT, 0)) AS AMT_14,
       SUM (DECODE (STND_COST_CD, '72100000', N4TH_NTWK_COST_AMT, 0)) AS AMT_15
  FROM (SELECT A1.SLS_YRMON,
               A1.COST_YRMON,
               A1.COST_WK,
               A1.TRD_CD,
               A1.RLANE_CD,
               A1.IOC_CD,
               A1.VSL_CD,
               A1.SKD_VOY_NO,
               A1.DIR_CD,
			   A4.HUL_BND_CD,
               A2.STND_COST_CD,
               A3.FNL_HJS_BSA_CAPA,
               NVL (A4.OP_LANE_TP_CD, 'OT') AS OP_LANE_TP_CD,
               NVL (A2.N4TH_NTWK_COST_AMT, 0) AS N4TH_NTWK_COST_AMT,
               @[user_id] AS CRE_USR_ID,
               SYSDATE AS CRE_DT,
               @[user_id] AS UPD_USR_ID,
               SYSDATE AS UPD_DT
          FROM MAS_MON_VVD A1,
               MAS_VVD_HIR A2,
               BSA_VVD_MST A3,
               MAS_LANE_RGST A4
         WHERE A1.TRD_CD = A2.TRD_CD
           AND A1.RLANE_CD = A2.RLANE_CD
           AND A1.IOC_CD = A2.IOC_CD
           AND A1.VSL_CD = A2.VSL_CD
           AND A1.SKD_VOY_NO = A2.SKD_VOY_NO
           AND A1.DIR_CD = A2.DIR_CD
           AND A1.TRD_CD = A3.TRD_CD
           AND A1.RLANE_CD = A3.RLANE_CD
           AND A1.IOC_CD = A3.IOC_CD
           AND A1.VSL_CD = A3.VSL_CD
           AND A1.SKD_VOY_NO = A3.SKD_VOY_NO
           AND A1.DIR_CD = A3.SKD_DIR_CD
           AND A1.RLANE_CD = A4.RLANE_CD
           AND A1.DIR_CD = A4.DIR_CD
           AND A1.TRD_CD = A4.TRD_CD
           AND A1.IOC_CD = A4.IOC_CD
           AND A4.VSL_LANE_TP_CD IN ('JO', 'SC')
		   AND NVL(A4.OP_LANE_TP_CD, 'OT') <> 'OT'
           AND NVL(A1.DELT_FLG, 'N') = 'N'
           AND NVL(A4.DELT_FLG, 'N') = 'N'
           AND A1.SUB_TRD_CD NOT IN ('IP')
#if (${f_chkprd} == 'M')
           AND A1.COST_YRMON BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]
#elseif (${f_chkprd} == 'W')
           AND A1.SLS_YRMON LIKE @[f_year]||'%'
           AND A1.COST_WK BETWEEN @[f_fm_wk] AND @[f_to_wk]
#end
#if (${f_trd_cd} != '')
           AND A1.TRD_CD = @[f_trd_cd]
#end
#if (${f_rlane_cd} != '')
           AND A1.RLANE_CD = @[f_rlane_cd]
#end
#if (${f_vsl_cd} != '')
           AND A1.VSL_CD = @[f_vsl_cd]
#end
#if (${f_skd_voy_no} != '')
           AND A1.SKD_VOY_NO = @[f_skd_voy_no]
#end
#if (${f_dir_cd} != '')
           AND A1.DIR_CD = @[f_dir_cd]
#end
#if (${f_op_lane_tp_cd} != '')
           AND NVL (A4.OP_LANE_TP_CD, 'OT') = @[f_op_lane_tp_cd]
#end
       )
GROUP BY SLS_YRMON,
         COST_YRMON,
         COST_WK,
         TRD_CD,
         RLANE_CD,
         OP_LANE_TP_CD,
         VSL_CD||SKD_VOY_NO||DIR_CD,
 		 HUL_BND_CD,
         FNL_HJS_BSA_CAPA			]]></sql>
			<params>
				<param name="user_id" type="12" value="" out="N"/>
				<param name="f_year" type="12" value="" out="N"/>
				<param name="f_fm_mon" type="12" value="" out="N"/>
				<param name="f_to_mon" type="12" value="" out="N"/>
				<param name="f_fm_wk" type="12" value="" out="N"/>
				<param name="f_to_wk" type="12" value="" out="N"/>
				<param name="f_trd_cd" type="12" value="" out="N"/>
				<param name="f_rlane_cd" type="12" value="" out="N"/>
				<param name="f_vsl_cd" type="12" value="" out="N"/>
				<param name="f_skd_voy_no" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_op_lane_tp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
