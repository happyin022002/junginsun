<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UsaManifestListDownloadDBDAOmodifyCMUSQL">
			<desc><![CDATA[modifyCM]]></desc>
			<sql><![CDATA[
MERGE INTO BKG_CSTMS_ADV_CNTR_MF MF
USING ( 
    SELECT @[cnt_cd] AS CNT_CD, 
           @[bl_no] AS BL_NO, 
           @[cmdt_gds_seq] AS CMDT_GDS_SEQ,
           @[cntr_no] AS CNTR_NO
    FROM DUAL 
) TM
ON ( MF.CNT_CD       = TM.CNT_CD        AND 
     MF.BL_NO        = TM.BL_NO         AND 
     MF.CMDT_GDS_SEQ = TM.CMDT_GDS_SEQ  AND 
     MF.CNTR_NO      = TM.CNTR_NO 
)
WHEN MATCHED THEN
        UPDATE     
        SET      UPD_USR_ID = @[usr_id]
        ,        UPD_DT = SYSDATE
        ,        PCK_QTY = NVL(@[pck_qty], 0)
        ,        AMS_PCK_TP_CD = @[ams_pck_tp_cd]
        ,        GRS_WGT = NVL(@[grs_wgt], 0)
        ,        WGT_UT_CD = @[wgt_ut_cd]
        ,        MK_DESC = @[mk_desc]
        ,        CGO_DESC = @[cgo_desc]
        ,        HAMO_CMDT_CD = @[hamo_cmdt_cd]
        ,        PRIOR_NTC_SND_FLG = NVL(@[prior_ntc_snd_flg], 'N')
        ,        PRIOR_NTC_CFM_FLG =  DECODE(@[prior_ntc_cfm_flg],'0','N','1','Y')
        ,        PRIOR_NTC_CFM_DT = TO_DATE(@[prior_ntc_cfm_dt], 'YYYYMMDD')
        ,        PRIOR_NTC_RMK = @[prior_ntc_rmk]
WHEN NOT MATCHED THEN
        INSERT ( CNT_CD
                ,BL_NO
                ,CMDT_GDS_SEQ
                ,CNTR_NO
                ,PCK_QTY
                ,AMS_PCK_TP_CD
                ,GRS_WGT
                ,WGT_UT_CD
                ,MK_DESC
                ,CGO_DESC
                ,HAMO_CMDT_CD
                ,PRIOR_NTC_SND_FLG
                ,PRIOR_NTC_CFM_FLG
                ,PRIOR_NTC_CFM_DT
                ,PRIOR_NTC_RMK
                ,CRE_USR_ID
                ,CRE_DT
                ,UPD_USR_ID
                ,UPD_DT )
        VALUES ( @[cnt_cd]
                ,@[bl_no]
                ,NVL((SELECT /*+ index_desc(A XPKBKG_CSTMS_ADV_CNTR_MF MF) */   
                             CMDT_GDS_SEQ 
                      FROM   BKG_CSTMS_ADV_CNTR_MF A
                      WHERE  1=1
                      AND	 CNT_CD = @[cnt_cd]  
                      AND    BL_NO = @[bl_no] 
                      AND    ROWNUM = 1   
                    ),0)+1
                ,@[cntr_no]
                ,NVL(@[pck_qty], 0)
                ,@[ams_pck_tp_cd]
                ,NVL(@[grs_wgt], 0)
                ,@[wgt_ut_cd]
                ,@[mk_desc]
                ,@[cgo_desc]
                ,@[hamo_cmdt_cd]
                ,NVL(@[prior_ntc_snd_flg], 'N')
                ,DECODE(@[prior_ntc_cfm_flg],'0','N','1','Y')
                ,TO_DATE(@[prior_ntc_cfm_dt], 'YYYYMMDD')
                ,@[prior_ntc_rmk]
                ,@[usr_id]
                ,SYSDATE
                ,@[usr_id]
                ,SYSDATE )			]]></sql>
			<params>
				<param name="cnt_cd" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="cmdt_gds_seq" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="pck_qty" type="12" value="" out="N"/>
				<param name="ams_pck_tp_cd" type="12" value="" out="N"/>
				<param name="grs_wgt" type="12" value="" out="N"/>
				<param name="wgt_ut_cd" type="12" value="" out="N"/>
				<param name="mk_desc" type="12" value="" out="N"/>
				<param name="cgo_desc" type="12" value="" out="N"/>
				<param name="hamo_cmdt_cd" type="12" value="" out="N"/>
				<param name="prior_ntc_snd_flg" type="12" value="" out="N"/>
				<param name="prior_ntc_cfm_flg" type="12" value="" out="N"/>
				<param name="prior_ntc_cfm_dt" type="12" value="" out="N"/>
				<param name="prior_ntc_rmk" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
