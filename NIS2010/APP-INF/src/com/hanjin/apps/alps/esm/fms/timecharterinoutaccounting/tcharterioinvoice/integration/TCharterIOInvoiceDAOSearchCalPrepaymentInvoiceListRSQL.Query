<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TCharterIOInvoiceDAOSearchCalPrepaymentInvoiceListRSQL">
			<desc><![CDATA[TCharterIOInvoiceDAOSearchCalPrepaymentInvoiceListRSQL]]></desc>
			<sql><![CDATA[
#if(${flet_ctrt_tp_gb} == 'TI')

SELECT  ACCT_ITM_NM,
		ACCT_CD,
		CURR_CD,
		INV_AMT,
		ORI_INV_AMT,
		CURR_CD2,
		INV_AMT2,
		ORI_INV_AMT2,
		SLP_TP_CD,
        SUBSTR(INV_DESC, 0, INSTR(INV_DESC, '('))||TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD HH24:MI')||' ~ '||TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD HH24:MI')||')' INV_DESC,
		FLET_CTRT_NO,
		ROWNUM INV_DTL_SEQ,
		ACCT_ITM_SEQ,
		SORTKEY SORT_KEY
  FROM  (
		SELECT  ACCT_ITM_NM,
				ACCT_CD,
				CURR_CD,
				INV_AMT,
				ORI_INV_AMT,
				CURR_CD2,
				INV_AMT2,
				ORI_INV_AMT2,
				SLP_TP_CD,
				INV_DESC,
				FLET_CTRT_NO,
				ACCT_ITM_SEQ,
				SORTKEY
		  FROM  (
				SELECT  ACCT_ITM_NM,
						ACCT_CD,
						DECODE(FLET_CURR_CHK_CD,'F',HIR_CURR_N1ST_CD,NULL) CURR_CD,
						DECODE(FLET_CURR_CHK_CD,'F',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) INV_AMT,
						DECODE(FLET_CURR_CHK_CD,'F',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) ORI_INV_AMT,
						DECODE(FLET_CURR_CHK_CD,'S',HIR_CURR_N1ST_CD,NULL) CURR_CD2,
						DECODE(FLET_CURR_CHK_CD,'S',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) INV_AMT2,
						DECODE(FLET_CURR_CHK_CD,'S',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) ORI_INV_AMT2,
						'N' SLP_TP_CD,
						INV_DESC,
						FLET_CTRT_NO,
						ROWNUM INV_DTL_SEQ,
						ACCT_ITM_SEQ,
						'1' SORTKEY
				FROM (	SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO
						  FROM (SELECT 	(SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI') <= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO
						  FROM (SELECT	(SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI') <= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
					)
					UNION ALL
					SELECT	ACCT_ITM_NM,
							ACCT_CD,
							DECODE(FLET_CURR_CHK_CD,'F',HIR_CURR_N1ST_CD,NULL) CURR_CD,
							DECODE(FLET_CURR_CHK_CD,'F',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) INV_AMT,
							DECODE(FLET_CURR_CHK_CD,'F',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) ORI_INV_AMT,
							DECODE(FLET_CURR_CHK_CD,'S',HIR_CURR_N1ST_CD,NULL) CURR_CD2,
							DECODE(FLET_CURR_CHK_CD,'S',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) INV_AMT2,
							DECODE(FLET_CURR_CHK_CD,'S',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) ORI_INV_AMT2,
							'N' SLP_TP_CD,
							INV_DESC,
							FLET_CTRT_NO,
							ROWNUM INV_DTL_SEQ,
							ACCT_ITM_SEQ,
							'3' SORTKEY
					  FROM (
							SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
								   MIN(ACCT_CD) ACCT_CD,
								   HIR_CURR_N1ST_CD,
								   HIR_RT_N1ST_AMT HIR_RT_N1ST_AMT,
								   MIN(SLP_TP_CD) SLP_TP_CD,
								   MIN(INV_DESC) INV_DESC,
								   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
								   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
								   MIN(FLET_CTRT_NO) FLET_CTRT_NO
							  FROM (SELECT  (SELECT ACCT_ITM_NM 
											   FROM FMS_ACCT_ITM
											  WHERE ACCT_CD = '510911'
												AND ROWNUM = 1) ACCT_ITM_NM,
											'510911' ACCT_CD,
											HIR_CURR_N1ST_CD,
											- FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100) HIR_RT_N1ST_AMT,
											'N' SLP_TP_CD,
											CASE WHEN SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
													  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
												 ELSE
													  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 END INV_DESC,
											(SELECT ACCT_ITM_SEQ
											   FROM FMS_ACCT_ITM
											  WHERE ACCT_CD = '510911'
												AND ROWNUM = 1) ACCT_ITM_SEQ,
											'F' FLET_CURR_CHK_CD,
											FH.FLET_CTRT_NO
									  FROM  FMS_CONTRACT FC, FMS_HIRE FH
									 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
									   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
									   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																						  FROM FMS_HIRE 
																						 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
									   AND  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI') <= (SELECT MAX(EXP_DT) 
																						  FROM FMS_HIRE 
																						 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
									   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   ) WHERE  HIR_RT_N1ST_AMT != 0
									 GROUP BY HIR_CURR_N1ST_CD
							UNION ALL
							SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
								   MIN(ACCT_CD) ACCT_CD,
								   HIR_CURR_N2ND_CD,
								   HIR_RT_N1ST_AMT HIR_RT_N1ST_AMT,
								   MIN(SLP_TP_CD) SLP_TP_CD,
								   MIN(INV_DESC) INV_DESC,
								   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
								   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
								   MIN(FLET_CTRT_NO) FLET_CTRT_NO
							  FROM (SELECT	(SELECT ACCT_ITM_NM 
											   FROM FMS_ACCT_ITM
											  WHERE ACCT_CD = '510911'
												AND ROWNUM = 1) ACCT_ITM_NM,
											'510911' ACCT_CD,
											HIR_CURR_N2ND_CD,
											- FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100) HIR_RT_N1ST_AMT,
											'N' SLP_TP_CD,
											CASE WHEN SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
													  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
												 ELSE
													  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 END INV_DESC,
											(SELECT ACCT_ITM_SEQ
											   FROM FMS_ACCT_ITM
											  WHERE ACCT_CD = '510911'
												AND ROWNUM = 1) ACCT_ITM_SEQ,
											'S' FLET_CURR_CHK_CD,
											FH.FLET_CTRT_NO
									  FROM  FMS_CONTRACT FC, FMS_HIRE FH
									 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
									   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
									   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																						  FROM FMS_HIRE 
																						 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
									   AND  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI') <= (SELECT MAX(EXP_DT) 
																						  FROM FMS_HIRE 
																						 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
									   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   ) WHERE  HIR_RT_N1ST_AMT != 0
									 GROUP BY HIR_CURR_N2ND_CD
						) WHERE @[acmm_flg] = 'Y'
					UNION ALL
					SELECT  ACCT_ITM_NM,
							ACCT_CD,
							DECODE(FLET_CURR_CHK_CD,'F',HIR_CURR_N1ST_CD,NULL) CURR_CD,
							DECODE(FLET_CURR_CHK_CD,'F',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) INV_AMT,
							DECODE(FLET_CURR_CHK_CD,'F',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) ORI_INV_AMT,
							DECODE(FLET_CURR_CHK_CD,'S',HIR_CURR_N1ST_CD,NULL) CURR_CD2,
							DECODE(FLET_CURR_CHK_CD,'S',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) INV_AMT2,
							DECODE(FLET_CURR_CHK_CD,'S',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) ORI_INV_AMT2,
							'N' SLP_TP_CD,
							INV_DESC,
							FLET_CTRT_NO,
							ROWNUM INV_DTL_SEQ,
							ACCT_ITM_SEQ,
							'4' SORTKEY
					  FROM  (
							SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
								   MIN(ACCT_CD) ACCT_CD,
								   HIR_CURR_N1ST_CD,
								   HIR_RT_N1ST_AMT HIR_RT_N1ST_AMT,
								   MIN(SLP_TP_CD) SLP_TP_CD,
								   MIN(INV_DESC) INV_DESC,
								   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
								   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
								   MIN(FLET_CTRT_NO) FLET_CTRT_NO
							  FROM (SELECT  (SELECT ACCT_ITM_NM
											   FROM FMS_ACCT_ITM
											  WHERE ACCT_CD = '512641'
												AND ACCT_ITM_SEQ = 41
												AND ROWNUM = 1) ACCT_ITM_NM,
											'512641' ACCT_CD,
											HIR_CURR_N1ST_CD,
											FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[flet_brog_rt_amt]/100) HIR_RT_N1ST_AMT,
											'N' SLP_TP_CD,
											CASE WHEN SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
													  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
												 ELSE
													  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 END INV_DESC,
											41 ACCT_ITM_SEQ,
											'F' FLET_CURR_CHK_CD,
											FH.FLET_CTRT_NO
									  FROM  FMS_CONTRACT FC, FMS_HIRE FH
									 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
									   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
									   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																						  FROM FMS_HIRE 
																						 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
									   AND  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI') <= (SELECT MAX(EXP_DT) 
																						  FROM FMS_HIRE 
																						 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
									   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   ) WHERE  HIR_RT_N1ST_AMT != 0
									 GROUP BY HIR_CURR_N1ST_CD
							UNION ALL
							SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
								   MIN(ACCT_CD) ACCT_CD,
								   HIR_CURR_N2ND_CD,
								   HIR_RT_N1ST_AMT HIR_RT_N1ST_AMT,
								   MIN(SLP_TP_CD) SLP_TP_CD,
								   MIN(INV_DESC) INV_DESC,
								   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
								   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
								   MIN(FLET_CTRT_NO) FLET_CTRT_NO
							  FROM (SELECT	(SELECT ACCT_ITM_NM
											   FROM FMS_ACCT_ITM
											  WHERE ACCT_CD = '512641'
												AND ACCT_ITM_SEQ = 41
												AND ROWNUM = 1) ACCT_ITM_NM,
											'512641' ACCT_CD,
											HIR_CURR_N2ND_CD,
											FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[flet_brog_rt_amt]/100) HIR_RT_N1ST_AMT,
											'N' SLP_TP_CD,
											CASE WHEN SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
													  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
												 ELSE
													  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 END INV_DESC,
											41 ACCT_ITM_SEQ,
											'S' FLET_CURR_CHK_CD,
											FH.FLET_CTRT_NO
									  FROM  FMS_CONTRACT FC, FMS_HIRE FH
									 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
									   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
									   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																						  FROM FMS_HIRE 
																						 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
									   AND  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI') <= (SELECT MAX(EXP_DT) 
																						  FROM FMS_HIRE 
																						 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
									   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   ) WHERE  HIR_RT_N1ST_AMT != 0
									 GROUP BY HIR_CURR_N2ND_CD
						) WHERE @[brog_flg] = 'Y'
					UNION ALL
					SELECT 	ACCT_ITM_NM,
							ACCT_CD,
							HIR_CURR_N1ST_CD,
							HIR_RT_N1ST_AMT,
							HIR_RT_N1ST_AMT ORI_HIR_RT_N1ST_AMT,
							HIR_CURR_N2ND_CD,
							HIR_RT_N2ND_AMT,
							ORI_HIR_RT_N2ND_AMT,
							SLP_TP_CD,
							INV_DESC,
							FLET_CTRT_NO,
							INV_DTL_SEQ,
							ACCT_ITM_SEQ,
							SORTKEY
					  FROM  (
							SELECT	ACCT_ITM_NM,
									ACCT_CD,
									MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
									TO_CHAR(FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, @[ori_eff_dt], @[ori_exp_dt]),'999,999,999,999,999,990.00') HIR_RT_N1ST_AMT,
									'' ORI_HIR_RT_N1ST_AMT,
									MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
									MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
									MIN(HIR_RT_N2ND_AMT) ORI_HIR_RT_N2ND_AMT,
									MIN(SLP_TP_CD) SLP_TP_CD,
									MIN(INV_DESC) INV_DESC,
									MIN(FLET_CTRT_NO) FLET_CTRT_NO,
									MIN(INV_DTL_SEQ) INV_DTL_SEQ,
									ACCT_ITM_SEQ,
									MIN(EFF_DT) EFF_DT,
									MAX(EXP_DT) EXP_DT,
									'2' SORTKEY
							  FROM  (
									SELECT	(SELECT ACCT_ITM_NM 
											   FROM FMS_ACCT_ITM 
											  WHERE ACCT_CD = FO.ACCT_CD 
												AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
												AND ROWNUM =1) ACCT_ITM_NM,
											FO.ACCT_CD,
											FO.CURR_CD HIR_CURR_N1ST_CD,
											FO.OTR_EXPN_AMT / TO_NUMBER(@[ori_inv_usd_dys]) * TO_NUMBER(@[inv_usd_dys]) HIR_RT_N1ST_AMT,
											NULL HIR_CURR_N2ND_CD,
											NULL HIR_RT_N2ND_AMT,
											'N' SLP_TP_CD,
											CASE WHEN SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
													  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
												 ELSE
													  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 END INV_DESC,
											FO.FLET_CTRT_NO,
											ROWNUM INV_DTL_SEQ,
											FO.ACCT_ITM_SEQ,
											FO.EFF_DT,
											FO.EXP_DT
									  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
									 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
									   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
									   AND  TO_DATE(SUBSTR(@[ori_eff_dt],1,8),'YYYYMMDD') >= (SELECT MIN(EFF_DT) 
																						        FROM FMS_OTR_EXPN 
																						       WHERE FLET_CTRT_NO = @[flet_ctrt_no])
									   AND  TO_DATE(SUBSTR(@[ori_exp_dt],1,8),'YYYYMMDD') <= (SELECT CASE WHEN MAX(EXP_DT) >= TO_DATE(SUBSTR(@[ori_exp_dt],1,8),'YYYYMMDD') THEN
                 																							   MAX(EXP_DT)
            																						      ELSE
                 																							   MAX(EXP_DT) + 1
        																						      END EXP_DT
																						        FROM FMS_OTR_EXPN 
																						       WHERE FLET_CTRT_NO = @[flet_ctrt_no])
									)
									GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
						)
				) ORDER BY SORTKEY ASC, ACCT_CD ASC, CURR_CD ASC
		)

#else

SELECT
		ACCT_ITM_NM,
		ACCT_CD,
		CURR_CD,
		INV_AMT,
		ORI_INV_AMT,
		CURR_CD2,
		INV_AMT2,
		ORI_INV_AMT2,
		SLP_TP_CD,
        SUBSTR(INV_DESC, 0, INSTR(INV_DESC, '('))||TO_CHAR(TO_DATE(EFF_DT,'YYYYMMDDHH24MI'),'YYYY-MM-DD HH24:MI')||' ~ '||TO_CHAR(TO_DATE(EXP_DT ,'YYYYMMDDHH24MI'),'YYYY-MM-DD HH24:MI')||')' INV_DESC,
		FLET_CTRT_NO,
		ROWNUM INV_DTL_SEQ,
		ACCT_ITM_SEQ,
		EFF_DT,
		EXP_DT,
		TO_CHAR(ROUND((TO_DATE(EXP_DT,'YYYYMMDDHH24MI') - TO_DATE(EFF_DT,'YYYYMMDDHH24MI')),4),'FM999,990.0000') INV_USD_DYS,
		SORTKEY SORT_KEY
  FROM  (
		SELECT  ACCT_ITM_NM,
				ACCT_CD,
				CURR_CD,
				INV_AMT,
				ORI_INV_AMT,
				CURR_CD2,
				INV_AMT2,
				ORI_INV_AMT2,
				SLP_TP_CD,
				INV_DESC,
				FLET_CTRT_NO,
				ACCT_ITM_SEQ,
				EFF_DT,
				EXP_DT,
				SORTKEY,
				ITEMKEY
		  FROM  (
				SELECT  ACCT_ITM_NM,
						ACCT_CD,
						DECODE(FLET_CURR_CHK_CD,'F',HIR_CURR_N1ST_CD,NULL) CURR_CD,
						DECODE(FLET_CURR_CHK_CD,'F',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) INV_AMT,
						DECODE(FLET_CURR_CHK_CD,'F',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) ORI_INV_AMT,
						DECODE(FLET_CURR_CHK_CD,'S',HIR_CURR_N1ST_CD,NULL) CURR_CD2,
						DECODE(FLET_CURR_CHK_CD,'S',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) INV_AMT2,
						DECODE(FLET_CURR_CHK_CD,'S',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) ORI_INV_AMT2,
						'N' SLP_TP_CD,
						INV_DESC,
						FLET_CTRT_NO,
						ROWNUM INV_DTL_SEQ,
						ACCT_ITM_SEQ,
						'1' SORTKEY,
						EFF_DT,
						EXP_DT,
						ITEMKEY
				  FROM  (
						#if(${months} == '0')

						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'))
										END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'))
										END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD

						#elseif(${months} == '1')

						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'))
										END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '2' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(SUBSTR(@[ori_exp_dt],1,8),'YYYYMMDD'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
										 END													  <= (SELECT MAX(EXP_DT) 
																									    FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'))
										END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '2' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(SUBSTR(@[ori_exp_dt],1,8),'YYYYMMDD'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
										 END													  <= (SELECT MAX(EXP_DT) 
																									    FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD

						#elseif(${months} == '2')

						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'))
										END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '2' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
										 END													  <= (SELECT MAX(EXP_DT) 
																									    FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '3' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 2
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'))
										END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '2' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
										 END													  <= (SELECT MAX(EXP_DT) 
																									    FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '3' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 2
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD

						#else

						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'))
										END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '2' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
										 END													  <= (SELECT MAX(EXP_DT) 
																									    FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '3' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 2
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '4' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 3
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '5' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 4
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '6' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 5
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '7' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 6
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '8' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 7
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '9' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(SUBSTR(@[ori_exp_dt],1,8),'YYYYMMDD'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(SUBSTR(@[ori_exp_dt],1,8),'YYYYMMDD'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 8
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '10' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(SUBSTR(@[ori_exp_dt],1,8),'YYYYMMDD'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(SUBSTR(@[ori_exp_dt],1,8),'YYYYMMDD'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 9
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '11' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(SUBSTR(@[ori_exp_dt],1,8),'YYYYMMDD'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(SUBSTR(@[ori_exp_dt],1,8),'YYYYMMDD'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11)
										 END													   <= (SELECT MAX(EXP_DT) 
																										 FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 10
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '12' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') THEN

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(SUBSTR(@[ori_exp_dt],1,8),'YYYYMMDD'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(SUBSTR(@[ori_exp_dt],1,8),'YYYYMMDD'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12)
										 END													   <= (SELECT MAX(EXP_DT) 
																										 FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 11
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'))
										END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '2' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
										 END													  <= (SELECT MAX(EXP_DT) 
																									    FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '3' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 2
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '4' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 3
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '5' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5)
										 END													  <= (SELECT MAX(EXP_DT) 
																									    FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 4
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '6' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 5
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '7' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 6
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '8' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 7
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '9' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 8
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '10' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 9
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '11' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11)
										 END													   <= (SELECT MAX(EXP_DT) 
																										 FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 10
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '12' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') THEN

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12)
										 END													   <= (SELECT MAX(EXP_DT) 
																										 FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 11
							   ) WHERE  HIR_RT_N1ST_AMT != 0
								 GROUP BY HIR_CURR_N2ND_CD

						#end
						)
				UNION ALL
				SELECT  ACCT_ITM_NM,
						ACCT_CD,
						DECODE(FLET_CURR_CHK_CD,'F',HIR_CURR_N1ST_CD,NULL) CURR_CD,
						DECODE(FLET_CURR_CHK_CD,'F',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) INV_AMT,
						DECODE(FLET_CURR_CHK_CD,'F',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) ORI_INV_AMT,
						DECODE(FLET_CURR_CHK_CD,'S',HIR_CURR_N1ST_CD,NULL) CURR_CD2,
						DECODE(FLET_CURR_CHK_CD,'S',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) INV_AMT2,
						DECODE(FLET_CURR_CHK_CD,'S',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) ORI_INV_AMT2,
						'N' SLP_TP_CD,
						INV_DESC,
						FLET_CTRT_NO,
						ROWNUM INV_DTL_SEQ,
						ACCT_ITM_SEQ,
						'3' SORTKEY,
						EFF_DT,
						EXP_DT,
						ITEMKEY
				  FROM  (
						#if(${months} == '0')

						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										 END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD

						#elseif(${months} == '1')

						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '2' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										 END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '2' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD

						#elseif(${months} == '2')

						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '2' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '3' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 2
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										 END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '2' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '3' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 2
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD

						#else

						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '2' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '3' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 2
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '4' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 3
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '5' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5)
										 END													  <= (SELECT MAX(EXP_DT) 
																									    FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 4
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '6' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 5
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '7' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 6
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '8' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 7
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '9' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 8
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '10' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 9
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '11' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11)
										 END													   <= (SELECT MAX(EXP_DT) 
																										 FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 10
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '12' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') THEN

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12)
										 END													   <= (SELECT MAX(EXP_DT) 
																										 FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 11
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
												  @[ori_exp_dt]
											 ELSE
												  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
										 END EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
												  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
										END										<= (SELECT MAX(EXP_DT) 
																					  FROM FMS_HIRE 
																					 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '2' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '3' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 2
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '4' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 3
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '5' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 4
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '6' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 5
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '7' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 6
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '8' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 7
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '9' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 8
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '10' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10)
										 END													  <= (SELECT MAX(EXP_DT) 
																										FROM FMS_HIRE 
																									   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 9
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '11' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11)
										 END													   <= (SELECT MAX(EXP_DT) 
																										 FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 10
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '12' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM 
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_NM,
										'510911' ACCT_CD,
										HIR_CURR_N2ND_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') THEN

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'), @[ori_exp_dt]) * TO_NUMBER(@[acmm_rt_amt]/100)
											 ELSE

												  - FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12),'YYYYMMDDHH24MI')) * TO_NUMBER(@[acmm_rt_amt]/100)
										 END HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '510911'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11) >= (SELECT MIN(EFF_DT) 
																										FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') THEN 
												  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
											 ELSE
											      ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12)
										 END													   <= (SELECT MAX(EXP_DT) 
																										 FROM FMS_HIRE 
																										WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
								   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 11
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD

						#end
					    ) WHERE @[acmm_flg] = 'Y'
				UNION ALL
				SELECT  ACCT_ITM_NM,
						ACCT_CD,
						DECODE(FLET_CURR_CHK_CD,'F',HIR_CURR_N1ST_CD,NULL) CURR_CD,
						DECODE(FLET_CURR_CHK_CD,'F',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) INV_AMT,
						DECODE(FLET_CURR_CHK_CD,'F',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) ORI_INV_AMT,
						DECODE(FLET_CURR_CHK_CD,'S',HIR_CURR_N1ST_CD,NULL) CURR_CD2,
						DECODE(FLET_CURR_CHK_CD,'S',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) INV_AMT2,
						DECODE(FLET_CURR_CHK_CD,'S',TO_CHAR(HIR_RT_N1ST_AMT,'999,999,999,999,999,990.00'),NULL) ORI_INV_AMT2,
						'N' SLP_TP_CD,
						INV_DESC,
						FLET_CTRT_NO,
						ROWNUM INV_DTL_SEQ,
						ACCT_ITM_SEQ,
						'4' SORTKEY,
						EFF_DT,
						EXP_DT,
						ITEMKEY
				  FROM  (
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N1ST_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '512641'
											AND ACCT_ITM_SEQ = 40
											AND ROWNUM = 1) ACCT_ITM_NM,
										'512641' ACCT_CD,
										HIR_CURR_N1ST_CD,
										FMS_HIRCURAMT1_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[flet_brog_rt_amt]/100)*-1 HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) != SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N1ST_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '512641'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'F' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																				      FROM FMS_HIRE 
																				     WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI') <= (SELECT MAX(EXP_DT) 
																				      FROM FMS_HIRE 
																				     WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N1ST_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N1ST_CD
						UNION ALL
						SELECT MIN(ACCT_ITM_NM) ACCT_ITM_NM,
							   MIN(ACCT_CD) ACCT_CD,
							   HIR_CURR_N2ND_CD,
							   HIR_RT_N1ST_AMT,
							   MIN(SLP_TP_CD) SLP_TP_CD,
							   MIN(INV_DESC) INV_DESC,
							   MIN(ACCT_ITM_SEQ) ACCT_ITM_SEQ,
							   MIN(FLET_CURR_CHK_CD) FLET_CURR_CHK_CD,
							   MIN(FLET_CTRT_NO) FLET_CTRT_NO,
							   MIN(EFF_DT) EFF_DT,
							   MIN(EXP_DT) EXP_DT,
							   '1' ITEMKEY
						  FROM (SELECT  (SELECT ACCT_ITM_NM
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '512641'
											AND ACCT_ITM_SEQ = 40
											AND ROWNUM = 1) ACCT_ITM_NM,
										'512641' ACCT_CD,
										HIR_CURR_N2ND_CD,
										FMS_HIRCURAMT2_FNC(@[flet_ctrt_no], @[ori_eff_dt], @[ori_exp_dt]) * TO_NUMBER(@[flet_brog_rt_amt]/100)*-1 HIR_RT_N1ST_AMT,
										'N' SLP_TP_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
											      'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 WHEN SUBSTR(@[ori_eff_dt],5,2) != SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
											 ELSE
												  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || HIR_CURR_N2ND_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
										 END INV_DESC,
										(SELECT ACCT_ITM_SEQ
										   FROM FMS_ACCT_ITM
										  WHERE ACCT_CD = '512641'
											AND ROWNUM = 1) ACCT_ITM_SEQ,
										'S' FLET_CURR_CHK_CD,
										FH.FLET_CTRT_NO,
										@[ori_eff_dt] EFF_DT,
										@[ori_exp_dt] EXP_DT
								  FROM  FMS_CONTRACT FC, FMS_HIRE FH
								 WHERE  FC.FLET_CTRT_NO = FH.FLET_CTRT_NO
								   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
								   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																				      FROM FMS_HIRE 
																				     WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI') <= (SELECT MAX(EXP_DT) 
																				      FROM FMS_HIRE 
																				     WHERE FLET_CTRT_NO = @[flet_ctrt_no])
								   AND  HIR_CURR_N2ND_CD IS NOT NULL
							   ) WHERE  HIR_RT_N1ST_AMT != 0
							     GROUP BY HIR_CURR_N2ND_CD
					    ) WHERE @[brog_flg] = 'Y'
				UNION ALL
				SELECT  ACCT_ITM_NM,
						ACCT_CD,
						HIR_CURR_N1ST_CD,
						TO_CHAR(ROUND(HIR_RT_N1ST_AMT,2),'999,999,999,999,999,990.00') HIR_RT_N1ST_AMT,
						TO_CHAR(ROUND(HIR_RT_N1ST_AMT,2),'999,999,999,999,999,990.00') ORI_HIR_RT_N1ST_AMT,
						HIR_CURR_N2ND_CD,
						HIR_RT_N2ND_AMT,
						HIR_RT_N2ND_AMT ORI_HIR_RT_N2ND_AMT,
						SLP_TP_CD,
						INV_DESC,
						FLET_CTRT_NO,
						ROWNUM INV_DTL_SEQ,
						ACCT_ITM_SEQ,
						'2' SORTKEY,
						EFF_DT,
						EXP_DT,
						ITEMKEY
				  FROM  (
						SELECT  ACCT_ITM_NM,
								ACCT_CD,
								HIR_CURR_N1ST_CD,
								HIR_RT_N1ST_AMT,
								HIR_CURR_N2ND_CD,
								HIR_RT_N2ND_AMT,
								SLP_TP_CD,
								INV_DESC,
								FLET_CTRT_NO,
								INV_DTL_SEQ,
								ACCT_ITM_SEQ,
								EFF_DT,
								EXP_DT,
								ITEMKEY
						  FROM  (
								#if(${months} == '0')

								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, @[ori_eff_dt], @[ori_exp_dt])
											 ELSE
												  
												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'1' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												@[ori_eff_dt] EFF_DT,
												CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
														  @[ori_exp_dt]
													 ELSE
														  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
												 END EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																							  FROM FMS_OTR_EXPN 
																							 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
												 END									<= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
																																	  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																 ELSE
																																	  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
																															 END 
																										THEN
                 																							 MAX(EXP_DT)
            																						    ELSE
                 																							 MAX(EXP_DT) + 1
        																						    END EXP_DT 
																							  FROM FMS_OTR_EXPN 
																							 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ

								#elseif(${months} == '1')

								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, @[ori_eff_dt], @[ori_exp_dt])
											 ELSE
												  
												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'1' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												@[ori_eff_dt] EFF_DT,
												CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
														  @[ori_exp_dt]
													 ELSE
														  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
												 END EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																							  FROM FMS_OTR_EXPN 
																							 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
												 END									<= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
																																	  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																 ELSE
																																	  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
																															 END 
																										THEN
                 																							 MAX(EXP_DT)
            																						    ELSE
                 																							 MAX(EXP_DT) + 1
        																						    END EXP_DT 
																							  FROM FMS_OTR_EXPN 
																							 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'2' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																												FROM FMS_OTR_EXPN 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
												 END													  <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
																																					    TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																				   ELSE
																																					    ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
																																			   END 
																														  THEN
																															   MAX(EXP_DT)
																														  ELSE
																															   MAX(EXP_DT) + 1
																													  END EXP_DT 
																												FROM FMS_OTR_EXPN 
																											   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ

								#elseif(${months} == '2')

								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, @[ori_eff_dt], @[ori_exp_dt])
											 ELSE
												  
												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'1' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												@[ori_eff_dt] EFF_DT,
												CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
														  @[ori_exp_dt]
													 ELSE
														  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
												 END EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																							  FROM FMS_OTR_EXPN 
																							 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
												 END									<= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
																																	  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																 ELSE
																																	  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
																															 END 
																									    THEN
																										     MAX(EXP_DT)
																									    ELSE
																										     MAX(EXP_DT) + 1
																								    END EXP_DT 
																							  FROM FMS_OTR_EXPN 
																							 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'2' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																												FROM FMS_OTR_EXPN 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
												 END													  <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
																																						TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																				   ELSE
																																						ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
																																			   END 
																														  THEN
																															   MAX(EXP_DT)
																														  ELSE
																															   MAX(EXP_DT) + 1
																													  END EXP_DT 
																												FROM FMS_OTR_EXPN 
																											   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'3' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2) >= (SELECT MIN(EFF_DT) 
																												FROM FMS_OTR_EXPN 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3)
												 END													  <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN 
																																					    TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																				   ELSE
																																					    ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3)
																																			   END 
																														  THEN
																															   MAX(EXP_DT)
																														  ELSE
																															   MAX(EXP_DT) + 1
																													  END EXP_DT 
																												FROM FMS_OTR_EXPN 
																											   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 2
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ

								#else

								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, @[ori_eff_dt], @[ori_exp_dt])
											 ELSE
												  
												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, @[ori_eff_dt], TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'1' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												@[ori_eff_dt] EFF_DT,
												CASE WHEN SUBSTR(@[ori_eff_dt],5,2) = SUBSTR(@[ori_exp_dt],5,2) THEN
														  @[ori_exp_dt]
													 ELSE
														  TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI')
												 END EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  TO_DATE(@[ori_eff_dt],'YYYYMMDDHH24MI') >= (SELECT MIN(EFF_DT) 
																							  FROM FMS_OTR_EXPN 
																							 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
												 END									<= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_eff_dt],1,6) = SUBSTR(@[ori_exp_dt],1,6) THEN 
																																	  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																 ELSE
																																	  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1)
																															 END 
																									    THEN
																										     MAX(EXP_DT)
																									    ELSE
																										     MAX(EXP_DT) + 1
																								    END EXP_DT 
																							  FROM FMS_OTR_EXPN 
																							 WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'2' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1) >= (SELECT MIN(EFF_DT) 
																												FROM FMS_OTR_EXPN 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
												 END													  <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMM') THEN 
																																						TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																				   ELSE
																																						ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2)
																																			   END 
																														  THEN
																															   MAX(EXP_DT)
																														  ELSE
																															   MAX(EXP_DT) + 1
																													  END EXP_DT 
																												FROM FMS_OTR_EXPN 
																											   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 1
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'3' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2) >= (SELECT MIN(EFF_DT) 
																												FROM FMS_OTR_EXPN 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3)
												 END													  <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),2),'YYYYMM') THEN 
																																					    TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																				   ELSE
																																					    ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3)
																																			   END 
																														  THEN
																															   MAX(EXP_DT)
																														  ELSE
																															   MAX(EXP_DT) + 1
																													  END EXP_DT 
																												FROM FMS_OTR_EXPN 
																											   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 2
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'4' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3) >= (SELECT MIN(EFF_DT) 
																												FROM FMS_OTR_EXPN 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4)
												 END													  <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),3),'YYYYMM') THEN 
																																						TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																				   ELSE
																																						ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4)
																																			   END 
																														  THEN
																															   MAX(EXP_DT)
																														  ELSE
																															   MAX(EXP_DT) + 1
																													  END EXP_DT 
																												FROM FMS_OTR_EXPN 
																											   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 3
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'5' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4) >= (SELECT MIN(EFF_DT) 
																												FROM FMS_OTR_EXPN 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5)
												 END													  <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),4),'YYYYMM') THEN 
																																						TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																				   ELSE
																																						ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5)
																																			   END 
																														  THEN
																															   MAX(EXP_DT)
																														  ELSE
																															   MAX(EXP_DT) + 1
																													  END EXP_DT 
																												FROM FMS_OTR_EXPN 
																											   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 4
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'6' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5) >= (SELECT MIN(EFF_DT) 
																												FROM FMS_OTR_EXPN 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6)
												 END													  <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),5),'YYYYMM') THEN 
																																						TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																				   ELSE
																																						ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6)
																																			   END 
																														  THEN
																															   MAX(EXP_DT)
																														  ELSE
																															   MAX(EXP_DT) + 1
																													  END EXP_DT 
																												FROM FMS_OTR_EXPN 
																											   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 5
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'7' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6) >= (SELECT MIN(EFF_DT) 
																												FROM FMS_OTR_EXPN 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7)
												 END													  <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),6),'YYYYMM') THEN 
																																						TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																				   ELSE
																																						ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7)
																																			   END 
																														  THEN
																															   MAX(EXP_DT)
																														  ELSE
																															   MAX(EXP_DT) + 1
																													  END EXP_DT 
																												FROM FMS_OTR_EXPN 
																											   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 6
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'8' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7) >= (SELECT MIN(EFF_DT) 
																												FROM FMS_OTR_EXPN 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8)
												 END													  <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),7),'YYYYMM') THEN 
																																						TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																				   ELSE
																																						ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8)
																																			   END 
																														  THEN
																															   MAX(EXP_DT)
																														  ELSE
																															   MAX(EXP_DT) + 1
																													  END EXP_DT 
																												FROM FMS_OTR_EXPN 
																											   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 7
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'9' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8) >= (SELECT MIN(EFF_DT) 
																												FROM FMS_OTR_EXPN 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9)
												 END													  <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),8),'YYYYMM') THEN 
																																						TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																				   ELSE
																																						ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9)
																																			   END 
																														  THEN
																															   MAX(EXP_DT)
																														  ELSE
																															   MAX(EXP_DT) + 1
																													  END EXP_DT 
																												FROM FMS_OTR_EXPN 
																											   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 8
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'10' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9) >= (SELECT MIN(EFF_DT) 
																												FROM FMS_OTR_EXPN 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10)
												 END													  <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),9),'YYYYMM') THEN 
																																						TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																				   ELSE
																																						ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10)
																																			   END 
																														  THEN
																															   MAX(EXP_DT)
																														  ELSE
																															   MAX(EXP_DT) + 1
																													  END EXP_DT 
																												FROM FMS_OTR_EXPN 
																											   WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 9
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'11' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10) >= (SELECT MIN(EFF_DT) 
																												 FROM FMS_HIRE 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11)
												 END													   <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),10),'YYYYMM') THEN 
																																						 TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																					ELSE
																																						 ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11)
																																				END 
																														   THEN
																															    MAX(EXP_DT)
																														   ELSE
																															    MAX(EXP_DT) + 1
																													   END EXP_DT 
																												 FROM FMS_HIRE 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 10
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ
								UNION ALL
								SELECT  ACCT_ITM_NM, 
										ACCT_CD,
										MIN(HIR_CURR_N1ST_CD) HIR_CURR_N1ST_CD,
										CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') THEN

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'), @[ori_exp_dt])
											 ELSE

												  FMS_OTRAMT_FNC(@[flet_ctrt_no], ACCT_CD, ACCT_ITM_SEQ, TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMMDDHH24MI'), TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12),'YYYYMMDDHH24MI'))
										 END HIR_RT_N1ST_AMT,
										MIN(HIR_CURR_N2ND_CD) HIR_CURR_N2ND_CD,
										MIN(HIR_RT_N2ND_AMT) HIR_RT_N2ND_AMT,
										MIN(SLP_TP_CD) SLP_TP_CD,
										MIN(INV_DESC) INV_DESC,
										MIN(FLET_CTRT_NO) FLET_CTRT_NO,
										MIN(INV_DTL_SEQ) INV_DTL_SEQ,
										ACCT_ITM_SEQ,
										MIN(EFF_DT) EFF_DT,
										MAX(EXP_DT) EXP_DT,
										'12' ITEMKEY
								  FROM  (SELECT (SELECT ACCT_ITM_NM 
												   FROM FMS_ACCT_ITM 
												  WHERE ACCT_CD = FO.ACCT_CD 
													AND ACCT_ITM_SEQ = FO.ACCT_ITM_SEQ 
													AND ROWNUM =1) ACCT_ITM_NM,
												FO.ACCT_CD,
												FO.CURR_CD HIR_CURR_N1ST_CD,
												0 HIR_RT_N1ST_AMT,
												NULL HIR_CURR_N2ND_CD,
												NULL HIR_RT_N2ND_AMT,
												'N' SLP_TP_CD,
												CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) = '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') AND SUBSTR(@[ori_exp_dt],9,4) != '0000' THEN
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI'),'YYYY-MM-DD') || ')'
													 ELSE
														  'Hire' || ' ' || @[vsl_cd] || ' ' || @[ppay_hir_no] || 'th' || ' ' || FO.CURR_CD || ' ' || '(' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYY-MM-DD') || ' ~ ' || TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12),'YYYY-MM-DD') || ')'
												 END INV_DESC,
												FO.FLET_CTRT_NO,
												ROWNUM INV_DTL_SEQ,
												FO.ACCT_ITM_SEQ,
												TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),1),'YYYYMMDDHH24MI') EFF_DT,
												@[ori_exp_dt] EXP_DT
										  FROM  FMS_CONTRACT FC, FMS_OTR_EXPN FO
										 WHERE  FC.FLET_CTRT_NO = FO.FLET_CTRT_NO
										   AND  FC.FLET_CTRT_NO = @[flet_ctrt_no]
										   AND  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11) >= (SELECT MIN(EFF_DT) 
																												 FROM FMS_HIRE 
																												WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') THEN 
														  TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
													 ELSE
														  ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12)
												 END													   <= (SELECT CASE WHEN MAX(EXP_DT) >= CASE WHEN SUBSTR(@[ori_exp_dt],1,6) = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),11),'YYYYMM') THEN 
																																						 TO_DATE(@[ori_exp_dt],'YYYYMMDDHH24MI')
																																					ELSE
																																						 ADD_MONTHS(TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM'),12)
																																				END 
																														   THEN
																															    MAX(EXP_DT)
																														   ELSE
																															    MAX(EXP_DT) + 1
																													   END EXP_DT 
																												  FROM FMS_HIRE 
																											     WHERE FLET_CTRT_NO = @[flet_ctrt_no])
										   AND  MONTHS_BETWEEN(TO_DATE(SUBSTR(@[ori_exp_dt],1,6),'YYYYMM'), TO_DATE(SUBSTR(@[ori_eff_dt],1,6),'YYYYMM')) >= 11
										) 
										GROUP BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ

								#end
								) WHERE  HIR_RT_N1ST_AMT != 0
								ORDER BY ACCT_ITM_NM, ACCT_CD, ACCT_ITM_SEQ, ROWNUM
						)
				) ORDER BY SORTKEY ASC, ACCT_ITM_NM ASC, ACCT_CD ASC, ITEMKEY ASC, CURR_CD ASC, ROWNUM
		)

#end			]]></sql>
			<params>
				<param name="ori_eff_dt" type="12" value="" out="N"/>
				<param name="ori_exp_dt" type="12" value="" out="N"/>
				<param name="flet_ctrt_no" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="ppay_hir_no" type="12" value="" out="N"/>
				<param name="acmm_rt_amt" type="12" value="" out="N"/>
				<param name="acmm_flg" type="12" value="" out="N"/>
				<param name="flet_brog_rt_amt" type="12" value="" out="N"/>
				<param name="brog_flg" type="12" value="" out="N"/>
				<param name="ori_inv_usd_dys" type="12" value="" out="N"/>
				<param name="inv_usd_dys" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
