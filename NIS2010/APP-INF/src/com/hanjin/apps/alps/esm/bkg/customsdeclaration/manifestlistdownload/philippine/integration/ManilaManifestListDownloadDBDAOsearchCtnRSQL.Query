<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ManilaManifestListDownloadDBDAOsearchCtnRSQL">
			<desc><![CDATA[Philippines Customs Manifest 화면의 CTN 탭 정보 조회]]></desc>
			<sql><![CDATA[
SELECT  REG_NO,
        BL_NO,
        CNTR_NO,
        CNTR_TPSZ,
		CGO_TP,
        CNTR_SEAL_NO,
		CNTR_SEAL_NO2,
		CNTR_SEAL_NO3,
		SEAL_PTY_CD,
        ROWNUM AS SEQ
FROM (
        SELECT @[reg_no]||'-'||SUBSTR(TO_CHAR(SYSDATE, 'YYYYMMDD'), 3, 2) REG_NO,
               BKG.BL_NO BL_NO,
               NVL(BC.CNTR_NO,' ') CNTR_NO,
               NVL(DECODE(SUBSTR(BC.CNTR_TPSZ_CD,2,1),'2',BC.CNTR_TPSZ_CD,SUBSTR(BC.CNTR_TPSZ_CD,1,1)||'4'),' ') CNTR_TPSZ,
			   NVL(DECODE(NVL(BKG.BKG_CGO_TP_CD,'F'),'F','FCL','B','Break Bulk',DECODE(NVL(BKG.RCV_TERM_CD,'Y'),'S','LCL','')),'') CGO_TP,
			   (SELECT NVL(MIN(CNTR_SEAL_NO),' ') 
			      FROM BKG_CNTR_SEAL_NO
			     WHERE BKG_NO = BC.BKG_NO
				   AND CNTR_NO = BC.CNTR_NO ) CNTR_SEAL_NO,
		 	   '' CNTR_SEAL_NO2,
			   '' CNTR_SEAL_NO3,
			   '' SEAL_PTY_CD
        FROM BKG_BOOKING BKG, BKG_CONTAINER BC, BKG_VVD BV
        WHERE BKG.BKG_NO       = BC.BKG_NO 
          AND BKG.BKG_NO       = BV.BKG_NO 
          AND BV.VSL_CD        = @[vsl_cd]
          AND BV.SKD_VOY_NO    = @[skd_voy_no]
          AND BV.SKD_DIR_CD    = @[skd_dir_cd]
		  #if (${pol_cd}!= '') 
		  AND BV.POL_CD          LIKE @[pol_cd] 
		  #end
		  #if (${pod_cd}!= '') 
		  AND BV.POD_CD          LIKE @[pod_cd] 
		  #end
          AND BKG.BKG_STS_CD   IN ('F','W')
          AND BKG.BL_NO        > ' '
)			]]></sql>
			<params>
				<param name="reg_no" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
