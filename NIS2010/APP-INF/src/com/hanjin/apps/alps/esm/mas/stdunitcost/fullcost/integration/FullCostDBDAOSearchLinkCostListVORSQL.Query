<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="FullCostDBDAOSearchLinkCostListVORSQL">
			<desc><![CDATA[MAS_LNK_AVG_STND_COST, MAS_COST_SRC_ACCT, MAS_STND_ACCT 테이블의 데이터 조회(Empty)   ]]></desc>
			<sql><![CDATA[
SELECT B1.LNK_FM_NOD_CD
	    ,B1.LNK_TO_NOD_CD
      ,'' COST_ACT_GRP_CD
      ,'' GRP
      ,SUM(B1.STND_COST_USD_AMT) COST
      ,B2.STND_COST_CD
      ,MAS_GET_COM_NM_FNC('STND_COST_CD', B2.STND_COST_CD) STND_COST_NM
      ,B2.MAS_COST_SRC_CD
      ,MAS_GET_COM_NM_FNC('MAS_COST_SRC_CD', B2.MAS_COST_SRC_CD) MAS_COST_SRC_CD_NM
      ,DECODE(GROUPING(B2.MAS_COST_SRC_CD), 1, 1, 2) LVL
      ,'AVERAGE' COST_ASS_BSE_CD
      ,'USD' LOCL_CURR_CD
      ,DECODE(@[f_cost_loc_grp_cd], 'S', 'SCC', 'E', 'ECC', 'R', 'RCC', 'NODE') LOC_TYPE
      ,DECODE(GROUPING(B2.MAS_COST_SRC_CD), 1, MAS_GET_COM_NM_FNC('STND_COST_CD', B2.STND_COST_CD), MAS_GET_COM_NM_FNC('MAS_COST_SRC_CD', B2.MAS_COST_SRC_CD)) COST_NM
  FROM (SELECT LNK_FM_NOD_CD, LNK_TO_NOD_CD
			        ,MAS_COST_SRC_CD                                               
              ,SUM(STND_COST_USD_AMT) STND_COST_USD_AMT                                               
          FROM MAS_LNK_AVG_STND_COST                                               
         WHERE 1 = 1                                               
           AND COST_LOC_GRP_CD = @[f_cost_loc_grp_cd]                                              
           AND FULL_MTY_CD = @[f_full_mty_cd]                                                
                                     
           #if (${f_cost_loc_grp_cd} == 'N') 
           AND LNK_FM_NOD_CD LIKE @[f_from] || '%'
           AND LNK_TO_NOD_CD LIKE @[f_to] || '%'
         #else 
           AND LNK_FM_NOD_CD = NVL(MAS_LOC_FNC(@[f_from], DECODE(@[f_cost_loc_grp_cd], 'S', 'SCC','E' ,'ECC', 'R', 'RCC', 'NODE')), @[f_from]) 
           AND LNK_TO_NOD_CD = NVL(MAS_LOC_FNC(@[f_to], DECODE(@[f_cost_loc_grp_cd], 'S', 'SCC','E' ,'ECC', 'R'	, 'RCC', 'NODE')), @[f_to]) 
          #end  
		                                              
           #if (${f_cost_yrmon} != '') 
           AND COST_YRMON = @[f_cost_yrmon]
          #end    

           #if (${f_cntr_tpsz_cd} != '') 
           AND CNTR_TPSZ_CD = @[f_cntr_tpsz_cd] 
          #end                                                                                        
          
       GROUP BY LNK_FM_NOD_CD, LNK_TO_NOD_CD, MAS_COST_SRC_CD) B1                                               
     ,(SELECT DISTINCT A1.STND_COST_CD                                               
                      ,A1.MAS_COST_SRC_CD                                               
                  FROM MAS_COST_SRC_ACCT A1, MAS_STND_ACCT A2                                               
                 WHERE 1 = 1                                               
                   AND A1.COST_SRC_SYS_CD = 'TRS'                                               
                   AND A1.STND_COST_CD = A2.STND_COST_CD                                               
              GROUP BY A1.STND_COST_CD, A1.MAS_COST_SRC_CD) B2                                               
  WHERE 1 = 1                                              
    AND B1.MAS_COST_SRC_CD = B2.MAS_COST_SRC_CD                                               
GROUP BY B1.LNK_FM_NOD_CD, B1.LNK_TO_NOD_CD, B2.STND_COST_CD, CUBE(B2.MAS_COST_SRC_CD)			]]></sql>
			<params>
				<param name="f_cost_loc_grp_cd" type="12" value="" out="N"/>
				<param name="f_full_mty_cd" type="12" value="" out="N"/>
				<param name="f_from" type="12" value="" out="N"/>
				<param name="f_to" type="12" value="" out="N"/>
				<param name="f_cost_yrmon" type="12" value="" out="N"/>
				<param name="f_cntr_tpsz_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
