<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AGTCommonDBDAOSearchAROfficeAgmtCmpnRSQL">
			<desc><![CDATA[searchAROfficeAgmtCmpn]]></desc>
			<sql><![CDATA[
SELECT
    OR2.AR_OFC_CD CODE,
    OR2.AR_OFC_CD NAME
FROM MDM_ORGANIZATION ORG,
    MDM_ORGANIZATION OR2,
    AGT_CMPN_AGMT_RT CAR
WHERE OR2.AR_OFC_CD IS NOT NULL
    AND OR2.OFC_CD
        IN
        (
            CASE
            WHEN ORG.AR_OFC_CD = OR2.AR_HD_QTR_OFC_CD
            THEN OR2.OFC_CD
            WHEN ORG.AR_OFC_CD = OR2.AR_OFC_CD
            THEN OR2.OFC_CD
            ELSE ORG.OFC_CD
            END
        )
    AND OR2.AR_OFC_CD = CAR.AR_OFC_CD
    AND ORG.OFC_CD = @[code]
GROUP BY OR2.AR_OFC_CD
ORDER BY OR2.AR_OFC_CD			]]></sql>
			<params>
				<param name="code" type="12" value="" out="Y"/>
			</params>
		</query>
	</querys>
</sqls>
