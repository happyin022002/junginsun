<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BookingHistoryMgtDBDAOSearchHistBkgDocIssRdemRSQL">
			<desc><![CDATA[BookingHistoryMgtDBDAOSearchHistBkgDocIssRdemRSQL]]></desc>
			<sql><![CDATA[
WITH OLD_RDEM AS
(
	SELECT @[bkg_no] AS BKG_NO
          ,@[his_seq] AS HIS_SEQ
          ,@[evnt_ofc_cd] AS EVNT_OFC_CD
          ,@[iss_rdem_knt] AS ISS_RDEM_KNT
          ,@[evnt_usr_id] AS EVNT_USR_ID
          ,@[evnt_dt] AS EVNT_DT
          ,@[obl_rdem_cfm_flg] AS OBL_RDEM_CFM_FLG
      FROM DUAL
)
SELECT HIS_CATE_NM
      ,PRE_CTNT
      ,CRNT_CTNT
  FROM 
       (
        SELECT 'ISSUE/RLS CANCEL' HIS_CATE_NM
              ,OLD_RDEM.ISS_RDEM_KNT || '/' || OLD_RDEM.EVNT_OFC_CD || '/' || 
               OLD_RDEM.EVNT_USR_ID || '/' || TO_CHAR(TO_DATE(OLD_RDEM.EVNT_DT, 'RRRR-MM-DD HH24:MI:SS'), 'YYYYMMDD') PRE_CTNT
              ,NOW_RDEM.ISS_RDEM_KNT || '/' || NOW_RDEM.EVNT_OFC_CD || '/' || 
               NOW_RDEM.EVNT_USR_ID || '/' || TO_CHAR(NOW_RDEM.EVNT_DT, 'YYYYMMDD') CRNT_CTNT
          FROM BKG_DOC_ISS_RDEM NOW_RDEM
			  ,OLD_RDEM
         WHERE OLD_RDEM.BKG_NO      = NOW_RDEM.BKG_NO (+)
           AND OLD_RDEM.HIS_SEQ     = NOW_RDEM.HIS_SEQ (+)
       )
 WHERE NVL(TRIM(PRE_CTNT), ' ') <> NVL(TRIM(CRNT_CTNT), ' ')			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="his_seq" type="12" value="" out="N"/>
				<param name="evnt_ofc_cd" type="12" value="" out="N"/>
				<param name="iss_rdem_knt" type="12" value="" out="N"/>
				<param name="evnt_usr_id" type="12" value="" out="N"/>
				<param name="evnt_dt" type="12" value="" out="N"/>
				<param name="obl_rdem_cfm_flg" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
