<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SCRateQuotationDBDAORsltPriCostSimulationCheckRouteVORSQL">
			<desc><![CDATA[  Pre CM/OP Simulation화면에서 입력한 POL,POD 가 정확한지 점사한다.]]></desc>
			<sql><![CDATA[
SELECT ORI.ROUT_PNT_LOC_DEF_CD
    ,ORI.RCV_DE_TERM_CD
    ,ORI.QTTN_NO
    ,ORI.QTTN_VER_NO
    ,ORI.GEN_SPCL_RT_TP_CD
    ,ORI.CMDT_HDR_SEQ
    ,ORI.ORG_DEST_TP_CD
    ,ORI.ROUT_SEQ
FROM (    
	SELECT GRP_DTL.LOC_CD AS ROUT_PNT_LOC_DEF_CD, NVL(PNT.RCV_DE_TERM_CD,'Y') AS RCV_DE_TERM_CD
		, PNT.QTTN_NO, PNT.QTTN_VER_NO, PNT.GEN_SPCL_RT_TP_CD,PNT.CMDT_HDR_SEQ, PNT.ORG_DEST_TP_CD,PNT.ROUT_SEQ 
	FROM PRI_SQ_RT_ROUT_PNT PNT
	    , PRI_SQ_GRP_LOC GRP
	    , PRI_SQ_GRP_LOC_DTL GRP_DTL
	WHERE  
	   PNT.QTTN_NO = @[qttn_no]
	    AND PNT.QTTN_VER_NO = @[qttn_ver_no]
	    AND PNT.GEN_SPCL_RT_TP_CD = @[gen_spcl_rt_tp_cd]
	    AND PNT.CMDT_HDR_SEQ = @[cmdt_hdr_seq]
	    AND PNT.ORG_DEST_TP_CD = 'O'
	    AND PNT.ROUT_SEQ = @[rout_seq]
	    AND ROUT_PNT_LOC_TP_CD = 'G'
	    AND PNT.SRC_INFO_CD <> 'AD' 
	    AND PNT.QTTN_NO = GRP.QTTN_NO
	    AND PNT.QTTN_VER_NO    = GRP.QTTN_VER_NO
	    AND PNT.ROUT_PNT_LOC_DEF_CD   = GRP.PRC_GRP_LOC_CD
	    AND GRP.QTTN_NO = GRP_DTL.QTTN_NO
	    AND GRP.QTTN_VER_NO    = GRP_DTL.QTTN_VER_NO 
	    AND GRP.GRP_LOC_SEQ   = GRP_DTL.GRP_LOC_SEQ
	    AND GRP_DTL.LOC_CD = @[por_cd]
	     AND  NVL(RCV_DE_TERM_CD,'Y') = @[bkg_rcv_term_cd]
	UNION ALL    
	select ROUT_PNT_LOC_DEF_CD, NVL(RCV_DE_TERM_CD,'Y') AS RCV_DE_TERM_CD
		, QTTN_NO, QTTN_VER_NO, GEN_SPCL_RT_TP_CD,CMDT_HDR_SEQ, ORG_DEST_TP_CD,ROUT_SEQ 
	from PRI_SQ_RT_ROUT_PNT 
	where  QTTN_NO = @[qttn_no]
	       AND QTTN_VER_NO = @[qttn_ver_no]
	       AND GEN_SPCL_RT_TP_CD = @[gen_spcl_rt_tp_cd]
	       AND CMDT_HDR_SEQ = @[cmdt_hdr_seq]
	       AND ORG_DEST_TP_CD = 'O'
		   AND ROUT_SEQ = @[rout_seq]
	       AND ROUT_PNT_LOC_TP_CD = 'L'
	       AND SRC_INFO_CD <> 'AD' 
	       AND ROUT_PNT_LOC_DEF_CD = @[por_cd]
	       AND  NVL(RCV_DE_TERM_CD,'Y') = @[bkg_rcv_term_cd]
    ) ORI
    ,(
	SELECT GRP_DTL.LOC_CD AS ROUT_PNT_LOC_DEF_CD, NVL(PNT.RCV_DE_TERM_CD,'Y') AS RCV_DE_TERM_CD
		, PNT.QTTN_NO, PNT.QTTN_VER_NO, PNT.GEN_SPCL_RT_TP_CD,PNT.CMDT_HDR_SEQ, PNT.ORG_DEST_TP_CD,PNT.ROUT_SEQ 
	FROM PRI_SQ_RT_ROUT_PNT PNT
	    , PRI_SQ_GRP_LOC GRP
	    , PRI_SQ_GRP_LOC_DTL GRP_DTL
	WHERE  
	   PNT.QTTN_NO = @[qttn_no]
	    AND PNT.QTTN_VER_NO = @[qttn_ver_no]
	    AND PNT.GEN_SPCL_RT_TP_CD = @[gen_spcl_rt_tp_cd]
	    AND PNT.CMDT_HDR_SEQ = @[cmdt_hdr_seq]
	    AND PNT.ORG_DEST_TP_CD = 'D'
	    AND PNT.ROUT_SEQ = @[rout_seq]
	    AND ROUT_PNT_LOC_TP_CD = 'G'
	    AND PNT.SRC_INFO_CD <> 'AD' 
	    AND PNT.QTTN_NO = GRP.QTTN_NO
	    AND PNT.QTTN_VER_NO    = GRP.QTTN_VER_NO
	    AND PNT.ROUT_PNT_LOC_DEF_CD   = GRP.PRC_GRP_LOC_CD
	    AND GRP.QTTN_NO = GRP_DTL.QTTN_NO
	    AND GRP.QTTN_VER_NO    = GRP_DTL.QTTN_VER_NO
	    AND GRP.GRP_LOC_SEQ   = GRP_DTL.GRP_LOC_SEQ
	    AND GRP_DTL.LOC_CD = @[del_cd]
	     AND  NVL(RCV_DE_TERM_CD,'Y') = @[bkg_de_term_cd]
	UNION ALL    
	select ROUT_PNT_LOC_DEF_CD, NVL(RCV_DE_TERM_CD,'Y') AS RCV_DE_TERM_CD
		, QTTN_NO, QTTN_VER_NO,  GEN_SPCL_RT_TP_CD,CMDT_HDR_SEQ, ORG_DEST_TP_CD,ROUT_SEQ 
	from PRI_SQ_RT_ROUT_PNT 
	where  QTTN_NO = @[qttn_no]
	       AND QTTN_VER_NO = @[qttn_ver_no]
	       AND GEN_SPCL_RT_TP_CD = @[gen_spcl_rt_tp_cd]
	       AND CMDT_HDR_SEQ = @[cmdt_hdr_seq]
	       AND ORG_DEST_TP_CD = 'D'
		   AND ROUT_SEQ = @[rout_seq]
	       AND ROUT_PNT_LOC_TP_CD = 'L'
	       AND SRC_INFO_CD <> 'AD' 
	       AND ROUT_PNT_LOC_DEF_CD = @[del_cd]
	       AND  NVL(RCV_DE_TERM_CD,'Y') = @[bkg_de_term_cd]
    ) DST   
WHERE ORI.QTTN_NO = DST.QTTN_NO     
    AND ORI.QTTN_VER_NO = DST.QTTN_VER_NO
    AND ORI.GEN_SPCL_RT_TP_CD = DST.GEN_SPCL_RT_TP_CD
    AND ORI.CMDT_HDR_SEQ = DST.CMDT_HDR_SEQ
    AND ORI.ROUT_SEQ = DST.ROUT_SEQ			]]></sql>
			<params>
				<param name="qttn_no" type="12" value="" out="N"/>
				<param name="qttn_ver_no" type="12" value="" out="N"/>
				<param name="gen_spcl_rt_tp_cd" type="12" value="" out="N"/>
				<param name="cmdt_hdr_seq" type="12" value="" out="N"/>
				<param name="rout_seq" type="12" value="" out="N"/>
				<param name="por_cd" type="12" value="" out="N"/>
				<param name="bkg_rcv_term_cd" type="12" value="" out="N"/>
				<param name="del_cd" type="12" value="" out="N"/>
				<param name="bkg_de_term_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
