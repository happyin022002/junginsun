/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : PerformanceReportDBDAOTroUsaStatusListInVORSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.08.08
*@LastModifier : 
*@LastVersion : 1.0
* 2016.08.08 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esm.bkg.bookingreport.performancereport.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class PerformanceReportDBDAOTroUsaStatusListInVORSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  *    
	  * </pre>
	  */
	public PerformanceReportDBDAOTroUsaStatusListInVORSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_term",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("tro_dt_fr",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pup_dt_fr",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("bkg_dt_to",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("tro_dt_to",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("bkg_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("bkg_dt_fr",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pup_dt_to",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("slan_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("d_term",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esm.bkg.bookingreport.performancereport.integration").append("\n"); 
		query.append("FileName : PerformanceReportDBDAOTroUsaStatusListInVORSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if (${so_flg} == '') " ).append("\n"); 
		query.append("SELECT B.BKG_NO" ).append("\n"); 
		query.append("      ,B.SLAN_CD" ).append("\n"); 
		query.append("      ,B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD VVD_CD" ).append("\n"); 
		query.append("      ,B.POR_CD" ).append("\n"); 
		query.append("      ,B.POL_CD" ).append("\n"); 
		query.append("      ,BQ.CNTR_TPSZ_CD BKG_TPSZ" ).append("\n"); 
		query.append("      ,BQ.OP_CNTR_QTY" ).append("\n"); 
		query.append("      ,B.BKG_OFC_CD" ).append("\n"); 
		query.append("      ,B.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("      ,TRO.TRO_SEQ       " ).append("\n"); 
		query.append("      ,TROD.TRO_SUB_SEQ  " ).append("\n"); 
		query.append("      ,TRO.DOR_LOC_CD" ).append("\n"); 
		query.append("      ,TROD.PKUP_YD_CD" ).append("\n"); 
		query.append("      ,TROD.RTN_YD_CD" ).append("\n"); 
		query.append("      ,TROD.CNTR_TPSZ_CD TRO_TPSZ" ).append("\n"); 
		query.append("      ,TROD.TRO_QTY" ).append("\n"); 
		query.append("      ,TO_CHAR(TRO.CRE_DT,'YYYY-MM-DD') TRO_DT" ).append("\n"); 
		query.append("      ,TO_CHAR(TRO.RQST_DT,'YYYY-MM-DD') RQST_DT" ).append("\n"); 
		query.append("      ,TRO.CFM_FLG" ).append("\n"); 
		query.append("      ,SO.EQ_NO" ).append("\n"); 
		query.append("      ,SO.COP_NO" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00275' AND CD.INTG_CD_VAL_CTNT = SO.TRSP_SO_STS_CD) SO_STS" ).append("\n"); 
		query.append("      ,SO.TRSP_SO_OFC_CTY_CD||SO.TRSP_SO_SEQ SO_NO" ).append("\n"); 
		query.append("      ,TO_CHAR(SO.LOCL_CRE_DT,'YYYY-MM-DD') SO_CRE_DT" ).append("\n"); 
		query.append("      ,(SELECT USR.USR_NM FROM COM_USER USR WHERE USR.USR_ID=SO.CRE_USR_ID) SO_CRE_ID" ).append("\n"); 
		query.append("      ,(SELECT USR2.USR_NM FROM COM_USER USR2, TRS_TRSP_WRK_ORD WO WHERE USR2.USR_ID=WO.CRE_USR_ID AND SO.TRSP_WO_OFC_CTY_CD=WO.TRSP_WO_OFC_CTY_CD AND SO.TRSP_WO_SEQ=WO.TRSP_WO_SEQ) WO_ISS_ID" ).append("\n"); 
		query.append("      ,SO.TRSP_WO_OFC_CTY_CD||SO.TRSP_WO_SEQ WO_NO" ).append("\n"); 
		query.append("      ,SO.INTER_RMK" ).append("\n"); 
		query.append("      ,DECODE(SO.DOR_SVC_TP_CD,'UD', 'UNDECIDED','LL', 'LIVE LOAD','LU', 'LIVE UNLOAD','ST', 'STREET TURN','DP', 'DROP AND PICK') DOOR_SVC_TP" ).append("\n"); 
		query.append("      ,SO.CRE_OFC_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(TROD.DOR_ARR_DT,'YYYY-MM-DD') DOR_ARR_DT" ).append("\n"); 
		query.append("      ,TO_CHAR(SO.DE_DT,'YYYY-MM-DD') DE_DT" ).append("\n"); 
		query.append("      ,TO_CHAR(SO.APNT_DT,'YYYY-MM-DD') APNT_DT" ).append("\n"); 
		query.append("      ,(SELECT VNDR_LGL_ENG_NM FROM MDM_VENDOR M WHERE M.VNDR_SEQ = SO.VNDR_SEQ) SERVICE_PROVIDER" ).append("\n"); 
		query.append("      ,(SELECT CNTC_PSON_NM FROM MDM_VENDOR M WHERE M.VNDR_SEQ = SO.VNDR_SEQ) CNTC_PSON_NM" ).append("\n"); 
		query.append("      ,C.LOC_CD" ).append("\n"); 
		query.append("      ,C.CNMV_STS_CD" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D2',TROD.TRO_QTY)),0)) D2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D4',TROD.TRO_QTY)),0)) D4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D5',TROD.TRO_QTY)),0)) D5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D7',TROD.TRO_QTY)),0)) D7" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D8',TROD.TRO_QTY)),0)) D8" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D9',TROD.TRO_QTY)),0)) D9" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'DW',TROD.TRO_QTY)),0)) DW" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'DX',TROD.TRO_QTY)),0)) DX" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'R2',TROD.TRO_QTY)),0)) R2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'R4',TROD.TRO_QTY)),0)) R4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'R5',TROD.TRO_QTY)),0)) R5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'F2',TROD.TRO_QTY)),0)) F2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'F4',TROD.TRO_QTY)),0)) F4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'F5',TROD.TRO_QTY)),0)) F5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'O2',TROD.TRO_QTY)),0)) O2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'O4',TROD.TRO_QTY)),0)) O4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'O5',TROD.TRO_QTY)),0)) O5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'S2',TROD.TRO_QTY)),0)) S2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'S4',TROD.TRO_QTY)),0)) S4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'T2',TROD.TRO_QTY)),0)) T2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'T4',TROD.TRO_QTY)),0)) T4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'A2',TROD.TRO_QTY)),0)) A2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'A4',TROD.TRO_QTY)),0)) A4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'A5',TROD.TRO_QTY)),0)) A5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'P2',TROD.TRO_QTY)),0)) P2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'P4',TROD.TRO_QTY)),0)) P4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'Z2',TROD.TRO_QTY)),0)) Z2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'Z4',TROD.TRO_QTY)),0)) Z4" ).append("\n"); 
		query.append("      ,'0' TOT_SUM" ).append("\n"); 
		query.append("  FROM BKG_BOOKING B JOIN BKG_QUANTITY BQ" ).append("\n"); 
		query.append("       ON B.BKG_NO = BQ.BKG_NO  " ).append("\n"); 
		query.append("       JOIN BKG_TRO TRO" ).append("\n"); 
		query.append("       ON B.BKG_NO = TRO.BKG_NO" ).append("\n"); 
		query.append("       JOIN BKG_TRO_DTL TROD" ).append("\n"); 
		query.append("       ON TRO.BKG_NO = TROD.BKG_NO" ).append("\n"); 
		query.append("       AND TRO.TRO_SEQ = TROD.TRO_SEQ" ).append("\n"); 
		query.append("       AND TRO.IO_BND_CD = TROD.IO_BND_CD" ).append("\n"); 
		query.append("       AND TRO.RTN_TRO_FLG = TROD.RTN_TRO_FLG" ).append("\n"); 
		query.append("       AND BQ.CNTR_TPSZ_CD = TROD.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("       LEFT OUTER JOIN TRS_TRSP_SVC_ORD SO" ).append("\n"); 
		query.append("       ON TROD.BKG_NO = SO.BKG_NO" ).append("\n"); 
		query.append("       AND TROD.TRO_SEQ = SO.TRO_SEQ" ).append("\n"); 
		query.append("       AND TROD.TRO_SUB_SEQ = SO.TRO_SUB_SEQ" ).append("\n"); 
		query.append("       AND TROD.IO_BND_CD = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("       AND SO.DELT_FLG = 'N'" ).append("\n"); 
		query.append("       LEFT OUTER JOIN MST_CONTAINER C" ).append("\n"); 
		query.append("       ON SO.EQ_NO = C.CNTR_NO" ).append("\n"); 
		query.append(" WHERE 1=1" ).append("\n"); 
		query.append("   AND (B.POR_CD LIKE 'US%' OR B.POL_CD LIKE 'US%')" ).append("\n"); 
		query.append("   AND TRO.CXL_FLG = 'N'" ).append("\n"); 
		query.append("   AND B.BKG_STS_CD != 'X'" ).append("\n"); 
		query.append("#if (${r_term} != '') " ).append("\n"); 
		query.append("   AND B.RCV_TERM_CD = @[r_term]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${d_term} != '') " ).append("\n"); 
		query.append("   AND B.DE_TERM_CD = @[d_term]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_dt_fr} != '') " ).append("\n"); 
		query.append("   AND B.BKG_CRE_DT > TO_DATE(@[bkg_dt_fr],'YYYY-MM-DD') " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_dt_to} != '') " ).append("\n"); 
		query.append("   AND B.BKG_CRE_DT <= TO_DATE(@[bkg_dt_to],'YYYY-MM-DD') + 0.99999     --BKG Date" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${bkg_no} != '') " ).append("\n"); 
		query.append("   AND B.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $ofcCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.BKG_OFC_CD " ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${ofcCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${vvd_cd} != '') " ).append("\n"); 
		query.append("   AND B.VSL_CD      =  SUBSTR(@[vvd_cd],1,4)" ).append("\n"); 
		query.append("   AND B.SKD_VOY_NO  =  SUBSTR(@[vvd_cd],5,4)" ).append("\n"); 
		query.append("   AND B.SKD_DIR_CD  =  SUBSTR(@[vvd_cd],9,1)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $porCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.POR_CD" ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${porCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $polCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.POL_CD" ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${polCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${slan_cd} != '') " ).append("\n"); 
		query.append("   AND B.SLAN_CD = @[slan_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${tro_dt_fr} != '') " ).append("\n"); 
		query.append("   AND TRO.CRE_DT >= TO_DATE(@[tro_dt_fr],'YYYY-MM-DD') " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${tro_dt_to} != '') " ).append("\n"); 
		query.append("   AND TRO.CRE_DT <= TO_DATE(@[tro_dt_to],'YYYY-MM-DD') + 0.99999" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${cfm_flg} == 'Y')" ).append("\n"); 
		query.append("  AND TRO.CFM_FLG = 'Y'" ).append("\n"); 
		query.append("#elseif (${cfm_flg} == 'N')" ).append("\n"); 
		query.append("  AND TRO.CFM_FLG = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${pup_dt_fr} != '') " ).append("\n"); 
		query.append("   AND TRO.RQST_DT >= TO_DATE(@[pup_dt_fr],'YYYY-MM-DD') " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${pup_dt_to} != '')" ).append("\n"); 
		query.append("   AND TRO.RQST_DT <= TO_DATE(@[pup_dt_to],'YYYY-MM-DD') + 0.99999" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $eqOfcCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${eqOfcCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY B.BKG_NO" ).append("\n"); 
		query.append("      ,B.SLAN_CD" ).append("\n"); 
		query.append("      ,B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD" ).append("\n"); 
		query.append("      ,B.POR_CD" ).append("\n"); 
		query.append("      ,B.POL_CD" ).append("\n"); 
		query.append("      ,BQ.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("      ,BQ.OP_CNTR_QTY" ).append("\n"); 
		query.append("      ,B.BKG_OFC_CD" ).append("\n"); 
		query.append("      ,B.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("      ,TRO.TRO_SEQ       " ).append("\n"); 
		query.append("      ,TROD.TRO_SUB_SEQ  " ).append("\n"); 
		query.append("      ,TRO.DOR_LOC_CD" ).append("\n"); 
		query.append("      ,TROD.PKUP_YD_CD" ).append("\n"); 
		query.append("      ,TROD.RTN_YD_CD" ).append("\n"); 
		query.append("      ,TROD.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("      ,TROD.TRO_QTY" ).append("\n"); 
		query.append("      ,TRO.CRE_DT" ).append("\n"); 
		query.append("      ,TRO.RQST_DT" ).append("\n"); 
		query.append("      ,TRO.CFM_FLG" ).append("\n"); 
		query.append("      ,SO.EQ_NO" ).append("\n"); 
		query.append("      ,SO.COP_NO" ).append("\n"); 
		query.append("      ,SO.TRSP_SO_STS_CD" ).append("\n"); 
		query.append("      ,SO.TRSP_SO_OFC_CTY_CD||SO.TRSP_SO_SEQ" ).append("\n"); 
		query.append("      ,SO.LOCL_CRE_DT" ).append("\n"); 
		query.append("      ,SO.CRE_USR_ID" ).append("\n"); 
		query.append("      ,SO.TRSP_WO_OFC_CTY_CD" ).append("\n"); 
		query.append("      ,SO.TRSP_WO_SEQ" ).append("\n"); 
		query.append("      ,SO.INTER_RMK" ).append("\n"); 
		query.append("      ,SO.DOR_SVC_TP_CD" ).append("\n"); 
		query.append("      ,SO.CRE_OFC_CD" ).append("\n"); 
		query.append("      ,TROD.DOR_ARR_DT" ).append("\n"); 
		query.append("      ,SO.DE_DT" ).append("\n"); 
		query.append("      ,SO.APNT_DT" ).append("\n"); 
		query.append("      ,SO.VNDR_SEQ" ).append("\n"); 
		query.append("      ,C.LOC_CD" ).append("\n"); 
		query.append("      ,C.CNMV_STS_CD" ).append("\n"); 
		query.append("ORDER BY B.BKG_NO" ).append("\n"); 
		query.append("        ,TRO.TRO_SEQ" ).append("\n"); 
		query.append("        ,TROD.TRO_SUB_SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif (${so_flg} == 'Y')" ).append("\n"); 
		query.append("SELECT B.BKG_NO" ).append("\n"); 
		query.append("      ,B.SLAN_CD" ).append("\n"); 
		query.append("      ,B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD VVD_CD" ).append("\n"); 
		query.append("      ,B.POR_CD" ).append("\n"); 
		query.append("      ,B.POL_CD" ).append("\n"); 
		query.append("      ,BQ.CNTR_TPSZ_CD BKG_TPSZ" ).append("\n"); 
		query.append("      ,BQ.OP_CNTR_QTY" ).append("\n"); 
		query.append("      ,B.BKG_OFC_CD" ).append("\n"); 
		query.append("      ,B.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("      ,TRO.TRO_SEQ       " ).append("\n"); 
		query.append("      ,TROD.TRO_SUB_SEQ  " ).append("\n"); 
		query.append("      ,TRO.DOR_LOC_CD" ).append("\n"); 
		query.append("      ,TROD.PKUP_YD_CD" ).append("\n"); 
		query.append("      ,TROD.RTN_YD_CD" ).append("\n"); 
		query.append("      ,TROD.CNTR_TPSZ_CD TRO_TPSZ" ).append("\n"); 
		query.append("      ,TROD.TRO_QTY" ).append("\n"); 
		query.append("      ,TO_CHAR(TRO.CRE_DT,'YYYY-MM-DD') TRO_DT" ).append("\n"); 
		query.append("      ,TO_CHAR(TRO.RQST_DT,'YYYY-MM-DD') RQST_DT" ).append("\n"); 
		query.append("      ,TRO.CFM_FLG" ).append("\n"); 
		query.append("      ,SO.EQ_NO" ).append("\n"); 
		query.append("      ,SO.COP_NO" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00275' AND CD.INTG_CD_VAL_CTNT = SO.TRSP_SO_STS_CD) SO_STS" ).append("\n"); 
		query.append("      ,SO.TRSP_SO_OFC_CTY_CD||SO.TRSP_SO_SEQ SO_NO" ).append("\n"); 
		query.append("      ,TO_CHAR(SO.LOCL_CRE_DT,'YYYY-MM-DD') SO_CRE_DT" ).append("\n"); 
		query.append("      ,(SELECT USR.USR_NM FROM COM_USER USR WHERE USR.USR_ID=SO.CRE_USR_ID) SO_CRE_ID" ).append("\n"); 
		query.append("      ,(SELECT USR2.USR_NM FROM COM_USER USR2, TRS_TRSP_WRK_ORD WO WHERE USR2.USR_ID=WO.CRE_USR_ID AND SO.TRSP_WO_OFC_CTY_CD=WO.TRSP_WO_OFC_CTY_CD AND SO.TRSP_WO_SEQ=WO.TRSP_WO_SEQ) WO_ISS_ID" ).append("\n"); 
		query.append("      ,SO.TRSP_WO_OFC_CTY_CD||SO.TRSP_WO_SEQ WO_NO" ).append("\n"); 
		query.append("      ,SO.INTER_RMK" ).append("\n"); 
		query.append("      ,DECODE(SO.DOR_SVC_TP_CD,'UD', 'UNDECIDED','LL', 'LIVE LOAD','LU', 'LIVE UNLOAD','ST', 'STREET TURN','DP', 'DROP AND PICK') DOOR_SVC_TP" ).append("\n"); 
		query.append("      ,SO.CRE_OFC_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(TROD.DOR_ARR_DT,'YYYY-MM-DD') DOR_ARR_DT" ).append("\n"); 
		query.append("      ,TO_CHAR(SO.DE_DT,'YYYY-MM-DD') DE_DT" ).append("\n"); 
		query.append("      ,TO_CHAR(SO.APNT_DT,'YYYY-MM-DD') APNT_DT" ).append("\n"); 
		query.append("      ,(SELECT VNDR_LGL_ENG_NM FROM MDM_VENDOR M WHERE M.VNDR_SEQ = SO.VNDR_SEQ) SERVICE_PROVIDER" ).append("\n"); 
		query.append("      ,(SELECT CNTC_PSON_NM FROM MDM_VENDOR M WHERE M.VNDR_SEQ = SO.VNDR_SEQ) CNTC_PSON_NM" ).append("\n"); 
		query.append("      ,C.LOC_CD" ).append("\n"); 
		query.append("      ,C.CNMV_STS_CD" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D2',TROD.TRO_QTY)),0)) D2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D4',TROD.TRO_QTY)),0)) D4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D5',TROD.TRO_QTY)),0)) D5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D7',TROD.TRO_QTY)),0)) D7" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D8',TROD.TRO_QTY)),0)) D8" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D9',TROD.TRO_QTY)),0)) D9" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'DW',TROD.TRO_QTY)),0)) DW" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'DX',TROD.TRO_QTY)),0)) DX" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'R2',TROD.TRO_QTY)),0)) R2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'R4',TROD.TRO_QTY)),0)) R4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'R5',TROD.TRO_QTY)),0)) R5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'F2',TROD.TRO_QTY)),0)) F2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'F4',TROD.TRO_QTY)),0)) F4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'F5',TROD.TRO_QTY)),0)) F5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'O2',TROD.TRO_QTY)),0)) O2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'O4',TROD.TRO_QTY)),0)) O4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'O5',TROD.TRO_QTY)),0)) O5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'S2',TROD.TRO_QTY)),0)) S2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'S4',TROD.TRO_QTY)),0)) S4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'T2',TROD.TRO_QTY)),0)) T2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'T4',TROD.TRO_QTY)),0)) T4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'A2',TROD.TRO_QTY)),0)) A2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'A4',TROD.TRO_QTY)),0)) A4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'A5',TROD.TRO_QTY)),0)) A5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'P2',TROD.TRO_QTY)),0)) P2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'P4',TROD.TRO_QTY)),0)) P4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'Z2',TROD.TRO_QTY)),0)) Z2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'Z4',TROD.TRO_QTY)),0)) Z4" ).append("\n"); 
		query.append("      ,'0' TOT_SUM" ).append("\n"); 
		query.append("  FROM BKG_BOOKING B JOIN BKG_QUANTITY BQ" ).append("\n"); 
		query.append("       ON B.BKG_NO = BQ.BKG_NO  " ).append("\n"); 
		query.append("       JOIN BKG_TRO TRO" ).append("\n"); 
		query.append("       ON B.BKG_NO = TRO.BKG_NO" ).append("\n"); 
		query.append("       JOIN BKG_TRO_DTL TROD" ).append("\n"); 
		query.append("       ON TRO.BKG_NO = TROD.BKG_NO" ).append("\n"); 
		query.append("       AND TRO.TRO_SEQ = TROD.TRO_SEQ" ).append("\n"); 
		query.append("       AND TRO.IO_BND_CD = TROD.IO_BND_CD" ).append("\n"); 
		query.append("       AND TRO.RTN_TRO_FLG = TROD.RTN_TRO_FLG" ).append("\n"); 
		query.append("       AND BQ.CNTR_TPSZ_CD = TROD.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("       JOIN TRS_TRSP_SVC_ORD SO" ).append("\n"); 
		query.append("       ON TROD.BKG_NO = SO.BKG_NO" ).append("\n"); 
		query.append("       AND TROD.TRO_SEQ = SO.TRO_SEQ" ).append("\n"); 
		query.append("       AND TROD.TRO_SUB_SEQ = SO.TRO_SUB_SEQ" ).append("\n"); 
		query.append("       AND TROD.IO_BND_CD = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("       AND SO.TRSP_SO_STS_CD = 'I'" ).append("\n"); 
		query.append("       AND SO.DELT_FLG = 'N'" ).append("\n"); 
		query.append("       LEFT OUTER JOIN MST_CONTAINER C" ).append("\n"); 
		query.append("       ON SO.EQ_NO = C.CNTR_NO" ).append("\n"); 
		query.append(" WHERE 1=1" ).append("\n"); 
		query.append("   AND (B.POR_CD LIKE 'US%' OR B.POL_CD LIKE 'US%')" ).append("\n"); 
		query.append("   AND TRO.CXL_FLG = 'N'" ).append("\n"); 
		query.append("   AND B.BKG_STS_CD != 'X'" ).append("\n"); 
		query.append("#if (${r_term} != '') " ).append("\n"); 
		query.append("   AND B.RCV_TERM_CD = @[r_term]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${d_term} != '') " ).append("\n"); 
		query.append("   AND B.DE_TERM_CD = @[d_term]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_dt_fr} != '') " ).append("\n"); 
		query.append("   AND B.BKG_CRE_DT > TO_DATE(@[bkg_dt_fr],'YYYY-MM-DD') " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_dt_to} != '') " ).append("\n"); 
		query.append("   AND B.BKG_CRE_DT <= TO_DATE(@[bkg_dt_to],'YYYY-MM-DD') + 0.99999     --BKG Date" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${bkg_no} != '') " ).append("\n"); 
		query.append("   AND B.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $ofcCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.BKG_OFC_CD " ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${ofcCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${vvd_cd} != '') " ).append("\n"); 
		query.append("   AND B.VSL_CD      =  SUBSTR(@[vvd_cd],1,4)" ).append("\n"); 
		query.append("   AND B.SKD_VOY_NO  =  SUBSTR(@[vvd_cd],5,4)" ).append("\n"); 
		query.append("   AND B.SKD_DIR_CD  =  SUBSTR(@[vvd_cd],9,1)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $porCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.POR_CD" ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${porCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $polCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.POL_CD" ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${polCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${slan_cd} != '') " ).append("\n"); 
		query.append("   AND B.SLAN_CD = @[slan_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${tro_dt_fr} != '') " ).append("\n"); 
		query.append("   AND TRO.CRE_DT >= TO_DATE(@[tro_dt_fr],'YYYY-MM-DD') " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${tro_dt_to} != '') " ).append("\n"); 
		query.append("   AND TRO.CRE_DT <= TO_DATE(@[tro_dt_to],'YYYY-MM-DD') + 0.99999" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${cfm_flg} == 'Y')" ).append("\n"); 
		query.append("  AND TRO.CFM_FLG = 'Y'" ).append("\n"); 
		query.append("#elseif (${cfm_flg} == 'N')" ).append("\n"); 
		query.append("  AND TRO.CFM_FLG = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${pup_dt_fr} != '') " ).append("\n"); 
		query.append("   AND TRO.RQST_DT >= TO_DATE(@[pup_dt_fr],'YYYY-MM-DD') " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${pup_dt_to} != '')" ).append("\n"); 
		query.append("   AND TRO.RQST_DT <= TO_DATE(@[pup_dt_to],'YYYY-MM-DD') + 0.99999" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $eqOfcCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${eqOfcCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY B.BKG_NO" ).append("\n"); 
		query.append("      ,B.SLAN_CD" ).append("\n"); 
		query.append("      ,B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD" ).append("\n"); 
		query.append("      ,B.POR_CD" ).append("\n"); 
		query.append("      ,B.POL_CD" ).append("\n"); 
		query.append("      ,BQ.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("      ,BQ.OP_CNTR_QTY" ).append("\n"); 
		query.append("      ,B.BKG_OFC_CD" ).append("\n"); 
		query.append("      ,B.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("      ,TRO.TRO_SEQ       " ).append("\n"); 
		query.append("      ,TROD.TRO_SUB_SEQ  " ).append("\n"); 
		query.append("      ,TRO.DOR_LOC_CD" ).append("\n"); 
		query.append("      ,TROD.PKUP_YD_CD" ).append("\n"); 
		query.append("      ,TROD.RTN_YD_CD" ).append("\n"); 
		query.append("      ,TROD.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("      ,TROD.TRO_QTY" ).append("\n"); 
		query.append("      ,TRO.CRE_DT" ).append("\n"); 
		query.append("      ,TRO.RQST_DT" ).append("\n"); 
		query.append("      ,TRO.CFM_FLG" ).append("\n"); 
		query.append("      ,SO.EQ_NO" ).append("\n"); 
		query.append("      ,SO.COP_NO" ).append("\n"); 
		query.append("      ,SO.TRSP_SO_STS_CD" ).append("\n"); 
		query.append("      ,SO.TRSP_SO_OFC_CTY_CD||SO.TRSP_SO_SEQ" ).append("\n"); 
		query.append("      ,SO.LOCL_CRE_DT" ).append("\n"); 
		query.append("      ,SO.CRE_USR_ID" ).append("\n"); 
		query.append("      ,SO.TRSP_WO_OFC_CTY_CD" ).append("\n"); 
		query.append("      ,SO.TRSP_WO_SEQ" ).append("\n"); 
		query.append("      ,SO.INTER_RMK" ).append("\n"); 
		query.append("      ,SO.DOR_SVC_TP_CD" ).append("\n"); 
		query.append("      ,SO.CRE_OFC_CD" ).append("\n"); 
		query.append("      ,TROD.DOR_ARR_DT" ).append("\n"); 
		query.append("      ,SO.DE_DT" ).append("\n"); 
		query.append("      ,SO.APNT_DT" ).append("\n"); 
		query.append("      ,SO.VNDR_SEQ" ).append("\n"); 
		query.append("      ,C.LOC_CD" ).append("\n"); 
		query.append("      ,C.CNMV_STS_CD" ).append("\n"); 
		query.append("ORDER BY B.BKG_NO" ).append("\n"); 
		query.append("        ,TRO.TRO_SEQ" ).append("\n"); 
		query.append("        ,TROD.TRO_SUB_SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif (${so_flg} == 'N')" ).append("\n"); 
		query.append("SELECT * FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT B.BKG_NO" ).append("\n"); 
		query.append("      ,B.SLAN_CD" ).append("\n"); 
		query.append("      ,B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD VVD_CD" ).append("\n"); 
		query.append("      ,B.POR_CD" ).append("\n"); 
		query.append("      ,B.POL_CD" ).append("\n"); 
		query.append("      ,BQ.CNTR_TPSZ_CD BKG_TPSZ" ).append("\n"); 
		query.append("      ,BQ.OP_CNTR_QTY" ).append("\n"); 
		query.append("      ,B.BKG_OFC_CD" ).append("\n"); 
		query.append("      ,B.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("      ,TRO.TRO_SEQ       " ).append("\n"); 
		query.append("      ,TROD.TRO_SUB_SEQ  " ).append("\n"); 
		query.append("      ,TRO.DOR_LOC_CD" ).append("\n"); 
		query.append("      ,TROD.PKUP_YD_CD" ).append("\n"); 
		query.append("      ,TROD.RTN_YD_CD" ).append("\n"); 
		query.append("      ,TROD.CNTR_TPSZ_CD TRO_TPSZ" ).append("\n"); 
		query.append("      ,TROD.TRO_QTY" ).append("\n"); 
		query.append("      ,TO_CHAR(TRO.CRE_DT,'YYYY-MM-DD') TRO_DT" ).append("\n"); 
		query.append("      ,TO_CHAR(TRO.RQST_DT,'YYYY-MM-DD') RQST_DT" ).append("\n"); 
		query.append("      ,TRO.CFM_FLG" ).append("\n"); 
		query.append("      ,SO.EQ_NO" ).append("\n"); 
		query.append("      ,SO.COP_NO" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00275' AND CD.INTG_CD_VAL_CTNT = SO.TRSP_SO_STS_CD) SO_STS" ).append("\n"); 
		query.append("      ,SO.TRSP_SO_OFC_CTY_CD||SO.TRSP_SO_SEQ SO_NO" ).append("\n"); 
		query.append("      ,TO_CHAR(SO.LOCL_CRE_DT,'YYYY-MM-DD') SO_CRE_DT" ).append("\n"); 
		query.append("      ,(SELECT USR.USR_NM FROM COM_USER USR WHERE USR.USR_ID=SO.CRE_USR_ID) SO_CRE_ID" ).append("\n"); 
		query.append("      ,(SELECT USR2.USR_NM FROM COM_USER USR2, TRS_TRSP_WRK_ORD WO WHERE USR2.USR_ID=WO.CRE_USR_ID AND SO.TRSP_WO_OFC_CTY_CD=WO.TRSP_WO_OFC_CTY_CD AND SO.TRSP_WO_SEQ=WO.TRSP_WO_SEQ) WO_ISS_ID" ).append("\n"); 
		query.append("      ,SO.TRSP_WO_OFC_CTY_CD||SO.TRSP_WO_SEQ WO_NO" ).append("\n"); 
		query.append("      ,SO.INTER_RMK" ).append("\n"); 
		query.append("      ,DECODE(SO.DOR_SVC_TP_CD,'UD', 'UNDECIDED','LL', 'LIVE LOAD','LU', 'LIVE UNLOAD','ST', 'STREET TURN','DP', 'DROP AND PICK') DOOR_SVC_TP" ).append("\n"); 
		query.append("      ,SO.CRE_OFC_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(TROD.DOR_ARR_DT,'YYYY-MM-DD') DOR_ARR_DT" ).append("\n"); 
		query.append("      ,TO_CHAR(SO.DE_DT,'YYYY-MM-DD') DE_DT" ).append("\n"); 
		query.append("      ,TO_CHAR(SO.APNT_DT,'YYYY-MM-DD') APNT_DT" ).append("\n"); 
		query.append("      ,(SELECT VNDR_LGL_ENG_NM FROM MDM_VENDOR M WHERE M.VNDR_SEQ = SO.VNDR_SEQ) SERVICE_PROVIDER" ).append("\n"); 
		query.append("      ,(SELECT CNTC_PSON_NM FROM MDM_VENDOR M WHERE M.VNDR_SEQ = SO.VNDR_SEQ) CNTC_PSON_NM" ).append("\n"); 
		query.append("      ,C.LOC_CD" ).append("\n"); 
		query.append("      ,C.CNMV_STS_CD" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D2',TROD.TRO_QTY)),0)) D2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D4',TROD.TRO_QTY)),0)) D4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D5',TROD.TRO_QTY)),0)) D5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D7',TROD.TRO_QTY)),0)) D7" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D8',TROD.TRO_QTY)),0)) D8" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D9',TROD.TRO_QTY)),0)) D9" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'DW',TROD.TRO_QTY)),0)) DW" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'DX',TROD.TRO_QTY)),0)) DX" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'R2',TROD.TRO_QTY)),0)) R2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'R4',TROD.TRO_QTY)),0)) R4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'R5',TROD.TRO_QTY)),0)) R5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'F2',TROD.TRO_QTY)),0)) F2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'F4',TROD.TRO_QTY)),0)) F4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'F5',TROD.TRO_QTY)),0)) F5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'O2',TROD.TRO_QTY)),0)) O2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'O4',TROD.TRO_QTY)),0)) O4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'O5',TROD.TRO_QTY)),0)) O5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'S2',TROD.TRO_QTY)),0)) S2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'S4',TROD.TRO_QTY)),0)) S4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'T2',TROD.TRO_QTY)),0)) T2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'T4',TROD.TRO_QTY)),0)) T4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'A2',TROD.TRO_QTY)),0)) A2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'A4',TROD.TRO_QTY)),0)) A4" ).append("\n"); 
		query.append("	  ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'A5',TROD.TRO_QTY)),0)) A5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'P2',TROD.TRO_QTY)),0)) P2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'P4',TROD.TRO_QTY)),0)) P4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'Z2',TROD.TRO_QTY)),0)) Z2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'Z4',TROD.TRO_QTY)),0)) Z4" ).append("\n"); 
		query.append("      ,'0' TOT_SUM" ).append("\n"); 
		query.append("  FROM BKG_BOOKING B JOIN BKG_QUANTITY BQ" ).append("\n"); 
		query.append("       ON B.BKG_NO = BQ.BKG_NO  " ).append("\n"); 
		query.append("       JOIN BKG_TRO TRO" ).append("\n"); 
		query.append("       ON B.BKG_NO = TRO.BKG_NO" ).append("\n"); 
		query.append("       JOIN BKG_TRO_DTL TROD" ).append("\n"); 
		query.append("       ON TRO.BKG_NO = TROD.BKG_NO" ).append("\n"); 
		query.append("       AND TRO.TRO_SEQ = TROD.TRO_SEQ" ).append("\n"); 
		query.append("       AND TRO.IO_BND_CD = TROD.IO_BND_CD" ).append("\n"); 
		query.append("       AND TRO.RTN_TRO_FLG = TROD.RTN_TRO_FLG" ).append("\n"); 
		query.append("       AND BQ.CNTR_TPSZ_CD = TROD.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("       JOIN TRS_TRSP_SVC_ORD SO" ).append("\n"); 
		query.append("       ON TROD.BKG_NO = SO.BKG_NO" ).append("\n"); 
		query.append("       AND TROD.TRO_SEQ = SO.TRO_SEQ" ).append("\n"); 
		query.append("       AND TROD.TRO_SUB_SEQ = SO.TRO_SUB_SEQ" ).append("\n"); 
		query.append("       AND TROD.IO_BND_CD = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("       AND SO.DELT_FLG = 'N'" ).append("\n"); 
		query.append("       AND SO.TRSP_SO_STS_CD != 'I'" ).append("\n"); 
		query.append("       LEFT OUTER JOIN MST_CONTAINER C" ).append("\n"); 
		query.append("       ON SO.EQ_NO = C.CNTR_NO" ).append("\n"); 
		query.append(" WHERE 1=1" ).append("\n"); 
		query.append("   AND (B.POR_CD LIKE 'US%' OR B.POL_CD LIKE 'US%')" ).append("\n"); 
		query.append("   AND TRO.CXL_FLG = 'N'" ).append("\n"); 
		query.append("   AND B.BKG_STS_CD != 'X'" ).append("\n"); 
		query.append("#if (${r_term} != '') " ).append("\n"); 
		query.append("   AND B.RCV_TERM_CD = @[r_term]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${d_term} != '') " ).append("\n"); 
		query.append("   AND B.DE_TERM_CD = @[d_term]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_dt_fr} != '') " ).append("\n"); 
		query.append("   AND B.BKG_CRE_DT > TO_DATE(@[bkg_dt_fr],'YYYY-MM-DD') " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_dt_to} != '') " ).append("\n"); 
		query.append("   AND B.BKG_CRE_DT <= TO_DATE(@[bkg_dt_to],'YYYY-MM-DD') + 0.99999     --BKG Date" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${bkg_no} != '') " ).append("\n"); 
		query.append("   AND B.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $ofcCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.BKG_OFC_CD " ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${ofcCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${vvd_cd} != '') " ).append("\n"); 
		query.append("   AND B.VSL_CD      =  SUBSTR(@[vvd_cd],1,4)" ).append("\n"); 
		query.append("   AND B.SKD_VOY_NO  =  SUBSTR(@[vvd_cd],5,4)" ).append("\n"); 
		query.append("   AND B.SKD_DIR_CD  =  SUBSTR(@[vvd_cd],9,1)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $porCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.POR_CD" ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${porCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $polCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.POL_CD" ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${polCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${slan_cd} != '') " ).append("\n"); 
		query.append("   AND B.SLAN_CD = @[slan_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${tro_dt_fr} != '') " ).append("\n"); 
		query.append("   AND TRO.CRE_DT >= TO_DATE(@[tro_dt_fr],'YYYY-MM-DD') " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${tro_dt_to} != '') " ).append("\n"); 
		query.append("   AND TRO.CRE_DT <= TO_DATE(@[tro_dt_to],'YYYY-MM-DD') + 0.99999" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${cfm_flg} == 'Y')" ).append("\n"); 
		query.append("  AND TRO.CFM_FLG = 'Y'" ).append("\n"); 
		query.append("#elseif (${cfm_flg} == 'N')" ).append("\n"); 
		query.append("  AND TRO.CFM_FLG = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${pup_dt_fr} != '') " ).append("\n"); 
		query.append("   AND TRO.RQST_DT >= TO_DATE(@[pup_dt_fr],'YYYY-MM-DD') " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${pup_dt_to} != '')" ).append("\n"); 
		query.append("   AND TRO.RQST_DT <= TO_DATE(@[pup_dt_to],'YYYY-MM-DD') + 0.99999" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $eqOfcCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${eqOfcCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY B.BKG_NO" ).append("\n"); 
		query.append("      ,B.SLAN_CD" ).append("\n"); 
		query.append("      ,B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD" ).append("\n"); 
		query.append("      ,B.POR_CD" ).append("\n"); 
		query.append("      ,B.POL_CD" ).append("\n"); 
		query.append("      ,BQ.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("      ,BQ.OP_CNTR_QTY" ).append("\n"); 
		query.append("      ,B.BKG_OFC_CD" ).append("\n"); 
		query.append("      ,B.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("      ,TRO.TRO_SEQ       " ).append("\n"); 
		query.append("      ,TROD.TRO_SUB_SEQ  " ).append("\n"); 
		query.append("      ,TRO.DOR_LOC_CD" ).append("\n"); 
		query.append("      ,TROD.PKUP_YD_CD" ).append("\n"); 
		query.append("      ,TROD.RTN_YD_CD" ).append("\n"); 
		query.append("      ,TROD.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("      ,TROD.TRO_QTY" ).append("\n"); 
		query.append("      ,TRO.CRE_DT" ).append("\n"); 
		query.append("      ,TRO.RQST_DT" ).append("\n"); 
		query.append("      ,TRO.CFM_FLG" ).append("\n"); 
		query.append("      ,SO.EQ_NO" ).append("\n"); 
		query.append("      ,SO.COP_NO" ).append("\n"); 
		query.append("      ,SO.TRSP_SO_STS_CD" ).append("\n"); 
		query.append("      ,SO.TRSP_SO_OFC_CTY_CD||SO.TRSP_SO_SEQ" ).append("\n"); 
		query.append("      ,SO.LOCL_CRE_DT" ).append("\n"); 
		query.append("      ,SO.CRE_USR_ID" ).append("\n"); 
		query.append("      ,SO.TRSP_WO_OFC_CTY_CD" ).append("\n"); 
		query.append("      ,SO.TRSP_WO_SEQ" ).append("\n"); 
		query.append("      ,SO.INTER_RMK" ).append("\n"); 
		query.append("      ,SO.DOR_SVC_TP_CD" ).append("\n"); 
		query.append("      ,SO.CRE_OFC_CD" ).append("\n"); 
		query.append("      ,TROD.DOR_ARR_DT" ).append("\n"); 
		query.append("      ,SO.DE_DT" ).append("\n"); 
		query.append("      ,SO.APNT_DT" ).append("\n"); 
		query.append("      ,SO.VNDR_SEQ" ).append("\n"); 
		query.append("      ,C.LOC_CD" ).append("\n"); 
		query.append("      ,C.CNMV_STS_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT B.BKG_NO" ).append("\n"); 
		query.append("      ,B.SLAN_CD" ).append("\n"); 
		query.append("      ,B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD VVD_CD" ).append("\n"); 
		query.append("      ,B.POR_CD" ).append("\n"); 
		query.append("      ,B.POL_CD" ).append("\n"); 
		query.append("      ,BQ.CNTR_TPSZ_CD BKG_TPSZ" ).append("\n"); 
		query.append("      ,BQ.OP_CNTR_QTY" ).append("\n"); 
		query.append("      ,B.BKG_OFC_CD" ).append("\n"); 
		query.append("      ,B.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("      ,TRO.TRO_SEQ       " ).append("\n"); 
		query.append("      ,TROD.TRO_SUB_SEQ  " ).append("\n"); 
		query.append("      ,TRO.DOR_LOC_CD" ).append("\n"); 
		query.append("      ,TROD.PKUP_YD_CD" ).append("\n"); 
		query.append("      ,TROD.RTN_YD_CD" ).append("\n"); 
		query.append("      ,TROD.CNTR_TPSZ_CD TRO_TPSZ" ).append("\n"); 
		query.append("      ,TROD.TRO_QTY" ).append("\n"); 
		query.append("      ,TO_CHAR(TRO.CRE_DT,'YYYY-MM-DD') TRO_DT" ).append("\n"); 
		query.append("      ,TO_CHAR(TRO.RQST_DT,'YYYY-MM-DD') RQST_DT" ).append("\n"); 
		query.append("      ,TRO.CFM_FLG" ).append("\n"); 
		query.append("      ,'' EQ_NO" ).append("\n"); 
		query.append("      ,'' COP_NO" ).append("\n"); 
		query.append("      ,'' SO_STS" ).append("\n"); 
		query.append("      ,'' SO_NO" ).append("\n"); 
		query.append("      ,'' SO_CRE_DT" ).append("\n"); 
		query.append("      ,'' SO_CRE_ID" ).append("\n"); 
		query.append("      ,'' WO_ISS_ID" ).append("\n"); 
		query.append("      ,'' WO_NO" ).append("\n"); 
		query.append("      ,'' INTER_RMK" ).append("\n"); 
		query.append("      ,'' DOOR_SVC_TP" ).append("\n"); 
		query.append("      ,'' CRE_OFC_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(TROD.DOR_ARR_DT,'YYYY-MM-DD') DOR_ARR_DT" ).append("\n"); 
		query.append("      ,'' DE_DT" ).append("\n"); 
		query.append("      ,'' APNT_DT" ).append("\n"); 
		query.append("      ,'' SERVICE_PROVIDER" ).append("\n"); 
		query.append("      ,'' CNTC_PSON_NM" ).append("\n"); 
		query.append("      ,'' LOC_CD" ).append("\n"); 
		query.append("      ,'' CNMV_STS_CD" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D2',TROD.TRO_QTY)),0)) D2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D4',TROD.TRO_QTY)),0)) D4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D5',TROD.TRO_QTY)),0)) D5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D7',TROD.TRO_QTY)),0)) D7" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D8',TROD.TRO_QTY)),0)) D8" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'D9',TROD.TRO_QTY)),0)) D9" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'DW',TROD.TRO_QTY)),0)) DW" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'DX',TROD.TRO_QTY)),0)) DX" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'R2',TROD.TRO_QTY)),0)) R2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'R4',TROD.TRO_QTY)),0)) R4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'R5',TROD.TRO_QTY)),0)) R5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'F2',TROD.TRO_QTY)),0)) F2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'F4',TROD.TRO_QTY)),0)) F4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'F5',TROD.TRO_QTY)),0)) F5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'O2',TROD.TRO_QTY)),0)) O2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'O4',TROD.TRO_QTY)),0)) O4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'O5',TROD.TRO_QTY)),0)) O5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'S2',TROD.TRO_QTY)),0)) S2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'S4',TROD.TRO_QTY)),0)) S4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'T2',TROD.TRO_QTY)),0)) T2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'T4',TROD.TRO_QTY)),0)) T4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'A2',TROD.TRO_QTY)),0)) A2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'A4',TROD.TRO_QTY)),0)) A4" ).append("\n"); 
		query.append("	  ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'A5',TROD.TRO_QTY)),0)) A5" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'P2',TROD.TRO_QTY)),0)) P2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'P4',TROD.TRO_QTY)),0)) P4" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'Z2',TROD.TRO_QTY)),0)) Z2" ).append("\n"); 
		query.append("      ,SUM(NVL(GREATEST(DECODE(BQ.CNTR_TPSZ_CD,'Z4',TROD.TRO_QTY)),0)) Z4" ).append("\n"); 
		query.append("      ,'0' TOT_SUM" ).append("\n"); 
		query.append("  FROM BKG_BOOKING B JOIN BKG_QUANTITY BQ" ).append("\n"); 
		query.append("       ON B.BKG_NO = BQ.BKG_NO  " ).append("\n"); 
		query.append("       JOIN BKG_TRO TRO" ).append("\n"); 
		query.append("       ON B.BKG_NO = TRO.BKG_NO" ).append("\n"); 
		query.append("       JOIN BKG_TRO_DTL TROD" ).append("\n"); 
		query.append("       ON TRO.BKG_NO = TROD.BKG_NO" ).append("\n"); 
		query.append("       AND TRO.TRO_SEQ = TROD.TRO_SEQ" ).append("\n"); 
		query.append("       AND TRO.IO_BND_CD = TROD.IO_BND_CD" ).append("\n"); 
		query.append("       AND TRO.RTN_TRO_FLG = TROD.RTN_TRO_FLG" ).append("\n"); 
		query.append("       AND BQ.CNTR_TPSZ_CD = TROD.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(" WHERE 1=1" ).append("\n"); 
		query.append("   AND NOT EXISTS (SELECT 'X' FROM TRS_TRSP_SVC_ORD SO" ).append("\n"); 
		query.append("                    WHERE TROD.BKG_NO = SO.BKG_NO" ).append("\n"); 
		query.append("                      AND TROD.TRO_SEQ = SO.TRO_SEQ" ).append("\n"); 
		query.append("                      AND TROD.TRO_SUB_SEQ = SO.TRO_SUB_SEQ" ).append("\n"); 
		query.append("                      AND TROD.IO_BND_CD = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("                      AND SO.DELT_FLG = 'N')" ).append("\n"); 
		query.append("   AND (B.POR_CD LIKE 'US%' OR B.POL_CD LIKE 'US%')" ).append("\n"); 
		query.append("   AND TRO.CXL_FLG = 'N'" ).append("\n"); 
		query.append("   AND B.BKG_STS_CD != 'X'" ).append("\n"); 
		query.append("#if (${r_term} != '') " ).append("\n"); 
		query.append("   AND B.RCV_TERM_CD = @[r_term]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${d_term} != '') " ).append("\n"); 
		query.append("   AND B.DE_TERM_CD = @[d_term]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_dt_fr} != '') " ).append("\n"); 
		query.append("   AND B.BKG_CRE_DT > TO_DATE(@[bkg_dt_fr],'YYYY-MM-DD') " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${bkg_dt_to} != '') " ).append("\n"); 
		query.append("   AND B.BKG_CRE_DT <= TO_DATE(@[bkg_dt_to],'YYYY-MM-DD') + 0.99999     --BKG Date" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${bkg_no} != '') " ).append("\n"); 
		query.append("   AND B.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $ofcCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.BKG_OFC_CD " ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${ofcCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${vvd_cd} != '') " ).append("\n"); 
		query.append("   AND B.VSL_CD      =  SUBSTR(@[vvd_cd],1,4)" ).append("\n"); 
		query.append("   AND B.SKD_VOY_NO  =  SUBSTR(@[vvd_cd],5,4)" ).append("\n"); 
		query.append("   AND B.SKD_DIR_CD  =  SUBSTR(@[vvd_cd],9,1)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $porCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.POR_CD" ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${porCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $polCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.POL_CD" ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${polCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${slan_cd} != '') " ).append("\n"); 
		query.append("   AND B.SLAN_CD = @[slan_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${tro_dt_fr} != '') " ).append("\n"); 
		query.append("   AND TRO.CRE_DT >= TO_DATE(@[tro_dt_fr],'YYYY-MM-DD') " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${tro_dt_to} != '') " ).append("\n"); 
		query.append("   AND TRO.CRE_DT <= TO_DATE(@[tro_dt_to],'YYYY-MM-DD') + 0.99999" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${cfm_flg} == 'Y')" ).append("\n"); 
		query.append("  AND TRO.CFM_FLG = 'Y'" ).append("\n"); 
		query.append("#elseif (${cfm_flg} == 'N')" ).append("\n"); 
		query.append("  AND TRO.CFM_FLG = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${pup_dt_fr} != '') " ).append("\n"); 
		query.append("   AND TRO.RQST_DT >= TO_DATE(@[pup_dt_fr],'YYYY-MM-DD') " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${pup_dt_to} != '')" ).append("\n"); 
		query.append("   AND TRO.RQST_DT <= TO_DATE(@[pup_dt_to],'YYYY-MM-DD') + 0.99999" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( $eqOfcCdArr.size() > 0)	" ).append("\n"); 
		query.append("   AND B.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("	IN ( " ).append("\n"); 
		query.append("	#foreach( ${key} in ${eqOfcCdArr})" ).append("\n"); 
		query.append("		#if($velocityCount == 1)" ).append("\n"); 
		query.append("			 '${key}'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			,  '${key}'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY B.BKG_NO" ).append("\n"); 
		query.append("      ,B.SLAN_CD" ).append("\n"); 
		query.append("      ,B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD" ).append("\n"); 
		query.append("      ,B.POR_CD" ).append("\n"); 
		query.append("      ,B.POL_CD" ).append("\n"); 
		query.append("      ,BQ.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("      ,BQ.OP_CNTR_QTY" ).append("\n"); 
		query.append("      ,B.BKG_OFC_CD" ).append("\n"); 
		query.append("      ,B.EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("      ,TRO.TRO_SEQ       " ).append("\n"); 
		query.append("      ,TROD.TRO_SUB_SEQ  " ).append("\n"); 
		query.append("      ,TRO.DOR_LOC_CD" ).append("\n"); 
		query.append("      ,TROD.PKUP_YD_CD" ).append("\n"); 
		query.append("      ,TROD.RTN_YD_CD" ).append("\n"); 
		query.append("      ,TROD.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("      ,TROD.TRO_QTY" ).append("\n"); 
		query.append("      ,TRO.CRE_DT" ).append("\n"); 
		query.append("      ,TRO.RQST_DT" ).append("\n"); 
		query.append("      ,TRO.CFM_FLG" ).append("\n"); 
		query.append("      ,TROD.DOR_ARR_DT" ).append("\n"); 
		query.append(") A" ).append("\n"); 
		query.append("ORDER BY A.BKG_NO" ).append("\n"); 
		query.append("        ,A.TRO_SEQ" ).append("\n"); 
		query.append("        ,A.TRO_SUB_SEQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 

	}
}