<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PlanningDBDAOCreateRbcLaneQtaSettingCSQL">
			<desc><![CDATA[RbcLaneQta list를 생성한다.]]></desc>
			<sql><![CDATA[
INSERT INTO SQM_QTA_RBC (
         BSE_TP_CD
        ,BSE_YR
        ,BSE_QTR_CD
        ,OFC_VW_CD
        ,TRD_CD
        ,RLANE_CD
        ,DIR_CD
        ,RGN_OFC_CD
        ,RHQ_CD
        ,SUB_TRD_CD
        ,GID_LOD_QTY
        ,GID_GRS_REV
        ,GID_PA_CM_AMT
        ,GID_RA_CM_AMT
        ,LOD_QTY
        ,GRS_REV
        ,PA_CM_AMT
        ,RA_CM_AMT
        ,CRE_USR_ID
        ,CRE_DT
        ,UPD_USR_ID
        ,UPD_DT   
	)
SELECT OFC.BSE_TP_CD 
      ,OFC.BSE_YR
      ,OFC.BSE_QTR_CD
      ,OFC.OFC_VW_CD
      ,OFC.TRD_CD
      ,OFC.RLANE_CD
      ,OFC.DIR_CD
      ,OFC.RGN_OFC_CD
      ,OFC.RHQ_CD
      ,OFC.SUB_TRD_CD      
#if (${f_bse_tp_cd} == 'Y')
      ,ROUND(NVL(PER.LOD_QTY,0) / 53) 
      ,ROUND(NVL(PER.GRS_TTL_REV,0) / 53) 
      ,ROUND(NVL(PER.GRS_TTL_REV,0) / 53) - ROUND(NVL(PER.PA_CM_UC_AMT,0)*NVL(PER.LOD_QTY,0) / 53) 
      ,ROUND(NVL(PER.GRS_TTL_REV,0) / 53) - ROUND(NVL(PER.RA_CM_UC_AMT,0)*NVL(PER.LOD_QTY,0) / 53)  
      ,ROUND(NVL(PER.LOD_QTY,0) / 53) 
      ,ROUND(NVL(PER.GRS_TTL_REV,0) / 53) 
      ,ROUND(NVL(PER.GRS_TTL_REV,0) / 53) - ROUND(NVL(PER.PA_CM_UC_AMT,0)*NVL(PER.LOD_QTY,0) / 53) 
      ,ROUND(NVL(PER.GRS_TTL_REV,0) / 53) - ROUND(NVL(PER.RA_CM_UC_AMT,0)*NVL(PER.LOD_QTY,0) / 53)  
#else
      ,ROUND(NVL(PER.LOD_QTY,0) / 13)
      ,ROUND(NVL(PER.GRS_TTL_REV,0) / 13) 
      ,ROUND(NVL(PER.GRS_TTL_REV,0) / 13) - ROUND(NVL(PER.PA_CM_UC_AMT,0)*NVL(PER.LOD_QTY,0) / 13)
      ,ROUND(NVL(PER.GRS_TTL_REV,0) / 13) - ROUND(NVL(PER.RA_CM_UC_AMT,0)*NVL(PER.LOD_QTY,0) / 13)
      ,ROUND(NVL(PER.LOD_QTY,0) / 13)
      ,ROUND(NVL(PER.GRS_TTL_REV,0) / 13) 
      ,ROUND(NVL(PER.GRS_TTL_REV,0) / 13) - ROUND(NVL(PER.PA_CM_UC_AMT,0)*NVL(PER.LOD_QTY,0) / 13)
      ,ROUND(NVL(PER.GRS_TTL_REV,0) / 13) - ROUND(NVL(PER.RA_CM_UC_AMT,0)*NVL(PER.LOD_QTY,0) / 13) 
#end
      ,@[usr_id]  CRE_USR_ID
      ,SYSDATE        CRE_DT
      ,@[usr_id]  UPD_USR_ID
      ,SYSDATE        UPD_DT
 FROM SQM_PERF_IF PER
     ,SQM_QTA_LANE_OFC OFC
WHERE OFC.BSE_TP_CD      = PER.BSE_TP_CD(+)
  AND OFC.BSE_YR         = PER.BSE_YR(+)
  AND OFC.BSE_QTR_CD     = PER.BSE_QTR_CD(+) 
  AND OFC.OFC_VW_CD      = PER.OFC_VW_CD(+) 
  AND OFC.TRD_CD         = PER.TRD_CD(+)
  AND OFC.SUB_TRD_CD     = PER.SUB_TRD_CD(+)
  AND OFC.RLANE_CD       = PER.RLANE_CD(+)
  AND OFC.DIR_CD         = PER.DIR_CD(+) 
  AND OFC.RHQ_CD         = PER.RHQ_CD(+)
  AND OFC.RGN_OFC_CD     = PER.RGN_OFC_CD(+) 
  AND OFC.BSE_TP_CD      = @[f_bse_tp_cd]
  AND OFC.BSE_YR         = @[f_bse_yr]
  AND OFC.BSE_QTR_CD     = DECODE(@[f_bse_tp_cd],'Y','00',@[f_bse_qtr_cd]) 
  AND OFC.RLANE_CD       = 'RBCCO'
  AND PER.QTA_TGT_CD(+)  = 'D'
  AND PER.SQM_LVL_CD(+)  = 2			]]></sql>
			<params>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="f_bse_tp_cd" type="12" value="" out="N"/>
				<param name="f_bse_yr" type="12" value="" out="N"/>
				<param name="f_bse_qtr_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
