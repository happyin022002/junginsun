<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TransshipmentMgtDBDAOsearchVslDischargingRSQL">
			<desc><![CDATA[조회 조건에 맞는 vessel schedule과 지정되어 있는 crn, uvi no를 조회한다.]]></desc>
			<sql><![CDATA[
select vps.vsl_cd||vps.skd_voy_no||vps.skd_dir_cd vvd
        , vps.slan_cd lane
		, vps.clpt_ind_seq skd_call_seq
        , vps.vps_port_cd clpt_cd 
        , to_char(vps.vps_etb_dt,'yyyy-mm-dd') etb
        , SUBSTR(dchg.yd_cd, 6, 2) ydcd
        , dchg.cvy_ref_no 
        , dchg.uq_vsl_id_no 
        , vps.vsl_cd
        , vps.skd_voy_no
        , vps.skd_dir_cd
        , dchg.yd_cd yd_cd
  from vsk_vsl_port_skd vps, bkg_vsl_dchg_yd dchg, mdm_vsl_cntr vsl
 where vps.vsl_cd = dchg.vsl_cd(+)
   and vps.skd_voy_no = dchg.skd_voy_no(+)
   and vps.skd_dir_cd = dchg.skd_dir_cd(+)
   and vps.vps_port_cd = dchg.port_cd(+)
   and vps.CLPT_IND_SEQ = dchg.clpt_ind_seq(+)
   and vps.vsl_cd = vsl.vsl_cd

#if (${vps_etb_dt} != '') 
   and vps.vps_etb_dt  >= TO_DATE(@[vps_etb_dt],'YYYY-MM-DD')
#end

#if (${vps_etd_dt} != '') 
   and vps.vps_etd_dt  <= TO_DATE(@[vps_etd_dt],'YYYY-MM-DD') +0.99999
#end

#if (${vps_port_cd} != '') 
   and vps.VPS_PORT_CD = @[vps_port_cd]
#end

#if (${vps_oher_port_cd} != '') 
 and  (vps.vsl_cd, vps.skd_voy_no, vps.skd_dir_cd)
        in (select vsl_cd, skd_voy_no, skd_dir_cd
            from vsk_vsl_port_skd where vps_port_cd = @[vps_oher_port_cd]) 
#end

#if (${vvd} != '') 
   and vps.VSL_CD||vps.SKD_VOY_NO||vps.SKD_DIR_CD like @[vvd]||'%'
#end

#if (${lane} != '') 
   and vps.slan_cd  = @[lane]
#end

#if (${crr_cd} != '') 
   and vsl.crr_cd  = @[crr_cd]
#end			]]></sql>
			<params>
				<param name="vps_etb_dt" type="12" value="" out="N"/>
				<param name="vps_etd_dt" type="12" value="" out="N"/>
				<param name="vps_port_cd" type="12" value="" out="N"/>
				<param name="vps_oher_port_cd" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="lane" type="12" value="" out="N"/>
				<param name="crr_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
