<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CostSetUpDBDAOAddVslLayupListCSQL">
			<desc><![CDATA[COA_MNL_DTL_COST 테이블에 데이터 저장]]></desc>
			<sql><![CDATA[
INSERT INTO COA_MNL_DTL_COST
 SELECT B.YYYY_MM
      , B.COST_WK
      , A.RLANE_CD
      , A.VSL_CD
      , A.STND_COST_CD
      , DECODE(B.SUN, NULL, 0, SUN_COST_AMT) SUN_COST_AMT
      , DECODE(B.MON, NULL, 0, MON_COST_AMT) MON_COST_AMT
      , DECODE(B.TUE, NULL, 0, TUE_COST_AMT) TUE_COST_AMT
      , DECODE(B.WED, NULL, 0, WED_COST_AMT) WED_COST_AMT
      , DECODE(B.THU, NULL, 0, THU_COST_AMT) THU_COST_AMT
      , DECODE(B.FRI, NULL, 0, FRI_COST_AMT) FRI_COST_AMT
      , DECODE(B.SAT, NULL, 0, SAT_COST_AMT) SAT_COST_AMT
      , DECODE(B.SUN, NULL, 0, SUN_COST_AMT) 
      + DECODE(B.MON, NULL, 0, MON_COST_AMT) 
      + DECODE(B.TUE, NULL, 0, TUE_COST_AMT) 
      + DECODE(B.WED, NULL, 0, WED_COST_AMT) 
      + DECODE(B.THU, NULL, 0, THU_COST_AMT) 
      + DECODE(B.FRI, NULL, 0, FRI_COST_AMT) 
      + DECODE(B.SAT, NULL, 0, SAT_COST_AMT) TTL_AMT
      ,@[usr_id]
      ,SYSDATE
      ,@[usr_id]
      ,SYSDATE
      ,@[dp_seq]
   FROM
        (SELECT SUBSTR(REPLACE(@[cost_yrmon],'-',''),1,4) COST_YR
              , SUBSTR(REPLACE(@[cost_yrmon],'-',''),5,2) COST_WK
              , @[rlane_cd] RLANE_CD
              , @[vsl_cd] VSL_CD
              , @[stnd_cost_cd] STND_COST_CD
              , @[sun_cost_amt] SUN_COST_AMT
              , @[mon_cost_amt] MON_COST_AMT
              , @[tue_cost_amt] TUE_COST_AMT
              , @[wed_cost_amt] WED_COST_AMT
              , @[thu_cost_amt] THU_COST_AMT
              , @[fri_cost_amt] FRI_COST_AMT
              , @[sat_cost_amt] SAT_COST_AMT
              , @[ttl_amt] TTL_AMT
           FROM DUAL
        ) A
      , (SELECT COST_YR
              , YYYY_MM
              , COST_WK
              , MAX(SUN) SUN
              , MAX(MON) MON
              , MAX(TUE) TUE
              , MAX(WED) WED
              , MAX(THU) THU
              , MAX(FRI) FRI
              , MAX(SAT) SAT
           FROM
                (SELECT COST_YR
                      , SUBSTR(SLS_FM_DT, 1, 6) YYYY_MM
                      , TO_DATE(SLS_FM_DT, 'YYYYMMDD') YEAR_MONTH
                      , COST_WK
                      , DECODE(TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 0, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 0)) SUN
                      , DECODE(TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 1, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 1)) MON
                      , DECODE(TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 2, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 2)) TUE
                      , DECODE(TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 3, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 3)) WED
                      , DECODE(TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 4, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 4)) THU
                      , DECODE(TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 5, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 5)) FRI
                      , DECODE(TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 6, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 6)) SAT
                   FROM COA_WK_PRD
                  WHERE 1=1
                    AND COST_YR = SUBSTR(REPLACE(@[cost_yrmon],'-',''),1,4)
                    AND COST_WK = SUBSTR(REPLACE(@[cost_yrmon],'-',''),5,2)
              UNION ALL
                 SELECT COST_YR
                      , SUBSTR(SLS_TO_DT, 1, 6) YYYY_MM
                      , TO_DATE(SLS_TO_DT, 'YYYYMMDD') YEAR_MONTH
                      , COST_WK
                      , DECODE(TO_CHAR(TO_DATE(SLS_TO_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 0, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 0)) SUN
                      , DECODE(TO_CHAR(TO_DATE(SLS_TO_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 1, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 1)) MON
                      , DECODE(TO_CHAR(TO_DATE(SLS_TO_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 2, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 2)) TUE
                      , DECODE(TO_CHAR(TO_DATE(SLS_TO_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 3, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 3)) WED
                      , DECODE(TO_CHAR(TO_DATE(SLS_TO_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 4, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 4)) THU
                      , DECODE(TO_CHAR(TO_DATE(SLS_TO_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 5, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 5)) FRI
                      , DECODE(TO_CHAR(TO_DATE(SLS_TO_DT, 'YYYYMMDD'), 'YYYYMM'), TO_CHAR(TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 6, 'YYYYMM'), (TO_DATE(SLS_FM_DT, 'YYYYMMDD') + 6)) SAT
                   FROM COA_WK_PRD
                  WHERE 1=1
                    AND COST_YR = SUBSTR(REPLACE(@[cost_yrmon],'-',''),1,4)
                    AND COST_WK = SUBSTR(REPLACE(@[cost_yrmon],'-',''),5,2)
                )
       GROUP BY COST_YR
              , YYYY_MM
              , COST_WK
        ) B
  WHERE A. COST_YR = B.COST_YR
    AND A.COST_WK  = B.COST_WK			]]></sql>
			<params>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="dp_seq" type="12" value="" out="N"/>
				<param name="cost_yrmon" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="stnd_cost_cd" type="12" value="" out="N"/>
				<param name="sun_cost_amt" type="12" value="" out="N"/>
				<param name="mon_cost_amt" type="12" value="" out="N"/>
				<param name="tue_cost_amt" type="12" value="" out="N"/>
				<param name="wed_cost_amt" type="12" value="" out="N"/>
				<param name="thu_cost_amt" type="12" value="" out="N"/>
				<param name="fri_cost_amt" type="12" value="" out="N"/>
				<param name="sat_cost_amt" type="12" value="" out="N"/>
				<param name="ttl_amt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
