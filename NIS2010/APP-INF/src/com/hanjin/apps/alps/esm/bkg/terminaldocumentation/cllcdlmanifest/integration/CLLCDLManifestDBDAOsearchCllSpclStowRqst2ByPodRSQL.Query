<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CLLCDLManifestDBDAOsearchCllSpclStowRqst2ByPodRSQL">
			<desc><![CDATA[searchCllSpclStowRqst2ByPod]]></desc>
			<sql><![CDATA[
SELECT *
FROM (

#if (${in_pgm_no} == 'ESM_BKG_0951') 
/**************************** ESM_BKG_0951에서 조회된 경우  *****************************/
SELECT GUBUN_CD3,
  '' GUBUN_CD2,
  '' GUBUN_CD,
  BLCK_STWG_CD,
  DECODE(SUM(ODAL_20), 0, '', SUM(ODAL_20)) ODAL_20,
  DECODE(SUM(ODAL_40), 0, '', SUM(ODAL_40)) ODAL_40,
  DECODE(SUM(ODAL_40H), 0, '', SUM(ODAL_40H)) ODAL_40H,
  DECODE(SUM(ODAL_45), 0, '', SUM(ODAL_45)) ODAL_45,
  
  DECODE(SUM(ODBC_20), 0, '', SUM(ODBC_20)) ODBC_20,
  DECODE(SUM(ODBC_40), 0, '', SUM(ODBC_40)) ODBC_40,
  DECODE(SUM(ODBC_40H), 0, '', SUM(ODBC_40H)) ODBC_40H,
  DECODE(SUM(ODBC_45), 0, '', SUM(ODBC_45)) ODBC_45,
  
  DECODE(SUM(ODET_20), 0, '', SUM(ODET_20)) ODET_20,
  DECODE(SUM(ODET_40), 0, '', SUM(ODET_40)) ODET_40,
  DECODE(SUM(ODET_40H), 0, '', SUM(ODET_40H)) ODET_40H,
  DECODE(SUM(ODET_45), 0, '', SUM(ODET_45)) ODET_45,
  
  DECODE(SUM(ODFT_20), 0, '', SUM(ODFT_20)) ODFT_20,
  DECODE(SUM(ODFT_40), 0, '', SUM(ODFT_40)) ODFT_40,
  DECODE(SUM(ODFT_40H), 0, '', SUM(ODFT_40H)) ODFT_40H,
  DECODE(SUM(ODFT_45), 0, '', SUM(ODFT_45)) ODFT_45,
  
  DECODE(SUM(ODHD_20), 0, '', SUM(ODHD_20)) ODHD_20,
  DECODE(SUM(ODHD_40), 0, '', SUM(ODHD_40)) ODHD_40,
  DECODE(SUM(ODHD_45), 0, '', SUM(ODHD_45)) ODHD_45,
  
  DECODE(SUM(ODHD_40H), 0, '', SUM(ODHD_40H)) ODHD_40H,
  DECODE(SUM(OP_20), 0, '', SUM(OP_20)) OP_20,
  DECODE(SUM(OP_40), 0, '', SUM(OP_40)) OP_40,
  DECODE(SUM(OP_40H), 0, '', SUM(OP_40H)) OP_40H,
  DECODE(SUM(OP_45), 0, '', SUM(OP_45)) OP_45,
  
  DECODE(SUM(OT_20), 0, '', SUM(OT_20)) OT_20,
  DECODE(SUM(OT_40), 0, '', SUM(OT_40)) OT_40,
  DECODE(SUM(OT_40H), 0, '', SUM(OT_40H)) OT_40H,
  DECODE(SUM(OT_45), 0, '', SUM(OT_45)) OT_45,
  
  DECODE(SUM(OTNO_20), 0, '', SUM(OTNO_20)) OTNO_20,
  DECODE(SUM(OTNO_40), 0, '', SUM(OTNO_40)) OTNO_40,
  DECODE(SUM(OTNO_40H), 0, '', SUM(OTNO_40H)) OTNO_40H,
  DECODE(SUM(OTNO_45), 0, '', SUM(OTNO_45)) OTNO_45,
  
  DECODE(SUM(PC_20), 0, '', SUM(PC_20)) PC_20,
  DECODE(SUM(PC_40), 0, '', SUM(PC_40)) PC_40,
  DECODE(SUM(PC_40H), 0, '', SUM(PC_40H)) PC_40H,
  DECODE(SUM(PC_45), 0, '', SUM(PC_45)) PC_45


FROM (
    SELECT NVL(LO.UN_LOC_CD,BV.POD_CD) GUBUN_CD3,
	  BK.BLCK_STWG_CD AS BLCK_STWG_CD,
      DECODE(DECODE(BK.STWG_CD,'ODAL',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODAL',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0)) ODAL_20,
	  DECODE(DECODE(BK.STWG_CD,'ODAL',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODAL',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0)) ODAL_40,
	  DECODE(DECODE(BK.STWG_CD,'ODAL',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0, '7', 0,  BQ.OP_CNTR_QTY),0),0,'',DECODE(BK.STWG_CD,'ODAL',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0, '7', 0,  BQ.OP_CNTR_QTY),0)) ODAL_40H,
      DECODE(DECODE(BK.STWG_CD,'ODAL',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODAL',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0)) ODAL_45,
      
      DECODE(DECODE(BK.STWG_CD,'ODBC',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODBC',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0)) ODBC_20,
      DECODE(DECODE(BK.STWG_CD,'ODBC',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODBC',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0)) ODBC_40,
      DECODE(DECODE(BK.STWG_CD,'ODBC',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0, '7', 0,  BQ.OP_CNTR_QTY),0),0,'',DECODE(BK.STWG_CD,'ODBC',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0,  '7', 0, BQ.OP_CNTR_QTY),0)) ODBC_40H,
      DECODE(DECODE(BK.STWG_CD,'ODBC',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODBC',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0)) ODBC_45,
      
      DECODE(DECODE(BK.STWG_CD,'ODET',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODET',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0)) ODET_20,
      DECODE(DECODE(BK.STWG_CD,'ODET',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODET',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0)) ODET_40,
      DECODE(DECODE(BK.STWG_CD,'ODET',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0, '7', 0,  BQ.OP_CNTR_QTY),0),0,'',DECODE(BK.STWG_CD,'ODET',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0, '7', 0,  BQ.OP_CNTR_QTY),0)) ODET_40H,
      DECODE(DECODE(BK.STWG_CD,'ODET',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODET',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0)) ODET_45,
      
      DECODE(DECODE(BK.STWG_CD,'ODFT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODFT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0)) ODFT_20,
      DECODE(DECODE(BK.STWG_CD,'ODFT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODFT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0)) ODFT_40,
      DECODE(DECODE(BK.STWG_CD,'ODFT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0, '7', 0,  BQ.OP_CNTR_QTY),0),0,'',DECODE(BK.STWG_CD,'ODFT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0, '7', 0,  BQ.OP_CNTR_QTY),0)) ODFT_40H,
      DECODE(DECODE(BK.STWG_CD,'ODFT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODFT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0)) ODFT_45,
      
      DECODE(DECODE(BK.STWG_CD,'ODHD',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODHD',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0)) ODHD_20,
      DECODE(DECODE(BK.STWG_CD,'ODHD',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODHD',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0)) ODHD_40,
      DECODE(DECODE(BK.STWG_CD,'ODHD',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0,  '7', 0, BQ.OP_CNTR_QTY),0),0,'',DECODE(BK.STWG_CD,'ODHD',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0, '7', 0,  BQ.OP_CNTR_QTY),0)) ODHD_40H,
      DECODE(DECODE(BK.STWG_CD,'ODHD',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'ODHD',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0)) ODHD_45,
      
      DECODE(DECODE(BK.STWG_CD,'OP',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'OP',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0)) OP_20,
      DECODE(DECODE(BK.STWG_CD,'OP',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'OP',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0)) OP_40,
      DECODE(DECODE(BK.STWG_CD,'OP',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0, '7', 0,  BQ.OP_CNTR_QTY),0),0,'',DECODE(BK.STWG_CD,'OP',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0, '7', 0,  BQ.OP_CNTR_QTY),0)) OP_40H,
      DECODE(DECODE(BK.STWG_CD,'OP',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'OP',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0)) OP_45,
      
      DECODE(DECODE(BK.STWG_CD,'OT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'OT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0)) OT_20,
      DECODE(DECODE(BK.STWG_CD,'OT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'OT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0)) OT_40,
      DECODE(DECODE(BK.STWG_CD,'OT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0,  '7', 0, BQ.OP_CNTR_QTY),0),0,'',DECODE(BK.STWG_CD,'OT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0,  '7', 0, BQ.OP_CNTR_QTY),0)) OT_40H,
      DECODE(DECODE(BK.STWG_CD,'OT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'OT',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0)) OT_45,
      
      DECODE(DECODE(BK.STWG_CD,'OTNO',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'OTNO',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0)) OTNO_20,
      DECODE(DECODE(BK.STWG_CD,'OTNO',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'OTNO',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0)) OTNO_40,
      DECODE(DECODE(BK.STWG_CD,'OTNO',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0,  '7', 0, BQ.OP_CNTR_QTY),0),0,'',DECODE(BK.STWG_CD,'OTNO',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0,  '7', 0, BQ.OP_CNTR_QTY),0)) OTNO_40H,
      DECODE(DECODE(BK.STWG_CD,'OTNO',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.STWG_CD,'OTNO',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0)) OTNO_45,


      CASE WHEN BK.PRCT_FLG = 'Y'-- BK.STWG_CD IS NOT NULL AND BK.STWG_CD = 'PC'
                THEN DECODE(DECODE(BK.PRCT_FLG,'Y',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.PRCT_FLG,'Y',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0), 0))
           WHEN BK.STWG_CD IS NULL
                THEN DECODE(DECODE(CM.REP_IMDG_LVL_CD,'P',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(CM.REP_IMDG_LVL_CD,'P',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2',BQ.OP_CNTR_QTY,0),0))
      END PC_20,
      
      CASE WHEN BK.PRCT_FLG = 'Y' -- BK.STWG_CD IS NOT NULL AND BK.STWG_CD = 'PC'
                THEN DECODE(DECODE(BK.PRCT_FLG,'Y',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.PRCT_FLG,'Y',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0))
           WHEN BK.STWG_CD IS NULL
                THEN DECODE(DECODE(CM.REP_IMDG_LVL_CD,'P',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(CM.REP_IMDG_LVL_CD,'P',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'4',BQ.OP_CNTR_QTY,0),0))
      END PC_40,
      
      CASE WHEN BK.PRCT_FLG = 'Y' -- BK.STWG_CD IS NOT NULL AND BK.STWG_CD = 'PC'
                THEN DECODE(DECODE(BK.PRCT_FLG,'Y',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0,  '7', 0, BQ.OP_CNTR_QTY),0),0,'',DECODE(BK.PRCT_FLG,'Y',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0,  '7', 0, BQ.OP_CNTR_QTY),0))
           WHEN BK.STWG_CD IS NULL
                THEN DECODE(DECODE(CM.REP_IMDG_LVL_CD,'P',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0,  '7', 0, BQ.OP_CNTR_QTY),0),0,'',DECODE(CM.REP_IMDG_LVL_CD,'P',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'2', 0, '4', 0,  '7', 0, BQ.OP_CNTR_QTY),0))
      END PC_40H,
           
      CASE WHEN BK.PRCT_FLG = 'Y' --BK.STWG_CD IS NOT NULL AND BK.STWG_CD = 'PC'
           THEN DECODE(DECODE(BK.PRCT_FLG,'Y',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(BK.PRCT_FLG,'Y',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0))
      WHEN BK.STWG_CD IS NULL
           THEN DECODE(DECODE(CM.REP_IMDG_LVL_CD,'P',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0),0,'',DECODE(CM.REP_IMDG_LVL_CD,'P',DECODE(SUBSTR(BQ.CNTR_TPSZ_CD,2,1),'7',BQ.OP_CNTR_QTY,0),0))
      END PC_45,

      VPS.CLPT_SEQ CLPT_SEQ
    FROM BKG_BOOKING BK, BKG_VVD BV, VSK_VSL_PORT_SKD VPS, MDM_LOCATION LO, BKG_QUANTITY BQ, MDM_COMMODITY CM
    WHERE BK.BKG_NO = BV.BKG_NO
      AND BK.BKG_NO = BQ.BKG_NO
      AND BQ.CNTR_TPSZ_CD NOT IN ('Q2','Q4')
      AND BV.VSL_CD = VPS.VSL_CD
      AND BV.SKD_VOY_NO = VPS.SKD_VOY_NO
      AND BV.SKD_DIR_CD = VPS.SKD_DIR_CD
      AND BV.POD_CD = VPS.VPS_PORT_CD
      AND BK.CMDT_CD = CM.CMDT_CD
      AND VPS.VPS_PORT_CD = LO.LOC_CD
      AND NVL(CM.DELT_FLG,'N')='N'


	  AND BV.VSL_CD     = NVL(@[in_vsl_cd], SUBSTR(@[in_vvd_cd], 1, 4))
	  AND BV.SKD_VOY_NO = NVL(@[in_skd_voy_no], SUBSTR(@[in_vvd_cd], 5, 4))
	  AND BV.SKD_DIR_CD = NVL(@[in_skd_dir_cd], SUBSTR(@[in_vvd_cd], 9, 1))
      AND BV.POL_CD     = @[in_pol_cd]
      AND SUBSTR(BV.POL_YD_CD, 6, 2) like @[in_pol_yd_cd]||'%'

      AND BK.BKG_STS_CD IN ( 'F','W')
      AND VPS.CLPT_IND_SEQ = '1'
      AND NVL(BK.SPLIT_RSN_CD,' ') <> 'M' )
GROUP BY GUBUN_CD3,BLCK_STWG_CD, CLPT_SEQ
ORDER BY CLPT_SEQ

#else 
/***************************** 기본 조회 *****************************/
   SELECT GUBUN_CD3,
          '' GUBUN_CD2,
          '' GUBUN_CD,
          BLCK_STWG_CD,
          DECODE(SUM(ODAL_20), 0, '', SUM(ODAL_20)) ODAL_20,
          DECODE(SUM(ODAL_40), 0, '', SUM(ODAL_40)) ODAL_40,
          DECODE(SUM(ODAL_40H), 0, '', SUM(ODAL_40H)) ODAL_40H,
          DECODE(SUM(ODAL_45), 0, '', SUM(ODAL_45)) ODAL_45,
          
          DECODE(SUM(ODBC_20), 0, '', SUM(ODBC_20)) ODBC_20,
          DECODE(SUM(ODBC_40), 0, '', SUM(ODBC_40)) ODBC_40,
          DECODE(SUM(ODBC_40H), 0, '', SUM(ODBC_40H)) ODBC_40H,
          DECODE(SUM(ODBC_45), 0, '', SUM(ODBC_45)) ODBC_45,
          
          DECODE(SUM(ODET_20), 0, '', SUM(ODET_20)) ODET_20,
          DECODE(SUM(ODET_40), 0, '', SUM(ODET_40)) ODET_40,
          DECODE(SUM(ODET_40H), 0, '', SUM(ODET_40H)) ODET_40H,
          DECODE(SUM(ODET_45), 0, '', SUM(ODET_45)) ODET_45,
          
          DECODE(SUM(ODFT_20), 0, '', SUM(ODFT_20)) ODFT_20,
          DECODE(SUM(ODFT_40), 0, '', SUM(ODFT_40)) ODFT_40,
          DECODE(SUM(ODFT_40H), 0, '', SUM(ODFT_40H)) ODFT_40H,
          DECODE(SUM(ODFT_45), 0, '', SUM(ODFT_45)) ODFT_45,
          
          DECODE(SUM(ODHD_20), 0, '', SUM(ODHD_20)) ODHD_20,
          DECODE(SUM(ODHD_40), 0, '', SUM(ODHD_40)) ODHD_40,
          DECODE(SUM(ODHD_45), 0, '', SUM(ODHD_45)) ODHD_45,
          DECODE(SUM(ODHD_40H), 0, '', SUM(ODHD_40H)) ODHD_40H,
          
          DECODE(SUM(OP_20), 0, '', SUM(OP_20)) OP_20,
          DECODE(SUM(OP_40), 0, '', SUM(OP_40)) OP_40,
          DECODE(SUM(OP_40H), 0, '', SUM(OP_40H)) OP_40H,
          DECODE(SUM(OP_45), 0, '', SUM(OP_45)) OP_45,
          
          DECODE(SUM(OT_20), 0, '', SUM(OT_20)) OT_20,
          DECODE(SUM(OT_40), 0, '', SUM(OT_40)) OT_40,
          DECODE(SUM(OT_40H), 0, '', SUM(OT_40H)) OT_40H,
          DECODE(SUM(OT_45), 0, '', SUM(OT_45)) OT_45,
          
          DECODE(SUM(OTNO_20), 0, '', SUM(OTNO_20)) OTNO_20,
          DECODE(SUM(OTNO_40), 0, '', SUM(OTNO_40)) OTNO_40,
          DECODE(SUM(OTNO_40H), 0, '', SUM(OTNO_40H)) OTNO_40H,
          DECODE(SUM(OTNO_45), 0, '', SUM(OTNO_45)) OTNO_45,
          
          DECODE(SUM(PC_20), 0, '', SUM(PC_20)) PC_20,
          DECODE(SUM(PC_40), 0, '', SUM(PC_40)) PC_40,
          DECODE(SUM(PC_40H), 0, '', SUM(PC_40H)) PC_40H,
          DECODE(SUM(PC_45), 0, '', SUM(PC_45)) PC_45


		FROM (
				SELECT NVL(LO.UN_LOC_CD, BV.POD_CD) GUBUN_CD3,
					BK.BLCK_STWG_CD AS BLCK_STWG_CD,
   					DECODE(CLL.STWG_CD, 'ODAL', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 1, 0), 0) ODAL_20,
                    DECODE(CLL.STWG_CD, 'ODAL', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '4', 1, 0), 0) ODAL_40,
                    DECODE(CLL.STWG_CD, 'ODAL', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 0, '4', 0, '7', 0, 1), 0) ODAL_40H,
                    DECODE(CLL.STWG_CD, 'ODAL', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '7', 1, 0), 0) ODAL_45,
                    
					DECODE(CLL.STWG_CD, 'ODBC', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 1, 0), 0) ODBC_20,
					DECODE(CLL.STWG_CD, 'ODBC', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '4', 1, 0), 0) ODBC_40,
					DECODE(CLL.STWG_CD, 'ODBC', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 0, '4', 0, '7', 0, 1), 0) ODBC_40H,
                    DECODE(CLL.STWG_CD, 'ODBC', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '7', 1, 0), 0) ODBC_45,
                    
					DECODE(CLL.STWG_CD, 'ODET', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 1, 0), 0) ODET_20,
					DECODE(CLL.STWG_CD, 'ODET', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '4', 1, 0), 0) ODET_40,
					DECODE(CLL.STWG_CD, 'ODET', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 0, '4', 0,  '7', 0, 1), 0) ODET_40H,
                    DECODE(CLL.STWG_CD, 'ODET', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '7', 1, 0), 0) ODET_45,
                    
					DECODE(CLL.STWG_CD, 'ODFT', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 1, 0), 0) ODFT_20,
					DECODE(CLL.STWG_CD, 'ODFT', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '4', 1, 0), 0) ODFT_40,
					DECODE(CLL.STWG_CD, 'ODFT', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 0, '4', 0, '7', 0, 1), 0) ODFT_40H,
                    DECODE(CLL.STWG_CD, 'ODFT', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '7', 1, 0), 0) ODFT_45,
                    
                    DECODE(CLL.STWG_CD, 'ODHD', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 1, 0), 0) ODHD_20,
					DECODE(CLL.STWG_CD, 'ODHD', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '4', 1, 0), 0) ODHD_40,
					DECODE(CLL.STWG_CD, 'ODHD', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 0, '4', 0, '7', 0, 1), 0) ODHD_40H,
                    DECODE(CLL.STWG_CD, 'ODHD', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '7', 1, 0), 0) ODHD_45,
                    
					DECODE(CLL.STWG_CD, 'OP', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 1, 0), 0) OP_20,
					DECODE(CLL.STWG_CD, 'OP', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '4', 1, 0), 0) OP_40,
					DECODE(CLL.STWG_CD, 'OP', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 0, '4', 0, '7', 0, 1), 0) OP_40H,
                    DECODE(CLL.STWG_CD, 'OP', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '7', 1, 0), 0) OP_45,
                    
					DECODE(CLL.STWG_CD, 'OT', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 1, 0), 0) OT_20,
					DECODE(CLL.STWG_CD, 'OT', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '4', 1, 0), 0) OT_40,
					DECODE(CLL.STWG_CD, 'OT', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 0, '4', 0, '7', 0, 1), 0) OT_40H,
                    DECODE(CLL.STWG_CD, 'OT', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '7', 1, 0), 0) OT_45,
                    
					DECODE(CLL.STWG_CD, 'OTNO', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 1, 0), 0) OTNO_20,
					DECODE(CLL.STWG_CD, 'OTNO', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '4', 1, 0), 0) OTNO_40,
					DECODE(CLL.STWG_CD, 'OTNO', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 0, '4', 0, '7', 0, 1), 0) OTNO_40H,
                    DECODE(CLL.STWG_CD, 'OTNO', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '7', 1, 0), 0) OTNO_45,

					CASE WHEN CLL.STWG_CD IS NOT NULL AND CLL.STWG_CD = 'PC'
                	THEN DECODE(CLL.STWG_CD, 'PC', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 1, 0), 0)
           			WHEN CLL.STWG_CD IS NULL
                	THEN DECODE(CLL.KR_TML_PRCT_ID, 'P', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 1, 0), 0)
      				END PC_20,      
      				CASE WHEN CLL.STWG_CD IS NOT NULL AND CLL.STWG_CD = 'PC'
                	THEN DECODE(CLL.STWG_CD, 'PC', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '4', 1, 0), 0)
           			WHEN CLL.STWG_CD IS NULL
                	THEN DECODE(CLL.KR_TML_PRCT_ID, 'P', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '4', 1, 0), 0)
      				END PC_40,      
      				CASE WHEN CLL.STWG_CD IS NOT NULL AND CLL.STWG_CD = 'PC'
                	THEN DECODE(CLL.STWG_CD, 'PC', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 0, '4', 0, '7', 0, 1), 0)
           			WHEN CLL.STWG_CD IS NULL
                	THEN DECODE(CLL.KR_TML_PRCT_ID, 'P', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 0, '4', 0, '7', 0, 1), 0)
      				END PC_40H,
					CASE WHEN CLL.STWG_CD IS NOT NULL AND CLL.STWG_CD = 'PC'
                	THEN DECODE(CLL.STWG_CD, 'PC', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '7', 1, 0), 0)
           			WHEN CLL.STWG_CD IS NULL
                	THEN DECODE(CLL.KR_TML_PRCT_ID, 'P', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '7', 1, 0), 0)
      				END PC_45,
                    
					--DECODE(CLL.STWG_CD, 'PC', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 1, 0), 0) PC_20,
					--DECODE(CLL.STWG_CD, 'PC', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '4', 1, 0), 0) PC_40,
					--DECODE(CLL.STWG_CD, 'PC', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '2', 0, '4', 0, '7', 0, 1), 0) PC_40H,
                    --DECODE(CLL.STWG_CD, 'PC', DECODE(SUBSTR(CLL.CNTR_TPSZ_CD, 2, 1), '7', 1, 0), 0) PC_45,
					VPS.CLPT_SEQ CLPT_SEQ
				FROM BKG_BOOKING BK, BKG_VVD BV, VSK_VSL_PORT_SKD VPS, MDM_LOCATION LO, BKG_CSTMS_TML_KR_CLL CLL
				WHERE BK.BKG_NO = BV.BKG_NO
					AND CLL.CNTR_TPSZ_CD NOT IN ('Q2', 'Q4')
					AND BK.BKG_NO = CLL.BKG_NO
					AND BV.VSL_CD = VPS.VSL_CD
					AND BV.SKD_VOY_NO = VPS.SKD_VOY_NO
					AND BV.SKD_DIR_CD = VPS.SKD_DIR_CD
					AND BV.POD_CD = VPS.VPS_PORT_CD
					AND VPS.VPS_PORT_CD = LO.LOC_CD
					AND BV.VSL_CD = SUBSTR(@[in_vvd_cd], 1, 4)
					AND BV.SKD_VOY_NO = SUBSTR(@[in_vvd_cd], 5, 4)
					AND BV.SKD_DIR_CD = SUBSTR(@[in_vvd_cd], 9, 1)
					AND BV.POL_CD = @[in_pol_cd]
					AND SUBSTR(BV.POL_YD_CD, 6, 2) like @[in_pol_yd_cd]||'%'
					AND BK.BKG_STS_CD IN ('F',  'W')
					AND VPS.CLPT_IND_SEQ = '1'
					AND NVL(BK.SPLIT_RSN_CD, ' ') <> 'M'
					AND CLL.CNTR_LIST_NO = BV.VSL_CD||SUBSTR(BV.SKD_VOY_NO, 2, 3)||BV.SKD_DIR_CD||SUBSTR(BV.POL_CD, 3, 3) )
		GROUP BY GUBUN_CD3, BLCK_STWG_CD, CLPT_SEQ
		ORDER BY CLPT_SEQ
#end
)			]]></sql>
			<params>
				<param name="in_vsl_cd" type="12" value="" out="N"/>
				<param name="in_vvd_cd" type="12" value="" out="N"/>
				<param name="in_skd_voy_no" type="12" value="" out="N"/>
				<param name="in_skd_dir_cd" type="12" value="" out="N"/>
				<param name="in_pol_cd" type="12" value="" out="N"/>
				<param name="in_pol_yd_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
