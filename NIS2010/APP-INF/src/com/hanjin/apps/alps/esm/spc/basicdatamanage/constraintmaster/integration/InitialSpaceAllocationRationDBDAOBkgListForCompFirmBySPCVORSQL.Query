<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InitialSpaceAllocationRationDBDAOBkgListForCompFirmBySPCVORSQL">
			<desc><![CDATA[2015.03.02 김성욱 0116 화면, Compulsory Firm 조회화면]]></desc>
			<sql><![CDATA[
SELECT BK.BKG_NO
          ,BK.BKG_STS_CD
          ,'' STANDBY_TYPE   -- HISTORY TABLE
          ,'' STANDBY_REASON -- HISTORY TABLE
          ,BK.ALOC_SVC_CD
          ,BK.BL_NO
          ,BK.SLS_RHQ_CD
          ,BK.BKG_ALOC_TP_CD
          ,COA.SUB_TRD_CD
          ,BK.SLAN_CD               TRNK_SLAN_CD
         , BK.SKD_DIR_CD            TRNK_DIR_CD
         , BK.POL_CD                TRNK_POL
         , BK.POD_CD                TRNK_POD
         , BK.POR_CD                POR_LOC_CD
         , BK.POR_NOD_CD            POR_NOD_CD 
         , (SELECT SCC_CD FROM MDM_LOCATION LOC WHERE LOC.LOC_CD = BK.POR_CD) POR_SCC_CD         
         , BK.POL_CD                POL_LOC_CD
         , BK.POL_NOD_CD            POL_NOD_CD         
         , NVL((SELECT VSL_SLAN_CD FROM VSK_VSL_SKD SKD WHERE SKD.VSL_CD = VVD.VSL_CD AND SKD.SKD_VOY_NO = VVD.SKD_VOY_NO AND SKD.SKD_DIR_CD = VVD.SKD_DIR_CD), 'X') TS_SLAN_CD         
         , NVL(VVD.SKD_DIR_CD, 'X') TS_DIR_CD
         , NVL(VVD.POL_CD,     'X') TS_POL_CD
         , NVL(VVD.POD_CD,     'X') TS_POD_CD         
         , BK.POD_CD                POD_LOC_CD
         , BK.POD_NOD_CD            POD_NOD_CD          
         , BK.DEL_CD                DEL_LOC_CD
         , BK.DEL_NOD_CD            DEL_NOD_CD 
         , (SELECT SCC_CD FROM MDM_LOCATION LOC WHERE LOC.LOC_CD = BK.DEL_CD) DEL_SCC_CD
         , BK.VSL_CD || BK.SKD_VOY_NO || BK.SKD_DIR_CD VVD
         , BK.OB_SLS_OFC_CD 
         , DECODE(BK.DCGO_FLG,'Y','DG', DECODE(BK.RD_CGO_FLG, 'Y', 'RD',''), '') DGRD
         , BK.SC_NO
         , BK.RFA_NO
         , BK.CTRT_CUST_CNT_CD || NVL(LPAD(BK.CTRT_CUST_SEQ,6,'0'),'')     C_CUST
         , BK.AGMT_ACT_CNT_CD  || NVL(LPAD(BK.AGMT_ACT_CUST_SEQ,6,'0'),'') A_CUST
         , CNEE.CUST_CNT_CD    || NVL(LPAD(CNEE.CUST_SEQ,6,'0'),'')        CNEE
         , FWDR.CUST_CNT_CD    || NVL(LPAD(FWDR.CUST_SEQ,6,'0'),'')        FWDR
         , BK.CMDT_CD
         ,(SELECT CMDT.CMDT_NM FROM MDM_COMMODITY CMDT WHERE BK.CMDT_CD = CMDT.CMDT_CD) CMDT_DESC	
         , QTY.CNTR_TPSZ_CD 
         ,(DECODE(SUBSTR(QTY.CNTR_TPSZ_CD, 2, 1), '2', QTY.OP_CNTR_QTY, 0)) FEU
         ,(DECODE(SUBSTR(QTY.CNTR_TPSZ_CD, 2, 1), '2', 0, QTY.OP_CNTR_QTY)) TEU
      FROM COA_MON_VVD COA
         , BKG_BOOKING BK
         , BKG_VVD VVD
         , BKG_QUANTITY QTY
         , BKG_CUSTOMER CNEE
         , BKG_CUSTOMER FWDR
     WHERE 1=1
       AND SUBSTR(COA.SLS_YRMON,1,4)||COA.COST_WK = '201409'
       AND COA.VSL_CD     = BK.VSL_CD
       AND COA.SKD_VOY_NO = BK.SKD_VOY_NO
       AND COA.DIR_CD     = BK.SKD_DIR_CD
       AND BK.BKG_NO      = VVD.BKG_NO
       AND BK.BKG_NO      = QTY.BKG_NO
       AND BK.BKG_NO      = CNEE.BKG_NO(+)
       AND 'C'            = CNEE.BKG_CUST_TP_CD(+) -- S: SHIPPER[물품을 보내는자(송하인)], C:CONSIGNEE[물건을 받는자(수하인)], F:FORWARDER[운송취급인.운송주선인 이라고 하며, 화물을 인수하여 수하인에게 인도할 때까지 일체의 업무를 주선하는 사람]
       AND BK.BKG_NO      = FWDR.BKG_NO(+)
       AND 'F'            = FWDR.BKG_CUST_TP_CD(+)
      AND BK.VSL_CD||BK.SKD_VOY_NO||BK.SKD_DIR_CD = 'COGN0009W'			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
