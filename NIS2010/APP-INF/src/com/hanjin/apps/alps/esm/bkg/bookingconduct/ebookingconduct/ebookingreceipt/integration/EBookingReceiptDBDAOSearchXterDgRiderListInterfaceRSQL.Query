<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EBookingReceiptDBDAOSearchXterDgRiderListInterfaceRSQL">
			<desc><![CDATA[external request 처리를 위해 external rqst의 danger cgo Rider 정보를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT RIDR_TP_CD,
       FILE_NM,
       FILE_SAV_ID,
       BKG_JOIN_FNC(CURSOR(SELECT DCGO_SEQ 
                           FROM BKG_XTER_IMG_STO 
                           WHERE  XTER_SNDR_ID = @[xter_sndr_id]
                           AND XTER_RQST_SEQ = @[xter_rqst_seq]
                           AND XTER_RQST_NO=MAIN_TABLE.XTER_RQST_NO 
                           AND FILE_SAV_ID=MAIN_TABLE.FILE_SAV_ID 
                           AND DCGO_SEQ > 0)) AS DCGO_SEQ,
       'I' AS IBFLAG
FROM (
    SELECT
        MIN(IMG.XTER_RQST_NO) AS XTER_RQST_NO
        ,MIN(IMG.RIDR_TP_CD) AS RIDR_TP_CD
        ,MIN(IMG.FILE_NM) AS FILE_NM
        ,MIN(IMG.DCGO_SEQ) AS CARGO_SEQ
	    ,MIN(IMG_SEQ)  IMG_SEQ
        ,IMG.FILE_SAV_ID AS FILE_SAV_ID
    FROM
        BKG_XTER_IMG_STO IMG, COM_UPLD_FILE UPLD
    WHERE    IMG.FILE_SAV_ID = UPLD.FILE_SAV_ID(+)
      AND IMG.XTER_RQST_NO = @[xter_rqst_no]
      AND IMG.XTER_SNDR_ID = @[xter_sndr_id]
      AND IMG.RIDR_TP_CD= 'D'
      AND IMG.XTER_RQST_SEQ = @[xter_rqst_seq]
    GROUP BY IMG.FILE_SAV_ID
) MAIN_TABLE
ORDER BY IMG_SEQ			]]></sql>
			<params>
				<param name="xter_sndr_id" type="12" value="" out="N"/>
				<param name="xter_rqst_seq" type="12" value="" out="N"/>
				<param name="xter_rqst_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
