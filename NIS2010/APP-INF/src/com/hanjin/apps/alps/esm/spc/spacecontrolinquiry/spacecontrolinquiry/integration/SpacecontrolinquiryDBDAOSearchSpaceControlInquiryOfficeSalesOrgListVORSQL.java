/*=========================================================
*Copyright(c) 2015 CyberLogitec
*@FileName : SpacecontrolinquiryDBDAOSearchSpaceControlInquiryOfficeSalesOrgListVORSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2015.12.17
*@LastModifier : 최성민
*@LastVersion : 1.0
* 2015.12.17 최성민
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esm.spc.spacecontrolinquiry.spacecontrolinquiry.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author CHOI SUNGMIN
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class SpacecontrolinquiryDBDAOSearchSpaceControlInquiryOfficeSalesOrgListVORSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * SearchSpaceControlInquiryOfficeSalesOrgListVO
	  * --2014.08 이전주석 쿼리안으로
	  * 2014.08.04 김시몬 [CHM-201431081] SPC Allocation Control Option 추가 보완
	  * 2015.01.13 신자영 [CHM-201533666] Control Registration 보완요청
	  * 2015.03.03 CHM-201534458 SQM QTA주가 변경 관련 적용 요청
	  * 2015.07.03 이혜민 [CHM-201536633] Control Option management 보완요청 (Fixed Rate관련)
	  * 2015.07.16 Arie [CHM-201537094] MAS CMB 산출 로직 변경 적용 - dem/det 추가 CM = REV+DEM/DET-COST TTL
	  * 2015.09.16 이혜민 선반영 SPC_CONTI_CONV_FNC 태울때 SLAN_CD를 인자로 가져가던것 RLANE_CD로 수정 (RLANE_CD로 가져가야 제대로 펑션을 탐)
	  * </pre>
	  */
	public SpacecontrolinquiryDBDAOSearchSpaceControlInquiryOfficeSalesOrgListVORSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sales_office",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("trade",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vsl_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("subtrade",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("skd_dir_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("skd_voy_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("lane",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esm.spc.spacecontrolinquiry.spacecontrolinquiry.integration").append("\n"); 
		query.append("FileName : SpacecontrolinquiryDBDAOSearchSpaceControlInquiryOfficeSalesOrgListVORSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("WITH PARAM AS ( " ).append("\n"); 
		query.append("    SELECT @[trade]        AS TRD_CD    ," ).append("\n"); 
		query.append("           @[subtrade]     AS SUB_TRD_CD," ).append("\n"); 
		query.append("           @[lane]         AS RLANE_CD  ," ).append("\n"); 
		query.append("           @[vsl_cd]       AS VSL_CD    ," ).append("\n"); 
		query.append("           @[skd_voy_no]   AS SKD_VOY_NO," ).append("\n"); 
		query.append("           @[skd_dir_cd]   AS SKD_DIR_CD," ).append("\n"); 
		query.append("           @[sales_office] AS OFC_CD" ).append("\n"); 
		query.append("      FROM DUAL" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", BASE AS (" ).append("\n"); 
		query.append("    SELECT P.OFC_CD    ," ).append("\n"); 
		query.append("           P.TRD_CD    ," ).append("\n"); 
		query.append("           P.SUB_TRD_CD," ).append("\n"); 
		query.append("           P.RLANE_CD  ," ).append("\n"); 
		query.append("           P.VSL_CD    ," ).append("\n"); 
		query.append("           P.SKD_VOY_NO," ).append("\n"); 
		query.append("           P.SKD_DIR_CD," ).append("\n"); 
		query.append("           SUBSTR(V.SLS_YRMON, 1, 4) AS COST_YR ," ).append("\n"); 
		query.append("           SUBSTR(V.SLS_YRMON, 5, 2) AS COST_MON," ).append("\n"); 
		query.append("           V.COST_WK   ," ).append("\n"); 
		query.append("           NVL(ACO.CTRL_PORT_FLG   , 'N') AS CTRL_PORT," ).append("\n"); 
		query.append("           NVL(ACO.CTRL_WGT_FLG    , 'N') AS CTRL_WGT ," ).append("\n"); 
		query.append("           NVL(ACO.CTRL_40FT_HC_FLG, 'N') AS CTRL_40HC," ).append("\n"); 
		query.append("           NVL(ACO.CTRL_45FT_HC_FLG, 'N') AS CTRL_45HC," ).append("\n"); 
		query.append("           NVL(ACO.CTRL_53FT_FLG,    'N') AS CTRL_53FT," ).append("\n"); 
		query.append("           NVL(ACO.CTRL_RF_FLG     , 'N') AS CTRL_RF," ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("           -- 20140723 추가" ).append("\n"); 
		query.append("           NVL(ACO.CTRL_D2_FLG     , 'N') AS CTRL_D2  ," ).append("\n"); 
		query.append("           NVL(ACO.CTRL_D4_FLG     , 'N') AS CTRL_D4  ," ).append("\n"); 
		query.append("           NVL(ACO.CTRL_RD_FLG     , 'N') AS CTRL_RD  ," ).append("\n"); 
		query.append("           NVL(ACO.CTRL_USA_SVC_MOD_FLG, 'N') AS CTRL_USA  ," ).append("\n"); 
		query.append("           NVL(ACO.CTRL_ACCT_FLG   , 'N')     AS CTRL_ACCT  ," ).append("\n"); 
		query.append("           NVL(ACO.CTRL_FX_RT_FLG  , 'N')     AS CTRL_FX_RT_FLG  ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("           NVL(DECODE(ACO.CTRL_ECC_FLG,'Y','E',DECODE(ACO.CTRL_LOC_FLG,'Y','L','N')),'N') AS CTRL_DEST, -- E = ECC, L = LOCATION" ).append("\n"); 
		query.append("           NVL(ACO.CTRL_DEST_LVL_CD, 'N')     AS CTRL_DEST_LVL  , -- D = BKG_POD, T = BKG_DEL" ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("           V.IOC_CD,    " ).append("\n"); 
		query.append("           V.DIR_CD" ).append("\n"); 
		query.append("           , CASE WHEN V.COST_YRMON >= '201501' " ).append("\n"); 
		query.append("                  THEN CEIL(TO_NUMBER(SUBSTR(V.COST_YRMON, -2))/3)||'Q' " ).append("\n"); 
		query.append("                  ELSE CEIL(TO_NUMBER(DECODE(V.COST_WK,'00','01','53','52',V.COST_WK))/13)||'Q'" ).append("\n"); 
		query.append("             END BSE_QTR_CD --2015.03.04 CHM-201534435 SQM QTA주가 변경 관련 적용 요청" ).append("\n"); 
		query.append("           , SUBSTR(V.COST_YRMON, 1,4) AS BSE_YR" ).append("\n"); 
		query.append("            , V.N1ST_LODG_PORT_ETD_DT AS FL_ETD_DT -- First Loading ETD" ).append("\n"); 
		query.append("      FROM SPC_ALOC_CTRL_OPT ACO," ).append("\n"); 
		query.append("           MAS_MON_VVD       V  ," ).append("\n"); 
		query.append("           PARAM             P" ).append("\n"); 
		query.append("     WHERE V.TRD_CD          = P.TRD_CD" ).append("\n"); 
		query.append("       AND V.RLANE_CD        = P.RLANE_CD" ).append("\n"); 
		query.append("       AND V.VSL_CD          = P.VSL_CD" ).append("\n"); 
		query.append("       AND V.SKD_VOY_NO      = P.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND V.DIR_CD          = P.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND ACO.RLANE_CD  (+) = P.RLANE_CD" ).append("\n"); 
		query.append("       AND ACO.DIR_CD    (+) = P.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND ACO.VSL_CD    (+) = P.VSL_CD" ).append("\n"); 
		query.append("       AND ACO.SKD_VOY_NO(+) = P.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND ACO.SKD_DIR_CD(+) = P.SKD_DIR_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", CTRT_OPT_DTL AS (" ).append("\n"); 
		query.append("-- SPC_ALOC_LANE_CTRL_OPT_DTL 테이블의 계약 정보를 가지고 온다." ).append("\n"); 
		query.append("SELECT DISTINCT  " ).append("\n"); 
		query.append("       A2.TRD_CD" ).append("\n"); 
		query.append("      ,A2.SUB_TRD_CD" ).append("\n"); 
		query.append("      ,A2.RLANE_CD" ).append("\n"); 
		query.append("      ,A2.DIR_CD" ).append("\n"); 
		query.append("      ,A2.ALOC_CTRL_TP_CD" ).append("\n"); 
		query.append("      ,A2.CTRL_LOC_ACCT_CD" ).append("\n"); 
		query.append("      ,A1.FL_ETD_DT" ).append("\n"); 
		query.append("  FROM BASE A1" ).append("\n"); 
		query.append("      ,SPC_ALOC_LANE_CTRL_OPT_DTL A2" ).append("\n"); 
		query.append(" WHERE 1=1" ).append("\n"); 
		query.append("   AND A1.TRD_CD           = A2.TRD_CD" ).append("\n"); 
		query.append("   AND A1.SUB_TRD_CD   	   = A2.SUB_TRD_CD" ).append("\n"); 
		query.append("   AND A1.RLANE_CD         = A2.RLANE_CD" ).append("\n"); 
		query.append("   AND A1.DIR_CD           = A2.DIR_CD" ).append("\n"); 
		query.append("   AND A1.CTRL_ACCT        = 'Y'" ).append("\n"); 
		query.append("   AND A1.CTRL_FX_RT_FLG   = 'Y'" ).append("\n"); 
		query.append("   AND A2.CTRL_FX_RT_FLG   = 'Y'" ).append("\n"); 
		query.append("   AND A2.ALOC_CTRL_TP_CD  = 'F'" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", CTRT_DTL_INFO AS (" ).append("\n"); 
		query.append("    SELECT  " ).append("\n"); 
		query.append("           A5.TRD_CD" ).append("\n"); 
		query.append("          ,A5.SUB_TRD_CD" ).append("\n"); 
		query.append("          ,A5.RLANE_CD" ).append("\n"); 
		query.append("          ,A5.DIR_CD" ).append("\n"); 
		query.append("          ,A5.ALOC_CTRL_TP_CD" ).append("\n"); 
		query.append("          ,A5.CTRL_LOC_ACCT_CD " ).append("\n"); 
		query.append("          ,A1.PROP_NO" ).append("\n"); 
		query.append("          ,A2.AMDT_SEQ" ).append("\n"); 
		query.append("          ,A3.SVC_SCP_CD" ).append("\n"); 
		query.append("          ,A4.GEN_SPCL_RT_TP_CD" ).append("\n"); 
		query.append("          ,A4.CMDT_HDR_SEQ" ).append("\n"); 
		query.append("          ,A2.REAL_CUST_CNT_CD || LPAD(A2.REAL_CUST_SEQ,'6','0') CUST_CD" ).append("\n"); 
		query.append("          ,A4.FX_RT_FLG" ).append("\n"); 
		query.append("          ,A2.EFF_DT" ).append("\n"); 
		query.append("          ,A2.EXP_DT" ).append("\n"); 
		query.append("          ,A2.PROP_STS_CD" ).append("\n"); 
		query.append("      FROM CTRT_OPT_DTL A5" ).append("\n"); 
		query.append("          ,PRI_SP_HDR A1" ).append("\n"); 
		query.append("          ,PRI_SP_MN  A2" ).append("\n"); 
		query.append("          ,PRI_SP_SCP_MN A3" ).append("\n"); 
		query.append("          ,PRI_SP_SCP_RT_CMDT_HDR A4 " ).append("\n"); 
		query.append("     WHERE 1=1" ).append("\n"); 
		query.append("       AND A1.SC_NO             = A5.CTRL_LOC_ACCT_CD" ).append("\n"); 
		query.append("       AND A1.PROP_NO           = A2.PROP_NO" ).append("\n"); 
		query.append("       AND A2.PROP_STS_CD       = 'F' -- A, F, Q" ).append("\n"); 
		query.append("       AND TRUNC(A5.FL_ETD_DT) BETWEEN A2.EFF_DT AND A2.EXP_DT" ).append("\n"); 
		query.append("       AND A2.PROP_NO           = A3.PROP_NO" ).append("\n"); 
		query.append("       AND A2.AMDT_SEQ          = A3.AMDT_SEQ" ).append("\n"); 
		query.append("       AND A3.PROP_NO           = A4.PROP_NO" ).append("\n"); 
		query.append("       AND A3.AMDT_SEQ          = A4.AMDT_SEQ" ).append("\n"); 
		query.append("       AND A3.SVC_SCP_CD        = A4.SVC_SCP_CD" ).append("\n"); 
		query.append("       AND NVL(A4.FX_RT_FLG,'N')= 'Y'" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append(", ALOC_LANE_CTRL_OPT_DTL AS (" ).append("\n"); 
		query.append("SELECT DISTINCT B1.TRD_CD" ).append("\n"); 
		query.append("      ,B1.SUB_TRD_CD" ).append("\n"); 
		query.append("      ,B1.RLANE_CD" ).append("\n"); 
		query.append("      ,B1.DIR_CD" ).append("\n"); 
		query.append("--      ,B1.ALOC_CTRL_TP_CD" ).append("\n"); 
		query.append("--      ,B3.ALOC_CTRL_TP_CD" ).append("\n"); 
		query.append("      ,NVL(B3.ALOC_CTRL_TP_CD, B1.ALOC_CTRL_TP_CD) AS ALOC_CTRL_TP_CD" ).append("\n"); 
		query.append("      ,B1.CTRL_LOC_ACCT_CD" ).append("\n"); 
		query.append("      ,B1.SC_NO" ).append("\n"); 
		query.append("      ,B1.RFA_NO" ).append("\n"); 
		query.append("      ,NVL(B3.ALOC_CTRL_DTL_CD, B1.ALOC_CTRL_DTL_CD) AS ALOC_CTRL_DTL_CD" ).append("\n"); 
		query.append("  FROM " ).append("\n"); 
		query.append("       SPC_ALOC_LANE_CTRL_OPT_DTL B1" ).append("\n"); 
		query.append("      ,BASE B2" ).append("\n"); 
		query.append("      ,(" ).append("\n"); 
		query.append("        -- Actual Account 정보 추출" ).append("\n"); 
		query.append("        SELECT distinct" ).append("\n"); 
		query.append("               A1.TRD_CD" ).append("\n"); 
		query.append("              ,A1.SUB_TRD_CD" ).append("\n"); 
		query.append("              ,A1.RLANE_CD" ).append("\n"); 
		query.append("              ,A1.DIR_CD" ).append("\n"); 
		query.append("              ,'B' AS ALOC_CTRL_TP_CD" ).append("\n"); 
		query.append("              ,A1.ALOC_CTRL_TP_CD AS ORG_ALOC_CTRL_TP_CD-- B : A/Acct, C : Commodity, F : Fixed" ).append("\n"); 
		query.append("              ,A1.CTRL_LOC_ACCT_CD" ).append("\n"); 
		query.append("              ,A1.PROP_NO" ).append("\n"); 
		query.append("              ,A1.AMDT_SEQ" ).append("\n"); 
		query.append("              ,A1.SVC_SCP_CD" ).append("\n"); 
		query.append("              ,A2.CUST_CNT_CD || LPAD(A2.CUST_SEQ,'6','0') AS ALOC_CTRL_DTL_CD" ).append("\n"); 
		query.append("          FROM CTRT_DTL_INFO A1" ).append("\n"); 
		query.append("              ,PRI_SP_SCP_RT_ACT_CUST A2" ).append("\n"); 
		query.append("         WHERE 1=1" ).append("\n"); 
		query.append("           AND A1.PROP_NO           = A2.PROP_NO" ).append("\n"); 
		query.append("           AND A1.AMDT_SEQ          = A2.AMDT_SEQ" ).append("\n"); 
		query.append("           AND A1.SVC_SCP_CD        = A2.SVC_SCP_CD" ).append("\n"); 
		query.append("           AND A1.GEN_SPCL_RT_TP_CD = A2.GEN_SPCL_RT_TP_CD" ).append("\n"); 
		query.append("           AND A1.CMDT_HDR_SEQ      = A2.CMDT_HDR_SEQ" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        -- CMDT 정보 추출" ).append("\n"); 
		query.append("        SELECT distinct" ).append("\n"); 
		query.append("               A1.TRD_CD" ).append("\n"); 
		query.append("              ,A1.SUB_TRD_CD" ).append("\n"); 
		query.append("              ,A1.RLANE_CD" ).append("\n"); 
		query.append("              ,A1.DIR_CD" ).append("\n"); 
		query.append("              ,'C' AS ALOC_CTRL_TP_CD" ).append("\n"); 
		query.append("              ,A1.ALOC_CTRL_TP_CD AS ORG_ALOC_CTRL_TP_CD -- B : A/Acct, C : Commodity, F : Fixed" ).append("\n"); 
		query.append("              ,A1.CTRL_LOC_ACCT_CD" ).append("\n"); 
		query.append("              ,A1.PROP_NO" ).append("\n"); 
		query.append("              ,A1.AMDT_SEQ" ).append("\n"); 
		query.append("              ,A1.SVC_SCP_CD" ).append("\n"); 
		query.append("              ,DECODE(A2.PRC_CMDT_TP_CD,'C', A2.PRC_CMDT_DEF_CD, 'G', A4.PRC_CMDT_DEF_CD) AS ALOC_CTRL_DTL_CD" ).append("\n"); 
		query.append("          FROM CTRT_DTL_INFO A1" ).append("\n"); 
		query.append("              ,PRI_SP_SCP_RT_CMDT     A2" ).append("\n"); 
		query.append("              ,PRI_SP_SCP_GRP_CMDT    A3" ).append("\n"); 
		query.append("              ,PRI_SP_SCP_GRP_CMDT_DTL A4  " ).append("\n"); 
		query.append("         WHERE 1=1" ).append("\n"); 
		query.append("           AND A1.PROP_NO           = A2.PROP_NO" ).append("\n"); 
		query.append("           AND A1.AMDT_SEQ          = A2.AMDT_SEQ" ).append("\n"); 
		query.append("           AND A1.SVC_SCP_CD        = A2.SVC_SCP_CD" ).append("\n"); 
		query.append("           AND A1.GEN_SPCL_RT_TP_CD = A2.GEN_SPCL_RT_TP_CD" ).append("\n"); 
		query.append("           AND A1.CMDT_HDR_SEQ      = A2.CMDT_HDR_SEQ" ).append("\n"); 
		query.append("           AND A2.SRC_INFO_CD       <> 'AD'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("           AND A2.PROP_NO           = A3.PROP_NO(+)" ).append("\n"); 
		query.append("           AND A2.AMDT_SEQ          = A3.AMDT_SEQ(+)" ).append("\n"); 
		query.append("           AND A2.SVC_SCP_CD        = A3.SVC_SCP_CD(+)" ).append("\n"); 
		query.append("           AND A2.PRC_CMDT_DEF_CD   = A3.PRC_GRP_CMDT_CD(+)" ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("           AND A3.PROP_NO           = A4.PROP_NO(+)" ).append("\n"); 
		query.append("           AND A3.AMDT_SEQ          = A4.AMDT_SEQ(+)" ).append("\n"); 
		query.append("           AND A3.SVC_SCP_CD        = A4.SVC_SCP_CD(+)" ).append("\n"); 
		query.append("           AND A3.GRP_CMDT_SEQ      = A4.GRP_CMDT_SEQ(+)   " ).append("\n"); 
		query.append("           AND A4.SRC_INFO_CD(+)    <> 'AD'" ).append("\n"); 
		query.append("         GROUP BY A1.TRD_CD" ).append("\n"); 
		query.append("              ,A1.SUB_TRD_CD" ).append("\n"); 
		query.append("              ,A1.RLANE_CD" ).append("\n"); 
		query.append("              ,A1.DIR_CD" ).append("\n"); 
		query.append("              ,A1.ALOC_CTRL_TP_CD" ).append("\n"); 
		query.append("              ,A1.CTRL_LOC_ACCT_CD" ).append("\n"); 
		query.append("              ,A1.PROP_NO" ).append("\n"); 
		query.append("              ,A1.AMDT_SEQ" ).append("\n"); 
		query.append("              ,A1.SVC_SCP_CD" ).append("\n"); 
		query.append("              ,DECODE(A2.PRC_CMDT_TP_CD,'C', A2.PRC_CMDT_DEF_CD, 'G', A4.PRC_CMDT_DEF_CD)       " ).append("\n"); 
		query.append("       ) B3" ).append("\n"); 
		query.append(" WHERE 1=1" ).append("\n"); 
		query.append("   AND B2.TRD_CD           = B1.TRD_CD" ).append("\n"); 
		query.append("   AND B2.SUB_TRD_CD       = B1.SUB_TRD_CD" ).append("\n"); 
		query.append("   AND B2.RLANE_CD         = B1.RLANE_CD" ).append("\n"); 
		query.append("   AND B2.DIR_CD           = B1.DIR_CD" ).append("\n"); 
		query.append("   AND B1.TRD_CD           = B3.TRD_CD(+)" ).append("\n"); 
		query.append("   AND B1.SUB_TRD_CD       = B3.SUB_TRD_CD(+)" ).append("\n"); 
		query.append("   AND B1.RLANE_CD         = B3.RLANE_CD(+)" ).append("\n"); 
		query.append("   AND B1.DIR_CD           = B3.DIR_CD(+)" ).append("\n"); 
		query.append("   AND B1.ALOC_CTRL_TP_CD  = B3.ORG_ALOC_CTRL_TP_CD(+)" ).append("\n"); 
		query.append("   AND B1.CTRL_LOC_ACCT_CD = B3.CTRL_LOC_ACCT_CD(+)" ).append("\n"); 
		query.append("    )" ).append("\n"); 
		query.append(", WK_CMB AS ( -- 20140723 수정필요" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    SELECT RNUM," ).append("\n"); 
		query.append("           COST_YRWK," ).append("\n"); 
		query.append("           TS_FLG," ).append("\n"); 
		query.append("           IOC_CD,           " ).append("\n"); 
		query.append("           OFC_CD," ).append("\n"); 
		query.append("           NVL(USA_BKG_MOD_CD,' ') AS USA_BKG_MOD_CD," ).append("\n"); 
		query.append("           NVL(CUST_ACCT,' ') AS CUST_ACCT," ).append("\n"); 
		query.append("           NVL(POL_YD_CD,' ') AS POL_YD_CD," ).append("\n"); 
		query.append("           NVL(POD_YD_CD,' ') AS POD_YD_CD," ).append("\n"); 
		query.append("           NVL(DEST_LOC_CD,' ') AS DEST_LOC_CD, " ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("           SUM(BKG_REV)          AS BKG_REV,NVL(SUM(DMDT_COM_AMT),0) AS DMDT_COM_AMT," ).append("\n"); 
		query.append("           SUM(ESTM_CM_COST_AMT) AS ESTM_CM_COST_AMT," ).append("\n"); 
		query.append("           SUM(BKG_TTL_QTY)      AS BKG_TTL_QTY," ).append("\n"); 
		query.append("           SUM(USD_BKG_TTL_WGT)  AS BKG_TTL_WGT" ).append("\n"); 
		query.append("      FROM (" ).append("\n"); 
		query.append("            SELECT T.RNUM," ).append("\n"); 
		query.append("                   BAR.COST_YRWK," ).append("\n"); 
		query.append("                   BAR.SLS_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("                   BAR.TS_FLG," ).append("\n"); 
		query.append("                   BAR.IOC_CD," ).append("\n"); 
		query.append("                   BAR.POL_YD_CD," ).append("\n"); 
		query.append("                   BAR.POD_YD_CD," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   CASE WHEN M.CTRL_USA = 'Y' THEN" ).append("\n"); 
		query.append("                        --DECODE(BAR.USA_BKG_MOD_CD,'OTH','OTHERS',BAR.USA_BKG_MOD_CD) -- SPC_BKG_AVG_REV.LOCAL/IPI" ).append("\n"); 
		query.append("                        BAR.USA_BKG_MOD_CD -- SPC_BKG_AVG_REV.LOCAL/IPI" ).append("\n"); 
		query.append("                   ELSE" ).append("\n"); 
		query.append("                        'OTH'" ).append("\n"); 
		query.append("                   --     --'OTHERS'" ).append("\n"); 
		query.append("                   END AS USA_BKG_MOD_CD," ).append("\n"); 
		query.append("                                      " ).append("\n"); 
		query.append("                   CASE WHEN M.CTRL_DEST <> 'N' THEN	" ).append("\n"); 
		query.append("                        NVL((SELECT D.CTRL_LOC_ACCT_CD" ).append("\n"); 
		query.append("                               FROM SPC_ALOC_LANE_CTRL_OPT_DTL D," ).append("\n"); 
		query.append("                                    MDM_LOCATION               ML1," ).append("\n"); 
		query.append("                                    MDM_LOCATION               ML2," ).append("\n"); 
		query.append("                                    MDM_EQ_ORZ_CHT             ME1," ).append("\n"); 
		query.append("                                    MDM_EQ_ORZ_CHT             ME2" ).append("\n"); 
		query.append("                              WHERE P.RLANE_CD         = D.RLANE_CD" ).append("\n"); 
		query.append("                                AND SPC_GET_REP_TRD_FNC(P.RLANE_CD)     = D.TRD_CD" ).append("\n"); 
		query.append("                                AND SPC_GET_REP_SUB_TRD_FNC(P.RLANE_CD) = D.SUB_TRD_CD" ).append("\n"); 
		query.append("                                AND P.SKD_DIR_CD       = D.DIR_CD " ).append("\n"); 
		query.append("                                AND D.ALOC_CTRL_TP_CD  = M.CTRL_DEST" ).append("\n"); 
		query.append("                                AND ML1.LOC_CD         = BAR.BKG_POD_CD" ).append("\n"); 
		query.append("                                AND ME1.SCC_CD         = ML1.SCC_CD" ).append("\n"); 
		query.append("                                AND ML2.LOC_CD         = BAR.BKG_DEL_CD" ).append("\n"); 
		query.append("                                AND ME2.SCC_CD         = ML2.SCC_CD" ).append("\n"); 
		query.append("                                AND D.CTRL_LOC_ACCT_CD = DECODE(M.CTRL_DEST_LVL,'T',DECODE(M.CTRL_DEST,'E',ME2.ECC_CD,'L',BAR.BKG_DEL_CD),DECODE(M.CTRL_DEST,'E',ME1.ECC_CD,'L',BAR.BKG_POD_CD))" ).append("\n"); 
		query.append("                           ),'XXXXX')                           " ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   ELSE" ).append("\n"); 
		query.append("                        'XXXXX'" ).append("\n"); 
		query.append("                   END AS DEST_LOC_CD," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   -- 20140801 변경" ).append("\n"); 
		query.append("                   CASE WHEN M.CTRL_ACCT = 'Y' THEN" ).append("\n"); 
		query.append("                        NVL((SELECT D.CTRL_LOC_ACCT_CD" ).append("\n"); 
		query.append("                               FROM SPC_ALOC_LANE_CTRL_OPT_DTL D" ).append("\n"); 
		query.append("                              WHERE P.RLANE_CD                           = D.RLANE_CD" ).append("\n"); 
		query.append("                                AND SPC_GET_REP_TRD_FNC(P.RLANE_CD)      = D.TRD_CD" ).append("\n"); 
		query.append("                                AND SPC_GET_REP_SUB_TRD_FNC(P.RLANE_CD)  = D.SUB_TRD_CD" ).append("\n"); 
		query.append("                                AND P.SKD_DIR_CD                         = D.DIR_CD " ).append("\n"); 
		query.append("                                AND D.ALOC_CTRL_TP_CD                    = 'A'  " ).append("\n"); 
		query.append("                                AND D.CTRL_LOC_ACCT_CD  = BAR.CUST_CNT_CD ||LPAD(BAR.CUST_SEQ,6,'0')                                        " ).append("\n"); 
		query.append("                           ),'XXX999999')   " ).append("\n"); 
		query.append("                   ELSE" ).append("\n"); 
		query.append("                        'XXX999999'" ).append("\n"); 
		query.append("                   END AS CUST_ACCT," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   BAR.BKG_REV, BAR.DMDT_COM_AMT," ).append("\n"); 
		query.append("                   BAR.ESTM_CM_COST_AMT," ).append("\n"); 
		query.append("                   BAR.BKG_TTL_QTY," ).append("\n"); 
		query.append("                   BAR.USD_BKG_TTL_WGT" ).append("\n"); 
		query.append("              FROM SPC_BKG_AVG_REV   BAR," ).append("\n"); 
		query.append("                   (SELECT DISTINCT DENSE_RANK() OVER (ORDER BY COST_YRWK) AS RNUM," ).append("\n"); 
		query.append("                           COST_YRWK" ).append("\n"); 
		query.append("                      FROM SPC_BKG_AVG_REV" ).append("\n"); 
		query.append("                   ) T," ).append("\n"); 
		query.append("                   PARAM            P," ).append("\n"); 
		query.append("                   (SELECT DIR_CD," ).append("\n"); 
		query.append("                           CTRL_USA ," ).append("\n"); 
		query.append("                           CTRL_ACCT," ).append("\n"); 
		query.append("                           CTRL_DEST,    -- E = ECC, L = LOCATION" ).append("\n"); 
		query.append("                           CTRL_DEST_LVL -- D = BKG_POD, T = BKG_DEL  " ).append("\n"); 
		query.append("                      FROM BASE" ).append("\n"); 
		query.append("                   ) M --20140801" ).append("\n"); 
		query.append("             WHERE BAR.COST_YRWK  = T.COST_YRWK" ).append("\n"); 
		query.append("               AND BAR.OFC_KND_CD = '4'" ).append("\n"); 
		query.append("               AND BAR.SLS_OFC_CD = P.OFC_CD" ).append("\n"); 
		query.append("               AND BAR.TRD_CD     = P.TRD_CD" ).append("\n"); 
		query.append("               AND BAR.RLANE_CD   = P.RLANE_CD" ).append("\n"); 
		query.append("               AND BAR.DIR_CD     = P.SKD_DIR_CD" ).append("\n"); 
		query.append("               AND BAR.POD_YD_CD <> '00000' -- 20140801 변경 (CUST_CNT_CD <> '00' 에서)" ).append("\n"); 
		query.append("               AND BAR.DIR_CD     = M.DIR_CD --20140801" ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append("     GROUP BY GROUPING SETS (" ).append("\n"); 
		query.append("                             (RNUM,COST_YRWK,TS_FLG,IOC_CD,OFC_CD,USA_BKG_MOD_CD, CUST_ACCT,POL_YD_CD,POD_YD_CD,DEST_LOC_CD)," ).append("\n"); 
		query.append("                             (RNUM,COST_YRWK,TS_FLG,IOC_CD,OFC_CD,USA_BKG_MOD_CD, CUST_ACCT,POL_YD_CD,POD_YD_CD)," ).append("\n"); 
		query.append("                             (RNUM,COST_YRWK,TS_FLG,IOC_CD,OFC_CD,USA_BKG_MOD_CD, CUST_ACCT,POL_YD_CD)," ).append("\n"); 
		query.append("                             (RNUM,COST_YRWK,TS_FLG,IOC_CD,OFC_CD,USA_BKG_MOD_CD, CUST_ACCT)," ).append("\n"); 
		query.append("                             (RNUM,COST_YRWK,TS_FLG,IOC_CD,OFC_CD,USA_BKG_MOD_CD)," ).append("\n"); 
		query.append("                             (RNUM,COST_YRWK,TS_FLG,IOC_CD,OFC_CD)" ).append("\n"); 
		query.append("                            )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT Z.IOC_TS_CD," ).append("\n"); 
		query.append("       Z.OFC_CD," ).append("\n"); 
		query.append("       DECODE(Z.USA_BKG_MOD_CD,'OTH','OTHERS',Z.USA_BKG_MOD_CD) AS USA_BKG_MOD_CD," ).append("\n"); 
		query.append("       -- 2014.12.01 ACCT/CMDT 추가" ).append("\n"); 
		query.append("       CUST_ACCT1        AS CUST_ACCT, " ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       --CASE WHEN CUST_ACCT1 = 'XXX999999' THEN" ).append("\n"); 
		query.append("       --      'OTHERS'" ).append("\n"); 
		query.append("       --     WHEN LENGTH(CUST_ACCT1) = 8 THEN" ).append("\n"); 
		query.append("       --     (" ).append("\n"); 
		query.append("       --       SELECT CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("       --         FROM MDM_CUSTOMER" ).append("\n"); 
		query.append("       --        WHERE CUST_CNT_CD = SUBSTR(CUST_ACCT1,1,2)" ).append("\n"); 
		query.append("       --          AND CUST_SEQ    = SUBSTR(CUST_ACCT1,3,6)" ).append("\n"); 
		query.append("       --      )" ).append("\n"); 
		query.append("       --ELSE" ).append("\n"); 
		query.append("       --      CUST_ACCT1" ).append("\n"); 
		query.append("       --END AS CUST_LGL_ENG_NM, " ).append("\n"); 
		query.append("              -- 2015.01.13 변경      " ).append("\n"); 
		query.append("       CASE   WHEN CUST_ACCT1 = 'XXX999999' THEN 'OTHERS'           " ).append("\n"); 
		query.append("              -- 2014.12.03 기존의 CUSTOMER CODE는 8자리 이외의 CASE는 모두 계약으로 판단하여 NAME에 CODE사용" ).append("\n"); 
		query.append("              -- 2014.12.12 계약 no길이 혼재로인해 변경. 앞자리 2개가 알파벳인 경우 CUSTOMER/그 외엔 계약" ).append("\n"); 
		query.append("              WHEN LENGTH(TRIM(TRANSLATE(CUST_ACCT1, '1234567890', '          '))) = 2 THEN " ).append("\n"); 
		query.append("              (SELECT CUST_LGL_ENG_NM " ).append("\n"); 
		query.append("                 FROM MDM_CUSTOMER" ).append("\n"); 
		query.append("                WHERE CUST_CNT_CD||LPAD(CUST_SEQ, 6, '0') = CUST_ACCT1 ) " ).append("\n"); 
		query.append("              ELSE " ).append("\n"); 
		query.append("              -- 2014.12.17 계약의 경우 최신 CONTRACTOR이름 보여짐" ).append("\n"); 
		query.append("              NVL((" ).append("\n"); 
		query.append("              -- SC CASE NAME " ).append("\n"); 
		query.append("                SELECT (SELECT CUST_LGL_ENG_NM " ).append("\n"); 
		query.append("                        FROM MDM_CUSTOMER A " ).append("\n"); 
		query.append("                        WHERE A.CUST_CNT_CD = AC.CUST_CNT_CD " ).append("\n"); 
		query.append("                        AND A.CUST_SEQ = AC.CUST_SEQ ) CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("                FROM    PRI_SP_HDR    HD  ," ).append("\n"); 
		query.append("                        PRI_SP_MN     MN  ," ).append("\n"); 
		query.append("                        PRI_SP_CTRT_PTY AC" ).append("\n"); 
		query.append("                WHERE   HD.SC_NO        = CUST_ACCT1" ).append("\n"); 
		query.append("                AND     MN.PROP_NO      = HD.PROP_NO" ).append("\n"); 
		query.append("                AND     MN.PROP_STS_CD  = 'F'    -- Filed만 B/L적용 가능 " ).append("\n"); 
		query.append("                AND     AC.PROP_NO      = MN.PROP_NO" ).append("\n"); 
		query.append("                AND     AC.AMDT_SEQ     = MN.AMDT_SEQ" ).append("\n"); 
		query.append("                AND     AC.PRC_CTRT_PTY_TP_CD = 'C'" ).append("\n"); 
		query.append("                AND     AC.AMDT_SEQ   = (SELECT MAX(AMDT_SEQ)" ).append("\n"); 
		query.append("                                           FROM PRI_SP_MN N_MN" ).append("\n"); 
		query.append("                                          WHERE N_MN.PROP_NO = HD.PROP_NO" ).append("\n"); 
		query.append("					    AND	N_MN.PROP_STS_CD  = 'F'" ).append("\n"); 
		query.append("                                        )" ).append("\n"); 
		query.append("                AND     ROWNUM = 1 -- multi인 경우 에러 발생하므로 미리 막음" ).append("\n"); 
		query.append("                UNION ALL" ).append("\n"); 
		query.append("                SELECT  (SELECT CUST_LGL_ENG_NM " ).append("\n"); 
		query.append("                        FROM MDM_CUSTOMER A " ).append("\n"); 
		query.append("                        WHERE A.CUST_CNT_CD = MN.CTRT_CUST_CNT_CD " ).append("\n"); 
		query.append("                        AND A.CUST_SEQ = MN.CTRT_CUST_SEQ ) CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("                FROM    PRI_RP_HDR    HD  ," ).append("\n"); 
		query.append("                        PRI_RP_MN     MN  " ).append("\n"); 
		query.append("                WHERE   HD.RFA_NO        = CUST_ACCT1" ).append("\n"); 
		query.append("                AND     MN.PROP_NO       = HD.PROP_NO" ).append("\n"); 
		query.append("                AND     MN.PROP_STS_CD   = 'A'        /*상수*/" ).append("\n"); 
		query.append("                AND     MN.AMDT_SEQ      = (SELECT MAX(AMDT_SEQ)" ).append("\n"); 
		query.append("                                              FROM PRI_RP_MN N_MN" ).append("\n"); 
		query.append("                                             WHERE N_MN.PROP_NO = HD.PROP_NO" ).append("\n"); 
		query.append("                                               AND N_MN.PROP_STS_CD   = 'A'  )" ).append("\n"); 
		query.append("                AND     ROWNUM = 1" ).append("\n"); 
		query.append("              ), CUST_ACCT1)   " ).append("\n"); 
		query.append("            END AS CUST_LGL_ENG_NM,   " ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       Z.POL_CD," ).append("\n"); 
		query.append("       Z.POD_CD," ).append("\n"); 
		query.append("       DECODE(Z.DEST_LOC_CD1,'XXXXX','OTHERS',Z.DEST_LOC_CD1)    AS DEST_LOC_CD," ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       Z.BKG_QTA," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("       (" ).append("\n"); 
		query.append("          SELECT ROUND((SUM(BAR.BKG_REV) + SUM(BAR.DMDT_COM_AMT) - SUM(BAR.ESTM_CM_COST_AMT)) / DECODE(SUM(BAR.BKG_TTL_QTY), 0, 1, SUM(BAR.BKG_TTL_QTY)))" ).append("\n"); 
		query.append("            FROM WK_CMB BAR" ).append("\n"); 
		query.append("           WHERE BAR.OFC_CD         = Z.OFC_CD" ).append("\n"); 
		query.append("             AND BAR.POL_YD_CD      = SUBSTR(NVL(Z.POL_CD,' '),1,5)" ).append("\n"); 
		query.append("             AND BAR.POD_YD_CD      = SUBSTR(NVL(Z.POD_CD,' '),1,5) " ).append("\n"); 
		query.append("             -- 20140728 추가(S)" ).append("\n"); 
		query.append("             AND BAR.USA_BKG_MOD_CD = NVL(Z.USA_BKG_MOD_CD,' ')" ).append("\n"); 
		query.append("             AND BAR.CUST_ACCT      = NVL(Z.CUST_ACCT1     ,' ')" ).append("\n"); 
		query.append("             AND BAR.DEST_LOC_CD    = NVL(Z.DEST_LOC_CD1   ,' ') " ).append("\n"); 
		query.append("       ) AS CMB," ).append("\n"); 
		query.append("       (" ).append("\n"); 
		query.append("          SELECT ROUND((SUM(BAR.BKG_REV) + SUM(BAR.DMDT_COM_AMT) - SUM(BAR.ESTM_CM_COST_AMT)) / DECODE(SUM(BAR.BKG_TTL_WGT), 0, 1, SUM(BAR.BKG_TTL_WGT)))" ).append("\n"); 
		query.append("            FROM WK_CMB BAR" ).append("\n"); 
		query.append("           WHERE BAR.OFC_CD         = Z.OFC_CD" ).append("\n"); 
		query.append("             AND BAR.POL_YD_CD      = SUBSTR(NVL(Z.POL_CD,' '),1,5)" ).append("\n"); 
		query.append("             AND BAR.POD_YD_CD      = SUBSTR(NVL(Z.POD_CD,' '),1,5) " ).append("\n"); 
		query.append("             -- 20140728 추가(S)" ).append("\n"); 
		query.append("             AND BAR.USA_BKG_MOD_CD = NVL(Z.USA_BKG_MOD_CD,' ')" ).append("\n"); 
		query.append("             AND BAR.CUST_ACCT      = NVL(Z.CUST_ACCT1     ,' ')" ).append("\n"); 
		query.append("             AND BAR.DEST_LOC_CD    = NVL(Z.DEST_LOC_CD1   ,' ') " ).append("\n"); 
		query.append("       ) AS CMB_WGT," ).append("\n"); 
		query.append("       -- 주차별 CMB" ).append("\n"); 
		query.append("       (" ).append("\n"); 
		query.append("          SELECT ROUND((SUM(BAR.BKG_REV) + SUM(BAR.DMDT_COM_AMT) - SUM(BAR.ESTM_CM_COST_AMT)) / DECODE(SUM(BAR.BKG_TTL_QTY), 0, 1, SUM(BAR.BKG_TTL_QTY)))" ).append("\n"); 
		query.append("            FROM WK_CMB BAR" ).append("\n"); 
		query.append("           WHERE BAR.OFC_CD         = Z.OFC_CD" ).append("\n"); 
		query.append("             AND BAR.POL_YD_CD      = SUBSTR(NVL(Z.POL_CD,' '),1,5)" ).append("\n"); 
		query.append("             AND BAR.POD_YD_CD      = SUBSTR(NVL(Z.POD_CD,' '),1,5) " ).append("\n"); 
		query.append("             -- 20140728 추가(S)" ).append("\n"); 
		query.append("             AND BAR.USA_BKG_MOD_CD = NVL(Z.USA_BKG_MOD_CD,' ')" ).append("\n"); 
		query.append("             AND BAR.CUST_ACCT      = NVL(Z.CUST_ACCT1     ,' ')" ).append("\n"); 
		query.append("             AND BAR.DEST_LOC_CD    = NVL(Z.DEST_LOC_CD1   ,' ') " ).append("\n"); 
		query.append("             AND BAR.RNUM = 1" ).append("\n"); 
		query.append("       ) AS CMB1," ).append("\n"); 
		query.append("       (" ).append("\n"); 
		query.append("          SELECT ROUND((SUM(BAR.BKG_REV) + SUM(BAR.DMDT_COM_AMT) - SUM(BAR.ESTM_CM_COST_AMT)) / DECODE(SUM(BAR.BKG_TTL_WGT), 0, 1, SUM(BAR.BKG_TTL_WGT)))" ).append("\n"); 
		query.append("            FROM WK_CMB BAR" ).append("\n"); 
		query.append("           WHERE BAR.OFC_CD         = Z.OFC_CD" ).append("\n"); 
		query.append("             AND BAR.POL_YD_CD      = SUBSTR(NVL(Z.POL_CD,' '),1,5)" ).append("\n"); 
		query.append("             AND BAR.POD_YD_CD      = SUBSTR(NVL(Z.POD_CD,' '),1,5) " ).append("\n"); 
		query.append("             -- 20140728 추가(S)" ).append("\n"); 
		query.append("             AND BAR.USA_BKG_MOD_CD = NVL(Z.USA_BKG_MOD_CD,' ')" ).append("\n"); 
		query.append("             AND BAR.CUST_ACCT      = NVL(Z.CUST_ACCT1     ,' ')" ).append("\n"); 
		query.append("             AND BAR.DEST_LOC_CD    = NVL(Z.DEST_LOC_CD1   ,' ') " ).append("\n"); 
		query.append("             AND BAR.RNUM = 1" ).append("\n"); 
		query.append("       ) AS CMB_WGT1," ).append("\n"); 
		query.append("       (" ).append("\n"); 
		query.append("          SELECT ROUND((SUM(BAR.BKG_REV) + SUM(BAR.DMDT_COM_AMT) - SUM(BAR.ESTM_CM_COST_AMT)) / DECODE(SUM(BAR.BKG_TTL_QTY), 0, 1, SUM(BAR.BKG_TTL_QTY)))" ).append("\n"); 
		query.append("            FROM WK_CMB BAR" ).append("\n"); 
		query.append("           WHERE BAR.OFC_CD         = Z.OFC_CD" ).append("\n"); 
		query.append("             AND BAR.POL_YD_CD      = SUBSTR(NVL(Z.POL_CD,' '),1,5)" ).append("\n"); 
		query.append("             AND BAR.POD_YD_CD      = SUBSTR(NVL(Z.POD_CD,' '),1,5) " ).append("\n"); 
		query.append("             -- 20140728 추가(S)" ).append("\n"); 
		query.append("             AND BAR.USA_BKG_MOD_CD = NVL(Z.USA_BKG_MOD_CD,' ')" ).append("\n"); 
		query.append("             AND BAR.CUST_ACCT      = NVL(Z.CUST_ACCT1     ,' ')" ).append("\n"); 
		query.append("             AND BAR.DEST_LOC_CD    = NVL(Z.DEST_LOC_CD1   ,' ') " ).append("\n"); 
		query.append("             AND BAR.RNUM = 2" ).append("\n"); 
		query.append("       ) AS CMB2," ).append("\n"); 
		query.append("       (" ).append("\n"); 
		query.append("          SELECT ROUND((SUM(BAR.BKG_REV) + SUM(BAR.DMDT_COM_AMT) - SUM(BAR.ESTM_CM_COST_AMT)) / DECODE(SUM(BAR.BKG_TTL_WGT), 0, 1, SUM(BAR.BKG_TTL_WGT)))" ).append("\n"); 
		query.append("            FROM WK_CMB BAR" ).append("\n"); 
		query.append("           WHERE BAR.OFC_CD         = Z.OFC_CD" ).append("\n"); 
		query.append("             AND BAR.POL_YD_CD      = SUBSTR(NVL(Z.POL_CD,' '),1,5)" ).append("\n"); 
		query.append("             AND BAR.POD_YD_CD      = SUBSTR(NVL(Z.POD_CD,' '),1,5) " ).append("\n"); 
		query.append("             -- 20140728 추가(S)" ).append("\n"); 
		query.append("             AND BAR.USA_BKG_MOD_CD = NVL(Z.USA_BKG_MOD_CD,' ')" ).append("\n"); 
		query.append("             AND BAR.CUST_ACCT      = NVL(Z.CUST_ACCT1     ,' ')" ).append("\n"); 
		query.append("             AND BAR.DEST_LOC_CD    = NVL(Z.DEST_LOC_CD1   ,' ') " ).append("\n"); 
		query.append("             AND BAR.RNUM = 2" ).append("\n"); 
		query.append("       ) AS CMB_WGT2," ).append("\n"); 
		query.append("       (" ).append("\n"); 
		query.append("          SELECT ROUND((SUM(BAR.BKG_REV) + SUM(BAR.DMDT_COM_AMT) - SUM(BAR.ESTM_CM_COST_AMT)) / DECODE(SUM(BAR.BKG_TTL_QTY), 0, 1, SUM(BAR.BKG_TTL_QTY)))" ).append("\n"); 
		query.append("            FROM WK_CMB BAR" ).append("\n"); 
		query.append("           WHERE BAR.OFC_CD         = Z.OFC_CD" ).append("\n"); 
		query.append("             AND BAR.POL_YD_CD      = SUBSTR(NVL(Z.POL_CD,' '),1,5)" ).append("\n"); 
		query.append("             AND BAR.POD_YD_CD      = SUBSTR(NVL(Z.POD_CD,' '),1,5) " ).append("\n"); 
		query.append("             -- 20140728 추가(S)" ).append("\n"); 
		query.append("             AND BAR.USA_BKG_MOD_CD = NVL(Z.USA_BKG_MOD_CD,' ')" ).append("\n"); 
		query.append("             AND BAR.CUST_ACCT      = NVL(Z.CUST_ACCT1     ,' ')" ).append("\n"); 
		query.append("             AND BAR.DEST_LOC_CD    = NVL(Z.DEST_LOC_CD1   ,' ') " ).append("\n"); 
		query.append("             AND BAR.RNUM = 3" ).append("\n"); 
		query.append("       ) AS CMB3," ).append("\n"); 
		query.append("       (" ).append("\n"); 
		query.append("          SELECT ROUND((SUM(BAR.BKG_REV) + SUM(BAR.DMDT_COM_AMT) - SUM(BAR.ESTM_CM_COST_AMT)) / DECODE(SUM(BAR.BKG_TTL_WGT), 0, 1, SUM(BAR.BKG_TTL_WGT)))" ).append("\n"); 
		query.append("            FROM WK_CMB BAR" ).append("\n"); 
		query.append("           WHERE BAR.OFC_CD         = Z.OFC_CD" ).append("\n"); 
		query.append("             AND BAR.POL_YD_CD      = SUBSTR(NVL(Z.POL_CD,' '),1,5)" ).append("\n"); 
		query.append("             AND BAR.POD_YD_CD      = SUBSTR(NVL(Z.POD_CD,' '),1,5) " ).append("\n"); 
		query.append("             -- 20140728 추가(S)" ).append("\n"); 
		query.append("             AND BAR.USA_BKG_MOD_CD = NVL(Z.USA_BKG_MOD_CD,' ')" ).append("\n"); 
		query.append("             AND BAR.CUST_ACCT      = NVL(Z.CUST_ACCT1     ,' ')" ).append("\n"); 
		query.append("             AND BAR.DEST_LOC_CD    = NVL(Z.DEST_LOC_CD1   ,' ') " ).append("\n"); 
		query.append("             AND BAR.RNUM = 3" ).append("\n"); 
		query.append("       ) AS CMB_WGT3," ).append("\n"); 
		query.append("       (" ).append("\n"); 
		query.append("          SELECT ROUND((SUM(BAR.BKG_REV) + SUM(BAR.DMDT_COM_AMT) - SUM(BAR.ESTM_CM_COST_AMT)) / DECODE(SUM(BAR.BKG_TTL_QTY), 0, 1, SUM(BAR.BKG_TTL_QTY)))" ).append("\n"); 
		query.append("            FROM WK_CMB BAR" ).append("\n"); 
		query.append("           WHERE BAR.OFC_CD         = Z.OFC_CD" ).append("\n"); 
		query.append("             AND BAR.POL_YD_CD      = SUBSTR(NVL(Z.POL_CD,' '),1,5)" ).append("\n"); 
		query.append("             AND BAR.POD_YD_CD      = SUBSTR(NVL(Z.POD_CD,' '),1,5) " ).append("\n"); 
		query.append("             -- 20140728 추가(S)" ).append("\n"); 
		query.append("             AND BAR.USA_BKG_MOD_CD = NVL(Z.USA_BKG_MOD_CD,' ')" ).append("\n"); 
		query.append("             AND BAR.CUST_ACCT      = NVL(Z.CUST_ACCT1     ,' ')" ).append("\n"); 
		query.append("             AND BAR.DEST_LOC_CD    = NVL(Z.DEST_LOC_CD1   ,' ') " ).append("\n"); 
		query.append("             AND BAR.RNUM = 4" ).append("\n"); 
		query.append("       ) AS CMB4," ).append("\n"); 
		query.append("       (" ).append("\n"); 
		query.append("          SELECT ROUND((SUM(BAR.BKG_REV) + SUM(BAR.DMDT_COM_AMT) - SUM(BAR.ESTM_CM_COST_AMT)) / DECODE(SUM(BAR.BKG_TTL_WGT), 0, 1, SUM(BAR.BKG_TTL_WGT)))" ).append("\n"); 
		query.append("            FROM WK_CMB BAR" ).append("\n"); 
		query.append("           WHERE BAR.OFC_CD         = Z.OFC_CD" ).append("\n"); 
		query.append("             AND BAR.POL_YD_CD      = SUBSTR(NVL(Z.POL_CD,' '),1,5)" ).append("\n"); 
		query.append("             AND BAR.POD_YD_CD      = SUBSTR(NVL(Z.POD_CD,' '),1,5) " ).append("\n"); 
		query.append("             -- 20140728 추가(S)" ).append("\n"); 
		query.append("             AND BAR.USA_BKG_MOD_CD = NVL(Z.USA_BKG_MOD_CD,' ')" ).append("\n"); 
		query.append("             AND BAR.CUST_ACCT      = NVL(Z.CUST_ACCT1     ,' ')" ).append("\n"); 
		query.append("             AND BAR.DEST_LOC_CD    = NVL(Z.DEST_LOC_CD1   ,' ') " ).append("\n"); 
		query.append("             AND BAR.RNUM = 4" ).append("\n"); 
		query.append("       ) AS CMB_WGT4," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("       Z.FC_TTL_TEU," ).append("\n"); 
		query.append("       Z.FCT_VOL," ).append("\n"); 
		query.append("       Z.FCT_HC  ," ).append("\n"); 
		query.append("       Z.FCT_45  ," ).append("\n"); 
		query.append("       Z.FCT_53  ," ).append("\n"); 
		query.append("       Z.FCT_RF  ," ).append("\n"); 
		query.append("       Z.FCT_WGT ," ).append("\n"); 
		query.append("       Z.FCT_D2  ," ).append("\n"); 
		query.append("       Z.FCT_D4  ," ).append("\n"); 
		query.append("       Z.FCT_RD  ," ).append("\n"); 
		query.append("     " ).append("\n"); 
		query.append("       Z.ALC_VOL ," ).append("\n"); 
		query.append("       Z.ALC_20  ," ).append("\n"); 
		query.append("       Z.ALC_40  ," ).append("\n"); 
		query.append("       Z.ALC_HC  ," ).append("\n"); 
		query.append("       Z.ALC_45  ," ).append("\n"); 
		query.append("       Z.ALC_53  ," ).append("\n"); 
		query.append("       Z.ALC_RF  ," ).append("\n"); 
		query.append("       Z.ALC_WGT ," ).append("\n"); 
		query.append("       Z.ALC_D2  ," ).append("\n"); 
		query.append("       Z.ALC_D4  ," ).append("\n"); 
		query.append("       Z.ALC_RD  ," ).append("\n"); 
		query.append("     " ).append("\n"); 
		query.append("       Z.FRM_VOL ," ).append("\n"); 
		query.append("       Z.FRM_20  ," ).append("\n"); 
		query.append("       Z.FRM_40  ," ).append("\n"); 
		query.append("       Z.FRM_HC  ," ).append("\n"); 
		query.append("       Z.FRM_45  ," ).append("\n"); 
		query.append("       Z.FRM_53  ," ).append("\n"); 
		query.append("       Z.FRM_RF  ," ).append("\n"); 
		query.append("       Z.FRM_WGT ," ).append("\n"); 
		query.append("       Z.FRM_D2  ," ).append("\n"); 
		query.append("       Z.FRM_D4  ," ).append("\n"); 
		query.append("       Z.FRM_RD  ," ).append("\n"); 
		query.append("     " ).append("\n"); 
		query.append("       Z.WAT_VOL ," ).append("\n"); 
		query.append("       Z.WAT_20  ," ).append("\n"); 
		query.append("       Z.WAT_40  ," ).append("\n"); 
		query.append("       Z.WAT_HC  ," ).append("\n"); 
		query.append("       Z.WAT_45  ," ).append("\n"); 
		query.append("       Z.WAT_53  ," ).append("\n"); 
		query.append("       Z.WAT_RF  ," ).append("\n"); 
		query.append("       Z.WAT_WGT ," ).append("\n"); 
		query.append("       Z.WAT_D2  ," ).append("\n"); 
		query.append("       Z.WAT_D4  ," ).append("\n"); 
		query.append("       Z.WAT_RD  ," ).append("\n"); 
		query.append("     " ).append("\n"); 
		query.append("       Z.CTRL_PORT," ).append("\n"); 
		query.append("                                " ).append("\n"); 
		query.append("       CASE WHEN USA_BKG_MOD_CD IS NULL THEN 1" ).append("\n"); 
		query.append("            WHEN CUST_ACCT1 IS NULL THEN 2" ).append("\n"); 
		query.append("            WHEN POL_CD IS NULL THEN 3" ).append("\n"); 
		query.append("            WHEN POD_CD IS NULL THEN 4" ).append("\n"); 
		query.append("            WHEN DEST_LOC_CD1 IS NULL THEN 5" ).append("\n"); 
		query.append("            ELSE 6" ).append("\n"); 
		query.append("       END AS LVL" ).append("\n"); 
		query.append("  FROM ( " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        SELECT Z.IOC_TS_CD," ).append("\n"); 
		query.append("               Z.OFC_CD," ).append("\n"); 
		query.append("               Z.USA_BKG_MOD_CD," ).append("\n"); 
		query.append("               Z.CUST_ACCT    AS CUST_ACCT1,     " ).append("\n"); 
		query.append("               Z.POL_CD," ).append("\n"); 
		query.append("               Z.POD_CD," ).append("\n"); 
		query.append("               Z.DEST_LOC_CD  AS DEST_LOC_CD1,  " ).append("\n"); 
		query.append("               " ).append("\n"); 
		query.append("               MAX(Z.BKG_QTA) AS BKG_QTA," ).append("\n"); 
		query.append("               MAX(Z.FC_TTL_TEU) AS FC_TTL_TEU," ).append("\n"); 
		query.append("               MAX(Z.FCT_VOL) AS FCT_VOL ," ).append("\n"); 
		query.append("               MAX(Z.FCT_HC)  AS FCT_HC  ," ).append("\n"); 
		query.append("               MAX(Z.FCT_45)  AS FCT_45  ," ).append("\n"); 
		query.append("               MAX(Z.FCT_53)  AS FCT_53  ," ).append("\n"); 
		query.append("               MAX(Z.FCT_RF)  AS FCT_RF  ," ).append("\n"); 
		query.append("               MAX(Z.FCT_WGT) AS FCT_WGT ," ).append("\n"); 
		query.append("               MAX(Z.FCT_D2)  AS FCT_D2  ," ).append("\n"); 
		query.append("               MAX(Z.FCT_D4)  AS FCT_D4  ," ).append("\n"); 
		query.append("               MAX(Z.FCT_RD)  AS FCT_RD  ," ).append("\n"); 
		query.append("             " ).append("\n"); 
		query.append("               NVL(MAX(Z.ALC_VOL),0) AS ALC_VOL ," ).append("\n"); 
		query.append("               NVL(MAX(Z.ALC_20),0)  AS ALC_20  ," ).append("\n"); 
		query.append("               NVL(MAX(Z.ALC_40),0)  AS ALC_40  ," ).append("\n"); 
		query.append("               NVL(MAX(Z.ALC_HC),0)  AS ALC_HC  ," ).append("\n"); 
		query.append("               NVL(MAX(Z.ALC_45),0)  AS ALC_45  ," ).append("\n"); 
		query.append("               NVL(MAX(Z.ALC_53),0)  AS ALC_53  ," ).append("\n"); 
		query.append("               NVL(MAX(Z.ALC_RF),0)  AS ALC_RF  ," ).append("\n"); 
		query.append("               NVL(MAX(Z.ALC_WGT),0) AS ALC_WGT ," ).append("\n"); 
		query.append("               NVL(MAX(Z.ALC_D2),0)  AS ALC_D2  ," ).append("\n"); 
		query.append("               NVL(MAX(Z.ALC_D4),0)  AS ALC_D4  ," ).append("\n"); 
		query.append("               NVL(MAX(Z.ALC_RD),0)  AS ALC_RD  ," ).append("\n"); 
		query.append("             " ).append("\n"); 
		query.append("               MAX(Z.FRM_VOL) AS FRM_VOL ," ).append("\n"); 
		query.append("               MAX(Z.FRM_20)  AS FRM_20  ," ).append("\n"); 
		query.append("               MAX(Z.FRM_40)  AS FRM_40  ," ).append("\n"); 
		query.append("               MAX(Z.FRM_HC)  AS FRM_HC  ," ).append("\n"); 
		query.append("               MAX(Z.FRM_45)  AS FRM_45  ," ).append("\n"); 
		query.append("               MAX(Z.FRM_53)  AS FRM_53  ," ).append("\n"); 
		query.append("               MAX(Z.FRM_RF)  AS FRM_RF  ," ).append("\n"); 
		query.append("               MAX(Z.FRM_WGT) AS FRM_WGT ," ).append("\n"); 
		query.append("               MAX(Z.FRM_D2)  AS FRM_D2  ," ).append("\n"); 
		query.append("               MAX(Z.FRM_D4)  AS FRM_D4  ," ).append("\n"); 
		query.append("               MAX(Z.FRM_RD)  AS FRM_RD  ," ).append("\n"); 
		query.append("             " ).append("\n"); 
		query.append("               MAX(Z.WAT_VOL) AS WAT_VOL ," ).append("\n"); 
		query.append("               MAX(Z.WAT_20)  AS WAT_20  ," ).append("\n"); 
		query.append("               MAX(Z.WAT_40)  AS WAT_40  ," ).append("\n"); 
		query.append("               MAX(Z.WAT_HC)  AS WAT_HC  ," ).append("\n"); 
		query.append("               MAX(Z.WAT_45)  AS WAT_45  ," ).append("\n"); 
		query.append("               MAX(Z.WAT_53)  AS WAT_53  ," ).append("\n"); 
		query.append("               MAX(Z.WAT_RF)  AS WAT_RF  ," ).append("\n"); 
		query.append("               MAX(Z.WAT_WGT) AS WAT_WGT ," ).append("\n"); 
		query.append("               MAX(Z.WAT_D2)  AS WAT_D2  ," ).append("\n"); 
		query.append("               MAX(Z.WAT_D4)  AS WAT_D4  ," ).append("\n"); 
		query.append("               MAX(Z.WAT_RD)  AS WAT_RD  ," ).append("\n"); 
		query.append("             " ).append("\n"); 
		query.append("               MAX(Z.CTRL_PORT) AS CTRL_PORT" ).append("\n"); 
		query.append("          FROM ( " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("                SELECT IOC_TS_CD," ).append("\n"); 
		query.append("                       OFC_CD," ).append("\n"); 
		query.append("                       -- 20140728 추가(S)                       " ).append("\n"); 
		query.append("                       USA_BKG_MOD_CD," ).append("\n"); 
		query.append("                       CUST_ACCT,       " ).append("\n"); 
		query.append("                       POL_CD," ).append("\n"); 
		query.append("                       POD_CD," ).append("\n"); 
		query.append("                       DEST_LOC_CD,              " ).append("\n"); 
		query.append("                       " ).append("\n"); 
		query.append("                       BKG_QTA," ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("                       FC_TTL_TEU," ).append("\n"); 
		query.append("                       FCT_VOL," ).append("\n"); 
		query.append("                       FCT_HC  ," ).append("\n"); 
		query.append("                       FCT_45  ," ).append("\n"); 
		query.append("                       FCT_53  ," ).append("\n"); 
		query.append("                       FCT_RF  ," ).append("\n"); 
		query.append("                       FCT_WGT ," ).append("\n"); 
		query.append("                       FCT_D2  ," ).append("\n"); 
		query.append("                       FCT_D4  ," ).append("\n"); 
		query.append("                       FCT_RD  ," ).append("\n"); 
		query.append("                       " ).append("\n"); 
		query.append("                       ALC_VOL ," ).append("\n"); 
		query.append("                       ALC_20  ," ).append("\n"); 
		query.append("                       ALC_40  ," ).append("\n"); 
		query.append("                       ALC_HC  ," ).append("\n"); 
		query.append("                       ALC_45  ," ).append("\n"); 
		query.append("                       ALC_53  ," ).append("\n"); 
		query.append("                       ALC_RF  ," ).append("\n"); 
		query.append("                       ALC_WGT ," ).append("\n"); 
		query.append("                       ALC_D2  ," ).append("\n"); 
		query.append("                       ALC_D4  ," ).append("\n"); 
		query.append("                       ALC_RD  ," ).append("\n"); 
		query.append("                       " ).append("\n"); 
		query.append("                       FRM_VOL ," ).append("\n"); 
		query.append("                       FRM_20  ," ).append("\n"); 
		query.append("                       FRM_40  ," ).append("\n"); 
		query.append("                       FRM_HC  ," ).append("\n"); 
		query.append("                       FRM_45  ," ).append("\n"); 
		query.append("                       FRM_53  ," ).append("\n"); 
		query.append("                       FRM_RF  ," ).append("\n"); 
		query.append("                       FRM_WGT ," ).append("\n"); 
		query.append("                       FRM_D2  ," ).append("\n"); 
		query.append("                       FRM_D4  ," ).append("\n"); 
		query.append("                       FRM_RD  ," ).append("\n"); 
		query.append("                       " ).append("\n"); 
		query.append("                       WAT_VOL ," ).append("\n"); 
		query.append("                       WAT_20  ," ).append("\n"); 
		query.append("                       WAT_40  ," ).append("\n"); 
		query.append("                       WAT_HC  ," ).append("\n"); 
		query.append("                       WAT_45  ," ).append("\n"); 
		query.append("                       WAT_53  ," ).append("\n"); 
		query.append("                       WAT_RF  ," ).append("\n"); 
		query.append("                       WAT_WGT ," ).append("\n"); 
		query.append("                       WAT_D2  ," ).append("\n"); 
		query.append("                       WAT_D4  ," ).append("\n"); 
		query.append("                       WAT_RD  ," ).append("\n"); 
		query.append("                       CTRL_PORT" ).append("\n"); 
		query.append("                --       LVL" ).append("\n"); 
		query.append("                  FROM (" ).append("\n"); 
		query.append("                          SELECT DECODE(Z.IOC_TS_CD, 'O', 'OCN', 'I', 'IPC', 'T', 'T/S') AS IOC_TS_CD," ).append("\n"); 
		query.append("                                 Z.OFC_CD," ).append("\n"); 
		query.append("                                 Z.USA_BKG_MOD_CD," ).append("\n"); 
		query.append("                                 Z.CUST_ACCT," ).append("\n"); 
		query.append("                                 Z.POL_CD," ).append("\n"); 
		query.append("                                 Z.POD_CD," ).append("\n"); 
		query.append("                                 Z.DEST_LOC_CD," ).append("\n"); 
		query.append("                                 " ).append("\n"); 
		query.append("                                 GROUPING_ID(Z.USA_BKG_MOD_CD) AS GU1," ).append("\n"); 
		query.append("                                 GROUPING_ID(Z.CUST_ACCT)      AS GC1," ).append("\n"); 
		query.append("                                 GROUPING_ID(Z.POL_CD)         AS GP1," ).append("\n"); 
		query.append("                                 GROUPING_ID(Z.POD_CD)         AS GP2," ).append("\n"); 
		query.append("                                 GROUPING_ID(Z.DEST_LOC_CD)    AS GD1," ).append("\n"); 
		query.append("                                 " ).append("\n"); 
		query.append("                                 ROUND(SUM(Z.BKG_QTA)) AS BKG_QTA," ).append("\n"); 
		query.append("                                 SUM(NVL(Z.FCT_VOL, 0) + NVL(Z.FCT_HC, 0) * 2 + NVL(Z.FCT_45, 0) * 2 + NVL(Z.FCT_53, 0) * 2) AS FC_TTL_TEU," ).append("\n"); 
		query.append("                                 SUM(Z.FCT_VOL) AS FCT_VOL ," ).append("\n"); 
		query.append("                                 SUM(Z.FCT_HC)  AS FCT_HC  ," ).append("\n"); 
		query.append("                                 SUM(Z.FCT_45)  AS FCT_45  ," ).append("\n"); 
		query.append("                                 SUM(Z.FCT_53)  AS FCT_53  ," ).append("\n"); 
		query.append("                                 SUM(Z.FCT_RF)  AS FCT_RF  ," ).append("\n"); 
		query.append("                                 SUM(Z.FCT_WGT) AS FCT_WGT ," ).append("\n"); 
		query.append("                                 SUM(Z.FCT_D2)  AS FCT_D2  ," ).append("\n"); 
		query.append("                                 SUM(Z.FCT_D4)  AS FCT_D4  ," ).append("\n"); 
		query.append("                                 SUM(Z.FCT_RD)  AS FCT_RD  ," ).append("\n"); 
		query.append("                                 " ).append("\n"); 
		query.append("                                 SUM(Z.ALC_VOL) AS ALC_VOL ," ).append("\n"); 
		query.append("                                 SUM(Z.ALC_20)  AS ALC_20  ," ).append("\n"); 
		query.append("                                 SUM(Z.ALC_40)  AS ALC_40  ," ).append("\n"); 
		query.append("                                 SUM(Z.ALC_HC)  AS ALC_HC  ," ).append("\n"); 
		query.append("                                 SUM(Z.ALC_45)  AS ALC_45  ," ).append("\n"); 
		query.append("                                 SUM(Z.ALC_53)  AS ALC_53  ," ).append("\n"); 
		query.append("                                 SUM(Z.ALC_RF)  AS ALC_RF  ," ).append("\n"); 
		query.append("                                 SUM(Z.ALC_WGT) AS ALC_WGT ," ).append("\n"); 
		query.append("                                 SUM(Z.ALC_D2)  AS ALC_D2  ," ).append("\n"); 
		query.append("                                 SUM(Z.ALC_D4)  AS ALC_D4  ," ).append("\n"); 
		query.append("                                 SUM(Z.ALC_RD)  AS ALC_RD  ," ).append("\n"); 
		query.append("                                 " ).append("\n"); 
		query.append("                                 SUM(Z.FRM_VOL) AS FRM_VOL ," ).append("\n"); 
		query.append("                                 SUM(Z.FRM_20)  AS FRM_20  ," ).append("\n"); 
		query.append("                                 SUM(Z.FRM_40)  AS FRM_40  ," ).append("\n"); 
		query.append("                                 SUM(Z.FRM_HC)  AS FRM_HC  ," ).append("\n"); 
		query.append("                                 SUM(Z.FRM_45)  AS FRM_45  ," ).append("\n"); 
		query.append("                                 SUM(Z.FRM_53)  AS FRM_53  ," ).append("\n"); 
		query.append("                                 SUM(Z.FRM_RF)  AS FRM_RF  ," ).append("\n"); 
		query.append("                                 SUM(Z.FRM_WGT) AS FRM_WGT ," ).append("\n"); 
		query.append("                                 SUM(Z.FRM_D2)  AS FRM_D2  ," ).append("\n"); 
		query.append("                                 SUM(Z.FRM_D4)  AS FRM_D4  ," ).append("\n"); 
		query.append("                                 SUM(Z.FRM_RD)  AS FRM_RD  ," ).append("\n"); 
		query.append("                                 " ).append("\n"); 
		query.append("                                 SUM(Z.WAT_VOL) AS WAT_VOL ," ).append("\n"); 
		query.append("                                 SUM(Z.WAT_20)  AS WAT_20  ," ).append("\n"); 
		query.append("                                 SUM(Z.WAT_40)  AS WAT_40  ," ).append("\n"); 
		query.append("                                 SUM(Z.WAT_HC)  AS WAT_HC  ," ).append("\n"); 
		query.append("                                 SUM(Z.WAT_45)  AS WAT_45  ," ).append("\n"); 
		query.append("                                 SUM(Z.WAT_53)  AS WAT_53  ," ).append("\n"); 
		query.append("                                 SUM(Z.WAT_RF)  AS WAT_RF  ," ).append("\n"); 
		query.append("                                 SUM(Z.WAT_WGT) AS WAT_WGT ," ).append("\n"); 
		query.append("                                 SUM(Z.WAT_D2)  AS WAT_D2  ," ).append("\n"); 
		query.append("                                 SUM(Z.WAT_D4)  AS WAT_D4  ," ).append("\n"); 
		query.append("                                 SUM(Z.WAT_RD)  AS WAT_RD  ," ).append("\n"); 
		query.append("                                 " ).append("\n"); 
		query.append("                                 MAX(CTRL_PORT) AS CTRL_PORT" ).append("\n"); 
		query.append("                --                 6 - (GROUPING_ID(Z.USA_BKG_MOD_CD) + GROUPING_ID(Z.CUST_ACCT) + GROUPING_ID(Z.POL_CD) + GROUPING_ID(Z.POD_CD) + GROUPING_ID(Z.DEST_LOC_CD)) AS LVL" ).append("\n"); 
		query.append("                            FROM (" ).append("\n"); 
		query.append("                                    -- QTA" ).append("\n"); 
		query.append("                                    SELECT DECODE(SUBSTR(T2.TRD_CD, 1, 1), 'I', 'I', 'O') AS IOC_TS_CD," ).append("\n"); 
		query.append("                                           P.TRD_CD    ," ).append("\n"); 
		query.append("                                           P.SUB_TRD_CD," ).append("\n"); 
		query.append("                                           P.RLANE_CD  ," ).append("\n"); 
		query.append("                                           P.VSL_CD    ," ).append("\n"); 
		query.append("                                           P.SKD_VOY_NO," ).append("\n"); 
		query.append("                                           P.SKD_DIR_CD," ).append("\n"); 
		query.append("                                           T3.SAQ_RGN_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("                                           'OTH'           AS USA_BKG_MOD_CD," ).append("\n"); 
		query.append("                                           'XXX999999'      AS CUST_ACCT,                           " ).append("\n"); 
		query.append("                                           'XXXXX'         AS DEST_LOC_CD," ).append("\n"); 
		query.append("                                           --'00000'         AS POL_CD," ).append("\n"); 
		query.append("                                           --'00000'         AS POD_CD," ).append("\n"); 
		query.append("--                                           NULL         AS USA_BKG_MOD_CD," ).append("\n"); 
		query.append("--                                           NULL         AS CUST_ACCT,                           " ).append("\n"); 
		query.append("--                                           NULL         AS DEST_LOC_CD," ).append("\n"); 
		query.append("                                           NULL         AS POL_CD," ).append("\n"); 
		query.append("                                           NULL         AS POD_CD," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           (T2.LOD_QTY) AS BKG_QTA," ).append("\n"); 
		query.append("                                           NULL AS FCT_VOL," ).append("\n"); 
		query.append("                                           NULL AS FCT_HC ," ).append("\n"); 
		query.append("                                           NULL AS FCT_45 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_53 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_RF ," ).append("\n"); 
		query.append("                                           NULL AS FCT_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS FCT_D2 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_D4 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           NULL AS ALC_VOL," ).append("\n"); 
		query.append("                                           NULL AS ALC_20 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_40 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_HC ," ).append("\n"); 
		query.append("                                           NULL AS ALC_45 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_53 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_RF ," ).append("\n"); 
		query.append("                                           NULL AS ALC_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS ALC_D2 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_D4 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           NULL AS FRM_VOL," ).append("\n"); 
		query.append("                                           NULL AS FRM_20 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_40 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_HC ," ).append("\n"); 
		query.append("                                           NULL AS FRM_45 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_53 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_RF ," ).append("\n"); 
		query.append("                                           NULL AS FRM_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS FRM_D2 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_D4 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           NULL AS WAT_VOL," ).append("\n"); 
		query.append("                                           NULL AS WAT_20 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_40 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_HC ," ).append("\n"); 
		query.append("                                           NULL AS WAT_45 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_53 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_RF ," ).append("\n"); 
		query.append("                                           NULL AS WAT_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS WAT_D2 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_D4 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           P.CTRL_PORT    ," ).append("\n"); 
		query.append("                                           P.CTRL_WGT     ," ).append("\n"); 
		query.append("                                           P.CTRL_40HC    ," ).append("\n"); 
		query.append("                                           P.CTRL_45HC    ," ).append("\n"); 
		query.append("                                           P.CTRL_53FT    ," ).append("\n"); 
		query.append("                                           P.CTRL_RF      ," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           P.CTRL_D2      ," ).append("\n"); 
		query.append("                                           P.CTRL_D4      ," ).append("\n"); 
		query.append("                                           P.CTRL_RD      " ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                      FROM SQM_QTA_RLSE_VER T1," ).append("\n"); 
		query.append("                                           SQM_CFM_QTA      T2," ).append("\n"); 
		query.append("                                           SPC_OFC_LVL      T3," ).append("\n"); 
		query.append("                                           BASE             P" ).append("\n"); 
		query.append("                                     WHERE T1.BSE_YR           = P.BSE_YR" ).append("\n"); 
		query.append("                                       --AND T1.BSE_QTR_CD       = CEIL(TO_NUMBER(DECODE(P.COST_WK,'00','01','53','52',P.COST_WK))/13)||'Q' --CEIL(TO_NUMBER(P.COST_MON) / 3)||'Q'" ).append("\n"); 
		query.append("									   -- CHM-201534458 SQM QTA주가 변경 관련 적용 요청" ).append("\n"); 
		query.append("									   AND T1.BSE_QTR_CD      = P.BSE_QTR_CD" ).append("\n"); 
		query.append("                                       AND T1.SQM_VER_STS_CD   = 'R'" ).append("\n"); 
		query.append("                                       AND T1.BSE_TP_CD        = 'Q' -- 분기 20131205추가" ).append("\n"); 
		query.append("                                       AND T2.QTA_RLSE_VER_NO  = T1.QTA_RLSE_VER_NO" ).append("\n"); 
		query.append("                                       AND T2.BSE_TP_CD        = T1.BSE_TP_CD -- 분기 20131205추가 " ).append("\n"); 
		query.append("                                       AND T2.BSE_YR           = T1.BSE_YR" ).append("\n"); 
		query.append("                                       AND T2.BSE_QTR_CD       = T1.BSE_QTR_CD " ).append("\n"); 
		query.append("                                       AND T2.QTA_TGT_CD       = 'D'" ).append("\n"); 
		query.append("                                       AND T2.OFC_VW_CD        = 'L'  -- 20131205추가" ).append("\n"); 
		query.append("                                       AND NOT EXISTS(" ).append("\n"); 
		query.append("                                            SELECT '1'" ).append("\n"); 
		query.append("                                            FROM SQM_SCTR_CFM_QTA QTA" ).append("\n"); 
		query.append("                                            WHERE QTA.QTA_RLSE_VER_NO = T1.QTA_RLSE_VER_NO" ).append("\n"); 
		query.append("                                            AND QTA.BSE_TP_CD         = T1.BSE_TP_CD -- 분기 20131205추가     " ).append("\n"); 
		query.append("                                            AND QTA.BSE_YR            = T1.BSE_YR" ).append("\n"); 
		query.append("                                            AND QTA.BSE_QTR_CD        = T1.BSE_QTR_CD" ).append("\n"); 
		query.append("                                            AND QTA.OFC_VW_CD         = 'L'  -- 20131205추가" ).append("\n"); 
		query.append("                                            AND QTA.TRD_CD            = P.TRD_CD" ).append("\n"); 
		query.append("                                            AND QTA.RLANE_CD          = P.RLANE_CD" ).append("\n"); 
		query.append("                                            AND QTA.DIR_CD            = P.DIR_CD" ).append("\n"); 
		query.append("                                            AND QTA.VSL_CD            = P.VSL_CD" ).append("\n"); 
		query.append("                                            AND QTA.SKD_VOY_NO        = P.SKD_VOY_NO" ).append("\n"); 
		query.append("                                            AND QTA.SKD_DIR_CD        = P.SKD_DIR_CD" ).append("\n"); 
		query.append("                                            AND P.COST_YR || P.COST_WK >= '201427'" ).append("\n"); 
		query.append("                                            )" ).append("\n"); 
		query.append("                                       AND T2.TRD_CD           = P.TRD_CD" ).append("\n"); 
		query.append("                                       AND T2.RLANE_CD         = P.RLANE_CD" ).append("\n"); 
		query.append("                                       AND T2.DIR_CD           = P.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND T2.VSL_CD           = P.VSL_CD" ).append("\n"); 
		query.append("                                       AND T2.SKD_VOY_NO       = P.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND T2.SKD_DIR_CD       = P.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND SPC_SCR_OFC_CONV_FNC(T2.RGN_OFC_CD) = P.OFC_CD" ).append("\n"); 
		query.append("                                       AND SPC_SCR_OFC_CONV_FNC(T2.RGN_OFC_CD) = T3.OFC_CD" ).append("\n"); 
		query.append("                                       AND P.COST_YR || P.COST_WK BETWEEN T3.OFC_APLY_FM_YRWK AND T3.OFC_APLY_TO_YRWK" ).append("\n"); 
		query.append("                                -- IAS SECTOR 관련 NEW QUATA FROM 201427주차" ).append("\n"); 
		query.append("                                UNION ALL" ).append("\n"); 
		query.append("                                    SELECT DECODE(SUBSTR(T2.TRD_CD, 1, 1), 'I', 'I', 'O') AS IOC_TS_CD," ).append("\n"); 
		query.append("                                           P.TRD_CD    ," ).append("\n"); 
		query.append("                                           P.SUB_TRD_CD," ).append("\n"); 
		query.append("                                           P.RLANE_CD  ," ).append("\n"); 
		query.append("                                           P.VSL_CD    ," ).append("\n"); 
		query.append("                                           P.SKD_VOY_NO," ).append("\n"); 
		query.append("                                           P.SKD_DIR_CD," ).append("\n"); 
		query.append("                                           T3.SAQ_RGN_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           'OTH'         AS USA_BKG_MOD_CD," ).append("\n"); 
		query.append("                                           'XXX999999'      AS CUST_ACCT,                           " ).append("\n"); 
		query.append("                                           'XXXXX'         AS DEST_LOC_CD," ).append("\n"); 
		query.append("--                                           NULL         AS USA_BKG_MOD_CD," ).append("\n"); 
		query.append("--                                           NULL         AS CUST_ACCT,                           " ).append("\n"); 
		query.append("--                                           NULL         AS DEST_LOC_CD," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           T4.YD_CD         AS POL_CD," ).append("\n"); 
		query.append("                                           --SUBSTR(T2.POL_CD,1,5) AS POL_CD," ).append("\n"); 
		query.append("                                           T5.YD_CD         AS POD_CD," ).append("\n"); 
		query.append("                                           --SUBSTR(T2.POD_CD,1,5) AS POD_CD," ).append("\n"); 
		query.append("                                           (T2.LOD_QTY) AS BKG_QTA," ).append("\n"); 
		query.append("                                           NULL AS FCT_VOL," ).append("\n"); 
		query.append("                                           NULL AS FCT_HC ," ).append("\n"); 
		query.append("                                           NULL AS FCT_45 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_53 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_RF ," ).append("\n"); 
		query.append("                                           NULL AS FCT_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS FCT_D2 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_D4 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           NULL AS ALC_VOL," ).append("\n"); 
		query.append("                                           NULL AS ALC_20 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_40 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_HC ," ).append("\n"); 
		query.append("                                           NULL AS ALC_45 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_53 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_RF ," ).append("\n"); 
		query.append("                                           NULL AS ALC_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS ALC_D2 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_D4 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           NULL AS FRM_VOL," ).append("\n"); 
		query.append("                                           NULL AS FRM_20 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_40 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_HC ," ).append("\n"); 
		query.append("                                           NULL AS FRM_45 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_53 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_RF ," ).append("\n"); 
		query.append("                                           NULL AS FRM_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS FRM_D2 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_D4 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           NULL AS WAT_VOL," ).append("\n"); 
		query.append("                                           NULL AS WAT_20 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_40 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_HC ," ).append("\n"); 
		query.append("                                           NULL AS WAT_45 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_53 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_RF ," ).append("\n"); 
		query.append("                                           NULL AS WAT_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS WAT_D2 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_D4 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           P.CTRL_PORT    ," ).append("\n"); 
		query.append("                                           P.CTRL_WGT     ," ).append("\n"); 
		query.append("                                           P.CTRL_40HC    ," ).append("\n"); 
		query.append("                                           P.CTRL_45HC    ," ).append("\n"); 
		query.append("                                           P.CTRL_53FT    ," ).append("\n"); 
		query.append("                                           P.CTRL_RF      ," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           P.CTRL_D2      ," ).append("\n"); 
		query.append("                                           P.CTRL_D4      ," ).append("\n"); 
		query.append("                                           P.CTRL_RD          " ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                      FROM SQM_QTA_RLSE_VER T1," ).append("\n"); 
		query.append("                                           SQM_SCTR_CFM_QTA T2," ).append("\n"); 
		query.append("                                           SPC_OFC_LVL      T3," ).append("\n"); 
		query.append("                                           VSK_VSL_PORT_SKD T4," ).append("\n"); 
		query.append("                                           VSK_VSL_PORT_SKD T5," ).append("\n"); 
		query.append("                                           BASE             P" ).append("\n"); 
		query.append("                                     WHERE T1.BSE_YR           = P.BSE_YR" ).append("\n"); 
		query.append("                                       --AND T1.BSE_QTR_CD       = CEIL(TO_NUMBER(DECODE(P.COST_WK,'00','01','53','52',P.COST_WK))/13)||'Q' --CEIL(TO_NUMBER(P.COST_MON) / 3)||'Q'" ).append("\n"); 
		query.append("									   -- CHM-201534458 SQM QTA주가 변경 관련 적용 요청" ).append("\n"); 
		query.append("									   AND T1.BSE_QTR_CD       =P.BSE_QTR_CD" ).append("\n"); 
		query.append("                                       AND T1.SQM_VER_STS_CD   = 'R'" ).append("\n"); 
		query.append("                                       AND T1.BSE_TP_CD        = 'Q' -- 분기 20131205추가" ).append("\n"); 
		query.append("                                       AND T2.QTA_RLSE_VER_NO  = T1.QTA_RLSE_VER_NO" ).append("\n"); 
		query.append("                                       AND T2.BSE_TP_CD        = T1.BSE_TP_CD -- 분기 20131205추가 " ).append("\n"); 
		query.append("                                       AND T2.BSE_YR           = T1.BSE_YR" ).append("\n"); 
		query.append("                                       AND T2.BSE_QTR_CD       = T1.BSE_QTR_CD " ).append("\n"); 
		query.append("                                      -- AND T2.QTA_TGT_CD       = 'D'" ).append("\n"); 
		query.append("                                       AND T2.OFC_VW_CD        = 'L'  -- 20131205추가" ).append("\n"); 
		query.append("                --                       AND T2.TRD_CD	       = 'IAS'" ).append("\n"); 
		query.append("                                       AND T2.TRD_CD           = P.TRD_CD" ).append("\n"); 
		query.append("                                       AND T2.RLANE_CD         = P.RLANE_CD" ).append("\n"); 
		query.append("                                       AND T2.DIR_CD           = P.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND T2.VSL_CD           = P.VSL_CD" ).append("\n"); 
		query.append("                                       AND T2.SKD_VOY_NO       = P.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND T2.SKD_DIR_CD       = P.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND T2.VSL_CD           = T4.VSL_CD" ).append("\n"); 
		query.append("                                       AND T2.SKD_VOY_NO       = T4.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND T2.SKD_DIR_CD       = T4.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND T2.POL_CD           = T4.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND (T4.VPS_PORT_CD, T4.CLPT_SEQ) IN" ).append("\n"); 
		query.append("                                            (SELECT VPS_PORT_CD, MIN(CLPT_SEQ) CLPT_SEQ" ).append("\n"); 
		query.append("                                                FROM VSK_VSL_PORT_SKD " ).append("\n"); 
		query.append("                                                WHERE VSL_CD         = P.VSL_CD" ).append("\n"); 
		query.append("                                                AND SKD_VOY_NO       = P.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                AND SKD_DIR_CD       = P.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                GROUP BY VPS_PORT_CD)" ).append("\n"); 
		query.append("                --                       AND T2.POL_CALL_SEQ     = T4.CLPT_SEQ" ).append("\n"); 
		query.append("                                       AND T2.VSL_CD           = T5.VSL_CD" ).append("\n"); 
		query.append("                                       AND T2.SKD_VOY_NO       = T5.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND T2.SKD_DIR_CD       = T5.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND T2.POD_CD           = T5.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND (T5.VPS_PORT_CD, T5.CLPT_SEQ) IN" ).append("\n"); 
		query.append("                                            (SELECT VPS_PORT_CD, MIN(CLPT_SEQ) CLPT_SEQ" ).append("\n"); 
		query.append("                                                FROM VSK_VSL_PORT_SKD " ).append("\n"); 
		query.append("                                                WHERE VSL_CD         = P.VSL_CD" ).append("\n"); 
		query.append("                                                AND SKD_VOY_NO       = P.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                AND SKD_DIR_CD       = P.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                GROUP BY VPS_PORT_CD)" ).append("\n"); 
		query.append("                --                       AND T2.POD_CALL_SEQ     = T5.CLPT_SEQ" ).append("\n"); 
		query.append("                                       AND SPC_SCR_OFC_CONV_FNC(T2.RGN_OFC_CD) = P.OFC_CD" ).append("\n"); 
		query.append("                                       AND SPC_SCR_OFC_CONV_FNC(T2.RGN_OFC_CD) = T3.OFC_CD" ).append("\n"); 
		query.append("                                       AND P.COST_YR || P.COST_WK BETWEEN T3.OFC_APLY_FM_YRWK AND T3.OFC_APLY_TO_YRWK" ).append("\n"); 
		query.append("                                       AND P.COST_YR || P.COST_WK >= '201427' " ).append("\n"); 
		query.append("                --                       AND SUBSTR(T2.TRD_CD, 1, 1) ='I'" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("                                UNION ALL" ).append("\n"); 
		query.append("                                    -- FORECAST" ).append("\n"); 
		query.append("                                    SELECT Z.IOC_TS_CD ," ).append("\n"); 
		query.append("                                           P.TRD_CD    ," ).append("\n"); 
		query.append("                                           P.SUB_TRD_CD," ).append("\n"); 
		query.append("                                           P.RLANE_CD  ," ).append("\n"); 
		query.append("                                           P.VSL_CD    ," ).append("\n"); 
		query.append("                                           P.SKD_VOY_NO," ).append("\n"); 
		query.append("                                           P.SKD_DIR_CD," ).append("\n"); 
		query.append("                                           Z.SLS_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           Z.USA_BKG_MOD_CD," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           CASE WHEN P.CTRL_ACCT = 'Y' THEN" ).append("\n"); 
		query.append("                                                NVL((SELECT D.CTRL_LOC_ACCT_CD" ).append("\n"); 
		query.append("                                                       FROM SPC_ALOC_LANE_CTRL_OPT_DTL D" ).append("\n"); 
		query.append("                                                      WHERE P.RLANE_CD                           = D.RLANE_CD" ).append("\n"); 
		query.append("                                                        AND SPC_GET_REP_TRD_FNC(P.RLANE_CD)      = D.TRD_CD" ).append("\n"); 
		query.append("                                                        AND SPC_GET_REP_SUB_TRD_FNC(P.RLANE_CD)  = D.SUB_TRD_CD" ).append("\n"); 
		query.append("                                                        AND P.SKD_DIR_CD                         = D.DIR_CD " ).append("\n"); 
		query.append("                                                        AND D.ALOC_CTRL_TP_CD                    = 'A'  " ).append("\n"); 
		query.append("                                                        AND D.CTRL_LOC_ACCT_CD                   = Z.CUST_CNT_CD ||LPAD(Z.CUST_SEQ,6,'0')                                        " ).append("\n"); 
		query.append("                                                    ),'XXX999999')   -- 20140801 수정" ).append("\n"); 
		query.append("                                           ELSE" ).append("\n"); 
		query.append("                                                'XXX999999'" ).append("\n"); 
		query.append("                                           END AS CUST_ACCT," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           Z.DEST_LOC_CD," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           Z.POL_YD_CD  AS POL_CD," ).append("\n"); 
		query.append("                                           Z.POD_YD_CD  AS POD_CD," ).append("\n"); 
		query.append("                                           NULL               AS BKG_QTA," ).append("\n"); 
		query.append("                                           Z.CFM_TTL_QTY      AS FCT_VOL," ).append("\n"); 
		query.append("                                           Z.CFM_40FT_HC_QTY  AS FCT_HC ," ).append("\n"); 
		query.append("                                           Z.CFM_45FT_HC_QTY  AS FCT_45 ," ).append("\n"); 
		query.append("                                           Z.CFM_53FT_QTY     AS FCT_53 ," ).append("\n"); 
		query.append("                                           Z.CFM_RF_QTY       AS FCT_RF ," ).append("\n"); 
		query.append("                                           Z.CFM_TTL_WGT      AS FCT_WGT," ).append("\n"); 
		query.append("                                           Z.CFM_20FT_DRY_QTY AS FCT_D2 ," ).append("\n"); 
		query.append("                                           Z.CFM_40FT_DRY_QTY AS FCT_D4 ," ).append("\n"); 
		query.append("                                           Z.CFM_RD_QTY       AS FCT_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           NULL AS ALC_VOL," ).append("\n"); 
		query.append("                                           NULL AS ALC_20 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_40 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_HC ," ).append("\n"); 
		query.append("                                           NULL AS ALC_45 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_53 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_RF ," ).append("\n"); 
		query.append("                                           NULL AS ALC_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS ALC_D2 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_D4 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           NULL AS FRM_VOL," ).append("\n"); 
		query.append("                                           NULL AS FRM_20 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_40 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_HC ," ).append("\n"); 
		query.append("                                           NULL AS FRM_45 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_53 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_RF ," ).append("\n"); 
		query.append("                                           NULL AS FRM_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS FRM_D2 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_D4 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           NULL AS WAT_VOL," ).append("\n"); 
		query.append("                                           NULL AS WAT_20 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_40 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_HC ," ).append("\n"); 
		query.append("                                           NULL AS WAT_45 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_53 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_RF ," ).append("\n"); 
		query.append("                                           NULL AS WAT_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS WAT_D2 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_D4 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           P.CTRL_PORT    ," ).append("\n"); 
		query.append("                                           P.CTRL_WGT     ," ).append("\n"); 
		query.append("                                           P.CTRL_40HC    ," ).append("\n"); 
		query.append("                                           P.CTRL_45HC    ," ).append("\n"); 
		query.append("                                           P.CTRL_53FT    ," ).append("\n"); 
		query.append("                                           P.CTRL_RF      ," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           P.CTRL_D2      ," ).append("\n"); 
		query.append("                                           P.CTRL_D4      ," ).append("\n"); 
		query.append("                                           P.CTRL_RD       " ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                      FROM SPC_DLY_FCAST_CUST Z," ).append("\n"); 
		query.append("                                           BASE               P" ).append("\n"); 
		query.append("                                     WHERE Z.RLANE_CD   = P.RLANE_CD" ).append("\n"); 
		query.append("                                       AND Z.DIR_CD     = P.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND Z.VSL_CD     = P.VSL_CD" ).append("\n"); 
		query.append("                                       AND Z.SKD_VOY_NO = P.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND Z.SKD_DIR_CD = P.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND Z.SLS_OFC_CD = P.OFC_CD" ).append("\n"); 
		query.append("                                       AND Z.TRD_CD     = P.TRD_CD" ).append("\n"); 
		query.append("                                       AND Z.SUB_TRD_CD = P.SUB_TRD_CD" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                UNION ALL" ).append("\n"); 
		query.append("                                    -- ALLOCATION" ).append("\n"); 
		query.append("                                    SELECT DECODE(Z.TS_FLG, 'Y', 'T', Z.IOC_CD) AS IOC_TS_CD," ).append("\n"); 
		query.append("                                           P.TRD_CD," ).append("\n"); 
		query.append("                                           P.SUB_TRD_CD," ).append("\n"); 
		query.append("                                           P.RLANE_CD," ).append("\n"); 
		query.append("                                           P.VSL_CD," ).append("\n"); 
		query.append("                                           P.SKD_VOY_NO," ).append("\n"); 
		query.append("                                           P.SKD_DIR_CD," ).append("\n"); 
		query.append("                                           Z.SLS_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           Z.USA_BKG_MOD_CD," ).append("\n"); 
		query.append("                                           -- 2014.12.04 CTRT_NO 추가 " ).append("\n"); 
		query.append("                                           DECODE(Z.CTRT_NO||Z.CUST_CNT_CD||LPAD(Z.CUST_SEQ, 6, '0'), 'XXX999999', 'XXX999999', " ).append("\n"); 
		query.append("                                            DECODE(Z.CUST_CNT_CD||LPAD(Z.CUST_SEQ, 6, '0'), 'XX999999', Z.CTRT_NO, Z.CUST_CNT_CD||LPAD(Z.CUST_SEQ, 6, '0'))) AS CUST_ACCT,                           " ).append("\n"); 
		query.append("                                           Z.DEST_LOC_CD,                           " ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           Z.POL_YD_CD  AS POL_CD," ).append("\n"); 
		query.append("                                           Z.POD_YD_CD  AS POD_CD," ).append("\n"); 
		query.append("                                           NULL AS BKG_QTA," ).append("\n"); 
		query.append("                                           NULL AS FCT_VOL," ).append("\n"); 
		query.append("                                           NULL AS FCT_HC ," ).append("\n"); 
		query.append("                                           NULL AS FCT_45 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_53 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_RF ," ).append("\n"); 
		query.append("                                           NULL AS FCT_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS FCT_D2 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_D4 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           (Z.BKG_AVAL_TTL_QTY)     AS ALC_VOL," ).append("\n"); 
		query.append("                                           (Z.BKG_AVAL_20FT_QTY)    AS ALC_20 ," ).append("\n"); 
		query.append("                                           (Z.BKG_AVAL_40FT_QTY)    AS ALC_40 ," ).append("\n"); 
		query.append("                                           (Z.BKG_AVAL_40FT_HC_QTY) AS ALC_HC ," ).append("\n"); 
		query.append("                                           (Z.BKG_AVAL_45FT_HC_QTY) AS ALC_45 ," ).append("\n"); 
		query.append("                                           (Z.BKG_AVAL_53FT_QTY)    AS ALC_53 ," ).append("\n"); 
		query.append("                                           (Z.BKG_AVAL_RF_QTY)      AS ALC_RF ," ).append("\n"); 
		query.append("                                           (Z.BKG_AVAL_TTL_WGT)     AS ALC_WGT," ).append("\n"); 
		query.append("                                           (Z.BKG_AVAL_20FT_DRY_QTY) AS ALC_D2 ," ).append("\n"); 
		query.append("                                           (Z.BKG_AVAL_40FT_DRY_QTY) AS ALC_D4 ," ).append("\n"); 
		query.append("                                           (Z.BKG_AVAL_RD_QTY)       AS ALC_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           NULL AS FRM_VOL," ).append("\n"); 
		query.append("                                           NULL AS FRM_20 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_40 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_HC ," ).append("\n"); 
		query.append("                                           NULL AS FRM_45 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_53 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_RF ," ).append("\n"); 
		query.append("                                           NULL AS FRM_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS FRM_D2 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_D4 ," ).append("\n"); 
		query.append("                                           NULL AS FRM_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           NULL AS WAT_VOL," ).append("\n"); 
		query.append("                                           NULL AS WAT_20 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_40 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_HC ," ).append("\n"); 
		query.append("                                           NULL AS WAT_45 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_53 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_RF ," ).append("\n"); 
		query.append("                                           NULL AS WAT_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS WAT_D2 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_D4 ," ).append("\n"); 
		query.append("                                           NULL AS WAT_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           P.CTRL_PORT    ," ).append("\n"); 
		query.append("                                           P.CTRL_WGT     ," ).append("\n"); 
		query.append("                                           P.CTRL_40HC    ," ).append("\n"); 
		query.append("                                           P.CTRL_45HC    ," ).append("\n"); 
		query.append("                                           P.CTRL_53FT    ," ).append("\n"); 
		query.append("                                           P.CTRL_RF      ," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           P.CTRL_D2      ," ).append("\n"); 
		query.append("                                           P.CTRL_D4      ," ).append("\n"); 
		query.append("                                           P.CTRL_RD       " ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                      FROM SPC_ALOC_POL_POD Z," ).append("\n"); 
		query.append("                                           BASE             P" ).append("\n"); 
		query.append("                                           --VSK_VSL_PORT_SKD V" ).append("\n"); 
		query.append("                                     WHERE Z.RLANE_CD   = P.RLANE_CD" ).append("\n"); 
		query.append("                                       AND Z.DIR_CD     = P.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND Z.VSL_CD     = P.VSL_CD" ).append("\n"); 
		query.append("                                       AND Z.SKD_VOY_NO = P.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND Z.SKD_DIR_CD = P.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND Z.SLS_OFC_CD = P.OFC_CD" ).append("\n"); 
		query.append("                                       AND Z.TRD_CD     = P.TRD_CD" ).append("\n"); 
		query.append("                                       AND Z.SUB_TRD_CD = P.SUB_TRD_CD" ).append("\n"); 
		query.append("                                        -- Double-Calling Port의 경우 Allocation의 정보가 배수로 표시되어, Yard 존재 여부만 체크하도록 변경. @2012-03-30" ).append("\n"); 
		query.append("                                       AND Z.POD_YD_CD IN (SELECT V.YD_CD" ).append("\n"); 
		query.append("                                                             FROM VSK_VSL_PORT_SKD V" ).append("\n"); 
		query.append("                                                            WHERE V.SLAN_CD = SUBSTR(P.RLANE_CD, 1, 3)" ).append("\n"); 
		query.append("                                                              AND V.VSL_CD = P.VSL_CD" ).append("\n"); 
		query.append("                                                              AND V.SKD_VOY_NO = P.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                              AND V.SKD_DIR_CD = P.SKD_DIR_CD)" ).append("\n"); 
		query.append("                                       -- 2014.11.03 POD와 동일하게 POL도 YARD CHECK" ).append("\n"); 
		query.append("                                       AND Z.POL_YD_CD IN (SELECT V.YD_CD" ).append("\n"); 
		query.append("                                                             FROM VSK_VSL_PORT_SKD V" ).append("\n"); 
		query.append("                                                            WHERE V.SLAN_CD = SUBSTR(P.RLANE_CD, 1, 3)" ).append("\n"); 
		query.append("                                                              AND V.VSL_CD = P.VSL_CD" ).append("\n"); 
		query.append("                                                              AND V.SKD_VOY_NO = P.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                              AND V.SKD_DIR_CD = P.SKD_DIR_CD)" ).append("\n"); 
		query.append("                                UNION ALL" ).append("\n"); 
		query.append("                                " ).append("\n"); 
		query.append("                                    SELECT " ).append("\n"); 
		query.append("                                           IOC_TS_CD," ).append("\n"); 
		query.append("                                           TRD_CD    ," ).append("\n"); 
		query.append("                                           SUB_TRD_CD," ).append("\n"); 
		query.append("                                           RLANE_CD  ," ).append("\n"); 
		query.append("                                           VSL_CD    ," ).append("\n"); 
		query.append("                                           SKD_VOY_NO," ).append("\n"); 
		query.append("                                           SKD_DIR_CD," ).append("\n"); 
		query.append("                                           OFC_CD," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           USA_BKG_MOD_CD," ).append("\n"); 
		query.append("                                           CUST_ACCT,                           " ).append("\n"); 
		query.append("                                           DEST_LOC_CD,  " ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           POL_CD," ).append("\n"); 
		query.append("                                           POD_CD," ).append("\n"); 
		query.append("                                           NULL AS BKG_QTA," ).append("\n"); 
		query.append("                                           NULL AS FCT_VOL," ).append("\n"); 
		query.append("                                           NULL AS FCT_HC ," ).append("\n"); 
		query.append("                                           NULL AS FCT_45 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_53 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_RF ," ).append("\n"); 
		query.append("                                           NULL AS FCT_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS FCT_D2 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_D4 ," ).append("\n"); 
		query.append("                                           NULL AS FCT_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           NULL AS ALC_VOL," ).append("\n"); 
		query.append("                                           NULL AS ALC_20 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_40 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_HC ," ).append("\n"); 
		query.append("                                           NULL AS ALC_45 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_53 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_RF ," ).append("\n"); 
		query.append("                                           NULL AS ALC_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           NULL AS ALC_D2 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_D4 ," ).append("\n"); 
		query.append("                                           NULL AS ALC_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           FIRM_VOL," ).append("\n"); 
		query.append("                                           FIRM_20 ," ).append("\n"); 
		query.append("                                           FIRM_40 ," ).append("\n"); 
		query.append("                                           FIRM_HC ," ).append("\n"); 
		query.append("                                           FIRM_45 ," ).append("\n"); 
		query.append("                                           FIRM_53 ," ).append("\n"); 
		query.append("                                           FIRM_RF ," ).append("\n"); 
		query.append("                                           FIRM_WGT," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           FIRM_D2 ," ).append("\n"); 
		query.append("                                           FIRM_D4 ," ).append("\n"); 
		query.append("                                           FIRM_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           WAT_VOL ," ).append("\n"); 
		query.append("                                           WAT_20  ," ).append("\n"); 
		query.append("                                           WAT_40  ," ).append("\n"); 
		query.append("                                           WAT_HC  ," ).append("\n"); 
		query.append("                                           WAT_45  ," ).append("\n"); 
		query.append("                                           WAT_53  ," ).append("\n"); 
		query.append("                                           WAT_RF  ," ).append("\n"); 
		query.append("                                           WAT_WGT ," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           WAT_D2 ," ).append("\n"); 
		query.append("                                           WAT_D4 ," ).append("\n"); 
		query.append("                                           WAT_RD ," ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                           CTRL_PORT," ).append("\n"); 
		query.append("                                           CTRL_WGT ," ).append("\n"); 
		query.append("                                           CTRL_40HC," ).append("\n"); 
		query.append("                                           CTRL_45HC," ).append("\n"); 
		query.append("                                           CTRL_53FT," ).append("\n"); 
		query.append("                                           CTRL_RF," ).append("\n"); 
		query.append("                                           -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                           CTRL_D2  ," ).append("\n"); 
		query.append("                                           CTRL_D4  ," ).append("\n"); 
		query.append("                                           CTRL_RD  " ).append("\n"); 
		query.append("                                      FROM" ).append("\n"); 
		query.append("                                           (" ).append("\n"); 
		query.append("                                            SELECT " ).append("\n"); 
		query.append("                                                      OFC_CD" ).append("\n"); 
		query.append("                                                    , TRD_CD    " ).append("\n"); 
		query.append("                                                    , SUB_TRD_CD" ).append("\n"); 
		query.append("                                                    , RLANE_CD  " ).append("\n"); 
		query.append("                                                    , VSL_CD    " ).append("\n"); 
		query.append("                                                    , SKD_VOY_NO" ).append("\n"); 
		query.append("                                                    , SKD_DIR_CD  " ).append("\n"); 
		query.append("                                                    " ).append("\n"); 
		query.append("                                                    , USA_BKG_MOD_CD" ).append("\n"); 
		query.append("                                                    , CUST_ACCT  " ).append("\n"); 
		query.append("                                                    " ).append("\n"); 
		query.append("                                                    -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                          			,CASE WHEN M.CTRL_DEST = 'E' THEN	                                                      " ).append("\n"); 
		query.append("                                                           NVL((SELECT D.CTRL_LOC_ACCT_CD" ).append("\n"); 
		query.append("                                                                  FROM SPC_ALOC_LANE_CTRL_OPT_DTL D," ).append("\n"); 
		query.append("                                                                       MDM_LOCATION               ML1," ).append("\n"); 
		query.append("                                                                       MDM_EQ_ORZ_CHT             ME1" ).append("\n"); 
		query.append("                                                                 WHERE M.RLANE_CD         = D.RLANE_CD" ).append("\n"); 
		query.append("                                                                   AND SPC_GET_REP_TRD_FNC(M.RLANE_CD)     = D.TRD_CD" ).append("\n"); 
		query.append("                                                                   AND SPC_GET_REP_SUB_TRD_FNC(M.RLANE_CD) = D.SUB_TRD_CD" ).append("\n"); 
		query.append("                                                                   AND M.SKD_DIR_CD       = D.DIR_CD " ).append("\n"); 
		query.append("                                                                   AND D.ALOC_CTRL_TP_CD  = M.CTRL_DEST" ).append("\n"); 
		query.append("                                                                   AND ML1.LOC_CD         = M.DEST_PORT" ).append("\n"); 
		query.append("                                                                   AND ME1.SCC_CD         = ML1.SCC_CD" ).append("\n"); 
		query.append("                                                                   AND D.CTRL_LOC_ACCT_CD = ME1.ECC_CD" ).append("\n"); 
		query.append("                                                           ),'XXXXX')" ).append("\n"); 
		query.append("                                                     WHEN M.CTRL_DEST = 'L' THEN	                                                      " ).append("\n"); 
		query.append("                                                           NVL((SELECT D.CTRL_LOC_ACCT_CD" ).append("\n"); 
		query.append("                                                                  FROM SPC_ALOC_LANE_CTRL_OPT_DTL D" ).append("\n"); 
		query.append("                                                                 WHERE M.RLANE_CD         = D.RLANE_CD" ).append("\n"); 
		query.append("                                                                   AND SPC_GET_REP_TRD_FNC(M.RLANE_CD)     = D.TRD_CD" ).append("\n"); 
		query.append("                                                                   AND SPC_GET_REP_SUB_TRD_FNC(M.RLANE_CD) = D.SUB_TRD_CD" ).append("\n"); 
		query.append("                                                                   AND M.SKD_DIR_CD       = D.DIR_CD " ).append("\n"); 
		query.append("                                                                   AND D.ALOC_CTRL_TP_CD  = M.CTRL_DEST" ).append("\n"); 
		query.append("                                                                   AND D.CTRL_LOC_ACCT_CD = M.DEST_PORT" ).append("\n"); 
		query.append("                                                           ),'XXXXX')" ).append("\n"); 
		query.append("                                                           " ).append("\n"); 
		query.append("                                                     ELSE" ).append("\n"); 
		query.append("                                                          'XXXXX'" ).append("\n"); 
		query.append("                                                     END AS DEST_LOC_CD                          " ).append("\n"); 
		query.append("                                                     " ).append("\n"); 
		query.append("                                                    , NVL(POD_YD_CD, POD_CD) AS POD_CD" ).append("\n"); 
		query.append("                                                    , NVL(POL_YD_CD, POL_CD) AS POL_CD   	          " ).append("\n"); 
		query.append("                                                    , DECODE(VSL_PRE_PST_CD, 'T', IOC_CD, 'T') AS IOC_TS_CD" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'F', TO_NUMBER(NVL(SUBSTR(VAL, 1, 14), 0)), 0)   AS FIRM_VOL" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'F', TO_NUMBER(NVL(SUBSTR(VAL, 15, 14), 0)), 0)  AS FIRM_20" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'F', TO_NUMBER(NVL(SUBSTR(VAL, 29, 14), 0)), 0)  AS FIRM_40" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'F', TO_NUMBER(NVL(SUBSTR(VAL, 43, 14), 0)), 0)  AS FIRM_D2" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'F', TO_NUMBER(NVL(SUBSTR(VAL, 57, 14), 0)), 0)  AS FIRM_D4" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'F', TO_NUMBER(NVL(SUBSTR(VAL, 71, 14), 0)), 0)  AS FIRM_HC" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'F', TO_NUMBER(NVL(SUBSTR(VAL, 85, 14), 0)), 0)  AS FIRM_45" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'F', TO_NUMBER(NVL(SUBSTR(VAL, 99, 14), 0)), 0)  AS FIRM_53" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'F', TO_NUMBER(NVL(SUBSTR(VAL,113, 14), 0)), 0)  AS FIRM_RF" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'F', TO_NUMBER(NVL(SUBSTR(VAL,127, 14), 0)), 0)  AS FIRM_RD" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'F', TO_NUMBER(NVL(SUBSTR(VAL,141, 14), 0)), 0)  AS FIRM_WGT" ).append("\n"); 
		query.append("                                                    " ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'W', TO_NUMBER(NVL(SUBSTR(VAL, 1, 14), 0)), 0)   AS WAT_VOL" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'W', TO_NUMBER(NVL(SUBSTR(VAL, 15, 14), 0)), 0)  AS WAT_20" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'W', TO_NUMBER(NVL(SUBSTR(VAL, 29, 14), 0)), 0)  AS WAT_40" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'W', TO_NUMBER(NVL(SUBSTR(VAL, 43, 14), 0)), 0)  AS WAT_D2" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'W', TO_NUMBER(NVL(SUBSTR(VAL, 57, 14), 0)), 0)  AS WAT_D4" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'W', TO_NUMBER(NVL(SUBSTR(VAL, 71, 14), 0)), 0)  AS WAT_HC" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'W', TO_NUMBER(NVL(SUBSTR(VAL, 85, 14), 0)), 0)  AS WAT_45" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'W', TO_NUMBER(NVL(SUBSTR(VAL, 99, 14), 0)), 0)  AS WAT_53" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'W', TO_NUMBER(NVL(SUBSTR(VAL,113, 14), 0)), 0)  AS WAT_RF" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'W', TO_NUMBER(NVL(SUBSTR(VAL,127, 14), 0)), 0)  AS WAT_RD" ).append("\n"); 
		query.append("                                                    , DECODE(BKG_STS_CD, 'W', TO_NUMBER(NVL(SUBSTR(VAL,141, 14), 0)), 0)  AS WAT_WGT" ).append("\n"); 
		query.append("                                                    " ).append("\n"); 
		query.append("                                                    , TO_NUMBER(NVL(SUBSTR(VAL, 1, 14), 0))                               AS BKG_TTL" ).append("\n"); 
		query.append("                                                    , TO_NUMBER(NVL(SUBSTR(VAL, 15, 14), 0))                              AS BKG_20" ).append("\n"); 
		query.append("                                                    , TO_NUMBER(NVL(SUBSTR(VAL, 29, 14), 0))                              AS BKG_40" ).append("\n"); 
		query.append("                                                    , TO_NUMBER(NVL(SUBSTR(VAL, 43, 14), 0))                              AS BKG_D2" ).append("\n"); 
		query.append("                                                    , TO_NUMBER(NVL(SUBSTR(VAL, 57, 14), 0))                              AS BKG_D4" ).append("\n"); 
		query.append("                                                    , TO_NUMBER(NVL(SUBSTR(VAL, 71, 14), 0))                              AS BKG_HC" ).append("\n"); 
		query.append("                                                    , TO_NUMBER(NVL(SUBSTR(VAL, 85, 14), 0))                              AS BKG_45" ).append("\n"); 
		query.append("                                                    , TO_NUMBER(NVL(SUBSTR(VAL, 99, 14), 0))                              AS BKG_53" ).append("\n"); 
		query.append("                                                    , TO_NUMBER(NVL(SUBSTR(VAL,113, 14), 0))                              AS BKG_RF" ).append("\n"); 
		query.append("                                                    , TO_NUMBER(NVL(SUBSTR(VAL,127, 14), 0))                              AS BKG_RD" ).append("\n"); 
		query.append("                                                    , TO_NUMBER(NVL(SUBSTR(VAL,141, 14), 0))                              AS BKG_WGT" ).append("\n"); 
		query.append("                                                    " ).append("\n"); 
		query.append("                                                    , CTRL_PORT               " ).append("\n"); 
		query.append("                                                    , CTRL_WGT                " ).append("\n"); 
		query.append("                                                    , CTRL_40HC               " ).append("\n"); 
		query.append("                                                    , CTRL_45HC               " ).append("\n"); 
		query.append("                                                    , CTRL_53FT               " ).append("\n"); 
		query.append("                                                    , CTRL_RF    " ).append("\n"); 
		query.append("                                                    " ).append("\n"); 
		query.append("                                                    , CTRL_D2" ).append("\n"); 
		query.append("                                                    , CTRL_D4" ).append("\n"); 
		query.append("                                                    , CTRL_RD                  			" ).append("\n"); 
		query.append("                                              FROM" ).append("\n"); 
		query.append("                                                    (" ).append("\n"); 
		query.append("                                                     SELECT B.BKG_STS_CD" ).append("\n"); 
		query.append("                                                            , O.N2ND_PRNT_OFC_CD" ).append("\n"); 
		query.append("                                                            , O.N3RD_PRNT_OFC_CD" ).append("\n"); 
		query.append("                                                            , O.N4TH_PRNT_OFC_CD" ).append("\n"); 
		query.append("                                                            " ).append("\n"); 
		query.append("                                                            -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                                            ,CASE WHEN M.CTRL_USA = 'Y' AND (SUBSTR(B.POL_CD,1,2) IN ('US','CA') OR SUBSTR(B.POD_CD,1,2) IN ('US','CA')) THEN" ).append("\n"); 
		query.append("                                                                 NVL(SPC_USA_MODE_FNC(B.RCV_TERM_CD, B.DE_TERM_CD, B.POR_CD, B.POL_CD, B.POD_CD, B.DEL_CD),'OTH') " ).append("\n"); 
		query.append("                                                             ELSE" ).append("\n"); 
		query.append("                                                                 'OTH'" ).append("\n"); 
		query.append("                                                             END AS USA_BKG_MOD_CD" ).append("\n"); 
		query.append("                                             " ).append("\n"); 
		query.append("                                                            , M.CTRL_DEST" ).append("\n"); 
		query.append("                                                            , DECODE(M.CTRL_DEST_LVL,'T',B.DEL_CD,B.POD_CD) AS DEST_PORT" ).append("\n"); 
		query.append("                                                            " ).append("\n"); 
		query.append("                                                            ,CASE WHEN M.CTRL_ACCT = 'Y' THEN" ).append("\n"); 
		query.append("                                                                 NVL((SELECT DISTINCT(D.CTRL_LOC_ACCT_CD)" ).append("\n"); 
		query.append("                                                                        FROM ALOC_LANE_CTRL_OPT_DTL D" ).append("\n"); 
		query.append("                                                                       WHERE M.RLANE_CD                           = D.RLANE_CD" ).append("\n"); 
		query.append("                                                                         AND SPC_GET_REP_TRD_FNC(M.RLANE_CD)      = D.TRD_CD" ).append("\n"); 
		query.append("                                                                         AND SPC_GET_REP_SUB_TRD_FNC(M.RLANE_CD)  = D.SUB_TRD_CD" ).append("\n"); 
		query.append("                                                                         AND M.SKD_DIR_CD                         = D.DIR_CD " ).append("\n"); 
		query.append("                                                                         AND D.ALOC_CTRL_TP_CD                    IN ('A' , 'B', 'C') " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                                         AND (D.CTRL_LOC_ACCT_CD = B.SC_NO OR D.CTRL_LOC_ACCT_CD = B.RFA_NO)" ).append("\n"); 
		query.append("                                                                         AND D.ALOC_CTRL_DTL_CD  = DECODE(D.ALOC_CTRL_TP_CD, 'A', B.CTRT_CUST_CNT_CD ||LPAD(B.CTRT_CUST_SEQ,6,'0')," ).append("\n"); 
		query.append("                                                                                                                             'B', B.AGMT_ACT_CNT_CD ||LPAD(B.AGMT_ACT_CUST_SEQ,6,'0')," ).append("\n"); 
		query.append("                                                                                                                             'C', B.CMDT_CD)                                   " ).append("\n"); 
		query.append("                                                                     ),'XXX999999')   -- 20140801 수정" ).append("\n"); 
		query.append("                                                             ELSE" ).append("\n"); 
		query.append("                                                                 'XXX999999'" ).append("\n"); 
		query.append("                                                             END AS CUST_ACCT" ).append("\n"); 
		query.append("                                                            , M.IOC_CD" ).append("\n"); 
		query.append("                                                            , BV.POL_YD_CD" ).append("\n"); 
		query.append("                                                            , BV.POL_CD" ).append("\n"); 
		query.append("                                                            , BV.POD_YD_CD" ).append("\n"); 
		query.append("                                                            , BV.POD_CD" ).append("\n"); 
		query.append("                                                            , B.DEL_NOD_CD" ).append("\n"); 
		query.append("                                                            , B.DEL_CD" ).append("\n"); 
		query.append("                                                            , BV.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                                            , M.OFC_CD " ).append("\n"); 
		query.append("                                                            , (SELECT  TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '2', 1, 2) * Q.OP_CNTR_QTY), 'FM0000000000.000') " ).append("\n"); 
		query.append("                                                                    || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '2', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000') " ).append("\n"); 
		query.append("                                                                    || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '4', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000') " ).append("\n"); 
		query.append("                                                                    -- 20140728 추가(S)" ).append("\n"); 
		query.append("                                                                    || TO_CHAR(SUM(DECODE(SUBSTR(Q.CNTR_TPSZ_CD,1,2), 'D2', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000') -- D2" ).append("\n"); 
		query.append("                                                                    || TO_CHAR(SUM(DECODE(SUBSTR(Q.CNTR_TPSZ_CD,1,2), 'D4', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000') -- D4" ).append("\n"); 
		query.append("                                                     " ).append("\n"); 
		query.append("                                                                    || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '5', Q.OP_CNTR_QTY, '9', Q.OP_CNTR_QTY, '8', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')	--R9,R8에 대해서 R5과 동일하게 HC으로 처리되도록 추가" ).append("\n"); 
		query.append("                                                                    || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '7', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')  " ).append("\n"); 
		query.append("                                                                    || TO_CHAR(SUM(DECODE(Q.CNTR_TPSZ_CD, 'DW', Q.OP_CNTR_QTY, 'DX', Q.OP_CNTR_QTY, 0)) , 'FM0000000000.000')  " ).append("\n"); 
		query.append("                                                                    || TO_CHAR(SUM(DECODE(SUBSTR(Q.CNTR_TPSZ_CD, 1, 1), 'R', Q.OP_CNTR_QTY - Q.EQ_SUBST_CGO_QTY, 0)), 'FM0000000000.000') " ).append("\n"); 
		query.append("                                                                    -- 20140728 추가" ).append("\n"); 
		query.append("                                                                    || TO_CHAR(SUM(CASE WHEN Q.CNTR_TPSZ_CD LIKE 'R%' AND Q.EQ_SUBST_CNTR_TPSZ_CD LIKE 'D%' THEN Q.EQ_SUBST_CGO_QTY ELSE 0 END), 'FM0000000000.000')--RD" ).append("\n"); 
		query.append("                                                     " ).append("\n"); 
		query.append("                                                                    || TO_CHAR((R.ACT_WGT * DECODE(R.ACT_WGT,'LBS', 0.00045, 0.001)) " ).append("\n"); 
		query.append("                                                                            + SUM(Q.OP_CNTR_QTY * (SELECT TS.CNTR_TPSZ_TARE_WGT" ).append("\n"); 
		query.append("                                                                                                     FROM MDM_CNTR_TP_SZ TS" ).append("\n"); 
		query.append("                                                                                                    WHERE TS.CNTR_TPSZ_CD = Q.CNTR_TPSZ_CD)) * 0.001, 'FM0000000000.000')" ).append("\n"); 
		query.append("                                                                  FROM BKG_QUANTITY Q" ).append("\n"); 
		query.append("                                                                 WHERE B.BKG_NO = Q.BKG_NO) VAL" ).append("\n"); 
		query.append("                                                            ,M.TRD_CD    " ).append("\n"); 
		query.append("                                                            ,M.SUB_TRD_CD" ).append("\n"); 
		query.append("                                                            ,M.RLANE_CD  " ).append("\n"); 
		query.append("                                                            ,M.VSL_CD    " ).append("\n"); 
		query.append("                                                            ,M.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                            ,M.SKD_DIR_CD    " ).append("\n"); 
		query.append("                                                            ,M.CTRL_PORT    " ).append("\n"); 
		query.append("                                                            ,M.CTRL_WGT     " ).append("\n"); 
		query.append("                                                            ,M.CTRL_40HC    " ).append("\n"); 
		query.append("                                                            ,M.CTRL_45HC    " ).append("\n"); 
		query.append("                                                            ,M.CTRL_53FT    " ).append("\n"); 
		query.append("                                                            ,M.CTRL_RF  " ).append("\n"); 
		query.append("                                                                 " ).append("\n"); 
		query.append("                                                            ,M.CTRL_D2" ).append("\n"); 
		query.append("                                                            ,M.CTRL_D4" ).append("\n"); 
		query.append("                                                            ,M.CTRL_RD                                                            " ).append("\n"); 
		query.append("                                                       FROM BKG_VVD BV" ).append("\n"); 
		query.append("                                                            , BKG_BOOKING B" ).append("\n"); 
		query.append("                                                            , BASE M" ).append("\n"); 
		query.append("                                                            , BKG_BL_DOC R" ).append("\n"); 
		query.append("                                                            , MDM_DTL_REV_LANE DRL" ).append("\n"); 
		query.append("                                                            , MDM_REV_LANE RL" ).append("\n"); 
		query.append("                                                            , SPC_OFC_LVL O" ).append("\n"); 
		query.append("                                                      WHERE B.BKG_NO         = BV.BKG_NO" ).append("\n"); 
		query.append("                                                      AND B.BKG_NO         = R.BKG_NO" ).append("\n"); 
		query.append("                                                      AND B.BKG_STS_CD    IN ('W','F')" ).append("\n"); 
		query.append("                                                      AND B.BKG_CGO_TP_CD IN ('F', 'B', 'R')" ).append("\n"); 
		query.append("                                                      AND M.VSL_CD         = BV.VSL_CD" ).append("\n"); 
		query.append("                                                      AND M.SKD_VOY_NO     = BV.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                      AND M.SKD_DIR_CD     = BV.SKD_DIR_CD" ).append("\n"); 
		query.append("                                " ).append("\n"); 
		query.append("                                                      AND RL.VSL_SLAN_CD   = BV.SLAN_CD" ).append("\n"); 
		query.append("                                                      AND M.OFC_CD = O.SPC_SLS_OFC_CD" ).append("\n"); 
		query.append("                                                      AND O.OFC_CD = SPC_SCR_OFC_CONV_FNC(B.OB_SLS_OFC_CD)" ).append("\n"); 
		query.append("                                                      AND M.COST_YR || M.COST_WK BETWEEN OFC_APLY_FM_YRWK AND OFC_APLY_TO_YRWK" ).append("\n"); 
		query.append("                                                      AND DRL.RLANE_CD        = M.RLANE_CD" ).append("\n"); 
		query.append("                                                      AND DRL.VSL_SLAN_DIR_CD = M.DIR_CD" ).append("\n"); 
		query.append("                                                      AND DRL.IOC_CD          = M.IOC_CD" ).append("\n"); 
		query.append("                                                      AND DRL.TRD_CD          = M.TRD_CD" ).append("\n"); 
		query.append("                                                      AND DRL.SUB_TRD_CD      = M.SUB_TRD_CD" ).append("\n"); 
		query.append("                                                      AND DRL.DELT_FLG        = 'N'" ).append("\n"); 
		query.append("                                                      AND DRL.RLANE_CD        = RL.RLANE_CD" ).append("\n"); 
		query.append("                                                      AND DRL.FM_CONTI_CD     = (SELECT SPC_CONTI_CONV_FNC(L.CONTI_CD, M.RLANE_CD, M.DIR_CD)" ).append("\n"); 
		query.append("                                                                                   FROM MDM_LOCATION L" ).append("\n"); 
		query.append("                                                                                  WHERE L.LOC_CD = BV.POL_CD )" ).append("\n"); 
		query.append("                                                      AND DRL.TO_CONTI_CD 	  = (SELECT SPC_CONTI_CONV_FNC(L.CONTI_CD, M.RLANE_CD, M.DIR_CD)" ).append("\n"); 
		query.append("                                                                                   FROM MDM_LOCATION L" ).append("\n"); 
		query.append("                                                                                  WHERE L.LOC_CD =  BV.POD_CD )" ).append("\n"); 
		query.append("                                                      AND RL.RLANE_CD  = M.RLANE_CD" ).append("\n"); 
		query.append("                                                      AND RL.VSL_TP_CD = 'C'" ).append("\n"); 
		query.append("                                                      AND RL.DELT_FLG  = 'N'" ).append("\n"); 
		query.append("                                                      AND RL.RLANE_CD      <> 'RBCCO'" ).append("\n"); 
		query.append("                                              ) M" ).append("\n"); 
		query.append("                                      )A" ).append("\n"); 
		query.append("                             ) Z" ).append("\n"); 
		query.append("                       GROUP BY Z.IOC_TS_CD, " ).append("\n"); 
		query.append("                                Z.OFC_CD, " ).append("\n"); 
		query.append("                                CUBE(Z.USA_BKG_MOD_CD, Z.CUST_ACCT, Z.POL_CD, Z.POD_CD, Z.DEST_LOC_CD)" ).append("\n"); 
		query.append("                       ) " ).append("\n"); 
		query.append("                 WHERE NOT (" ).append("\n"); 
		query.append("                               GU1||GC1||GP1||GP2||GD1 = '11110'" ).append("\n"); 
		query.append("                            OR GU1||GC1 = '10'" ).append("\n"); 
		query.append("                            OR GU1||GP1 = '10'" ).append("\n"); 
		query.append("                            OR GU1||GP2 = '10'" ).append("\n"); 
		query.append("                            OR GU1||GD1 = '10'" ).append("\n"); 
		query.append("                            OR GC1||GP1 = '10'" ).append("\n"); 
		query.append("                            OR GC1||GP2 = '10'" ).append("\n"); 
		query.append("                            OR GC1||GD1 = '10'" ).append("\n"); 
		query.append("                            OR GP1||GP2 = '10'" ).append("\n"); 
		query.append("                            OR GP1||GD1 = '10'" ).append("\n"); 
		query.append("                            OR GP2||GD1 = '10'" ).append("\n"); 
		query.append("                           )     " ).append("\n"); 
		query.append("                ) Z" ).append("\n"); 
		query.append("--          WHERE POD_CD||DEST_LOC_CD <> ' XXXXX'" ).append("\n"); 
		query.append("          GROUP BY Z.IOC_TS_CD," ).append("\n"); 
		query.append("               Z.OFC_CD," ).append("\n"); 
		query.append("               Z.USA_BKG_MOD_CD," ).append("\n"); 
		query.append("               Z.CUST_ACCT,     " ).append("\n"); 
		query.append("               Z.POL_CD," ).append("\n"); 
		query.append("               Z.POD_CD," ).append("\n"); 
		query.append("               Z.DEST_LOC_CD" ).append("\n"); 
		query.append("       ) Z" ).append("\n"); 
		query.append(" ORDER BY Z.IOC_TS_CD," ).append("\n"); 
		query.append("       Z.OFC_CD," ).append("\n"); 
		query.append("       NVL(Z.USA_BKG_MOD_CD,'0')," ).append("\n"); 
		query.append("       NVL(Z.CUST_ACCT1,'0')     ,       " ).append("\n"); 
		query.append("       NVL(Z.POL_CD,'0')        ," ).append("\n"); 
		query.append("       NVL(Z.POD_CD,'0')        ," ).append("\n"); 
		query.append("       NVL(Z.DEST_LOC_CD1,'0')" ).append("\n"); 
		query.append("/*" ).append("\n"); 
		query.append("- Lee Sang-Yong : [프로젝트] Ticket ID : CHM-201004171 53ft 추가" ).append("\n"); 
		query.append("2011.01.05 최윤성 [CHM-201008093-01] Office Level Table 생성" ).append("\n"); 
		query.append(" - SPC_ORGANIZATION_V 대신 SPC_OFC_LVL 로 대체" ).append("\n"); 
		query.append("2011.07.05 [ CHM-201111880-01] 김종준control by HO 화면 보완 - IPC, TS 관련" ).append("\n"); 
		query.append("2012.03.30 [CHM-201217046-01] Double-Calling Port의 경우 Allocation의 정보가 배수로 표시되어, Yard 존재 여부만 체크하도록 변경" ).append("\n"); 
		query.append("2012.12.03 [CHM-201221639] 김시몬 R9와 동일하게 R8이 적용될 수 있도록 쿼리수정" ).append("\n"); 
		query.append("2013.01.23 [CHM-201322502-01] SPC 프로젝트 - 성수기 선복운영 개선을 위한 T/F추진" ).append("\n"); 
		query.append("2013.11.26 진마리아 [CHM-201326854] SAQ project로 인한 SPC 변경건_FNC 우선제거" ).append("\n"); 
		query.append("2013.12.05 김시몬 [CHM-201326854] SAQ project로 인한 SPC 변경건_테이블 변경" ).append("\n"); 
		query.append("2014.03.25 김시몬 [선처리] SQM 분기구하는 로직 관련 보완" ).append("\n"); 
		query.append("*/" ).append("\n"); 

	}
}