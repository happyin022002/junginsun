<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BLIssuanceDBDAOManageBlReIssueUSQL">
			<desc><![CDATA[ManageBlReIssue]]></desc>
			<sql><![CDATA[
#if (${sql_type} == 'count') 

	SELECT COUNT(BKG_NO) FROM BKG_DOC_ISS_HIS WHERE BKG_NO= @[bkg_no] AND HIS_SEQ= @[his_seq]


#elseif (${sql_type} == 'insert') 


	INSERT INTO BKG_DOC_ISS_HIS (
	   BKG_NO, HIS_SEQ, BKG_EVNT_KND_CD, 
	   RISS_FLG, BL_RISS_RSN_CD, RISS_RSN, 
	   RISS_CFM_FLG, RISS_RDEM_FLG, CRE_USR_ID, 
	   CRE_DT, UPD_USR_ID, UPD_DT) 
	VALUES ( 
	   @[bkg_no], (SELECT  NVL(MAX(HIS_SEQ),0)+1 AS SEQ FROM BKG_DOC_ISS_HIS WHERE BKG_NO = @[bkg_no]), @[bkg_evnt_knd_cd], 
	   @[riss_flg], @[bl_riss_rsn_cd], @[riss_rsn], 
	   @[riss_cfm_flg], @[riss_rdem_flg], @[cre_usr_id], 
	   sysdate, @[upd_usr_id], sysdate
	)

#elseif (${sql_type} == 'update') 

	UPDATE BKG_DOC_ISS_HIS
	SET    
		BL_RISS_RSN_CD   = @[bl_riss_rsn_cd]
		,RISS_RSN        = @[riss_rsn]
		,UPD_USR_ID      = @[upd_usr_id]
		,UPD_DT          = sysdate
	WHERE 
		BKG_NO= @[bkg_no] AND HIS_SEQ= @[his_seq]

#end
			]]></sql>
			<params>
				<param name="bkg_no" type="12" value=" " out="N"/>
				<param name="his_seq" type="12" value="" out="N"/>
				<param name="bkg_evnt_knd_cd" type="12" value="" out="N"/>
				<param name="riss_flg" type="12" value="" out="N"/>
				<param name="bl_riss_rsn_cd" type="12" value="" out="N"/>
				<param name="riss_rsn" type="12" value="" out="N"/>
				<param name="riss_cfm_flg" type="12" value="" out="N"/>
				<param name="riss_rdem_flg" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
