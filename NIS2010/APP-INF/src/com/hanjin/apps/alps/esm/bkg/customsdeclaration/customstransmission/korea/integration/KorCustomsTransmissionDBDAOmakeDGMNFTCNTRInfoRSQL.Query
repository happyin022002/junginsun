<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="KorCustomsTransmissionDBDAOmakeDGMNFTCNTRInfoRSQL">
			<desc><![CDATA[DGMNFT Cntr make flat file]]></desc>
			<sql><![CDATA[
SELECT	SUBSTR(
		MAX(TO_CHAR(CNTR_SEQ, '00000')||
			CNTR_NO					||'~'||	/*	CNTR NO	*/
			IMDG_CLSS_CD||IMDG_COMP_GRP_CD			||'~'||	/*	IMO CLASS		*/
			BL_NO						||'~'||	/*	B/L NO		*/
			IMDG_UN_NO				||'~'||	/*	UN NO			*/
			MF_CERTI_NO||DECODE(@[io_bnd_cd], 'I','SMLM','')			||'~'||	    /*	MANIFEST REFERENCE NO + INBOUND SMLM	*/
			DECODE(@[io_bnd_cd],'O',SUBSTR(@[certi_seq_no],2),CGO_SEQ_NO)||'~'||	/*	MANIFEST REFERENCE SEQ NO	*//* OUTBOUD SEQ 만 INBOUND SEQ로 전송*/
			''		||'~'||	
			DECODE(CSTMS_DECL_TP_CD, 'I', '1', 'E', '2', 'T', '3', 'R', '4', '9')	||'~'||	/*	하역작업구분 코드	*/
			SUBSTR(PRP_SHP_NM, 1, 35)	||'~'||	/*	상품명세1		*/
			SUBSTR(PRP_SHP_NM, 36, 35)||'~'||	/*	상품명세2	*/
			NET_WGT	/*	WEIGHT	*/
			), 7)||'~' EDI_SND_MSG
FROM	BKG_CSTMS_KR_DG_CGO
WHERE	VSL_CD		=	SUBSTR(@[vvd], 1, 4)
AND		SKD_VOY_NO	=	SUBSTR(@[vvd], 5, 4)
AND		SKD_DIR_CD	=	SUBSTR(@[vvd], 9, 1)
AND		CNTR_SEQ	=	@[cntr_seq]
AND     CNTR_NO 	=   @[cntr_no]
AND		IMDG_UN_NO  =   @[imdg_un_no]
AND		IMDG_CLSS_CD =  @[imdg_clss_cd]
AND     BL_NO = @[bl_no]
#if(${io_bnd_cd}=='I')
AND POD_CD = @[pod_cd]
AND CSTMS_DECL_TP_CD IN ('I', 'T')
#end
#if(${io_bnd_cd}=='O')
AND POL_CD = @[pol_cd]
AND CSTMS_DECL_TP_CD IN ('E', 'R')
#end
GROUP BY BKG_NO, CSTMS_DECL_TP_CD, CNTR_NO, IMDG_UN_NO			]]></sql>
			<params>
				<param name="io_bnd_cd" type="12" value="" out="N"/>
				<param name="certi_seq_no" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="cntr_seq" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
				<param name="imdg_un_no" type="12" value="" out="N"/>
				<param name="imdg_clss_cd" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
