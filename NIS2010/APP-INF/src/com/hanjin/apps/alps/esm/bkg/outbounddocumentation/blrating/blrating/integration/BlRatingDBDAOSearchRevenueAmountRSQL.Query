<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BlRatingDBDAOSearchRevenueAmountRSQL">
			<desc><![CDATA[TEMP테이블상 저장된 Revenue Amount를 조회한다.
Application Date / 경리 환율 기준으로 USD 환산한 값]]></desc>
			<sql><![CDATA[
SELECT ROUND(NVL(SUM(AMT),0), 2)     REV_AMT
     , ROUND(NVL(SUM(OFT_AMT),0), 2) OFT_AMT 
FROM (
        SELECT T.CHG_AMT/NVL(G.USD_LOCL_XCH_RT, C.USD_LOCL_XCH_RT) AMT
             , CASE WHEN T.CHG_CD = 'OFT' 
                    THEN T.CHG_AMT/NVL(G.USD_LOCL_XCH_RT, C.USD_LOCL_XCH_RT) 
                    ELSE 0 END OFT_AMT
        FROM BKG_REV_AUD_CHG_TMP T, 
             GL_MON_XCH_RT G, 
             GL_MON_XCH_RT C
        WHERE T.FRT_INCL_XCLD_DIV_CD = 'N'
        AND G.ACCT_XCH_RT_LVL(+) = '1'
        AND G.CURR_CD(+) = T.CURR_CD
        AND G.ACCT_XCH_RT_YRMON(+) = SUBSTR(NVL(@[rt_aply_dt], TO_CHAR(SYSDATE, 'YYYYMMDD')), 0, 6)
        AND C.CURR_CD = T.CURR_CD
        AND C.ACCT_XCH_RT_LVL = '1'
        AND C.ACCT_XCH_RT_YRMON = (SELECT MAX(ACCT_XCH_RT_YRMON)
                                   FROM GL_MON_XCH_RT
                                   WHERE ACCT_XCH_RT_LVL = '1'
                                   AND CURR_CD = C.CURR_CD)
     )			]]></sql>
			<params>
				<param name="rt_aply_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
