<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ArrivalNoticeDBDAOmergeArrNtcDtlByEdiUSQL">
			<desc><![CDATA[추가하기]]></desc>
			<sql><![CDATA[
MERGE INTO BKG_ARR_NTC_DTL A
USING (SELECT   @[bkg_no]                 AS BKG_NO   
              , @[bkg_cust_tp_cd]         AS BKG_CUST_TP_CD 
              , 'C1'                      AS CUST_CNTC_TP_CD
              , GLOBALDATE_PKG.TIME_CONV_FNC('KRSEL',TO_DATE(sysdate, 'YYYY/MM/DD HH24MISS'),@[ofc_cd] )  AS EDI_SND_DT   
              , GLOBALDATE_PKG.TIME_CONV_FNC('KRSEL',TO_DATE(sysdate, 'YYYY/MM/DD HH24MISS'),'GMT' )      AS EDI_SND_GDT   
              , @[cre_usr_id]             AS EDI_SND_USR_ID  
              , @[cre_usr_id]             AS CRE_USR_ID  
              , SYSDATE                   AS CRE_DT           
              , @[upd_usr_id]             AS UPD_USR_ID 
	      , SYSDATE                   AS UPD_DT    
        FROM DUAL 
      ) B
ON ( A.BKG_NO = B.BKG_NO 
     AND A.BKG_CUST_TP_CD  = B.BKG_CUST_TP_CD
     AND A.CUST_CNTC_TP_CD = B.CUST_CNTC_TP_CD )

WHEN MATCHED THEN
    UPDATE 
    SET  EDI_SND_DT            = B.EDI_SND_DT
       , EDI_SND_GDT           = B.EDI_SND_GDT
       , EDI_SND_USR_ID        = B.EDI_SND_USR_ID
       , UPD_USR_ID            = B.UPD_USR_ID
       , UPD_DT                = B.UPD_DT    
WHEN NOT MATCHED THEN
    INSERT (BKG_NO,BKG_CUST_TP_CD,CUST_CNTC_TP_CD,EDI_SND_DT,EDI_SND_GDT,EDI_SND_USR_ID, CRE_USR_ID,CRE_DT, UPD_USR_ID, UPD_DT) 
    VALUES( B.BKG_NO                  
           ,B.BKG_CUST_TP_CD           
           ,B.CUST_CNTC_TP_CD           
           ,B.EDI_SND_DT           
           ,B.EDI_SND_GDT           
           ,B.EDI_SND_USR_ID           
           ,B.CRE_USR_ID              
           ,B.CRE_DT               
           ,B.UPD_USR_ID
           ,B.UPD_DT
    )			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="bkg_cust_tp_cd" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
