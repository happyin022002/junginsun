<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CLLCDLManifestDBDAOsearchCntrExportTransmitBlRSQL">
			<desc><![CDATA[Container Export EDI 전송시 BL정보를 구하는 쿼리.]]></desc>
			<sql><![CDATA[
SELECT  NVL(BK.bl_no,' ')||NVL(BK.BL_TP_CD,' ') 	BLNBR,
		NVL(B.POL_CD,' ') 	BLPOL,
		C1.LOC_AMS_PORT_CD 	POL_AMS,
		C1.LOC_NM POL_FULLNAME,
		NVL(BK.POD_CD,' ') BLPOD,
		C2.LOC_AMS_PORT_CD POD_AMS,
		C2.LOC_NM POD_FULLNAME,
		NVL(BK.POR_CD,' ') BLPOR,
		C3.LOC_AMS_PORT_CD POR_AMS,
		C3.LOC_NM POR_FULLNAME,
		NVL(BK.DEL_CD,' ') BLDEL,
		C4.LOC_AMS_PORT_CD DEL_AMS,
		C4.LOC_NM DEL_FULLNAME,
		decode(@[form_term_pol],null,NVL(BK.PST_RLY_PORT_CD,' '),NVL(BK.PRE_RLY_PORT_CD,' ')) BLRLY,
		C5.LOC_AMS_PORT_CD RLY_AMS,
		C5.LOC_NM RLY_FULLNAME,
		NVL(E.LOC_CD,' ') BLPLACE,
		NVL(TO_CHAR(I.OBL_ISS_DT,'RRMMDD'),' ') BLDATE,
		DECODE(OL.EUR_TML_PURP_CD,'3','31',OL.EUR_TML_PURP_CD) BRAC,
		NVL(OL.POL_CD,' ') POL,
		NVL(OL.POD_CD,' ') POD,
		DECODE(OL.HLG_TP_CD,'1','1','2','2','3','2',OL.HLG_TP_CD) HAUL_MODE,
		DECODE(OL.BKG_TRSP_MOD_CD,'R','2','T','3','B','8',OL.BKG_TRSP_MOD_CD) TRAN_MODE,
		'230'||NVL(OL.FWRD_AGN_ID,' ') FORWARD_CD,
		BK.OB_SLS_OFC_CD SALES_OFFICE,
		SREP.SREP_NM SALES_NAME,
		P.CNTC_PSON_NM CONTACT_NAME,
		SUBSTR(NVL(CUST_S.CUST_CNT_CD,'  '),1,2) SHPRCN,
		NVL(TO_CHAR(CUST_S.CUST_SEQ), '   ') SHPRCD,
		BKG_TOKEN_NL_FNC(CUST_S.CUST_NM,1,'') SHPR1,
		BKG_TOKEN_NL_FNC(CUST_S.CUST_NM,2,'') SHPR2,
		BKG_TOKEN_NL_FNC(CUST_S.CUST_ADDR,1,'') SHPR3,
		BKG_TOKEN_NL_FNC(CUST_S.CUST_ADDR,2,'') SHPR4,
		BKG_TOKEN_NL_FNC(CUST_S.CUST_ADDR,3,'') SHPR5,
		NVL(CUST_C.CUST_CNT_CD,'') CNEECN,
		DECODE(TO_CHAR(CUST_C.CUST_SEQ),'0','',TO_CHAR(CUST_C.CUST_SEQ)) CNEECD,
		BKG_TOKEN_NL_FNC(CUST_C.CUST_NM,1,'') CNEE1,
		BKG_TOKEN_NL_FNC(CUST_C.CUST_NM,2,'') CNEE2,
		BKG_TOKEN_NL_FNC(CUST_C.CUST_ADDR,1,'') CNEE3,
		BKG_TOKEN_NL_FNC(CUST_C.CUST_ADDR,2,'') CNEE4,
		BKG_TOKEN_NL_FNC(CUST_C.CUST_ADDR,3,'') CNEE5,
		NVL(CUST_N.CUST_CNT_CD,'') NTFYCN,
		DECODE(TO_CHAR(CUST_N.CUST_SEQ),'0','',TO_CHAR(CUST_N.CUST_SEQ)) NTFYCD,
		BKG_TOKEN_NL_FNC(CUST_N.CUST_NM,1,'') NTFY1,
		BKG_TOKEN_NL_FNC(CUST_N.CUST_NM,2,'') NTFY2,
		BKG_TOKEN_NL_FNC(CUST_N.CUST_ADDR,1,'') NTFY3,
		BKG_TOKEN_NL_FNC(CUST_N.CUST_ADDR,2,'') NTFY4,
		BKG_TOKEN_NL_FNC(CUST_N.CUST_ADDR,3,'') NTFY5,
		NVL(CUST_A.CUST_CNT_CD,'') NTFY2CN,
		DECODE(TO_CHAR(CUST_A.CUST_SEQ),'0','',TO_CHAR(CUST_A.CUST_SEQ)) NTFY2CD,
		BKG_TOKEN_NL_FNC(CUST_A.CUST_NM,1,'') NTFY21,
		BKG_TOKEN_NL_FNC(CUST_A.CUST_NM,2,'') NTFY22,
		BKG_TOKEN_NL_FNC(CUST_A.CUST_NM,3,'') NTFY23,
		BKG_TOKEN_NL_FNC(CUST_A.CUST_NM,4,'') NTFY24,
		BKG_TOKEN_NL_FNC(CUST_A.CUST_NM,5,'') NTFY25,
		NVL(CUST_F.CUST_CNT_CD,'') FFWDCN,
		DECODE(TO_CHAR(CUST_F.CUST_SEQ),'0','',TO_CHAR(CUST_F.CUST_SEQ)) FFWDCD,
		BKG_TOKEN_NL_FNC(CUST_F.CUST_NM,1,'') FFWD1,
		BKG_TOKEN_NL_FNC(CUST_F.CUST_NM,2,'') FFWD2,
		BKG_TOKEN_NL_FNC(CUST_F.CUST_NM,3,'') FFWD3,
		BKG_TOKEN_NL_FNC(CUST_F.CUST_NM,4,'') FFWD4,
		BKG_TOKEN_NL_FNC(CUST_F.CUST_NM,5,'') FFWD5,
		NVL(CUST_E.CUST_CNT_CD,'') EXPOCN,
		DECODE(TO_CHAR(CUST_E.CUST_SEQ),'0','',TO_CHAR(CUST_E.CUST_SEQ)) EXPOCD,
		BKG_TOKEN_NL_FNC(CUST_E.CUST_NM,1,'') EXPO1,
		BKG_TOKEN_NL_FNC(CUST_E.CUST_NM,2,'') EXPO2,
		BKG_TOKEN_NL_FNC(CUST_E.CUST_NM,3,'') EXPO3,
		BKG_TOKEN_NL_FNC(CUST_E.CUST_NM,4,'') EXPO4,
		BKG_TOKEN_NL_FNC(CUST_E.CUST_NM,5,'') EXPO5,
		NVL(ISS.BL_CPY_KNT,0) BLCOPY,
		'1' BLORG,
		NVL(F.PCK_QTY,0) BLPKG,
		NVL(F.PCK_TP_CD,' ') BLPKGU,
		NVL(F.ACT_WGT,0) BLWGT,
		NVL(F.WGT_UT_CD,' ') BL_WGT_UNIT,
		NVL(F.MEAS_QTY,0) BLMEA,
		NVL(F.MEAS_UT_CD,' ') BL_MEA_UNIT,
		NVL(BK.rcv_term_CD,' ')||NVL(BK.DE_TERM_CD,' ') RDTYPE,
		NVL(BK.bkg_cgo_tp_CD,' ') CARGOTYPE,
		NVL(BK.cmdt_cd,' ') COMMODITY,
		Translate(NVL(COM.CMDT_NM,' '),chr(13)||chr(10),' ') BLCMD,
		NVL(BK.REP_CMDT_CD,' ') BLREPCMDCD,
		NVL(REP.REP_CMDT_NM,' ') BLREPCMD,
		Translate(NVL(BK.XTER_RMK,' '),chr(13)||chr(10),' ') REMARK,
		NVL(X.AUS_MF_REF_NO,' ') AUS_QUAR,
		'' SRNBR,
		NVL(B.bkg_no,' ') BKGNBR,
		NVL(R2.CUST_REF_NO_CTNT,' ') RGN_BKGNBR,
		NVL(RATE.PPD_RCV_OFC_CD,' ') PPDOFC,
		NVL(RATE.CLT_OFC_CD,' ') CCTOFC,
		'com_id' THDOFC,
		NVL(BK.SC_NO,' ') SCNO,
		NVL(BK.RFA_NO,' ') RFANO,
		'' WAYBILL_IND,
		NVL(R1.CUST_REF_NO_CTNT,' ') CUSTREF_NUM,
		'' FINAL_ETA,
		'' FUNC_CODE,
		'' ONBOARD,
		'' INV_NO,
		'' BLTS,
		'' BLTP,
		'' MSN,
		'' MSNCFM,
		'' CMDESC,
		DECODE(L1.scc_CD, L2.scc_CD, DECODE(SUBSTR(BK.pod_CD,1,2), SUBSTR(BK.del_CD,1,2), 'L', 'I'), 'I') LOCAL_IPI,
		BK.MTY_PKUP_YD_CD EQREL,
		TO_CHAR(bk.MTY_PKUP_DT,'RRRRMMDDHH24MI') EQPICKDT,
		BK.FULL_RTN_YD_CD EQRTN,
		NVL(BK.BKG_CGO_TP_CD,' ') BKG_CGO_TP,
		NVL(BK.DCGO_FLG,' ') DG_FLAG,
		NVL(BK.RC_FLG,' ') RC_FLAG,
		NVL(BK.AWK_CGO_FLG,' ') AK_FLAG,
		NVL(BK.BB_CGO_FLG,' ') BB_FLAG,
		NVL(BK.RD_CGO_FLG,' ') RD_FLAG,
		NVL(BK.cmdt_cd,' ') CMDT_CD,
		Translate(NVL(COM.CMDT_NM,' '),chr(13)||chr(10),' ') CMDT_NM
FROM 	BKG_VVD B,
        BKG_BOOKING BK,
        BKG_BL_DOC F,
        BKG_BL_ISS I,
        bkg_reference R1,
        BKG_REFERENCE R2,
        BKG_RATE RATE,
        BKG_BL_ISS ISS,
        bkg_cntc_pson P,
        BKG_XPT_IMP_LIC X,
        MDM_LOCATION C,
        MDM_LOCATION C1,
        MDM_LOCATION C2,
        MDM_LOCATION C3,
        MDM_LOCATION C4,
        MDM_LOCATION C5,
		MDM_LOCATION L1,
		MDM_LOCATION L2,
        BKG_CUSTOMER CUST_C,
        BKG_CUSTOMER CUST_S,
        BKG_CUSTOMER CUST_N,
        BKG_CUSTOMER CUST_A,
        BKG_CUSTOMER CUST_F,
        BKG_CUSTOMER CUST_E,                      
        MDM_ORGANIZATION E,
        MDM_COMMODITY COM,
		MDM_REP_CMDT REP,
        MDM_SLS_REP SREP,
        BKG_CSTMS_TML_EUR_ORG_LOCL OL
WHERE  	B.BKG_NO		= @[form_bkg_no] and
        B.BKG_NO		= BK.BKG_NO and
        B.BKG_NO		= OL.BKG_NO(+) and
        B.BKG_NO		= F.BKG_NO and
        B.BKG_NO     	= I.BKG_NO(+) AND
        B.BKG_NO    	= R1.BKG_NO(+) AND
        B.BKG_NO     	= R2.BKG_NO(+) AND
        B.BKG_NO     	= RATE.BKG_NO AND
        B.BKG_NO     	= ISS.BKG_NO(+) AND
        B.BKG_NO     	= P.BKG_NO AND
        B.BKG_NO     	= X.BKG_NO(+) AND
        C.loc_cd(+) 	= decode(@[form_term_pol] ,null,B.POL_CD,B.POD_CD) and
        BK.POL_CD 		= C1.loc_cd(+) and
        BK.POD_CD 		= C2.loc_cd(+) and
        BK.POR_CD 		= C3.loc_cd(+) and
        BK.DEL_CD 		= C4.loc_cd(+) and
        DECODE(@[form_term_pol],null,NVL(BK.PST_RLY_PORT_CD,' '),NVL(BK.PRE_RLY_PORT_CD,' ')) = C5.loc_cd(+) and
		BK.POD_CD		= L1.LOC_CD(+) AND
		BK.DEL_CD		= L2.LOC_CD(+) AND
        B.BKG_NO                 	= CUST_C.BKG_NO(+) AND
        CUST_C.BKG_CUST_TP_CD(+) 	= 'C' AND
        B.BKG_NO                 	= CUST_S.BKG_NO(+) AND
        CUST_S.BKG_CUST_TP_CD(+) 	= 'S' AND
        B.BKG_NO                 	= CUST_N.BKG_NO(+) AND
        CUST_N.BKG_CUST_TP_CD(+) 	= 'N' AND
        B.BKG_NO                 	= CUST_A.BKG_NO(+) AND
        CUST_A.BKG_CUST_TP_CD(+) 	= 'A' AND
        B.BKG_NO 					= CUST_F.BKG_NO(+) AND
        CUST_F.BKG_CUST_TP_CD(+) 	= 'F' AND
        B.BKG_NO 					= CUST_E.BKG_NO(+) AND
        CUST_E.BKG_CUST_TP_CD(+) 	= 'E' AND
        NVL(BK.OB_SREP_CD,'X')		= SREP.srep_cd(+) and
        I.OBL_ISS_OFC_CD            = E.ofc_cd(+) and
        BK.CMDT_CD            		= COM.CMDT_CD(+) and
		BK.REP_CMDT_CD              = REP.REP_CMDT_CD(+) AND
        R1.BKG_REF_TP_CD(+) 		= 'EBRF' AND
        R2.BKG_REF_TP_CD(+) 		= 'PSAN' AND
        P.BKG_CNTC_PSON_TP_CD 		= 'BK' AND
        ROWNUM = 1			]]></sql>
			<params>
				<param name="form_term_pol" type="12" value="" out="N"/>
				<param name="form_bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
