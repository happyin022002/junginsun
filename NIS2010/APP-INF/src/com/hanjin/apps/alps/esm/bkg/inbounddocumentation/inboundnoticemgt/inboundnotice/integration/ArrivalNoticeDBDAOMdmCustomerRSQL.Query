<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ArrivalNoticeDBDAOMdmCustomerRSQL">
			<desc><![CDATA[...]]></desc>
			<sql><![CDATA[
SELECT /*+ USE_NL(A B C D) */  
       A.CUST_CNT_CD || LPAD(A.CUST_SEQ,6,'0') AS CUST_CD
      ,CUST_LGL_ENG_NM
      ,A.CUST_CNT_CD
      ,C.CTY_NM
      ,C.BZET_ADDR
      ,B.PHN_NO
      ,B.FAX_NO
      ,B.CUST_EML
      ,CUST_STS_CD
      ,DECODE(D.CUST_RLSE_CTRL_FLG,'N','No','Y','Yes',NULL,'No',D.CUST_RLSE_CTRL_FLG) BOOKING_ALERT_TO_DATE
      ,A.CRE_DT
      ,SREP_CD
      ,OFC_CD
      ,A.CUST_SEQ
      ,CASE WHEN A.DELT_FLG = 'Y' OR A.SLS_DELT_EFF_DT IS NOT NULL THEN A.MODI_CUST_CNT_CD||LPAD(MODI_CUST_SEQ,6,'0')
            ELSE ''
       END AS MRG_CD
      ,A.FRT_FWRD_FMC_NO                  AS FF_FMC_NO
      ,(
        CASE
          WHEN A.DELT_FLG = 'Y' THEN 'Yes'
          WHEN A.SLS_DELT_EFF_DT IS NOT NULL THEN 'Yes'
        ELSE 'No'
        END 
        ) AS NO_USE               
       ,   DECODE(A.RVIS_CNTR_CUST_TP_CD, 'B', 'BCO', 'NON BCO') CUST_DIV_FLAG
       , C.ZIP_CD
       , C.STE_CD
       ,F.LOC_CD || '-' || F.LOC_NM as LOCATION_CODE           
  FROM MDM_CUSTOMER      A
      ,MDM_CUST_CNTC_PNT B
      ,MDM_CUST_ADDR     C
      ,MDM_CR_CUST       D
      ,MDM_LOCATION      F
 WHERE 1 = 1
   AND NVL(A.NMD_CUST_FLG,'N')  <> 'Y'
   AND B.CUST_CNT_CD    = A.CUST_CNT_CD 
   AND B.CUST_SEQ       = A.CUST_SEQ 
   AND C.CUST_CNT_CD    = A.CUST_CNT_CD
   AND C.CUST_SEQ       = A.CUST_SEQ 
   AND C.PRMRY_CHK_FLG = 'Y'
   AND D.CUST_CNT_CD(+) = A.CUST_CNT_CD
   AND D.CUST_SEQ(+)    = A.CUST_SEQ    

   /* 2014.12.19 ����������������� ������������ ����������������� SUB_SYS_NM����� ERP����� ������������ ����������������� ������������ ����� */
   AND NVL(D.SUB_SYS_NM(+),'MDM') != 'ERP'

   AND A.DELT_FLG = 'N'
 AND A.LOC_CD = F.LOC_CD(+)


#if (${cust_cnt_cd} != '' ) 
  AND A.CUST_CNT_CD = @[cust_cnt_cd]
#end

#if (${cust_seq} != '')   
  AND A.CUST_SEQ = TO_NUMBER(@[cust_seq])
#end

#if (${cust_lgl_eng_nm} != '') 
 #if(${include} != '')
  AND (REGEXP_REPLACE(UPPER(A.CUST_LGL_ENG_NM),'[^a-zA-Z0-9]','')  LIKE '%'||REGEXP_REPLACE(UPPER(@[cust_lgl_eng_nm]),'[^a-zA-Z0-9]','')||'%')
 #else
  AND UPPER(A.CUST_LGL_ENG_NM) LIKE UPPER(@[cust_lgl_eng_nm]) || '%'
 #end
#end

#if (${cust_cnt_cd_ext} != '') 
  AND A.CUST_CNT_CD = @[cust_cnt_cd_ext]
#end

#if (${ofc_cd} != '')  
 AND A.OFC_CD= UPPER(@[ofc_cd])
#end 

#if (${cust_sts_cd} != '')  
 AND A.CUST_STS_CD = @[cust_sts_cd]
#end

#if (${ste_cd} != '')  
 AND UPPER(C.STE_CD) = UPPER(@[ste_cd])
#end

#if (${cty_nm} != '')
 AND UPPER(C.CTY_NM) = UPPER(@[cty_nm])
#end

#if (${zip_cd} != '')
 AND C.ZIP_CD = @[zip_cd]
#end

#if (${no_use} != '') 
 AND (A.SLS_DELT_EFF_DT IS NULL OR A.SLS_DELT_EFF_DT IS NOT NULL )
#else
 AND (A.SLS_DELT_EFF_DT IS NULL AND A.DELT_FLG ='N')
#end

#if (${bklst} != '') 
 AND NVL(D.CUST_RLSE_CTRL_FLG, 'N') IN ('N','Y')
#else
 AND NVL(D.CUST_RLSE_CTRL_FLG, 'N') = 'N'
#end

#if (${cre_limit} != '') 

#else
AND NVL(A.SLS_DELT_EFF_RSN_CD ,'XX') <>'07'
 
#end			]]></sql>
			<params>
				<param name="cust_cnt_cd" type="12" value="" out="N"/>
				<param name="cust_seq" type="12" value="" out="N"/>
				<param name="cust_lgl_eng_nm" type="12" value="" out="N"/>
				<param name="cust_cnt_cd_ext" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="cust_sts_cd" type="12" value="" out="N"/>
				<param name="ste_cd" type="12" value="" out="N"/>
				<param name="cty_nm" type="12" value="" out="N"/>
				<param name="zip_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
