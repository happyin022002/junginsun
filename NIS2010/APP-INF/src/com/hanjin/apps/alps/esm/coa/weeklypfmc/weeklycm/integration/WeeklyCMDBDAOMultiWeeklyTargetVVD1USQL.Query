<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WeeklyCMDBDAOMultiWeeklyTargetVVD1USQL">
			<desc><![CDATA[MultiWeeklyTargetVVD UPDATE1]]></desc>
			<sql><![CDATA[
UPDATE COA_MON_VVD
SET (LST_LODG_PORT_ETD_DT, N1ST_LODG_PORT_ETD_DT)
  = (
     SELECT MAX(LST_LODG_PORT_ETD_DT), MAX(N1ST_LODG_PORT_ETD_DT)
     FROM (
         SELECT null LST_LODG_PORT_ETD_DT, MIN(VPS_ETD_DT) N1ST_LODG_PORT_ETD_DT
         FROM VSK_VSL_PORT_SKD
         WHERE VSL_CD      = @[vsl_cd]
           AND SKD_VOY_NO  = @[skd_voy_no]
           AND SKD_DIR_CD  = @[skd_dir_cd]
         UNION ALL
         SELECT VPS_ETD_DT LST_LODG_PORT_ETD_DT, null N1ST_LODG_PORT_ETD_DT
         FROM VSK_VSL_PORT_SKD
         WHERE VSL_CD      = @[vsl_cd]
           AND SKD_VOY_NO  = @[skd_voy_no]
           AND SKD_DIR_CD  = @[skd_dir_cd]
           AND VPS_PORT_CD = @[vps_port_cd]
         )
    )
WHERE TRD_CD     = @[trd_cd]
  AND RLANE_CD   = @[rlane_cd]
  AND IOC_CD     = @[ioc_cd]
  AND VSL_CD     = @[vsl_cd]
  AND SKD_VOY_NO = @[skd_voy_no]
  AND DIR_CD     = @[dir_cd]			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="Y"/>
				<param name="skd_voy_no" type="12" value="" out="Y"/>
				<param name="skd_dir_cd" type="12" value="" out="Y"/>
				<param name="vps_port_cd" type="12" value="" out="Y"/>
				<param name="trd_cd" type="12" value="" out="Y"/>
				<param name="rlane_cd" type="12" value="" out="Y"/>
				<param name="ioc_cd" type="12" value="" out="Y"/>
				<param name="dir_cd" type="12" value="" out="Y"/>
			</params>
		</query>
	</querys>
</sqls>
