<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralBookingReceiptDBDAOSearchTsCloseNoticeRSQL">
			<desc><![CDATA[T/S Close Notice에 대해서 수신인 email address를 찾는다]]></desc>
			<sql><![CDATA[
SELECT (SELECT NVL(USR_EML, DFLT_EML) 
          FROM COM_USER USR, BKG_BOOKING BK 
         WHERE BK.DOC_USR_ID = USR.USR_ID
           AND BK.BKG_NO = @[bkg_no]) ORG_RCVR_EML
     , A.RCVR_EML TS_RCVR_EML
     , SKD.VSL_CD||SKD.SKD_VOY_NO||SKD.SKD_DIR_CD VVD
	 , @[bkg_no] BKG_NO
  FROM BKG_CLL_CNG_NTFY_SET A, VSK_VSL_SKD SKD
 WHERE LOCL_TS_IND_CD = 'T'
   AND A.SLAN_CD = SKD.VSL_SLAN_CD 
   AND A.DIR_CD  = SKD.SKD_DIR_CD   
   AND SKD.VSL_CD || SKD.SKD_VOY_NO || SKD.SKD_DIR_CD
		IN (
#foreach( ${vvd} in ${closed_vvds}) 
	#if($velocityCount < $closed_vvds.size()) '$vvd', #else '$vvd' #end
#end
		)			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
