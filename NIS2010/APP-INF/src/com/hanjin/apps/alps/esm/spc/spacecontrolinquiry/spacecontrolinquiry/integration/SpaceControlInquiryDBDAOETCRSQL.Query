<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SpaceControlInquiryDBDAOETCRSQL">
			<desc><![CDATA[ETC Data]]></desc>
			<sql><![CDATA[
SELECT ROWNUM AS NUM,
         Z.COST_YR    ,
         Z.COST_WK1   ,
         Z.SLS_FM_DT  ,
         Z.SLS_TO_DT
#if (${mon_flg} == 'Y')
FROM (
            SELECT T.COST_YR   AS COST_YR  ,
                   T.COST_WK   AS COST_WK1 ,
                   T.SLS_FM_DT AS SLS_FM_DT,
                   T.SLS_TO_DT AS SLS_TO_DT
              FROM MAS_WK_PRD T
              WHERE T.COST_YR||T.COST_WK >= (SELECT MIN(DISTINCT(SUBSTR(SLS_YRMON, 1,4)||COST_WK))
                								FROM MAS_MON_VVD
												WHERE COST_YRMON = @[rev_month]
												AND TRD_CD = @[trade]
--               								WHERE SLS_YRMON = '201301'
                                                AND DELT_FLG = 'N')
               AND T.COST_YR||T.COST_WK <= (SELECT MAX(DISTINCT(SUBSTR(SLS_YRMON, 1,4)||COST_WK))
                								FROM MAS_MON_VVD
												WHERE COST_YRMON = @[rev_month]
												AND TRD_CD = @[trade]
--               								WHERE SLS_YRMON = '201301'
                                                AND DELT_FLG = 'N')
          ORDER BY T.COST_YR||T.COST_WK
         ) Z
ORDER BY NUM     ,
         COST_YR ,
         COST_WK1
#else 
FROM (
            SELECT T.COST_YR   AS COST_YR  ,
                   T.COST_WK   AS COST_WK1 ,
                   T.SLS_FM_DT AS SLS_FM_DT,
                   T.SLS_TO_DT AS SLS_TO_DT
              FROM MAS_WK_PRD T
             WHERE T.COST_YR||T.COST_WK >= @[year]||@[week]
          ORDER BY T.COST_YR||T.COST_WK
         ) Z
   WHERE ROWNUM <= @[duration]
ORDER BY NUM     ,
         COST_YR ,
         COST_WK1
#end			]]></sql>
			<params>
				<param name="rev_month" type="12" value="" out="N"/>
				<param name="trade" type="12" value="" out="N"/>
				<param name="year" type="12" value="" out="N"/>
				<param name="week" type="12" value="" out="N"/>
				<param name="duration" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
