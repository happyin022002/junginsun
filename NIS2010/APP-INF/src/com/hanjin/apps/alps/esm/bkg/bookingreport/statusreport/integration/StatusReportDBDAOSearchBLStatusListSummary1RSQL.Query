<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="StatusReportDBDAOSearchBLStatusListSummary1RSQL">
			<desc><![CDATA[StatusReportDBDAOSearchBLStatusListSummary1RSQL]]></desc>
			<sql><![CDATA[
SELECT 
                  SUM(F_BKG_QTY) OVER( PARTITION BY ORDERBY_TITLE ) AS SUB_F_BKG_QTY
                , SUM(F_TEU)     OVER( PARTITION BY ORDERBY_TITLE ) AS SUB_F_TEU
                , SUM(P_BKG_QTY) OVER( PARTITION BY ORDERBY_TITLE ) AS SUB_P_BKG_QTY
                , SUM(P_TEU)     OVER( PARTITION BY ORDERBY_TITLE ) AS SUB_P_TEU
                , SUM(R_BKG_QTY) OVER( PARTITION BY ORDERBY_TITLE ) AS SUB_R_BKG_QTY
                , SUM(R_TEU)     OVER( PARTITION BY ORDERBY_TITLE ) AS SUB_R_TEU
                , SUM(T_BKG_QTY) OVER( PARTITION BY ORDERBY_TITLE ) AS SUB_T_BKG_QTY
                , SUM(T_TEU)     OVER( PARTITION BY ORDERBY_TITLE ) AS SUB_T_TEU
                , SUM(BKG_CNT)   OVER( PARTITION BY ORDERBY_TITLE ) AS SUB_BKG_CNT
                , SUM(F_BKG_QTY) OVER() AS GRD_F_BKG_QTY
                , SUM(F_TEU)     OVER() AS GRD_F_TEU
                , SUM(P_BKG_QTY) OVER() AS GRD_P_BKG_QTY
                , SUM(P_TEU)     OVER() AS GRD_P_TEU
                , SUM(R_BKG_QTY) OVER() AS GRD_R_BKG_QTY
                , SUM(R_TEU)     OVER() AS GRD_R_TEU
                , SUM(T_BKG_QTY) OVER() AS GRD_T_BKG_QTY
                , SUM(T_TEU)     OVER() AS GRD_T_TEU
                , SUM(BKG_CNT)   OVER() AS GRD_BKG_CNT   
				, Y.*	
FROM (
        SELECT
                    SUM(DECODE(BKG_CGO_TP_CD, 'F', 1, 0) * OP_CNTR_QTY)                  AS F_BKG_QTY
                   ,SUM(DECODE(BKG_CGO_TP_CD, 'F',
                        DECODE(SUBSTR(TP_SZ,-1),'2',OP_CNTR_QTY,OP_CNTR_QTY*2)
                        ,0))                                                             AS F_TEU
                        
                   ,SUM(DECODE(BKG_CGO_TP_CD, 'P', 1, 0) * OP_CNTR_QTY)                  AS P_BKG_QTY
                   ,SUM(DECODE(BKG_CGO_TP_CD, 'P',
                        DECODE(SUBSTR(TP_SZ,-1),'2',OP_CNTR_QTY,OP_CNTR_QTY*2)
                        ,0))                                                             AS P_TEU
                        
                   ,SUM(DECODE(BKG_CGO_TP_CD, 'R', 1, 0) * OP_CNTR_QTY)                  AS R_BKG_QTY
                   ,SUM(DECODE(BKG_CGO_TP_CD, 'R',
                        DECODE(SUBSTR(TP_SZ,-1),'2',OP_CNTR_QTY,OP_CNTR_QTY*2)
                        ,0))                                                             AS R_TEU
                             
                  ,SUM(OP_CNTR_QTY)                                                      AS T_BKG_QTY
                  ,SUM(
                        DECODE(SUBSTR(TP_SZ,-1),'2',OP_CNTR_QTY,OP_CNTR_QTY*2)
                        )                                                                AS T_TEU
                        
                  ,COUNT(DISTINCT BKG_NO )                                               AS BKG_CNT                 
              , ORDERBY_TITLE
			  , TP_SZ
        FROM (
				SELECT ${orderby_title_sql} AS ORDERBY_TITLE
                       , K.*
                FROM (
                    SELECT /*+ RULE */
                           			 DISTINCT
                           			 NVL(BKG_QTY.CNTR_TPSZ_CD, 'Not Match') AS TP_SZ
                                   , VB.BKG_CGO_TP_CD
                                   , BKG_QTY.OP_CNTR_QTY
                                   , VB.BKG_NO

                                    /****************** FOR SORT START *****************/
                                 , VB.SPLIT_FLG
                                 , VB.BKG_STS_CD AS BST_FLG
                                 , VB.BDR_FLG AS BDR_FLG
    
                                 /* BL_NO */
                                ,VB.BL_NO||VB.BL_TP_CD AS BL_NO
                                , REPLACE(VB.SHPR_NAME,CHR(13)||CHR(10),' ') AS SHPR_NAME
                                , VB.CUST_TO_ORD_FLG AS CUST_TO_ORD_FLG
                                , REPLACE(VB.CONSIGNEE_NAME,CHR(13)||CHR(10),' ') AS CONSIGNEE_NAME
                                , REPLACE(VB.NTFY_NAME,CHR(13)||CHR(10),' ') AS NTFY_NAME
                                , VB.CMDT_CD         AS COMMODITY
                                , VB.REP_CMDT_CD     AS REP
                                , NVL(VB.PCK_QTY,0)     AS PCK_QTY
                                , VB.PCK_TP_CD  AS PCK_TP_CD
                                  /* R */
                                , VB.RCV_TERM_CD     AS RCV_TERM_CD
                                  /* D */
                                , VB.DE_TERM_CD      AS DE_TERM_CD
                                  /* BKG STF */
                                , VB.DOC_USR_ID   AS BKG_STF
                                  /* SREP */
                                , VB.OB_SREP_CD AS OB_SREP_CD
                                  /* BKG OFC */
                                , VB.BKG_OFC_CD AS BKG_OFC_CD
                                  /* S/OFC */
                                , VB.OB_SLS_OFC_CD OB_SLS_OFC_CD
     
                                , VB.TRUNK_VVD TRUNK_VVD
                                , VB.ORG_TRNS_SVC_MOD_CD    AS ORG_TRNS_SVC_MOD_CD
                                , VB.DEST_TRNS_SVC_MOD_CD   AS DEST_TRNS_SVC_MOD_CD
                                , VB.ORG_SCONTI_CD          AS ORG_SVC_ROUTE
                                , VB.DEST_SCONTI_CD         AS DEST_SVC_ROUTE
                                , VB.KEY_POL_CD           AS POL_CD
                                , VB.KEY_POD_CD           AS POD_CD
                                , VB.PRE_1_VVD        AS PRE_1_VVD
                                , VB.PRE_2_VVD        AS PRE_2_VVD
                                , VB.PRE_3_VVD        AS PRE_3_VVD
                                , VB.PRE_4_VVD        AS PRE_4_VVD
                                , VB.POST_1_VVD       AS POST_1_VVD
                                , VB.POST_2_VVD       AS POST_2_VVD
                                , VB.POST_3_VVD       AS POST_3_VVD
                                , VB.POST_4_VVD       AS POST_4_VVD
                                , VB.PRE_1_POL_CD     AS PRE_1_POL_CD
                                , VB.PRE_2_POL_CD     AS PRE_2_POL_CD
                                , VB.PRE_3_POL_CD     AS PRE_3_POL_CD
                                , VB.PRE_4_POL_CD     AS PRE_4_POL_CD
                                , VB.PRE_1_POD_CD     AS PRE_1_POD_CD
                                , VB.PRE_2_POD_CD     AS PRE_2_POD_CD
                                , VB.PRE_3_POD_CD     AS PRE_3_POD_CD
                                , VB.PRE_4_POD_CD     AS PRE_4_POD_CD
                                , VB.POST_1_POL_CD    AS POST_1_POL_CD
                                , VB.POST_2_POL_CD    AS POST_2_POL_CD
                                , VB.POST_3_POL_CD    AS POST_3_POL_CD
                                , VB.POST_4_POL_CD    AS POST_4_POL_CD
                                , VB.POST_1_POD_CD    AS POST_1_POD_CD
                                , VB.POST_2_POD_CD    AS POST_2_POD_CD
                                , VB.POST_3_POD_CD    AS POST_3_POD_CD
                                , VB.POST_4_POD_CD    AS POST_4_POD_CD
                                , VB.SI_FLG          AS SI_FLG
                                , VB.BKG_CLZ_FLG      AS BKG_CLZ_FLG
                                , VB.ANTY_NAME        AS ANTY_NAME
                                , VB.FFDR_NAME        AS FFDR_NAME
                                , VB.EXPT_NAME        AS EXPT_NAME
                                , VB.HNGR_FLG         AS HNGR_FLG
                                  /* AK */
                                , VB.AWK_CGO_FLG      AS AWK_CGO_FLG
                                  /* HT */
                                , VB.HOT_DE_FLG       AS HOT_DE_FLG
                                  /* RC */
                                , VB.RC_FLG           AS RC_FLG
                                  /* BB */
                                , VB.BB_CGO_FLG       AS BB_CGO_FLG  
                                , VB.SOC_FLG          AS SOC_FLG
                                , VB.EQ_SUBST_FLG     AS EQ_SUBST_FLG
                                /* RF */
                                , VB.RD_CGO_FLG       AS RD_CGO_FLG
                                /* DG */
                                , VB.DCGO_FLG         AS DCGO_FLG
                                , VB.SLAN_CD                AS SLAN_CD
                                , TO_CHAR(VB.BKG_CRE_DT,'YYYY-MM-DD')  AS BKG_CRE_DT
                                , NVL(DECODE(VB.SHIPPER,'0',' ',SUBSTR(VB.SHIPPER,1,2)||LTRIM(TO_CHAR(SUBSTR(VB.SHIPPER,3),'000000'))),' ')        AS SHIPPER
                                , NVL(DECODE(VB.CONSIGNEE,'0',' ',SUBSTR(VB.CONSIGNEE,1,2)||LTRIM(TO_CHAR(SUBSTR(VB.CONSIGNEE,3),'000000'))),' ')  AS CONSIGNEE
                                , NVL(DECODE(VB.NTFY,'0',' ',SUBSTR(VB.NTFY,1,2)||LTRIM(TO_CHAR(SUBSTR(VB.NTFY,3),'000000'))),' ') AS NTFY
                                , NVL(DECODE(VB.FFDR,'0',' ',SUBSTR(VB.FFDR,1,2)||LTRIM(TO_CHAR(SUBSTR(VB.FFDR,3),'000000'))),' ') AS FFDR
                         
                                    
                                    , VB.DEL_CD
                                    , VB.POD_CD    AS ACTUAL_POD
                                    , VB.POL_CD    AS ACTUAL_POL
                                    , VB.BKG_STS_CD      AS BKG_STS_CD
                                    , VB.CHN_AGN_CD AS CHINA_AGENT_CD
                                    , (SELECT  CMDT_NM  FROM MDM_COMMODITY  WHERE CMDT_CD = VB.CMDT_CD)          AS CMDT_NM
                                    , REPLACE(VB.CONSIGNEE_NAME,CHR(13)||CHR(10),' ') AS CNEE_NAME
                                    , VB.CTRT_OFC_CD     AS CTRT_OFC_CD
                                    , VB.CTRT_SREP_CD    AS CTRT_SREP_CD
                                    , ( SELECT EQ_CTRL_OFC_CD FROM MDM_LOCATION WHERE LOC_CD = VB.DEL_CD )      AS DEL_EQ_OFC
                                    , VB.DOC_USR_ID      AS DOC_USR_ID
                                    , VB.POR_CD          AS POR_CD
                                    , ( SELECT EQ_CTRL_OFC_CD FROM MDM_LOCATION WHERE LOC_CD = VB.POR_CD )      AS POR_EQ_OFC
                                    , NVL(VB.RFA_NO,' ') AS RFA_NO
                                    , SUBSTR(NVL(VB.SC_NO, ' '), 1, 8)        AS SC_NO
                                    , DECODE(VB.PRE_1_POL_CD,NULL,' ',NVL(VB.PRE_1_POL_CD,' '),
                                            DECODE(VB.PRE_2_POL_CD,NULL,NVL(VB.PRE_1_POL_CD,' '),
                                            DECODE(VB.PRE_3_POL_CD,NULL,NVL(VB.PRE_2_POL_CD,' '),
                                             DECODE(VB.PRE_4_POL_CD,NULL,NVL(VB.PRE_3_POL_CD,' '),NVL(VB.PRE_4_POL_CD,' ')))))   AS SORT_PRE_POL
                                    , DECODE(VB.PRE_1_POD_CD, NULL,' ',
                                            DECODE(VB.PRE_2_POD_CD,NULL,NVL(VB.PRE_1_POD_CD,' '),
                                             DECODE(VB.PRE_3_POD_CD,NULL,NVL(VB.PRE_2_POD_CD,' '),
                                             DECODE(VB.PRE_4_POD_CD,NULL,NVL(VB.PRE_3_POD_CD,' '),NVL(VB.PRE_4_POD_CD,' ')))))   AS SORT_PRE_POD
                                    , DECODE(VB.POST_1_POL_CD,NULL,' ',
                                           DECODE(VB.POST_2_POL_CD,NULL,NVL(VB.POST_1_POL_CD,' '),
                                             DECODE(VB.POST_3_POL_CD,NULL,NVL(VB.POST_2_POL_CD,' '),
                                             DECODE(VB.POST_4_POL_CD,NULL,NVL(VB.POST_3_POL_CD,' '),NVL(VB.POST_4_POL_CD,' '))))) AS SORT_POST_POL
                                    , DECODE(VB.POST_1_POD_CD,NULL,' ',
                                             DECODE(VB.POST_2_POD_CD,NULL,NVL(VB.POST_1_POD_CD,' '),
                                             DECODE(VB.POST_3_POD_CD,NULL,NVL(VB.POST_2_POD_CD,' '),
                                             DECODE(VB.POST_4_POD_CD,NULL,NVL(VB.POST_3_POD_CD,' '),NVL(VB.POST_4_POD_CD,' '))))) AS SORT_POST_POD

                                    , DECODE(VB.PRE_2_VVD,NULL,VB.PRE_1_VVD,
                                             DECODE(VB.PRE_3_VVD,NULL,VB.PRE_2_VVD, DECODE(VB.PRE_4_VVD,NULL,VB.PRE_3_VVD,VB.PRE_4_VVD) ))   AS SORT_PRE_VVD
                                             
                                    , DECODE(VB.POST_1_VVD,NULL,' ', 
                                            DECODE(VB.POST_2_VVD,NULL,VB.POST_1_VVD, 
                                            DECODE(VB.POST_3_VVD,NULL,VB.POST_2_VVD,
                                            DECODE(VB.POST_4_VVD,NULL,VB.POST_3_VVD,VB.POST_4_VVD)))) AS SORT_POST_VVD


                                     , VB.TRUNK_POD        AS TRUNK_POD
                                     , VB.TRUNK_POL        AS TRUNK_POL

                                 ,  (SELECT  COUNT(1) VVD_COUNT
                                     FROM BKG_VVD
                                     WHERE BKG_NO           = VB.BKG_NO
                                     AND VSL_CD IS NOT NULL)VVD_CNT

                                 ,  (SELECT   COUNT(1) SKD_COUNT
                                     FROM VSK_VSL_PORT_SKD POL,
                                          VSK_VSL_PORT_SKD POD,
                                          BKG_VVD VVD
                                     WHERE BKG_NO           = VB.BKG_NO
                                     AND VVD.VSL_CD       = POL.VSL_CD
                                     AND VVD.SKD_VOY_NO   = POL.SKD_VOY_NO
                                     AND VVD.SKD_DIR_CD   = POL.SKD_DIR_CD
                                     AND VVD.POL_CD       = POL.VPS_PORT_CD
                                     AND NVL(VVD.POL_CLPT_IND_SEQ, 1) = POL.CLPT_IND_SEQ
                                     AND NVL(POL.SKD_CNG_STS_CD, 'X') <> 'S'
                                     AND VVD.VSL_CD       = POD.VSL_CD
                                     AND VVD.SKD_VOY_NO   = POD.SKD_VOY_NO
                                     AND VVD.SKD_DIR_CD   = POD.SKD_DIR_CD
                                     AND VVD.POD_CD       = POD.VPS_PORT_CD
                                     AND NVL(VVD.POD_CLPT_IND_SEQ, 1) = POD.CLPT_IND_SEQ
                                     AND NVL(POD.SKD_CNG_STS_CD, 'X') <> 'S') SKD_CNT
                                  /****************** FOR SORT END *****************/                           
                    FROM   BKG_QUANTITY BKG_QTY--BKG_QTY
                          #if (${vvd_cd} != '')
                			, BKG_WORK_V VB
						  #else
							, (SELECT 
                                                      B.BKG_NO,
                                                      B.BKG_CGO_TP_CD,
                                                      B.BL_NO,     
                                                      B.BL_TP_CD,
                                                      D.BL_OBRD_TP_CD BL_TP,
                                                      D.BL_OBRD_DT,
                                                      B.SI_FLG,
                                                      B.BKG_OFC_CD,
                                                      B.EQ_CTRL_OFC_CD,
                                                      D.BKG_CLZ_FLG,
                                                      B.DOC_USR_ID,
                                                      B.OB_SLS_OFC_CD,
                                                      B.OB_SREP_CD,
                                                      B.CTRT_SREP_CD CTRT_SREP_CD,
                                                      B.RCV_TERM_CD,
                                                      B.DE_TERM_CD,
                                                      B.ORG_TRNS_SVC_MOD_CD,                          
                                                      B.DEST_TRNS_SVC_MOD_CD,
                                                      B.ORG_SCONTI_CD,
                                                      B.DEST_SCONTI_CD,
                                                      B.BKG_STS_CD,
                                                      B.FM_BKG_NO,
                                                      B.SPLIT_RSN_CD,
                                                      B.ADV_SHTG_CD,
                                                      B.SPLIT_FLG,
                                                      (SELECT max(DOC_DTL.EVNT_DT)
                                                         FROM BKG_DOC_PROC_SKD DOC_DTL
                                                        WHERE DOC_DTL.BKG_NO = B.BKG_NO
                                                          AND BKG_DOC_PROC_TP_CD = 'BKGHOT') HOT_DT ,
                                                      B.BKG_CRE_DT,
                                                      B.TWN_SO_NO,
                                                      B.REV_DIR_CD,
                                                      B.SLAN_CD,
                                                      B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD TRUNK_VVD,
                                                      B.VSL_CD,
                                                      B.SKD_VOY_NO,
                                                      B.SKD_DIR_CD,
                                                      B.POR_NOD_CD AS POR_NODE,
                                                      B.POR_CD,
                                                      B.POL_CD,
                                                      B.POD_CD,
                                                      B.DEL_CD,
                                                      B.DEL_NOD_CD,
                                                      B.FNL_DEST_CD,
                                                      DECODE ((
                                                            SELECT DOC_DTL.DOC_PROC_SEQ
                                                            FROM BKG_DOC_PROC_SKD DOC_DTL
                                                            WHERE DOC_DTL.BKG_NO = B.BKG_NO
                                                              AND BKG_DOC_PROC_TP_CD = 'CMCNTR'
                                                              AND ROWNUM = 1 ), NULL, 'N', 'Y') BKG_CM_FRM ,
                                                      DECODE ((
                                                            SELECT DOC_DTL.DOC_PROC_SEQ
                                                            FROM BKG_DOC_PROC_SKD DOC_DTL
                                                            WHERE DOC_DTL.BKG_NO = B.BKG_NO
                                                              AND BKG_DOC_PROC_TP_CD = 'CNTCFM'
                                                              AND ROWNUM = 1 ), NULL, 'N', 'Y') BKG_CM_FRM,
                                                      D.PCK_QTY,
                                                      D.PCK_TP_CD,
                                                      B.XTER_RMK,
                                                      D.MEAS_QTY,
                                                      D.MEAS_UT_CD,
                                                      D.BDR_FLG,
                                                      B.PRE_RLY_PORT_CD,
                                                      B.PST_RLY_PORT_CD,
                                                      D.ACT_WGT,
                                                      D.WGT_UT_CD,
                                                      B.CHN_AGN_CD,
                                                      D.BDR_CNG_FLG,
                                                      (SELECT max(DOC_DTL.EVNT_DT)
                                                         FROM BKG_DOC_PROC_SKD DOC_DTL
                                                        WHERE DOC_DTL.BKG_NO = B.BKG_NO
                                                          AND BKG_DOC_PROC_TP_CD = 'CNTCFM' ) BKG_CGO_DT,
                                                      CNTC.CNTC_PSON_NM,
                                                      CNTC.CNTC_PSON_PHN_NO,
                                                      CNTC.CNTC_PSON_FAX_NO,
                                                      CNTC.CNTC_PSON_EML,
                                                      B.XTER_BKG_RQST_CD,
                                                      (SELECT FRT_TERM_CD
                                                         FROM BKG_RATE R
                                                        WHERE R.BKG_NO = B.BKG_NO) FRT_TERM_CD,
                                                      B.SC_NO,
                                                      B.RFA_NO,
                                                      B.TAA_NO,
                                                      B.CTRT_OFC_CD,
                                                      S.CUST_NM SHPR_NAME,
                                                      S.CUST_CNT_CD||S.CUST_SEQ SHIPPER,
                                                      S.CUST_NM,
                                                      S.CUST_ADDR S_ADDR,
                                                      S.BKG_CUST_TP_CD S_CUST_TP,
                                                      C.CUST_CNT_CD||C.CUST_SEQ CONSIGNEE,
                                                      C.CUST_NM CONSIGNEE_NAME,
                                                      C.CUST_ADDR C_ADDR,
                                                      B.CUST_TO_ORD_FLG,
                                                      F.CUST_CNT_CD||F.CUST_SEQ FFDR,
                                                      F.CUST_NM FFDR_NAME,
                                                      F.BKG_CUST_TP_CD S_CUST_TP,
                                                      N.CUST_CNT_CD||N.CUST_SEQ NTFY,
                                                      N.CUST_NM NTFY_NAME,
                                                      N.CUST_ADDR N_ADDR,
                                                      N.BKG_CUST_TP_CD N_CUST_TP,
                                                      (SELECT CUST_NM FROM BKG_CUSTOMER A WHERE A.BKG_CUST_TP_CD(+) ='A' AND B.BKG_NO = A.BKG_NO(+)) ANTY_NAME,
                                                      (SELECT CUST_NM FROM BKG_CUSTOMER A WHERE A.BKG_CUST_TP_CD(+) ='E' AND B.BKG_NO = A.BKG_NO(+)) EXPT_NAME,
                                                      VVD.VSL_CD KEY_VSL_CD,
                                                      VVD.SKD_VOY_NO KEY_SKD_VOY_NO,
                                                      VVD.SKD_DIR_CD KEY_SKD_DIR_CD,
                                                      VVD.POL_CD KEY_POL_CD,
                                                      VVD.POD_CD KEY_POD_CD,
                                                      VVD.POL_YD_CD KEY_POL_YD_CD,
                                                      VVD.POD_YD_CD KEY_POD_YD_CD,
													  D.POL_CD DOC_POL_CD,
													  D.POD_CD DOC_POD_CD,
                                                      VVD.VSL_PRE_PST_CD,
                                                      V1.VSL_CD||V1.SKD_VOY_NO||V1.SKD_DIR_CD PRE_1_VVD,
                                                      V1.POL_CD PRE_1_POL_CD,
                                                      V1.POD_CD PRE_1_POD_CD,
                                                      V2.VSL_CD||V2.SKD_VOY_NO||V2.SKD_DIR_CD PRE_2_VVD,
                                                      V2.POL_CD PRE_2_POL_cd,
                                                      V2.POD_CD PRE_2_POD_cd,
                                                      V3.VSL_CD||V3.SKD_VOY_NO||V3.SKD_DIR_CD PRE_3_VVD,
                                                      V3.POL_CD PRE_3_POL_CD,
                                                      V3.POD_CD PRE_3_POD_CD,
                                                      V4.VSL_CD||V4.SKD_VOY_NO||V4.SKD_DIR_CD PRE_4_VVD,
                                                      V4.POL_CD PRE_4_POL_CD,
                                                      V4.POD_CD PRE_4_POD_CD,
                                                      V5.VSL_CD||V5.SKD_VOY_NO||V5.SKD_DIR_CD POST_1_VVD,
                                                      V5.POL_CD POST_1_POL_CD,
                                                      V5.POD_CD POST_1_POD_CD,
                                                      V6.VSL_CD||V6.SKD_VOY_NO||V6.SKD_DIR_CD POST_2_VVD,
                                                      V6.POL_CD POST_2_POL_CD,
                                                      V6.POD_CD POST_2_POD_CD,
                                                      V7.VSL_CD||V7.SKD_VOY_NO||V7.SKD_DIR_CD POST_3_VVD,
                                                      V7.POL_CD POST_3_POL_CD,
                                                      V7.POD_CD POST_3_POD_CD,
                                                      V8.VSL_CD||V8.SKD_VOY_NO||V8.SKD_DIR_CD POST_4_VVD,
                                                      V8.POL_CD POST_4_POL_CD,
                                                      V8.POD_CD POST_4_POD_CD,
                                                      V9.POL_CD TRUNK_POL,
                                                      V9.POD_CD TRUNK_POD,
													  V9.SLAN_CD TRUNK_LANE,
                                                      DECODE(B.STOP_OFF_LOC_CD, NULL, 'N', 'Y') STOP_OFF_LOC_CD,
                                                      D.SPCL_CGO_AUTH_KNT,
                                                      B.RC_FLG,
                                                      B.DCGO_FLG,
                                                      B.PRCT_FLG,    
                                                      B.AWK_CGO_FLG,
                                                      B.RD_CGO_FLG,
                                                      B.BB_CGO_FLG,
                                                      B.HNGR_FLG,
                                                      B.SOC_FLG,
                                                      B.FD_GRD_FLG,
                                                      B.SPCL_HIDE_FLG,
                                                      B.EQ_SUBST_FLG,
                                                      B.RAIL_BLK_CD,
                                                      B.HOT_DE_FLG,
                                                      B.WT_RSN_SPCL_CGO_FLG,
                                                      B.WT_RSN_HLD_FLG,
                                                      B.AP_BROG_FLG,
                                                      B.STWG_CD,
                                                      B.BLCK_STWG_CD,
                                                      DECODE(nvl(B.STOP_OFF_LOC_CD, 'N'), 'N', 'N', 'Y') STOP_CGO_FLG,
                                                      B.CMDT_CD,
                                                      (SELECT CMDT_NM
                                                         FROM MDM_COMMODITY M
                                                        WHERE M.CMDT_CD = B.CMDT_CD) CMDT_NM,
                                                      B.REP_CMDT_CD,
                                                      D.CSTMS_DESC CSTMS_DESC,
                                                      B.INTER_RMK,
                                                      SR.OFC_TEAM_CD
                                                    FROM BKG_BOOKING B ,
                                                      BKG_BL_DOC D,
                                                      BKG_CNTC_PSON CNTC,
                                                      BKG_CUSTOMER S,
                                                      BKG_CUSTOMER C,
                                                      BKG_CUSTOMER F,
                                                      BKG_CUSTOMER N,
                                                      BKG_VVD V1,
                                                      BKG_VVD V2,
                                                      BKG_VVD V3,
                                                      BKG_VVD V4,
                                                      BKG_VVD V5,
                                                      BKG_VVD V6,
                                                      BKG_VVD V7,
                                                      BKG_VVD V8,
                                                      BKG_VVD V9,
                                                      BKG_VVD VVD,
                                                      MDM_SLS_REP SR
                                                    WHERE 1=1
                                                      AND B.BKG_NO = D.BKG_NO
                                                      AND B.BKG_NO = CNTC.BKG_NO(+)
                                                      AND CNTC.BKG_CNTC_PSON_TP_CD(+) ='BK'
                                                      AND C.BKG_CUST_TP_CD ='C'
                                                      AND B.BKG_NO = C.BKG_NO
                                                      AND S.BKG_CUST_TP_CD ='S'
                                                      AND B.BKG_NO = S.BKG_NO
                                                      AND F.BKG_CUST_TP_CD(+) ='F'
                                                      AND B.BKG_NO = F.BKG_NO(+)
                                                      AND N.BKG_CUST_TP_CD(+) ='N'
                                                      AND B.BKG_NO = N.BKG_NO(+)
                                                      AND B.BKG_NO = V1.BKG_NO(+)
                                                      AND V1.VSL_PRE_PST_CD(+) ='S'
                                                      AND V1.VSL_SEQ(+) ='1'
                                                      AND B.BKG_NO = V2.BKG_NO(+)
                                                      AND V2.VSL_PRE_PST_CD(+) ='S'
                                                      AND V2.VSL_SEQ(+) ='2'
                                                      AND B.BKG_NO = V3.BKG_NO(+)
                                                      AND V3.VSL_PRE_PST_CD(+) ='S'
                                                      AND V3.VSL_SEQ(+) ='3'
                                                      AND B.BKG_NO = V4.BKG_NO(+)
                                                      AND V4.VSL_PRE_PST_CD(+) ='S'
                                                      AND V4.VSL_SEQ(+) ='4'
                                                      AND B.BKG_NO = V5.BKG_NO(+)
                                                      AND V5.VSL_PRE_PST_CD(+) ='U'
                                                      AND V5.VSL_SEQ(+) ='1'
                                                      AND B.BKG_NO = V6.BKG_NO(+)
                                                      AND V6.VSL_PRE_PST_CD(+) ='U'
                                                      AND V6.VSL_SEQ(+) ='2'
                                                      AND B.BKG_NO = V7.BKG_NO(+)
                                                      AND V7.VSL_PRE_PST_CD(+) ='U'
                                                      AND V7.VSL_SEQ(+) ='3'
                                                      AND B.BKG_NO = V8.BKG_NO(+)
                                                      AND V8.VSL_PRE_PST_CD(+) ='U'
                                                      AND V8.VSL_SEQ(+) ='4'
                                                      AND B.BKG_NO = V9.BKG_NO
                                                      AND V9.VSL_PRE_PST_CD ='T'
                                                      AND B.BKG_NO = VVD.BKG_NO
                                                      AND B.OB_SREP_CD = SR.SREP_CD(+)
                                                      AND SR.OFC_CD(+) = 'SELSC' -- SELSC에 한해 L/TEAM 을 조회함
                                                      ) VB
						  #end
						 ,MDM_LOCATION
						 ,BKG_XPT_IMP_LIC XPT_IMP
						 ,BKG_BOOKING B
						 ,BKG_RATE RA
                    WHERE  VB.BKG_NO = BKG_QTY.BKG_NO(+)
                    AND    VB.DEL_CD     = MDM_LOCATION.LOC_CD
                    AND    VB.BKG_NO     = XPT_IMP.BKG_NO(+)
                    AND    XPT_IMP.IO_BND_CD(+) ='O'
                    AND    VB.BKG_NO = B.BKG_NO
                    AND    B.BKG_NO = RA.BKG_NO(+)                   


										 /***************** 조건 시작 *********************/
                                             /* 1  vvd_cd  */
                                           #if (${vvd_cd} != '') 
                                            AND     VB.KEY_VSL_CD     = SUBSTR(@[vvd_cd], 1, 4)
                                            AND     VB.KEY_SKD_VOY_NO = SUBSTR(@[vvd_cd], 5, 4)
                                            AND     VB.KEY_SKD_DIR_CD = SUBSTR(@[vvd_cd], 9, 1)
                                           #end

                                            /* 2  trunk_flag */
                                           #if (${trunk_flag} != '') 
                                            AND   VB.VSL_PRE_PST_CD ='T'
                                           #end
                                            
                                            /* 3 lane_cd */
                                           #if (${lane_cd} != '') 
                                            AND VB.TRUNK_LANE = @[lane_cd]
                                           #end
                                            
                                            /* 4  dir_cd */        
                                           #if (${dir_cd} != '') 
                                            AND VB.SKD_DIR_CD IN (${dir_cd})
                                           #end
                                            
                                            /* 5  pol_cd */
                                           #if (${pol_cd} != '') 
												#if (${board_from_dt} != '')
		                                            AND VB.DOC_POL_CD > ' ' 
												#end
													AND VB.KEY_POL_CD LIKE @[pol_cd]||'%'
                                           #end
                                            
                                            /* 6 pol_yard_cd */
                                           #if (${pol_yard_cd} != '') 
                                            AND SUBSTR(VB.KEY_POL_YD_CD,-2) = @[pol_yard_cd]
                                           #end
                                            
                                            /* 7 pol_local */
                                           #if ( ${pol_cd} != '' && ${pol_local} != '') 
                                            AND VB.KEY_POL_CD = VB.POL_CD
                                           #end
                                            
                                            /* 8 pol_ts */ 
                                           #if (${pol_cd} != '' && ${pol_ts} != '') 
                                            AND VB.KEY_POL_CD <> VB.POL_CD
                                           #end
                                            
                                            /* 9 pod_cd */
                                           #if (${pod_cd} != '') 
                                            AND VB.KEY_POD_CD LIKE @[pod_cd]||'%'
                                           #end
                                            
                                            /* 10 pod_yard_cd*/
                                           #if (${pod_yard_cd} != '') 
                                            AND SUBSTR(VB.KEY_POD_YD_CD,-2) = @[pod_yard_cd]
                                           #end
                                             
                                            /* 11 pod_local */
                                           #if (${pod_local} != '') 
	                                            AND VB.KEY_POD_CD = VB.POD_CD
                                           #end
                                            
                                            /* 12 pod_ts */
                                           #if (${pod_ts} != '') 
                                            AND VB.KEY_POD_CD <> VB.POD_CD
                                           #end
                                            
                                            /* 13 por_cd         */
                                           #if (${por_cd} != '') 
                                            AND VB.POR_CD LIKE @[por_cd]||'%' 
                                           #end
                                            
                                            /* 14 del_cd         */
                                           #if (${del_cd} != '') 
                                            AND VB.DEL_CD LIKE @[del_cd]||'%' 
                                           #end
                                            
                                            /* 15 r_term         */
                                           #if (${r_term} != '') 
                                            AND VB.RCV_TERM_CD IN (${r_term})
                                           #end
                                            
                                            /* 16 d_term         */
                                           #if (${d_term} != '') 
                                            AND VB.DE_TERM_CD IN (${d_term})
                                           #end
                                                                                   
                                           /*17 zone_cd OCN*/
                                            #if (${zone_cd} == 'OCN') 
                                             AND (SELECT CONTI_CD FROM MDM_LOCATION WHERE LOC_CD = VB.POR_CD) <> (SELECT CONTI_CD FROM MDM_LOCATION WHERE LOC_CD = VB.DEL_CD)
                                            #end
                                           /* 17 zone_cd IPT*/
                                            #if (${zone_cd} == 'IPT') 
                                             AND (SELECT CONTI_CD FROM MDM_LOCATION WHERE LOC_CD = VB.POR_CD) = (SELECT CONTI_CD FROM MDM_LOCATION WHERE LOC_CD = VB.DEL_CD)
                                            #end
											 /* 17 zone_cd IPT*/
                                            #if (${zone_cd} == 'DOM') 
                                             AND (SUBSTR(VB.por_cd,1,2) = SUBSTR(VB.del_cd,1,2))
                                            #end
                                            
                                            /* 18 deli_mode      */
										   #if (${deli_mode} !='')
	                                       		AND decode(NVL(VB.DEST_TRNS_MOD_CD, ' '),'T','1','2','R','A','4','F','3','B','3','E','5','U','5','*') IN (${deli_mode})
										   #end
										
										   /* 19, 20 Pre1 ETD Date */
										   #if (${board_from_dt} != '') 
											AND VB.BKG_NO
											 IN ( SELECT DISTINCT BKG.BKG_NO
                            						FROM BKG_VVD VVD, BKG_BOOKING BKG
                           						   WHERE ( VVD.VSL_CD,VVD.SKD_VOY_NO,VVD.SKD_DIR_CD,VVD.POL_CD,VVD.POL_CLPT_IND_SEQ ) IN 
                               						     ( SELECT A.VSL_CD,A.SKD_VOY_NO,A.SKD_DIR_CD,A.VPS_PORT_CD,A.CLPT_IND_SEQ
                              								 FROM VSK_VSL_PORT_SKD A
                                							WHERE A.VPS_ETD_DT >= TO_DATE(@[board_from_dt], 'YYYY-MM-DD')
                                  							  AND A.VPS_ETD_DT <= TO_DATE(@[board_to_dt], 'YYYY-MM-DD') +0.99999)
                                  							  AND VB.BKG_NO  = BKG.BKG_NO                           									  
                                  							  AND VVD.BKG_NO = BKG.BKG_NO
                                  							  AND VVD.POL_CD = BKG.POL_CD
                                  							  AND ( VVD.VSL_PRE_PST_CD, VVD.VSL_SEQ) IN ( ('S',1),('T',0) )
												)
										   #end 
                                            #if (${eta_from_dt} != '')
											/* 19, 20 lst ETA Date */
											AND VB.BKG_NO
											 IN ( SELECT DISTINCT BKG.BKG_NO
                            						FROM BKG_VVD VVD, BKG_BOOKING BKG
                           						   WHERE ( VVD.VSL_CD,VVD.SKD_VOY_NO,VVD.SKD_DIR_CD,VVD.POD_CD,VVD.POD_CLPT_IND_SEQ ) IN
                               						     ( SELECT A.VSL_CD,A.SKD_VOY_NO,A.SKD_DIR_CD,A.VPS_PORT_CD,A.CLPT_IND_SEQ
                              								 FROM VSK_VSL_PORT_SKD A
                                							WHERE A.VPS_ETA_DT >= TO_DATE(@[eta_from_dt], 'YYYY-MM-DD')
                                  							  AND A.VPS_ETA_DT <= TO_DATE(@[eta_to_dt], 'YYYY-MM-DD') +0.99999)
													 AND VB.BKG_NO  = BKG.BKG_NO
                           							 AND VVD.BKG_NO = BKG.BKG_NO
                           							 AND VVD.POD_CD = BKG.POD_CD
													 AND VVD.VSL_PRE_PST_CD IN ('T','U')
													 AND (VVD.VSL_PRE_PST_CD, VVD.VSL_SEQ) = (SELECT /*+ INDEX_DESC (VVD2 XPKBKG_VVD) */ VVD2.VSL_PRE_PST_CD, VVD2.VSL_SEQ
																								 FROM BKG_VVD VVD2
																								WHERE VVD2.BKG_NO = VVD.BKG_NO
																								  AND VVD2.VSL_PRE_PST_CD IN ('T','U')
																								  AND ROWNUM = 1)
												)
										   #end
                                            /* 21 bkg_from_dt    */
                                           #if (${bkg_from_dt} != '') 
                                            AND VB.BKG_CRE_DT >= TO_DATE(@[bkg_from_dt],'YYYY-MM-DD') 
                                           #end
                                            
                                            /* 22 bkg_to_dt      */
                                           #if (${bkg_to_dt} != '') 
                                            AND VB.BKG_CRE_DT <= TO_DATE(@[bkg_to_dt],'YYYY-MM-DD') +0.99999
                                           #end
                                            
                                            /* 23 bkg_kind       */
                                           #if (${bkg_kind} != '') 
                                            AND VB.XTER_BKG_RQST_CD IN (${bkg_kind})
                                           #end
                                            
											/* 24 b_ofc_cd       *//* 25 b_ofc_cd_sub   */
                                           #if (${b_ofc_cd} != '') 
                                            #if(${b_ofc_cd_sub} != '')
											/* 2010.04.22 수정 */
											 AND VB.BKG_OFC_CD IN ( ${b_ofc_cd_sub} )
                                            #else
											 AND VB.BKG_OFC_CD IN ( ${b_ofc_cd} )
                                            #end
                                           #end
                                            
                                            /* 26 b_staff_id     */
                                           #if (${b_staff_id} != '') 
                                            AND VB.DOC_USR_ID = @[b_staff_id]
                                           #end
                                            
                                            /* 27 ca_flag        */
                                           #if (${ca_flag} != '') 
                                            AND EXISTS ( SELECT  'Y' FROM BKG_CORRECTION
														 WHERE BKG_NO = VB.BKG_NO
														 AND CORR_NO IS NOT NULL
														 AND CORR_NO <> '0000000001')
                                           #end
                                            
                                            /* 28 agent_cd       */
                                           #if (${agent_cd} != '') 
                                            AND VB.CHN_AGN_CD = @[agent_cd]
                                           #end
                                            
                                            /* 29 agent_cd_all   */
                                           #if (${agent_cd_all} != '') 
                                            AND VB.CHN_AGN_CD IS NOT NULL
                                           #end
                                            
                                            /* 30 eq_type BKG_QUANTITY  EXISTS 체크*/
                                           #if (${eq_type} != '') 
                                            AND EXISTS  ( SELECT 'Y'
                                                          FROM BKG_QUANTITY
                                                          WHERE BKG_NO = VB.BKG_NO
                                                          AND   CNTR_TPSZ_CD IN (${eq_type})
                                                         )
                                           #end
                                                         
                                            /* 31 cmdt_cd MDM_COMMODITY   EXISTS 체크*/
                                           #if (${cmdt_cd} != '') 
                                            AND VB.CMDT_CD = @[cmdt_cd]
                                           #end
                                                         
                                            /* 32 cmdt_nm - 체크안함 */
                                            
                                            /* 33 wgt_from       */
                                           #if (${wgt_from} != '') 
                                            AND VB.WGT_UT_CD = 'KGS'
                                            AND VB.ACT_WGT >= (@[wgt_from] *'1000')
                                           #end
                                            
                                            /* 34 wgt_to         */
                                           #if (${wgt_to} != '') 
                                            AND VB.WGT_UT_CD = 'KGS' 
                                            AND VB.ACT_WGT <= (@[wgt_to] *'1000')
                                           #end
                                            
                                            /* 35 so_no          */
                                           #if (${so_no} != '') 
                                            AND VB.TWN_SO_NO = @[so_no]
                                           #end
                                            
                                           /* 36 l_ofc_cd *//* 37 l_ofc_cd_sub */
                                           #if (${l_ofc_cd} != '') 
                                            #if(${l_ofc_cd_sub} != '')
                                             AND VB.OB_SLS_OFC_CD   IN ( SELECT OFC_N8TH_LVL_CD
                                                                          FROM   DMT_OFC_LVL_V
                                                                          WHERE @[l_ofc_cd] IN (OFC_N1ST_LVL_CD, OFC_N2ND_LVL_CD, OFC_N3RD_LVL_CD, OFC_N4TH_LVL_CD,
                                                                                                OFC_N5TH_LVL_CD, OFC_N6TH_LVL_CD, OFC_N7TH_LVL_CD, OFC_N8TH_LVL_CD)
                                                                        )
                                            #else
                                             AND VB.OB_SLS_OFC_CD = @[l_ofc_cd]
                                            #end
                                           #end
                                           
                                            /* 38 l_team_cd        */
                                           #if (${l_team_cd} != '') 
                                             AND VB.OFC_TEAM_CD = @[l_team_cd]
                                           #end
                                           
                                            /* 39 l_rep_id       */
                                           #if (${l_rep_id} != '') 
                                            AND VB.OB_SREP_CD = @[l_rep_id]
                                           #end
                                           
                                           /* 40 c_ofc_cd *//* 41 c_ofc_cd_sub */
                                           #if (${c_ofc_cd} != '') 
                                            #if(${c_ofc_cd_sub} != '')
                                             AND VB.CTRT_OFC_CD   IN ( SELECT OFC_N8TH_LVL_CD
                                                                     FROM   DMT_OFC_LVL_V
                                                                     WHERE @[c_ofc_cd] IN (OFC_N1ST_LVL_CD, OFC_N2ND_LVL_CD, OFC_N3RD_LVL_CD, OFC_N4TH_LVL_CD,
                                                                                                OFC_N5TH_LVL_CD, OFC_N6TH_LVL_CD, OFC_N7TH_LVL_CD, OFC_N8TH_LVL_CD)
                                                                   )
                                            #else
                                             AND VB.CTRT_OFC_CD = @[c_ofc_cd]
                                            #end
                                           #end
                                           
                                            /* 42 c_rep_id       */
                                           #if (${c_rep_id} != '') 
                                            AND VB.CTRT_SREP_CD = @[c_rep_id]
                                           #end
                                           
                                            /* 43 ctr_rfa_cd*//* 44 ctr_rfa_no*/
                                           #if (${ctr_rfa_cd} == 'C') 
                                            #if (${ctr_rfa_no} != '') 
                                             AND VB.SC_NO = @[ctr_rfa_no]
                                            #end
                                           #elseif (${ctr_rfa_cd} == 'R') 
                                            #if (${ctr_rfa_no} != '') 
                                             AND VB.RFA_NO = @[ctr_rfa_no]
                                            #end
                                           #elseif (${ctr_rfa_cd} == 'T')
                                            #if (${ctr_rfa_no} != '')
                                             AND VB.TAA_NO = @[ctr_rfa_no]
                                            #end
                                           #end
                                            
                                            /* 45 s_mode_ori     */
                                           #if (${s_mode_ori} != '') 
                                            AND VB.ORG_TRNS_SVC_MOD_CD IN (${s_mode_ori})
                                           #end
                                            
                                            /* 46 s_mode_dest    */
                                           #if (${s_mode_dest} != '') 
                                            AND VB.DEST_TRNS_SVC_MOD_CD IN (${s_mode_dest})
                                           #end
                                            
                                            /* 47 s_route_ori    */
                                           #if (${s_route_ori} != '') 
                                            AND VB.ORG_SCONTI_CD IN (${s_route_ori})
                                           #end
                                            
                                            /* 48 s_route_dest   */
                                           #if (${s_route_dest} != '') 
                                            AND VB.DEST_SCONTI_CD IN(${s_route_dest})
                                           #end
                                            
                                           
                                            /* 50 fv_vvd_cd      */
                                                 /* 49 fv_pre_pst_cd  */
                                           #if (${fv_vvd_cd} != '') 
                                               #if (${fv_pre_pst_cd} == 'PR') 
                                                AND @[fv_vvd_cd] IN (VB.PRE_1_VVD, VB.PRE_2_VVD, VB.PRE_3_VVD, VB.PRE_4_VVD)
                                               #elseif (${fv_pre_pst_cd} == 'PO') 
                                                AND @[fv_vvd_cd] IN ( VB.POST_1_VVD , VB.POST_2_VVD , VB.POST_3_VVD , VB.POST_4_VVD )
                                               #end
                                           #end

                                            /* 51 fv_pol_cd      *//* 52 fv_pol_yard_cd *//* 53 fv_pol_local */
                                                 /* 49 fv_pre_pst_cd  */
                                           #if (${fv_pol_cd} != '') 
                                               #if (${fv_pre_pst_cd} == 'PR') 
                                                #if(${fv_pol_yard_cd} != '')
                                                 AND @[fv_pol_cd]||@[fv_pol_yard_cd] IN ( VB.PRE_1_POL_YD_CD  , VB.PRE_2_POL_YD_CD  , VB.PRE_3_POL_YD_CD  , VB.PRE_4_POL_YD_CD)
                                                #else
                                                 AND @[fv_pol_cd] IN ( VB.PRE_1_POL_CD  , VB.PRE_2_POL_CD  , VB.PRE_3_POL_CD  , VB.PRE_4_POL_CD)
                                                #end
                                                
                                                 #if (${fv_pol_local} != '') 
                                                    AND VB.POL_CD = NVL( (SELECT @[fv_pol_cd] FROM DUAL 
                                                                          WHERE  @[fv_pol_cd] IN (VB.PRE_4_POL_CD, VB.PRE_3_POL_CD, VB.PRE_2_POL_CD ) )
                                                                       , VB.PRE_1_POL_CD)
                                                 #end                     
                                               #elseif (${fv_pre_pst_cd} == 'PO') 
                                                #if(${fv_pol_yard_cd} != '')
                                                 AND @[fv_pol_cd]||@[fv_pol_yard_cd] IN ( VB.POST_1_POL_YD_CD  , VB.POST_2_POL_YD_CD  , VB.POST_3_POL_YD_CD  , VB.POST_4_POL_YD_CD)
                                                #else
                                                 AND @[fv_pol_cd] IN ( VB.POST_1_POL_CD , VB.POST_2_POL_CD , VB.POST_3_POL_CD , VB.POST_4_POL_CD) 
                                                #end
                                                
                                                
                                                 #if (${fv_pol_local} != '') 
                                                    AND VB.POL_CD = NVL( (SELECT @[fv_pol_cd] FROM DUAL 
                                                                          WHERE  @[fv_pol_cd] IN (VB.POST_4_POL_CD, VB.POST_3_POL_CD, VB.POST_2_POL_CD ) )
                                                                       , VB.POST_1_POL_CD)
                                                 #end
                                               #end
                                           #end
                                           
                                           #if (${fv_pol_cd} == '' && ${fv_pol_yard_cd} != '') 
                                             #if (${fv_pre_pst_cd} == 'PR') 
                                                 AND @[fv_pol_yard_cd] IN ( SUBSTR(VB.PRE_1_POL_YD_CD,-2)  , SUBSTR(VB.PRE_2_POL_YD_CD,-2)  , SUBSTR(VB.PRE_3_POL_YD_CD,-2)  , SUBSTR(VB.PRE_4_POL_YD_CD,-2))
                                               #elseif (${fv_pre_pst_cd} == 'PO') 
                                                 AND @[fv_pol_yard_cd] IN ( SUBSTR(VB.POST_1_POL_YD_CD,-2)  , SUBSTR(VB.POST_2_POL_YD_CD,-2)  , SUBSTR(VB.POST_3_POL_YD_CD,-2)  , SUBSTR(VB.POST_4_POL_YD_CD,-2))
                                               #end
                                           #end
                                           
                                            
                                            /* 54 fv_pod_cd      */ /* 55 fv_pod_yard_cd *//* 56 fv_pod_local   */
                                                 /* 49 fv_pre_pst_cd  */
                                           #if (${fv_pod_cd} != '') 
                                               #if (${fv_pre_pst_cd} == 'PR') 
                                                #if(${fv_pod_yard_cd} != '')
                                                 AND @[fv_pod_cd]||@[fv_pod_yard_cd] IN ( VB.PRE_1_POD_YD_CD  , VB.PRE_2_POD_YD_CD  , VB.PRE_3_POD_YD_CD  , VB.PRE_4_POD_YD_CD)
                                                #else
                                                 AND @[fv_pod_cd] IN ( VB.PRE_1_POD_CD  , VB.PRE_2_POD_CD  , VB.PRE_3_POD_CD  , VB.PRE_4_POD_CD)
                                                #end
                                                
                                                 #if (${fv_pol_local} != '') 
                                                    AND VB.POD_CD = NVL( (SELECT @[fv_pod_cd] FROM DUAL 
                                                                          WHERE  @[fv_pod_cd] IN (VB.PRE_4_POD_CD, VB.PRE_3_POD_CD, VB.PRE_2_POD_CD ) )
                                                                       , VB.PRE_1_POD_CD)
                                                 #end                     
                                               #elseif (${fv_pre_pst_cd} == 'PO') 
                                                #if(${fv_pod_yard_cd} != '')
                                                 AND @[fv_pod_cd]||@[fv_pod_yard_cd] IN ( VB.POST_1_POD_YD_CD  , VB.POST_2_POD_YD_CD  , VB.POST_3_POD_YD_CD  , VB.POST_4_POD_YD_CD)
                                                #else
                                                 AND @[fv_pod_cd] IN ( VB.POST_1_POD_CD , VB.POST_2_POD_CD , VB.POST_3_POD_CD , VB.POST_4_POD_CD) 
                                                #end
                                                
                                                
                                                 #if (${fv_pol_local} != '') 
                                                    AND VB.POD_CD = NVL( (SELECT @[fv_pod_cd] FROM DUAL 
                                                                          WHERE  @[fv_pod_cd] IN (VB.POST_4_POD_CD, VB.POST_3_POD_CD, VB.POST_2_POD_CD ) )
                                                                       , VB.POST_1_POD_CD)
                                                 #end
                                               #end
                                           #end
                                           
                                           #if (${fv_pod_cd} == '' && ${fv_pod_yard_cd} != '') 
                                             #if (${fv_pre_pst_cd} == 'PR') 
                                                 AND @[fv_pod_yard_cd] IN ( SUBSTR(VB.PRE_1_POD_YD_CD,-2)  , SUBSTR(VB.PRE_2_POD_YD_CD,-2)  , SUBSTR(VB.PRE_3_POD_YD_CD,-2)  , SUBSTR(VB.PRE_4_POD_YD_CD,-2))
                                               #elseif (${fv_pre_pst_cd} == 'PO') 
                                                 AND @[fv_pod_yard_cd] IN ( SUBSTR(VB.POST_1_POD_YD_CD,-2)  , SUBSTR(VB.POST_2_POD_YD_CD,-2)  , SUBSTR(VB.POST_3_POD_YD_CD,-2)  , SUBSTR(VB.POST_4_POD_YD_CD,-2))
                                               #end
                                           #end

                                            /* 57~61 cust_tp_cd_s,c,n,f,a*/
											/* 63 cust_cnt_cd    *//* 64 cust_seq *//* 66 cust_tp_cd*/
										 #if (${cust_tp_cd_s} != '' || ${cust_tp_cd_c} != '' || ${cust_tp_cd_n} != '' || ${cust_tp_cd_f} != '' || ${cust_tp_cd_a} != '')                                        
   											  #if(${cust_cnt_cd} !='' && ${cust_seq} != '')
												AND ( 1=2
														#if (${cust_tp_cd_s} !='')
															OR VB.SHIPPER = @[cust_cnt_cd]||TO_NUMBER(@[cust_seq])
														#end
														#if (${cust_tp_cd_c} !='')
															OR CONSIGNEE = @[cust_cnt_cd]||TO_NUMBER(@[cust_seq])
														#end
														#if (${cust_tp_cd_n} !='')
															OR NTFY = @[cust_cnt_cd]||TO_NUMBER(@[cust_seq])
														#end
														#if (${cust_tp_cd_f} !='')
															OR FFDR = @[cust_cnt_cd]||TO_NUMBER(@[cust_seq])
														#end
														#if (${cust_tp_cd_a} !='')
															/* 예비*/															
														#end
													)
											   #end


										#end
														
										/* 67 sp_cargo_dg  *//* 68 sp_cargo_rf    *//* 69 sp_cargo_ak *//* 70 sp_cargo_bb *//* 71 sp_cargo_hg    *//* 72 sp_cargo_soc   *//* 73 sp_cargo_eq    *//* 74 sp_cargo_rd    *//* 75 sp_cargo_pm    *//* 76 sp_cargo_pc    *//* 77 sp_cargo_fg    *//* 78 sp_cargo_hd    *//* 79 sp_cargo_rb    */
										#if (${sp_cargo_dg} !=''||${sp_cargo_rf} != ''||${sp_cargo_ak} != ''||${sp_cargo_bb} != ''||${sp_cargo_hg} != ''||${sp_cargo_soc} != ''||${sp_cargo_eq} != ''||${sp_cargo_rd} != ''||${sp_cargo_pm} != ''||${sp_cargo_pc} != ''||${sp_cargo_fg} != ''||${sp_cargo_hd} != ''||${sp_cargo_rb} != '')
										     AND ( 1=2 
										  /* 67 sp_cargo_dg  */
										  #if (${sp_cargo_dg} != '') 
										  	OR VB.DCGO_FLG = 'Y'
										  #end
										  /* 68 sp_cargo_rf    */
										  #if (${sp_cargo_rf} != '') 
											OR VB.RC_FLG = 'Y'
										  #end
										  /* 69 sp_cargo_ak */
										  #if (${sp_cargo_ak} != '') 
											OR VB.AWK_CGO_FLG = 'Y'
										  #end
										  /* 69 sp_cargo_ak */
										  #if (${sp_cargo_ak} != '') 
										    OR VB.AWK_CGO_FLG = 'Y'
										  #end
										  /* 70 sp_cargo_bb */
										  #if (${sp_cargo_bb} != '') 
											OR VB.BB_CGO_FLG = 'Y'
										  #end
										  /* 71 sp_cargo_hg    */
										  #if (${sp_cargo_hg} != '') 
										    OR VB.HNGR_FLG = 'Y'
										  #end
										  /* 72 sp_cargo_soc   */
										  #if (${sp_cargo_soc} != '') 
											OR VB.SOC_FLG = 'Y'
										  #end	
										  /* 73 sp_cargo_eq    */
										  #if (${sp_cargo_eq} != '') 
										    OR VB.EQ_SUBST_FLG = 'Y'
										  #end
										  /* 74 sp_cargo_rd    */
										  #if (${sp_cargo_rd} != '') 
										    OR VB.RD_CGO_FLG = 'Y'
										  #end
										  /* 75 sp_cargo_pm    */
										  #if (${sp_cargo_pm} != '') 
										    OR VB.HOT_DE_FLG = 'Y'
										  #end
										  /* 76 sp_cargo_pc    */
										  #if (${sp_cargo_pc} != '') 
										    OR VB.PRCT_FLG = 'Y'
										  #end
										  /* 77 sp_cargo_fg    */
										  #if (${sp_cargo_fg} != '') 
										    OR VB.FD_GRD_FLG = 'Y'
										  #end
										  /* 78 sp_cargo_hd    */
										  #if (${sp_cargo_hd} != '') 
										    OR VB.SPCL_HIDE_FLG = 'Y'
										  #end
										  /* 79 sp_cargo_rb    */
										  #if (${sp_cargo_rb} != '') 
										    OR VB.RAIL_BLK_CD IS NOT NULL
										  #end
										  )
										#end

                                            /* 80~82 cargo_tp_f,p,r     */
                                           #if (${cargo_tp_f} != '' || ${cargo_tp_p} != '' || ${cargo_tp_r} != '') 
                                            AND VB.BKG_CGO_TP_CD IN ( @[cargo_tp_f], @[cargo_tp_p], @[cargo_tp_r]) 
                                           #end
                                            
                                            /* 83 bkg_sts_cd_f*//* 84 bkg_sts_cd_x*//* 85 bkg_sts_cd_a*//* 86 bkg_sts_cd_w*/
                                           #if (${bkg_sts_cd_f} != '' || ${bkg_sts_cd_x} != '' || ${bkg_sts_cd_a} != '' || ${bkg_sts_cd_w} != '') 
                                            AND VB.BKG_STS_CD IN ( @[bkg_sts_cd_f], @[bkg_sts_cd_x], @[bkg_sts_cd_a], @[bkg_sts_cd_w]) 
											#else /* 선택되지 않을경우 기본 STATUS */
                                            AND  VB.BKG_STS_CD IN ('F', 'W', 'A') 
                                           #end
                                            
                                            /* 87 non_sp_cargo   */
                                           #if (${non_sp_cargo} != '') 
                                            AND VB.WT_RSN_SPCL_CGO_FLG = 'Y'
                                           #end
                                            /* 88 holding*/
                                           #if (${holding} != '') 
                                            AND VB.WT_RSN_HLD_FLG = 'Y'
                                           #end
                                            
                                            /* 89 bl_type_a      */
                                           #if (${bl_type_a} != '') 
                                            AND VB.ADV_SHTG_CD = 'A'
                                           #end
                                            /* 90 bl_type_s      */
                                           #if (${bl_type_s} != '') 
                                            AND VB.ADV_SHTG_CD = 'S'
                                           #end
                                            /* 91 rev            */
                                           #if (${rev} != '') 
                                            AND EXISTS ( SELECT 'Y' FROM BKG_CHG_RT WHERE BKG_NO = VB.BKG_NO) 
                                           #end
                                            /* 92 non_rev        */
                                           #if (${non_rev} != '') 
                                            AND NOT EXISTS ( SELECT 'Y' FROM BKG_CHG_RT WHERE BKG_NO = VB.BKG_NO)
                                           #end

                                            /* 93 aes_y          */
                                           #if (${aes_y} != '') 
                                            AND XPT_IMP.AES_TP_CD IS NOT NULL
                                           #end
                                            /* 94 aes_n          */
                                           #if (${aes_n} != '') 
                                            AND XPT_IMP.AES_TP_CD IS NULL
                                           #end
                                            /* 95 stop_cargo     */
                                           #if (${stop_cargo} != '') 
                                            AND VB.STOP_CGO_FLG ='Y'
                                           #end
                                            /* 96 ro_y           */
                                           #if (${ro_y} != '') 
											AND EXISTS ( SELECT 'Y'
											             FROM BKG_ROLL_OVR WHERE BKG_NO = VB.BKG_NO
											             GROUP BY BKG_NO
											             HAVING COUNT(BKG_NO) > @[ro_y]
														)
                                           #end
                                            
                                            /* 98 caed_y         */
                                           #if (${caed_y} != '') 
                                            AND XPT_IMP.CAED_TP_CD IS NOT NULL
                                           #end
                                            /* 99 caed_n         */
                                           #if (${caed_n} != '') 
                                            AND XPT_IMP.CAED_TP_CD IS NULL
                                           #end
                                            
                                            /* 101 certi_y        */
                                           #if (${certi_y} != '') 
                                            AND EXISTS ( SELECT 'Y' FROM BKG_IMG_STO WHERE BKG_NO = VB.BKG_NO
                                           							#if (${certi_d} != '' || ${certi_a} != '' || ${certi_b} != '' || ${certi_g} != '' || ${certi_c} != '')
                                           							AND RIDR_TP_CD IN (@[certi_d], @[certi_a], @[certi_b], @[certi_g], @[certi_c])
                                           							#end 	
                                            						)
                                           #end
                                           
                                            /* 102 certi_n        */
                                           #if (${certi_n} != '') 
                                            AND NOT EXISTS ( SELECT 'Y' FROM BKG_IMG_STO WHERE BKG_NO = VB.BKG_NO
                                            								#if (${certi_d} != '' || ${certi_a} != '' || ${certi_b} != '' || ${certi_g} != '' || ${certi_c} != '')
		                                           							AND RIDR_TP_CD IN (@[certi_d], @[certi_a], @[certi_b], @[certi_g], @[certi_c])
		                                           							#end 	
		                                            						)	
                                           #end     
                                           #if (${rate_check} != '')
											AND @[rate_check] = 
													CASE WHEN SUBSTR(VB.SC_NO,1,3) = 'DUM' OR SUBSTR(VB.RFA_NO,1,3) = 'DUM' OR SUBSTR(VB.TAA_NO,1,3) = 'DUM' THEN 'Y'
                                                         WHEN RA.OFT_MSS_FLG = 'N' THEN 'N'
														 WHEN RA.OFT_MSS_FLG = 'Y' THEN NVL((SELECT 'N' 
																								FROM BKG_CHG_RT RT 
																								WHERE RT.BKG_NO = RA.BKG_NO 
																								AND ROWNUM = 1), 'Y') END
										   #end                            
                                
                                /***************** 조건 끝 *********************/
				 ) K
                 #if(${bkg_sts_cd_i} != '')
                 WHERE VVD_CNT <> SKD_CNT 
                 #end
            ) X
           GROUP BY  ORDERBY_TITLE, TP_SZ
  ) Y
  ORDER BY ORDERBY_TITLE, TP_SZ			]]></sql>
			<params>
				<param name="vvd_cd" type="12" value="" out="N"/>
				<param name="lane_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pol_yard_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="pod_yard_cd" type="12" value="" out="N"/>
				<param name="por_cd" type="12" value="" out="N"/>
				<param name="del_cd" type="12" value="" out="N"/>
				<param name="board_from_dt" type="12" value="" out="N"/>
				<param name="board_to_dt" type="12" value="" out="N"/>
				<param name="eta_from_dt" type="12" value="" out="N"/>
				<param name="eta_to_dt" type="12" value="" out="N"/>
				<param name="bkg_from_dt" type="12" value="" out="N"/>
				<param name="bkg_to_dt" type="12" value="" out="N"/>
				<param name="b_staff_id" type="12" value="" out="N"/>
				<param name="agent_cd" type="12" value="" out="N"/>
				<param name="cmdt_cd" type="12" value="" out="N"/>
				<param name="wgt_from" type="12" value="" out="N"/>
				<param name="wgt_to" type="12" value="" out="N"/>
				<param name="so_no" type="12" value="" out="N"/>
				<param name="l_ofc_cd" type="12" value="" out="N"/>
				<param name="l_team_cd" type="12" value="" out="N"/>
				<param name="l_rep_id" type="12" value="" out="N"/>
				<param name="c_ofc_cd" type="12" value="" out="N"/>
				<param name="c_rep_id" type="12" value="" out="N"/>
				<param name="ctr_rfa_no" type="12" value="" out="N"/>
				<param name="fv_vvd_cd" type="12" value="" out="N"/>
				<param name="fv_pol_cd" type="12" value="" out="N"/>
				<param name="fv_pol_yard_cd" type="12" value="" out="N"/>
				<param name="fv_pod_cd" type="12" value="" out="N"/>
				<param name="fv_pod_yard_cd" type="12" value="" out="N"/>
				<param name="cust_cnt_cd" type="12" value="" out="N"/>
				<param name="cust_seq" type="12" value="" out="N"/>
				<param name="cargo_tp_f" type="12" value="" out="N"/>
				<param name="cargo_tp_p" type="12" value="" out="N"/>
				<param name="cargo_tp_r" type="12" value="" out="N"/>
				<param name="bkg_sts_cd_f" type="12" value="" out="N"/>
				<param name="bkg_sts_cd_x" type="12" value="" out="N"/>
				<param name="bkg_sts_cd_a" type="12" value="" out="N"/>
				<param name="bkg_sts_cd_w" type="12" value="" out="N"/>
				<param name="ro_y" type="12" value="" out="N"/>
				<param name="certi_d" type="12" value="" out="N"/>
				<param name="certi_a" type="12" value="" out="N"/>
				<param name="certi_b" type="12" value="" out="N"/>
				<param name="certi_g" type="12" value="" out="N"/>
				<param name="certi_c" type="12" value="" out="N"/>
				<param name="rate_check" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
