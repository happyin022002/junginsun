<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="LaneSimulationDBDAOCreateSimVolProj2CSQL">
			<desc><![CDATA[route projection volumn insert 2]]></desc>
			<sql><![CDATA[
INSERT INTO  MAS_SIM_CTRB_MGN_COST(
	            SIM_DT, SIM_NO, SECT_NO, POL_CD, POD_CD, SGRP_COST_CD, CGO_VAR_UC_AMT, CGO_VAR_AMT, CRE_USR_ID, CRE_DT, UPD_USR_ID, UPD_DT) 
	         SELECT A1.SIM_DT 
	               ,A1.SIM_NO 
	               ,A1.SECT_NO 
	               ,A1.POL_CD 
	               ,A1.POD_CD 
	               ,A2.SGRP_COST_CD 
	               ,SUM(DECODE(A1.PORT_PAIR_QTY, 0 , 0, A2.SIM_PERF_AMT/A1.PORT_PAIR_QTY)) AS CGO_VAR_UC_AMT
	               ,SUM(DECODE(A1.PORT_PAIR_QTY, 0 , 0, A2.SIM_PERF_AMT/A1.PORT_PAIR_QTY)* A1.PORT_PAIR_LOD_QTY)  AS CGO_VAR_AMT
	               ,@[cre_usr_id] 
	               ,SYSDATE 
	               ,@[upd_usr_id] 
	               ,SYSDATE 
	           FROM MAS_SIM_VOL_PRJ A1 
	               ,MAS_SIM_SMRY A2 
	          WHERE 1=1 
	            AND A1.POL_CD       = A2.POL_CD 
	            AND A1.POD_CD       = A2.POD_CD 
	            AND A2.SGRP_COST_CD NOT IN ('LOAD','FRRE') 
	            AND A2.COST_YRMON   >= TO_CHAR(ADD_MONTHS(SYSDATE,-${prd_cd}),'YYYYMM')  
	            AND A1.SIM_DT       = @[sim_dt] 
	            AND A1.SIM_NO       = @[sim_no] 
	            AND A1.TRD_CD       = A2.TRD_CD 
	            AND A1.SKD_DIR_CD   = A2.DIR_CD 
			#if (${trd_cd} != '') 
				AND A2.TRD_CD       = @[trd_cd] 
			#end	        
	        #if (${rlane_cd} != '')     
				AND A2.RLANE_CD     = @[rlane_cd] 
            #end
	        #if (${dir_cd} != '')       
				AND A2.DIR_CD       = @[dir_cd] 
            #end
	          GROUP BY A1.SIM_DT 
	               ,A1.SIM_NO 
	               ,A1.SECT_NO 
	               ,A1.POL_CD 
	               ,A1.POD_CD 
	               ,A2.SGRP_COST_CD			]]></sql>
			<params>
				<param name="cre_usr_id" type="12" value="" out="Y"/>
				<param name="upd_usr_id" type="12" value="" out="Y"/>
				<param name="sim_dt" type="12" value="" out="Y"/>
				<param name="sim_no" type="12" value="" out="Y"/>
				<param name="trd_cd" type="12" value="" out="Y"/>
				<param name="rlane_cd" type="12" value="" out="Y"/>
				<param name="dir_cd" type="12" value="" out="Y"/>
			</params>
		</query>
	</querys>
</sqls>
