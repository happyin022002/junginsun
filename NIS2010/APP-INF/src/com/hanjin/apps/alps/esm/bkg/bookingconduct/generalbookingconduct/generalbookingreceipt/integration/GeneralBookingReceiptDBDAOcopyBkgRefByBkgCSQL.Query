<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralBookingReceiptDBDAOcopyBkgRefByBkgCSQL">
			<desc><![CDATA[sourceBkg의 bkg_reference를 targetBkg로 복사한다.]]></desc>
			<sql><![CDATA[
insert into bkg_reference(BKG_NO 
,REF_SEQ 
,BKG_REF_TP_CD 
,CUST_REF_NO_CTNT
,CNTR_NO 
,CNTR_MF_SEQ 
,CPY_DESC_FLG 
,CRE_USR_ID 
,CRE_DT 
,UPD_USR_ID 
,UPD_DT
)
select @[targetBkg] BKG_NO 
			,(select /*+index_desc ( bkg_reference XPKBKG_REFERENCE)*/ 
					(nvl(sum(REF_SEQ),0)+1)+ref.REF_SEQ 
					from bkg_reference
					where REF_SEQ >= 0  
                    and rownum <= 1 
					and bkg_no = @[targetBkg] )REF_SEQ 
			,ref.BKG_REF_TP_CD 
			,ref.CUST_REF_NO_CTNT 
			,ref.CNTR_NO 
			,ref.CNTR_MF_SEQ 
			,ref.CPY_DESC_FLG 
			,@[usr_id] CRE_USR_ID 
			,sysdate CRE_DT 
			,@[usr_id] UPD_USR_ID 
			,sysdate UPD_DT
	from bkg_reference ref
   where ref.bkg_no = @[bkg_no]
 #if (${cntr_no}!='') 
    and ref.cntr_no =@[cntr_no] 
 #else 
	and ref.cntr_no is null
 #end			]]></sql>
			<params>
				<param name="targetBkg" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
