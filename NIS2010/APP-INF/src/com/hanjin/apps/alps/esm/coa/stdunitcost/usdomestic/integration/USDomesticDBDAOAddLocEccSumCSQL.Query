<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="USDomesticDBDAOAddLocEccSumCSQL">
			<desc><![CDATA[AddLocEccSum]]></desc>
			<sql><![CDATA[
--Location data를 ECC Level로 Summary--            
INSERT INTO COA_USA_DMST_UT_COST
      ( COST_YRMON
       ,ORG_RAIL_LOC_CD
       ,COST_LOC_GRP_CD
       ,CNTR_TPSZ_CD
       ,DMST_VOL_QTY
       ,RAILG_AMT
       ,EQ_RNTL_SCG_AMT
       ,FUEL_SCG_AMT
       ,HZD_MTRL_SCG_AMT
       ,DMST_TTL_FRT_REV_AMT
       ,RAIL_SO_VOL_QTY
       ,RAIL_AGMT_AMT
       ,TRP_QTY
       ,TRP_AMT
       ,TRP_UC_AMT      
       ,CRE_USR_ID
       ,CRE_DT
       ,UPD_USR_ID
       ,UPD_DT
      )
SELECT REPLACE(@[f_cost_yrmon], '-', '')         AS COST_YRMON
      ,COA_LOC_FNC(ORG_RAIL_LOC_CD, 'ECC') LOC_CD
      ,'E' --ECC Level 로 summary
      ,CNTR_TPSZ_CD
      ,SUM(DMST_VOL_QTY) 
      ,SUM(RAILG_AMT)
      ,SUM(EQ_RNTL_SCG_AMT)
      ,SUM(FUEL_SCG_AMT)
      ,SUM(HZD_MTRL_SCG_AMT)
      ,SUM(DMST_TTL_FRT_REV_AMT)
      ,SUM(RAIL_SO_VOL_QTY)
      ,SUM(RAIL_AGMT_AMT)
      ,SUM(TRP_QTY) AS TRP_QTY
      ,SUM(TRP_AMT) AS TRP_AMT
      ,SUM(TRP_AMT) / SUM(TRP_QTY) AS TRP_UC_AMT
      ,@[upd_usr_id]
      ,SYSDATE
      ,@[cre_usr_id]
      ,SYSDATE
 FROM COA_USA_DMST_UT_COST
WHERE COST_YRMON = REPLACE(@[f_cost_yrmon], '-', '')
GROUP BY COA_LOC_FNC(ORG_RAIL_LOC_CD, 'ECC'), CNTR_TPSZ_CD			]]></sql>
			<params>
				<param name="f_cost_yrmon" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
