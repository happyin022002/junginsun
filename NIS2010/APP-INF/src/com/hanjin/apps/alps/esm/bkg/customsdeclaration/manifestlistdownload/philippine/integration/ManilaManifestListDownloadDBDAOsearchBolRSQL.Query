<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ManilaManifestListDownloadDBDAOsearchBolRSQL">
			<desc><![CDATA[Philpplines Manifest 화면의 Bol 탭 정보 조회]]></desc>
			<sql><![CDATA[
SELECT OFC_CD
	 , REG_NO 
 	 , BL_NO
	 , BL_LINE_NO
	 , BL_SUB_LINE_NO
	 , BL_STS
	 , PRE_DOC
	 , BL_TP
	 , BL_NT_CD
	 , UQ_REF_NO
	 , SHPR_NM
	 , SHPR_ADDR1  
	 , SHPR_ADDR2
	 , SHPR_ADDR3
	 , SHPR_ADDR4
	 , CNEE_CD
	 , CNEE_NM
	 , CNEE_ADDR1
	 , CNEE_ADDR2
	 , CNEE_ADDR3
	 , CNEE_ADDR4 
	 , NTFY_CD
	 , NTFY_NM
	 , NTFY_ADDR1
	 , NTFY_ADDR2
	 , NTFY_ADDR3
	 , NTFY_ADDR4
	 , POR_CD
	 , DEL_CD
	 , TOT_CNTR	
	 , PCK_TP
	 , DECODE(PCK_QTY,0,1,PCK_QTY) AS PCK_QTY
	 , LTRIM(TO_CHAR(DECODE(WGT,0,1,WGT),'9999999990.999')) AS WGT
	 , LTRIM(TO_CHAR(DECODE(VOL,0,0.01,VOL),'9999999990.99999')) AS VOL 
	 , MK_DESC1
	 , MK_DESC2
	 , MK_DESC3
	 , MK_DESC4
	 , MK_DESC5
	 , MK_DESC6
	 , MK_DESC7
	 , MK_DESC8
	 , MK_DESC9
	 , MK_DESC10
	 , GDS_DESC1
	 , GDS_DESC2
	 , GDS_DESC3
	 , GDS_DESC4
	 , GDS_DESC5
	 , FRE_IND
	 , FRE_VAL
	 , FRE_CUR
	 , CSTMS_VAL
	 , CSTMS_CUR
	 , TRSP_VAL
	 , TRSP_CUR
	 , INSUR_VAL
	 , INSUR_CUR
	 , TOT_SUB_BL
	 , TOT_SEAL
	 , DEL_MOD
	 , INFO1
	 , INFO2
     , ROWNUM AS SEQ
  FROM (SELECT @[ofc_cd] AS OFC_CD
			 , @[reg_no]||'-'||TO_CHAR(SYSDATE, 'YY') AS REG_NO 
			 , BB.BL_NO AS BL_NO
			 , ROWNUM AS BL_LINE_NO
			 , '0' AS BL_SUB_LINE_NO
			 , '4' AS BL_STS
			 , '' AS PRE_DOC
			 , 'HBL' AS BL_TP
			 , '23' AS BL_NT_CD
			 , '' AS UQ_REF_NO
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(S.CUST_NM, CHR(13)||CHR(10),'  '),1,35),'NO SHIPPER NAME'),'J') AS SHPR_NM
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(S.CUST_ADDR, CHR(13)||CHR(10),'  '),1,35),''),'J') AS SHPR_ADDR1  
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(S.CUST_ADDR, CHR(13)||CHR(10),'  '),36,35),''),'J') AS SHPR_ADDR2
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(S.CUST_ADDR, CHR(13)||CHR(10),'  '),71,35),''),'J') AS SHPR_ADDR3
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(S.CUST_ADDR, CHR(13)||CHR(10),'  '),106,35),''),'J') AS SHPR_ADDR4
			 , '' AS CNEE_CD
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(C.CUST_NM, CHR(13)||CHR(10),'  '),1,35),'NO CONSIGNEE NAME'),'J') AS CNEE_NM
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(C.CUST_ADDR, CHR(13)||CHR(10),'  '),1,35),''),'J') AS CNEE_ADDR1
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(C.CUST_ADDR, CHR(13)||CHR(10),'  '),36,35),''),'J') AS CNEE_ADDR2
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(C.CUST_ADDR, CHR(13)||CHR(10),'  '),71,35),''),'J') AS CNEE_ADDR3
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(C.CUST_ADDR, CHR(13)||CHR(10),'  '),106,35),''),'J') AS CNEE_ADDR4 
			 , '' AS NTFY_CD
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(N.CUST_NM, CHR(13)||CHR(10),'  '),1,35),''),'J') AS NTFY_NM
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(N.CUST_ADDR, CHR(13)||CHR(10),'  '),1,35),''),'J') AS NTFY_ADDR1
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(N.CUST_ADDR, CHR(13)||CHR(10),'  '),36,35),''),'J') AS NTFY_ADDR2
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(N.CUST_ADDR, CHR(13)||CHR(10),'  '),71,35),''),'J') AS NTFY_ADDR3
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(N.CUST_ADDR, CHR(13)||CHR(10),'  '),106,35),''),'J') AS NTFY_ADDR4
			 , NVL(BB.POL_CD, 'XXXXX') AS POR_CD
			 , BB.POD_CD AS DEL_CD
			 , (SELECT COUNT(CNTR_NO)
				  FROM BKG_CONTAINER BC
				 WHERE BC.BKG_NO = BB.BKG_NO) AS TOT_CNTR	
			 , NVL(DOC.PCK_TP_CD, 'NE') AS PCK_TP
			 , NVL(DOC.PCK_QTY, 0) AS PCK_QTY
			 , NVL(DECODE(NVL(DOC.WGT_UT_CD,'KGS'),'KGS',NVL(DOC.ACT_WGT,0),'LBS',NVL(DOC.ACT_WGT,0)*0.45359),0) AS WGT
			 , NVL(TO_CHAR(DECODE(NVL(DOC.MEAS_UT_CD,'CBM'),'CBM',NVL(DOC.MEAS_QTY,0),'CBF',NVL(DOC.MEAS_QTY,0)*0.02831)),0.00) AS VOL
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(BMD.MK_DESC||BH.BL_MK_DESC, CHR(13)||CHR(10),'  '),1,35),'NO MARKS'),'J') AS MK_DESC1
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(BMD.MK_DESC||BH.BL_MK_DESC, CHR(13)||CHR(10),'  '),36,35),''),'J') AS MK_DESC2
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(BMD.MK_DESC||BH.BL_MK_DESC, CHR(13)||CHR(10),'  '),71,35),''),'J') AS MK_DESC3
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(BMD.MK_DESC||BH.BL_MK_DESC, CHR(13)||CHR(10),'  '),106,35),''),'J') AS MK_DESC4
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(BMD.MK_DESC||BH.BL_MK_DESC, CHR(13)||CHR(10),'  '),141,35),''),'J') AS MK_DESC5
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(BMD.MK_DESC||BH.BL_MK_DESC, CHR(13)||CHR(10),'  '),176,35),''),'J') AS MK_DESC6
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(BMD.MK_DESC||BH.BL_MK_DESC, CHR(13)||CHR(10),'  '),211,35),''),'J') AS MK_DESC7
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(BMD.MK_DESC||BH.BL_MK_DESC, CHR(13)||CHR(10),'  '),246,35),''),'J') AS MK_DESC8
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(BMD.MK_DESC||BH.BL_MK_DESC, CHR(13)||CHR(10),'  '),246,35),''),'J') AS MK_DESC9
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(BMD.MK_DESC||BH.BL_MK_DESC, CHR(13)||CHR(10),'  '),281,35),''),'J') AS MK_DESC10
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(DOC.PCK_CMDT_DESC||DOC.CNTR_CMDT_DESC||BMD.CMDT_DESC||BH.BL_GDS_DESC, CHR(13)||CHR(10),'  '),1,25),'NO GOODS DESCRIPTION'),'J') AS GDS_DESC1
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(DOC.PCK_CMDT_DESC||DOC.CNTR_CMDT_DESC||BMD.CMDT_DESC||BH.BL_GDS_DESC, CHR(13)||CHR(10),'  '),26,35),''),'J') AS GDS_DESC2
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(DOC.PCK_CMDT_DESC||DOC.CNTR_CMDT_DESC||BMD.CMDT_DESC||BH.BL_GDS_DESC, CHR(13)||CHR(10),'  '),61,35),''),'J') AS GDS_DESC3
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(DOC.PCK_CMDT_DESC||DOC.CNTR_CMDT_DESC||BMD.CMDT_DESC||BH.BL_GDS_DESC, CHR(13)||CHR(10),'  '),96,35),''),'J') AS GDS_DESC4
			 , BKG_SPCLCHAR_CONV_FNC(NVL(SUBSTR(REPLACE(DOC.PCK_CMDT_DESC||DOC.CNTR_CMDT_DESC||BMD.CMDT_DESC||BH.BL_GDS_DESC, CHR(13)||CHR(10),'  '),131,35),''),'J') AS GDS_DESC5
			 , 'P' AS FRE_IND
			 , LTRIM(TO_CHAR(0.01,'0.99')) AS FRE_VAL
			 , 'USD' AS FRE_CUR
 			 , LTRIM(TO_CHAR(0.01,'0.99')) AS CSTMS_VAL
			 , 'USD' AS CSTMS_CUR
			 , LTRIM(TO_CHAR(0.00,'0.99')) AS TRSP_VAL
			 , 'USD' AS TRSP_CUR
			 , '' AS INSUR_VAL
			 , 'USD' AS INSUR_CUR			
			 , '' AS TOT_SUB_BL
			 , '' AS TOT_SEAL
             ,  DECODE(BB.RCV_TERM_CD,'Y','CY-','S','CFS-','CY-')||DECODE(BB.DE_TERM_CD,'Y','CY','S','CFS','CY') DEL_MOD
			 , '' AS INFO1
			 , '' AS INFO2
		 FROM BKG_CUSTOMER S,
		      BKG_CUSTOMER C,
		      BKG_CUSTOMER N,
		      BKG_BOOKING BB,
		      BKG_VVD BV,
		      BKG_BL_DOC DOC,
			  BKG_BL_MK_DESC BMD,
			  BKG_HBL BH 
		WHERE 1=1
		  AND BB.BKG_NO = BMD.BKG_NO(+)
		  AND BB.BKG_NO = BH.BKG_NO(+)
		  AND BB.BKG_NO = S.BKG_NO(+) 
		  AND S.BKG_CUST_TP_CD = 'S' 
		  AND BB.BKG_NO = C.BKG_NO(+)  
		  AND C.BKG_CUST_TP_CD = 'C' 
		  AND BB.BKG_NO = N.BKG_NO(+)  
		  AND N.BKG_CUST_TP_CD = 'N' 
		  AND BB.BKG_NO = BV.BKG_NO 
		  AND BB.BKG_NO = DOC.BKG_NO 
		  AND BV.VSL_CD = @[vsl_cd] 
		  AND BV.SKD_VOY_NO = @[skd_voy_no] 
		  AND BV.SKD_DIR_CD = @[skd_dir_cd] 
#if (${pol_cd}!= '') 
		  AND BV.POL_CD = @[pol_cd] 
#end
#if (${pod_cd}!= '') 
		  AND BV.POD_CD = @[pod_cd] 
#end
		  AND BB.BKG_STS_CD IN ('F','W') 
		  AND BB.BL_NO > ' '
)			]]></sql>
			<params>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="reg_no" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
