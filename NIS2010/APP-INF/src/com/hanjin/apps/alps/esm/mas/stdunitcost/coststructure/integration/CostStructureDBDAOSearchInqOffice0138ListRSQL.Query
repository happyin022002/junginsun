<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CostStructureDBDAOSearchInqOffice0138ListRSQL">
			<desc><![CDATA[_NOD_AVG_STND_COST/_LNK_AVG_STND_COST 테이블의 TES/TRS 단가 조회 

2010.10.14 아키 위배사항 테스트 중 조회 데이터가 정렬이 필요한듯 쿼리 수정  ]]></desc>
			<sql><![CDATA[
#if (${f_sls_ofc_cd} == '' )
SELECT A1.OFC_CD
       , DECODE(A1.OFC_N2ND_LVL_TP_CD,NULL,' ', A1.OFC_N2ND_LVL_CD) AS ROOT2
       , DECODE(A1.OFC_N3RD_LVL_TP_CD,NULL,' ', A1.OFC_N3RD_LVL_CD) AS ROOT3
       , DECODE(A1.OFC_N4TH_LVL_TP_CD,NULL,' ', A1.OFC_N4TH_LVL_CD) AS ROOT4
       , DECODE(A1.OFC_N5TH_LVL_TP_CD,NULL,' ', A1.OFC_N5TH_LVL_CD) AS ROOT5
       , DECODE(A1.OFC_N6TH_LVL_TP_CD,NULL,' ', A1.OFC_N6TH_LVL_CD) AS ROOT6
       , DECODE(A1.OFC_N7TH_LVL_TP_CD,NULL,' ', A1.OFC_N7TH_LVL_CD) AS ROOT7
FROM   MAS_OFC_LVL A1
       , (SELECT DISTINCT DECODE(@[f_ofc_lvl],'1',OFC_N1ST_LVL_CD
                                , '2',OFC_N2ND_LVL_CD
                                , '3',OFC_N3RD_LVL_CD
                                , '4',OFC_N4TH_LVL_CD
                                , '5',OFC_N5TH_LVL_CD
                                , '6',OFC_N6TH_LVL_CD
                                , '7',OFC_N7TH_LVL_CD) AS OFC_CD
        FROM   MAS_OFC_LVL
        WHERE  DECODE(@[f_ofc_lvl],'1',OFC_N1ST_LVL_CD
                       , '2',OFC_N2ND_LVL_CD
                       , '3',OFC_N3RD_LVL_CD
                       , '4',OFC_N4TH_LVL_CD
                       , '5',OFC_N5TH_LVL_CD
                       , '6',OFC_N6TH_LVL_CD
                       , '7',OFC_N7TH_LVL_CD) = @[f_ofc_cd]
               AND TO_CHAR(SYSDATE,'YYYYMM') BETWEEN OFC_APLY_FM_YRMON AND OFC_APLY_TO_YRMON ) A2
WHERE  DECODE(@[f_ofc_lvl],'1',A1.OFC_N1ST_LVL_CD
               , '2',A1.OFC_N2ND_LVL_CD
               , '3',A1.OFC_N3RD_LVL_CD
               , '4',A1.OFC_N4TH_LVL_CD
               , '5',A1.OFC_N5TH_LVL_CD
               , '6',A1.OFC_N6TH_LVL_CD
               , '7',A1.OFC_N7TH_LVL_CD) = A2.OFC_CD
       AND DECODE(@[f_ofc_lvl],'1',A1.OFC_N1ST_LVL_CD
                   , '2',A1.OFC_N2ND_LVL_TP_CD
                   , '3',A1.OFC_N3RD_LVL_TP_CD
                   , '4',A1.OFC_N4TH_LVL_TP_CD
                   , '5',A1.OFC_N5TH_LVL_TP_CD
                   , '6',A1.OFC_N6TH_LVL_TP_CD
                   , '7',A1.OFC_N7TH_LVL_TP_CD) IS NOT NULL
       AND TO_CHAR(SYSDATE,'YYYYMM') BETWEEN A1.OFC_APLY_FM_YRMON AND A1.OFC_APLY_TO_YRMON
       AND (
            A1.OFC_CD = A1.OFC_N1ST_LVL_CD AND A1.OFC_LVL = '1' 
         OR A1.OFC_CD = A1.OFC_N2ND_LVL_CD AND A1.OFC_LVL = '2' AND A1.OFC_N2ND_LVL_TP_CD IS NOT NULL
         OR A1.OFC_CD = A1.OFC_N3RD_LVL_CD AND A1.OFC_LVL = '3' AND A1.OFC_N3RD_LVL_TP_CD IS NOT NULL
         OR A1.OFC_CD = A1.OFC_N4TH_LVL_CD AND A1.OFC_LVL = '4' AND A1.OFC_N4TH_LVL_TP_CD IS NOT NULL
         OR A1.OFC_CD = A1.OFC_N5TH_LVL_CD AND A1.OFC_LVL = '5' AND A1.OFC_N5TH_LVL_TP_CD IS NOT NULL
         OR A1.OFC_CD = A1.OFC_N6TH_LVL_CD AND A1.OFC_LVL = '6' AND A1.OFC_N6TH_LVL_TP_CD IS NOT NULL
         OR A1.OFC_CD = A1.OFC_N7TH_LVL_CD AND A1.OFC_LVL = '7' AND A1.OFC_N7TH_LVL_TP_CD IS NOT NULL
         OR A1.OFC_CD = A1.OFC_N7TH_LVL_CD AND A1.OFC_LVL = '9' 
         
           )
ORDER BY A1.OFC_LVL, A1.OFC_N1ST_LVL_CD,A1.OFC_N2ND_LVL_CD,A1.OFC_N3RD_LVL_CD,A1.OFC_N4TH_LVL_CD,A1.OFC_N5TH_LVL_CD

#else
SELECT OFC_CD
       , DECODE(OFC_N2ND_LVL_TP_CD,NULL,' ', OFC_N2ND_LVL_CD) AS ROOT2
       , DECODE(OFC_N2ND_LVL_TP_CD,NULL,' ', OFC_N3RD_LVL_CD) AS ROOT3
       , DECODE(OFC_N4TH_LVL_TP_CD,NULL,' ', OFC_N4TH_LVL_CD) AS ROOT4
       , DECODE(OFC_N5TH_LVL_TP_CD,NULL,' ', OFC_N5TH_LVL_CD) AS ROOT5
       , DECODE(OFC_N6TH_LVL_TP_CD,NULL,' ', OFC_N6TH_LVL_CD) AS ROOT6
       , DECODE(OFC_N7TH_LVL_TP_CD,NULL,' ', OFC_N7TH_LVL_CD) AS ROOT7
FROM   MAS_OFC_LVL A1
WHERE  DECODE(@[f_rhq_cd],'1',OFC_N1ST_LVL_CD
               , '2',OFC_N2ND_LVL_CD
               , '3',OFC_N3RD_LVL_CD
               , '4',OFC_N4TH_LVL_CD
               , '5',OFC_N5TH_LVL_CD
               , '6',OFC_N6TH_LVL_CD
               , '7',OFC_N7TH_LVL_CD) = @[f_sls_ofc_cd]
       AND DECODE(@[f_rhq_cd],'1',OFC_N1ST_LVL_CD
                   , '2',OFC_N2ND_LVL_TP_CD
                   , '3',OFC_N3RD_LVL_TP_CD
                   , '4',OFC_N4TH_LVL_TP_CD
                   , '5',OFC_N5TH_LVL_TP_CD
                   , '6',OFC_N6TH_LVL_TP_CD
                   , '7',OFC_N7TH_LVL_TP_CD) IS NOT NULL
       AND TO_CHAR(SYSDATE,'YYYYMM') BETWEEN OFC_APLY_FM_YRMON AND OFC_APLY_TO_YRMON
       AND (
            A1.OFC_CD = A1.OFC_N1ST_LVL_CD AND A1.OFC_LVL = '1' 
         OR A1.OFC_CD = A1.OFC_N2ND_LVL_CD AND A1.OFC_LVL = '2' AND A1.OFC_N2ND_LVL_TP_CD IS NOT NULL
         OR A1.OFC_CD = A1.OFC_N3RD_LVL_CD AND A1.OFC_LVL = '3' AND A1.OFC_N3RD_LVL_TP_CD IS NOT NULL
         OR A1.OFC_CD = A1.OFC_N4TH_LVL_CD AND A1.OFC_LVL = '4' AND A1.OFC_N4TH_LVL_TP_CD IS NOT NULL
         OR A1.OFC_CD = A1.OFC_N5TH_LVL_CD AND A1.OFC_LVL = '5' AND A1.OFC_N5TH_LVL_TP_CD IS NOT NULL
         OR A1.OFC_CD = A1.OFC_N6TH_LVL_CD AND A1.OFC_LVL = '6' AND A1.OFC_N6TH_LVL_TP_CD IS NOT NULL
         OR A1.OFC_CD = A1.OFC_N7TH_LVL_CD AND A1.OFC_LVL = '7' AND A1.OFC_N7TH_LVL_TP_CD IS NOT NULL
         OR A1.OFC_CD = A1.OFC_N7TH_LVL_CD AND A1.OFC_LVL = '9' 
         
           )
ORDER BY A1.OFC_LVL, A1.OFC_N1ST_LVL_CD,A1.OFC_N2ND_LVL_CD,A1.OFC_N3RD_LVL_CD,A1.OFC_N4TH_LVL_CD,A1.OFC_N5TH_LVL_CD

#end			]]></sql>
			<params>
				<param name="f_ofc_lvl" type="12" value="" out="N"/>
				<param name="f_ofc_cd" type="12" value="" out="N"/>
				<param name="f_rhq_cd" type="12" value="" out="N"/>
				<param name="f_sls_ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
