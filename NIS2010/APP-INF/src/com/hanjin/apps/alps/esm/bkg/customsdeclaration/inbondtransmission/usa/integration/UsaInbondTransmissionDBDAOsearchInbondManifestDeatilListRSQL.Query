<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UsaInbondTransmissionDBDAOsearchInbondManifestDeatilListRSQL">
			<desc><![CDATA[dwkim, 0408 하단 시트 조회용, Paperless MIB Generate 화면의 Inbond/Local 상세조회용.
outVO: UsaInbondManifestDetailListVO
public class UsaInbondManifestDetailListVO extends InbondManifestDetailListVO 수정해야함]]></desc>
			<sql><![CDATA[
SELECT A.BL_NO,
    MAX(A.DEL_CD) del_cd,
    MAX(A.USA_LST_LOC_CD) usa_lst_loc_cd,
    MAX(A.HUB_LOC_CD) hub_loc_cd,
    MAX(IBD.IBD_TRSP_NO) ibd_trsp_no,
    MAX(IBD.IBD_TRSP_TP_CD) ibd_trsp_tp_cd,
    MAX(TO_CHAR(A.PCK_QTY)) pck_qty,
    MAX(IBD.CSTMS_CLR_TP_CD) cstms_clr_tp_cd,
    --MAX(DECODE(A.IT_STAGE,NULL,'A','D')),
    MAX(IBD.LOCL_CLR_IPI_MVMT_FLG) locl_clr_ipi_mvmt_flg,
    MAX(NVL(CR.CSTMS_CLR_CD,'  ')) dspo_cd,
    MAX(R.RCV_LOC_CD) rcv_loc_cd,
    MAX(NVL(A.RCV_TERM_CD,' ')) rcv_term_cd,
    MAX(NVL(A.DE_TERM_CD,' '))de_term_cd,
    MAX(DECODE(BCK.CUST_TO_ORD_FLG,'Y',BCN.CUST_CNT_CD || BCN.CUST_SEQ, BCC.CUST_CNT_CD || BCC.CUST_SEQ)) cust_seq,
    REPLACE(DECODE(BCK.CUST_TO_ORD_FLG,'Y',BCN.CUST_NM, BCC.CUST_NM),CHR(13)||CHR(10),' ') cust_nm,
    MAX(A.CSTMS_LOC_CD) cstms_loc_cd,
	'' LCL_FLG, @[vvd] vvd, @[pod_cd] pod_cd, MAX(A.CSTMS_POL_CD) pol_cd,
	 MAX(A.USA_LST_LOC_CD) old_usa, MAX(IBD.CSTMS_CLR_TP_CD) old_entry, MAX(IBD.IBD_TRSP_TP_CD) old_tp,
	MAX(A.HUB_LOC_CD) old_hub,
	'' CSTMS_CLR_TP_CD_CHG, 	-- VO FILED
	'' LOCL_CLR_IPI_MVMT_FLG, 	-- VO FILED
    '' IBD_TRSP_TP_CD_CHG 		-- VO FILED
FROM BKG_CSTMS_ADV_BL A , BKG_CSTMS_ADV_IBD IBD 
    ,BKG_CSTMS_ADV_RSLT R , BKG_CUSTOMER BCC, BKG_BOOKING BCK, BKG_CUSTOMER BCN 
    ,BKG_CGO_RLSE CR--, MDM_LOCATION PL, MDM_LOCATION DL
WHERE A.CNT_CD = 'US'
     AND A.CNT_CD = IBD.CNT_CD(+)
     AND A.BL_NO = IBD.BL_NO(+)
     AND A.CNT_CD = R.CNT_CD(+)  
     AND A.BL_NO  = R.BL_NO(+)
     AND R.DSPO_CD(+) = '1C'
     AND A.VSL_CD = SUBSTR(@[vvd], 1, 4)
     AND A.SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
     AND A.SKD_DIR_CD = SUBSTR(@[vvd], 9, 1)
     AND A.CSTMS_POD_CD = @[pod_cd]
     AND NVL(A.HUB_LOC_CD,'C') = NVL(@[hub_loc_cd],'C')
     AND A.DEL_CD = @[del_cd]
	 AND A.CSTMS_LOC_CD = @[cstms_loc_cd]
#if (${inbond_local} != '') 
	AND IBD.CSTMS_CLR_TP_CD = @[inbond_local]
#end
     AND A.MF_STS_CD = 'A'
     AND  A.BKG_NO =  BCC.BKG_NO AND BCC.BKG_CUST_TP_CD = 'C'
     AND A.BKG_NO =  BCK.BKG_NO
     AND A.BKG_NO =  BCN.BKG_NO AND BCN.BKG_CUST_TP_CD = 'N'
     AND A.BL_NO = CR.BL_NO(+)
     AND (CR.CSTMS_CLR_CD is null OR CR.CSTMS_CLR_CD <> 'Y')
	-- 2009/11/13 정민정 과장 로컬만 조회 요청.
	-- 하동일 수석, pod의 SCC와 del의 SCC가 같으면 로컬임.
	-- 의미상, CSTMS_CLR_TP_CD의 I/L의 로컬과는 틀림.
	--AND A.POD_CD = PL.LOC_CD
	--AND A.DEL_CD = DL.LOC_CD
	--AND PL.SCC_CD = DL.SCC_CD
	AND A.MF_NO IS NULL
GROUP BY A.BL_NO, BCK.CUST_TO_ORD_FLG, BCC.CUST_NM, BCN.CUST_NM			]]></sql>
			<params>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="hub_loc_cd" type="12" value="" out="N"/>
				<param name="del_cd" type="12" value="" out="N"/>
				<param name="cstms_loc_cd" type="12" value="" out="N"/>
				<param name="inbond_local" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
