<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UnmatchBLDBDAOCreateRevenueAuditOftForMultiRatingCSQL">
			<desc><![CDATA[Group & Multi B/L Rating을위해 RevenueAuditOft를 생성한다.]]></desc>
			<sql><![CDATA[
INSERT INTO BKG_REV_AUD_CHG_TMP (
       BKG_NO      ,
       OFT_CMB_SEQ ,
       CHG_RT_SEQ  ,
       CHG_CD      ,
       RAT_UT_CD   ,
       CURR_CD     ,
       CHG_UT_AMT  ,
       RAT_AS_QTY  ,
       CHG_AMT     ,
       CGO_CATE_CD ,
       SOC_FLG     ,
       RCV_TERM_CD ,
       DE_TERM_CD  ,
	   CRE_USR_ID  ,
	   CRE_DT      ,
       UPD_USR_ID  ,
	   UPD_DT      ,
       FRT_TERM_CD ,
       TRF_ITM_NO  ,
       FRT_INCL_XCLD_DIV_CD,
       PRN_HDN_FLG ,
       NOTE_RT_SEQ ,
       PROP_NO     ,
       AMDT_SEQ    ,
       SVC_SCP_CD  ,
       GEN_SPCL_RT_TP_CD,
       CMDT_HDR_SEQ,
       ROUT_SEQ    ,
       IMDG_CLSS_CD,
       FX_RT_FLG,
       MST_RFA_ROUT_ID
       
)
SELECT BKG_NO      ,
       OFT_CMB_SEQ ,
       OFRT_SEQ    ,
       CHG_CD      ,
       RAT_UT_CD   ,
       CURR_CD     ,
       CHG_UT_AMT  ,
       RAT_AS_QTY  ,
       CHG_AMT     ,
       CASE WHEN DCGO_FLG    = 'Y' THEN 'DG'  
            WHEN AWK_CGO_FLG = 'Y' THEN 'AK'
            WHEN RC_FLG      = 'Y' THEN 'RF'
            WHEN BB_CGO_FLG  = 'Y' THEN 'BB'
            ELSE 'DR'  
       END CGO_CATE_CD ,
       SOC_FLG     ,
       RCV_TERM_CD ,
       DE_TERM_CD  ,
	   CRE_USR_ID  ,
	   SYSDATE     ,
       UPD_USR_ID  ,
	   SYSDATE     ,
       (SELECT FRT_TERM_CD FROM BKG_RATE R WHERE R.BKG_NO = T.BKG_NO),
       TRF_ITM_NO  ,
       FRT_INCL_XCLD_DIV_CD,
       'N' PRN_HDN_FLG ,
       PRC_RT_SEQ  ,
       PROP_NO     ,
       AMDT_SEQ    ,
       SVC_SCP_CD  ,
       PRC_GEN_SPCL_RT_TP_CD,
       PRC_CMDT_HDR_SEQ,
       PRC_ROUT_SEQ    ,
       IMDG_CLSS_CD,
       FX_RT_FLG,
       MST_RFA_ROUT_ID
FROM   BKG_AUTO_RT_OCN_FRT_TMP T			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
