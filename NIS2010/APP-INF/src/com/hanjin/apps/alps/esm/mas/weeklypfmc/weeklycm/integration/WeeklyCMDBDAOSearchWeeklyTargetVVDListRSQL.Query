<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WeeklyCMDBDAOSearchWeeklyTargetVVDListRSQL">
			<desc><![CDATA[History---------------------------------------------------
2011.04.18 이행지 [CHM-201110235-01] OPR 컬럼 추가(MAS_VSL_RGST.VOP_CD)]]></desc>
			<sql><![CDATA[
SELECT
     DECODE(NVL(A.bsa_zr_flg,'N'),'N', '0', '1')                BSA_ZR_FLG
    ,A.COST_YRMON                                               COST_YRMON
    ,A.SLS_YRMON                                                SLS_YRMON
    ,A.COST_WK                                                  COST_WK
    ,A.TRD_CD                                                   TRD_CD
    ,A.SUB_TRD_CD                                               SUB_TRD_CD
    ,B.SLAN_CD                                                  SLAN_CD
    ,A.RLANE_CD                                                 RLANE_CD
    ,B.VSL_LANE_TP_CD                                           VSL_LANE_TP_CD
    ,A.VSL_CD                                                   VSL_CD
    ,A.SKD_VOY_NO                                               SKD_VOY_NO
    ,A.DIR_CD                                                   DIR_CD
	, (SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD03217' AND INTG_CD_VAL_CTNT = B.HUL_BND_CD) HUL_BND_CD
    ,A.IOC_CD                                                   IOC_CD
    ,A.LST_LODG_PORT_CD                                         LST_LODG_PORT_CD
    ,TO_CHAR( A.LST_LODG_PORT_ETD_DT, 'YYYY-MM-DD HH24:MI:SS')  LST_LODG_PORT_ETD_DT
    ,TO_CHAR(A.N1ST_LODG_PORT_ETD_DT, 'YYYY-MM-DD HH24:MI:SS')  N1ST_LODG_PORT_ETD_DT
    ,CASE WHEN A.WKY_TGT_FLG = 'Y' THEN 'YES' ELSE 'NO' END     WKY_TGT_FLG
     --DECODE(A.wky_tgt_flg, 'N', 'NO', 'YES') wky_tgt_flg
    ,A.WKY_MNL_FLG                                              WKY_MNL_FLG
    ,DECODE(A.MON_TGT_FLG, 'N', 'NO', 'YES')                    MON_TGT_FLG
    ,A.DELT_FLG                                                 DELT_FLG
	,C.VOP_CD													VOP_CD

    ,A.COST_WK                                                  OLD_COST_WK
    ,DECODE(NVL(A.bsa_zr_flg,'N'),'N', '0', '1')                OLD_BSA_ZR_FLG

   FROM MAS_MON_VVD A
      , MAS_LANE_RGST B
      , MAS_VSL_RGST C
  WHERE A.TRD_CD     = B.TRD_CD
    AND A.RLANE_CD   = B.RLANE_CD
    AND A.IOC_CD     = B.IOC_CD
    AND A.DIR_CD     = B.DIR_CD
    AND A.VSL_CD     = C.VSL_CD(+)
    AND A.N1ST_LODG_PORT_ETD_DT BETWEEN VSL_APLY_FM_DT(+) AND VSL_APLY_TO_DT(+)
    #if (${f_chkdel} == '')
    AND NVL(A.DELT_FLG,'N') = 'N'
    #else
    AND NVL(A.DELT_FLG,'N') = 'Y'
    #end
    AND NVL(B.DELT_FLG,'N') = 'N'
    #if (${f_seltrade} != '')
    AND A.TRD_CD = @[f_seltrade]
    #end
    #if (${f_selrlane} != '')
    AND A.RLANE_CD = @[f_selrlane]
    #end
    #if (${f_seldir} != '')
    AND A.DIR_CD = @[f_seldir]
    #end
    #if (${f_selioc} != '')
    AND A.IOC_CD = @[f_selioc]
    #end
    #if (${f_selslane} != '')
    AND A.SLAN_CD = @[f_selslane]
    #end
    #if (${f_vsl_cd} != '')
    AND A.VSL_CD = @[f_vsl_cd]
    #end
    #if (${f_skd_voy_no} != '')
    AND A.SKD_VOY_NO = @[f_skd_voy_no]
    #end
    #if (${f_dir_cd} != '')
    AND A.DIR_CD = @[f_dir_cd]
    #end
    #if (${f_chkprd} == 'M')
    AND A.COST_YRMON BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]    
    #elseif(${f_chkprd} == 'W')
    AND A.SLS_YRMON LIKE @[f_year] || '%'
    AND A.COST_WK BETWEEN @[f_fm_wk] AND @[f_to_wk]
    #end
#if(${f_hul_bnd_cd} != '')
    AND B.HUL_BND_CD = @[f_hul_bnd_cd]
#end
 ORDER BY A.COST_YRMON
        , A.COST_WK
        , A.TRD_CD
        , B.SUB_TRD_CD
        , B.SLAN_CD			]]></sql>
			<params>
				<param name="f_seltrade" type="12" value="" out="N"/>
				<param name="f_selrlane" type="12" value="" out="N"/>
				<param name="f_seldir" type="12" value="" out="N"/>
				<param name="f_selioc" type="12" value="" out="N"/>
				<param name="f_selslane" type="12" value="" out="N"/>
				<param name="f_vsl_cd" type="12" value="" out="N"/>
				<param name="f_skd_voy_no" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_year" type="12" value="" out="N"/>
				<param name="f_fm_mon" type="12" value="" out="N"/>
				<param name="f_to_mon" type="12" value="" out="N"/>
				<param name="f_fm_wk" type="12" value="" out="N"/>
				<param name="f_to_wk" type="12" value="" out="N"/>
				<param name="f_hul_bnd_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
