<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UsWharfageDecMgtDBDAOsearchUsWhfSendCntrCntRSQL">
			<desc><![CDATA[searchUsWhfSendCntrCnt]]></desc>
			<sql><![CDATA[
SELECT '1' AS SEQ
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '20FF', RAT_AS_QTY, 0)) AS CNT_20F
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '20FM', RAT_AS_QTY, 0)) AS CNT_20E
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '40FF', RAT_AS_QTY, 0)) AS CNT_40F
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '40FM', RAT_AS_QTY, 0)) AS CNT_40E
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '45FF', RAT_AS_QTY, 0)) AS CNT_45F
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '45FM', RAT_AS_QTY, 0)) AS CNT_45E
  FROM BKG_USA_WHF_SND_QTY
 WHERE VSL_CD = SUBSTR(@[vvd], 1, 4)
   AND SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
   AND SKD_DIR_CD = SUBSTR(@[vvd], 9)
   AND PORT_CD = @[port]
   AND IO_BND_CD = @[bound]
#if (${type_rail} != '')
   AND USA_WHF_TRSP_TP_CD = 'L'
#else
   AND USA_WHF_TRSP_TP_CD IN ('L', 'R')
#end
UNION ALL
SELECT '2' AS SEQ
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '20FF', RAT_AS_QTY, 0)) AS CNT_20F
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '20FM', RAT_AS_QTY, 0)) AS CNT_20E
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '40FF', RAT_AS_QTY, 0)) AS CNT_40F
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '40FM', RAT_AS_QTY, 0)) AS CNT_40E
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '45FF', RAT_AS_QTY, 0)) AS CNT_45F
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '45FM', RAT_AS_QTY, 0)) AS CNT_45E
  FROM BKG_USA_WHF_SND_QTY
 WHERE VSL_CD = SUBSTR(@[vvd], 1, 4)
   AND SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
   AND SKD_DIR_CD = SUBSTR(@[vvd], 9)
   AND PORT_CD = @[port]
   AND IO_BND_CD = @[bound]
#if (${type_rail} != '')
   AND USA_WHF_TRSP_TP_CD = 'R'
#else
   AND 1=2
#end
UNION ALL
SELECT '3' AS SEQ
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '20FF', RAT_AS_QTY, 0)) AS CNT_20F
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '20FM', RAT_AS_QTY, 0)) AS CNT_20E
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '40FF', RAT_AS_QTY, 0)) AS CNT_40F
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '40FM', RAT_AS_QTY, 0)) AS CNT_40E
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '45FF', RAT_AS_QTY, 0)) AS CNT_45F
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '45FM', RAT_AS_QTY, 0)) AS CNT_45E
  FROM BKG_USA_WHF_SND_QTY
 WHERE VSL_CD = SUBSTR(@[vvd], 1, 4)
   AND SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
   AND SKD_DIR_CD = SUBSTR(@[vvd], 9)
   AND PORT_CD = @[port]
   AND IO_BND_CD = @[bound]
   AND USA_WHF_TRSP_TP_CD = 'T'
UNION ALL
SELECT '4' AS SEQ
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '20FF', RAT_AS_QTY, 0)) AS CNT_20F
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '20FM', RAT_AS_QTY, 0)) AS CNT_20E
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '40FF', RAT_AS_QTY, 0)) AS CNT_40F
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '40FM', RAT_AS_QTY, 0)) AS CNT_40E
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '45FF', RAT_AS_QTY, 0)) AS CNT_45F
      ,SUM(DECODE(USA_WHF_RAT_UT_CD||FULL_MTY_CD, '45FM', RAT_AS_QTY, 0)) AS CNT_45E
  FROM BKG_USA_WHF_SND_QTY
 WHERE VSL_CD = SUBSTR(@[vvd], 1, 4)
   AND SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
   AND SKD_DIR_CD = SUBSTR(@[vvd], 9)
   AND PORT_CD = @[port]
   AND IO_BND_CD = @[bound]
UNION ALL
SELECT '5' AS SEQ
      ,SUM(DECODE(FULL_MTY_CD, 'F', RAT_AS_QTY, 0)) AS CNT_20F
      ,SUM(DECODE(FULL_MTY_CD, 'M', RAT_AS_QTY, 0)) AS CNT_20E
      ,0 AS CNT_40F
      ,0 AS CNT_40E
      ,0 AS CNT_45F
      ,0 AS CNT_45E
  FROM BKG_USA_WHF_SND_QTY
 WHERE VSL_CD = SUBSTR(@[vvd], 1, 4)
   AND SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
   AND SKD_DIR_CD = SUBSTR(@[vvd], 9)
   AND PORT_CD = @[port]
   AND IO_BND_CD = @[bound]			]]></sql>
			<params>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="port" type="12" value="" out="N"/>
				<param name="bound" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
