<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BLDocumentationBLDBDAOSearchTgEctnNoRSQL">
			<desc><![CDATA[토고가 POL일 때 (아웃바운드) ECTN 값이 있는지 확인
토고가 POD일 때 (인바운드) ECTN 값이 있는지 확인
application date(bkg_rate)가 2016년 이후 부터 적용]]></desc>
			<sql><![CDATA[
SELECT  
decode((select 'Y'from bkg_vvd where bkg_no = @[bkg_no]and 'TG' = SUBSTR(pol_cd,1,2) AND ROWNUM = 1), 'Y','Y','N') pol_cd,
decode((select 'Y'from bkg_vvd where bkg_no = @[bkg_no]and 'TG' = SUBSTR(pod_cd,1,2) AND ROWNUM = 1), 'Y','Y','N') pod_cd,
nvl((
     SELECT TG_ECTN_NO
     FROM BKG_VVD A, BKG_XPT_IMP_LIC B
     WHERE A.BKG_NO = B.BKG_NO
     AND 'TG' = SUBSTR(A.POL_CD,1,2)
     AND A.BKG_NO = @[bkg_no]
     AND IO_BND_CD = 'O'
     AND TG_ECTN_NO is not null
     AND ROWNUM = 1
),'') TG_ECTN_NO_OB,
nvl((
     SELECT TG_ECTN_NO
     FROM BKG_VVD A, BKG_XPT_IMP_LIC B
     WHERE A.BKG_NO = B.BKG_NO
     AND 'TG' = SUBSTR(A.POD_CD,1,2)
     AND A.BKG_NO = @[bkg_no]
     AND IO_BND_CD = 'I'
     AND TG_ECTN_NO is not null
     AND ROWNUM = 1
),'') TG_ECTN_NO_IB,
decode((select 'Y' from bkg_rate where bkg_no = @[bkg_no] and to_char(RT_APLY_DT,'yyyy') = '2016'),'Y','Y','N') eff_dt        
FROM DUAL			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
