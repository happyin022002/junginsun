<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SalesRPTDBDAOSearchInqByCondition060ListRSQL">
			<desc><![CDATA[2015이전 주석은 페이지하단에 있음
2015.03.23 [CHM-201534153] 김시몬 CM/OP계정 추가 및 변경에 따라 보완
2015.04.22 [CHM-201534153] 김시몬 Dem/Det CM계정관련 수정
2015.05.14 손진환[CHM-201535771] [MAS] CGO RCV DT를 부킹 모듈 상에서 OC Status 발생 date를 바로 바라볼 수 있도록 로직 수정
2015.05.14 손진환[CHM-201535424] [MAS] COA 상 Fixed Rate 반영
2015.05.27 손진환[CHM-201536029] [MAS] COA 상 Fixed Rate 반영 요청 CSR
2015.07.06 김시몬[] DEMDET CM/OP 계산시 추가
2016.04.13 김성욱[CHM-201640967] inquiry by Customized Condition 검색시 제약조건 변경 및 data export 형식 변경
2017.05.17 김동호 [CSR #791] ALPS 화면의 실적산출 값에 'CNTR Size/Type'를 기본 컬럼으로 추가]]></desc>
			<sql><![CDATA[
#foreach(${keys} IN ${keyList6})
	 #if (${keys} == 'mty_pkup_yd_cd' || ${keys} == 'bkg_por_scc_cd'||${keys} == 'bkg_del_scc_cd')
       #set($condition = true)
     #end
#end
SELECT
       COST_YRMON                                                  AS COST_YRMON
      ,SLS_YRMON                                                   AS SLS_YRMON
      ,COST_WK                                                     AS COST_WK

#if(${f_include_ts} =='Y')
       , ts_sts     
#end      
      
#foreach(${keys} IN ${keyList1})
    #if (${keys} == 'obrd_dt' )
      ,TO_CHAR($keys,'YYYY-MM-DD') AS $keys
	#elseif(${keys} == 'cntr_rcv_dt')
	  ,TO_CHAR(MAX($keys),'YYYY-MM-DD') AS $keys
	#elseif(${keys} == 'n1st_trd_cd')
      , SUBSTR(VVD_INFO,1,3) N1ST_TRD_CD
	#elseif(${keys} == 'n2nd_trd_cd')
      , SUBSTR(VVD_INFO,29,3) N2ND_TRD_CD
	#elseif(${keys} == 'n3rd_trd_cd')
      , SUBSTR(VVD_INFO,57,3) N3RD_TRD_CD
	#elseif(${keys} == 'n4th_trd_cd')
      , SUBSTR(VVD_INFO,85,3) N4TH_TRD_CD
	#elseif(${keys} == 'n5th_trd_cd')
      , SUBSTR(VVD_INFO,113,3) N5TH_TRD_CD
	#elseif(${keys} == 'n1st_rlane_cd')
      , SUBSTR(VVD_INFO,5,5) N1ST_RLANE_CD
	#elseif(${keys} == 'n2nd_rlane_cd')
      , SUBSTR(VVD_INFO,33,5) N2ND_RLANE_CD
	#elseif(${keys} == 'n3rd_rlane_cd')
      , SUBSTR(VVD_INFO,61,5) N3RD_RLANE_CD
	#elseif(${keys} == 'n4th_rlane_cd')
      , SUBSTR(VVD_INFO,89,5) N4TH_RLANE_CD
	#elseif(${keys} == 'n5th_rlane_cd')
      , SUBSTR(VVD_INFO,117,5) N5TH_RLANE_CD
	#elseif(${keys} == 'n1st_finc_vvd_cd')
      , DECODE(SUBSTR(VVD_INFO,10,9),'XXXXXXXXX','',SUBSTR(VVD_INFO,10,9)) N1ST_FINC_VVD_CD
	#elseif(${keys} == 'n2nd_finc_vvd_cd')
      , DECODE(SUBSTR(VVD_INFO,38,9),'XXXXXXXXX','',SUBSTR(VVD_INFO,38,9)) N2ND_FINC_VVD_CD
	#elseif(${keys} == 'n3rd_finc_vvd_cd')
      , DECODE(SUBSTR(VVD_INFO,66,9),'XXXXXXXXX','',SUBSTR(VVD_INFO,66,9)) N3RD_FINC_VVD_CD
	#elseif(${keys} == 'n4th_finc_vvd_cd')
      , DECODE(SUBSTR(VVD_INFO,94,9),'XXXXXXXXX','',SUBSTR(VVD_INFO,94,9)) N4TH_FINC_VVD_CD
	#elseif(${keys} == 'n5th_finc_vvd_cd')
      , DECODE(SUBSTR(VVD_INFO,122,9),'XXXXXXXXX','',SUBSTR(VVD_INFO,122,9)) N5TH_FINC_VVD_CD
	#elseif(${keys} == 'n1st_pol_cd')
      , SUBSTR(VVD_INFO,19,5) N1ST_POL_CD
	#elseif(${keys} == 'n2nd_pol_cd')
      , SUBSTR(VVD_INFO,47,5) N2ND_POL_CD
	#elseif(${keys} == 'n3rd_pol_cd')
      , SUBSTR(VVD_INFO,75,5) N3RD_POL_CD
	#elseif(${keys} == 'n4th_pol_cd')
      , SUBSTR(VVD_INFO,103,5) N4TH_POL_CD
	#elseif(${keys} == 'n5th_pol_cd')
      , SUBSTR(VVD_INFO,131,5) N5TH_POL_CD
	#elseif(${keys} == 'n1st_pod_cd')
      , SUBSTR(VVD_INFO,24,5) N1ST_POD_CD
	#elseif(${keys} == 'n2nd_pod_cd')
      , SUBSTR(VVD_INFO,52,5) N2ND_POD_CD
	#elseif(${keys} == 'n3rd_pod_cd')
      , SUBSTR(VVD_INFO,80,5) N3RD_POD_CD
	#elseif(${keys} == 'n4th_pod_cd')
      , SUBSTR(VVD_INFO,108,5) N4TH_POD_CD
	#elseif(${keys} == 'n5th_pod_cd')
      , SUBSTR(VVD_INFO,136,5) N5TH_POD_CD	
	#elseif(${keys} == 'fixed_rate_flag')
      #set($fixed_rate_flag = true)
      , FX_RT_FLG AS FX_RT_FLG
	#elseif(${keys} == 'bkg_cre_dt')
	  ,TO_CHAR(MAX($keys),'YYYY-MM-DD') AS $keys
	#elseif(${keys} == 'cfm_dt')
	  ,TO_CHAR(MAX($keys),'YYYY-MM-DD') AS $keys
    #elseif (${keys} == 'pol_etb1')
      ,MAX(TO_CHAR((SELECT MAX(NVL(VPS_ETB_DT, INIT_ETB_DT)) KEEP (DENSE_RANK LAST ORDER BY CLPT_IND_SEQ) 
                  FROM VSK_VSL_PORT_SKD 
                 WHERE VSL_CD = SUBSTR(VVD_INFO,10,4)
                   AND SKD_VOY_NO = SUBSTR(VVD_INFO,14,4)
                   AND SKD_DIR_CD = SUBSTR(VVD_INFO,18,1)
                   AND VPS_PORT_CD = SUBSTR(VVD_INFO,19,5)), 'YYYY-MM-DD')) AS POL_ETB1
    #elseif (${keys} == 'pol_etb2')
      ,MAX(TO_CHAR((SELECT MAX(NVL(VPS_ETB_DT, INIT_ETB_DT)) KEEP (DENSE_RANK LAST ORDER BY CLPT_IND_SEQ) 
                  FROM VSK_VSL_PORT_SKD 
                 WHERE VSL_CD = SUBSTR(VVD_INFO,38,4)
                   AND SKD_VOY_NO = SUBSTR(VVD_INFO,42,4)
                   AND SKD_DIR_CD = SUBSTR(VVD_INFO,46,1)
                   AND VPS_PORT_CD = SUBSTR(VVD_INFO,47,5)), 'YYYY-MM-DD')) AS POL_ETB2
    #elseif (${keys} == 'pol_etb3')
      ,MAX(TO_CHAR((SELECT MAX(NVL(VPS_ETB_DT, INIT_ETB_DT)) KEEP (DENSE_RANK LAST ORDER BY CLPT_IND_SEQ) 
                  FROM VSK_VSL_PORT_SKD 
                 WHERE VSL_CD = SUBSTR(VVD_INFO,66,4)
                   AND SKD_VOY_NO = SUBSTR(VVD_INFO,70,4)
                   AND SKD_DIR_CD = SUBSTR(VVD_INFO,74,1)
                   AND VPS_PORT_CD = SUBSTR(VVD_INFO,75,5)), 'YYYY-MM-DD')) AS POL_ETB3
    #elseif (${keys} == 'pol_etb4')
      ,MAX(TO_CHAR((SELECT MAX(NVL(VPS_ETB_DT, INIT_ETB_DT)) KEEP (DENSE_RANK LAST ORDER BY CLPT_IND_SEQ) 
                  FROM VSK_VSL_PORT_SKD 
                 WHERE VSL_CD = SUBSTR(VVD_INFO,94,4)
                   AND SKD_VOY_NO = SUBSTR(VVD_INFO,98,4)
                   AND SKD_DIR_CD = SUBSTR(VVD_INFO,102,1)
                   AND VPS_PORT_CD = SUBSTR(VVD_INFO,103,5)), 'YYYY-MM-DD')) AS POL_ETB4
    #elseif (${keys} == 'pol_etb5')
      ,MAX(TO_CHAR((SELECT MAX(NVL(VPS_ETB_DT, INIT_ETB_DT)) KEEP (DENSE_RANK LAST ORDER BY CLPT_IND_SEQ) 
                  FROM VSK_VSL_PORT_SKD 
                 WHERE VSL_CD = SUBSTR(VVD_INFO,122,4)
                   AND SKD_VOY_NO = SUBSTR(VVD_INFO,126,4)
                   AND SKD_DIR_CD = SUBSTR(VVD_INFO,130,1)
                   AND VPS_PORT_CD = SUBSTR(VVD_INFO,131,5)), 'YYYY-MM-DD')) AS POL_ETB5
    #elseif (${keys} == 'pod_etb1')
      ,MAX(TO_CHAR((SELECT MAX(NVL(VPS_ETB_DT, INIT_ETB_DT)) KEEP (DENSE_RANK FIRST ORDER BY CLPT_IND_SEQ) 
                  FROM VSK_VSL_PORT_SKD 
                 WHERE VSL_CD = SUBSTR(VVD_INFO,10,4)
                   AND SKD_VOY_NO = SUBSTR(VVD_INFO,14,4)
                   AND SKD_DIR_CD = SUBSTR(VVD_INFO,18,1)
                   AND VPS_PORT_CD = SUBSTR(VVD_INFO,24,5)), 'YYYY-MM-DD')) AS POD_ETB1
    #elseif (${keys} == 'pod_etb2')
      ,MAX(TO_CHAR((SELECT MAX(NVL(VPS_ETB_DT, INIT_ETB_DT)) KEEP (DENSE_RANK FIRST ORDER BY CLPT_IND_SEQ) 
                  FROM VSK_VSL_PORT_SKD 
                 WHERE VSL_CD = SUBSTR(VVD_INFO,38,4)
                   AND SKD_VOY_NO = SUBSTR(VVD_INFO,42,4)
                   AND SKD_DIR_CD = SUBSTR(VVD_INFO,46,1)
                   AND VPS_PORT_CD = SUBSTR(VVD_INFO,52,5)), 'YYYY-MM-DD')) AS POD_ETB2
    #elseif (${keys} == 'pod_etb3')
      ,MAX(TO_CHAR((SELECT MAX(NVL(VPS_ETB_DT, INIT_ETB_DT)) KEEP (DENSE_RANK FIRST ORDER BY CLPT_IND_SEQ) 
                  FROM VSK_VSL_PORT_SKD 
                 WHERE VSL_CD = SUBSTR(VVD_INFO,66,4)
                   AND SKD_VOY_NO = SUBSTR(VVD_INFO,70,4)
                   AND SKD_DIR_CD = SUBSTR(VVD_INFO,74,1)
                   AND VPS_PORT_CD = SUBSTR(VVD_INFO,80,5)), 'YYYY-MM-DD')) AS POD_ETB3
    #elseif (${keys} == 'pod_etb4')
      ,MAX(TO_CHAR((SELECT MAX(NVL(VPS_ETB_DT, INIT_ETB_DT)) KEEP (DENSE_RANK FIRST ORDER BY CLPT_IND_SEQ) 
                  FROM VSK_VSL_PORT_SKD 
                 WHERE VSL_CD = SUBSTR(VVD_INFO,94,4)
                   AND SKD_VOY_NO = SUBSTR(VVD_INFO,98,4)
                   AND SKD_DIR_CD = SUBSTR(VVD_INFO,102,1)
                   AND VPS_PORT_CD = SUBSTR(VVD_INFO,108,5)), 'YYYY-MM-DD')) AS POD_ETB4
    #elseif (${keys} == 'pod_etb5')
      ,MAX(TO_CHAR((SELECT MAX(NVL(VPS_ETB_DT, INIT_ETB_DT)) KEEP (DENSE_RANK FIRST ORDER BY CLPT_IND_SEQ) 
                  FROM VSK_VSL_PORT_SKD 
                 WHERE VSL_CD = SUBSTR(VVD_INFO,122,4)
                   AND SKD_VOY_NO = SUBSTR(VVD_INFO,126,4)
                   AND SKD_DIR_CD = SUBSTR(VVD_INFO,130,1)
                   AND VPS_PORT_CD = SUBSTR(VVD_INFO,136,5)), 'YYYY-MM-DD')) AS POD_ETB5
    #elseif (${keys} == 'rt_dt')
		,( 
			select NVL( MIN( TO_CHAR(DTL.CRE_DT, 'YYYY-MM-DD HH24:MI')) , '' )
			from BKG_HIS_MST MST , BKG_HIS_DTL DTL
			WHERE MST.BKG_NO  = DTL.BKG_NO
					  AND MST.HIS_SEQ = DTL.HIS_SEQ
					  AND NVL(MST.CORR_NO, 'X') <> 'TMP0000001'
					  AND UPPER(NVL(DTL.CRNT_CTNT,'TMP')) NOT IN ('SEE CUSTOMER INFORMATION TAB', 'SEE FREIGHT & CHARGE TAB')
					  and MST.BKG_NO = chg_bkg_no
                      AND DTL.CRNT_CTNT LIKE '%OFT%'
		) AS CRE_DT
	 #elseif (${keys} == 'rert_dt')
		,(
		select DECODE ( MIN( TO_CHAR(DTL.CRE_DT, 'YYYY-MM-DD HH24:MI') ) , MAX( TO_CHAR(DTL.UPD_DT, 'YYYY-MM-DD HH24:MI') ), '' , MAX( TO_CHAR(DTL.UPD_DT, 'YYYY-MM-DD HH24:MI')) )
		from BKG_HIS_MST MST , BKG_HIS_DTL DTL
			WHERE MST.BKG_NO  = DTL.BKG_NO
					  AND MST.HIS_SEQ = DTL.HIS_SEQ
					  AND NVL(MST.CORR_NO, 'X') <> 'TMP0000001'
					  AND UPPER(NVL(DTL.CRNT_CTNT,'TMP')) NOT IN ('SEE CUSTOMER INFORMATION TAB', 'SEE FREIGHT & CHARGE TAB')
					  and MST.BKG_NO = chg_bkg_no
					  AND DTL.CRNT_CTNT LIKE '%OFT%'
		)RE_DT
	 #elseif(${keys} == 'vgm_wgt')
    ,(SELECT NVL(SUM(VGM_WGT),0) FROM BKG_CONTAINER WHERE BKG_NO = chg_bkg_no) AS VGM
	 #else
      ,$keys AS $keys
    #end
#end
      ,DIR_CD2                                                     AS DIR_CD2
/* 2017.05.17 [CSR #791] 에 따라 로직 변경
#if(${tpsz_sts} == 'BOX')
      ,TPSZ_CODE                                                   AS TPSZ_CODE
#end
*/
      ,TPSZ_CODE                                                   AS TPSZ_CODE
      ,SUM(LOAD)                                                   AS LOAD
#if (${mdm_charge_cd} != '')
      ,SUM(CHARGE_REV)                                   AS REV
--      ,0      AS MISC_REV --20150706 추가
--      ,0      AS DEMDET  --20150706 추가    
      ,0      AS CMC
      ,0      AS CM
      ,0      AS OPC
      ,0      AS OP
      ,SUM(CHARGE_REV)/SUM(LOAD)                                    AS G_RPB
      ,0      AS CM_COST
      ,0      AS CMCOST
      ,0      AS CMB
      ,0      AS BKG_CM	--20170601 
      ,0      AS BKG_CMB	--20170601 
      ,0      AS OP_COST
      ,0      AS OPCOST
      ,0      AS OPB
#else
      ,SUM(BKG_REV)              AS REV 
--      ,SUM(MISC_REV)             AS MISC_REV  --20150706 추가
--      ,SUM(DEM_DET)              AS DEMDET  --20150706 추가
      ,NVL(SUM(CM_COST),0)                        AS CMC
      ,SUM(BKG_REV+MISC_REV+DEM_DET)- NVL(SUM(CM_COST),0) AS CM	--20150706 
#if(${pro_lvl} =='M') -- 2012.01.02 SHKIM CM2 ADD
	  ,SUM(OWN_FDR_AMT) AS CM2C
	  ,SUM(BKG_REV+MISC_REV+DEM_DET) - NVL(SUM(CM_COST,0)) - SUM(OWN_FDR_AMT) AS CM2	  
#else	  
	  ,0 AS CM2C
	  ,0 AS CM2
#end
      ,SUM(BKG_REV)/SUM(LOAD)                                      AS G_RPB
      ,NVL(SUM(CM_COST),0)                                         AS CM_COST
      ,NVL(SUM(CM_COST),0) / SUM(LOAD)                             AS CMCOST
      ,(SUM(BKG_REV+MISC_REV+DEM_DET) - NVL(SUM(CM_COST),0) ) / SUM(LOAD)  AS CMB
      ,SUM(BKG_REV+MISC_REV)- NVL(SUM(CM_COST),0) + SUM(EQ_CM_COST) AS BKG_CM	--20170601 
      ,(SUM(BKG_REV+MISC_REV) - NVL(SUM(CM_COST),0) + SUM(EQ_CM_COST)) / SUM(LOAD)  AS BKG_CMB	--20170601 

      ,SUM(OP_COST)                                                AS OPC
      ,SUM(BKG_REV+MISC_REV+DEM_DET) - NVL(SUM(CM_COST),0) - SUM(OP_COST)  AS OP
      ,SUM(OP_COST)                                                AS OP_COST
      ,SUM(OP_COST)/SUM(LOAD)                                      AS OPCOST
      ,(SUM(BKG_REV+MISC_REV+DEM_DET) - NVL(SUM(CM_COST),0) - SUM(OP_COST))/SUM(LOAD) AS OPB
#end
  FROM (
  
   SELECT AA.*
#foreach(${keys} IN ${keyList2})
    #if(${keys} == 'cmpb_amt')
        ,(SELECT MAX(RV.CMPB_AMT) KEEP (DENSE_RANK LAST ORDER BY RV.REV_COST_SEQ) FROM BKG_REV_COST RV WHERE RV.BKG_NO = AA.CHG_BKG_NO) AS CMPB_AMT
    #end
    #if(${keys} == 'act_teu')
        ,(SELECT TRIM(TO_CHAR(SUM(DECODE(GREATEST('2', SUBSTR(CNTR_TPSZ_CD, 2, 1)), '2', 1, 0)) , '999999990.99')) FROM BKG_CONTAINER WHERE BKG_NO = AA.CHG_BKG_NO) AS ACT_TEU
    #end
    #if(${keys} == 'act_feu')
        ,(SELECT TRIM(TO_CHAR(SUM(DECODE(GREATEST('2', SUBSTR(CNTR_TPSZ_CD, 2, 1)), '2', 0, 1)) , '999999990.99')) FROM BKG_CONTAINER WHERE BKG_NO = AA.CHG_BKG_NO) AS ACT_FEU
    #end
    #if(${keys} == 'mst_rfa_rout_id')
        ,(SELECT MST_RFA_ROUT_ID FROM BKG_RATE WHERE BKG_NO = AA.CHG_BKG_NO) AS MST_RFA_ROUT_ID
    #end
#end
    FROM (
        
    SELECT 
          'dummy'  dummy_column
          ,D.BKG_NO AS CHG_BKG_NO
#if(${f_include_ts} =='Y' && ${rlane_cd} != 'RBCCO')
          ,CASE WHEN d.trd_cd||d.rlane_cd||d.vsl_cd||d.skd_voy_no||d.dir_cd = v.trd_cd||v.rlane_cd||v.vsl_cd||v.skd_voy_no||v.dir_cd
             THEN 'L/C'  ELSE 'T/S'  END TS_STS
#elseif (${f_include_ts} =='Y' && ${rlane_cd} == 'RBCCO')
          ,CASE WHEN d.trd_cd||d.rlane_cd = 'IASRBCCO'
             THEN 'L/C'  ELSE 'T/S'  END TS_STS
#end

          ,D.SPCL_CNTR_TPSZ_CD
#set($sc_desc_flg   = 'FALSE')
#set($cmdt_desc_flg = 'FALSE')
#set($bl_shpr_flg   = 'FALSE')
#set($grp_perp_flg   = 'FALSE')
#set($vvd_flg   = 'FALSE')
#foreach(${keys} IN ${keyList3})
    #if (${keys} == 'sc_desc')
          ,J.$keys AS $keys
    #set($sc_desc_flg = 'TRUE')
    #elseif (${keys} == 'rep_cmdt_desc')
          ,F.$keys AS $keys
    #set($cmdt_desc_flg = 'TRUE')
    #elseif (${keys} == 'shpr_nm')
          ,H.BL_SHPR_NM                                                                       AS SHPR_NM
    #set($bl_shpr_flg = 'TRUE')
    #elseif (${keys} == 'bkg_no')
          ,D.BKG_NO                                                                           AS BKG_NO
    #elseif (${keys} == 'rev_vvd')
          ,D.VSL_CD||D.SKD_VOY_NO||D.DIR_CD                                                   AS REV_VVD
    #elseif (${keys} == 'bl_no')
          ,DECODE(SUBSTR(D.BL_NO, 1, 4), 'KOSA', 'K' || D.BKG_NO, D.BL_NO || D.BL_NO_TP || D.BL_NO_CHK) BL_NO
    #elseif (${keys} == 'slan_cd')
          ,D.SLAN_CD                                                                          AS SLAN_CD
    #elseif (${keys} == 'soc_flg' || ${keys} == 'spcl_dg_cgo_flg' || ${keys} == 'spcl_bb_cgo_flg' || ${keys} == 'spcl_awk_cgo_flg')
          ,NVL(D.$keys, 'N') AS $keys
    #elseif (${keys} == 'bkg_cgo_tp_cd_r')
          ,DECODE(D.BKG_CGO_TP_CD, 'R', 'Y', 'N')                                             AS BKG_CGO_TP_CD_R
    #elseif (${keys} == 'bkg_cgo_wgt')
          ,D.BKG_CGO_WGT                                                                      AS BKG_CGO_WGT
    #elseif (${keys} == 'sc_cust_cd')
          ,D.AGMT_CNT_CD || TO_CHAR(lpad(DECODE(D.AGMT_CUST_SEQ,0,'',D.AGMT_CUST_SEQ),6,'0')) AS SC_CUST_CD
    #elseif (${keys} == 'cmdt_desc')
          ,K.CMDT_NM                                                                          AS CMDT_DESC
    #elseif (${keys} == 'sc_cust_nm')
          ,(SELECT CUST_LGL_ENG_NM
              FROM MDM_CUSTOMER B1
             WHERE D.AGMT_CNT_CD   = B1.CUST_CNT_CD(+)
               AND D.AGMT_CUST_SEQ = B1.CUST_SEQ(+)
           )                                          AS SC_CUST_NM
    #elseif (${keys} == 'bkg_shpr_cd')
          ,D.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(D.SHPR_CUST_SEQ,0,'',D.SHPR_CUST_SEQ),6,'0')) AS BKG_SHPR_CD
    #elseif (${keys} == 'agmt_act_cust_cd')
          ,D.AGMT_ACT_CNT_CD || TO_CHAR(lpad(DECODE(D.AGMT_ACT_CUST_SEQ,0,'',D.AGMT_ACT_CUST_SEQ),6,'0')) AS AGMT_ACT_CUST_CD
    #elseif (${keys} == 'bkg_shpr_nm')
          ,(SELECT CUST_LGL_ENG_NM
              FROM MDM_CUSTOMER B1
             WHERE D.SHPR_CNT_CD   = B1.CUST_CNT_CD(+)
               AND D.SHPR_CUST_SEQ = B1.CUST_SEQ(+)
           )                                          AS BKG_SHPR_NM
    #elseif (${keys} == 'cnee_cd')
          ,D.CNEE_CNT_CD || TO_CHAR(LPAD(DECODE(D.CNEE_CUST_SEQ,0,'',D.CNEE_CUST_SEQ),6,'0')) AS CNEE_CD
    #elseif (${keys} == 'cnee_nm')
          ,(SELECT CUST_LGL_ENG_NM
              FROM MDM_CUSTOMER B1
             WHERE D.CNEE_CNT_CD   = B1.CUST_CNT_CD(+)
               AND D.CNEE_CUST_SEQ = B1.CUST_SEQ(+))                                          AS CNEE_NM
    #elseif (${keys} == 'ntfy_cd')
          ,D.NTFY_CNT_CD || TO_CHAR(LPAD(DECODE(D.NTFY_CUST_SEQ,0,'',D.NTFY_CUST_SEQ),6,'0')) AS NTFY_CD
    #elseif (${keys} == 'ntfy_nm')
          ,(SELECT CUST_LGL_ENG_NM
              FROM MDM_CUSTOMER B1
             WHERE D.NTFY_CNT_CD   = B1.CUST_CNT_CD(+)
               AND D.NTFY_CUST_SEQ = B1.CUST_SEQ(+))                                          AS NTFY_NM
    #elseif (${keys} == 'shpr_cd')
          ,D.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(D.SHPR_CUST_SEQ,0,'',D.SHPR_CUST_SEQ),6,'0')) AS SHPR_CD
    #elseif (${keys} == 'bl_shpr_cd')
          ,D.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(D.SHPR_CUST_SEQ,0,'',D.SHPR_CUST_SEQ),6,'0')) AS BL_SHPR_CD
    #elseif (${keys} == 'mty_pkup_yd_cd')
         , B.MTY_PKUP_YD_CD MTY_PKUP_YD_CD
    #elseif (${keys} == 'bkg_por_scc_cd')
         , MAS_LOC_FNC(D.BKG_POR_CD,'SCC') BKG_POR_SCC_CD
    #elseif (${keys} == 'bkg_del_scc_cd')
         , MAS_LOC_FNC(D.BKG_DEL_CD,'SCC') BKG_DEL_SCC_CD
    #elseif (${keys} == 'bkg_por_ecc_cd')
         , MAS_LOC_FNC(D.BKG_POR_CD,'ECC') BKG_POR_ECC_CD
    #elseif (${keys} == 'bkg_del_ecc_cd')
         , MAS_LOC_FNC(D.BKG_DEL_CD,'ECC') BKG_DEL_ECC_CD
    #elseif (${keys} == 'bkg_por_lcc_cd')
         , MAS_LOC_FNC(D.BKG_POR_CD,'LCC') BKG_POR_LCC_CD
    #elseif (${keys} == 'bkg_del_lcc_cd')
         , MAS_LOC_FNC(D.BKG_DEL_CD,'LCC') BKG_DEL_LCC_CD
    #elseif (${keys} == 'bkg_por_rcc_cd')
         , MAS_LOC_FNC(D.BKG_POR_CD,'RCC') BKG_POR_RCC_CD
    #elseif (${keys} == 'bkg_del_rcc_cd')
         , MAS_LOC_FNC(D.BKG_DEL_CD,'RCC') BKG_DEL_RCC_CD
    #elseif (${keys} == 'ias_rgn_cd')
         , MAS_GET_CD_NM_FNC('CD03218', R.IAS_RGN_CD) AS IAS_RGN_CD
    #elseif (${keys} == 'hul_bnd_cd')
         , MAS_GET_CD_NM_FNC('CD03217', R.HUL_BND_CD) AS HUL_BND_CD
	#elseif (${keys} == 'rhq_cd_team')
         , GRP.rhq_cd AS $keys
	#set($grp_perp_flg = 'TRUE')
	#elseif (${keys} == 'ofc_team_cd')
         , GRP.$keys AS $keys
	#set($grp_perp_flg = 'TRUE')
	#elseif (${keys} == 'n1st_trd_cd' or ${keys} == 'n2nd_trd_cd' or ${keys} == 'n3rd_trd_cd' or ${keys} == 'n4th_trd_cd' or ${keys} == 'n5th_trd_cd' or
 			 ${keys} == 'n1st_rlane_cd' or ${keys} == 'n2nd_rlane_cd' or ${keys} == 'n3rd_rlane_cd' or ${keys} == 'n4th_rlane_cd' or ${keys} == 'n5th_rlane_cd' or
			 ${keys} == 'n1st_finc_vvd_cd' or ${keys} == 'n2nd_finc_vvd_cd' or ${keys} == 'n3rd_finc_vvd_cd' or ${keys} == 'n4th_finc_vvd_cd' or ${keys} == 'n5th_finc_vvd_cd' or
			 ${keys} == 'n1st_pol_cd' or ${keys} == 'n2nd_pol_cd' or ${keys} == 'n3rd_pol_cd' or ${keys} == 'n4th_pol_cd' or ${keys} == 'n5th_pol_cd' or
			 ${keys} == 'n1st_pod_cd' or ${keys} == 'n2nd_pod_cd' or ${keys} == 'n3rd_pod_cd' or ${keys} == 'n4th_pod_cd' or ${keys} == 'n5th_pod_cd' or
             ${keys} == 'pol_etb1' or ${keys} == 'pol_etb2' or ${keys} == 'pol_etb3' or ${keys} == 'pol_etb4' or ${keys} == 'pol_etb5' or
             ${keys} == 'pod_etb1' or ${keys} == 'pod_etb2' or ${keys} == 'pod_etb3' or ${keys} == 'pod_etb4' or ${keys} == 'pod_etb5'
			)
	#set($vvd_flg = 'TRUE')
	#elseif(${keys} == 'fixed_rate_flag')
		 , NVL(MRB.FX_RT_FLG, 'N' ) AS FX_RT_FLG
	#elseif (${keys} == 'rfa_ctrt_tp_cd')
	     , MAX((SELECT MAS_GET_CD_NM_FNC('CD03493', RFA_MN.$keys)
        	      FROM PRI_RP_MN RFA_MN
	                  ,PRI_RP_HDR RFA_HDR
        	     WHERE RFA_HDR.PROP_NO = RFA_MN.PROP_NO
                   AND RFA_MN.AMDT_SEQ = ( SELECT /*+ INDEX_DESC(A XPKPRI_RP_MN)*/ AMDT_SEQ FROM PRI_RP_MN A WHERE RFA_MN.PROP_NO = PROP_NO AND ROWNUM = 1)
                   AND RFA_HDR.RFA_NO = D.RFA_NO)) AS $keys
    #elseif (${keys} == 'bkg_cre_dt')
          ,B.BKG_CRE_DT AS BKG_CRE_DT
    #elseif (${keys} == 'cfm_dt')
          ,S.CFM_DT AS CFM_DT
    #elseif (${keys} == 'spc_bkg_sts_cd')
          ,CASE WHEN B.ALOC_STS_CD IN ('A', 'S') THEN 'S'
                WHEN B.ALOC_STS_CD = 'F' AND S.CFM_USR_ID IS NOT NULL AND S.CFM_DT IS NOT NULL THEN 'S->F'
                ELSE DECODE(B.ALOC_STS_CD, 'F', 'F', '')
                END SPC_BKG_STS_CD
    #elseif (${keys} == 'cmpb_amt')
    #elseif (${keys} == 'pol_etb1')
    #elseif (${keys} == 'pol_etb2')
    #elseif (${keys} == 'pol_etb3')
    #elseif (${keys} == 'pol_etb4')
    #elseif (${keys} == 'pol_etb5')
    #elseif (${keys} == 'pod_etb1')
    #elseif (${keys} == 'pod_etb2')
    #elseif (${keys} == 'pod_etb3')
    #elseif (${keys} == 'pod_etb4')
    #elseif (${keys} == 'pod_etb5')
    #elseif (${keys} == 'act_teu')
    #elseif (${keys} == 'act_feu')
	#elseif (${keys} == 'rert_dt')
	#elseif (${keys} == 'rt_dt')
    #elseif (${keys} == 'mst_rfa_rout_id')
    #elseif (${keys} == 'l_sls_ofc_cd')
	     , MAX((SELECT O.OFC_N5TH_LVL_CD
                  FROM MAS_OFC_LVL O
                 WHERE O.OFC_CD = D.SLS_OFC_CD
                 #if(${period} =='M')
                   AND D.COST_YRMON BETWEEN O.OFC_APLY_FM_YRMON AND O.OFC_APLY_TO_YRMON
                 #elseif(${period} =='W')
                   AND D.SLS_YRMON BETWEEN O.OFC_APLY_FM_YRMON AND O.OFC_APLY_TO_YRMON
                 #end
               )
              ) AS L_SLS_OFC_CD
    #else
        #if(${keys} == 'cust_grp_id')
            #if(${f_cust_tp} != 'S')    
                ,(SELECT NVL(B1.CUST_GRP_ID, D.AGMT_CNT_CD||D.AGMT_CUST_SEQ) FROM MDM_CUSTOMER B1    -- CONTRACT CUSTOMER
                    WHERE 1=1 
                        AND D.AGMT_CUST_SEQ = B1.CUST_SEQ(+) 
                        AND D.AGMT_CNT_CD = B1.CUST_CNT_CD(+)
                ) AS $keys
            #else                       
                ,(SELECT NVL(B1.CUST_GRP_ID, D.SHPR_CNT_CD||D.SHPR_CUST_SEQ) FROM MDM_CUSTOMER B1    -- SHIPPER
                    WHERE 1=1
                        AND D.SHPR_CUST_SEQ = B1.CUST_SEQ(+)
                        AND D.SHPR_CNT_CD = B1.CUST_CNT_CD(+)
                ) AS $keys
                
            #end
        #elseif(${keys} == 'cust_grp_nm')
            #if(${f_cust_tp} != 'S')    
                ,(SELECT NVL(B2.CUST_GRP_NM, B1.CUST_LGL_ENG_NM) FROM MDM_CUSTOMER B1, MDM_CUST_PERF_GRP B2     -- CONTRACT CUSTOMER
                    WHERE 1=1
                        AND D.AGMT_CNT_CD = B1.CUST_CNT_CD(+)
                        AND D.AGMT_CUST_SEQ = B1.CUST_SEQ(+) 
                        AND B1.CUST_GRP_ID = B2.CUST_GRP_ID(+)
                ) AS $keys
            #else                       
                ,(SELECT NVL(B2.CUST_GRP_NM, B1.CUST_LGL_ENG_NM) FROM MDM_CUSTOMER B1, MDM_CUST_PERF_GRP B2   -- SHIPPER
                    WHERE 1=1
                        AND D.SHPR_CNT_CD = B1.CUST_CNT_CD(+)
                        AND D.SHPR_CUST_SEQ = B1.CUST_SEQ(+)
                        AND B1.CUST_GRP_ID = B2.CUST_GRP_ID(+)
                ) AS $keys
                
            #end
		#elseif(${keys} == 'cntr_rcv_dt')
			#set($cntr_rcv_dt_condition = true)
			,MAX(C.CGO_RCV_DT) AS cntr_rcv_dt
	 #elseif(${keys} == 'vgm_wgt')
    ,(SELECT SUM(VGM_WGT) FROM BKG_CONTAINER WHERE BKG_NO = D.BKG_NO) AS VGM
        #else
            ,D.$keys AS $keys            
        #end
    #end
#end
		#if(${vvd_flg} == 'TRUE')
		 , MAS_PSG_TS_ARRAY_FNC(D.n1st_trd_cd,
                              DECODE (MAS_SLAN_CONTI_CONV_FNC(D.n1st_finc_vvd_cd,substr(D.N1ST_RLANE_CD,1,3),SUBSTR (D.n1st_ioc_conti_cd, 1, 1))
                                     ,MAS_SLAN_CONTI_CONV_FNC(D.n1st_finc_vvd_cd,substr(D.N1ST_RLANE_CD,1,3),SUBSTR (D.n1st_ioc_conti_cd, 2, 1)), 'I' ,'O'),
                              D.n1st_rlane_cd, SUBSTR (D.n1st_finc_vvd_cd, 1, 9), D.n1st_pol_cd, D.n1st_pod_cd, --1
                              D.n2nd_trd_cd,
                              DECODE (MAS_SLAN_CONTI_CONV_FNC(D.n2nd_finc_vvd_cd,substr(D.N2nd_RLANE_CD,1,3),SUBSTR (D.n2nd_ioc_conti_cd, 1, 1))
                                     ,MAS_SLAN_CONTI_CONV_FNC(D.n2nd_finc_vvd_cd,substr(D.n2nd_RLANE_CD,1,3),SUBSTR (D.n2nd_ioc_conti_cd, 2, 1)), 'I' ,'O'),
                              D.n2nd_rlane_cd, SUBSTR (D.n2nd_finc_vvd_cd, 1, 9), D.n2nd_pol_cd, D.n2nd_pod_cd, --2
                              D.n3rd_trd_cd,
                              DECODE (MAS_SLAN_CONTI_CONV_FNC(D.n3rd_finc_vvd_cd,substr(D.n3rd_RLANE_CD,1,3),SUBSTR (D.n3rd_ioc_conti_cd, 1, 1))
                                     ,MAS_SLAN_CONTI_CONV_FNC(D.n3rd_finc_vvd_cd,substr(D.n3rd_RLANE_CD,1,3),SUBSTR (D.n3rd_ioc_conti_cd, 2, 1)), 'I' ,'O'),
                              D.n3rd_rlane_cd, SUBSTR (D.n3rd_finc_vvd_cd, 1, 9), D.n3rd_pol_cd, D.n3rd_pod_cd, --3
                              D.n4th_trd_cd,
                              DECODE (MAS_SLAN_CONTI_CONV_FNC(D.n4th_finc_vvd_cd,substr(D.n4th_RLANE_CD,1,3),SUBSTR (D.n4th_ioc_conti_cd, 1, 1))
                                     ,MAS_SLAN_CONTI_CONV_FNC(D.n4th_finc_vvd_cd,substr(D.n4th_RLANE_CD,1,3),SUBSTR (D.n4th_ioc_conti_cd, 2, 1)), 'I' ,'O'),
                              D.n4th_rlane_cd, SUBSTR (D.n4th_finc_vvd_cd, 1, 9), D.n4th_pol_cd, D.n4th_pod_cd --4
                             ) vvd_info
		#end
          ,DECODE('${wk_sts}',  'Y', D.COST_YRMON, '', DECODE('${period}', 'M', D.COST_YRMON, ''))                AS COST_YRMON
          ,DECODE('${wk_sts}',  'Y', D.SLS_YRMON, '')                                                           AS SLS_YRMON
          ,DECODE('${wk_sts}',  'Y', D.COST_WK, '')                                                             AS COST_WK
          ,DECODE('${dir_sts}', 'Y', D.DIR_CD,  '')                                                             AS DIR_CD2
/* 2017.05.17 [CSR #791] 에 따라 로직 변경
          ,DECODE('${tpsz_sts}', 'BOX', D.SPCL_CNTR_TPSZ_CD, 'TEU','')                                          AS TPSZ_CODE
*/
          ,D.SPCL_CNTR_TPSZ_CD                                                                                  AS TPSZ_CODE
          ,DECODE('${tpsz_sts}', 'BOX', SUM(NVL(D.BKG_QTY,0)), 'TEU',SUM(DECODE(SUBSTR(D.SPCL_CNTR_TPSZ_CD,-1,1),'2', D.BKG_QTY, '3', D.BKG_QTY, D.BKG_QTY*2))) AS LOAD
          ,SUM(NVL(D.BKG_REV,0)+NVL(D.BKG_OFT_REV,0))                                                              AS BKG_REV
          ,SUM(NVL(D.BKG_MISC_REV,0)+NVL(D.SCR_CHG_REV,0))                                                         AS MISC_REV
          
		  ,SUM(DECODE('${pro_vw}', 'P', NVL(D.PA_CM_COST_TTL_AMT, 0)   , 'R', NVL(D.RA_CM_COST_TTL_AMT, 0)))    AS CM_COST
#if(${pro_lvl} =='M') -- 2012.01.02 SHKIM CM2 ADD
		  ,SUM(D.OWN_FDR_AMT) AS OWN_FDR_AMT
#end
          ,SUM(DECODE('${pro_vw}', 'P', NVL(A6.PA_OP_COST_TTL_AMT, 0), 'R', 0))                                  AS OP_COST
          ,SUM(NVL(D.DMDT_COM_AMT,0))                                                                                     AS DEM_DET
          ,SUM(NVL(D.BKG_QTY, 0)) AS CHARGE_LOAD

	,SUM(	NVL(D.CNTR_STERM_RNTL_LAND_AMT, 0)+ 
		NVL(D.CNTR_LTERM_RNTL_LAND_AMT, 0) +
		NVL(D.CNTR_MNR_LAND_AMT, 0)        +
		NVL(D.CNTR_DPC_LAND_AMT, 0)        +
		NVL(D.CNTR_INSUR_LAND_AMT, 0)      +
		NVL(D.CNTR_STERM_RNTL_OTR_AMT, 0)  +
		NVL(D.CNTR_LTERM_RNTL_OTR_AMT, 0)  +
		NVL(D.CNTR_MNR_OTR_AMT, 0)         +
		NVL(D.CNTR_DPC_OTR_AMT, 0)         +
		NVL(D.CNTR_INSUR_OTR_AMT, 0)       +
		NVL(D.CHSS_AMT, 0)                 +
        NVL(D.CNTR_RNTL_NORM_AMT, 0)       +  
        NVL(D.CNTR_MNR_NORM_AMT, 0)        +
        NVL(D.CNTR_DPC_NORM_AMT, 0)        + 
        NVL(D.CNTR_INSUR_NORM_AMT, 0) )    AS EQ_CM_COST --20170601 

#if (${mdm_charge_cd} != '')
          ,MAS_GET_REV_AMT_FNC (D.BKG_NO, D.SPCL_CNTR_TPSZ_CD,'${mdm_charge_cd}','${period}','${mdm_charge_type_cd}') AS CHARGE_REV
#end
          FROM
               MAS_OFC_LVL L
              ,MAS_MON_VVD V 
              ,MAS_LANE_RGST R
#if(${period} =='M')
              ,MAS_BKG_EXPN_DTL D
#elseif (${period} =='W')
              ,MAS_BKG_EXPN_DTL_WK D
#end
              ,MDM_COMMODITY    K
              ,MAS_BKG_OP_EXPN_DTL A6
#if(${grp_perp_flg} =='TRUE' || (${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))
			  ,MDM_CUST_PERF_GRP GRP
#end
#if (${soc_sts} == 'Y')
              ,MAS_BKG_REV_DTL H
#end
#if (${cmdt_desc_flg} == 'TRUE')
              ,(SELECT REP_CMDT_CD AS REP_CMDT_CD
                      ,REP_CMDT_NM AS REP_CMDT_DESC
                 FROM MDM_REP_CMDT
                WHERE NVL(DELT_FLG,'N') = 'N'
               ) F
#end
#if (${sc_desc_flg} == 'TRUE')
              ,(SELECT CUST_CNT_CD     AS CUST_CNT_CD
                      ,CUST_SEQ        AS CUST_SEQ
                      ,CUST_LGL_ENG_NM AS SC_DESC
                  FROM MDM_CUSTOMER
                ) J
#end
#if (${bl_shpr_flg} == 'TRUE')
              ,(SELECT CUST_CNT_CD     AS CUST_CNT_CD
                      ,CUST_SEQ        AS CUST_SEQ
                      ,CUST_LGL_ENG_NM AS BL_SHPR_NM
                  FROM MDM_CUSTOMER
                ) H
#end
#if (((${key_acct_group} != '' && ${key_acct_group} != 'All') || ${otr_key_acct} != '') || (${otr_regional_acct} == '' && ${local_acct} == '' && ${f_cust_tp} == 'C' && ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))))
              ,MDM_CUSTOMER CO
#if ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))
              ,MDM_CUST_PERF_GRP CO_GRP
#end
#end

#if ((${f_ra_acct_group_cd} != '' && ${f_ra_acct_group_cd} != 'All') || ${otr_regional_acct} != '' || (${otr_regional_acct} != '' && ${f_cust_tp} == 'C' && ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))))
              ,MDM_CUSTOMER RGN
#if ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))
              ,MDM_CUST_PERF_GRP RGN_GRP
#end
#end

#if (${local_acct} != '' || (${local_acct} != '' && ${f_cust_tp} == 'C' && ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))))
              ,MDM_CUSTOMER LCL
#if ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))
              ,MDM_CUST_PERF_GRP LCL_GRP
#end
#end

#if (${mdm_charge_cd} != '')
              ,(SELECT DISTINCT BKG_NO 
                  FROM BKG_CHG_RT 
                 WHERE CHG_CD = '${mdm_charge_cd}'
                   AND FRT_INCL_XCLD_DIV_CD = DECODE('${mdm_charge_type_cd}','',FRT_INCL_XCLD_DIV_CD,'${mdm_charge_type_cd}')
                )RT
#end

              ,BKG_BOOKING B
              ,SPC_SB_BKG S

#if(${f_include_ts} =='Y' && ${rlane_cd} != 'RBCCO')
              , BKG_VVD BV
#end

#if(${f_fixed_rate} == 'Y' || $fixed_rate_flag )
			, MAS_RGST_BKG MRB
#end


#if( $cntr_rcv_dt_condition )
			, ( SELECT BKG_NO, MAX(CGO_RCV_DT) AS CGO_RCV_DT 
        		FROM BKG_CONTAINER 
		        GROUP BY BKG_NO ) C
#end
          WHERE 1=1
            AND D.BKG_NO = B.BKG_NO
            AND D.BKG_NO = S.BKG_NO(+)

#if (${mt_pu_cd} !='')         
            AND B.MTY_PKUP_YD_CD LIKE '${mt_pu_cd}'||DECODE('${mt_pu_yd_cd}','All','','${mt_pu_yd_cd}')||'%'  -- 화면에서 MT Pick up 5+2
#end

#if (${mdm_charge_cd} != '')
           AND D.BKG_NO = RT.BKG_NO
#end
#if (${srep_cd} != '')
#if(${ofc_vw} =='C')
           AND D.CTRT_SREP_CD = '${srep_cd}'
#else
           AND D.SREP_CD = '${srep_cd}'
#end
#end
#if(${period} =='M')
  #if(${f_include_ts} =='Y' && ${rlane_cd} != 'RBCCO')
           AND V.COST_YRMON  BETWEEN '${year}'||'${fm_mon}' AND '${year}'||'${to_mon}'
           AND V.VSL_CD              = BV.VSL_CD 
           AND V.SKD_VOY_NO          = BV.SKD_VOY_NO 
           AND V.DIR_CD              = BV.SKD_DIR_CD 
           AND BV.BKG_NO             = D.BKG_NO 
  #else
           AND D.COST_YRMON  BETWEEN '${year}'||'${fm_mon}' AND '${year}'||'${to_mon}'             
           AND V.TRD_CD              = D.TRD_CD 
           AND V.RLANE_CD            = D.RLANE_CD 
           AND V.IOC_CD              = D.IOC_CD 
           AND V.VSL_CD              = D.VSL_CD 
           AND V.SKD_VOY_NO          = D.SKD_VOY_NO 
           AND V.DIR_CD              = D.DIR_CD 
  #end
           AND D.COST_YRMON  BETWEEN L.OFC_APLY_FM_YRMON AND L.OFC_APLY_TO_YRMON
#elseif (${period} =='W')

  #if(${f_include_ts} =='Y' && ${rlane_cd} != 'RBCCO')
           AND SUBSTR(V.SLS_YRMON, 1, 4)||V.COST_WK BETWEEN '${year}'||'${fm_wk}' AND '${year}'||'${to_wk}'
           AND V.VSL_CD              = BV.VSL_CD 
           AND V.SKD_VOY_NO          = BV.SKD_VOY_NO 
           AND V.DIR_CD              = BV.SKD_DIR_CD 
           AND BV.BKG_NO             = D.BKG_NO 
           
    #if ( ${sls_month} != '')
           AND V.SLS_YRMON = '${year}'||'${fm_mon}'
    #end
  #else
           AND SUBSTR(D.SLS_YRMON, 1, 4)||D.COST_WK BETWEEN '${year}'||'${fm_wk}' AND '${year}'||'${to_wk}'             
           AND V.TRD_CD              = D.TRD_CD 
           AND V.RLANE_CD            = D.RLANE_CD 
           AND V.IOC_CD              = D.IOC_CD 
           AND V.VSL_CD              = D.VSL_CD 
           AND V.SKD_VOY_NO          = D.SKD_VOY_NO 
           AND V.DIR_CD              = D.DIR_CD 
    #if ( ${sls_month} != '')
           AND D.SLS_YRMON = '${year}'||'${fm_mon}'
    #end
  #end  
           AND D.SLS_YRMON  BETWEEN L.OFC_APLY_FM_YRMON AND L.OFC_APLY_TO_YRMON
#end

#if (${f_fixed_rate} == 'Y' || $fixed_rate_flag )
		   AND MRB.BKG_NO			 = D.BKG_NO
#end
#if(${f_fixed_rate} == 'Y' )
		   AND MRB.FX_RT_FLG		 = 'Y'
#end

#if(${ofc_vw} =='C')
           AND D.AGMT_SGN_OFC_CD = L.OFC_CD
#elseif (${ofc_vw} =='L')
           AND D.SLS_OFC_CD = L.OFC_CD
#else
           AND 1 = 0
#end
#if (${sc_desc_flg} == 'TRUE')
           AND D.AGMT_CNT_CD   = J.CUST_CNT_CD(+)
           AND D.AGMT_CUST_SEQ = J.CUST_SEQ(+)
#end
#if (${bl_shpr_flg} == 'TRUE')
           AND D.SHPR_CNT_CD   = H.CUST_CNT_CD(+)
           AND D.SHPR_CUST_SEQ = H.CUST_SEQ(+)
#end
#if (${cmdt_desc_flg} == 'TRUE')
           AND D.REP_CMDT_CD = F.REP_CMDT_CD
#end
#if (${grp_perp_flg} == 'TRUE' || ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All')))
           AND D.CUST_GRP_ID = GRP.CUST_GRP_ID(+)
#end
           AND D.CMDT_CD             = K.CMDT_CD(+)
           AND NVL(V.DELT_FLG,'N')   = 'N'


           AND D.BL_NO_TP             IN ('M','0')
           AND D.BKG_STS_CD           IN ('F','S',DECODE(NVL('${bkg_sts}','N'), 'Y', 'W'))
           AND NVL(D.BKG_CGO_TP_CD,'*') <> 'P'
           AND V.RLANE_CD            = R.RLANE_CD
           AND V.DIR_CD              = R.DIR_CD
           AND V.IOC_CD              = R.IOC_CD
           AND V.TRD_CD              = R.TRD_CD
           AND R.DELT_FLG            = 'N'

#if (${ias_rgn_cd} != '')
           AND R.IAS_RGN_CD          = '${ias_rgn_cd}'
#end
#if (${hul_bnd_cd} != '')
           AND R.HUL_BND_CD          = '${hul_bnd_cd}'
#end

#if ((${key_acct_group} != '' && ${key_acct_group} != 'All') || ${otr_key_acct} != '' || (${otr_regional_acct} == '' && ${local_acct} == '' && ${f_cust_tp} == 'C' && ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))))
#if (${f_cust_tp} != 'S')
           AND D.AGMT_CNT_CD   = CO.CUST_CNT_CD
           AND D.AGMT_CUST_SEQ = CO.CUST_SEQ
#if ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))
           AND CO.CUST_GRP_ID   = CO_GRP.CUST_GRP_ID(+)
#end
#else
           AND D.SHPR_CNT_CD   = CO.CUST_CNT_CD
           AND D.SHPR_CUST_SEQ = CO.CUST_SEQ
#if ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))
           AND CO.CUST_GRP_ID   = CO_GRP.CUST_GRP_ID(+)
#end
#end
           AND CO.NEW_KEY_ACCT_FLG  = 'Y'
           AND CO.CNTR_DIV_FLG  = 'Y'
           AND CO.DELT_FLG      = 'N'
#end

#if ((${f_ra_acct_group_cd} != '' && ${f_ra_acct_group_cd} != 'All') || ${otr_regional_acct} != ''|| (${otr_regional_acct} != '' && ${f_cust_tp} == 'C' && ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))))

#if(${f_cust_tp} != 'S')
           AND D.AGMT_CNT_CD   = RGN.CUST_CNT_CD
           AND D.AGMT_CUST_SEQ = RGN.CUST_SEQ
#if ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))
           AND RGN.CUST_GRP_ID   = RGN_GRP.CUST_GRP_ID(+)
#end
#else
           AND D.SHPR_CNT_CD   = RGN.CUST_CNT_CD
           AND D.SHPR_CUST_SEQ = RGN.CUST_SEQ
#end
           AND RGN.RGN_ACCT_FLG  = 'Y'
           AND RGN.CNTR_DIV_FLG  = 'Y'
           AND RGN.DELT_FLG      = 'N'
#end

#if (${local_acct} != '' || (${local_acct} != '' && ${f_cust_tp} == 'C' && ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))))
#if(${f_cust_tp} != 'S')
           AND D.AGMT_CNT_CD   = LCL.CUST_CNT_CD
           AND D.AGMT_CUST_SEQ = LCL.CUST_SEQ
#if ((${ofc_team_cd} != '' && ${ofc_team_cd} !='All') || (${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All'))
           AND LCL.CUST_GRP_ID   = LCL_GRP.CUST_GRP_ID(+)
#end
#else
           AND D.SHPR_CNT_CD   = LCL.CUST_CNT_CD
           AND D.SHPR_CUST_SEQ = LCL.CUST_SEQ
#end
           AND LCL.RGN_ACCT_FLG  = 'Y'
           AND LCL.CNTR_DIV_FLG  = 'Y'
           AND LCL.DELT_FLG      = 'N'
		   AND NVL(LCL.NEW_KEY_ACCT_FLG,'N') = 'N'
		   AND NVL(LCL.RGN_ACCT_FLG, 'N') = 'N'
#end


#if(${f_include_ts} == 'Y' && ${rlane_cd} != 'RBCCO')
  #if (${trd_cd} != '')
             AND V.TRD_CD = '${trd_cd}'
  #end
  #if (${sub_trd_cd} != '')
             AND V.SUB_TRD_CD = '${sub_trd_cd}'
  #end
  #if (${rlane_cd} != '')
             AND V.RLANE_CD = '${rlane_cd}'
  #end

  #if (${dir_cd} != '')
             AND V.DIR_CD = '${dir_cd}'
  #end
  #if (${vsl_cd} != '')
             AND V.VSL_CD = '${vsl_cd}'
  #end
  #if (${skd_voy_no} != '')
             AND V.SKD_VOY_NO = '${skd_voy_no}'
  #end
  #if (${skd_dir_cd} != '')
             AND V.DIR_CD = '${skd_dir_cd}'
  #end  

#elseif(${f_include_ts} == 'Y' && ${rlane_cd} == 'RBCCO')
	#if(${trd_cd} !='' && ${rlane_cd} !='')
             AND '${trd_cd}'||'${rlane_cd}' IN (D.N1ST_TRD_CD||D.N1ST_RLANE_CD, D.N2ND_TRD_CD||D.N2ND_RLANE_CD, D.N3RD_TRD_CD||D.N3RD_RLANE_CD, D.N4TH_TRD_CD||D.N4TH_RLANE_CD)
  #end 
   
#else 

  #if (${trd_cd} != '')
             AND D.TRD_CD = '${trd_cd}'
  #end
  #if (${sub_trd_cd} != '')
             AND D.SUB_TRD_CD = '${sub_trd_cd}'
  #end
  #if (${rlane_cd} != '')
             AND D.RLANE_CD = '${rlane_cd}'
  #end

  #if (${dir_cd} != '')
             AND D.DIR_CD = '${dir_cd}'
  #end
  #if (${vsl_cd} != '')
             AND D.VSL_CD = '${vsl_cd}'
  #end
  #if (${skd_voy_no} != '')
             AND D.SKD_VOY_NO = '${skd_voy_no}'
  #end
  #if (${skd_dir_cd} != '')
             AND D.DIR_CD = '${skd_dir_cd}'
  #end 
#end 

#if (${taa_no} != '')
           AND D.TAA_NO = '${taa_no}'
#end

#if (${bkg_por_cd} != '')
           AND D.BKG_POR_CD LIKE '${bkg_por_cd}' ||'%'
#end
#if (${rev_pol_cd} != '')
           AND D.REV_POL_CD LIKE '${rev_pol_cd}' ||'%'
#end
#if (${rev_pod_cd} != '')
           AND D.REV_POD_CD LIKE '${rev_pod_cd}' ||'%'
#end
#if (${bkg_del_cd} != '')
           AND D.BKG_DEL_CD LIKE '${bkg_del_cd}' ||'%'
#end
#if (${ias_sub_grp_cd} != '')
           AND SUBSTR(D.BKG_POL_CD,1,2) IN (SELECT IAS.POL_CNT_CD FROM MAS_IAS_SUB IAS WHERE IAS.IAS_SUB_CD = '${ias_sub_grp_cd}')
#end
#if (${bkg_pol_cd} != '')
           AND D.BKG_POL_CD LIKE '${bkg_pol_cd}' ||'%'
#end
#if (${ias_sub_grp_cd} != '')
           AND (SUBSTR(D.BKG_POD_CD,1,2) IN (SELECT IAS.POD_CNT_CD
                                               FROM MAS_IAS_SUB IAS
                                              WHERE IAS.IAS_SUB_CD = '${ias_sub_grp_cd}'
#if (${ias_sub_grp_cd} == 'RSEA')
                                                AND IAS.POD_CNT_CD NOT IN ('SA')
#end
                                             )
#if (${ias_sub_grp_cd} == 'MEST')
           AND  D.BKG_POD_CD != 'SAJED'
#elseif (${ias_sub_grp_cd} == 'RSEA')
           OR  (SUBSTR(D.BKG_POD_CD,1,2)='SA' AND D.BKG_POD_CD = 'SAJED')
#end
                )
#end
#if (${bkg_pod_cd} != '')
           AND D.BKG_POD_CD LIKE '${bkg_pod_cd}' ||'%'
#end
#if (${sc_no} != '')
           AND D.SC_NO = '${sc_no}'
#end
#if (${rfa_no} != '')
           AND D.RFA_NO = '${rfa_no}'
#end
#if (${shpr_cnt_cd} != '')
           AND D.SHPR_CNT_CD || D.SHPR_CUST_SEQ = SUBSTR('${shpr_cnt_cd}',1,2)||TO_NUMBER(SUBSTR('${shpr_cnt_cd}',3,6))
#end
#if (${cmdt_cd} != '')
           AND D.REP_CMDT_CD = '${cmdt_cd}'
#end
#if (${usa_bkg_mod_cd} != '')
           AND D.USA_BKG_MOD_CD = '${usa_bkg_mod_cd}'
#end
#if (${bkg_no} != '')
           AND D.BKG_NO = '${bkg_no}'
#end
#if (${cntr_tpsz_cd} != '' )
           AND (
    #foreach($field_id in ${cntr_tpsz_cd})
        #if($velocityCount > 1)
               OR #end      D.SPCL_CNTR_TPSZ_CD = '$field_id'
        #end
                )
#end
#if (${key_acct_group} != '' && ${key_acct_group} != 'All')
    #if (${key_acct_group1} != '')
           AND CO.CUST_GRP_ID = '${key_acct_group1}'
    #end
#end

#if (${f_ra_acct_group_cd} != '' && ${f_ra_acct_group_cd} != 'All')
           AND RGN.CUST_GRP_ID = '${f_ra_acct_group_cd}'
#end

#if(${ofc_team_cd} != '' && ${ofc_team_cd} !='All')
#if(${f_cust_tp} != 'C')
		   AND GRP.OFC_TEAM_CD = '${ofc_team_cd}'
#else
#if(${local_acct} != '')
           AND LCL_GRP.OFC_TEAM_CD = '${ofc_team_cd}'
#elseif(${otr_regional_acct} != '')
           AND RGN_GRP.OFC_TEAM_CD = '${ofc_team_cd}'
#else
           AND CO_GRP.OFC_TEAM_CD = '${ofc_team_cd}'
#end
#end
#end

#if(${cust_rhq_cd} != '' && ${cust_rhq_cd} !='All')
#if(${f_cust_tp} != 'C')
		   AND GRP.RHQ_CD = '${cust_rhq_cd}'
#else
		   AND CO_GRP.RHQ_CD = '${cust_rhq_cd}'
#end
#end

#if (${soc_sts} == 'Y')
           AND D.BKG_NO       = H.BKG_NO
           AND D.CNTR_TPSZ_CD = H.CNTR_TPSZ_CD
           AND D.COST_ROUT_NO = H.COST_ROUT_NO
           AND NVL(H.SOC_FLG,'N') = 'N'
#end
#if(${sls_ofc_cd} !='')
    #if(${excl_sts} =='')
           AND DECODE('${ofc_lvl}','1',L.OFC_N1ST_LVL_CD,'2',L.OFC_N2ND_LVL_CD,'3',L.OFC_N3RD_LVL_CD,'4',L.OFC_N4TH_LVL_CD,'5',L.OFC_N5TH_LVL_CD
              ,'6',L.OFC_N6TH_LVL_CD,'7',L.OFC_N7TH_LVL_CD) = '${ofc_cd}'
    #else
           AND L.OFC_CD = '${ofc_cd}'
    #end
#end

#if( $cntr_rcv_dt_condition )
			AND D.BKG_NO = C.BKG_NO(+)
#end

#if(${ofc_lvl}=='6')
           AND L.OFC_LVL IN ('6', '7')
#elseif(${ofc_lvl}=='7')
           AND L.OFC_LVL = '7'
#else
           AND L.OFC_LVL < '9'
#end

           AND D.BKG_NO         = A6.BKG_NO(+)
           AND D.CNTR_TPSZ_CD   = A6.CNTR_TPSZ_CD(+)
           AND D.COST_ROUT_NO   = A6.COST_ROUT_NO(+)

    GROUP BY 1
            ,D.BKG_NO       
#if(${f_include_ts} =='Y' && ${rlane_cd} != 'RBCCO')
          ,CASE WHEN d.trd_cd||d.rlane_cd||d.vsl_cd||d.skd_voy_no||d.dir_cd = v.trd_cd||v.rlane_cd||v.vsl_cd||v.skd_voy_no||v.dir_cd
             THEN 'L/C'  ELSE 'T/S'  END 
#elseif (${f_include_ts} =='Y' && ${rlane_cd} == 'RBCCO')
          ,CASE WHEN d.trd_cd||d.rlane_cd = 'IASRBCCO'
             THEN 'L/C'  ELSE 'T/S'  END 
#end
            ,D.SPCL_CNTR_TPSZ_CD
#set($vvd_flg = 'FALSE')
#foreach(${keys} IN ${keyList4})
    #if (${keys} == 'sc_desc')
            ,J.$keys
    #elseif (${keys} == 'rep_cmdt_desc')
            ,F.$keys
    #elseif (${keys} == 'shpr_nm')
            ,H.BL_SHPR_NM
    #elseif (${keys} == 'bkg_no')
            ,D.BKG_NO
    #elseif (${keys} == 'rev_vvd')
            ,D.VSL_CD||D.SKD_VOY_NO||D.DIR_CD
	#elseif (${keys} == 'fixed_rate_flag')
			,MRB.FX_RT_FLG
    #elseif (${keys} == 'bl_no')
            ,DECODE(SUBSTR(D.BL_NO, 1, 4), 'KOSA', 'K' || D.BKG_NO, D.BL_NO || D.BL_NO_TP || D.BL_NO_CHK)
    #elseif (${keys} == 'slan_cd')
            ,D.SLAN_CD
    #elseif (${keys} == 'soc_flg' || ${keys} == 'spcl_dg_cgo_flg' || ${keys} == 'spcl_bb_cgo_flg' || ${keys} == 'spcl_awk_cgo_flg')
            ,NVL(D.$keys, 'N')
    #elseif (${keys} == 'bkg_cgo_tp_cd_r')
            ,DECODE(D.BKG_CGO_TP_CD, 'R', 'Y', 'N')
    #elseif (${keys} == 'bkg_cgo_wgt')
            ,D.BKG_CGO_WGT
    #elseif (${keys} == 'sc_cust_cd')
            ,D.AGMT_CNT_CD || TO_CHAR(LPAD(DECODE(D.AGMT_CUST_SEQ,0,'',D.AGMT_CUST_SEQ),6,'0'))
    #elseif (${keys} == 'cmdt_desc')
            ,K.CMDT_NM
    #elseif (${keys} == 'sc_cust_nm')
            ,D.AGMT_CNT_CD
            ,D.AGMT_CUST_SEQ
    #elseif (${keys} == 'bkg_shpr_cd')
            ,D.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(D.SHPR_CUST_SEQ,0,'',D.SHPR_CUST_SEQ),6,'0'))
    #elseif (${keys} == 'agmt_act_cust_cd')
            ,D.AGMT_ACT_CNT_CD || TO_CHAR(LPAD(DECODE(D.AGMT_ACT_CUST_SEQ,0,'',D.AGMT_ACT_CUST_SEQ),6,'0'))
    #elseif (${keys} == 'bkg_shpr_nm')
            ,D.SHPR_CNT_CD
            ,D.SHPR_CUST_SEQ
    #elseif (${keys} == 'cnee_cd')
            ,D.CNEE_CNT_CD || TO_CHAR(LPAD(DECODE(D.CNEE_CUST_SEQ,0,'',D.CNEE_CUST_SEQ),6,'0'))
    #elseif (${keys} == 'cnee_nm')
            ,D.CNEE_CNT_CD
            ,D.CNEE_CUST_SEQ
    #elseif (${keys} == 'ntfy_cd')
            ,D.NTFY_CNT_CD || TO_CHAR(LPAD(DECODE(D.NTFY_CUST_SEQ,0,'',D.NTFY_CUST_SEQ),6,'0'))
    #elseif (${keys} == 'ntfy_nm')
            ,D.NTFY_CNT_CD
            ,D.NTFY_CUST_SEQ
    #elseif (${keys} == 'shpr_cd')
            ,D.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(D.SHPR_CUST_SEQ,0,'',D.SHPR_CUST_SEQ),6,'0'))
   #elseif (${keys} == 'bl_shpr_cd')
            ,D.SHPR_CNT_CD || TO_CHAR(LPAD(DECODE(D.SHPR_CUST_SEQ,0,'',D.SHPR_CUST_SEQ),6,'0'))
    #elseif (${keys} == 'mty_pkup_yd_cd')
         , B.MTY_PKUP_YD_CD
    #elseif (${keys} == 'bkg_por_scc_cd')
         , MAS_LOC_FNC(D.BKG_POR_CD,'SCC') 
    #elseif (${keys} == 'bkg_del_scc_cd')
         , MAS_LOC_FNC(D.BKG_DEL_CD,'SCC') 
    #elseif (${keys} == 'bkg_por_ecc_cd')
         , MAS_LOC_FNC(D.BKG_POR_CD,'ECC') 
    #elseif (${keys} == 'bkg_del_ecc_cd')
         , MAS_LOC_FNC(D.BKG_DEL_CD,'ECC') 
    #elseif (${keys} == 'bkg_por_lcc_cd')
         , MAS_LOC_FNC(D.BKG_POR_CD,'LCC') 
    #elseif (${keys} == 'bkg_del_lcc_cd')
         , MAS_LOC_FNC(D.BKG_DEL_CD,'LCC') 
    #elseif (${keys} == 'bkg_por_rcc_cd')
         , MAS_LOC_FNC(D.BKG_POR_CD,'RCC') 
    #elseif (${keys} == 'bkg_del_rcc_cd')
         , MAS_LOC_FNC(D.BKG_DEL_CD,'RCC') 
    #elseif (${keys} == 'ias_rgn_cd' || ${keys} == 'hul_bnd_cd')
         , R.$keys
	#elseif (${keys} == 'rhq_cd_team')
         , GRP.RHQ_CD
	#elseif  (${keys} == 'ofc_team_cd')
		 , GRP.$keys
	#elseif (${keys} == 'n1st_trd_cd' or ${keys} == 'n2nd_trd_cd' or ${keys} == 'n3rd_trd_cd' or ${keys} == 'n4th_trd_cd' or ${keys} == 'n5th_trd_cd' or
 			 ${keys} == 'n1st_rlane_cd' or ${keys} == 'n2nd_rlane_cd' or ${keys} == 'n3rd_rlane_cd' or ${keys} == 'n4th_rlane_cd' or ${keys} == 'n5th_rlane_cd' or
			 ${keys} == 'n1st_finc_vvd_cd' or ${keys} == 'n2nd_finc_vvd_cd' or ${keys} == 'n3rd_finc_vvd_cd' or ${keys} == 'n4th_finc_vvd_cd' or ${keys} == 'n5th_finc_vvd_cd' or
			 ${keys} == 'n1st_pol_cd' or ${keys} == 'n2nd_pol_cd' or ${keys} == 'n3rd_pol_cd' or ${keys} == 'n4th_pol_cd' or ${keys} == 'n5th_pol_cd' or
			 ${keys} == 'n1st_pod_cd' or ${keys} == 'n2nd_pod_cd' or ${keys} == 'n3rd_pod_cd' or ${keys} == 'n4th_pod_cd' or ${keys} == 'n5th_pod_cd' or
             ${keys} == 'pol_etb1' or ${keys} == 'pol_etb2' or ${keys} == 'pol_etb3' or ${keys} == 'pol_etb4' or ${keys} == 'pol_etb5' or
             ${keys} == 'pod_etb1' or ${keys} == 'pod_etb2' or ${keys} == 'pod_etb3' or ${keys} == 'pod_etb4' or ${keys} == 'pod_etb5'
			)
	#set($vvd_flg = 'TRUE')
    #elseif (${keys} == 'bkg_cre_dt')
            ,B.BKG_CRE_DT
    #elseif (${keys} == 'cfm_dt')
            ,S.CFM_DT
    #elseif (${keys} == 'spc_bkg_sts_cd')
            ,B.ALOC_STS_CD
            ,S.CFM_USR_ID
            ,S.CFM_DT
	 #elseif (${keys} == 'rfa_ctrt_tp_cd')
	 #elseif (${keys} == 'rert_dt')
	 #elseif (${keys} == 'rt_dt')
   #else

        #if(${keys} == 'cust_grp_id')
            #if(${f_cust_tp} != 'S')   
                ,D.CUST_GRP_ID          -- CONTRACT CUSTOMER
                ,D.AGMT_CUST_SEQ        
                ,D.AGMT_CNT_CD
            #else                 
                ,D.CUST_GRP_ID          -- SHIPPER
                ,D.SHPR_CUST_SEQ        
                ,D.SHPR_CNT_CD
            #end
        #elseif(${keys} == 'cust_grp_nm')
            #if(${f_cust_tp} != 'S')   
                 ,D.CUST_GRP_ID         -- CONTRACT CUSTOMER
                ,D.AGMT_CUST_SEQ
                ,D.AGMT_CNT_CD
            #else           
                ,D.CUST_GRP_ID          -- SHIPPER
                ,D.SHPR_NM
                ,D.SHPR_CUST_SEQ
                ,D.SHPR_CNT_CD
            #end
		    #elseif(${keys} == 'cntr_rcv_dt')
        #elseif(${keys} == 'cmpb_amt')
        #elseif(${keys} == 'pol_etb1')
        #elseif(${keys} == 'pol_etb2')
        #elseif(${keys} == 'pol_etb3')
        #elseif(${keys} == 'pol_etb4')
        #elseif(${keys} == 'pol_etb5')
        #elseif(${keys} == 'pod_etb1')
        #elseif(${keys} == 'pod_etb2')
        #elseif(${keys} == 'pod_etb3')
        #elseif(${keys} == 'pod_etb4')
        #elseif(${keys} == 'pod_etb5')
        #elseif(${keys} == 'act_teu')
        #elseif(${keys} == 'act_feu')
		    #elseif(${keys} == 'l_sls_ofc_cd')
        #elseif(${keys} == 'mst_rfa_rout_id')
	      #elseif(${keys} == 'vgm_wgt')
        #else
            ,D.$keys       
        #end
    #end
#end
		#if(${vvd_flg} == 'TRUE')
		 , MAS_PSG_TS_ARRAY_FNC(D.n1st_trd_cd,
                              DECODE (MAS_SLAN_CONTI_CONV_FNC(D.n1st_finc_vvd_cd,substr(D.N1ST_RLANE_CD,1,3),SUBSTR (D.n1st_ioc_conti_cd, 1, 1))
                                     ,MAS_SLAN_CONTI_CONV_FNC(D.n1st_finc_vvd_cd,substr(D.N1ST_RLANE_CD,1,3),SUBSTR (D.n1st_ioc_conti_cd, 2, 1)), 'I' ,'O'),
                              D.n1st_rlane_cd, SUBSTR (D.n1st_finc_vvd_cd, 1, 9), D.n1st_pol_cd, D.n1st_pod_cd, --1
                              D.n2nd_trd_cd,
                              DECODE (MAS_SLAN_CONTI_CONV_FNC(D.n2nd_finc_vvd_cd,substr(D.N2nd_RLANE_CD,1,3),SUBSTR (D.n2nd_ioc_conti_cd, 1, 1))
                                     ,MAS_SLAN_CONTI_CONV_FNC(D.n2nd_finc_vvd_cd,substr(D.n2nd_RLANE_CD,1,3),SUBSTR (D.n2nd_ioc_conti_cd, 2, 1)), 'I' ,'O'),
                              D.n2nd_rlane_cd, SUBSTR (D.n2nd_finc_vvd_cd, 1, 9), D.n2nd_pol_cd, D.n2nd_pod_cd, --2
                              D.n3rd_trd_cd,
                              DECODE (MAS_SLAN_CONTI_CONV_FNC(D.n3rd_finc_vvd_cd,substr(D.n3rd_RLANE_CD,1,3),SUBSTR (D.n3rd_ioc_conti_cd, 1, 1))
                                     ,MAS_SLAN_CONTI_CONV_FNC(D.n3rd_finc_vvd_cd,substr(D.n3rd_RLANE_CD,1,3),SUBSTR (D.n3rd_ioc_conti_cd, 2, 1)), 'I' ,'O'),
                              D.n3rd_rlane_cd, SUBSTR (D.n3rd_finc_vvd_cd, 1, 9), D.n3rd_pol_cd, D.n3rd_pod_cd, --3
                              D.n4th_trd_cd,
                              DECODE (MAS_SLAN_CONTI_CONV_FNC(D.n4th_finc_vvd_cd,substr(D.n4th_RLANE_CD,1,3),SUBSTR (D.n4th_ioc_conti_cd, 1, 1))
                                     ,MAS_SLAN_CONTI_CONV_FNC(D.n4th_finc_vvd_cd,substr(D.n4th_RLANE_CD,1,3),SUBSTR (D.n4th_ioc_conti_cd, 2, 1)), 'I' ,'O'),
                              D.n4th_rlane_cd, SUBSTR (D.n4th_finc_vvd_cd, 1, 9), D.n4th_pol_cd, D.n4th_pod_cd --4
                             )
		#end

            ,DECODE('${wk_sts}', 'Y', D.COST_YRMON, '', DECODE('${period}', 'M', D.COST_YRMON, ''))
            ,DECODE('${wk_sts}', 'Y', D.SLS_YRMON, '')
            ,DECODE('${wk_sts}', 'Y', D.COST_WK, '')
            ,DECODE('${dir_sts}', 'Y', D.DIR_CD, '')
/* 2017.05.17 [CSR #791] 에 따라 로직 변경
            ,DECODE('${tpsz_sts}', 'BOX', D.SPCL_CNTR_TPSZ_CD, 'TEU','')
*/
            ,D.SPCL_CNTR_TPSZ_CD

    ) AA
    )
GROUP BY 1
#if(${f_include_ts} =='Y')
       , ts_sts     
#end      

#foreach(${keys} IN ${keyList5})
    #if (${keys} == 'obrd_dt' )
            ,TO_CHAR($keys,'YYYY-MM-DD')
	#elseif(${keys} == 'n1st_trd_cd')
      , SUBSTR(VVD_INFO,1,3) 
	#elseif(${keys} == 'n2nd_trd_cd')
      , SUBSTR(VVD_INFO,29,3) 
	#elseif(${keys} == 'n3rd_trd_cd')
      , SUBSTR(VVD_INFO,57,3) 
	#elseif(${keys} == 'n4th_trd_cd')
      , SUBSTR(VVD_INFO,85,3) 
	#elseif(${keys} == 'n5th_trd_cd')
      , SUBSTR(VVD_INFO,113,3) 
	#elseif(${keys} == 'n1st_rlane_cd')
      , SUBSTR(VVD_INFO,5,5) 
	#elseif(${keys} == 'n2nd_rlane_cd')
      , SUBSTR(VVD_INFO,33,5) 
	#elseif(${keys} == 'n3rd_rlane_cd')
      , SUBSTR(VVD_INFO,61,5) 
	#elseif(${keys} == 'n4th_rlane_cd')
      , SUBSTR(VVD_INFO,89,5) 
	#elseif(${keys} == 'n5th_rlane_cd')
      , SUBSTR(VVD_INFO,117,5) 
	#elseif(${keys} == 'n1st_finc_vvd_cd')
      , DECODE(SUBSTR(VVD_INFO,10,9),'XXXXXXXXX','',SUBSTR(VVD_INFO,10,9)) 
	#elseif(${keys} == 'n2nd_finc_vvd_cd')
      , DECODE(SUBSTR(VVD_INFO,38,9),'XXXXXXXXX','',SUBSTR(VVD_INFO,38,9)) 
	#elseif(${keys} == 'n3rd_finc_vvd_cd')
      , DECODE(SUBSTR(VVD_INFO,66,9),'XXXXXXXXX','',SUBSTR(VVD_INFO,66,9)) 
	#elseif(${keys} == 'n4th_finc_vvd_cd')
      , DECODE(SUBSTR(VVD_INFO,94,9),'XXXXXXXXX','',SUBSTR(VVD_INFO,94,9)) 
	#elseif(${keys} == 'n5th_finc_vvd_cd')
      , DECODE(SUBSTR(VVD_INFO,122,9),'XXXXXXXXX','',SUBSTR(VVD_INFO,122,9)) 
	#elseif(${keys} == 'n1st_pol_cd')
      , SUBSTR(VVD_INFO,19,5) 
	#elseif(${keys} == 'n2nd_pol_cd')
      , SUBSTR(VVD_INFO,47,5) 
	#elseif(${keys} == 'n3rd_pol_cd')
      , SUBSTR(VVD_INFO,75,5) 
	#elseif(${keys} == 'n4th_pol_cd')
      , SUBSTR(VVD_INFO,103,5) 
	#elseif(${keys} == 'n5th_pol_cd')
      , SUBSTR(VVD_INFO,131,5) 
	#elseif(${keys} == 'n1st_pod_cd')
      , SUBSTR(VVD_INFO,24,5) 
	#elseif(${keys} == 'n2nd_pod_cd')
      , SUBSTR(VVD_INFO,52,5) 
	#elseif(${keys} == 'n3rd_pod_cd')
      , SUBSTR(VVD_INFO,80,5) 
	#elseif(${keys} == 'n4th_pod_cd')
      , SUBSTR(VVD_INFO,108,5) 
	#elseif(${keys} == 'n5th_pod_cd')
      , SUBSTR(VVD_INFO,136,5) 	
	#elseif(${keys} == 'fixed_rate_flag')
	  , fx_rt_flg
    #elseif(${keys} == 'pol_etb1')
    #elseif(${keys} == 'pol_etb2')
    #elseif(${keys} == 'pol_etb3')
    #elseif(${keys} == 'pol_etb4')
    #elseif(${keys} == 'pol_etb5')
    #elseif(${keys} == 'pod_etb1')
    #elseif(${keys} == 'pod_etb2')
    #elseif(${keys} == 'pod_etb3')
    #elseif(${keys} == 'pod_etb4')
    #elseif(${keys} == 'pod_etb5')
	 #elseif (${keys} == 'rt_dt' || ${keys} == 'rert_dt')
	 , chg_bkg_no
	 #elseif(${keys} == 'vgm_wgt')
    ,VGM
    #else
            ,$keys
    #end
#end
            ,COST_YRMON
            ,SLS_YRMON
            ,COST_WK
            ,DIR_CD2
            ,TPSZ_CODE
/*
2010.08.02  김기종 CSR No. CHM-201004764-01 
[MAS] MAS Report 보완 요청  (Inquiry by Customized Condition) - bl_shpr_cd 예외로직 처리 추가
2010.09.01 김기종  CHM-201005370-01
Inquiry by customized condition 기능 개선
2010.09.27 장영석 CHM-201005937 
Inquiry by customized condition 기능추가
2011.06.22 김민아 [CHM-201111640-01] Reefer Core Account 조회조건 추가_Inquiry by customized condition
                                                          Month 체크 시 COST_YRMON이 조회되도록 수정
2011.11.08 전윤주 [CHM-201114383-01] Inquiry by Customized Condition Tuning 요청
                           From 절 순서 변경 후 힌트 사용
2011.11.28 전윤주 [CHM-201114789] 화면에서 surcharge 계정 code가 들어왔을 시 쿼리가 hint로 인해 잘못 풀리고 있음
               기존 exists 문을 sub 쿼리로 변경하여 동일한 값이 나오도록 쿼리 변경
               #_if ($_{mdm_charge_cd} != '') 문을 sub 쿼리로 변경
2012.08.29 이석준[CHM-201219872] Inquiry by customized condition_MT Pick up Location 등 메뉴 추가
2013.01.22 성미영[CHM-201322531] [MAS] Inquiry by Customized Condition 버튼 수정
2013.05.29 김수정[CHM-201324876] [MAS] MAS Report내 'IAS Region ' / 'Bound2' 추가
2014.01.20 김수정[CHM-201428552] [MAS] Inquiry by Customized Condition Shipper / Contract Customer View 선택 추가
2014.06.03 최덕우[CHM-201430312] [MAS] G.Customer Display 관련 일부 화면 로직 보완 수정
*/			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
