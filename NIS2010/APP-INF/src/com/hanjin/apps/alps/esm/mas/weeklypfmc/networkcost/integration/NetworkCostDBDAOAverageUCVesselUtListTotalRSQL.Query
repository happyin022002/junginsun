<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="NetworkCostDBDAOAverageUCVesselUtListTotalRSQL">
			<desc><![CDATA[Average U/C_Vessel Pooling2 (OP Fixed & Variable cost, etc) 의 'Cost Tatal' 탭의 결과를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT 							
    COST_YRMON,
    TRD_CD,
    SUB_TRD_CD,
    RLANE_CD,
    DIR_CD,
    HUL_BND_CD,
    NVL(SUM(CRE_AMT),0) AS CRE_AMT, --CREW EXPENSE
    NVL(SUM(INS_AMT),0) AS INS_AMT, --INSURANCE
    NVL(SUM(STO_AMT),0) AS STO_AMT, --STORE SUPPLY EXP
    NVL(SUM(LUB_AMT),0) AS LUB_AMT, --LUBRICANT EXP
    NVL(SUM(MNR_AMT),0) AS MNR_AMT, --VESSEL M&R							
    NVL(SUM(DEP_AMT),0) AS DEP_AMT, --DEPRECIATIONS							
    NVL(SUM(TEL_AMT),0) AS TEL_AMT, --TELECOM EXP							
    NVL(SUM(VSL_AMT),0) AS VSL_AMT, --VESSEL INTEREST							
    NVL(SUM(OTR_AMT),0) AS OTR_AMT, --OTHER OPERATION EXP							
    NVL(SUM(TIM_AMT),0) AS TIM_AMT,  --TIME CHARTERAGE							
    NVL(SUM(POR_AMT),0) AS POR_AMT, --Port Expense							
    NVL(SUM(CAN_AMT),0) AS CAN_AMT, --Canal Transit Fee							
    NVL(SUM(BNK_AMT),0) AS BNK_AMT, --Bunker							
    NVL(SUM(SPC_AMT),0) AS SPC_AMT, --Space Charterage                       							
                                
    NVL(SUM(cre_amt),0) + NVL(SUM(ins_amt),0) +							
    NVL(SUM(sto_amt),0) + NVL(SUM(lub_amt),0) +							
    NVL(SUM(MNR_AMT),0) + NVL(SUM(dep_amt),0) +							
    NVL(SUM(tel_amt),0) + NVL(SUM(vsl_amt),0) +							
    NVL(SUM(otr_amt),0) + NVL(SUM(TIM_AMT),0) +							
    NVL(SUM(POR_AMT),0) + NVL(SUM(CAN_AMT),0) +							
    NVL(SUM(BNK_AMT),0) + NVL(SUM(SPC_AMT),0) AS TTL_AMT,  							
                            
    NVL(SUM(SPR_AMT),0) AS SPR_AMT  --Space Charter Revenue							
                            
FROM (							
    SELECT							
          COST_YRMON,							
          TRD_CD,					
          SUB_TRD_CD,					
          RLANE_CD,					
          DIR_CD,					
          HUL_BND_CD,					
          DECODE(STND_COST_CD,'54100000',TEU_UC_AMT,0) AS CRE_AMT, --CREW EXPENSE							
          DECODE(STND_COST_CD,'54250000',TEU_UC_AMT,0) AS INS_AMT, --INSURANCE							
          DECODE(STND_COST_CD,'54200000',TEU_UC_AMT,0) AS STO_AMT, --STORE SUPPLY EXP							
          DECODE(STND_COST_CD,'54300000',TEU_UC_AMT,0) AS LUB_AMT, --LUBRICANT EXP
          DECODE(STND_COST_CD,'54150000',TEU_UC_AMT,0) AS MNR_AMT, --VESSEL M&R
          DECODE(STND_COST_CD,'54450000',TEU_UC_AMT,0) AS DEP_AMT, --DEPRECIATIONS
          DECODE(STND_COST_CD,'54180000',TEU_UC_AMT,0) AS TEL_AMT, --TELECOM EXP
          DECODE(STND_COST_CD,'72100000',TEU_UC_AMT,0) AS VSL_AMT, --VESSEL INTEREST
          DECODE(STND_COST_CD,'54550000',TEU_UC_AMT,0) AS OTR_AMT, --OTHER OPERATION EXP
          DECODE(STND_COST_CD,'54350000',TEU_UC_AMT,0) AS TIM_AMT, --TIME CHARTERAGE
          
          DECODE(STND_COST_CD,'53101000',TEU_UC_AMT,0) AS POR_AMT, --Port Expense
          DECODE(STND_COST_CD,'53102000',TEU_UC_AMT,0) AS CAN_AMT, --Canal Transit Fee
          DECODE(STND_COST_CD,'53200000',TEU_UC_AMT,0) AS BNK_AMT, --Bunker
          DECODE(STND_COST_CD,'54400000',TEU_UC_AMT,0) AS SPC_AMT, --Space Charterage
          DECODE(STND_COST_CD,'43102011',TEU_UC_AMT,0) AS SPR_AMT  --Space Charter Revenue
          
     FROM MAS_POOL_UT_COST
     WHERE COST_YRMON = REPLACE(@[f_yearweek], '-', '')
     )
GROUP BY COST_YRMON,
         TRD_CD,
         SUB_TRD_CD,
         RLANE_CD,
         DIR_CD,
         HUL_BND_CD
ORDER BY COST_YRMON,
         TRD_CD,
         SUB_TRD_CD,
         RLANE_CD,
         DIR_CD,
         HUL_BND_CD			]]></sql>
			<params>
				<param name="f_yearweek" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
