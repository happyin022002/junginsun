<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TCharterIOInquiryDBDAOSearchRfStatusInquiryByVvdDetailListLoadingRSQL">
			<desc><![CDATA[VVD로 RF 상태를 상세 조회한다.
Loading값 조회]]></desc>
			<sql><![CDATA[
WITH SKD AS (
    SELECT S.*,
      P.REP_PORT_CD,
      DECODE(P.CHK_MTY_PLN_FLG, 'Y', 'E', 'F') AS PLANTYPE
    FROM VSK_VSL_PORT_SKD S,
      STO_PLN_VSL_PORT_SKD P
    WHERE S.VSL_CD = SUBSTR(@[vvd], 1, 4)
      AND S.SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
      AND S.SKD_DIR_CD = SUBSTR(@[vvd], 9, 1)
      AND S.TURN_PORT_IND_CD <> 'V'
      AND S.TURN_PORT_IND_CD <> 'F'
      AND S.TURN_PORT_IND_CD <> 'D'
      AND (S.SKD_CNG_STS_CD IS NULL OR S.SKD_CNG_STS_CD <> 'S')
      AND S.VPS_PORT_CD <> 'PAPAC'
      AND S.VPS_PORT_CD <> 'EGSUZ'
      AND S.VSL_CD = P.VSL_CD
      AND S.SKD_VOY_NO = P.SKD_VOY_NO
      AND S.SKD_DIR_CD = P.SKD_DIR_CD
      AND S.VPS_PORT_CD = P.VPS_PORT_CD
      AND S.CLPT_IND_SEQ = P.CLPT_IND_SEQ
	  AND (P.CHK_FNL_PLN_FLG = 'Y' OR P.CHK_MTY_PLN_FLG = 'Y')	
)
SELECT 
 P.PORT_CD	AS port
,P.POL		AS loadingport
,P.POD		AS dischargingport
,P.OPR_CD	AS operator
,P.ID 		AS cntrno
,'Loading' 	AS kind
,S.YD_CD     AS yard
,S.CLPT_IND_SEQ  AS indicator  
,TO_CHAR(S.VPS_ETA_DT, 'YYYY-MM-DD') vpsetadt
,TO_CHAR(S.VPS_ETD_DT, 'YYYY-MM-DD') vpsetddt   
FROM BAY_PLAN P, SKD S
WHERE 1=1
AND P.VSL_CD = S.VSL_CD
AND P.VOY_NO = S.SKD_VOY_NO
AND P.DIR_CD = S.SKD_DIR_CD
AND P.PORT_CD = S.VPS_PORT_CD
AND P.CALL_IND = S.CLPT_IND_SEQ
AND P.PLAN_TYPE = 'F'
AND P.TEMP IS NOT NULL
AND NVL(S.REP_PORT_CD, P.PORT_CD) = P.POL
ORDER BY S.CLPT_SEQ ASC			]]></sql>
			<params>
				<param name="vvd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
