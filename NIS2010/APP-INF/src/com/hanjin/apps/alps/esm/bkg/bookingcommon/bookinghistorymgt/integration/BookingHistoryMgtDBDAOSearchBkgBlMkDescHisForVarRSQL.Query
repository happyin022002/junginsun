<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BookingHistoryMgtDBDAOSearchBkgBlMkDescHisForVarRSQL">
			<desc><![CDATA[BookingHistoryMgtDBDAOSearchBkgBlMkDescHisForVarRSQL]]></desc>
			<sql><![CDATA[
WITH OLD AS
(SELECT @[bkg_no] BKG_NO
, @[auto_cluz_dp_cd] AUTO_CLUZ_DP_CD
, @[upd_usr_id] UPD_USR_ID
, @[upd_dt] UPD_DT
FROM DUAL)
SELECT HIS_CATE_NM
     , PRE_CTNT||'/'||OLD_UPD_DT||'/'|| OLD_UPD_USR_ID PRE_CTNT
     , CRNT_CTNT||'/'||NOW_UPD_DT||'/'|| NOW_UPD_USR_ID CRNT_CTNT
  FROM 
    (
		SELECT 'Auto Clause Display' HIS_CATE_NM
        	, OLD.AUTO_CLUZ_DP_CD PRE_CTNT
	        , NOW.AUTO_CLUZ_DP_CD CRNT_CTNT
            , TO_CHAR(NOW.UPD_DT,'YYYY-MM-DD HH24:MI:SS') NOW_UPD_DT
            , NOW.UPD_USR_ID NOW_UPD_USR_ID
            , DECODE(OLD.AUTO_CLUZ_DP_CD,null,null,OLD.UPD_DT) OLD_UPD_DT
            , DECODE(OLD.AUTO_CLUZ_DP_CD,null,null,OLD.UPD_USR_ID) OLD_UPD_USR_ID
          FROM OLD 
#if (${ca_flg} == 'Y')
             , BKG_BL_MK_DESC_HIS NOW 
         WHERE NOW.BKG_NO      (+) = OLD.BKG_NO
	       AND NOW.CORR_NO     (+) = 'TMP0000001' 
#else
             , BKG_BL_MK_DESC NOW 
         WHERE NOW.BKG_NO      (+) = OLD.BKG_NO
#end
    )    
 WHERE NVL(TRIM(PRE_CTNT), ' ') <> NVL(TRIM(CRNT_CTNT), ' ')			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="auto_cluz_dp_cd" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="upd_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
