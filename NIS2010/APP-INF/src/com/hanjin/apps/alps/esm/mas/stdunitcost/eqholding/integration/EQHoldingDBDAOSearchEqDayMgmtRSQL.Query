<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EQHoldingDBDAOSearchEqDayMgmtRSQL">
			<desc><![CDATA[EQ Day 관리화면 조회]]></desc>
			<sql><![CDATA[
#if (${code} == '0')
  SELECT POR_CD
        ,DEL_CD
        ,TPSZ_CD
        ,ROUND(SUM(FULL_DMT * BX_KNT)/DECODE(SUM(BX_KNT),0,1,SUM(BX_KNT)), 2) FULL_DMT
        ,(ROUND(SUM(MT_LAND)/DECODE(COUNT(MT_LAND),0,1,COUNT(MT_LAND)), 2)) MT_LAND
        ,ROUND(SUM(ORG_MTY_LAND_DYS)/DECODE(COUNT(ORG_MTY_LAND_DYS),0,1,COUNT(ORG_MTY_LAND_DYS)), 2) ORG_MTY_LAND_DYS
        ,ROUND(SUM(DEST_MTY_LAND_DYS)/DECODE(COUNT(DEST_MTY_LAND_DYS),0,1,COUNT(DEST_MTY_LAND_DYS)), 2) DEST_MTY_LAND_DYS
  FROM MAS_CNTR_PRECM_CALC
  WHERE 1=1
    AND COST_YRMON BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(@[f_cost_yrmon], 'YYYYMM'), -5), 'YYYYMM') AND @[f_cost_yrmon]
  #if (${f_cntr_tpsz_cd} != '')
    AND TPSZ_CD IN (
        #if ($f_cntr_tpsz_cd.size() > 1 )
          #foreach($key in ${f_cntr_tpsz_cd})
            #if ($velocityCount < $f_cntr_tpsz_cd.size())
            '$key',
            #else
            '$key'
            #end
          #end
        #else
          @[f_cntr_tpsz_cd]
        #end
        )
  #end
  #if (${location_by_por} == 'RL')
    AND MAS_LOC_FNC(POR_CD,'RCC') = @[location_por]
  #end
  #if (${location_by_por} == 'LE')
    AND MAS_LOC_FNC(POR_CD,'LCC') = @[location_por]
  #end
  #if (${location_by_por} == 'ES')
    AND MAS_LOC_FNC(POR_CD,'ECC') = @[location_por]
  #end
  #if (${location_by_por} == 'CC')
    AND MAS_LOC_FNC(POR_CD,'SCC') LIKE @[location_por]||'%'
  #end

  #if (${location_by_del} == 'RL')
    AND MAS_LOC_FNC(DEL_CD,'RCC') = @[location_del]
  #end
  #if (${location_by_del} == 'LE')
    AND MAS_LOC_FNC(DEL_CD,'LCC') = @[location_del]
  #end
  #if (${location_by_del} == 'ES')
    AND MAS_LOC_FNC(DEL_CD,'ECC') = @[location_del]
  #end
  #if (${location_by_del} == 'CC')
    AND MAS_LOC_FNC(DEL_CD,'SCC') LIKE @[location_del]||'%'
  #end
  GROUP BY POR_CD
          ,DEL_CD
          ,TPSZ_CD
  ORDER BY TPSZ_CD

#elseif (${code} == '1')
  SELECT COST_YRMON
        ,POR_CD
        ,POL_CD
        ,POD_CD
        ,DEL_CD
        ,TS_ROUT
        ,TPSZ_CD
        ,LANE_CD
        ,SEA_DYS
        ,ORG_RAIL_DYS
      ,DEST_RAIL_DYS
      ,FULL_DMT
        ,ORG_MTY_LAND_DYS
        ,DEST_MTY_LAND_DYS
      ,MT_SEA_DYS
	  ,MT_LAND
	  ,DYS_DMT_EXPT_SEA
  FROM MAS_CNTR_PRECM_CALC
  WHERE 1=1
    AND COST_YRMON BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(@[f_cost_yrmon], 'YYYYMM'), -5), 'YYYYMM') AND @[f_cost_yrmon]
  #if (${f_cntr_tpsz_cd} != '')
    AND TPSZ_CD IN (
        #if ($f_cntr_tpsz_cd.size() > 1 )
          #foreach($key in ${f_cntr_tpsz_cd})
            #if ($velocityCount < $f_cntr_tpsz_cd.size())
            '$key',
            #else
            '$key'
            #end
          #end
        #else
          @[f_cntr_tpsz_cd]
        #end
        )
  #end
  #if (${f_lane_cd} != '')
    AND LANE_CD = @[f_lane_cd]
  #end
  #if (${f_eq_days} != '')
    AND 1=1
    #if (${f_eq_itm} == 'sea_dys')
      AND SEA_DYS >= @[f_eq_days]
    #end
    #if (${f_eq_itm} == 'org_rail_dys')
      AND ORG_RAIL_DYS >= @[f_eq_days]
    #end	
    #if (${f_eq_itm} == 'dest_rail_dys')
      AND DEST_RAIL_DYS >= @[f_eq_days]
    #end	
    #if (${f_eq_itm} == 'full_dmt')
      AND FULL_DMT >= @[f_eq_days]
    #end	
    #if (${f_eq_itm} == 'org_mty_land_dys')
      AND ORG_MTY_LAND_DYS >= @[f_eq_days]
    #end
    #if (${f_eq_itm} == 'dest_mty_land_dys')
      AND DEST_MTY_LAND_DYS >= @[f_eq_days]
    #end
    #if (${f_eq_itm} == 'mt_sea_dys')
      AND MT_SEA_DYS >= @[f_eq_days]
    #end	
  #end
  #if (${location_by_por} == 'RL')
    AND MAS_LOC_FNC(POR_CD,'RCC') = @[location_por]
  #end
  #if (${location_by_por} == 'LE')
    AND MAS_LOC_FNC(POR_CD,'LCC') = @[location_por]
  #end
  #if (${location_by_por} == 'ES')
    AND MAS_LOC_FNC(POR_CD,'ECC') = @[location_por]
  #end
  #if (${location_by_por} == 'CC')
    AND MAS_LOC_FNC(POR_CD,'SCC') LIKE @[location_por]||'%'
  #end

  #if (${location_by_del} == 'RL')
    AND MAS_LOC_FNC(DEL_CD,'RCC') = @[location_del]
  #end
  #if (${location_by_del} == 'LE')
    AND MAS_LOC_FNC(DEL_CD,'LCC') = @[location_del]
  #end
  #if (${location_by_del} == 'ES')
    AND MAS_LOC_FNC(DEL_CD,'ECC') = @[location_del]
  #end
  #if (${location_by_del} == 'CC')
    AND MAS_LOC_FNC(DEL_CD,'SCC') LIKE @[location_del]||'%'
  #end
  ORDER BY TPSZ_CD
		  ,COST_YRMON
#end			]]></sql>
			<params>
				<param name="f_cost_yrmon" type="12" value="" out="N"/>
				<param name="f_cntr_tpsz_cd" type="12" value="" out="N"/>
				<param name="location_por" type="12" value="" out="N"/>
				<param name="location_del" type="12" value="" out="N"/>
				<param name="f_lane_cd" type="12" value="" out="N"/>
				<param name="f_eq_days" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
