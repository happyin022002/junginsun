<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RussiaCustomsTransmissionDBDAOsearchVslInfoRSQL">
			<desc><![CDATA[searchVslInfo]]></desc>
			<sql><![CDATA[
SELECT	SKD.VPS_PORT_CD  AS FST_PORT,
    	LOC.LOC_NM       AS FST_PORT_NM,
    	TO_CHAR(SKD.VPS_ETB_DT,'YYYYMMDDHH24MI') AS FST_ARR_DT,
    	VSL.NATION_CD, 
        NVL((SELECT X.CNT_NM FROM MDM_COUNTRY X WHERE X.CNT_CD = VSL.NATION_CD ),'') NATION_NM
FROM	VSK_VSL_PORT_SKD SKD, 
	    MDM_LOCATION LOC,
     	(SELECT NVL(VSL_RGST_CNT_CD, ' ') NATION_CD
         FROM	MDM_VSL_CNTR
         WHERE	VSL_CD = SUBSTR(@[vvd_cd],1,4)) VSL
WHERE	SKD.VPS_PORT_CD		=       LOC.LOC_CD
AND	    SKD.VSL_CD			=       SUBSTR(@[vvd_cd],1,4)
AND	    SKD.SKD_VOY_NO	    =       SUBSTR(@[vvd_cd],5,4)
AND	    SKD.SKD_DIR_CD		=       SUBSTR(@[vvd_cd],9,1)

#if (${mode_type} == 'I') 

AND     LOC.LOC_CD          =    @[pod_cd]
#else
AND     LOC.LOC_CD          =    @[pol_cd]
#end
AND     SKD.VPS_ETB_DT = ( SELECT MIN(VPS_ETB_DT)
                           FROM VSK_VSL_PORT_SKD
                           WHERE VSL_CD          = SUBSTR(@[vvd_cd], 1, 4)
                           AND   SKD_VOY_NO      = SUBSTR(@[vvd_cd], 5, 4)
                           AND   SKD_DIR_CD      = SUBSTR(@[vvd_cd], 9, 1)
                           
							#if (${mode_type} == 'I') 
							AND   VPS_PORT_CD    =@[pod_cd]
							#else
							AND   VPS_PORT_CD    =@[pol_cd]
							#end
                            )			]]></sql>
			<params>
				<param name="vvd_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
