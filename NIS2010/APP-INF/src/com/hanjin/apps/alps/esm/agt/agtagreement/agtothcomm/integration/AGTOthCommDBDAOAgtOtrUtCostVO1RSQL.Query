<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AGTOthCommDBDAOAgtOtrUtCostVO1RSQL">
			<desc><![CDATA[Commission Unit Cost Inquiry]]></desc>
			<sql><![CDATA[
SELECT KIND,
           BND,
           ROUND(D2, 2) D2,
           ROUND(D4, 2) D4,
           ROUND(D5, 2) D5,
           ROUND(D7, 2) D7,
           ROUND(D9, 2) D9,
           ROUND(R2, 2) R2,
           ROUND(R4, 2) R4,
           ROUND(R5, 2) R5,
           ROUND(R7, 2) R7,
           ROUND(F2, 2) F2,
           ROUND(F4, 2) F4,
           ROUND(O2, 2) O2,
           ROUND(O4, 2) O4,
           ROUND(P2, 2) P2,
           ROUND(P4, 2) P4,
           ROUND(S2, 2) S2,
           ROUND(S4, 2) S4,
           ROUND(T2, 2) T2,
           ROUND(T4, 2) T4,
           ROUND(A2, 2) A2,
           ROUND(A4, 2) A4,
           ROUND(DW, 2) DW,
           ROUND(DX, 2) DX
      FROM 
         (     SELECT
                      1             AS SEQ,
                      'Commission'  AS KIND,
                      'I/B'         AS BND
                 FROM DUAL
            UNION ALL
               SELECT 2             AS SEQ,
                      'Commission',
                      'T/S'
                 FROM DUAL
            UNION ALL
               SELECT
                      3             AS SEQ,
                      'Commission',
                      'O/B'
                 FROM DUAL
            UNION ALL
               SELECT
                      4             AS SEQ,
                      'Brokerage/FAC',
                      '   '
                 FROM DUAL
            UNION ALL
               SELECT 5             AS SEQ,
                      'CHF',
                      'I/B'
                 FROM DUAL
            UNION ALL
               SELECT 6             AS SEQ,
                      'CHF',
                      'O/B'
                 FROM DUAL
         ),
         (     SELECT
                      COMM_TYPE,
                      BOUND,
                      SUM(DECODE(DECODE(SEQ,  1, TPSZZ, NULL), NULL, 0, UNIT_COST)) D2,
                      SUM(DECODE(DECODE(SEQ,  2, TPSZZ, NULL), NULL, 0, UNIT_COST)) D4,
                      SUM(DECODE(DECODE(SEQ,  3, TPSZZ, NULL), NULL, 0, UNIT_COST)) D5,
                      SUM(DECODE(DECODE(SEQ,  4, TPSZZ, NULL), NULL, 0, UNIT_COST)) D7,
                      SUM(DECODE(DECODE(SEQ,  5, TPSZZ, NULL), NULL, 0, UNIT_COST)) D8,
                      SUM(DECODE(DECODE(SEQ,  6, TPSZZ, NULL), NULL, 0, UNIT_COST)) D9,
                      SUM(DECODE(DECODE(SEQ,  7, TPSZZ, NULL), NULL, 0, UNIT_COST)) R2,
                      SUM(DECODE(DECODE(SEQ,  8, TPSZZ, NULL), NULL, 0, UNIT_COST)) R4,
                      SUM(DECODE(DECODE(SEQ,  9, TPSZZ, NULL), NULL, 0, UNIT_COST)) R5,
                      SUM(DECODE(DECODE(SEQ, 10, TPSZZ, NULL), NULL, 0, UNIT_COST)) R7,
                      SUM(DECODE(DECODE(SEQ, 11, TPSZZ, NULL), NULL, 0, UNIT_COST)) F2,
                      SUM(DECODE(DECODE(SEQ, 12, TPSZZ, NULL), NULL, 0, UNIT_COST)) F4,
                      SUM(DECODE(DECODE(SEQ, 13, TPSZZ, NULL), NULL, 0, UNIT_COST)) F5,
                      SUM(DECODE(DECODE(SEQ, 14, TPSZZ, NULL), NULL, 0, UNIT_COST)) O2,
                      SUM(DECODE(DECODE(SEQ, 15, TPSZZ, NULL), NULL, 0, UNIT_COST)) O4,
                      SUM(DECODE(DECODE(SEQ, 16, TPSZZ, NULL), NULL, 0, UNIT_COST)) P2,
                      SUM(DECODE(DECODE(SEQ, 17, TPSZZ, NULL), NULL, 0, UNIT_COST)) P4,
                      SUM(DECODE(DECODE(SEQ, 18, TPSZZ, NULL), NULL, 0, UNIT_COST)) S2,
                      SUM(DECODE(DECODE(SEQ, 19, TPSZZ, NULL), NULL, 0, UNIT_COST)) S4,
                      SUM(DECODE(DECODE(SEQ, 20, TPSZZ, NULL), NULL, 0, UNIT_COST)) T2,
                      SUM(DECODE(DECODE(SEQ, 21, TPSZZ, NULL), NULL, 0, UNIT_COST)) T4,
                      SUM(DECODE(DECODE(SEQ, 22, TPSZZ, NULL), NULL, 0, UNIT_COST)) A2,
                      SUM(DECODE(DECODE(SEQ, 23, TPSZZ, NULL), NULL, 0, UNIT_COST)) A4,
                      SUM(DECODE(DECODE(SEQ, 24, TPSZZ, NULL), NULL, 0, UNIT_COST)) DW,
                      SUM(DECODE(DECODE(SEQ, 25, TPSZZ, NULL), NULL, 0, UNIT_COST)) DX
                 FROM
                    (     SELECT DECODE(AC_TP_CD, 'K', 'Brokerage/FAC', 'B', 'Brokerage/FAC', 'F', 'Brokerage/FAC', 'H', 'CHF', 'Commission') COMM_TYPE,
                                 DECODE(IO_BND_CD||AC_TP_CD, 'OS', 'T/S', 'IS', 'T/S', 'OF', '   ', 'OB', '   ', 'OK', '   ', DECODE(IO_BND_CD, 'O', 'O/B', 'I/B')) BOUND,
                                 CNTR_TPSZ_CD TPSZ,
                                 SUM(COMM_UT_AMT) UNIT_COST
                            FROM AGT_OTR_UT_COST
                           WHERE COMM_YRMON = REPLACE(@[comm_yrmon1], '-', '')
                             AND OFC_CD     = @[ofc_cd]
                             AND BKG_POR_CD = NVL(@[bkg_por_cd], BKG_POR_CD)
                             AND BKG_DEL_CD = NVL(@[bkg_del_cd], BKG_DEL_CD)
                        GROUP BY DECODE(AC_TP_CD, 'K', 'Brokerage/FAC', 'B', 'Brokerage/FAC', 'F', 'Brokerage/FAC', 'H', 'CHF', 'Commission'), DECODE(IO_BND_CD||AC_TP_CD, 'OS', 'T/S', 'IS', 'T/S', 'OF', '   ', 'OB', '   ', 'OK', '   ', DECODE(IO_BND_CD, 'O', 'O/B', 'I/B')) , CNTR_TPSZ_CD
                    ),
                    (     SELECT
                                 DECODE(CNTR_TPSZ_CD, 'D2', 1, 'D4', 2, 'D5', 3, 'D7', 4, 'D8', 5, 'D9', 6, 'R2', 7, 'R4', 8, 'R5', 9, 'R7', 10, 'F2', 11, 'F4', 12, 'F5', 13, 'O2', 14, 'O4', 15, 'P2', 16, 'P4', 17, 'S2', 18, 'S4', 19, 'T2', 20, 'T4', 21, 'A2', 22, 'A4', 23, 'DW', 24, 25) SEQ,
                                 CNTR_TPSZ_CD TPSZZ
                            FROM MDM_CNTR_TP_SZ
                           WHERE NVL(DELT_FLG, 'N') = 'N'
                    )
                WHERE TPSZZ = TPSZ
             GROUP BY DECODE(COMM_TYPE, 'Commission', 1, 'CHF', 3, 2), COMM_TYPE, BOUND
         )
     WHERE KIND = COMM_TYPE(+)
       AND BND  = BOUND(+)
  ORDER BY SEQ			]]></sql>
			<params>
				<param name="comm_yrmon1" type="12" value="" out="Y"/>
				<param name="ofc_cd" type="12" value="AARBA" out="Y"/>
				<param name="bkg_por_cd" type="12" value="" out="Y"/>
				<param name="bkg_del_cd" type="12" value="" out="Y"/>
			</params>
		</query>
	</querys>
</sqls>
