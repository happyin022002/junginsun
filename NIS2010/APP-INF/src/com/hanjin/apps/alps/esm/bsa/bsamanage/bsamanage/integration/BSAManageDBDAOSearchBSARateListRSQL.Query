<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BSAManageDBDAOSearchBSARateListRSQL">
			<desc><![CDATA[ESM_BSA_0172 화면의 조회 쿼리]]></desc>
			<sql><![CDATA[
SELECT 
      RANK() OVER (ORDER BY A.TRD_CD||A.RLANE_CD||A.DIR_CD||A.CNTR_TPSZ_CD) GRP,
      MAX(A.BSA_SEQ) OVER(PARTITION BY A.TRD_CD||A.RLANE_CD||A.DIR_CD||A.CNTR_TPSZ_CD) MAXSEQ, 
      A.BSA_SEQ,
      A.BSA_SEQ BSA_SEQ_ORG, 
      A.VVD_CD, 
      A.BSA_FM_DT, 
      A.BSA_TO_DT, 
      A.TRD_CD, 
      A.RLANE_CD, 
      A.DIR_CD, 
      A.VOP_CD, 
      A.CNTR_TPSZ_CD 
#if (${rdotype}=="D7") 
	#set($count = 0) 
		#foreach( ${keys} in ${keyList}) 
		 	,MAX(DECODE(B.CRR_CD,'${keys}',B.HC_RT,0 ) ) 		AS HC_RT$count   
     		,MAX(DECODE(B.CRR_CD,'${keys}',B.HC_OVR_RT,0 ) ) 	AS HC_OVR_RT$count   
     		,MAX(DECODE(B.CRR_CD,'${keys}',B.RT_TP_FLG,'' ) )  AS RT_TP_FLG$count   				        
        #set($count = $count + 1)
		#end
#else
	#set($count = 0) 
		#foreach( ${keys} in ${keyList}) 
		 	,MAX(DECODE(B.CRR_CD,'${keys}',B.HC_OVR_RT,0 ) ) AS HC_OVR_RT$count   
     		,MAX(DECODE(B.CRR_CD,'${keys}',B.RT_TP_FLG,'' ) ) AS RT_TP_FLG$count   				        
        #set($count = $count + 1)
		#end  
#end	
FROM    
    BSA_HIGH_CUBIC_RT_MST     A 
   ,BSA_HIGH_CUBIC_RT_DTL B 
WHERE   
     A.CNTR_TPSZ_CD  = B.CNTR_TPSZ_CD  
AND  A.CNTR_TPSZ_CD  = @[rdotype]  
AND  A.BSA_SEQ       = B.BSA_SEQ
AND  A.BSA_TO_DT     >= @[txtsdate] 
AND  A.DELT_FLG      = 'N' 
#if (${cobtrade} !='') 
 AND  A.TRD_CD 		= @[cobtrade] 
#end
#if (${coblane}!='') 
 AND  A.RLANE_CD 	= @[coblane] 
#end
#if (${cobdir}!='') 
 AND  A.DIR_CD 		= @[cobdir] 
#end
GROUP BY 
       A.TRD_CD, 
       A.RLANE_CD, 
       A.DIR_CD, 
       A.CNTR_TPSZ_CD, 
       A.BSA_SEQ, 
       A.VVD_CD, 
       A.BSA_FM_DT, 
       A.BSA_TO_DT, 
       A.VOP_CD
ORDER BY 
       A.BSA_SEQ, 
       A.VVD_CD,
       A.BSA_FM_DT,
       A.BSA_TO_DT, 
       A.TRD_CD, 
       A.RLANE_CD, 
       A.DIR_CD, 
       A.VOP_CD, 
       A.CNTR_TPSZ_CD			]]></sql>
			<params>
				<param name="rdotype" type="12" value="" out="N"/>
				<param name="txtsdate" type="12" value="" out="N"/>
				<param name="cobtrade" type="12" value="" out="N"/>
				<param name="coblane" type="12" value="" out="N"/>
				<param name="cobdir" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
