<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TariffGeneralInformationDBDAOPriTrfBzcHistoryAmendRSQL">
			<desc><![CDATA[선택한 Tariff Code의 Amend별 정보를 조회]]></desc>
			<sql><![CDATA[
SELECT 
    B.AMDT_SEQ
   ,TO_CHAR(B.CRE_DT,'YYYYMMDD') AS CRE_DT
   ,TO_CHAR(B.EFF_DT,'YYYYMMDD') AS EFF_DT
   ,TO_CHAR(B.EXP_DT,'YYYYMMDD') AS EXP_DT
   ,TO_CHAR(B.PUB_DT,'YYYYMMDD') AS PUB_DT
   ,C.INTG_CD_VAL_DP_DESC AS TRF_BZC_STS_CD_NM
   ,B.RQST_OFC_CD
   ,B.CRE_USR_ID
   ,B.APRO_OFC_CD
   ,B.TRF_BZC_TP_CD
   ,TRIM(TO_CHAR(B.TRF_BZC_WGT,9999999999.999)) AS TRF_BZC_WGT
   ,B.TRF_BZC_WGT_UT_CD
   ,TRIM(TO_CHAR(B.TRF_BZC_VOL_QTY,9999999999.999)) AS TRF_BZC_VOL_QTY
   ,B.TRF_BZC_VOL_QTY
   ,B.TRF_BZC_VOL_UT_CD
   ,B.CURR_CD
   ,B.PUB_CNTC_PSON_NM
   ,B.PUB_OFC_ADDR
   ,B.PUB_OFC_PHN_NO
   ,B.PUB_OFC_CTY_NM
   ,B.PUB_OFC_STE_CD
   ,B.PUB_OFC_ZIP_CD
   ,B.PUB_OFC_CNT_NM
   ,B.PUB_OFC_FAX_NO
   ,B.TRF_NO
   ,B.TRF_PFX_CD
   ,T.TRF_NM
   ,T.TRF_INLND_FLG
FROM 
    PRI_TRF_BZC B
	,(
        SELECT  INTG_CD_VAL_CTNT, INTG_CD_VAL_DP_DESC
          FROM  COM_INTG_CD_DTL
         WHERE  1 = 1
           AND  INTG_CD_ID = 'CD02395'
        ) C
     ,(
        SELECT  TRF_NM, TRF_INLND_FLG
          FROM  PRI_TARIFF 
         WHERE  1 = 1
           AND TRF_PFX_CD = @[trf_pfx_cd]
           AND TRF_NO = @[trf_no]
        ) T  
WHERE 1 = 1
AND B.TRF_NO = @[trf_no]
AND B.TRF_PFX_CD = @[trf_pfx_cd]
AND B.TRF_BZC_STS_CD = C.INTG_CD_VAL_CTNT
AND B.TRF_BZC_STS_CD = 'F'

   #if(${access_dt}!= '')
   AND B.EFF_DT <= TO_DATE(@[access_dt], 'YYYY-MM-DD')
   AND NVL(B.EXP_DT, TO_DATE('9999-12-31','YYYY-MM-DD')) >= TO_DATE(@[access_dt], 'YYYY-MM-DD')
   #end

ORDER BY B.AMDT_SEQ DESC			]]></sql>
			<params>
				<param name="trf_pfx_cd" type="12" value="" out="N"/>
				<param name="trf_no" type="12" value="" out="N"/>
				<param name="access_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
