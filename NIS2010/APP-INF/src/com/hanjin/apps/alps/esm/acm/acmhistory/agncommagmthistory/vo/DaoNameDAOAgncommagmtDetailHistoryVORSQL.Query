<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DaoNameDAOAgncommagmtDetailHistoryVORSQL">
			<desc><![CDATA[AgncommagmtDetailHistoryVO]]></desc>
			<sql><![CDATA[
SELECT
'' AS CRE_DT_TM,
'' AS CRE_GDT_TM,
B.AGN_AGMT_NO,
'' as AGMT_HIS_NO,
A.ITEM1, 
A.ITEM2, 
DECODE(A.SEQ,
1,MAX(DECODE(B.HIS_DIV, 'C', B.CNTR_TPSZ_GRP_NM)),
2,MAX(DECODE(B.HIS_DIV, 'C', B.FULL_MTY_CD)),
3,MAX(DECODE(B.HIS_DIV, 'C', B.FIX_BASE)),
4,MAX(DECODE(B.HIS_DIV, 'C', B.RATE_BASE)),
5,MAX(DECODE(B.HIS_DIV, 'C', B.OFC_SET_TP_CD)),
6,MAX(DECODE(B.HIS_DIV, 'C', B.OFC_CVRG_CD)),
7,MAX(DECODE(B.HIS_DIV, 'C', B.OFC_CD)),
8,MAX(DECODE(B.HIS_DIV, 'C', B.POR)),
9,MAX(DECODE(B.HIS_DIV, 'C', B.POL)),
10,MAX(DECODE(B.HIS_DIV, 'C', B.POD)),
11,MAX(DECODE(B.HIS_DIV, 'C', B.DEL)),
12,MAX(DECODE(B.HIS_DIV, 'C', B.CHG_DDCT_GRP_NM)),
13,MAX(DECODE(B.HIS_DIV, 'C', B.CHG_DDCT_GRP_NM)),
14,MAX(DECODE(B.HIS_DIV, 'C', B.HLG_DDCT_ORG_FLG)),
15,MAX(DECODE(B.HIS_DIV, 'C', B.HLG_DDCT_DEST_FLG)),
16,MAX(DECODE(B.HIS_DIV, 'C', B.FDRG_DDCT_ORG_FLG)),
17,MAX(DECODE(B.HIS_DIV, 'C', B.FDRG_DDCT_DEST_FLG))
) AS CURRENT_VALUE,
DECODE(A.SEQ,
1,MAX(DECODE(B.HIS_DIV, 'P', B.CNTR_TPSZ_GRP_NM)),
2,MAX(DECODE(B.HIS_DIV, 'P', B.FULL_MTY_CD)),
3,MAX(DECODE(B.HIS_DIV, 'P', B.FIX_BASE)),
4,MAX(DECODE(B.HIS_DIV, 'P', B.RATE_BASE)),
5,MAX(DECODE(B.HIS_DIV, 'P', B.OFC_SET_TP_CD)),
6,MAX(DECODE(B.HIS_DIV, 'P', B.OFC_CVRG_CD)),
7,MAX(DECODE(B.HIS_DIV, 'P', B.OFC_CD)),
8,MAX(DECODE(B.HIS_DIV, 'P', B.POR)),
9,MAX(DECODE(B.HIS_DIV, 'P', B.POL)),
10,MAX(DECODE(B.HIS_DIV, 'P', B.POD)),
11,MAX(DECODE(B.HIS_DIV, 'P', B.DEL)),
12,MAX(DECODE(B.HIS_DIV, 'P', B.CHG_DDCT_GRP_NM)),
13,MAX(DECODE(B.HIS_DIV, 'P', B.CHG_DDCT_GRP_NM)),
14,MAX(DECODE(B.HIS_DIV, 'P', B.HLG_DDCT_ORG_FLG)),
15,MAX(DECODE(B.HIS_DIV, 'P', B.HLG_DDCT_DEST_FLG)),
16,MAX(DECODE(B.HIS_DIV, 'P', B.FDRG_DDCT_ORG_FLG)),
17,MAX(DECODE(B.HIS_DIV, 'P', B.FDRG_DDCT_DEST_FLG))
) AS PREVIOUS_VALUE,
MAX(DECODE(B.HIS_DIV, 'C', B.MASTER_INFO)) AS MASTER_INFO,
MAX(DECODE(B.HIS_DIV, 'C', B.CRE_USR_ID)) AS CRE_USR_ID,
MAX(DECODE(B.HIS_DIV, 'C', B.CRE_DT)) AS CRE_DT,
MAX(DECODE(B.HIS_DIV, 'C', B.CRE_GDT)) AS CRE_GDT
FROM (
SELECT 1 AS SEQ, 'Compensation Rate' AS ITEM1, 'TP/SZ' AS ITEM2 FROM DUAL UNION ALL
SELECT 2 AS SEQ, 'Compensation Rate' AS ITEM1, 'Full/MT' FROM DUAL UNION ALL
SELECT 3 AS SEQ, 'Compensation Rate' AS ITEM1, 'Fixed Base' FROM DUAL UNION ALL
SELECT 4 AS SEQ, 'Compensation Rate' AS ITEM1, 'Rate Base' FROM DUAL UNION ALL
SELECT 5 AS SEQ, 'Office Setting' AS ITEM1, 'Type' FROM DUAL UNION ALL
SELECT 6 AS SEQ, 'Office Setting' AS ITEM1, 'Covers' FROM DUAL UNION ALL
SELECT 7 AS SEQ, 'Office Setting' AS ITEM1, 'Office' FROM DUAL UNION ALL
SELECT 8 AS SEQ, 'Route Setting' AS ITEM1, 'POR' FROM DUAL UNION ALL
SELECT 9 AS SEQ, 'Route Setting' AS ITEM1, 'POL' FROM DUAL UNION ALL
SELECT 10 AS SEQ, 'Route Setting' AS ITEM1, 'POD' FROM DUAL UNION ALL
SELECT 11 AS SEQ, 'Route Setting' AS ITEM1, 'DEL' FROM DUAL UNION ALL
SELECT 12 AS SEQ, 'CHG Deduction' AS ITEM1, 'Rep' FROM DUAL UNION ALL
SELECT 13 AS SEQ, 'CHG Deduction' AS ITEM1,'Individual' FROM DUAL UNION ALL
SELECT 14 AS SEQ, 'Haulage Deduction' AS ITEM1,'Origin Haul.' FROM DUAL UNION ALL
SELECT 15 AS SEQ, 'Haulage Deduction' AS ITEM1, 'Dest Haul.' FROM DUAL UNION ALL
SELECT 16 AS SEQ, 'Haulage Deduction' AS ITEM1, 'Origin FDRG' FROM DUAL UNION ALL
SELECT 17 AS SEQ, 'Haulage Deduction' AS ITEM1, 'Dest FDRG' FROM DUAL
) A,
(SELECT 
A.AGN_AGMT_NO,
DECODE(A.AGMT_DTL_HIS_NO,B.AGMT_DTL_HIS_NO,'C','P') AS HIS_DIV,
A.CNTR_TPSZ_GRP_NM,
DECODE(A.FULL_MTY_CD,'F','FULL','M','EMPTY',A.FULL_MTY_CD) AS FULL_MTY_CD,
A.CURR_CD||'/'||A.COMM_FX_AMT AS FIX_BASE, 
DECODE(A.COMM_PAY_TERM_CD,'C','CCT','P','PPD','T','All',A.COMM_PAY_TERM_CD)||'/'||DECODE(A.REV_DIV_CD,'G','Gross','N','Net',A.REV_DIV_CD)||'/'||A.COMM_RT AS RATE_BASE,
DECODE(A.OFC_SET_TP_CD, 'A', 'AR Office', 'B', 'BKG Office', 'F','Fin Office') AS OFC_SET_TP_CD,
A.OFC_CVRG_CD,
A.OFC_CD,
'' POR,
'' POL,
'' POD,
'' DEL,
A.CHG_DDCT_GRP_NM,
A.HLG_DDCT_ORG_FLG,
A.HLG_DDCT_DEST_FLG,
A.FDRG_DDCT_ORG_FLG,
A.FDRG_DDCT_DEST_FLG,
A.AGN_AGMT_SEQ||'/'||DECODE(A.IO_BND_CD,'I','In','O','Out')||'/'||A.AC_TP_CD AS MASTER_INFO,
A.CRE_USR_ID,
TO_CHAR(A.CRE_DT, 'YYYY-MM-DD HH24:MI') AS CRE_DT,
TO_CHAR(A.CRE_GDT, 'YYYY-MM-DD HH24:MI') AS CRE_GDT
FROM ACM_AGN_AGMT_DTL_HIS A,
      (SELECT
            AGN_AGMT_NO, MAX(AGMT_DTL_HIS_NO) AS AGMT_DTL_HIS_NO
        FROM ACM_AGN_AGMT_DTL_HIS
        WHERE AGN_AGMT_NO = @[agn_agmt_no]
        GROUP BY AGN_AGMT_NO) B
 WHERE A.AGN_AGMT_NO = @[agn_agmt_no]
 AND A.AGN_AGMT_NO = B.AGN_AGMT_NO
 AND A.AGMT_DTL_HIS_NO >= B.AGMT_DTL_HIS_NO -1
 ) B
 GROUP BY B.AGN_AGMT_NO, A.SEQ, A.ITEM1, A.ITEM2
 ORDER BY A.SEQ			]]></sql>
			<params>
				<param name="agn_agmt_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
