/*=========================================================
*Copyright(c) 2017 CyberLogitec
*@FileName : MultiDimensionRPTDBDAOSearchWeeklySalesByOffice3TEUBased7ListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2017.01.18
*@LastModifier : 
*@LastVersion : 1.0
* 2017.01.18 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esm.mas.multidimensionrpt.multidimensionrpt.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class MultiDimensionRPTDBDAOSearchWeeklySalesByOffice3TEUBased7ListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * 2014.01.02 김수정 [CHM-201327858] [MAS] IAS P&L 추가
	  * 2015.08.31 손진환 [CHM-201536958] Split15-[그룹사 표준 코드 시행] SML 프로그램 대응 및 데이타 마이그레이션 작업 요청
	  * </pre>
	  */
	public MultiDimensionRPTDBDAOSearchWeeklySalesByOffice3TEUBased7ListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_trd_dir_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_chkprd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ofc_lvl",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_pro_lvl",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_year",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_pro_vw",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_sls_mon",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_sub_trd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_fm_wk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_skd_voy_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_skd_dir_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_dir_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ofc_vw",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("str_display",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_rlane_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_to_mon",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ias_rgn_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_trd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_vsl_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_fm_mon",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_to_wk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_chtbiz",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esm.mas.multidimensionrpt.multidimensionrpt.integration").append("\n"); 
		query.append("FileName : MultiDimensionRPTDBDAOSearchWeeklySalesByOffice3TEUBased7ListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("WITH COMM_RTO" ).append("\n"); 
		query.append("AS (SELECT COST_YRMON," ).append("\n"); 
		query.append("           TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD," ).append("\n"); 
		query.append("           VSL_CD," ).append("\n"); 
		query.append("           SKD_VOY_NO," ).append("\n"); 
		query.append("           SKD_DIR_CD," ).append("\n"); 
		query.append("           STATUS," ).append("\n"); 
		query.append("           VOL," ).append("\n"); 
		query.append("           IAS_RTO," ).append("\n"); 
		query.append("           CMMT_RTO," ).append("\n"); 
		query.append("           CASE WHEN ROUND(SUM(DECODE(STATUS, 'T/S', CMMT_RTO, IAS_RTO*CMMT_RTO)) OVER (PARTITION BY COST_YRMON, TRD_CD, RLANE_CD, VSL_CD, SKD_VOY_NO, SKD_DIR_CD), 3) <> 1 AND VOL <> 0 THEN" ).append("\n"); 
		query.append("                     CASE WHEN STATUS = 'T/S' THEN 1" ).append("\n"); 
		query.append("                          ELSE IAS_RTO" ).append("\n"); 
		query.append("                     END" ).append("\n"); 
		query.append("                ELSE" ).append("\n"); 
		query.append("                     CASE WHEN STATUS = 'T/S' THEN CMMT_RTO" ).append("\n"); 
		query.append("                          ELSE IAS_RTO * CMMT_RTO" ).append("\n"); 
		query.append("                     END" ).append("\n"); 
		query.append("           END RTO" ).append("\n"); 
		query.append("      FROM (       " ).append("\n"); 
		query.append("                SELECT A.COST_YRMON," ).append("\n"); 
		query.append("                       TRD_CD," ).append("\n"); 
		query.append("                       RLANE_CD," ).append("\n"); 
		query.append("                       VSL_CD," ).append("\n"); 
		query.append("                       SKD_VOY_NO," ).append("\n"); 
		query.append("                       SKD_DIR_CD," ).append("\n"); 
		query.append("                       STATUS," ).append("\n"); 
		query.append("                       NVL(VOL, 0) AS VOL," ).append("\n"); 
		query.append("                       SUM(NVL(VOL, 0)) OVER (PARTITION BY A.COST_YRMON,TRD_CD, RLANE_CD, VSL_CD, SKD_VOY_NO, SKD_DIR_CD) AS TTL_VOL," ).append("\n"); 
		query.append("                       SUM(IAS_VOL) OVER (PARTITION BY A.COST_YRMON,TRD_CD, RLANE_CD, VSL_CD, SKD_VOY_NO, SKD_DIR_CD) AS IAS_VOL," ).append("\n"); 
		query.append("                       CASE WHEN STATUS = 'T/S' THEN 0" ).append("\n"); 
		query.append("                            ELSE DECODE(SUM(IAS_VOL) OVER (PARTITION BY A.COST_YRMON,TRD_CD, RLANE_CD, VSL_CD, SKD_VOY_NO, SKD_DIR_CD), 0, 0, ROUND(VOL / SUM(IAS_VOL) OVER (PARTITION BY A.COST_YRMON,TRD_CD, RLANE_CD, VSL_CD, SKD_VOY_NO, SKD_DIR_CD), 2))" ).append("\n"); 
		query.append("                       END IAS_RTO," ).append("\n"); 
		query.append("                       DECODE(STATUS, 'T/S', OCN_CMMT_RTO, IAS_CMMT_RTO) AS CMMT_RTO" ).append("\n"); 
		query.append("                  FROM (" ).append("\n"); 
		query.append("                        SELECT COST_YRMON," ).append("\n"); 
		query.append("                               TRD_CD," ).append("\n"); 
		query.append("                               RLANE_CD," ).append("\n"); 
		query.append("                               VSL_CD," ).append("\n"); 
		query.append("                               SKD_VOY_NO," ).append("\n"); 
		query.append("                               SKD_DIR_CD," ).append("\n"); 
		query.append("                               B.STATUS," ).append("\n"); 
		query.append("                               SUM(DECODE(A.STATUS, B.STATUS, VOL, 0)) AS VOL," ).append("\n"); 
		query.append("                               SUM(DECODE(B.STATUS, 'T/S', 0, DECODE(A.STATUS, B.STATUS, VOL, 0))) AS IAS_VOL" ).append("\n"); 
		query.append("                          FROM (" ).append("\n"); 
		query.append("                                SELECT B.COST_YRMON," ).append("\n"); 
		query.append("                                       FM_TRD_CD AS TRD_CD," ).append("\n"); 
		query.append("                                       FM_RLANE_CD AS RLANE_CD," ).append("\n"); 
		query.append("                                       FM_VSL_CD AS VSL_CD," ).append("\n"); 
		query.append("                                       FM_SKD_VOY_NO AS SKD_VOY_NO," ).append("\n"); 
		query.append("                                       FM_SKD_DIR_CD AS SKD_DIR_CD," ).append("\n"); 
		query.append("                                       TS_QTY AS VOL, " ).append("\n"); 
		query.append("                                       CASE WHEN FM_RLANE_CD||FM_VSL_CD||FM_SKD_VOY_NO||FM_SKD_DIR_CD = TO_RLANE_CD||TO_VSL_CD||TO_SKD_VOY_NO||TO_SKD_DIR_CD THEN 'L/C'" ).append("\n"); 
		query.append("                                            WHEN TO_TRD_CD = 'IAS' THEN 'IAS T/S'" ).append("\n"); 
		query.append("                                            ELSE 'T/S'" ).append("\n"); 
		query.append("                                       END STATUS    " ).append("\n"); 
		query.append("                                  FROM MAS_LANE_TS_QTY A," ).append("\n"); 
		query.append("                                       MAS_MON_VVD B,   " ).append("\n"); 
		query.append("                                       MAS_LANE_RGST L1" ).append("\n"); 
		query.append("                                 WHERE B.TRD_CD = A.FM_TRD_CD" ).append("\n"); 
		query.append("                                   AND B.RLANE_CD = A.FM_RLANE_CD" ).append("\n"); 
		query.append("                                   AND B.IOC_CD = A.FM_IOC_CD" ).append("\n"); 
		query.append("                                   AND B.VSL_CD = A.FM_VSL_CD" ).append("\n"); 
		query.append("                                   AND B.SKD_VOY_NO = A.FM_SKD_VOY_NO" ).append("\n"); 
		query.append("                                   AND B.DIR_CD = A.FM_SKD_DIR_CD" ).append("\n"); 
		query.append("                                   AND B.DELT_FLG = 'N'" ).append("\n"); 
		query.append("                                   AND B.RLANE_CD = L1.RLANE_CD" ).append("\n"); 
		query.append("                                   AND B.DIR_CD = L1.DIR_CD" ).append("\n"); 
		query.append("                                   AND B.TRD_CD = L1.TRD_CD" ).append("\n"); 
		query.append("                                   AND B.IOC_CD = L1.IOC_CD" ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("                                   AND B.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   " ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("                                   AND B.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    " ).append("\n"); 
		query.append("                                   AND B.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   " ).append("\n"); 
		query.append("#end	" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("                                   AND B.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("                                   AND B.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("                                   AND B.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("                                   AND B.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("                                   AND B.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("#end                               " ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='')          " ).append("\n"); 
		query.append("                                   AND B.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("#end                               " ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='')          " ).append("\n"); 
		query.append("                                   AND B.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end                    " ).append("\n"); 
		query.append("#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("                                   AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("                                   AND L1.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("#end   " ).append("\n"); 
		query.append("                            ) A," ).append("\n"); 
		query.append("                            (SELECT 'L/C' STATUS FROM DUAL" ).append("\n"); 
		query.append("                             UNION ALL" ).append("\n"); 
		query.append("                             SELECT 'T/S' STATUS FROM DUAL" ).append("\n"); 
		query.append("                             UNION ALL" ).append("\n"); 
		query.append("                             SELECT 'IAS T/S' STATUS FROM DUAL) B" ).append("\n"); 
		query.append("                        GROUP BY COST_YRMON," ).append("\n"); 
		query.append("                               TRD_CD," ).append("\n"); 
		query.append("                               RLANE_CD," ).append("\n"); 
		query.append("                               VSL_CD," ).append("\n"); 
		query.append("                               SKD_VOY_NO," ).append("\n"); 
		query.append("                               SKD_DIR_CD," ).append("\n"); 
		query.append("                               B.STATUS" ).append("\n"); 
		query.append("                    ) A, " ).append("\n"); 
		query.append("                    (SELECT A.COST_YRMON," ).append("\n"); 
		query.append("                            FM_TRD_CD," ).append("\n"); 
		query.append("                            FM_RLANE_CD," ).append("\n"); 
		query.append("                            FM_DIR_CD," ).append("\n"); 
		query.append("                            SUM(DECODE(TO_TRD_CD, 'IAS', BSA_CMMT_RTO / 100, 0)) AS IAS_CMMT_RTO," ).append("\n"); 
		query.append("                            SUM(DECODE(TO_TRD_CD, 'IAS', 0, BSA_CMMT_RTO / 100)) AS OCN_CMMT_RTO " ).append("\n"); 
		query.append("                       FROM MAS_LANE_TS_BSA_CMMT A" ).append("\n"); 
		query.append("                      WHERE 1=1" ).append("\n"); 
		query.append("                        AND EXISTS (SELECT 'A' " ).append("\n"); 
		query.append("                                      FROM MAS_MON_VVD B" ).append("\n"); 
		query.append("                                     WHERE B.COST_YRMON = A.COST_YRMON" ).append("\n"); 
		query.append("                                       AND B.TRD_CD = A.FM_TRD_CD" ).append("\n"); 
		query.append("                                       AND B.RLANE_CD = A.FM_RLANE_CD" ).append("\n"); 
		query.append("                                       AND B.DIR_CD = A.FM_DIR_CD" ).append("\n"); 
		query.append("                                       AND B.DELT_FLG = 'N'" ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("                                       AND B.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   " ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("                                       AND B.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    " ).append("\n"); 
		query.append("                                       AND B.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   " ).append("\n"); 
		query.append("#end	" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("                                       AND B.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("                                       AND B.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("                                       AND B.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("                                       AND B.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("                                       AND B.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("                                       AND B.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("                                       AND B.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                                   )" ).append("\n"); 
		query.append("                      GROUP BY A.COST_YRMON," ).append("\n"); 
		query.append("                            FM_TRD_CD," ).append("\n"); 
		query.append("                            FM_RLANE_CD," ).append("\n"); 
		query.append("                            FM_DIR_CD" ).append("\n"); 
		query.append("                      ) B" ).append("\n"); 
		query.append("                WHERE 1=1" ).append("\n"); 
		query.append("                  AND NVL(A.COST_YRMON, B.COST_YRMON) = B.COST_YRMON" ).append("\n"); 
		query.append("                  AND NVL(A.TRD_CD, B.FM_TRD_CD) = B.FM_TRD_CD" ).append("\n"); 
		query.append("                  AND NVL(A.RLANE_CD, B.FM_RLANE_CD) = B.FM_RLANE_CD" ).append("\n"); 
		query.append("                  AND NVL(A.SKD_DIR_CD, B.FM_DIR_CD)  = B.FM_DIR_CD " ).append("\n"); 
		query.append("        ) " ).append("\n"); 
		query.append(")    " ).append("\n"); 
		query.append("SELECT A.COST_YRMON " ).append("\n"); 
		query.append("      ,A.SLS_YRMON " ).append("\n"); 
		query.append("      ,A.COST_WK" ).append("\n"); 
		query.append("	  ,'' RHQ" ).append("\n"); 
		query.append("      ,A.TRD_CD " ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD " ).append("\n"); 
		query.append("      ,A.RLANE_CD " ).append("\n"); 
		query.append("      ,A.IOC_CD " ).append("\n"); 
		query.append("      ,A.VSL_CD " ).append("\n"); 
		query.append("      ,A.SKD_VOY_NO " ).append("\n"); 
		query.append("      ,A.DIR_CD" ).append("\n"); 
		query.append("      ,A.HUL_BND_CD " ).append("\n"); 
		query.append("      ,A.STATUS" ).append("\n"); 
		query.append("	" ).append("\n"); 
		query.append("#foreach($key in ${allcols})" ).append("\n"); 
		query.append("      ,SUM(DECODE(A.STND_COST_CD, '$key', NVL(A.AMT,0), 0)) AS COST_AMT$velocityCount" ).append("\n"); 
		query.append("#end		" ).append("\n"); 
		query.append("  FROM ( " ).append("\n"); 
		query.append("    SELECT COST_YRMON" ).append("\n"); 
		query.append("          ,SLS_YRMON" ).append("\n"); 
		query.append("          ,COST_WK" ).append("\n"); 
		query.append("          ,TRD_CD" ).append("\n"); 
		query.append("          ,SUB_TRD_CD" ).append("\n"); 
		query.append("          ,RLANE_CD" ).append("\n"); 
		query.append("          ,IOC_CD       " ).append("\n"); 
		query.append("          ,VSL_CD " ).append("\n"); 
		query.append("          ,SKD_VOY_NO " ).append("\n"); 
		query.append("          ,DIR_CD " ).append("\n"); 
		query.append("          ,HUL_BND_CD" ).append("\n"); 
		query.append("          ,STATUS" ).append("\n"); 
		query.append("          ,DECODE (B2.RNUM " ).append("\n"); 
		query.append("                   ,1, 'VOYAGE00'" ).append("\n"); 
		query.append("                   ,2, 'BSA00000'" ).append("\n"); 
		query.append("                   ,3, 'LOAD0000'" ).append("\n"); 
		query.append("                   ,4, 'LOADFACT' " ).append("\n"); 
		query.append("                   ,5, 'REVENUE0' " ).append("\n"); 
		query.append("                   ,6, '41101011'" ).append("\n"); 
		query.append("                   ,7, 'RPB00000' " ).append("\n"); 
		query.append("                   ,8, 'OTHINCOM'" ).append("\n"); 
		query.append("                   ,9, '43207011'" ).append("\n"); 
		query.append("                   ,10, '43102011'" ).append("\n"); 
		query.append("                   ,11, '43201011'" ).append("\n"); 
		query.append("                   ,12, 'INCOMTTL'" ).append("\n"); 
		query.append("                   ,13, '51101011'" ).append("\n"); 
		query.append("                   ,14, '51101071'" ).append("\n"); 
		query.append("                   ,15, '51101021'" ).append("\n"); 
		query.append("                   ,16, '51101031'" ).append("\n"); 
		query.append("                   ,17, '51101051'" ).append("\n"); 
		query.append("                   ,18, '51101041'" ).append("\n"); 
		query.append("                   ,19, '51101061'" ).append("\n"); 
		query.append("                   ,20, '92301000'" ).append("\n"); 
		query.append("                   ,21, '51601011'" ).append("\n"); 
		query.append("                   ,22, '51601012'" ).append("\n"); 
		query.append("                   ,23, '51301011'" ).append("\n"); 
		query.append("                   ,24, '51301021'" ).append("\n"); 
		query.append("                   ,25, '51301031'" ).append("\n"); 
		query.append("                   ,26, '51301041'" ).append("\n"); 
		query.append("                   ,27, '51301051'" ).append("\n"); 
		query.append("                   ,28, '51301061'" ).append("\n"); 
		query.append("                   ,29, '51301081'" ).append("\n"); 
		query.append("                   ,30, '92303000'" ).append("\n"); 
		query.append("                   ,31, '51102000'" ).append("\n"); 
		query.append("                   ,32, '51302000'" ).append("\n"); 
		query.append("                   ,33, '51401011'" ).append("\n"); 
		query.append("                   ,34, 'CMCOST00'" ).append("\n"); 
		query.append("                   ,35, 'CMCB0000'" ).append("\n"); 
		query.append("                   ,36, 'CMCTOTAL'" ).append("\n"); 
		query.append("                   ,37, 'CMB00000' " ).append("\n"); 
		query.append("                   ,38, '51801011'" ).append("\n"); 
		query.append("                                    " ).append("\n"); 
		query.append("                   ,39, '52101013'" ).append("\n"); 
		query.append("                   ,40, '52201013'" ).append("\n"); 
		query.append("                   ,41, '52301013'" ).append("\n"); 
		query.append("                   ,42, '52401013'" ).append("\n"); 
		query.append("                   ,43, '52601013'" ).append("\n"); 
		query.append("                   ,44, '52101012'" ).append("\n"); 
		query.append("                   ,45, '52201012'" ).append("\n"); 
		query.append("                   ,46, '52301012'" ).append("\n"); 
		query.append("                   ,47, '52401012'" ).append("\n"); 
		query.append("                   ,48, '52601012'" ).append("\n"); 
		query.append("                   ,49, '52111021'" ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   ,50, '65000000'" ).append("\n"); 
		query.append("                   ,51, '65010001'" ).append("\n"); 
		query.append("                   ,52, '54600000'" ).append("\n"); 
		query.append("                   ,53, 'OPCOSTEX'" ).append("\n"); 
		query.append("                   ,54, 'OPCOSTIN'" ).append("\n"); 
		query.append("                   ,55, 'OPCB0000'" ).append("\n"); 
		query.append("                   ,56, 'BOPTTLEX'" ).append("\n"); 
		query.append("                   ,57, 'BOPTTLIN'" ).append("\n"); 
		query.append("                   ,58, 'BOPB0000'" ).append("\n"); 
		query.append("                   ,59, '51801012'" ).append("\n"); 
		query.append("                  			   	   " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    	       ) STND_COST_CD	   " ).append("\n"); 
		query.append("          ,DECODE (B2.RNUM     	" ).append("\n"); 
		query.append("                   ,1, VOYAGE" ).append("\n"); 
		query.append("                   ,2, SUPPLY" ).append("\n"); 
		query.append("                   ,3, TOT_QTY" ).append("\n"); 
		query.append("                   ,4, DECODE (SUPPLY, 0, 0, TOT_QTY / SUPPLY) * 100" ).append("\n"); 
		query.append("                   ,5, FREIGTH_REV " ).append("\n"); 
		query.append("                   ,6, FREIGTH_REV" ).append("\n"); 
		query.append("                   ,7, DECODE (TOT_QTY, 0, 0, FREIGTH_REV / TOT_QTY)" ).append("\n"); 
		query.append("                   ,8, (MISC_REV + SPC_CHTR + DMDT_COST)" ).append("\n"); 
		query.append("                   ,9, MISC_REV" ).append("\n"); 
		query.append("                   ,10, SPC_CHTR" ).append("\n"); 
		query.append("                   ,11, DMDT_COST" ).append("\n"); 
		query.append("                   ,12, (FREIGTH_REV + (MISC_REV + SPC_CHTR + DMDT_COST))" ).append("\n"); 
		query.append("                   ,13, BASIC_STEVEDORAGE" ).append("\n"); 
		query.append("                   ,14, OTHER_CY_EXPENSE" ).append("\n"); 
		query.append("                   ,15, TS_STEVEDORAGE" ).append("\n"); 
		query.append("                   ,16, ON_DOCK_CY_EXPENSE" ).append("\n"); 
		query.append("                   ,17, CARGO_HANDLING_EXPENSE" ).append("\n"); 
		query.append("                   ,18, STORAGE" ).append("\n"); 
		query.append("                   ,19, MISC_CARGO_HANDLING_EXPENSE" ).append("\n"); 
		query.append("                   ,20, EXCLUSIVE_TERMINAL_ADD_COST" ).append("\n"); 
		query.append("                   ,21, CARGO_VARIABLE_VOLUME_DISCOUNT" ).append("\n"); 
		query.append("                   ,22, 0" ).append("\n"); 
		query.append("                   ,23, RAIL_DIRECT" ).append("\n"); 
		query.append("                   ,24, RAIL_TRUCK" ).append("\n"); 
		query.append("                   ,25, TRUCK_DIRCET" ).append("\n"); 
		query.append("                   ,26, WATER_DIRECT" ).append("\n"); 
		query.append("                   ,27, WATER_RAIL" ).append("\n"); 
		query.append("                   ,28, WATER_TRUCK" ).append("\n"); 
		query.append("                   ,29, OTHER_TRANSPORT_EXPENSE" ).append("\n"); 
		query.append("                   ,30, CARRIERS_HAULAGE_SVG_CHG" ).append("\n"); 
		query.append("                   ,31, EMPTY_TERMINAL_EXPENSE" ).append("\n"); 
		query.append("                   ,32, EMPTY_TRANSPORT_EXPENSE" ).append("\n"); 
		query.append("                   ,33, AGENT_COMMISSION" ).append("\n"); 
		query.append("                   ,34, CM_COST_TOTAL" ).append("\n"); 
		query.append("                   ,35, DECODE(TOT_QTY, 0, 0, CM_COST_TOTAL / TOT_QTY)" ).append("\n"); 
		query.append("                   ,36, CM" ).append("\n"); 
		query.append("                   ,37, DECODE(TOT_QTY, 0, 0, CM / TOT_QTY)" ).append("\n"); 
		query.append("                   ,38, US_DOMESTIC_SAV_CREDIT" ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   ,39, CNTR_STERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                   ,40, CNTR_LTERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                   ,41, CNTR_MNR_LAND_AMT  " ).append("\n"); 
		query.append("                   ,42, CNTR_DPC_LAND_AMT  " ).append("\n"); 
		query.append("                   ,43, CNTR_INSUR_LAND_AMT                  " ).append("\n"); 
		query.append("                   ,44, CNTR_STERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                   ,45, CNTR_LTERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                   ,46, CNTR_MNR_OTR_AMT  " ).append("\n"); 
		query.append("                   ,47, CNTR_DPC_OTR_AMT  " ).append("\n"); 
		query.append("                   ,48, CNTR_INSUR_OTR_AMT   " ).append("\n"); 
		query.append("                   ,49, CHSS_AMT  " ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   ,50, BUSINESS_ACTIVITY_COST" ).append("\n"); 
		query.append("                   ,51, GEN_EXPN" ).append("\n"); 
		query.append("                   ,52, INTERNAL_EXPN" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                   ,53, OP_COST - VSL_INT_EXP" ).append("\n"); 
		query.append("                   ,54, OP_COST" ).append("\n"); 
		query.append("                   ,55, DECODE(TOT_QTY, 0, 0, (OP_COST - VSL_INT_EXP) / TOT_QTY)                   " ).append("\n"); 
		query.append("                   ,56, ((FREIGTH_REV + SUPPLY + SPC_CHTR) - CM_COST_TOTAL - OP_COST - VSL_INT_EXP)" ).append("\n"); 
		query.append("                   ,57, ((FREIGTH_REV + SUPPLY + SPC_CHTR) - CM_COST_TOTAL - OP_COST)" ).append("\n"); 
		query.append("                   ,58, DECODE(TOT_QTY, 0, 0, ((FREIGTH_REV + SUPPLY + SPC_CHTR) - CM_COST_TOTAL - OP_COST - VSL_INT_EXP) / TOT_QTY)                    " ).append("\n"); 
		query.append("                   ,59, DECODE (@[f_pro_vw], 'P', ONE_WY_SAV_PFIT_ANAL_AMT ,  ONE_WY_SAV_RESPB_ANAL_AMT)" ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("              ) AS AMT" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("      FROM (" ).append("\n"); 
		query.append("            SELECT COST_YRMON" ).append("\n"); 
		query.append("                  ,SLS_YRMON" ).append("\n"); 
		query.append("                  ,COST_WK" ).append("\n"); 
		query.append("                  ,TRD_CD" ).append("\n"); 
		query.append("                  ,SUB_TRD_CD" ).append("\n"); 
		query.append("                  ,RLANE_CD" ).append("\n"); 
		query.append("                  ,IOC_CD       " ).append("\n"); 
		query.append("                  ,VSL_CD " ).append("\n"); 
		query.append("                  ,SKD_VOY_NO " ).append("\n"); 
		query.append("                  ,DIR_CD " ).append("\n"); 
		query.append("                  ,HUL_BND_CD" ).append("\n"); 
		query.append("                  ,STATUS" ).append("\n"); 
		query.append("                  ,SUM(VOYAGE     ) AS VOYAGE" ).append("\n"); 
		query.append("                  ,SUM(TOT_QTY    ) AS TOT_QTY " ).append("\n"); 
		query.append("                  ,SUM(FREIGTH_REV) AS FREIGTH_REV " ).append("\n"); 
		query.append("                  ,SUM(MISC_REV   ) AS MISC_REV " ).append("\n"); 
		query.append("                  ,SUM(SUPPLY)      AS SUPPLY" ).append("\n"); 
		query.append("                  ,SUM(SPC_CHTR)    AS SPC_CHTR                  " ).append("\n"); 
		query.append("                  " ).append("\n"); 
		query.append("                  ,SUM(DMDT_COST)                      AS DMDT_COST " ).append("\n"); 
		query.append("                  ,SUM(BASIC_STEVEDORAGE             ) AS BASIC_STEVEDORAGE " ).append("\n"); 
		query.append("                  ,SUM(OTHER_CY_EXPENSE              ) AS OTHER_CY_EXPENSE " ).append("\n"); 
		query.append("                  ,SUM(TS_STEVEDORAGE                ) AS TS_STEVEDORAGE " ).append("\n"); 
		query.append("                  ,SUM(ON_DOCK_CY_EXPENSE            ) AS ON_DOCK_CY_EXPENSE " ).append("\n"); 
		query.append("                  ,SUM(CARGO_HANDLING_EXPENSE        ) AS CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                  ,SUM(STORAGE                       ) AS STORAGE " ).append("\n"); 
		query.append("                  ,SUM(MISC_CARGO_HANDLING_EXPENSE   ) AS MISC_CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                  ,SUM(EXCLUSIVE_TERMINAL_ADD_COST   ) AS EXCLUSIVE_TERMINAL_ADD_COST " ).append("\n"); 
		query.append("                  ,SUM(CARGO_VARIABLE_VOLUME_DISCOUNT) AS CARGO_VARIABLE_VOLUME_DISCOUNT " ).append("\n"); 
		query.append("                  ,SUM(RAIL_DIRECT                   ) AS RAIL_DIRECT " ).append("\n"); 
		query.append("                  ,SUM(RAIL_TRUCK                    ) AS RAIL_TRUCK " ).append("\n"); 
		query.append("                  ,SUM(TRUCK_DIRCET                  ) AS TRUCK_DIRCET " ).append("\n"); 
		query.append("                  ,SUM(WATER_DIRECT                  ) AS WATER_DIRECT " ).append("\n"); 
		query.append("                  ,SUM(WATER_RAIL                    ) AS WATER_RAIL " ).append("\n"); 
		query.append("                  ,SUM(WATER_TRUCK                   ) AS WATER_TRUCK " ).append("\n"); 
		query.append("                  ,SUM(OTHER_TRANSPORT_EXPENSE       ) AS OTHER_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                  ,SUM(CARRIERS_HAULAGE_SVG_CHG      ) AS CARRIERS_HAULAGE_SVG_CHG" ).append("\n"); 
		query.append("                  ,SUM(EMPTY_TERMINAL_EXPENSE        ) AS EMPTY_TERMINAL_EXPENSE " ).append("\n"); 
		query.append("                  ,SUM(EMPTY_TRANSPORT_EXPENSE       ) AS EMPTY_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                  ,SUM(AGENT_COMMISSION              ) AS AGENT_COMMISSION " ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                  ,SUM(CM_COST_TOTAL)   AS CM_COST_TOTAL " ).append("\n"); 
		query.append("                  ,SUM(CM)              AS CM" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("              	    " ).append("\n"); 
		query.append("                  ,SUM(US_DOMESTIC_SAV_CREDIT      ) AS US_DOMESTIC_SAV_CREDIT" ).append("\n"); 
		query.append("                  " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                  ,SUM(CNTR_STERM_RNTL_LAND_AMT )    AS CNTR_STERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                  ,SUM(CNTR_LTERM_RNTL_LAND_AMT )    AS CNTR_LTERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                  ,SUM(CNTR_MNR_LAND_AMT )           AS CNTR_MNR_LAND_AMT  " ).append("\n"); 
		query.append("                  ,SUM(CNTR_DPC_LAND_AMT )           AS CNTR_DPC_LAND_AMT  " ).append("\n"); 
		query.append("                  ,SUM(CNTR_INSUR_LAND_AMT )         AS CNTR_INSUR_LAND_AMT  " ).append("\n"); 
		query.append("                  " ).append("\n"); 
		query.append("                  ,SUM(CNTR_STERM_RNTL_OTR_AMT )     AS CNTR_STERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                  ,SUM(CNTR_LTERM_RNTL_OTR_AMT )     AS CNTR_LTERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                  ,SUM(CNTR_MNR_OTR_AMT )            AS CNTR_MNR_OTR_AMT  " ).append("\n"); 
		query.append("                  ,SUM(CNTR_DPC_OTR_AMT )            AS CNTR_DPC_OTR_AMT  " ).append("\n"); 
		query.append("                  ,SUM(CNTR_INSUR_OTR_AMT  )         AS CNTR_INSUR_OTR_AMT   " ).append("\n"); 
		query.append("                  ,SUM(CHSS_AMT )                    AS CHSS_AMT  " ).append("\n"); 
		query.append("                  ,SUM(ONE_WY_SAV_PFIT_ANAL_AMT  )   AS ONE_WY_SAV_PFIT_ANAL_AMT   " ).append("\n"); 
		query.append("                  ,SUM(ONE_WY_SAV_RESPB_ANAL_AMT  )  AS ONE_WY_SAV_RESPB_ANAL_AMT   " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                  ,SUM(BUSINESS_ACTIVITY_COST      ) AS BUSINESS_ACTIVITY_COST" ).append("\n"); 
		query.append("                  ,SUM(GEN_EXPN                    ) AS GEN_EXPN " ).append("\n"); 
		query.append("                  ,SUM(INTERNAL_EXPN               ) AS INTERNAL_EXPN" ).append("\n"); 
		query.append("                  ,SUM(OP_COST) + SUM(GEN_EXPN) + SUM(INTERNAL_EXPN) AS OP_COST" ).append("\n"); 
		query.append("                  ,SUM(VSL_INT_EXP)                  AS VSL_INT_EXP" ).append("\n"); 
		query.append("              FROM (" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    SELECT V.COST_YRMON" ).append("\n"); 
		query.append("                          ,V.SLS_YRMON" ).append("\n"); 
		query.append("                          ,V.COST_WK         " ).append("\n"); 
		query.append("                          ,V.TRD_CD " ).append("\n"); 
		query.append("                          ,V.SUB_TRD_CD " ).append("\n"); 
		query.append("                          ,V.RLANE_CD " ).append("\n"); 
		query.append("                          ,V.IOC_CD " ).append("\n"); 
		query.append("                          ,V.VSL_CD " ).append("\n"); 
		query.append("                          ,V.SKD_VOY_NO " ).append("\n"); 
		query.append("                          ,V.DIR_CD " ).append("\n"); 
		query.append("                          ,R.HUL_BND_CD" ).append("\n"); 
		query.append("                          ,CR.STATUS" ).append("\n"); 
		query.append("                          ,COUNT(DISTINCT V.TRD_CD|| V.RLANE_CD || V.IOC_CD || V.VSL_CD || V.SKD_VOY_NO || V.DIR_CD)  AS VOYAGE" ).append("\n"); 
		query.append("                          ,SUM(DECODE(SUBSTR(A2.SPCL_CNTR_TPSZ_CD,-1),'2',A2.BKG_QTY,'3',A2.BKG_QTY,A2.BKG_QTY*2)) AS TOT_QTY " ).append("\n"); 
		query.append("                          ,SUM(A2.BKG_REV+A2.BKG_OFT_REV)      AS FREIGTH_REV " ).append("\n"); 
		query.append("                          ,SUM(A2.BKG_MISC_REV+A2.SCR_CHG_REV) AS MISC_REV " ).append("\n"); 
		query.append("                          ,0 AS SUPPLY" ).append("\n"); 
		query.append("                          ,0 AS SPC_CHTR      		" ).append("\n"); 
		query.append("                          ,SUM(A2.DMDT_COM_AMT)             AS DMDT_COST " ).append("\n"); 
		query.append("                          ,SUM(A2.BZC_STVG_COM_AMT)         AS BASIC_STEVEDORAGE " ).append("\n"); 
		query.append("                          ,SUM(A2.OTR_CY_HNDL_COM_AMT)      AS OTHER_CY_EXPENSE " ).append("\n"); 
		query.append("                          ,SUM(A2.TS_STVG_COM_AMT)          AS TS_STEVEDORAGE " ).append("\n"); 
		query.append("                          ,SUM(A2.DCK_CY_HNDL_COM_AMT)      AS ON_DOCK_CY_EXPENSE " ).append("\n"); 
		query.append("                          ,SUM(A2.CGO_HNDL_COM_AMT)         AS CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                          ,SUM(A2.FCNTR_STO_COM_AMT)        AS STORAGE " ).append("\n"); 
		query.append("                          ,SUM(A2.MISC_CGO_HNDL_COM_AMT)    AS MISC_CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                          ,SUM(A2.TML_COM_AMT)              AS EXCLUSIVE_TERMINAL_ADD_COST" ).append("\n"); 
		query.append("                          ,SUM(A2.CGO_VAR_VOL_DC_AMT)       AS CARGO_VARIABLE_VOLUME_DISCOUNT " ).append("\n"); 
		query.append("                          ,SUM(A2.FULL_RAIL_DIR_COM_AMT)    AS RAIL_DIRECT " ).append("\n"); 
		query.append("                          ,SUM(A2.FULL_RAIL_TRK_COM_AMT)    AS RAIL_TRUCK " ).append("\n"); 
		query.append("                          ,SUM(A2.FULL_TRK_DIR_COM_AMT)     AS TRUCK_DIRCET " ).append("\n"); 
		query.append("                          ,SUM(A2.FULL_WTR_DIR_COM_AMT)     AS WATER_DIRECT " ).append("\n"); 
		query.append("                          ,SUM(A2.FULL_WTR_RAIL_COM_AMT)    AS WATER_RAIL " ).append("\n"); 
		query.append("                          ,SUM(A2.FULL_WTR_TRK_COM_AMT)     AS WATER_TRUCK " ).append("\n"); 
		query.append("                          ,SUM(A2.FULL_TRSP_COM_AMT)        AS OTHER_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                          ,SUM(A2.CRR_HLG_SVC_CHG_AMT)      AS CARRIERS_HAULAGE_SVG_CHG" ).append("\n"); 
		query.append("                          		" ).append("\n"); 
		query.append("                          ,SUM(A2.MTY_STVG_PA_AMT)          AS EMPTY_TERMINAL_EXPENSE " ).append("\n"); 
		query.append("                          ,SUM(A2.MTY_TRSP_PA_AMT)          AS EMPTY_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                            		" ).append("\n"); 
		query.append("                          ,SUM(A2.AC_COM_AMT)               AS AGENT_COMMISSION " ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                          ,SUM(DECODE('P','P',A2.PA_CM_COST_TTL_AMT,'R',A2.RA_CM_COST_TTL_AMT))   AS CM_COST_TOTAL " ).append("\n"); 
		query.append("                          ,SUM(A2.BKG_REV+A2.BKG_OFT_REV) - SUM(DECODE('P','P',A2.PA_CM_COST_TTL_AMT,'R',A2.RA_CM_COST_TTL_AMT)) AS CM" ).append("\n"); 
		query.append("                          " ).append("\n"); 
		query.append("                          ,SUM(A2.USA_DMST_SAV_CR_AMT)       				   AS US_DOMESTIC_SAV_CREDIT" ).append("\n"); 
		query.append("                          ,SUM(A2.CNTR_STERM_RNTL_LAND_AMT )                             AS CNTR_STERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                          ,SUM(A2.CNTR_LTERM_RNTL_LAND_AMT )                             AS CNTR_LTERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                          ,SUM(A2.CNTR_MNR_LAND_AMT )                                    AS CNTR_MNR_LAND_AMT  " ).append("\n"); 
		query.append("                          ,SUM(A2.CNTR_DPC_LAND_AMT )                                    AS CNTR_DPC_LAND_AMT  " ).append("\n"); 
		query.append("                          ,SUM(A2.CNTR_INSUR_LAND_AMT )                                  AS CNTR_INSUR_LAND_AMT  " ).append("\n"); 
		query.append("                          " ).append("\n"); 
		query.append("                          ,SUM(A2.CNTR_STERM_RNTL_OTR_AMT )                              AS CNTR_STERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                          ,SUM(A2.CNTR_LTERM_RNTL_OTR_AMT )                              AS CNTR_LTERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                          ,SUM(A2.CNTR_MNR_OTR_AMT )                                     AS CNTR_MNR_OTR_AMT  " ).append("\n"); 
		query.append("                          ,SUM(A2.CNTR_DPC_OTR_AMT )                                     AS CNTR_DPC_OTR_AMT  " ).append("\n"); 
		query.append("                          ,SUM(A2.CNTR_INSUR_OTR_AMT  )                                  AS CNTR_INSUR_OTR_AMT   " ).append("\n"); 
		query.append("                          ,SUM(A2.CHSS_AMT )                                             AS CHSS_AMT  " ).append("\n"); 
		query.append("                          ,SUM(A2.ONE_WY_SAV_PFIT_ANAL_AMT  )                            AS ONE_WY_SAV_PFIT_ANAL_AMT   " ).append("\n"); 
		query.append("                          ,SUM(A2.ONE_WY_SAV_RESPB_ANAL_AMT  )                           AS ONE_WY_SAV_RESPB_ANAL_AMT   " ).append("\n"); 
		query.append("                          ,SUM(A2.BIZ_ACT_PA_AMT)                                           AS BUSINESS_ACTIVITY_COST " ).append("\n"); 
		query.append("                          ,0 AS OP_COST" ).append("\n"); 
		query.append("                          ,0 AS GEN_EXPN" ).append("\n"); 
		query.append("                          ,0 AS INTERNAL_EXPN" ).append("\n"); 
		query.append("                          ,0 AS VSL_INT_EXP" ).append("\n"); 
		query.append("                      FROM  MAS_BKG_EXPN_DTL_WK A2 " ).append("\n"); 
		query.append("                           ,MAS_MON_VVD V" ).append("\n"); 
		query.append("                           ,BKG_VVD B" ).append("\n"); 
		query.append("                           ,MAS_OFC_LVL A4" ).append("\n"); 
		query.append("                           ,MAS_LANE_RGST R" ).append("\n"); 
		query.append("                           ,COMM_RTO CR" ).append("\n"); 
		query.append("                      WHERE 1 = 1" ).append("\n"); 
		query.append("                        AND NVL(V.DELT_FLG,'N')   = 'N'" ).append("\n"); 
		query.append("                        AND V.VSL_CD = B.VSL_CD" ).append("\n"); 
		query.append("                        AND V.SKD_VOY_NO = B.SKD_VOY_NO" ).append("\n"); 
		query.append("                        AND V.DIR_CD = B.SKD_DIR_CD" ).append("\n"); 
		query.append("                        AND B.BKG_NO = A2.BKG_NO" ).append("\n"); 
		query.append("                          " ).append("\n"); 
		query.append("                        AND A2.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("                       " ).append("\n"); 
		query.append("                        AND A2.AGMT_SGN_OFC_CD = A4.OFC_CD" ).append("\n"); 
		query.append("                        AND NVL(A2.DELT_FLG, 'N') = 'N' " ).append("\n"); 
		query.append("                        AND A2.BKG_STS_CD    IN ('F','S') " ).append("\n"); 
		query.append("                        AND A2.BKG_CGO_TP_CD <> 'P' " ).append("\n"); 
		query.append("                        AND A2.BL_NO_TP      IN ('M','0')" ).append("\n"); 
		query.append("                       " ).append("\n"); 
		query.append("                        AND V.RLANE_CD = R.RLANE_CD" ).append("\n"); 
		query.append("                        AND V.DIR_CD = R.DIR_CD" ).append("\n"); 
		query.append("                        AND V.IOC_CD = R.IOC_CD" ).append("\n"); 
		query.append("                        AND V.TRD_CD = R.TRD_CD" ).append("\n"); 
		query.append("                        AND R.DELT_FLG = 'N' " ).append("\n"); 
		query.append("                        AND A4.OFC_LVL < '9'                            " ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("                        AND V.TRD_CD = CR.TRD_CD" ).append("\n"); 
		query.append("                        AND V.RLANE_CD = CR.RLANE_CD" ).append("\n"); 
		query.append("                        AND V.VSL_CD = CR.VSL_CD" ).append("\n"); 
		query.append("                        AND V.SKD_VOY_NO = CR.SKD_VOY_NO" ).append("\n"); 
		query.append("                        AND V.DIR_CD = CR.SKD_DIR_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                        AND V.RLANE_CD <> 'PSGIA' -- PSGIA 노선은 아래 쿼리에서 별도 처리" ).append("\n"); 
		query.append("                        " ).append("\n"); 
		query.append("                        AND CR.STATUS = DECODE(A2.TRD_CD, 'IAS', DECODE(A2.VSL_CD||A2.SKD_VOY_NO||A2.DIR_CD, V.VSL_CD||V.SKD_VOY_NO||V.DIR_CD, 'L/C', 'IAS T/S'), 'T/S')" ).append("\n"); 
		query.append("                       " ).append("\n"); 
		query.append("                       " ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("                        AND V.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   " ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("                        AND V.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    " ).append("\n"); 
		query.append("                        AND V.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   " ).append("\n"); 
		query.append("#end	" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("                        AND V.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("                        AND V.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("                        AND V.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("                        AND V.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("                        AND V.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("                        AND V.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("                        AND V.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("                        AND R.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("                        AND R.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("#end        			" ).append("\n"); 
		query.append("                     GROUP BY V.COST_YRMON" ).append("\n"); 
		query.append("                             ,V.SLS_YRMON" ).append("\n"); 
		query.append("                             ,V.COST_WK         " ).append("\n"); 
		query.append("                             ,V.TRD_CD " ).append("\n"); 
		query.append("                             ,V.SUB_TRD_CD " ).append("\n"); 
		query.append("                             ,V.RLANE_CD " ).append("\n"); 
		query.append("                             ,V.IOC_CD " ).append("\n"); 
		query.append("                             ,V.VSL_CD " ).append("\n"); 
		query.append("                             ,V.SKD_VOY_NO " ).append("\n"); 
		query.append("                             ,V.DIR_CD " ).append("\n"); 
		query.append("                             ,R.HUL_BND_CD" ).append("\n"); 
		query.append("                             ,CR.STATUS " ).append("\n"); 
		query.append("                            " ).append("\n"); 
		query.append("                    UNION ALL" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("-- PSGIA =======================================================================                    " ).append("\n"); 
		query.append("            SELECT COST_YRMON" ).append("\n"); 
		query.append("                  ,SLS_YRMON" ).append("\n"); 
		query.append("                  ,COST_WK         " ).append("\n"); 
		query.append("                  ,TRD_CD " ).append("\n"); 
		query.append("                  ,SUB_TRD_CD " ).append("\n"); 
		query.append("                  ,RLANE_CD " ).append("\n"); 
		query.append("                  ,IOC_CD " ).append("\n"); 
		query.append("                  ,VSL_CD " ).append("\n"); 
		query.append("                  ,SKD_VOY_NO " ).append("\n"); 
		query.append("                  ,DIR_CD " ).append("\n"); 
		query.append("                  ,HUL_BND_CD" ).append("\n"); 
		query.append("                  ,STATUS" ).append("\n"); 
		query.append("                  ,COUNT(DISTINCT VOYAGE)  AS VOYAGE" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, TOT_QTY                         ,0)) AS TOT_QTY" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, FREIGTH_REV                     ,0)) AS FREIGTH_REV" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, MISC_REV                        ,0)) AS MISC_REV" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, SUPPLY                          ,0)) AS SUPPLY" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, SPC_CHTR                        ,0)) AS SPC_CHTR" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, DMDT_COST                       ,0)) AS DMDT_COST" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, BASIC_STEVEDORAGE               ,0)) AS BASIC_STEVEDORAGE" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, OTHER_CY_EXPENSE                ,0)) AS OTHER_CY_EXPENSE" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, TS_STEVEDORAGE                  ,0)) AS TS_STEVEDORAGE" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, ON_DOCK_CY_EXPENSE              ,0)) AS ON_DOCK_CY_EXPENSE" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CARGO_HANDLING_EXPENSE          ,0)) AS CARGO_HANDLING_EXPENSE" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, STORAGE                         ,0)) AS STORAGE" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, MISC_CARGO_HANDLING_EXPENSE     ,0)) AS MISC_CARGO_HANDLING_EXPENSE" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, EXCLUSIVE_TERMINAL_ADD_COST     ,0)) AS EXCLUSIVE_TERMINAL_ADD_COST" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CARGO_VARIABLE_VOLUME_DISCOUNT  ,0)) AS CARGO_VARIABLE_VOLUME_DISCOUNT" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, RAIL_DIRECT                     ,0)) AS RAIL_DIRECT" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, RAIL_TRUCK                      ,0)) AS RAIL_TRUCK" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, TRUCK_DIRCET                    ,0)) AS TRUCK_DIRCET" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, WATER_DIRECT                    ,0)) AS WATER_DIRECT" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, WATER_RAIL                      ,0)) AS WATER_RAIL" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, WATER_TRUCK                     ,0)) AS WATER_TRUCK" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, OTHER_TRANSPORT_EXPENSE         ,0)) AS OTHER_TRANSPORT_EXPENSE" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CARRIERS_HAULAGE_SVG_CHG        ,0)) AS CARRIERS_HAULAGE_SVG_CHG" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, EMPTY_TERMINAL_EXPENSE          ,0)) AS EMPTY_TERMINAL_EXPENSE" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, EMPTY_TRANSPORT_EXPENSE         ,0)) AS EMPTY_TRANSPORT_EXPENSE" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, AGENT_COMMISSION                ,0)) AS AGENT_COMMISSION" ).append("\n"); 
		query.append("                  " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, DECODE('P','P',PA_CM_COST_TTL_AMT,'R',RA_CM_COST_TTL_AMT), 0))   AS CM_COST_TOTAL " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, BKG_REV+BKG_OFT_REV, 0)) " ).append("\n"); 
		query.append("                  - SUM(DECODE(STATUS, STATUS2, DECODE('P','P',PA_CM_COST_TTL_AMT,'R',RA_CM_COST_TTL_AMT), 0)) AS CM                   " ).append("\n"); 
		query.append("                           " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, US_DOMESTIC_SAV_CREDIT          ,0)) AS US_DOMESTIC_SAV_CREDIT" ).append("\n"); 
		query.append("                  " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CNTR_STERM_RNTL_LAND_AMT        ,0)) AS CNTR_STERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CNTR_LTERM_RNTL_LAND_AMT        ,0)) AS CNTR_LTERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CNTR_MNR_LAND_AMT               ,0)) AS CNTR_MNR_LAND_AMT  " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CNTR_DPC_LAND_AMT               ,0)) AS CNTR_DPC_LAND_AMT  " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CNTR_INSUR_LAND_AMT             ,0)) AS CNTR_INSUR_LAND_AMT  " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CNTR_STERM_RNTL_OTR_AMT         ,0)) AS CNTR_STERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CNTR_LTERM_RNTL_OTR_AMT         ,0)) AS CNTR_LTERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CNTR_MNR_OTR_AMT                ,0)) AS CNTR_MNR_OTR_AMT  " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CNTR_DPC_OTR_AMT                ,0)) AS CNTR_DPC_OTR_AMT  " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CNTR_INSUR_OTR_AMT              ,0)) AS CNTR_INSUR_OTR_AMT   " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, CHSS_AMT                        ,0)) AS CHSS_AMT  " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, ONE_WY_SAV_PFIT_ANAL_AMT        ,0)) AS ONE_WY_SAV_PFIT_ANAL_AMT   " ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, ONE_WY_SAV_RESPB_ANAL_AMT       ,0)) AS ONE_WY_SAV_RESPB_ANAL_AMT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, BUSINESS_ACTIVITY_COST          ,0)) AS BUSINESS_ACTIVITY_COST" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, OP_COST                         ,0)) AS OP_COST" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, GEN_EXPN                        ,0)) AS GEN_EXPN" ).append("\n"); 
		query.append("                  , SUM(DECODE(STATUS, STATUS2, INTERNAL_EXPN                   ,0)) AS INTERNAL_EXPN  " ).append("\n"); 
		query.append("                  ,0 AS VSL_INT_EXP" ).append("\n"); 
		query.append("                  " ).append("\n"); 
		query.append("               FROM (" ).append("\n"); 
		query.append("                                                          " ).append("\n"); 
		query.append("                            SELECT V.COST_YRMON" ).append("\n"); 
		query.append("                                  ,V.SLS_YRMON" ).append("\n"); 
		query.append("                                  ,V.COST_WK         " ).append("\n"); 
		query.append("                                  ,V.TRD_CD " ).append("\n"); 
		query.append("                                  ,V.SUB_TRD_CD " ).append("\n"); 
		query.append("                                  ,V.RLANE_CD " ).append("\n"); 
		query.append("                                  ,V.IOC_CD " ).append("\n"); 
		query.append("                                  ,V.VSL_CD " ).append("\n"); 
		query.append("                                  ,V.SKD_VOY_NO " ).append("\n"); 
		query.append("                                  ,V.DIR_CD " ).append("\n"); 
		query.append("                                  ,R.HUL_BND_CD" ).append("\n"); 
		query.append("                                  ,CR.STATUS" ).append("\n"); 
		query.append("                                  " ).append("\n"); 
		query.append("                                  , CASE WHEN A2.TRD_CD = 'IAS' AND A2.VSL_CD||A2.SKD_VOY_NO||A2.DIR_CD  = V.VSL_CD||V.SKD_VOY_NO||V.DIR_CD THEN 'L/C'" ).append("\n"); 
		query.append("                                         WHEN A2.TRD_CD = 'IAS' AND A2.VSL_CD||A2.SKD_VOY_NO||A2.DIR_CD <> V.VSL_CD||V.SKD_VOY_NO||V.DIR_CD THEN 'IAS T/S'" ).append("\n"); 
		query.append("                                         ELSE 'T/S' END STATUS2" ).append("\n"); 
		query.append("                                         " ).append("\n"); 
		query.append("                                  ,(V.TRD_CD|| V.RLANE_CD || V.IOC_CD || V.VSL_CD || V.SKD_VOY_NO || V.DIR_CD) AS VOYAGE" ).append("\n"); 
		query.append("                                  ,DECODE(SUBSTR(A2.SPCL_CNTR_TPSZ_CD,-1),'2',A2.BKG_QTY,'3',A2.BKG_QTY,A2.BKG_QTY*2)          AS TOT_QTY " ).append("\n"); 
		query.append("                                  ,(A2.BKG_REV+A2.BKG_OFT_REV)      AS FREIGTH_REV " ).append("\n"); 
		query.append("                                  ,(A2.BKG_MISC_REV+A2.SCR_CHG_REV) AS MISC_REV " ).append("\n"); 
		query.append("                                  ,0 AS SUPPLY" ).append("\n"); 
		query.append("                                  ,0 AS SPC_CHTR      		" ).append("\n"); 
		query.append("                                  ,A2.DMDT_COM_AMT             AS DMDT_COST " ).append("\n"); 
		query.append("                                  ,A2.BZC_STVG_COM_AMT         AS BASIC_STEVEDORAGE " ).append("\n"); 
		query.append("                                  ,A2.OTR_CY_HNDL_COM_AMT      AS OTHER_CY_EXPENSE " ).append("\n"); 
		query.append("                                  ,A2.TS_STVG_COM_AMT          AS TS_STEVEDORAGE " ).append("\n"); 
		query.append("                                  ,A2.DCK_CY_HNDL_COM_AMT      AS ON_DOCK_CY_EXPENSE " ).append("\n"); 
		query.append("                                  ,A2.CGO_HNDL_COM_AMT         AS CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                                  ,A2.FCNTR_STO_COM_AMT        AS STORAGE " ).append("\n"); 
		query.append("                                  ,A2.MISC_CGO_HNDL_COM_AMT    AS MISC_CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                                  ,A2.TML_COM_AMT              AS EXCLUSIVE_TERMINAL_ADD_COST" ).append("\n"); 
		query.append("                                  ,A2.CGO_VAR_VOL_DC_AMT       AS CARGO_VARIABLE_VOLUME_DISCOUNT " ).append("\n"); 
		query.append("                                  ,A2.FULL_RAIL_DIR_COM_AMT    AS RAIL_DIRECT " ).append("\n"); 
		query.append("                                  ,A2.FULL_RAIL_TRK_COM_AMT    AS RAIL_TRUCK " ).append("\n"); 
		query.append("                                  ,A2.FULL_TRK_DIR_COM_AMT     AS TRUCK_DIRCET " ).append("\n"); 
		query.append("                                  ,A2.FULL_WTR_DIR_COM_AMT     AS WATER_DIRECT " ).append("\n"); 
		query.append("                                  ,A2.FULL_WTR_RAIL_COM_AMT    AS WATER_RAIL " ).append("\n"); 
		query.append("                                  ,A2.FULL_WTR_TRK_COM_AMT     AS WATER_TRUCK " ).append("\n"); 
		query.append("                                  ,A2.FULL_TRSP_COM_AMT        AS OTHER_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                                  ,A2.CRR_HLG_SVC_CHG_AMT      AS CARRIERS_HAULAGE_SVG_CHG  " ).append("\n"); 
		query.append("                                                                  		" ).append("\n"); 
		query.append("                                  ,A2.MTY_STVG_PA_AMT          AS EMPTY_TERMINAL_EXPENSE " ).append("\n"); 
		query.append("                                  ,A2.MTY_STVG_PA_AMT          AS EMPTY_TRANSPORT_EXPENSE                                     		" ).append("\n"); 
		query.append("                                  ,A2.AC_COM_AMT               AS AGENT_COMMISSION                                 " ).append("\n"); 
		query.append("                                  " ).append("\n"); 
		query.append("                                  ,A2.USA_DMST_SAV_CR_AMT      AS US_DOMESTIC_SAV_CREDIT" ).append("\n"); 
		query.append("                                  ,(A2.CNTR_STERM_RNTL_LAND_AMT )                             AS CNTR_STERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                                  ,(A2.CNTR_LTERM_RNTL_LAND_AMT )                             AS CNTR_LTERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                                  ,(A2.CNTR_MNR_LAND_AMT )                                    AS CNTR_MNR_LAND_AMT  " ).append("\n"); 
		query.append("                                  ,(A2.CNTR_DPC_LAND_AMT )                                    AS CNTR_DPC_LAND_AMT  " ).append("\n"); 
		query.append("                                  ,(A2.CNTR_INSUR_LAND_AMT )                                  AS CNTR_INSUR_LAND_AMT  " ).append("\n"); 
		query.append("                                  " ).append("\n"); 
		query.append("                                  ,(A2.CNTR_STERM_RNTL_OTR_AMT )                              AS CNTR_STERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                                  ,(A2.CNTR_LTERM_RNTL_OTR_AMT )                              AS CNTR_LTERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                                  ,(A2.CNTR_MNR_OTR_AMT )                                     AS CNTR_MNR_OTR_AMT  " ).append("\n"); 
		query.append("                                  ,(A2.CNTR_DPC_OTR_AMT )                                     AS CNTR_DPC_OTR_AMT  " ).append("\n"); 
		query.append("                                  ,(A2.CNTR_INSUR_OTR_AMT  )                                  AS CNTR_INSUR_OTR_AMT   " ).append("\n"); 
		query.append("                                  ,(A2.CHSS_AMT )                                             AS CHSS_AMT  " ).append("\n"); 
		query.append("                                  ,(A2.ONE_WY_SAV_PFIT_ANAL_AMT  )                            AS ONE_WY_SAV_PFIT_ANAL_AMT   " ).append("\n"); 
		query.append("                                  ,(A2.ONE_WY_SAV_RESPB_ANAL_AMT  )                           AS ONE_WY_SAV_RESPB_ANAL_AMT   " ).append("\n"); 
		query.append("                                  ,A2.BIZ_ACT_PA_AMT           AS BUSINESS_ACTIVITY_COST " ).append("\n"); 
		query.append("                                  ,0 AS OP_COST" ).append("\n"); 
		query.append("                                  ,0 AS GEN_EXPN" ).append("\n"); 
		query.append("                                  ,0 AS INTERNAL_EXPN" ).append("\n"); 
		query.append("                                  " ).append("\n"); 
		query.append("                                  ,A2.PA_CM_COST_TTL_AMT" ).append("\n"); 
		query.append("                                  ,A2.RA_CM_COST_TTL_AMT" ).append("\n"); 
		query.append("                                  ,A2.MTY_STVG_PA_AMT" ).append("\n"); 
		query.append("                                  ,A2.MTY_TRSP_PA_AMT" ).append("\n"); 
		query.append("                                  ,A2.BKG_REV" ).append("\n"); 
		query.append("                                  ,A2.BKG_OFT_REV" ).append("\n"); 
		query.append("                                  ,A2.BKG_MISC_REV" ).append("\n"); 
		query.append("                                  ,A2.SCR_CHG_REV" ).append("\n"); 
		query.append("                                  , MAS_PSG_TS_ARRAY_FNC(" ).append("\n"); 
		query.append("                                        a2.n1st_trd_cd, DECODE (MAS_SLAN_CONTI_CONV_FNC(A2.n1st_finc_vvd_cd, SUBSTR(A2.N1ST_RLANE_CD, 1, 3), SUBSTR (A2.n1st_ioc_conti_cd, 1, 1)), MAS_SLAN_CONTI_CONV_FNC(A2.n1st_finc_vvd_cd, SUBSTR(A2.N1ST_RLANE_CD, 1, 3), SUBSTR (A2.n1st_ioc_conti_cd, 2, 1)), 'I', 'O'), A2.n1st_rlane_cd, SUBSTR (A2.n1st_finc_vvd_cd, 1, 9), A2.n1st_pol_cd, A2.n1st_pod_cd, --1" ).append("\n"); 
		query.append("                                        a2.n2nd_trd_cd, DECODE (MAS_SLAN_CONTI_CONV_FNC(A2.n2nd_finc_vvd_cd, SUBSTR(A2.N2nd_RLANE_CD, 1, 3), SUBSTR (A2.n2nd_ioc_conti_cd, 1, 1)), MAS_SLAN_CONTI_CONV_FNC(A2.n2nd_finc_vvd_cd, SUBSTR(A2.n2nd_RLANE_CD, 1, 3), SUBSTR (A2.n2nd_ioc_conti_cd, 2, 1)), 'I', 'O'), A2.n2nd_rlane_cd, SUBSTR (A2.n2nd_finc_vvd_cd, 1, 9), A2.n2nd_pol_cd, A2.n2nd_pod_cd, --2" ).append("\n"); 
		query.append("                                        a2.n3rd_trd_cd, DECODE (MAS_SLAN_CONTI_CONV_FNC(A2.n3rd_finc_vvd_cd, SUBSTR(A2.n3rd_RLANE_CD, 1, 3), SUBSTR (A2.n3rd_ioc_conti_cd, 1, 1)), MAS_SLAN_CONTI_CONV_FNC(A2.n3rd_finc_vvd_cd, SUBSTR(A2.n3rd_RLANE_CD, 1, 3), SUBSTR (A2.n3rd_ioc_conti_cd, 2, 1)), 'I', 'O'), A2.n3rd_rlane_cd, SUBSTR (A2.n3rd_finc_vvd_cd, 1, 9), A2.n3rd_pol_cd, A2.n3rd_pod_cd, --3" ).append("\n"); 
		query.append("                                        a2.n4th_trd_cd, DECODE (MAS_SLAN_CONTI_CONV_FNC(A2.n4th_finc_vvd_cd, SUBSTR(A2.n4th_RLANE_CD, 1, 3), SUBSTR (A2.n4th_ioc_conti_cd, 1, 1)), MAS_SLAN_CONTI_CONV_FNC(A2.n4th_finc_vvd_cd, SUBSTR(A2.n4th_RLANE_CD, 1, 3), SUBSTR (A2.n4th_ioc_conti_cd, 2, 1)), 'I', 'O'), A2.n4th_rlane_cd, SUBSTR (A2.n4th_finc_vvd_cd, 1, 9), A2.n4th_pol_cd, A2.n4th_pod_cd  --4" ).append("\n"); 
		query.append("                                        ) VVD_INFO" ).append("\n"); 
		query.append("                                  " ).append("\n"); 
		query.append("                              FROM  MAS_BKG_EXPN_DTL_WK A2 " ).append("\n"); 
		query.append("                                   ,MAS_MON_VVD V" ).append("\n"); 
		query.append("                                   ,BKG_VVD B" ).append("\n"); 
		query.append("                                   ,MAS_OFC_LVL A4" ).append("\n"); 
		query.append("                                   ,MAS_LANE_RGST R" ).append("\n"); 
		query.append("                                   ,COMM_RTO CR" ).append("\n"); 
		query.append("                              WHERE 1 = 1" ).append("\n"); 
		query.append("                                AND NVL(V.DELT_FLG,'N')   = 'N'" ).append("\n"); 
		query.append("                                AND V.VSL_CD = B.VSL_CD" ).append("\n"); 
		query.append("                                AND V.SKD_VOY_NO = B.SKD_VOY_NO" ).append("\n"); 
		query.append("                                AND V.DIR_CD = B.SKD_DIR_CD" ).append("\n"); 
		query.append("                                AND B.BKG_NO = A2.BKG_NO" ).append("\n"); 
		query.append("                                  " ).append("\n"); 
		query.append("                                AND A2.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("                               " ).append("\n"); 
		query.append("                                AND A2.AGMT_SGN_OFC_CD = A4.OFC_CD" ).append("\n"); 
		query.append("                                AND NVL(A2.DELT_FLG, 'N') = 'N' " ).append("\n"); 
		query.append("                                AND A2.BKG_STS_CD    IN ('F','S') " ).append("\n"); 
		query.append("                                AND A2.BKG_CGO_TP_CD <> 'P' " ).append("\n"); 
		query.append("                                AND A2.BL_NO_TP      IN ('M','0')" ).append("\n"); 
		query.append("                               " ).append("\n"); 
		query.append("                                AND V.RLANE_CD = R.RLANE_CD" ).append("\n"); 
		query.append("                                AND V.DIR_CD = R.DIR_CD" ).append("\n"); 
		query.append("                                AND V.IOC_CD = R.IOC_CD" ).append("\n"); 
		query.append("                                AND V.TRD_CD = R.TRD_CD" ).append("\n"); 
		query.append("                                AND R.DELT_FLG = 'N' " ).append("\n"); 
		query.append("                                AND A4.OFC_LVL < '9'                            " ).append("\n"); 
		query.append("                            " ).append("\n"); 
		query.append("                                AND V.TRD_CD = CR.TRD_CD" ).append("\n"); 
		query.append("                                AND V.RLANE_CD = CR.RLANE_CD" ).append("\n"); 
		query.append("                                AND V.VSL_CD = CR.VSL_CD" ).append("\n"); 
		query.append("                                AND V.SKD_VOY_NO = CR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                AND V.DIR_CD = CR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                " ).append("\n"); 
		query.append("                                AND V.RLANE_CD = 'PSGIA' -- PSGIA 노선만 해당됨." ).append("\n"); 
		query.append("                                " ).append("\n"); 
		query.append("                               " ).append("\n"); 
		query.append("        #if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("                                AND V.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   " ).append("\n"); 
		query.append("        #elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("                                AND V.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    " ).append("\n"); 
		query.append("                                AND V.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   " ).append("\n"); 
		query.append("        #end	" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        #if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("                                AND V.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        #if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("                                AND V.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        #if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("                                AND V.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        #if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("                                AND V.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        #if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("                                AND V.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        #if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("                                AND V.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        #if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("                                AND V.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        #if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("                                AND R.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        #if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("                                AND R.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("        #end       " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("                  WHERE TRD_CD||RLANE_CD IN ((SUBSTR(VVD_INFO, 1, 3)||SUBSTR(VVD_INFO, 5, 5)), (SUBSTR(VVD_INFO, 29, 3)||SUBSTR(VVD_INFO, 33, 5)), (SUBSTR(VVD_INFO, 57, 3)||SUBSTR(VVD_INFO, 61, 5)), (SUBSTR(VVD_INFO, 85, 3)||SUBSTR(VVD_INFO, 89, 5)), (SUBSTR(VVD_INFO, 113, 3)||SUBSTR(VVD_INFO, 117, 5)))" ).append("\n"); 
		query.append("                  GROUP BY COST_YRMON" ).append("\n"); 
		query.append("                          , SLS_YRMON" ).append("\n"); 
		query.append("                          , COST_WK" ).append("\n"); 
		query.append("                          , TRD_CD" ).append("\n"); 
		query.append("                          , SUB_TRD_CD" ).append("\n"); 
		query.append("                          , RLANE_CD" ).append("\n"); 
		query.append("                          , IOC_CD" ).append("\n"); 
		query.append("                          , VSL_CD" ).append("\n"); 
		query.append("                          , SKD_VOY_NO" ).append("\n"); 
		query.append("                          , DIR_CD" ).append("\n"); 
		query.append("                          , HUL_BND_CD" ).append("\n"); 
		query.append("                          , STATUS 			" ).append("\n"); 
		query.append("                                    " ).append("\n"); 
		query.append("                  UNION ALL                    " ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("-- PSGIA =======================================================================  " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    SELECT V.COST_YRMON" ).append("\n"); 
		query.append("                          ,V.SLS_YRMON" ).append("\n"); 
		query.append("                          ,V.COST_WK         " ).append("\n"); 
		query.append("                          ,V.TRD_CD " ).append("\n"); 
		query.append("                          ,V.SUB_TRD_CD " ).append("\n"); 
		query.append("                          ,V.RLANE_CD " ).append("\n"); 
		query.append("                          ,V.IOC_CD " ).append("\n"); 
		query.append("                          ,V.VSL_CD " ).append("\n"); 
		query.append("                          ,V.SKD_VOY_NO " ).append("\n"); 
		query.append("                          ,V.DIR_CD " ).append("\n"); 
		query.append("                          ,R.HUL_BND_CD" ).append("\n"); 
		query.append("                          ,CR.STATUS" ).append("\n"); 
		query.append("                          ,0 AS VOYAGE" ).append("\n"); 
		query.append("                          ,0 AS TOT_QTY " ).append("\n"); 
		query.append("                          ,0 AS FREIGTH_REV " ).append("\n"); 
		query.append("                          ,0 AS MISC_REV " ).append("\n"); 
		query.append("                          ,((FNL_HJS_BSA_CAPA) * CR.RTO) AS SUPPLY" ).append("\n"); 
		query.append("                          ,((NVL(INCM_BZC_CHTR_AMT, 0)+NVL(INCM_SUB_CHTR_AMT, 0)+NVL(INCM_CRS_CHTR_AMT, 0)) * CR.RTO) SPC_CHTR" ).append("\n"); 
		query.append("                          ,0 AS DMDT_COST                      " ).append("\n"); 
		query.append("                          ,0 AS BASIC_STEVEDORAGE " ).append("\n"); 
		query.append("                          ,0 AS OTHER_CY_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS TS_STEVEDORAGE " ).append("\n"); 
		query.append("                          ,0 AS ON_DOCK_CY_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS STORAGE " ).append("\n"); 
		query.append("                          ,0 AS MISC_CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS EXCLUSIVE_TERMINAL_ADD_COST " ).append("\n"); 
		query.append("                          ,0 AS CARGO_VARIABLE_VOLUME_DISCOUNT " ).append("\n"); 
		query.append("                          ,0 AS RAIL_DIRECT " ).append("\n"); 
		query.append("                          ,0 AS RAIL_TRUCK " ).append("\n"); 
		query.append("                          ,0 AS TRUCK_DIRCET " ).append("\n"); 
		query.append("                          ,0 AS WATER_DIRECT " ).append("\n"); 
		query.append("                          ,0 AS WATER_RAIL " ).append("\n"); 
		query.append("                          ,0 AS WATER_TRUCK " ).append("\n"); 
		query.append("                          ,0 AS OTHER_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS CARRIERS_HAULAGE_SVG_CHG" ).append("\n"); 
		query.append("                          ,0 AS EMPTY_TERMINAL_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS EMPTY_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS AGENT_COMMISSION " ).append("\n"); 
		query.append("                           " ).append("\n"); 
		query.append("                          ,0 AS CM_COST_TOTAL " ).append("\n"); 
		query.append("                          ,0 AS CM" ).append("\n"); 
		query.append("                          " ).append("\n"); 
		query.append("                          " ).append("\n"); 
		query.append("                          ,0 AS US_DOMESTIC_SAV_CREDIT" ).append("\n"); 
		query.append("                          ,0 AS CNTR_STERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_LTERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_MNR_LAND_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_DPC_LAND_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_INSUR_LAND_AMT  " ).append("\n"); 
		query.append("                          " ).append("\n"); 
		query.append("                          ,0 AS CNTR_STERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_LTERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_MNR_OTR_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_DPC_OTR_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_INSUR_OTR_AMT   " ).append("\n"); 
		query.append("                          ,0 AS CHSS_AMT  " ).append("\n"); 
		query.append("                          ,0 AS ONE_WY_SAV_PFIT_ANAL_AMT   " ).append("\n"); 
		query.append("                          ,0 AS ONE_WY_SAV_RESPB_ANAL_AMT   " ).append("\n"); 
		query.append("                          ,0 AS BUSINESS_ACTIVITY_COST" ).append("\n"); 
		query.append("                          ,0 AS OP_COST" ).append("\n"); 
		query.append("                          ,0 AS GEN_EXPN" ).append("\n"); 
		query.append("                          ,0 AS INTERNAL_EXPN" ).append("\n"); 
		query.append("                          ,0 AS VSL_INT_EXP" ).append("\n"); 
		query.append("                      FROM  MAS_MON_VVD V" ).append("\n"); 
		query.append("                           ,MAS_LANE_RGST R" ).append("\n"); 
		query.append("                           ,BSA_VVD_MST B" ).append("\n"); 
		query.append("                           ,COMM_RTO CR" ).append("\n"); 
		query.append("                      WHERE 1=1" ).append("\n"); 
		query.append("                        AND NVL(V.DELT_FLG,'N')   = 'N'" ).append("\n"); 
		query.append("                        AND V.RLANE_CD = R.RLANE_CD" ).append("\n"); 
		query.append("                        AND V.DIR_CD = R.DIR_CD" ).append("\n"); 
		query.append("                        AND V.IOC_CD = R.IOC_CD" ).append("\n"); 
		query.append("                        AND V.TRD_CD = R.TRD_CD" ).append("\n"); 
		query.append("                        AND R.DELT_FLG = 'N' 	" ).append("\n"); 
		query.append("                        AND V.TRD_CD = B.TRD_CD" ).append("\n"); 
		query.append("                        AND V.RLANE_CD = B.RLANE_CD" ).append("\n"); 
		query.append("                        AND V.VSL_CD = B.VSL_CD" ).append("\n"); 
		query.append("                        AND V.SKD_VOY_NO = B.SKD_VOY_NO" ).append("\n"); 
		query.append("                        AND V.DIR_CD = B.SKD_DIR_CD" ).append("\n"); 
		query.append("                        AND V.TRD_CD = CR.TRD_CD" ).append("\n"); 
		query.append("                        AND V.RLANE_CD = CR.RLANE_CD" ).append("\n"); 
		query.append("                        AND V.VSL_CD = CR.VSL_CD" ).append("\n"); 
		query.append("                        AND V.SKD_VOY_NO = CR.SKD_VOY_NO" ).append("\n"); 
		query.append("                        AND V.DIR_CD = CR.SKD_DIR_CD #if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("                        AND V.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   " ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("                        AND V.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    " ).append("\n"); 
		query.append("                        AND V.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   " ).append("\n"); 
		query.append("#end	" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("                        AND V.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("                        AND V.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("                        AND V.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("                        AND V.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("                        AND V.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("                        AND V.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("                        AND V.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("                        AND R.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("                        AND R.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("               " ).append("\n"); 
		query.append("                    -- OP COST TOTAL" ).append("\n"); 
		query.append("                    UNION ALL" ).append("\n"); 
		query.append("                    SELECT A1.COST_YRMON  " ).append("\n"); 
		query.append("                          ,A1.SLS_YRMON  " ).append("\n"); 
		query.append("                          ,A1.COST_WK" ).append("\n"); 
		query.append("                          ,A1.TRD_CD " ).append("\n"); 
		query.append("                          ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("                          ,A1.RLANE_CD " ).append("\n"); 
		query.append("                          ,A1.IOC_CD " ).append("\n"); 
		query.append("                          ,A1.VSL_CD " ).append("\n"); 
		query.append("                          ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("                          ,A1.DIR_CD " ).append("\n"); 
		query.append("                          ,L1.HUL_BND_CD" ).append("\n"); 
		query.append("                          ,R.STATUS" ).append("\n"); 
		query.append("                                              		" ).append("\n"); 
		query.append("                          ,0 AS VOYAGE" ).append("\n"); 
		query.append("                          ,0 AS TOT_QTY " ).append("\n"); 
		query.append("                          ,0 AS FREIGTH_REV " ).append("\n"); 
		query.append("                          ,0 AS MISC_REV " ).append("\n"); 
		query.append("                          ,0 AS SUPPLY" ).append("\n"); 
		query.append("                          ,0 SPC_CHTR" ).append("\n"); 
		query.append("                          ,0 AS DMDT_COST                      " ).append("\n"); 
		query.append("                          ,0 AS BASIC_STEVEDORAGE " ).append("\n"); 
		query.append("                          ,0 AS OTHER_CY_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS TS_STEVEDORAGE " ).append("\n"); 
		query.append("                          ,0 AS ON_DOCK_CY_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS STORAGE " ).append("\n"); 
		query.append("                          ,0 AS MISC_CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS EXCLUSIVE_TERMINAL_ADD_COST " ).append("\n"); 
		query.append("                          ,0 AS CARGO_VARIABLE_VOLUME_DISCOUNT " ).append("\n"); 
		query.append("                          ,0 AS RAIL_DIRECT " ).append("\n"); 
		query.append("                          ,0 AS RAIL_TRUCK " ).append("\n"); 
		query.append("                          ,0 AS TRUCK_DIRCET " ).append("\n"); 
		query.append("                          ,0 AS WATER_DIRECT " ).append("\n"); 
		query.append("                          ,0 AS WATER_RAIL " ).append("\n"); 
		query.append("                          ,0 AS WATER_TRUCK " ).append("\n"); 
		query.append("                          ,0 AS OTHER_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS CARRIERS_HAULAGE_SVG_CHG" ).append("\n"); 
		query.append("                          ,0 AS EMPTY_TERMINAL_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS EMPTY_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                          ,0 AS AGENT_COMMISSION " ).append("\n"); 
		query.append("                           " ).append("\n"); 
		query.append("                          ,0 AS CM_COST_TOTAL " ).append("\n"); 
		query.append("                          ,0 AS CM" ).append("\n"); 
		query.append("                          " ).append("\n"); 
		query.append("                          " ).append("\n"); 
		query.append("                          ,0 AS US_DOMESTIC_SAV_CREDIT" ).append("\n"); 
		query.append("                          ,0 AS CNTR_STERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_LTERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_MNR_LAND_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_DPC_LAND_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_INSUR_LAND_AMT  " ).append("\n"); 
		query.append("                          " ).append("\n"); 
		query.append("                          ,0 AS CNTR_STERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_LTERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_MNR_OTR_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_DPC_OTR_AMT  " ).append("\n"); 
		query.append("                          ,0 AS CNTR_INSUR_OTR_AMT   " ).append("\n"); 
		query.append("                          ,0 AS CHSS_AMT  " ).append("\n"); 
		query.append("                          ,0 AS ONE_WY_SAV_PFIT_ANAL_AMT   " ).append("\n"); 
		query.append("                          ,0 AS ONE_WY_SAV_RESPB_ANAL_AMT   " ).append("\n"); 
		query.append("                          ,0 AS BUSINESS_ACTIVITY_COST" ).append("\n"); 
		query.append("                          " ).append("\n"); 
		query.append("                          ,SUM(NTWK_HIR_COST_AMT) * MAX(NVL(R.RTO, 0)) AS OP_COST" ).append("\n"); 
		query.append("                          ,0 AS GEN_EXPN" ).append("\n"); 
		query.append("                          ,0 AS INTERNAL_EXPN" ).append("\n"); 
		query.append("                          ,SUM(DECODE(A2.STND_COST_CD,'72100000',NTWK_HIR_COST_AMT,0)) AS VSL_INT_EXP" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                      FROM MAS_MON_VVD A1 " ).append("\n"); 
		query.append("                          ,MAS_VVD_HIR A2 " ).append("\n"); 
		query.append("                          ,MAS_LANE_RGST L1" ).append("\n"); 
		query.append("                          ,COMM_RTO R" ).append("\n"); 
		query.append("                      WHERE A1.VSL_CD       = A2.VSL_CD " ).append("\n"); 
		query.append("                        AND A1.SKD_VOY_NO   = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("                        AND A1.DIR_CD       = A2.DIR_CD " ).append("\n"); 
		query.append("                        AND A1.TRD_CD       = A2.TRD_CD " ).append("\n"); 
		query.append("                        AND A1.RLANE_CD     = A2.RLANE_CD " ).append("\n"); 
		query.append("                        AND A1.IOC_CD       = A2.IOC_CD " ).append("\n"); 
		query.append("                        " ).append("\n"); 
		query.append("                        AND A1.RLANE_CD = L1.RLANE_CD" ).append("\n"); 
		query.append("                        AND A1.DIR_CD = L1.DIR_CD" ).append("\n"); 
		query.append("                        AND A1.TRD_CD = L1.TRD_CD" ).append("\n"); 
		query.append("                        AND A1.IOC_CD = L1.IOC_CD" ).append("\n"); 
		query.append("                        AND A1.DELT_FLG     <> 'Y'" ).append("\n"); 
		query.append("                        			" ).append("\n"); 
		query.append("                        AND A1.VSL_CD       = R.VSL_CD " ).append("\n"); 
		query.append("                        AND A1.SKD_VOY_NO   = R.SKD_VOY_NO " ).append("\n"); 
		query.append("                        AND A1.DIR_CD       = R.SKD_DIR_CD " ).append("\n"); 
		query.append("                        AND A1.TRD_CD       = R.TRD_CD " ).append("\n"); 
		query.append("                        AND A1.RLANE_CD     = R.RLANE_CD " ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("                        AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   " ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("                        AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    " ).append("\n"); 
		query.append("                        AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   " ).append("\n"); 
		query.append("#end	" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("                        AND A1.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("                        AND A1.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("                        AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("                        AND L1.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                      GROUP BY  " ).append("\n"); 
		query.append("                               A1.COST_YRMON " ).append("\n"); 
		query.append("                              ,A1.SLS_YRMON " ).append("\n"); 
		query.append("                              ,A1.COST_WK " ).append("\n"); 
		query.append("                              ,A1.TRD_CD " ).append("\n"); 
		query.append("                              ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("                              ,A1.RLANE_CD " ).append("\n"); 
		query.append("                              ,A1.IOC_CD " ).append("\n"); 
		query.append("                              ,A1.VSL_CD " ).append("\n"); 
		query.append("                              ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("                              ,A1.DIR_CD " ).append("\n"); 
		query.append("                              ,L1.HUL_BND_CD" ).append("\n"); 
		query.append("                              ,R.STATUS  " ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("                      UNION ALL     " ).append("\n"); 
		query.append("                     /* General Expense */" ).append("\n"); 
		query.append("                     SELECT  A1.COST_YRMON  " ).append("\n"); 
		query.append("                            ,A1.SLS_YRMON  " ).append("\n"); 
		query.append("                            ,A1.COST_WK" ).append("\n"); 
		query.append("                            ,A1.TRD_CD " ).append("\n"); 
		query.append("                            ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("                            ,A1.RLANE_CD " ).append("\n"); 
		query.append("                            ,A1.IOC_CD " ).append("\n"); 
		query.append("                            ,A1.VSL_CD " ).append("\n"); 
		query.append("                            ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("                            ,A1.DIR_CD " ).append("\n"); 
		query.append("                            ,L1.HUL_BND_CD" ).append("\n"); 
		query.append("                            ,R.STATUS                                                		" ).append("\n"); 
		query.append("                            ,0 AS VOYAGE" ).append("\n"); 
		query.append("                            ,0 AS TOT_QTY " ).append("\n"); 
		query.append("                            ,0 AS FREIGTH_REV " ).append("\n"); 
		query.append("                            ,0 AS MISC_REV " ).append("\n"); 
		query.append("                            ,0 AS SUPPLY" ).append("\n"); 
		query.append("                            ,0 SPC_CHTR" ).append("\n"); 
		query.append("                            ,0 AS DMDT_COST                      " ).append("\n"); 
		query.append("                            ,0 AS BASIC_STEVEDORAGE " ).append("\n"); 
		query.append("                            ,0 AS OTHER_CY_EXPENSE " ).append("\n"); 
		query.append("                            ,0 AS TS_STEVEDORAGE " ).append("\n"); 
		query.append("                            ,0 AS ON_DOCK_CY_EXPENSE " ).append("\n"); 
		query.append("                            ,0 AS CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                            ,0 AS STORAGE " ).append("\n"); 
		query.append("                            ,0 AS MISC_CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                            ,0 AS EXCLUSIVE_TERMINAL_ADD_COST " ).append("\n"); 
		query.append("                            ,0 AS CARGO_VARIABLE_VOLUME_DISCOUNT " ).append("\n"); 
		query.append("                            ,0 AS RAIL_DIRECT " ).append("\n"); 
		query.append("                            ,0 AS RAIL_TRUCK " ).append("\n"); 
		query.append("                            ,0 AS TRUCK_DIRCET " ).append("\n"); 
		query.append("                            ,0 AS WATER_DIRECT " ).append("\n"); 
		query.append("                            ,0 AS WATER_RAIL " ).append("\n"); 
		query.append("                            ,0 AS WATER_TRUCK " ).append("\n"); 
		query.append("                            ,0 AS OTHER_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                            ,0 AS CARRIERS_HAULAGE_SVG_CHG" ).append("\n"); 
		query.append("                            ,0 AS EMPTY_TERMINAL_EXPENSE " ).append("\n"); 
		query.append("                            ,0 AS EMPTY_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                            ,0 AS AGENT_COMMISSION                              " ).append("\n"); 
		query.append("                            ,0 AS CM_COST_TOTAL " ).append("\n"); 
		query.append("                            ,0 AS CM " ).append("\n"); 
		query.append("                            ,0 AS US_DOMESTIC_SAV_CREDIT" ).append("\n"); 
		query.append("                            ,0 AS CNTR_STERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_LTERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_MNR_LAND_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_DPC_LAND_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_INSUR_LAND_AMT  " ).append("\n"); 
		query.append("                            " ).append("\n"); 
		query.append("                            ,0 AS CNTR_STERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_LTERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_MNR_OTR_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_DPC_OTR_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_INSUR_OTR_AMT   " ).append("\n"); 
		query.append("                            ,0 AS CHSS_AMT  " ).append("\n"); 
		query.append("                            ,0 AS ONE_WY_SAV_PFIT_ANAL_AMT   " ).append("\n"); 
		query.append("                            ,0 AS ONE_WY_SAV_RESPB_ANAL_AMT   " ).append("\n"); 
		query.append("                            ,0 AS BUSINESS_ACTIVITY_COST                          " ).append("\n"); 
		query.append("                            ,0 AS OP_COST" ).append("\n"); 
		query.append("                            ,SUM(DECODE(A3.STND_COST_CD, '65010001', DECODE (@[f_pro_vw], 'P', A2.ESTM_PL_AMT, 'R', A2.RA_PL_AMT), 0)) * MAX(NVL(R.RTO, 0)) AS GEN_EXPN" ).append("\n"); 
		query.append("                            ,0 AS INTERNAL_EXPN" ).append("\n"); 
		query.append("                            ,0 AS VSL_INT_EXP" ).append("\n"); 
		query.append("                       FROM MAS_MON_VVD A1 " ).append("\n"); 
		query.append("                           ,MAS_PFIT_LSS_GEN_EXPN A2 " ).append("\n"); 
		query.append("                           ,MAS_PFIT_LSS_RPT_ITM A3 " ).append("\n"); 
		query.append("                           ,MAS_OFC_LVL A4 " ).append("\n"); 
		query.append("                           ,MAS_LANE_RGST L1" ).append("\n"); 
		query.append("                           ,COMM_RTO R" ).append("\n"); 
		query.append("                      WHERE A1.VSL_CD        = A2.VSL_CD " ).append("\n"); 
		query.append("                        AND A1.SKD_VOY_NO    = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("                        AND A1.DIR_CD        = A2.SKD_DIR_CD " ).append("\n"); 
		query.append("                        AND A1.TRD_CD        = A2.TRD_CD " ).append("\n"); 
		query.append("                        AND A1.RLANE_CD      = A2.RLANE_CD " ).append("\n"); 
		query.append("                        AND A1.IOC_CD        = A2.IOC_CD " ).append("\n"); 
		query.append("                      " ).append("\n"); 
		query.append("                        AND A1.RLANE_CD      = L1.RLANE_CD" ).append("\n"); 
		query.append("                        AND A1.DIR_CD        = L1.DIR_CD" ).append("\n"); 
		query.append("                        AND A1.TRD_CD        = L1.TRD_CD" ).append("\n"); 
		query.append("                        AND A1.IOC_CD        = L1.IOC_CD" ).append("\n"); 
		query.append("                        			" ).append("\n"); 
		query.append("                        AND A1.VSL_CD       = R.VSL_CD " ).append("\n"); 
		query.append("                        AND A1.SKD_VOY_NO   = R.SKD_VOY_NO " ).append("\n"); 
		query.append("                        AND A1.DIR_CD       = R.SKD_DIR_CD " ).append("\n"); 
		query.append("                        AND A1.TRD_CD       = R.TRD_CD " ).append("\n"); 
		query.append("                        AND A1.RLANE_CD     = R.RLANE_CD " ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("                        AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("                        AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("#end /*ofc_월별 관리*/" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("                        AND A2.STND_COST_CD  = '65010001' " ).append("\n"); 
		query.append("                        AND A2.STND_COST_CD  = A3.STND_COST_CD " ).append("\n"); 
		query.append("                        AND A1.DELT_FLG      <> 'Y' " ).append("\n"); 
		query.append("                        AND A2.OFC_VW_CD     = @[f_ofc_vw] /* Office view code 별로 expense 관리 */" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("                        AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] " ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("                        AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'  " ).append("\n"); 
		query.append("                        AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("                        AND A1.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("                        AND A1.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end           " ).append("\n"); 
		query.append("#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("                        AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("                        AND L1.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("#end		" ).append("\n"); 
		query.append("								" ).append("\n"); 
		query.append("                        AND A3.RPT_VW_CD     = @[f_pro_vw]  " ).append("\n"); 
		query.append("                        AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD  " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_ofc_cd} !='')" ).append("\n"); 
		query.append("	#if(${f_excl_sts} =='')" ).append("\n"); 
		query.append("                        AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  " ).append("\n"); 
		query.append("	#else" ).append("\n"); 
		query.append("                        AND A4.OFC_CD  = @[f_ofc_cd]  " ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("                        AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL " ).append("\n"); 
		query.append("                        AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD" ).append("\n"); 
		query.append("                        			            ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("                        				                                                                                        , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("                        				                                                                                        , DECODE(A4.OFC_N4TH_LVL_CD, 'SZPDC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */" ).append("\n"); 
		query.append("                        			            ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')" ).append("\n"); 
		query.append("                        AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */" ).append("\n"); 
		query.append("                             OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) " ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("                        AND A3.STND_COST_TP_CD IN ('S','C','O')  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                      GROUP BY  " ).append("\n"); 
		query.append("                            A1.COST_YRMON " ).append("\n"); 
		query.append("                           ,A1.SLS_YRMON " ).append("\n"); 
		query.append("                           ,A1.COST_WK " ).append("\n"); 
		query.append("                           ,A1.TRD_CD " ).append("\n"); 
		query.append("                           ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("                           ,A1.RLANE_CD " ).append("\n"); 
		query.append("                           ,A1.IOC_CD " ).append("\n"); 
		query.append("                           ,A1.VSL_CD " ).append("\n"); 
		query.append("                           ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("                           ,A1.DIR_CD " ).append("\n"); 
		query.append("                           ,L1.HUL_BND_CD" ).append("\n"); 
		query.append("                           ,R.STATUS " ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("                      UNION ALL" ).append("\n"); 
		query.append("                      /* Internal Expense */ " ).append("\n"); 
		query.append("                     SELECT  /*+ ORDERED */ " ).append("\n"); 
		query.append("                            A1.COST_YRMON  " ).append("\n"); 
		query.append("                           ,A1.SLS_YRMON  " ).append("\n"); 
		query.append("                           ,A1.COST_WK" ).append("\n"); 
		query.append("                           ,A1.TRD_CD " ).append("\n"); 
		query.append("                           ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("                           ,A1.RLANE_CD " ).append("\n"); 
		query.append("                           ,A1.IOC_CD " ).append("\n"); 
		query.append("                           ,A1.VSL_CD " ).append("\n"); 
		query.append("                           ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("                           ,A1.DIR_CD " ).append("\n"); 
		query.append("                           ,L1.HUL_BND_CD" ).append("\n"); 
		query.append("                           ,R.STATUS" ).append("\n"); 
		query.append("                                               		" ).append("\n"); 
		query.append("                           ,0 AS VOYAGE" ).append("\n"); 
		query.append("                           ,0 AS TOT_QTY " ).append("\n"); 
		query.append("                           ,0 AS FREIGTH_REV " ).append("\n"); 
		query.append("                           ,0 AS MISC_REV " ).append("\n"); 
		query.append("                           ,0 AS SUPPLY" ).append("\n"); 
		query.append("                           ,0 SPC_CHTR" ).append("\n"); 
		query.append("                           ,0 AS DMDT_COST                      " ).append("\n"); 
		query.append("                           ,0 AS BASIC_STEVEDORAGE " ).append("\n"); 
		query.append("                           ,0 AS OTHER_CY_EXPENSE " ).append("\n"); 
		query.append("                           ,0 AS TS_STEVEDORAGE " ).append("\n"); 
		query.append("                           ,0 AS ON_DOCK_CY_EXPENSE " ).append("\n"); 
		query.append("                           ,0 AS CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                           ,0 AS STORAGE " ).append("\n"); 
		query.append("                           ,0 AS MISC_CARGO_HANDLING_EXPENSE " ).append("\n"); 
		query.append("                           ,0 AS EXCLUSIVE_TERMINAL_ADD_COST" ).append("\n"); 
		query.append("                           ,0 AS CARGO_VARIABLE_VOLUME_DISCOUNT " ).append("\n"); 
		query.append("                           ,0 AS RAIL_DIRECT " ).append("\n"); 
		query.append("                           ,0 AS RAIL_TRUCK " ).append("\n"); 
		query.append("                           ,0 AS TRUCK_DIRCET " ).append("\n"); 
		query.append("                           ,0 AS WATER_DIRECT " ).append("\n"); 
		query.append("                           ,0 AS WATER_RAIL " ).append("\n"); 
		query.append("                           ,0 AS WATER_TRUCK " ).append("\n"); 
		query.append("                           ,0 AS OTHER_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                           ,0 AS CARRIERS_HAULAGE_SVG_CHG" ).append("\n"); 
		query.append("                           ,0 AS EMPTY_TERMINAL_EXPENSE " ).append("\n"); 
		query.append("                           ,0 AS EMPTY_TRANSPORT_EXPENSE " ).append("\n"); 
		query.append("                           ,0 AS AGENT_COMMISSION                             " ).append("\n"); 
		query.append("                           ,0 AS CM_COST_TOTAL " ).append("\n"); 
		query.append("                           ,0 AS CM" ).append("\n"); 
		query.append("                           " ).append("\n"); 
		query.append("                           " ).append("\n"); 
		query.append("                           ,0 AS US_DOMESTIC_SAV_CREDIT" ).append("\n"); 
		query.append("                           ,0 AS CNTR_STERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_LTERM_RNTL_LAND_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_MNR_LAND_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_DPC_LAND_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_INSUR_LAND_AMT  " ).append("\n"); 
		query.append("                            " ).append("\n"); 
		query.append("                            ,0 AS CNTR_STERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_LTERM_RNTL_OTR_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_MNR_OTR_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_DPC_OTR_AMT  " ).append("\n"); 
		query.append("                            ,0 AS CNTR_INSUR_OTR_AMT   " ).append("\n"); 
		query.append("                            ,0 AS CHSS_AMT  " ).append("\n"); 
		query.append("                            ,0 AS ONE_WY_SAV_PFIT_ANAL_AMT   " ).append("\n"); 
		query.append("                            ,0 AS ONE_WY_SAV_RESPB_ANAL_AMT   " ).append("\n"); 
		query.append("                           ,0 AS BUSINESS_ACTIVITY_COST                          " ).append("\n"); 
		query.append("                           ,0 AS OP_COST" ).append("\n"); 
		query.append("                           ,0 AS GEN_EXPN" ).append("\n"); 
		query.append("                           ,SUM (DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("                                                 ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz]" ).append("\n"); 
		query.append("                                                              , 'O|CHT', A2.N5TH_CO_AMT" ).append("\n"); 
		query.append("                                                              , 'O|BIZ', A2.N5TH_HJS_SLS_AMT" ).append("\n"); 
		query.append("                                                              , A2.N5TH_ESTM_PL_AMT)" ).append("\n"); 
		query.append("                                       	         ,'R', A2.RA_PL_AMT)) * MAX(NVL(R.RTO, 0)) AS INTERNAL_EXPN" ).append("\n"); 
		query.append("                          ,0 AS VSL_INT_EXP" ).append("\n"); 
		query.append("                       FROM MAS_MON_VVD A1 " ).append("\n"); 
		query.append("                           ,MAS_PFIT_LSS_SMRY A2 " ).append("\n"); 
		query.append("                           ,MAS_PFIT_LSS_RPT_ITM A3 " ).append("\n"); 
		query.append("                           ,MAS_OFC_LVL A4 " ).append("\n"); 
		query.append("                           ,MAS_LANE_RGST L1" ).append("\n"); 
		query.append("                           ,COMM_RTO R" ).append("\n"); 
		query.append("                      WHERE A1.VSL_CD        = A2.VSL_CD " ).append("\n"); 
		query.append("                        AND A1.SKD_VOY_NO    = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("                        AND A1.DIR_CD        = A2.SKD_DIR_CD " ).append("\n"); 
		query.append("                        AND A1.TRD_CD        = A2.TRD_CD " ).append("\n"); 
		query.append("                        AND A1.RLANE_CD      = A2.RLANE_CD " ).append("\n"); 
		query.append("                        AND A1.IOC_CD        = A2.IOC_CD " ).append("\n"); 
		query.append("                        " ).append("\n"); 
		query.append("                        AND A1.RLANE_CD = L1.RLANE_CD" ).append("\n"); 
		query.append("                        AND A1.DIR_CD = L1.DIR_CD" ).append("\n"); 
		query.append("                        AND A1.TRD_CD = L1.TRD_CD" ).append("\n"); 
		query.append("                        AND A1.IOC_CD = L1.IOC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                        AND A1.VSL_CD       = R.VSL_CD " ).append("\n"); 
		query.append("                        AND A1.SKD_VOY_NO   = R.SKD_VOY_NO " ).append("\n"); 
		query.append("                        AND A1.DIR_CD       = R.SKD_DIR_CD " ).append("\n"); 
		query.append("                        AND A1.TRD_CD       = R.TRD_CD " ).append("\n"); 
		query.append("                        AND A1.RLANE_CD     = R.RLANE_CD" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("                        AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("                        AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("#end /*ofc_월별 관리*/" ).append("\n"); 
		query.append("    		" ).append("\n"); 
		query.append("                        AND A2.STND_COST_CD  = '54600000'" ).append("\n"); 
		query.append("                        AND A2.STND_COST_CD  = A3.STND_COST_CD " ).append("\n"); 
		query.append("                        AND A1.DELT_FLG      <> 'Y' " ).append("\n"); 
		query.append("    				" ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("                        AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] " ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("                        AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'  " ).append("\n"); 
		query.append("                        AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    				" ).append("\n"); 
		query.append("#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("                        AND A1.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("                        AND A1.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("                        AND A1.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("                        AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("                        AND L1.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    		" ).append("\n"); 
		query.append("                        AND A3.RPT_VW_CD     = @[f_pro_vw]" ).append("\n"); 
		query.append("                        AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD  " ).append("\n"); 
		query.append("    				" ).append("\n"); 
		query.append("#if(${f_ofc_cd} !='')" ).append("\n"); 
		query.append("   #if(${f_excl_sts} =='')" ).append("\n"); 
		query.append("                        /*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '') */" ).append("\n"); 
		query.append("                        AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  " ).append("\n"); 
		query.append("   #else" ).append("\n"); 
		query.append("                        AND A4.OFC_CD  = @[f_ofc_cd]  " ).append("\n"); 
		query.append("   #end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("                        /*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/" ).append("\n"); 
		query.append("                        AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL " ).append("\n"); 
		query.append("                        AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD" ).append("\n"); 
		query.append("    					                        ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("    					                                                                                                        , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("    					                                                                                                        , DECODE(A4.OFC_N4TH_LVL_CD, 'SZPDC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */" ).append("\n"); 
		query.append("    					                        ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    				" ).append("\n"); 
		query.append("#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')" ).append("\n"); 
		query.append("                        AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */" ).append("\n"); 
		query.append("                             OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) " ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("                        AND A3.STND_COST_TP_CD IN ('S','C','O')  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                      GROUP BY  " ).append("\n"); 
		query.append("                            A1.COST_YRMON " ).append("\n"); 
		query.append("                           ,A1.SLS_YRMON " ).append("\n"); 
		query.append("                           ,A1.COST_WK " ).append("\n"); 
		query.append("                           ,A1.TRD_CD " ).append("\n"); 
		query.append("                           ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("                           ,A1.RLANE_CD " ).append("\n"); 
		query.append("                           ,A1.IOC_CD " ).append("\n"); 
		query.append("                           ,A1.VSL_CD " ).append("\n"); 
		query.append("                           ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("                           ,A1.DIR_CD " ).append("\n"); 
		query.append("                           ,L1.HUL_BND_CD" ).append("\n"); 
		query.append("                           ,R.STATUS " ).append("\n"); 
		query.append("                    )" ).append("\n"); 
		query.append("             GROUP BY  COST_YRMON" ).append("\n"); 
		query.append("                      ,SLS_YRMON" ).append("\n"); 
		query.append("                      ,COST_WK" ).append("\n"); 
		query.append("                      ,TRD_CD" ).append("\n"); 
		query.append("                      ,SUB_TRD_CD" ).append("\n"); 
		query.append("                      ,RLANE_CD" ).append("\n"); 
		query.append("                      ,IOC_CD       " ).append("\n"); 
		query.append("                      ,VSL_CD " ).append("\n"); 
		query.append("                      ,SKD_VOY_NO " ).append("\n"); 
		query.append("                      ,DIR_CD " ).append("\n"); 
		query.append("                      ,HUL_BND_CD" ).append("\n"); 
		query.append("                      ,STATUS " ).append("\n"); 
		query.append("               ) B1 " ).append("\n"); 
		query.append("            	, (SELECT CPY_NO AS RNUM " ).append("\n"); 
		query.append("            	     FROM COM_CPY_NO " ).append("\n"); 
		query.append("                     WHERE CPY_NO BETWEEN 1 AND 59" ).append("\n"); 
		query.append("               ) B2" ).append("\n"); 
		query.append("               " ).append("\n"); 
		query.append("    -- 계정별 OP COST" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT A1.COST_YRMON  " ).append("\n"); 
		query.append("    		,A1.SLS_YRMON  " ).append("\n"); 
		query.append("    		,A1.COST_WK" ).append("\n"); 
		query.append("    		,A1.TRD_CD " ).append("\n"); 
		query.append("    		,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("    		,A1.RLANE_CD " ).append("\n"); 
		query.append("    		,A1.IOC_CD " ).append("\n"); 
		query.append("    		,A1.VSL_CD " ).append("\n"); 
		query.append("    		,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("    		,A1.DIR_CD " ).append("\n"); 
		query.append("    		,L1.HUL_BND_CD" ).append("\n"); 
		query.append("    		,R.STATUS" ).append("\n"); 
		query.append("    		,A2.STND_COST_CD" ).append("\n"); 
		query.append("    --		,MAX(NVL(R.RTO, 1)) RTO" ).append("\n"); 
		query.append("    		,SUM(NTWK_HIR_COST_AMT) * MAX(NVL(R.RTO, 0)) AS AMT" ).append("\n"); 
		query.append("      FROM MAS_MON_VVD A1 " ).append("\n"); 
		query.append("           ,MAS_VVD_HIR A2 " ).append("\n"); 
		query.append("    	   ,MAS_LANE_RGST L1" ).append("\n"); 
		query.append("    	   ,COMM_RTO R" ).append("\n"); 
		query.append("      WHERE A1.VSL_CD       = A2.VSL_CD " ).append("\n"); 
		query.append("        AND A1.SKD_VOY_NO   = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("        AND A1.DIR_CD       = A2.DIR_CD " ).append("\n"); 
		query.append("        AND A1.TRD_CD       = A2.TRD_CD " ).append("\n"); 
		query.append("        AND A1.RLANE_CD     = A2.RLANE_CD " ).append("\n"); 
		query.append("        AND A1.IOC_CD       = A2.IOC_CD " ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("        AND A1.RLANE_CD = L1.RLANE_CD" ).append("\n"); 
		query.append("        AND A1.DIR_CD = L1.DIR_CD" ).append("\n"); 
		query.append("        AND A1.TRD_CD = L1.TRD_CD" ).append("\n"); 
		query.append("        AND A1.IOC_CD = L1.IOC_CD" ).append("\n"); 
		query.append("        AND A1.DELT_FLG     <> 'Y'     				" ).append("\n"); 
		query.append("        AND A1.VSL_CD       = R.VSL_CD " ).append("\n"); 
		query.append("        AND A1.SKD_VOY_NO   = R.SKD_VOY_NO " ).append("\n"); 
		query.append("        AND A1.DIR_CD       = R.SKD_DIR_CD " ).append("\n"); 
		query.append("        AND A1.TRD_CD       = R.TRD_CD " ).append("\n"); 
		query.append("        AND A1.RLANE_CD     = R.RLANE_CD  " ).append("\n"); 
		query.append("#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("        AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   " ).append("\n"); 
		query.append("#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("        AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    " ).append("\n"); 
		query.append("        AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   " ).append("\n"); 
		query.append("#end	" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("        AND A1.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("        AND A1.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("        AND A1.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("        AND A1.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("        AND A1.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("        AND A1.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("        AND A1.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("        AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("         AND L1.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    GROUP BY  " ).append("\n"); 
		query.append("             A1.COST_YRMON " ).append("\n"); 
		query.append("            ,A1.SLS_YRMON " ).append("\n"); 
		query.append("            ,A1.COST_WK " ).append("\n"); 
		query.append("            ,A1.TRD_CD " ).append("\n"); 
		query.append("            ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("            ,A1.RLANE_CD " ).append("\n"); 
		query.append("            ,A1.IOC_CD " ).append("\n"); 
		query.append("            ,A1.VSL_CD " ).append("\n"); 
		query.append("            ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("            ,A1.DIR_CD " ).append("\n"); 
		query.append("            ,L1.HUL_BND_CD" ).append("\n"); 
		query.append("            ,R.STATUS" ).append("\n"); 
		query.append("            ,A2.STND_COST_CD" ).append("\n"); 
		query.append("    ) A " ).append("\n"); 
		query.append("GROUP BY A.COST_YRMON " ).append("\n"); 
		query.append("        ,A.SLS_YRMON " ).append("\n"); 
		query.append("        ,A.COST_WK " ).append("\n"); 
		query.append("        ,A.TRD_CD " ).append("\n"); 
		query.append("        ,A.SUB_TRD_CD " ).append("\n"); 
		query.append("        ,A.RLANE_CD " ).append("\n"); 
		query.append("        ,A.IOC_CD " ).append("\n"); 
		query.append("        ,A.VSL_CD " ).append("\n"); 
		query.append("        ,A.SKD_VOY_NO " ).append("\n"); 
		query.append("        ,A.DIR_CD" ).append("\n"); 
		query.append("        ,A.HUL_BND_CD" ).append("\n"); 
		query.append("        ,A.STATUS" ).append("\n"); 
		query.append("        		" ).append("\n"); 
		query.append("ORDER BY COST_YRMON " ).append("\n"); 
		query.append("        ,SLS_YRMON " ).append("\n"); 
		query.append("        ,COST_WK " ).append("\n"); 
		query.append("        ,TRD_CD " ).append("\n"); 
		query.append("        ,SUB_TRD_CD " ).append("\n"); 
		query.append("        ,RLANE_CD " ).append("\n"); 
		query.append("        ,IOC_CD " ).append("\n"); 
		query.append("        ,VSL_CD " ).append("\n"); 
		query.append("        ,SKD_VOY_NO " ).append("\n"); 
		query.append("        ,DIR_CD " ).append("\n"); 
		query.append("        ,HUL_BND_CD" ).append("\n"); 
		query.append("        ,DECODE(STATUS, 'L/C', 0, 'T/S', 1, 2)" ).append("\n"); 

	}
}