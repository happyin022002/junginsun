<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TCharterIOInvoiceDAOAddOffInvDtlsCSQL">
			<desc><![CDATA[TCharterIOInvoiceDAOAddOffInvDtlsCSQL]]></desc>
			<sql><![CDATA[
INSERT INTO FMS_INV_DTL (
	FLET_CTRT_NO,
	FLET_ISS_TP_CD,
	INV_SEQ,
	INV_DTL_SEQ,
	ACCT_CD,
	ACCT_ITM_SEQ,
	EFF_DT,
	EXP_DT,
	INV_USD_DYS,
	CURR_CD,
	INV_AMT,
	INV_DESC,
	FLET_CURR_CHK_CD,
	VSL_CD,
	SKD_VOY_NO,
	SKD_DIR_CD,
	REV_DIR_CD,
    BROG_ACCT_FLG,
	CRE_USR_ID,
	CRE_DT,
	UPD_USR_ID,
    UPD_DT,
	MODI_VNOR_ITM_UT_CD,
	MODI_VNOR_ITM_VAL,
	MODI_VNOR_ITM_PRC,
	VNOR_SEQ,
	VNOR_ITM_SEQ
) VALUES( 
	@[flet_ctrt_no],
	'OFF',
    CASE WHEN NVL(@[inv_seq],0) = 0 THEN
	    	(SELECT MAX(NVL(INV_SEQ,1))
			   FROM FMS_INVOICE 
			  WHERE FLET_CTRT_NO = @[flet_ctrt_no] 
			    AND FLET_ISS_TP_CD = 'OFF')
		ELSE to_number(NVL(@[inv_seq],0))
    END,
	@[inv_dtl_seq],
	@[acct_cd],
	@[acct_itm_seq],
	TO_DATE(@[eff_dt],'YYYYMMDDHH24:MI'),
	TO_DATE(@[exp_dt],'YYYYMMDDHH24:MI'),
	@[inv_usd_dys],
	DECODE(@[curr_cd],NULL,@[curr_cd2],@[curr_cd]),
	DECODE(@[inv_amt],NULL,@[inv_amt2],@[inv_amt]),
	@[inv_desc],
	DECODE(@[curr_cd],NULL,'S','F'),
	SUBSTR(@[bunker_vvd],1,4),
	SUBSTR(@[bunker_vvd],5,4),
	SUBSTR(@[bunker_vvd],9,1),
	SUBSTR(@[bunker_vvd],10,1),
    CASE WHEN @[brog_flg] IS NOT NULL THEN
              DECODE(@[acct_cd],'512641','Y','N')
         ELSE
			  'N'
     END,
	@[cre_usr_id],
	SYSDATE,
	@[upd_usr_id],
    SYSDATE,
	@[vnor_itm_ut_cd], 
	@[vnor_itm_val2],
	@[vnor_itm_prc],
	@[vnor_seq],
	@[vnor_itm_seq]
)			]]></sql>
			<params>
				<param name="flet_ctrt_no" type="12" value="" out="N"/>
				<param name="inv_seq" type="12" value="" out="N"/>
				<param name="inv_dtl_seq" type="12" value="" out="N"/>
				<param name="acct_cd" type="12" value="" out="N"/>
				<param name="acct_itm_seq" type="12" value="" out="N"/>
				<param name="eff_dt" type="12" value="" out="N"/>
				<param name="exp_dt" type="12" value="" out="N"/>
				<param name="inv_usd_dys" type="12" value="" out="N"/>
				<param name="curr_cd" type="12" value="" out="N"/>
				<param name="curr_cd2" type="12" value="" out="N"/>
				<param name="inv_amt" type="12" value="" out="N"/>
				<param name="inv_amt2" type="12" value="" out="N"/>
				<param name="inv_desc" type="12" value="" out="N"/>
				<param name="bunker_vvd" type="12" value="" out="N"/>
				<param name="brog_flg" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="vnor_itm_ut_cd" type="12" value="" out="N"/>
				<param name="vnor_itm_val2" type="12" value="" out="N"/>
				<param name="vnor_itm_prc" type="12" value="" out="N"/>
				<param name="vnor_seq" type="12" value="" out="N"/>
				<param name="vnor_itm_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
