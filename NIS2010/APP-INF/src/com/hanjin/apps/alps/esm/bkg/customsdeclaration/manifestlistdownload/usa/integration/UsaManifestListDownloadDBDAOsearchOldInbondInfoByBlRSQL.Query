<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UsaManifestListDownloadDBDAOsearchOldInbondInfoByBlRSQL">
			<desc><![CDATA[UsaOldInbondModiVO]]></desc>
			<sql><![CDATA[
SELECT ABL.BL_NO
      ,ABL.USA_LST_LOC_CD     AS ABL_USA_LST_LOC_CD
      ,ABL.HUB_LOC_CD         AS ABL_HUB_LOC_CD
      ,IBD.IBD_TRSP_TP_CD
      ,IBD.IBD_TRSP_NO
      ,IBD.CSTMS_CLR_TP_CD     AS IBD_CLR_TP_CD
      ,IBD.FREE_TRD_ZN_FLG     AS IBD_FREE_TRD_ZN_FLG
      ,IBD.DIR_DE_FLG          AS IBD_DIR_DE_FLG
      ,SUBSTR(CNT.CNTR_TPSZ_CD, 0,1) AS CNT_CNTR_TP_CD
      ,CLR.CSTMS_CLR_TP_CD     AS CLR_CLR_TP_CD
      ,CLR.FREE_TRD_ZN_FLG     AS CLR_FREE_TRD_ZN_FLG
      ,CLR.DIR_DE_FLG         AS CLR_DIR_DE_FLG
      ,CLR.CNTR_TP_CD         AS CLR_CNTR_TP_CD
      ,'' AS CRE_USR_ID
      ,'' AS UPD_USR_ID
  FROM BKG_CSTMS_ADV_IBD IBD
      ,BKG_CSTMS_ADV_BL ABL
      ,BKG_CSTMS_ADV_CNTR CNT
      ,(
        SELECT ICLR.*
          FROM (
                SELECT B.POD_CD
                      ,B.DEL_CD
                      ,CLR.CSTMS_CLR_TP_CD
                      ,CLR.FREE_TRD_ZN_FLG
                      ,CLR.DIR_DE_FLG
                      ,CLR.CNTR_TP_CD
                      ,ROW_NUMBER() OVER(ORDER BY CLR.DEL_CD DESC) AS RNUM
                  FROM BKG_CSTMS_ADV_CLR_TP CLR
                      ,BKG_BOOKING B
            #if (${bl_type} == 'H')
                      ,BKG_HBL H
                      ,BKG_HBL_CUST C
                 WHERE H.BKG_NO = C.BKG_NO
                   AND H.HBL_SEQ = C.HBL_SEQ
                   AND H.BKG_NO > ' '
                   AND H.CNTR_MF_NO = @[bl_no]
            #else
                      ,BKG_CUSTOMER C
                 WHERE B.BL_NO = @[bl_no]
            #end
                   AND B.BKG_NO = C.BKG_NO
                   AND C.BKG_CUST_TP_CD = DECODE(B.CUST_TO_ORD_FLG, 'Y', 'N', 'C')
                   AND C.CUST_CNT_CD    = CLR.CUST_CNT_CD
                   AND C.CUST_SEQ       = CLR.CUST_SEQ
                   AND B.POD_CD         = CLR.POD_CD
                   AND CLR.DELT_FLG ='N'
                   AND B.DEL_CD         = DECODE(CLR.DEL_CD, 'ALL', B.DEL_CD, CLR.DEL_CD)
                   AND B.CMDT_CD        = DECODE(CLR.CMDT_CD, NULL, B.CMDT_CD, CLR.CMDT_CD)
                   AND B.SC_NO          = DECODE(CLR.SC_NO, NULL, B.SC_NO, CLR.SC_NO)
                )ICLR
          WHERE ICLR.RNUM = 1
        )CLR
 WHERE ABL.CNT_CD = @[cnt_cd]
   AND ABL.BL_NO  = @[bl_no]
   AND ABL.CNT_CD = IBD.CNT_CD(+)
   AND ABL.BL_NO  = IBD.BL_NO(+)
   AND ABL.CNT_CD = CNT.CNT_CD(+)
   AND ABL.BL_NO  = CNT.BL_NO(+)
   AND ABL.CSTMS_POD_CD = CLR.POD_CD(+)
   AND ABL.DEL_CD = CLR.DEL_CD(+)
   AND ROWNUM = 1			]]></sql>
			<params>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="cnt_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
