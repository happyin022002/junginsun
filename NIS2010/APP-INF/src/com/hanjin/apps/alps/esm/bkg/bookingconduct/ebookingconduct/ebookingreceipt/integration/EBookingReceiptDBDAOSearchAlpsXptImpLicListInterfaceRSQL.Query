<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EBookingReceiptDBDAOSearchAlpsXptImpLicListInterfaceRSQL">
			<desc><![CDATA[MND 중 Booking Request시 접수되는 Import&Export Licence No만 별도 처리하기 위해 정보를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT 	MST.BKG_NO, 'MX' CNT_CD
		, SH.MX_TAX_ID MX_SHPR_TAX_ID  -- Mexico
        , CN.MX_TAX_ID MX_CNEE_TAX_ID		
        , NF.MX_TAX_ID MX_NTFY_TAX_ID
        , '' TR_SHPR_TAX_ID         , '' TR_CNEE_TAX_ID         , '' TR_NTFY_TAX_ID  -- Turkey
        , '' IL_SHPR_TAX_ID         , '' IL_CNEE_TAX_ID         , '' IL_NTFY_TAX_ID  -- Israel
        , '' LB_SHPR_TAX_ID         , '' LB_CNEE_TAX_ID         , '' LB_NTFY_TAX_ID  -- Lebanon
        , '' BR_SHPR_TAX_ID         , '' BR_CNEE_TAX_ID         , '' BR_NTFY_TAX_ID  -- Brazil
        , '' AES_INLND_TRNS_NO      , '' AES_PTA_NO1            , '' AES_PTA_NO2     -- USA
        , '' AES_PTA_DT             , '' AES_PTU_NO             , '' AES_PTU_DT
        , '' AES_DWN_NO             , '' AES_DWN_DT             , '' AES_EXPT_CTNT
        , '' AES_EXPT_ID            , '' AES_TP_CD
        , '' CAED_CTNT              , '' G7_EDI_CTNT            , '' MF_SMRY_RPT_NO  -- Canada
        , '' B13A_XPT_CTNT          , '' CGO_CTRL_NO            , '' NDR_REF_CTNT
        , '' NDR_REF_ID             , '' CAED_TP_CD				, '' VIN_CTNT
FROM BKG_XTER_RQST_MST MST, BKG_XTER_CUST SH, BKG_XTER_CUST CN, BKG_XTER_CUST NF
WHERE MST.XTER_SNDR_ID  = @[xter_sndr_id]
AND MST.XTER_RQST_NO  = @[xter_rqst_no]
AND MST.XTER_RQST_SEQ = @[xter_rqst_seq]
AND MST.XTER_SNDR_ID  = SH.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = SH.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = SH.XTER_RQST_SEQ  (+) 
AND SH.XTER_CUST_TP_CD(+) = 'S'
AND MST.XTER_SNDR_ID  = CN.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = CN.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = CN.XTER_RQST_SEQ  (+) 
AND CN.XTER_CUST_TP_CD(+) = 'C'
AND MST.XTER_SNDR_ID  = NF.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = NF.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = NF.XTER_RQST_SEQ  (+)
AND NF.XTER_CUST_TP_CD(+) = 'N'
AND LENGTH(SH.MX_TAX_ID||CN.MX_TAX_ID||NF.MX_TAX_ID) > 0
UNION ALL
SELECT 	MST.BKG_NO, 'TR' CNT_CD
		, '' MX_SHPR_TAX_ID         , '' MX_CNEE_TAX_ID         , '' MX_NTFY_TAX_ID  -- Mexico
        , SH.TR_TAX_ID TR_SHPR_TAX_ID  -- Turkey         
        , CN.TR_TAX_ID TR_CNEE_TAX_ID         
        , NF.TR_TAX_ID TR_NTFY_TAX_ID	
        , '' IL_SHPR_TAX_ID         , '' IL_CNEE_TAX_ID         , '' IL_NTFY_TAX_ID  -- Israel
        , '' LB_SHPR_TAX_ID         , '' LB_CNEE_TAX_ID         , '' LB_NTFY_TAX_ID  -- Lebanon
        , '' BR_SHPR_TAX_ID         , '' BR_CNEE_TAX_ID         , '' BR_NTFY_TAX_ID  -- Brazil
        , '' AES_INLND_TRNS_NO      , '' AES_PTA_NO1            , '' AES_PTA_NO2     -- USA
        , '' AES_PTA_DT             , '' AES_PTU_NO             , '' AES_PTU_DT
        , '' AES_DWN_NO             , '' AES_DWN_DT             , '' AES_EXPT_CTNT
        , '' AES_EXPT_ID            , '' AES_TP_CD
        , '' CAED_CTNT              , '' G7_EDI_CTNT            , '' MF_SMRY_RPT_NO  -- Canada
        , '' B13A_XPT_CTNT          , '' CGO_CTRL_NO            , '' NDR_REF_CTNT
        , '' NDR_REF_ID             , '' CAED_TP_CD				, '' VIN_CTNT
FROM BKG_XTER_RQST_MST MST, BKG_XTER_CUST SH, BKG_XTER_CUST CN, BKG_XTER_CUST NF
WHERE MST.XTER_SNDR_ID  = @[xter_sndr_id]
AND MST.XTER_RQST_NO  = @[xter_rqst_no]
AND MST.XTER_RQST_SEQ = @[xter_rqst_seq]
AND MST.XTER_SNDR_ID  = SH.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = SH.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = SH.XTER_RQST_SEQ  (+) 
AND SH.XTER_CUST_TP_CD(+) = 'S'
AND MST.XTER_SNDR_ID  = CN.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = CN.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = CN.XTER_RQST_SEQ  (+) 
AND CN.XTER_CUST_TP_CD(+) = 'C'
AND MST.XTER_SNDR_ID  = NF.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = NF.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = NF.XTER_RQST_SEQ  (+)
AND NF.XTER_CUST_TP_CD(+) = 'N'
AND LENGTH(SH.TR_TAX_ID||CN.TR_TAX_ID||NF.TR_TAX_ID) > 0
UNION ALL
SELECT 	MST.BKG_NO, 'IL' CNT_CD
		, '' MX_SHPR_TAX_ID         , '' MX_CNEE_TAX_ID         , '' MX_NTFY_TAX_ID  -- Mexico
        , '' TR_SHPR_TAX_ID         , '' TR_CNEE_TAX_ID         , '' TR_NTFY_TAX_ID  -- Turkey  
        , SH.IL_TAX_ID IL_SHPR_TAX_ID  -- Israel
        , CN.IL_TAX_ID IL_CNEE_TAX_ID
        , NF.IL_TAX_ID IL_NTFY_TAX_ID
        , '' LB_SHPR_TAX_ID         , '' LB_CNEE_TAX_ID         , '' LB_NTFY_TAX_ID  -- Lebanon
        , '' BR_SHPR_TAX_ID         , '' BR_CNEE_TAX_ID         , '' BR_NTFY_TAX_ID  -- Brazil
        , '' AES_INLND_TRNS_NO      , '' AES_PTA_NO1            , '' AES_PTA_NO2     -- USA
        , '' AES_PTA_DT             , '' AES_PTU_NO             , '' AES_PTU_DT
        , '' AES_DWN_NO             , '' AES_DWN_DT             , '' AES_EXPT_CTNT
        , '' AES_EXPT_ID            , '' AES_TP_CD
        , '' CAED_CTNT              , '' G7_EDI_CTNT            , '' MF_SMRY_RPT_NO  -- Canada
        , '' B13A_XPT_CTNT          , '' CGO_CTRL_NO            , '' NDR_REF_CTNT
        , '' NDR_REF_ID             , '' CAED_TP_CD				, '' VIN_CTNT
FROM BKG_XTER_RQST_MST MST, BKG_XTER_CUST SH, BKG_XTER_CUST CN, BKG_XTER_CUST NF
WHERE MST.XTER_SNDR_ID  = @[xter_sndr_id]
AND MST.XTER_RQST_NO  = @[xter_rqst_no]
AND MST.XTER_RQST_SEQ = @[xter_rqst_seq]
AND MST.XTER_SNDR_ID  = SH.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = SH.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = SH.XTER_RQST_SEQ  (+) 
AND SH.XTER_CUST_TP_CD(+) = 'S'
AND MST.XTER_SNDR_ID  = CN.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = CN.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = CN.XTER_RQST_SEQ  (+) 
AND CN.XTER_CUST_TP_CD(+) = 'C'
AND MST.XTER_SNDR_ID  = NF.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = NF.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = NF.XTER_RQST_SEQ  (+)
AND NF.XTER_CUST_TP_CD(+) = 'N'
AND LENGTH(SH.IL_TAX_ID||CN.IL_TAX_ID||NF.IL_TAX_ID) > 0
UNION ALL
SELECT 	MST.BKG_NO, 'LB' CNT_CD
		, '' MX_SHPR_TAX_ID         , '' MX_CNEE_TAX_ID         , '' MX_NTFY_TAX_ID  -- Mexico
        , '' TR_SHPR_TAX_ID         , '' TR_CNEE_TAX_ID         , '' TR_NTFY_TAX_ID  -- Turkey	
        , '' IL_SHPR_TAX_ID         , '' IL_CNEE_TAX_ID         , '' IL_NTFY_TAX_ID  -- Israel
        , SH.LB_TAX_ID LB_SHPR_TAX_ID  -- Lebanon
        , CN.LB_TAX_ID LB_CNEE_TAX_ID
        , NF.LB_TAX_ID LB_NTFY_TAX_ID
        , '' BR_SHPR_TAX_ID         , '' BR_CNEE_TAX_ID         , '' BR_NTFY_TAX_ID  -- Brazil
        , '' AES_INLND_TRNS_NO      , '' AES_PTA_NO1            , '' AES_PTA_NO2     -- USA
        , '' AES_PTA_DT             , '' AES_PTU_NO             , '' AES_PTU_DT
        , '' AES_DWN_NO             , '' AES_DWN_DT             , '' AES_EXPT_CTNT
        , '' AES_EXPT_ID            , '' AES_TP_CD
        , '' CAED_CTNT              , '' G7_EDI_CTNT            , '' MF_SMRY_RPT_NO  -- Canada
        , '' B13A_XPT_CTNT          , '' CGO_CTRL_NO            , '' NDR_REF_CTNT
        , '' NDR_REF_ID             , '' CAED_TP_CD				, '' VIN_CTNT
FROM BKG_XTER_RQST_MST MST, BKG_XTER_CUST SH, BKG_XTER_CUST CN, BKG_XTER_CUST NF
WHERE MST.XTER_SNDR_ID  = @[xter_sndr_id]
AND MST.XTER_RQST_NO  = @[xter_rqst_no]
AND MST.XTER_RQST_SEQ = @[xter_rqst_seq]
AND MST.XTER_SNDR_ID  = SH.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = SH.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = SH.XTER_RQST_SEQ  (+) 
AND SH.XTER_CUST_TP_CD(+) = 'S'
AND MST.XTER_SNDR_ID  = CN.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = CN.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = CN.XTER_RQST_SEQ  (+) 
AND CN.XTER_CUST_TP_CD(+) = 'C'
AND MST.XTER_SNDR_ID  = NF.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = NF.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = NF.XTER_RQST_SEQ  (+)
AND NF.XTER_CUST_TP_CD(+) = 'N'
AND LENGTH(SH.LB_TAX_ID||CN.LB_TAX_ID||NF.LB_TAX_ID) > 0
UNION ALL
SELECT 	MST.BKG_NO, 'BR' CNT_CD
		, '' MX_SHPR_TAX_ID         , '' MX_CNEE_TAX_ID         , '' MX_NTFY_TAX_ID  -- Mexico
        , '' TR_SHPR_TAX_ID         , '' TR_CNEE_TAX_ID         , '' TR_NTFY_TAX_ID  -- Turkey
        , '' IL_SHPR_TAX_ID         , '' IL_CNEE_TAX_ID         , '' IL_NTFY_TAX_ID  -- Israel
        , '' LB_SHPR_TAX_ID         , '' LB_CNEE_TAX_ID         , '' LB_NTFY_TAX_ID  -- Lebanon
        , SH.BRZ_TAX_ID BR_SHPR_TAX_ID  -- Brazil
        , CN.BRZ_TAX_ID BR_CNEE_TAX_ID
        , NF.BRZ_TAX_ID BR_NTFY_TAX_ID
        , '' AES_INLND_TRNS_NO      , '' AES_PTA_NO1            , '' AES_PTA_NO2     -- USA
        , '' AES_PTA_DT             , '' AES_PTU_NO             , '' AES_PTU_DT
        , '' AES_DWN_NO             , '' AES_DWN_DT             , '' AES_EXPT_CTNT
        , '' AES_EXPT_ID            , '' AES_TP_CD
        , '' CAED_CTNT              , '' G7_EDI_CTNT            , '' MF_SMRY_RPT_NO  -- Canada
        , '' B13A_XPT_CTNT          , '' CGO_CTRL_NO            , '' NDR_REF_CTNT
        , '' NDR_REF_ID             , '' CAED_TP_CD				, '' VIN_CTNT
FROM BKG_XTER_RQST_MST MST, BKG_XTER_CUST SH, BKG_XTER_CUST CN, BKG_XTER_CUST NF
WHERE MST.XTER_SNDR_ID  = @[xter_sndr_id]
AND MST.XTER_RQST_NO  = @[xter_rqst_no]
AND MST.XTER_RQST_SEQ = @[xter_rqst_seq]
AND MST.XTER_SNDR_ID  = SH.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = SH.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = SH.XTER_RQST_SEQ  (+) 
AND SH.XTER_CUST_TP_CD(+) = 'S'
AND MST.XTER_SNDR_ID  = CN.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = CN.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = CN.XTER_RQST_SEQ  (+) 
AND CN.XTER_CUST_TP_CD(+) = 'C'
AND MST.XTER_SNDR_ID  = NF.XTER_SNDR_ID   (+)
AND MST.XTER_RQST_NO  = NF.XTER_RQST_NO   (+)
AND MST.XTER_RQST_SEQ = NF.XTER_RQST_SEQ  (+)
AND NF.XTER_CUST_TP_CD(+) = 'N'
AND LENGTH(SH.BRZ_TAX_ID||CN.BRZ_TAX_ID||NF.BRZ_TAX_ID) > 0
UNION ALL
SELECT 	MST.BKG_NO, 'US' CNT_CD
		, '' MX_SHPR_TAX_ID         , '' MX_CNEE_TAX_ID         , '' MX_NTFY_TAX_ID  -- Mexico
        , '' TR_SHPR_TAX_ID         , '' TR_CNEE_TAX_ID         , '' TR_NTFY_TAX_ID  -- Turkey
        , '' IL_SHPR_TAX_ID         , '' IL_CNEE_TAX_ID         , '' IL_NTFY_TAX_ID  -- Israel
        , '' LB_SHPR_TAX_ID         , '' LB_CNEE_TAX_ID         , '' LB_NTFY_TAX_ID  -- Lebanon
        , '' BR_SHPR_TAX_ID         , '' BR_CNEE_TAX_ID         , '' BR_NTFY_TAX_ID  -- Brazil        
        , AES.AES_INLND_TRNS_NO 	AES_INLND_TRNS_NO     -- USA
        , AES.AES_PTA_NO1 			AES_PTA_NO1
        , AES.AES_PTA_NO2 			AES_PTA_NO2
        , TO_CHAR(AES.AES_PTA_DT, 'MM-DD-YYYY') AES_PTA_DT
        , AES.AES_PTU_NO						AES_PTU_NO
        , TO_CHAR(AES.AES_PTU_DT, 'MM-DD-YYYY')	AES_PTU_DT
        , AES.AES_DWN_NO						AES_DWN_NO
        , TO_CHAR(AES.AES_DWN_DT, 'MM-DD-YYYY') AES_DWN_DT
        , AES.AES_EXPT_CTNT			AES_EXPT_CTNT
        , AES.AES_EXPT_ID           AES_EXPT_ID
        , CASE WHEN AES.AES_FLG = 'Y' THEN 'AE'
               WHEN AES.PTA_FLG = 'Y' THEN 'PA'
               WHEN AES.PTU_FLG	= 'Y' THEN 'PU'
               WHEN AES.DWN_FLG = 'Y' THEN 'DN'
               WHEN AES.EXPT_FLG= 'Y' THEN 'EX'
               ELSE NULL
          END AES_TP_CD
        , '' CAED_CTNT              , '' G7_EDI_CTNT            , '' MF_SMRY_RPT_NO  -- Canada
        , '' B13A_XPT_CTNT          , '' CGO_CTRL_NO            , '' NDR_REF_CTNT
        , '' NDR_REF_ID             , '' CAED_TP_CD				, AES.VIN_CTNT AS VIN_CTNT
FROM BKG_XTER_RQST_MST MST, BKG_XTER_AES AES
WHERE MST.XTER_SNDR_ID  = @[xter_sndr_id]
AND MST.XTER_RQST_NO  = @[xter_rqst_no]
AND MST.XTER_RQST_SEQ = @[xter_rqst_seq]
AND MST.XTER_SNDR_ID  = AES.XTER_SNDR_ID
AND MST.XTER_RQST_NO  = AES.XTER_RQST_NO
AND MST.XTER_RQST_SEQ = AES.XTER_RQST_SEQ
AND LENGTH(AES.AES_INLND_TRNS_NO||AES.AES_PTA_NO1||AES.AES_PTA_NO2||AES.AES_PTU_NO||AES.AES_DWN_NO||AES.AES_EXPT_ID) > 0
UNION ALL

SELECT 	MST.BKG_NO, 'CA' CNT_CD
		, '' MX_SHPR_TAX_ID         , '' MX_CNEE_TAX_ID         , '' MX_NTFY_TAX_ID  -- Mexico
        , '' TR_SHPR_TAX_ID         , '' TR_CNEE_TAX_ID         , '' TR_NTFY_TAX_ID  -- Turkey
        , '' IL_SHPR_TAX_ID         , '' IL_CNEE_TAX_ID         , '' IL_NTFY_TAX_ID  -- Israel
        , '' LB_SHPR_TAX_ID         , '' LB_CNEE_TAX_ID         , '' LB_NTFY_TAX_ID  -- Lebanon
        , '' BR_SHPR_TAX_ID         , '' BR_CNEE_TAX_ID         , '' BR_NTFY_TAX_ID  -- Brazil
        , '' AES_INLND_TRNS_NO      , '' AES_PTA_NO1            , '' AES_PTA_NO2     -- USA
        , '' AES_PTA_DT             , '' AES_PTU_NO             , '' AES_PTU_DT
        , '' AES_DWN_NO             , '' AES_DWN_DT             , '' AES_EXPT_CTNT
        , '' AES_EXPT_ID            , '' AES_TP_CD        
        , CAED.CAED_CTNT1
			||decode(nvl(CAED.CAED_CTNT2, 'x'), 'x', '', '-'||CAED.CAED_CTNT2)
			||decode(nvl(CAED.CAED_CTNT3, 'x'), 'x', '', '-'||CAED.CAED_CTNT3)	CAED_CTNT  -- Canada
        , CAED.G7_EDI_CTNT1
			||decode(nvl(CAED.G7_EDI_CTNT2, 'x'), 'x', '', '-'||CAED.G7_EDI_CTNT2) G7_EDI_CTNT
		, CAED.SMRY_RPT_CTNT1
			||decode(nvl(CAED.SMRY_RPT_CTNT2, 'x'), 'x', '', '-'||CAED.SMRY_RPT_CTNT2) MF_SMRY_RPT_NO
        , TO_CHAR(CAED.B13A_DT, 'MM-DD-YYYY')
			||decode(nvl(CAED.B13A_CTNT1, 'x'), 'x', '', '-'||CAED.B13A_CTNT1)
			||decode(nvl(CAED.B13A_CTNT2, 'x'), 'x', '', '-'||CAED.B13A_CTNT2) B13A_XPT_CTNT
        , CAED.INLND_TZ_CGO_CTNT 	CGO_CTRL_NO
        , CAED.MNL_INP_CTNT			NDR_REF_CTNT
        , CAED.NON_DECL_CTNT 		NDR_REF_ID
        , CASE WHEN CAED.CAED_FLG = 'Y' THEN 'CE'
               WHEN CAED.G7_EDI_FLG = 'Y' THEN 'G7'
               WHEN CAED.SMRY_RPT_FLG = 'Y' THEN 'SM'
               WHEN CAED.B13A_FLG = 'Y' THEN 'EX'
               WHEN CAED.INLND_TZ_CGO_FLG = 'Y' THEN 'IT'
               WHEN CAED.NON_DECL_FLG = 'Y' THEN 'ND'
               ELSE NULL
          END CAED_TP_CD
		, '' VIN_CTNT
FROM BKG_XTER_RQST_MST MST, BKG_XTER_CAED CAED
WHERE MST.XTER_SNDR_ID  = @[xter_sndr_id]
AND MST.XTER_RQST_NO  = @[xter_rqst_no]
AND MST.XTER_RQST_SEQ = @[xter_rqst_seq]
AND MST.XTER_SNDR_ID  = CAED.XTER_SNDR_ID (+)
AND MST.XTER_RQST_NO  = CAED.XTER_RQST_NO (+)
AND MST.XTER_RQST_SEQ = CAED.XTER_RQST_SEQ(+)
AND LENGTH(CAED.CAED_CTNT1||CAED.G7_EDI_CTNT1||CAED.SMRY_RPT_CTNT1||CAED.B13A_DT||CAED.INLND_TZ_CGO_CTNT||CAED.MNL_INP_CTNT||CAED.NON_DECL_CTNT) > 0			]]></sql>
			<params>
				<param name="xter_sndr_id" type="12" value="" out="N"/>
				<param name="xter_rqst_no" type="12" value="" out="N"/>
				<param name="xter_rqst_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
