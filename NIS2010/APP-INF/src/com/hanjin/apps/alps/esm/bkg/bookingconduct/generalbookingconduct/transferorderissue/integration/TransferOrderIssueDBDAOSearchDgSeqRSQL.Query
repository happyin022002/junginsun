<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TransferOrderIssueDBDAOSearchDgSeqRSQL">
			<desc><![CDATA[ESM_BKG_0079_02A dq 콤보목록 조회]]></desc>
			<sql><![CDATA[
SELECT DG_SEQ
      ,DECODE(CNT_CGO_SEQ, 1, '', '(')|| DISPLAY_NM || DECODE(CNT_CGO_SEQ, 1, '', ')') AS DG_TRO_RMK
      ,DG_SEQ || '|' || DECODE(CNT_CGO_SEQ, 1, '', '(')|| DISPLAY_NM || DECODE(CNT_CGO_SEQ, 1, '', ')') AS DISPLAY_NM
  FROM (SELECT DG_CNTR_SEQ DG_SEQ
              ,CNTR_CGO_SEQ
              ,MIN(CNTR_CGO_SEQ) OVER (PARTITION BY DG_CNTR_SEQ) AS MIN_CGO_SEQ
              ,COUNT(CNTR_CGO_SEQ) OVER (PARTITION BY DG_CNTR_SEQ) AS CNT_CGO_SEQ
              ,BKG_JOIN_FNC(CURSOR(SELECT 'UN No:'||IMDG_UN_NO||', IMO Class:'||IMDG_CLSS_CD ||DECODE(NVL(SPCL_CGO_APRO_CD, 'X'), 'X', '', ' ('||INTG_CD_VAL_DP_DESC||')') DG_TRO_RMK
                                     FROM BKG_DG_CGO DG
                                         ,COM_INTG_CD_DTL CODE
                                    WHERE SPCL_CGO_APRO_CD = INTG_CD_VAL_CTNT(+)
                                      AND 'CD01955' = INTG_CD_ID(+)
                                      AND BKG_NO = @[bkg_no]
                                      AND DG.DG_CNTR_SEQ = DGCO.DG_CNTR_SEQ)) AS DISPLAY_NM
          FROM BKG_DG_CGO DGCO
         WHERE BKG_NO = @[bkg_no]
       ) A 
 WHERE CNTR_CGO_SEQ = MIN_CGO_SEQ
 ORDER BY DG_SEQ			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="FXT900004600" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
