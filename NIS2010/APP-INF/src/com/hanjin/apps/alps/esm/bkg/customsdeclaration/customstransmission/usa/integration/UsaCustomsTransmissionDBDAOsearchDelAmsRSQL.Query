<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UsaCustomsTransmissionDBDAOsearchDelAmsRSQL">
			<desc><![CDATA[조회]]></desc>
			<sql><![CDATA[
SELECT 
	CASE WHEN @[it_ittype] in( '62', '63' ) THEN
		-- 2009/09/16 Dong-il Ha, request by E-mail. mail title : 미세관 전송..
		-- 메일 내용중 BR은 오기. CA가 맞음.
        -- 멕시코, 캐나다의 경우 대표 PORT코드로 기타항만 코드로 부여한다.
		NVL((SELECT NVL(NVL(C.LOC_AMS_PORT_CD, D.LOC_AMS_PORT_CD), DECODE(SUBSTR(B.DEL_CD, 1, 2), 'MX', '20195', 'CA', '13400'))
			 FROM BKG_CSTMS_ADV_BL A, BKG_BOOKING B, MDM_LOCATION C, MDM_LOCATION D
			 WHERE
				A.CNT_CD = 'US'
				AND A.BL_NO     = @[bl_no]
				AND B.BKG_NO    = A.BKG_NO
				AND C.LOC_CD    = B.POD_CD
				AND C.DELT_FLG	= 'N'
				AND D.LOC_CD(+) = C.SCC_CD
				AND D.DELT_FLG(+)	= 'N'
				AND ROWNUM = 1
			), 
			RPAD(' ', 5, ' ')
		)	
	ELSE
		RPAD(' ', 5, ' ')
	END
FROM DUAL			]]></sql>
			<params>
				<param name="it_ittype" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
