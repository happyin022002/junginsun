<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="NetworkCostDBDAOSearchPortTariffWeekListRSQL">
			<desc><![CDATA[주차, VVD별 항비 조회]]></desc>
			<sql><![CDATA[
SELECT SUBSTR(A.COST_YRMON, 1, 4)||A.COST_WK COST_WK,
       C.SLAN_CD,
       C.VSL_CD||C.SKD_VOY_NO||C.SKD_DIR_CD VVD,
       C.VSL_CD,
       C.SKD_VOY_NO,
       C.SKD_DIR_CD,
       D.CNT_CD,
       SUM(C.PORT_ORG_AMT) PORT_ORG_AMT,
       D.WK_VSL_RT,
       D.WK_VSL_DTRB_AMT,
       MAX(D.WK_TTL_AMT) WK_TTL_AMT
  FROM MAS_MON_VVD A,
       MAS_VSL_RGST B,
       MAS_PORT_TRF C,
       MAS_PORT_ADD_TRF D
 WHERE A.VSL_CD     = B.VSL_CD
   AND A.N1ST_LODG_PORT_ETD_DT BETWEEN B.VSL_APLY_FM_DT AND B.VSL_APLY_TO_DT
   AND B.VOP_CD     = 'SML'
   AND A.SUB_TRD_CD <> 'IP'
   AND A.DELT_FLG   <> 'Y'
   AND A.SLAN_CD    = C.SLAN_CD
   AND A.VSL_CD     = C.VSL_CD
   AND A.SKD_VOY_NO = C.SKD_VOY_NO
   AND A.DIR_CD     = C.SKD_DIR_CD                       
   AND A.SLAN_CD    = D.SLAN_CD
   AND A.VSL_CD     = D.VSL_CD
   AND A.SKD_VOY_NO = D.SKD_VOY_NO
   AND A.DIR_CD     = D.SKD_DIR_CD
   AND SUBSTR(A.COST_YRMON, 1, 4)||A.COST_WK = REPLACE(@[f_yearweek], '-', '')
   AND D.CNT_CD     = @[f_cust_cnt_cd]
  GROUP BY A.COST_YRMON,
       A.COST_WK,
       C.SLAN_CD,
       C.VSL_CD,
       C.SKD_VOY_NO,
       C.SKD_DIR_CD,
       D.CNT_CD,
       D.WK_VSL_RT,
       D.WK_VSL_DTRB_AMT			]]></sql>
			<params>
				<param name="f_yearweek" type="12" value="" out="N"/>
				<param name="f_cust_cnt_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
