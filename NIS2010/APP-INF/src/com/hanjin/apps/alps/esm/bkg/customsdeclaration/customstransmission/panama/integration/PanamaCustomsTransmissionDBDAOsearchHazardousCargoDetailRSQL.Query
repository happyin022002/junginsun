<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PanamaCustomsTransmissionDBDAOsearchHazardousCargoDetailRSQL">
			<desc><![CDATA[searchHazardousCargoDetail]]></desc>
			<sql><![CDATA[
SELECT
E.IMDG_UN_NO IMDG_UN_NO,
E.IMDG_CLSS_CD  IMDG_CLSS_CD,
E.IMDG_COMP_GRP_CD IMDG_CO_GRP_CD,
E.CNTR_NO CNTR_NO,
TRANSLATE(E.FLSH_PNT_CDO_TEMP, '1234567890.-><+', '1234567890.-') VALUE1,
DECODE(ROUND((E.GRS_WGT * DECODE(E.WGT_UT_CD, 'LBS', 0.0005, 0.001)) + (X_CNTR_TARE_WGT / 1000), 3), 0, DECODE(X_BKG_COUNT, 1, X_BKG_WEIGHT, 0), ROUND((E.GRS_WGT * DECODE(E.WGT_UT_CD, 'LBS', 0.0005, 0.001)) + (X_CNTR_TARE_WGT / 1000), 3)) VALUE2,
'CONT' DG_KEPTIN,
E.CNTR_TPSZ_CD CNTR_TPSZ_CD,
A.POL_CD POL_CD,
A.POD_CD POD_CD
FROM
BKG_VVD A,
VSK_VSL_PORT_SKD B,
VSK_VSL_PORT_SKD C,
BKG_BOOKING D,
BKG_DG_CGO E,
(
SELECT
J.CNTR_NO X_CNTR_NO,
NVL(K.CNTRTS_TARE_WGT, L.CNTR_TPSZ_TARE_WGT) / 1000 X_CNTR_TARE_WGT,
COUNT(J.CNTR_NO) X_CNTR_COUNT,
--COUNT(DISTINCT J.BKG_NO||J.BKG_NO_SPLIT||J.DG_CNTR_SEQ||J.CNTR_CGO_SEQ) X_BKG_COUNT,
COUNT(DISTINCT J.BKG_NO||J.DG_CNTR_SEQ||J.CNTR_CGO_SEQ) X_BKG_COUNT,
SUM(M.ACT_WGT * DECODE(M.WGT_UT_CD, 'KGS', 0.001, 0.0005)) X_BKG_WEIGHT
FROM
BKG_VVD F,
VSK_VSL_PORT_SKD G,
VSK_VSL_PORT_SKD H,
BKG_BOOKING I,
BKG_DG_CGO J,
MDM_CNTR_TP_SZ L,
BKG_BL_DOC M,
(SELECT MC.CNTR_NO CNTR_NO,
MC.CNTR_TPSZ_CD CNTR_TPSZ_CD,
DECODE(NVL(S.TARE_WGT, 0), 0
, DECODE(NVL(MDM.CNTR_TPSZ_TARE_WGT, 0), 0
, DECODE(MC.CNTR_TPSZ_CD, 'T2', 3600, 'T4', 5200, 0),
MDM.CNTR_TPSZ_TARE_WGT) , S.TARE_WGT ) CNTRTS_TARE_WGT
FROM MST_CONTAINER MC, MST_CNTR_SPEC S, MDM_CNTR_TP_SZ MDM
WHERE MC.CNTR_SPEC_NO      =   S.CNTR_SPEC_NO(+)
AND MC.CNTR_TPSZ_CD          =   MDM.CNTR_TPSZ_CD
) K
WHERE F.VSL_CD        =  @[vsl_cd]
AND F.SKD_VOY_NO    =  @[skd_voy_no]
AND F.SKD_DIR_CD    =  @[skd_dir_cd]
AND F.VSL_CD = G.VSL_CD(+)
AND F.SKD_VOY_NO = G.SKD_VOY_NO(+)
AND F.SKD_DIR_CD = G.SKD_DIR_CD(+)
AND F.POL_CD = G.VPS_PORT_CD(+)
AND F.VSL_CD = H.VSL_CD(+)
AND F.SKD_VOY_NO = H.SKD_VOY_NO(+)
AND F.SKD_DIR_CD = H.SKD_DIR_CD(+)
AND F.POD_CD = H.VPS_PORT_CD(+)
AND F.BKG_NO        =  I.BKG_NO
--AND I.BKG_NO_SPLIT  =  F.BKG_NO_SPLIT
AND I.BKG_NO        =  J.BKG_NO
--AND J.BKG_NO_SPLIT  =  I.BKG_NO_SPLIT
AND I.BKG_NO        =  M.BKG_NO
--AND M.BKG_NO_SPLIT  =  I.BKG_NO_SPLIT
AND J.CNTR_NO  =  K.CNTR_NO
AND K.CNTR_TPSZ_CD(+)  =  L.CNTR_TPSZ_CD
AND NVL(H.CLPT_SEQ, 9999)  >  NVL(G.CLPT_SEQ, 0)
AND NVL(G.CLPT_SEQ, 0)  <= @[clpt_seq]
AND NVL(H.CLPT_SEQ, 9999)  >  @[clpt_seq]
AND I.BKG_STS_CD       IN ('W', 'F')
GROUP BY J.CNTR_NO, NVL(K.CNTRTS_TARE_WGT, L.CNTR_TPSZ_TARE_WGT)
)
WHERE A.VSL_CD        =  @[vsl_cd]
AND A.SKD_VOY_NO    =  @[skd_voy_no]
AND A.SKD_DIR_CD    =  @[skd_dir_cd]
AND B.VSL_CD(+)     =  A.VSL_CD
AND B.SKD_VOY_NO(+) =  A.SKD_VOY_NO
AND B.SKD_DIR_CD(+) =  A.SKD_DIR_CD
AND B.VPS_PORT_CD(+) =  A.POL_CD
AND C.VSL_CD(+)     =  A.VSL_CD
AND C.SKD_VOY_NO(+) =  A.SKD_VOY_NO
AND C.SKD_DIR_CD(+) =  A.SKD_DIR_CD
AND C.VPS_PORT_CD(+) =  A.POD_CD
AND NVL(C.CLPT_SEQ, 9999)  >  NVL(B.CLPT_SEQ, 0)
AND NVL(B.CLPT_SEQ, 0)  <= @[clpt_seq]
AND NVL(C.CLPT_SEQ, 9999)  >  @[clpt_seq]
AND D.BKG_NO        =  A.BKG_NO
AND D.BKG_STS_CD       IN ('W', 'F')
AND E.BKG_NO        =  D.BKG_NO
AND X_CNTR_NO  =  E.CNTR_NO			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="clpt_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
