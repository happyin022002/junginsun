<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CMPBGuidelineDBDAOPriCmpbGlineBaseListRSQL">
			<desc><![CDATA[base list]]></desc>
			<sql><![CDATA[
SELECT  A1.SVC_SCP_CD
,       A1.CRE_OFC_CD
,       A1.GLINE_SEQ
,       A1.PRS_CUST_TP_CD
,       A1.BSE_SEQ
,       B1.VSL_SLAN_CD                                               -- SVC_LANE
,       C1.PRC_CMDT_DEF_CD                                           --COMMODITY
,       D1.ROUT_PNT_LOC_DEF_CD AS ORG_ROUT_PNT_LOC_DEF_CD            --ORIGIN PNT
,       E1.ROUT_VIA_PORT_DEF_CD AS ORG_ROUT_VIA_PORT_DEF_CD          --ORIGIN VIA
,       F1.ROUT_VIA_PORT_DEF_CD AS DEST_ROUT_VIA_PORT_DEF_CD         --DEST VIA
,       G1.ROUT_PNT_LOC_DEF_CD AS DEST_ROUT_PNT_LOC_DEF_CD           --DEST PNT
FROM
        PRI_CMPB_GLINE_BSE A1
        ,       (
        --SVC_LANE
        SELECT  SVC_SCP_CD
        ,       CRE_OFC_CD
        ,       GLINE_SEQ
        ,       PRS_CUST_TP_CD
        ,       BSE_SEQ
        ,       SUBSTR(MAX(SYS_CONNECT_BY_PATH(VSL_SLAN_CD, '; ')),3) AS VSL_SLAN_CD
        FROM    (
                SELECT  SVC_SCP_CD
                ,       CRE_OFC_CD
                ,       GLINE_SEQ
                ,       PRS_CUST_TP_CD
                ,       BSE_SEQ
                ,       VSL_SLAN_CD
                ,       ROW_NUMBER() OVER(PARTITION BY SVC_SCP_CD, CRE_OFC_CD, GLINE_SEQ, PRS_CUST_TP_CD, BSE_SEQ
                ORDER BY  VSL_SLAN_CD, SVC_SCP_CD, CRE_OFC_CD, GLINE_SEQ, PRS_CUST_TP_CD, BSE_SEQ) AS RN
                FROM    PRI_CMPB_GLINE_SVC_LANE
                WHERE   1=1
                AND   SVC_SCP_CD = @[svc_scp_cd]
                AND   CRE_OFC_CD = @[cre_ofc_cd]
                AND   GLINE_SEQ = @[gline_seq]
                AND   PRS_CUST_TP_CD = @[prs_cust_tp_cd]
				--ORDER BY VSL_SLAN_CD
                )
        START WITH RN = 1
        CONNECT BY PRIOR BSE_SEQ = BSE_SEQ
        AND PRIOR RN = RN - 1
        GROUP BY SVC_SCP_CD
        ,        CRE_OFC_CD
        ,        GLINE_SEQ
        ,        PRS_CUST_TP_CD
        ,        BSE_SEQ
        ) B1
        ,       (
        --COMMODITY
        SELECT  SVC_SCP_CD
        ,       CRE_OFC_CD
        ,       GLINE_SEQ
        ,       PRS_CUST_TP_CD
        ,       BSE_SEQ
        ,       SUBSTR(MAX(SYS_CONNECT_BY_PATH(PRC_CMDT_DEF_CD, '; ')),3) AS PRC_CMDT_DEF_CD
        FROM    (
                SELECT  SVC_SCP_CD
                ,       CRE_OFC_CD
                ,       GLINE_SEQ
                ,       PRS_CUST_TP_CD
                ,       BSE_SEQ
                ,       CMDT_SEQ
                ,       PRC_CMDT_TP_CD
                ,       PRC_CMDT_DEF_CD
                ,       ROW_NUMBER() OVER(PARTITION BY SVC_SCP_CD, CRE_OFC_CD, GLINE_SEQ, PRS_CUST_TP_CD, BSE_SEQ
                ORDER BY DECODE(PRC_CMDT_TP_CD, 'G','1','R','2','C','3'),  PRC_CMDT_DEF_CD, 
				SVC_SCP_CD, CRE_OFC_CD, GLINE_SEQ, PRS_CUST_TP_CD, BSE_SEQ, CMDT_SEQ) AS RN
                FROM    PRI_CMPB_GLINE_CMDT
                WHERE   1=1
                AND   SVC_SCP_CD = @[svc_scp_cd]
                AND   CRE_OFC_CD = @[cre_ofc_cd]
                AND   GLINE_SEQ = @[gline_seq]
                AND   PRS_CUST_TP_CD = @[prs_cust_tp_cd]
				--ORDER BY 
                )
        START WITH RN = 1
        CONNECT BY PRIOR BSE_SEQ = BSE_SEQ
        AND PRIOR RN = RN - 1
        GROUP BY SVC_SCP_CD
        ,       CRE_OFC_CD
        ,       GLINE_SEQ
        ,       PRS_CUST_TP_CD
        ,       BSE_SEQ
        ) C1
        ,       (
        --ORIGIN POINT
        SELECT  SVC_SCP_CD
        ,       CRE_OFC_CD
        ,       GLINE_SEQ
        ,       PRS_CUST_TP_CD
        ,       BSE_SEQ
        ,       ORG_DEST_TP_CD
        ,       SUBSTR(MAX(SYS_CONNECT_BY_PATH(ROUT_PNT_LOC_DEF_CD, '; ')),3) AS ROUT_PNT_LOC_DEF_CD
        FROM    (
                SELECT  A.SVC_SCP_CD
                ,       A.CRE_OFC_CD
                ,       A.GLINE_SEQ
                ,       A.PRS_CUST_TP_CD
                ,       A.BSE_SEQ
                ,       A.ORG_DEST_TP_CD
                --,       (A.ROUT_PNT_LOC_DEF_CD || DECODE(NVL(B.INTG_CD_VAL_DESC,''),'','','(' || B.INTG_CD_VAL_DESC || ')')) AS ROUT_PNT_LOC_DEF_CD\
				,       A.ROUT_PNT_LOC_DEF_CD AS ROUT_PNT_LOC_DEF_CD
                ,       ROW_NUMBER() OVER(PARTITION BY A.SVC_SCP_CD, A.CRE_OFC_CD, A.GLINE_SEQ, A.PRS_CUST_TP_CD, A.BSE_SEQ, A.ORG_DEST_TP_CD
                ORDER BY DECODE(A.ROUT_PNT_LOC_TP_CD, 'C','1','R','2','G','3','L','4'),  A.ROUT_PNT_LOC_DEF_CD,
				A.SVC_SCP_CD, A.CRE_OFC_CD, A.GLINE_SEQ, A.PRS_CUST_TP_CD, A.BSE_SEQ) AS RN
                FROM    PRI_CMPB_GLINE_ROUT_PNT A
                ,       COM_INTG_CD_DTL B
                WHERE   1=1
                AND   SVC_SCP_CD = @[svc_scp_cd]
                AND   CRE_OFC_CD = @[cre_ofc_cd]
                AND   GLINE_SEQ = @[gline_seq]
                AND   PRS_CUST_TP_CD = @[prs_cust_tp_cd]
                AND   A.ORG_DEST_TP_CD = 'O'
                AND   B.INTG_CD_ID(+) = 'CD02138'
                AND   A.RCV_DE_TERM_CD = B.INTG_CD_VAL_CTNT(+)
				--ORDER BY DECODE(A.ROUT_PNT_LOC_TP_CD, 'C','1','R','2','G','3','L','4'),  A.ROUT_PNT_LOC_DEF_CD
                )
        START WITH RN = 1
        CONNECT BY PRIOR BSE_SEQ = BSE_SEQ
        AND PRIOR RN = RN - 1
        GROUP BY SVC_SCP_CD
        ,        CRE_OFC_CD
        ,        GLINE_SEQ
        ,        PRS_CUST_TP_CD
        ,        BSE_SEQ
        ,        ORG_DEST_TP_CD
        ) D1
        ,       (
        --ORIGIN VIA
        SELECT  SVC_SCP_CD
        ,       CRE_OFC_CD
        ,       GLINE_SEQ
        ,       PRS_CUST_TP_CD
        ,       BSE_SEQ
        ,       ORG_DEST_TP_CD
        ,       SUBSTR(MAX(SYS_CONNECT_BY_PATH(ROUT_VIA_PORT_DEF_CD, '; ')),3) AS ROUT_VIA_PORT_DEF_CD
        FROM    (
                SELECT  A.SVC_SCP_CD
                ,       A.CRE_OFC_CD
                ,       A.GLINE_SEQ
                ,       A.PRS_CUST_TP_CD
                ,       A.BSE_SEQ
                ,       A.ORG_DEST_TP_CD
                ,       A.ROUT_VIA_PORT_DEF_CD
                ,       ROW_NUMBER() OVER(PARTITION BY A.SVC_SCP_CD, A.CRE_OFC_CD, A.GLINE_SEQ, A.PRS_CUST_TP_CD, A.BSE_SEQ, A.ORG_DEST_TP_CD
                ORDER BY DECODE(A.ROUT_VIA_PORT_TP_CD, 'C','1','R','2','G','3','L','4'),  A.ROUT_VIA_PORT_DEF_CD,
				A.SVC_SCP_CD, A.CRE_OFC_CD, A.GLINE_SEQ, A.PRS_CUST_TP_CD, A.BSE_SEQ) AS RN
                FROM    PRI_CMPB_GLINE_ROUT_VIA A
                WHERE   1=1
                AND   SVC_SCP_CD = @[svc_scp_cd]
                AND   CRE_OFC_CD = @[cre_ofc_cd]
                AND   GLINE_SEQ = @[gline_seq]
                AND   PRS_CUST_TP_CD = @[prs_cust_tp_cd]
                AND   A.ORG_DEST_TP_CD = 'O'
				--ORDER BY DECODE(A.ROUT_VIA_PORT_TP_CD, 'C','1','R','2','G','3','L','4'),  A.ROUT_VIA_PORT_DEF_CD
                )
        START WITH RN = 1
        CONNECT BY PRIOR BSE_SEQ = BSE_SEQ
        AND PRIOR RN = RN - 1
        GROUP BY SVC_SCP_CD
        ,        CRE_OFC_CD
        ,        GLINE_SEQ
        ,        PRS_CUST_TP_CD
        ,        BSE_SEQ
        ,        ORG_DEST_TP_CD
        ) E1
        ,       (
        --DEST VIA
        SELECT  SVC_SCP_CD
        ,       CRE_OFC_CD
        ,       GLINE_SEQ
        ,       PRS_CUST_TP_CD
        ,       BSE_SEQ
        ,       ORG_DEST_TP_CD
        ,       SUBSTR(MAX(SYS_CONNECT_BY_PATH(ROUT_VIA_PORT_DEF_CD, '; ')),3) AS ROUT_VIA_PORT_DEF_CD
        FROM    (
                SELECT  A.SVC_SCP_CD
                ,       A.CRE_OFC_CD
                ,       A.GLINE_SEQ
                ,       A.PRS_CUST_TP_CD
                ,       A.BSE_SEQ
                ,       A.ORG_DEST_TP_CD
                ,       A.ROUT_VIA_PORT_DEF_CD
                ,       ROW_NUMBER() OVER(PARTITION BY A.SVC_SCP_CD, A.CRE_OFC_CD, A.GLINE_SEQ, A.PRS_CUST_TP_CD, A.BSE_SEQ, A.ORG_DEST_TP_CD
                ORDER BY DECODE(A.ROUT_VIA_PORT_TP_CD, 'C','1','R','2','G','3','L','4'),  A.ROUT_VIA_PORT_DEF_CD,
				A.SVC_SCP_CD, A.CRE_OFC_CD, A.GLINE_SEQ, A.PRS_CUST_TP_CD, A.BSE_SEQ) AS RN
                FROM    PRI_CMPB_GLINE_ROUT_VIA A
                WHERE   1=1
                AND   SVC_SCP_CD = @[svc_scp_cd]
                AND   CRE_OFC_CD = @[cre_ofc_cd]
                AND   GLINE_SEQ = @[gline_seq]
                AND   PRS_CUST_TP_CD = @[prs_cust_tp_cd]
                AND   A.ORG_DEST_TP_CD = 'D'
				--ORDER BY DECODE(A.ROUT_VIA_PORT_TP_CD, 'C','1','R','2','G','3','L','4'),  A.ROUT_VIA_PORT_DEF_CD
                )
        START WITH RN = 1
        CONNECT BY PRIOR BSE_SEQ = BSE_SEQ
        AND PRIOR RN = RN - 1
        GROUP BY SVC_SCP_CD
        ,        CRE_OFC_CD
        ,        GLINE_SEQ
        ,        PRS_CUST_TP_CD
        ,        BSE_SEQ
        ,        ORG_DEST_TP_CD
        ) F1
        ,       (
        --DEST POINT
        SELECT  SVC_SCP_CD
        ,       CRE_OFC_CD
        ,       GLINE_SEQ
        ,       PRS_CUST_TP_CD
        ,       BSE_SEQ
        ,       ORG_DEST_TP_CD
        ,       SUBSTR(MAX(SYS_CONNECT_BY_PATH(ROUT_PNT_LOC_DEF_CD, '; ')),3) AS ROUT_PNT_LOC_DEF_CD
        FROM    (
                SELECT  A.SVC_SCP_CD
                ,       A.CRE_OFC_CD
                ,       A.GLINE_SEQ
                ,       A.PRS_CUST_TP_CD
                ,       A.BSE_SEQ
                ,       A.ORG_DEST_TP_CD
                ,       A.ROUT_PNT_SEQ
                --,       (A.ROUT_PNT_LOC_DEF_CD || DECODE(NVL(B.INTG_CD_VAL_DESC,''),'','','(' || B.INTG_CD_VAL_DESC || ')')) AS ROUT_PNT_LOC_DEF_CD
				,       A.ROUT_PNT_LOC_DEF_CD AS ROUT_PNT_LOC_DEF_CD
                ,       ROW_NUMBER() OVER(PARTITION BY A.SVC_SCP_CD, A.CRE_OFC_CD, A.GLINE_SEQ, A.PRS_CUST_TP_CD, A.BSE_SEQ, A.ORG_DEST_TP_CD
                ORDER BY DECODE(A.ROUT_PNT_LOC_TP_CD, 'C','1','R','2','G','3','L','4'),  A.ROUT_PNT_LOC_DEF_CD,
				A.SVC_SCP_CD, A.CRE_OFC_CD, A.GLINE_SEQ, A.PRS_CUST_TP_CD, A.BSE_SEQ) AS RN
                FROM    PRI_CMPB_GLINE_ROUT_PNT A
                ,       COM_INTG_CD_DTL B
                WHERE   1=1
                AND   SVC_SCP_CD = @[svc_scp_cd]
                AND   CRE_OFC_CD = @[cre_ofc_cd]
                AND   GLINE_SEQ = @[gline_seq]
                AND   PRS_CUST_TP_CD = @[prs_cust_tp_cd]
                AND   A.ORG_DEST_TP_CD = 'D'
                AND   B.INTG_CD_ID(+) = 'CD02139'
                AND   A.RCV_DE_TERM_CD = B.INTG_CD_VAL_CTNT(+)
				--ORDER BY DECODE(A.ROUT_PNT_LOC_TP_CD, 'C','1','R','2','G','3','L','4'),  A.ROUT_PNT_LOC_DEF_CD
                )
        START WITH RN = 1
        CONNECT BY PRIOR BSE_SEQ = BSE_SEQ
        AND PRIOR RN = RN - 1
        GROUP BY SVC_SCP_CD
        ,        CRE_OFC_CD
        ,        GLINE_SEQ
        ,        PRS_CUST_TP_CD
        ,        BSE_SEQ
        ,        ORG_DEST_TP_CD
        ) G1
WHERE   A1.SVC_SCP_CD = B1.SVC_SCP_CD(+)
AND     A1.CRE_OFC_CD = B1.CRE_OFC_CD(+)
AND     A1.GLINE_SEQ = B1.GLINE_SEQ(+)
AND     A1.PRS_CUST_TP_CD = B1.PRS_CUST_TP_CD(+)
AND     A1.BSE_SEQ = B1.BSE_SEQ(+)
AND     A1.SVC_SCP_CD = C1.SVC_SCP_CD(+)
AND     A1.CRE_OFC_CD = C1.CRE_OFC_CD(+)
AND     A1.GLINE_SEQ = C1.GLINE_SEQ(+)
AND     A1.PRS_CUST_TP_CD = C1.PRS_CUST_TP_CD(+)
AND     A1.BSE_SEQ = C1.BSE_SEQ(+)
AND     A1.SVC_SCP_CD = D1.SVC_SCP_CD(+)
AND     A1.CRE_OFC_CD = D1.CRE_OFC_CD(+)
AND     A1.GLINE_SEQ = D1.GLINE_SEQ(+)
AND     A1.PRS_CUST_TP_CD = D1.PRS_CUST_TP_CD(+)
AND     A1.BSE_SEQ = D1.BSE_SEQ(+)
AND     A1.SVC_SCP_CD = E1.SVC_SCP_CD(+)
AND     A1.CRE_OFC_CD = E1.CRE_OFC_CD(+)
AND     A1.GLINE_SEQ = E1.GLINE_SEQ(+)
AND     A1.PRS_CUST_TP_CD = E1.PRS_CUST_TP_CD(+)
AND     A1.BSE_SEQ = E1.BSE_SEQ(+)
AND     A1.SVC_SCP_CD = F1.SVC_SCP_CD(+)
AND     A1.CRE_OFC_CD = F1.CRE_OFC_CD(+)
AND     A1.GLINE_SEQ = F1.GLINE_SEQ(+)
AND     A1.PRS_CUST_TP_CD = F1.PRS_CUST_TP_CD(+)
AND     A1.BSE_SEQ = F1.BSE_SEQ(+)
AND     A1.SVC_SCP_CD = G1.SVC_SCP_CD(+)
AND     A1.CRE_OFC_CD = G1.CRE_OFC_CD(+)
AND     A1.GLINE_SEQ = G1.GLINE_SEQ(+)
AND     A1.PRS_CUST_TP_CD = G1.PRS_CUST_TP_CD(+)
AND     A1.BSE_SEQ = G1.BSE_SEQ(+)
AND     A1.SVC_SCP_CD = @[svc_scp_cd]
AND     A1.CRE_OFC_CD = @[cre_ofc_cd]
AND     A1.GLINE_SEQ = @[gline_seq]
AND     A1.PRS_CUST_TP_CD = @[prs_cust_tp_cd]
ORDER BY A1.BSE_SEQ			]]></sql>
			<params>
				<param name="svc_scp_cd" type="12" value="" out="N"/>
				<param name="cre_ofc_cd" type="12" value="" out="N"/>
				<param name="gline_seq" type="12" value="" out="N"/>
				<param name="prs_cust_tp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
