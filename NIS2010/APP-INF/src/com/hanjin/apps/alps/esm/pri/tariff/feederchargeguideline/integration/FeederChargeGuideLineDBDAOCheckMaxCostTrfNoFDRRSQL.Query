<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="FeederChargeGuideLineDBDAOCheckMaxCostTrfNoFDRRSQL">
			<desc><![CDATA[CheckMaxCostTrfNoFDR]]></desc>
			<sql><![CDATA[
SELECT HDR.SVC_SCP_CD
        , HDR.FDR_TRF_NO
        , HDR.RHQ_CD
        , MAPG.FDR_COST_TRF_NO
        , (SELECT MAX(COST_TRF_NO)
            FROM #if(${rhq_cd} == 'HAMRU')    
                     AOC_EUR_FDR_TRF_HDR
                 #end 
                 #if(${rhq_cd} == 'SINRS')
                     AOC_CHN_FDR_TRF_HDR
                 #end 
                 #if(${rhq_cd} == 'SHARC')
                     AOC_CHN_FDR_TRF_HDR
                 #end   
            WHERE RHQ_CD = @[rhq_cd] AND COST_TRF_STS_CD = 'C') MAX_COST_TRF_NO
        , DECODE(FDR_COST_TRF_NO, 
          (SELECT MAX(COST_TRF_NO)
            FROM #if(${rhq_cd} == 'HAMRU')    
                     AOC_EUR_FDR_TRF_HDR
                 #end 
                 #if(${rhq_cd} == 'SINRS')
                     AOC_CHN_FDR_TRF_HDR
                 #end 
                 #if(${rhq_cd} == 'SHARC')
                     AOC_CHN_FDR_TRF_HDR
                 #end
            WHERE RHQ_CD = @[rhq_cd] AND COST_TRF_STS_CD = 'C'), 0, 1 ) CHECK_COST_TRF_NO 
     FROM PRI_TRF_FDR_HDR HDR
        , PRI_TRF_FDR_COST_VER_MAPG MAPG 
    WHERE 1=1
      AND HDR.SVC_SCP_CD = @[svc_scp_cd]
      AND HDR.FDR_TRF_NO  = @[fdr_trf_no]
      AND HDR.ORG_DEST_TP_CD = @[org_dest_tp_cd]
      AND HDR.SVC_SCP_CD  = MAPG.SVC_SCP_CD
      AND HDR.FDR_TRF_NO  = MAPG.FDR_TRF_NO
      AND HDR.ORG_DEST_TP_CD  = MAPG.ORG_DEST_TP_CD
      ORDER BY CHECK_COST_TRF_NO DESC			]]></sql>
			<params>
				<param name="rhq_cd" type="12" value="" out="N"/>
				<param name="svc_scp_cd" type="12" value="" out="N"/>
				<param name="fdr_trf_no" type="12" value="" out="N"/>
				<param name="org_dest_tp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
