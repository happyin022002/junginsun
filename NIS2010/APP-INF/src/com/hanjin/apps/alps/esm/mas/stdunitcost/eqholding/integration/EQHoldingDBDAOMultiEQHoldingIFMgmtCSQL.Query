<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EQHoldingDBDAOMultiEQHoldingIFMgmtCSQL">
			<desc><![CDATA[   ]]></desc>
			<sql><![CDATA[
INSERT INTO MAS_EQ_HLD_IF_MGMT
(
	COST_YR
	, COST_MON
	, VER_TP_CD
	, IF_VER_CD
	, CNTR_TPSZ_CD
	, ACT_PRC_AMT
	, ADJ_RT_AMT
	, PLCY_PRC_AMT
	, CRE_USR_ID
	, CRE_DT
	, UPD_USR_ID
	, UPD_DT 
)
 SELECT SUBSTR(@[cost_yrmon],1,4) COST_YR
      , SUBSTR(@[cost_yrmon],5,2) COST_MON
      , 'M' VER_TP_CD
      , '0' IF_VER_CD
      , TPSZ_CD CNTR_TPSZ_CD
      , CASE WHEN @[cost_yrmon] >= '201707' THEN SUM(HLD_UC_AMT_NORM_ADJ)
		ELSE SUM(HLD_UC_AMT_DMT + HLD_UC_AMT_DMT_SEA) 
		END  AS ACT_PRC_AMT
      , 100 ADJ_RT_AMT
      , SUM(HLD_UC_AMT_DMT + HLD_UC_AMT_DMT_SEA) PLCY_PRC_AMT
      , @[cre_usr_id]
      , SYSDATE   
      , @[upd_usr_id]
      , SYSDATE  
   FROM MAS_CNTR_HLD_COST
  WHERE COST_YRMON = @[cost_yrmon]
   AND TPSZ_CD <> 'BOX'

 		AND ACCT_CD IN (select stnd_cost_cd from MAS_COST_SRC_ACCT where SGRP_COST_CD = 
	      					CASE WHEN @[cost_yrmon] >= '201707' THEN 'EQC3'
							ELSE 'EQCF'
							END   )


GROUP BY TPSZ_CD			]]></sql>
			<params>
				<param name="cost_yrmon" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
