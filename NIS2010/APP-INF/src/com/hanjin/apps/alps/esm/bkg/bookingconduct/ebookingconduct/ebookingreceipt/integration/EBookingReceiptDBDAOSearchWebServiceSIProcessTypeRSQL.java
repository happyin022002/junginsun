/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : EBookingReceiptDBDAOSearchWebServiceSIProcessTypeRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.07.19
*@LastModifier : 윤용상
*@LastVersion : 1.0
* 2016.07.19 윤용상
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esm.bkg.bookingconduct.ebookingconduct.ebookingreceipt.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author YOON Yong-Sang
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class EBookingReceiptDBDAOSearchWebServiceSIProcessTypeRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * external request 처리를 위해 external rqst의 Job Type, BKG Block Flag, Manual Flag 정보를 조회한다.
	  * </pre>
	  */
	public EBookingReceiptDBDAOSearchWebServiceSIProcessTypeRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rqst_seq",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rqst_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("bkg_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sender_id",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esm.bkg.bookingconduct.ebookingconduct.ebookingreceipt.integration").append("\n"); 
		query.append("FileName : EBookingReceiptDBDAOSearchWebServiceSIProcessTypeRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("WITH TMLIM AS(" ).append("\n"); 
		query.append("SELECT (SELECT CASE WHEN 'KR' = SUBSTR(BK.POL_CD,1,2) AND (SELECT BKG_GET_DCT_COFF_FNC(BK.BKG_NO) FROM DUAL) IS NOT NULL 			" ).append("\n"); 
		query.append("               THEN (SELECT BKG_GET_DCT_COFF_FNC(BK.BKG_NO) FROM DUAL)			" ).append("\n"); 
		query.append("               ELSE NVL(MNL_SET_DT, SYS_SET_DT) END" ).append("\n"); 
		query.append("          FROM BKG_CLZ_TM TM" ).append("\n"); 
		query.append("         WHERE TM.BKG_NO = BK.BKG_NO	" ).append("\n"); 
		query.append("           AND CLZ_TP_CD = 'D') AS DCT_DT		" ).append("\n"); 
		query.append("      ,(SELECT NVL(MNL_SET_DT, SYS_SET_DT) 			" ).append("\n"); 
		query.append("          FROM BKG_CLZ_TM TM			" ).append("\n"); 
		query.append("         WHERE TM.BKG_NO = BK.BKG_NO			" ).append("\n"); 
		query.append("           AND CLZ_TP_CD = 'T') AS CCT_DT" ).append("\n"); 
		query.append("      ,(SELECT ACT_DEP_DT FROM VSK_ACT_PORT_SKD VAP" ).append("\n"); 
		query.append("					WHERE 1=1" ).append("\n"); 
		query.append("					AND VPS.VSL_CD = VAP.VSL_CD" ).append("\n"); 
		query.append("					AND VPS.SKD_VOY_NO = VAP.SKD_VOY_NO" ).append("\n"); 
		query.append("					AND VPS.SKD_DIR_CD = VAP.SKD_DIR_CD" ).append("\n"); 
		query.append("					AND VPS.VPS_PORT_CD = VAP.VPS_PORT_CD" ).append("\n"); 
		query.append("					AND VPS.CLPT_IND_SEQ = VAP.CLPT_IND_SEQ" ).append("\n"); 
		query.append("					AND ROWNUM = 1" ).append("\n"); 
		query.append("				) AS ATD" ).append("\n"); 
		query.append("      ,(SELECT BKG_GET_PORT_CLZ_DT_FNC(BK.BKG_NO) FROM DUAL) PCT_DT" ).append("\n"); 
		query.append("      ,VPS.VPS_ETD_DT AS ETD_DT" ).append("\n"); 
		query.append("      ,VPS.VPS_ETB_DT AS ETB_DT" ).append("\n"); 
		query.append("      ,BLI.OBL_ISS_FLG" ).append("\n"); 
		query.append("      ,BLD.BDR_FLG" ).append("\n"); 
		query.append("      ,POL_ETD_DT    " ).append("\n"); 
		query.append("      ,( SELECT MAX(DTL.DEP_FSH_DT) " ).append("\n"); 
		query.append("		   FROM PRD_PROD_CTL_ROUT_DTL DTL" ).append("\n"); 
		query.append("		  WHERE BK.PCTL_NO     = DTL.PCTL_NO" ).append("\n"); 
		query.append(" 		    AND PCTL_IO_BND_CD  = 'T'" ).append("\n"); 
		query.append("		    AND DTL.TRSP_MOD_CD IN ('VD', 'WD')) AS POD_ETA_DT" ).append("\n"); 
		query.append("      ,DECODE(BK.BKG_STS_CD,'W','Y','X','Y','N') BKG_STS_FLG" ).append("\n"); 
		query.append("      ,( SELECT /*+ INDEX_ASC(VVD XPKBKG_VVD) */ TO_CHAR(SKD.ACT_ARR_DT, 'YYYY-MM-DD HH24:MI:SS')" ).append("\n"); 
		query.append("          FROM BKG_VVD VVD, VSK_ACT_PORT_SKD SKD" ).append("\n"); 
		query.append("         WHERE 1=1" ).append("\n"); 
		query.append("           AND BK.BKG_NO = VVD.BKG_NO" ).append("\n"); 
		query.append("           AND BK.POD_CD = VVD.POD_CD" ).append("\n"); 
		query.append("           AND VVD.VSL_CD = SKD.VSL_CD " ).append("\n"); 
		query.append("           AND VVD.SKD_VOY_NO = SKD.SKD_VOY_NO" ).append("\n"); 
		query.append("           AND VVD.SKD_DIR_CD = SKD.SKD_DIR_CD" ).append("\n"); 
		query.append("           AND VVD.POD_CD = SKD.VPS_PORT_CD" ).append("\n"); 
		query.append("           AND VVD.POD_CLPT_IND_SEQ = SKD.CLPT_IND_SEQ" ).append("\n"); 
		query.append("           AND VSL_PRE_PST_CD IN ('T','U')" ).append("\n"); 
		query.append("           AND SKD.PORT_SKD_STS_CD = 'A'" ).append("\n"); 
		query.append("           AND ROWNUM=1 ) AS POD_ATA_DT" ).append("\n"); 
		query.append("      ,(SELECT COUNT(*) FROM BKG_CSTMS_ADV_EUR_SND WHERE BL_NO = BK.BL_NO AND EUR_EDI_MSG_TP_ID='ENS' AND SND_DT IS NOT NULL) ADV_EUR_CSTMS" ).append("\n"); 
		query.append("      ,(SELECT COUNT(*) FROM BKG_CSTMS_ADV_JP_SND_LOG WHERE BL_NO = BK.BL_NO AND SND_DT IS NOT NULL) ADV_JP_CSTMS" ).append("\n"); 
		query.append("      ,(SELECT COUNT(*) FROM BKG_CSTMS_ADV_BL WHERE BKG_NO = BK.BKG_NO AND MF_SND_DT IS NOT NULL) ADV_US_CSTMS" ).append("\n"); 
		query.append("      ,(SELECT COUNT(*) FROM BKG_CSTMS_CHN_SND_LOG_BL BL, BKG_CSTMS_CHN_SND_LOG SND WHERE BK.BL_NO = BL.BL_NO AND BL.EDI_REF_ID = SND.EDI_REF_ID AND SND.MF_SND_DT IS NOT NULL) ADV_CN_CSTMS" ).append("\n"); 
		query.append("	  ,(SELECT COUNT(*) FROM BKG_NTC_HIS WHERE BKG_NO = BK.BKG_NO AND NTC_KND_CD = 'IM' AND EDI_ID = 'MEXCUS') ADV_MX_CSTMS" ).append("\n"); 
		query.append("      ,(SELECT COUNT(*) FROM BKG_CSTMS_SRI_VVD WHERE VSL_CD=BK.VSL_CD AND SKD_VOY_NO=BK.SKD_VOY_NO AND SKD_DIR_CD=BK.SKD_DIR_CD AND IO_BND_CD='O' AND SND_DT IS NOT NULL) SRI_CSTMS" ).append("\n"); 
		query.append("      ,(SELECT COUNT(*) FROM BKG_CSTMS_BD_CNTR WHERE BD_CSTMS_BND_CD='O' AND BL_NO=BK.BL_NO) BD_CSTMS" ).append("\n"); 
		query.append("      ,(SELECT COUNT(*) FROM BKG_CSTMS_MM_SND_LOG WHERE CSTMS_BND_CD='O' AND BKG_NO =BK.BKG_NO AND MF_SND_DT IS NOT NULL) MM_CSTMS" ).append("\n"); 
		query.append("      ,(SELECT COUNT(*) FROM BKG_CSTMS_MY_SND_LOG WHERE MY_CSTMS_BND_CD ='E' AND VSL_CD=BK.VSL_CD AND SKD_VOY_NO=BK.SKD_VOY_NO AND SKD_DIR_CD=BK.SKD_DIR_CD AND SND_DT IS NOT NULL) MY_CSTMS" ).append("\n"); 
		query.append("      ,(SELECT COUNT(*) FROM BKG_CSTMS_VN_SND_LOG WHERE VN_CSTMS_BND_CD ='E' AND BKG_NO = BK.BKG_NO AND MF_SND_DT IS NOT NULL) VN_CSTMS" ).append("\n"); 
		query.append("      ,(SELECT COUNT(*) FROM BKG_CSTMS_KR_SND_LOG WHERE BL_NO = BK.BL_NO AND SND_DT IS NOT NULL) KR_CSTMS" ).append("\n"); 
		query.append("      ,(SELECT COUNT(*) FROM BKG_CSTMS_EUR_IO_SND WHERE BND_TP_CD ='O' AND BL_NO =BK.BL_NO AND EUR_EDI_MSG_TP_ID='EXS' AND SND_DT IS NOT NULL) EUR_CSTMS" ).append("\n"); 
		query.append("	  ,BL_NO" ).append("\n"); 
		query.append(" FROM BKG_BOOKING BK" ).append("\n"); 
		query.append("     ,BKG_VVD     VVD" ).append("\n"); 
		query.append("     ,VSK_VSL_PORT_SKD VPS" ).append("\n"); 
		query.append("     ,BKG_BL_ISS BLI" ).append("\n"); 
		query.append("     ,BKG_BL_DOC BLD" ).append("\n"); 
		query.append("WHERE BK.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("  AND BK.BKG_NO           =   VVD.BKG_NO" ).append("\n"); 
		query.append("  AND BK.BKG_NO           =   BLI.BKG_NO(+)" ).append("\n"); 
		query.append("  AND BK.BKG_NO           =   BLD.BKG_NO(+)" ).append("\n"); 
		query.append("  AND VPS.VSL_CD          =   VVD.VSL_CD" ).append("\n"); 
		query.append("  AND VPS.SKD_VOY_NO      =   VVD.SKD_VOY_NO" ).append("\n"); 
		query.append("  AND VPS.SKD_DIR_CD      =   VVD.SKD_DIR_CD" ).append("\n"); 
		query.append("  AND VPS.CLPT_IND_SEQ    =   VVD.POL_CLPT_IND_SEQ" ).append("\n"); 
		query.append("  AND VPS.VPS_PORT_CD     =   VVD.POL_CD) " ).append("\n"); 
		query.append(",XTERMST AS (" ).append("\n"); 
		query.append("SELECT CASE WHEN X.POR_CD !=BK.POR_CD OR X.POR_CD != BL.POR_CD THEN 'Y' " ).append("\n"); 
		query.append("            WHEN X.POR_NM !=BL.POR_NM THEN 'Y' ELSE 'N' END             AS POR_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN X.PRE_VSL_NM !=BL.PRE_VSL_NM THEN 'Y' ELSE 'N' END     AS PRE_VSL_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN X.VSL_NM !=BL.VSL_NM THEN 'Y' ELSE 'N' END             AS VSL_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN X.POL_CD !=BK.POL_CD OR X.POL_CD != BL.POL_CD THEN 'Y' " ).append("\n"); 
		query.append("            WHEN X.POL_NM !=BL.POL_NM THEN 'Y' ELSE 'N' END             AS POL_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN X.POD_CD !=BK.POD_CD OR X.POD_CD != BL.POD_CD THEN 'Y' " ).append("\n"); 
		query.append("            WHEN X.POD_NM !=BL.POD_NM THEN 'Y' ELSE 'N' END             AS POD_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN X.DEL_CD !=BK.DEL_CD OR X.DEL_CD != BL.DEL_CD THEN 'Y' " ).append("\n"); 
		query.append("            WHEN X.DEL_NM !=BL.DEL_NM THEN 'Y' ELSE 'N' END             AS DEL_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN X.RCV_TERM_CD !=BK.RCV_TERM_CD THEN 'Y' ELSE 'N' END   AS RCV_TERM_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN X.DE_TERM_CD != BK.DE_TERM_CD THEN 'Y' ELSE 'N' END   AS DE_TERM_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN DBMS_LOB.COMPARE(REPLACE(REPLACE(REPLACE(X.MK_DESC, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)), REPLACE(REPLACE(REPLACE(MK.MK_DESC, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10))) != 0 THEN 'Y' ELSE 'N' END AS MK_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN DBMS_LOB.COMPARE(REPLACE(REPLACE(REPLACE(SUBSTR(X.GDS_DESC,REGEXP_INSTR(GDS_DESC,'[[:alpha:]|[:digit:]|[:punct:]]'),BKG_GET_ENTER_FNC(GDS_DESC)), CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)), REPLACE(REPLACE(REPLACE(SUBSTR(MK.CMDT_DESC,REGEXP_INSTR(MK.CMDT_DESC,'[[:alpha:]|[:digit:]|[:punct:]]'),BKG_GET_ENTER_FNC(MK.CMDT_DESC)), CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10))) != 0 THEN 'Y' ELSE 'N' END AS DES_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN X.KR_CSTMS_CUST_TP_CD !=BK.KR_CSTMS_CUST_TP_CD THEN 'Y' ELSE 'N' END AS KR_CSTMS_CUST_TP_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN X.XTER_BL_TP_CD !=BI.RQST_BL_TP_CD THEN 'Y' ELSE 'N' END AS BL_TP_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN X.FRT_TERM_CD !=BR.FRT_TERM_CD THEN 'Y' ELSE 'N' END AS FRT_TERM_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN X.CSTMS_DESC !=BL.CSTMS_DESC THEN 'Y' ELSE 'N' END AS CSTMS_DESC_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN REPLACE(REPLACE(REPLACE(X.XTER_BKG_RMK1, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) != REPLACE(REPLACE(REPLACE(BK.XTER_RMK, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) THEN 'Y' ELSE 'N' END AS RMK_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN (SELECT COUNT(*) FROM BKG_CLUZ_LCK WHERE BKG_NO = @[bkg_no] AND DBMS_LOB.INSTR(REPLACE(REPLACE(REPLACE(X.GDS_DESC, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)), CLUZ_LCK_DESC , 1, 1) = 0) > 0 THEN 'Y' ELSE 'N' END AS CLUZ_LCK_FLG" ).append("\n"); 
		query.append("      ,CASE WHEN ESTM_WGT = 0 THEN 'Y' ELSE 'N' END AS WGT_FLG" ).append("\n"); 
		query.append("      ,XTER_SNDR_ID" ).append("\n"); 
		query.append("      ,XTER_RQST_NO" ).append("\n"); 
		query.append("      ,XTER_RQST_SEQ" ).append("\n"); 
		query.append("      ,X.BKG_NO" ).append("\n"); 
		query.append("	  ,X.CMPB_RT_FLG" ).append("\n"); 
		query.append("  FROM BKG_XTER_RQST_MST X" ).append("\n"); 
		query.append("      ,BKG_BOOKING BK" ).append("\n"); 
		query.append("      ,BKG_BL_DOC  BL" ).append("\n"); 
		query.append("      ,BKG_BL_ISS  BI" ).append("\n"); 
		query.append("      ,BKG_RATE    BR" ).append("\n"); 
		query.append("      ,BKG_BL_MK_DESC MK" ).append("\n"); 
		query.append(" WHERE X.XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("   AND X.XTER_RQST_NO =@[rqst_no]" ).append("\n"); 
		query.append("   AND X.XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("   AND X.BKG_NO = BK.BKG_NO" ).append("\n"); 
		query.append("   AND BK.BKG_NO = BL.BKG_NO" ).append("\n"); 
		query.append("   AND BK.BKG_NO = BI.BKG_NO(+)" ).append("\n"); 
		query.append("   AND BK.BKG_NO = BR.BKG_NO(+)" ).append("\n"); 
		query.append("   AND BK.BKG_NO = MK.BKG_NO(+)" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(",XTERCUST AS (" ).append("\n"); 
		query.append("SELECT CASE WHEN REPLACE(REPLACE(REPLACE(XC1.CUST_NM, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) != REPLACE(REPLACE(REPLACE(BC1.CUST_NM, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) THEN 'Y' ELSE 'N' END AS SH_NM_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN REPLACE(REPLACE(REPLACE(XC1.CUST_ADDR, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) != REPLACE(REPLACE(REPLACE(BC1.CUST_ADDR, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) THEN 'Y' ELSE 'N' END AS SH_ADDR_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC1.LOC_CTNT != BC1.CSTMS_DECL_CNT_CD THEN 'Y' ELSE 'N' END AS SH_CTRY_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC1.PST_CTNT != BC1.CUST_ZIP_ID THEN 'Y' ELSE 'N' END AS SH_ZIP_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC1.EORI_NO != BC1.CUST_CTY_NM THEN 'Y' ELSE 'N' END AS SH_EORI_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC1.LOC_NM != BC1.CUST_CTY_NM THEN 'Y' ELSE 'N' END AS SH_CITY_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC1.STE_CD != BC1.CUST_STE_CD THEN 'Y' ELSE 'N' END AS SH_STE_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC1.EUR_CSTMS_ST_NM != BC1.EUR_CSTMS_ST_NM THEN 'Y' ELSE 'N' END AS SH_ST_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC1.MX_TAX_ID != MX.MX_SHPR_TAX_ID THEN 'Y' ELSE 'N' END AS MX_SHPR_TAX_ID_MOD " ).append("\n"); 
		query.append("      ,CASE WHEN XC1.TR_TAX_ID != MX.TR_SHPR_TAX_ID THEN 'Y' ELSE 'N' END AS TR_SHPR_TAX_ID_MOD " ).append("\n"); 
		query.append("      ,CASE WHEN XC1.IL_TAX_ID != MX.IL_SHPR_TAX_ID THEN 'Y' ELSE 'N' END AS IL_SHPR_TAX_ID_MOD " ).append("\n"); 
		query.append("      ,CASE WHEN XC1.LB_TAX_ID != MX.LB_SHPR_TAX_ID THEN 'Y' ELSE 'N' END AS LB_SHPR_TAX_ID_MOD " ).append("\n"); 
		query.append("      ,CASE WHEN XC1.BRZ_TAX_ID != MX.SHPR_TAX_NO THEN 'Y' ELSE 'N' END AS BRZ_SHPR_TAX_ID_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN REPLACE(REPLACE(REPLACE(XC2.CUST_NM, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) != REPLACE(REPLACE(REPLACE(BC2.CUST_NM, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) THEN 'Y' ELSE 'N' END AS CN_NM_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN REPLACE(REPLACE(REPLACE(XC2.CUST_ADDR, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) != REPLACE(REPLACE(REPLACE(BC2.CUST_ADDR, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) THEN 'Y' ELSE 'N' END AS CN_ADDR_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC2.LOC_CTNT != BC2.CSTMS_DECL_CNT_CD THEN 'Y' ELSE 'N' END AS CN_CTRY_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC2.PST_CTNT != BC2.CUST_ZIP_ID THEN 'Y' ELSE 'N' END AS CN_ZIP_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC2.EORI_NO != BC2.CUST_CTY_NM THEN 'Y' ELSE 'N' END AS CN_EORI_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC2.LOC_NM != BC2.CUST_CTY_NM THEN 'Y' ELSE 'N' END AS CN_CITY_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC2.STE_CD != BC2.CUST_STE_CD THEN 'Y' ELSE 'N' END AS CN_STE_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC2.EUR_CSTMS_ST_NM != BC2.EUR_CSTMS_ST_NM THEN 'Y' ELSE 'N' END AS CN_ST_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC2.MX_TAX_ID != MX.MX_CNEE_TAX_ID THEN 'Y' ELSE 'N' END AS MX_CNEE_TAX_ID_MOD " ).append("\n"); 
		query.append("      ,CASE WHEN XC2.TR_TAX_ID != MX.TR_CNEE_TAX_ID THEN 'Y' ELSE 'N' END AS TR_CNEE_TAX_ID_MOD " ).append("\n"); 
		query.append("      ,CASE WHEN XC2.IL_TAX_ID != MX.IL_CNEE_TAX_ID THEN 'Y' ELSE 'N' END AS IL_CNEE_TAX_ID_MOD " ).append("\n"); 
		query.append("      ,CASE WHEN XC2.LB_TAX_ID != MX.LB_CNEE_TAX_ID THEN 'Y' ELSE 'N' END AS LB_CNEE_TAX_ID_MOD " ).append("\n"); 
		query.append("      ,CASE WHEN XC2.BRZ_TAX_ID != MX.CNEE_TAX_NO THEN 'Y' ELSE 'N' END AS BRZ_CNEE_TAX_ID_MOD       " ).append("\n"); 
		query.append("      ,CASE WHEN REPLACE(REPLACE(REPLACE(XC3.CUST_NM, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) != REPLACE(REPLACE(REPLACE(BC3.CUST_NM, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) THEN 'Y' ELSE 'N' END AS NF_NM_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN REPLACE(REPLACE(REPLACE(XC3.CUST_ADDR, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) != REPLACE(REPLACE(REPLACE(BC3.CUST_ADDR, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) THEN 'Y' ELSE 'N' END AS NF_ADDR_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC3.LOC_CTNT != BC3.CSTMS_DECL_CNT_CD THEN 'Y' ELSE 'N' END AS NF_CTRY_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC3.PST_CTNT != BC3.CUST_ZIP_ID THEN 'Y' ELSE 'N' END AS NF_ZIP_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC3.EORI_NO != BC3.CUST_CTY_NM THEN 'Y' ELSE 'N' END AS NF_EORI_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC3.LOC_NM != BC3.CUST_CTY_NM THEN 'Y' ELSE 'N' END AS NF_CITY_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC3.STE_CD != BC3.CUST_STE_CD THEN 'Y' ELSE 'N' END AS NF_STE_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC3.EUR_CSTMS_ST_NM != BC3.EUR_CSTMS_ST_NM THEN 'Y' ELSE 'N' END AS NF_ST_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN XC3.MX_TAX_ID != MX.MX_NTFY_TAX_ID THEN 'Y' ELSE 'N' END AS MX_NTFY_TAX_ID_MOD " ).append("\n"); 
		query.append("      ,CASE WHEN XC3.TR_TAX_ID != MX.TR_NTFY_TAX_ID THEN 'Y' ELSE 'N' END AS TR_NTFY_TAX_ID_MOD " ).append("\n"); 
		query.append("      ,CASE WHEN XC3.IL_TAX_ID != MX.IL_NTFY_TAX_ID THEN 'Y' ELSE 'N' END AS IL_NTFY_TAX_ID_MOD " ).append("\n"); 
		query.append("      ,CASE WHEN XC3.LB_TAX_ID != MX.LB_NTFY_TAX_ID THEN 'Y' ELSE 'N' END AS LB_NTFY_TAX_ID_MOD " ).append("\n"); 
		query.append("      ,CASE WHEN XC3.BRZ_TAX_ID != MX.NTFY_TAX_NO THEN 'Y' ELSE 'N' END AS BRZ_NTFY_TAX_ID_MOD       " ).append("\n"); 
		query.append("      ,CASE WHEN REPLACE(REPLACE(REPLACE(XC4.CUST_NM, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) != REPLACE(REPLACE(REPLACE(BC4.CUST_NM, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) THEN 'Y' ELSE 'N' END AS FF_NM_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN REPLACE(REPLACE(REPLACE(XC5.CUST_NM, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) != REPLACE(REPLACE(REPLACE(BC5.CUST_NM, CHR(13)||CHR(10), CHR(13)), CHR(10), CHR(13)), CHR(13), CHR(13)||CHR(10)) THEN 'Y' ELSE 'N' END AS AN_NM_MOD" ).append("\n"); 
		query.append("	  ,CASE WHEN (XM.POR_CD LIKE 'IR%' OR XM.POL_CD LIKE 'IR%' OR XM.POD_CD LIKE 'IR%' OR XM.DEL_CD LIKE 'IR%') AND INSTR(UPPER(XC2.CUST_NM), 'ORDER') > 0 THEN 'Y' ELSE 'N' END AS IR_TO_ORD_FLG" ).append("\n"); 
		query.append("  FROM BKG_XTER_RQST_MST XM" ).append("\n"); 
		query.append("      ,BKG_XTER_CUST XC1" ).append("\n"); 
		query.append("      ,BKG_CUSTOMER BC1" ).append("\n"); 
		query.append("      ,BKG_XTER_CUST XC2" ).append("\n"); 
		query.append("      ,BKG_CUSTOMER BC2" ).append("\n"); 
		query.append("      ,BKG_XTER_CUST XC3" ).append("\n"); 
		query.append("      ,BKG_CUSTOMER BC3" ).append("\n"); 
		query.append("      ,BKG_XTER_CUST XC4" ).append("\n"); 
		query.append("      ,BKG_CUSTOMER BC4" ).append("\n"); 
		query.append("      ,BKG_XTER_CUST XC5" ).append("\n"); 
		query.append("      ,BKG_CUSTOMER BC5" ).append("\n"); 
		query.append("      ,BKG_XPT_IMP_LIC MX" ).append("\n"); 
		query.append("      ,BKG_XPT_IMP_LIC TR" ).append("\n"); 
		query.append("      ,BKG_XPT_IMP_LIC IL" ).append("\n"); 
		query.append("      ,BKG_XPT_IMP_LIC LB" ).append("\n"); 
		query.append("      ,BKG_XPT_IMP_LIC BR" ).append("\n"); 
		query.append(" WHERE XM.XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("   AND XM.XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("   AND XM.XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("   AND XM.XTER_SNDR_ID= XC1.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("   AND XM.XTER_RQST_NO = XC1.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("   AND XM.XTER_RQST_SEQ = XC1.XTER_RQST_SEQ(+)   " ).append("\n"); 
		query.append("   AND XC1.XTER_CUST_TP_CD(+) ='S'" ).append("\n"); 
		query.append("   AND XM.BKG_NO = BC1.BKG_NO(+)" ).append("\n"); 
		query.append("   AND BC1.BKG_CUST_TP_CD(+) ='S'" ).append("\n"); 
		query.append("   AND XM.XTER_SNDR_ID= XC2.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("   AND XM.XTER_RQST_NO = XC2.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("   AND XM.XTER_RQST_SEQ = XC2.XTER_RQST_SEQ(+)   " ).append("\n"); 
		query.append("   AND XC2.XTER_CUST_TP_CD(+) ='C'" ).append("\n"); 
		query.append("   AND XM.BKG_NO = BC2.BKG_NO(+)" ).append("\n"); 
		query.append("   AND BC2.BKG_CUST_TP_CD(+) ='C'" ).append("\n"); 
		query.append("   AND XM.XTER_SNDR_ID= XC3.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("   AND XM.XTER_RQST_NO = XC3.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("   AND XM.XTER_RQST_SEQ = XC3.XTER_RQST_SEQ(+)   " ).append("\n"); 
		query.append("   AND XC3.XTER_CUST_TP_CD(+) ='N'" ).append("\n"); 
		query.append("   AND XM.BKG_NO = BC3.BKG_NO(+)" ).append("\n"); 
		query.append("   AND BC3.BKG_CUST_TP_CD(+) ='N'" ).append("\n"); 
		query.append("   AND XM.XTER_SNDR_ID= XC4.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("   AND XM.XTER_RQST_NO = XC4.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("   AND XM.XTER_RQST_SEQ = XC4.XTER_RQST_SEQ(+)   " ).append("\n"); 
		query.append("   AND XC4.XTER_CUST_TP_CD(+) ='F'" ).append("\n"); 
		query.append("   AND XM.BKG_NO = BC4.BKG_NO(+)" ).append("\n"); 
		query.append("   AND BC4.BKG_CUST_TP_CD(+) ='F'" ).append("\n"); 
		query.append("   AND XM.XTER_SNDR_ID= XC5.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("   AND XM.XTER_RQST_NO = XC5.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("   AND XM.XTER_RQST_SEQ = XC5.XTER_RQST_SEQ(+)   " ).append("\n"); 
		query.append("   AND XC5.XTER_CUST_TP_CD(+) ='A'" ).append("\n"); 
		query.append("   AND XM.BKG_NO = BC5.BKG_NO(+)" ).append("\n"); 
		query.append("   AND BC5.BKG_CUST_TP_CD(+) ='A'" ).append("\n"); 
		query.append("   AND XM.BKG_NO = MX.BKG_NO(+)" ).append("\n"); 
		query.append("   AND MX.CNT_CD(+) = 'MX'" ).append("\n"); 
		query.append("   AND XM.BKG_NO = TR.BKG_NO(+)" ).append("\n"); 
		query.append("   AND TR.CNT_CD(+) = 'TR'" ).append("\n"); 
		query.append("   AND XM.BKG_NO = IL.BKG_NO(+)" ).append("\n"); 
		query.append("   AND IL.CNT_CD(+) = 'IL'" ).append("\n"); 
		query.append("   AND XM.BKG_NO = LB.BKG_NO(+)" ).append("\n"); 
		query.append("   AND LB.CNT_CD(+) = 'LB'" ).append("\n"); 
		query.append("   AND XM.BKG_NO = BR.BKG_NO(+)" ).append("\n"); 
		query.append("   AND BR.CNT_CD(+) = 'BR' " ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(",XTERAES AS (" ).append("\n"); 
		query.append("SELECT CASE WHEN XA.AES_INLND_TRNS_NO != BX.AES_INLND_TRNS_NO THEN 'Y' " ).append("\n"); 
		query.append("             WHEN XA.AES_PTA_NO1 != BX.AES_PTA_NO1 THEN 'Y' " ).append("\n"); 
		query.append("             WHEN XA.AES_PTA_NO2 != BX.AES_PTA_NO2 THEN 'Y' " ).append("\n"); 
		query.append("             WHEN XA.AES_PTA_DT != BX.AES_PTA_DT THEN 'Y' " ).append("\n"); 
		query.append("             WHEN XA.AES_PTU_NO != BX.AES_PTU_NO THEN 'Y'" ).append("\n"); 
		query.append("             WHEN XA.AES_PTU_DT != BX.AES_PTU_DT THEN 'Y'" ).append("\n"); 
		query.append("             WHEN XA.AES_DWN_NO != BX.AES_DWN_DT THEN 'Y'" ).append("\n"); 
		query.append("             WHEN XA.AES_EXPT_CTNT != BX.AES_EXPT_CTNT THEN 'Y'" ).append("\n"); 
		query.append("             WHEN XA.VIN_CTNT != BX.VIN_CTNT THEN 'Y'" ).append("\n"); 
		query.append("             ELSE 'N' END AS AES_MOD" ).append("\n"); 
		query.append("   FROM BKG_XTER_RQST_MST XM" ).append("\n"); 
		query.append("       ,BKG_XTER_AES XA" ).append("\n"); 
		query.append("       ,(SELECT BKG_NO" ).append("\n"); 
		query.append("               ,AES_INLND_TRNS_NO" ).append("\n"); 
		query.append("               ,AES_PTA_NO1,AES_PTA_NO2,AES_PTA_DT" ).append("\n"); 
		query.append("               ,AES_PTU_NO,AES_PTU_DT" ).append("\n"); 
		query.append("               ,AES_DWN_NO,AES_DWN_DT" ).append("\n"); 
		query.append("               ,AES_EXPT_CTNT" ).append("\n"); 
		query.append("               ,VIN_CTNT " ).append("\n"); 
		query.append("          FROM BKG_XPT_IMP_LIC A" ).append("\n"); 
		query.append("         WHERE BKG_NO = (SELECT BKG_NO FROM BKG_XTER_RQST_MST WHERE XTER_SNDR_ID=@[sender_id] AND XTER_RQST_NO =@[rqst_no] AND XTER_RQST_SEQ = @[rqst_seq]) " ).append("\n"); 
		query.append("           AND CNT_CD = 'US'" ).append("\n"); 
		query.append("           AND IO_BND_CD = 'O'" ).append("\n"); 
		query.append("           AND XPT_IMP_SEQ = (SELECT MAX(XPT_IMP_SEQ) FROM BKG_XPT_IMP_LIC WHERE BKG_NO = A.BKG_NO AND CNT_CD='US' AND IO_BND_CD='O')) BX" ).append("\n"); 
		query.append("  WHERE XM.XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("    AND XM.XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("    AND XM.XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("    AND XM.XTER_SNDR_ID= XA.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("    AND XM.XTER_RQST_NO = XA.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("    AND XM.XTER_RQST_SEQ = XA.XTER_RQST_SEQ(+)" ).append("\n"); 
		query.append("    AND XM.BKG_NO = BX.BKG_NO(+)   " ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(",XTERCAED AS (" ).append("\n"); 
		query.append("SELECT CASE WHEN XC.CAED_CTNT1 != BX.CAED_NO1 THEN 'Y' " ).append("\n"); 
		query.append("             WHEN XC.CAED_CTNT2 != BX.CAED_NO2 THEN 'Y' " ).append("\n"); 
		query.append("             WHEN XC.CAED_CTNT3 != BX.CAED_NO3 THEN 'Y' " ).append("\n"); 
		query.append("             WHEN XC.G7_EDI_CTNT1 != BX.G7_EDI_NO1 THEN 'Y' " ).append("\n"); 
		query.append("             WHEN XC.G7_EDI_CTNT2 != BX.G7_EDI_NO2 THEN 'Y'" ).append("\n"); 
		query.append("             WHEN XC.SMRY_RPT_CTNT1 != BX.MF_SMRY_RPT_PFX_CTNT THEN 'Y'" ).append("\n"); 
		query.append("             WHEN XC.SMRY_RPT_CTNT2 != BX.MF_SMRY_RPT_NO THEN 'Y'" ).append("\n"); 
		query.append("             WHEN XC.B13A_DT != BX.B13A_XPT_DT THEN 'Y'" ).append("\n"); 
		query.append("             WHEN XC.B13A_CTNT1 != BX.B13A_XPT_NO1 THEN 'Y'" ).append("\n"); 
		query.append("             WHEN XC.B13A_CTNT2 != BX.B13A_XPT_NO2 THEN 'Y'" ).append("\n"); 
		query.append("             WHEN XC.INLND_TZ_CGO_CTNT != BX.CGO_CTRL_NO THEN 'Y'" ).append("\n"); 
		query.append("             WHEN XC.NON_DECL_CTNT != BX.NDR_REF_ID||BX.NDR_REF_CTNT THEN 'Y'" ).append("\n"); 
		query.append("             ELSE 'N' END AS CAED_MOD" ).append("\n"); 
		query.append("   FROM BKG_XTER_RQST_MST XM" ).append("\n"); 
		query.append("       ,BKG_XTER_CAED XC" ).append("\n"); 
		query.append("       ,(SELECT BKG_NO,CAED_NO1,CAED_NO2,CAED_NO3" ).append("\n"); 
		query.append("               ,G7_EDI_NO1,G7_EDI_NO2" ).append("\n"); 
		query.append("               ,MF_SMRY_RPT_PFX_CTNT,MF_SMRY_RPT_NO" ).append("\n"); 
		query.append("               ,B13A_XPT_DT,B13A_XPT_NO1,B13A_XPT_NO2" ).append("\n"); 
		query.append("               ,CGO_CTRL_NO" ).append("\n"); 
		query.append("               ,NDR_REF_ID,NDR_REF_CTNT" ).append("\n"); 
		query.append("          FROM BKG_XPT_IMP_LIC A" ).append("\n"); 
		query.append("         WHERE BKG_NO = (SELECT BKG_NO FROM BKG_XTER_RQST_MST WHERE XTER_SNDR_ID=@[sender_id] AND XTER_RQST_NO =@[rqst_no] AND XTER_RQST_SEQ = @[rqst_seq]) " ).append("\n"); 
		query.append("           AND CNT_CD = 'CA'" ).append("\n"); 
		query.append("           AND IO_BND_CD = 'O'" ).append("\n"); 
		query.append("           AND XPT_IMP_SEQ = (SELECT MAX(XPT_IMP_SEQ) FROM BKG_XPT_IMP_LIC WHERE BKG_NO = A.BKG_NO AND CNT_CD='CA' AND IO_BND_CD='O')) BX" ).append("\n"); 
		query.append("  WHERE XM.XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("    AND XM.XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("    AND XM.XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("    AND XM.XTER_SNDR_ID= XC.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("    AND XM.XTER_RQST_NO = XC.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("    AND XM.XTER_RQST_SEQ = XC.XTER_RQST_SEQ(+)" ).append("\n"); 
		query.append("    AND XM.BKG_NO = BX.BKG_NO(+)" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(",XTERCNTR AS (" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("		case when (" ).append("\n"); 
		query.append(" select count(*) from bkg_xter_rqst_mst  " ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no] " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("                           and por_cd like 'KR%' ) < 1" ).append("\n"); 
		query.append("                           THEN 'N' ELSE case when " ).append("\n"); 
		query.append("                           (SELECT count(*)" ).append("\n"); 
		query.append("                          FROM BKG_XTER_CNTR " ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no] " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("                           and CNTR_NO is not null and PCK_QTY is not null and PCK_TP_CD is not null and CNTR_WGT is not null and WGT_UT_CD is not null and MEAS_QTY is not null and MEAS_UT_CD is not null" ).append("\n"); 
		query.append("                           ) > 0 THEN 'N' ELSE 'Y' END END as CNTR_KR_MNL," ).append("\n"); 
		query.append("		CASE WHEN (SELECT COUNT(*) FROM BKG_CONTAINER WHERE BKG_NO = @[bkg_no]) > 0 AND " ).append("\n"); 
		query.append("                (SELECT COUNT(*) " ).append("\n"); 
		query.append("                  FROM (" ).append("\n"); 
		query.append("                        SELECT CNTR_NO,SOC_FLG" ).append("\n"); 
		query.append("                          FROM BKG_XTER_CNTR " ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("                        MINUS  " ).append("\n"); 
		query.append("                        SELECT CNTR_NO,SOC_FLG" ).append("\n"); 
		query.append("                          FROM BKG_CONTAINER " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                        UNION " ).append("\n"); 
		query.append("                        SELECT CNTR_NO,SOC_FLG" ).append("\n"); 
		query.append("                          FROM BKG_CONTAINER " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                        MINUS" ).append("\n"); 
		query.append("                        SELECT CNTR_NO,SOC_FLG" ).append("\n"); 
		query.append("                          FROM BKG_XTER_CNTR " ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq])) > 0 THEN 'Y' ELSE 'N' END AS CNTR_NO_MOD" ).append("\n"); 
		query.append("       ,CASE WHEN (SELECT COUNT(*) FROM BKG_CONTAINER WHERE BKG_NO = @[bkg_no]) > 0 AND " ).append("\n"); 
		query.append("                (SELECT COUNT(*) " ).append("\n"); 
		query.append("                  FROM (" ).append("\n"); 
		query.append("                        SELECT CNTR_NO,PCK_QTY,PCK_TP_CD,CNTR_WGT,WGT_UT_CD,MEAS_QTY,MEAS_UT_CD" ).append("\n"); 
		query.append("                          FROM BKG_XTER_CNTR " ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("                        MINUS  " ).append("\n"); 
		query.append("                        SELECT CNTR_NO,PCK_QTY,PCK_TP_CD,CNTR_WGT,WGT_UT_CD,MEAS_QTY,MEAS_UT_CD " ).append("\n"); 
		query.append("                          FROM BKG_CONTAINER " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                        UNION " ).append("\n"); 
		query.append("                        SELECT CNTR_NO,PCK_QTY,PCK_TP_CD,CNTR_WGT,WGT_UT_CD,MEAS_QTY,MEAS_UT_CD " ).append("\n"); 
		query.append("                          FROM BKG_CONTAINER " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                        MINUS" ).append("\n"); 
		query.append("                        SELECT CNTR_NO,PCK_QTY,PCK_TP_CD,CNTR_WGT,WGT_UT_CD,MEAS_QTY,MEAS_UT_CD" ).append("\n"); 
		query.append("                          FROM BKG_XTER_CNTR " ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq])) > 0 THEN 'Y' ELSE 'N' END AS CNTR_QTY_MOD" ).append("\n"); 
		query.append("      ,CASE WHEN (SELECT COUNT(*) FROM BKG_CONTAINER WHERE BKG_NO = @[bkg_no]) > 0 AND " ).append("\n"); 
		query.append("                (SELECT COUNT(*) " ).append("\n"); 
		query.append("                  FROM (SELECT CNTR_NO, XTER_CNTR_SEAL_NO " ).append("\n"); 
		query.append("                          FROM BKG_XTER_CNTR_SEAL_NO" ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("                         MINUS " ).append("\n"); 
		query.append("                         SELECT CNTR_NO,CNTR_SEAL_NO" ).append("\n"); 
		query.append("                          FROM BKG_CNTR_SEAL_NO " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                         UNION " ).append("\n"); 
		query.append("                         SELECT CNTR_NO,CNTR_SEAL_NO" ).append("\n"); 
		query.append("                          FROM BKG_CNTR_SEAL_NO " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                         MINUS" ).append("\n"); 
		query.append("                         SELECT CNTR_NO, XTER_CNTR_SEAL_NO " ).append("\n"); 
		query.append("                          FROM BKG_XTER_CNTR_SEAL_NO" ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq])) > 0 THEN 'Y' ELSE 'N' END AS CNTR_SEAL_MOD" ).append("\n"); 
		query.append("     ,CASE WHEN (SELECT COUNT(*) FROM BKG_CONTAINER WHERE BKG_NO = @[bkg_no]) > 0 AND " ).append("\n"); 
		query.append("                (SELECT COUNT(*) " ).append("\n"); 
		query.append("                  FROM (SELECT PCK_QTY,PCK_TP_CD, CNTR_MF_WGT,WGT_UT_CD, HAMO_TRF_CTNT, CMDT_HS_CD" ).append("\n"); 
		query.append("                          FROM BKG_XTER_CNTR_MK_DESC" ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("                         MINUS " ).append("\n"); 
		query.append("                         SELECT PCK_QTY,PCK_TP_CD, CNTR_MF_WGT,WGT_UT_CD, HAMO_TRF_CD, CMDT_HS_CD" ).append("\n"); 
		query.append("                          FROM BKG_CNTR_MF_DESC " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                         UNION" ).append("\n"); 
		query.append("                         SELECT PCK_QTY,PCK_TP_CD, CNTR_MF_WGT,WGT_UT_CD, HAMO_TRF_CD, CMDT_HS_CD" ).append("\n"); 
		query.append("                          FROM BKG_CNTR_MF_DESC " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                         MINUS" ).append("\n"); 
		query.append("                         SELECT PCK_QTY,PCK_TP_CD, CNTR_MF_WGT,WGT_UT_CD, HAMO_TRF_CTNT, CMDT_HS_CD" ).append("\n"); 
		query.append("                           FROM BKG_XTER_CNTR_MK_DESC" ).append("\n"); 
		query.append("                          WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                            AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                            AND XTER_RQST_SEQ = @[rqst_seq])) > 0 THEN 'Y' ELSE 'N' END AS CNTR_MF_MOD  " ).append("\n"); 
		query.append("     ,CASE WHEN (SELECT COUNT(*) FROM BKG_CONTAINER WHERE BKG_NO = @[bkg_no]) > 0 AND " ).append("\n"); 
		query.append("                (SELECT COUNT(*) " ).append("\n"); 
		query.append("                  FROM (SELECT NCM_NO" ).append("\n"); 
		query.append("                          FROM BKG_XTER_CNTR_MK_DESC_NCM" ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("                         MINUS" ).append("\n"); 
		query.append("                        SELECT NCM_NO" ).append("\n"); 
		query.append("                          FROM BKG_CNTR_MF_DESC_DTL" ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                        UNION" ).append("\n"); 
		query.append("                        SELECT NCM_NO" ).append("\n"); 
		query.append("                          FROM BKG_CNTR_MF_DESC_DTL" ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                         MINUS" ).append("\n"); 
		query.append("                        SELECT NCM_NO" ).append("\n"); 
		query.append("                          FROM BKG_XTER_CNTR_MK_DESC_NCM" ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq])) > 0 THEN 'Y' ELSE 'N' END AS CNTR_NCM_MOD  " ).append("\n"); 
		query.append("	, CASE WHEN (SELECT COUNT(*) " ).append("\n"); 
		query.append("                   FROM BKG_XTER_CNTR " ).append("\n"); 
		query.append("                  WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                    AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                    AND XTER_RQST_SEQ = @[rqst_seq]) <> (SELECT SUM(OP_CNTR_QTY) FROM BKG_QUANTITY WHERE BKG_NO =@[bkg_no]) " ).append("\n"); 
		query.append("            AND (SELECT COUNT(*) " ).append("\n"); 
		query.append("                   FROM BKG_XTER_CNTR " ).append("\n"); 
		query.append("                  WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                    AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                    AND XTER_RQST_SEQ = @[rqst_seq]) > 0 THEN 'Y' ELSE 'N' END AS BKG_QTY_MOD     " ).append("\n"); 
		query.append(" FROM DUAL " ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(",XTERLIC AS (" ).append("\n"); 
		query.append("SELECT CASE WHEN (SELECT COUNT(*) " ).append("\n"); 
		query.append("                  FROM (" ).append("\n"); 
		query.append("                        SELECT XPT_LIC_NO, PCK_QTY, PCK_TP_CD, CNTR_WGT, WGT_UT_CD, CGO_DIVD_FLG, SAM_PCK_QTY, SAM_PCK_TP_CD " ).append("\n"); 
		query.append("                          FROM BKG_XTER_XPT_LIC_NO   " ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("                         MINUS  " ).append("\n"); 
		query.append("                        SELECT XPT_LIC_NO, PCK_QTY, PCK_TP_CD, MF_WGT, WGT_UT_CD, DIVD_FLG, SAM_PCK_QTY ,SAM_PCK_TP_CD" ).append("\n"); 
		query.append("                          FROM BKG_XPT_IMP_LIC " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                           AND CNT_CD= 'KR'" ).append("\n"); 
		query.append("                         UNION" ).append("\n"); 
		query.append("                        SELECT XPT_LIC_NO, PCK_QTY, PCK_TP_CD, MF_WGT, WGT_UT_CD, DIVD_FLG, SAM_PCK_QTY ,SAM_PCK_TP_CD" ).append("\n"); 
		query.append("                          FROM BKG_XPT_IMP_LIC " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                           AND CNT_CD= 'KR'" ).append("\n"); 
		query.append("                         MINUS" ).append("\n"); 
		query.append("                        SELECT XPT_LIC_NO, PCK_QTY, PCK_TP_CD, CNTR_WGT, WGT_UT_CD, CGO_DIVD_FLG, SAM_PCK_QTY, SAM_PCK_TP_CD " ).append("\n"); 
		query.append("                          FROM BKG_XTER_XPT_LIC_NO   " ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq])) > 0 THEN 'Y' ELSE 'N' END AS LIC_KR_MOD" ).append("\n"); 
		query.append("       ,CASE WHEN (SELECT COUNT(*) " ).append("\n"); 
		query.append("                  FROM (" ).append("\n"); 
		query.append("                        SELECT XPT_LIC_NO, ID_XPT_NO_ISS_DT" ).append("\n"); 
		query.append("                          FROM BKG_XTER_XPT_LIC_NO   " ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("                         MINUS  " ).append("\n"); 
		query.append("                        SELECT ID_XPT_NO, ID_XPT_NO_ISS_DT" ).append("\n"); 
		query.append("                          FROM BKG_XPT_IMP_LIC " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                           AND CNT_CD= 'ID'" ).append("\n"); 
		query.append("                         UNION" ).append("\n"); 
		query.append("                        SELECT ID_XPT_NO, ID_XPT_NO_ISS_DT" ).append("\n"); 
		query.append("                          FROM BKG_XPT_IMP_LIC " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("                           AND CNT_CD= 'ID'" ).append("\n"); 
		query.append("                         MINUS" ).append("\n"); 
		query.append("                        SELECT XPT_LIC_NO, ID_XPT_NO_ISS_DT" ).append("\n"); 
		query.append("                          FROM BKG_XTER_XPT_LIC_NO   " ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq] )) > 0 THEN 'Y' ELSE 'N' END AS LIC_ID_MOD" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append(" FROM DUAL " ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(",XTERCHG AS (" ).append("\n"); 
		query.append("SELECT CASE WHEN (SELECT COUNT(*) FROM BKG_CHG_RT WHERE BKG_NO = @[bkg_no]) > 0 AND " ).append("\n"); 
		query.append("                (SELECT COUNT(*) " ).append("\n"); 
		query.append("                  FROM (" ).append("\n"); 
		query.append("                        SELECT CHG_CD,TRF_ITM_NO,CURR_CD,RAT_UT_CD,RAT_AS_QTY,CHG_UT_AMT,CHG_AMT,FRT_TERM_CD" ).append("\n"); 
		query.append("                          FROM BKG_XTER_CHG_RT   " ).append("\n"); 
		query.append("                         WHERE XTER_SNDR_ID=@[sender_id]" ).append("\n"); 
		query.append("                           AND XTER_RQST_NO =@[rqst_no]   " ).append("\n"); 
		query.append("                           AND XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("                         MINUS  " ).append("\n"); 
		query.append("                        SELECT CHG_CD,TRF_ITM_NO,CURR_CD,RAT_UT_CD,RAT_AS_QTY,CHG_UT_AMT,CHG_AMT,FRT_TERM_CD" ).append("\n"); 
		query.append("                          FROM BKG_CHG_RT " ).append("\n"); 
		query.append("                         WHERE BKG_NO =@[bkg_no])) > 0 THEN 'Y' ELSE 'N' END AS CHG_MOD          " ).append("\n"); 
		query.append("                         FROM DUAL " ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append(",XTERHBL AS (" ).append("\n"); 
		query.append("SELECT CASE WHEN (SELECT COUNT(*) FROM (" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append(" HBL.HBL_NO" ).append("\n"); 
		query.append(", SH.CUST_NM SHPR_NM" ).append("\n"); 
		query.append(", SH.CUST_ADDR SHPR_ADDR" ).append("\n"); 
		query.append(", CN.CUST_NM CNEE_NM" ).append("\n"); 
		query.append(", CN.CUST_ADDR CNEE_ADDR" ).append("\n"); 
		query.append(", NF.CUST_NM NOTI_NM" ).append("\n"); 
		query.append(", NF.CUST_ADDR NOTI_ADDR" ).append("\n"); 
		query.append(", HBL.HBL_WGT" ).append("\n"); 
		query.append(", HBL.WGT_UT_CD" ).append("\n"); 
		query.append(", HBL.PCK_QTY" ).append("\n"); 
		query.append(", HBL.PCK_TP_CD" ).append("\n"); 
		query.append(", HBL.CMDT_MEAS_QTY" ).append("\n"); 
		query.append(", HBL.CMDT_MEAS_UT_CD" ).append("\n"); 
		query.append(", HBL.BL_MK_DESC" ).append("\n"); 
		query.append(", HBL.BL_GDS_DESC" ).append("\n"); 
		query.append("FROM BKG_HBL HBL, BKG_HBL_CUST SH, BKG_HBL_CUST CN, BKG_HBL_CUST NF" ).append("\n"); 
		query.append("WHERE 1=1" ).append("\n"); 
		query.append("and HBL.BKG_NO       = SH.BKG_NO(+)" ).append("\n"); 
		query.append("and hbl.hbl_seq      = sh.hbl_seq(+)" ).append("\n"); 
		query.append("AND 'S'              = SH.BKG_CUST_TP_CD(+)" ).append("\n"); 
		query.append("AND HBL.BKG_NO       = CN.BKG_NO(+)" ).append("\n"); 
		query.append("and hbl.hbl_seq      = cn.hbl_seq(+)" ).append("\n"); 
		query.append("AND 'C'              = CN.BKG_CUST_TP_CD(+)" ).append("\n"); 
		query.append("AND HBL.BKG_NO       = NF.BKG_NO(+)" ).append("\n"); 
		query.append("and hbl.hbl_seq      = nf.hbl_seq(+)" ).append("\n"); 
		query.append("AND 'N'              = NF.BKG_CUST_TP_CD(+)" ).append("\n"); 
		query.append("AND HBL.BKG_NO       = @[bkg_no]" ).append("\n"); 
		query.append("MINUS" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append(" HBL.BL_NO_CTNT HBL_NO" ).append("\n"); 
		query.append(", SH.CUST_NM SHPR_NM" ).append("\n"); 
		query.append(", SH.CUST_ADDR SHPR_ADDR" ).append("\n"); 
		query.append(", CN.CUST_NM CNEE_NM" ).append("\n"); 
		query.append(", CN.CUST_ADDR CNEE_ADDR" ).append("\n"); 
		query.append(", NF.CUST_NM NOTI_NM" ).append("\n"); 
		query.append(", NF.CUST_ADDR NOTI_ADDR" ).append("\n"); 
		query.append(", HBL.ESTM_WGT AS HBL_WGT" ).append("\n"); 
		query.append(", HBL.ESTM_WGT_UT_CD AS WGT_UT_CD" ).append("\n"); 
		query.append(", HBL.PCK_QTY AS PCK_QTY" ).append("\n"); 
		query.append(", HBL.PCK_TP_CD AS PCK_TP_CD" ).append("\n"); 
		query.append(", HBL.MEAS_QTY AS CMDT_MEAS_QTY" ).append("\n"); 
		query.append(", HBL.MEAS_UT_CD AS CMDT_MEAS_UT_CD" ).append("\n"); 
		query.append(", DBMS_LOB.SUBSTR(HBL.MK_DESC, 4000, 1) BL_MK_DESC" ).append("\n"); 
		query.append(", DBMS_LOB.SUBSTR(HBL.GDS_DESC, 4000, 1) BL_GDS_DESC" ).append("\n"); 
		query.append("FROM BKG_XTER_RQST_MST HBL, BKG_XTER_CUST SH, BKG_XTER_CUST CN, BKG_XTER_CUST NF," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT MND.XTER_SNDR_ID,MND.XTER_RQST_NO,MND.XTER_RQST_SEQ" ).append("\n"); 
		query.append(",SUM(MND.CNTR_MF_WGT) ESTM_WGT,MAX(DECODE(MND.CNTR_SEQ,1,MND.WGT_UT_CD,0)) ESTM_WGT_UT_CD,SUM(MND.PCK_QTY) PCK_QTY" ).append("\n"); 
		query.append(",MAX(DECODE(MND.CNTR_SEQ,1,MND.PCK_TP_CD,0)) PCK_TP_CD,SUM(MND.MEAS_QTY) MEAS_QTY,MAX(DECODE(MND.CNTR_SEQ,1,MND.MEAS_UT_CD,0)) MEAS_UT_CD" ).append("\n"); 
		query.append("FROM BKG_XTER_CNTR_MK_DESC MND, BKG_XTER_RQST_MST MST" ).append("\n"); 
		query.append("WHERE MND.XTER_SNDR_ID = MST.XTER_SNDR_ID" ).append("\n"); 
		query.append("AND MND.XTER_RQST_NO = MST.XTER_RQST_NO" ).append("\n"); 
		query.append("AND MND.XTER_RQST_SEQ = MST.XTER_RQST_SEQ" ).append("\n"); 
		query.append("AND MST.XTER_SNDR_ID = @[sender_id]" ).append("\n"); 
		query.append("AND MST.XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("AND MST.BKG_NO= @[bkg_no]" ).append("\n"); 
		query.append("AND MST.XTER_BL_TP_CD = 'H'" ).append("\n"); 
		query.append("GROUP BY MND.XTER_SNDR_ID,MND.XTER_RQST_NO,MND.XTER_RQST_SEQ" ).append("\n"); 
		query.append(") HBL_CM" ).append("\n"); 
		query.append("WHERE HBL.XTER_SNDR_ID = SH.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_NO = SH.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_SEQ= SH.XTER_RQST_SEQ(+)" ).append("\n"); 
		query.append("AND 'S'              = SH.XTER_CUST_TP_CD(+)" ).append("\n"); 
		query.append("AND HBL.XTER_SNDR_ID = CN.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_NO = CN.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_SEQ= CN. XTER_RQST_SEQ(+)" ).append("\n"); 
		query.append("AND 'C'              = CN.XTER_CUST_TP_CD(+)" ).append("\n"); 
		query.append("AND HBL.XTER_SNDR_ID = NF.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_NO = NF.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_SEQ= NF.XTER_RQST_SEQ(+)" ).append("\n"); 
		query.append("AND 'N'              = NF.XTER_CUST_TP_CD(+)" ).append("\n"); 
		query.append("AND HBL.XTER_SNDR_ID = HBL_CM.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_NO = HBL_CM.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_SEQ= HBL_CM.XTER_RQST_SEQ(+)" ).append("\n"); 
		query.append("AND HBL.BKG_NO       = @[bkg_no]" ).append("\n"); 
		query.append("AND HBL.XTER_SNDR_ID = @[sender_id]" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_SEQ= @[rqst_seq]" ).append("\n"); 
		query.append("AND HBL.XTER_BL_TP_CD= 'H'" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_VIA_CD = (SELECT XTER_RQST_VIA_CD" ).append("\n"); 
		query.append("FROM BKG_XTER_RQST_MST" ).append("\n"); 
		query.append("WHERE XTER_SNDR_ID = @[sender_id]" ).append("\n"); 
		query.append("AND XTER_RQST_NO = @[rqst_no]" ).append("\n"); 
		query.append("AND XTER_RQST_SEQ= @[rqst_seq])" ).append("\n"); 
		query.append("UNION" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append(" HBL.BL_NO_CTNT HBL_NO" ).append("\n"); 
		query.append(", SH.CUST_NM SHPR_NM" ).append("\n"); 
		query.append(", SH.CUST_ADDR SHPR_ADDR" ).append("\n"); 
		query.append(", CN.CUST_NM CNEE_NM" ).append("\n"); 
		query.append(", CN.CUST_ADDR CNEE_ADDR" ).append("\n"); 
		query.append(", NF.CUST_NM NOTI_NM" ).append("\n"); 
		query.append(", NF.CUST_ADDR NOTI_ADDR" ).append("\n"); 
		query.append(", DECODE(HBL.XTER_RQST_VIA_CD,'SIM',HBL_CM.ESTM_WGT,HBL.ESTM_WGT) AS HBL_WGT" ).append("\n"); 
		query.append(", DECODE(HBL.XTER_RQST_VIA_CD,'SIM',HBL_CM.ESTM_WGT_UT_CD,HBL.ESTM_WGT_UT_CD) AS WGT_UT_CD" ).append("\n"); 
		query.append(", DECODE(HBL.XTER_RQST_VIA_CD,'SIM',HBL_CM.PCK_QTY,HBL.PCK_QTY) AS PCK_QTY" ).append("\n"); 
		query.append(", DECODE(HBL.XTER_RQST_VIA_CD,'SIM',HBL_CM.PCK_TP_CD,HBL.PCK_TP_CD) AS PCK_TP_CD" ).append("\n"); 
		query.append(", DECODE(HBL.XTER_RQST_VIA_CD,'SIM',HBL_CM.MEAS_QTY,HBL.MEAS_QTY) AS CMDT_MEAS_QTY" ).append("\n"); 
		query.append(", DECODE(HBL.XTER_RQST_VIA_CD,'SIM',HBL_CM.MEAS_UT_CD,HBL.MEAS_UT_CD) AS CMDT_MEAS_UT_CD" ).append("\n"); 
		query.append(", DBMS_LOB.SUBSTR(HBL.MK_DESC, 4000, 1) BL_MK_DESC" ).append("\n"); 
		query.append(", DBMS_LOB.SUBSTR(HBL.GDS_DESC, 4000, 1) BL_GDS_DESC" ).append("\n"); 
		query.append("FROM BKG_XTER_RQST_MST HBL, BKG_XTER_CUST SH, BKG_XTER_CUST CN, BKG_XTER_CUST NF," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT MND.XTER_SNDR_ID,MND.XTER_RQST_NO,MND.XTER_RQST_SEQ" ).append("\n"); 
		query.append(",SUM(MND.CNTR_MF_WGT) ESTM_WGT,MAX(DECODE(MND.CNTR_SEQ,1,MND.WGT_UT_CD,0)) ESTM_WGT_UT_CD,SUM(MND.PCK_QTY) PCK_QTY" ).append("\n"); 
		query.append(",MAX(DECODE(MND.CNTR_SEQ,1,MND.PCK_TP_CD,0)) PCK_TP_CD,SUM(MND.MEAS_QTY) MEAS_QTY,MAX(DECODE(MND.CNTR_SEQ,1,MND.MEAS_UT_CD,0)) MEAS_UT_CD" ).append("\n"); 
		query.append("FROM BKG_XTER_CNTR_MK_DESC MND, BKG_XTER_RQST_MST MST" ).append("\n"); 
		query.append("WHERE MND.XTER_SNDR_ID = MST.XTER_SNDR_ID" ).append("\n"); 
		query.append("AND MND.XTER_RQST_NO = MST.XTER_RQST_NO" ).append("\n"); 
		query.append("AND MND.XTER_RQST_SEQ = MST.XTER_RQST_SEQ" ).append("\n"); 
		query.append("AND MST.XTER_SNDR_ID = @[sender_id]" ).append("\n"); 
		query.append("AND MST.XTER_RQST_SEQ = @[rqst_seq]" ).append("\n"); 
		query.append("AND MST.BKG_NO= @[bkg_no]" ).append("\n"); 
		query.append("AND MST.XTER_BL_TP_CD = 'H'" ).append("\n"); 
		query.append("GROUP BY MND.XTER_SNDR_ID,MND.XTER_RQST_NO,MND.XTER_RQST_SEQ" ).append("\n"); 
		query.append(") HBL_CM" ).append("\n"); 
		query.append("WHERE HBL.XTER_SNDR_ID = SH.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_NO = SH.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_SEQ= SH.XTER_RQST_SEQ(+)" ).append("\n"); 
		query.append("AND 'S'              = SH.XTER_CUST_TP_CD(+)" ).append("\n"); 
		query.append("AND HBL.XTER_SNDR_ID = CN.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_NO = CN.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_SEQ= CN. XTER_RQST_SEQ(+)" ).append("\n"); 
		query.append("AND 'C'              = CN.XTER_CUST_TP_CD(+)" ).append("\n"); 
		query.append("AND HBL.XTER_SNDR_ID = NF.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_NO = NF.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_SEQ= NF.XTER_RQST_SEQ(+)" ).append("\n"); 
		query.append("AND 'N'              = NF.XTER_CUST_TP_CD(+)" ).append("\n"); 
		query.append("AND HBL.XTER_SNDR_ID = HBL_CM.XTER_SNDR_ID(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_NO = HBL_CM.XTER_RQST_NO(+)" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_SEQ= HBL_CM.XTER_RQST_SEQ(+)" ).append("\n"); 
		query.append("AND HBL.BKG_NO       = @[bkg_no]" ).append("\n"); 
		query.append("AND HBL.XTER_SNDR_ID = @[sender_id]" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_SEQ= @[rqst_seq]" ).append("\n"); 
		query.append("AND HBL.XTER_BL_TP_CD= 'H'" ).append("\n"); 
		query.append("AND HBL.XTER_RQST_VIA_CD = (SELECT XTER_RQST_VIA_CD" ).append("\n"); 
		query.append("FROM BKG_XTER_RQST_MST" ).append("\n"); 
		query.append("WHERE XTER_SNDR_ID = @[sender_id]" ).append("\n"); 
		query.append("AND XTER_RQST_NO = @[rqst_no]" ).append("\n"); 
		query.append("AND XTER_RQST_SEQ= @[rqst_seq])" ).append("\n"); 
		query.append("MINUS" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append(" HBL.HBL_NO" ).append("\n"); 
		query.append(", SH.CUST_NM SHPR_NM" ).append("\n"); 
		query.append(", SH.CUST_ADDR SHPR_ADDR" ).append("\n"); 
		query.append(", CN.CUST_NM CNEE_NM" ).append("\n"); 
		query.append(", CN.CUST_ADDR CNEE_ADDR" ).append("\n"); 
		query.append(", NF.CUST_NM NOTI_NM" ).append("\n"); 
		query.append(", NF.CUST_ADDR NOTI_ADDR" ).append("\n"); 
		query.append(", HBL.HBL_WGT" ).append("\n"); 
		query.append(", HBL.WGT_UT_CD" ).append("\n"); 
		query.append(", HBL.PCK_QTY" ).append("\n"); 
		query.append(", HBL.PCK_TP_CD" ).append("\n"); 
		query.append(", HBL.CMDT_MEAS_QTY" ).append("\n"); 
		query.append(", HBL.CMDT_MEAS_UT_CD" ).append("\n"); 
		query.append(", HBL.BL_MK_DESC" ).append("\n"); 
		query.append(", HBL.BL_GDS_DESC" ).append("\n"); 
		query.append("FROM BKG_HBL HBL, BKG_HBL_CUST SH, BKG_HBL_CUST CN, BKG_HBL_CUST NF" ).append("\n"); 
		query.append("WHERE 1=1" ).append("\n"); 
		query.append("and HBL.BKG_NO       = SH.BKG_NO(+)" ).append("\n"); 
		query.append("and hbl.hbl_seq      = sh.hbl_seq(+)" ).append("\n"); 
		query.append("AND 'S'              = SH.BKG_CUST_TP_CD(+)" ).append("\n"); 
		query.append("AND HBL.BKG_NO       = CN.BKG_NO(+)" ).append("\n"); 
		query.append("and hbl.hbl_seq      = cn.hbl_seq(+)" ).append("\n"); 
		query.append("AND 'C'              = CN.BKG_CUST_TP_CD(+)" ).append("\n"); 
		query.append("AND HBL.BKG_NO       = NF.BKG_NO(+)" ).append("\n"); 
		query.append("and hbl.hbl_seq      = nf.hbl_seq(+)" ).append("\n"); 
		query.append("AND 'N'              = NF.BKG_CUST_TP_CD(+)" ).append("\n"); 
		query.append("AND HBL.BKG_NO       = @[bkg_no])) > 0 THEN 'Y' ELSE 'N' END AS HBL1_MOD," ).append("\n"); 
		query.append("CASE WHEN (SELECT COUNT(*) FROM (" ).append("\n"); 
		query.append("SELECT USA_CSTMS_FILE_NO" ).append("\n"); 
		query.append(",SCAC_CD" ).append("\n"); 
		query.append(",PCK_QTY" ).append("\n"); 
		query.append("FROM BKG_USA_CSTMS_FILE_NO" ).append("\n"); 
		query.append("WHERE BKG_NO  = @[bkg_no]" ).append("\n"); 
		query.append("MINUS" ).append("\n"); 
		query.append("SELECT USA_CSTMS_FILE_NO" ).append("\n"); 
		query.append(", SCAC_CD" ).append("\n"); 
		query.append(", PCK_QTY" ).append("\n"); 
		query.append("FROM BKG_XTER_RQST_MST" ).append("\n"); 
		query.append("WHERE BKG_NO       = @[bkg_no]" ).append("\n"); 
		query.append("AND XTER_RQST_SEQ= @[rqst_seq]" ).append("\n"); 
		query.append("AND NVL(XTER_BL_TP_CD, ' ') = 'H'" ).append("\n"); 
		query.append("AND USA_CSTMS_FILE_NO IS NOT NULL" ).append("\n"); 
		query.append("UNION" ).append("\n"); 
		query.append("SELECT USA_CSTMS_FILE_NO" ).append("\n"); 
		query.append(", SCAC_CD" ).append("\n"); 
		query.append(", PCK_QTY" ).append("\n"); 
		query.append("FROM BKG_XTER_RQST_MST" ).append("\n"); 
		query.append("WHERE BKG_NO       = @[bkg_no]" ).append("\n"); 
		query.append("AND XTER_RQST_SEQ= @[rqst_seq]" ).append("\n"); 
		query.append("AND NVL(XTER_BL_TP_CD, ' ') = 'H'" ).append("\n"); 
		query.append("AND USA_CSTMS_FILE_NO IS NOT NULL" ).append("\n"); 
		query.append("MINUS" ).append("\n"); 
		query.append("SELECT USA_CSTMS_FILE_NO" ).append("\n"); 
		query.append(",SCAC_CD" ).append("\n"); 
		query.append(",PCK_QTY" ).append("\n"); 
		query.append("FROM BKG_USA_CSTMS_FILE_NO" ).append("\n"); 
		query.append("WHERE BKG_NO  = @[bkg_no])) > 0 THEN 'Y' ELSE 'N' END AS HBL2_MOD" ).append("\n"); 
		query.append("FROM DUAL" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", DGCHK AS (SELECT CASE WHEN (SELECT 'Y' " ).append("\n"); 
		query.append("                                FROM BKG_XTER_DG_CGO " ).append("\n"); 
		query.append("                               WHERE XTER_SNDR_ID = @[sender_id]" ).append("\n"); 
		query.append("                                 AND XTER_RQST_NO = @[rqst_no]" ).append("\n"); 
		query.append("                                 AND XTER_RQST_SEQ= @[rqst_seq]" ).append("\n"); 
		query.append("                                 AND ROWNUM = 1) = 'Y' THEN 'N' " ).append("\n"); 
		query.append("                        WHEN (SELECT 'Y' " ).append("\n"); 
		query.append("                                FROM BKG_DG_CGO " ).append("\n"); 
		query.append("                               WHERE BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("                                 AND ROWNUM = 1) = 'Y' THEN 'N' " ).append("\n"); 
		query.append("                        ELSE ( SELECT DECODE(COUNT(*),0,'N','Y') " ).append("\n"); 
		query.append("                                FROM (" ).append("\n"); 
		query.append("                                    SELECT HRD.*" ).append("\n"); 
		query.append("                                    FROM BKG_BLCK_KW_LIST HRD" ).append("\n"); 
		query.append("                                        ,BKG_XTER_RQST_MST MST" ).append("\n"); 
		query.append("                                    WHERE HRD.BLCK_KW_TP_CD = 'MIS'" ).append("\n"); 
		query.append("                                      AND MST.XTER_SNDR_ID = @[sender_id]" ).append("\n"); 
		query.append("                                      AND MST.XTER_RQST_NO = @[rqst_no]" ).append("\n"); 
		query.append("                                      AND MST.XTER_RQST_SEQ= @[rqst_seq]" ).append("\n"); 
		query.append("                                      AND (UPPER(MST.CSTMS_DESC) LIKE '%'||HRD.BLCK_KW_NM||'%'" ).append("\n"); 
		query.append("                                      OR UPPER(MST.GDS_DESC) LIKE '%'||HRD.BLCK_KW_NM||'%'" ).append("\n"); 
		query.append("                                      OR UPPER(MST.XTER_BKG_RMK1) LIKE '%'||HRD.BLCK_KW_NM||'%')" ).append("\n"); 
		query.append("                                    UNION ALL" ).append("\n"); 
		query.append("                                    SELECT HRD.*" ).append("\n"); 
		query.append("                                    FROM BKG_BLCK_KW_LIST HRD" ).append("\n"); 
		query.append("                                         ,BKG_XTER_CNTR_MK_DESC CM" ).append("\n"); 
		query.append("                                    WHERE HRD.BLCK_KW_TP_CD = 'MIS'" ).append("\n"); 
		query.append("                                      AND CM.XTER_SNDR_ID = @[sender_id]" ).append("\n"); 
		query.append("                                      AND CM.XTER_RQST_NO = @[rqst_no]" ).append("\n"); 
		query.append("                                      AND CM.XTER_RQST_SEQ= @[rqst_seq]" ).append("\n"); 
		query.append("                                      AND UPPER(CM.CNTR_MF_MK_DESC) LIKE '%'||HRD.BLCK_KW_NM||'%'" ).append("\n"); 
		query.append("                                    ))" ).append("\n"); 
		query.append("    END AS DG_FLG" ).append("\n"); 
		query.append("FROM DUAL)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT CASE WHEN ALL_MANUAL ='Y' THEN 'Y'" ).append("\n"); 
		query.append("            WHEN DCT_LMT < SYSDATE AND DCT_MANUAL = 'Y' THEN 'Y'" ).append("\n"); 
		query.append("            WHEN CCT_DT < SYSDATE AND (DCT_MANUAL = 'Y' OR CCT_MANUAL = 'Y') THEN 'Y'" ).append("\n"); 
		query.append("            WHEN ATD_LMT < SYSDATE AND (DCT_MANUAL = 'Y' OR CCT_MANUAL = 'Y' OR ATD_MANUAL ='Y') THEN 'Y'" ).append("\n"); 
		query.append("            WHEN ( BDR_FLG ='Y' OR BDR_LMT < SYSDATE ) AND (DCT_MANUAL = 'Y' OR CCT_MANUAL = 'Y' OR ATD_MANUAL ='Y' OR BDR_MANUAL = 'Y') THEN 'Y'" ).append("\n"); 
		query.append("            WHEN PCT_DT < SYSDATE AND (DCT_MANUAL = 'Y' OR CCT_MANUAL = 'Y' OR ATD_MANUAL ='Y' OR BDR_MANUAL = 'Y' OR PCT_MANUAL ='Y') THEN 'Y'" ).append("\n"); 
		query.append("            WHEN OBL_ISS_FLG = 'Y' AND BLISS_MANUAL ='Y' THEN 'Y'" ).append("\n"); 
		query.append("            WHEN BKG_STS_FLG ='Y' THEN 'Y'" ).append("\n"); 
		query.append("            WHEN CLUZ_LCK_FLG ='Y' THEN 'Y'" ).append("\n"); 
		query.append("            WHEN ATA_LMT < SYSDATE THEN 'Y'" ).append("\n"); 
		query.append("            WHEN ADM_FLG = 'Y' AND ADM_MANUAL ='Y' THEN 'Y'" ).append("\n"); 
		query.append("            WHEN OBM_FLG = 'Y' AND OBM_MANUAL ='Y' THEN 'Y'" ).append("\n"); 
		query.append("			WHEN IR_TO_ORD_FLG ='Y' THEN 'Y'" ).append("\n"); 
		query.append("			WHEN DG_FLG = 'Y'  THEN 'Y'" ).append("\n"); 
		query.append("            ELSE 'N'" ).append("\n"); 
		query.append("        END AS MNL_FLG," ).append("\n"); 
		query.append("      CASE WHEN ALL_MANUAL ='Y' THEN 'Entirely manual upload'" ).append("\n"); 
		query.append("            WHEN DCT_LMT < SYSDATE AND DCT_MANUAL = 'Y' THEN 'DCT Time Limit'" ).append("\n"); 
		query.append("            WHEN CCT_DT < SYSDATE AND (DCT_MANUAL = 'Y' OR CCT_MANUAL = 'Y') THEN 'CCT Time Limit'" ).append("\n"); 
		query.append("            WHEN ATD_LMT < SYSDATE AND (DCT_MANUAL = 'Y' OR CCT_MANUAL = 'Y' OR ATD_MANUAL ='Y') THEN 'ATD Time Limit'" ).append("\n"); 
		query.append("            WHEN ( BDR_FLG ='Y' OR BDR_LMT < SYSDATE ) AND (DCT_MANUAL = 'Y' OR CCT_MANUAL = 'Y' OR ATD_MANUAL ='Y' OR BDR_MANUAL = 'Y') THEN 'BDR Time Limit'" ).append("\n"); 
		query.append("            WHEN PCT_DT < SYSDATE AND (DCT_MANUAL = 'Y' OR ATD_MANUAL ='Y' OR CCT_MANUAL = 'Y' OR BDR_MANUAL = 'Y' OR PCT_MANUAL ='Y') THEN 'PCT Time Limit'" ).append("\n"); 
		query.append("            WHEN OBL_ISS_FLG = 'Y' AND BLISS_MANUAL ='Y' THEN 'B/L Issue Time Limit'" ).append("\n"); 
		query.append("            WHEN BKG_STS_FLG ='Y' THEN 'Booking Status'" ).append("\n"); 
		query.append("            WHEN CLUZ_LCK_FLG ='Y' THEN 'Clause Lock'" ).append("\n"); 
		query.append("            WHEN ATA_LMT < SYSDATE THEN 'ATA Time Limit'" ).append("\n"); 
		query.append("            WHEN ADM_FLG = 'Y' AND ADM_MANUAL ='Y' THEN 'Advance Manifest'" ).append("\n"); 
		query.append("            WHEN OBM_FLG = 'Y' AND OBM_MANUAL ='Y' THEN 'O/B Manifest'" ).append("\n"); 
		query.append("			WHEN IR_TO_ORD_FLG ='Y' THEN 'Iran To Order'" ).append("\n"); 
		query.append("			WHEN DG_FLG = 'Y'  THEN 'Non Checked DG Cargo'" ).append("\n"); 
		query.append("            ELSE ''" ).append("\n"); 
		query.append("        END AS MNL_UPLD_RSN" ).append("\n"); 
		query.append("        ,XTER_SNDR_ID" ).append("\n"); 
		query.append("        ,XTER_RQST_NO" ).append("\n"); 
		query.append("        ,XTER_RQST_SEQ" ).append("\n"); 
		query.append("        ,BKG_NO" ).append("\n"); 
		query.append("		,BL_NO" ).append("\n"); 
		query.append("		,CHG_MOD" ).append("\n"); 
		query.append("		,'N' BKG_UPLD_STS_CD" ).append("\n"); 
		query.append("		,'N' SYS_UPLD_FLG" ).append("\n"); 
		query.append("		,CMPB_RT_FLG " ).append("\n"); 
		query.append("		,'' SI_AUD_FLG" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("  SELECT CASE WHEN SH_NM_MOD = 'Y'OR PRE_VSL_MOD = 'Y' OR VSL_MOD = 'Y' " ).append("\n"); 
		query.append("                      OR POR_MOD ='Y' OR POL_MOD ='Y'  OR POD_MOD ='Y' OR DEL_MOD = 'Y' " ).append("\n"); 
		query.append("                      OR RCV_TERM_MOD ='Y' OR DE_TERM_MOD ='Y'" ).append("\n"); 
		query.append("                      OR CNTR_NO_MOD ='Y' OR CNTR_SEAL_MOD ='Y'" ).append("\n"); 
		query.append("                      OR CHG_MOD ='Y'  OR BKG_QTY_MOD ='Y' " ).append("\n"); 
		query.append("					  OR CNTR_KR_MNL = 'Y' THEN 'Y'					 " ).append("\n"); 
		query.append("                    ELSE 'N'" ).append("\n"); 
		query.append("                END AS ALL_MANUAL " ).append("\n"); 
		query.append("              ,CASE WHEN KR_CSTMS_CUST_TP_MOD = 'Y' OR AES_MOD ='Y' OR CAED_MOD ='Y' THEN 'Y'" ).append("\n"); 
		query.append("                    ELSE 'N'" ).append("\n"); 
		query.append("                END AS DCT_MANUAL" ).append("\n"); 
		query.append("			  ,CASE WHEN HBL1_MOD = 'Y' OR HBL2_MOD ='Y' THEN 'Y'" ).append("\n"); 
		query.append("                    ELSE 'N'" ).append("\n"); 
		query.append("                END AS CCT_MANUAL" ).append("\n"); 
		query.append("              ,CASE WHEN SH_ADDR_MOD = 'Y' OR SH_CTRY_MOD = 'Y' OR SH_EORI_MOD ='Y' OR SH_CITY_MOD = 'Y' OR SH_STE_MOD = 'Y' OR" ).append("\n"); 
		query.append("                         CN_NM_MOD = 'Y' OR CN_ADDR_MOD = 'Y' OR CN_CTRY_MOD = 'Y' OR CN_ZIP_MOD = 'Y' OR CN_EORI_MOD = 'Y' OR CN_CITY_MOD = 'Y' OR CN_STE_MOD = 'Y' OR CN_ST_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         NF_NM_MOD = 'Y' OR CNTR_QTY_MOD = 'Y' OR CNTR_MF_MOD = 'Y' OR CNTR_NCM_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         MK_MOD = 'Y' OR DES_MOD = 'Y' OR CSTMS_DESC_MOD = 'Y'  THEN 'Y'" ).append("\n"); 
		query.append("                    ELSE 'N'" ).append("\n"); 
		query.append("                END AS ATD_MANUAL" ).append("\n"); 
		query.append("              ,CASE WHEN NF_ADDR_MOD = 'Y' OR NF_CTRY_MOD = 'Y' OR NF_ZIP_MOD = 'Y' OR NF_EORI_MOD = 'Y' OR NF_CITY_MOD = 'Y' OR NF_STE_MOD = 'Y' OR NF_ST_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         AN_NM_MOD = 'Y' OR BL_TP_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         MX_SHPR_TAX_ID_MOD = 'Y' OR TR_SHPR_TAX_ID_MOD = 'Y' OR IL_SHPR_TAX_ID_MOD = 'Y' OR LB_SHPR_TAX_ID_MOD = 'Y' OR BRZ_SHPR_TAX_ID_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         MX_CNEE_TAX_ID_MOD = 'Y' OR TR_CNEE_TAX_ID_MOD = 'Y' OR IL_CNEE_TAX_ID_MOD = 'Y' OR LB_CNEE_TAX_ID_MOD = 'Y' OR BRZ_CNEE_TAX_ID_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         MX_NTFY_TAX_ID_MOD = 'Y' OR TR_NTFY_TAX_ID_MOD = 'Y' OR IL_NTFY_TAX_ID_MOD = 'Y' OR LB_NTFY_TAX_ID_MOD = 'Y' OR BRZ_NTFY_TAX_ID_MOD = 'Y' THEN 'Y'" ).append("\n"); 
		query.append("                    ELSE 'N'" ).append("\n"); 
		query.append("                END AS BDR_MANUAL" ).append("\n"); 
		query.append("              ,CASE WHEN FRT_TERM_MOD = 'Y' OR FF_NM_MOD = 'Y' THEN 'Y'  " ).append("\n"); 
		query.append("                    ELSE 'N'" ).append("\n"); 
		query.append("                END AS PCT_MANUAL " ).append("\n"); 
		query.append("              ,CASE WHEN SH_ADDR_MOD = 'Y' OR SH_CTRY_MOD = 'Y' OR SH_ZIP_MOD = 'Y' OR SH_EORI_MOD = 'Y' OR SH_CITY_MOD = 'Y' OR SH_STE_MOD = 'Y' OR SH_ST_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         CN_NM_MOD = 'Y' OR CN_ADDR_MOD = 'Y' OR CN_CTRY_MOD = 'Y' OR CN_ZIP_MOD = 'Y' OR CN_EORI_MOD = 'Y' OR CN_CITY_MOD = 'Y' OR CN_STE_MOD = 'Y' OR CN_ST_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         NF_NM_MOD = 'Y' OR NF_ADDR_MOD = 'Y' OR NF_CTRY_MOD = 'Y' OR NF_ZIP_MOD = 'Y' OR NF_EORI_MOD = 'Y' OR NF_CITY_MOD = 'Y' OR NF_STE_MOD = 'Y' OR NF_ST_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         CNTR_QTY_MOD = 'Y' OR CNTR_MF_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         MK_MOD = 'Y' OR DES_MOD = 'Y' OR KR_CSTMS_CUST_TP_MOD = 'Y' OR RMK_MOD = 'Y' OR CSTMS_DESC_MOD = 'Y' OR" ).append("\n"); 
		query.append("						 HBL1_MOD = 'Y' OR HBL2_MOD ='Y'" ).append("\n"); 
		query.append("						 THEN 'Y'" ).append("\n"); 
		query.append("                    ELSE 'N'" ).append("\n"); 
		query.append("                END AS ADM_MANUAL" ).append("\n"); 
		query.append("              ,CASE WHEN SH_ADDR_MOD = 'Y' OR SH_CTRY_MOD = 'Y' OR CN_NM_MOD = 'Y' OR CN_ADDR_MOD = 'Y' OR CN_CTRY_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         MK_MOD = 'Y' OR DES_MOD = 'Y' OR FRT_TERM_MOD = 'Y' THEN 'Y'" ).append("\n"); 
		query.append("                    ELSE 'N'" ).append("\n"); 
		query.append("                END AS BLISS_MANUAL" ).append("\n"); 
		query.append("              ,CASE WHEN SH_ADDR_MOD = 'Y' OR SH_CTRY_MOD = 'Y' OR SH_ZIP_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         CN_NM_MOD = 'Y' OR CN_ADDR_MOD = 'Y' OR CN_CTRY_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         CNTR_QTY_MOD = 'Y' OR CNTR_MF_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         MK_MOD = 'Y' OR DES_MOD = 'Y' OR KR_CSTMS_CUST_TP_MOD = 'Y' OR " ).append("\n"); 
		query.append("                         CSTMS_DESC_MOD = 'Y' OR RMK_MOD = 'Y' THEN 'Y'" ).append("\n"); 
		query.append("                    ELSE 'N'" ).append("\n"); 
		query.append("                END AS OBM_MANUAL" ).append("\n"); 
		query.append("			  ,CASE WHEN ADV_EUR_CSTMS > 0 OR ADV_JP_CSTMS > 0  OR ADV_US_CSTMS > 0  OR ADV_CN_CSTMS > 0 OR ADV_MX_CSTMS > 0" ).append("\n"); 
		query.append("                     THEN 'Y' ELSE 'N' " ).append("\n"); 
		query.append("                END AS ADM_FLG" ).append("\n"); 
		query.append("              ,CASE WHEN SRI_CSTMS > 0  OR MM_CSTMS > 0  OR MY_CSTMS > 0  OR VN_CSTMS > 0 OR" ).append("\n"); 
		query.append("                         KR_CSTMS > 0  OR EUR_CSTMS > 0  OR BD_CSTMS > 0" ).append("\n"); 
		query.append("                     THEN 'Y' ELSE 'N' " ).append("\n"); 
		query.append("                END AS OBM_FLG" ).append("\n"); 
		query.append("              ,NVL(DCT_DT, CCT_DT-48/24) AS DCT_LMT" ).append("\n"); 
		query.append("              ,NVL(ATD, ETD_DT) AS ATD_LMT" ).append("\n"); 
		query.append("              ,BDR_FLG" ).append("\n"); 
		query.append("              ,POL_ETD_DT+(POD_ETA_DT-POL_ETD_DT)/2 AS BDR_LMT" ).append("\n"); 
		query.append("              ,OBL_ISS_FLG" ).append("\n"); 
		query.append("              ,BKG_STS_FLG" ).append("\n"); 
		query.append("              ,PCT_DT" ).append("\n"); 
		query.append("              ,CLUZ_LCK_FLG" ).append("\n"); 
		query.append("              ,ATD" ).append("\n"); 
		query.append("              ,DCT_DT" ).append("\n"); 
		query.append("              ,ETD_DT" ).append("\n"); 
		query.append("              ,CCT_DT" ).append("\n"); 
		query.append("              ,POL_ETD_DT" ).append("\n"); 
		query.append("              ,POD_ETA_DT" ).append("\n"); 
		query.append("              ,ETB_DT" ).append("\n"); 
		query.append("              ,NVL(POD_ATA_DT,POD_ETA_DT) AS ATA_LMT" ).append("\n"); 
		query.append("              ,XTER_SNDR_ID" ).append("\n"); 
		query.append("              ,XTER_RQST_NO" ).append("\n"); 
		query.append("              ,XTER_RQST_SEQ" ).append("\n"); 
		query.append("              ,BKG_NO" ).append("\n"); 
		query.append("			  ,BL_NO" ).append("\n"); 
		query.append("			  ,CHG_MOD" ).append("\n"); 
		query.append("			  ,CMPB_RT_FLG" ).append("\n"); 
		query.append("			  ,IR_TO_ORD_FLG" ).append("\n"); 
		query.append("			  ,DG_FLG" ).append("\n"); 
		query.append("          FROM TMLIM " ).append("\n"); 
		query.append("              ,XTERMST" ).append("\n"); 
		query.append("              ,XTERCUST" ).append("\n"); 
		query.append("              ,XTERAES" ).append("\n"); 
		query.append("              ,XTERCAED" ).append("\n"); 
		query.append("              ,XTERCNTR" ).append("\n"); 
		query.append("              ,XTERLIC" ).append("\n"); 
		query.append("              ,XTERCHG " ).append("\n"); 
		query.append("			  ,XTERHBL" ).append("\n"); 
		query.append("			  ,DGCHK" ).append("\n"); 
		query.append("              )" ).append("\n"); 

	}
}