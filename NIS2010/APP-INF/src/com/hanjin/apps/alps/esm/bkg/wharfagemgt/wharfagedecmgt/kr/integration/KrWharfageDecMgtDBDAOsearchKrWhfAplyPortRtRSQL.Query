<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="KrWharfageDecMgtDBDAOsearchKrWhfAplyPortRtRSQL">
			<desc><![CDATA[s]]></desc>
			<sql><![CDATA[
SELECT B.TEU_PRC * (1 - B.TEU_AMT_RT) AS KR_WHF_CNTR_20FT_RT,
       B.FEU_PRC * (1 - B.FEU_AMT_RT) AS KR_WHF_CNTR_40FT_RT,
       B.HC_PRC * (1 - B.HC_AMT_RT) AS KR_WHF_CNTR_45FT_RT,
       C.TEU_PRC * (1 - C.TEU_AMT_RT) AS KR_WHF_BLK_RT
FROM ( SELECT 
           U.WHF_VOL_DC_CD WHF_VOL_DC_CD,
           S.VPS_ETA_DT VPS_ETA_DT,
           S.VPS_ETD_DT VPS_ETD_DT
      FROM BKG_KR_WHF_VOL U,
           VSK_VSL_PORT_SKD S
      WHERE U.VSL_CD(+) = SUBSTR(@[vvd], 1, 4)
      AND U.SKD_VOY_NO(+) = SUBSTR(@[vvd], 5, 4)
      AND U.SKD_DIR_CD(+) = SUBSTR(@[vvd], 9, 1)
      AND U.PORT_CD(+) = @[port_cd]
      AND SUBSTR(U.WHF_BND_CD(+), 1, 1) = SUBSTR(@[whf_bnd_cd], 1, 1)
      AND S.VSL_CD(+) = SUBSTR(@[vvd], 1, 4)
      AND S.SKD_VOY_NO(+) = SUBSTR(@[vvd], 5, 4)
      AND S.SKD_DIR_CD(+) = SUBSTR(@[vvd], 9, 1)
      AND S.VPS_PORT_CD(+) = @[port_cd]
      and S.CLPT_IND_SEQ(+) = '1'
      AND ROWNUM =1
      ) A, 
      BKG_KR_WHF_PORT_RT B, 
      BKG_KR_WHF_PORT_RT C
WHERE B.CNTR_BLK_DIV_CD(+) = 'C'
AND B.PORT_CD(+) = @[port_cd]
AND B.IO_BND_CD(+) = SUBSTR(@[whf_bnd_cd], 1, 1)
AND B.DC_RTO_NO(+) = A.WHF_VOL_DC_CD
AND C.CNTR_BLK_DIV_CD(+) = 'B'
AND C.PORT_CD(+) = @[port_cd]
AND C.IO_BND_CD(+) = SUBSTR(@[whf_bnd_cd], 1, 1)
AND C.DC_RTO_NO(+) = A.WHF_VOL_DC_CD
AND decode( SUBSTR(@[whf_bnd_cd], 1, 1), 'I', A.VPS_ETA_DT, A.VPS_ETD_DT) BETWEEN B.EFF_FM_DT(+) AND B.EFF_TO_DT(+) + 0.99999
AND decode( SUBSTR(@[whf_bnd_cd], 1, 1), 'I', A.VPS_ETA_DT, A.VPS_ETD_DT) BETWEEN C.EFF_FM_DT(+) AND C.EFF_TO_DT(+) + 0.99999			]]></sql>
			<params>
				<param name="vvd" type="12" value="HJMT0001E" out="N"/>
				<param name="port_cd" type="12" value="KRPUS" out="N"/>
				<param name="whf_bnd_cd" type="12" value="II" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
