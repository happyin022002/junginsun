<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="IHCGuideLineDBDAOModifyIHCTariffDurationConfirmUSQL">
			<desc><![CDATA[update IHC Tariff Duration]]></desc>
			<sql><![CDATA[
UPDATE PRI_TRF_IHC_DUR 
   SET EXP_DT     = TO_DATE(@[eff_dt], 'YYYY-MM-DD')-1
     , UPD_USR_ID = @[upd_usr_id]
     , UPD_DT     = SYSDATE
 WHERE ( SVC_SCP_CD, IHC_TRF_NO, AMDT_SEQ, ORG_DEST_TP_CD ) IN      
    (
        SELECT @[svc_scp_cd]
             , TRF.IHC_TRF_NO
             , MAX(MN.AMDT_SEQ) AMDT_SEQ
             , @[org_dest_tp_cd] 
          FROM PRI_TRF_IHC_MN MN
             , (    SELECT MAX(MN.IHC_TRF_NO) IHC_TRF_NO
                      FROM PRI_TRF_IHC_HDR HDR
                         , PRI_TRF_IHC_MN MN
                     WHERE 1=1
                       AND MN.SVC_SCP_CD     = @[svc_scp_cd]
                       AND HDR.COST_CNT_CD   = @[cost_cnt_cd]
                       AND MN.ORG_DEST_TP_CD = @[org_dest_tp_cd]
                       AND MN.FIC_PROP_STS_CD = 'C'
                       AND MN.SVC_SCP_CD = HDR.SVC_SCP_CD
                       AND MN.IHC_TRF_NO = HDR.IHC_TRF_NO
                       AND MN.ORG_DEST_TP_CD = HDR.ORG_DEST_TP_CD
               ) TRF
         WHERE 1=1
           AND MN.IHC_TRF_NO = TRF.IHC_TRF_NO
      GROUP BY TRF.IHC_TRF_NO
    )			]]></sql>
			<params>
				<param name="eff_dt" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="svc_scp_cd" type="12" value="" out="N"/>
				<param name="org_dest_tp_cd" type="12" value="" out="N"/>
				<param name="cost_cnt_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
