<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SalesRPTDBDAOSearchBkgAbcstp0156ListRSQL">
			<desc><![CDATA[Inquiry by BKG (ABC/STP)]]></desc>
			<sql><![CDATA[
SELECT DECODE(A1.COND_OFC_CD,'EMU',A5.CTRT_OFC_CD,'SMU',A5.CTRT_OFC_CD, A1.COND_OFC_CD) GUBUN 
	,A5.CTRT_OFC_CD 
	,A1.COND_OFC_CD 
	,DECODE(A1.RA_ACCT_CD, '91401011', DECODE('${f_stp_flg}','I', 'STP REVENUE', 'O', 'STP COST'), A3.MAS_COST_SRC_CD_NM) MAS_COST_SRC_CD_NM 
	,REPLACE(A4.OFC_CLSS_NM,'&',' ') OFC_CLSS_NM 
	,REPLACE(A2.SLS_ACT_DESC,'&',' ') SLS_ACT_CD_NM 
	,DECODE(A1.DIV_MEAS_CD,'TEUQ','TEU','BKGQ','BKG','BKRV','REV','CNTQ','CNTR') DIV_MEAS_CD 
	,SUM(A1.SVC_TRNS_PRC_AMT) * NVL(A1.BKG_SPLIT_RTO, 1) SVC_TRNS_PRC_AMT 
	,SUM(DECODE(A1.RA_ACCT_CD, '91401011', A1.SVC_TRNS_PRC_AMT)) * NVL(A1.BKG_SPLIT_RTO, 1) STP_REV 
	,SUM(DECODE(A1.RA_ACCT_CD, '65901021', A1.SVC_TRNS_PRC_AMT)) * NVL(A1.BKG_SPLIT_RTO, 1) OTH_COST 
FROM MAS_BKG_SVC_TRNS_PRC A1 
	,MAS_OFC_ROUT_MAPG A2 
	,MAS_COST_SRC_ACCT A3 
	,( SELECT INTG_CD_VAL_DP_SEQ OFC_CLSS_SEQ 
			,INTG_CD_VAL_CTNT OFC_CLSS_CD 
			,INTG_CD_VAL_DP_DESC OFC_CLSS_NM 
		FROM COM_INTG_CD_DTL 
		WHERE INTG_CD_ID = 'CD00920' 
	) A4 
	,MAS_RGST_BKG A5 
	,MAS_MON_VVD  A6 
WHERE A1.SLS_ACT_CD   = A2.SLS_ACT_CD 
	AND A1.OFC_CLSS_CD  = A2.OFC_CLSS_CD 
	AND A1.RA_ACCT_CD   = A3.MAS_COST_SRC_CD 
	AND A1.OFC_CLSS_CD  = A4.OFC_CLSS_CD 
	AND A1.BKG_NO       = A5.BKG_NO 
	AND A5.TRD_CD       = A6.TRD_CD  
	AND A5.RLANE_CD     = A6.RLANE_CD  
	AND A5.IOC_CD       = A6.IOC_CD   
	AND A5.VSL_CD       = A6.VSL_CD  
	AND A5.SKD_VOY_NO   = A6.SKD_VOY_NO  
	AND A5.DIR_CD       = A6.DIR_CD  
	AND A6.COST_YRMON   = A2.COST_YRMON
	AND A1.BKG_NO       = @[f_bkg_no] 
			
	#if(${f_pro_vw} =='P')  /* Trade Profit */
		AND A1.RA_ACCT_CD   IN ('65901011','65901021')  
	#else  /* Office Profit */
		#if(${f_stp_flg} =='O')
			AND A1.RA_ACCT_CD   IN ('65901011','91401011') /* Office Profit : STP Cost */
		#else 
			AND A1.RA_ACCT_CD   IN ('65901021','91401011') /* Office Profit : STP Income */
		#end
	#end
			
GROUP BY A5.CTRT_OFC_CD 
	,A1.COND_OFC_CD 
	,A1.RA_ACCT_CD 
	,DECODE(A1.RA_ACCT_CD, '91401011', DECODE('${f_stp_flg}','I', 'STP REVENUE', 'O', 'STP COST'), A3.MAS_COST_SRC_CD_NM) 
	,A4.OFC_CLSS_SEQ 
	,A1.OFC_CLSS_CD 
	,REPLACE(A4.OFC_CLSS_NM,'&',' ')  
	,A1.SLS_ACT_CD 
	,REPLACE(A2.SLS_ACT_DESC,'&',' ') 
	,DECODE(A1.DIV_MEAS_CD,'TEUQ','TEU','BKGQ','BKG','BKRV','REV','CNTQ','CNTR') 
	,A1.BKG_SPLIT_RTO 
ORDER BY 
#if(${f_pro_vw} =='R' && ${f_stp_flg} =='I' )
	 A1.COND_OFC_CD 
	,A4.OFC_CLSS_SEQ ASC
	,A1.RA_ACCT_CD DESC
#else
	A4.OFC_CLSS_SEQ 
#end			]]></sql>
			<params>
				<param name="f_bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
