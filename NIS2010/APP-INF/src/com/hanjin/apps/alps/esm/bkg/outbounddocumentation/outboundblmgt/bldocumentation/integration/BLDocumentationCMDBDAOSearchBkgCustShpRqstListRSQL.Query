<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BLDocumentationCMDBDAOSearchBkgCustShpRqstListRSQL">
			<desc><![CDATA[방글라데시 ODCY로부터의 파일을 조회]]></desc>
			<sql><![CDATA[
#if (${vvd_cd} != '')
SELECT 
    SLAN_CD,
    VVD.VSL_CD||VVD.SKD_VOY_NO||VVD.SKD_DIR_CD VVD_CD,
    VVD.POL_CD,
    VVD.BKG_NO,
    SHP.CNTR_NO,
    SHP.CNTR_SEQ,
    SHP.CNTR_TPSZ_CD,
    SHP.CNTR_VOL_QTY,
    SHP.CNTR_SEAL_NO,
    SHP.PCK_QTY,
    SHP.PCK_TP_CD,
    SHP.CNTR_WGT,
    SHP.WGT_UT_CD,
    SHP.MEAS_QTY,
    SHP.MEAS_UT_CD,
     TO_CHAR(SHP.CRE_DT,'YYYY-MM-DD') CRE_DT,
    SHP.CRE_USR_ID,
    (SELECT OFC_CD FROM COM_USER WHERE USR_ID = SHP.CRE_USR_ID) OFC_CD
 FROM BKG_VVD VVD, BKG_CUST_SHP_RQST SHP
WHERE 1=1
	#if(${vvd_cd} !='')
		AND VVD.VSL_CD = SUBSTR(@[vvd_cd],1,4)
		AND VVD.SKD_VOY_NO = SUBSTR(@[vvd_cd],5,4)
		AND VVD.SKD_DIR_CD = SUBSTR(@[vvd_cd],9,1)
	#end
    #if(${pol_cd} !='')
		AND VVD.POL_CD = @[pol_cd]
	#end
    #if(${slan_cd} !='')
		AND VVD.SLAN_CD = @[slan_cd]
	#end

        AND VVD.BKG_NO = SHP.BKG_NO

     #if(${cre_dt} !='')
		AND SHP.CRE_DT >= TO_DATE(@[cre_dt],'YYYYMMDD')
        AND SHP.CRE_DT <= TO_DATE(@[cre_dt],'YYYYMMDD') +0.99999
	 #end
     #if(${cre_usr_id} !='')
		AND SHP.CRE_USR_ID = @[cre_usr_id]
	 #end

     #if(${bkg_no} !='')
		AND VVD.BKG_NO = @[bkg_no]
	 #end

#end

#if (${vvd_cd} == '' && ${bkg_no} !='')
SELECT 
    SLAN_CD,
    VVD.VSL_CD||VVD.SKD_VOY_NO||VVD.SKD_DIR_CD VVD_CD,
    VVD.POL_CD,
    VVD.BKG_NO,
    SHP.CNTR_NO,
    SHP.CNTR_SEQ,
    SHP.CNTR_TPSZ_CD,
    SHP.CNTR_VOL_QTY,
    SHP.CNTR_SEAL_NO,
    SHP.PCK_QTY,
    SHP.PCK_TP_CD,
    SHP.CNTR_WGT,
    SHP.WGT_UT_CD,
    SHP.MEAS_QTY,
    SHP.MEAS_UT_CD,
     TO_CHAR(SHP.CRE_DT,'YYYY-MM-DD') CRE_DT,
    SHP.CRE_USR_ID,
    (SELECT OFC_CD FROM COM_USER WHERE USR_ID = SHP.CRE_USR_ID) OFC_CD
 FROM BKG_BOOKING VVD, BKG_CUST_SHP_RQST SHP
WHERE 1=1
    #if(${pol_cd} !='')
		AND VVD.POL_CD = @[pol_cd]
	#end
    #if(${slan_cd} !='')
		AND VVD.SLAN_CD = @[slan_cd]
	#end

        AND VVD.BKG_NO = SHP.BKG_NO

     #if(${cre_dt} !='')
		AND SHP.CRE_DT >= TO_DATE(@[cre_dt],'YYYYMMDD')
        AND SHP.CRE_DT <= TO_DATE(@[cre_dt],'YYYYMMDD') +0.99999
	 #end
     #if(${cre_usr_id} !='')
		AND SHP.CRE_USR_ID = @[cre_usr_id]
	 #end

     #if(${bkg_no} !='')
		AND VVD.BKG_NO = @[bkg_no]
	 #end
#end
			]]></sql>
			<params>
				<param name="vvd_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="slan_cd" type="12" value="" out="N"/>
				<param name="cre_dt" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
