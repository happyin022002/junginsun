<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UsaManifestListDownloadDBDAOmodifyMibNumberByBlUSQL">
			<desc><![CDATA[dwkim, Ibd_Trsp_No 갱신. 0408]]></desc>
			<sql><![CDATA[
UPDATE BKG_CSTMS_ADV_IBD
SET
	IBD_TRSP_NO = DECODE(NVL(CSTMS_CLR_TP_CD, ' '), 'I', @[pmib_no], '')
    ,IBD_TRSP_ISS_DT = GLOBALDATE_PKG.TIME_CONV_FNC ('KRACY', sysdate, 'USNYC')
    ,UPD_USR_ID = @[user_id]
    ,UPD_DT = SYSDATE
WHERE
	(CNT_CD, BL_NO) IN (
		SELECT CNT_CD, BL_NO 
		FROM BKG_CSTMS_ADV_BL A
		WHERE A.VSL_CD = SUBSTR(@[vvd], 1, 4)
			AND A.SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
			AND A.SKD_DIR_CD = SUBSTR(@[vvd], 9, 1)
			AND A.CSTMS_POD_CD = @[pod]
			AND NVL(A.HUB_LOC_CD,'C') = NVL(@[hub],'C')
			AND A.CSTMS_LOC_CD = @[cstms]
			AND A.DEL_CD = @[del]
			AND A.MF_STS_CD = 'A'
			AND A.CNT_CD = 'US'
			AND A.BL_NO = NVL(@[bl_no], A.BL_NO)
	)			]]></sql>
			<params>
				<param name="pmib_no" type="12" value="" out="N"/>
				<param name="user_id" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="pod" type="12" value="" out="N"/>
				<param name="hub" type="12" value="" out="N"/>
				<param name="cstms" type="12" value="" out="N"/>
				<param name="del" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
