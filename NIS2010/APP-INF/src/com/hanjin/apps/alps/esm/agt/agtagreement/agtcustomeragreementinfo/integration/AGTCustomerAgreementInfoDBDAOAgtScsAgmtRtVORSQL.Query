<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AGTCustomerAgreementInfoDBDAOAgtScsAgmtRtVORSQL">
			<desc><![CDATA[[ESM_AGT_0057]Brokerage Agreement Rate Creation]]></desc>
			<sql><![CDATA[
SELECT
           A.AR_OFC_CD,
           CONCAT(A.CMPN_CNT_CD, TO_CHAR(A.CUST_SEQ, 'FM000000'))                  AS BROG_CNT_CUST_SEQ,
      CASE TO_CHAR(A.CUST_SEQ, 'FM000000')
      WHEN '999999'
      THEN 'All customer for General Rate Case'
      WHEN '888888'
      THEN 'All customer for Special Rate Case'
      WHEN '777777'
      THEN 'All customer for Canadian Special Rate Case'
      ELSE NVL(REPLACE(REPLACE(B.CUST_LGL_ENG_NM,CHR(13)||CHR(10),' '),CHR(9),' '),' ')
       END                                                                              AS BROG_CNT_CUST_NM,
      CASE CONCAT(A.SHPR_CNT_CD, TO_CHAR(A.SHPR_SEQ, 'FM000000'))
      WHEN '*000000'
      THEN '*'
      ELSE NVL(CONCAT(A.SHPR_CNT_CD, TO_CHAR(A.SHPR_SEQ, 'FM000000')), '*')
       END                                                                              AS SHPR_CNT_SEQ,
           NVL(REPLACE(REPLACE(C.CUST_LGL_ENG_NM,CHR(13)||CHR(10),' '),CHR(9),' '),' ') AS SHPR_CNT_NM,
           NVL(A.POR_GRP_TP_CD, '*')                                                    AS POR_GRP_TP_CD,
           NVL(A.POR_ROUT_CD,   '*')                                                    AS POR_ROUT_CD,
           NVL(A.POL_GRP_TP_CD, '*')                                                    AS POL_GRP_TP_CD,
           NVL(A.POL_ROUT_CD,   '*')                                                    AS POL_ROUT_CD,
           NVL(A.POD_GRP_TP_CD, '*')                                                    AS POD_GRP_TP_CD,
           NVL(A.POD_ROUT_CD,   '*')                                                    AS POD_ROUT_CD,
           NVL(A.FM_EFF_DT, '20000101')                                                 AS FM_EFF_DT,
           NVL(A.TO_EFF_DT, '29991231')                                                 AS TO_EFF_DT,
           NVL(A.SC_NO,         '*')                                                    AS SC_NO,
           NVL(A.RFA_NO,        '*')                                                    AS RFA_NO,
           NVL(A.CMDT_TP_CD,    '*')                                                    AS CMDT_TP_CD,
           NVL(A.CMDT_CD,       '*')                                                    AS CMDT_CD,
      CASE A.CMDT_TP_CD
      WHEN '2'
      THEN E.REP_CMDT_NM
      WHEN '3'
      THEN F.CMDT_NM
       END                                                                              AS CMDT_NM,
           NVL(A.CMPN_DIV_CD,   ' ')                                                    AS BROG_DIV_CD,
           NVL(A.CMPN_TP_CD,    ' ')                                                    AS BROG_TP_CD,
           NVL(A.CMPN_BKG_RT,     0)                                                    AS BKG_BROG_RT,
           NVL(A.CMPN_BX_RT,      0)                                                    AS BROG_BX_RT,
           NVL(A.CMPN_TEU_RT,     0)                                                    AS BROG_TEU_RT,
           NVL(A.CMPN_FEU_RT,     0)                                                    AS BROG_FEU_RT,
           NVL(A.CMPN_RF_RT,      0)                                                    AS BROG_RF_RT,
           NVL(A.CMPN_RF_TEU_RT,  0)                               	       	            AS BROG_RTEU_RT,
           NVL(A.CMPN_RF_FEU_RT,  0)                                 	                AS BROG_RFEU_RT,
           NVL(A.CMPN_CHG_CTNT, ' ')                                                    AS BROG_CHG_CTNT,
           NVL(A.CMPN_KND_CD,   'F')                                                    AS BROG_KND_CD,
           A.CMPN_RT_SEQ																AS BROG_RT_SEQ
      FROM AGT_CMPN_AGMT_RT A,
           MDM_CUSTOMER     B,
           MDM_CUSTOMER     C,
           MDM_REP_CMDT     E,
           MDM_COMMODITY    F
     WHERE A.CMPN_CNT_CD    = B.CUST_CNT_CD(+)
       AND A.CUST_SEQ  = B.CUST_SEQ(+)
       AND A.SHPR_CNT_CD    = C.CUST_CNT_CD(+)
       AND A.SHPR_SEQ       = C.CUST_SEQ(+)
       AND A.CMDT_CD        = E.REP_CMDT_CD(+)
       AND A.CMDT_CD        = F.CMDT_CD(+)
	   AND A.AR_OFC_CD		= @[ofc_cd]
#if(${search_brog_cnt_cust_seq} != '')
       AND CONCAT(A.CMPN_CNT_CD, TO_CHAR(A.CUST_SEQ, 'FM000000')) LIKE @[search_brog_cnt_cust_seq]||'%'
#end
  ORDER BY 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14			]]></sql>
			<params>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="search_brog_cnt_cust_seq" type="12" value="" out="Y"/>
			</params>
		</query>
	</querys>
</sqls>
