<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralBookingReceiptDBDAOmodifyXterRefernceUSQL">
			<desc><![CDATA[modifyXterRefernce]]></desc>
			<sql><![CDATA[
MERGE INTO BKG_REFERENCE BKG_REF 
USING ( SELECT @[bkg_no] BKG_NO, @[bkg_ref_tp_cd] BKG_REF_TP_CD
        FROM dual ) REF 
ON ( BKG_REF.BKG_NO = REF.BKG_NO
     AND BKG_REF.BKG_REF_TP_CD = REF.BKG_REF_TP_CD)

WHEN MATCHED THEN
    UPDATE
    SET CUST_REF_NO_CTNT = @[cust_ref_no_ctnt] ,
      UPD_USR_ID = @[usr_id] ,
      UPD_DT = sysdate
    WHERE BKG_NO = @[bkg_no]
      AND BKG_REF_TP_CD = @[bkg_ref_tp_cd]
WHEN NOT MATCHED THEN
    INSERT ( BKG_NO ,
          REF_SEQ ,
          BKG_REF_TP_CD ,
          CUST_REF_NO_CTNT ,
          CRE_USR_ID ,
          CRE_DT ,
          UPD_USR_ID ,
          UPD_DT)
    VALUES ( @[bkg_no] ,
        (SELECT NVL(MAX(REF_SEQ), 0) + 1
        FROM BKG_REFERENCE
        WHERE BKG_NO = @[bkg_no]),
          @[bkg_ref_tp_cd] ,
          @[cust_ref_no_ctnt] ,
          @[usr_id] ,
          sysdate ,
          @[usr_id] ,
          sysdate )			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="bkg_ref_tp_cd" type="12" value="" out="N"/>
				<param name="cust_ref_no_ctnt" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
