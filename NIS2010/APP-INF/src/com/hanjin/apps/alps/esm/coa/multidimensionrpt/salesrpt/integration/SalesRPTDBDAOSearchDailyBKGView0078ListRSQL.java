/*=========================================================
*Copyright(c) 2015 CyberLogitec
*@FileName : SalesRPTDBDAOSearchDailyBKGView0078ListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2015.08.05
*@LastModifier : 손진환
*@LastVersion : 1.0
* 2015.08.05 손진환
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esm.coa.multidimensionrpt.salesrpt.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author Son, Jin-Hwan
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class SalesRPTDBDAOSearchDailyBKGView0078ListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * Office Report-by Daily BKG Creation
	  *  - Office Report by Daily BKG Creation  화면에 CNEE NAME 조회 기능 추가
	  * 
	  * 2012.01.03 [CHM-201114896-01] 이석준  CM2(Own Feeder) 비용 반영
	  * 2015.08.31 손진환 [CHM-201536992] Split14-[그룹사 표준 코드 시행] HJS 프로그램 대응 및 데이타 마이그레이션 작업 요청
	  * </pre>
	  */
	public SalesRPTDBDAOSearchDailyBKGView0078ListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esm.coa.multidimensionrpt.salesrpt.integration").append("\n"); 
		query.append("FileName : SalesRPTDBDAOSearchDailyBKGView0078ListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if(${f_prd_cd}=='B')" ).append("\n"); 
		query.append("			SELECT  " ).append("\n"); 
		query.append("			#if(${f_isvvd}=='Y')" ).append("\n"); 
		query.append("				         B1.TRD_CD " ).append("\n"); 
		query.append("				        ,B1.RLANE_CD " ).append("\n"); 
		query.append("				        ,B1.DIR_CD " ).append("\n"); 
		query.append("				        ,B1.VSL_CD || B1.SKD_VOY_NO || B1.DIR_CD AS VVD_CD, " ).append("\n"); 
		query.append("			#else     " ).append("\n"); 
		query.append("			          '' TRD_CD" ).append("\n"); 
		query.append("			          , '' RLANE_CD" ).append("\n"); 
		query.append("			          , '' DIR_CD" ).append("\n"); 
		query.append("			          , '' VVD_CD," ).append("\n"); 
		query.append("		  #end " ).append("\n"); 
		query.append("			#if(${f_isvvd}=='Y' || ${f_isweek}=='Y')" ).append("\n"); 
		query.append("				         B1.COST_WK, " ).append("\n"); 
		query.append("			#else         " ).append("\n"); 
		query.append("			          '' COST_WK, " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isroute}=='Y')  " ).append("\n"); 
		query.append("				         B2.BKG_POR_CD " ).append("\n"); 
		query.append("				        ,B2.BKG_POL_CD " ).append("\n"); 
		query.append("				        ,B2.BKG_POD_CD" ).append("\n"); 
		query.append("				        ,B2.REV_POL_CD " ).append("\n"); 
		query.append("				        ,B2.REV_POD_CD " ).append("\n"); 
		query.append("				        ,B2.BKG_DEL_CD, " ).append("\n"); 
		query.append("			#else " ).append("\n"); 
		query.append("				         '' AS BKG_POR_CD " ).append("\n"); 
		query.append("				        ,'' AS BKG_POL_CD " ).append("\n"); 
		query.append("				        ,'' AS BKG_POD_CD " ).append("\n"); 
		query.append("				        ,'' AS REV_POL_CD " ).append("\n"); 
		query.append("				        ,'' AS REV_POD_CD " ).append("\n"); 
		query.append("				        ,'' AS BKG_DEL_CD, " ).append("\n"); 
		query.append("			#end			" ).append("\n"); 
		query.append("			         B2.AGMT_SGN_OFC_CD AS C_OFC_CD " ).append("\n"); 
		query.append("			        ,B2.SLS_OFC_CD      AS L_OFC_CD " ).append("\n"); 
		query.append("			#if(${f_issrep}=='Y')" ).append("\n"); 
		query.append("				        ,B2.CTRT_SREP_CD  AS C_REP_CD " ).append("\n"); 
		query.append("				        ,B2.SREP_CD       AS L_REP_CD " ).append("\n"); 
		query.append("			#else         " ).append("\n"); 
		query.append("			          ,'' AS L_REP_CD" ).append("\n"); 
		query.append("			          ,'' AS C_REP_CD" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_issc}=='Y')" ).append("\n"); 
		query.append("				        ,B2.SC_NO  " ).append("\n"); 
		query.append("				        ,B2.RFA_NO " ).append("\n"); 
		query.append("			#else        " ).append("\n"); 
		query.append("			          ,'' AS SC_NO" ).append("\n"); 
		query.append("			          ,'' AS RFA_NO " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isshpr}=='Y')         " ).append("\n"); 
		query.append("			          ,B4.CUST_LGL_ENG_NM AS SHPR_NM " ).append("\n"); 
		query.append("			#else        " ).append("\n"); 
		query.append("			          ,'' AS SHPR_NM " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			#if(${f_iscnee}=='Y')         " ).append("\n"); 
		query.append("			          ,B6.CUST_LGL_ENG_NM AS CNEE_NM " ).append("\n"); 
		query.append("			#else        " ).append("\n"); 
		query.append("			          ,'' AS CNEE_NM  " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			#if(${f_iscmdt}=='Y')" ).append("\n"); 
		query.append("				        ,B2.CMDT_CD " ).append("\n"); 
		query.append("				        ,B5.CMDT_NM " ).append("\n"); 
		query.append("			#else     " ).append("\n"); 
		query.append("			          ,'' AS CMDT_CD" ).append("\n"); 
		query.append("			          , '' AS CMDT_NM " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isbkg}=='Y')          " ).append("\n"); 
		query.append("			          ,B2.BKG_NO  " ).append("\n"); 
		query.append("			#else     " ).append("\n"); 
		query.append("			          ,'' AS BKG_NO " ).append("\n"); 
		query.append("			#end			" ).append("\n"); 
		query.append("            #if(${f_istpsz}=='Y')" ).append("\n"); 
		query.append("					,B2.SPCL_CNTR_TPSZ_CD" ).append("\n"); 
		query.append("			        ,SUM(NVL(B2.BKG_QTY,0)) AS BOX " ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("					,'' AS SPCL_CNTR_TPSZ_CD" ).append("\n"); 
		query.append("			        ,'' AS BOX " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			        ,SUM(DECODE(SUBSTR(B2.SPCL_CNTR_TPSZ_CD,-1,1),'2', NVL(B2.BKG_QTY,0), '3', NVL(B2.BKG_QTY,0), NVL(B2.BKG_QTY,0)*2)) AS LOAD " ).append("\n"); 
		query.append("			        ,SUM(NVL(B2.BKG_REV,0)+NVL(B2.BKG_OFT_REV,0)) AS REV " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			        ,SUM(NVL(B2.BKG_REV,0)+NVL(B2.BKG_OFT_REV,0)+NVL(B2.BKG_MISC_REV,0)+NVL(B2.SCR_CHG_REV,0)) - " ).append("\n"); 
		query.append("			         SUM(DECODE('${f_pro_vw}', 'P', NVL(B2.PA_CM_COST_TTL_AMT,0) + NVL(B2.OWN_FDR_AMT,0), 'R', NVL(B2.RA_CM_COST_TTL_AMT, 0)+NVL(B2.OWN_FDR_AMT,0) ))    AS CM2  " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			        ,SUM(NVL(B2.BKG_REV,0)+NVL(B2.BKG_OFT_REV,0)+NVL(B2.BKG_MISC_REV,0)+NVL(B2.SCR_CHG_REV,0)) - " ).append("\n"); 
		query.append("			         SUM(DECODE('${f_pro_vw}', 'P', NVL(B2.PA_CM_COST_TTL_AMT,0), 'R', NVL(B2.RA_CM_COST_TTL_AMT, 0) ))    AS CM  " ).append("\n"); 
		query.append("                        " ).append("\n"); 
		query.append("			        ,'' AS OP " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			        ,SUM(B2.OWN_FDR_AMT) AS OWN_FDR" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			        ,SUM(DECODE('${f_pro_vw}', 'P', NVL(B2.PA_CM_COST_TTL_AMT,0), 'R', NVL(B2.RA_CM_COST_TTL_AMT, 0) )) AS CM_COST " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("			        ,SUM(DECODE('${f_pro_vw}', 'P', 0,'R', NVL(B2.RA_OP_COST_TTL_AMT, 0) )) AS OP_COST " ).append("\n"); 
		query.append("			        ,'' AS GRPB " ).append("\n"); 
		query.append("			        ,'' AS CMB " ).append("\n"); 
		query.append("			        ,'' AS OPB " ).append("\n"); 
		query.append("			  FROM ( " ).append("\n"); 
		query.append("			       SELECT " ).append("\n"); 
		query.append("			              A1.BKG_NO " ).append("\n"); 
		query.append("			             ,A2.TRD_CD " ).append("\n"); 
		query.append("			             ,A2.RLANE_CD " ).append("\n"); 
		query.append("			             ,A2.IOC_CD " ).append("\n"); 
		query.append("			             ,A2.VSL_CD " ).append("\n"); 
		query.append("			             ,A2.SKD_VOY_NO " ).append("\n"); 
		query.append("			             ,A2.DIR_CD " ).append("\n"); 
		query.append("			             ,A2.COST_YRMON " ).append("\n"); 
		query.append("			             ,A2.COST_WK " ).append("\n"); 
		query.append("			       FROM BKG_BOOKING A1 " ).append("\n"); 
		query.append("			           ,COA_MON_VVD A2 " ).append("\n"); 
		query.append("			       WHERE 1=1 " ).append("\n"); 
		query.append("			         AND A1.VSL_CD     = A2.VSL_CD " ).append("\n"); 
		query.append("			         AND A1.SKD_VOY_NO = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("			         AND A1.SKD_DIR_CD = A2.DIR_CD " ).append("\n"); 
		query.append("			         AND A2.DELT_FLG   = 'N' " ).append("\n"); 
		query.append("			#if(${f_vsl_cd}!='' && ${f_skd_voy_no}!='' && ${f_dir_cd}!='')" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				         AND A1.BKG_CRE_DT BETWEEN TO_DATE('${f_fm_date}','yyyymmdd') AND TO_DATE('${f_to_date}','yyyymmdd')+0.999999 " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_trd_cd}!='')             " ).append("\n"); 
		query.append("			        AND A2.TRD_CD     = '${f_trd_cd}' " ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("			#if(${f_rlane_cd}!='')           " ).append("\n"); 
		query.append("			        AND A2.RLANE_CD   = '${f_rlane_cd}' " ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("			#if(${f_vsl_cd}!='')             " ).append("\n"); 
		query.append("			        AND A2.VSL_CD     = '${f_vsl_cd}' " ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("			#if(${f_skd_voy_no}!='')         " ).append("\n"); 
		query.append("			        AND A2.SKD_VOY_NO = '${f_skd_voy_no}' " ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("			#if(${f_dir_cd}!='')             " ).append("\n"); 
		query.append("			        AND A2.DIR_CD     = '${f_dir_cd}' " ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("			#if(${f_skd_dir_cd}!='')         " ).append("\n"); 
		query.append("			        AND A2.DIR_CD     = '${f_skd_dir_cd}' " ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("			       ) B1 " ).append("\n"); 
		query.append("			      ,COA_BKG_EXPN_DTL  B2 " ).append("\n"); 
		query.append("			      ,COA_OFC_LVL B3       " ).append("\n"); 
		query.append("			#if(${f_isshpr}=='Y')      " ).append("\n"); 
		query.append("			      ,MDM_CUSTOMER B4      " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			#if(${f_iscmdt}=='Y')      " ).append("\n"); 
		query.append("			      ,MDM_COMMODITY B5     " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_iscnee}=='Y')      " ).append("\n"); 
		query.append("			      ,MDM_CUSTOMER B6      " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			  WHERE B1.BKG_NO        = B2.BKG_NO " ).append("\n"); 
		query.append("			    AND B1.TRD_CD        = B2.TRD_CD " ).append("\n"); 
		query.append("			    AND B1.RLANE_CD      = B2.RLANE_CD " ).append("\n"); 
		query.append("			    AND B1.VSL_CD        = B2.VSL_CD " ).append("\n"); 
		query.append("			    AND B1.SKD_VOY_NO    = B2.SKD_VOY_NO " ).append("\n"); 
		query.append("			    AND B1.DIR_CD        = B2.DIR_CD " ).append("\n"); 
		query.append("			    AND B1.IOC_CD        = B2.IOC_CD " ).append("\n"); 
		query.append("			    AND B2.BKG_CGO_TP_CD NOT IN ('P') " ).append("\n"); 
		query.append("			    AND B2.BL_NO_TP      IN ('M','0') " ).append("\n"); 
		query.append("			    AND B2.BKG_STS_CD    IN ('F','S',DECODE('${f_bkg_sts}','Y','W'))  " ).append("\n"); 
		query.append("			#if(${f_srep_cd}!='')    " ).append("\n"); 
		query.append("			    AND DECODE('${f_ofc_vw}', 'C', B2.CTRT_SREP_CD, 'L', B2.SREP_CD)  = UPPER('${f_srep_cd}') " ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("			#if(${f_sc_no}!='')      " ).append("\n"); 
		query.append("			    AND B2.SC_NO         = '${f_sc_no}' " ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("			#if(${f_rfa}!='')        " ).append("\n"); 
		query.append("			    AND B2.RFA_NO        = '${f_rfa}' " ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("			  " ).append("\n"); 
		query.append("			#if(${f_iscmdt}=='Y')    " ).append("\n"); 
		query.append("			    AND B2.CMDT_CD       = B5.CMDT_CD " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isshpr}=='Y')" ).append("\n"); 
		query.append("			    AND B2.SHPR_CNT_CD   = B4.CUST_CNT_CD(+) " ).append("\n"); 
		query.append("			    AND B2.SHPR_CUST_SEQ = B4.CUST_SEQ(+) " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_iscnee}=='Y')" ).append("\n"); 
		query.append("			    AND B2.CNEE_CNT_CD   = B6.CUST_CNT_CD(+) " ).append("\n"); 
		query.append("			    AND B2.CNEE_CUST_SEQ = B6.CUST_SEQ(+) " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			    AND B1.COST_YRMON BETWEEN B3.OFC_APLY_FM_YRMON AND B3.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("				AND B1.COST_YRMON = B2.COST_YRMON" ).append("\n"); 
		query.append("			    AND DECODE('${f_ofc_vw}', 'C', B2.AGMT_SGN_OFC_CD, 'L', B2.SLS_OFC_CD)  = B3.OFC_CD " ).append("\n"); 
		query.append("			#if (${f_sls_ofc_cd}!='') " ).append("\n"); 
		query.append("				#if(${f_excl_sts}=='')" ).append("\n"); 
		query.append("					    AND DECODE('${f_rhq_cd}', '1', B3.OFC_N1ST_LVL_CD, '2', B3.OFC_N2ND_LVL_CD, '3', B3.OFC_N3RD_LVL_CD, '4', B3.OFC_N4TH_LVL_CD, '5', B3.OFC_N5TH_LVL_CD, '6', B3.OFC_N6TH_LVL_CD, '7', B3.OFC_N7TH_LVL_CD) = '${f_sls_ofc_cd}' " ).append("\n"); 
		query.append("				#else" ).append("\n"); 
		query.append("					    AND B3.OFC_CD        = '${f_sls_ofc_cd}'" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				    AND DECODE('${f_rhq_cd}', '1', B3.OFC_N1ST_LVL_CD, '2', B3.OFC_N2ND_LVL_CD,    '3', B3.OFC_N3RD_LVL_CD, '4', B3.OFC_N4TH_LVL_CD, '5', B3.OFC_N5TH_LVL_CD, '6', B3.OFC_N6TH_LVL_CD, '7', B3.OFC_N7TH_LVL_CD) IS NOT NULL " ).append("\n"); 
		query.append("				    AND DECODE('${f_rhq_cd}', '1', B3.OFC_N1ST_LVL_CD, '2', B3.OFC_N2ND_LVL_TP_CD, '3', B3.OFC_N3RD_LVL_TP_CD " ).append("\n"); 
		query.append("				                  , '4', DECODE(SUBSTR(B1.COST_YRMON, 1, 4), '2008', DECODE(B3.OFC_N4TH_LVL_CD, 'NYCRA', B3.OFC_N4TH_LVL_CD, B3.OFC_N4TH_LVL_TP_CD) " ).append("\n"); 
		query.append("				                                                           , '2007', DECODE(B3.OFC_N4TH_LVL_CD, 'NYCRA', B3.OFC_N4TH_LVL_CD, B3.OFC_N4TH_LVL_TP_CD) " ).append("\n"); 
		query.append("				                                                           , DECODE(B3.OFC_N4TH_LVL_CD, 'SZPDC', B3.OFC_N4TH_LVL_TP_CD, B3.OFC_N4TH_LVL_CD)) " ).append("\n"); 
		query.append("				                 , '5', B3.OFC_N5TH_LVL_TP_CD, '6', B3.OFC_N6TH_LVL_TP_CD,'7', B3.OFC_N7TH_LVL_TP_CD) IS NOT NULL " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		 	#if(${f_cntr_tpsz_cd}!='')" ).append("\n"); 
		query.append("					AND B2.CNTR_TPSZ_CD='${f_cntr_tpsz_cd}'" ).append("\n"); 
		query.append(" 			#end" ).append("\n"); 
		query.append("			  GROUP BY " ).append("\n"); 
		query.append("			#if(${f_isvvd}=='Y')" ).append("\n"); 
		query.append("				         B1.TRD_CD " ).append("\n"); 
		query.append("				        ,B1.RLANE_CD " ).append("\n"); 
		query.append("				        ,B1.DIR_CD " ).append("\n"); 
		query.append("				        ,B1.VSL_CD || B1.SKD_VOY_NO || B1.DIR_CD, " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isvvd}=='Y' || ${f_isweek}=='Y')" ).append("\n"); 
		query.append("				         B1.COST_WK ," ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			         B2.AGMT_SGN_OFC_CD " ).append("\n"); 
		query.append("			        ,B2.SLS_OFC_CD " ).append("\n"); 
		query.append("			#if(${f_isroute}=='Y') " ).append("\n"); 
		query.append("				        ,B2.BKG_POR_CD " ).append("\n"); 
		query.append("				        ,B2.BKG_POL_CD " ).append("\n"); 
		query.append("				        ,B2.BKG_POD_CD " ).append("\n"); 
		query.append("				        ,B2.REV_POL_CD " ).append("\n"); 
		query.append("				        ,B2.REV_POD_CD " ).append("\n"); 
		query.append("				        ,B2.BKG_DEL_CD " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_issc}=='Y')" ).append("\n"); 
		query.append("				        ,B2.SC_NO  " ).append("\n"); 
		query.append("				        ,B2.RFA_NO " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_iscmdt}=='Y')" ).append("\n"); 
		query.append("				        ,B2.CMDT_CD " ).append("\n"); 
		query.append("				        ,B5.CMDT_NM " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_issrep}=='Y')" ).append("\n"); 
		query.append("				        ,B2.SREP_CD " ).append("\n"); 
		query.append("				        ,B2.CTRT_SREP_CD " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isshpr}=='Y')         " ).append("\n"); 
		query.append("			          ,B4.CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_iscnee}=='Y')         " ).append("\n"); 
		query.append("			          ,B6.CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isbkg}=='Y')          " ).append("\n"); 
		query.append("			          ,B2.BKG_NO" ).append("\n"); 
		query.append("			#end	" ).append("\n"); 
		query.append("			#if(${f_istpsz}=='Y')" ).append("\n"); 
		query.append("				  	  ,B2.SPCL_CNTR_TPSZ_CD" ).append("\n"); 
		query.append("			#end		" ).append("\n"); 
		query.append("#else  " ).append("\n"); 
		query.append("			#if(${f_sls_ofc_cd}=='')" ).append("\n"); 
		query.append("			 SELECT /*+ordered*/" ).append("\n"); 
		query.append("			#else " ).append("\n"); 
		query.append("			 SELECT" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isvvd}=='Y')" ).append("\n"); 
		query.append("				         B1.TRD_CD " ).append("\n"); 
		query.append("				        ,B1.RLANE_CD " ).append("\n"); 
		query.append("				        ,B1.DIR_CD " ).append("\n"); 
		query.append("				        ,B1.VSL_CD || B1.SKD_VOY_NO || B1.DIR_CD AS VVD_CD, " ).append("\n"); 
		query.append("			#else         " ).append("\n"); 
		query.append("			          '' TRD_CD, '' RLANE_CD, '' DIR_CD, '' VVD_CD, " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isvvd}=='Y' || ${f_isweek}=='Y')" ).append("\n"); 
		query.append("				        B1.COST_WK, " ).append("\n"); 
		query.append("			#else         " ).append("\n"); 
		query.append("			          '' COST_WK, " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isroute}=='Y') " ).append("\n"); 
		query.append("				         B2.BKG_POR_CD " ).append("\n"); 
		query.append("				        ,B2.BKG_POL_CD " ).append("\n"); 
		query.append("				        ,B2.BKG_POD_CD " ).append("\n"); 
		query.append("				        ,B2.REV_POL_CD " ).append("\n"); 
		query.append("				        ,B2.REV_POD_CD " ).append("\n"); 
		query.append("				        ,B2.BKG_DEL_CD, " ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				         '' AS BKG_POR_CD " ).append("\n"); 
		query.append("				        ,'' AS BKG_POL_CD " ).append("\n"); 
		query.append("				        ,'' AS BKG_POD_CD " ).append("\n"); 
		query.append("				        ,'' AS REV_POL_CD " ).append("\n"); 
		query.append("				        ,'' AS REV_POD_CD " ).append("\n"); 
		query.append("				        ,'' AS BKG_DEL_CD, " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			         B2.AGMT_SGN_OFC_CD AS C_OFC_CD " ).append("\n"); 
		query.append("			        ,B2.SLS_OFC_CD      AS L_OFC_CD  " ).append("\n"); 
		query.append("			#if(${f_issrep}=='Y')" ).append("\n"); 
		query.append("				        ,B2.CTRT_SREP_CD  AS C_REP_CD" ).append("\n"); 
		query.append("				        ,B2.SREP_CD       AS L_REP_CD " ).append("\n"); 
		query.append("			#else         " ).append("\n"); 
		query.append("			          ,'' AS L_REP_CD, ''  AS C_REP_CD" ).append("\n"); 
		query.append("      #end			          " ).append("\n"); 
		query.append("			#if(${f_issc}=='Y')" ).append("\n"); 
		query.append("				        ,B2.SC_NO  " ).append("\n"); 
		query.append("				        ,B2.RFA_NO " ).append("\n"); 
		query.append("			#else        " ).append("\n"); 
		query.append("			          ,'' AS SC_NO,'' AS RFA_NO " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isshpr}=='Y')         " ).append("\n"); 
		query.append("			          ,B4.CUST_LGL_ENG_NM  AS SHPR_NM " ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("			          ,'' AS SHPR_NM " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			#if(${f_iscnee}=='Y')         " ).append("\n"); 
		query.append("                      ,B6.CUST_LGL_ENG_NM AS CNEE_NM " ).append("\n"); 
		query.append("            #else        " ).append("\n"); 
		query.append("                      ,'' AS CNEE_NM " ).append("\n"); 
		query.append("            #end			" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("			#if(${f_iscmdt}=='Y')" ).append("\n"); 
		query.append("				        ,B2.CMDT_CD " ).append("\n"); 
		query.append("				        ,B5.CMDT_NM " ).append("\n"); 
		query.append("			#else        " ).append("\n"); 
		query.append("			          ,'' AS CMDT_CD, '' AS CMDT_NM " ).append("\n"); 
		query.append("			#end          " ).append("\n"); 
		query.append("			#if(${f_isbkg}=='Y')          " ).append("\n"); 
		query.append("			          ,B2.BKG_NO  " ).append("\n"); 
		query.append("		    #else        " ).append("\n"); 
		query.append("		            ,'' AS BKG_NO " ).append("\n"); 
		query.append("   		    #end			" ).append("\n"); 
		query.append("            #if(${f_istpsz}=='Y')" ).append("\n"); 
		query.append("					,B2.SPCL_CNTR_TPSZ_CD" ).append("\n"); 
		query.append("			        ,SUM(NVL(B2.BKG_QTY,0)) AS BOX " ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("					,'' AS SPCL_CNTR_TPSZ_CD" ).append("\n"); 
		query.append("			        ,'' AS BOX " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			        ,SUM(DECODE(SUBSTR(B2.SPCL_CNTR_TPSZ_CD,-1,1),'2', NVL(B2.BKG_QTY,0), '3', NVL(B2.BKG_QTY,0), NVL(B2.BKG_QTY,0)*2))    LOAD " ).append("\n"); 
		query.append("			        ,SUM(NVL(B2.BKG_REV,0)+NVL(B2.BKG_OFT_REV,0)) REV " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		        ,SUM(NVL(B2.BKG_REV,0)+NVL(B2.BKG_OFT_REV,0)+NVL(B2.BKG_MISC_REV,0)+NVL(B2.SCR_CHG_REV,0)) - " ).append("\n"); 
		query.append("			         SUM(DECODE('${f_pro_vw}', 'P', NVL(B2.PA_CM_COST_TTL_AMT,0) + NVL(B2.OWN_FDR_AMT,0), 'R', NVL(B2.RA_CM_COST_TTL_AMT, 0)+NVL(B2.OWN_FDR_AMT,0) ))    AS CM2  " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			        ,SUM(NVL(B2.BKG_REV,0)+NVL(B2.BKG_OFT_REV,0)+NVL(B2.BKG_MISC_REV,0)+NVL(B2.SCR_CHG_REV,0)) - " ).append("\n"); 
		query.append("			         SUM(DECODE('${f_pro_vw}', 'P', NVL(B2.PA_CM_COST_TTL_AMT,0),   'R', NVL(B2.RA_CM_COST_TTL_AMT, 0) ))    CM " ).append("\n"); 
		query.append("			        ,'' AS OP " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			        ,SUM(B2.OWN_FDR_AMT) OWN_FDR" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			        ,SUM(DECODE('${f_pro_vw}', 'P', NVL(B2.PA_CM_COST_TTL_AMT,0),   'R', NVL(B2.RA_CM_COST_TTL_AMT, 0) ))  + " ).append("\n"); 
		query.append("			         SUM(NVL(B2.DMDT_COM_AMT,0)) CM_COST " ).append("\n"); 
		query.append("			        ,SUM(DECODE('${f_pro_vw}', 'P', 0,'R', NVL(b2.ra_op_cost_ttl_amt, 0) )) op_cost " ).append("\n"); 
		query.append("			        ,'' AS GRPB " ).append("\n"); 
		query.append("			        ,'' AS CMB " ).append("\n"); 
		query.append("			        ,'' AS OPB " ).append("\n"); 
		query.append("			  FROM ( " ).append("\n"); 
		query.append("			         SELECT DISTINCT " ).append("\n"); 
		query.append("			                A1.COST_YRMON " ).append("\n"); 
		query.append("			               ,A1.COST_WK " ).append("\n"); 
		query.append("			               ,A1.TRD_CD " ).append("\n"); 
		query.append("			               ,A1.RLANE_CD " ).append("\n"); 
		query.append("			               ,A1.SLAN_CD " ).append("\n"); 
		query.append("			               ,A1.IOC_CD " ).append("\n"); 
		query.append("			               ,A1.VSL_CD " ).append("\n"); 
		query.append("			               ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("			               ,A1.DIR_CD " ).append("\n"); 
		query.append("			               ,A2.VPS_PORT_CD " ).append("\n"); 
		query.append("			           FROM COA_MON_VVD A1 " ).append("\n"); 
		query.append("			               ,VSK_VSL_PORT_SKD A2 " ).append("\n"); 
		query.append("			          WHERE A1.VSL_CD     = A2.VSL_CD " ).append("\n"); 
		query.append("			            AND A1.SKD_VOY_NO = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("			            AND A1.DIR_CD     = A2.SKD_DIR_CD " ).append("\n"); 
		query.append("			            AND A1.SLAN_CD    = A2.SLAN_CD " ).append("\n"); 
		query.append("			            AND A1.DELT_FLG   = 'N' " ).append("\n"); 
		query.append("			#if(${f_vsl_cd}!='' && ${f_skd_voy_no}!='' && ${f_dir_cd}!='')" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				          AND A2.VPS_ETD_DT BETWEEN TO_DATE('${f_fm_date}','yyyymmdd') AND TO_DATE('${f_to_date}','yyyymmdd')+0.999999 " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_trd_cd}!='')                " ).append("\n"); 
		query.append("			            AND A1.TRD_CD     = '${f_trd_cd}'" ).append("\n"); 
		query.append("		  #end " ).append("\n"); 
		query.append("			#if(${f_rlane_cd}!='')              " ).append("\n"); 
		query.append("			            AND A1.RLANE_CD   = '${f_rlane_cd}'" ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("			#if(${f_vsl_cd}!='')                " ).append("\n"); 
		query.append("			            AND A1.VSL_CD     = '${f_vsl_cd}'" ).append("\n"); 
		query.append("		  #end " ).append("\n"); 
		query.append("			#if(${f_skd_voy_no}!='')            " ).append("\n"); 
		query.append("			            AND A1.SKD_VOY_NO = '${f_skd_voy_no}'" ).append("\n"); 
		query.append("		  #end " ).append("\n"); 
		query.append("			#if(${f_dir_cd}!='')                " ).append("\n"); 
		query.append("			            AND A1.DIR_CD     = '${f_dir_cd}'" ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("			#if(${f_skd_dir_cd}!='')            " ).append("\n"); 
		query.append("			            AND A1.DIR_CD     = '${f_skd_dir_cd}'" ).append("\n"); 
		query.append("	    #end " ).append("\n"); 
		query.append("			       ) B1 " ).append("\n"); 
		query.append("			      ,COA_BKG_EXPN_DTL  B2 " ).append("\n"); 
		query.append("			      ,COA_OFC_LVL B3       " ).append("\n"); 
		query.append("			#if(${f_isshpr}=='Y')      " ).append("\n"); 
		query.append("		        ,MDM_CUSTOMER B4      " ).append("\n"); 
		query.append("		  	#end" ).append("\n"); 
		query.append("			" ).append("\n"); 
		query.append("			#if(${f_iscmdt}=='Y')      " ).append("\n"); 
		query.append("			      ,MDM_COMMODITY B5     " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_iscnee}=='Y')      " ).append("\n"); 
		query.append("			      ,MDM_CUSTOMER B6      " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			  WHERE 1=1 " ).append("\n"); 
		query.append("			    AND B1.TRD_CD        = B2.TRD_CD " ).append("\n"); 
		query.append("			    AND B1.RLANE_CD      = B2.RLANE_CD " ).append("\n"); 
		query.append("			    AND B1.IOC_CD        = B2.IOC_CD " ).append("\n"); 
		query.append("			    AND B1.VSL_CD        = B2.VSL_CD " ).append("\n"); 
		query.append("			    AND B1.SKD_VOY_NO    = B2.SKD_VOY_NO " ).append("\n"); 
		query.append("			    AND B1.DIR_CD        = B2.DIR_CD " ).append("\n"); 
		query.append("			    AND B1.VPS_PORT_CD   = B2.REV_POL_CD " ).append("\n"); 
		query.append("			    AND B2.BKG_CGO_TP_CD <> 'P' " ).append("\n"); 
		query.append("			    AND B2.BL_NO_TP      IN ('M','0') " ).append("\n"); 
		query.append("			    AND B2.BKG_STS_CD    IN ('F','S',DECODE('${f_bkg_sts}','Y','W'))  " ).append("\n"); 
		query.append("			#if(${f_isshpr}=='Y')" ).append("\n"); 
		query.append("			    AND B2.SHPR_CNT_CD   = B4.CUST_CNT_CD(+) " ).append("\n"); 
		query.append("			    AND B2.SHPR_CUST_SEQ = B4.CUST_SEQ(+) " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_iscnee}=='Y')" ).append("\n"); 
		query.append("			    AND B2.CNEE_CNT_CD   = B6.CUST_CNT_CD(+) " ).append("\n"); 
		query.append("			    AND B2.CNEE_CUST_SEQ = B6.CUST_SEQ(+) " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_iscmdt}=='Y')          " ).append("\n"); 
		query.append("			    AND B2.CMDT_CD       = B5.CMDT_CD " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_srep_cd}!='')       " ).append("\n"); 
		query.append("			    AND DECODE('${f_ofc_vw}', 'C', B2.CTRT_SREP_CD, 'L', B2.SREP_CD)  = UPPER('${f_srep_cd}') " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_sc_no}!='')         " ).append("\n"); 
		query.append("			    AND B2.SC_NO         = '${f_sc_no}' " ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("			#if(${f_rfa}!='')           " ).append("\n"); 
		query.append("			    AND B2.RFA_NO        = '${f_rfa}' " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			#if(${f_rev_pol_cd}!='')    " ).append("\n"); 
		query.append("			    AND B2.REV_POL_CD    = '${f_rev_pol_cd}' " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			    AND DECODE('${f_ofc_vw}', 'C', B2.AGMT_SGN_OFC_CD, 'L', B2.SLS_OFC_CD)  = B3.OFC_CD " ).append("\n"); 
		query.append("			    AND B1.COST_YRMON BETWEEN B3.OFC_APLY_FM_YRMON AND B3.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("  				AND B1.COST_YRMON = B2.COST_YRMON" ).append("\n"); 
		query.append("			#if (${f_sls_ofc_cd}!='') " ).append("\n"); 
		query.append("                AND 1=1       " ).append("\n"); 
		query.append("				#if(${f_excl_sts}=='')" ).append("\n"); 
		query.append("					    AND DECODE('${f_rhq_cd}', '1', B3.OFC_N1ST_LVL_CD, '2', B3.OFC_N2ND_LVL_CD, '3', B3.OFC_N3RD_LVL_CD, '4', B3.OFC_N4TH_LVL_CD, '5', B3.OFC_N5TH_LVL_CD, '6', B3.OFC_N6TH_LVL_CD, '7', B3.OFC_N7TH_LVL_CD) = '${f_sls_ofc_cd}' " ).append("\n"); 
		query.append("				#else" ).append("\n"); 
		query.append("					    AND B3.OFC_CD        = '${f_sls_ofc_cd}' " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				    AND DECODE('${f_rhq_cd}', '1', B3.OFC_N1ST_LVL_CD, '2', B3.OFC_N2ND_LVL_CD,    '3', B3.OFC_N3RD_LVL_CD, '4', B3.OFC_N4TH_LVL_CD, '5', B3.OFC_N5TH_LVL_CD, '6', B3.OFC_N6TH_LVL_CD, '7', B3.OFC_N7TH_LVL_CD) IS NOT NULL " ).append("\n"); 
		query.append("				    AND DECODE('${f_rhq_cd}', '1', B3.OFC_N1ST_LVL_CD, '2', B3.OFC_N2ND_LVL_TP_CD, '3', B3.OFC_N3RD_LVL_TP_CD " ).append("\n"); 
		query.append("				                  , '4', DECODE(SUBSTR(B1.COST_YRMON, 1, 4), '2008', DECODE(B3.OFC_N4TH_LVL_CD, 'NYCRA', B3.OFC_N4TH_LVL_CD, B3.OFC_N4TH_LVL_TP_CD) " ).append("\n"); 
		query.append("				                                                           , '2007', DECODE(B3.OFC_N4TH_LVL_CD, 'NYCRA', B3.OFC_N4TH_LVL_CD, B3.OFC_N4TH_LVL_TP_CD) " ).append("\n"); 
		query.append("				                                                           , DECODE(B3.OFC_N4TH_LVL_CD, 'SZPDC', B3.OFC_N4TH_LVL_TP_CD, B3.OFC_N4TH_LVL_CD)) " ).append("\n"); 
		query.append("				                 , '5', B3.OFC_N5TH_LVL_TP_CD, '6', B3.OFC_N6TH_LVL_TP_CD,'7', B3.OFC_N7TH_LVL_TP_CD) IS NOT NULL " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		 	#if(${f_cntr_tpsz_cd}!='')" ).append("\n"); 
		query.append("					AND B2.CNTR_TPSZ_CD='${f_cntr_tpsz_cd}'" ).append("\n"); 
		query.append(" 			#end" ).append("\n"); 
		query.append("			  GROUP BY " ).append("\n"); 
		query.append("			#if(${f_isvvd}=='Y')" ).append("\n"); 
		query.append("				         B1.TRD_CD " ).append("\n"); 
		query.append("				        ,B1.RLANE_CD " ).append("\n"); 
		query.append("				        ,B1.DIR_CD " ).append("\n"); 
		query.append("				        ,B1.VSL_CD || B1.SKD_VOY_NO || B1.DIR_CD, " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isvvd}=='Y' || ${f_isweek}=='Y')" ).append("\n"); 
		query.append("				         B1.COST_WK, " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			         B2.AGMT_SGN_OFC_CD " ).append("\n"); 
		query.append("			        ,B2.SLS_OFC_CD " ).append("\n"); 
		query.append("			#if(${f_isroute}=='Y') " ).append("\n"); 
		query.append("				        ,B2.BKG_POR_CD " ).append("\n"); 
		query.append("				        ,B2.BKG_POL_CD " ).append("\n"); 
		query.append("				        ,B2.BKG_POD_CD " ).append("\n"); 
		query.append("				        ,B2.REV_POL_CD " ).append("\n"); 
		query.append("				        ,B2.REV_POD_CD " ).append("\n"); 
		query.append("				        ,B2.BKG_DEL_CD " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_issc}=='Y')" ).append("\n"); 
		query.append("				        ,B2.SC_NO  " ).append("\n"); 
		query.append("				        ,B2.RFA_NO " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_iscmdt}=='Y')" ).append("\n"); 
		query.append("				        ,B2.CMDT_CD " ).append("\n"); 
		query.append("				        ,B5.CMDT_NM " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_issrep}=='Y')" ).append("\n"); 
		query.append("				        ,B2.SREP_CD " ).append("\n"); 
		query.append("				        ,B2.CTRT_SREP_CD " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isshpr}=='Y')         " ).append("\n"); 
		query.append("			          ,B4.CUST_LGL_ENG_NM " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_iscnee}=='Y')         " ).append("\n"); 
		query.append("			          ,B6.CUST_LGL_ENG_NM " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("			#if(${f_isbkg}=='Y')          " ).append("\n"); 
		query.append("    	          	  ,B2.BKG_NO  " ).append("\n"); 
		query.append("			#end	" ).append("\n"); 
		query.append("			#if(${f_istpsz}=='Y')" ).append("\n"); 
		query.append("				  	  ,B2.SPCL_CNTR_TPSZ_CD" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 

	}
}