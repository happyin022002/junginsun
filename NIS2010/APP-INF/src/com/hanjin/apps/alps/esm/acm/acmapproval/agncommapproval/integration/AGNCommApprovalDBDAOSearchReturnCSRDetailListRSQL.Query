<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AGNCommApprovalDBDAOSearchReturnCSRDetailListRSQL">
			<desc><![CDATA[ACMCommVendorInfo]]></desc>
			<sql><![CDATA[
SELECT AUD_NO,
       AGN_CD,
       COUNT(DISTINCT AC_VSL_CD||AC_SKD_VOY_NO||AC_SKD_DIR_CD||AC_REV_DIR_CD) AS VVD_CNT,
       CURR_CD,
       ROUND(SUM(IF_AMT), 2) AS NET_AMT,
       ROUND(SUM(IF_AMT * NVL(INV_TAX_RT, 0) / 100), DECODE(CURR_CD, 'JPY', 0, 2)) AS VAT,
       ROUND(SUM(IF_AMT + (IF_AMT * NVL(INV_TAX_RT, 0) / 100)), DECODE(CURR_CD, 'JPY', 0, 2)) AS TOT_AMT,
       CSR_NO,
       TO_CHAR(APRO_DT, 'YYYY-MM-DD') AS APRO_DT
  FROM ACM_AGN_COMM
 WHERE AGN_CD = @[agn_cd]
#if (${csr_no_master} != '')
   AND CSR_NO = @[csr_no_master]
#end
   AND AC_STS_CD = 'IF'
   AND CRE_USR_ID <> 'COST'
   AND APRO_DT BETWEEN TO_DATE(@[date_fm], 'YYYY-MM-DD') AND TO_DATE(@[date_to], 'YYYY-MM-DD') + 0.99999
 GROUP BY AUD_NO,
          AGN_CD,
          CURR_CD,
          CSR_NO,
          TO_CHAR(APRO_DT, 'YYYY-MM-DD')
 ORDER BY AUD_NO,
          AGN_CD,
          CURR_CD,
          APRO_DT			]]></sql>
			<params>
				<param name="agn_cd" type="12" value="" out="N"/>
				<param name="csr_no_master" type="12" value="" out="N"/>
				<param name="date_fm" type="12" value="" out="N"/>
				<param name="date_to" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
