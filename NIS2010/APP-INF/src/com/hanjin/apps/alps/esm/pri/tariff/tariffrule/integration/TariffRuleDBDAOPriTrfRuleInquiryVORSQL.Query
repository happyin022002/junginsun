<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TariffRuleDBDAOPriTrfRuleInquiryVORSQL">
			<desc><![CDATA[Tariff Rule Inquiry 화면 조회]]></desc>
			<sql><![CDATA[
WITH MAX_AMEND_RULE AS (
	SELECT TRF_RULE_NO, MAX(AMDT_SEQ) AMDT_SEQ
	  FROM PRI_TRF_RULE
	 WHERE TRF_PFX_CD = @[trf_pfx_cd]
	   AND TRF_NO = @[trf_no]
	 GROUP BY TRF_RULE_NO
)
	SELECT A.TRF_PFX_CD
	     , A.TRF_NO
	     , A.TRF_RULE_NO
	     , A.AMDT_SEQ
	     , A.TRF_RULE_NM
	     , A.TRF_RULE_CTNT
	     , A.TRF_RULE_CHG_CD
	     , A.TRF_RULE_AMDT_TP_CD
	     , TO_CHAR(A.EFF_DT, 'YYYYMMDD') EFF_DT
	     , TO_CHAR(A.EXP_DT, 'YYYYMMDD') EXP_DT
	     , TO_CHAR(A.PUB_DT, 'YYYYMMDD') PUB_DT
	     , A.RQST_OFC_CD
	     , A.APRO_OFC_CD
	     , A.TRF_RULE_STS_CD
	     , A.CRE_USR_ID
	     , TO_CHAR(A.CRE_DT,'YYYYMMDD') CRE_DT
	     , A.UPD_USR_ID
	     , TO_CHAR(A.UPD_DT,'YYYYMMDD-HH24MISS') UPD_DT
       
	  FROM PRI_TRF_RULE A, MAX_AMEND_RULE B
	 WHERE A.TRF_PFX_CD			= @[trf_pfx_cd]
	   AND A.TRF_NO				= @[trf_no]
	   AND A.TRF_RULE_NO		= B.TRF_RULE_NO
	   AND A.AMDT_SEQ			= B.AMDT_SEQ

#if (${trf_rule_no} != '') 
       AND A.TRF_RULE_NO LIKE UPPER(@[trf_rule_no] || '%')
#end

#if (${trf_rule_sts_cd} != '') 
       AND A.TRF_RULE_STS_CD	= @[trf_rule_sts_cd]
#end

#if (${trf_rule_ctnt} != '') 
	   AND ( REGEXP_LIKE( A.TRF_RULE_NM , '('||@[trf_rule_ctnt]||')','i') 
			OR REGEXP_LIKE( A.TRF_RULE_CTNT , '('||@[trf_rule_ctnt]||')','i') )
#end
       
 	 ORDER BY LPAD(DECODE( SIGN(INSTR(A.TRF_RULE_NO,'-')), 1, SUBSTR(A.TRF_RULE_NO,1,INSTR(A.TRF_RULE_NO,'-')-1),A.TRF_RULE_NO),50,' ')
             ,LPAD(DECODE( SIGN(INSTR(A.TRF_RULE_NO,'-')), 1, SUBSTR(A.TRF_RULE_NO,INSTR(A.TRF_RULE_NO,'-')+1,LENGTH(A.TRF_RULE_NO)),0),50,' ')
             ,A.TRF_RULE_NO			]]></sql>
			<params>
				<param name="trf_pfx_cd" type="12" value="" out="N"/>
				<param name="trf_no" type="12" value="" out="N"/>
				<param name="trf_rule_no" type="12" value="" out="N"/>
				<param name="trf_rule_sts_cd" type="12" value="" out="N"/>
				<param name="trf_rule_ctnt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
