<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="MTCostDBDAOCreateCopyEqRepoCostCSQL">
			<desc><![CDATA[2012.09.10 이석준 [CHM-201220070-01] EQ Repo Cost (PA) 화면에 Month Copy 기능 추가 ]]></desc>
			<sql><![CDATA[
#if(${table_name} =='MAS_MTCH_BAK_INFO')
INSERT INTO MAS_MTCH_BAK_INFO
(COST_YRMON,LOC_CD,CNTR_TPSZ_CD,FULL_IB_QTY,FULL_OB_QTY,CRE_USR_ID,CRE_DT,UPD_USR_ID,UPD_DT)
SELECT 
    @[f_tar_mon] AS COST_YRMON,
    LOC_CD,
    CNTR_TPSZ_CD,
    FULL_IB_QTY,
    FULL_OB_QTY,
    @[user_id],
    SYSDATE,
    @[user_id],
    SYSDATE
FROM MAS_MTCH_BAK_INFO
WHERE COST_YRMON = @[f_src_mon]
#elseif (${table_name} =='MAS_FULL_ECC_IMBAL')
INSERT INTO MAS_FULL_ECC_IMBAL
(COST_YRMON,COST_LOC_GRP_CD,FCNTR_ECC_CD,CNTR_TPSZ_CD,CNTR_IO_VOL_STS_CD,
 CNTR_IMBAL_RTO,CNTR_IMBAL_QTY,CNTR_IB_QTY,CNTR_OB_QTY,
 CRE_USR_ID,CRE_DT,UPD_USR_ID,UPD_DT)
SELECT 
    @[f_tar_mon] AS COST_YRMON,
    COST_LOC_GRP_CD,
    FCNTR_ECC_CD,
    CNTR_TPSZ_CD,
    CNTR_IO_VOL_STS_CD,
    CNTR_IMBAL_RTO,
    CNTR_IMBAL_QTY,
    CNTR_IB_QTY,
    CNTR_OB_QTY,
    @[user_id],
    SYSDATE,
    @[user_id],
    SYSDATE
FROM MAS_FULL_ECC_IMBAL
WHERE COST_YRMON = @[f_src_mon]
#elseif (${table_name} =='MAS_CNTR_MTY_MVMT')
INSERT INTO MAS_CNTR_MTY_MVMT
(COST_YRMON,CNTR_NO,MON_MVMT_SEQ,MTY_COST_TP_CD,YD_CD,CNTR_TPSZ_CD,
CNTR_ROUT_SEQ,CNMV_STS_CD,CNMV_DT,ROUT_N1ST_YD_CD,ROUT_LST_YD_CD,ROUT_SEQ,
COST_CRE_STS_CD,MTY_STVG_TTL_AMT,MTY_TRSP_TTL_AMT,MTY_DUR_DYS,NXT_YD_CD,COST_CALC_RMK,
CRE_USR_ID,CRE_DT,UPD_USR_ID,UPD_DT)
SELECT 
    @[f_tar_mon] AS COST_YRMON,CNTR_NO,MON_MVMT_SEQ,MTY_COST_TP_CD,YD_CD,CNTR_TPSZ_CD,
    CNTR_ROUT_SEQ,CNMV_STS_CD,CNMV_DT,ROUT_N1ST_YD_CD,ROUT_LST_YD_CD,ROUT_SEQ,
    COST_CRE_STS_CD,MTY_STVG_TTL_AMT,MTY_TRSP_TTL_AMT,MTY_DUR_DYS,NXT_YD_CD,COST_CALC_RMK,
    @[user_id],
    SYSDATE,
    @[user_id],
    SYSDATE
FROM MAS_CNTR_MTY_MVMT
WHERE COST_YRMON = @[f_src_mon]       
#elseif (${table_name} =='MAS_MTY_CNTR_ROUT_PERF')
INSERT INTO MAS_MTY_CNTR_ROUT_PERF
(COST_YRMON,CNTR_TPSZ_CD,ROUT_N1ST_YD_CD,ROUT_LST_YD_CD,ROUT_SEQ,CNTR_ORG_DEST_CD,
MTY_COST_TP_CD,ROUT_N1ST_ECC_CD,ROUT_LST_ECC_CD,MTY_STVG_TTL_AMT,MTY_TRSP_TTL_AMT,TTL_TZ_DYS,
TTL_TZTM_HRS,TTL_CNTR_QTY,CRE_USR_ID,CRE_DT,UPD_USR_ID,UPD_DT)
SELECT 
    @[f_tar_mon] AS COST_YRMON,CNTR_TPSZ_CD,ROUT_N1ST_YD_CD,ROUT_LST_YD_CD,ROUT_SEQ,CNTR_ORG_DEST_CD,
    MTY_COST_TP_CD,ROUT_N1ST_ECC_CD,ROUT_LST_ECC_CD,MTY_STVG_TTL_AMT,MTY_TRSP_TTL_AMT,TTL_TZ_DYS,
    TTL_TZTM_HRS,TTL_CNTR_QTY,   
    @[user_id],
    SYSDATE,
    @[user_id],
    SYSDATE
FROM MAS_MTY_CNTR_ROUT_PERF
WHERE COST_YRMON = @[f_src_mon]  
#elseif (${table_name} =='MAS_MTY_ECC_CNTR_SMRY')
INSERT INTO MAS_MTY_ECC_CNTR_SMRY
(COST_YRMON,COST_LOC_GRP_CD,CNTR_TPSZ_CD,ECC_CD,CNTR_IO_VOL_STS_CD,
CNTR_ORG_DEST_CD,MTY_REPO_SIM_CD,MTY_COST_TP_CD,MTY_QTY,MTY_STVG_UC_AMT,
MTY_STVG_TTL_AMT,MTY_TRSP_UC_AMT,MTY_TRSP_TTL_AMT,MTY_TZ_HRS,MTY_TZ_DYS,
CRE_USR_ID,CRE_DT,UPD_USR_ID,UPD_DT)
SELECT @[f_tar_mon] AS COST_YRMON,COST_LOC_GRP_CD,CNTR_TPSZ_CD,ECC_CD,CNTR_IO_VOL_STS_CD,
       CNTR_ORG_DEST_CD,MTY_REPO_SIM_CD,MTY_COST_TP_CD,MTY_QTY,MTY_STVG_UC_AMT,
       MTY_STVG_TTL_AMT,MTY_TRSP_UC_AMT,MTY_TRSP_TTL_AMT,MTY_TZ_HRS,MTY_TZ_DYS,
       @[user_id],SYSDATE,@[user_id],SYSDATE
FROM MAS_MTY_ECC_CNTR_SMRY
WHERE COST_YRMON = @[f_src_mon]        
#elseif (${table_name} =='MAS_MTY_ECC_UT_COST')
INSERT INTO MAS_MTY_ECC_UT_COST
(COST_YRMON,
COST_LOC_GRP_CD,ECC_CD,CNTR_TPSZ_CD,CNTR_ORG_DEST_CD,CNTR_IO_VOL_STS_CD,IMBAL_RTO,
MCNTR_QTY,MTY_STVG_UC_AMT,MTY_TRSP_UC_AMT,MTY_TZ_DYS,MTY_TZ_HRS,SIM_CNTR_QTY,
SIM_STVG_UC_AMT,SIM_TRSP_UC_AMT,SIM_TZ_DYS,SIM_TZ_HRS,FCNTR_QTY,FULL_STVG_UC_AMT,
FULL_TRSP_UC_AMT,FULL_TZ_HRS,MNUS_CR_CNTR_QTY,MNUS_CR_TRSP_UC_AMT,MTY_USA_COST_CD,
CRE_USR_ID,CRE_DT,UPD_USR_ID,UPD_DT,ORG_SIM_STVG_UC_AMT,ORG_SIM_TRSP_UC_AMT)
SELECT  @[f_tar_mon] AS COST_YRMON,
       COST_LOC_GRP_CD,ECC_CD,CNTR_TPSZ_CD,CNTR_ORG_DEST_CD,CNTR_IO_VOL_STS_CD,IMBAL_RTO,
       MCNTR_QTY,MTY_STVG_UC_AMT,MTY_TRSP_UC_AMT,MTY_TZ_DYS,MTY_TZ_HRS,SIM_CNTR_QTY,
       SIM_STVG_UC_AMT,SIM_TRSP_UC_AMT,SIM_TZ_DYS,SIM_TZ_HRS,FCNTR_QTY,FULL_STVG_UC_AMT,
       FULL_TRSP_UC_AMT,FULL_TZ_HRS,MNUS_CR_CNTR_QTY,MNUS_CR_TRSP_UC_AMT,MTY_USA_COST_CD,
       @[user_id],SYSDATE,@[user_id],SYSDATE,ORG_SIM_STVG_UC_AMT,ORG_SIM_TRSP_UC_AMT
FROM MAS_MTY_ECC_UT_COST
WHERE COST_YRMON = @[f_src_mon]     
#elseif (${table_name} =='MAS_MTY_DEST_COST')
INSERT INTO MAS_MTY_DEST_COST
(COST_YRMON,
COST_LOC_GRP_CD,CNTR_ORG_DEST_CD,ECC_CD,
CNTR_TPSZ_CD,SIM_STVG_UC_AMT,MTY_STVG_TTL_AMT,MTY_QTY,
CRE_USR_ID,CRE_DT,UPD_USR_ID,UPD_DT)
SELECT @[f_tar_mon] AS COST_YRMON,
       COST_LOC_GRP_CD,CNTR_ORG_DEST_CD,ECC_CD,
       CNTR_TPSZ_CD,SIM_STVG_UC_AMT,MTY_STVG_TTL_AMT,MTY_QTY,
       @[user_id],SYSDATE,@[user_id],SYSDATE
FROM MAS_MTY_DEST_COST
WHERE COST_YRMON = @[f_src_mon]       
#elseif (${table_name} =='MAS_MTY_CNTR_ROUT_DTL')
INSERT INTO MAS_MTY_CNTR_ROUT_DTL
(COST_YRMON, CNTR_TPSZ_CD, 
ROUT_N1ST_YD_CD, ROUT_LST_YD_CD, ROUT_SEQ, MVMT_SEQ, 
CNTR_ORG_DEST_CD, YD_CD, LST_YD_CD, LST_YD_MVMT_STS_CD, 
ROUT_N1ST_ECC_CD, ROUT_LST_ECC_CD, 
MTY_STVG_TTL_AMT, MTY_TRSP_TTL_AMT, TTL_TZ_DYS, TTL_TZTM_HRS, TTL_CNTR_QTY, 
CRE_USR_ID, CRE_DT, UPD_USR_ID, UPD_DT)
SELECT @[f_tar_mon] AS COST_YRMON, CNTR_TPSZ_CD, 
       ROUT_N1ST_YD_CD, ROUT_LST_YD_CD, ROUT_SEQ, MVMT_SEQ, 
       CNTR_ORG_DEST_CD, YD_CD, LST_YD_CD, LST_YD_MVMT_STS_CD, 
       ROUT_N1ST_ECC_CD, ROUT_LST_ECC_CD, 
       MTY_STVG_TTL_AMT, MTY_TRSP_TTL_AMT, TTL_TZ_DYS, TTL_TZTM_HRS, TTL_CNTR_QTY, 
       @[user_id],SYSDATE,@[user_id],SYSDATE
FROM MAS_MTY_CNTR_ROUT_DTL
WHERE COST_YRMON = @[f_src_mon]   
#end			]]></sql>
			<params>
				<param name="f_tar_mon" type="12" value="" out="N"/>
				<param name="user_id" type="12" value="" out="N"/>
				<param name="f_src_mon" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
