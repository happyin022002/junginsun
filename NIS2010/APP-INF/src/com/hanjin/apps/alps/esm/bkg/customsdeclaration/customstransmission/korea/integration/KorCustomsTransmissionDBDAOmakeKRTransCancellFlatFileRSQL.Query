<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="KorCustomsTransmissionDBDAOmakeKRTransCancellFlatFileRSQL">
			<desc><![CDATA[Korea Trans Cancellation Flat File을 만든다.]]></desc>
			<sql><![CDATA[
SELECT
		@[trsm_cxl_tp_cd]||'~'||	/*	신청타입	*/
		@[locl_cstms_cd] || TO_CHAR(SYSDATE,'YY')||
		    (SELECT LPAD(MAX(MF_SND_SEQ),4,'0') 
			 FROM BKG_CSTMS_KR_SND_LOG
			 WHERE MSG_LOG_TP_ID = '5VD'
			   AND SND_DT = TO_DATE(@[snd_dt],'YYYY-MM-DD HH24:MI:SS')
			   AND OFC_CD = DECODE(@[io_bnd_cd],'I',@[pod_cd],@[pol_cd])
			   AND FLT_FILE_REF_NO = '*') ||'~'||	/*	제출번호	*/
		@[vvd]			 ||'~'||	/*	VVD	*/
		@[vsl_nm]	 	 ||'~'||	/*	Vessel Name	*/
		DECODE(@[io_bnd_cd],'I',@[pod_cd],@[pol_cd]) ||'~'||	/*	LOC	*/
		TO_CHAR(SYSDATE,'YYYYMMDD')	 ||'~'||	/*	APP_DTM	*/
		DECODE(@[io_bnd_cd],'I',TO_CHAR(TO_DATE(@[eta_dt],'YYYY-MM-DD HH24MI'),'YYYYMMDDHH24MI'),TO_CHAR(TO_DATE(@[etd_dt],'YYYY-MM-DD HH24MI'),'YYYYMMDDHH24MI')) ||'~'||	/*	DTM	*/
		@[trsm_cxl_rsn_cd]||'~'||	/*	WITHDRAW_TYPE	*/
		@[trsm_cxl_desc] ||'~'||	/*	WITHDRAW_REASON	*/
		@[mrn_no]	 	 ||'~'||	/*	MRN_NO	*/
		@[smp_bl_knt]	 ||'~'||	/*	Simple Master B/L	*/
		@[cnsl_bl_knt]	 ||'~'||	/*	Consol Master B/L	*/
		@[hbl_knt]		 ||'~'||	/*	House B/L	*/
		(SELECT VNDR_LOCL_LANG_NM ||'~'||	/*	신청인 상호	*/
				CEO_NM			  ||'~'||	/*	대표자명	*/
				'SMLM'			  ||'~'||	/*	신고인 세관 등록번호	*/
				(SELECT XTN_PHN_NO 
				 FROM COM_USER
			     WHERE USR_ID = @[user_id] AND USE_FLG = 'Y') ||'~'||	/*	전화번호	*/
				SUBSTR(LOCL_LANG_ADDR,1,35)   ||'~'||	/*	주소1	*/ 
				SUBSTR(LOCL_LANG_ADDR,36,70)  ||'~'||	/*	주소2	*/
				SUBSTR(LOCL_LANG_ADDR,71,100) ||'~'		/*	주소3	*/
		 FROM MDM_VENDOR
		 WHERE VNDR_SEQ = 185647
		   AND VNDR_CNT_CD = 'KR')
FROM	DUAL			]]></sql>
			<params>
				<param name="trsm_cxl_tp_cd" type="12" value="" out="N"/>
				<param name="locl_cstms_cd" type="12" value="" out="N"/>
				<param name="snd_dt" type="12" value="" out="N"/>
				<param name="io_bnd_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="vsl_nm" type="12" value="" out="N"/>
				<param name="eta_dt" type="12" value="" out="N"/>
				<param name="etd_dt" type="12" value="" out="N"/>
				<param name="trsm_cxl_rsn_cd" type="12" value="" out="N"/>
				<param name="trsm_cxl_desc" type="12" value="" out="N"/>
				<param name="mrn_no" type="12" value="" out="N"/>
				<param name="smp_bl_knt" type="12" value="" out="N"/>
				<param name="cnsl_bl_knt" type="12" value="" out="N"/>
				<param name="hbl_knt" type="12" value="" out="N"/>
				<param name="user_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
