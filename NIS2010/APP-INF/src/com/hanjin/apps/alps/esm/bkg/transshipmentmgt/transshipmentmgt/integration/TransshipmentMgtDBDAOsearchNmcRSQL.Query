<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TransshipmentMgtDBDAOsearchNmcRSQL">
			<desc><![CDATA[NMC Form 을 조회한다.]]></desc>
			<sql><![CDATA[
SELECT substr(d.CSTMS_DESC, 1, 200) ITEM_DESC,
  (
    select c.CNTR_TPSZ_CD||' '||m.cntr_tpsz_desc
    from mdm_cntr_tp_sz m
    where c.CNTR_TPSZ_CD = m.CNTR_TPSZ_CD) TP,
  d.PCK_QTY||' '||(select m.PCK_NM from mdm_pck_tp m where d.PCK_TP_CD = m.pck_cd) QTY,
  d.ACT_WGT||' '||d.WGT_UT_CD WGT,
  (
    SELECT L.LOC_NM||', '||C.CNT_NM
    FROM MDM_LOCATION L,
      MDM_COUNTRY C
    WHERE L.LOC_CD = B.POL_CD
      AND L.CNT_CD = C.CNT_CD) POL,
  (
    SELECT C.VSL_ENG_NM||' '||V.SKD_VOY_NO||V.SKD_DIR_CD
    FROM BKG_VVD V,
      MDM_VSL_CNTR C
    WHERE V.BKG_NO = B.BKG_NO
      AND V.POL_CD = B.POL_CD
      AND V.VSL_CD = C.VSL_CD
      AND ROWNUM = 1) INBOUND,
  (
    SELECT TO_CHAR(VPS_ETA_DT, 'YYYY-MM-DD')
    FROM VSK_VSL_PORT_SKD S,
      BKG_VVD V
    WHERE V.BKG_NO = B.BKG_NO
      AND B.POL_CD = V.POL_CD
      AND S.VSL_CD = V.VSL_CD
      AND S.SKD_VOY_NO = V.SKD_VOY_NO
      AND S.SKD_DIR_CD = V.SKD_DIR_CD
      AND S.VPS_PORT_CD = V.POD_CD
      AND S.CLPT_IND_SEQ = '1') A_DATE,
  (
    SELECT L.LOC_NM||', '||'KOREA'
    FROM MDM_LOCATION L,
      MDM_COUNTRY C,
      BKG_VVD V
    WHERE V.BKG_NO = B.BKG_NO
      AND V.POL_CD LIKE 'KR%'
      AND L.LOC_CD = V.POL_CD
      AND L.CNT_CD = C.CNT_CD
      AND ROWNUM = 1) KR_POL,
  (
    SELECT C.VSL_ENG_NM||' '||V.SKD_VOY_NO||V.SKD_DIR_CD
    FROM BKG_VVD V,
      MDM_VSL_CNTR C
    WHERE V.BKG_NO = B.BKG_NO
      AND V.POL_CD LIKE 'KR%'
      AND V.VSL_CD = C.VSL_CD
      AND ROWNUM = 1) OUTBOUND,
  (
    SELECT TO_CHAR(VPS_ETD_DT, 'YYYY-MM-DD')
    FROM VSK_VSL_PORT_SKD S,
      BKG_VVD V
    WHERE V.BKG_NO = B.BKG_NO
      AND V.POL_CD LIKE 'KR%'
      AND S.VSL_CD = V.VSL_CD
      AND S.SKD_VOY_NO = V.SKD_VOY_NO
      AND S.SKD_DIR_CD = V.SKD_DIR_CD
      AND S.VPS_PORT_CD = V.POL_CD
      AND S.CLPT_IND_SEQ = '1') D_DATE,
  (
    SELECT L.LOC_NM||', '||C.CNT_NM
    FROM MDM_LOCATION L,
      MDM_COUNTRY C
    WHERE L.LOC_CD = B.DEL_CD
      AND L.CNT_CD = C.CNT_CD) DEL,
  'SMLM'||b.bkg_No BL_NO,
  c.cntr_no,
  TO_CHAR(SYSDATE, 'YYYY.MM.DD') TODAY
FROM BKG_BOOKING B,
  bkg_container c,
  bkg_bl_doc d
WHERE 1=1
#if (${bkg_no} !='') 
  AND B.BKG_NO = @[bkg_no]
#end
#if (${bl_no} !='') 
  AND B.BL_NO = @[bl_no]
#end
#if (${cntr_no} !='') 
  AND C.CNTR_NO = @[cntr_no]
#end
  and b.bkg_no = c.bkg_no
  and b.bkg_no = d.bkg_no
 AND ROWNUM = 1			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
