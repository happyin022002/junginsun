<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BLIssuanceDBDAOAddBkgEblAvcNtfyCSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
INSERT INTO BKG_EBL_AVC_NTFY
	(BKG_NO
	,BL_NO
	,BKG_EBL_SEQ
	,CNTR_SEQ
	,DOC_PARA_NO1
	,DOC_PARA_NO2
	,EBL_BKG_CUST_TP_CD
	,NTFY_ADDR1
	,NTFY_ADDR2
	,NTFY_FAX_NO1
	,NTFY_PHN_NO1
	,NTFY_EML1
	,NTFY_ADDR3
	,NTFY_ADDR4
	,NTFY_ADDR5
	,NTFY_ADDR6
	,NTFY_ADDR7
	,NTFY_FAX_NO2
	,NTFY_PHN_NO2
	,NTFY_EML2
	,NTFY_CUST_NM
	,IF_FLG
	,CRE_USR_ID
	,CRE_DT
	,UPD_USR_ID
	,UPD_DT)
SELECT	C.BKG_NO BKG_NO
	,B.BL_NO BL_NO
	,@[bkg_ebl_seq]
	,ROW_NUMBER() OVER( ORDER BY DECODE(BKG_CUST_TP_CD ,'N',1,'A',2,3)) CNTR_SEQ
	,C.BKG_NO||LTRIM(TO_CHAR(@[bkg_ebl_seq], '0000')) DOC_PARA_NO1
	,C.BKG_NO||LTRIM(TO_CHAR(@[bkg_ebl_seq], '0000'))||LTRIM(TO_CHAR(ROW_NUMBER() OVER( ORDER BY DECODE(BKG_CUST_TP_CD ,'N',1,'A',2,3)), '0000')) DOC_PARA_NO2
	,'N'||ROW_NUMBER() OVER( ORDER BY DECODE(BKG_CUST_TP_CD ,'N',1,'A',2,3)) EBL_BKG_CUST_TP_CD
	,SUBSTR(REPLACE(C.CUST_NM,CHR(13)||CHR(10),'^'),1,INSTR(REPLACE(C.CUST_NM||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,1) - 1) NTFY_ADDR1
    ,SUBSTR(REPLACE(C.CUST_NM,CHR(13)||CHR(10),'^'),INSTR(REPLACE(C.CUST_NM||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,1) + 1
                                                   ,INSTR(REPLACE(C.CUST_NM||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,2) - 
                                                    INSTR(REPLACE(C.CUST_NM||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,1) - 1) NTFY_ADDR2
	,C.CUST_FAX_NO NTFY_FAX_NO1
	,'' NTFY_PHN_NO1
	,C.CUST_EML NTFY_EML1
    ,SUBSTR(REPLACE(C.CUST_ADDR,CHR(13)||CHR(10),'^'),1,INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,1) - 1) NTFY_ADDR3
    ,SUBSTR(REPLACE(C.CUST_ADDR,CHR(13)||CHR(10),'^'),INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,1) + 1
                                                     ,INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,2) - 
                                                      INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,1) - 1) NTFY_ADDR4
    ,SUBSTR(REPLACE(C.CUST_ADDR,CHR(13)||CHR(10),'^'),INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,2) + 1
                                                     ,INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,3) - 
                                                      INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,2) - 1) NTFY_ADDR5
    ,SUBSTR(REPLACE(C.CUST_ADDR,CHR(13)||CHR(10),'^'),INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,3) + 1
                                                     ,INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,4) - 
                                                      INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,3) - 1) NTFY_ADDR6
    ,SUBSTR(REPLACE(C.CUST_ADDR,CHR(13)||CHR(10),'^'),INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,4) + 1
                                                     ,INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,5) - 
                                                      INSTR(REPLACE(C.CUST_ADDR||CHR(13)||CHR(10),CHR(13)||CHR(10),'^'),'^',1,4) - 1) NTFY_ADDR7
	,'' NTFY_FAX_NO2
	,'' NTFY_PHN_NO2
	,'' NTFY_EML2
	,SUBSTR(CNTC.CNTC_PSON_NM,1,25) NTFY_CUST_NM
	,'N' IF_FLG
	,@[usr_id] CRE_USR_ID
	,SYSDATE CRE_DT
	,@[usr_id] UPD_USR_ID
	,SYSDATE UPD_DT
  FROM	BKG_CUSTOMER C
        ,BKG_BOOKING B
		,BKG_CNTC_PSON CNTC
  WHERE C.BKG_NO = B.BKG_NO
   AND  B.BKG_NO = CNTC.BKG_NO(+)
   AND  CNTC.BKG_CNTC_PSON_TP_CD(+) = 'BK'
   AND  C.BKG_NO = @[bkg_no]
   AND  C.BKG_CUST_TP_CD IN('N','A')			]]></sql>
			<params>
				<param name="bkg_ebl_seq" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
