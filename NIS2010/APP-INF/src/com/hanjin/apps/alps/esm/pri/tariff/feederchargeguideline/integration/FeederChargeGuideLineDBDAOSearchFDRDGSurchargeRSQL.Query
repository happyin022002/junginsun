<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="FeederChargeGuideLineDBDAOSearchFDRDGSurchargeRSQL">
			<desc><![CDATA[FDR DG Surcharge inquiry
2013.02.19 [CHM-201323107] 전윤주 AOC Feeder DG Tab 변경에 따른 Add-on Tariff 변경요청
2013.03.04 [CHM-201323352] 전윤주 AOC 테이블의 delt_flg 확인 로직 추가
2014.12.09 [CHM-201433491] ADD ON TARIFF / DG 요율 관련 (CUR_CD 추가)]]></desc>
			<sql><![CDATA[
SELECT DECODE(A.PCTL_IO_BND_CD, 'B', DECODE(DECODE(@[org_dest_tp_cd],'D','I','O','O'), 'I', SUBSTR(A.TO_NOD_CD, 1, 5), SUBSTR(A.FM_NOD_CD, 1, 5)), 'I', SUBSTR(A.TO_NOD_CD, 1, 5), SUBSTR(A.FM_NOD_CD, 1, 5)) PNT_LOC_CD
     , (SELECT LOC_NM 
          FROM MDM_LOCATION 
         WHERE LOC_CD = DECODE(A.PCTL_IO_BND_CD, 'B', DECODE(DECODE(@[org_dest_tp_cd],'D','I','O','O'), 'I', SUBSTR(A.TO_NOD_CD, 1, 5), SUBSTR(A.FM_NOD_CD, 1, 5)), 'I', SUBSTR(A.TO_NOD_CD, 1, 5), SUBSTR(A.FM_NOD_CD, 1, 5))
           AND DELT_FLG = 'N') AS PNT_LOC_NM   
     , DECODE(A.PCTL_IO_BND_CD, 'B', DECODE(DECODE(@[org_dest_tp_cd],'D','I','O','O'), 'I', SUBSTR(A.FM_NOD_CD, 1, 5), SUBSTR(A.TO_NOD_CD, 1, 5)), 'I', SUBSTR(A.FM_NOD_CD, 1, 5), SUBSTR(A.TO_NOD_CD, 1, 5)) BSE_PORT_LOC_CD
     , DECODE(DECODE(@[org_dest_tp_cd],'D','I','O','O'), 'I',  DECODE(A.WTR_DE_TERM_CD, 'V', 'Y','T','Y', A.WTR_DE_TERM_CD), 'O', DECODE(A.WTR_RCV_TERM_CD, 'V', 'Y', 'T','Y',A.WTR_RCV_TERM_CD))RCV_DE_TERM_CD
     , D.IMDG_N1ST_CLSS_SVC_FLG
     , D.IMDG_N1ST_CLSS_20FT_SCG_AMT 
     , D.IMDG_N1ST_CLSS_40FT_SCG_AMT 
     , D.IMDG_N2ND_CLSS_SVC_FLG
     , D.IMDG_N2ND_CLSS_20FT_SCG_AMT 
     , D.IMDG_N2ND_CLSS_40FT_SCG_AMT 
     , D.IMDG_N3RD_CLSS_SVC_FLG
     , D.IMDG_N3RD_CLSS_20FT_SCG_AMT 
     , D.IMDG_N3RD_CLSS_40FT_SCG_AMT
     , D.IMDG_N4TH_CLSS_SVC_FLG
     , D.IMDG_N4TH_CLSS_20FT_SCG_AMT 
     , D.IMDG_N4TH_CLSS_40FT_SCG_AMT 
     , D.IMDG_N5TH_CLSS_SVC_FLG
     , D.IMDG_N5TH_CLSS_20FT_SCG_AMT 
     , D.IMDG_N5TH_CLSS_40FT_SCG_AMT 
     , D.IMDG_N6TH_CLSS_SVC_FLG
     , D.IMDG_N6TH_CLSS_20FT_SCG_AMT 
     , D.IMDG_N6TH_CLSS_40FT_SCG_AMT 
     , D.IMDG_N7TH_CLSS_SVC_FLG
     , D.IMDG_N7TH_CLSS_20FT_SCG_AMT 
     , D.IMDG_N7TH_CLSS_40FT_SCG_AMT 
     , D.IMDG_N8TH_CLSS_SVC_FLG
     , D.IMDG_N8TH_CLSS_20FT_SCG_AMT 
     , D.IMDG_N8TH_CLSS_40FT_SCG_AMT 
     , D.IMDG_N9TH_CLSS_SVC_FLG
     , D.IMDG_N9TH_CLSS_20FT_SCG_AMT 
     , D.IMDG_N9TH_CLSS_40FT_SCG_AMT
     , '' AS FDR_TRF_NO
     , '' AS SVC_SCP_CD
     , '' AS ORG_DEST_TP_CD
     , '' AS RHQ_CD
	 , A.CURR_CD  
  FROM 
         #if(${rhq_cd} == 'HAMRU')    
             AOC_EUR_FDR_TRF_DTL A,  
             AOC_EUR_FDR_TRF_HDR B,
             AOC_EUR_FDR_DG_TRF_DTL D
         #end 
         #if(${rhq_cd} == 'SINRS')
             AOC_CHN_FDR_TRF_DTL A,
             AOC_CHN_FDR_TRF_HDR B, 
             AOC_CHN_FDR_DG_TRF_DTL D
         #end 
         #if(${rhq_cd} == 'SHARC')
             AOC_CHN_FDR_TRF_DTL A,
             AOC_CHN_FDR_TRF_HDR B, 
             AOC_CHN_FDR_DG_TRF_DTL D
         #end
 WHERE 1=1
   AND A.COST_TRF_NO = B.COST_TRF_NO
   AND A.PCTL_IO_BND_CD IN (DECODE(@[org_dest_tp_cd],'D','I','O','O'), 'B')
   AND NVL(A.DELT_FLG, 'N') <> 'Y'
   --------------------------   DG       
   AND A.COST_TRF_NO        = D.COST_TRF_NO (+)
   AND A.COST_TRF_ROUT_SEQ  = D.COST_TRF_ROUT_SEQ (+)    
   ------------------------------------------
   AND A.COST_TRF_NO  = (  SELECT FDR_COST_TRF_NO
                             FROM PRI_TRF_FDR_COST_VER_MAPG
                            WHERE 1=1
                              AND FDR_TRF_NO = @[fdr_trf_no]
                              AND SVC_SCP_CD = @[svc_scp_cd]
                              AND ORG_DEST_TP_CD = @[org_dest_tp_cd]
                              AND RHQ_CD = @[rhq_cd]
                         )			]]></sql>
			<params>
				<param name="org_dest_tp_cd" type="12" value="" out="N"/>
				<param name="fdr_trf_no" type="12" value="" out="N"/>
				<param name="svc_scp_cd" type="12" value="" out="N"/>
				<param name="rhq_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
