<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BLInformationMgtDBDAOSearchBisManualListRSQL">
			<desc><![CDATA[BLInformationMgtDBDAOSearchBisManualListRSQL.Query]]></desc>
			<sql><![CDATA[
SELECT /*+ INDEX(XAK3BKG_BOOKING,BK) */
    BK.BKG_NO,
    BL.BDR_FLG,
    BL.BIS_SYS_FLG,
    ISS.OBL_ISS_FLG,
    ISS.OBL_PRN_FLG,
    ISS.OBL_RLSE_FLG,
    ISS.OBL_SRND_FLG,
    ISS.OBL_RDEM_FLG,
    NVL((SELECT 'Y' FROM BKG_CHG_RT WHERE BKG_NO = BK.BKG_NO AND ROWNUM = 1),'N') CHG_FLG
 FROM BKG_BOOKING BK, BKG_BL_DOC BL, BKG_BL_ISS ISS
WHERE BK.BKG_CRE_DT >= TO_DATE(@[from_dt],'YYYY-MM-DD')
AND   BK.BKG_CRE_DT <= TO_DATE(@[to_dt],'YYYY-MM-DD') +0.99999
AND BK.BKG_STS_CD <>'X'
AND BK.BKG_NO = BL.BKG_NO
AND BK.BKG_NO = ISS.BKG_NO
AND ( BL.BDR_FLG ='Y' OR ISS.OBL_ISS_FLG ='Y' OR ISS.OBL_PRN_FLG ='Y' OR ISS.OBL_RLSE_FLG ='Y' OR ISS.OBL_SRND_FLG ='Y' OR ISS.OBL_RDEM_FLG='Y'
OR EXISTS( SELECT 'Y' FROM BKG_CHG_RT WHERE BKG_NO = BK.BKG_NO AND ROWNUM =1))
AND NOT EXISTS ( SELECT 'Y' FROM BIS_BOOKING WHERE BKG_NO = BK.BKG_NO )			]]></sql>
			<params>
				<param name="from_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
