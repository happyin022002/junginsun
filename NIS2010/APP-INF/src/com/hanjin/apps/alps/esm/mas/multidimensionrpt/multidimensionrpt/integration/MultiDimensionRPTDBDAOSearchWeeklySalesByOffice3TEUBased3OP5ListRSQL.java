/*=========================================================
*Copyright(c) 2017 CyberLogitec
*@FileName : MultiDimensionRPTDBDAOSearchWeeklySalesByOffice3TEUBased3OP5ListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2017.01.18
*@LastModifier : 
*@LastVersion : 1.0
* 2017.01.18 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esm.mas.multidimensionrpt.multidimensionrpt.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class MultiDimensionRPTDBDAOSearchWeeklySalesByOffice3TEUBased3OP5ListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * 2015.08.31 손진환 [CHM-201536958] Split15-[그룹사 표준 코드 시행] SML 프로그램 대응 및 데이타 마이그레이션 작업 요청
	  * </pre>
	  */
	public MultiDimensionRPTDBDAOSearchWeeklySalesByOffice3TEUBased3OP5ListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_trd_dir_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_chkprd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ofc_lvl",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_pro_lvl",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_year",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_pro_vw",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_sls_mon",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_sub_trd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_skd_dir_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_skd_voy_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_fm_wk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_dir_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ofc_vw",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("str_display",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_rlane_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_to_mon",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_ias_rgn_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_trd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_vsl_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_fm_mon",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_to_wk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_chtbiz",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esm.mas.multidimensionrpt.multidimensionrpt.integration").append("\n"); 
		query.append("FileName : MultiDimensionRPTDBDAOSearchWeeklySalesByOffice3TEUBased3OP5ListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT A.COST_YRMON" ).append("\n"); 
		query.append("	,A.SLS_YRMON " ).append("\n"); 
		query.append("	,A.COST_WK" ).append("\n"); 
		query.append("#if(${f_ofc_lvl} == '2')" ).append("\n"); 
		query.append("    ,A.OFC_N2ND_LVL_CD RHQ " ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	,'' RHQ" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("	,A.TRD_CD " ).append("\n"); 
		query.append("	,DECODE(B.NO,1,A.SUB_TRD_CD,2,'OT') AS SUB_TRD_CD" ).append("\n"); 
		query.append("	,A.RLANE_CD " ).append("\n"); 
		query.append("	,A.IOC_CD " ).append("\n"); 
		query.append("	,A.VSL_CD " ).append("\n"); 
		query.append("	,A.SKD_VOY_NO " ).append("\n"); 
		query.append("	,A.DIR_CD" ).append("\n"); 
		query.append("	,A.HUL_BND_CD " ).append("\n"); 
		query.append("	" ).append("\n"); 
		query.append("	#foreach($key in ${allcols})" ).append("\n"); 
		query.append("		-- OP(Operating Profit) Total, BU OP(Operating Profit) Total 의 OT금액은 마이너스 금액이 나오게 처리 " ).append("\n"); 
		query.append("		#if($key == '53101000' || $key == '53102000' || $key == '53200000' || $key == '54100000' || $key == '54250000' || $key == '54300000' " ).append("\n"); 
		query.append("		 || $key == '54200000' || $key == '54150000' || $key == '54450000' || $key == '54180000' || $key == '54550000' || $key == '54350000' " ).append("\n"); 
		query.append("		 || $key == '54400000' || $key == '54600000' || $key == 'OPCOST00' || $key == 'BOPTOTAL' || $key == 'NTMASLOC') " ).append("\n"); 
		query.append("		,DECODE(B.NO,1,SUM(DECODE(A.STND_COST_CD, '$key', NVL(A.AMT, 0), 0)), " ).append("\n"); 
		query.append("					   SUM(DECODE(A.STND_COST_CD, '$key', DECODE('$key','BOPTOTAL',NVL(A.OTR_AMT, 0) * -1 ,NVL(A.OTR_AMT, 0)), 0))) AS COST_AMT$velocityCount" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("		,DECODE(B.NO,1,SUM(DECODE(A.STND_COST_CD, '$key', NVL(A.AMT, 0), 0))) AS COST_AMT$velocityCount" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end		" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("	,SUM(NVL(a.amt,0)) AS ttl_amt " ).append("\n"); 
		query.append("FROM ( " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	SELECT   /*+ ORDERED */ " ).append("\n"); 
		query.append("		 B1.COST_YRMON " ).append("\n"); 
		query.append("		,B1.SLS_YRMON " ).append("\n"); 
		query.append("		,B1.COST_WK " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("		,B4.OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		,B1.TRD_CD " ).append("\n"); 
		query.append("		,B1.SUB_TRD_CD " ).append("\n"); 
		query.append("		,B1.RLANE_CD " ).append("\n"); 
		query.append("		,B1.IOC_CD " ).append("\n"); 
		query.append("		,B1.VSL_CD " ).append("\n"); 
		query.append("		,B1.SKD_VOY_NO " ).append("\n"); 
		query.append("		,B1.DIR_CD " ).append("\n"); 
		query.append("		,L1.HUL_BND_CD" ).append("\n"); 
		query.append("		,B2.STND_COST_CD " ).append("\n"); 
		query.append("		,SUM (DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("		          ,'P', DECODE (B2.STND_COST_CD " ).append("\n"); 
		query.append("		                       ,'LOAD0000', DECODE(SUBSTR (B2.CNTR_TPSZ_CD, -1),'2', B2.N5TH_ESTM_PL_AMT, '3', B2.N5TH_ESTM_PL_AMT, B2.N5TH_ESTM_PL_AMT * 2) " ).append("\n"); 
		query.append("		                       ,'BSA00000', B2.N5TH_ESTM_PL_AMT " ).append("\n"); 
		query.append("		                       ,DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', B2.N5TH_CO_AMT,'O|BIZ', B2.N5TH_HJS_SLS_AMT,B2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("		                       ) " ).append("\n"); 
		query.append("		          ,'R', DECODE (B2.STND_COST_CD " ).append("\n"); 
		query.append("		                       ,'LOAD0000', DECODE(SUBSTR(B2.CNTR_TPSZ_CD, -1),'2', B2.RA_PL_AMT, '3', B2.RA_PL_AMT, B2.RA_PL_AMT * 2) " ).append("\n"); 
		query.append("		                       ,'92404011', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, B2.RA_PL_AMT))  " ).append("\n"); 
		query.append("		                       ,B2.RA_PL_AMT " ).append("\n"); 
		query.append("		                       ) " ).append("\n"); 
		query.append("		          ) " ).append("\n"); 
		query.append("		  ) AS AMT " ).append("\n"); 
		query.append("		, SUM (B2.ADJ_TRD_OTR_FNL_AMT) AS OTR_AMT" ).append("\n"); 
		query.append("	FROM MAS_MON_VVD B1 " ).append("\n"); 
		query.append("		,MAS_PFIT_LSS_SMRY B2 " ).append("\n"); 
		query.append("		,MAS_PFIT_LSS_RPT_ITM B3 " ).append("\n"); 
		query.append("		,MAS_OFC_LVL B4 " ).append("\n"); 
		query.append("        ,MAS_LANE_RGST L1" ).append("\n"); 
		query.append("	WHERE B1.VSL_CD        = B2.VSL_CD " ).append("\n"); 
		query.append("		AND B1.SKD_VOY_NO    = B2.SKD_VOY_NO " ).append("\n"); 
		query.append("		AND B1.DIR_CD        = B2.SKD_DIR_CD " ).append("\n"); 
		query.append("		AND B1.TRD_CD        = B2.TRD_CD " ).append("\n"); 
		query.append("		AND B1.RLANE_CD      = B2.RLANE_CD " ).append("\n"); 
		query.append("		AND B1.IOC_CD        = B2.IOC_CD " ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("        AND B1.RLANE_CD = L1.RLANE_CD" ).append("\n"); 
		query.append("        AND B1.DIR_CD = L1.DIR_CD" ).append("\n"); 
		query.append("        AND B1.TRD_CD = L1.TRD_CD" ).append("\n"); 
		query.append("        AND B1.IOC_CD = L1.IOC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("			AND B1.COST_YRMON    BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON   " ).append("\n"); 
		query.append("		#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("			AND B1.SLS_YRMON     BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON  " ).append("\n"); 
		query.append("		#end /*ofc_월별 관리*/" ).append("\n"); 
		query.append("		#if(${f_init_cost} == 'Y')" ).append("\n"); 
		query.append("			AND B2.STND_COST_CD  NOT IN ('53101000', '53102000', '53200000', '54100000', '54250000', '54300000', '54200000', '54150000','54450000', '54180000', '54550000', '54350000', '54400000')" ).append("\n"); 
		query.append("		#end /* 배부 이전 원가 */" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		AND B2.STND_COST_CD  NOT IN ('91401011') /* STP REV 제외 */" ).append("\n"); 
		query.append("		AND B2.STND_COST_CD  = B3.STND_COST_CD " ).append("\n"); 
		query.append("		AND B1.DELT_FLG      <> 'Y' " ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("			AND B1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   " ).append("\n"); 
		query.append("		#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("			AND B1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    " ).append("\n"); 
		query.append("			AND B1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   " ).append("\n"); 
		query.append("		#end	" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("			AND B1.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("			AND B1.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("			AND B1.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("			AND B1.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("			AND B1.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("			AND B1.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("	    #end" ).append("\n"); 
		query.append("		#if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("			AND B1.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("			AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("			AND L1.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		                          " ).append("\n"); 
		query.append("		AND B3.RPT_VW_CD     = @[f_pro_vw]" ).append("\n"); 
		query.append("		AND DECODE (@[f_ofc_vw], 'C', B2.AGMT_SGN_OFC_CD, 'L', B2.SLS_OFC_CD) = B4.OFC_CD " ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		#if(${f_ofc_cd} !='')" ).append("\n"); 
		query.append("			#if(${f_excl_sts} =='')" ).append("\n"); 
		query.append("				/* N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '') */" ).append("\n"); 
		query.append("				AND DECODE (@[f_ofc_lvl] ,'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  " ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				AND B4.OFC_CD = @[f_ofc_cd]  " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			/* N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '') */" ).append("\n"); 
		query.append("			AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) IS NOT NULL  " ).append("\n"); 
		query.append("			AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_TP_CD,'3', B4.OFC_N3RD_LVL_TP_CD" ).append("\n"); 
		query.append("			           ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', B1.COST_YRMON, B1.SLS_YRMON), 1, 4), '2008', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCRA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("			                                                   , '2007', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCRA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("			                                                   , DECODE(B4.OFC_N4TH_LVL_CD, 'SZPDC', B4.OFC_N4TH_LVL_TP_CD, B4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA*/" ).append("\n"); 
		query.append("			           ,'5', B4.OFC_N5TH_LVL_TP_CD,'6', B4.OFC_N6TH_LVL_TP_CD,'7', B4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	" ).append("\n"); 
		query.append("		#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')" ).append("\n"); 
		query.append("			AND (B3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* strDisplay( f_pro_obj P->O,A,B) */" ).append("\n"); 
		query.append("				OR B3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) " ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			#if( ${f_pro_lvl} =='C')" ).append("\n"); 
		query.append("				AND B3.STND_COST_TP_CD IN ('S','C') " ).append("\n"); 
		query.append("			#elseif (${f_pro_lvl} =='O')" ).append("\n"); 
		query.append("				AND B3.STND_COST_TP_CD IN ('S','C','O') " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("	GROUP BY  " ).append("\n"); 
		query.append("		 B1.COST_YRMON " ).append("\n"); 
		query.append("		,B1.SLS_YRMON " ).append("\n"); 
		query.append("		,B1.COST_WK" ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("		,B4.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		,B1.TRD_CD " ).append("\n"); 
		query.append("		,B1.SUB_TRD_CD " ).append("\n"); 
		query.append("		,B1.RLANE_CD " ).append("\n"); 
		query.append("		,B1.IOC_CD " ).append("\n"); 
		query.append("		,B1.VSL_CD " ).append("\n"); 
		query.append("		,B1.SKD_VOY_NO " ).append("\n"); 
		query.append("		,B1.DIR_CD " ).append("\n"); 
		query.append("		,L1.HUL_BND_CD" ).append("\n"); 
		query.append("		,B2.STND_COST_CD " ).append("\n"); 
		query.append("	UNION ALL  " ).append("\n"); 
		query.append("#if(${f_init_cost} == 'Y')" ).append("\n"); 
		query.append("	SELECT   /*+ ORDERED */ " ).append("\n"); 
		query.append("		 B1.COST_YRMON " ).append("\n"); 
		query.append("		,B1.SLS_YRMON " ).append("\n"); 
		query.append("		,B1.COST_WK " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("		,B4.OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		,B1.TRD_CD " ).append("\n"); 
		query.append("		,B1.SUB_TRD_CD " ).append("\n"); 
		query.append("		,B1.RLANE_CD " ).append("\n"); 
		query.append("		,B1.IOC_CD " ).append("\n"); 
		query.append("		,B1.VSL_CD " ).append("\n"); 
		query.append("		,B1.SKD_VOY_NO " ).append("\n"); 
		query.append("		,B1.DIR_CD " ).append("\n"); 
		query.append("		,L1.HUL_BND_CD" ).append("\n"); 
		query.append("		,B2.STND_COST_CD " ).append("\n"); 
		query.append("		,SUM (DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("		          ,'P', DECODE (B2.STND_COST_CD " ).append("\n"); 
		query.append("		                       ,'LOAD0000', DECODE(SUBSTR (B2.CNTR_TPSZ_CD, -1),'2', B2.N5TH_ESTM_PL_AMT, '3', B2.N5TH_ESTM_PL_AMT, B2.N5TH_ESTM_PL_AMT * 2) " ).append("\n"); 
		query.append("		                       ,'BSA00000', B2.N5TH_ESTM_PL_AMT " ).append("\n"); 
		query.append("		                       ,DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', B2.N5TH_CO_AMT,'O|BIZ', B2.N5TH_HJS_SLS_AMT,V.NTWK_HIR_COST_AMT) " ).append("\n"); 
		query.append("		                       ) " ).append("\n"); 
		query.append("		          ,'R', DECODE (B2.STND_COST_CD " ).append("\n"); 
		query.append("		                       ,'LOAD0000', DECODE(SUBSTR(B2.CNTR_TPSZ_CD, -1),'2', B2.RA_PL_AMT, '3', B2.RA_PL_AMT, B2.RA_PL_AMT * 2) " ).append("\n"); 
		query.append("		                       ,'92404011', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, B2.RA_PL_AMT))  " ).append("\n"); 
		query.append("		                       ,B2.RA_PL_AMT " ).append("\n"); 
		query.append("		                       ) " ).append("\n"); 
		query.append("		          ) " ).append("\n"); 
		query.append("		  ) AS AMT " ).append("\n"); 
		query.append("		, SUM (B2.ADJ_TRD_OTR_FNL_AMT) AS OTR_AMT" ).append("\n"); 
		query.append("	FROM MAS_MON_VVD B1 " ).append("\n"); 
		query.append("		,MAS_PFIT_LSS_SMRY B2 " ).append("\n"); 
		query.append("		,MAS_PFIT_LSS_RPT_ITM B3 " ).append("\n"); 
		query.append("		,MAS_OFC_LVL B4 " ).append("\n"); 
		query.append("        ,MAS_LANE_RGST L1" ).append("\n"); 
		query.append("		,MAS_VVD_HIR V" ).append("\n"); 
		query.append("	WHERE B1.VSL_CD        = B2.VSL_CD " ).append("\n"); 
		query.append("		AND B1.SKD_VOY_NO    = B2.SKD_VOY_NO " ).append("\n"); 
		query.append("		AND B1.DIR_CD        = B2.SKD_DIR_CD " ).append("\n"); 
		query.append("		AND B1.TRD_CD        = B2.TRD_CD " ).append("\n"); 
		query.append("		AND B1.RLANE_CD      = B2.RLANE_CD " ).append("\n"); 
		query.append("		AND B1.IOC_CD        = B2.IOC_CD " ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("        AND B1.RLANE_CD = L1.RLANE_CD" ).append("\n"); 
		query.append("        AND B1.DIR_CD = L1.DIR_CD" ).append("\n"); 
		query.append("        AND B1.TRD_CD = L1.TRD_CD" ).append("\n"); 
		query.append("        AND B1.IOC_CD = L1.IOC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("			AND B1.COST_YRMON    BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON   " ).append("\n"); 
		query.append("		#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("			AND B1.SLS_YRMON     BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON  " ).append("\n"); 
		query.append("		#end /*ofc_월별 관리*/" ).append("\n"); 
		query.append("		#if(${f_init_cost} == 'Y')" ).append("\n"); 
		query.append("			AND B2.STND_COST_CD   IN ('53101000', '53102000', '53200000', '54100000', '54250000', '54300000', '54200000', '54150000','54450000', '54180000', '54550000', '54350000', '54400000')" ).append("\n"); 
		query.append("		#end /* 배부 이전 원가 */" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		AND B2.STND_COST_CD  NOT IN ('91401011') /* STP REV 제외 */" ).append("\n"); 
		query.append("		AND V.VSL_CD        = B2.VSL_CD " ).append("\n"); 
		query.append("		AND V.SKD_VOY_NO    = B2.SKD_VOY_NO " ).append("\n"); 
		query.append("		AND V.DIR_CD        = B2.SKD_DIR_CD " ).append("\n"); 
		query.append("		AND V.TRD_CD        = B2.TRD_CD " ).append("\n"); 
		query.append("		AND V.RLANE_CD      = B2.RLANE_CD " ).append("\n"); 
		query.append("		AND V.IOC_CD        = B2.IOC_CD " ).append("\n"); 
		query.append("		AND V.STND_COST_CD  = B2.STND_COST_CD" ).append("\n"); 
		query.append("		AND B2.STND_COST_CD  = B3.STND_COST_CD " ).append("\n"); 
		query.append("		AND B1.DELT_FLG      <> 'Y' " ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("			AND B1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   " ).append("\n"); 
		query.append("		#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("			AND B1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    " ).append("\n"); 
		query.append("			AND B1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   " ).append("\n"); 
		query.append("		#end	" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("			AND B1.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("			AND B1.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("			AND B1.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("			AND B1.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("			AND B1.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("			AND B1.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("	    #end" ).append("\n"); 
		query.append("		#if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("			AND B1.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("			AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("			AND L1.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		                          " ).append("\n"); 
		query.append("		AND B3.RPT_VW_CD     = @[f_pro_vw]" ).append("\n"); 
		query.append("		AND DECODE (@[f_ofc_vw], 'C', B2.AGMT_SGN_OFC_CD, 'L', B2.SLS_OFC_CD) = B4.OFC_CD " ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		#if(${f_ofc_cd} !='')" ).append("\n"); 
		query.append("			#if(${f_excl_sts} =='')" ).append("\n"); 
		query.append("				/* N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '') */" ).append("\n"); 
		query.append("				AND DECODE (@[f_ofc_lvl] ,'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  " ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				AND B4.OFC_CD = @[f_ofc_cd]  " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			/* N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '') */" ).append("\n"); 
		query.append("			AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) IS NOT NULL  " ).append("\n"); 
		query.append("			AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_TP_CD,'3', B4.OFC_N3RD_LVL_TP_CD" ).append("\n"); 
		query.append("			           ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', B1.COST_YRMON, B1.SLS_YRMON), 1, 4), '2008', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCRA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("			                                                   , '2007', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCRA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("			                                                   , DECODE(B4.OFC_N4TH_LVL_CD, 'SZPDC', B4.OFC_N4TH_LVL_TP_CD, B4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA*/" ).append("\n"); 
		query.append("			           ,'5', B4.OFC_N5TH_LVL_TP_CD,'6', B4.OFC_N6TH_LVL_TP_CD,'7', B4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	" ).append("\n"); 
		query.append("		#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')" ).append("\n"); 
		query.append("			AND (B3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* strDisplay( f_pro_obj P->O,A,B) */" ).append("\n"); 
		query.append("				OR B3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) " ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			#if( ${f_pro_lvl} =='C')" ).append("\n"); 
		query.append("				AND B3.STND_COST_TP_CD IN ('S','C') " ).append("\n"); 
		query.append("			#elseif (${f_pro_lvl} =='O')" ).append("\n"); 
		query.append("				AND B3.STND_COST_TP_CD IN ('S','C','O') " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("	GROUP BY  " ).append("\n"); 
		query.append("		 B1.COST_YRMON " ).append("\n"); 
		query.append("		,B1.SLS_YRMON " ).append("\n"); 
		query.append("		,B1.COST_WK" ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("		,B4.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		,B1.TRD_CD " ).append("\n"); 
		query.append("		,B1.SUB_TRD_CD " ).append("\n"); 
		query.append("		,B1.RLANE_CD " ).append("\n"); 
		query.append("		,B1.IOC_CD " ).append("\n"); 
		query.append("		,B1.VSL_CD " ).append("\n"); 
		query.append("		,B1.SKD_VOY_NO " ).append("\n"); 
		query.append("		,B1.DIR_CD " ).append("\n"); 
		query.append("		,L1.HUL_BND_CD" ).append("\n"); 
		query.append("		,B2.STND_COST_CD " ).append("\n"); 
		query.append("	UNION ALL " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	SELECT   /*+ ORDERED */  " ).append("\n"); 
		query.append("		 B1.COST_YRMON  " ).append("\n"); 
		query.append("		,B1.SLS_YRMON  " ).append("\n"); 
		query.append("		,B1.COST_WK" ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("		,B4.OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		,B1.TRD_CD " ).append("\n"); 
		query.append("		,B1.SUB_TRD_CD " ).append("\n"); 
		query.append("		,B1.RLANE_CD " ).append("\n"); 
		query.append("		,B1.IOC_CD " ).append("\n"); 
		query.append("		,B1.VSL_CD " ).append("\n"); 
		query.append("		,B1.SKD_VOY_NO " ).append("\n"); 
		query.append("		,B1.DIR_CD " ).append("\n"); 
		query.append("		,L1.HUL_BND_CD" ).append("\n"); 
		query.append("		,DECODE(B2.STND_COST_CD, '65901021' ,'65901022', B2.STND_COST_CD) STND_COST_CD " ).append("\n"); 
		query.append("		,SUM (DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, B2.RA_PL_AMT))) AS AMT  " ).append("\n"); 
		query.append("        , 0 AS OTR_AMT" ).append("\n"); 
		query.append("	FROM MAS_MON_VVD B1 " ).append("\n"); 
		query.append("		,MAS_PFIT_LSS_SVC_TRNS_PRC B2 " ).append("\n"); 
		query.append("		,MAS_PFIT_LSS_RPT_ITM B3 " ).append("\n"); 
		query.append("		,MAS_OFC_LVL B4 " ).append("\n"); 
		query.append("        ,MAS_LANE_RGST L1" ).append("\n"); 
		query.append("	WHERE B1.VSL_CD        = B2.VSL_CD " ).append("\n"); 
		query.append("		AND B1.SKD_VOY_NO    = B2.SKD_VOY_NO " ).append("\n"); 
		query.append("		AND B1.DIR_CD        = B2.SKD_DIR_CD " ).append("\n"); 
		query.append("		AND B1.TRD_CD        = B2.TRD_CD " ).append("\n"); 
		query.append("		AND B1.RLANE_CD      = B2.RLANE_CD " ).append("\n"); 
		query.append("		AND B1.IOC_CD        = B2.IOC_CD " ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("        AND B1.RLANE_CD = L1.RLANE_CD" ).append("\n"); 
		query.append("        AND B1.DIR_CD = L1.DIR_CD" ).append("\n"); 
		query.append("        AND B1.TRD_CD = L1.TRD_CD" ).append("\n"); 
		query.append("        AND B1.IOC_CD = L1.IOC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("			AND B1.COST_YRMON    BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON   " ).append("\n"); 
		query.append("		#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("			AND B1.SLS_YRMON     BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON   " ).append("\n"); 
		query.append("		#end /* ofc_월별 관리*/" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("		AND B2.STND_COST_CD  IN ('91401011', '65901021')  /* STP REV, ABC OTH 만 */" ).append("\n"); 
		query.append("		AND B2.STND_COST_CD  = B3.STND_COST_CD " ).append("\n"); 
		query.append("		AND B1.DELT_FLG      <> 'Y' " ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("			AND B1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]  " ).append("\n"); 
		query.append("		#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("			AND B1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%' " ).append("\n"); 
		query.append("			AND B1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("			AND B1.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("			AND B1.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("			AND B1.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("			AND B1.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("			AND B1.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("			AND B1.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("	    #end	" ).append("\n"); 
		query.append("		#if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("			AND B1.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("			AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("			AND L1.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	    " ).append("\n"); 
		query.append("		AND B3.RPT_VW_CD     = @[f_pro_vw]" ).append("\n"); 
		query.append("		AND DECODE (@[f_ofc_vw], 'C', B2.AGMT_SGN_OFC_CD, 'L', B2.SLS_OFC_CD) = B4.OFC_CD " ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		#if(${f_ofc_cd} !='')" ).append("\n"); 
		query.append("			#if(${f_excl_sts} =='')" ).append("\n"); 
		query.append("				/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/" ).append("\n"); 
		query.append("				AND DECODE (@[f_ofc_lvl] ,'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) = @[f_ofc_cd] " ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				AND B4.OFC_CD  = @[f_ofc_cd]  " ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/" ).append("\n"); 
		query.append("			AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) IS NOT NULL  " ).append("\n"); 
		query.append("			AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_TP_CD,'3', B4.OFC_N3RD_LVL_TP_CD" ).append("\n"); 
		query.append("			       ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', B1.COST_YRMON, B1.SLS_YRMON), 1, 4), '2008', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCRA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("			                                               , '2007', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCRA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("			                                               , DECODE(B4.OFC_N4TH_LVL_CD, 'SZPDC', B4.OFC_N4TH_LVL_TP_CD, B4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA*/" ).append("\n"); 
		query.append("			       ,'5', B4.OFC_N5TH_LVL_TP_CD,'6', B4.OFC_N6TH_LVL_TP_CD,'7', B4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')" ).append("\n"); 
		query.append("			AND (B3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */" ).append("\n"); 
		query.append("				OR B3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) " ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			AND B3.STND_COST_TP_CD IN ('S','C','O' )  " ).append("\n"); 
		query.append("		#end	" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("	GROUP BY  " ).append("\n"); 
		query.append("		 B1.COST_YRMON " ).append("\n"); 
		query.append("		,B1.SLS_YRMON " ).append("\n"); 
		query.append("		,B1.COST_WK " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("		,B4.OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		,B1.TRD_CD " ).append("\n"); 
		query.append("		,B1.SUB_TRD_CD " ).append("\n"); 
		query.append("		,B1.RLANE_CD " ).append("\n"); 
		query.append("		,B1.IOC_CD " ).append("\n"); 
		query.append("		,B1.VSL_CD " ).append("\n"); 
		query.append("		,B1.SKD_VOY_NO " ).append("\n"); 
		query.append("		,B1.DIR_CD " ).append("\n"); 
		query.append("		,L1.HUL_BND_CD" ).append("\n"); 
		query.append("		,DECODE(B2.STND_COST_CD, '65901021' ,'65901022', B2.STND_COST_CD) " ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("	UNION ALL " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	SELECT " ).append("\n"); 
		query.append("		 COST_YRMON " ).append("\n"); 
		query.append("		,SLS_YRMON " ).append("\n"); 
		query.append("		,COST_WK " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("		,OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		,TRD_CD " ).append("\n"); 
		query.append("		,SUB_TRD_CD " ).append("\n"); 
		query.append("		,RLANE_CD " ).append("\n"); 
		query.append("		,IOC_CD " ).append("\n"); 
		query.append("		,VSL_CD " ).append("\n"); 
		query.append("		,SKD_VOY_NO " ).append("\n"); 
		query.append("		,DIR_CD " ).append("\n"); 
		query.append("		,HUL_BND_CD" ).append("\n"); 
		query.append("		,DECODE (B2.RNUM " ).append("\n"); 
		query.append("		       ,1, 'VOYAGE00' " ).append("\n"); 
		query.append("		       ,2, 'LOADFACT' " ).append("\n"); 
		query.append("		       ,3, 'REVENUE0' " ).append("\n"); 
		query.append("		       ,4, 'RPB00000' " ).append("\n"); 
		query.append("		       ,5, 'OTHINCOM' " ).append("\n"); 
		query.append("		       ,6, 'INCOMTTL' " ).append("\n"); 
		query.append("		       ,7, 'CMCOST00' " ).append("\n"); 
		query.append("		       ,8, 'CMCB0000' " ).append("\n"); 
		query.append("		       ,9, 'CMCTOTAL' " ).append("\n"); 
		query.append("		       ,10, 'CMB00000' " ).append("\n"); 
		query.append("		       ,11, 'OPCOST00' " ).append("\n"); 
		query.append("		       ,12, 'OPCB0000' " ).append("\n"); 
		query.append("		       ,13, 'OPCTOTAL' " ).append("\n"); 
		query.append("		       ,14, 'OPB00000' " ).append("\n"); 
		query.append("		       ,15, 'TSCTRB01' " ).append("\n"); 
		query.append("		       ,16, 'CMMT0001' " ).append("\n"); 
		query.append("		       ,17, 'BCMTOTAL' " ).append("\n"); 
		query.append("		       ,18, 'BCMB0000' " ).append("\n"); 
		query.append("		       ,19, '65901023'  " ).append("\n"); 
		query.append("		       ,20, 'BLN00001'   " ).append("\n"); 
		query.append("		       ,21, 'BLN00002'   " ).append("\n"); 
		query.append("		       ,22, 'BLNTOTAL'  " ).append("\n"); 
		query.append("		       ,23, 'BOPTOTAL' " ).append("\n"); 
		query.append("		       ,24, 'BOPB0000' " ).append("\n"); 
		query.append("		       ,25, 'EQCOST00' " ).append("\n"); 
		query.append("			   ,26, 'OPCOST01' 	" ).append("\n"); 
		query.append("			   ,27, 'OPCOST02' 	" ).append("\n"); 
		query.append("			   ,28, 'NTCOINIT' 	" ).append("\n"); 
		query.append("			   ,29, 'NTMASLOC' 		" ).append("\n"); 
		query.append("			   ,30, '65010001'" ).append("\n"); 
		query.append("		       ) STND_COST_CD " ).append("\n"); 
		query.append("		,DECODE(B2.RNUM " ).append("\n"); 
		query.append("		   ,1, VOYAGE                                            /* VOYAGE00 */ " ).append("\n"); 
		query.append("		   ,2, DECODE (SUPPLY, 0, 0, LOAD_TEU / SUPPLY) * 100    /* LOADFACT */" ).append("\n"); 
		query.append("		   ,3, REVENUE                                           /* REVENUE0 */" ).append("\n"); 
		query.append("		   ,4, DECODE (LOAD_TEU, 0, 0, REVENUE / LOAD_TEU)       /* RPB00000 (REV / TEU) */" ).append("\n"); 
		query.append("		   ,5, OTHER_INCOME                                      /* OTHINCOM */" ).append("\n"); 
		query.append("		   ,6, INCOME_TOTAL                                      /* INCOMTTL */" ).append("\n"); 
		query.append("		   ,7, DECODE " ).append("\n"); 
		query.append("		           (@[f_pro_vw]" ).append("\n"); 
		query.append("		           ,'P', CM_COST " ).append("\n"); 
		query.append("		           ,'R', DECODE (@[f_ofc_lvl]" ).append("\n"); 
		query.append("		                        ,'1', (CM_COST + SPC_CHTR) " ).append("\n"); 
		query.append("		                        ,CM_COST " ).append("\n"); 
		query.append("		                        ) " ).append("\n"); 
		query.append("		           )                                             /* CMCOST00 (Cost1 Total) */" ).append("\n"); 
		query.append("		   ,8, DECODE (LOAD_TEU " ).append("\n"); 
		query.append("		              ,0, 0 " ).append("\n"); 
		query.append("		              ,   DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("		                         ,'P', CM_COST " ).append("\n"); 
		query.append("		                         ,'R', DECODE (@[f_ofc_lvl]" ).append("\n"); 
		query.append("		                                      ,'1', (CM_COST + SPC_CHTR) " ).append("\n"); 
		query.append("		                                      ,CM_COST" ).append("\n"); 
		query.append("		                                      ) " ).append("\n"); 
		query.append("		                         ) " ).append("\n"); 
		query.append("		                / LOAD_TEU " ).append("\n"); 
		query.append("		              )                                          /* CMCB0000 (Cost1/TEU) */" ).append("\n"); 
		query.append("		   ,9, DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("		              ,'P', (INCOME_TOTAL) - (CM_COST + SPC_CHTR) " ).append("\n"); 
		query.append("		              ,'R', DECODE (@[f_ofc_lvl]" ).append("\n"); 
		query.append("		                           ,'1', (INCOME_TOTAL) - (CM_COST + SPC_CHTR) " ).append("\n"); 
		query.append("		                           , (INCOME_TOTAL) - (CM_COST + SPC_CHTR) " ).append("\n"); 
		query.append("		                           ) " ).append("\n"); 
		query.append("		              )   /* CMCTOTAL (CM(Contribution Margin) Total) */" ).append("\n"); 
		query.append("		   ,10, DECODE (LOAD_TEU " ).append("\n"); 
		query.append("		               ,0, 0 " ).append("\n"); 
		query.append("		               , (  DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("		                           ,'P', (INCOME_TOTAL) - (CM_COST + SPC_CHTR) " ).append("\n"); 
		query.append("		                           ,'R', DECODE (@[f_ofc_lvl]" ).append("\n"); 
		query.append("		                                        ,'1', (INCOME_TOTAL) - (CM_COST + SPC_CHTR) " ).append("\n"); 
		query.append("		                                        , (INCOME_TOTAL) - (CM_COST + SPC_CHTR) " ).append("\n"); 
		query.append("		                                        ) " ).append("\n"); 
		query.append("		                           ) " ).append("\n"); 
		query.append("		                  / LOAD_TEU " ).append("\n"); 
		query.append("		                 ) " ).append("\n"); 
		query.append("		               )   /* CMB00000 (CM(Contribution Margin)/TEU) */" ).append("\n"); 
		query.append("		   ,11, OP_COST " ).append("\n"); 
		query.append("		   ,12, DECODE (LOAD_TEU, 0, 0, OP_COST / LOAD_TEU) " ).append("\n"); 
		query.append("		   ,13, DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("		               ,'P', 0 " ).append("\n"); 
		query.append("		               ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE (@[f_ofc_lvl],'1', 0, INCOME_TOTAL - (CM_COST + SPC_CHTR) + (STP_REV-ABC_OTH_COND) + (ABC_OTH - STP_COST) - OP_COST)) " ).append("\n"); 
		query.append("		               )   /* OPCTOTAL (Branch CM-cost2) */" ).append("\n"); 
		query.append("		   ,14, DECODE (LOAD_TEU " ).append("\n"); 
		query.append("		               ,0, 0 " ).append("\n"); 
		query.append("		               ,   DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("		                          ,'P', 0 " ).append("\n"); 
		query.append("		                          ,'R',DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE (@[f_ofc_lvl],'1', 0,INCOME_TOTAL - (CM_COST + SPC_CHTR) + (STP_REV-ABC_OTH_COND)+(ABC_OTH - STP_COST) - OP_COST)) " ).append("\n"); 
		query.append("		                          ) " ).append("\n"); 
		query.append("		                 / LOAD_TEU " ).append("\n"); 
		query.append("		               )  /* OPB00000(OPCTOTAL/load) */" ).append("\n"); 
		query.append("		   ,15, (INCOME_TOTAL + TS_COST) - (CM_COST + OP_COST)   /* TSCTRB01 */" ).append("\n"); 
		query.append("		   ,16, ((INCOME_TOTAL - CM_COST) - HJS_SLS_AMT - CO_AMT - CMMT_COST - INTER_TS)   /* CMMT0001 */" ).append("\n"); 
		query.append("		   ,17, DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("		               ,'P', 0 " ).append("\n"); 
		query.append("		               ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE (@[f_ofc_lvl],'1', 0, (INCOME_TOTAL) - (CM_COST + SPC_CHTR) + (STP_REV-ABC_OTH_COND)+(ABC_OTH - STP_COST))) " ).append("\n"); 
		query.append("		               )   /* BCMTOTAL (Branch CM)  */" ).append("\n"); 
		query.append("		   ,18, DECODE (LOAD_TEU " ).append("\n"); 
		query.append("		               ,0, 0 " ).append("\n"); 
		query.append("		               ,   DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("		                          ,'P', 0 " ).append("\n"); 
		query.append("		                          ,'R',DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE (@[f_ofc_lvl],'1', 0,(INCOME_TOTAL) - (CM_COST + SPC_CHTR) + (STP_REV-ABC_OTH_COND)+(ABC_OTH - STP_COST))) " ).append("\n"); 
		query.append("		                          ) " ).append("\n"); 
		query.append("		                 / LOAD_TEU " ).append("\n"); 
		query.append("		               ) " ).append("\n"); 
		query.append("		   ,19, DECODE (@[f_pro_vw],'P', 0 ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, ABC_OTH)))                /* 65901023 */" ).append("\n"); 
		query.append("		   ,20, DECODE (@[f_pro_vw],'P', 0 ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, STP_REV-ABC_OTH_COND)))   /* BLN00001 */" ).append("\n"); 
		query.append("		   ,21, DECODE (@[f_pro_vw],'P', 0 ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, STP_COST - ABC_OTH)))     /* BLN00002 */" ).append("\n"); 
		query.append("		   ,22, DECODE (@[f_pro_vw],'P', 0 ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C',DECODE(@[f_ofc_lvl],'1',0, (STP_REV-ABC_OTH_COND)-(STP_COST - ABC_OTH))))   /* BLNTOTAL */" ).append("\n"); 
		query.append("		   ,23, DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("		               ,'P', INCOME_TOTAL - (CM_COST + OP_COST) " ).append("\n"); 
		query.append("		               ,'R', DECODE (@[f_ofc_lvl]" ).append("\n"); 
		query.append("		                            ,'1', INCOME_TOTAL - (CM_COST + OP_COST + SPC_CHTR) " ).append("\n"); 
		query.append("		                            , INCOME_TOTAL - (CM_COST + OP_COST) " ).append("\n"); 
		query.append("		                            ) " ).append("\n"); 
		query.append("		               )   /* BOPTOTAL */" ).append("\n"); 
		query.append("		   ,24, DECODE (LOAD_TEU " ).append("\n"); 
		query.append("		               ,0, 0 " ).append("\n"); 
		query.append("		               , (  DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("		                          ,'P', INCOME_TOTAL - (CM_COST + OP_COST) " ).append("\n"); 
		query.append("		                          ,'R', DECODE (@[f_ofc_lvl]" ).append("\n"); 
		query.append("		                                       ,'1', INCOME_TOTAL - (CM_COST + OP_COST + SPC_CHTR) " ).append("\n"); 
		query.append("		                                       , INCOME_TOTAL - (CM_COST + OP_COST) " ).append("\n"); 
		query.append("		                                       ) " ).append("\n"); 
		query.append("		                            ) " ).append("\n"); 
		query.append("		                   ) " ).append("\n"); 
		query.append("		                   / LOAD_TEU " ).append("\n"); 
		query.append("		                 )  /* BOPB0000 ((BOPTOTAL)/TEU) */" ).append("\n"); 
		query.append("		   ,25, EQ_COST " ).append("\n"); 
		query.append("		   ,26, OP_COST01 			   		" ).append("\n"); 
		query.append("		   ,27, OP_COST02 		" ).append("\n"); 
		query.append("		   ,28, INIT_COST 			   		" ).append("\n"); 
		query.append("		   ,29, TS_ALOC		   		" ).append("\n"); 
		query.append("		   ,30, GEN_EXPN 		   		 " ).append("\n"); 
		query.append("		   ) AS AMT            " ).append("\n"); 
		query.append("         , OTR_AMT AS OTR_AMT	 " ).append("\n"); 
		query.append("	FROM ( " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		SELECT    " ).append("\n"); 
		query.append("			 COST_YRMON " ).append("\n"); 
		query.append("			,SLS_YRMON " ).append("\n"); 
		query.append("			,COST_WK" ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("			,OFC_N2ND_LVL_CD " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("			,TRD_CD " ).append("\n"); 
		query.append("			,SUB_TRD_CD " ).append("\n"); 
		query.append("			,RLANE_CD " ).append("\n"); 
		query.append("			,IOC_CD " ).append("\n"); 
		query.append("			,VSL_CD " ).append("\n"); 
		query.append("			,SKD_VOY_NO " ).append("\n"); 
		query.append("			,DIR_CD " ).append("\n"); 
		query.append("			,HUL_BND_CD" ).append("\n"); 
		query.append("			,SUM (VOYAGE) VOYAGE " ).append("\n"); 
		query.append("			,SUM (SUPPLY) SUPPLY " ).append("\n"); 
		query.append("			,SUM (LOAD_TEU) LOAD_TEU " ).append("\n"); 
		query.append("			,SUM (REVENUE) REVENUE " ).append("\n"); 
		query.append("			,SUM (OTHER_INCOME) OTHER_INCOME " ).append("\n"); 
		query.append("			,SUM (SPC_CHTR) SPC_CHTR " ).append("\n"); 
		query.append("			,SUM (INCOME_TOTAL) INCOME_TOTAL " ).append("\n"); 
		query.append("			,SUM (CM_COST) CM_COST " ).append("\n"); 
		query.append("			,SUM (ABC_OWN) ABC_OWN " ).append("\n"); 
		query.append("			,SUM (STP_COST) STP_COST " ).append("\n"); 
		query.append("			,SUM (STP_REV) STP_REV " ).append("\n"); 
		query.append("			,SUM (ABC_OTH) ABC_OTH " ).append("\n"); 
		query.append("			,SUM (ABC_OTH_COND) ABC_OTH_COND " ).append("\n"); 
		query.append("			,SUM (OP_COST) + SUM (GEN_EXPN) OP_COST " ).append("\n"); 
		query.append("			,SUM (TS_COST) TS_COST " ).append("\n"); 
		query.append("			,SUM (CMMT_COST) CMMT_COST " ).append("\n"); 
		query.append("			,SUM (HJS_SLS_AMT) HJS_SLS_AMT " ).append("\n"); 
		query.append("			,SUM (CO_AMT) CO_AMT " ).append("\n"); 
		query.append("			,SUM (INTER_TS) INTER_TS " ).append("\n"); 
		query.append("			,SUM (EQ_COST) EQ_COST " ).append("\n"); 
		query.append("			,SUM (DEM_DET) DEM_DET " ).append("\n"); 
		query.append("			,SUM (OP_COST01) + SUM (GEN_EXPN) OP_COST01" ).append("\n"); 
		query.append("			,SUM (OP_COST01) - SUM (OP_COST) OP_COST02" ).append("\n"); 
		query.append("			,SUM (INIT_COST) INIT_COST" ).append("\n"); 
		query.append("			,SUM (TS_ALOC) TS_ALOC" ).append("\n"); 
		query.append("			,SUM (GEN_EXPN) GEN_EXPN" ).append("\n"); 
		query.append("            , SUM (OTR_AMT) OTR_AMT" ).append("\n"); 
		query.append("		FROM ( " ).append("\n"); 
		query.append("			SELECT  /*+ ORDERED */ " ).append("\n"); 
		query.append("				 A1.COST_YRMON " ).append("\n"); 
		query.append("				,A1.SLS_YRMON " ).append("\n"); 
		query.append("				,A1.COST_WK " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("				,A4.OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("				,A1.TRD_CD " ).append("\n"); 
		query.append("				,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("				,A1.RLANE_CD " ).append("\n"); 
		query.append("				,A1.IOC_CD " ).append("\n"); 
		query.append("				,A1.VSL_CD 		" ).append("\n"); 
		query.append("				,A1.SKD_VOY_NO 		" ).append("\n"); 
		query.append("				,A1.DIR_CD 	" ).append("\n"); 
		query.append("				,L1.HUL_BND_CD	" ).append("\n"); 
		query.append("				,COUNT(DISTINCT A2.TRD_CD|| A2.RLANE_CD || A2.IOC_CD || A2.VSL_CD || A2.SKD_VOY_NO || A2.SKD_DIR_CD)  AS VOYAGE " ).append("\n"); 
		query.append("				,NVL(SUM(DECODE(A3.STND_COST_CD,'BSA00000', DECODE (@[f_pro_vw],'P', A2.N5TH_ESTM_PL_AMT,'R', A2.RA_PL_AMT),0)),0) AS SUPPLY " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'LOAD0000', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1),'2', A2.N5TH_ESTM_PL_AMT, '3', A2.N5TH_ESTM_PL_AMT, A2.N5TH_ESTM_PL_AMT * 2) " ).append("\n"); 
		query.append("				                                     ,'R', DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1),'2', A2.RA_PL_AMT,'3', A2.RA_PL_AMT,A2.RA_PL_AMT * 2) " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS LOAD_TEU " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'41101011', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT, A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                     ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS REVENUE " ).append("\n"); 
		query.append("				,NVL(SUM(CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('43102011', '43201011', '43207011') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT, A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS OTHER_INCOME " ).append("\n"); 
		query.append("				,NVL(SUM(CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('43102011') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS SPC_CHTR " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_TP_CD " ).append("\n"); 
		query.append("				                 ,'S', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT, A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                              ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                              ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS INCOME_TOTAL " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_TP_CD " ).append("\n"); 
		query.append("				                 ,'C', DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                              ,'BSA00000', 0 /* 공급량 */" ).append("\n"); 
		query.append("				                              ,'LOAD0000', 0 /* 수송량 */" ).append("\n"); 
		query.append("				                              ,'91401011', 0 /* STP REVENUE */" ).append("\n"); 
		query.append("				                              ,'92404011', 0 /* STP COST  65901021 */" ).append("\n"); 
		query.append("				                              ,DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                      ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                      ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                      ) " ).append("\n"); 
		query.append("				                              ) " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS CM_COST " ).append("\n"); 
		query.append("				,NVL(SUM " ).append("\n"); 
		query.append("				       (CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('65901011') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS ABC_OWN " ).append("\n"); 
		query.append("				,NVL " ).append("\n"); 
		query.append("				   (SUM " ).append("\n"); 
		query.append("				       (CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('92404011') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS STP_COST " ).append("\n"); 
		query.append("				,NVL " ).append("\n"); 
		query.append("				   (SUM " ).append("\n"); 
		query.append("				       (CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('65901021') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS ABC_OTH " ).append("\n"); 
		query.append("				,0 AS STP_REV " ).append("\n"); 
		query.append("				,0 AS ABC_OTH_COND " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_TP_CD " ).append("\n"); 
		query.append("				                 ,'O', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                              ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                              ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS OP_COST " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'TSCTRB00', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                     ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS TS_COST " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'CMMT0000', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                     ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS CMMT_COST " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'HJSAMT00', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                     ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS HJS_SLS_AMT " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'CHTOUT00', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                     ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS CO_AMT " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'INTTRDTS', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                     ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS INTER_TS " ).append("\n"); 
		query.append("				,NVL " ).append("\n"); 
		query.append("				   (SUM " ).append("\n"); 
		query.append("				       (CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('92202013','92202014') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS EQ_COST " ).append("\n"); 
		query.append("				,NVL " ).append("\n"); 
		query.append("				   (SUM " ).append("\n"); 
		query.append("				       (CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('43201011') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS DEM_DET " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_TP_CD " ).append("\n"); 
		query.append("				                 ,'O', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                              ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                              ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS OP_COST01 	" ).append("\n"); 
		query.append("                -- Initial Network Cost(SML Sales/Slot Cht-out->All Network Cost by VVD->Total)" ).append("\n"); 
		query.append("                , SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF') AND STND_COST_CD <> '54600000') " ).append("\n"); 
		query.append("                           THEN NVL(A2.N5TH_HJS_SLS_AMT,0) + NVL(A2.N5TH_CO_AMT,0) - NVL(A2.N5TH_ASGN_AMT,0) ELSE 0 END) INIT_COST" ).append("\n"); 
		query.append("                -- T/S Cost Amount" ).append("\n"); 
		query.append("                , SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF') AND STND_COST_CD <> '54600000') " ).append("\n"); 
		query.append("                           THEN A2.N5TH_ASGN_AMT ELSE 0 END) TS_ALOC" ).append("\n"); 
		query.append("				, 0 AS GEN_EXPN" ).append("\n"); 
		query.append("                 , NVL(SUM(A2.ADJ_TRD_OTR_FNL_AMT),0) AS OTR_AMT" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("			FROM MAS_MON_VVD A1 " ).append("\n"); 
		query.append("				,MAS_PFIT_LSS_SMRY A2 " ).append("\n"); 
		query.append("				,MAS_PFIT_LSS_RPT_ITM A3 " ).append("\n"); 
		query.append("				,MAS_OFC_LVL A4 " ).append("\n"); 
		query.append("				,MAS_LANE_RGST L1" ).append("\n"); 
		query.append("			WHERE A1.VSL_CD       = A2.VSL_CD " ).append("\n"); 
		query.append("				AND A1.SKD_VOY_NO   = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("				AND A1.DIR_CD       = A2.SKD_DIR_CD " ).append("\n"); 
		query.append("				AND A1.TRD_CD       = A2.TRD_CD " ).append("\n"); 
		query.append("				AND A1.RLANE_CD     = A2.RLANE_CD " ).append("\n"); 
		query.append("				AND A1.IOC_CD       = A2.IOC_CD " ).append("\n"); 
		query.append("			" ).append("\n"); 
		query.append("				AND A1.RLANE_CD = L1.RLANE_CD" ).append("\n"); 
		query.append("				AND A1.DIR_CD = L1.DIR_CD" ).append("\n"); 
		query.append("				AND A1.TRD_CD = L1.TRD_CD" ).append("\n"); 
		query.append("				AND A1.IOC_CD = L1.IOC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("				#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("					AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("				#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("					AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_init_cost} == 'Y')" ).append("\n"); 
		query.append("					AND A2.STND_COST_CD  NOT IN ('53101000', '53102000', '53200000', '54100000', '54250000', '54300000', '54200000', '54150000','54450000', '54180000', '54550000', '54350000', '54400000')" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("								" ).append("\n"); 
		query.append("				AND A2.STND_COST_CD NOT IN ('91401011')   /*, '65901021' STP REV, ABC OTH 제외 */ " ).append("\n"); 
		query.append("				AND A2.STND_COST_CD = A3.STND_COST_CD " ).append("\n"); 
		query.append("				AND A1.DELT_FLG     <> 'Y' " ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("				#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("					AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] " ).append("\n"); 
		query.append("				#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("					AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%' " ).append("\n"); 
		query.append("					AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("				#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("					AND A1.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("					AND A1.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("					AND A1.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("					AND A1.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("					AND A1.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("					AND A1.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("			    #end     	" ).append("\n"); 
		query.append("			    #if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("				    AND A1.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("		        #end" ).append("\n"); 
		query.append("				#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("					AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("					AND L1.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("				AND A3.RPT_VW_CD     = @[f_pro_vw]  " ).append("\n"); 
		query.append("				AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD " ).append("\n"); 
		query.append("						" ).append("\n"); 
		query.append("				#if(${f_ofc_cd} !='')" ).append("\n"); 
		query.append("					#if(${f_excl_sts} =='')" ).append("\n"); 
		query.append("						/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/" ).append("\n"); 
		query.append("						AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  " ).append("\n"); 
		query.append("					#else" ).append("\n"); 
		query.append("						AND A4.OFC_CD        = @[f_ofc_cd]  " ).append("\n"); 
		query.append("					#end" ).append("\n"); 
		query.append("				#else" ).append("\n"); 
		query.append("					/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/" ).append("\n"); 
		query.append("					AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL  " ).append("\n"); 
		query.append("					" ).append("\n"); 
		query.append("					AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD" ).append("\n"); 
		query.append("					                                 ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("					                                                                         , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("					                                                                         , DECODE(A4.OFC_N4TH_LVL_CD, 'SZPDC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */" ).append("\n"); 
		query.append("					                                 ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("				#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')" ).append("\n"); 
		query.append("					AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */" ).append("\n"); 
		query.append("						OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) " ).append("\n"); 
		query.append("				#else" ).append("\n"); 
		query.append("					AND A3.STND_COST_TP_CD IN ('S','C','O') " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("			GROUP BY  " ).append("\n"); 
		query.append("			    A1.COST_YRMON " ).append("\n"); 
		query.append("			   ,A1.SLS_YRMON " ).append("\n"); 
		query.append("			   ,A1.COST_WK " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("			   ,A4.OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("			   ,A1.TRD_CD " ).append("\n"); 
		query.append("			   ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("			   ,A1.RLANE_CD " ).append("\n"); 
		query.append("			   ,A1.IOC_CD " ).append("\n"); 
		query.append("			   ,A1.VSL_CD " ).append("\n"); 
		query.append("			   ,A1.DIR_CD " ).append("\n"); 
		query.append("			   ,L1.HUL_BND_CD" ).append("\n"); 
		query.append("			   ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("			UNION ALL " ).append("\n"); 
		query.append("#if(${f_init_cost} == 'Y')" ).append("\n"); 
		query.append("			SELECT  /*+ ORDERED */ " ).append("\n"); 
		query.append("				 A1.COST_YRMON " ).append("\n"); 
		query.append("				,A1.SLS_YRMON " ).append("\n"); 
		query.append("				,A1.COST_WK " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("				,A4.OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("				,A1.TRD_CD " ).append("\n"); 
		query.append("				,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("				,A1.RLANE_CD " ).append("\n"); 
		query.append("				,A1.IOC_CD " ).append("\n"); 
		query.append("				,A1.VSL_CD 		" ).append("\n"); 
		query.append("				,A1.SKD_VOY_NO 		" ).append("\n"); 
		query.append("				,A1.DIR_CD 	" ).append("\n"); 
		query.append("				,L1.HUL_BND_CD	" ).append("\n"); 
		query.append("				,0 AS VOYAGE " ).append("\n"); 
		query.append("				,NVL(SUM(DECODE(A3.STND_COST_CD,'BSA00000', DECODE (@[f_pro_vw],'P', A2.N5TH_ESTM_PL_AMT,'R', A2.RA_PL_AMT),0)),0) AS SUPPLY " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'LOAD0000', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1),'2', A2.N5TH_ESTM_PL_AMT, '3', A2.N5TH_ESTM_PL_AMT, A2.N5TH_ESTM_PL_AMT * 2) " ).append("\n"); 
		query.append("				                                     ,'R', DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1),'2', A2.RA_PL_AMT,'3', A2.RA_PL_AMT,A2.RA_PL_AMT * 2) " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS LOAD_TEU " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'41101011', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT, A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                     ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS REVENUE " ).append("\n"); 
		query.append("				,NVL(SUM(CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('43102011', '43201011', '43207011') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT, A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS OTHER_INCOME " ).append("\n"); 
		query.append("				,NVL(SUM(CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('43102011') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS SPC_CHTR " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_TP_CD " ).append("\n"); 
		query.append("				                 ,'S', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT, A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                              ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                              ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS INCOME_TOTAL " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_TP_CD " ).append("\n"); 
		query.append("				                 ,'C', DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                              ,'BSA00000', 0 /* 공급량 */" ).append("\n"); 
		query.append("				                              ,'LOAD0000', 0 /* 수송량 */" ).append("\n"); 
		query.append("				                              ,'91401011', 0 /* STP REVENUE */" ).append("\n"); 
		query.append("				                              ,'92404011', 0 /* STP COST  65901021 */" ).append("\n"); 
		query.append("				                              ,DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                      ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                      ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                      ) " ).append("\n"); 
		query.append("				                              ) " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS CM_COST " ).append("\n"); 
		query.append("				,NVL(SUM " ).append("\n"); 
		query.append("				       (CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('65901011') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS ABC_OWN " ).append("\n"); 
		query.append("				,NVL " ).append("\n"); 
		query.append("				   (SUM " ).append("\n"); 
		query.append("				       (CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('92404011') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS STP_COST " ).append("\n"); 
		query.append("				,NVL " ).append("\n"); 
		query.append("				   (SUM " ).append("\n"); 
		query.append("				       (CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('65901021') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS ABC_OTH " ).append("\n"); 
		query.append("				,0 AS STP_REV " ).append("\n"); 
		query.append("				,0 AS ABC_OTH_COND " ).append("\n"); 
		query.append("				-- Initial Network Cost Display 일경우 OP Cost Total 에 T/S cost Amount 를 더한다." ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_TP_CD " ).append("\n"); 
		query.append("				                 ,'O', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,V.NTWK_HIR_COST_AMT) " ).append("\n"); 
		query.append("				                              ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                              ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) + SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF') AND STND_COST_CD <> '54600000') " ).append("\n"); 
		query.append("                           THEN A2.N5TH_ASGN_AMT ELSE 0 END) AS OP_COST " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'TSCTRB00', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                     ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS TS_COST " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'CMMT0000', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                     ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS CMMT_COST " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'HJSAMT00', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                     ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS HJS_SLS_AMT " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'CHTOUT00', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                     ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS CO_AMT " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_CD " ).append("\n"); 
		query.append("				                 ,'INTTRDTS', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                                     ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                                     ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS INTER_TS " ).append("\n"); 
		query.append("				,NVL " ).append("\n"); 
		query.append("				   (SUM " ).append("\n"); 
		query.append("				       (CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('92202013','92202014') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS EQ_COST " ).append("\n"); 
		query.append("				,NVL " ).append("\n"); 
		query.append("				   (SUM " ).append("\n"); 
		query.append("				       (CASE " ).append("\n"); 
		query.append("				           WHEN A3.STND_COST_CD IN ('43201011') " ).append("\n"); 
		query.append("				           		THEN DECODE(@[f_pro_vw]" ).append("\n"); 
		query.append("	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("	                                       ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("	                                       ) " ).append("\n"); 
		query.append("				           ELSE 0 " ).append("\n"); 
		query.append("				        END " ).append("\n"); 
		query.append("				       ) " ).append("\n"); 
		query.append("				   ,0 " ).append("\n"); 
		query.append("				   ) AS DEM_DET " ).append("\n"); 
		query.append("				,NVL (SUM (DECODE (A3.STND_COST_TP_CD " ).append("\n"); 
		query.append("				                 ,'O', DECODE (@[f_pro_vw]" ).append("\n"); 
		query.append("				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N5TH_CO_AMT,'O|BIZ', A2.N5TH_HJS_SLS_AMT,A2.N5TH_ESTM_PL_AMT) " ).append("\n"); 
		query.append("				                              ,'R', A2.RA_PL_AMT " ).append("\n"); 
		query.append("				                              ) " ).append("\n"); 
		query.append("				                 ,0 " ).append("\n"); 
		query.append("				                 ) " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS OP_COST01 	" ).append("\n"); 
		query.append("                -- Initial Network Cost(SML Sales/Slot Cht-out->All Network Cost by VVD->Total)" ).append("\n"); 
		query.append("                , SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF') AND STND_COST_CD <> '54600000') " ).append("\n"); 
		query.append("                           THEN NVL(A2.N5TH_HJS_SLS_AMT,0) + NVL(A2.N5TH_CO_AMT,0) - NVL(A2.N5TH_ASGN_AMT,0) ELSE 0 END) INIT_COST" ).append("\n"); 
		query.append("                -- T/S Cost Amount" ).append("\n"); 
		query.append("                , SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF') AND STND_COST_CD <> '54600000') " ).append("\n"); 
		query.append("                           THEN A2.N5TH_ASGN_AMT ELSE 0 END) TS_ALOC" ).append("\n"); 
		query.append("				, 0 AS GEN_EXPN" ).append("\n"); 
		query.append("                 , NVL(SUM(A2.ADJ_TRD_OTR_FNL_AMT),0) AS OTR_AMT" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("			FROM MAS_MON_VVD A1 " ).append("\n"); 
		query.append("				,MAS_PFIT_LSS_SMRY A2 " ).append("\n"); 
		query.append("				,MAS_PFIT_LSS_RPT_ITM A3 " ).append("\n"); 
		query.append("				,MAS_OFC_LVL A4 " ).append("\n"); 
		query.append("				,MAS_LANE_RGST L1" ).append("\n"); 
		query.append("				,MAS_VVD_HIR V" ).append("\n"); 
		query.append("			WHERE A1.VSL_CD       = A2.VSL_CD " ).append("\n"); 
		query.append("				AND A1.SKD_VOY_NO   = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("				AND A1.DIR_CD       = A2.SKD_DIR_CD " ).append("\n"); 
		query.append("				AND A1.TRD_CD       = A2.TRD_CD " ).append("\n"); 
		query.append("				AND A1.RLANE_CD     = A2.RLANE_CD " ).append("\n"); 
		query.append("				AND A1.IOC_CD       = A2.IOC_CD " ).append("\n"); 
		query.append("			" ).append("\n"); 
		query.append("				AND A1.RLANE_CD = L1.RLANE_CD" ).append("\n"); 
		query.append("				AND A1.DIR_CD = L1.DIR_CD" ).append("\n"); 
		query.append("				AND A1.TRD_CD = L1.TRD_CD" ).append("\n"); 
		query.append("				AND A1.IOC_CD = L1.IOC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("				#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("					AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("				#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("					AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_init_cost} == 'Y')" ).append("\n"); 
		query.append("					AND A2.STND_COST_CD  IN ('53101000', '53102000', '53200000', '54100000', '54250000', '54300000', '54200000', '54150000','54450000', '54180000', '54550000', '54350000', '54400000')" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("								" ).append("\n"); 
		query.append("				AND A2.STND_COST_CD NOT IN ('91401011')   /*, '65901021' STP REV, ABC OTH 제외 */ " ).append("\n"); 
		query.append("					AND V.VSL_CD        = A2.VSL_CD " ).append("\n"); 
		query.append("					AND V.SKD_VOY_NO    = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("					AND V.DIR_CD        = A2.SKD_DIR_CD " ).append("\n"); 
		query.append("					AND V.TRD_CD        = A2.TRD_CD " ).append("\n"); 
		query.append("					AND V.RLANE_CD      = A2.RLANE_CD " ).append("\n"); 
		query.append("					AND V.IOC_CD        = A2.IOC_CD " ).append("\n"); 
		query.append("					AND V.STND_COST_CD  = A2.STND_COST_CD" ).append("\n"); 
		query.append("				AND A2.STND_COST_CD = A3.STND_COST_CD " ).append("\n"); 
		query.append("				AND A1.DELT_FLG     <> 'Y' " ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("				#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("					AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] " ).append("\n"); 
		query.append("				#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("					AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%' " ).append("\n"); 
		query.append("					AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("				#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("					AND A1.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("					AND A1.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("					AND A1.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("					AND A1.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("					AND A1.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("					AND A1.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("			    #end     	" ).append("\n"); 
		query.append("			    #if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("				    AND A1.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("		        #end" ).append("\n"); 
		query.append("				#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("					AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("					AND L1.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("				AND A3.RPT_VW_CD     = @[f_pro_vw]  " ).append("\n"); 
		query.append("				AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD " ).append("\n"); 
		query.append("						" ).append("\n"); 
		query.append("				#if(${f_ofc_cd} !='')" ).append("\n"); 
		query.append("					#if(${f_excl_sts} =='')" ).append("\n"); 
		query.append("						/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/" ).append("\n"); 
		query.append("						AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  " ).append("\n"); 
		query.append("					#else" ).append("\n"); 
		query.append("						AND A4.OFC_CD        = @[f_ofc_cd]  " ).append("\n"); 
		query.append("					#end" ).append("\n"); 
		query.append("				#else" ).append("\n"); 
		query.append("					/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/" ).append("\n"); 
		query.append("					AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL  " ).append("\n"); 
		query.append("					" ).append("\n"); 
		query.append("					AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD" ).append("\n"); 
		query.append("					                                 ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("					                                                                         , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("					                                                                         , DECODE(A4.OFC_N4TH_LVL_CD, 'SZPDC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */" ).append("\n"); 
		query.append("					                                 ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("				#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')" ).append("\n"); 
		query.append("					AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */" ).append("\n"); 
		query.append("						OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) " ).append("\n"); 
		query.append("				#else" ).append("\n"); 
		query.append("					AND A3.STND_COST_TP_CD IN ('S','C','O') " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("			GROUP BY  " ).append("\n"); 
		query.append("			    A1.COST_YRMON " ).append("\n"); 
		query.append("			   ,A1.SLS_YRMON " ).append("\n"); 
		query.append("			   ,A1.COST_WK " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("			   ,A4.OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("			   ,A1.TRD_CD " ).append("\n"); 
		query.append("			   ,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("			   ,A1.RLANE_CD " ).append("\n"); 
		query.append("			   ,A1.IOC_CD " ).append("\n"); 
		query.append("			   ,A1.VSL_CD " ).append("\n"); 
		query.append("			   ,A1.DIR_CD " ).append("\n"); 
		query.append("			   ,L1.HUL_BND_CD" ).append("\n"); 
		query.append("			   ,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("			UNION ALL " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			SELECT  /*+ ORDERED */ " ).append("\n"); 
		query.append("				 A1.COST_YRMON " ).append("\n"); 
		query.append("				,A1.SLS_YRMON " ).append("\n"); 
		query.append("				,A1.COST_WK " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("				,A4.OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("				,A1.TRD_CD " ).append("\n"); 
		query.append("				,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("				,A1.RLANE_CD " ).append("\n"); 
		query.append("				,A1.IOC_CD " ).append("\n"); 
		query.append("				,A1.VSL_CD 		" ).append("\n"); 
		query.append("				,A1.SKD_VOY_NO 		" ).append("\n"); 
		query.append("				,A1.DIR_CD 	" ).append("\n"); 
		query.append("                ,L1.HUL_BND_CD	" ).append("\n"); 
		query.append("				,0 AS VOYAGE " ).append("\n"); 
		query.append("				,0 AS SUPPLY " ).append("\n"); 
		query.append("				,0 AS LOAD_TEU " ).append("\n"); 
		query.append("				,0 AS REVENUE " ).append("\n"); 
		query.append("				,0 AS OTHER_INCOME " ).append("\n"); 
		query.append("				,0 AS SPC_CHTR " ).append("\n"); 
		query.append("				,0 AS INCOME_TOTAL " ).append("\n"); 
		query.append("				,0 AS CM_COST " ).append("\n"); 
		query.append("				,0 AS ABC_OWN " ).append("\n"); 
		query.append("				,0 AS STP_COST " ).append("\n"); 
		query.append("				,0 AS ABC_OTH " ).append("\n"); 
		query.append("				,NVL (SUM (CASE " ).append("\n"); 
		query.append("				             WHEN A3.STND_COST_CD IN ('91401011') AND A3.RPT_VW_CD = 'R' THEN  A2.RA_PL_AMT " ).append("\n"); 
		query.append("				             ELSE 0 " ).append("\n"); 
		query.append("				          END " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS STP_REV " ).append("\n"); 
		query.append("				,NVL (SUM (CASE " ).append("\n"); 
		query.append("				             WHEN A3.STND_COST_CD IN ('65901021') AND A3.RPT_VW_CD = 'R' THEN  A2.RA_PL_AMT " ).append("\n"); 
		query.append("				             ELSE 0 " ).append("\n"); 
		query.append("				          END " ).append("\n"); 
		query.append("				         ) " ).append("\n"); 
		query.append("				    ,0 " ).append("\n"); 
		query.append("				    ) AS ABC_OTH_COND " ).append("\n"); 
		query.append("				,0 OP_COST " ).append("\n"); 
		query.append("				,0 TS_COST " ).append("\n"); 
		query.append("				,0 CMMT_COST " ).append("\n"); 
		query.append("				,0 HJS_SLS_AMT " ).append("\n"); 
		query.append("				,0 AS CO_AMT " ).append("\n"); 
		query.append("				,0 AS INTER_TS " ).append("\n"); 
		query.append("				,0 AS EQ_COST " ).append("\n"); 
		query.append("				,0 AS DEM_DET " ).append("\n"); 
		query.append("				,0 OP_COST01 " ).append("\n"); 
		query.append("				,0 AS INIT_COST		-- Initial Network Cost" ).append("\n"); 
		query.append("				,0 AS TS_ALOC		-- T/S Cost Amount" ).append("\n"); 
		query.append("				,0 AS GEN_EXPN" ).append("\n"); 
		query.append("                , 0 AS OTR_AMT" ).append("\n"); 
		query.append("			FROM MAS_MON_VVD A1 " ).append("\n"); 
		query.append("				,MAS_PFIT_LSS_SVC_TRNS_PRC A2 " ).append("\n"); 
		query.append("				,MAS_PFIT_LSS_RPT_ITM A3 " ).append("\n"); 
		query.append("				,MAS_OFC_LVL A4 " ).append("\n"); 
		query.append("				,MAS_LANE_RGST L1" ).append("\n"); 
		query.append("			WHERE A1.VSL_CD        = A2.VSL_CD " ).append("\n"); 
		query.append("				AND A1.SKD_VOY_NO    = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("				AND A1.DIR_CD        = A2.SKD_DIR_CD " ).append("\n"); 
		query.append("				AND A1.TRD_CD        = A2.TRD_CD " ).append("\n"); 
		query.append("				AND A1.RLANE_CD      = A2.RLANE_CD " ).append("\n"); 
		query.append("				AND A1.IOC_CD        = A2.IOC_CD " ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("				AND A1.RLANE_CD = L1.RLANE_CD" ).append("\n"); 
		query.append("				AND A1.DIR_CD = L1.DIR_CD" ).append("\n"); 
		query.append("				AND A1.TRD_CD = L1.TRD_CD" ).append("\n"); 
		query.append("				AND A1.IOC_CD = L1.IOC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("				#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("					AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("				#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("					AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("				#end /*ofc_월별 관리*/" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("				AND A2.STND_COST_CD  IN ('91401011', '65901021') " ).append("\n"); 
		query.append("				AND A2.STND_COST_CD  = A3.STND_COST_CD " ).append("\n"); 
		query.append("				AND A1.DELT_FLG      <> 'Y' " ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("				#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("					AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] " ).append("\n"); 
		query.append("				#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("					AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'  " ).append("\n"); 
		query.append("					AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("				#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("					AND A1.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("					AND A1.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("					AND A1.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("					AND A1.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("					AND A1.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("					AND A1.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("			    #end" ).append("\n"); 
		query.append("			    #if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("				    AND A1.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("		        #end" ).append("\n"); 
		query.append("				#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("					AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("					AND L1.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("				AND A3.RPT_VW_CD     = @[f_pro_vw]" ).append("\n"); 
		query.append("				AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD  " ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("				#if(${f_ofc_cd} !='')" ).append("\n"); 
		query.append("					#if(${f_excl_sts} =='')" ).append("\n"); 
		query.append("						/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '') */" ).append("\n"); 
		query.append("						AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  " ).append("\n"); 
		query.append("					#else" ).append("\n"); 
		query.append("						AND A4.OFC_CD  = @[f_ofc_cd]  " ).append("\n"); 
		query.append("					#end" ).append("\n"); 
		query.append("				#else" ).append("\n"); 
		query.append("					/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/" ).append("\n"); 
		query.append("					AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL " ).append("\n"); 
		query.append("					AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD" ).append("\n"); 
		query.append("					                                 ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("					                                                                         , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("					                                                                         , DECODE(A4.OFC_N4TH_LVL_CD, 'SZPDC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */" ).append("\n"); 
		query.append("					                                 ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("				#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')" ).append("\n"); 
		query.append("					AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */" ).append("\n"); 
		query.append("						OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) " ).append("\n"); 
		query.append("				#else" ).append("\n"); 
		query.append("					AND A3.STND_COST_TP_CD IN ('S','C','O')  " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("			GROUP BY  " ).append("\n"); 
		query.append("				 A1.COST_YRMON " ).append("\n"); 
		query.append("				,A1.SLS_YRMON " ).append("\n"); 
		query.append("				,A1.COST_WK " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("				,A4.OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("				,A1.TRD_CD " ).append("\n"); 
		query.append("				,A1.SUB_TRD_CD " ).append("\n"); 
		query.append("				,A1.RLANE_CD " ).append("\n"); 
		query.append("				,A1.IOC_CD " ).append("\n"); 
		query.append("				,A1.VSL_CD " ).append("\n"); 
		query.append("				,A1.SKD_VOY_NO " ).append("\n"); 
		query.append("				,A1.DIR_CD " ).append("\n"); 
		query.append("				,L1.HUL_BND_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			   UNION ALL " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("				/* General Expense */" ).append("\n"); 
		query.append("			   SELECT A1.COST_YRMON" ).append("\n"); 
		query.append("					, A1.SLS_YRMON " ).append("\n"); 
		query.append("					, A1.COST_WK" ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("					, A4.OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("					, A1.TRD_CD" ).append("\n"); 
		query.append("					, A1.SUB_TRD_CD" ).append("\n"); 
		query.append("					, A1.RLANE_CD " ).append("\n"); 
		query.append("					, A1.IOC_CD" ).append("\n"); 
		query.append("					, A1.VSL_CD 		" ).append("\n"); 
		query.append("					, A1.SKD_VOY_NO 	" ).append("\n"); 
		query.append("					, A1.DIR_CD" ).append("\n"); 
		query.append("					, L1.HUL_BND_CD " ).append("\n"); 
		query.append("					, 0 AS VOYAGE " ).append("\n"); 
		query.append("					, 0 AS SUPPLY " ).append("\n"); 
		query.append("					, 0 AS LOAD_TEU " ).append("\n"); 
		query.append("					, 0 AS REVENUE " ).append("\n"); 
		query.append("					, 0 AS OTHER_INCOME " ).append("\n"); 
		query.append("					, 0 AS SPC_CHTR " ).append("\n"); 
		query.append("					, 0 AS INCOME_TOTAL " ).append("\n"); 
		query.append("					, 0 AS CM_COST " ).append("\n"); 
		query.append("					, 0 AS ABC_OWN " ).append("\n"); 
		query.append("					, 0 AS STP_COST " ).append("\n"); 
		query.append("					, 0 AS ABC_OTH " ).append("\n"); 
		query.append("					, 0 AS STP_REV " ).append("\n"); 
		query.append("					, 0 AS ABC_OTH_COND " ).append("\n"); 
		query.append("					, 0 AS OP_COST " ).append("\n"); 
		query.append("					, 0 AS TS_COST " ).append("\n"); 
		query.append("					, 0 AS CMMT_COST " ).append("\n"); 
		query.append("					, 0 AS HJS_SLS_AMT " ).append("\n"); 
		query.append("					, 0 AS CO_AMT " ).append("\n"); 
		query.append("					, 0 AS INTER_TS " ).append("\n"); 
		query.append("					, 0 AS EQ_COST " ).append("\n"); 
		query.append("					, 0 AS DEM_DET " ).append("\n"); 
		query.append("					, 0 AS OP_COST01 " ).append("\n"); 
		query.append("					, 0 AS INIT_COST" ).append("\n"); 
		query.append("					, 0 AS TS_ALOC" ).append("\n"); 
		query.append("					, SUM(DECODE(A3.STND_COST_CD, '65010001', DECODE (@[f_pro_vw], 'P', A2.ESTM_PL_AMT, 'R', A2.RA_PL_AMT), 0)) AS GEN_EXPN" ).append("\n"); 
		query.append("                    , 0 AS OTR_AMT" ).append("\n"); 
		query.append("				 FROM MAS_MON_VVD A1 " ).append("\n"); 
		query.append("					, MAS_PFIT_LSS_GEN_EXPN A2 " ).append("\n"); 
		query.append("					, MAS_PFIT_LSS_RPT_ITM A3 " ).append("\n"); 
		query.append("					, MAS_OFC_LVL A4 " ).append("\n"); 
		query.append("					, MAS_LANE_RGST L1" ).append("\n"); 
		query.append("				WHERE A1.VSL_CD        = A2.VSL_CD " ).append("\n"); 
		query.append("				  AND A1.SKD_VOY_NO    = A2.SKD_VOY_NO " ).append("\n"); 
		query.append("				  AND A1.DIR_CD        = A2.SKD_DIR_CD " ).append("\n"); 
		query.append("				  AND A1.TRD_CD        = A2.TRD_CD " ).append("\n"); 
		query.append("				  AND A1.RLANE_CD      = A2.RLANE_CD " ).append("\n"); 
		query.append("				  AND A1.IOC_CD        = A2.IOC_CD " ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("				  AND A1.RLANE_CD      = L1.RLANE_CD" ).append("\n"); 
		query.append("				  AND A1.DIR_CD        = L1.DIR_CD" ).append("\n"); 
		query.append("				  AND A1.TRD_CD        = L1.TRD_CD" ).append("\n"); 
		query.append("				  AND A1.IOC_CD        = L1.IOC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("				#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("				  AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("				#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("				  AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON" ).append("\n"); 
		query.append("				#end /*ofc_월별 관리*/" ).append("\n"); 
		query.append("						" ).append("\n"); 
		query.append("				  AND A2.STND_COST_CD  = '65010001' " ).append("\n"); 
		query.append("				  AND A2.STND_COST_CD  = A3.STND_COST_CD " ).append("\n"); 
		query.append("				  AND A1.DELT_FLG      <> 'Y' " ).append("\n"); 
		query.append("				  AND A2.OFC_VW_CD     = @[f_ofc_vw] /* Office view code 별로 expense 관리 */" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("				#if(${f_chkprd} =='M')" ).append("\n"); 
		query.append("				  AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] " ).append("\n"); 
		query.append("				#elseif (${f_chkprd} =='W')" ).append("\n"); 
		query.append("				  AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'  " ).append("\n"); 
		query.append("				  AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("						" ).append("\n"); 
		query.append("				#if(${f_trd_cd} !='') " ).append("\n"); 
		query.append("				  AND A1.TRD_CD    = @[f_trd_cd]  " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_rlane_cd} !='') " ).append("\n"); 
		query.append("				  AND A1.RLANE_CD  = @[f_rlane_cd]" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_dir_cd} !='')   " ).append("\n"); 
		query.append("				  AND A1.DIR_CD    = @[f_dir_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_vsl_cd} !='') " ).append("\n"); 
		query.append("				  AND A1.VSL_CD    = @[f_vsl_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_skd_voy_no} !='')  " ).append("\n"); 
		query.append("				  AND A1.SKD_VOY_NO    = @[f_skd_voy_no] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_skd_dir_cd} !='') " ).append("\n"); 
		query.append("				  AND A1.DIR_CD     = @[f_skd_dir_cd] " ).append("\n"); 
		query.append("				#end " ).append("\n"); 
		query.append("				#if(${f_sub_trd_cd} !='') " ).append("\n"); 
		query.append("				  AND A1.SUB_TRD_CD = @[f_sub_trd_cd] " ).append("\n"); 
		query.append("				#end           " ).append("\n"); 
		query.append("				#if(${f_ias_rgn_cd} !='') " ).append("\n"); 
		query.append("				  AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if(${f_trd_dir_cd} !='') " ).append("\n"); 
		query.append("				  AND L1.HUL_BND_CD = @[f_trd_dir_cd] " ).append("\n"); 
		query.append("				#end		" ).append("\n"); 
		query.append("												" ).append("\n"); 
		query.append("				  AND A3.RPT_VW_CD     = @[f_pro_vw]  " ).append("\n"); 
		query.append("				  AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD  " ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("				#if(${f_ofc_cd} !='')" ).append("\n"); 
		query.append("					#if(${f_excl_sts} =='')" ).append("\n"); 
		query.append("				  AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  " ).append("\n"); 
		query.append("					#else" ).append("\n"); 
		query.append("				  AND A4.OFC_CD  = @[f_ofc_cd]  " ).append("\n"); 
		query.append("					#end" ).append("\n"); 
		query.append("				#else" ).append("\n"); 
		query.append("						" ).append("\n"); 
		query.append("				  AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL " ).append("\n"); 
		query.append("				  AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD" ).append("\n"); 
		query.append("								      ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("										   , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)" ).append("\n"); 
		query.append("										   , DECODE(A4.OFC_N4TH_LVL_CD, 'SZPDC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */" ).append("\n"); 
		query.append("								      ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  " ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("				#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')" ).append("\n"); 
		query.append("				  AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */" ).append("\n"); 
		query.append("						OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) " ).append("\n"); 
		query.append("				#else" ).append("\n"); 
		query.append("				  AND A3.STND_COST_TP_CD IN ('S','C','O')  " ).append("\n"); 
		query.append("				#end	                " ).append("\n"); 
		query.append("						       " ).append("\n"); 
		query.append("				GROUP BY A1.COST_YRMON" ).append("\n"); 
		query.append("					, A1.SLS_YRMON" ).append("\n"); 
		query.append("					, A1.COST_WK" ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("					, A4.OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("					, A1.TRD_CD" ).append("\n"); 
		query.append("					, A1.SUB_TRD_CD" ).append("\n"); 
		query.append("					, A1.RLANE_CD" ).append("\n"); 
		query.append("					, A1.IOC_CD" ).append("\n"); 
		query.append("					, A1.VSL_CD " ).append("\n"); 
		query.append("					, A1.SKD_VOY_NO " ).append("\n"); 
		query.append("					, A1.DIR_CD" ).append("\n"); 
		query.append("					, L1.HUL_BND_CD " ).append("\n"); 
		query.append("			) " ).append("\n"); 
		query.append("		GROUP BY   " ).append("\n"); 
		query.append("			 COST_YRMON " ).append("\n"); 
		query.append("			,SLS_YRMON " ).append("\n"); 
		query.append("			,COST_WK " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("			,OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("			,TRD_CD " ).append("\n"); 
		query.append("			,SUB_TRD_CD " ).append("\n"); 
		query.append("			,RLANE_CD " ).append("\n"); 
		query.append("			,IOC_CD " ).append("\n"); 
		query.append("			,VSL_CD " ).append("\n"); 
		query.append("			,SKD_VOY_NO " ).append("\n"); 
		query.append("			,DIR_CD " ).append("\n"); 
		query.append("			,HUL_BND_CD" ).append("\n"); 
		query.append("		) B1 " ).append("\n"); 
		query.append("		, (SELECT CPY_NO AS RNUM " ).append("\n"); 
		query.append("			FROM COM_CPY_NO " ).append("\n"); 
		query.append("			WHERE CPY_NO BETWEEN 1 AND 30" ).append("\n"); 
		query.append("		) B2 " ).append("\n"); 
		query.append("	) A " ).append("\n"); 
		query.append("    , (SELECT LEVEL AS NO FROM dual  CONNECT BY LEVEL < 3 ) B  " ).append("\n"); 
		query.append("GROUP BY A.COST_YRMON " ).append("\n"); 
		query.append("	,A.SLS_YRMON " ).append("\n"); 
		query.append("	,A.COST_WK " ).append("\n"); 
		query.append("#if($f_ofc_lvl == '2')" ).append("\n"); 
		query.append("	,A.OFC_N2ND_LVL_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("	,A.TRD_CD " ).append("\n"); 
		query.append("	,A.SUB_TRD_CD " ).append("\n"); 
		query.append("	,A.RLANE_CD " ).append("\n"); 
		query.append("	,A.IOC_CD " ).append("\n"); 
		query.append("	,A.VSL_CD " ).append("\n"); 
		query.append("	,A.SKD_VOY_NO " ).append("\n"); 
		query.append("	,A.DIR_CD" ).append("\n"); 
		query.append("	,A.HUL_BND_CD" ).append("\n"); 
		query.append("    , B.NO" ).append("\n"); 
		query.append("ORDER BY A.SLS_YRMON" ).append("\n"); 
		query.append("      , A.TRD_CD" ).append("\n"); 
		query.append("      , A.RLANE_CD" ).append("\n"); 
		query.append("      , A.IOC_CD" ).append("\n"); 
		query.append("      , A.VSL_CD " ).append("\n"); 
		query.append("      , A.SKD_VOY_NO " ).append("\n"); 
		query.append("      , A.DIR_CD" ).append("\n"); 
		query.append("      , A.HUL_BND_CD     " ).append("\n"); 
		query.append("      , DECODE(DECODE(B.NO,1,A.SUB_TRD_CD,2,'OT'),'OT',2,1)" ).append("\n"); 

	}
}