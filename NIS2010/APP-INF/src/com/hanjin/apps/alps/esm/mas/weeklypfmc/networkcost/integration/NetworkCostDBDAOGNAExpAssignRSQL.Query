<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="NetworkCostDBDAOGNAExpAssignRSQL">
			<desc><![CDATA[G&A Expense Creation By Office 를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT 
	 A.TRD_CD
	, A.RLANE_CD
	, A.IOC_CD
	, A.VSL_CD
	, A.SKD_VOY_NO
	, A.DIR_CD
	, A.OFC_CD
	, A.LOD_QTA
	, A.HO_EXPN_AMT
	, A.OWN_EXPN_AMT
	, A.HO_QTA_RTO
	, A.OWN_QTA_RTO
	, A.EXPN_TTL
	, A.ADJ_EXPN_TTL
	, A.CRE_USR_ID
	, A.CRE_DT
	, A.UPD_USR_ID
	, A.UPD_DT 
	, B.COST_YRMON 
	, B.COST_WK
	, B.SUB_TRD_CD
	, (SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD03217' AND INTG_CD_VAL_CTNT = C.HUL_BND_CD   ) HUL_BND_CD
	, A.VSL_CD || A.SKD_VOY_NO ||  A.DIR_CD as VVD
    , A.TRD_CD || A.RLANE_CD || A.IOC_CD || A.VSL_CD || A.SKD_VOY_NO || A.DIR_CD || A.OFC_CD as COMPARE_KEY
FROM MAS_GEN_EXPN_ASGN A, MAS_MON_VVD B, MAS_LANE_RGST C
WHERE 	 A.TRD_CD = B.TRD_CD
	AND A.RLANE_CD = B.RLANE_CD
	AND A.IOC_CD = B.IOC_CD
	AND A.VSL_CD = B.VSL_CD
	AND A.SKD_VOY_NO = B.SKD_VOY_NO
	AND A.DIR_CD = B.DIR_CD
	AND B.TRD_CD = C.TRD_CD
	AND B.RLANE_CD = C.RLANE_CD
	AND B.IOC_CD = C.IOC_CD
	AND B.DIR_CD = C.DIR_CD
#if(${f_chkprd} == 'M')
	AND B.COST_YRMON = @[f_year]||@[f_mon]
#else
    AND SUBSTR(B.COST_YRMON, 1, 4)||B.COST_WK BETWEEN @[f_year]||@[f_fm_wk] AND @[f_year]||@[f_to_wk]
#end

ORDER BY 		
	 B.COST_YRMON 
	, B.COST_WK
	, A.TRD_CD
	, A.RLANE_CD
	, A.IOC_CD
	, A.VSL_CD
	, A.SKD_VOY_NO
	, A.DIR_CD
	, A.OFC_CD			]]></sql>
			<params>
				<param name="f_year" type="12" value="" out="N"/>
				<param name="f_mon" type="12" value="" out="N"/>
				<param name="f_fm_wk" type="12" value="" out="N"/>
				<param name="f_to_wk" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
