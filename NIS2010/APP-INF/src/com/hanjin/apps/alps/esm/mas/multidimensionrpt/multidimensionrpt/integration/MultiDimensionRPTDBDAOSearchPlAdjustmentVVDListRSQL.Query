<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="MultiDimensionRPTDBDAOSearchPlAdjustmentVVDListRSQL">
			<desc><![CDATA[SearchPlAdjustmentVVDList]]></desc>
			<sql><![CDATA[
SELECT COST_YRMON
      ,SLS_YRMON
      ,COST_WK
      ,'' RHQ
      ,TRD_CD
      ,SUB_TRD_CD
      ,RLANE_CD
      ,IOC_CD
      ,VSL_CD
      ,SKD_VOY_NO
      ,SKD_DIR_CD
      ,HUL_BND_CD
#foreach($key in ${allcols})
      ,SUM(DECODE(STND_COST_CD, '$key', NVL(AMT,0), 0)) AS COST_AMT$velocityCount
#end
      ,SUM(NVL(AMT,0)) AS TTL_AMT
FROM (
        SELECT /*+ ORDERED */
               A.COST_YRMON
              ,A.SLS_YRMON
              ,A.COST_WK
              ,A.TRD_CD
              ,A.SUB_TRD_CD
              ,A.RLANE_CD
              ,A.IOC_CD
              ,A.VSL_CD
              ,A.SKD_VOY_NO
              ,A.SKD_DIR_CD
              ,A.HUL_BND_CD
              ,B.STND_COST_CD
              ,SUM(NVL(DECODE(A.PL_DESC, 'Week', A.ESTM_PL_AMT, 'Month', A.ACCT_AMT), 0)) AS AMT
         FROM MAS_PFIT_ADJ A, MAS_PFIT_LSS_RPT_ITM B
        WHERE 1=1
          AND A.STND_COST_CD = B.STND_COST_CD
          AND B.RPT_VW_CD = 'P'
      #if(${f_chkprd} =='M')
          AND A.REV_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]
      #elseif (${f_chkprd} =='W')
          AND A.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'
          AND A.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]
      #end
      #if(${f_trd_cd} !='')
          AND A.TRD_CD    = @[f_trd_cd]
      #end
      #if(${f_rlane_cd} !='')
            AND A.RLANE_CD  = @[f_rlane_cd]
      #end
      #if(${f_dir_cd} !='')
          AND A.SKD_DIR_CD = @[f_dir_cd] 
      #end
      #if(${f_vsl_cd} !='')
          AND A.VSL_CD    = @[f_vsl_cd]
      #end
      #if(${f_skd_voy_no} !='')
          AND A.SKD_VOY_NO = @[f_skd_voy_no]
      #end
      #if(${f_skd_dir_cd} !='')
          AND A.SKD_DIR_CD = @[f_skd_dir_cd]
      #end
      #if(${f_sub_trd_cd} !='')
          AND A.SUB_TRD_CD = @[f_sub_trd_cd]
      #end
      #if(${f_trd_dir_cd} !='')
          AND A.HUL_BND_CD = @[f_trd_dir_cd]
      #end
          AND (B.STND_COST_TP_CD IN ('S','C','O') OR B.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000'))
     GROUP BY A.COST_YRMON
             ,A.SLS_YRMON
             ,A.COST_WK
             ,A.TRD_CD
             ,A.SUB_TRD_CD
             ,A.RLANE_CD
             ,A.IOC_CD
             ,A.VSL_CD
             ,A.SKD_VOY_NO
             ,A.SKD_DIR_CD
             ,A.HUL_BND_CD
             ,B.STND_COST_CD
    )
GROUP BY COST_YRMON
        ,SLS_YRMON
        ,COST_WK
        ,TRD_CD
        ,SUB_TRD_CD
        ,RLANE_CD
        ,IOC_CD
        ,VSL_CD
        ,SKD_VOY_NO
        ,SKD_DIR_CD
        ,HUL_BND_CD 
ORDER BY INSTR('CNTLY CDMCO CNTTS CNTMR', RLANE_CD)			]]></sql>
			<params>
				<param name="f_year" type="12" value="" out="N"/>
				<param name="f_fm_mon" type="12" value="" out="N"/>
				<param name="f_to_mon" type="12" value="" out="N"/>
				<param name="f_sls_mon" type="12" value="" out="N"/>
				<param name="f_fm_wk" type="12" value="" out="N"/>
				<param name="f_to_wk" type="12" value="" out="N"/>
				<param name="f_trd_cd" type="12" value="" out="N"/>
				<param name="f_rlane_cd" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_vsl_cd" type="12" value="" out="N"/>
				<param name="f_skd_voy_no" type="12" value="" out="N"/>
				<param name="f_skd_dir_cd" type="12" value="" out="N"/>
				<param name="f_sub_trd_cd" type="12" value="" out="N"/>
				<param name="f_trd_dir_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
