<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PickUpNoticeDBDAOcopyPkupNtcFormWdCSQL">
			<desc><![CDATA[Form Type별 Notice Form안에 기입 될 문구정보를  Copy한다]]></desc>
			<sql><![CDATA[
MERGE INTO BKG_PKUP_WD A
USING (SELECT T1.PKUP_NTC_SEQ
             ,NVL(T1.PKUP_NTC_FOM_CD, T2.FOM_CD) AS PKUP_NTC_FOM_CD
             ,T1.ECLZ_OBL_CPY_FLG
             ,T1.BTM_RMK
             ,@[usr_id] AS CRE_USR_ID
             ,@[usr_id] AS UPD_USR_ID
       FROM   (
               SELECT (SELECT PKUP_NTC_SEQ 
                       FROM   BKG_PKUP_NTC_STUP 
                       WHERE  PKUP_NTC_SND_TP_CD = 'A'
                       AND    OFC_CD             = @[ofc_cd]
                       AND    DEL_CD             = DECODE(nvl(@[del_cd],'ALL'),'ALL','*',@[del_cd])) AS PKUP_NTC_SEQ
                     ,T2.PKUP_NTC_FOM_CD
                     ,T2.ECLZ_OBL_CPY_FLG
                     ,T2.BTM_RMK
               FROM   BKG_PKUP_NTC_STUP T1
                     ,BKG_PKUP_WD       T2
               WHERE  T1.PKUP_NTC_SND_TP_CD = 'A'
               AND    T1.OFC_CD             = @[fm_ofc_cd]
               AND    T1.DEL_CD             = DECODE(nvl(@[fm_del_cd],'ALL'),'ALL','*',@[fm_del_cd])
               AND    T2.PKUP_NTC_SEQ(+)    = T1.PKUP_NTC_SEQ
              ) T1
             ,(SELECT DECODE(LEVEL,1,'PRE','ARR') AS FOM_CD FROM DUAL CONNECT BY LEVEL<=2) T2
       WHERE  T1.PKUP_NTC_FOM_CD(+) = T2.FOM_CD
      ) B
ON (A.PKUP_NTC_SEQ = B.PKUP_NTC_SEQ
    AND A.PKUP_NTC_FOM_CD = B.PKUP_NTC_FOM_CD
   )

WHEN MATCHED THEN

UPDATE SET
	ECLZ_OBL_CPY_FLG = B.ECLZ_OBL_CPY_FLG
   ,BTM_RMK          = B.BTM_RMK
   ,UPD_USR_ID       = B.UPD_USR_ID
   ,UPD_DT           = SYSDATE

WHEN NOT MATCHED THEN

INSERT (
	PKUP_NTC_SEQ
,	PKUP_NTC_FOM_CD
,	ECLZ_OBL_CPY_FLG
,	BTM_RMK
,	CRE_USR_ID
,	CRE_DT
,	UPD_USR_ID
,	UPD_DT
) VALUES( 
	B.PKUP_NTC_SEQ
,	B.PKUP_NTC_FOM_CD
,	B.ECLZ_OBL_CPY_FLG
,	B.BTM_RMK
,	B.CRE_USR_ID
,	SYSDATE
,	B.UPD_USR_ID
,	SYSDATE
)			]]></sql>
			<params>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="del_cd" type="12" value="" out="N"/>
				<param name="fm_ofc_cd" type="12" value="" out="N"/>
				<param name="fm_del_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
