<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ExternalFinderDBDAOSearchCheckAcctCdVvdLevelRSQL">
			<desc><![CDATA[ExternalFinderDBDAOSearchCheckAcctCdVvdLevelRSQL]]></desc>
			<sql><![CDATA[
SELECT DECODE(SUM(COUNT(*)),0,NULL,SUM(COUNT(*))) VSL_CD
  FROM (
		SELECT
			   VSL_CD
		  FROM AR_MST_REV_VVD
		 WHERE VSL_CD = SUBSTR(@[vvd_cd],1,4)
   		   AND SKD_VOY_NO = SUBSTR(@[vvd_cd],5,4)
   		   AND SKD_DIR_CD = SUBSTR(@[vvd_cd],9,1)
   		   AND RLANE_DIR_CD = SUBSTR(@[vvd_cd],10,1)
		   AND DELT_FLG = 'N'
		UNION ALL
		SELECT DISTINCT 'OK'
		  FROM AR_MST_REV_VVD A
		 WHERE A.VSL_CD = SUBSTR(@[vvd_cd],1,4)
		   AND A.SKD_VOY_NO = SUBSTR(@[vvd_cd],5,4)
		   AND A.SKD_DIR_CD = SUBSTR(@[vvd_cd],9,1)
		   AND EXISTS (SELECT 'Y'
		   			     FROM MDM_ACCOUNT B
		                WHERE B.ACCT_CD = @[acct_cd]
		                  AND A.VVD_COM_LVL IN (DECODE(B.VVD_LVL_FLG1, 'Y', '1', ''),
		                                        DECODE(B.VVD_LVL_FLG2, 'Y', '2', ''),
		                                        DECODE(B.VVD_LVL_FLG3, 'Y', '3', ''),
		                                        DECODE(B.VVD_LVL_FLG4, 'Y', '4', ''),
		                                        DECODE(B.VVD_LVL_FLG5, 'Y', '5', ''),
		                                        DECODE(B.VVD_LVL_FLG6, 'Y', '6', '')
		                                        )
		               )
   		) GROUP BY VSL_CD			]]></sql>
			<params>
				<param name="vvd_cd" type="12" value="" out="N"/>
				<param name="acct_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
