<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ModelManageDBDAOSearchSmpCustOldDataRSQL">
			<desc><![CDATA[SMP Cust History를 위해 old 값을 조회합니다.
[CHM-201322502-01] SPC 프로젝트 - 성수기 선복운영 개선을 위한 T/F추진
2014.02.04 [CHM-201428383-01] RFA 로직 추가
2014.05.16 [CHM-201430353] SMP / AES 보완요청 - SC 입력 기능 추가]]></desc>
			<sql><![CDATA[
SELECT A.TRD_CD
      ,A.COST_YRWK
      ,A.VER_SEQ
      ,A.CUST_CD
      ,A.SC_NO
      ,A.RFA_NO
      ,A.CUST_CTRL_CD
      ,A.WK_MQC_QTY
      ,A.CUST_CD AS OLD_CUST_CD
      ,A.SC_NO   AS OLD_SC_NO
      ,A.RFA_NO  AS OLD_RFA_NO
      ,B.OLD_CUST_CTRL_CD
      ,B.OLD_WK_MQC_QTY
  FROM (SELECT @[trade]        AS TRD_CD
              ,@[cost_yrwk]    AS COST_YRWK
              ,@[ver_seq]      AS VER_SEQ
              ,@[cust_cd]      AS CUST_CD
              ,@[sc_no]        AS SC_NO
              ,@[rfa_no]       AS RFA_NO
              ,@[cust_ctrl_cd] AS CUST_CTRL_CD
              ,@[wk_mqc_qty]   AS WK_MQC_QTY
          FROM DUAL) A,
       (SELECT MAX(CUST_CTRL_CD) AS OLD_CUST_CTRL_CD
              ,MAX(WK_MQC_QTY)   AS OLD_WK_MQC_QTY
          FROM SPC_MDL_CUST_CTRL
         WHERE TRD_CD           = @[trade]
           AND COST_YRWK        = @[cost_yrwk]
           AND VER_SEQ          = @[old_ver]
           AND CUST_CNT_CD      = SUBSTR(@[cust_cd], 1, 2)
           AND CUST_SEQ         = SUBSTR(@[cust_cd], 3)
           AND NVL(RFA_NO, ' ') = NVL(@[rfa_no], ' ')
           AND NVL(SC_NO , ' ') = NVL(@[sc_no] , NVL(SC_NO, ' '))
        ) B			]]></sql>
			<params>
				<param name="trade" type="12" value="" out="N"/>
				<param name="cost_yrwk" type="12" value="" out="N"/>
				<param name="ver_seq" type="12" value="" out="N"/>
				<param name="cust_cd" type="12" value="" out="N"/>
				<param name="sc_no" type="12" value="" out="N"/>
				<param name="rfa_no" type="12" value="" out="N"/>
				<param name="cust_ctrl_cd" type="12" value="" out="N"/>
				<param name="wk_mqc_qty" type="12" value="" out="N"/>
				<param name="old_ver" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
