<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="QtaInquiryDBDAOSearchCurrQtaReptIasSectorPreviousVersionYearlyRSQL">
			<desc><![CDATA[QtaInquiryDBDAOSearchCurrQtaReptIasSectorPreviousVersionYearly]]></desc>
			<sql><![CDATA[
###if (${f_chk_week} == 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} != 'Y' && ${f_ofc_lvl} == '03')
#if (${f_chk_week} == 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} != 'Y')
SELECT BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
,BSE_WK
--,VVD
#if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
,RHQ_CD
#if (${f_ofc_lvl} == '03')
,RGN_OFC_CD
#end
#end
--,POL_CD
--,POD_CD
--,SQM_MN_SCTR_FLG  
,SUM(TOT_BSA_CAPA) AS TOT_BSA_CAPA
,SUM(LOD_QTY) AS LOD_QTY
,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
,SUM(GRS_REV) AS GRS_REV
,SUM(PA_CM_COST) AS PA_CM_COST
,SUM(RA_CM_COST) AS RA_CM_COST
,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
,SUM(PA_CM) AS PA_CM
,SUM(RA_CM) AS RA_CM
,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
FROM
(
    SELECT BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    ,BSE_WK
    ,VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    --,POL_CD
    --,POD_CD
    --,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA
    ,SUM(LOD_QTY) AS LOD_QTY
    ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
    ,SUM(GRS_REV) AS GRS_REV
    ,SUM(PA_CM_COST) AS PA_CM_COST
    ,SUM(RA_CM_COST) AS RA_CM_COST
    ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
    ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
    ,SUM(PA_CM) AS PA_CM
    ,SUM(RA_CM) AS RA_CM
    ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
    ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
    FROM
    (
###elseif (${f_chk_week} == 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} != 'Y' && ${f_ofc_lvl} == '03')
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} != 'Y')
    SELECT BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    ,BSE_WK
    ,VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    --,POL_CD
    --,POD_CD
    --,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA 
    ,SUM(LOD_QTY) AS LOD_QTY
    ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
    ,SUM(GRS_REV) AS GRS_REV
    ,SUM(PA_CM_COST) AS PA_CM_COST
    ,SUM(RA_CM_COST) AS RA_CM_COST
    ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
    ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
    ,SUM(PA_CM) AS PA_CM
    ,SUM(RA_CM) AS RA_CM
    ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
    ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
    FROM
    (
###elseif (${f_chk_week} != 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} != 'Y' && ${f_ofc_lvl} == '03')
#elseif (${f_chk_week} != 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} != 'Y')
    SELECT BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
--    ,BSE_WK
    ,VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    --,POL_CD
    --,POD_CD
    --,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA 
    ,SUM(LOD_QTY) AS LOD_QTY
    ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
    ,SUM(GRS_REV) AS GRS_REV
    ,SUM(PA_CM_COST) AS PA_CM_COST
    ,SUM(RA_CM_COST) AS RA_CM_COST
    ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
    ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
    ,SUM(PA_CM) AS PA_CM
    ,SUM(RA_CM) AS RA_CM
    ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
    ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
    FROM
    (
###elseif (${f_chk_week} != 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} != 'Y' && ${f_ofc_lvl} == '03')
#elseif (${f_chk_week} != 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} != 'Y')
SELECT BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
--    ,BSE_WK
--    ,VVD
#if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
,RHQ_CD
#if (${f_ofc_lvl} == '03')
,RGN_OFC_CD
#end
#end
    --,POL_CD
    --,POD_CD
    --,SQM_MN_SCTR_FLG  
,SUM(TOT_BSA_CAPA) AS TOT_BSA_CAPA
,SUM(LOD_QTY) AS LOD_QTY
,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
,SUM(GRS_REV) AS GRS_REV
,SUM(PA_CM_COST) AS PA_CM_COST
,SUM(RA_CM_COST) AS RA_CM_COST
,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
,SUM(PA_CM) AS PA_CM
,SUM(RA_CM) AS RA_CM
,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
FROM
(
    SELECT BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    --    ,BSE_WK
    ,VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    --,POL_CD
    --,POD_CD
    --,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA 
    ,SUM(LOD_QTY) AS LOD_QTY
    ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
    ,SUM(GRS_REV) AS GRS_REV
    ,SUM(PA_CM_COST) AS PA_CM_COST
    ,SUM(RA_CM_COST) AS RA_CM_COST
    ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
    ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
    ,SUM(PA_CM) AS PA_CM
    ,SUM(RA_CM) AS RA_CM
    ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
    ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
    FROM
    (
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '03')
    SELECT BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    ,BSE_WK
--    ,VVD
	,RHQ_CD
	,RGN_OFC_CD
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
    ,SUM(TOT_BSA_CAPA) AS TOT_BSA_CAPA
    ,SUM(LOD_QTY) AS LOD_QTY
    ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
    ,SUM(GRS_REV) AS GRS_REV
    ,SUM(PA_CM_COST) AS PA_CM_COST
    ,SUM(RA_CM_COST) AS RA_CM_COST
    ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
    ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
    ,SUM(PA_CM) AS PA_CM
    ,SUM(RA_CM) AS RA_CM
    ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
    ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
    FROM
    (
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '02')
SELECT BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
,BSE_WK
--,VVD
,RHQ_CD
--,RGN_OFC_CD
,POL_CD
,POD_CD
,SQM_MN_SCTR_FLG  
,SUM(TOT_BSA_CAPA) AS TOT_BSA_CAPA
,SUM(LOD_QTY) AS LOD_QTY
,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
,SUM(GRS_REV) AS GRS_REV
,SUM(PA_CM_COST) AS PA_CM_COST
,SUM(RA_CM_COST) AS RA_CM_COST
,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
,SUM(PA_CM) AS PA_CM
,SUM(RA_CM) AS RA_CM
,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
FROM
(
    SELECT BSE_YR
        ,BSE_QTR_CD
        ,OFC_VW_CD
        ,TRD_CD
        ,SUB_TRD_CD
        ,IAS_RGN_CD
        ,RLANE_CD
        ,DIR_CD
        ,HUL_BND_CD
        ,BSE_MON                 
        ,BSE_WK
        ,VVD
        ,RHQ_CD
        --,RGN_OFC_CD
        ,POL_CD
        ,POD_CD
        ,SQM_MN_SCTR_FLG  
        ,TOT_BSA_CAPA
        ,SUM(LOD_QTY) AS LOD_QTY
        ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
        ,SUM(GRS_REV) AS GRS_REV
        ,SUM(PA_CM_COST) AS PA_CM_COST
        ,SUM(RA_CM_COST) AS RA_CM_COST
        ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
        ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
        ,SUM(PA_CM) AS PA_CM
        ,SUM(RA_CM) AS RA_CM
        ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
        ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
        FROM
        (
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '01')
SELECT BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
,BSE_WK
--,VVD
--,RHQ_CD
--,RGN_OFC_CD
,POL_CD
,POD_CD
,SQM_MN_SCTR_FLG  
,SUM(TOT_BSA_CAPA) AS TOT_BSA_CAPA
,SUM(LOD_QTY) AS LOD_QTY
,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
,SUM(GRS_REV) AS GRS_REV
,SUM(PA_CM_COST) AS PA_CM_COST
,SUM(RA_CM_COST) AS RA_CM_COST
,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
,SUM(PA_CM) AS PA_CM
,SUM(RA_CM) AS RA_CM
,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
FROM
(
    SELECT BSE_YR
        ,BSE_QTR_CD
        ,OFC_VW_CD
        ,TRD_CD
        ,SUB_TRD_CD
        ,IAS_RGN_CD
        ,RLANE_CD
        ,DIR_CD
        ,HUL_BND_CD
        ,BSE_MON                 
        ,BSE_WK
        ,VVD
    --    ,RHQ_CD
        --,RGN_OFC_CD
        ,POL_CD
        ,POD_CD
        ,SQM_MN_SCTR_FLG  
        ,TOT_BSA_CAPA
        ,SUM(LOD_QTY) AS LOD_QTY
        ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
        ,SUM(GRS_REV) AS GRS_REV
        ,SUM(PA_CM_COST) AS PA_CM_COST
        ,SUM(RA_CM_COST) AS RA_CM_COST
        ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
        ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
        ,SUM(PA_CM) AS PA_CM
        ,SUM(RA_CM) AS RA_CM
        ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
        ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
        FROM
        (
#elseif (${f_chk_week} != 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '03')
SELECT BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
--,BSE_WK
--    ,VVD
,RHQ_CD
,RGN_OFC_CD
,POL_CD
,POD_CD
,SQM_MN_SCTR_FLG  
,SUM(TOT_BSA_CAPA) AS TOT_BSA_CAPA
,SUM(LOD_QTY) AS LOD_QTY
,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
,SUM(GRS_REV) AS GRS_REV
,SUM(PA_CM_COST) AS PA_CM_COST
,SUM(RA_CM_COST) AS RA_CM_COST
,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
,SUM(PA_CM) AS PA_CM
,SUM(RA_CM) AS RA_CM
,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
FROM
(
    SELECT BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    ,BSE_WK
--    ,VVD
	,RHQ_CD
	,RGN_OFC_CD
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
    ,SUM(TOT_BSA_CAPA) AS TOT_BSA_CAPA
    ,SUM(LOD_QTY) AS LOD_QTY
    ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
    ,SUM(GRS_REV) AS GRS_REV
    ,SUM(PA_CM_COST) AS PA_CM_COST
    ,SUM(RA_CM_COST) AS RA_CM_COST
    ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
    ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
    ,SUM(PA_CM) AS PA_CM
    ,SUM(RA_CM) AS RA_CM
    ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
    ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
    FROM
    (
#elseif (${f_chk_week} != 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '02')
SELECT BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
--,BSE_WK
--,VVD
,RHQ_CD
,POL_CD
,POD_CD
,SQM_MN_SCTR_FLG  
,SUM(TOT_BSA_CAPA) AS TOT_BSA_CAPA
,SUM(LOD_QTY) AS LOD_QTY
,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
,SUM(GRS_REV) AS GRS_REV
,SUM(PA_CM_COST) AS PA_CM_COST
,SUM(RA_CM_COST) AS RA_CM_COST
,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
,SUM(PA_CM) AS PA_CM
,SUM(RA_CM) AS RA_CM
,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
FROM
(
SELECT BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    --,BSE_WK
    ,VVD
    ,RHQ_CD
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA
    ,SUM(LOD_QTY) AS LOD_QTY
    ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
    ,SUM(GRS_REV) AS GRS_REV
    ,SUM(PA_CM_COST) AS PA_CM_COST
    ,SUM(RA_CM_COST) AS RA_CM_COST
    ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
    ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
    ,SUM(PA_CM) AS PA_CM
    ,SUM(RA_CM) AS RA_CM
    ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
    ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
    FROM
    (
#elseif (${f_chk_week} != 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '01')
SELECT BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
--,BSE_WK
--,VVD
,POL_CD
,POD_CD
,SQM_MN_SCTR_FLG  
,SUM(TOT_BSA_CAPA) AS TOT_BSA_CAPA
,SUM(LOD_QTY) AS LOD_QTY
,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
,SUM(GRS_REV) AS GRS_REV
,SUM(PA_CM_COST) AS PA_CM_COST
,SUM(RA_CM_COST) AS RA_CM_COST
,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
,SUM(PA_CM) AS PA_CM
,SUM(RA_CM) AS RA_CM
,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
FROM
(
SELECT BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    --,BSE_WK
    ,VVD
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA
    ,SUM(LOD_QTY) AS LOD_QTY
    ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
    ,SUM(GRS_REV) AS GRS_REV
    ,SUM(PA_CM_COST) AS PA_CM_COST
    ,SUM(RA_CM_COST) AS RA_CM_COST
    ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
    ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
    ,SUM(PA_CM) AS PA_CM
    ,SUM(RA_CM) AS RA_CM
    ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
    ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
    FROM
    (
###elseif (${f_chk_week} != 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '03')
#elseif (${f_chk_week} != 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} == 'Y')
    SELECT BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    --,BSE_WK
    ,VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA
    ,SUM(LOD_QTY) AS LOD_QTY
    ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
    ,SUM(GRS_REV) AS GRS_REV
    ,SUM(PA_CM_COST) AS PA_CM_COST
    ,SUM(RA_CM_COST) AS RA_CM_COST
    ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
    ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
    ,SUM(PA_CM) AS PA_CM
    ,SUM(RA_CM) AS RA_CM
    ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
    ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
    FROM
    (
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '02')
    SELECT BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    ,BSE_WK
    ,VVD
    ,RHQ_CD
    --,RGN_OFC_CD
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA
    ,SUM(LOD_QTY) AS LOD_QTY
    ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
    ,SUM(GRS_REV) AS GRS_REV
    ,SUM(PA_CM_COST) AS PA_CM_COST
    ,SUM(RA_CM_COST) AS RA_CM_COST
    ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
    ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
    ,SUM(PA_CM) AS PA_CM
    ,SUM(RA_CM) AS RA_CM
    ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
    ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
    FROM
    (
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '01')
    SELECT BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    ,BSE_WK
    ,VVD
--    ,RHQ_CD
    --,RGN_OFC_CD
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA
    ,SUM(LOD_QTY) AS LOD_QTY
    ,NVL((SUM(GRS_REV)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS REV_RPB
    ,SUM(GRS_REV) AS GRS_REV
    ,SUM(PA_CM_COST) AS PA_CM_COST
    ,SUM(RA_CM_COST) AS RA_CM_COST
    ,NVL((SUM(PA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMCB
    ,NVL((SUM(RA_CM_COST)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMCB
    ,SUM(PA_CM) AS PA_CM
    ,SUM(RA_CM) AS RA_CM
    ,NVL((SUM(PA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS PA_CMPB
    ,NVL((SUM(RA_CM)/DECODE(SUM(LOD_QTY), 0, NULL, SUM(LOD_QTY))),0) AS RA_CMPB
    FROM
    (
#end 


        SELECT DISTINCT
                  '20'||SUBSTR(BSE_YR,-2) AS BSE_YR
				#if (${f_year_tp_cd} =='C') 
                  ,DECODE(BSE_QTR_CD, 'L', 'Y', 'C', 'Y', SUBSTR(BSE_QTR_CD,1,1)||'Q') AS BSE_QTR_CD
				#end 
                  ,DECODE(OFC_VW_CD, 'L', 'Loading', 'C', 'Contract', OFC_VW_CD) AS OFC_VW_CD
                  ,TRD_CD
                  ,SUB_TRD_CD
                  ,DECODE(IAS_RGN_CD, 'AU', 'Austrailia', 'AF', 'Africa', 'FD', 'Feeder', 'IN', 'India', 'IA', 'Intra Asia', 'ME', 'Middle East', 'RS', 'Red Sea') AS IAS_RGN_CD
                  ,RLANE_CD
                  ,DIR_CD
                  ,DECODE(HUL_BND_CD, 'HH', 'H/H', 'BH', 'B/H') HUL_BND_CD
                  ,BSE_MON   
                  ,BSE_WK    
                  ,VSL_CD||SKD_VOY_NO||SKD_DIR_CD AS VVD
				  ,TTL_BSA_CAPA AS TOT_BSA_CAPA 
                  ,RHQ_CD
                  ,RGN_OFC_CD
                  ,POL_CD
                  ,POD_CD
                  ,DECODE(NVL(SQM_MN_SCTR_FLG, 'N'), 'Y', 'Main', 'N', 'Sector') AS SQM_MN_SCTR_FLG                    
                  ,LOD_QTY
                  ,GRS_RPB_REV AS REV_RPB
                  ,GRS_REV
                  ,PA_CM_COST_AMT AS PA_CM_COST
                  ,RA_CM_COST_AMT AS RA_CM_COST
                  ,PA_CM_COST_PER_BX_AMT AS PA_CMCB
                  ,RA_CM_COST_PER_BX_AMT AS RA_CMCB
                  ,PA_CM_AMT AS PA_CM
                  ,RA_CM_AMT AS RA_CM
                  ,PA_CM_PER_BX_AMT AS PA_CMPB 
                  ,RA_CM_PER_BX_AMT AS RA_CMPB 
            FROM SQM_RPT_DAT_BKUP 
            WHERE 1=1
            AND CONV_DIR_CD = @[f_year_tp_cd] -- CONV_DIR_CD에 Currently Updated 데이터인지, Initially Fixed 데이터인지 정보를 담아줌(C: Currently Updated, I: Initially Fixed)
            AND TRD_CD       = 'IAS'
            AND LOD_QTY != 0
            #if (${f_fm_wk} != '' && ${f_to_wk} != '') 
            AND BSE_WK BETWEEN ${f_fm_wk} AND ${f_to_wk}
            #end 
            #if (${f_fm_mon} != '' && ${f_to_mon} != '') 
            AND BSE_MON BETWEEN ${f_fm_mon} AND ${f_to_mon}
            #end --13e
            #if (${f_trd_dir} != 'on' && ${f_dir_cd} != '' && ${f_dir_cd} != 'All')
            AND DIR_CD     = @[f_dir_cd]
            #end 
            AND BSE_TP_CD = @[f_bse_tp_cd]
            AND BSE_YR = 'SY'||SUBSTR(@[f_bse_yr],-2)
            AND OFC_VW_CD = @[f_ofc_vw_cd]
            #if (${f_sub_trd_cd} != '' && ${f_sub_trd_cd} != 'All') 
            AND SUB_TRD_CD = @[f_sub_trd_cd]
            #end 
            #if (${f_rlane_cd} != '' && ${f_rlane_cd} != 'All') 
            AND RLANE_CD = @[f_rlane_cd]
            #end 
            #if (${f_trd_dir} != 'on' && ${f_dir_cd} != '' && ${f_dir_cd} != 'All') 
            AND DIR_CD   = @[f_dir_cd]
            #end 
            #if (${f_ofc_lvl} != '01' && ${f_rhq_cd} != '' && ${f_rhq_cd} != 'All') 
            AND RHQ_CD          = @[f_rhq_cd]
            #end 
            #if (${f_ofc_lvl} == '03' && ${f_rgn_ofc_cd} != '' && ${f_rgn_ofc_cd} != 'All') 
            AND RGN_OFC_CD      = @[f_rgn_ofc_cd]
            #end 
            #if (${f_pol_cd} != '' && ${f_pol_cd} != 'All') 
            AND POL_CD = @[f_pol_cd]
            #end 
            #if (${f_pod_cd} != '' && ${f_pod_cd} != 'All') 
            AND POD_CD = @[f_pod_cd]
            #end
            #if (${f_ias_rgn_cd} != '' && ${f_ias_rgn_cd} != 'All') 
            AND IAS_RGN_CD  = @[f_ias_rgn_cd]
            #end 
            #if (${f_trd_dir} == 'on' && ${f_hul_bnd_cd} != '' && ${f_hul_bnd_cd} != 'All') 
            AND HUL_BND_CD  = @[f_hul_bnd_cd]
            #end 
            #if (${f_sqm_mn_sctr_flg} != '' && ${f_sqm_mn_sctr_flg} != 'All') 
            AND NVL(SQM_MN_SCTR_FLG, 'N') = @[f_sqm_mn_sctr_flg]
            #end 
            ORDER BY SUB_TRD_CD
            , IAS_RGN_CD
            , RLANE_CD
            , DIR_CD
            , BSE_MON
            , BSE_WK
            , VVD
            , RHQ_CD, RGN_OFC_CD
            , POL_CD
            , POD_CD
            

###elseif (${f_chk_week} == 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} != 'Y' && ${f_ofc_lvl} == '03')
#if (${f_chk_week} == 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} != 'Y')
    )
    GROUP BY BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    ,BSE_WK
    ,VVD
#if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
    ,RHQ_CD
#if (${f_ofc_lvl} == '03')
    ,RGN_OFC_CD
#end
#end
    --,POL_CD
    --,POD_CD
    --,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA 
    ORDER BY SUB_TRD_CD
    , IAS_RGN_CD
    , RLANE_CD
    , DIR_CD
    , BSE_MON  
    , BSE_WK
    , VVD
#if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
    ,RHQ_CD
#if (${f_ofc_lvl} == '03')
    ,RGN_OFC_CD
#end
#end
    --, POL_CD
    --, POD_CD
)
GROUP BY BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
,BSE_WK
--    ,VVD
#if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
    ,RHQ_CD
#if (${f_ofc_lvl} == '03')
    ,RGN_OFC_CD
#end
#end
    --,POL_CD
    --,POD_CD
    --,SQM_MN_SCTR_FLG  
--    ,TOT_BSA_CAPA 
ORDER BY SUB_TRD_CD
, IAS_RGN_CD
, RLANE_CD
, DIR_CD
, BSE_MON  
, BSE_WK
--    , VVD
#if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
    ,RHQ_CD
#if (${f_ofc_lvl} == '03')
    ,RGN_OFC_CD
#end
#end
    --, POL_CD
    --, POD_CD

###elseif (${f_chk_week} != 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '03')
#elseif (${f_chk_week} != 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} == 'Y')
    )
    GROUP BY BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    --,BSE_WK
    ,VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
    ,RHQ_CD
    #if (${f_ofc_lvl} == '03')
    ,RGN_OFC_CD
    #end
    #end
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA 
    ORDER BY SUB_TRD_CD
    , IAS_RGN_CD
    , RLANE_CD
    , DIR_CD
    , BSE_MON    
    --, BSE_WK
    , VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
    ,RHQ_CD
    #if (${f_ofc_lvl} == '03')
    ,RGN_OFC_CD
    #end
    #end
    , POL_CD
    , POD_CD
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '02')
    )
    GROUP BY BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    ,BSE_WK
    ,VVD
    ,RHQ_CD
    --,RGN_OFC_CD
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA 
    ORDER BY SUB_TRD_CD
    , IAS_RGN_CD
    , RLANE_CD
    , DIR_CD
    , BSE_MON  
    , BSE_WK
    , VVD
    , RHQ_CD
    --, RGN_OFC_CD
    , POL_CD
    , POD_CD
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '01')
    )
    GROUP BY BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    ,BSE_WK
    ,VVD
--    ,RHQ_CD
    --,RGN_OFC_CD
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA 
    ORDER BY SUB_TRD_CD
    , IAS_RGN_CD
    , RLANE_CD
    , DIR_CD
    , BSE_MON    
    , BSE_WK
    , VVD
--    , RHQ_CD
    --, RGN_OFC_CD
    , POL_CD
    , POD_CD
###elseif (${f_chk_week} == 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} != 'Y' && ${f_ofc_lvl} == '03')
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} != 'Y')
    )
    GROUP BY BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    ,BSE_WK
    ,VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    --,POL_CD
    --,POD_CD
    --,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA 
    ORDER BY SUB_TRD_CD
    , IAS_RGN_CD
    , RLANE_CD
    , DIR_CD
    , BSE_MON     
    , BSE_WK
    , VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    --, POL_CD
    --, POD_CD
###elseif (${f_chk_week} != 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} != 'Y' && ${f_ofc_lvl} == '03')
#elseif (${f_chk_week} != 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} != 'Y')
    )
    GROUP BY BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
--    ,BSE_WK
    ,VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    --,POL_CD
    --,POD_CD
    --,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA 
    ORDER BY SUB_TRD_CD
    , IAS_RGN_CD
    , RLANE_CD
    , DIR_CD
    , BSE_MON    
--    , BSE_WK
    , VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    --, POL_CD
    --, POD_CD
###elseif (${f_chk_week} != 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} != 'Y' && ${f_ofc_lvl} == '03')
#elseif (${f_chk_week} != 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} != 'Y')
    )
    GROUP BY BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
--    ,BSE_WK
    ,VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    --,POL_CD
    --,POD_CD
    --,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA 
    ORDER BY SUB_TRD_CD
    , IAS_RGN_CD
    , RLANE_CD
    , DIR_CD
    , BSE_MON     
--    , BSE_WK
    , VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    --, POL_CD
    --, POD_CD
)
GROUP BY BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
--    ,BSE_WK
--    ,VVD
#if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
,RHQ_CD
#if (${f_ofc_lvl} == '03')
,RGN_OFC_CD
#end
#end
    --,POL_CD
    --,POD_CD
    --,SQM_MN_SCTR_FLG  
--    ,TOT_BSA_CAPA 
ORDER BY SUB_TRD_CD
, IAS_RGN_CD
, RLANE_CD
, DIR_CD
, BSE_MON    
--    , BSE_WK
--    , VVD
#if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
,RHQ_CD
#if (${f_ofc_lvl} == '03')
,RGN_OFC_CD
#end
#end
    --, POL_CD
    --, POD_CD
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '03')
    )
    GROUP BY BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    ,BSE_WK
--    ,VVD
	,RHQ_CD
	,RGN_OFC_CD
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
--    ,TOT_BSA_CAPA 
    ORDER BY SUB_TRD_CD
    , IAS_RGN_CD
    , RLANE_CD
    , DIR_CD
    , BSE_MON
    , BSE_WK
--    , VVD
	,RHQ_CD
	,RGN_OFC_CD
    , POL_CD
    , POD_CD
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '02')
)
        GROUP BY BSE_YR
        ,BSE_QTR_CD
        ,OFC_VW_CD
        ,TRD_CD
        ,SUB_TRD_CD
        ,IAS_RGN_CD
        ,RLANE_CD
        ,DIR_CD
        ,HUL_BND_CD
        ,BSE_MON                 
        ,BSE_WK
        ,VVD
        ,RHQ_CD
        --,RGN_OFC_CD
        ,POL_CD
        ,POD_CD
        ,SQM_MN_SCTR_FLG  
        ,TOT_BSA_CAPA 
        ORDER BY SUB_TRD_CD
        , IAS_RGN_CD
        , RLANE_CD
        , DIR_CD
        , BSE_MON   
        , BSE_WK
        , VVD
        , RHQ_CD
        --, RGN_OFC_CD
        , POL_CD
        , POD_CD
)
GROUP BY BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
,BSE_WK
--,VVD
,RHQ_CD
--,RGN_OFC_CD
,POL_CD
,POD_CD
,SQM_MN_SCTR_FLG  
--,TOT_BSA_CAPA 
ORDER BY SUB_TRD_CD
, IAS_RGN_CD
, RLANE_CD
, DIR_CD
, BSE_MON  
, BSE_WK
--, VVD
, RHQ_CD
--, RGN_OFC_CD
, POL_CD
, POD_CD
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '01')
        )
        GROUP BY BSE_YR
        ,BSE_QTR_CD
        ,OFC_VW_CD
        ,TRD_CD
        ,SUB_TRD_CD
        ,IAS_RGN_CD
        ,RLANE_CD
        ,DIR_CD
        ,HUL_BND_CD
        ,BSE_MON                 
        ,BSE_WK
        ,VVD
    --    ,RHQ_CD
        --,RGN_OFC_CD
        ,POL_CD
        ,POD_CD
        ,SQM_MN_SCTR_FLG  
        ,TOT_BSA_CAPA 
        ORDER BY SUB_TRD_CD
        , IAS_RGN_CD
        , RLANE_CD
        , DIR_CD
        , BSE_MON   
        , BSE_WK
        , VVD
    --    , RHQ_CD
        --, RGN_OFC_CD
        , POL_CD
        , POD_CD
)
GROUP BY BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
,BSE_WK
--,VVD
--,RHQ_CD
--,RGN_OFC_CD
,POL_CD
,POD_CD
,SQM_MN_SCTR_FLG  
--,TOT_BSA_CAPA 
ORDER BY SUB_TRD_CD
, IAS_RGN_CD
, RLANE_CD
, DIR_CD
, BSE_MON   
, BSE_WK
--, VVD
--, RHQ_CD
--, RGN_OFC_CD
, POL_CD
, POD_CD
###elseif (${f_chk_week} == 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} != 'Y' && ${f_ofc_lvl} == '03')
#elseif (${f_chk_week} == 'W' && ${f_chk_vvd} == 'V' && ${f_chk_pair} != 'Y')
    )
    GROUP BY BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
--    ,BSE_WK
    ,VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    --,POL_CD
    --,POD_CD
    --,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA 
    ORDER BY SUB_TRD_CD
    , IAS_RGN_CD
    , RLANE_CD
    , DIR_CD
    , BSE_MON
--    , BSE_WK
    , VVD
    #if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
	,RHQ_CD
	#if (${f_ofc_lvl} == '03')
	,RGN_OFC_CD
	#end
	#end
    --, POL_CD
    --, POD_CD
)
GROUP BY BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
--,BSE_WK
--    ,VVD
#if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
,RHQ_CD
#if (${f_ofc_lvl} == '03')
,RGN_OFC_CD
#end
#end
,POL_CD
,POD_CD
,SQM_MN_SCTR_FLG  
--    ,TOT_BSA_CAPA 
ORDER BY SUB_TRD_CD
, IAS_RGN_CD
, RLANE_CD
, DIR_CD
, BSE_MON  
--, BSE_WK
--    , VVD
#if (${f_ofc_lvl} == '02' || ${f_ofc_lvl} == '03')
,RHQ_CD
#if (${f_ofc_lvl} == '03')
,RGN_OFC_CD
#end
#end
, POL_CD
, POD_CD
#elseif (${f_chk_week} != 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '03')
    )
    GROUP BY BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    ,BSE_WK
--    ,VVD
	,RHQ_CD
	,RGN_OFC_CD
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
--    ,TOT_BSA_CAPA 
    ORDER BY SUB_TRD_CD
    , IAS_RGN_CD
    , RLANE_CD
    , DIR_CD
    , BSE_MON     
    , BSE_WK
--    , VVD
	,RHQ_CD
	,RGN_OFC_CD
    , POL_CD
    , POD_CD
)
GROUP BY BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
--,BSE_WK
--    ,VVD
,RHQ_CD
,RGN_OFC_CD
,POL_CD
,POD_CD
,SQM_MN_SCTR_FLG  
--    ,TOT_BSA_CAPA 
ORDER BY SUB_TRD_CD
, IAS_RGN_CD
, RLANE_CD
, DIR_CD
, BSE_MON  
--, BSE_WK
--    , VVD
,RHQ_CD
,RGN_OFC_CD
, POL_CD
, POD_CD
#elseif (${f_chk_week} != 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '02')
)
GROUP BY BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
--,BSE_WK
,VVD
,RHQ_CD
,POL_CD
,POD_CD
,SQM_MN_SCTR_FLG  
,TOT_BSA_CAPA 
ORDER BY SUB_TRD_CD
, IAS_RGN_CD
, RLANE_CD
, DIR_CD
, BSE_MON    
--, BSE_WK
, VVD
,RHQ_CD
, POL_CD
, POD_CD
)
GROUP BY BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    --,BSE_WK
--    ,VVD
    ,RHQ_CD
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
--    ,TOT_BSA_CAPA 
    ORDER BY SUB_TRD_CD
    , IAS_RGN_CD
    , RLANE_CD
    , DIR_CD
    , BSE_MON     
    --, BSE_WK
--    , VVD
    ,RHQ_CD
    , POL_CD
    , POD_CD
#elseif (${f_chk_week} != 'W' && ${f_chk_vvd} != 'V' && ${f_chk_pair} == 'Y' && ${f_ofc_lvl} == '01')
    )
    GROUP BY BSE_YR
    ,BSE_QTR_CD
    ,OFC_VW_CD
    ,TRD_CD
    ,SUB_TRD_CD
    ,IAS_RGN_CD
    ,RLANE_CD
    ,DIR_CD
    ,HUL_BND_CD
    ,BSE_MON                 
    --,BSE_WK
    ,VVD
    ,POL_CD
    ,POD_CD
    ,SQM_MN_SCTR_FLG  
    ,TOT_BSA_CAPA 
    ORDER BY SUB_TRD_CD
    , IAS_RGN_CD
    , RLANE_CD
    , DIR_CD
    , BSE_MON     
    --, BSE_WK
    , VVD
    , POL_CD
    , POD_CD
)
GROUP BY BSE_YR
,BSE_QTR_CD
,OFC_VW_CD
,TRD_CD
,SUB_TRD_CD
,IAS_RGN_CD
,RLANE_CD
,DIR_CD
,HUL_BND_CD
,BSE_MON                 
--,BSE_WK
--,VVD
,POL_CD
,POD_CD
,SQM_MN_SCTR_FLG  
--,TOT_BSA_CAPA 
ORDER BY SUB_TRD_CD
, IAS_RGN_CD
, RLANE_CD
, DIR_CD
, BSE_MON     
--, BSE_WK
--, VVD
, POL_CD
, POD_CD
#end			]]></sql>
			<params>
				<param name="f_year_tp_cd" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_bse_tp_cd" type="12" value="" out="N"/>
				<param name="f_bse_yr" type="12" value="" out="N"/>
				<param name="f_ofc_vw_cd" type="12" value="" out="N"/>
				<param name="f_sub_trd_cd" type="12" value="" out="N"/>
				<param name="f_rlane_cd" type="12" value="" out="N"/>
				<param name="f_rhq_cd" type="12" value="" out="N"/>
				<param name="f_rgn_ofc_cd" type="12" value="" out="N"/>
				<param name="f_pol_cd" type="12" value="" out="N"/>
				<param name="f_pod_cd" type="12" value="" out="N"/>
				<param name="f_ias_rgn_cd" type="12" value="" out="N"/>
				<param name="f_hul_bnd_cd" type="12" value="" out="N"/>
				<param name="f_sqm_mn_sctr_flg" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
