<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="FFCmpnAgreementDBDAOFFAgreementRSQL">
			<desc><![CDATA[FFAgreement]]></desc>
			<sql><![CDATA[
SELECT
      A.FF_CNT_CD,
      A.FF_SEQ,
      CONCAT(A.FF_CNT_CD, TO_CHAR(A.FF_SEQ, 'FM000000'))                  AS FF_CNT_SEQ,
      CASE TO_CHAR(A.FF_SEQ, 'FM000000')
      WHEN '999999'
      THEN 'All customer for General Rate Case'
      WHEN '888888'
      THEN 'All customer for Special Rate Case'
      WHEN '777777'
      THEN 'All customer for Canadian Special Rate Case'
      ELSE NVL(REPLACE(REPLACE(B.CUST_LGL_ENG_NM,CHR(13)||CHR(10),' '),CHR(9),' '),' ')
       END                                                                              AS FF_CNT_CUST_NM,
      CASE CONCAT(A.SHPR_CNT_CD, TO_CHAR(A.SHPR_SEQ, 'FM000000'))
      WHEN '*000000'
      THEN '*'
      ELSE NVL(CONCAT(A.SHPR_CNT_CD, TO_CHAR(A.SHPR_SEQ, 'FM000000')), '*')
       END                                                                              AS SHPR_CNT_SEQ,
           NVL(REPLACE(REPLACE(C.CUST_LGL_ENG_NM,CHR(13)||CHR(10),' '),CHR(9),' '),' ') AS SHPR_CNT_NM,
           NVL(A.POR_GRP_TP_CD, '*')                                                    AS POR_GRP_TP_CD,
           NVL(A.POR_ROUT_CD,   '*')                                                    AS POR_ROUT_CD,
           NVL(A.POL_GRP_TP_CD, '*')                                                    AS POL_GRP_TP_CD,
           NVL(A.POL_ROUT_CD,   '*')                                                    AS POL_ROUT_CD,
           NVL(A.POD_GRP_TP_CD, '*')                                                    AS POD_GRP_TP_CD,
           NVL(A.POD_ROUT_CD,   '*')                                                    AS POD_ROUT_CD,
           NVL(A.FM_EFF_DT, '20000101')                                                 AS FM_EFF_DT,
           NVL(A.TO_EFF_DT, '29991231')                                                 AS TO_EFF_DT,
           NVL(A.SC_NO,         '*')                                                    AS SC_NO,
           NVL(A.RFA_NO,        '*')                                                    AS RFA_NO,
           NVL(A.CMDT_TP_CD,    '*')                                                    AS CMDT_TP_CD,
           NVL(A.CMDT_CD,       '*')                                                    AS CMDT_CD,
      CASE A.CMDT_TP_CD
      WHEN '2'
      THEN E.REP_CMDT_NM
      WHEN '3'
      THEN F.CMDT_NM
       END                                                                              AS CMDT_NM,
           NVL(A.FF_DIV_CD,   ' ')                                                      AS FF_DIV_CD,
           NVL(A.FF_BKG_RT,     0)                                                      AS FF_BKG_RT,
           NVL(A.FF_BX_AMT,      0)                                                     AS FF_BX_AMT,
           NVL(A.FF_TEU_AMT,     0)                                                     AS FF_TEU_AMT,
           NVL(A.FF_FEU_AMT,     0)                                                     AS FF_FEU_AMT,
           NVL(A.FF_RF_AMT,      0)                                                     AS FF_RF_AMT,
           NVL(A.FF_CHG_CTNT, ' ')                                                      AS FF_CHG_CTNT,
           A.FF_AGMT_SEQ
      FROM ACM_FF_AGMT A,
           MDM_CUSTOMER     B,
           MDM_CUSTOMER     C,
           MDM_REP_CMDT     E,
           MDM_COMMODITY    F
     WHERE A.FF_CNT_CD    = B.CUST_CNT_CD(+)
       AND A.FF_SEQ  = B.CUST_SEQ(+)
       AND A.SHPR_CNT_CD    = C.CUST_CNT_CD(+)
       AND A.SHPR_SEQ       = C.CUST_SEQ(+)
       AND A.CMDT_CD        = E.REP_CMDT_CD(+)
       AND A.CMDT_CD        = F.CMDT_CD(+)
       AND NVL(A.DELT_FLG,'N') <> 'Y' 
#if(${search_brog_cnt_cust_seq} != '')
       AND CONCAT(A.FF_CNT_CD, TO_CHAR(A.FF_SEQ, 'FM000000')) LIKE @[search_brog_cnt_cust_seq]||'%'
#end
  ORDER BY FF_CNT_SEQ, FF_CNT_CUST_NM, SHPR_CNT_NM, POR_GRP_TP_CD, POR_ROUT_CD, POL_GRP_TP_CD, POL_ROUT_CD, POD_GRP_TP_CD
  , POD_ROUT_CD, FM_EFF_DT, TO_EFF_DT, SC_NO, CMDT_TP_CD			]]></sql>
			<params>
				<param name="search_brog_cnt_cust_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
