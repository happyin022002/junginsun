/*=========================================================
*Copyright(c) 2015 CyberLogitec
*@FileName : DailyForecastManageDBDAOSearchDailyForecastManageListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2015.12.15
*@LastModifier : 최성민
*@LastVersion : 1.0
* 2015.12.15 최성민
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esm.spc.dailyforecast.dailyforecastmanage.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author CHOI SUNGMIN
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class DailyForecastManageDBDAOSearchDailyForecastManageListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * DailyForecastManage의 데이타 모델에 해당되는 값을 불러온다.
	  * CHOI.Y.S - [프로젝트] Ticket ID : CHM-201004171 - 53FT 관련 필드 추가
	  * -2011.06.01 [ CHM-201111305-01] 김종준 R5와 동일하게 R9이 적용될 수 있도록 쿼리수정
	  * -2012.12.03 [CHM-201221639] 김시몬 R9와 동일하게 R8이 적용될 수 있도록 쿼리수정
	  * -2013.03.27 김시몬 [CHM-201322502] 성수기 선복운영 개선을 위한 T/F추진 VVD_POL SEQ 산출 로직 변경
	  * 2013.11.26 진마리아 [CHM-201326854] SAQ project로 인한 SPC 변경건_FNC 우선제거
	  * 2013.12.05 김시몬 [CHM-201326854] SAQ project로 인한 SPC 변경건_테이블 변경
	  * 2014.03.25 김시몬 [선처리] SQM 분기구하는 로직 관련 보완
	  * </pre>
	  */
	public DailyForecastManageDBDAOSearchDailyForecastManageListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("duration",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("salesoffice",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("week",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("trade",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("year",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("salesrep",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("subtrade",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("bound",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ioc",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("suboffice",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("lane",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esm.spc.dailyforecast.dailyforecastmanage.integration").append("\n"); 
		query.append("FileName : DailyForecastManageDBDAOSearchDailyForecastManageListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("WITH PARAMS_ORG AS (" ).append("\n"); 
		query.append("    SELECT @[year]        AS COST_YR     ," ).append("\n"); 
		query.append("           @[week]        AS COST_WK     ," ).append("\n"); 
		query.append("           @[duration]    AS DUR         ," ).append("\n"); 
		query.append("           @[trade]       AS TRD_CD      ," ).append("\n"); 
		query.append("           @[subtrade]    AS SUB_TRD_CD  ," ).append("\n"); 
		query.append("           @[lane]        AS RLANE_CD    ," ).append("\n"); 
		query.append("           @[bound]       AS DIR_CD      ," ).append("\n"); 
		query.append("           @[ioc]         AS IOC_TS_CD   ," ).append("\n"); 
		query.append("           @[salesoffice] AS RGN_OFC_CD  ," ).append("\n"); 
		query.append("           @[suboffice]   AS SUB_OFC_CD  ," ).append("\n"); 
		query.append("           @[salesrep]    AS SALES_REP_CD," ).append("\n"); 
		query.append("           @[vvd]         AS VVD" ).append("\n"); 
		query.append("      FROM DUAL" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", PARAMS AS (" ).append("\n"); 
		query.append("    SELECT COST_YR       ," ).append("\n"); 
		query.append("           COST_WK       ," ).append("\n"); 
		query.append("           DUR           ," ).append("\n"); 
		query.append("           TRD_CD        ," ).append("\n"); 
		query.append("           SUB_TRD_CD    ," ).append("\n"); 
		query.append("           RLANE_CD      ," ).append("\n"); 
		query.append("           DIR_CD        ," ).append("\n"); 
		query.append("           IOC_TS_CD     ," ).append("\n"); 
		query.append("           RGN_OFC_CD    ," ).append("\n"); 
		query.append("           SUB_OFC_CD    ," ).append("\n"); 
		query.append("           SALES_REP_CD  ," ).append("\n"); 
		query.append("           VVD           ," ).append("\n"); 
		query.append("           REP_TRD_CD    ," ).append("\n"); 
		query.append("           REP_SUB_TRD_CD," ).append("\n"); 
		query.append("           VSL_SLAN_CD" ).append("\n"); 
		query.append("      FROM (" ).append("\n"); 
		query.append("              SELECT PO.COST_YR     ," ).append("\n"); 
		query.append("                     PO.COST_WK     ," ).append("\n"); 
		query.append("                     PO.DUR         ," ).append("\n"); 
		query.append("                     PO.TRD_CD      ," ).append("\n"); 
		query.append("                     PO.SUB_TRD_CD  ," ).append("\n"); 
		query.append("                     PO.RLANE_CD    ," ).append("\n"); 
		query.append("                     PO.DIR_CD      ," ).append("\n"); 
		query.append("                     PO.IOC_TS_CD   ," ).append("\n"); 
		query.append("                     PO.RGN_OFC_CD  ," ).append("\n"); 
		query.append("                     PO.SUB_OFC_CD  ," ).append("\n"); 
		query.append("                     PO.SALES_REP_CD," ).append("\n"); 
		query.append("                     PO.VVD         ," ).append("\n"); 
		query.append("                     RL.REP_TRD_CD  ," ).append("\n"); 
		query.append("                     SPC_GET_REP_SUB_TRD_FNC(PO.RLANE_CD) AS REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                     RL.VSL_SLAN_CD" ).append("\n"); 
		query.append("                FROM MDM_REV_LANE RL," ).append("\n"); 
		query.append("                     PARAMS_ORG   PO" ).append("\n"); 
		query.append("               WHERE RL.RLANE_CD = PO.RLANE_CD" ).append("\n"); 
		query.append("                 AND PO.VVD IS NULL" ).append("\n"); 
		query.append("              UNION ALL" ).append("\n"); 
		query.append("              SELECT DISTINCT  " ).append("\n"); 
		query.append("                     ''   AS COST_YR   ," ).append("\n"); 
		query.append("                     ''   AS COST_WK   ," ).append("\n"); 
		query.append("                     NULL AS DUR       ," ).append("\n"); 
		query.append("                     ''   AS TRD_CD    ," ).append("\n"); 
		query.append("                     ''   AS SUB_TRD_CD," ).append("\n"); 
		query.append("                     ''   AS RLANE_CD  ," ).append("\n"); 
		query.append("                     SUBSTR(PO.VVD, 9, 1) AS DIR_CD," ).append("\n"); 
		query.append("                     PO.IOC_TS_CD        ," ).append("\n"); 
		query.append("                     PO.RGN_OFC_CD       ," ).append("\n"); 
		query.append("                     PO.SUB_OFC_CD       ," ).append("\n"); 
		query.append("                     PO.SALES_REP_CD     ," ).append("\n"); 
		query.append("                     PO.VVD              ," ).append("\n"); 
		query.append("                     '' AS REP_TRD_CD    ," ).append("\n"); 
		query.append("                     '' AS REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                     RL.VSL_SLAN_CD" ).append("\n"); 
		query.append("                FROM VSK_VSL_SKD  VS," ).append("\n"); 
		query.append("                     MDM_REV_LANE RL," ).append("\n"); 
		query.append("                     PARAMS_ORG   PO" ).append("\n"); 
		query.append("               WHERE VS.VSL_CD      = SUBSTR(PO.VVD, 1, 4)" ).append("\n"); 
		query.append("                 AND VS.SKD_VOY_NO  = SUBSTR(PO.VVD, 5, 4)" ).append("\n"); 
		query.append("                 AND VS.SKD_DIR_CD  = SUBSTR(PO.VVD, 9, 1)" ).append("\n"); 
		query.append("                 AND VS.VSL_SLAN_CD = RL.VSL_SLAN_CD" ).append("\n"); 
		query.append("                 AND PO.VVD IS NOT NULL" ).append("\n"); 
		query.append("            --   AND ROWNUM = 1" ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", VVDLS AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT" ).append("\n"); 
		query.append("           SLS_YRMON     ," ).append("\n"); 
		query.append("           COST_YRMON    ," ).append("\n"); 
		query.append("           COST_WK       ," ).append("\n"); 
		query.append("           REP_TRD_CD    ," ).append("\n"); 
		query.append("           REP_SUB_TRD_CD," ).append("\n"); 
		query.append("           TRD_CD        ," ).append("\n"); 
		query.append("           SUB_TRD_CD    ," ).append("\n"); 
		query.append("           RLANE_CD      ," ).append("\n"); 
		query.append("           DIR_CD        ," ).append("\n"); 
		query.append("           VSL_CD        ," ).append("\n"); 
		query.append("           SKD_VOY_NO    ," ).append("\n"); 
		query.append("           SKD_DIR_CD    ," ).append("\n"); 
		query.append("           IOC_CD        ," ).append("\n"); 
		query.append("           ETD_DT        ," ).append("\n"); 
		query.append("           CTRL_LVL      ," ).append("\n"); 
		query.append("           CTRL_HC       ," ).append("\n"); 
		query.append("           CTRL_45       ," ).append("\n"); 
		query.append("           CTRL_53       ," ).append("\n"); 
		query.append("           CTRL_RF       ," ).append("\n"); 
		query.append("           CTRL_WT" ).append("\n"); 
		query.append("           ,BSE_QTR_CD" ).append("\n"); 
		query.append("      FROM (" ).append("\n"); 
		query.append("              SELECT MV.SLS_YRMON           ," ).append("\n"); 
		query.append("                     MV.COST_YRMON          ," ).append("\n"); 
		query.append("                     MV.COST_WK             ," ).append("\n"); 
		query.append("                     P.REP_TRD_CD           ," ).append("\n"); 
		query.append("                     P.REP_SUB_TRD_CD       ," ).append("\n"); 
		query.append("                     MV.TRD_CD              ," ).append("\n"); 
		query.append("                     MV.SUB_TRD_CD          ," ).append("\n"); 
		query.append("                     MV.RLANE_CD            ," ).append("\n"); 
		query.append("                     MV.DIR_CD              ," ).append("\n"); 
		query.append("                     MV.VSL_CD              ," ).append("\n"); 
		query.append("                     MV.SKD_VOY_NO          ," ).append("\n"); 
		query.append("                     MV.DIR_CD AS SKD_DIR_CD," ).append("\n"); 
		query.append("                     MV.IOC_CD              ," ).append("\n"); 
		query.append("                     MV.LST_LODG_PORT_ETD_DT       AS ETD_DT  ," ).append("\n"); 
		query.append("                     NVL(CO.CTRL_LVL_CD     , 'L') AS CTRL_LVL," ).append("\n"); 
		query.append("                     NVL(CO.CTRL_40FT_HC_FLG, 'N') AS CTRL_HC ," ).append("\n"); 
		query.append("                     NVL(CO.CTRL_45FT_HC_FLG, 'N') AS CTRL_45 ," ).append("\n"); 
		query.append("                     NVL(CO.CTRL_53FT_FLG   , 'N') AS CTRL_53 ," ).append("\n"); 
		query.append("                     NVL(CO.CTRL_RF_FLG     , 'N') AS CTRL_RF ," ).append("\n"); 
		query.append("                     NVL(CO.CTRL_WGT_FLG    , 'N') AS CTRL_WT" ).append("\n"); 
		query.append("                     , CASE WHEN MV.COST_YRMON >= '201501' " ).append("\n"); 
		query.append("                          THEN CEIL(TO_NUMBER(SUBSTR(MV.COST_YRMON, -2))/3)||'Q' " ).append("\n"); 
		query.append("                          ELSE CEIL(TO_NUMBER(DECODE(MV.COST_WK,'00','01','53','52',MV.COST_WK))/13)||'Q'" ).append("\n"); 
		query.append("                       END BSE_QTR_CD --2015.03.04 CHM-201534435 SQM QTA주가 변경 관련 적용 요청" ).append("\n"); 
		query.append("                FROM SPC_ALOC_CTRL_OPT CO," ).append("\n"); 
		query.append("                     MAS_MON_VVD       MV," ).append("\n"); 
		query.append("                     PARAMS            P" ).append("\n"); 
		query.append("               WHERE SUBSTR(MV.SLS_YRMON, 1, 4)||MV.COST_WK IN ( SELECT /*+ INDEX(P XPKMAS_WK_PRD)*/" ).append("\n"); 
		query.append("                                                                        PRD.COST_YR||PRD.COST_WK COST_YRWK" ).append("\n"); 
		query.append("                                                                   FROM MAS_WK_PRD PRD" ).append("\n"); 
		query.append("                                                                  WHERE PRD.COST_YR||PRD.COST_WK >= P.COST_YR||P.COST_WK" ).append("\n"); 
		query.append("                                                                    AND ROWNUM <= P.DUR )" ).append("\n"); 
		query.append("                 AND MV.TRD_CD = P.TRD_CD" ).append("\n"); 
		query.append("                 AND MV.SUB_TRD_CD LIKE P.SUB_TRD_CD||'%'" ).append("\n"); 
		query.append("                 AND MV.RLANE_CD   LIKE P.RLANE_CD||'%'" ).append("\n"); 
		query.append("                 AND MV.DIR_CD     LIKE P.DIR_CD||'%'" ).append("\n"); 
		query.append("                 AND (MV.DELT_FLG IS NULL OR MV.DELT_FLG = 'N')" ).append("\n"); 
		query.append("                 AND MV.RLANE_CD     <> 'RBCCO'" ).append("\n"); 
		query.append("                 AND CO.RLANE_CD  (+) = MV.RLANE_CD" ).append("\n"); 
		query.append("                 AND CO.DIR_CD    (+) = MV.DIR_CD" ).append("\n"); 
		query.append("                 AND CO.VSL_CD    (+) = MV.VSL_CD" ).append("\n"); 
		query.append("                 AND CO.SKD_VOY_NO(+) = MV.SKD_VOY_NO" ).append("\n"); 
		query.append("                 AND CO.SKD_DIR_CD(+) = MV.DIR_CD" ).append("\n"); 
		query.append("                 AND P.VVD IS NULL" ).append("\n"); 
		query.append("              UNION ALL" ).append("\n"); 
		query.append("              SELECT MV.SLS_YRMON," ).append("\n"); 
		query.append("                     MV.COST_YRMON          ," ).append("\n"); 
		query.append("                     MV.COST_WK  ," ).append("\n"); 
		query.append("                     SPC_GET_REP_TRD_FNC(MV.RLANE_CD)     AS REP_TRD_CD    ," ).append("\n"); 
		query.append("                     SPC_GET_REP_SUB_TRD_FNC(MV.RLANE_CD) AS REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                     MV.TRD_CD              ," ).append("\n"); 
		query.append("                     MV.SUB_TRD_CD          ," ).append("\n"); 
		query.append("                     MV.RLANE_CD            ," ).append("\n"); 
		query.append("                     MV.DIR_CD              ," ).append("\n"); 
		query.append("                     MV.VSL_CD              ," ).append("\n"); 
		query.append("                     MV.SKD_VOY_NO          ," ).append("\n"); 
		query.append("                     MV.DIR_CD AS SKD_DIR_CD," ).append("\n"); 
		query.append("                     MV.IOC_CD              ," ).append("\n"); 
		query.append("                     MV.LST_LODG_PORT_ETD_DT       AS ETD_DT  ," ).append("\n"); 
		query.append("                     NVL(CO.CTRL_LVL_CD     , 'L') AS CTRL_LVL," ).append("\n"); 
		query.append("                     NVL(CO.CTRL_40FT_HC_FLG, 'N') AS CTRL_HC ," ).append("\n"); 
		query.append("                     NVL(CO.CTRL_45FT_HC_FLG, 'N') AS CTRL_45 ," ).append("\n"); 
		query.append("                     NVL(CO.CTRL_53FT_FLG   , 'N') AS CTRL_53 ," ).append("\n"); 
		query.append("                     NVL(CO.CTRL_RF_FLG     , 'N') AS CTRL_RF ," ).append("\n"); 
		query.append("                     NVL(CO.CTRL_WGT_FLG    , 'N') AS CTRL_WT" ).append("\n"); 
		query.append("                     , CASE WHEN MV.COST_YRMON >= '201501' " ).append("\n"); 
		query.append("                          THEN CEIL(TO_NUMBER(SUBSTR(MV.COST_YRMON, -2))/3)||'Q' " ).append("\n"); 
		query.append("                          ELSE CEIL(TO_NUMBER(DECODE(MV.COST_WK,'00','01','53','52',MV.COST_WK))/13)||'Q'" ).append("\n"); 
		query.append("                       END BSE_QTR_CD --2015.03.04 CHM-201534435 SQM QTA주가 변경 관련 적용 요청" ).append("\n"); 
		query.append("                FROM SPC_ALOC_CTRL_OPT CO," ).append("\n"); 
		query.append("                     MAS_MON_VVD       MV," ).append("\n"); 
		query.append("                     PARAMS            P" ).append("\n"); 
		query.append("               WHERE MV.VSL_CD     = SUBSTR(P.VVD, 1, 4)" ).append("\n"); 
		query.append("                 AND MV.SKD_VOY_NO = SUBSTR(P.VVD, 5, 4)" ).append("\n"); 
		query.append("                 AND MV.DIR_CD     = SUBSTR(P.VVD, 9, 1)" ).append("\n"); 
		query.append("                 AND MV.IOC_CD     = DECODE(P.IOC_TS_CD, 'O', 'O', 'I')" ).append("\n"); 
		query.append("                 AND (MV.DELT_FLG IS NULL OR MV.DELT_FLG = 'N')" ).append("\n"); 
		query.append("                 AND CO.RLANE_CD  (+) = MV.RLANE_CD" ).append("\n"); 
		query.append("                 AND CO.DIR_CD    (+) = MV.DIR_CD" ).append("\n"); 
		query.append("                 AND CO.VSL_CD    (+) = MV.VSL_CD" ).append("\n"); 
		query.append("                 AND CO.SKD_VOY_NO(+) = MV.SKD_VOY_NO" ).append("\n"); 
		query.append("                 AND CO.SKD_DIR_CD(+) = MV.DIR_CD" ).append("\n"); 
		query.append("                 AND P.VVD IS NOT NULL" ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", VVD_POL AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT " ).append("\n"); 
		query.append("           SLS_YRMON     ," ).append("\n"); 
		query.append("           COST_YRMON    ," ).append("\n"); 
		query.append("           COST_WK       ," ).append("\n"); 
		query.append("           REP_TRD_CD    ," ).append("\n"); 
		query.append("           REP_SUB_TRD_CD," ).append("\n"); 
		query.append("           TRD_CD        ," ).append("\n"); 
		query.append("           SUB_TRD_CD    ," ).append("\n"); 
		query.append("           RLANE_CD      ," ).append("\n"); 
		query.append("           M.VSL_CD      ," ).append("\n"); 
		query.append("           M.SKD_VOY_NO  ," ).append("\n"); 
		query.append("           M.SKD_DIR_CD  ," ).append("\n"); 
		query.append("           NVL(V.YD_CD, M.POL_CD) AS POL_CD," ).append("\n"); 
		query.append("           ( SELECT DECODE(MAX(S.SKD_CNG_STS_CD), 'S', 0, NVL(DECODE(IOC_TS_CD, 'O', MAX(S.CLPT_SEQ), MIN(S.CLPT_SEQ)), -1))" ).append("\n"); 
		query.append("                   FROM VSK_VSL_PORT_SKD S" ).append("\n"); 
		query.append("                  WHERE S.VSL_CD      = M.VSL_CD" ).append("\n"); 
		query.append("                    AND S.SKD_VOY_NO  = M.SKD_VOY_NO" ).append("\n"); 
		query.append("                    AND S.SKD_DIR_CD  = M.SKD_DIR_CD" ).append("\n"); 
		query.append("                    AND S.VPS_PORT_CD = M.POL_CD" ).append("\n"); 
		query.append("                    AND (S.SKD_CNG_STS_CD IS NULL OR S.SKD_CNG_STS_CD <> 'S')" ).append("\n"); 
		query.append("           ) AS POL_SEQ," ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("           ( SELECT SPC_CONTI_CONV_FNC(MLOC.CONTI_CD, M.RLANE_CD,M.SKD_DIR_CD)" ).append("\n"); 
		query.append("                   FROM MDM_LOCATION MLOC" ).append("\n"); 
		query.append("                  WHERE M.POL_CD = MLOC.LOC_CD" ).append("\n"); 
		query.append("           ) AS POL_CONTI," ).append("\n"); 
		query.append("           ETD_DT    ," ).append("\n"); 
		query.append("           --MIN(CD_DP_SEQ) AS CD_DP_SEQ," ).append("\n"); 
		query.append("           MIN(CD_DP_SEQ) OVER (PARTITION BY SLS_YRMON, COST_WK, REP_TRD_CD, REP_SUB_TRD_CD, RLANE_CD, M.VSL_CD, M.SKD_VOY_NO, M.SKD_DIR_CD, NVL(V.YD_CD, M.POL_CD), ETD_DT, SUB_OFC_CD, RGN_OFC_CD, IOC_TS_CD) AS CD_DP_SEQ," ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("           SUB_OFC_CD," ).append("\n"); 
		query.append("           RGN_OFC_CD," ).append("\n"); 
		query.append("           IOC_TS_CD ," ).append("\n"); 
		query.append("           CTRL_LVL  ," ).append("\n"); 
		query.append("           CTRL_HC   ," ).append("\n"); 
		query.append("           CTRL_45   ," ).append("\n"); 
		query.append("           CTRL_53   ," ).append("\n"); 
		query.append("           CTRL_RF   ," ).append("\n"); 
		query.append("           CTRL_WT" ).append("\n"); 
		query.append("           ,V.BSE_QTR_CD" ).append("\n"); 
		query.append("      FROM (" ).append("\n"); 
		query.append("              SELECT 1 AS FLG        ," ).append("\n"); 
		query.append("                     V.SLS_YRMON     ," ).append("\n"); 
		query.append("                     V.COST_YRMON    ," ).append("\n"); 
		query.append("                     V.COST_WK       ," ).append("\n"); 
		query.append("                     V.REP_TRD_CD    ," ).append("\n"); 
		query.append("                     V.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                     V.TRD_CD        ," ).append("\n"); 
		query.append("                     V.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                     V.RLANE_CD      ," ).append("\n"); 
		query.append("                     V.VSL_CD        ," ).append("\n"); 
		query.append("                     V.SKD_VOY_NO    ," ).append("\n"); 
		query.append("                     V.SKD_DIR_CD    ," ).append("\n"); 
		query.append("                     M.POL_CD        ," ).append("\n"); 
		query.append("                     V.ETD_DT        ," ).append("\n"); 
		query.append("                     M.CD_DP_SEQ     ," ).append("\n"); 
		query.append("                     M.SLS_OFC_CD     AS SUB_OFC_CD," ).append("\n"); 
		query.append("                     M.SLS_RGN_OFC_CD AS RGN_OFC_CD," ).append("\n"); 
		query.append("                     M.IOC_TS_CD     ," ).append("\n"); 
		query.append("                     V.CTRL_LVL      ," ).append("\n"); 
		query.append("                     V.CTRL_HC       ," ).append("\n"); 
		query.append("                     V.CTRL_45       ," ).append("\n"); 
		query.append("                     V.CTRL_53       ," ).append("\n"); 
		query.append("                     V.CTRL_RF       ," ).append("\n"); 
		query.append("                     V.CTRL_WT" ).append("\n"); 
		query.append("                     ,V.BSE_QTR_CD" ).append("\n"); 
		query.append("                FROM VVDLS                  V," ).append("\n"); 
		query.append("                     SPC_FCAST_OFC_POL_MAPG M," ).append("\n"); 
		query.append("                     PARAMS                 P" ).append("\n"); 
		query.append("               WHERE M.REP_TRD_CD     = V.REP_TRD_CD" ).append("\n"); 
		query.append("                 AND M.REP_SUB_TRD_CD = V.REP_SUB_TRD_CD" ).append("\n"); 
		query.append("                 AND M.TRD_CD         = V.TRD_CD" ).append("\n"); 
		query.append("                 AND M.SUB_TRD_CD     = V.SUB_TRD_CD" ).append("\n"); 
		query.append("                 AND M.RLANE_CD       = V.RLANE_CD" ).append("\n"); 
		query.append("                 AND M.DIR_CD         = V.DIR_CD" ).append("\n"); 
		query.append("                 AND M.IOC_TS_CD      = P.IOC_TS_CD" ).append("\n"); 
		query.append("                 AND M.SLS_OFC_CD     = P.RGN_OFC_CD" ).append("\n"); 
		query.append("                 AND M.BSE_YRWK       = ( SELECT /*+ INDEX_DESC(MI XPKSPC_FCAST_OFC_POL_MAPG) */" ).append("\n"); 
		query.append("                                                 MI.BSE_YRWK" ).append("\n"); 
		query.append("                                            FROM SPC_FCAST_OFC_POL_MAPG MI" ).append("\n"); 
		query.append("                                           WHERE MI.REP_TRD_CD     = M.REP_TRD_CD" ).append("\n"); 
		query.append("                                             AND MI.REP_SUB_TRD_CD = M.REP_SUB_TRD_CD" ).append("\n"); 
		query.append("                                             AND MI.RLANE_CD       = M.RLANE_CD" ).append("\n"); 
		query.append("                                             AND MI.DIR_CD         = M.DIR_CD" ).append("\n"); 
		query.append("                                             AND MI.IOC_TS_CD      = M.IOC_TS_CD" ).append("\n"); 
		query.append("                                             AND MI.SLS_OFC_CD     = M.SLS_OFC_CD" ).append("\n"); 
		query.append("                                             AND MI.BSE_YRWK      <= SUBSTR(V.SLS_YRMON, 1, 4)||V.COST_WK" ).append("\n"); 
		query.append("                                             AND ROWNUM = 1 )" ).append("\n"); 
		query.append("              UNION ALL" ).append("\n"); 
		query.append("              SELECT 2 AS FLG        ," ).append("\n"); 
		query.append("                     V.SLS_YRMON     ," ).append("\n"); 
		query.append("                     V.COST_YRMON    ," ).append("\n"); 
		query.append("                     V.COST_WK       ," ).append("\n"); 
		query.append("                     V.REP_TRD_CD    ," ).append("\n"); 
		query.append("                     V.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                     V.TRD_CD        ," ).append("\n"); 
		query.append("                     V.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                     V.RLANE_CD      ," ).append("\n"); 
		query.append("                     V.VSL_CD        ," ).append("\n"); 
		query.append("                     V.SKD_VOY_NO    ," ).append("\n"); 
		query.append("                     V.SKD_DIR_CD    ," ).append("\n"); 
		query.append("                     M.POL_CD        ," ).append("\n"); 
		query.append("                     V.ETD_DT        ," ).append("\n"); 
		query.append("                     M.CD_DP_SEQ + 100 AS CD_DP_SEQ ," ).append("\n"); 
		query.append("                     M.SLS_OFC_CD      AS SUB_OFC_CD," ).append("\n"); 
		query.append("                     M.SLS_RGN_OFC_CD  AS RGN_OFC_CD," ).append("\n"); 
		query.append("                     M.IOC_TS_CD     ," ).append("\n"); 
		query.append("                     V.CTRL_LVL      ," ).append("\n"); 
		query.append("                     V.CTRL_HC       ," ).append("\n"); 
		query.append("                     V.CTRL_45       ," ).append("\n"); 
		query.append("                     V.CTRL_53       ," ).append("\n"); 
		query.append("                     V.CTRL_RF       ," ).append("\n"); 
		query.append("                     V.CTRL_WT" ).append("\n"); 
		query.append("                     ,V.BSE_QTR_CD" ).append("\n"); 
		query.append("                FROM VVDLS                      V," ).append("\n"); 
		query.append("                     SPC_IRR_FCAST_OFC_POL_MAPG M," ).append("\n"); 
		query.append("                     PARAMS                     P" ).append("\n"); 
		query.append("               WHERE M.REP_TRD_CD     = V.REP_TRD_CD" ).append("\n"); 
		query.append("                 AND M.REP_SUB_TRD_CD = V.REP_SUB_TRD_CD" ).append("\n"); 
		query.append("                 AND M.TRD_CD         = V.TRD_CD" ).append("\n"); 
		query.append("                 AND M.SUB_TRD_CD     = V.SUB_TRD_CD" ).append("\n"); 
		query.append("                 AND M.RLANE_CD       = V.RLANE_CD" ).append("\n"); 
		query.append("                 AND M.DIR_CD         = V.DIR_CD" ).append("\n"); 
		query.append("                 AND M.IOC_TS_CD      = P.IOC_TS_CD" ).append("\n"); 
		query.append("                 AND M.VSL_CD         = V.VSL_CD" ).append("\n"); 
		query.append("                 AND M.SKD_VOY_NO     = V.SKD_VOY_NO" ).append("\n"); 
		query.append("                 AND M.SKD_DIR_CD     = V.SKD_DIR_CD" ).append("\n"); 
		query.append("                 AND M.SLS_OFC_CD     = P.RGN_OFC_CD" ).append("\n"); 
		query.append("           ) M," ).append("\n"); 
		query.append("           VSK_VSL_PORT_SKD V" ).append("\n"); 
		query.append("     WHERE M.VSL_CD     = V.VSL_CD" ).append("\n"); 
		query.append("       AND M.SKD_VOY_NO = V.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND M.SKD_DIR_CD = V.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND M.POL_CD     = V.VPS_PORT_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", VVD_POL_POD AS (" ).append("\n"); 
		query.append("    SELECT SLS_YRMON ," ).append("\n"); 
		query.append("           COST_WK   ," ).append("\n"); 
		query.append("           TRD_CD    ," ).append("\n"); 
		query.append("           SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD  ," ).append("\n"); 
		query.append("           VSL_CD    ," ).append("\n"); 
		query.append("           SKD_VOY_NO," ).append("\n"); 
		query.append("           SKD_DIR_CD," ).append("\n"); 
		query.append("           POL_CD    ," ).append("\n"); 
		query.append("           POL_SEQ   ," ).append("\n"); 
		query.append("           CD_DP_SEQ ," ).append("\n"); 
		query.append("           POL_CONTI ," ).append("\n"); 
		query.append("           ETD_DT    ," ).append("\n"); 
		query.append("           POD_CD    ," ).append("\n"); 
		query.append("           MIN(POD_SEQ) AS POD_SEQ," ).append("\n"); 
		query.append("           RGN_OFC_CD," ).append("\n"); 
		query.append("           SUB_OFC_CD," ).append("\n"); 
		query.append("           IOC_TS_CD ," ).append("\n"); 
		query.append("           POD_CONTI ," ).append("\n"); 
		query.append("           POL_SKIP  ," ).append("\n"); 
		query.append("           CTRL_LVL  ," ).append("\n"); 
		query.append("           CTRL_HC   ," ).append("\n"); 
		query.append("           CTRL_45   ," ).append("\n"); 
		query.append("           CTRL_53   ," ).append("\n"); 
		query.append("           CTRL_RF   ," ).append("\n"); 
		query.append("           CTRL_WT" ).append("\n"); 
		query.append("      FROM (" ).append("\n"); 
		query.append("              SELECT SL.SLS_YRMON ," ).append("\n"); 
		query.append("                     SL.COST_WK   ," ).append("\n"); 
		query.append("                     RL.TRD_CD    ," ).append("\n"); 
		query.append("                     RL.SUB_TRD_CD," ).append("\n"); 
		query.append("                     RL.RLANE_CD  ," ).append("\n"); 
		query.append("                     SL.VSL_CD    ," ).append("\n"); 
		query.append("                     SL.SKD_VOY_NO," ).append("\n"); 
		query.append("                     SL.SKD_DIR_CD," ).append("\n"); 
		query.append("                     SL.POL_CD    ," ).append("\n"); 
		query.append("                     SL.POL_SEQ   ," ).append("\n"); 
		query.append("                     SL.CD_DP_SEQ ," ).append("\n"); 
		query.append("                     SL.POL_CONTI ," ).append("\n"); 
		query.append("                     SL.ETD_DT    ," ).append("\n"); 
		query.append("                     SD.YD_CD AS POD_CD," ).append("\n"); 
		query.append("                     TO_NUMBER(DECODE(SD.SKD_CNG_STS_CD, 'S', NULL, SD.CLPT_SEQ)) AS POD_SEQ," ).append("\n"); 
		query.append("                     SL.RGN_OFC_CD," ).append("\n"); 
		query.append("                     SL.SUB_OFC_CD," ).append("\n"); 
		query.append("                     SL.IOC_TS_CD ," ).append("\n"); 
		query.append("                     SPC_CONTI_CONV_FNC(MLOC.CONTI_CD,SL.RLANE_CD,SL.SKD_DIR_CD) AS POD_CONTI," ).append("\n"); 
		query.append("                     DECODE(SL.POL_SEQ, NULL, 'Y', 'N')            AS POL_SKIP ," ).append("\n"); 
		query.append("                     SL.CTRL_LVL  ," ).append("\n"); 
		query.append("                     SL.CTRL_HC   ," ).append("\n"); 
		query.append("                     SL.CTRL_45   ," ).append("\n"); 
		query.append("                     SL.CTRL_53   ," ).append("\n"); 
		query.append("                     SL.CTRL_RF   ," ).append("\n"); 
		query.append("                     SL.CTRL_WT   ," ).append("\n"); 
		query.append("                     RL.IOC_CD" ).append("\n"); 
		query.append("                FROM VSK_VSL_PORT_SKD SD  ," ).append("\n"); 
		query.append("                     VVD_POL          SL  ," ).append("\n"); 
		query.append("                     MDM_DTL_REV_LANE RL  ," ).append("\n"); 
		query.append("                     MDM_LOCATION     MLOC," ).append("\n"); 
		query.append("                     PARAMS           P" ).append("\n"); 
		query.append("               WHERE SUBSTR(sl.pol_cd, 1, 5) NOT IN ('EGSUZ', 'PAPAC')" ).append("\n"); 
		query.append("                 AND SD.VPS_PORT_CD NOT IN ('EGSUZ', 'PAPAC')" ).append("\n"); 
		query.append("                 AND SL.POL_SEQ        >= 0" ).append("\n"); 
		query.append("                 AND SD.VSL_CD          = SL.VSL_CD" ).append("\n"); 
		query.append("                 AND SD.SKD_VOY_NO      = SL.SKD_VOY_NO" ).append("\n"); 
		query.append("                 AND SD.SKD_DIR_CD      = SL.SKD_DIR_CD" ).append("\n"); 
		query.append("                 AND (SD.SKD_CNG_STS_CD IS NULL OR SD.SKD_CNG_STS_CD <> 'S')" ).append("\n"); 
		query.append("                 AND SD.CLPT_SEQ        > SL.POL_SEQ" ).append("\n"); 
		query.append("                 AND SD.SLAN_CD         = P.VSL_SLAN_CD" ).append("\n"); 
		query.append("                 AND RL.RLANE_CD        = SL.RLANE_CD" ).append("\n"); 
		query.append("                 AND RL.VSL_SLAN_DIR_CD = SL.SKD_DIR_CD" ).append("\n"); 
		query.append("                 AND RL.FM_CONTI_CD     = SL.POL_CONTI" ).append("\n"); 
		query.append("                 AND SD.VPS_PORT_CD     = MLOC.LOC_CD" ).append("\n"); 
		query.append("                 AND RL.TO_CONTI_CD     = SPC_CONTI_CONV_FNC(MLOC.CONTI_CD, SL.RLANE_CD,SL.SKD_DIR_CD)" ).append("\n"); 
		query.append("                 AND RL.DELT_FLG        = 'N'" ).append("\n"); 
		query.append("                 AND DECODE(RL.FM_CONTI_CD,RL.TO_CONTI_CD, 'I', 'O') = DECODE(P.IOC_TS_CD, 'O', 'O', 'I')" ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append("  GROUP BY" ).append("\n"); 
		query.append("           SLS_YRMON ," ).append("\n"); 
		query.append("           COST_WK   ," ).append("\n"); 
		query.append("           TRD_CD    ," ).append("\n"); 
		query.append("           SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD  ," ).append("\n"); 
		query.append("           VSL_CD    ," ).append("\n"); 
		query.append("           SKD_VOY_NO," ).append("\n"); 
		query.append("           SKD_DIR_CD," ).append("\n"); 
		query.append("           POL_CD    ," ).append("\n"); 
		query.append("           POL_SEQ   ," ).append("\n"); 
		query.append("           CD_DP_SEQ ," ).append("\n"); 
		query.append("           POL_CONTI ," ).append("\n"); 
		query.append("           ETD_DT    ," ).append("\n"); 
		query.append("           POD_CD    ," ).append("\n"); 
		query.append("           RGN_OFC_CD," ).append("\n"); 
		query.append("           SUB_OFC_CD," ).append("\n"); 
		query.append("           IOC_TS_CD ," ).append("\n"); 
		query.append("           POD_CONTI ," ).append("\n"); 
		query.append("           POL_SKIP  ," ).append("\n"); 
		query.append("           CTRL_LVL  ," ).append("\n"); 
		query.append("           CTRL_HC   ," ).append("\n"); 
		query.append("           CTRL_45   ," ).append("\n"); 
		query.append("           CTRL_53   ," ).append("\n"); 
		query.append("           CTRL_RF   ," ).append("\n"); 
		query.append("           CTRL_WT" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", OFFICES AS (" ).append("\n"); 
		query.append("#if (${salesoffice} != 'SELSC')" ).append("\n"); 
		query.append("    SELECT 1 AS FLG    ," ).append("\n"); 
		query.append("           O.OFC_CD    ," ).append("\n"); 
		query.append("           P.RGN_OFC_CD," ).append("\n"); 
		query.append("           SUBSTR(SYS_CONNECT_BY_PATH(OFC_CD, '/'), DECODE(LEVEL, 1, 2, 8), 5) AS SUB_OFC_CD," ).append("\n"); 
		query.append("           P.SALES_REP_CD" ).append("\n"); 
		query.append("      FROM MDM_ORGANIZATION O," ).append("\n"); 
		query.append("           PARAMS           P" ).append("\n"); 
		query.append("CONNECT BY PRIOR O.OFC_CD      = O.PRNT_OFC_CD" ).append("\n"); 
		query.append("             AND O.DELT_FLG    = 'N'" ).append("\n"); 
		query.append("             AND O.OFC_TP_CD  IN ('BB', 'BA', 'BS')" ).append("\n"); 
		query.append("      START WITH O.OFC_CD      = P.RGN_OFC_CD" ).append("\n"); 
		query.append("             AND P.SUB_OFC_CD IS NULL" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT" ).append("\n"); 
		query.append("           2 AS FLG    ," ).append("\n"); 
		query.append("           O.OFC_CD    ," ).append("\n"); 
		query.append("           P.RGN_OFC_CD," ).append("\n"); 
		query.append("           SUBSTR(SYS_CONNECT_BY_PATH(OFC_CD, '/'), DECODE(LEVEL, 1, 2, 8), 5) AS SUB_OFC_CD," ).append("\n"); 
		query.append("           P.SALES_REP_CD" ).append("\n"); 
		query.append("      FROM MDM_ORGANIZATION O," ).append("\n"); 
		query.append("           PARAMS           P" ).append("\n"); 
		query.append("CONNECT BY PRIOR O.OFC_CD       = O.PRNT_OFC_CD" ).append("\n"); 
		query.append("             AND O.DELT_FLG     = 'N'" ).append("\n"); 
		query.append("             AND O.OFC_TP_CD   IN ('BB', 'BA', 'BS')" ).append("\n"); 
		query.append("             AND (P.RGN_OFC_CD <> P.SUB_OFC_CD OR LEVEL = 1)" ).append("\n"); 
		query.append("      START WITH O.OFC_CD       = P.SUB_OFC_CD" ).append("\n"); 
		query.append("             AND P.SUB_OFC_CD  IS NOT NULL" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("    SELECT DISTINCT " ).append("\n"); 
		query.append("           1 AS FLG," ).append("\n"); 
		query.append("           O.SLS_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("           P.RGN_OFC_CD," ).append("\n"); 
		query.append("           DECODE(P.RGN_OFC_CD, 'SELSC', DECODE(O.SLS_REP_OFC_TEAM_CD, NULL, O.SLS_OFC_CD, O.SLS_REP_OFC_TEAM_CD), O.SLS_REP_OFC_TEAM_CD) AS SUB_OFC_CD," ).append("\n"); 
		query.append("           O.SREP_USR_ID AS SALES_REP_CD" ).append("\n"); 
		query.append("      FROM SPC_SLS_REP_TEAM_IF O," ).append("\n"); 
		query.append("           PARAMS              P" ).append("\n"); 
		query.append("     WHERE O.SLS_RGN_OFC_CD = P.RGN_OFC_CD" ).append("\n"); 
		query.append("       AND O.SREP_USR_ID LIKE P.SALES_REP_CD||'%'" ).append("\n"); 
		query.append("       AND P.SUB_OFC_CD IS NULL" ).append("\n"); 
		query.append("    UNION ALL " ).append("\n"); 
		query.append("    SELECT DISTINCT " ).append("\n"); 
		query.append("           2 AS FLG," ).append("\n"); 
		query.append("           O.SLS_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("           P.RGN_OFC_CD, " ).append("\n"); 
		query.append("           DECODE(P.RGN_OFC_CD, 'SELSC', DECODE(O.SLS_REP_OFC_TEAM_CD, NULL, O.SLS_OFC_CD, O.SLS_REP_OFC_TEAM_CD), O.SLS_REP_OFC_TEAM_CD) AS SUB_OFC_CD," ).append("\n"); 
		query.append("           O.SREP_USR_ID AS SALES_REP_CD" ).append("\n"); 
		query.append("      FROM SPC_SLS_REP_TEAM_IF O," ).append("\n"); 
		query.append("           PARAMS              P" ).append("\n"); 
		query.append("     WHERE DECODE(O.SLS_REP_OFC_TEAM_CD, NULL, O.SLS_OFC_CD, O.SLS_REP_OFC_TEAM_CD) LIKE P.SUB_OFC_CD||'%'" ).append("\n"); 
		query.append("       AND O.SREP_USR_ID LIKE P.SALES_REP_CD||'%'" ).append("\n"); 
		query.append("       AND P.SUB_OFC_CD IS NOT NULL" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", SREPS AS (" ).append("\n"); 
		query.append("    SELECT /*+ USE_NL(O SR) */" ).append("\n"); 
		query.append("           SR.SREP_CD  ," ).append("\n"); 
		query.append("           SR.SREP_NM  ," ).append("\n"); 
		query.append("           O.RGN_OFC_CD," ).append("\n"); 
		query.append("           O.SUB_OFC_CD," ).append("\n"); 
		query.append("           O.OFC_CD" ).append("\n"); 
		query.append("      FROM MDM_SLS_REP SR," ).append("\n"); 
		query.append("           OFFICES O" ).append("\n"); 
		query.append("     WHERE SR.SREP_STS_CD = 'N'" ).append("\n"); 
		query.append("       AND SR.OFC_CD      = O.OFC_CD" ).append("\n"); 
		query.append("       AND O.RGN_OFC_CD   = O.RGN_OFC_CD" ).append("\n"); 
		query.append("       AND SR.SREP_CD LIKE O.SALES_REP_CD||'%'" ).append("\n"); 
		query.append(")		" ).append("\n"); 
		query.append(", VVD_PORT_SREP AS (" ).append("\n"); 
		query.append("    SELECT V.SLS_YRMON           ," ).append("\n"); 
		query.append("           V.COST_WK             ," ).append("\n"); 
		query.append("           V.TRD_CD              ," ).append("\n"); 
		query.append("           V.SUB_TRD_CD          ," ).append("\n"); 
		query.append("           V.RLANE_CD            ," ).append("\n"); 
		query.append("           V.SKD_DIR_CD AS DIR_CD," ).append("\n"); 
		query.append("           V.IOC_TS_CD           ," ).append("\n"); 
		query.append("           SR.RGN_OFC_CD         ," ).append("\n"); 
		query.append("           SR.SUB_OFC_CD         ," ).append("\n"); 
		query.append("           SR.OFC_CD             ," ).append("\n"); 
		query.append("           SR.SREP_CD            ," ).append("\n"); 
		query.append("           SR.SREP_NM            ," ).append("\n"); 
		query.append("           V.POL_CD              ," ).append("\n"); 
		query.append("           V.POD_CD              ," ).append("\n"); 
		query.append("           V.POL_SKIP            ," ).append("\n"); 
		query.append("           V.ETD_DT              ," ).append("\n"); 
		query.append("           V.VSL_CD              ," ).append("\n"); 
		query.append("           V.SKD_VOY_NO          ," ).append("\n"); 
		query.append("           V.SKD_DIR_CD          ," ).append("\n"); 
		query.append("           V.CTRL_LVL            ," ).append("\n"); 
		query.append("           V.CTRL_HC             ," ).append("\n"); 
		query.append("           V.CTRL_45             ," ).append("\n"); 
		query.append("           V.CTRL_53             ," ).append("\n"); 
		query.append("           V.CTRL_RF             ," ).append("\n"); 
		query.append("           V.CTRL_WT" ).append("\n"); 
		query.append("      FROM SREPS       SR," ).append("\n"); 
		query.append("           VVD_POL_POD V" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", VVD_PORT_SREP_CUST AS (" ).append("\n"); 
		query.append("    SELECT SUBSTR(VPS.SLS_YRMON, 1, 4) AS COST_YR," ).append("\n"); 
		query.append("           VPS.COST_WK   ," ).append("\n"); 
		query.append("           VPS.TRD_CD    ," ).append("\n"); 
		query.append("           VPS.SUB_TRD_CD," ).append("\n"); 
		query.append("           VPS.RLANE_CD  ," ).append("\n"); 
		query.append("           VPS.SKD_DIR_CD AS DIR_CD," ).append("\n"); 
		query.append("           VPS.IOC_TS_CD ," ).append("\n"); 
		query.append("           VPS.RGN_OFC_CD," ).append("\n"); 
		query.append("           VPS.SUB_OFC_CD," ).append("\n"); 
		query.append("           VPS.OFC_CD    ," ).append("\n"); 
		query.append("           VPS.SREP_CD   ," ).append("\n"); 
		query.append("           VPS.SREP_NM   ," ).append("\n"); 
		query.append("           CM.FCAST_CUST_TP_CD AS CUST_TP_CD," ).append("\n"); 
		query.append("           CM.CUST_CNT_CD," ).append("\n"); 
		query.append("           CM.CUST_SEQ   ," ).append("\n"); 
		query.append("           VPS.POL_CD    ," ).append("\n"); 
		query.append("           VPS.POD_CD    ," ).append("\n"); 
		query.append("           VPS.VSL_CD    ," ).append("\n"); 
		query.append("           VPS.SKD_VOY_NO," ).append("\n"); 
		query.append("           VPS.SKD_DIR_CD," ).append("\n"); 
		query.append("           VPS.CTRL_LVL  ," ).append("\n"); 
		query.append("           VPS.CTRL_HC   ," ).append("\n"); 
		query.append("           VPS.CTRL_45   ," ).append("\n"); 
		query.append("           VPS.CTRL_53   ," ).append("\n"); 
		query.append("           VPS.CTRL_RF   ," ).append("\n"); 
		query.append("           VPS.CTRL_WT" ).append("\n"); 
		query.append("      FROM SPC_SLS_REP_CUST_MAPG CM ," ).append("\n"); 
		query.append("           VVD_PORT_SREP         VPS" ).append("\n"); 
		query.append("     WHERE CM.TRD_CD    (+) = VPS.TRD_CD" ).append("\n"); 
		query.append("       AND CM.SUB_TRD_CD(+) = VPS.SUB_TRD_CD" ).append("\n"); 
		query.append("       AND CM.RLANE_CD  (+) = VPS.RLANE_CD" ).append("\n"); 
		query.append("       AND CM.DIR_CD    (+) = VPS.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND CM.IOC_TS_CD (+) = VPS.IOC_TS_CD" ).append("\n"); 
		query.append("       AND CM.SREP_CD   (+) = VPS.SREP_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", MASTER_DATA AS (" ).append("\n"); 
		query.append("    SELECT 2 AS LVL1," ).append("\n"); 
		query.append("           2-TRUNC((GROUPING_ID(T.POL_CD, T.POD_CD) + 1) / 2) AS LVL2," ).append("\n"); 
		query.append("           T.TRD_CD    ," ).append("\n"); 
		query.append("           T.SUB_TRD_CD," ).append("\n"); 
		query.append("           T.RLANE_CD  ," ).append("\n"); 
		query.append("           T.DIR_CD    ," ).append("\n"); 
		query.append("           T.IOC_TS_CD ," ).append("\n"); 
		query.append("           T.RGN_OFC_CD," ).append("\n"); 
		query.append("           NULL AS OFC_CD     ," ).append("\n"); 
		query.append("           NULL AS SUB_OFC_CD ," ).append("\n"); 
		query.append("           NULL AS SREP_CD    ," ).append("\n"); 
		query.append("           NULL AS SREP_NM    ," ).append("\n"); 
		query.append("           NULL AS CUST_TP_CD ," ).append("\n"); 
		query.append("           NULL AS CUST_CNT_CD," ).append("\n"); 
		query.append("           NULL AS CUST_SEQ   ," ).append("\n"); 
		query.append("           T.COST_YR   ," ).append("\n"); 
		query.append("           T.COST_WK   ," ).append("\n"); 
		query.append("           T.POL_CD    ," ).append("\n"); 
		query.append("           T.POD_CD    ," ).append("\n"); 
		query.append("           T.VSL_CD    ," ).append("\n"); 
		query.append("           T.SKD_VOY_NO," ).append("\n"); 
		query.append("           T.SKD_DIR_CD," ).append("\n"); 
		query.append("           0 AS CHL    ," ).append("\n"); 
		query.append("           T.CTRL_LVL  ," ).append("\n"); 
		query.append("           T.CTRL_HC   ," ).append("\n"); 
		query.append("           T.CTRL_45   ," ).append("\n"); 
		query.append("           T.CTRL_53   ," ).append("\n"); 
		query.append("           T.CTRL_RF   ," ).append("\n"); 
		query.append("           T.CTRL_WT" ).append("\n"); 
		query.append("      FROM VVD_PORT_SREP_CUST T" ).append("\n"); 
		query.append("  GROUP BY GROUPING SETS (" ).append("\n"); 
		query.append("                           ( T.TRD_CD    , T.SUB_TRD_CD, T.RLANE_CD  , T.DIR_CD    , T.IOC_TS_CD ," ).append("\n"); 
		query.append("                             T.RGN_OFC_CD, T.POL_CD    , T.POD_CD    , T.VSL_CD    , T.SKD_VOY_NO," ).append("\n"); 
		query.append("                             T.SKD_DIR_CD, T.COST_YR   , T.COST_WK   , T.CTRL_LVL  , T.CTRL_HC   ," ).append("\n"); 
		query.append("                             T.CTRL_45   , T.CTRL_53   , T.CTRL_RF   , T.CTRL_WT                   )," ).append("\n"); 
		query.append("                           ( T.TRD_CD    , T.SUB_TRD_CD, T.RLANE_CD  , T.DIR_CD    , T.IOC_TS_CD ," ).append("\n"); 
		query.append("                             T.RGN_OFC_CD, T.POL_CD    , T.VSL_CD    , T.SKD_VOY_NO, T.SKD_DIR_CD," ).append("\n"); 
		query.append("                             T.COST_YR   , T.COST_WK   , T.CTRL_LVL  , T.CTRL_HC   , T.CTRL_45   ," ).append("\n"); 
		query.append("                             T.CTRL_53   , T.CTRL_RF   , T.CTRL_WT                                 )," ).append("\n"); 
		query.append("                           ( T.TRD_CD    , T.SUB_TRD_CD, T.RLANE_CD  , T.DIR_CD    , T.IOC_TS_CD ," ).append("\n"); 
		query.append("                             T.RGN_OFC_CD, T.VSL_CD    , T.SKD_VOY_NO, T.SKD_DIR_CD, T.COST_YR   ," ).append("\n"); 
		query.append("                             T.COST_WK   , T.CTRL_LVL  , T.CTRL_HC   , T.CTRL_45   , T.CTRL_53   ," ).append("\n"); 
		query.append("                             T.CTRL_RF   , T.CTRL_WT                                               )" ).append("\n"); 
		query.append("                         )" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT 3 AS LVL1," ).append("\n"); 
		query.append("           2-TRUNC((GROUPING_ID(T.POL_CD, T.POD_CD) + 1) / 2) AS LVL2," ).append("\n"); 
		query.append("           T.TRD_CD     ," ).append("\n"); 
		query.append("           T.SUB_TRD_CD ," ).append("\n"); 
		query.append("           T.RLANE_CD   ," ).append("\n"); 
		query.append("           T.DIR_CD     ," ).append("\n"); 
		query.append("           T.IOC_TS_CD  ," ).append("\n"); 
		query.append("           T.RGN_OFC_CD ," ).append("\n"); 
		query.append("           T.OFC_CD     ," ).append("\n"); 
		query.append("           T.SUB_OFC_CD ," ).append("\n"); 
		query.append("           T.SREP_CD    ," ).append("\n"); 
		query.append("           T.SREP_NM    ," ).append("\n"); 
		query.append("           T.CUST_TP_CD ," ).append("\n"); 
		query.append("           T.CUST_CNT_CD," ).append("\n"); 
		query.append("           T.CUST_SEQ   ," ).append("\n"); 
		query.append("           T.COST_YR    ," ).append("\n"); 
		query.append("           T.COST_WK    ," ).append("\n"); 
		query.append("           T.POL_CD     ," ).append("\n"); 
		query.append("           T.POD_CD     ," ).append("\n"); 
		query.append("           T.VSL_CD     ," ).append("\n"); 
		query.append("           T.SKD_VOY_NO ," ).append("\n"); 
		query.append("           T.SKD_DIR_CD ," ).append("\n"); 
		query.append("           COUNT(DISTINCT T.CUST_CNT_CD) AS CHL," ).append("\n"); 
		query.append("           T.CTRL_LVL   ," ).append("\n"); 
		query.append("           T.CTRL_HC    ," ).append("\n"); 
		query.append("           T.CTRL_45    ," ).append("\n"); 
		query.append("           T.CTRL_53    ," ).append("\n"); 
		query.append("           T.CTRL_RF    ," ).append("\n"); 
		query.append("           T.CTRL_WT" ).append("\n"); 
		query.append("      FROM VVD_PORT_SREP_CUST T" ).append("\n"); 
		query.append("  GROUP BY GROUPING SETS (" ).append("\n"); 
		query.append("                           ( T.TRD_CD    , T.SUB_TRD_CD , T.RLANE_CD  , T.DIR_CD , T.IOC_TS_CD," ).append("\n"); 
		query.append("                             T.RGN_OFC_CD, T.OFC_CD     , T.SUB_OFC_CD, T.SREP_CD, T.SREP_NM  ," ).append("\n"); 
		query.append("                             T.CUST_TP_CD, T.CUST_CNT_CD, T.CUST_SEQ  , T.POL_CD , T.POD_CD   ," ).append("\n"); 
		query.append("                             T.VSL_CD    , T.SKD_VOY_NO , T.SKD_DIR_CD, T.COST_YR, T.COST_WK  ," ).append("\n"); 
		query.append("                             T.CTRL_LVL  , T.CTRL_HC    , T.CTRL_45   , T.CTRL_53, T.CTRL_RF  ," ).append("\n"); 
		query.append("                             T.CTRL_WT                                                          )," ).append("\n"); 
		query.append("                           ( T.TRD_CD    , T.SUB_TRD_CD , T.RLANE_CD  , T.DIR_CD , T.IOC_TS_CD," ).append("\n"); 
		query.append("                             T.RGN_OFC_CD, T.OFC_CD     , T.SUB_OFC_CD, T.SREP_CD, T.SREP_NM  ," ).append("\n"); 
		query.append("                             T.CUST_TP_CD, T.CUST_CNT_CD, T.CUST_SEQ  , T.POL_CD , T.VSL_CD   ," ).append("\n"); 
		query.append("                             T.SKD_VOY_NO, T.SKD_DIR_CD , T.COST_YR   , T.COST_WK, T.CTRL_LVL ," ).append("\n"); 
		query.append("                             T.CTRL_HC   , T.CTRL_45    , T.CTRL_53   , T.CTRL_RF, T.CTRL_WT    )," ).append("\n"); 
		query.append("                           ( T.TRD_CD    , T.SUB_TRD_CD , T.RLANE_CD  , T.DIR_CD , T.IOC_TS_CD," ).append("\n"); 
		query.append("                             T.RGN_OFC_CD, T.OFC_CD     , T.SUB_OFC_CD, T.SREP_CD, T.SREP_NM  ," ).append("\n"); 
		query.append("                             T.VSL_CD    , T.SKD_VOY_NO , T.SKD_DIR_CD, T.COST_YR, T.COST_WK  ," ).append("\n"); 
		query.append("                             T.CTRL_LVL  , T.CTRL_HC    , T.CTRL_45   , T.CTRL_53, T.CTRL_RF  ," ).append("\n"); 
		query.append("                             T.CTRL_WT                                                          )" ).append("\n"); 
		query.append("                         )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", VVDS AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT" ).append("\n"); 
		query.append("           SLS_YRMON           ," ).append("\n"); 
		query.append("           COST_YRMON          ," ).append("\n"); 
		query.append("           COST_WK             ," ).append("\n"); 
		query.append("           REP_TRD_CD          ," ).append("\n"); 
		query.append("           REP_SUB_TRD_CD      ," ).append("\n"); 
		query.append("           TRD_CD              ," ).append("\n"); 
		query.append("           SUB_TRD_CD          ," ).append("\n"); 
		query.append("           RLANE_CD            ," ).append("\n"); 
		query.append("           VSL_CD              ," ).append("\n"); 
		query.append("           SKD_VOY_NO          ," ).append("\n"); 
		query.append("           SKD_DIR_CD          ," ).append("\n"); 
		query.append("           SKD_DIR_CD AS DIR_CD," ).append("\n"); 
		query.append("           SUB_OFC_CD          ," ).append("\n"); 
		query.append("           RGN_OFC_CD          ," ).append("\n"); 
		query.append("           IOC_TS_CD           ," ).append("\n"); 
		query.append("           CTRL_LVL            ," ).append("\n"); 
		query.append("           CTRL_HC             ," ).append("\n"); 
		query.append("           CTRL_45             ," ).append("\n"); 
		query.append("           CTRL_53             ," ).append("\n"); 
		query.append("           CTRL_RF             ," ).append("\n"); 
		query.append("           CTRL_WT             ," ).append("\n"); 
		query.append("           ETD_DT" ).append("\n"); 
		query.append("      FROM VVD_POL" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", FCAST_DATA AS (" ).append("\n"); 
		query.append("    SELECT 3 - GROUPING_ID(F.SREP_USR_ID) AS LVL1," ).append("\n"); 
		query.append("           2 - TRUNC((GROUPING_ID(F.POL_YD_CD, F.POD_YD_CD) + 1) / 2) AS LVL2," ).append("\n"); 
		query.append("           F.TRD_CD    ," ).append("\n"); 
		query.append("           F.SUB_TRD_CD," ).append("\n"); 
		query.append("           F.RLANE_CD  ," ).append("\n"); 
		query.append("           F.DIR_CD    ," ).append("\n"); 
		query.append("           F.IOC_TS_CD ," ).append("\n"); 
		query.append("           F.SLS_RGN_OFC_CD   AS RGN_OFC_CD," ).append("\n"); 
		query.append("           F.FCAST_OFC_CD     AS OFC_CD    ," ).append("\n"); 
		query.append("           SC.SUB_OFC_CD      AS SUB_OFC_CD," ).append("\n"); 
		query.append("           F.SREP_USR_ID      AS SREP_CD   ," ).append("\n"); 
		query.append("           NULL               AS SREP_NM   ," ).append("\n"); 
		query.append("           F.FCAST_CUST_TP_CD AS CUST_TP_CD," ).append("\n"); 
		query.append("           F.CUST_CNT_CD," ).append("\n"); 
		query.append("           F.CUST_SEQ   ," ).append("\n"); 
		query.append("           F.POL_YD_CD AS POL_CD," ).append("\n"); 
		query.append("           F.POD_YD_CD AS POD_CD," ).append("\n"); 
		query.append("           F.VSL_CD     ," ).append("\n"); 
		query.append("           F.SKD_VOY_NO ," ).append("\n"); 
		query.append("           F.SKD_DIR_CD ," ).append("\n"); 
		query.append("           1 AS CHL     ," ).append("\n"); 
		query.append("           V.CTRL_LVL   ," ).append("\n"); 
		query.append("           V.CTRL_HC    ," ).append("\n"); 
		query.append("           V.CTRL_45    ," ).append("\n"); 
		query.append("           V.CTRL_53    ," ).append("\n"); 
		query.append("           V.CTRL_RF    ," ).append("\n"); 
		query.append("           V.CTRL_WT    ," ).append("\n"); 
		query.append("           MAX(SUBSTR(V.SLS_YRMON, 1, 4)) AS COST_YR          ," ).append("\n"); 
		query.append("           MAX(V.COST_WK)                 AS COST_WK          ," ).append("\n"); 
		query.append("           SUM(F.FCAST_TTL_QTY)           AS FCAST_TTL_QTY    ," ).append("\n"); 
		query.append("           SUM(F.FCAST_40FT_HC_QTY)       AS FCAST_40FT_HC_QTY," ).append("\n"); 
		query.append("           SUM(F.FCAST_45FT_HC_QTY)       AS FCAST_45FT_HC_QTY," ).append("\n"); 
		query.append("           SUM(F.FCAST_53FT_QTY)          AS FCAST_53FT_QTY   ," ).append("\n"); 
		query.append("           SUM(F.FCAST_RF_QTY)            AS FCAST_RF_QTY     ," ).append("\n"); 
		query.append("           SUM(F.FCAST_TTL_WGT)           AS FCAST_TTL_WGT    ," ).append("\n"); 
		query.append("           SUM(F.CFM_TTL_QTY)             AS CFM_TTL_QTY      ," ).append("\n"); 
		query.append("           SUM(F.CFM_40FT_HC_QTY)         AS CFM_40FT_HC_QTY  ," ).append("\n"); 
		query.append("           SUM(F.CFM_45FT_HC_QTY)         AS CFM_45FT_HC_QTY  ," ).append("\n"); 
		query.append("           SUM(F.CFM_53FT_QTY)            AS CFM_53FT_QTY     ," ).append("\n"); 
		query.append("           SUM(F.CFM_RF_QTY)              AS CFM_RF_QTY       ," ).append("\n"); 
		query.append("           SUM(F.CFM_TTL_WGT)             AS CFM_TTL_WGT" ).append("\n"); 
		query.append("      FROM VVD_PORT_SREP_CUST SC," ).append("\n"); 
		query.append("           SPC_DLY_FCAST_CUST F ," ).append("\n"); 
		query.append("           VVDS               V ," ).append("\n"); 
		query.append("           PARAMS             P" ).append("\n"); 
		query.append("     WHERE SC.TRD_CD     (+) = F.TRD_CD" ).append("\n"); 
		query.append("       AND SC.SUB_TRD_CD (+) = F.SUB_TRD_CD" ).append("\n"); 
		query.append("       AND SC.RLANE_CD   (+) = F.RLANE_CD" ).append("\n"); 
		query.append("       AND SC.DIR_CD     (+) = F.DIR_CD" ).append("\n"); 
		query.append("       AND SC.IOC_TS_CD  (+) = F.IOC_TS_CD" ).append("\n"); 
		query.append("       AND SC.VSL_CD     (+) = F.VSL_CD" ).append("\n"); 
		query.append("       AND SC.SKD_VOY_NO (+) = F.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND SC.SKD_DIR_CD (+) = F.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND SC.POL_CD     (+) = F.POL_YD_CD" ).append("\n"); 
		query.append("       AND SC.POD_CD     (+) = F.POD_YD_CD" ).append("\n"); 
		query.append("       AND SC.SREP_CD    (+) = F.SREP_USR_ID" ).append("\n"); 
		query.append("       AND SC.CUST_TP_CD (+) = F.FCAST_CUST_TP_CD" ).append("\n"); 
		query.append("       AND SC.CUST_CNT_CD(+) = F.CUST_CNT_CD" ).append("\n"); 
		query.append("       AND SC.CUST_SEQ   (+) = F.CUST_SEQ" ).append("\n"); 
		query.append("#if (${salesoffice} == 'SELSC' && ${suboffice_size} > 0)" ).append("\n"); 
		query.append("       AND SC.SUB_OFC_CD     = P.SUB_OFC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("       AND (    SC.TRD_CD IS NOT NULL" ).append("\n"); 
		query.append("             OR F.FCAST_TTL_QTY     > 0" ).append("\n"); 
		query.append("             OR F.FCAST_40FT_HC_QTY > 0" ).append("\n"); 
		query.append("             OR F.FCAST_45FT_HC_QTY > 0" ).append("\n"); 
		query.append("             OR F.FCAST_53FT_QTY    > 0" ).append("\n"); 
		query.append("             OR F.FCAST_RF_QTY      > 0" ).append("\n"); 
		query.append("             OR F.FCAST_TTL_WGT     > 0" ).append("\n"); 
		query.append("             OR F.CFM_TTL_QTY       > 0" ).append("\n"); 
		query.append("             OR F.CFM_40FT_HC_QTY   > 0" ).append("\n"); 
		query.append("             OR F.CFM_45FT_HC_QTY   > 0" ).append("\n"); 
		query.append("             OR F.CFM_53FT_QTY      > 0" ).append("\n"); 
		query.append("             OR F.CFM_RF_QTY        > 0" ).append("\n"); 
		query.append("             OR F.CFM_TTL_WGT       > 0 )" ).append("\n"); 
		query.append("       AND F.TRD_CD         = V.TRD_CD" ).append("\n"); 
		query.append("       AND F.SUB_TRD_CD     = V.SUB_TRD_CD" ).append("\n"); 
		query.append("       AND F.RLANE_CD       = V.RLANE_CD" ).append("\n"); 
		query.append("       AND F.DIR_CD         = V.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND F.VSL_CD         = V.VSL_CD" ).append("\n"); 
		query.append("       AND F.SKD_VOY_NO     = V.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND F.SKD_DIR_CD     = V.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND F.IOC_TS_CD      = P.IOC_TS_CD" ).append("\n"); 
		query.append("       AND F.SLS_RGN_OFC_CD = P.RGN_OFC_CD" ).append("\n"); 
		query.append("#if (${salesoffice} == 'SELSC' && ${suboffice_size} > 0)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("       AND F.SLS_OFC_CD  LIKE P.SUB_OFC_CD||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("       AND F.SREP_USR_ID LIKE DECODE(P.RGN_OFC_CD, 'SELSC', DECODE(P.SALES_REP_CD, NULL, SC.SREP_CD, P.SALES_REP_CD), P.SALES_REP_CD)||'%'" ).append("\n"); 
		query.append("  GROUP BY GROUPING SETS (" ).append("\n"); 
		query.append("                           ( F.TRD_CD        , F.SUB_TRD_CD  , F.RLANE_CD   , F.DIR_CD     , F.IOC_TS_CD       ," ).append("\n"); 
		query.append("                             F.SLS_RGN_OFC_CD, F.FCAST_OFC_CD, SC.SUB_OFC_CD, F.SREP_USR_ID, F.FCAST_CUST_TP_CD," ).append("\n"); 
		query.append("                             F.CUST_CNT_CD   , F.CUST_SEQ    , F.POL_YD_CD  , F.POD_YD_CD  , F.VSL_CD          ," ).append("\n"); 
		query.append("                             F.SKD_VOY_NO    , F.SKD_DIR_CD  , V.CTRL_LVL   , V.CTRL_HC    , V.CTRL_45         ," ).append("\n"); 
		query.append("                             V.CTRL_53       , V.CTRL_RF     , V.CTRL_WT                                         )," ).append("\n"); 
		query.append("                           ( F.TRD_CD        , F.SUB_TRD_CD  , F.RLANE_CD   , F.DIR_CD     , F.IOC_TS_CD       ," ).append("\n"); 
		query.append("                             F.SLS_RGN_OFC_CD, F.FCAST_OFC_CD, SC.SUB_OFC_CD, F.SREP_USR_ID, F.FCAST_CUST_TP_CD," ).append("\n"); 
		query.append("                             F.CUST_CNT_CD   , F.CUST_SEQ    , F.POL_YD_CD  , F.VSL_CD     , F.SKD_VOY_NO      ," ).append("\n"); 
		query.append("                             F.SKD_DIR_CD    , V.CTRL_LVL    , V.CTRL_HC    , V.CTRL_45    , V.CTRL_53         ," ).append("\n"); 
		query.append("                             V.CTRL_RF       , V.CTRL_WT                                                         )," ).append("\n"); 
		query.append("                           ( F.TRD_CD        , F.SUB_TRD_CD  , F.RLANE_CD   , F.DIR_CD     , F.IOC_TS_CD       ," ).append("\n"); 
		query.append("                             F.SLS_RGN_OFC_CD, F.FCAST_OFC_CD, SC.SUB_OFC_CD, F.SREP_USR_ID, F.VSL_CD          ," ).append("\n"); 
		query.append("                             F.SKD_VOY_NO    , F.SKD_DIR_CD  , V.CTRL_LVL   , V.CTRL_HC    , V.CTRL_45         ," ).append("\n"); 
		query.append("                             V.CTRL_53       , V.CTRL_RF       , V.CTRL_WT                                       )," ).append("\n"); 
		query.append("                           ( F.TRD_CD        , F.SUB_TRD_CD  , F.RLANE_CD   , F.DIR_CD     , F.IOC_TS_CD       ," ).append("\n"); 
		query.append("                             F.SLS_RGN_OFC_CD, F.POL_YD_CD   , F.POD_YD_CD  , F.VSL_CD     , F.SKD_VOY_NO      ," ).append("\n"); 
		query.append("                             F.SKD_DIR_CD    , V.CTRL_LVL    , V.CTRL_HC    , V.CTRL_45    , V.CTRL_53         ," ).append("\n"); 
		query.append("                             V.CTRL_RF       , V.CTRL_WT                                                         )," ).append("\n"); 
		query.append("                           ( F.TRD_CD        , F.SUB_TRD_CD  , F.RLANE_CD   , F.DIR_CD     , F.IOC_TS_CD       ," ).append("\n"); 
		query.append("                             F.SLS_RGN_OFC_CD, F.POL_YD_CD   , F.VSL_CD     , F.SKD_VOY_NO , F.SKD_DIR_CD      ," ).append("\n"); 
		query.append("                             V.CTRL_LVL      , V.CTRL_HC     , V.CTRL_45    , V.CTRL_53    , V.CTRL_RF         ," ).append("\n"); 
		query.append("                             V.CTRL_WT                                                                           )," ).append("\n"); 
		query.append("                           ( F.TRD_CD        , F.SUB_TRD_CD  , F.RLANE_CD   , F.DIR_CD     , F.IOC_TS_CD       ," ).append("\n"); 
		query.append("                             F.SLS_RGN_OFC_CD, F.VSL_CD      , F.SKD_VOY_NO , F.SKD_DIR_CD , V.CTRL_LVL        ," ).append("\n"); 
		query.append("                             V.CTRL_HC       , V.CTRL_45     , V.CTRL_53    , V.CTRL_RF    , V.CTRL_WT           )" ).append("\n"); 
		query.append("                         )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", BKG_ORG AS (" ).append("\n"); 
		query.append("    SELECT /*+ USE_NL(BV B H C) */" ).append("\n"); 
		query.append("           VP.TRD_CD                  ," ).append("\n"); 
		query.append("           VP.SUB_TRD_CD              ," ).append("\n"); 
		query.append("           VP.RLANE_CD                ," ).append("\n"); 
		query.append("           VP.SKD_DIR_CD AS DIR_CD    ," ).append("\n"); 
		query.append("           P.IOC_TS_CD                ," ).append("\n"); 
		query.append("           P.RGN_OFC_CD               ," ).append("\n"); 
		query.append("           SPC_SCR_OFC_CONV_FNC(B.OB_SLS_OFC_CD) AS OFC_CD," ).append("\n"); 
		query.append("           O.SUB_OFC_CD  AS SUB_OFC_CD," ).append("\n"); 
		query.append("           B.OB_SREP_CD  AS SREP_CD   ," ).append("\n"); 
		query.append("           NULL          AS SREP_NM   ," ).append("\n"); 
		query.append("           NVL2(B.BKG_NO, DECODE(NVL2(REPLACE(B.RFA_NO, 'DUM00000001', ''), 0, 1) * NVL2(REPLACE(B.SC_NO, 'DUM00001', ''), 0, 1), 0, 'C', 1, 'S'), '') AS CUST_TP_CD," ).append("\n"); 
		query.append("           B.CTRT_CUST_CNT_CD," ).append("\n"); 
		query.append("           B.CTRT_CUST_SEQ   ," ).append("\n"); 
		query.append("           C.CUST_CNT_CD     ," ).append("\n"); 
		query.append("           C.CUST_SEQ        ," ).append("\n"); 
		query.append("--           NVL(BV.POL_YD_CD, NVL(( SELECT S.YD_CD" ).append("\n"); 
		query.append("--                                    FROM VSK_VSL_PORT_SKD S" ).append("\n"); 
		query.append("--                                   WHERE BV.VSL_CD     = S.VSL_CD" ).append("\n"); 
		query.append("--                                     AND BV.SKD_VOY_NO = S.SKD_VOY_NO" ).append("\n"); 
		query.append("--                                     AND BV.SKD_DIR_CD = S.SKD_DIR_CD" ).append("\n"); 
		query.append("--                                     AND B.POL_CD      = S.VPS_PORT_CD), BV.POL_CD)) AS POL_CD," ).append("\n"); 
		query.append("--           NVL(BV.POD_YD_CD, NVL(( SELECT S.YD_CD" ).append("\n"); 
		query.append("--                                     FROM VSK_VSL_PORT_SKD S" ).append("\n"); 
		query.append("--                                    WHERE BV.VSL_CD     = S.VSL_CD" ).append("\n"); 
		query.append("--                                      AND BV.SKD_VOY_NO = S.SKD_VOY_NO" ).append("\n"); 
		query.append("--                                      AND BV.SKD_DIR_CD = S.SKD_DIR_CD" ).append("\n"); 
		query.append("--                                      AND B.POD_CD      = S.VPS_PORT_CD), BV.POD_CD)) AS POD_CD," ).append("\n"); 
		query.append("           NVL(BV.POL_YD_CD, BV.POL_CD) AS POL_CD," ).append("\n"); 
		query.append("           NVL(BV.POD_YD_CD, BV.POD_CD) AS POD_CD," ).append("\n"); 
		query.append("           BV.VSL_CD    ," ).append("\n"); 
		query.append("           BV.SKD_VOY_NO," ).append("\n"); 
		query.append("           BV.SKD_DIR_CD," ).append("\n"); 
		query.append("           SUBSTR(VP.SLS_YRMON, 1, 4) AS COST_YR," ).append("\n"); 
		query.append("           VP.COST_WK   ," ).append("\n"); 
		query.append("           (" ).append("\n"); 
		query.append("              SELECT    TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '2', 1, 2) * Q.OP_CNTR_QTY), 'FM0000000000.000')" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '2', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '4', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '5', Q.OP_CNTR_QTY, '9', Q.OP_CNTR_QTY, '8', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')	--R9,R8에 대해서 R5과 동일하게 HC으로 처리되도록 추가" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '7', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), 'W', Q.OP_CNTR_QTY, 0) + DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), 'X', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_TP_FNC(Q.CNTR_TPSZ_CD), 'R', Q.OP_CNTR_QTY - Q.EQ_SUBST_CGO_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                     || TO_CHAR((BL.ACT_WGT * DECODE(BL.WGT_UT_CD, 'LBS', 0.00045, 0.001)) + SUM(Q.OP_CNTR_QTY * ( SELECT TS.CNTR_TPSZ_TARE_WGT" ).append("\n"); 
		query.append("                                                                                                                     FROM MDM_CNTR_TP_SZ TS" ).append("\n"); 
		query.append("                                                                                                                    WHERE TS.CNTR_TPSZ_CD = Q.CNTR_TPSZ_CD)) * 0.001, 'FM0000000000.000')" ).append("\n"); 
		query.append("                FROM BKG_QUANTITY Q" ).append("\n"); 
		query.append("               WHERE B.BKG_NO      = Q.BKG_NO" ).append("\n"); 
		query.append("                 AND Q.OP_CNTR_QTY > 0" ).append("\n"); 
		query.append("           ) AS VAL," ).append("\n"); 
		query.append("           VP.CTRL_LVL," ).append("\n"); 
		query.append("           VP.CTRL_HC ," ).append("\n"); 
		query.append("           VP.CTRL_45 ," ).append("\n"); 
		query.append("           VP.CTRL_53 ," ).append("\n"); 
		query.append("           VP.CTRL_RF ," ).append("\n"); 
		query.append("           VP.CTRL_WT" ).append("\n"); 
		query.append("      FROM BKG_CUSTOMER     C ," ).append("\n"); 
		query.append("           BKG_BOOKING      B ," ).append("\n"); 
		query.append("           BKG_VVD          BV," ).append("\n"); 
		query.append("           VVDS             VP," ).append("\n"); 
		query.append("           OFFICES          O ," ).append("\n"); 
		query.append("           PARAMS           P ," ).append("\n"); 
		query.append("           MDM_DTL_REV_LANE RB," ).append("\n"); 
		query.append("           BKG_BL_DOC       BL" ).append("\n"); 
		query.append("     WHERE 1=1" ).append("\n"); 
		query.append("       AND C.BKG_NO         (+) = B.BKG_NO" ).append("\n"); 
		query.append("       AND C.BKG_CUST_TP_CD (+) = 'S'" ).append("\n"); 
		query.append("       AND B.BKG_STS_CD        IN ('W', 'F')" ).append("\n"); 
		query.append("       AND B.BKG_CGO_TP_CD     IN ('F', 'B', 'R')" ).append("\n"); 
		query.append("       AND B.BKG_NO             = BV.BKG_NO" ).append("\n"); 
		query.append("       AND B.BKG_NO             = BL.BKG_NO" ).append("\n"); 
		query.append("       AND P.VSL_SLAN_CD        = BV.SLAN_CD" ).append("\n"); 
		query.append("       AND RB.RLANE_CD          = VP.RLANE_CD" ).append("\n"); 
		query.append("       AND RB.VSL_SLAN_DIR_CD   = VP.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND RB.IOC_CD            = DECODE(P.IOC_TS_CD, 'T', 'I',P.IOC_TS_CD)" ).append("\n"); 
		query.append("       AND RB.FM_CONTI_CD       = ( SELECT SPC_CONTI_CONV_FNC(MLOC.CONTI_CD, RB.RLANE_CD,RB.VSL_SLAN_DIR_CD)" ).append("\n"); 
		query.append("                                      FROM MDM_LOCATION MLOC" ).append("\n"); 
		query.append("                                     WHERE MLOC.LOC_CD = BV.POL_CD )" ).append("\n"); 
		query.append("       AND RB.TO_CONTI_CD       = ( SELECT SPC_CONTI_CONV_FNC(MLOC.CONTI_CD, RB.RLANE_CD,RB.VSL_SLAN_DIR_CD)" ).append("\n"); 
		query.append("                                      FROM MDM_LOCATION MLOC" ).append("\n"); 
		query.append("                                     WHERE MLOC.LOC_CD = BV.POD_CD )" ).append("\n"); 
		query.append("       AND RB.TRD_CD            = VP.TRD_CD" ).append("\n"); 
		query.append("       AND RB.SUB_TRD_CD        = VP.SUB_TRD_CD" ).append("\n"); 
		query.append("       AND RB.DELT_FLG          = 'N'" ).append("\n"); 
		query.append("       AND BV.VSL_CD            = VP.VSL_CD" ).append("\n"); 
		query.append("       AND BV.SKD_VOY_NO        = VP.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND BV.SKD_DIR_CD        = VP.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND BV.VSL_PRE_PST_CD   IN (DECODE(P.IOC_TS_CD, 'T',NULL,'T'), " ).append("\n"); 
		query.append("                                   DECODE(P.IOC_TS_CD, 'T', 'S')," ).append("\n"); 
		query.append("                                   DECODE(P.IOC_TS_CD, 'T', 'U'))" ).append("\n"); 
		query.append("       AND SPC_SCR_OFC_CONV_FNC(B.OB_SLS_OFC_CD) = O.OFC_CD" ).append("\n"); 
		query.append("       AND B.OB_SREP_CD LIKE O.SALES_REP_CD||'%'	" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", BKG_DIV AS (" ).append("\n"); 
		query.append("    SELECT B.TRD_CD    ," ).append("\n"); 
		query.append("           B.SUB_TRD_CD," ).append("\n"); 
		query.append("           B.RLANE_CD  ," ).append("\n"); 
		query.append("           B.DIR_CD    ," ).append("\n"); 
		query.append("           B.IOC_TS_CD ," ).append("\n"); 
		query.append("           B.RGN_OFC_CD," ).append("\n"); 
		query.append("           B.OFC_CD    ," ).append("\n"); 
		query.append("           B.SUB_OFC_CD," ).append("\n"); 
		query.append("           B.SREP_CD   ," ).append("\n"); 
		query.append("           B.SREP_NM   ," ).append("\n"); 
		query.append("           B.CUST_TP_CD," ).append("\n"); 
		query.append("           SC.CUST_CNT_CD AS CUST_CNT_CD," ).append("\n"); 
		query.append("           SC.CUST_SEQ    AS CUST_SEQ   ," ).append("\n"); 
		query.append("           B.POL_CD    ," ).append("\n"); 
		query.append("           B.POD_CD    ," ).append("\n"); 
		query.append("           B.VSL_CD    ," ).append("\n"); 
		query.append("           B.SKD_VOY_NO," ).append("\n"); 
		query.append("           B.SKD_DIR_CD," ).append("\n"); 
		query.append("           B.COST_YR   ," ).append("\n"); 
		query.append("           B.COST_WK   ," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL,  1, 14), 0))) AS BKG_TTL_QTY    ," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 15, 14), 0))) AS BKG_20FT_QTY   ," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 29, 14), 0))) AS BKG_40FT_QTY   ," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 43, 14), 0))) AS BKG_40FT_HC_QTY," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 57, 14), 0))) AS BKG_45FT_HC_QTY," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 71, 14), 0))) AS BKG_53FT_QTY   ," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 85, 14), 0))) AS BKG_RF_QTY     ," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 99, 14), 0))) AS BKG_TTL_WGT    ," ).append("\n"); 
		query.append("           B.CTRL_LVL," ).append("\n"); 
		query.append("           B.CTRL_HC ," ).append("\n"); 
		query.append("           B.CTRL_45 ," ).append("\n"); 
		query.append("           B.CTRL_53 ," ).append("\n"); 
		query.append("           B.CTRL_RF ," ).append("\n"); 
		query.append("           B.CTRL_WT" ).append("\n"); 
		query.append("      FROM BKG_ORG            B ," ).append("\n"); 
		query.append("           VVD_PORT_SREP_CUST SC" ).append("\n"); 
		query.append("     WHERE SC.TRD_CD     (+) = B.TRD_CD" ).append("\n"); 
		query.append("       AND SC.SUB_TRD_CD (+) = B.SUB_TRD_CD" ).append("\n"); 
		query.append("       AND SC.RLANE_CD   (+) = B.RLANE_CD" ).append("\n"); 
		query.append("       AND SC.DIR_CD     (+) = B.DIR_CD" ).append("\n"); 
		query.append("       AND SC.IOC_TS_CD  (+) = B.IOC_TS_CD" ).append("\n"); 
		query.append("       AND SC.VSL_CD     (+) = B.VSL_CD" ).append("\n"); 
		query.append("       AND SC.SKD_VOY_NO (+) = B.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND SC.SKD_DIR_CD (+) = B.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND SUBSTR(SC.POL_CD(+), 1, 5) = SUBSTR(B.POL_CD, 1, 5)" ).append("\n"); 
		query.append("       AND SUBSTR(SC.POD_CD(+), 1, 5) = SUBSTR(B.POD_CD, 1, 5)" ).append("\n"); 
		query.append("--       AND SC.POL_CD     (+) = B.POL_CD" ).append("\n"); 
		query.append("--       AND SC.POD_CD     (+) = B.POD_CD" ).append("\n"); 
		query.append("       AND SC.SREP_CD    (+) = B.SREP_CD" ).append("\n"); 
		query.append("       AND SC.CUST_TP_CD (+) = B.CUST_TP_CD" ).append("\n"); 
		query.append("       AND B.CUST_TP_CD      = 'S'" ).append("\n"); 
		query.append("       AND SC.CUST_CNT_CD(+) = B.CUST_CNT_CD" ).append("\n"); 
		query.append("       AND SC.CUST_SEQ   (+) = B.CUST_SEQ" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT B.TRD_CD    ," ).append("\n"); 
		query.append("           B.SUB_TRD_CD," ).append("\n"); 
		query.append("           B.RLANE_CD  ," ).append("\n"); 
		query.append("           B.DIR_CD    ," ).append("\n"); 
		query.append("           B.IOC_TS_CD ," ).append("\n"); 
		query.append("           B.RGN_OFC_CD," ).append("\n"); 
		query.append("           B.OFC_CD    ," ).append("\n"); 
		query.append("           B.SUB_OFC_CD," ).append("\n"); 
		query.append("           B.SREP_CD   ," ).append("\n"); 
		query.append("           B.SREP_NM   ," ).append("\n"); 
		query.append("           B.CUST_TP_CD," ).append("\n"); 
		query.append("           SC.CUST_CNT_CD AS CUST_CNT_CD," ).append("\n"); 
		query.append("           SC.CUST_SEQ    AS CUST_SEQ   ," ).append("\n"); 
		query.append("           B.POL_CD    ," ).append("\n"); 
		query.append("           B.POD_CD    ," ).append("\n"); 
		query.append("           B.VSL_CD    ," ).append("\n"); 
		query.append("           B.SKD_VOY_NO," ).append("\n"); 
		query.append("           B.SKD_DIR_CD," ).append("\n"); 
		query.append("           B.COST_YR   ," ).append("\n"); 
		query.append("           B.COST_WK   ," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL,  1, 14), 0))) AS BKG_TTL_QTY    ," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 15, 14), 0))) AS BKG_20FT_QTY   ," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 29, 14), 0))) AS BKG_40FT_QTY   ," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 43, 14), 0))) AS BKG_40FT_HC_QTY," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 57, 14), 0))) AS BKG_45FT_HC_QTY," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 71, 14), 0))) AS BKG_53FT_QTY   ," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 85, 14), 0))) AS BKG_RF_QTY     ," ).append("\n"); 
		query.append("           (TO_NUMBER(NVL(SUBSTR(B.VAL, 99, 14), 0))) AS BKG_TTL_WGT    ," ).append("\n"); 
		query.append("           B.CTRL_LVL," ).append("\n"); 
		query.append("           B.CTRL_HC ," ).append("\n"); 
		query.append("           B.CTRL_45 ," ).append("\n"); 
		query.append("           B.CTRL_53 ," ).append("\n"); 
		query.append("           B.CTRL_RF ," ).append("\n"); 
		query.append("           B.CTRL_WT" ).append("\n"); 
		query.append("      FROM BKG_ORG            B ," ).append("\n"); 
		query.append("           VVD_PORT_SREP_CUST SC" ).append("\n"); 
		query.append("     WHERE SC.TRD_CD     (+) = B.TRD_CD" ).append("\n"); 
		query.append("       AND SC.SUB_TRD_CD (+) = B.SUB_TRD_CD" ).append("\n"); 
		query.append("       AND SC.RLANE_CD   (+) = B.RLANE_CD" ).append("\n"); 
		query.append("       AND SC.DIR_CD     (+) = B.DIR_CD" ).append("\n"); 
		query.append("       AND SC.IOC_TS_CD  (+) = B.IOC_TS_CD" ).append("\n"); 
		query.append("       AND SC.VSL_CD     (+) = B.VSL_CD" ).append("\n"); 
		query.append("       AND SC.SKD_VOY_NO (+) = B.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND SC.SKD_DIR_CD (+) = B.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND SUBSTR(SC.POL_CD(+), 1, 5) = SUBSTR(B.POL_CD, 1, 5)" ).append("\n"); 
		query.append("       AND SUBSTR(SC.POD_CD(+), 1, 5) = SUBSTR(B.POD_CD, 1, 5)" ).append("\n"); 
		query.append("--       AND SC.POL_CD     (+) = B.POL_CD" ).append("\n"); 
		query.append("--       AND SC.POD_CD     (+) = B.POD_CD" ).append("\n"); 
		query.append("       AND SC.SREP_CD    (+) = B.SREP_CD" ).append("\n"); 
		query.append("       AND SC.CUST_TP_CD (+) = B.CUST_TP_CD" ).append("\n"); 
		query.append("       AND B.CUST_TP_CD      = 'C'" ).append("\n"); 
		query.append("       AND SC.CUST_CNT_CD(+) = NVL(B.CTRT_CUST_CNT_CD, B.CUST_CNT_CD)" ).append("\n"); 
		query.append("       AND SC.CUST_SEQ   (+) = NVL(B.CTRT_CUST_SEQ, B.CUST_SEQ)" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", BKG_DATA AS (" ).append("\n"); 
		query.append("    SELECT 3 - GROUPING_ID(F.SREP_CD) AS LVL1," ).append("\n"); 
		query.append("           2 - TRUNC((GROUPING_ID(F.POL_CD, F.POD_CD) + 1) / 2) AS LVL2," ).append("\n"); 
		query.append("           F.TRD_CD       ," ).append("\n"); 
		query.append("           F.SUB_TRD_CD   ," ).append("\n"); 
		query.append("           F.RLANE_CD     ," ).append("\n"); 
		query.append("           F.DIR_CD       ," ).append("\n"); 
		query.append("           F.IOC_TS_CD    ," ).append("\n"); 
		query.append("           F.RGN_OFC_CD   ," ).append("\n"); 
		query.append("           F.OFC_CD       ," ).append("\n"); 
		query.append("           F.SUB_OFC_CD   ," ).append("\n"); 
		query.append("           F.SREP_CD      ," ).append("\n"); 
		query.append("           NULL AS SREP_NM," ).append("\n"); 
		query.append("           F.CUST_TP_CD   ," ).append("\n"); 
		query.append("           F.CUST_CNT_CD  ," ).append("\n"); 
		query.append("           F.CUST_SEQ     ," ).append("\n"); 
		query.append("           F.POL_CD       ," ).append("\n"); 
		query.append("           F.POD_CD       ," ).append("\n"); 
		query.append("           F.VSL_CD       ," ).append("\n"); 
		query.append("           F.SKD_VOY_NO   ," ).append("\n"); 
		query.append("           F.SKD_DIR_CD   ," ).append("\n"); 
		query.append("           0 AS CHL       ," ).append("\n"); 
		query.append("           MAX(F.COST_YR) AS COST_YR," ).append("\n"); 
		query.append("           MAX(F.COST_WK) AS COST_WK," ).append("\n"); 
		query.append("           F.CTRL_LVL," ).append("\n"); 
		query.append("           F.CTRL_HC ," ).append("\n"); 
		query.append("           F.CTRL_45 ," ).append("\n"); 
		query.append("           F.CTRL_53 ," ).append("\n"); 
		query.append("           F.CTRL_RF ," ).append("\n"); 
		query.append("           F.CTRL_WT ," ).append("\n"); 
		query.append("           SUM(F.BKG_TTL_QTY)     AS BKG_TTL_QTY    ," ).append("\n"); 
		query.append("           SUM(F.BKG_20FT_QTY)    AS BKG_20FT_QTY   ," ).append("\n"); 
		query.append("           SUM(F.BKG_40FT_QTY)    AS BKG_40FT_QTY   ," ).append("\n"); 
		query.append("           SUM(F.BKG_40FT_HC_QTY) AS BKG_40FT_HC_QTY," ).append("\n"); 
		query.append("           SUM(F.BKG_45FT_HC_QTY) AS BKG_45FT_HC_QTY," ).append("\n"); 
		query.append("           SUM(F.BKG_53FT_QTY)    AS BKG_53FT_QTY   ," ).append("\n"); 
		query.append("           SUM(F.BKG_RF_QTY)      AS BKG_RF_QTY     ," ).append("\n"); 
		query.append("           SUM(F.BKG_TTL_WGT)     AS BKG_TTL_WGT" ).append("\n"); 
		query.append("      FROM BKG_DIV F" ).append("\n"); 
		query.append("  GROUP BY GROUPING SETS (" ).append("\n"); 
		query.append("                           ( F.TRD_CD     , F.SUB_TRD_CD, F.RLANE_CD  , F.DIR_CD    , F.IOC_TS_CD ," ).append("\n"); 
		query.append("                             F.RGN_OFC_CD , F.OFC_CD    , F.SUB_OFC_CD, F.SREP_CD   , F.CUST_TP_CD," ).append("\n"); 
		query.append("                             F.CUST_CNT_CD, F.CUST_SEQ  , F.POL_CD    , F.POD_CD    , F.VSL_CD    ," ).append("\n"); 
		query.append("                             F.SKD_VOY_NO , F.SKD_DIR_CD, F.CTRL_LVL  , F.CTRL_HC   , F.CTRL_45   ," ).append("\n"); 
		query.append("                             F.CTRL_53    , F.CTRL_RF    , F.CTRL_WT                                )," ).append("\n"); 
		query.append("                           ( F.TRD_CD     , F.SUB_TRD_CD, F.RLANE_CD  , F.DIR_CD    , F.IOC_TS_CD ," ).append("\n"); 
		query.append("                             F.RGN_OFC_CD , F.OFC_CD    , F.SUB_OFC_CD, F.SREP_CD   , F.CUST_TP_CD," ).append("\n"); 
		query.append("                             F.CUST_CNT_CD, F.CUST_SEQ  , F.POL_CD    , F.VSL_CD    , F.SKD_VOY_NO," ).append("\n"); 
		query.append("                             F.SKD_DIR_CD , F.CTRL_LVL  , F.CTRL_HC   , F.CTRL_45   , F.CTRL_53   ," ).append("\n"); 
		query.append("                             F.CTRL_RF    , F.CTRL_WT                                               )," ).append("\n"); 
		query.append("                           ( F.TRD_CD     , F.SUB_TRD_CD, F.RLANE_CD  , F.DIR_CD    , F.IOC_TS_CD ," ).append("\n"); 
		query.append("                             F.RGN_OFC_CD , F.OFC_CD    , F.SUB_OFC_CD, F.SREP_CD   , F.VSL_CD    ," ).append("\n"); 
		query.append("                             F.SKD_VOY_NO , F.SKD_DIR_CD, F.CTRL_LVL  , F.CTRL_HC   , F.CTRL_45   ," ).append("\n"); 
		query.append("                             F.CTRL_53    , F.CTRL_RF    , F.CTRL_WT                                )," ).append("\n"); 
		query.append("                           ( F.TRD_CD     , F.SUB_TRD_CD, F.RLANE_CD  , F.DIR_CD    , F.IOC_TS_CD ," ).append("\n"); 
		query.append("                             F.RGN_OFC_CD , F.POL_CD    , F.POD_CD    , F.VSL_CD    , F.SKD_VOY_NO," ).append("\n"); 
		query.append("                             F.SKD_DIR_CD , F.CTRL_LVL  , F.CTRL_HC   , F.CTRL_45   , F.CTRL_53   ," ).append("\n"); 
		query.append("                             F.CTRL_RF    , F.CTRL_WT                                               )," ).append("\n"); 
		query.append("                           ( F.TRD_CD     , F.SUB_TRD_CD, F.RLANE_CD  , F.DIR_CD    , F.IOC_TS_CD ," ).append("\n"); 
		query.append("                             F.RGN_OFC_CD , F.POL_CD    , F.VSL_CD    , F.SKD_VOY_NO, F.SKD_DIR_CD," ).append("\n"); 
		query.append("                             F.CTRL_LVL   , F.CTRL_HC   , F.CTRL_45   , F.CTRL_53   , F.CTRL_RF   ," ).append("\n"); 
		query.append("                             F.CTRL_WT                                                              )," ).append("\n"); 
		query.append("                           ( F.TRD_CD     , F.SUB_TRD_CD, F.RLANE_CD  , F.DIR_CD    , F.IOC_TS_CD ," ).append("\n"); 
		query.append("                             F.RGN_OFC_CD , F.VSL_CD    , F.SKD_VOY_NO, F.SKD_DIR_CD, F.CTRL_LVL  ," ).append("\n"); 
		query.append("                             F.CTRL_HC    , F.CTRL_45   , F.CTRL_53   , F.CTRL_RF   , F.CTRL_WT     )" ).append("\n"); 
		query.append("                         )" ).append("\n"); 
		query.append("    HAVING    SREP_CD     IS NULL " ).append("\n"); 
		query.append("           OR POL_CD      IS NULL" ).append("\n"); 
		query.append("           OR CUST_CNT_CD IS NOT NULL" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", ALL_DATA AS (" ).append("\n"); 
		query.append("    SELECT 'M' AS FLG            ," ).append("\n"); 
		query.append("           LVL1                  ," ).append("\n"); 
		query.append("           LVL2                  ," ).append("\n"); 
		query.append("           TRD_CD                ," ).append("\n"); 
		query.append("           SUB_TRD_CD            ," ).append("\n"); 
		query.append("           RLANE_CD              ," ).append("\n"); 
		query.append("           DIR_CD                ," ).append("\n"); 
		query.append("           IOC_TS_CD             ," ).append("\n"); 
		query.append("           RGN_OFC_CD            ," ).append("\n"); 
		query.append("           OFC_CD                ," ).append("\n"); 
		query.append("           SUB_OFC_CD            ," ).append("\n"); 
		query.append("           SREP_CD               ," ).append("\n"); 
		query.append("           SREP_NM               ," ).append("\n"); 
		query.append("           CUST_TP_CD            ," ).append("\n"); 
		query.append("           CUST_CNT_CD           ," ).append("\n"); 
		query.append("           CUST_SEQ              ," ).append("\n"); 
		query.append("           POL_CD                ," ).append("\n"); 
		query.append("           POD_CD                ," ).append("\n"); 
		query.append("           VSL_CD                ," ).append("\n"); 
		query.append("           SKD_VOY_NO            ," ).append("\n"); 
		query.append("           SKD_DIR_CD            ," ).append("\n"); 
		query.append("           COST_YR               ," ).append("\n"); 
		query.append("           COST_WK               ," ).append("\n"); 
		query.append("           CHL                   ," ).append("\n"); 
		query.append("           CTRL_LVL              ," ).append("\n"); 
		query.append("           CTRL_HC               ," ).append("\n"); 
		query.append("           CTRL_45               ," ).append("\n"); 
		query.append("           CTRL_53               ," ).append("\n"); 
		query.append("           CTRL_RF               ," ).append("\n"); 
		query.append("           CTRL_WT               ," ).append("\n"); 
		query.append("           0 AS FCAST_TTL_QTY    ," ).append("\n"); 
		query.append("           0 AS FCAST_40FT_HC_QTY," ).append("\n"); 
		query.append("           0 AS FCAST_45FT_HC_QTY," ).append("\n"); 
		query.append("           0 AS FCAST_53FT_QTY   ," ).append("\n"); 
		query.append("           0 AS FCAST_RF_QTY     ," ).append("\n"); 
		query.append("           0 AS FCAST_TTL_WGT    ," ).append("\n"); 
		query.append("           0 AS CFM_TTL_QTY      ," ).append("\n"); 
		query.append("           0 AS CFM_40FT_HC_QTY  ," ).append("\n"); 
		query.append("           0 AS CFM_45FT_HC_QTY  ," ).append("\n"); 
		query.append("           0 AS CFM_53FT_QTY     ," ).append("\n"); 
		query.append("           0 AS CFM_RF_QTY       ," ).append("\n"); 
		query.append("           0 AS CFM_TTL_WGT      ," ).append("\n"); 
		query.append("           0 AS BKG_TTL_QTY      ," ).append("\n"); 
		query.append("           0 AS BKG_20FT_QTY     ," ).append("\n"); 
		query.append("           0 AS BKG_40FT_QTY     ," ).append("\n"); 
		query.append("           0 AS BKG_40FT_HC_QTY  ," ).append("\n"); 
		query.append("           0 AS BKG_45FT_HC_QTY  ," ).append("\n"); 
		query.append("           0 AS BKG_53FT_QTY     ," ).append("\n"); 
		query.append("           0 AS BKG_RF_QTY       ," ).append("\n"); 
		query.append("           0 AS BKG_TTL_WGT" ).append("\n"); 
		query.append("      FROM MASTER_DATA" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT 'F' AS FLG          ," ).append("\n"); 
		query.append("           LVL1                ," ).append("\n"); 
		query.append("           LVL2                ," ).append("\n"); 
		query.append("           TRD_CD              ," ).append("\n"); 
		query.append("           SUB_TRD_CD          ," ).append("\n"); 
		query.append("           RLANE_CD            ," ).append("\n"); 
		query.append("           DIR_CD              ," ).append("\n"); 
		query.append("           IOC_TS_CD           ," ).append("\n"); 
		query.append("           RGN_OFC_CD          ," ).append("\n"); 
		query.append("           OFC_CD              ," ).append("\n"); 
		query.append("           SUB_OFC_CD          ," ).append("\n"); 
		query.append("           SREP_CD             ," ).append("\n"); 
		query.append("           SREP_NM             ," ).append("\n"); 
		query.append("           CUST_TP_CD          ," ).append("\n"); 
		query.append("           CUST_CNT_CD         ," ).append("\n"); 
		query.append("           CUST_SEQ            ," ).append("\n"); 
		query.append("           POL_CD              ," ).append("\n"); 
		query.append("           POD_CD              ," ).append("\n"); 
		query.append("           VSL_CD              ," ).append("\n"); 
		query.append("           SKD_VOY_NO          ," ).append("\n"); 
		query.append("           SKD_DIR_CD          ," ).append("\n"); 
		query.append("           COST_YR             ," ).append("\n"); 
		query.append("           COST_WK             ," ).append("\n"); 
		query.append("           CHL                 ," ).append("\n"); 
		query.append("           CTRL_LVL            ," ).append("\n"); 
		query.append("           CTRL_HC             ," ).append("\n"); 
		query.append("           CTRL_45             ," ).append("\n"); 
		query.append("           CTRL_53             ," ).append("\n"); 
		query.append("           CTRL_RF             ," ).append("\n"); 
		query.append("           CTRL_WT             ," ).append("\n"); 
		query.append("           FCAST_TTL_QTY       ," ).append("\n"); 
		query.append("           FCAST_40FT_HC_QTY   ," ).append("\n"); 
		query.append("           FCAST_45FT_HC_QTY   ," ).append("\n"); 
		query.append("           FCAST_53FT_QTY      ," ).append("\n"); 
		query.append("           FCAST_RF_QTY        ," ).append("\n"); 
		query.append("           FCAST_TTL_WGT       ," ).append("\n"); 
		query.append("           CFM_TTL_QTY         ," ).append("\n"); 
		query.append("           CFM_40FT_HC_QTY     ," ).append("\n"); 
		query.append("           CFM_45FT_HC_QTY     ," ).append("\n"); 
		query.append("           CFM_53FT_QTY        ," ).append("\n"); 
		query.append("           CFM_RF_QTY          ," ).append("\n"); 
		query.append("           CFM_TTL_WGT         ," ).append("\n"); 
		query.append("           0 AS BKG_TTL_QTY    ," ).append("\n"); 
		query.append("           0 AS BKG_20FT_QTY   ," ).append("\n"); 
		query.append("           0 AS BKG_40FT_QTY   ," ).append("\n"); 
		query.append("           0 AS BKG_40FT_HC_QTY," ).append("\n"); 
		query.append("           0 AS BKG_45FT_HC_QTY," ).append("\n"); 
		query.append("           0 AS BKG_53FT_QTY   ," ).append("\n"); 
		query.append("           0 AS BKG_RF_QTY     ," ).append("\n"); 
		query.append("           0 AS BKG_TTL_WGT" ).append("\n"); 
		query.append("      FROM FCAST_DATA" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT 'B' AS FLG            ," ).append("\n"); 
		query.append("           LVL1                  ," ).append("\n"); 
		query.append("           LVL2                  ," ).append("\n"); 
		query.append("           TRD_CD                ," ).append("\n"); 
		query.append("           SUB_TRD_CD            ," ).append("\n"); 
		query.append("           RLANE_CD              ," ).append("\n"); 
		query.append("           DIR_CD                ," ).append("\n"); 
		query.append("           IOC_TS_CD             ," ).append("\n"); 
		query.append("           RGN_OFC_CD            ," ).append("\n"); 
		query.append("           OFC_CD                ," ).append("\n"); 
		query.append("           SUB_OFC_CD            ," ).append("\n"); 
		query.append("           SREP_CD               ," ).append("\n"); 
		query.append("           SREP_NM               ," ).append("\n"); 
		query.append("           CUST_TP_CD            ," ).append("\n"); 
		query.append("           CUST_CNT_CD           ," ).append("\n"); 
		query.append("           CUST_SEQ              ," ).append("\n"); 
		query.append("           POL_CD                ," ).append("\n"); 
		query.append("           POD_CD                ," ).append("\n"); 
		query.append("           VSL_CD                ," ).append("\n"); 
		query.append("           SKD_VOY_NO            ," ).append("\n"); 
		query.append("           SKD_DIR_CD            ," ).append("\n"); 
		query.append("           COST_YR               ," ).append("\n"); 
		query.append("           COST_WK               ," ).append("\n"); 
		query.append("           CHL                   ," ).append("\n"); 
		query.append("           CTRL_LVL              ," ).append("\n"); 
		query.append("           CTRL_HC               ," ).append("\n"); 
		query.append("           CTRL_45               ," ).append("\n"); 
		query.append("           CTRL_53               ," ).append("\n"); 
		query.append("           CTRL_RF               ," ).append("\n"); 
		query.append("           CTRL_WT               ," ).append("\n"); 
		query.append("           0 AS FCAST_TTL_QTY    ," ).append("\n"); 
		query.append("           0 AS FCAST_40FT_HC_QTY," ).append("\n"); 
		query.append("           0 AS FCAST_45FT_HC_QTY," ).append("\n"); 
		query.append("           0 AS FCAST_53FT_QTY   ," ).append("\n"); 
		query.append("           0 AS FCAST_RF_QTY     ," ).append("\n"); 
		query.append("           0 AS FCAST_TTL_WGT    ," ).append("\n"); 
		query.append("           0 AS CFM_TTL_QTY      ," ).append("\n"); 
		query.append("           0 AS CFM_40FT_HC_QTY  ," ).append("\n"); 
		query.append("           0 AS CFM_45FT_HC_QTY  ," ).append("\n"); 
		query.append("           0 AS CFM_53FT_QTY     ," ).append("\n"); 
		query.append("           0 AS CFM_RF_QTY       ," ).append("\n"); 
		query.append("           0 AS CFM_TTL_WGT      ," ).append("\n"); 
		query.append("           BKG_TTL_QTY           ," ).append("\n"); 
		query.append("           BKG_20FT_QTY          ," ).append("\n"); 
		query.append("           BKG_40FT_QTY          ," ).append("\n"); 
		query.append("           BKG_40FT_HC_QTY       ," ).append("\n"); 
		query.append("           BKG_45FT_HC_QTY       ," ).append("\n"); 
		query.append("           BKG_53FT_QTY          ," ).append("\n"); 
		query.append("           BKG_RF_QTY            ," ).append("\n"); 
		query.append("           BKG_TTL_WGT" ).append("\n"); 
		query.append("      FROM BKG_DATA" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", ALL_DATA_VVD AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT" ).append("\n"); 
		query.append("           TRD_CD    ," ).append("\n"); 
		query.append("           SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD  ," ).append("\n"); 
		query.append("           DIR_CD    ," ).append("\n"); 
		query.append("           IOC_TS_CD ," ).append("\n"); 
		query.append("           VSL_CD    ," ).append("\n"); 
		query.append("           SKD_VOY_NO," ).append("\n"); 
		query.append("           SKD_DIR_CD," ).append("\n"); 
		query.append("           COST_YR   ," ).append("\n"); 
		query.append("           COST_WK" ).append("\n"); 
		query.append("      FROM ALL_DATA A" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", LANE_VVDS AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT" ).append("\n"); 
		query.append("           V.TRD_CD    ," ).append("\n"); 
		query.append("           V.SUB_TRD_CD," ).append("\n"); 
		query.append("           V.RLANE_CD  ," ).append("\n"); 
		query.append("           V.SKD_DIR_CD AS DIR_CD," ).append("\n"); 
		query.append("           D.IOC_TS_CD ," ).append("\n"); 
		query.append("           V.VSL_CD    ," ).append("\n"); 
		query.append("           V.SKD_VOY_NO," ).append("\n"); 
		query.append("           V.SKD_DIR_CD," ).append("\n"); 
		query.append("           SUBSTR(V.SLS_YRMON, 1, 4) AS COST_YR," ).append("\n"); 
		query.append("           V.COST_WK," ).append("\n"); 
		query.append("           V.ETD_DT" ).append("\n"); 
		query.append("      FROM ALL_DATA_VVD D," ).append("\n"); 
		query.append("           VVDS         V" ).append("\n"); 
		query.append("     WHERE D.TRD_CD = V.TRD_CD" ).append("\n"); 
		query.append("       AND D.SUB_TRD_CD = V.SUB_TRD_CD" ).append("\n"); 
		query.append("       AND D.RLANE_CD   = V.RLANE_CD" ).append("\n"); 
		query.append("       AND D.DIR_CD     = V.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND D.VSL_CD     = V.VSL_CD" ).append("\n"); 
		query.append("       AND D.SKD_VOY_NO = V.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND D.SKD_DIR_CD = V.SKD_DIR_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", LANE_WK AS (" ).append("\n"); 
		query.append("    SELECT TRD_CD    ," ).append("\n"); 
		query.append("           SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD  ," ).append("\n"); 
		query.append("           DIR_CD    ," ).append("\n"); 
		query.append("           IOC_TS_CD ," ).append("\n"); 
		query.append("           COST_YR   ," ).append("\n"); 
		query.append("           COST_WK   ," ).append("\n"); 
		query.append("           COUNT(1) AS VVD_CNT" ).append("\n"); 
		query.append("      FROM LANE_VVDS" ).append("\n"); 
		query.append("  GROUP BY TRD_CD    ," ).append("\n"); 
		query.append("           SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD  ," ).append("\n"); 
		query.append("           DIR_CD    ," ).append("\n"); 
		query.append("           IOC_TS_CD ," ).append("\n"); 
		query.append("           COST_YR   ," ).append("\n"); 
		query.append("           COST_WK" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", LANES AS (" ).append("\n"); 
		query.append("    SELECT TRD_CD    ," ).append("\n"); 
		query.append("           SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD  ," ).append("\n"); 
		query.append("           DIR_CD    ," ).append("\n"); 
		query.append("           IOC_TS_CD" ).append("\n"); 
		query.append("      FROM LANE_WK" ).append("\n"); 
		query.append("  GROUP BY TRD_CD    ," ).append("\n"); 
		query.append("           SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD  ," ).append("\n"); 
		query.append("           DIR_CD    ," ).append("\n"); 
		query.append("           IOC_TS_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", WEEKS AS (" ).append("\n"); 
		query.append("    SELECT COST_YR," ).append("\n"); 
		query.append("           COST_WK," ).append("\n"); 
		query.append("           LVL IDX," ).append("\n"); 
		query.append("           VVD_CNT," ).append("\n"); 
		query.append("           ROWNUM AS RNUM" ).append("\n"); 
		query.append("      FROM (" ).append("\n"); 
		query.append("              SELECT COST_YR," ).append("\n"); 
		query.append("                     COST_WK," ).append("\n"); 
		query.append("                     MAX(VVD_CNT) AS VVD_CNT" ).append("\n"); 
		query.append("                FROM LANE_WK" ).append("\n"); 
		query.append("            GROUP BY COST_YR," ).append("\n"); 
		query.append("                     COST_WK" ).append("\n"); 
		query.append("            ORDER BY COST_YR," ).append("\n"); 
		query.append("                     COST_WK" ).append("\n"); 
		query.append("           )," ).append("\n"); 
		query.append("           (" ).append("\n"); 
		query.append("              SELECT LEVEL LVL" ).append("\n"); 
		query.append("                FROM DUAL" ).append("\n"); 
		query.append("             CONNECT BY LEVEL <= 5" ).append("\n"); 
		query.append("           ) L" ).append("\n"); 
		query.append("     WHERE VVD_CNT >= LVL" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", LANE_WEEK AS (" ).append("\n"); 
		query.append("    SELECT L.TRD_CD," ).append("\n"); 
		query.append("           L.SUB_TRD_CD, " ).append("\n"); 
		query.append("           L.RLANE_CD  ," ).append("\n"); 
		query.append("           L.DIR_CD    ," ).append("\n"); 
		query.append("           L.IOC_TS_CD ," ).append("\n"); 
		query.append("           W.COST_YR   ," ).append("\n"); 
		query.append("           W.COST_WK   ," ).append("\n"); 
		query.append("           W.IDX       ," ).append("\n"); 
		query.append("           W.RNUM" ).append("\n"); 
		query.append("      FROM WEEKS W," ).append("\n"); 
		query.append("           LANES L" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", VVD_RANKS AS (" ).append("\n"); 
		query.append("    SELECT V.TRD_CD              ," ).append("\n"); 
		query.append("           V.SUB_TRD_CD          ," ).append("\n"); 
		query.append("           V.RLANE_CD            ," ).append("\n"); 
		query.append("           V.SKD_DIR_CD AS DIR_CD," ).append("\n"); 
		query.append("           V.IOC_TS_CD           ," ).append("\n"); 
		query.append("           V.VSL_CD              ," ).append("\n"); 
		query.append("           V.SKD_VOY_NO          ," ).append("\n"); 
		query.append("           V.SKD_DIR_CD          ," ).append("\n"); 
		query.append("           V.COST_YR             ," ).append("\n"); 
		query.append("           V.COST_WK             ," ).append("\n"); 
		query.append("           ROW_NUMBER() OVER (PARTITION BY V.TRD_CD, V.SUB_TRD_CD, V.RLANE_CD, V.SKD_DIR_CD, V.COST_YR, V.COST_WK" ).append("\n"); 
		query.append("                                  ORDER BY V.ETD_DT) AS RNK" ).append("\n"); 
		query.append("      FROM ALL_DATA_VVD D," ).append("\n"); 
		query.append("           LANE_VVDS V" ).append("\n"); 
		query.append("     WHERE D.TRD_CD     = V.TRD_CD" ).append("\n"); 
		query.append("       AND D.SUB_TRD_CD = V.SUB_TRD_CD" ).append("\n"); 
		query.append("       AND D.RLANE_CD   = V.RLANE_CD" ).append("\n"); 
		query.append("       AND D.DIR_CD     = V.DIR_CD" ).append("\n"); 
		query.append("       AND D.IOC_TS_CD  = V.IOC_TS_CD" ).append("\n"); 
		query.append("       AND D.VSL_CD     = V.VSL_CD" ).append("\n"); 
		query.append("       AND D.SKD_VOY_NO = V.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND D.SKD_DIR_CD = V.SKD_DIR_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", VVD_SEQ AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT" ).append("\n"); 
		query.append("           VR.TRD_CD    ," ).append("\n"); 
		query.append("           VR.SUB_TRD_CD," ).append("\n"); 
		query.append("           VR.RLANE_CD  ," ).append("\n"); 
		query.append("           VR.DIR_CD    ," ).append("\n"); 
		query.append("           VR.IOC_TS_CD ," ).append("\n"); 
		query.append("           VR.VSL_CD    ," ).append("\n"); 
		query.append("           VR.SKD_VOY_NO," ).append("\n"); 
		query.append("           VR.SKD_DIR_CD," ).append("\n"); 
		query.append("           VR.COST_YR   ," ).append("\n"); 
		query.append("           VR.COST_WK   ," ).append("\n"); 
		query.append("           LW.RNUM" ).append("\n"); 
		query.append("      FROM LANE_WEEK LW," ).append("\n"); 
		query.append("           VVD_RANKS VR" ).append("\n"); 
		query.append("     WHERE VR.TRD_CD     = LW.TRD_CD" ).append("\n"); 
		query.append("       AND VR.SUB_TRD_CD = LW.SUB_TRD_CD" ).append("\n"); 
		query.append("       AND VR.RLANE_CD   = LW.RLANE_CD" ).append("\n"); 
		query.append("       AND VR.DIR_CD     = LW.DIR_CD" ).append("\n"); 
		query.append("       AND VR.IOC_TS_CD  = LW.IOC_TS_CD" ).append("\n"); 
		query.append("       AND VR.COST_YR    = LW.COST_YR" ).append("\n"); 
		query.append("       AND VR.COST_WK    = LW.COST_WK" ).append("\n"); 
		query.append("       AND VR.RNK        = LW.IDX" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", VVD_POS AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT" ).append("\n"); 
		query.append("           TRD_CD    ," ).append("\n"); 
		query.append("           SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD  ," ).append("\n"); 
		query.append("           DIR_CD    ," ).append("\n"); 
		query.append("           IOC_TS_CD ," ).append("\n"); 
		query.append("           VSL_CD    ," ).append("\n"); 
		query.append("           SKD_VOY_NO," ).append("\n"); 
		query.append("           SKD_DIR_CD," ).append("\n"); 
		query.append("           COST_YR   ," ).append("\n"); 
		query.append("           COST_WK   ," ).append("\n"); 
		query.append("           RNUM" ).append("\n"); 
		query.append("      FROM VVD_SEQ" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT DISTINCT" ).append("\n"); 
		query.append("           TRD_CD    ," ).append("\n"); 
		query.append("           SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD  ," ).append("\n"); 
		query.append("           DIR_CD    ," ).append("\n"); 
		query.append("           IOC_TS_CD ," ).append("\n"); 
		query.append("           'TTL' AS VSL_CD    ," ).append("\n"); 
		query.append("           ' '   AS SKD_VOY_NO," ).append("\n"); 
		query.append("           ' '   AS SKD_DIR_CD," ).append("\n"); 
		query.append("           'TTL' AS COST_YR   ," ).append("\n"); 
		query.append("           NULL  AS COST_WK   ," ).append("\n"); 
		query.append("           (" ).append("\n"); 
		query.append("              SELECT MAX(RNUM) + 1" ).append("\n"); 
		query.append("                FROM VVD_SEQ" ).append("\n"); 
		query.append("           ) AS RNUM" ).append("\n"); 
		query.append("      FROM VVD_SEQ" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", POL_SEQ AS (" ).append("\n"); 
		query.append("    SELECT TRD_CD                   ," ).append("\n"); 
		query.append("           SUB_TRD_CD               ," ).append("\n"); 
		query.append("           RLANE_CD                 ," ).append("\n"); 
		query.append("           SKD_DIR_CD     AS DIR_CD ," ).append("\n"); 
		query.append("           IOC_TS_CD                ," ).append("\n"); 
		query.append("           POL_CD                   ," ).append("\n"); 
		query.append("           MIN(CD_DP_SEQ) AS POL_SEQ" ).append("\n"); 
		query.append("      FROM VVD_POL" ).append("\n"); 
		query.append("  GROUP BY TRD_CD    ," ).append("\n"); 
		query.append("           SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD  ," ).append("\n"); 
		query.append("           SKD_DIR_CD," ).append("\n"); 
		query.append("           IOC_TS_CD ," ).append("\n"); 
		query.append("           POL_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", POL_POD_SEQ AS (" ).append("\n"); 
		query.append("    SELECT TRD_CD                   ," ).append("\n"); 
		query.append("           SUB_TRD_CD               ," ).append("\n"); 
		query.append("           RLANE_CD                 ," ).append("\n"); 
		query.append("           SKD_DIR_CD     AS DIR_CD ," ).append("\n"); 
		query.append("           IOC_TS_CD                ," ).append("\n"); 
		query.append("           POL_CD                   ," ).append("\n"); 
		query.append("           MIN(CD_DP_SEQ) AS POL_SEQ," ).append("\n"); 
		query.append("           POD_CD                   ," ).append("\n"); 
		query.append("           MIN(POD_SEQ)   AS POD_SEQ" ).append("\n"); 
		query.append("      FROM VVD_POL_POD" ).append("\n"); 
		query.append("  GROUP BY TRD_CD    ," ).append("\n"); 
		query.append("           SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD  ," ).append("\n"); 
		query.append("           SKD_DIR_CD," ).append("\n"); 
		query.append("           IOC_TS_CD ," ).append("\n"); 
		query.append("           POL_CD    ," ).append("\n"); 
		query.append("           POD_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", QTA_DATA AS (" ).append("\n"); 
		query.append("    SELECT V.TRD_CD    ," ).append("\n"); 
		query.append("           V.SUB_TRD_CD," ).append("\n"); 
		query.append("           V.RLANE_CD  ," ).append("\n"); 
		query.append("           V.DIR_CD    ," ).append("\n"); 
		query.append("           P.IOC_TS_CD ," ).append("\n"); 
		query.append("           MQ.RGN_OFC_CD        AS RGN_OFC_CD," ).append("\n"); 
		query.append("           NVL(V.VSL_CD, 'TTL') AS VSL_CD    ," ).append("\n"); 
		query.append("           V.SKD_VOY_NO," ).append("\n"); 
		query.append("           V.SKD_DIR_CD," ).append("\n"); 
		query.append("           NVL(SUBSTR(V.SLS_YRMON, 1, 4), 'TTL') AS COST_YR," ).append("\n"); 
		query.append("           V.COST_WK ," ).append("\n"); 
		query.append("           V.CTRL_LVL," ).append("\n"); 
		query.append("           V.CTRL_HC ," ).append("\n"); 
		query.append("           V.CTRL_45 ," ).append("\n"); 
		query.append("           V.CTRL_53 ," ).append("\n"); 
		query.append("           V.CTRL_RF ," ).append("\n"); 
		query.append("           V.CTRL_WT ," ).append("\n"); 
		query.append("           SUM(MQ.LOD_QTY) AS LOD_QTY" ).append("\n"); 
		query.append("      FROM SQM_QTA_RLSE_VER MQR," ).append("\n"); 
		query.append("           SQM_CFM_QTA      MQ ," ).append("\n"); 
		query.append("           VVDS             V  ," ).append("\n"); 
		query.append("           PARAMS           P" ).append("\n"); 
		query.append("     WHERE P.SUB_OFC_CD   IS NULL" ).append("\n"); 
		query.append("       AND P.SALES_REP_CD IS NULL" ).append("\n"); 
		query.append("       AND MQR.BSE_YR          = SUBSTR(V.COST_YRMON, 1, 4)" ).append("\n"); 
		query.append("--       AND MQR.BSE_QTR_CD      = CEIL(TO_NUMBER(DECODE(V.COST_WK,'00','01','53','52',V.COST_WK))/13)||'Q' --CEIL(TO_NUMBER(SUBSTR(V.SLS_YRMON, 5, 4)) / 3)||'Q'" ).append("\n"); 
		query.append("       AND MQR.BSE_QTR_CD      = V.BSE_QTR_CD" ).append("\n"); 
		query.append("       AND MQR.SQM_VER_STS_CD  = 'R' -- 20131205 수정" ).append("\n"); 
		query.append("       AND MQR.BSE_TP_CD       = 'Q' -- 분기 20131205추가" ).append("\n"); 
		query.append("       AND MQ.QTA_RLSE_VER_NO = MQR.QTA_RLSE_VER_NO -- 컬럼명 변경 20131205 QTA_RLSE_VER_NO" ).append("\n"); 
		query.append("       AND MQ.BSE_TP_CD        = MQR.BSE_TP_CD -- 분기 20131205추가   " ).append("\n"); 
		query.append("       AND MQ.BSE_YR           = MQR.BSE_YR" ).append("\n"); 
		query.append("       AND MQ.BSE_QTR_CD       = MQR.BSE_QTR_CD" ).append("\n"); 
		query.append("       AND MQ.QTA_TGT_CD       = 'D'  -- 'T' => 'D'로 수정 20131205" ).append("\n"); 
		query.append("       AND MQ.OFC_VW_CD        = 'L'  -- 20131205추가" ).append("\n"); 
		query.append("       --AND MQ.BSE_MON          = SUBSTR(V.SLS_YRMON, 5, 4) 20131205 제거" ).append("\n"); 
		query.append("       AND MQ.TRD_CD           = V.TRD_CD" ).append("\n"); 
		query.append("       AND MQ.RLANE_CD         = V.RLANE_CD" ).append("\n"); 
		query.append("       AND MQ.DIR_CD           = V.DIR_CD" ).append("\n"); 
		query.append("       AND MQ.VSL_CD           = V.VSL_CD" ).append("\n"); 
		query.append("       AND MQ.SKD_VOY_NO       = V.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND MQ.SKD_DIR_CD       = V.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND MQ.RGN_OFC_CD       = P.RGN_OFC_CD" ).append("\n"); 
		query.append("  GROUP BY V.TRD_CD     ," ).append("\n"); 
		query.append("           V.SUB_TRD_CD ," ).append("\n"); 
		query.append("           V.RLANE_CD   ," ).append("\n"); 
		query.append("           V.DIR_CD     ," ).append("\n"); 
		query.append("           P.IOC_TS_CD  ," ).append("\n"); 
		query.append("           MQ.RGN_OFC_CD," ).append("\n"); 
		query.append("           SUBSTR(V.SLS_YRMON, 1, 4)," ).append("\n"); 
		query.append("           V.COST_WK    ," ).append("\n"); 
		query.append("           V.VSL_CD     ," ).append("\n"); 
		query.append("           V.SKD_VOY_NO ," ).append("\n"); 
		query.append("           V.SKD_DIR_CD ," ).append("\n"); 
		query.append("           V.CTRL_LVL   ," ).append("\n"); 
		query.append("           V.CTRL_HC    ," ).append("\n"); 
		query.append("           V.CTRL_45    ," ).append("\n"); 
		query.append("           V.CTRL_53    ," ).append("\n"); 
		query.append("           V.CTRL_RF    ," ).append("\n"); 
		query.append("           V.CTRL_WT" ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- OLD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--    SELECT V.TRD_CD    ," ).append("\n"); 
		query.append("--           V.SUB_TRD_CD," ).append("\n"); 
		query.append("--           V.RLANE_CD  ," ).append("\n"); 
		query.append("--           V.DIR_CD    ," ).append("\n"); 
		query.append("--           P.IOC_TS_CD ," ).append("\n"); 
		query.append("--           MQ.RGN_OFC_CD        AS RGN_OFC_CD," ).append("\n"); 
		query.append("--           NVL(V.VSL_CD, 'TTL') AS VSL_CD    ," ).append("\n"); 
		query.append("--           V.SKD_VOY_NO," ).append("\n"); 
		query.append("--           V.SKD_DIR_CD," ).append("\n"); 
		query.append("--           NVL(SUBSTR(V.SLS_YRMON, 1, 4), 'TTL') AS COST_YR," ).append("\n"); 
		query.append("--           V.COST_WK ," ).append("\n"); 
		query.append("--           V.CTRL_LVL," ).append("\n"); 
		query.append("--           V.CTRL_HC ," ).append("\n"); 
		query.append("--           V.CTRL_45 ," ).append("\n"); 
		query.append("--           V.CTRL_53 ," ).append("\n"); 
		query.append("--           V.CTRL_RF ," ).append("\n"); 
		query.append("--           V.CTRL_WT ," ).append("\n"); 
		query.append("--           SUM(MQ.LOD_QTY) AS LOD_QTY" ).append("\n"); 
		query.append("--      FROM SAQ_MON_QTA_RLSE MQR," ).append("\n"); 
		query.append("--           SAQ_MON_CFM_QTA  MQ ," ).append("\n"); 
		query.append("--           VVDS             V  ," ).append("\n"); 
		query.append("--           PARAMS           P" ).append("\n"); 
		query.append("--     WHERE P.SUB_OFC_CD   IS NULL" ).append("\n"); 
		query.append("--       AND P.SALES_REP_CD IS NULL" ).append("\n"); 
		query.append("--       AND MQR.BSE_YR          = SUBSTR(V.SLS_YRMON, 1, 4)" ).append("\n"); 
		query.append("--       AND MQR.BSE_QTR_CD      = CEIL(TO_NUMBER(SUBSTR(V.SLS_YRMON, 5, 4)) / 3)||'Q'" ).append("\n"); 
		query.append("--       AND MQR.QTA_RLSE_STS_CD = 'R'" ).append("\n"); 
		query.append("--       AND MQ.MQTA_RLSE_VER_NO = MQR.MQTA_RLSE_VER_NO" ).append("\n"); 
		query.append("--       AND MQ.BSE_YR           = MQR.BSE_YR" ).append("\n"); 
		query.append("--       AND MQ.BSE_QTR_CD       = MQR.BSE_QTR_CD" ).append("\n"); 
		query.append("--       AND MQ.QTA_TGT_CD       = 'T'" ).append("\n"); 
		query.append("--       AND MQ.BSE_MON          = SUBSTR(V.SLS_YRMON, 5, 4)" ).append("\n"); 
		query.append("--       AND MQ.TRD_CD           = V.TRD_CD" ).append("\n"); 
		query.append("--       AND MQ.RLANE_CD         = V.RLANE_CD" ).append("\n"); 
		query.append("--       AND MQ.DIR_CD           = V.DIR_CD" ).append("\n"); 
		query.append("--       AND MQ.VSL_CD           = V.VSL_CD" ).append("\n"); 
		query.append("--       AND MQ.SKD_VOY_NO       = V.SKD_VOY_NO" ).append("\n"); 
		query.append("--       AND MQ.SKD_DIR_CD       = V.SKD_DIR_CD" ).append("\n"); 
		query.append("--       AND MQ.RGN_OFC_CD       = P.RGN_OFC_CD" ).append("\n"); 
		query.append("--  GROUP BY V.TRD_CD     ," ).append("\n"); 
		query.append("--           V.SUB_TRD_CD ," ).append("\n"); 
		query.append("--           V.RLANE_CD   ," ).append("\n"); 
		query.append("--           V.DIR_CD     ," ).append("\n"); 
		query.append("--           P.IOC_TS_CD  ," ).append("\n"); 
		query.append("--           MQ.RGN_OFC_CD," ).append("\n"); 
		query.append("--           SUBSTR(V.SLS_YRMON, 1, 4)," ).append("\n"); 
		query.append("--           V.COST_WK    ," ).append("\n"); 
		query.append("--           V.VSL_CD     ," ).append("\n"); 
		query.append("--           V.SKD_VOY_NO ," ).append("\n"); 
		query.append("--           V.SKD_DIR_CD ," ).append("\n"); 
		query.append("--           V.CTRL_LVL   ," ).append("\n"); 
		query.append("--           V.CTRL_HC    ," ).append("\n"); 
		query.append("--           V.CTRL_45    ," ).append("\n"); 
		query.append("--           V.CTRL_53    ," ).append("\n"); 
		query.append("--           V.CTRL_RF    ," ).append("\n"); 
		query.append("--           V.CTRL_WT           " ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", ALOC_DATA AS (" ).append("\n"); 
		query.append("    SELECT V.TRD_CD    ," ).append("\n"); 
		query.append("           V.SUB_TRD_CD," ).append("\n"); 
		query.append("           V.RLANE_CD  ," ).append("\n"); 
		query.append("           V.DIR_CD    ," ).append("\n"); 
		query.append("           P.IOC_TS_CD ," ).append("\n"); 
		query.append("           P.RGN_OFC_CD," ).append("\n"); 
		query.append("           NVL(V.VSL_CD, 'TTL') AS VSL_CD," ).append("\n"); 
		query.append("           V.SKD_VOY_NO," ).append("\n"); 
		query.append("           V.SKD_DIR_CD ," ).append("\n"); 
		query.append("           NVL(SUBSTR(V.SLS_YRMON, 1, 4), 'TTL') AS COST_YR," ).append("\n"); 
		query.append("           V.COST_WK ," ).append("\n"); 
		query.append("           V.CTRL_LVL," ).append("\n"); 
		query.append("           V.CTRL_HC ," ).append("\n"); 
		query.append("           V.CTRL_45 ," ).append("\n"); 
		query.append("           V.CTRL_53 ," ).append("\n"); 
		query.append("           V.CTRL_RF ," ).append("\n"); 
		query.append("           V.CTRL_WT ," ).append("\n"); 
		query.append("           SUM(A.ASGN_TTL_QTY) AS LOD_QTY" ).append("\n"); 
		query.append("      FROM SPC_ALOC_POL_POD A," ).append("\n"); 
		query.append("           VVDS             V," ).append("\n"); 
		query.append("           PARAMS           P" ).append("\n"); 
		query.append("     WHERE P.SUB_OFC_CD   IS NULL" ).append("\n"); 
		query.append("       AND P.SALES_REP_CD IS NULL" ).append("\n"); 
		query.append("       AND A.RLANE_CD        = V.RLANE_CD" ).append("\n"); 
		query.append("       AND A.DIR_CD          = V.DIR_CD" ).append("\n"); 
		query.append("       AND A.VSL_CD          = V.VSL_CD" ).append("\n"); 
		query.append("       AND A.SKD_VOY_NO      = V.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND A.SKD_DIR_CD      = V.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND A.SLS_RGN_OFC_CD  = P.RGN_OFC_CD" ).append("\n"); 
		query.append("       AND A.TS_FLG          = DECODE(P.IOC_TS_CD, 'T', 'Y', 'N')" ).append("\n"); 
		query.append("       AND A.IOC_CD          = DECODE(P.IOC_TS_CD, 'O', 'O', 'I')" ).append("\n"); 
		query.append("  GROUP BY V.TRD_CD    ," ).append("\n"); 
		query.append("           V.SUB_TRD_CD," ).append("\n"); 
		query.append("           V.RLANE_CD  ," ).append("\n"); 
		query.append("           V.DIR_CD    ," ).append("\n"); 
		query.append("           P.IOC_TS_CD ," ).append("\n"); 
		query.append("           P.RGN_OFC_CD," ).append("\n"); 
		query.append("           V.VSL_CD    ," ).append("\n"); 
		query.append("           V.SKD_VOY_NO," ).append("\n"); 
		query.append("           V.SKD_DIR_CD," ).append("\n"); 
		query.append("           SUBSTR(V.SLS_YRMON, 1, 4)," ).append("\n"); 
		query.append("           V.COST_WK   ," ).append("\n"); 
		query.append("           V.CTRL_LVL  ," ).append("\n"); 
		query.append("           V.CTRL_HC   ," ).append("\n"); 
		query.append("           V.CTRL_45   ," ).append("\n"); 
		query.append("           V.CTRL_53   ," ).append("\n"); 
		query.append("           V.CTRL_RF   ," ).append("\n"); 
		query.append("           V.CTRL_WT" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", QTA_ALOC_DATA AS (" ).append("\n"); 
		query.append("    SELECT 1 AS LVL1 ," ).append("\n"); 
		query.append("           0 AS LVL2 ," ).append("\n"); 
		query.append("           TRD_CD    ," ).append("\n"); 
		query.append("           SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD  ," ).append("\n"); 
		query.append("           DIR_CD    ," ).append("\n"); 
		query.append("           IOC_TS_CD ," ).append("\n"); 
		query.append("           RGN_OFC_CD," ).append("\n"); 
		query.append("           NVL(VSL_CD    , 'TTL') AS VSL_CD    ," ).append("\n"); 
		query.append("           NVL(SKD_VOY_NO, ' ')   AS SKD_VOY_NO," ).append("\n"); 
		query.append("           NVL(SKD_DIR_CD, ' ')   AS SKD_DIR_CD," ).append("\n"); 
		query.append("           NVL(COST_YR   , 'TTL') AS COST_YR   ," ).append("\n"); 
		query.append("           COST_WK," ).append("\n"); 
		query.append("           ROUND(SUM(QTA_LOD_QTY)) || '/' || SUM(ALOC_LOD_QTA) AS LOD_QTY" ).append("\n"); 
		query.append("      FROM (" ).append("\n"); 
		query.append("              SELECT 1 AS FLG    ," ).append("\n"); 
		query.append("                     V.TRD_CD    ," ).append("\n"); 
		query.append("                     V.SUB_TRD_CD," ).append("\n"); 
		query.append("                     V.RLANE_CD  ," ).append("\n"); 
		query.append("                     V.DIR_CD    ," ).append("\n"); 
		query.append("                     V.IOC_TS_CD ," ).append("\n"); 
		query.append("                     P.RGN_OFC_CD," ).append("\n"); 
		query.append("                     V.VSL_CD    ," ).append("\n"); 
		query.append("                     V.SKD_VOY_NO," ).append("\n"); 
		query.append("                     V.SKD_DIR_CD," ).append("\n"); 
		query.append("                     V.COST_YR   ," ).append("\n"); 
		query.append("                     V.COST_WK   ," ).append("\n"); 
		query.append("                     A.LOD_QTY AS QTA_LOD_QTY ," ).append("\n"); 
		query.append("                     0         AS ALOC_LOD_QTA" ).append("\n"); 
		query.append("                FROM QTA_DATA  A," ).append("\n"); 
		query.append("                     VVD_RANKS V," ).append("\n"); 
		query.append("                     PARAMS    P" ).append("\n"); 
		query.append("               WHERE P.SUB_OFC_CD   IS NULL" ).append("\n"); 
		query.append("                 AND P.SALES_REP_CD IS NULL" ).append("\n"); 
		query.append("                 AND A.TRD_CD    (+) = V.TRD_CD" ).append("\n"); 
		query.append("                 AND A.SUB_TRD_CD(+) = V.SUB_TRD_CD" ).append("\n"); 
		query.append("                 AND A.RLANE_CD  (+) = V.RLANE_CD" ).append("\n"); 
		query.append("                 AND A.DIR_CD    (+) = V.DIR_CD" ).append("\n"); 
		query.append("                 AND A.VSL_CD    (+) = V.VSL_CD" ).append("\n"); 
		query.append("                 AND NVL(A.SKD_VOY_NO(+), ' ') = NVL(V.SKD_VOY_NO, ' ')" ).append("\n"); 
		query.append("                 AND NVL(A.SKD_DIR_CD(+), ' ') = NVL(V.SKD_DIR_CD, ' ')" ).append("\n"); 
		query.append("              UNION ALL" ).append("\n"); 
		query.append("              SELECT 2 AS FLG    ," ).append("\n"); 
		query.append("                     V.TRD_CD    ," ).append("\n"); 
		query.append("                     V.SUB_TRD_CD," ).append("\n"); 
		query.append("                     V.RLANE_CD  ," ).append("\n"); 
		query.append("                     V.DIR_CD    ," ).append("\n"); 
		query.append("                     V.IOC_TS_CD ," ).append("\n"); 
		query.append("                     P.RGN_OFC_CD," ).append("\n"); 
		query.append("                     V.VSL_CD    ," ).append("\n"); 
		query.append("                     V.SKD_VOY_NO," ).append("\n"); 
		query.append("                     V.SKD_DIR_CD," ).append("\n"); 
		query.append("                     V.COST_YR   ," ).append("\n"); 
		query.append("                     V.COST_WK   ," ).append("\n"); 
		query.append("                     0         AS QTA_LOD_QTY ," ).append("\n"); 
		query.append("                     A.LOD_QTY AS ALOC_LOD_QTA" ).append("\n"); 
		query.append("                FROM ALOC_DATA A," ).append("\n"); 
		query.append("                     VVD_RANKS V," ).append("\n"); 
		query.append("                     PARAMS    P" ).append("\n"); 
		query.append("               WHERE P.SUB_OFC_CD   IS NULL" ).append("\n"); 
		query.append("                 AND P.SALES_REP_CD IS NULL" ).append("\n"); 
		query.append("                 AND A.TRD_CD    (+) = V.TRD_CD" ).append("\n"); 
		query.append("                 AND A.SUB_TRD_CD(+) = V.SUB_TRD_CD" ).append("\n"); 
		query.append("                 AND A.RLANE_CD  (+) = V.RLANE_CD" ).append("\n"); 
		query.append("                 AND A.DIR_CD    (+) = V.DIR_CD" ).append("\n"); 
		query.append("                 AND A.VSL_CD    (+) = V.VSL_CD" ).append("\n"); 
		query.append("                 AND NVL(A.SKD_VOY_NO(+), ' ') = NVL(V.SKD_VOY_NO, ' ')" ).append("\n"); 
		query.append("                 AND NVL(A.SKD_DIR_CD(+), ' ') = NVL(V.SKD_DIR_CD, ' ')" ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append("  GROUP BY GROUPING SETS (" ).append("\n"); 
		query.append("                           ( TRD_CD    , SUB_TRD_CD, RLANE_CD, DIR_CD    ," ).append("\n"); 
		query.append("                             IOC_TS_CD , RGN_OFC_CD, VSL_CD  , SKD_VOY_NO," ).append("\n"); 
		query.append("                             SKD_DIR_CD, COST_YR   , COST_WK               )," ).append("\n"); 
		query.append("                           ( TRD_CD    , SUB_TRD_CD, RLANE_CD, DIR_CD    ," ).append("\n"); 
		query.append("                             IOC_TS_CD , RGN_OFC_CD                        )" ).append("\n"); 
		query.append("                         )" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", ALL_SUM_DATA AS (" ).append("\n"); 
		query.append("    SELECT NVL(A.LVL1, 0) AS LVL1," ).append("\n"); 
		query.append("           NVL(A.LVL2, 0) AS LVL2," ).append("\n"); 
		query.append("           SUM(DECODE(A.FLG, 'M', 1, 0)) AS MST_CNT  ," ).append("\n"); 
		query.append("           SUM(DECODE(A.FLG, 'F', 1, 0)) AS FCAST_CNT," ).append("\n"); 
		query.append("           SUM(DECODE(A.FLG, 'B', 1, 0)) AS BKG_CNT  ," ).append("\n"); 
		query.append("           A.TRD_CD    ," ).append("\n"); 
		query.append("           A.SUB_TRD_CD," ).append("\n"); 
		query.append("           A.RLANE_CD  ," ).append("\n"); 
		query.append("           A.DIR_CD    ," ).append("\n"); 
		query.append("           A.IOC_TS_CD ," ).append("\n"); 
		query.append("           A.RGN_OFC_CD," ).append("\n"); 
		query.append("           O.SUB_OFC_CD," ).append("\n"); 
		query.append("           A.OFC_CD    ," ).append("\n"); 
		query.append("           A.SREP_CD   ," ).append("\n"); 
		query.append("           COUNT(A.CUST_TP_CD) AS CUST_CNT," ).append("\n"); 
		query.append("           A.CUST_TP_CD ," ).append("\n"); 
		query.append("           A.CUST_CNT_CD," ).append("\n"); 
		query.append("           A.CUST_SEQ   ," ).append("\n"); 
		query.append("           A.POL_CD     ," ).append("\n"); 
		query.append("           A.POD_CD     ," ).append("\n"); 
		query.append("           NVL(A.VSL_CD    , 'TTL') AS VSL_CD    ," ).append("\n"); 
		query.append("           NVL(A.SKD_VOY_NO, ' ')   AS SKD_VOY_NO," ).append("\n"); 
		query.append("           NVL(A.SKD_DIR_CD, ' ')   AS SKD_DIR_CD," ).append("\n"); 
		query.append("           MAX(A.COST_YR) AS COST_YR," ).append("\n"); 
		query.append("           MAX(A.COST_WK) AS COST_WK," ).append("\n"); 
		query.append("           SUM(A.CHL)     AS CHL    ," ).append("\n"); 
		query.append("           A.CTRL_LVL," ).append("\n"); 
		query.append("           A.CTRL_HC ," ).append("\n"); 
		query.append("           A.CTRL_45 ," ).append("\n"); 
		query.append("           A.CTRL_53 ," ).append("\n"); 
		query.append("           A.CTRL_RF ," ).append("\n"); 
		query.append("           A.CTRL_WT ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.FCAST_TTL_QTY))     AS FCAST_TTL_QTY    ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.FCAST_40FT_HC_QTY)) AS FCAST_40FT_HC_QTY," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.FCAST_45FT_HC_QTY)) AS FCAST_45FT_HC_QTY," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.FCAST_53FT_QTY))    AS FCAST_53FT_QTY   ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.FCAST_RF_QTY))      AS FCAST_RF_QTY     ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.FCAST_TTL_WGT))     AS FCAST_TTL_WGT    ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.CFM_TTL_QTY))       AS CFM_TTL_QTY      ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.CFM_40FT_HC_QTY))   AS CFM_40FT_HC_QTY  ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.CFM_45FT_HC_QTY))   AS CFM_45FT_HC_QTY  ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.CFM_53FT_QTY))      AS CFM_53FT_QTY     ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.CFM_RF_QTY))        AS CFM_RF_QTY       ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.CFM_TTL_WGT))       AS CFM_TTL_WGT      ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.BKG_TTL_QTY))       AS BKG_TTL_QTY      ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.BKG_20FT_QTY))      AS BKG_20FT_QTY     ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.BKG_40FT_QTY))      AS BKG_40FT_QTY     ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.BKG_40FT_HC_QTY))   AS BKG_40FT_HC_QTY  ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.BKG_45FT_HC_QTY))   AS BKG_45FT_HC_QTY  ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.BKG_53FT_QTY))      AS BKG_53FT_QTY     ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.BKG_RF_QTY))        AS BKG_RF_QTY       ," ).append("\n"); 
		query.append("           TO_CHAR(SUM(A.BKG_TTL_WGT))       AS BKG_TTL_WGT" ).append("\n"); 
		query.append("      FROM ALL_DATA A," ).append("\n"); 
		query.append("           OFFICES  O" ).append("\n"); 
		query.append("     WHERE A.OFC_CD     = O.OFC_CD(+)" ).append("\n"); 
		query.append("#if (${salesoffice} == 'SELSC')" ).append("\n"); 
		query.append("       AND A.SUB_OFC_CD = O.SUB_OFC_CD  (+)" ).append("\n"); 
		query.append("       AND A.RGN_OFC_CD = O.RGN_OFC_CD  (+)" ).append("\n"); 
		query.append("       AND A.SREP_CD    = O.SALES_REP_CD(+)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  GROUP BY GROUPING SETS (" ).append("\n"); 
		query.append("                           ( A.LVL1      , A.LVL2      , A.TRD_CD     , A.SUB_TRD_CD , A.RLANE_CD  ," ).append("\n"); 
		query.append("                             A.DIR_CD    , A.IOC_TS_CD , A.CTRL_LVL   , A.CTRL_HC    , A.CTRL_45   ," ).append("\n"); 
		query.append("                             A.CTRL_53   , A.CTRL_RF   , A.CTRL_WT    , A.RGN_OFC_CD , O.SUB_OFC_CD," ).append("\n"); 
		query.append("                             A.OFC_CD    , A.SREP_CD   , A.CUST_TP_CD , A.CUST_CNT_CD, A.CUST_SEQ  ," ).append("\n"); 
		query.append("                             A.POL_CD    , A.POD_CD    , A.VSL_CD     , A.SKD_VOY_NO , A.SKD_DIR_CD  )," ).append("\n"); 
		query.append("                           ( A.LVL1      , A.LVL2      , A.TRD_CD     , A.SUB_TRD_CD , A.RLANE_CD  ," ).append("\n"); 
		query.append("                             A.DIR_CD    , A.IOC_TS_CD , A.RGN_OFC_CD , O.SUB_OFC_CD , A.OFC_CD    ," ).append("\n"); 
		query.append("                             A.SREP_CD   , A.CUST_TP_CD, A.CUST_CNT_CD, A.CUST_SEQ   , A.POL_CD    ," ).append("\n"); 
		query.append("                             A.POD_CD                                                                )," ).append("\n"); 
		query.append("                           ( A.TRD_CD    , A.SUB_TRD_CD, A.RLANE_CD   , A.DIR_CD    , A.IOC_TS_CD  ," ).append("\n"); 
		query.append("                             A.CTRL_LVL  , A.CTRL_HC   , A.CTRL_45    , A.CTRL_53   , A.CTRL_RF    ," ).append("\n"); 
		query.append("                             A.CTRL_WT   , A.RGN_OFC_CD, A.VSL_CD     , A.SKD_VOY_NO, A.SKD_DIR_CD   )," ).append("\n"); 
		query.append("                           ( A.TRD_CD    , A.SUB_TRD_CD, A.RLANE_CD   , A.DIR_CD    , A.IOC_TS_CD  ," ).append("\n"); 
		query.append("                             A.RGN_OFC_CD                                                            )" ).append("\n"); 
		query.append("                         )" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT LVL1                     ," ).append("\n"); 
		query.append("           LVL2                     ," ).append("\n"); 
		query.append("           0 AS MST_CNT             ," ).append("\n"); 
		query.append("           0 AS FCAST_CNT           ," ).append("\n"); 
		query.append("           0 AS BKG_CNT             ," ).append("\n"); 
		query.append("           TRD_CD                   ," ).append("\n"); 
		query.append("           SUB_TRD_CD               ," ).append("\n"); 
		query.append("           RLANE_CD                 ," ).append("\n"); 
		query.append("           DIR_CD                   ," ).append("\n"); 
		query.append("           IOC_TS_CD                ," ).append("\n"); 
		query.append("           RGN_OFC_CD               ," ).append("\n"); 
		query.append("           NULL AS SUB_OFC_CD       ," ).append("\n"); 
		query.append("           NULL AS OFC_CD           ," ).append("\n"); 
		query.append("           NULL AS SREP_CD          ," ).append("\n"); 
		query.append("           0    AS CUST_CNT         ," ).append("\n"); 
		query.append("           NULL AS CUST_TP_CD       ," ).append("\n"); 
		query.append("           NULL AS CUST_CNT_CD      ," ).append("\n"); 
		query.append("           NULL AS CUST_SEQ         ," ).append("\n"); 
		query.append("           NULL AS POL_CD           ," ).append("\n"); 
		query.append("           NULL AS POD_CD           ," ).append("\n"); 
		query.append("           VSL_CD                   ," ).append("\n"); 
		query.append("           SKD_VOY_NO               ," ).append("\n"); 
		query.append("           SKD_DIR_CD               ," ).append("\n"); 
		query.append("           COST_YR                  ," ).append("\n"); 
		query.append("           COST_WK                  ," ).append("\n"); 
		query.append("           0    AS CHL              ," ).append("\n"); 
		query.append("           NULL AS CTRL_LVL         ," ).append("\n"); 
		query.append("           NULL AS CTRL_HC          ," ).append("\n"); 
		query.append("           NULL AS CTRL_45          ," ).append("\n"); 
		query.append("           NULL AS CTRL_53          ," ).append("\n"); 
		query.append("           NULL AS CTRL_RF          ," ).append("\n"); 
		query.append("           NULL AS CTRL_WT          ," ).append("\n"); 
		query.append("           LOD_QTY FCAST_TTL_QTY    ," ).append("\n"); 
		query.append("           LOD_QTY FCAST_40FT_HC_QTY," ).append("\n"); 
		query.append("           LOD_QTY FCAST_45FT_HC_QTY," ).append("\n"); 
		query.append("           LOD_QTY FCAST_53FT_QTY   ," ).append("\n"); 
		query.append("           LOD_QTY FCAST_RF_QTY     ," ).append("\n"); 
		query.append("           LOD_QTY FCAST_TTL_WGT    ," ).append("\n"); 
		query.append("           LOD_QTY CFM_TTL_QTY      ," ).append("\n"); 
		query.append("           LOD_QTY CFM_40FT_HC_QTY  ," ).append("\n"); 
		query.append("           LOD_QTY CFM_45FT_HC_QTY  ," ).append("\n"); 
		query.append("           LOD_QTY CFM_53FT_QTY     ," ).append("\n"); 
		query.append("           LOD_QTY CFM_RF_QTY       ," ).append("\n"); 
		query.append("           LOD_QTY CFM_TTL_WGT      ," ).append("\n"); 
		query.append("           LOD_QTY BKG_TTL_QTY      ," ).append("\n"); 
		query.append("           LOD_QTY BKG_20FT_QTY     ," ).append("\n"); 
		query.append("           LOD_QTY BKG_40FT_QTY     ," ).append("\n"); 
		query.append("           LOD_QTY BKG_40FT_HC_QTY  ," ).append("\n"); 
		query.append("           LOD_QTY BKG_45FT_HC_QTY  ," ).append("\n"); 
		query.append("           LOD_QTY BKG_53FT_QTY     ," ).append("\n"); 
		query.append("           LOD_QTY BKG_RF_QTY       ," ).append("\n"); 
		query.append("           LOD_QTY BKG_TTL_WGT" ).append("\n"); 
		query.append("      FROM QTA_ALOC_DATA" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("  SELECT A.TRD_CD    ," ).append("\n"); 
		query.append("         A.SUB_TRD_CD," ).append("\n"); 
		query.append("         A.RLANE_CD  ," ).append("\n"); 
		query.append("         A.DIR_CD    ," ).append("\n"); 
		query.append("         A.IOC_TS_CD ," ).append("\n"); 
		query.append("         A.RGN_OFC_CD, " ).append("\n"); 
		query.append("#if (${salesoffice} == 'SELSC')" ).append("\n"); 
		query.append("         NVL(A.SUB_OFC_CD,A.OFC_CD) AS SUB_OFC_CD," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("         A.SUB_OFC_CD," ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("         A.OFC_CD     ," ).append("\n"); 
		query.append("         A.SREP_CD    ," ).append("\n"); 
		query.append("         SR.SREP_NM   ," ).append("\n"); 
		query.append("         A.CUST_TP_CD ," ).append("\n"); 
		query.append("         A.CUST_CNT_CD," ).append("\n"); 
		query.append("         A.CUST_SEQ   ," ).append("\n"); 
		query.append("         MC.CUST_LGL_ENG_NM AS CUST_NM," ).append("\n"); 
		query.append("         A.POL_CD     ," ).append("\n"); 
		query.append("         A.POD_CD     ," ).append("\n"); 
		query.append("         A.VSL_CD     ," ).append("\n"); 
		query.append("         A.SKD_VOY_NO ," ).append("\n"); 
		query.append("         A.SKD_DIR_CD ," ).append("\n"); 
		query.append("         DECODE(A.VSL_CD, 'TTL', 'TTL', A.COST_YR) AS COST_YR," ).append("\n"); 
		query.append("         DECODE(A.VSL_CD, 'TTL', ''   , A.COST_WK) AS COST_WK," ).append("\n"); 
		query.append("         A.LVL1 * 10 + A.LVL2 AS LVL," ).append("\n"); 
		query.append("         A.LVL1," ).append("\n"); 
		query.append("         A.LVL2," ).append("\n"); 
		query.append("         NVL(R.RNUM, 0)  AS RNUM," ).append("\n"); 
		query.append("         LEAST(A.CHL, 1) AS CHL ," ).append("\n"); 
		query.append("         A.CTRL_LVL ," ).append("\n"); 
		query.append("         A.CTRL_HC  ," ).append("\n"); 
		query.append("         A.CTRL_45  ," ).append("\n"); 
		query.append("         A.CTRL_53  ," ).append("\n"); 
		query.append("         A.CTRL_RF  ," ).append("\n"); 
		query.append("         A.CTRL_WT  ," ).append("\n"); 
		query.append("         PLS.POL_SEQ," ).append("\n"); 
		query.append("         PDS.POD_SEQ," ).append("\n"); 
		query.append("         (A.MST_CNT)   AS MST_CNT  ," ).append("\n"); 
		query.append("         (A.FCAST_CNT) AS FCAST_CNT," ).append("\n"); 
		query.append("         (A.BKG_CNT)   AS BKG_CNT  ," ).append("\n"); 
		query.append("         --FCAST_TTL_TEU_QTY 추가(TEU + HC * 2 + 45FT * 2 + 53FT * 2), LVL1이 1이 아닌경우에만 적용(1인경우는 TGT/ALOC이므로 다른컬럼과 동일한 값으로 넣어줌)" ).append("\n"); 
		query.append("         DECODE(A.LVL1, 1, FCAST_TTL_QTY, NVL(FCAST_TTL_QTY,0) + NVL(FCAST_40FT_HC_QTY, 0) * 2 + NVL(FCAST_45FT_HC_QTY, 0) * 2 + NVL(FCAST_53FT_QTY, 0) * 2) AS FCAST_TTL_TEU_QTY," ).append("\n"); 
		query.append("         (FCAST_TTL_QTY)     AS FCAST_TTL_QTY    ," ).append("\n"); 
		query.append("         (FCAST_40FT_HC_QTY) AS FCAST_40FT_HC_QTY," ).append("\n"); 
		query.append("         (FCAST_45FT_HC_QTY) AS FCAST_45FT_HC_QTY," ).append("\n"); 
		query.append("         (FCAST_53FT_QTY)    AS FCAST_53FT_QTY   ," ).append("\n"); 
		query.append("         (FCAST_RF_QTY)      AS FCAST_RF_QTY     ," ).append("\n"); 
		query.append("         (FCAST_TTL_WGT)     AS FCAST_TTL_WGT    ," ).append("\n"); 
		query.append("         (CFM_TTL_QTY)       AS CFM_TTL_QTY      ," ).append("\n"); 
		query.append("         (CFM_40FT_HC_QTY)   AS CFM_40FT_HC_QTY  ," ).append("\n"); 
		query.append("         (CFM_45FT_HC_QTY)   AS CFM_45FT_HC_QTY  ," ).append("\n"); 
		query.append("         (CFM_53FT_QTY)      AS CFM_53FT_QTY     ," ).append("\n"); 
		query.append("         (CFM_RF_QTY)        AS CFM_RF_QTY       ," ).append("\n"); 
		query.append("         (CFM_TTL_WGT)       AS CFM_TTL_WGT      ," ).append("\n"); 
		query.append("         (BKG_TTL_QTY)       AS BKG_TTL_QTY      ," ).append("\n"); 
		query.append("         (BKG_20FT_QTY)      AS BKG_20FT_QTY     ," ).append("\n"); 
		query.append("         (BKG_40FT_QTY)      AS BKG_40FT_QTY     ," ).append("\n"); 
		query.append("         (BKG_40FT_HC_QTY)   AS BKG_40FT_HC_QTY  ," ).append("\n"); 
		query.append("         (BKG_45FT_HC_QTY)   AS BKG_45FT_HC_QTY  ," ).append("\n"); 
		query.append("         (BKG_53FT_QTY)      AS BKG_53FT_QTY     ," ).append("\n"); 
		query.append("         (BKG_RF_QTY)        AS BKG_RF_QTY       ," ).append("\n"); 
		query.append("         (BKG_TTL_WGT)       AS BKG_TTL_WGT" ).append("\n"); 
		query.append("    FROM ALL_SUM_DATA A  ," ).append("\n"); 
		query.append("         VVD_POS      R  ," ).append("\n"); 
		query.append("         POL_SEQ      PLS," ).append("\n"); 
		query.append("         POL_POD_SEQ  PDS," ).append("\n"); 
		query.append("         MDM_SLS_REP  SR ," ).append("\n"); 
		query.append("         MDM_CUSTOMER MC" ).append("\n"); 
		query.append("   WHERE R.TRD_CD      (+) = A.TRD_CD" ).append("\n"); 
		query.append("     AND R.SUB_TRD_CD  (+) = A.SUB_TRD_CD" ).append("\n"); 
		query.append("     AND R.RLANE_CD    (+) = A.RLANE_CD" ).append("\n"); 
		query.append("     AND R.DIR_CD      (+) = A.DIR_CD" ).append("\n"); 
		query.append("     AND R.VSL_CD      (+) = A.VSL_CD" ).append("\n"); 
		query.append("     AND R.SKD_VOY_NO  (+) = A.SKD_VOY_NO" ).append("\n"); 
		query.append("     AND R.SKD_DIR_CD  (+) = A.SKD_DIR_CD" ).append("\n"); 
		query.append("     AND PLS.TRD_CD    (+) = A.TRD_CD" ).append("\n"); 
		query.append("     AND PLS.SUB_TRD_CD(+) = A.SUB_TRD_CD" ).append("\n"); 
		query.append("     AND PLS.RLANE_CD  (+) = A.RLANE_CD" ).append("\n"); 
		query.append("     AND PLS.DIR_CD    (+) = A.DIR_CD" ).append("\n"); 
		query.append("     AND PLS.POL_CD    (+) = A.POL_CD" ).append("\n"); 
		query.append("     AND PDS.TRD_CD    (+) = A.TRD_CD" ).append("\n"); 
		query.append("     AND PDS.SUB_TRD_CD(+) = A.SUB_TRD_CD" ).append("\n"); 
		query.append("     AND PDS.RLANE_CD  (+) = A.RLANE_CD" ).append("\n"); 
		query.append("     AND PDS.DIR_CD    (+) = A.DIR_CD" ).append("\n"); 
		query.append("     AND PDS.POL_CD    (+) = A.POL_CD" ).append("\n"); 
		query.append("     AND PDS.POD_CD    (+) = A.POD_CD" ).append("\n"); 
		query.append("     AND SR.SREP_CD    (+) = A.SREP_CD" ).append("\n"); 
		query.append("     AND MC.CUST_CNT_CD(+) = A.CUST_CNT_CD" ).append("\n"); 
		query.append("     AND MC.CUST_SEQ   (+) = A.CUST_SEQ" ).append("\n"); 
		query.append("     AND (A.LVL1 < 3 OR A.LVL2 = 0 OR A.CUST_TP_CD IS NOT NULL)" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("         A.TRD_CD    ," ).append("\n"); 
		query.append("         A.SUB_TRD_CD," ).append("\n"); 
		query.append("         A.RLANE_CD  ," ).append("\n"); 
		query.append("         A.DIR_CD    ," ).append("\n"); 
		query.append("         NVL(A.IOC_TS_CD , '0')," ).append("\n"); 
		query.append("         NVL(A.RGN_OFC_CD, '0')," ).append("\n"); 
		query.append("         DECODE(A.SUB_OFC_CD, NULL, '0', A.RGN_OFC_CD, '1', A.SUB_OFC_CD)," ).append("\n"); 
		query.append("         LVL1     ," ).append("\n"); 
		query.append("         A.SREP_CD," ).append("\n"); 
		query.append("         NVL(A.CUST_TP_CD, '0')," ).append("\n"); 
		query.append("         A.CUST_CNT_CD," ).append("\n"); 
		query.append("         A.CUST_SEQ   ," ).append("\n"); 
		query.append("         DECODE(A.POL_CD, NULL, 0, NVL(PLS.POL_SEQ, 99))," ).append("\n"); 
		query.append("         A.POL_CD," ).append("\n"); 
		query.append("         DECODE(A.POD_CD, NULL, 0, NVL(PDS.POD_SEQ, 99))," ).append("\n"); 
		query.append("         A.POD_CD," ).append("\n"); 
		query.append("         NVL(R.RNUM, 99)" ).append("\n"); 

	}
}