<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BookingHistoryMgtDBDAOSearchHistBkgRateRSQL">
			<desc><![CDATA[BookingHistoryMgtDBDAOSearchHistBkgRateRSQL
 * 2011.04.18 이일민 [CHM-201110112] BKG HISTORY 추가 요청 - bill type change 
]]></desc>
			<sql><![CDATA[
SELECT HIS_CATE_NM
     , DECODE(PRE_CTNT, '/0', NULL, PRE_CTNT) PRE_CTNT
     , CRNT_CTNT
  FROM 
    (
        SELECT 'PPD' HIS_CATE_NM
                , @[ppd_rcv_ofc_cd]||
                  '/'||@[ppd_payr_cnt_cd]||@[ppd_payr_cust_seq] PRE_CTNT
                , NOW.PPD_RCV_OFC_CD||
                  '/'||NOW.PPD_PAYR_CNT_CD||NOW.PPD_PAYR_CUST_SEQ CRNT_CTNT
#if (${ca_flg} == 'Y')
          FROM BKG_RT_HIS NOW
         WHERE NOW.BKG_NO(+)  = @[bkg_no]
	       AND NOW.CORR_NO(+) = 'TMP0000001' 
#else
          FROM BKG_RATE NOW
         WHERE NOW.BKG_NO(+) = @[bkg_no]
#end
  
        UNION ALL
        SELECT 'CCT' HIS_CATE_NM
                , @[clt_ofc_cd]||
                  '/'||@[clt_payr_cnt_cd]||@[clt_payr_cust_seq] PRE_CTNT
                , NOW.CLT_OFC_CD||
                  '/'||NOW.CLT_PAYR_CNT_CD||NOW.CLT_PAYR_CUST_SEQ CRNT_CTNT
#if (${ca_flg} == 'Y')
          FROM BKG_RT_HIS NOW
         WHERE NOW.BKG_NO(+)  = @[bkg_no]
	       AND NOW.CORR_NO(+) = 'TMP0000001' 
#else
          FROM BKG_RATE NOW
         WHERE NOW.BKG_NO(+) = @[bkg_no]
#end
  
        UNION ALL
        SELECT 'APPLICABLE DATE' HIS_CATE_NM
                , REPLACE(SUBSTR(@[rt_aply_dt], 0, 10), '-', '') PRE_CTNT
                , TO_CHAR(NOW.RT_APLY_DT, 'YYYYMMDD') CRNT_CTNT
#if (${ca_flg} == 'Y')
          FROM BKG_RT_HIS NOW
         WHERE NOW.BKG_NO(+)  = @[bkg_no]
	       AND NOW.CORR_NO(+) = 'TMP0000001' 
#else
          FROM BKG_RATE NOW
         WHERE NOW.BKG_NO(+) = @[bkg_no]
#end
        UNION ALL
        SELECT 'FREIGHT TERM' HIS_CATE_NM
                , DECODE(@[frt_term_cd], 'P', 'PPD', 'C', 'CCT') PRE_CTNT
                , DECODE(NOW.FRT_TERM_CD, 'P', 'PPD', 'C', 'CCT') CRNT_CTNT
#if (${ca_flg} == 'Y')
          FROM BKG_RT_HIS NOW
         WHERE NOW.BKG_NO(+)  = @[bkg_no]
	       AND NOW.CORR_NO(+) = 'TMP0000001' 
#else
          FROM BKG_RATE NOW
         WHERE NOW.BKG_NO(+) = @[bkg_no]
#end
        UNION ALL
        SELECT 'Bill Type' HIS_CATE_NM
                , (SELECT INTG_CD_VAL_CTNT||' : '||INTG_CD_VAL_DP_DESC
                     FROM COM_INTG_CD_DTL
                    WHERE INTG_CD_ID = 'CD01639'
                      AND INTG_CD_VAL_CTNT = @[rt_bl_tp_cd]) PRE_CTNT
                , (SELECT INTG_CD_VAL_CTNT||' : '||INTG_CD_VAL_DP_DESC
                     FROM COM_INTG_CD_DTL
                    WHERE INTG_CD_ID = 'CD01639'
                      AND INTG_CD_VAL_CTNT = NOW.RT_BL_TP_CD) CRNT_CTNT
#if (${ca_flg} == 'Y')
          FROM BKG_RT_HIS NOW
         WHERE NOW.BKG_NO(+)  = @[bkg_no]
	       AND NOW.CORR_NO(+) = 'TMP0000001' 
#else
          FROM BKG_RATE NOW
         WHERE NOW.BKG_NO(+) = @[bkg_no]
#end
		UNION ALL
		SELECT 'EXTERNAL REMARK' HIS_CATE_NM
		      , NVL(TRIM(@[diff_rmk]), ' ') PRE_CTNT
              , NVL(TRIM(NOW.DIFF_RMK), ' ') CRNT_CTNT
#if (${ca_flg} == 'Y')
     	 FROM BKG_RT_HIS NOW
    	WHERE NOW.BKG_NO(+) = @[bkg_no]
      	  AND NOW.CORR_NO(+) = 'TMP0000001'
#else
	     FROM BKG_RATE NOW
 	    WHERE NOW.BKG_NO(+) = @[bkg_no]
#end
		UNION ALL
		SELECT 'INTERNAL REMARK' HIS_CATE_NM
		      , NVL(TRIM(@[rt_inter_rmk]), ' ') PRE_CTNT
              , NVL(TRIM(NOW.RT_INTER_RMK), ' ') CRNT_CTNT
#if (${ca_flg} == 'Y')
     	 FROM BKG_RT_HIS NOW
    	WHERE NOW.BKG_NO(+) = @[bkg_no]
      	  AND NOW.CORR_NO(+) = 'TMP0000001'
#else
	     FROM BKG_RATE NOW
 	    WHERE NOW.BKG_NO(+) = @[bkg_no]
#end
		UNION ALL
		SELECT 'REMARK FOR DOC CENTER ' HIS_CATE_NM
		      , NVL(TRIM(@[doc_inter_rmk]), ' ') PRE_CTNT
              , NVL(TRIM(NOW.DOC_INTER_RMK), ' ') CRNT_CTNT
#if (${ca_flg} == 'Y')
     	 FROM BKG_RT_HIS NOW
    	WHERE NOW.BKG_NO(+) = @[bkg_no]
      	  AND NOW.CORR_NO(+) = 'TMP0000001'
#else
	     FROM BKG_RATE NOW
 	    WHERE NOW.BKG_NO(+) = @[bkg_no]
#end
		UNION ALL
		SELECT 'SELF CHECK' HIS_CATE_NM
		      , @[grp_rat_chk_flg] PRE_CTNT
              , GRP_RAT_CHK_FLG CRNT_CTNT
#if (${ca_flg} == 'Y')
     	 FROM BKG_RT_HIS NOW
    	WHERE NOW.BKG_NO(+) = @[bkg_no]
      	  AND NOW.CORR_NO(+) = 'TMP0000001'
#else
	     FROM BKG_RATE NOW
 	    WHERE NOW.BKG_NO(+) = @[bkg_no]
#end
    )    
 WHERE NVL(TRIM(PRE_CTNT), ' ') <> NVL(TRIM(CRNT_CTNT), ' ')			]]></sql>
			<params>
				<param name="ppd_rcv_ofc_cd" type="12" value="" out="N"/>
				<param name="ppd_payr_cnt_cd" type="12" value="" out="N"/>
				<param name="ppd_payr_cust_seq" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="clt_ofc_cd" type="12" value="" out="N"/>
				<param name="clt_payr_cnt_cd" type="12" value="" out="N"/>
				<param name="clt_payr_cust_seq" type="12" value="" out="N"/>
				<param name="rt_aply_dt" type="12" value="" out="N"/>
				<param name="frt_term_cd" type="12" value="" out="N"/>
				<param name="rt_bl_tp_cd" type="12" value="" out="N"/>
				<param name="diff_rmk" type="12" value="" out="N"/>
				<param name="rt_inter_rmk" type="12" value="" out="N"/>
				<param name="doc_inter_rmk" type="12" value="" out="N"/>
				<param name="grp_rat_chk_flg" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
