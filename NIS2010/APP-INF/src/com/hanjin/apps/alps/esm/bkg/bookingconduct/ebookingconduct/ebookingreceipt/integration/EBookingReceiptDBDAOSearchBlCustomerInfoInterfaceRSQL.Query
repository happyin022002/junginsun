<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EBookingReceiptDBDAOSearchBlCustomerInfoInterfaceRSQL">
			<desc><![CDATA[external request 처리를 위해 external rqst의 Booking 정보를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT NVL(XS.CUST_SEQ, S.CUST_SEQ) S_CUST_SEQ,
       S.CUST_SEQ S_CUST_SEQ_OLD,
       NVL(XS.CUST_NM,  MS.CUST_LGL_ENG_NM) S_CUST_NM,
       CASE WHEN XS.CUST_SEQ IS NOT NULL THEN 'Y' ELSE 'N' END S_CUST_SUBST_FLG,
       NVL(XS.CNT_CD, S.CUST_CNT_CD) S_CUST_CNT_CD,
       S.CUST_CNT_CD S_CUST_CNT_CD_OLD,
       NVL(XF.CUST_SEQ, F.CUST_SEQ) F_CUST_SEQ,
       F.CUST_SEQ F_CUST_SEQ_OLD,
       NVL(XF.CUST_NM,  MF.CUST_LGL_ENG_NM) F_CUST_NM,
       CASE WHEN XF.CUST_SEQ IS NOT NULL THEN 'Y' ELSE 'N' END F_CUST_SUBST_FLG,
       NVL(XF.CNT_CD, F.CUST_CNT_CD) F_CUST_CNT_CD,
       F.CUST_CNT_CD F_CUST_CNT_CD_OLD,
       NVL(XC.CUST_SEQ, C.CUST_SEQ) C_CUST_SEQ,
       C.CUST_SEQ C_CUST_SEQ_OLD,
       NVL(XC.CUST_NM,  MC.CUST_LGL_ENG_NM) C_CUST_NM,
       CASE WHEN XC.CUST_SEQ IS NOT NULL THEN 'Y' ELSE 'N' END C_CUST_SUBST_FLG,
       NVL(XC.CNT_CD, C.CUST_CNT_CD) C_CUST_CNT_CD,
       C.CUST_CNT_CD C_CUST_CNT_CD_OLD
FROM BKG_XTER_RQST_MST X, 
     BKG_XTER_CUST XS, BKG_XTER_CUST XF, BKG_XTER_CUST XC,
     BKG_CUSTOMER S, BKG_CUSTOMER F, BKG_CUSTOMER C,
     MDM_CUSTOMER MS, MDM_CUSTOMER MF, MDM_CUSTOMER MC
WHERE X.XTER_SNDR_ID = @[xter_sndr_id]
AND X.XTER_RQST_NO = @[xter_rqst_no]
AND X.XTER_RQST_SEQ = @[xter_rqst_seq]
AND X.XTER_SNDR_ID = XS.XTER_SNDR_ID(+)
AND X.XTER_RQST_NO = XS.XTER_RQST_NO(+)
AND X.XTER_RQST_SEQ = XS.XTER_RQST_SEQ(+)
AND 'S' = XS.XTER_CUST_TP_CD(+)
AND X.XTER_SNDR_ID = XF.XTER_SNDR_ID(+)
AND X.XTER_RQST_NO = XF.XTER_RQST_NO(+)
AND X.XTER_RQST_SEQ = XF.XTER_RQST_SEQ(+)
AND 'F' = XF.XTER_CUST_TP_CD(+)
AND X.XTER_SNDR_ID = XC.XTER_SNDR_ID(+)
AND X.XTER_RQST_NO = XC.XTER_RQST_NO(+)
AND X.XTER_RQST_SEQ = XC.XTER_RQST_SEQ(+)
AND 'C' = XC.XTER_CUST_TP_CD(+)
AND X.BKG_NO = S.BKG_NO(+)
AND 'S' = S.BKG_CUST_TP_CD(+)
AND X.BKG_NO = F.BKG_NO(+)
AND 'F' = F.BKG_CUST_TP_CD(+)
AND X.BKG_NO = C.BKG_NO(+)
AND 'C' = C.BKG_CUST_TP_CD(+)
and s.cust_cnt_cd  = ms.cust_cnt_cd(+)
and s.cust_seq     = ms.cust_seq(+)
and c.cust_cnt_cd  = mc.cust_cnt_cd(+)
and c.cust_seq     = mc.cust_seq(+)
and f.cust_cnt_cd  = mf.cust_cnt_cd(+)
and f.cust_seq     = mf.cust_seq(+)			]]></sql>
			<params>
				<param name="xter_sndr_id" type="12" value="" out="N"/>
				<param name="xter_rqst_no" type="12" value="" out="N"/>
				<param name="xter_rqst_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
