<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TCharterIOConsultationDBDAOFmsReverseCsrForSubletSaveListRSQL">
			<desc><![CDATA[Reverse CSR for Sublet Select after Save]]></desc>
			<sql><![CDATA[
SELECT BB.ACCT_CD,
	   BB.CUST_CNT_CD,
	   BB.CUST_SEQ,
	   BB.CTR_CD,
	   BB.SLP_LOC_CD,
	   AA.EFF_DT,
	   BB.CSR_AMT,
	  (SELECT SUM(B.CSR_AMT)
	     FROM FMS_CONSULTATION A,
  	          FMS_CSUL_SLP B
        WHERE A.SLP_TP_CD = B.SLP_TP_CD
          AND A.SLP_FUNC_CD = B.SLP_FUNC_CD
          AND A.SLP_OFC_CD = B.SLP_OFC_CD
          AND A.SLP_ISS_DT = B.SLP_ISS_DT
          AND A.SLP_SER_NO = B.SLP_SER_NO
          AND A.CXL_FLG = 'N'
          AND B.ACCT_CD = '110811'
          AND B.TO_INV_NO = BB.TO_INV_NO) REV_AMT,
	   BB.CSR_DESC,
	   BB.CSR_DESC CSR_DESC1,
	   BB.CSR_DESC CSR_DESC2,
       BB.CSR_DESC CSR_DESC3,
       BB.CSR_DESC CSR_DESC4,
	   (BB.VSL_CD || BB.SKD_VOY_NO || BB.SKD_DIR_CD || BB.REV_DIR_CD) VVD_CD,
	   BB.TO_INV_NO,
	   BB.TO_INV_NO TO_INV_NO1,
	   AA.SLP_TP_CD,
       AA.SLP_FUNC_CD,
       AA.SLP_OFC_CD,
       AA.SLP_ISS_DT,
       AA.CSR_CURR_CD,
       BB.INV_SEQ,
       TO_CHAR(BB.VVD_EFF_DT,'YYYYMMDD') VVD_EFF_DT,
       TO_CHAR(BB.VVD_EXP_DT,'YYYYMMDD') VVD_EXP_DT,
       BB.FLET_SRC_TP_CD,
       AA.SLP_TP_CD ORG_SLP_TP_CD,
       AA.SLP_FUNC_CD ORG_SLP_FUNC_CD,
       AA.SLP_OFC_CD ORG_SLP_OFC_CD,
       AA.SLP_ISS_DT ORG_ISS_DT,
       AA.SLP_SER_NO ORG_SLP_SER_NO,
       AA.FLET_CTRT_NO,
       (AA.SLP_TP_CD || AA.SLP_FUNC_CD || AA.SLP_OFC_CD || AA.SLP_ISS_DT || AA.SLP_SER_NO) CSR_NO
  FROM FMS_CONSULTATION AA,
  	   FMS_CSUL_SLP BB
 WHERE AA.SLP_TP_CD = BB.SLP_TP_CD
   AND AA.SLP_FUNC_CD = BB.SLP_FUNC_CD
   AND AA.SLP_OFC_CD = BB.SLP_OFC_CD
   AND AA.SLP_ISS_DT = BB.SLP_ISS_DT
   AND AA.SLP_SER_NO = BB.SLP_SER_NO
   AND AA.CXL_FLG = 'N'
   AND AA.SLP_TP_CD = @[slp_tp_cd]
   AND AA.SLP_FUNC_CD = @[slp_func_cd]
   AND AA.SLP_OFC_CD = @[slp_ofc_cd]
   AND AA.SLP_ISS_DT = SUBSTR(@[slp_iss_dt],3,6)
   AND AA.SLP_SER_NO =@[slp_ser_no]
   AND BB.ACCT_CD = '110811'
 ORDER BY BB.TO_INV_NO			]]></sql>
			<params>
				<param name="slp_tp_cd" type="12" value="" out="N"/>
				<param name="slp_func_cd" type="12" value="" out="N"/>
				<param name="slp_ofc_cd" type="12" value="" out="N"/>
				<param name="slp_iss_dt" type="12" value="" out="N"/>
				<param name="slp_ser_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
