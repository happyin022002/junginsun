<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="MultiDimensionRPTDBDAOSearchWeeklySalesByOffice3TEUBased3Op6ListRSQL">
			<desc><![CDATA[P&L by Lane OP6
 * 2010.08.24 윤진영 [CHM-201005423] RHQ 컬럼 추가
2015.08.31 손진환 [CHM-201536958] Split15-[그룹사 표준 코드 시행] SML 프로그램 대응 및 데이타 마이그레이션 작업 요청]]></desc>
			<sql><![CDATA[
SELECT A.COST_YRMON
	,A.SLS_YRMON 
	,A.COST_WK 
#if(${f_ofc_lvl} == '2')
    ,A.OFC_N2ND_LVL_CD RHQ 
#else
	,'' RHQ
#end
	,A.TRD_CD 
	,DECODE(B.NO,1,A.SUB_TRD_CD,2,'OT') AS SUB_TRD_CD
	,A.RLANE_CD 
	,A.IOC_CD 
	,A.VSL_CD 
	,A.SKD_VOY_NO 
	,A.DIR_CD 
	,A.HUL_BND_CD
	
	#foreach($key in ${allcols})
		--,SUM(DECODE(A.STND_COST_CD, '$key', NVL(A.AMT,0), 0)) AS COST_AMT$velocityCount
		#if($key == '53101000' || $key == '53102000' || $key == '53200000' || $key == '54100000' || $key == '54250000' || $key == '54300000' 
		 || $key == '54200000' || $key == '54150000' || $key == '54450000' || $key == '54180000' || $key == '54550000' || $key == '54350000' 
		 || $key == '54400000' || $key == '54600000' || $key == 'OPCOST00' || $key == 'BOPTOTAL' || $key == 'NTMASLOC')
		,DECODE(B.NO,1,SUM(DECODE(A.STND_COST_CD, '$key', NVL(A.AMT, 0), 0)), 
					   SUM(DECODE(A.STND_COST_CD, '$key', DECODE('$key','BOPTOTAL',NVL(A.OTR_AMT, 0) * -1 ,NVL(A.OTR_AMT, 0)), 0))) AS COST_AMT$velocityCount
		#else
		,DECODE(B.NO,1,SUM(DECODE(A.STND_COST_CD, '$key', NVL(A.AMT, 0), 0))) AS COST_AMT$velocityCount
		#end
	#end		
		
	,SUM(NVL(a.amt,0)) AS ttl_amt 
FROM ( 
	/*-- 계정별 비용집계 ----*/
	SELECT   /*+ ORDERED */ 
		 B1.COST_YRMON 
		,B1.SLS_YRMON 
		,B1.COST_WK 
#if($f_ofc_lvl == '2')
		,B4.OFC_N2ND_LVL_CD
#end
		,B1.TRD_CD 
		,B1.SUB_TRD_CD 
		,B1.RLANE_CD 
		,B1.IOC_CD 
		,B1.VSL_CD 
		,B1.SKD_VOY_NO 
		,B1.DIR_CD 
		,L1.HUL_BND_CD
		,B2.STND_COST_CD 
		,SUM (DECODE (@[f_pro_vw]
		          ,'P', DECODE (B2.STND_COST_CD 
		                       ,'LOAD0000', DECODE(SUBSTR (B2.CNTR_TPSZ_CD, -1),'2', B2.N6TH_ESTM_PL_AMT, '3', B2.N6TH_ESTM_PL_AMT, B2.N6TH_ESTM_PL_AMT * 2) 
		                       ,'BSA00000', B2.N6TH_ESTM_PL_AMT 
		                       ,DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', B2.N6TH_CO_AMT,'O|BIZ', B2.N6TH_HJS_SLS_AMT,B2.N6TH_ESTM_PL_AMT) 
		                       ) 
		          ,'R', DECODE (B2.STND_COST_CD 
		                       ,'LOAD0000', DECODE(SUBSTR(B2.CNTR_TPSZ_CD, -1),'2', B2.RA_PL_AMT, '3', B2.RA_PL_AMT, B2.RA_PL_AMT * 2) 
		                       ,'92404011', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, B2.RA_PL_AMT))  
		                       ,B2.RA_PL_AMT 
		                       ) 
		          ) 
		  ) AS AMT 
		, SUM (B2.N6TH_ADJ_OTR_FNL_AMT) AS OTR_AMT
	FROM MAS_MON_VVD B1 
		,MAS_PFIT_LSS_SMRY B2 
		,MAS_PFIT_LSS_RPT_ITM B3 
		,MAS_OFC_LVL B4 
        ,MAS_LANE_RGST L1
	WHERE B1.VSL_CD        = B2.VSL_CD 
		AND B1.SKD_VOY_NO    = B2.SKD_VOY_NO 
		AND B1.DIR_CD        = B2.SKD_DIR_CD 
		AND B1.TRD_CD        = B2.TRD_CD 
		AND B1.RLANE_CD      = B2.RLANE_CD 
		AND B1.IOC_CD        = B2.IOC_CD 
		
        AND B1.RLANE_CD = L1.RLANE_CD
        AND B1.DIR_CD = L1.DIR_CD
        AND B1.TRD_CD = L1.TRD_CD
        AND B1.IOC_CD = L1.IOC_CD

		#if(${f_chkprd} =='M')
			AND B1.COST_YRMON    BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON   
		#elseif (${f_chkprd} =='W')
			AND B1.SLS_YRMON     BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON  
		#end /*ofc_월별 관리*/
		#if(${f_init_cost} == 'Y')
			AND B2.STND_COST_CD  NOT IN ('53101000', '53102000', '53200000', '54100000', '54250000', '54300000', '54200000', '54150000','54450000', '54180000', '54550000', '54350000', '54400000')
		#end /* 배부 이전 원가 */
		
		
		AND B2.STND_COST_CD  NOT IN ('91401011') /* STP REV 제외 */
		AND B2.STND_COST_CD  = B3.STND_COST_CD 
		AND B1.DELT_FLG      <> 'Y' 
		
		#if(${f_chkprd} =='M')
			AND B1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   
		#elseif (${f_chkprd} =='W')
			AND B1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    
			AND B1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   
		#end	
		
		#if(${f_trd_cd} !='') 
			AND B1.TRD_CD    = @[f_trd_cd]  
		#end
		#if(${f_rlane_cd} !='') 
			AND B1.RLANE_CD  = @[f_rlane_cd]
		#end
		#if(${f_dir_cd} !='')   
			AND B1.DIR_CD    = @[f_dir_cd] 
		#end
		#if(${f_vsl_cd} !='') 
			AND B1.VSL_CD    = @[f_vsl_cd] 
		#end
		#if(${f_skd_voy_no} !='')  
			AND B1.SKD_VOY_NO    = @[f_skd_voy_no] 
		#end
		#if(${f_skd_dir_cd} !='') 
			AND B1.DIR_CD     = @[f_skd_dir_cd] 
	    #end
		#if(${f_sub_trd_cd} !='') 
			AND B1.SUB_TRD_CD = @[f_sub_trd_cd] 
		#end
		#if(${f_ias_rgn_cd} !='') 
			AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] 
		#end
		#if(${f_trd_dir_cd} !='') 
			AND L1.HUL_BND_CD = @[f_trd_dir_cd] 
		#end
		                          
		AND B3.RPT_VW_CD     = @[f_pro_vw]
		AND DECODE (@[f_ofc_vw], 'C', B2.AGMT_SGN_OFC_CD, 'L', B2.SLS_OFC_CD) = B4.OFC_CD 
		
		#if(${f_ofc_cd} !='')
			#if(${f_excl_sts} =='')
				/* N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '') */
				AND DECODE (@[f_ofc_lvl] ,'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  
			#else
				AND B4.OFC_CD = @[f_ofc_cd]  
			#end
		#else
			/* N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '') */
			AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) IS NOT NULL  
			AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_TP_CD,'3', B4.OFC_N3RD_LVL_TP_CD
			           ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', B1.COST_YRMON, B1.SLS_YRMON), 1, 4), '2008', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCRA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)
			                                                   , '2007', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCRA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)
			                                                   , DECODE(B4.OFC_N4TH_LVL_CD, 'SZPDC', B4.OFC_N4TH_LVL_TP_CD, B4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA*/
			           ,'5', B4.OFC_N5TH_LVL_TP_CD,'6', B4.OFC_N6TH_LVL_TP_CD,'7', B4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  
		#end
	
		#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
			AND (B3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* strDisplay( f_pro_obj P->O,A,B) */
				OR B3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
		#else
			#if( ${f_pro_lvl} =='C')
				AND B3.STND_COST_TP_CD IN ('S','C') 
			#elseif (${f_pro_lvl} =='O')
				AND B3.STND_COST_TP_CD IN ('S','C','O') 
			#end
		#end
		
		
	GROUP BY  
		 B1.COST_YRMON 
		,B1.SLS_YRMON 
		,B1.COST_WK 
#if($f_ofc_lvl == '2')
		,B4.OFC_N2ND_LVL_CD
#end
		,B1.TRD_CD 
		,B1.SUB_TRD_CD 
		,B1.RLANE_CD 
		,B1.IOC_CD 
		,B1.VSL_CD 
		,B1.SKD_VOY_NO 
		,B1.DIR_CD 
		,L1.HUL_BND_CD
		,B2.STND_COST_CD 
	UNION ALL 
#if(${f_init_cost} == 'Y')
	SELECT   /*+ ORDERED */ 
		 B1.COST_YRMON 
		,B1.SLS_YRMON 
		,B1.COST_WK 
#if($f_ofc_lvl == '2')
		,B4.OFC_N2ND_LVL_CD
#end
		,B1.TRD_CD 
		,B1.SUB_TRD_CD 
		,B1.RLANE_CD 
		,B1.IOC_CD 
		,B1.VSL_CD 
		,B1.SKD_VOY_NO 
		,B1.DIR_CD 
		,L1.HUL_BND_CD
		,B2.STND_COST_CD 
		,SUM (DECODE (@[f_pro_vw]
		          ,'P', DECODE (B2.STND_COST_CD 
		                       ,'LOAD0000', DECODE(SUBSTR (B2.CNTR_TPSZ_CD, -1),'2', B2.N6TH_ESTM_PL_AMT, '3', B2.N6TH_ESTM_PL_AMT, B2.N6TH_ESTM_PL_AMT * 2) 
		                       ,'BSA00000', B2.N6TH_ESTM_PL_AMT 
		                       ,DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', B2.N6TH_CO_AMT,'O|BIZ', B2.N6TH_HJS_SLS_AMT,V.NTWK_HIR_COST_AMT) 
		                       ) 
		          ,'R', DECODE (B2.STND_COST_CD 
		                       ,'LOAD0000', DECODE(SUBSTR(B2.CNTR_TPSZ_CD, -1),'2', B2.RA_PL_AMT, '3', B2.RA_PL_AMT, B2.RA_PL_AMT * 2) 
		                       ,'92404011', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, B2.RA_PL_AMT))  
		                       ,B2.RA_PL_AMT 
		                       ) 
		          ) 
		  ) AS AMT
		, SUM (B2.N6TH_ADJ_OTR_FNL_AMT) AS OTR_AMT
	FROM MAS_MON_VVD B1 
		,MAS_PFIT_LSS_SMRY B2 
		,MAS_PFIT_LSS_RPT_ITM B3 
		,MAS_OFC_LVL B4 
        ,MAS_LANE_RGST L1
		,MAS_VVD_HIR V
	WHERE B1.VSL_CD        = B2.VSL_CD 
		AND B1.SKD_VOY_NO    = B2.SKD_VOY_NO 
		AND B1.DIR_CD        = B2.SKD_DIR_CD 
		AND B1.TRD_CD        = B2.TRD_CD 
		AND B1.RLANE_CD      = B2.RLANE_CD 
		AND B1.IOC_CD        = B2.IOC_CD 
		
        AND B1.RLANE_CD = L1.RLANE_CD
        AND B1.DIR_CD = L1.DIR_CD
        AND B1.TRD_CD = L1.TRD_CD
        AND B1.IOC_CD = L1.IOC_CD

		#if(${f_chkprd} =='M')
			AND B1.COST_YRMON    BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON   
		#elseif (${f_chkprd} =='W')
			AND B1.SLS_YRMON     BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON  
		#end /*ofc_월별 관리*/
		#if(${f_init_cost} == 'Y')
			AND B2.STND_COST_CD  IN ('53101000', '53102000', '53200000', '54100000', '54250000', '54300000', '54200000', '54150000','54450000', '54180000', '54550000', '54350000', '54400000')
		#end /* 배부 이전 원가 */
		
		AND B2.STND_COST_CD  NOT IN ('91401011') /* STP REV 제외 */
		AND V.VSL_CD        = B2.VSL_CD 
		AND V.SKD_VOY_NO    = B2.SKD_VOY_NO 
		AND V.DIR_CD        = B2.SKD_DIR_CD 
		AND V.TRD_CD        = B2.TRD_CD 
		AND V.RLANE_CD      = B2.RLANE_CD 
		AND V.IOC_CD        = B2.IOC_CD 
		AND V.STND_COST_CD  = B2.STND_COST_CD
		AND B2.STND_COST_CD  = B3.STND_COST_CD 
		AND B1.DELT_FLG      <> 'Y' 
		
		#if(${f_chkprd} =='M')
			AND B1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   
		#elseif (${f_chkprd} =='W')
			AND B1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    
			AND B1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   
		#end	
		
		#if(${f_trd_cd} !='') 
			AND B1.TRD_CD    = @[f_trd_cd]  
		#end
		#if(${f_rlane_cd} !='') 
			AND B1.RLANE_CD  = @[f_rlane_cd]
		#end
		#if(${f_dir_cd} !='')   
			AND B1.DIR_CD    = @[f_dir_cd] 
		#end
		#if(${f_vsl_cd} !='') 
			AND B1.VSL_CD    = @[f_vsl_cd] 
		#end
		#if(${f_skd_voy_no} !='')  
			AND B1.SKD_VOY_NO    = @[f_skd_voy_no] 
		#end
		#if(${f_skd_dir_cd} !='') 
			AND B1.DIR_CD     = @[f_skd_dir_cd] 
	    #end
		#if(${f_sub_trd_cd} !='') 
			AND B1.SUB_TRD_CD = @[f_sub_trd_cd] 
		#end
		#if(${f_ias_rgn_cd} !='') 
			AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] 
		#end
		#if(${f_trd_dir_cd} !='') 
			AND L1.HUL_BND_CD = @[f_trd_dir_cd] 
		#end
		                          
		AND B3.RPT_VW_CD     = @[f_pro_vw]
		AND DECODE (@[f_ofc_vw], 'C', B2.AGMT_SGN_OFC_CD, 'L', B2.SLS_OFC_CD) = B4.OFC_CD 
		
		#if(${f_ofc_cd} !='')
			#if(${f_excl_sts} =='')
				/* N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '') */
				AND DECODE (@[f_ofc_lvl] ,'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  
			#else
				AND B4.OFC_CD = @[f_ofc_cd]  
			#end
		#else
			/* N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '') */
			AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) IS NOT NULL  
			AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_TP_CD,'3', B4.OFC_N3RD_LVL_TP_CD
			           ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', B1.COST_YRMON, B1.SLS_YRMON), 1, 4), '2008', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCRA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)
			                                                   , '2007', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCRA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)
			                                                   , DECODE(B4.OFC_N4TH_LVL_CD, 'SZPDC', B4.OFC_N4TH_LVL_TP_CD, B4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA*/
			           ,'5', B4.OFC_N5TH_LVL_TP_CD,'6', B4.OFC_N6TH_LVL_TP_CD,'7', B4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  
		#end
	
		#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
			AND (B3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* strDisplay( f_pro_obj P->O,A,B) */
				OR B3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
		#else
			#if( ${f_pro_lvl} =='C')
				AND B3.STND_COST_TP_CD IN ('S','C') 
			#elseif (${f_pro_lvl} =='O')
				AND B3.STND_COST_TP_CD IN ('S','C','O') 
			#end
		#end
		
		
	GROUP BY  
		 B1.COST_YRMON 
		,B1.SLS_YRMON 
		,B1.COST_WK 
#if($f_ofc_lvl == '2')
		,B4.OFC_N2ND_LVL_CD
#end
		,B1.TRD_CD 
		,B1.SUB_TRD_CD 
		,B1.RLANE_CD 
		,B1.IOC_CD 
		,B1.VSL_CD 
		,B1.SKD_VOY_NO 
		,B1.DIR_CD 
		,L1.HUL_BND_CD
		,B2.STND_COST_CD 
	UNION ALL 
#end
	/*-- ABC/STP 비용집계 -----*/ 
	SELECT   /*+ ORDERED */  
		 B1.COST_YRMON  
		,B1.SLS_YRMON  
		,B1.COST_WK 
#if($f_ofc_lvl == '2')
		,B4.OFC_N2ND_LVL_CD
#end
		,B1.TRD_CD 
		,B1.SUB_TRD_CD 
		,B1.RLANE_CD 
		,B1.IOC_CD 
		,B1.VSL_CD 
		,B1.SKD_VOY_NO 
		,B1.DIR_CD 
		,L1.HUL_BND_CD
		,DECODE(B2.STND_COST_CD, '65901021' ,'65901022', B2.STND_COST_CD) STND_COST_CD 
		,SUM (DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, B2.RA_PL_AMT))) AS AMT  
        , 0 AS OTR_AMT 
	FROM MAS_MON_VVD B1 
		,MAS_PFIT_LSS_SVC_TRNS_PRC B2 
		,MAS_PFIT_LSS_RPT_ITM B3 
		,MAS_OFC_LVL B4 
        ,MAS_LANE_RGST L1
	WHERE B1.VSL_CD        = B2.VSL_CD 
		AND B1.SKD_VOY_NO    = B2.SKD_VOY_NO 
		AND B1.DIR_CD        = B2.SKD_DIR_CD 
		AND B1.TRD_CD        = B2.TRD_CD 
		AND B1.RLANE_CD      = B2.RLANE_CD 
		AND B1.IOC_CD        = B2.IOC_CD 
		
        AND B1.RLANE_CD = L1.RLANE_CD
        AND B1.DIR_CD = L1.DIR_CD
        AND B1.TRD_CD = L1.TRD_CD
        AND B1.IOC_CD = L1.IOC_CD

		#if(${f_chkprd} =='M')
			AND B1.COST_YRMON    BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON   
		#elseif (${f_chkprd} =='W')
			AND B1.SLS_YRMON     BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON   
		#end /* ofc_월별 관리*/
				
		AND B2.STND_COST_CD  IN ('91401011', '65901021')  /* STP REV, ABC OTH 만 */
		AND B2.STND_COST_CD  = B3.STND_COST_CD 
		AND B1.DELT_FLG      <> 'Y' 
		
		#if(${f_chkprd} =='M')
			AND B1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]  
		#elseif (${f_chkprd} =='W')
			AND B1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%' 
			AND B1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]
		#end
		
		#if(${f_trd_cd} !='') 
			AND B1.TRD_CD    = @[f_trd_cd]  
		#end
		#if(${f_rlane_cd} !='') 
			AND B1.RLANE_CD  = @[f_rlane_cd]
		#end
		#if(${f_dir_cd} !='')   
			AND B1.DIR_CD    = @[f_dir_cd] 
		#end
		#if(${f_vsl_cd} !='') 
			AND B1.VSL_CD    = @[f_vsl_cd] 
		#end
		#if(${f_skd_voy_no} !='')  
			AND B1.SKD_VOY_NO    = @[f_skd_voy_no] 
		#end
		#if(${f_skd_dir_cd} !='') 
			AND B1.DIR_CD     = @[f_skd_dir_cd] 
	    #end
		#if(${f_sub_trd_cd} !='') 
			AND B1.SUB_TRD_CD = @[f_sub_trd_cd] 
		#end	
		#if(${f_ias_rgn_cd} !='') 
			AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] 
		#end
		#if(${f_trd_dir_cd} !='') 
			AND L1.HUL_BND_CD = @[f_trd_dir_cd] 
		#end
	    
		AND B3.RPT_VW_CD     = @[f_pro_vw]
		AND DECODE (@[f_ofc_vw], 'C', B2.AGMT_SGN_OFC_CD, 'L', B2.SLS_OFC_CD) = B4.OFC_CD 
		
		#if(${f_ofc_cd} !='')
			#if(${f_excl_sts} =='')
				/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/
				AND DECODE (@[f_ofc_lvl] ,'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) = @[f_ofc_cd] 
			#else
				AND B4.OFC_CD  = @[f_ofc_cd]  
			#end
		#else
			/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/
			AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) IS NOT NULL  
			AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_TP_CD,'3', B4.OFC_N3RD_LVL_TP_CD
			       ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', B1.COST_YRMON, B1.SLS_YRMON), 1, 4), '2008', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCRA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)
			                                               , '2007', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCRA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)
			                                               , DECODE(B4.OFC_N4TH_LVL_CD, 'SZPDC', B4.OFC_N4TH_LVL_TP_CD, B4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA*/
			       ,'5', B4.OFC_N5TH_LVL_TP_CD,'6', B4.OFC_N6TH_LVL_TP_CD,'7', B4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  
		#end
		
		#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
			AND (B3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */
				OR B3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
		#else
			AND B3.STND_COST_TP_CD IN ('S','C','O' )  
		#end	
		
	GROUP BY  
		 B1.COST_YRMON 
		,B1.SLS_YRMON 
		,B1.COST_WK 
#if($f_ofc_lvl == '2')
		,B4.OFC_N2ND_LVL_CD
#end
		,B1.TRD_CD 
		,B1.SUB_TRD_CD 
		,B1.RLANE_CD 
		,B1.IOC_CD 
		,B1.VSL_CD 
		,B1.SKD_VOY_NO 
		,B1.DIR_CD 
		,L1.HUL_BND_CD
		,DECODE(B2.STND_COST_CD, '65901021' ,'65901022', B2.STND_COST_CD) 
		
	UNION ALL 
	/*-- SUMMRY 비용집계 ----*/
	SELECT 
		 COST_YRMON 
		,SLS_YRMON 
		,COST_WK 
#if($f_ofc_lvl == '2')
		,OFC_N2ND_LVL_CD
#end
		,TRD_CD 
		,SUB_TRD_CD 
		,RLANE_CD 
		,IOC_CD 
		,VSL_CD 
		,SKD_VOY_NO 
		,DIR_CD 
		,HUL_BND_CD
		,DECODE (B2.RNUM 
		       ,1, 'VOYAGE00' 
		       ,2, 'LOADFACT' 
		       ,3, 'REVENUE0' 
		       ,4, 'RPB00000' 
		       ,5, 'OTHINCOM' 
		       ,6, 'INCOMTTL' 
		       ,7, 'CMCOST00' 
		       ,8, 'CMCB0000' 
		       ,9, 'CMCTOTAL' 
		       ,10, 'CMB00000' 
		       ,11, 'OPCOST00' 
		       ,12, 'OPCB0000' 
		       ,13, 'OPCTOTAL' 
		       ,14, 'OPB00000' 
		       ,15, 'TSCTRB01' 
		       ,16, 'CMMT0001' 
		       ,17, 'BCMTOTAL' 
		       ,18, 'BCMB0000' 
		       ,19, '65901023'  
		       ,20, 'BLN00001'   
		       ,21, 'BLN00002'   
		       ,22, 'BLNTOTAL'  
		       ,23, 'BOPTOTAL' 
		       ,24, 'BOPB0000' 
		       ,25, 'EQCOST00' 
			   ,26, 'OPCOST01' 	
			   ,27, 'OPCOST02' 
			   ,28, 'NTCOINIT' 	
			   ,29, 'NTMASLOC' 	
			   ,30, '65010001'
		       ) STND_COST_CD 
		,DECODE(B2.RNUM 
		   ,1, VOYAGE                                            /* VOYAGE00 */ 
		   ,2, DECODE (SUPPLY, 0, 0, LOAD_TEU / SUPPLY) * 100    /* LOADFACT */
		   ,3, REVENUE                                           /* REVENUE0 */
		   ,4, DECODE (LOAD_TEU, 0, 0, REVENUE / LOAD_TEU)       /* RPB00000 (REV / TEU) */
		   ,5, OTHER_INCOME                                      /* OTHINCOM */
		   ,6, INCOME_TOTAL                                      /* INCOMTTL */
		   ,7, DECODE 
		           (@[f_pro_vw]
		           ,'P', CM_COST 
		           ,'R', DECODE (@[f_ofc_lvl]
		                        ,'1', (CM_COST + SPC_CHTR) 
		                        ,CM_COST 
		                        ) 
		           )                                             /* CMCOST00 (Cost1 Total) */
		   ,8, DECODE (LOAD_TEU 
		              ,0, 0 
		              ,   DECODE (@[f_pro_vw]
		                         ,'P', CM_COST 
		                         ,'R', DECODE (@[f_ofc_lvl]
		                                      ,'1', (CM_COST + SPC_CHTR) 
		                                      ,CM_COST
		                                      ) 
		                         ) 
		                / LOAD_TEU 
		              )                                          /* CMCB0000 (Cost1/TEU) */
		   ,9, DECODE (@[f_pro_vw]
		              ,'P', (INCOME_TOTAL) - (CM_COST + SPC_CHTR) 
		              ,'R', DECODE (@[f_ofc_lvl]
		                           ,'1', (INCOME_TOTAL) - (CM_COST + SPC_CHTR) 
		                           , (INCOME_TOTAL) - (CM_COST + SPC_CHTR) 
		                           ) 
		              )   /* CMCTOTAL (CM(Contribution Margin) Total) */
		   ,10, DECODE (LOAD_TEU 
		               ,0, 0 
		               , (  DECODE (@[f_pro_vw]
		                           ,'P', (INCOME_TOTAL) - (CM_COST + SPC_CHTR) 
		                           ,'R', DECODE (@[f_ofc_lvl]
		                                        ,'1', (INCOME_TOTAL) - (CM_COST + SPC_CHTR) 
		                                        , (INCOME_TOTAL) - (CM_COST + SPC_CHTR) 
		                                        ) 
		                           ) 
		                  / LOAD_TEU 
		                 ) 
		               )   /* CMB00000 (CM(Contribution Margin)/TEU) */
		   ,11, OP_COST 
		   ,12, DECODE (LOAD_TEU, 0, 0, OP_COST / LOAD_TEU) 
		   ,13, DECODE (@[f_pro_vw]
		               ,'P', 0 
		               ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE (@[f_ofc_lvl],'1', 0, INCOME_TOTAL - (CM_COST + SPC_CHTR) + (STP_REV-ABC_OTH_COND) + (ABC_OTH - STP_COST) - OP_COST)) 
		               )   /* OPCTOTAL (Branch CM-cost2) */
		   ,14, DECODE (LOAD_TEU 
		               ,0, 0 
		               ,   DECODE (@[f_pro_vw]
		                          ,'P', 0 
		                          ,'R',DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE (@[f_ofc_lvl],'1', 0,INCOME_TOTAL - (CM_COST + SPC_CHTR) + (STP_REV-ABC_OTH_COND)+(ABC_OTH - STP_COST) - OP_COST)) 
		                          ) 
		                 / LOAD_TEU 
		               )  /* OPB00000(OPCTOTAL/load) */
		   ,15, (INCOME_TOTAL + TS_COST) - (CM_COST + OP_COST)   /* TSCTRB01 */
		   ,16, ((INCOME_TOTAL - CM_COST) - N6TH_HJS_SLS_AMT - N6TH_CO_AMT - CMMT_COST - INTER_TS)   /* CMMT0001 */
		   ,17, DECODE (@[f_pro_vw]
		               ,'P', 0 
		               ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE (@[f_ofc_lvl],'1', 0, (INCOME_TOTAL) - (CM_COST + SPC_CHTR) + (STP_REV-ABC_OTH_COND)+(ABC_OTH - STP_COST))) 
		               )   /* BCMTOTAL (Branch CM)  */
		   ,18, DECODE (LOAD_TEU 
		               ,0, 0 
		               ,   DECODE (@[f_pro_vw]
		                          ,'P', 0 
		                          ,'R',DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE (@[f_ofc_lvl],'1', 0,(INCOME_TOTAL) - (CM_COST + SPC_CHTR) + (STP_REV-ABC_OTH_COND)+(ABC_OTH - STP_COST))) 
		                          ) 
		                 / LOAD_TEU 
		               ) 
		   ,19, DECODE (@[f_pro_vw],'P', 0 ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, ABC_OTH)))                /* 65901023 */
		   ,20, DECODE (@[f_pro_vw],'P', 0 ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, STP_REV-ABC_OTH_COND)))   /* BLN00001 */
		   ,21, DECODE (@[f_pro_vw],'P', 0 ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, STP_COST - ABC_OTH)))     /* BLN00002 */
		   ,22, DECODE (@[f_pro_vw],'P', 0 ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C',DECODE(@[f_ofc_lvl],'1',0, (STP_REV-ABC_OTH_COND)-(STP_COST - ABC_OTH))))   /* BLNTOTAL */
		   ,23, DECODE (@[f_pro_vw]
		               ,'P', INCOME_TOTAL - (CM_COST + OP_COST) 
		               ,'R', DECODE (@[f_ofc_lvl]
		                            ,'1', INCOME_TOTAL - (CM_COST + OP_COST + SPC_CHTR) 
		                            , INCOME_TOTAL - (CM_COST + OP_COST) 
		                            ) 
		               )   /* BOPTOTAL */
		   ,24, DECODE (LOAD_TEU 
		               ,0, 0 
		               , (  DECODE (@[f_pro_vw]
		                          ,'P', INCOME_TOTAL - (CM_COST + OP_COST) 
		                          ,'R', DECODE (@[f_ofc_lvl]
		                                       ,'1', INCOME_TOTAL - (CM_COST + OP_COST + SPC_CHTR) 
		                                       , INCOME_TOTAL - (CM_COST + OP_COST) 
		                                       ) 
		                            ) 
		                   ) 
		                   / LOAD_TEU 
		                 )  /* BOPB0000 ((BOPTOTAL)/TEU) */
		   ,25, EQ_COST 
		   ,26, OP_COST01 			   		
		   ,27, OP_COST02 	
		   ,28, INIT_COST 			   		
		   ,29, TS_ALOC		   		
		   ,30, GEN_EXPN  
		   ) AS AMT    
         , OTR_AMT AS OTR_AMT	         
	FROM ( 
		/*-- SUMMRY : 계정별비용집계 ----*/
		SELECT    
			 COST_YRMON 
			,SLS_YRMON 
			,COST_WK 
#if($f_ofc_lvl == '2')
			,OFC_N2ND_LVL_CD
#end
			,TRD_CD 
			,SUB_TRD_CD 
			,RLANE_CD 
			,IOC_CD 
			,VSL_CD 
			,SKD_VOY_NO 
			,DIR_CD 
			,HUL_BND_CD
			,SUM (VOYAGE) VOYAGE 
			,SUM (SUPPLY) SUPPLY 
			,SUM (LOAD_TEU) LOAD_TEU 
			,SUM (REVENUE) REVENUE 
			,SUM (OTHER_INCOME) OTHER_INCOME 
			,SUM (SPC_CHTR) SPC_CHTR 
			,SUM (INCOME_TOTAL) INCOME_TOTAL 
			,SUM (CM_COST) CM_COST 
			,SUM (ABC_OWN) ABC_OWN 
			,SUM (STP_COST) STP_COST 
			,SUM (STP_REV) STP_REV 
			,SUM (ABC_OTH) ABC_OTH 
			,SUM (ABC_OTH_COND) ABC_OTH_COND 
			,SUM (OP_COST) + SUM (GEN_EXPN) OP_COST 
			,SUM (TS_COST) TS_COST 
			,SUM (CMMT_COST) CMMT_COST 
			,SUM (N6TH_HJS_SLS_AMT) N6TH_HJS_SLS_AMT 
			,SUM (N6TH_CO_AMT) N6TH_CO_AMT 
			,SUM (INTER_TS) INTER_TS 
			,SUM (EQ_COST) EQ_COST 
			,SUM (DEM_DET) DEM_DET 
			,SUM (OP_COST01) + SUM (GEN_EXPN) OP_COST01
			,SUM (OP_COST01) - SUM (OP_COST) OP_COST02
			,SUM (INIT_COST) INIT_COST
			,SUM (TS_ALOC) TS_ALOC
			,SUM (GEN_EXPN) GEN_EXPN
		    ,SUM (OTR_AMT) OTR_AMT
		FROM ( 
			SELECT  /*+ ORDERED */ 
				 A1.COST_YRMON 
				,A1.SLS_YRMON 
				,A1.COST_WK 
#if($f_ofc_lvl == '2')
				,A4.OFC_N2ND_LVL_CD
#end
				,A1.TRD_CD 
				,A1.SUB_TRD_CD 
				,A1.RLANE_CD 
				,A1.IOC_CD 
				,A1.VSL_CD 		
				,A1.SKD_VOY_NO 		
				,A1.DIR_CD 	
				,L1.HUL_BND_CD	
				,COUNT(DISTINCT A2.TRD_CD|| A2.RLANE_CD || A2.IOC_CD || A2.VSL_CD || A2.SKD_VOY_NO || A2.SKD_DIR_CD)  AS VOYAGE 
				,NVL(SUM(DECODE(A3.STND_COST_CD,'BSA00000', DECODE (@[f_pro_vw],'P', A2.N6TH_ESTM_PL_AMT,'R', A2.RA_PL_AMT),0)),0) AS SUPPLY 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'LOAD0000', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1),'2', A2.N6TH_ESTM_PL_AMT, '3', A2.N6TH_ESTM_PL_AMT, A2.N6TH_ESTM_PL_AMT * 2) 
				                                     ,'R', DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1),'2', A2.RA_PL_AMT,'3', A2.RA_PL_AMT,A2.RA_PL_AMT * 2) 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS LOAD_TEU 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'41101011', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT, A2.N6TH_ESTM_PL_AMT) 
				                                     ,'R', A2.RA_PL_AMT 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS REVENUE 
				,NVL(SUM(CASE 
				           WHEN A3.STND_COST_CD IN ('43102011', '43201011', '43207011') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT, A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS OTHER_INCOME 
				,NVL(SUM(CASE 
				           WHEN A3.STND_COST_CD IN ('43102011') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS SPC_CHTR 
				,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
				                 ,'S', DECODE (@[f_pro_vw]
				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT, A2.N6TH_ESTM_PL_AMT) 
				                              ,'R', A2.RA_PL_AMT 
				                              ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS INCOME_TOTAL 
				,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
				                 ,'C', DECODE (A3.STND_COST_CD 
				                              ,'BSA00000', 0 /* 공급량 */
				                              ,'LOAD0000', 0 /* 수송량 */
				                              ,'91401011', 0 /* STP REVENUE */
				                              ,'92404011', 0 /* STP COST  65901021 */
				                              ,DECODE (@[f_pro_vw]
				                                      ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                                      ,'R', A2.RA_PL_AMT 
				                                      ) 
				                              ) 
				                 ) 
				         ) 
				    ,0 
				    ) AS CM_COST 
				,NVL(SUM 
				       (CASE 
				           WHEN A3.STND_COST_CD IN ('65901011') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS ABC_OWN 
				,NVL 
				   (SUM 
				       (CASE 
				           WHEN A3.STND_COST_CD IN ('92404011') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS STP_COST 
				,NVL 
				   (SUM 
				       (CASE 
				           WHEN A3.STND_COST_CD IN ('65901021') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS ABC_OTH 
				,0 AS STP_REV 
				,0 AS ABC_OTH_COND 
				,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
				                 ,'O', DECODE (@[f_pro_vw]
				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                              ,'R', A2.RA_PL_AMT 
				                              ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS OP_COST 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'TSCTRB00', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                                     ,'R', A2.RA_PL_AMT 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS TS_COST 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'CMMT0000', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                                     ,'R', A2.RA_PL_AMT 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS CMMT_COST 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'HJSAMT00', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                                     ,'R', A2.RA_PL_AMT 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS N6TH_HJS_SLS_AMT 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'CHTOUT00', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                                     ,'R', A2.RA_PL_AMT 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS N6TH_CO_AMT 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'INTTRDTS', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                                     ,'R', A2.RA_PL_AMT 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS INTER_TS 
				,NVL 
				   (SUM 
				       (CASE 
				           WHEN A3.STND_COST_CD IN ('92202013','92202014') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS EQ_COST 
				,NVL 
				   (SUM 
				       (CASE 
				           WHEN A3.STND_COST_CD IN ('43201011') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS DEM_DET 
				,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
				                 ,'O', DECODE (@[f_pro_vw]
				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                              ,'R', A2.RA_PL_AMT 
				                              ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS OP_COST01 
                -- Initial Network Cost(SML Sales/Slot Cht-out->All Network Cost by VVD->Total)
                , SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF') AND STND_COST_CD <> '54600000') 
                           THEN NVL(A2.N6TH_HJS_SLS_AMT,0) + NVL(A2.N6TH_CO_AMT,0) - NVL(A2.N6TH_ASGN_AMT,0) ELSE 0 END) INIT_COST
                -- T/S Cost Amount
                , SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF') AND STND_COST_CD <> '54600000') 
                           THEN A2.N6TH_ASGN_AMT ELSE 0 END) TS_ALOC
				, 0 AS GEN_EXPN
                 , NVL(SUM(A2.N6TH_ADJ_OTR_FNL_AMT),0) AS OTR_AMT
			FROM MAS_MON_VVD A1 
				,MAS_PFIT_LSS_SMRY A2 
				,MAS_PFIT_LSS_RPT_ITM A3 
				,MAS_OFC_LVL A4 
				,MAS_LANE_RGST L1
			WHERE A1.VSL_CD       = A2.VSL_CD 
				AND A1.SKD_VOY_NO   = A2.SKD_VOY_NO 
				AND A1.DIR_CD       = A2.SKD_DIR_CD 
				AND A1.TRD_CD       = A2.TRD_CD 
				AND A1.RLANE_CD     = A2.RLANE_CD 
				AND A1.IOC_CD       = A2.IOC_CD 
			
				AND A1.RLANE_CD = L1.RLANE_CD
				AND A1.DIR_CD = L1.DIR_CD
				AND A1.TRD_CD = L1.TRD_CD
				AND A1.IOC_CD = L1.IOC_CD

				#if(${f_chkprd} =='M')
					AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
				#elseif (${f_chkprd} =='W')
					AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
				#end
				#if(${f_init_cost} == 'Y')
					AND A2.STND_COST_CD  NOT IN ('53101000', '53102000', '53200000', '54100000', '54250000', '54300000', '54200000', '54150000','54450000', '54180000', '54550000', '54350000', '54400000')
				#end
								
				AND A2.STND_COST_CD NOT IN ('91401011')   /*, '65901021' STP REV, ABC OTH 제외 */ 
				AND A2.STND_COST_CD = A3.STND_COST_CD 
				AND A1.DELT_FLG     <> 'Y' 
				
				#if(${f_chkprd} =='M')
					AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] 
				#elseif (${f_chkprd} =='W')
					AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%' 
					AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]
				#end
				
				#if(${f_trd_cd} !='') 
					AND A1.TRD_CD    = @[f_trd_cd]  
				#end
				#if(${f_rlane_cd} !='') 
					AND A1.RLANE_CD  = @[f_rlane_cd]
				#end
				#if(${f_dir_cd} !='')   
					AND A1.DIR_CD    = @[f_dir_cd] 
				#end
				#if(${f_vsl_cd} !='') 
					AND A1.VSL_CD    = @[f_vsl_cd] 
				#end
				#if(${f_skd_voy_no} !='')  
					AND A1.SKD_VOY_NO    = @[f_skd_voy_no] 
				#end
				#if(${f_skd_dir_cd} !='') 
					AND A1.DIR_CD     = @[f_skd_dir_cd] 
			    #end  
			    #if(${f_sub_trd_cd} !='') 
				    AND A1.SUB_TRD_CD = @[f_sub_trd_cd] 
		        #end   	
				#if(${f_ias_rgn_cd} !='') 
					AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] 
				#end
				#if(${f_trd_dir_cd} !='') 
					AND L1.HUL_BND_CD = @[f_trd_dir_cd] 
				#end
		
				AND A3.RPT_VW_CD     = @[f_pro_vw]  
				AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD 
						
				#if(${f_ofc_cd} !='')
					#if(${f_excl_sts} =='')
						/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/
						AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  
					#else
						AND A4.OFC_CD        = @[f_ofc_cd]  
					#end
				#else
					/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/
					AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL  
					
					AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD
					                                 ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
					                                                                         , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
					                                                                         , DECODE(A4.OFC_N4TH_LVL_CD, 'SZPDC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */
					                                 ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  
				#end
				
				#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
					AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */
						OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
				#else
					AND A3.STND_COST_TP_CD IN ('S','C','O') 
				#end
				
			GROUP BY  
			    A1.COST_YRMON 
			   ,A1.SLS_YRMON 
			   ,A1.COST_WK
#if($f_ofc_lvl == '2')
			   ,A4.OFC_N2ND_LVL_CD 
#end
			   ,A1.TRD_CD 
			   ,A1.SUB_TRD_CD 
			   ,A1.RLANE_CD 
			   ,A1.IOC_CD 
			   ,A1.VSL_CD 
			   ,A1.DIR_CD 
			   ,L1.HUL_BND_CD
			   ,A1.SKD_VOY_NO 
				
			UNION ALL 
#if(${f_init_cost} == 'Y')
			SELECT  /*+ ORDERED */ 
				 A1.COST_YRMON 
				,A1.SLS_YRMON 
				,A1.COST_WK 
#if($f_ofc_lvl == '2')
				,A4.OFC_N2ND_LVL_CD
#end
				,A1.TRD_CD 
				,A1.SUB_TRD_CD 
				,A1.RLANE_CD 
				,A1.IOC_CD 
				,A1.VSL_CD 		
				,A1.SKD_VOY_NO 		
				,A1.DIR_CD 	
				,L1.HUL_BND_CD	
				,0 AS VOYAGE 
				,NVL(SUM(DECODE(A3.STND_COST_CD,'BSA00000', DECODE (@[f_pro_vw],'P', A2.N6TH_ESTM_PL_AMT,'R', A2.RA_PL_AMT),0)),0) AS SUPPLY 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'LOAD0000', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1),'2', A2.N6TH_ESTM_PL_AMT, '3', A2.N6TH_ESTM_PL_AMT, A2.N6TH_ESTM_PL_AMT * 2) 
				                                     ,'R', DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1),'2', A2.RA_PL_AMT,'3', A2.RA_PL_AMT,A2.RA_PL_AMT * 2) 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS LOAD_TEU 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'41101011', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT, A2.N6TH_ESTM_PL_AMT) 
				                                     ,'R', A2.RA_PL_AMT 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS REVENUE 
				,NVL(SUM(CASE 
				           WHEN A3.STND_COST_CD IN ('43102011', '43201011', '43207011') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT, A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS OTHER_INCOME 
				,NVL(SUM(CASE 
				           WHEN A3.STND_COST_CD IN ('43102011') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS SPC_CHTR 
				,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
				                 ,'S', DECODE (@[f_pro_vw]
				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT, A2.N6TH_ESTM_PL_AMT) 
				                              ,'R', A2.RA_PL_AMT 
				                              ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS INCOME_TOTAL 
				,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
				                 ,'C', DECODE (A3.STND_COST_CD 
				                              ,'BSA00000', 0 /* 공급량 */
				                              ,'LOAD0000', 0 /* 수송량 */
				                              ,'91401011', 0 /* STP REVENUE */
				                              ,'92404011', 0 /* STP COST  65901021 */
				                              ,DECODE (@[f_pro_vw]
				                                      ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                                      ,'R', A2.RA_PL_AMT 
				                                      ) 
				                              ) 
				                 ) 
				         ) 
				    ,0 
				    ) AS CM_COST 
				,NVL(SUM 
				       (CASE 
				           WHEN A3.STND_COST_CD IN ('65901011') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS ABC_OWN 
				,NVL 
				   (SUM 
				       (CASE 
				           WHEN A3.STND_COST_CD IN ('92404011') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS STP_COST 
				,NVL 
				   (SUM 
				       (CASE 
				           WHEN A3.STND_COST_CD IN ('65901021') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS ABC_OTH 
				,0 AS STP_REV 
				,0 AS ABC_OTH_COND 
				-- Initial Network Cost Display 일경우 OP Cost Total 에 T/S cost Amount 를 더한다.
				,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
				                 ,'O', DECODE (@[f_pro_vw]
				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,V.NTWK_HIR_COST_AMT) 
				                              ,'R', A2.RA_PL_AMT 
				                              ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) + SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF') AND STND_COST_CD <> '54600000') 
                           THEN A2.N6TH_ASGN_AMT ELSE 0 END) AS OP_COST 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'TSCTRB00', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                                     ,'R', A2.RA_PL_AMT 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS TS_COST 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'CMMT0000', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                                     ,'R', A2.RA_PL_AMT 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS CMMT_COST 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'HJSAMT00', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                                     ,'R', A2.RA_PL_AMT 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS N6TH_HJS_SLS_AMT 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'CHTOUT00', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                                     ,'R', A2.RA_PL_AMT 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS N6TH_CO_AMT 
				,NVL (SUM (DECODE (A3.STND_COST_CD 
				                 ,'INTTRDTS', DECODE (@[f_pro_vw]
				                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                                     ,'R', A2.RA_PL_AMT 
				                                     ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS INTER_TS 
				,NVL 
				   (SUM 
				       (CASE 
				           WHEN A3.STND_COST_CD IN ('92202013','92202014') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS EQ_COST 
				,NVL 
				   (SUM 
				       (CASE 
				           WHEN A3.STND_COST_CD IN ('43201011') 
				           		THEN DECODE(@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
				           ELSE 0 
				        END 
				       ) 
				   ,0 
				   ) AS DEM_DET 
				,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
				                 ,'O', DECODE (@[f_pro_vw]
				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                              ,'R', A2.RA_PL_AMT 
				                              ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS OP_COST01 
                -- Initial Network Cost(SML Sales/Slot Cht-out->All Network Cost by VVD->Total)
                , SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF') AND STND_COST_CD <> '54600000') 
                           THEN NVL(A2.N6TH_HJS_SLS_AMT,0) + NVL(A2.N6TH_CO_AMT,0) - NVL(A2.N6TH_ASGN_AMT,0) ELSE 0 END) INIT_COST
                -- T/S Cost Amount
                , SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF') AND STND_COST_CD <> '54600000') 
                           THEN A2.N6TH_ASGN_AMT ELSE 0 END) TS_ALOC
				, 0 AS GEN_EXPN
                 , NVL(SUM(A2.N6TH_ADJ_OTR_FNL_AMT),0) AS OTR_AMT
			FROM MAS_MON_VVD A1 
				,MAS_PFIT_LSS_SMRY A2 
				,MAS_PFIT_LSS_RPT_ITM A3 
				,MAS_OFC_LVL A4 
				,MAS_LANE_RGST L1
				,MAS_VVD_HIR V
			WHERE A1.VSL_CD       = A2.VSL_CD 
				AND A1.SKD_VOY_NO   = A2.SKD_VOY_NO 
				AND A1.DIR_CD       = A2.SKD_DIR_CD 
				AND A1.TRD_CD       = A2.TRD_CD 
				AND A1.RLANE_CD     = A2.RLANE_CD 
				AND A1.IOC_CD       = A2.IOC_CD 
			
				AND A1.RLANE_CD = L1.RLANE_CD
				AND A1.DIR_CD = L1.DIR_CD
				AND A1.TRD_CD = L1.TRD_CD
				AND A1.IOC_CD = L1.IOC_CD

				#if(${f_chkprd} =='M')
					AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
				#elseif (${f_chkprd} =='W')
					AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
				#end
				#if(${f_init_cost} == 'Y')
					AND A2.STND_COST_CD  IN ('53101000', '53102000', '53200000', '54100000', '54250000', '54300000', '54200000', '54150000','54450000', '54180000', '54550000', '54350000', '54400000')
				#end
								
				AND A2.STND_COST_CD NOT IN ('91401011')   /*, '65901021' STP REV, ABC OTH 제외 */ 
				AND A2.STND_COST_CD = A3.STND_COST_CD 
					AND V.VSL_CD        = A2.VSL_CD 
					AND V.SKD_VOY_NO    = A2.SKD_VOY_NO 
					AND V.DIR_CD        = A2.SKD_DIR_CD 
					AND V.TRD_CD        = A2.TRD_CD 
					AND V.RLANE_CD      = A2.RLANE_CD 
					AND V.IOC_CD        = A2.IOC_CD 
					AND V.STND_COST_CD  = A2.STND_COST_CD
				AND A1.DELT_FLG     <> 'Y' 
				
				#if(${f_chkprd} =='M')
					AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] 
				#elseif (${f_chkprd} =='W')
					AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%' 
					AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]
				#end
				
				#if(${f_trd_cd} !='') 
					AND A1.TRD_CD    = @[f_trd_cd]  
				#end
				#if(${f_rlane_cd} !='') 
					AND A1.RLANE_CD  = @[f_rlane_cd]
				#end
				#if(${f_dir_cd} !='')   
					AND A1.DIR_CD    = @[f_dir_cd] 
				#end
				#if(${f_vsl_cd} !='') 
					AND A1.VSL_CD    = @[f_vsl_cd] 
				#end
				#if(${f_skd_voy_no} !='')  
					AND A1.SKD_VOY_NO    = @[f_skd_voy_no] 
				#end
				#if(${f_skd_dir_cd} !='') 
					AND A1.DIR_CD     = @[f_skd_dir_cd] 
			    #end  
			    #if(${f_sub_trd_cd} !='') 
				    AND A1.SUB_TRD_CD = @[f_sub_trd_cd] 
		        #end   	
				#if(${f_ias_rgn_cd} !='') 
					AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] 
				#end
				#if(${f_trd_dir_cd} !='') 
					AND L1.HUL_BND_CD = @[f_trd_dir_cd] 
				#end
		
				AND A3.RPT_VW_CD     = @[f_pro_vw]  
				AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD 
						
				#if(${f_ofc_cd} !='')
					#if(${f_excl_sts} =='')
						/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/
						AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  
					#else
						AND A4.OFC_CD        = @[f_ofc_cd]  
					#end
				#else
					/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/
					AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL  
					
					AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD
					                                 ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
					                                                                         , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
					                                                                         , DECODE(A4.OFC_N4TH_LVL_CD, 'SZPDC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */
					                                 ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  
				#end
				
				#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
					AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */
						OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
				#else
					AND A3.STND_COST_TP_CD IN ('S','C','O') 
				#end
				
			GROUP BY  
			    A1.COST_YRMON 
			   ,A1.SLS_YRMON 
			   ,A1.COST_WK
#if($f_ofc_lvl == '2')
			   ,A4.OFC_N2ND_LVL_CD 
#end
			   ,A1.TRD_CD 
			   ,A1.SUB_TRD_CD 
			   ,A1.RLANE_CD 
			   ,A1.IOC_CD 
			   ,A1.VSL_CD 
			   ,A1.DIR_CD 
			   ,L1.HUL_BND_CD
			   ,A1.SKD_VOY_NO 
				
			UNION ALL 
#end
			/* ---- STE REV, ABC OTH ---- */
			SELECT  /*+ ORDERED */ 
				 A1.COST_YRMON 
				,A1.SLS_YRMON 
				,A1.COST_WK
#if($f_ofc_lvl == '2')
				,A4.OFC_N2ND_LVL_CD 
#end
				,A1.TRD_CD 
				,A1.SUB_TRD_CD 
				,A1.RLANE_CD 
				,A1.IOC_CD 
				,A1.VSL_CD 		
				,A1.SKD_VOY_NO 		
				,A1.DIR_CD 	
                ,L1.HUL_BND_CD	
				,0 AS VOYAGE 
				,0 AS SUPPLY 
				,0 AS LOAD_TEU 
				,0 AS REVENUE 
				,0 AS OTHER_INCOME 
				,0 AS SPC_CHTR 
				,0 AS INCOME_TOTAL 
				,0 AS CM_COST 
				,0 AS ABC_OWN 
				,0 AS STP_COST 
				,0 AS ABC_OTH 
				,NVL (SUM (CASE 
				             WHEN A3.STND_COST_CD IN ('91401011') AND A3.RPT_VW_CD = 'R' THEN  A2.RA_PL_AMT 
				             ELSE 0 
				          END 
				         ) 
				    ,0 
				    ) AS STP_REV 
				,NVL (SUM (CASE 
				             WHEN A3.STND_COST_CD IN ('65901021') AND A3.RPT_VW_CD = 'R' THEN  A2.RA_PL_AMT 
				             ELSE 0 
				          END 
				         ) 
				    ,0 
				    ) AS ABC_OTH_COND 
				,0 OP_COST 
				,0 TS_COST 
				,0 CMMT_COST 
				,0 N6TH_HJS_SLS_AMT 
				,0 AS N6TH_CO_AMT 
				,0 AS INTER_TS 
				,0 AS EQ_COST 
				,0 AS DEM_DET
				,0 OP_COST01  
				,0 AS INIT_COST		-- Initial Network Cost
				,0 AS TS_ALOC		-- T/S Cost Amount
				,0 AS GEN_EXPN
                , 0 AS OTR_AMT
			FROM MAS_MON_VVD A1 
				,MAS_PFIT_LSS_SVC_TRNS_PRC A2 
				,MAS_PFIT_LSS_RPT_ITM A3 
				,MAS_OFC_LVL A4 
				,MAS_LANE_RGST L1
			WHERE A1.VSL_CD        = A2.VSL_CD 
				AND A1.SKD_VOY_NO    = A2.SKD_VOY_NO 
				AND A1.DIR_CD        = A2.SKD_DIR_CD 
				AND A1.TRD_CD        = A2.TRD_CD 
				AND A1.RLANE_CD      = A2.RLANE_CD 
				AND A1.IOC_CD        = A2.IOC_CD 
				
				AND A1.RLANE_CD = L1.RLANE_CD
				AND A1.DIR_CD = L1.DIR_CD
				AND A1.TRD_CD = L1.TRD_CD
				AND A1.IOC_CD = L1.IOC_CD

				#if(${f_chkprd} =='M')
					AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
				#elseif (${f_chkprd} =='W')
					AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
				#end /*ofc_월별 관리*/
		
				AND A2.STND_COST_CD  IN ('91401011', '65901021') 
				AND A2.STND_COST_CD  = A3.STND_COST_CD 
				AND A1.DELT_FLG      <> 'Y' 
				
				#if(${f_chkprd} =='M')
					AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] 
				#elseif (${f_chkprd} =='W')
					AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'  
					AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]
				#end
				
				#if(${f_trd_cd} !='') 
					AND A1.TRD_CD    = @[f_trd_cd]  
				#end
				#if(${f_rlane_cd} !='') 
					AND A1.RLANE_CD  = @[f_rlane_cd]
				#end
				#if(${f_dir_cd} !='')   
					AND A1.DIR_CD    = @[f_dir_cd] 
				#end
				#if(${f_vsl_cd} !='') 
					AND A1.VSL_CD    = @[f_vsl_cd] 
				#end
				#if(${f_skd_voy_no} !='')  
					AND A1.SKD_VOY_NO    = @[f_skd_voy_no] 
				#end
				#if(${f_skd_dir_cd} !='') 
					AND A1.DIR_CD     = @[f_skd_dir_cd] 
			    #end
			    #if(${f_sub_trd_cd} !='') 
				    AND A1.SUB_TRD_CD = @[f_sub_trd_cd] 
		        #end
				#if(${f_ias_rgn_cd} !='') 
					AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] 
				#end
				#if(${f_trd_dir_cd} !='') 
					AND L1.HUL_BND_CD = @[f_trd_dir_cd] 
				#end
		
				AND A3.RPT_VW_CD     = @[f_pro_vw]
				AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD  
				
				#if(${f_ofc_cd} !='')
					#if(${f_excl_sts} =='')
						/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '') */
						AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  
					#else
						AND A4.OFC_CD  = @[f_ofc_cd]  
					#end
				#else
					/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAR', 'SINRS', '')*/
					AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL 
					AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD
					                                 ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
					                                                                         , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
					                                                                         , DECODE(A4.OFC_N4TH_LVL_CD, 'SZPDC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */
					                                 ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  
				#end
				
				#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
					AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */
						OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
				#else
					AND A3.STND_COST_TP_CD IN ('S','C','O')  
				#end
				
			GROUP BY  
				 A1.COST_YRMON 
				,A1.SLS_YRMON 
				,A1.COST_WK 
#if($f_ofc_lvl == '2')
				,A4.OFC_N2ND_LVL_CD
#end
				,A1.TRD_CD 
				,A1.SUB_TRD_CD 
				,A1.RLANE_CD 
				,A1.IOC_CD 
				,A1.VSL_CD 
				,A1.SKD_VOY_NO 
				,A1.DIR_CD 
				,L1.HUL_BND_CD


			   UNION ALL 

				/* General Expense */
			   SELECT A1.COST_YRMON
					, A1.SLS_YRMON 
					, A1.COST_WK
 
#if($f_ofc_lvl == '2')
					, A4.OFC_N2ND_LVL_CD
#end
					, A1.TRD_CD
					, A1.SUB_TRD_CD
					, A1.RLANE_CD 
					, A1.IOC_CD
					, A1.VSL_CD 		
					, A1.SKD_VOY_NO 	
					, A1.DIR_CD
					, L1.HUL_BND_CD 
					, 0 AS VOYAGE 
					, 0 AS SUPPLY 
					, 0 AS LOAD_TEU 
					, 0 AS REVENUE 
					, 0 AS OTHER_INCOME 
					, 0 AS SPC_CHTR 
					, 0 AS INCOME_TOTAL 
					, 0 AS CM_COST 
					, 0 AS ABC_OWN 
					, 0 AS STP_COST 
					, 0 AS ABC_OTH 
					, 0 AS STP_REV 
					, 0 AS ABC_OTH_COND 
					, 0 AS OP_COST 
					, 0 AS TS_COST 
					, 0 AS CMMT_COST 
					, 0 AS HJS_SLS_AMT 
					, 0 AS CO_AMT 
					, 0 AS INTER_TS 
					, 0 AS EQ_COST 
					, 0 AS DEM_DET 
					, 0 AS OP_COST01 
					, 0 AS INIT_COST
					, 0 AS TS_ALOC
					, SUM(DECODE(A3.STND_COST_CD, '65010001', DECODE (@[f_pro_vw], 'P', A2.ESTM_PL_AMT, 'R', A2.RA_PL_AMT), 0)) AS GEN_EXPN
                    , 0 AS OTR_AMT
				 FROM MAS_MON_VVD A1 
					, MAS_PFIT_LSS_GEN_EXPN A2 
					, MAS_PFIT_LSS_RPT_ITM A3 
					, MAS_OFC_LVL A4 
					, MAS_LANE_RGST L1
				WHERE A1.VSL_CD        = A2.VSL_CD 
				  AND A1.SKD_VOY_NO    = A2.SKD_VOY_NO 
				  AND A1.DIR_CD        = A2.SKD_DIR_CD 
				  AND A1.TRD_CD        = A2.TRD_CD 
				  AND A1.RLANE_CD      = A2.RLANE_CD 
				  AND A1.IOC_CD        = A2.IOC_CD 
		
				  AND A1.RLANE_CD      = L1.RLANE_CD
				  AND A1.DIR_CD        = L1.DIR_CD
				  AND A1.TRD_CD        = L1.TRD_CD
				  AND A1.IOC_CD        = L1.IOC_CD

				#if(${f_chkprd} =='M')
				  AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
				#elseif (${f_chkprd} =='W')
				  AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
				#end /*ofc_월별 관리*/
						
				  AND A2.STND_COST_CD  = '65010001' 
				  AND A2.STND_COST_CD  = A3.STND_COST_CD 
				  AND A1.DELT_FLG      <> 'Y' 
				  AND A2.OFC_VW_CD     = @[f_ofc_vw] /* Office view code 별로 expense 관리 */
		
				#if(${f_chkprd} =='M')
				  AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] 
				#elseif (${f_chkprd} =='W')
				  AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'  
				  AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]
				#end
						
				#if(${f_trd_cd} !='') 
				  AND A1.TRD_CD    = @[f_trd_cd]  
				#end
				#if(${f_rlane_cd} !='') 
				  AND A1.RLANE_CD  = @[f_rlane_cd]
				#end
				#if(${f_dir_cd} !='')   
				  AND A1.DIR_CD    = @[f_dir_cd] 
				#end
				#if(${f_vsl_cd} !='') 
				  AND A1.VSL_CD    = @[f_vsl_cd] 
				#end
				#if(${f_skd_voy_no} !='')  
				  AND A1.SKD_VOY_NO    = @[f_skd_voy_no] 
				#end
				#if(${f_skd_dir_cd} !='') 
				  AND A1.DIR_CD     = @[f_skd_dir_cd] 
				#end 
				#if(${f_sub_trd_cd} !='') 
				  AND A1.SUB_TRD_CD = @[f_sub_trd_cd] 
				#end           
				#if(${f_ias_rgn_cd} !='') 
				  AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] 
				#end
				#if(${f_trd_dir_cd} !='') 
				  AND L1.HUL_BND_CD = @[f_trd_dir_cd] 
				#end		
												
				  AND A3.RPT_VW_CD     = @[f_pro_vw]  
				  AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD  
		
				#if(${f_ofc_cd} !='')
					#if(${f_excl_sts} =='')
				  AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  
					#else
				  AND A4.OFC_CD  = @[f_ofc_cd]  
					#end
				#else
						
				  AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL 
				  AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD
								      ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
										   , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCRA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
										   , DECODE(A4.OFC_N4TH_LVL_CD, 'SZPDC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */
								      ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  
				#end
		
				#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
				  AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */
						OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
				#else
				  AND A3.STND_COST_TP_CD IN ('S','C','O')  
				#end	                
						       
				GROUP BY A1.COST_YRMON
					, A1.SLS_YRMON
					, A1.COST_WK
#if($f_ofc_lvl == '2')
					, A4.OFC_N2ND_LVL_CD
#end
					, A1.TRD_CD
					, A1.SUB_TRD_CD
					, A1.RLANE_CD
					, A1.IOC_CD
					, A1.VSL_CD 
					, A1.SKD_VOY_NO 
					, A1.DIR_CD
					, L1.HUL_BND_CD 
			) 
		GROUP BY   
			 COST_YRMON 
			,SLS_YRMON 
			,COST_WK 
#if($f_ofc_lvl == '2')
			,OFC_N2ND_LVL_CD
#end
			,TRD_CD 
			,SUB_TRD_CD 
			,RLANE_CD 
			,IOC_CD 
			,VSL_CD 
			,SKD_VOY_NO 
			,DIR_CD 
			,HUL_BND_CD
		) B1 
		, (SELECT CPY_NO AS RNUM 
			FROM COM_CPY_NO 
			WHERE CPY_NO BETWEEN 1 AND 30
		) B2 
	) A 
    , (SELECT LEVEL AS NO FROM dual  CONNECT BY LEVEL < 3 ) B  
GROUP BY A.COST_YRMON 
	,A.SLS_YRMON 
	,A.COST_WK 
#if($f_ofc_lvl == '2')
	,A.OFC_N2ND_LVL_CD
#end
	,A.TRD_CD 
	,A.SUB_TRD_CD 
	,A.RLANE_CD 
	,A.IOC_CD 
	,A.VSL_CD 
	,A.SKD_VOY_NO 
	,A.DIR_CD
	,A.HUL_BND_CD
    , B.NO
ORDER BY A.SLS_YRMON
      , A.TRD_CD
      , A.RLANE_CD
      , A.IOC_CD
      , A.VSL_CD 
      , A.SKD_VOY_NO 
      , A.DIR_CD
      , A.HUL_BND_CD     
      , DECODE(DECODE(B.NO,1,A.SUB_TRD_CD,2,'OT'),'OT',2,1)			]]></sql>
			<params>
				<param name="f_pro_vw" type="12" value="" out="N"/>
				<param name="f_pro_lvl" type="12" value="" out="N"/>
				<param name="f_chtbiz" type="12" value="" out="N"/>
				<param name="f_ofc_vw" type="12" value="" out="N"/>
				<param name="f_ofc_lvl" type="12" value="" out="N"/>
				<param name="f_year" type="12" value="" out="N"/>
				<param name="f_fm_mon" type="12" value="" out="N"/>
				<param name="f_to_mon" type="12" value="" out="N"/>
				<param name="f_sls_mon" type="12" value="" out="N"/>
				<param name="f_fm_wk" type="12" value="" out="N"/>
				<param name="f_to_wk" type="12" value="" out="N"/>
				<param name="f_trd_cd" type="12" value="" out="N"/>
				<param name="f_rlane_cd" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_vsl_cd" type="12" value="" out="N"/>
				<param name="f_skd_voy_no" type="12" value="" out="N"/>
				<param name="f_skd_dir_cd" type="12" value="" out="N"/>
				<param name="f_sub_trd_cd" type="12" value="" out="N"/>
				<param name="f_ias_rgn_cd" type="12" value="" out="N"/>
				<param name="f_trd_dir_cd" type="12" value="" out="N"/>
				<param name="f_ofc_cd" type="12" value="" out="N"/>
				<param name="f_chkprd" type="12" value="" out="N"/>
				<param name="str_display" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
