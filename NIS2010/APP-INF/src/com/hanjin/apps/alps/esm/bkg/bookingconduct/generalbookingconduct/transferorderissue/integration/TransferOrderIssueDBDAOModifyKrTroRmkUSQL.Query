<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TransferOrderIssueDBDAOModifyKrTroRmkUSQL">
			<desc><![CDATA[TransferOrderIssueDBDAOModifyKrTroRmk
* 2011.10.27 윤태승 [CHM-201113981-01]ALPS > Booking Creation > TRO/O remarks 에 문구 삽입 요청드립니다.]]></desc>
			<sql><![CDATA[
UPDATE /*+ BYPASS_UJVC */ 
(
SELECT INSTR(B.DIFF_RMK, '위 BKG의 D2 장비에 대해 5년 이하의 신규 장비 공급 바랍니다.', 1, 1) AS POS
      ,B.DIFF_RMK
  FROM BKG_BOOKING A
      ,BKG_TRO B
      ,BKG_TRO_DTL C
WHERE A.BKG_NO = @[bkg_no]
   AND A.SLAN_CD = 'ALX'
   AND A.SKD_DIR_CD = 'W'
   AND A.POL_CD = 'KRPUS'
   AND A.POD_CD IN ('BRSSZ','BRRIG', 'ARBUE')
   AND A.BKG_NO = B.BKG_NO
   AND B.IO_BND_CD = 'O'
   AND B.RTN_TRO_FLG = @[rtn_tro_flg]
   AND B.TRO_SEQ = @[tro_seq]
   AND B.BKG_NO = C.BKG_NO
   AND B.IO_BND_CD = C.IO_BND_CD
   AND B.RTN_TRO_FLG = C.RTN_TRO_FLG
   AND B.TRO_SEQ = C.TRO_SEQ
   AND C.CNTR_TPSZ_CD = 'D2'
   AND C.CXL_FLG = 'N'
)
SET  DIFF_RMK =  DIFF_RMK || ' 위 BKG의 D2 장비에 대해 5년 이하의 신규 장비 공급 바랍니다.'
WHERE POS IS NULL
   OR POS = 0			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="rtn_tro_flg" type="12" value="" out="N"/>
				<param name="tro_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
