<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TCharterIOBunkerRegisterDAOFmsBunkerRSQL">
			<desc><![CDATA[TCharterIOBunkerRegisterDAOFmsBunkerRSQL]]></desc>
			<sql><![CDATA[
SELECT 
       FLET_CTRT_NO
       ,BNK_SEQ
       ,BNK_YRMON
 	   ,BNK_TP_CD
 	   ,FB.ACCT_CD
 	   ,FB.ACCT_ITM_SEQ
 	   ,FA.ACCT_ITM_NM
       ,TO_CHAR(BNK_DT, 'YYYYMMDDHH24MI') BNK_DT
 	   ,VSL_CD
 	   ,PORT_CD
	   ,FLET_MEAS_UT_CD
	   ,BNK_QTY
	   ,BNK_PRC_AMT
 	   ,BNK_AMT
       ,ROUND(FB.BNK_QTY * FB.BNK_PRC_AMT, 4) TOTAL_AMT
       ,FB.VSL_CD||FB.SKD_VOY_NO||FB.SKD_DIR_CD||FB.REV_DIR_CD BUNKER_VVD
       ,(SELECT U.USR_NM FROM COM_USER U WHERE U.USR_ID = FB.CRE_USR_ID) UPD_USR_ID 
       , FB.ATCH_FILE_FLET_LNK_ID
       ,(SELECT COUNT(F.FILE_SAV_ID) CNT
           FROM FMS_ATCH_FILE F
          WHERE 1 = 1
            AND F.ATCH_FILE_LNK_ID = FB.ATCH_FILE_FLET_LNK_ID
        ) AS ATCH_FILE_LNK_CNT
	   , SLP_TP_CD||SLP_FUNC_CD||SLP_OFC_CD||SLP_ISS_DT||SLP_SER_NO CSR_NO
 FROM FMS_BUNKER FB, FMS_ACCT_ITM FA
 WHERE 1 = 1
   #if(${flet_ctrt_no} != '')
      AND FLET_CTRT_NO = @[flet_ctrt_no]
   #end
   AND BNK_YRMON = REPLACE(@[bnk_yrmon],'-','')
   AND FA.ACCT_CD = FB.ACCT_CD
   AND FA.ACCT_ITM_SEQ = FB.ACCT_ITM_SEQ
 ORDER BY FB.BNK_TP_CD, FB.ACCT_ITM_SEQ			]]></sql>
			<params>
				<param name="flet_ctrt_no" type="12" value="" out="N"/>
				<param name="bnk_yrmon" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
