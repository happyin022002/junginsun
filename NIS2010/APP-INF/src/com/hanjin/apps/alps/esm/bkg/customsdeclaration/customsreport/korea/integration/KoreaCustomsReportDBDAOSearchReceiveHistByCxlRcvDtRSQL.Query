<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="KoreaCustomsReportDBDAOSearchReceiveHistByCxlRcvDtRSQL">
			<desc><![CDATA[2011.11.14 변종건[CHM-201114372-01] 한국지역 적하목록 사전 제출 관련 SYS보완 요청 - Receive History 화면에서 수신된 MSG(5VJ) 추가 작업]]></desc>
			<sql><![CDATA[
SELECT  DISTINCT L.MSG_LOG_TP_CD
      , TO_CHAR(D.RCV_DT,'YYYY-MM-DD HH24:MI:SS') AS RCV_DT
      , '' VVD
      , '' POL_CD
      , '' POD_CD
      , '' OFC_CD
      , '' BL_NO
      , DECODE(@[cboMsgTp],'5VJ',D.EDI_RCV_MSG,'') AS SMT_AMD_NO
      , DECODE(L.KR_CSTMS_ACPT_CD,'C','승인','E','기각') AS MSG_STS
      , D.KR_CSTMS_RJCT_RSN1 AS MSG_TEXT
      , L.EDI_RCVR_NM
      , L.TML_CD
      , L.KR_VSL_CALL_SGN_CD
      , L.ARR_YR
      , L.CALL_KNT
      , L.CSTMS_REF_NM
	  , L.RCV_SEQ RCV_SEQ
	  , L.FLT_FILE_REF_NO
FROM    BKG_CSTMS_KR_RCV_LOG L
      , BKG_CSTMS_KR_RCV_LOG_DTL D
WHERE   1 = 1
AND     D.MSG_LOG_TP_CD = L.MSG_LOG_TP_CD
AND     D.RCV_DT = L.RCV_DT
AND     D.RCV_SEQ = L.RCV_SEQ
AND     D.FLT_FILE_REF_NO = L.FLT_FILE_REF_NO
AND     L.MSG_LOG_TP_CD = @[cboMsgTp]
AND     L.RCV_DT >= TO_DATE(@[from_dt]||'000000', 'YYYY-MM-DDHH24MISS') 
AND     L.RCV_DT <= TO_DATE(@[to_dt]  ||'235959', 'YYYY-MM-DDHH24MISS')
ORDER BY RCV_DT DESC			]]></sql>
			<params>
				<param name="cboMsgTp" type="12" value="" out="N"/>
				<param name="from_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
