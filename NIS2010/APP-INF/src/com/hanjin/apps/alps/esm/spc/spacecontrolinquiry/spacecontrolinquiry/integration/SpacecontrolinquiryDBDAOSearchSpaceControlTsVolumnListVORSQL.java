/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : SpacecontrolinquiryDBDAOSearchSpaceControlTsVolumnListVORSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.07.20
*@LastModifier : Arie
*@LastVersion : 1.0
* 2016.07.20 Arie
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esm.spc.spacecontrolinquiry.spacecontrolinquiry.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author Arie
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class SpacecontrolinquiryDBDAOSearchSpaceControlTsVolumnListVORSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * - Lee Sang-Yong : [프로젝트] Ticket ID : CHM-201004171 53ft 추가
	  * 2010.11.16 남궁진호 [CHM-201007114-01]  DRL.TO_CONTI_CD <> ‘F’ 조건 제거
	  * 2011.01.04 최윤성 [CHM-201008093-01] Office Level Table 생성
	  *  - SPC_ORGANIZATION_V 대신 SPC_OFC_LVL 로 대체
	  * -2011.06.01 [ CHM-201111305-01] 김종준 R5와 동일하게 R9이 적용될 수 있도록 쿼리수정
	  * -2012.01.10 [SRM-201222989] SFX 노선 소속 trade 변경에 따른 inquiry by T/S port 화면 보완
	  * -2012.01.11 [SRM-201222989] SFX 노선 소속 trade 변경에 따른 inquiry by T/S port 화면 보완
	  * 2012.12.03 [CHM-201221639] 김시몬 R9와 동일하게 R8이 적용될 수 있도록 쿼리수정
	  * 2013.02.06 [CHM-201322502-01] SPC 프로젝트 - 성수기 선복운영 개선을 위한 T/F추진
	  * 2013.11.26 진마리아 [CHM-201326854] SAQ project로 인한 SPC 변경건_FNC 우선제거
	  * 2014.05.23 김시몬-DOUBLE CALL인 경우 IAS = MIN, Ocean = MAX 가져오도록 변경
	  * 2014.07.31 김시몬 [CHM-201431081] SPC Allocation Control Option 추가 보완
	  * 2015.01.07 신자영 [CHM-201433400] Inquiry by TS Port 메뉴의 데이터 변경 요청
	  * 2016.07.05 CHM-201642241 VGM(BKG상 표시되는 또 다른 WGT 정보) 도입 관련 SPC 사항
	  * </pre>
	  */
	public SpacecontrolinquiryDBDAOSearchSpaceControlTsVolumnListVORSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("port",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("subtrade",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("eDate",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("trade",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ioc",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sDate",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("org",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("bound",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("lane",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esm.spc.spacecontrolinquiry.spacecontrolinquiry.integration").append("\n"); 
		query.append("FileName : SpacecontrolinquiryDBDAOSearchSpaceControlTsVolumnListVORSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("WITH PARAMS1 AS (" ).append("\n"); 
		query.append("    SELECT @[vvd]      AS VVD           , " ).append("\n"); 
		query.append("           @[sDate]    AS FM_DT         ," ).append("\n"); 
		query.append("           @[eDate]    AS TO_DT         ," ).append("\n"); 
		query.append("           @[port]     AS PORT_CD       ," ).append("\n"); 
		query.append("           @[trade]    AS REP_TRD_CD    ," ).append("\n"); 
		query.append("           @[subtrade] AS REP_SUB_TRD_CD," ).append("\n"); 
		query.append("           @[lane]     AS RLANE_CD      ," ).append("\n"); 
		query.append("           @[bound]    AS BOUND         ," ).append("\n"); 
		query.append("           @[ioc]      AS IOC_CD        ," ).append("\n"); 
		query.append("           @[org]      AS ORG" ).append("\n"); 
		query.append("      FROM DUAL" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", PARAMS AS (" ).append("\n"); 
		query.append("    SELECT VVD," ).append("\n"); 
		query.append("           LEAST(FM_DT, TO_DT)    AS FM_SDT," ).append("\n"); 
		query.append("           GREATEST(FM_DT, TO_DT) AS TO_SDT," ).append("\n"); 
		query.append("           TO_DATE(LEAST(REPLACE(FM_DT,'-',''), REPLACE(TO_DT,'-','')), 'YYYYMMDD')    AS FM_DT," ).append("\n"); 
		query.append("           TO_DATE(GREATEST(REPLACE(FM_DT,'-',''), REPLACE(TO_DT,'-','')), 'YYYYMMDD') AS TO_DT," ).append("\n"); 
		query.append("           PORT_CD       ," ).append("\n"); 
		query.append("           REP_TRD_CD    ," ).append("\n"); 
		query.append("           REP_SUB_TRD_CD," ).append("\n"); 
		query.append("           RLANE_CD      ," ).append("\n"); 
		query.append("           BOUND         ," ).append("\n"); 
		query.append("           IOC_CD        ," ).append("\n"); 
		query.append("           ORG           ," ).append("\n"); 
		query.append("           SUBSTR(VVD, 1, 4) AS VSL_CD    ," ).append("\n"); 
		query.append("           SUBSTR(VVD, 5, 4) AS SKD_VOY_NO," ).append("\n"); 
		query.append("           SUBSTR(VVD, 9)    AS SKD_DIR_CD," ).append("\n"); 
		query.append("           (" ).append("\n"); 
		query.append("             SELECT L.CONTI_CD" ).append("\n"); 
		query.append("               FROM MDM_LOCATION L" ).append("\n"); 
		query.append("              WHERE L.LOC_CD = PORT_CD" ).append("\n"); 
		query.append("           ) AS PORT_CONTI" ).append("\n"); 
		query.append("      FROM PARAMS1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", VVDS AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT PRD.COST_YR," ).append("\n"); 
		query.append("           LPAD(CEIL((TO_CHAR(PS.VPS_ETB_DT, 'DDD') + 7 - TO_CHAR(TO_DATE(PRD.SLS_TO_DT, 'YYYYMMDD'), 'DDD')) / 7), 2, '0') AS COST_WK," ).append("\n"); 
		query.append("           PS.SLAN_CD   ," ).append("\n"); 
		query.append("           RL.REP_TRD_CD," ).append("\n"); 
		query.append("           DRL.SUB_TRD_CD AS REP_SUB_TRD_CD," ).append("\n"); 
		query.append("           RL.RLANE_CD  ," ).append("\n"); 
		query.append("           PS.VSL_CD    ," ).append("\n"); 
		query.append("           PS.SKD_VOY_NO," ).append("\n"); 
		query.append("           PS.SKD_DIR_CD," ).append("\n"); 
		query.append("           NVL(PS.YD_CD, PS.VPS_PORT_CD) AS POL_CD," ).append("\n"); 
		query.append("           PS.CLPT_SEQ   AS POL_SEQ   ," ).append("\n"); 
		query.append("           PS.VPS_ETB_DT AS POL_ETB_DT," ).append("\n"); 
		query.append("           P.PORT_CONTI  AS POL_CONTI ," ).append("\n"); 
		query.append("           P.IOC_CD," ).append("\n"); 
		query.append("           P.ORG" ).append("\n"); 
		query.append("      FROM MAS_WK_PRD       PRD," ).append("\n"); 
		query.append("           VSK_VSL_PORT_SKD PS ," ).append("\n"); 
		query.append("           MDM_REV_LANE     RL ," ).append("\n"); 
		query.append("           MDM_DTL_REV_LANE DRL," ).append("\n"); 
		query.append("           PARAMS           P" ).append("\n"); 
		query.append("     WHERE PRD.COST_YR         = TO_CHAR(PS.VPS_ETB_DT, 'YYYY')" ).append("\n"); 
		query.append("       AND PRD.COST_WK         = '01'" ).append("\n"); 
		query.append("       AND RL.VSL_SLAN_CD      = PS.SLAN_CD" ).append("\n"); 
		query.append("       AND RL.RLANE_CD         = DRL.RLANE_CD" ).append("\n"); 
		query.append("       AND RL.REP_TRD_CD       = DRL.TRD_CD" ).append("\n"); 
		query.append("       AND DRL.VSL_SLAN_DIR_CD = PS.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND RL.DELT_FLG         = 'N'" ).append("\n"); 
		query.append("       AND DRL.DELT_FLG        = 'N'" ).append("\n"); 
		query.append("       /**  CHM-201007114-01 처리" ).append("\n"); 
		query.append("       AND DRL.TO_CONTI_CD    <> 'F' " ).append("\n"); 
		query.append("       **/" ).append("\n"); 
		query.append("       AND RL.REP_TRD_CD       = P.REP_TRD_CD" ).append("\n"); 
		query.append("       AND (P.REP_SUB_TRD_CD IS NULL OR P.REP_SUB_TRD_CD = DRL.SUB_TRD_CD)" ).append("\n"); 
		query.append("       AND (P.RLANE_CD IS NULL OR P.RLANE_CD = RL.RLANE_CD)" ).append("\n"); 
		query.append("       AND (P.BOUND IS NULL OR P.BOUND = PS.SKD_DIR_CD)" ).append("\n"); 
		query.append("       AND RL.VSL_TP_CD   = 'C'" ).append("\n"); 
		query.append("       AND RL.RLANE_CD   <> 'RBCCO'" ).append("\n"); 
		query.append("       AND PS.VPS_PORT_CD = P.PORT_CD" ).append("\n"); 
		query.append("       AND PS.SKD_DIR_CD  > ' '" ).append("\n"); 
		query.append("       AND PS.VPS_ETB_DT >= P.FM_DT" ).append("\n"); 
		query.append("       AND PS.VPS_ETB_DT <= P.TO_DT + 0.99999" ).append("\n"); 
		query.append("       AND (PS.SKD_CNG_STS_CD IS NULL OR PS.SKD_CNG_STS_CD <> 'S')" ).append("\n"); 
		query.append("       AND PS.TURN_PORT_IND_CD IN ('Y', 'N')" ).append("\n"); 
		query.append("       AND P.VVD IS NULL" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT PRD.COST_YR," ).append("\n"); 
		query.append("           LPAD(CEIL((TO_CHAR(PS.VPS_ETB_DT, 'DDD') + 7 - TO_CHAR(TO_DATE(PRD.SLS_TO_DT, 'YYYYMMDD'), 'DDD')) / 7), 2, '0') AS COST_WK," ).append("\n"); 
		query.append("           PS.SLAN_CD   ," ).append("\n"); 
		query.append("           RL.REP_TRD_CD," ).append("\n"); 
		query.append("           (" ).append("\n"); 
		query.append("             SELECT DRL.SUB_TRD_CD" ).append("\n"); 
		query.append("               FROM MDM_DTL_REV_LANE DRL" ).append("\n"); 
		query.append("              WHERE RL.RLANE_CD         = DRL.RLANE_CD" ).append("\n"); 
		query.append("                AND RL.REP_TRD_CD       = DRL.TRD_CD" ).append("\n"); 
		query.append("                AND DRL.VSL_SLAN_DIR_CD = PS.SKD_DIR_CD" ).append("\n"); 
		query.append("                AND DRL.DELT_FLG        = 'N'" ).append("\n"); 
		query.append("                /**  CHM-201007114-01 처리 " ).append("\n"); 
		query.append("                AND DRL.TO_CONTI_CD    <> 'F' " ).append("\n"); 
		query.append("                **/" ).append("\n"); 
		query.append("                AND ROWNUM = 1" ).append("\n"); 
		query.append("           ) AS REP_SUB_TRD_CD," ).append("\n"); 
		query.append("           RL.RLANE_CD  ," ).append("\n"); 
		query.append("           PS.VSL_CD    ," ).append("\n"); 
		query.append("           PS.SKD_VOY_NO," ).append("\n"); 
		query.append("           PS.SKD_DIR_CD," ).append("\n"); 
		query.append("           NVL(PS.YD_CD, PS.VPS_PORT_CD) AS POL_CD," ).append("\n"); 
		query.append("           PS.CLPT_SEQ    AS POL_SEQ   ," ).append("\n"); 
		query.append("           PS.VPS_ETB_DT  AS POL_ETB_DT," ).append("\n"); 
		query.append("           P.PORT_CONTI   AS POL_CONTI ," ).append("\n"); 
		query.append("           P.IOC_CD," ).append("\n"); 
		query.append("           P.ORG" ).append("\n"); 
		query.append("      FROM MAS_WK_PRD       PRD," ).append("\n"); 
		query.append("           VSK_VSL_PORT_SKD PS ," ).append("\n"); 
		query.append("           MDM_REV_LANE     RL ," ).append("\n"); 
		query.append("           PARAMS           P" ).append("\n"); 
		query.append("     WHERE PRD.COST_YR    = TO_CHAR(PS.VPS_ETB_DT, 'YYYY')" ).append("\n"); 
		query.append("       AND PRD.COST_WK    = '01'" ).append("\n"); 
		query.append("       AND RL.VSL_SLAN_CD = PS.SLAN_CD" ).append("\n"); 
		query.append("       AND RL.DELT_FLG    = 'N'" ).append("\n"); 
		query.append("       AND RL.VSL_TP_CD   = 'C'" ).append("\n"); 
		query.append("       AND RL.RLANE_CD   <> 'RBCCO'" ).append("\n"); 
		query.append("       AND PS.VPS_PORT_CD = P.PORT_CD" ).append("\n"); 
		query.append("       AND PS.SKD_DIR_CD  > ' '" ).append("\n"); 
		query.append("       AND PS.VSL_CD      = P.VSL_CD" ).append("\n"); 
		query.append("       AND PS.SKD_VOY_NO  = P.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND PS.SKD_DIR_CD  = P.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND (PS.SKD_CNG_STS_CD IS NULL OR PS.SKD_CNG_STS_CD <> 'S')" ).append("\n"); 
		query.append("       AND PS.TURN_PORT_IND_CD IN ('Y', 'N')" ).append("\n"); 
		query.append("       AND RL.RLANE_CD    IN (SELECT RLANE_CD " ).append("\n"); 
		query.append("                                FROM MAS_MON_VVD" ).append("\n"); 
		query.append("                               WHERE VSL_CD = P.VSL_CD" ).append("\n"); 
		query.append("                                 AND SKD_VOY_NO = P.SKD_VOY_NO" ).append("\n"); 
		query.append("                                 AND DIR_CD = P.SKD_DIR_CD" ).append("\n"); 
		query.append("                                 AND DELT_FLG = 'N')" ).append("\n"); 
		query.append("       AND P.VVD IS NOT NULL" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", PORT_SKD AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT" ).append("\n"); 
		query.append("           PS.COST_YR       ," ).append("\n"); 
		query.append("           PS.COST_WK       ," ).append("\n"); 
		query.append("           PS.SLAN_CD       ," ).append("\n"); 
		query.append("           PS.REP_TRD_CD    ," ).append("\n"); 
		query.append("           PS.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("           DRL.TRD_CD       ," ).append("\n"); 
		query.append("           DRL.SUB_TRD_CD   ," ).append("\n"); 
		query.append("           PS.RLANE_CD      ," ).append("\n"); 
		query.append("           PS.VSL_CD        ," ).append("\n"); 
		query.append("           PS.SKD_VOY_NO    ," ).append("\n"); 
		query.append("           PS.SKD_DIR_CD    ," ).append("\n"); 
		query.append("           PS.POL_CD        ," ).append("\n"); 
		query.append("           PS.POL_SEQ       ," ).append("\n"); 
		query.append("           PS.POL_ETB_DT    ," ).append("\n"); 
		query.append("           SPC_CONTI_CONV_FNC(PS.POL_CONTI, PS.RLANE_CD,PS.SKD_DIR_CD) as pol_conti     ," ).append("\n"); 
		query.append("           NVL(VPS.YD_CD, VPS.VPS_PORT_CD) AS POD_CD," ).append("\n"); 
		query.append("           CASE WHEN DRL.TRD_CD !='TPS' AND DRL.TRD_CD !='AES' AND DRL.TRD_CD !='TAS' THEN" ).append("\n"); 
		query.append("               MIN(VPS.CLPT_SEQ) OVER(PARTITION BY DRL.TRD_CD,DRL.SUB_TRD_CD,PS.RLANE_CD,PS.VSL_CD,PS.SKD_VOY_NO,PS.SKD_DIR_CD,NVL(VPS.YD_CD, VPS.VPS_PORT_CD))" ).append("\n"); 
		query.append("           ELSE" ).append("\n"); 
		query.append("               MAX(VPS.CLPT_SEQ) OVER(PARTITION BY DRL.TRD_CD,DRL.SUB_TRD_CD,PS.RLANE_CD,PS.VSL_CD,PS.SKD_VOY_NO,PS.SKD_DIR_CD,NVL(VPS.YD_CD, VPS.VPS_PORT_CD))" ).append("\n"); 
		query.append("           END  AS POD_SEQ   ,           " ).append("\n"); 
		query.append("           CASE WHEN DRL.TRD_CD !='TPS' AND DRL.TRD_CD !='AES' AND DRL.TRD_CD !='TAS' THEN" ).append("\n"); 
		query.append("               MIN(VPS.VPS_ETB_DT) OVER(PARTITION BY DRL.TRD_CD,DRL.SUB_TRD_CD,PS.RLANE_CD,PS.VSL_CD,PS.SKD_VOY_NO,PS.SKD_DIR_CD,NVL(VPS.YD_CD, VPS.VPS_PORT_CD))" ).append("\n"); 
		query.append("           ELSE" ).append("\n"); 
		query.append("               MAX(VPS.VPS_ETB_DT) OVER(PARTITION BY DRL.TRD_CD,DRL.SUB_TRD_CD,PS.RLANE_CD,PS.VSL_CD,PS.SKD_VOY_NO,PS.SKD_DIR_CD,NVL(VPS.YD_CD, VPS.VPS_PORT_CD))" ).append("\n"); 
		query.append("           END  AS POD_ETB_DT   ,          " ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("           SPC_CONTI_CONV_FNC(L.CONTI_CD, PS.RLANE_CD,PS.SKD_DIR_CD)     AS POD_CONTI ," ).append("\n"); 
		query.append("           NVL(CO.CTRL_PORT_FLG   , 'N') AS CTRL_PORT,           " ).append("\n"); 
		query.append("           NVL(CO.CTRL_40FT_HC_FLG, 'N') AS CTRL_HC  ," ).append("\n"); 
		query.append("           NVL(CO.CTRL_45FT_HC_FLG, 'N') AS CTRL_45  ," ).append("\n"); 
		query.append("           NVL(CO.CTRL_53FT_FLG   , 'N') AS CTRL_53  ," ).append("\n"); 
		query.append("           NVL(CO.CTRL_RF_FLG     , 'N') AS CTRL_RF  ,           " ).append("\n"); 
		query.append("           NVL(CO.CTRL_WGT_FLG    , 'N') AS CTRL_WGT ," ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("           -- 20140723 추가" ).append("\n"); 
		query.append("           NVL(CO.CTRL_D2_FLG     , 'N') AS CTRL_D2  ," ).append("\n"); 
		query.append("           NVL(CO.CTRL_D4_FLG     , 'N') AS CTRL_D4  ," ).append("\n"); 
		query.append("           NVL(CO.CTRL_RD_FLG     , 'N') AS CTRL_RD  ," ).append("\n"); 
		query.append("           NVL(CO.CTRL_USA_SVC_MOD_FLG, 'N') AS CTRL_USA  ," ).append("\n"); 
		query.append("           NVL(DECODE(CO.CTRL_ECC_FLG,'Y','E',DECODE(CO.CTRL_LOC_FLG,'Y','L','N')),'N') AS CTRL_DEST, -- E = ECC, L = LOCATION" ).append("\n"); 
		query.append("           NVL(CO.CTRL_DEST_LVL_CD, 'N') AS CTRL_DEST_LVL  , -- D = BKG_POD, T = BKG_DEL" ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("           PS.IOC_CD," ).append("\n"); 
		query.append("           PS.ORG" ).append("\n"); 
		query.append("      FROM MDM_DTL_REV_LANE  DRL," ).append("\n"); 
		query.append("           MDM_LOCATION      L  ," ).append("\n"); 
		query.append("           VSK_VSL_PORT_SKD  VPS," ).append("\n"); 
		query.append("           SPC_ALOC_CTRL_OPT CO ," ).append("\n"); 
		query.append("           VVDS              PS" ).append("\n"); 
		query.append("     WHERE DRL.RLANE_CD        = PS.RLANE_CD" ).append("\n"); 
		query.append("       AND DRL.VSL_SLAN_DIR_CD = PS.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND DRL.IOC_CD          = DECODE(PS.POL_CONTI,SPC_CONTI_CONV_FNC(L.CONTI_CD, PS.RLANE_CD,PS.SKD_DIR_CD), 'I', 'O')" ).append("\n"); 
		query.append("       AND DRL.FM_CONTI_CD     = SPC_CONTI_CONV_FNC(PS.POL_CONTI, PS.RLANE_CD,PS.SKD_DIR_CD)" ).append("\n"); 
		query.append("       AND DRL.TO_CONTI_CD     = SPC_CONTI_CONV_FNC(L.CONTI_CD, PS.RLANE_CD,PS.SKD_DIR_CD)" ).append("\n"); 
		query.append("       AND DRL.DELT_FLG        = 'N'" ).append("\n"); 
		query.append("       AND L.LOC_CD            = VPS.VPS_PORT_CD" ).append("\n"); 
		query.append("       AND VPS.VSL_CD          = PS.VSL_CD" ).append("\n"); 
		query.append("       AND VPS.SKD_VOY_NO      = PS.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND VPS.SKD_DIR_CD      = PS.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND VPS.SLAN_CD         = PS.SLAN_CD" ).append("\n"); 
		query.append("       AND VPS.CLPT_SEQ        > PS.POL_SEQ" ).append("\n"); 
		query.append("       AND CO.RLANE_CD  (+)    = PS.RLANE_CD" ).append("\n"); 
		query.append("       AND CO.DIR_CD    (+)    = PS.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND CO.VSL_CD    (+)    = PS.VSL_CD" ).append("\n"); 
		query.append("       AND CO.SKD_VOY_NO(+)    = PS.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND CO.SKD_DIR_CD(+)    = PS.SKD_DIR_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", BOOKING AS (" ).append("\n"); 
		query.append("    SELECT BV.BKG_NO        ," ).append("\n"); 
		query.append("           BV.VSL_PRE_PST_CD," ).append("\n"); 
		query.append("           V.POL_ETB_DT     ," ).append("\n"); 
		query.append("           V.REP_TRD_CD     ," ).append("\n"); 
		query.append("           V.REP_SUB_TRD_CD ," ).append("\n"); 
		query.append("           V.TRD_CD         ," ).append("\n"); 
		query.append("           V.SUB_TRD_CD     ," ).append("\n"); 
		query.append("           V.RLANE_CD       ," ).append("\n"); 
		query.append("           V.COST_YR        ," ).append("\n"); 
		query.append("           V.COST_WK        ," ).append("\n"); 
		query.append("           V.VSL_CD         ," ).append("\n"); 
		query.append("           V.SKD_VOY_NO     ," ).append("\n"); 
		query.append("           V.SKD_DIR_CD     ," ).append("\n"); 
		query.append("           DECODE(BV.VSL_PRE_PST_CD, 'T', DECODE(V.POL_CONTI, V.POD_CONTI, 'IPC', 'OCN'), 'T/S') AS IOC_CD," ).append("\n"); 
		query.append("           SPC_SCR_OFC_CONV_FNC(B.OB_SLS_OFC_CD) AS SLS_OFC_CD," ).append("\n"); 
		query.append("           V.POL_CD ," ).append("\n"); 
		query.append("           V.POD_CD ," ).append("\n"); 
		query.append("           V.POD_SEQ," ).append("\n"); 
		query.append("           V.SLAN_CD," ).append("\n"); 
		query.append("           (" ).append("\n"); 
		query.append("              SELECT    TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '2', 1, 2)*Q.OP_CNTR_QTY), 'FM0000000000.000')" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '2', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '4', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                     -- 20140723 추가" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(SUBSTR(Q.CNTR_TPSZ_CD,1,2), 'D2', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000') -- 20에 포함되어 있음" ).append("\n"); 
		query.append("				     || TO_CHAR(SUM(DECODE(SUBSTR(Q.CNTR_TPSZ_CD,1,2), 'D4', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000') -- 40에 포함되어 있음" ).append("\n"); 
		query.append("				                             " ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '5', Q.OP_CNTR_QTY, '9', Q.OP_CNTR_QTY, '8', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')	--R9,R8에 대해서 R5과 동일하게 HC으로 처리되도록 추가" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD), '7', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(Q.CNTR_TPSZ_CD, 'DW', Q.OP_CNTR_QTY, 'DX', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000') " ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(DECODE(Q.CNTR_TPSZ_CD, 'R2', Q.OP_CNTR_QTY - Q.EQ_SUBST_CGO_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(CASE WHEN SUBSTR(Q.CNTR_TPSZ_CD, 1, 1) = 'R' AND Q.CNTR_TPSZ_CD <> 'R2' THEN Q.OP_CNTR_QTY - Q.EQ_SUBST_CGO_QTY ELSE 0 END), 'FM0000000000.000')" ).append("\n"); 
		query.append("                     -- 20140723 추가" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(CASE WHEN Q.CNTR_TPSZ_CD LIKE 'R%' AND Q.EQ_SUBST_CNTR_TPSZ_CD = 'D2' THEN Q.EQ_SUBST_CGO_QTY ELSE 0 END), 'FM0000000000.000')--RD2" ).append("\n"); 
		query.append("                     || TO_CHAR(SUM(CASE WHEN Q.CNTR_TPSZ_CD LIKE 'R%' AND Q.EQ_SUBST_CNTR_TPSZ_CD <> 'D2' THEN Q.EQ_SUBST_CGO_QTY ELSE 0 END), 'FM0000000000.000')--RD4" ).append("\n"); 
		query.append("                     " ).append("\n"); 
		query.append("                     || TO_CHAR((MAX(D.ACT_WGT) * DECODE(MAX(D.WGT_UT_CD), 'LBS', 0.00045, 0.001)) + SUM(Q.OP_CNTR_QTY * ( SELECT TS.CNTR_TPSZ_TARE_WGT" ).append("\n"); 
		query.append("                                                                                                                             FROM MDM_CNTR_TP_SZ TS" ).append("\n"); 
		query.append("                                                                                                                            WHERE TS.CNTR_TPSZ_CD = Q.CNTR_TPSZ_CD)) * 0.001, 'FM0000000000.000')" ).append("\n"); 
		query.append("                FROM BKG_QUANTITY Q" ).append("\n"); 
		query.append("               WHERE B.BKG_NO = Q.BKG_NO " ).append("\n"); 
		query.append("           ) AS VAL,           " ).append("\n"); 
		query.append("		   		   " ).append("\n"); 
		query.append("		   CASE WHEN V.CTRL_DEST <> 'N' THEN	                                                      " ).append("\n"); 
		query.append("                   NVL((SELECT D.CTRL_LOC_ACCT_CD" ).append("\n"); 
		query.append("                          FROM SPC_ALOC_LANE_CTRL_OPT_DTL D," ).append("\n"); 
		query.append("                               MDM_LOCATION               ML1," ).append("\n"); 
		query.append("                               MDM_LOCATION               ML2," ).append("\n"); 
		query.append("                               MDM_EQ_ORZ_CHT             ME1," ).append("\n"); 
		query.append("                               MDM_EQ_ORZ_CHT             ME2" ).append("\n"); 
		query.append("                         WHERE V.RLANE_CD         = D.RLANE_CD" ).append("\n"); 
		query.append("                           AND V.REP_TRD_CD       = D.TRD_CD" ).append("\n"); 
		query.append("                           AND V.REP_SUB_TRD_CD   = D.SUB_TRD_CD" ).append("\n"); 
		query.append("                           AND V.SKD_DIR_CD       = D.DIR_CD " ).append("\n"); 
		query.append("                           AND D.ALOC_CTRL_TP_CD  = V.CTRL_DEST" ).append("\n"); 
		query.append("                           AND ML1.LOC_CD         = B.POD_CD" ).append("\n"); 
		query.append("                           AND ME1.SCC_CD         = ML1.SCC_CD" ).append("\n"); 
		query.append("                           AND ML2.LOC_CD         = B.DEL_CD" ).append("\n"); 
		query.append("                           AND ME2.SCC_CD         = ML2.SCC_CD" ).append("\n"); 
		query.append("                           AND D.CTRL_LOC_ACCT_CD = DECODE(V.CTRL_DEST_LVL,'T',DECODE(V.CTRL_DEST,'E',ME2.ECC_CD,'L',B.DEL_CD),DECODE(V.CTRL_DEST,'E',ME1.ECC_CD,'L',B.POD_CD))" ).append("\n"); 
		query.append("                     ),'XXXXX')" ).append("\n"); 
		query.append("           ELSE" ).append("\n"); 
		query.append("                  'XXXXX'" ).append("\n"); 
		query.append("           END AS DEST_LOC_CD," ).append("\n"); 
		query.append("                                   " ).append("\n"); 
		query.append("           CASE WHEN V.CTRL_USA = 'Y' AND (SUBSTR(B.POL_CD,1,2) IN ('US','CA') OR SUBSTR(B.POD_CD,1,2) IN ('US','CA')) THEN" ).append("\n"); 
		query.append("                NVL(SPC_USA_MODE_FNC(B.RCV_TERM_CD, B.DE_TERM_CD, B.POR_CD, B.POL_CD, B.POD_CD, B.DEL_CD),'OTH')" ).append("\n"); 
		query.append("           ELSE" ).append("\n"); 
		query.append("                'OTH'" ).append("\n"); 
		query.append("           END  AS USA_BKG_MOD,				                   " ).append("\n"); 
		query.append("				                   " ).append("\n"); 
		query.append("           V.CTRL_PORT," ).append("\n"); 
		query.append("           V.CTRL_HC  ," ).append("\n"); 
		query.append("           V.CTRL_45  ," ).append("\n"); 
		query.append("           V.CTRL_53  ," ).append("\n"); 
		query.append("           V.CTRL_RF  ," ).append("\n"); 
		query.append("           V.CTRL_WGT ," ).append("\n"); 
		query.append("           -- 20140723 추가" ).append("\n"); 
		query.append("           V.CTRL_D2  ," ).append("\n"); 
		query.append("           V.CTRL_D4  ," ).append("\n"); 
		query.append("           V.CTRL_RD  ," ).append("\n"); 
		query.append("           V.CTRL_USA ," ).append("\n"); 
		query.append("           --V.CTRL_ACCT," ).append("\n"); 
		query.append("           DECODE(V.CTRL_DEST,'N','N','Y') AS CTRL_DEST," ).append("\n"); 
		query.append("           V.CTRL_DEST_LVL, -- D = BKG_POD, T = BKG_DEL" ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("           V.ORG" ).append("\n"); 
		query.append("			,(" ).append("\n"); 
		query.append("			SELECT SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Z.CNTR_TPSZ_CD), '2', 1, 2)* Z.OP_CNTR_QTY) " ).append("\n"); 
		query.append("			FROM BKG_QUANTITY Z " ).append("\n"); 
		query.append("			WHERE Z.BKG_NO= B.BKG_NO AND OP_CNTR_QTY > 0 " ).append("\n"); 
		query.append("			AND EXISTS ( SELECT 1 FROM BKG_CONTAINER C WHERE C.BKG_NO= Z.BKG_NO AND VGM_WGT>0 AND VGM_WGT IS NOT NULL )" ).append("\n"); 
		query.append("			) AS BKG_VOL_VGM			" ).append("\n"); 
		query.append("			,(SELECT SUM(NVL(Z.VGM_WGT,0) * DECODE(Z.VGM_WGT_UT_CD,'LBS',0.00045,0.001)) FROM BKG_CONTAINER Z WHERE Z.BKG_NO= B.BKG_NO AND VGM_WGT>0 AND VGM_WGT IS NOT NULL) AS BKG_WGT_VGM           " ).append("\n"); 
		query.append("      FROM BKG_BOOKING B ," ).append("\n"); 
		query.append("           BKG_VVD     BV," ).append("\n"); 
		query.append("           PORT_SKD    V ," ).append("\n"); 
		query.append("           BKG_BL_DOC  D" ).append("\n"); 
		query.append("     WHERE B.BKG_NO         = BV.BKG_NO" ).append("\n"); 
		query.append("       AND B.BKG_STS_CD    IN('W','F')" ).append("\n"); 
		query.append("       AND B.BKG_CGO_TP_CD <> 'P'" ).append("\n"); 
		query.append("       AND BV.VSL_CD        = V.VSL_CD" ).append("\n"); 
		query.append("       AND BV.SKD_VOY_NO    = V.SKD_VOY_NO" ).append("\n"); 
		query.append("       AND BV.SKD_DIR_CD    = V.SKD_DIR_CD" ).append("\n"); 
		query.append("       AND (    (V.COST_YR||V.COST_WK  < '201023' AND BV.POL_CD    = SUBSTR(V.POL_CD, 1, 5))" ).append("\n"); 
		query.append("             OR (V.COST_YR||V.COST_WK >= '201023' AND BV.POL_YD_CD = V.POL_CD))" ).append("\n"); 
		query.append("       AND (    (V.COST_YR||V.COST_WK  < '201023' AND BV.POD_CD    = SUBSTR(V.POD_CD, 1, 5))" ).append("\n"); 
		query.append("             OR (V.COST_YR||V.COST_WK >= '201023' AND BV.POD_YD_CD = V.POD_CD))" ).append("\n"); 
		query.append("       AND BV.SLAN_CD       = V.SLAN_CD" ).append("\n"); 
		query.append("       AND (V.ORG IS NULL OR SPC_SCR_OFC_CONV_FNC(B.OB_SLS_OFC_CD) = V.ORG)" ).append("\n"); 
		query.append("       AND (V.IOC_CD IS NULL OR DECODE(BV.VSL_PRE_PST_CD, 'T', DECODE(V.POL_CONTI, V.POD_CONTI, 'IPC', 'OCN'), 'T/S') = V.IOC_CD)" ).append("\n"); 
		query.append("       AND B.BKG_NO         = D.BKG_NO" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("  SELECT TO_CHAR(Z7.ETB_DT, 'YYYY.MM.DD') AS ETB_DT," ).append("\n"); 
		query.append("         Z7.REP_TRD_CD    ," ).append("\n"); 
		query.append("         Z7.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("         Z7.TRD_CD        ," ).append("\n"); 
		query.append("         Z7.SUB_TRD_CD    ," ).append("\n"); 
		query.append("         Z7.RLANE_CD      ," ).append("\n"); 
		query.append("         Z7.COST_WK       ," ).append("\n"); 
		query.append("         Z7.VVD           ," ).append("\n"); 
		query.append("         Z7.IOC_CD        ," ).append("\n"); 
		query.append("         Z7.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("         '' AS SLS_AQ_CD  ," ).append("\n"); 
		query.append("         DECODE(Z7.SLS_RGN_OFC_CD,' ',Z7.SLS_RHQ_CD, Z7.SLS_RGN_OFC_CD) AS SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("         MAX(Z7.SLS_OFC_CD)      AS SLS_OFC_CD        ," ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("         -- 20140723 " ).append("\n"); 
		query.append("         MAX(DECODE(Z7.USA_BKG_MOD_CD,'OTH','OTHERS',Z7.USA_BKG_MOD_CD)) AS USA_BKG_MOD_CD, --Local IPI		 " ).append("\n"); 
		query.append("         MAX(Z7.POD_CD)             AS POD_CD            ," ).append("\n"); 
		query.append("         -- 20140723 " ).append("\n"); 
		query.append("         MAX(DECODE(Z7.DEST_LOC_CD1,'XXXXX','OTHERS',Z7.DEST_LOC_CD1)) AS DEST_LOC_CD,   --DEST" ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("         MAX(Z7.FCAST_TTL)          AS FCAST_TTL         ," ).append("\n"); 
		query.append("         MAX(Z7.FCAST_HC)           AS FCAST_HC          ," ).append("\n"); 
		query.append("         MAX(Z7.FCAST_45)           AS FCAST_45          ," ).append("\n"); 
		query.append("         MAX(Z7.FCAST_53)           AS FCAST_53          ," ).append("\n"); 
		query.append("         MAX(Z7.FCAST_RF)           AS FCAST_RF          ," ).append("\n"); 
		query.append("         MAX(Z7.FCAST_WGT)          AS FCAST_WGT         ," ).append("\n"); 
		query.append("         -- 20140723 " ).append("\n"); 
		query.append("		 MAX(Z7.FCAST_D2)           AS FCAST_D2          , --Forecast D2" ).append("\n"); 
		query.append("         MAX(Z7.FCAST_D4)           AS FCAST_D4          , --Forecast D4" ).append("\n"); 
		query.append("         MAX(Z7.FCAST_RD)           AS FCAST_RD          , --Forecast RD" ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("         MAX(Z7.ASGN_TTL)           AS ASGN_TTL          ," ).append("\n"); 
		query.append("         MAX(Z7.ASGN_HC)            AS ASGN_HC           ," ).append("\n"); 
		query.append("         MAX(Z7.ASGN_45)            AS ASGN_45           ," ).append("\n"); 
		query.append("         MAX(Z7.ASGN_53)            AS ASGN_53           ," ).append("\n"); 
		query.append("         MAX(Z7.ASGN_RF)            AS ASGN_RF           ," ).append("\n"); 
		query.append("         MAX(Z7.ASGN_WGT)           AS ASGN_WGT          ," ).append("\n"); 
		query.append("         MAX(Z7.ASGN_D2)            AS ASGN_D2           , --Allocation D2" ).append("\n"); 
		query.append("         MAX(Z7.ASGN_D4)            AS ASGN_D4           , --Allocation D4" ).append("\n"); 
		query.append("         MAX(Z7.ASGN_RD)            AS ASGN_RD           , --Allocation RD" ).append("\n"); 
		query.append("		 " ).append("\n"); 
		query.append("         MAX(Z7.DIF_TTL)            AS DIF_TTL           ," ).append("\n"); 
		query.append("         MAX(Z7.DIF_HC)             AS DIF_HC            ," ).append("\n"); 
		query.append("         MAX(Z7.DIF_45)             AS DIF_45            ," ).append("\n"); 
		query.append("         MAX(Z7.DIF_53)             AS DIF_53            ," ).append("\n"); 
		query.append("         MAX(Z7.DIF_RF)             AS DIF_RF            ," ).append("\n"); 
		query.append("         MAX(Z7.DIF_WGT)            AS DIF_WGT           ," ).append("\n"); 
		query.append("         MAX(Z7.DIF_D2)             AS DIF_D2            , --Alloc Diff D2" ).append("\n"); 
		query.append("         MAX(Z7.DIF_D4)             AS DIF_D4            , --Alloc Diff D4" ).append("\n"); 
		query.append("         MAX(Z7.DIF_RD)             AS DIF_RD            , --Alloc Diff RD" ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("         MAX(Z7.BKG_TTL)            AS BKG_TTL           ," ).append("\n"); 
		query.append("         MAX(Z7.BKG_S20)            AS BKG_S20           ," ).append("\n"); 
		query.append("         MAX(Z7.BKG_S40)            AS BKG_S40           ," ).append("\n"); 
		query.append("         MAX(Z7.BKG_20)             AS BKG_20            ," ).append("\n"); 
		query.append("         MAX(Z7.BKG_40)             AS BKG_40            ," ).append("\n"); 
		query.append("         MAX(Z7.BKG_HC)             AS BKG_HC            ," ).append("\n"); 
		query.append("         MAX(Z7.BKG_45)             AS BKG_45            ," ).append("\n"); 
		query.append("         MAX(Z7.BKG_53)             AS BKG_53            ," ).append("\n"); 
		query.append("         MAX(Z7.BKG_RF20)           AS BKG_RF20          ," ).append("\n"); 
		query.append("         MAX(Z7.BKG_RF40)           AS BKG_RF40          ," ).append("\n"); 
		query.append("         MAX(Z7.BKG_WGT)            AS BKG_WGT           ,MAX(Z7.BKG_VOL_VGM) AS BKG_VOL_VGM , MAX(Z7.BKG_WGT_VGM) AS BKG_WGT_VGM ," ).append("\n"); 
		query.append("         MAX(Z7.BKG_D2)             AS BKG_D2            , --Booking D2" ).append("\n"); 
		query.append("         MAX(Z7.BKG_D4)             AS BKG_D4            , --Booking D4" ).append("\n"); 
		query.append("         MAX(Z7.BKG_RD20)           AS BKG_RD20          , --Booking RD20" ).append("\n"); 
		query.append("         MAX(Z7.BKG_RD40)           AS BKG_RD40          , --Booking RD40" ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("         MAX(Z7.PRE_REP_TRD_CD)     AS PRE_REP_TRD_CD    ," ).append("\n"); 
		query.append("         MAX(Z7.PRE_REP_SUB_TRD_CD) AS PRE_REP_SUB_TRD_CD," ).append("\n"); 
		query.append("         MAX(Z7.PRE_RLANE_CD)       AS PRE_RLANE_CD      ," ).append("\n"); 
		query.append("         MAX(Z7.PRE_VVD)            AS PRE_VVD           ," ).append("\n"); 
		query.append("         MAX(Z7.PRE_ETB_DT)         AS PRE_ETB_DT        ," ).append("\n"); 
		query.append("         MAX(Z7.DIS_TTL)            AS DIS_TTL           ," ).append("\n"); 
		query.append("         MAX(Z7.DIS_S20)            AS DIS_S20           ," ).append("\n"); 
		query.append("         MAX(Z7.DIS_S40)            AS DIS_S40           ," ).append("\n"); 
		query.append("         MAX(Z7.DIS_20)             AS DIS_20            ," ).append("\n"); 
		query.append("         MAX(Z7.DIS_40)             AS DIS_40            ," ).append("\n"); 
		query.append("         MAX(Z7.DIS_HC)             AS DIS_HC            ," ).append("\n"); 
		query.append("         MAX(Z7.DIS_45)             AS DIS_45            ," ).append("\n"); 
		query.append("         MAX(Z7.DIS_53)             AS DIS_53            ," ).append("\n"); 
		query.append("         MAX(Z7.DIS_RF20)           AS DIS_RF20          ," ).append("\n"); 
		query.append("         MAX(Z7.DIS_RF40)           AS DIS_RF40          ," ).append("\n"); 
		query.append("         MAX(Z7.DIS_WGT)            AS DIS_WGT           ,MAX(Z7.DIS_VOL_VGM) AS DIS_VOL_VGM ,MAX(Z7.DIS_WGT_VGM) AS DIS_WGT_VGM ," ).append("\n"); 
		query.append("         MAX(Z7.DIS_D2)             AS DIS_D2            , --Booking D2" ).append("\n"); 
		query.append("         MAX(Z7.DIS_D4)             AS DIS_D4            , --Booking D4" ).append("\n"); 
		query.append("         MAX(Z7.DIS_RD20)           AS DIS_RD20          , --Booking RD20" ).append("\n"); 
		query.append("         MAX(Z7.DIS_RD40)           AS DIS_RD40          , --Booking RD40" ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("         MAX(Z7.CTRL_HC)            AS CTRL_HC           ," ).append("\n"); 
		query.append("         MAX(Z7.CTRL_45)            AS CTRL_45           ," ).append("\n"); 
		query.append("         MAX(Z7.CTRL_53)            AS CTRL_53           ," ).append("\n"); 
		query.append("         MAX(Z7.CTRL_RF)            AS CTRL_RF           ," ).append("\n"); 
		query.append("         MAX(Z7.CTRL_WGT)           AS CTRL_WGT          ," ).append("\n"); 
		query.append("		 MAX(Z7.CTRL_D2)            AS CTRL_D2           ," ).append("\n"); 
		query.append("		 MAX(Z7.CTRL_D4)            AS CTRL_D4           ," ).append("\n"); 
		query.append("		 MAX(Z7.CTRL_RD)            AS CTRL_RD" ).append("\n"); 
		query.append("		 " ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("            SELECT Z6.ETB_DT        ," ).append("\n"); 
		query.append("                   Z6.REP_TRD_CD    ," ).append("\n"); 
		query.append("                   Z6.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                   Z6.TRD_CD        ," ).append("\n"); 
		query.append("                   Z6.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                   Z6.RLANE_CD      ," ).append("\n"); 
		query.append("                   Z6.COST_WK       ," ).append("\n"); 
		query.append("                   Z6.VVD           ," ).append("\n"); 
		query.append("                   Z6.IOC_CD        ," ).append("\n"); 
		query.append("                   Z6.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                   Z6.SLS_AQ_CD     ," ).append("\n"); 
		query.append("                   Z6.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("                   RANK() OVER ( PARTITION BY Z6.ETB_DT, Z6.REP_TRD_CD, Z6.REP_SUB_TRD_CD, Z6.TRD_CD, Z6.SUB_TRD_CD, Z6.RLANE_CD, Z6.COST_WK, Z6.VVD, Z6.IOC_CD, Z6.SLS_RHQ_CD, " ).append("\n"); 
		query.append("                                              Z6.SLS_AQ_CD, Z6.SLS_RGN_OFC_CD ORDER BY ROWNUM) AS RK,                           " ).append("\n"); 
		query.append("                   Z6.SLS_OFC_CD    ," ).append("\n"); 
		query.append("                   -- 20140723 " ).append("\n"); 
		query.append("				   Z6.USA_BKG_MOD_CD,				   " ).append("\n"); 
		query.append("                   Z6.POD_CD        ," ).append("\n"); 
		query.append("                   Z6.DEST_LOC_CD  AS DEST_LOC_CD1," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   Z6.FCAST_TTL     ," ).append("\n"); 
		query.append("                   Z6.FCAST_HC      ," ).append("\n"); 
		query.append("                   Z6.FCAST_45      ," ).append("\n"); 
		query.append("                   Z6.FCAST_53      ," ).append("\n"); 
		query.append("                   Z6.FCAST_RF      ," ).append("\n"); 
		query.append("                   Z6.FCAST_WGT     ," ).append("\n"); 
		query.append("                   Z6.FCAST_D2     ," ).append("\n"); 
		query.append("                   Z6.FCAST_D4      ," ).append("\n"); 
		query.append("                   Z6.FCAST_RD      ," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   Z6.ASGN_TTL      ," ).append("\n"); 
		query.append("                   Z6.ASGN_HC       ," ).append("\n"); 
		query.append("                   Z6.ASGN_45       ," ).append("\n"); 
		query.append("                   Z6.ASGN_53       ," ).append("\n"); 
		query.append("                   Z6.ASGN_RF       ," ).append("\n"); 
		query.append("                   Z6.ASGN_WGT      ," ).append("\n"); 
		query.append("                   Z6.ASGN_D2       ," ).append("\n"); 
		query.append("                   Z6.ASGN_D4       ," ).append("\n"); 
		query.append("                   Z6.ASGN_RD       ," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   Z6.DIF_TTL       ," ).append("\n"); 
		query.append("                   Z6.DIF_HC        ," ).append("\n"); 
		query.append("                   Z6.DIF_45        ," ).append("\n"); 
		query.append("                   Z6.DIF_53        ," ).append("\n"); 
		query.append("                   Z6.DIF_RF        ," ).append("\n"); 
		query.append("                   Z6.DIF_WGT       ," ).append("\n"); 
		query.append("                   Z6.DIF_D2        ," ).append("\n"); 
		query.append("                   Z6.DIF_D4        ," ).append("\n"); 
		query.append("                   Z6.DIF_RD        ," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   Z6.BKG_TTL       ," ).append("\n"); 
		query.append("                   Z6.BKG_S20       ," ).append("\n"); 
		query.append("                   Z6.BKG_S40       ," ).append("\n"); 
		query.append("                   Z6.BKG_20        ," ).append("\n"); 
		query.append("                   Z6.BKG_40        ," ).append("\n"); 
		query.append("                   Z6.BKG_HC        ," ).append("\n"); 
		query.append("                   Z6.BKG_45        ," ).append("\n"); 
		query.append("                   Z6.BKG_53        ," ).append("\n"); 
		query.append("                   Z6.BKG_RF20      ," ).append("\n"); 
		query.append("                   Z6.BKG_RF40      ," ).append("\n"); 
		query.append("                   Z6.BKG_WGT       ,BKG_VOL_VGM,BKG_WGT_VGM," ).append("\n"); 
		query.append("                   Z6.BKG_D2        ," ).append("\n"); 
		query.append("                   Z6.BKG_D4        ," ).append("\n"); 
		query.append("                   Z6.BKG_RD20      ," ).append("\n"); 
		query.append("                   Z6.BKG_RD40      ," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   ''   AS PRE_REP_TRD_CD    ," ).append("\n"); 
		query.append("                   ''   AS PRE_REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                   ''   AS PRE_RLANE_CD      ," ).append("\n"); 
		query.append("                   ''   AS PRE_VVD           ," ).append("\n"); 
		query.append("                   ''   AS PRE_ETB_DT        ," ).append("\n"); 
		query.append("                   NULL AS DIS_TTL           ," ).append("\n"); 
		query.append("                   NULL AS DIS_S20           ," ).append("\n"); 
		query.append("                   NULL AS DIS_S40           ," ).append("\n"); 
		query.append("                   NULL AS DIS_20            ," ).append("\n"); 
		query.append("                   NULL AS DIS_40            ," ).append("\n"); 
		query.append("                   NULL AS DIS_HC            ," ).append("\n"); 
		query.append("                   NULL AS DIS_45            ," ).append("\n"); 
		query.append("                   NULL AS DIS_53            ," ).append("\n"); 
		query.append("                   NULL AS DIS_RF20          ," ).append("\n"); 
		query.append("                   NULL AS DIS_RF40          ," ).append("\n"); 
		query.append("                   NULL AS DIS_WGT           , NULL AS DIS_VOL_VGM,NULL AS DIS_WGT_VGM," ).append("\n"); 
		query.append("                   NULL AS DIS_D2            ," ).append("\n"); 
		query.append("                   NULL AS DIS_D4            ," ).append("\n"); 
		query.append("                   NULL AS DIS_RD20          ," ).append("\n"); 
		query.append("                   NULL AS DIS_RD40          ," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   Z6.CTRL_HC ," ).append("\n"); 
		query.append("                   Z6.CTRL_45 ," ).append("\n"); 
		query.append("                   Z6.CTRL_53 ," ).append("\n"); 
		query.append("                   Z6.CTRL_RF ," ).append("\n"); 
		query.append("                   Z6.CTRL_WGT,	" ).append("\n"); 
		query.append("				   Z6.CTRL_D2," ).append("\n"); 
		query.append("				   Z6.CTRL_D4," ).append("\n"); 
		query.append("				   Z6.CTRL_RD" ).append("\n"); 
		query.append("				   " ).append("\n"); 
		query.append("              FROM (" ).append("\n"); 
		query.append("                      SELECT Z5.ETB_DT        ," ).append("\n"); 
		query.append("                             Z5.REP_TRD_CD    ," ).append("\n"); 
		query.append("                             Z5.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                             Z5.TRD_CD        ," ).append("\n"); 
		query.append("                             Z5.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                             Z5.RLANE_CD      ," ).append("\n"); 
		query.append("                             Z5.COST_WK       ," ).append("\n"); 
		query.append("                             Z5.VVD           ," ).append("\n"); 
		query.append("                             Z5.IOC_CD        ," ).append("\n"); 
		query.append("                             Z5.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                             Z5.SLS_AQ_CD     ," ).append("\n"); 
		query.append("                             Z5.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("                             Z5.SLS_OFC_CD    ," ).append("\n"); 
		query.append("                             -- 20140723        " ).append("\n"); 
		query.append("						     Z5.USA_BKG_MOD_CD,  " ).append("\n"); 
		query.append("                             Z5.POD_CD        ," ).append("\n"); 
		query.append("                        	 Z5.DEST_LOC_CD   , " ).append("\n"); 
		query.append("                             SUM(NVL(Z5.FCAST_TTL, 0)) AS FCAST_TTL," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.FCAST_HC, 0))  AS FCAST_HC ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.FCAST_45, 0))  AS FCAST_45 ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.FCAST_53, 0))  AS FCAST_53 ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.FCAST_RF, 0))  AS FCAST_RF ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.FCAST_WGT, 0)) AS FCAST_WGT," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_TTL, 0))  AS ASGN_TTL ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_HC, 0))   AS ASGN_HC  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_45, 0))   AS ASGN_45  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_53, 0))   AS ASGN_53  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_RF, 0))   AS ASGN_RF  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_WGT, 0))  AS ASGN_WGT ," ).append("\n"); 
		query.append("                             -- Alloc 정보가 입력되지 않은 경우에는 0으로 인식되어 BKG과의 Diff가 보여지도록 보완" ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_TTL, 0)) - SUM(NVL(Z5.BKG_TTL, 0)) AS DIF_TTL,		" ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_HC , 0)) - SUM(NVL(Z5.BKG_HC, 0))  AS DIF_HC ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_45 , 0)) - SUM(NVL(Z5.BKG_45, 0))  AS DIF_45 ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_53 , 0)) - SUM(NVL(Z5.BKG_53, 0))  AS DIF_53 ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_RF , 0)) - SUM(NVL(Z5.BKG_RF20, 0)) - SUM(NVL(Z5.BKG_RF40, 0)) AS DIF_RF," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_WGT, 0)) - SUM(NVL(Z5.BKG_WGT, 0)) AS DIF_WGT," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_TTL, 0))   AS BKG_TTL ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_20, 0))    AS BKG_S20 , --20에 R2,D2가 포함되어 있음:뒤자리 2만 취하므로" ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_40, 0)) + SUM(NVL(Z5.BKG_HC, 0)) + SUM(NVL(Z5.BKG_45, 0)) + SUM(NVL(Z5.BKG_53, 0)) AS BKG_S40, --40/HC/45에 R4,R7,R5, D4가 포함되어 있음" ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_20, 0))    AS BKG_20  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_40, 0))    AS BKG_40  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_HC, 0))    AS BKG_HC  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_45, 0))    AS BKG_45  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_53, 0))    AS BKG_53  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_RF20, 0))  AS BKG_RF20," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_RF40, 0))  AS BKG_RF40," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_WGT, 0))   AS BKG_WGT ,SUM(NVL(Z5.BKG_VOL_VGM, 0)) AS BKG_VOL_VGM ,SUM(NVL(Z5.BKG_WGT_VGM, 0)) AS BKG_WGT_VGM ," ).append("\n"); 
		query.append("                             MAX(Z5.CTRL_HC)   AS CTRL_HC ," ).append("\n"); 
		query.append("                             MAX(Z5.CTRL_45)   AS CTRL_45 ," ).append("\n"); 
		query.append("                             MAX(Z5.CTRL_53)   AS CTRL_53 ," ).append("\n"); 
		query.append("                             MAX(Z5.CTRL_RF)   AS CTRL_RF ," ).append("\n"); 
		query.append("                             MAX(Z5.CTRL_WGT)  AS CTRL_WGT," ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                             -- 20140723 " ).append("\n"); 
		query.append("--							 Z5.DEST_LOC_CD,        " ).append("\n"); 
		query.append("--						     Z5.USA_BKG_MOD_CD,      " ).append("\n"); 
		query.append("									   " ).append("\n"); 
		query.append("							 SUM(NVL(Z5.FCAST_D2,0))   AS FCAST_D2 ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.FCAST_D4, 0))  AS FCAST_D4 ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.FCAST_RD, 0))  AS FCAST_RD ," ).append("\n"); 
		query.append("							 " ).append("\n"); 
		query.append("							 SUM(NVL(Z5.ASGN_D2, 0))   AS ASGN_D2  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_D4, 0))   AS ASGN_D4  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_RD, 0))   AS ASGN_RD  ," ).append("\n"); 
		query.append("							 " ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_D2 , 0)) - SUM(NVL(Z5.BKG_D2, 0))  AS DIF_D2 ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_D4 , 0)) - SUM(NVL(Z5.BKG_D4, 0))  AS DIF_D4 ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.ASGN_RD , 0)) - SUM(NVL(Z5.BKG_RD20, 0)) - SUM(NVL(Z5.BKG_RD40, 0)) AS DIF_RD," ).append("\n"); 
		query.append("							 " ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_D2, 0))    AS BKG_D2  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_D4, 0))    AS BKG_D4  ," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_RD20, 0))  AS BKG_RD20," ).append("\n"); 
		query.append("                             SUM(NVL(Z5.BKG_RD40, 0))  AS BKG_RD40," ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                             MAX(Z5.CTRL_D2)       AS CTRL_D2," ).append("\n"); 
		query.append("                             MAX(Z5.CTRL_D4)       AS CTRL_D4," ).append("\n"); 
		query.append("                             MAX(Z5.CTRL_RD)       AS CTRL_RD                             " ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                        FROM (" ).append("\n"); 
		query.append("--                                -- 2009-04-23 서관영/최윤성 CSR:N200904130110, N200904150051 -- DAILY FORECAST 데이터 추가" ).append("\n"); 
		query.append("--                                -- DAILY FORECAST" ).append("\n"); 
		query.append("                                SELECT Z3.POL_ETB_DT AS ETB_DT," ).append("\n"); 
		query.append("                                       Z3.REP_TRD_CD    ," ).append("\n"); 
		query.append("                                       Z3.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                                       Z3.TRD_CD        ," ).append("\n"); 
		query.append("                                       Z3.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                                       Z3.RLANE_CD      ," ).append("\n"); 
		query.append("                                       Z3.COST_WK       ," ).append("\n"); 
		query.append("                                       Z3.VSL_CD||Z3.SKD_VOY_NO||Z3.SKD_DIR_CD AS VVD," ).append("\n"); 
		query.append("                                       Z3.IOC_CD    ," ).append("\n"); 
		query.append("                                       Z3.SLS_RHQ_CD," ).append("\n"); 
		query.append("                                       NVL(Z3.SLS_AQ_CD     , ' ') AS SLS_AQ_CD     ," ).append("\n"); 
		query.append("                                       NVL(Z3.SLS_RGN_OFC_CD, ' ') AS SLS_RGN_OFC_CD, --20140826" ).append("\n"); 
		query.append("                                       NVL(Z3.SLS_OFC_CD    , ' ') AS SLS_OFC_CD    ," ).append("\n"); 
		query.append("                                       --NVL(Z3.USA_BKG_MOD_CD,' ') AS USA_BKG_MOD_CD,   " ).append("\n"); 
		query.append("                                       DECODE(NVL(Z3.USA_BKG_MOD_CD,' '),'X','OTH',NVL(Z3.USA_BKG_MOD_CD,' ')) AS USA_BKG_MOD_CD,      " ).append("\n"); 
		query.append("                                       NVL(Z3.POD_CD        , ' ') AS POD_CD        , " ).append("\n"); 
		query.append("                                       Z3.POD_SEQ      ," ).append("\n"); 
		query.append("                                       NVL(Z3.DEST_LOC_CD,' ') AS DEST_LOC_CD,        " ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       --GO1||GU1||GP1||GD1," ).append("\n"); 
		query.append("                                       --Z3.TT," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       Z3.FCAST_TTL    ," ).append("\n"); 
		query.append("                                       Z3.FCAST_HC     ," ).append("\n"); 
		query.append("                                       Z3.FCAST_45     ," ).append("\n"); 
		query.append("                                       Z3.FCAST_53     ," ).append("\n"); 
		query.append("                                       Z3.FCAST_RF     ," ).append("\n"); 
		query.append("                                       Z3.FCAST_WGT    ," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       NULL AS ASGN_TTL," ).append("\n"); 
		query.append("                                       NULL AS ASGN_HC ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_45 ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_53 ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_RF ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_WGT,                                       " ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       0    AS BKG_TTL ," ).append("\n"); 
		query.append("                                       0    AS BKG_20  ," ).append("\n"); 
		query.append("                                       0    AS BKG_40  ," ).append("\n"); 
		query.append("                                       0    AS BKG_HC  ," ).append("\n"); 
		query.append("                                       0    AS BKG_45  ," ).append("\n"); 
		query.append("                                       0    AS BKG_53  ," ).append("\n"); 
		query.append("                                       0    AS BKG_RF20," ).append("\n"); 
		query.append("                                       0    AS BKG_RF40," ).append("\n"); 
		query.append("                                       0    AS BKG_WGT ,0 AS BKG_VOL_VGM ,0 AS BKG_WGT_VGM ," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       -- 20140723 추가" ).append("\n"); 
		query.append("                                       Z3.FCAST_D2     ," ).append("\n"); 
		query.append("                                       Z3.FCAST_D4     ," ).append("\n"); 
		query.append("                                       Z3.FCAST_RD     ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_D2 ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_D4 ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_RD ," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       0    AS BKG_D2  ," ).append("\n"); 
		query.append("                                       0    AS BKG_D4  ," ).append("\n"); 
		query.append("                                       0    AS BKG_RD20  ," ).append("\n"); 
		query.append("                                       0    AS BKG_RD40  ," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       Z3.CTRL_D2  ," ).append("\n"); 
		query.append("                                       Z3.CTRL_D4  ," ).append("\n"); 
		query.append("                                       Z3.CTRL_RD  ," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       Z3.CTRL_HC      ," ).append("\n"); 
		query.append("                                       Z3.CTRL_45      ," ).append("\n"); 
		query.append("                                       Z3.CTRL_53      ," ).append("\n"); 
		query.append("                                       Z3.CTRL_RF      ," ).append("\n"); 
		query.append("                                       Z3.CTRL_WGT   " ).append("\n"); 
		query.append("                                  FROM (" ).append("\n"); 
		query.append("                                          SELECT Z2.POL_ETB_DT    ," ).append("\n"); 
		query.append("                                                 Z2.REP_TRD_CD    ," ).append("\n"); 
		query.append("                                                 Z2.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                                                 Z2.TRD_CD        ," ).append("\n"); 
		query.append("                                                 Z2.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                                                 Z2.RLANE_CD      ," ).append("\n"); 
		query.append("                                                 Z2.COST_WK       ," ).append("\n"); 
		query.append("                                                 Z2.VSL_CD        ," ).append("\n"); 
		query.append("                                                 Z2.SKD_VOY_NO    ," ).append("\n"); 
		query.append("                                                 Z2.SKD_DIR_CD    ," ).append("\n"); 
		query.append("                                                 Z2.IOC_CD        ," ).append("\n"); 
		query.append("                                                 Z2.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                                                 Z2.SLS_AQ_CD     ," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 Z2.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("                                                 Z2.SLS_OFC_CD," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 Z2.POD_CD," ).append("\n"); 
		query.append("                                                 MIN(Z2.POD_SEQ) AS POD_SEQ," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 SUM(Z2.FCAST_TTL) AS FCAST_TTL," ).append("\n"); 
		query.append("                                                 SUM(Z2.FCAST_HC)  AS FCAST_HC ," ).append("\n"); 
		query.append("                                                 SUM(Z2.FCAST_45)  AS FCAST_45 ," ).append("\n"); 
		query.append("                                                 SUM(Z2.FCAST_53)  AS FCAST_53 ," ).append("\n"); 
		query.append("                                                 SUM(Z2.FCAST_RF)  AS FCAST_RF ," ).append("\n"); 
		query.append("                                                 SUM(Z2.FCAST_WGT) AS FCAST_WGT," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 -- 20140723 추가" ).append("\n"); 
		query.append("                                                 SUM(Z2.FCAST_D2)  AS FCAST_D2 ," ).append("\n"); 
		query.append("                                                 SUM(Z2.FCAST_D4)  AS FCAST_D4 ," ).append("\n"); 
		query.append("                                                 SUM(Z2.FCAST_RD)  AS FCAST_RD ,  " ).append("\n"); 
		query.append("                                                                                                 " ).append("\n"); 
		query.append("                                                 Z2.DEST_LOC_CD,        " ).append("\n"); 
		query.append("                                                 Z2.USA_BKG_MOD_CD, " ).append("\n"); 
		query.append("                                                 Z2.CTRL_D2  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_D4  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_RD  ," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.SLS_RGN_OFC_CD)   AS GO2, --20140826" ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.SLS_OFC_CD)       AS GO1," ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.POD_CD)           AS GP1," ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.USA_BKG_MOD_CD)   AS GU1," ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.DEST_LOC_CD   )   AS GD1," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 Z2.CTRL_PORT," ).append("\n"); 
		query.append("                                                 Z2.CTRL_HC  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_45  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_53  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_RF  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_WGT ,                                                 " ).append("\n"); 
		query.append("                                                 '' AS T" ).append("\n"); 
		query.append("                                            FROM (" ).append("\n"); 
		query.append("                                                    SELECT V.POL_ETB_DT     ," ).append("\n"); 
		query.append("                                                           DF.REP_TRD_CD    ," ).append("\n"); 
		query.append("                                                           DF.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                                                           DF.TRD_CD        ," ).append("\n"); 
		query.append("                                                           DF.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                                                           DF.RLANE_CD      ," ).append("\n"); 
		query.append("                                                           V.COST_WK        ," ).append("\n"); 
		query.append("                                                           DF.VSL_CD        ," ).append("\n"); 
		query.append("                                                           DF.SKD_VOY_NO    ," ).append("\n"); 
		query.append("                                                           DF.SKD_DIR_CD    ," ).append("\n"); 
		query.append("                                                           DECODE(DF.IOC_TS_CD, 'T', 'T/S','O', 'OCN', 'I', 'IPC') AS IOC_CD," ).append("\n"); 
		query.append("                                                           DECODE(DF.SLS_OFC_CD, DF.SLS_RHQ_CD, 1, DF.SLS_RGN_OFC_CD, 2, 3) AS FLG," ).append("\n"); 
		query.append("                                                           DF.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                                                           DF.SLS_AQ_CD     ," ).append("\n"); 
		query.append("                                                           DF.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("                                                           DF.SLS_OFC_CD    ," ).append("\n"); 
		query.append("                                                           SUBSTR(DF.POD_YD_CD, 1, 5) AS POD_CD," ).append("\n"); 
		query.append("                                                           V.POD_SEQ," ).append("\n"); 
		query.append("                                                           DF.FCAST_TTL_QTY      AS FCAST_TTL," ).append("\n"); 
		query.append("                                                           DF.FCAST_40FT_HC_QTY  AS FCAST_HC ," ).append("\n"); 
		query.append("                                                           DF.FCAST_45FT_HC_QTY  AS FCAST_45 ," ).append("\n"); 
		query.append("                                                           DF.FCAST_53FT_QTY     AS FCAST_53 ," ).append("\n"); 
		query.append("                                                           DF.FCAST_RF_QTY       AS FCAST_RF ," ).append("\n"); 
		query.append("                                                           DF.FCAST_TTL_WGT      AS FCAST_WGT," ).append("\n"); 
		query.append("                                                           -- 20140723 추가" ).append("\n"); 
		query.append("                                                           DF.FCAST_20FT_DRY_QTY AS FCAST_D2 ," ).append("\n"); 
		query.append("                                                           DF.FCAST_40FT_DRY_QTY AS FCAST_D4 ," ).append("\n"); 
		query.append("                                                           DF.FCAST_RD_QTY       AS FCAST_RD ,  " ).append("\n"); 
		query.append("                                                           " ).append("\n"); 
		query.append("                                                           -- 20140723 추가                                                                                                         		   		   " ).append("\n"); 
		query.append("                                                		   DF.DEST_LOC_CD,        " ).append("\n"); 
		query.append("                                                           DF.USA_BKG_MOD_CD, " ).append("\n"); 
		query.append("                                                           V.CTRL_D2  ," ).append("\n"); 
		query.append("                                                           V.CTRL_D4  ," ).append("\n"); 
		query.append("                                                           V.CTRL_RD  ," ).append("\n"); 
		query.append("                                                                                                                    " ).append("\n"); 
		query.append("                                                           V.CTRL_PORT     ," ).append("\n"); 
		query.append("                                                           V.CTRL_HC       ," ).append("\n"); 
		query.append("                                                           V.CTRL_45       ," ).append("\n"); 
		query.append("                                                           V.CTRL_53       ," ).append("\n"); 
		query.append("                                                           V.CTRL_RF       ," ).append("\n"); 
		query.append("                                                           V.CTRL_WGT      " ).append("\n"); 
		query.append("                                                           " ).append("\n"); 
		query.append("                                                      FROM SPC_DLY_FCAST_CUST DF," ).append("\n"); 
		query.append("                                                           PORT_SKD           V" ).append("\n"); 
		query.append("                                                     WHERE DF.REP_TRD_CD     = V.REP_TRD_CD" ).append("\n"); 
		query.append("                                                       AND DF.REP_SUB_TRD_CD = V.REP_SUB_TRD_CD" ).append("\n"); 
		query.append("                                                       AND DF.RLANE_CD       = V.RLANE_CD" ).append("\n"); 
		query.append("                                                       AND DF.DIR_CD         = V.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                       AND DF.VSL_CD         = V.VSL_CD" ).append("\n"); 
		query.append("                                                       AND DF.SKD_VOY_NO     = V.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                       AND DF.SKD_DIR_CD     = V.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                       AND SUBSTR(DF.POL_YD_CD, 1, LENGTH(V.POL_CD)) = V.POL_CD" ).append("\n"); 
		query.append("                                                       AND SUBSTR(DF.POD_YD_CD, 1, LENGTH(V.POD_CD)) = V.POD_CD" ).append("\n"); 
		query.append("                                                       AND (V.IOC_CD IS NULL OR DECODE(DF.IOC_TS_CD, 'T', 'T/S','O', 'OCN', 'I', 'IPC') = V.IOC_CD)" ).append("\n"); 
		query.append("                                                       AND (V.ORG IS NULL OR V.ORG = DF.SLS_OFC_CD)" ).append("\n"); 
		query.append("                                                 ) Z2" ).append("\n"); 
		query.append("                                        GROUP BY Z2.POL_ETB_DT    ," ).append("\n"); 
		query.append("                                                 Z2.REP_TRD_CD    ," ).append("\n"); 
		query.append("                                                 Z2.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                                                 Z2.TRD_CD        ," ).append("\n"); 
		query.append("                                                 Z2.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                                                 Z2.RLANE_CD      ," ).append("\n"); 
		query.append("                                                 Z2.COST_WK       ," ).append("\n"); 
		query.append("                                                 Z2.VSL_CD        ," ).append("\n"); 
		query.append("                                                 Z2.SKD_VOY_NO    ," ).append("\n"); 
		query.append("                                                 Z2.SKD_DIR_CD    ," ).append("\n"); 
		query.append("                                                 Z2.IOC_CD        ," ).append("\n"); 
		query.append("                                                 Z2.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                                                 Z2.SLS_AQ_CD     ," ).append("\n"); 
		query.append("                                                 --Z2.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("                                                 Z2.CTRL_PORT     ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_HC       ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_45       ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_53       ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_RF       ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_WGT      ," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 Z2.CTRL_D2  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_D4  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_RD  ," ).append("\n"); 
		query.append("                                                 --CUBE(Z2.SLS_OFC_CD, Z2.USA_BKG_MOD_CD,Z2.POD_CD,Z2.DEST_LOC_CD)" ).append("\n"); 
		query.append("                                                 CUBE(Z2.SLS_RGN_OFC_CD, Z2.SLS_OFC_CD, Z2.USA_BKG_MOD_CD,Z2.POD_CD,Z2.DEST_LOC_CD) --20140826" ).append("\n"); 
		query.append("                                       ) Z3" ).append("\n"); 
		query.append("                                 WHERE NOT (    --20140826" ).append("\n"); 
		query.append("                                               GO1||GU1||GP1||GD1 = 1110" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 0110" ).append("\n"); 
		query.append("                                            OR GO2||GO1||GU1||GP1 = 0110" ).append("\n"); 
		query.append("                                            OR GO2||GO1 = 10" ).append("\n"); 
		query.append("                                            OR GO2||GP1 = 10" ).append("\n"); 
		query.append("                                            OR GO2||GU1 = 10" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 1010" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 0010" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 0101" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 0100" ).append("\n"); 
		query.append("                                           ) " ).append("\n"); 
		query.append("                                    AND NOT (SLS_RGN_OFC_CD IS NULL AND IOC_CD != 'T/S')" ).append("\n"); 
		query.append("                                    AND NOT (SLS_RHQ_CD NOT IN ('NYCRA', 'HAMRU') AND SLS_RGN_OFC_CD IS NULL)" ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                UNION ALL" ).append("\n"); 
		query.append("                                --ALLOCATION" ).append("\n"); 
		query.append("                                SELECT Z3.POL_ETB_DT AS ETB_DT," ).append("\n"); 
		query.append("                                       Z3.REP_TRD_CD    ," ).append("\n"); 
		query.append("                                       Z3.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                                       Z3.TRD_CD        ," ).append("\n"); 
		query.append("                                       Z3.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                                       Z3.RLANE_CD      ," ).append("\n"); 
		query.append("                                       Z3.COST_WK       ," ).append("\n"); 
		query.append("                                       Z3.VSL_CD||Z3.SKD_VOY_NO||Z3.SKD_DIR_CD AS VVD," ).append("\n"); 
		query.append("                                       Z3.IOC_CD        ," ).append("\n"); 
		query.append("                                       Z3.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                                       NVL(Z3.SLS_AQ_CD     , ' ') AS SLS_AQ_CD     ," ).append("\n"); 
		query.append("                                       NVL(Z3.SLS_RGN_OFC_CD, ' ') AS SLS_RGN_OFC_CD,  --20140826" ).append("\n"); 
		query.append("                                       NVL(Z3.SLS_OFC_CD    , ' ') AS SLS_OFC_CD    ,  " ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       --NVL(Z3.USA_BKG_MOD_CD,' ') AS USA_BKG_MOD_CD,      " ).append("\n"); 
		query.append("                                       DECODE(NVL(Z3.USA_BKG_MOD_CD,' '),'X','OTH',NVL(Z3.USA_BKG_MOD_CD,' ')) AS USA_BKG_MOD_CD, " ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       NVL(Z3.POD_CD        , ' ') AS POD_CD        ," ).append("\n"); 
		query.append("                                       Z3.POD_SEQ       ,                                       " ).append("\n"); 
		query.append("                                       NVL(Z3.DEST_LOC_CD,' ')    AS DEST_LOC_CD," ).append("\n"); 
		query.append("                                            " ).append("\n"); 
		query.append("                                       NULL AS FCAST_TTL," ).append("\n"); 
		query.append("                                       NULL AS FCAST_HC ," ).append("\n"); 
		query.append("                                       NULL AS FCAST_45 ," ).append("\n"); 
		query.append("                                       NULL AS FCAST_53 ," ).append("\n"); 
		query.append("                                       NULL AS FCAST_RF ," ).append("\n"); 
		query.append("                                       NULL AS FCAST_WGT," ).append("\n"); 
		query.append("                                       Z3.ASGN_TTL      ," ).append("\n"); 
		query.append("                                       Z3.ASGN_HC       ," ).append("\n"); 
		query.append("                                       Z3.ASGN_45       ," ).append("\n"); 
		query.append("                                       Z3.ASGN_53       ," ).append("\n"); 
		query.append("                                       Z3.ASGN_RF       ," ).append("\n"); 
		query.append("                                       Z3.ASGN_WGT      ," ).append("\n"); 
		query.append("                                       0 AS BKG_TTL     ," ).append("\n"); 
		query.append("                                       0 AS BKG_20      ," ).append("\n"); 
		query.append("                                       0 AS BKG_40      ," ).append("\n"); 
		query.append("                                       0 AS BKG_HC      ," ).append("\n"); 
		query.append("                                       0 AS BKG_45      ," ).append("\n"); 
		query.append("                                       0 AS BKG_53      ," ).append("\n"); 
		query.append("                                       0 AS BKG_RF20    ," ).append("\n"); 
		query.append("                                       0 AS BKG_RF40    ," ).append("\n"); 
		query.append("                                       0 AS BKG_WGT     , 0 AS BKG_VOL_VGM,0 AS BKG_WGT_VGM," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       -- 20140723 추가" ).append("\n"); 
		query.append("                                       NULL AS FCAST_D2 ," ).append("\n"); 
		query.append("                                       NULL AS FCAST_D4 ," ).append("\n"); 
		query.append("                                       NULL AS FCAST_RD ," ).append("\n"); 
		query.append("                                       Z3.ASGN_D2       ," ).append("\n"); 
		query.append("                                       Z3.ASGN_D4       ," ).append("\n"); 
		query.append("                                       Z3.ASGN_RD       ," ).append("\n"); 
		query.append("                                       0 AS BKG_D2      ," ).append("\n"); 
		query.append("                                       0 AS BKG_D4      ," ).append("\n"); 
		query.append("                                       0 AS BKG_RD20    ," ).append("\n"); 
		query.append("                                       0 AS BKG_RD40    ," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       Z3.CTRL_D2  ," ).append("\n"); 
		query.append("                                       Z3.CTRL_D4  ," ).append("\n"); 
		query.append("                                       Z3.CTRL_RD  ," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       Z3.CTRL_HC       ," ).append("\n"); 
		query.append("                                       Z3.CTRL_45       ," ).append("\n"); 
		query.append("                                       Z3.CTRL_53       ," ).append("\n"); 
		query.append("                                       Z3.CTRL_RF       ," ).append("\n"); 
		query.append("                                       Z3.CTRL_WGT" ).append("\n"); 
		query.append("                                  FROM (" ).append("\n"); 
		query.append("                                          SELECT Z2.POL_ETB_DT    ," ).append("\n"); 
		query.append("                                                 Z2.REP_TRD_CD    ," ).append("\n"); 
		query.append("                                                 Z2.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                                                 Z2.TRD_CD        ," ).append("\n"); 
		query.append("                                                 Z2.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                                                 Z2.RLANE_CD      ," ).append("\n"); 
		query.append("                                                 Z2.COST_WK       ," ).append("\n"); 
		query.append("                                                 Z2.VSL_CD        ," ).append("\n"); 
		query.append("                                                 Z2.SKD_VOY_NO    ," ).append("\n"); 
		query.append("                                                 Z2.SKD_DIR_CD    ," ).append("\n"); 
		query.append("                                                 Z2.IOC_CD        ," ).append("\n"); 
		query.append("                                                 Z2.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                                                 Z2.SLS_AQ_CD     ," ).append("\n"); 
		query.append("                                                 Z2.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("                                                 Z2.SLS_OFC_CD," ).append("\n"); 
		query.append("                                                                                                  " ).append("\n"); 
		query.append("                                                 Z2.POD_CD," ).append("\n"); 
		query.append("                                                 MIN(Z2.POD_SEQ)  AS POD_SEQ," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("--                                                 DECODE(NVL(SUM(Z2.ASGN_TTL),0),0,DECODE(Z2.IOC_CD,'T/S' ,NVL(SUM(Z2.ASGN_TTL),0),NVL(SUM(Z2.AVAL_TTL),0)),NVL(SUM(Z2.ASGN_TTL),0)) AS ASGN_TTL," ).append("\n"); 
		query.append("--                                                 DECODE(NVL(SUM(Z2.ASGN_HC),0) ,0,DECODE(Z2.IOC_CD,'T/S' ,NVL(SUM(Z2.ASGN_HC),0) ,NVL(SUM(Z2.AVAL_HC),0)) ,NVL(SUM(Z2.ASGN_HC),0))  AS ASGN_HC ," ).append("\n"); 
		query.append("--                                                 DECODE(NVL(SUM(Z2.ASGN_45),0) ,0,DECODE(Z2.IOC_CD,'T/S' ,NVL(SUM(Z2.ASGN_45),0) ,NVL(SUM(Z2.AVAL_45),0)) ,NVL(SUM(Z2.ASGN_45),0))  AS ASGN_45 ," ).append("\n"); 
		query.append("--                                                 DECODE(NVL(SUM(Z2.ASGN_53),0) ,0,DECODE(Z2.IOC_CD,'T/S' ,NVL(SUM(Z2.ASGN_53),0) ,NVL(SUM(Z2.AVAL_53),0)) ,NVL(SUM(Z2.ASGN_53),0))  AS ASGN_53 ," ).append("\n"); 
		query.append("--                                                 DECODE(NVL(SUM(Z2.ASGN_RF),0) ,0,DECODE(Z2.IOC_CD,'T/S' ,NVL(SUM(Z2.ASGN_RF),0) ,NVL(SUM(Z2.AVAL_RF),0)) ,NVL(SUM(Z2.ASGN_RF),0))  AS ASGN_RF ," ).append("\n"); 
		query.append("--                                                 DECODE(NVL(SUM(Z2.ASGN_WGT),0),0,DECODE(Z2.IOC_CD,'T/S' ,NVL(SUM(Z2.ASGN_WGT),0),NVL(SUM(Z2.AVAL_WGT),0)),NVL(SUM(Z2.ASGN_WGT),0)) AS ASGN_WGT," ).append("\n"); 
		query.append("--                                                 " ).append("\n"); 
		query.append("--                                                 -- 20140723 추가" ).append("\n"); 
		query.append("--                                                 DECODE(NVL(SUM(Z2.ASGN_D2),0) ,0,DECODE(Z2.IOC_CD,'T/S' ,NVL(SUM(Z2.ASGN_D2),0) ,NVL(SUM(Z2.AVAL_D2),0)) ,NVL(SUM(Z2.ASGN_D2),0))   AS ASGN_D2," ).append("\n"); 
		query.append("--                                                 DECODE(NVL(SUM(Z2.ASGN_D4),0) ,0,DECODE(Z2.IOC_CD,'T/S' ,NVL(SUM(Z2.ASGN_D4),0) ,NVL(SUM(Z2.AVAL_D4),0)) ,NVL(SUM(Z2.ASGN_D4),0))   AS ASGN_D4," ).append("\n"); 
		query.append("--                                                 DECODE(NVL(SUM(Z2.ASGN_RD),0) ,0,DECODE(Z2.IOC_CD,'T/S' ,NVL(SUM(Z2.ASGN_RD),0) ,NVL(SUM(Z2.AVAL_RD),0)) ,NVL(SUM(Z2.ASGN_RD),0))   AS ASGN_RD,                                                                                                " ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 NVL(SUM(Z2.ASGN_TTL),0) AS ASGN_TTL," ).append("\n"); 
		query.append("                                                 NVL(SUM(Z2.ASGN_HC),0)  AS ASGN_HC ," ).append("\n"); 
		query.append("                                                 NVL(SUM(Z2.ASGN_45),0)  AS ASGN_45 ," ).append("\n"); 
		query.append("                                                 NVL(SUM(Z2.ASGN_53),0)  AS ASGN_53 ," ).append("\n"); 
		query.append("                                                 NVL(SUM(Z2.ASGN_RF),0)  AS ASGN_RF ," ).append("\n"); 
		query.append("                                                 NVL(SUM(Z2.ASGN_WGT),0) AS ASGN_WGT," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 -- 20140723 추가" ).append("\n"); 
		query.append("                                                 NVL(SUM(Z2.ASGN_D2),0)   AS ASGN_D2," ).append("\n"); 
		query.append("                                                 NVL(SUM(Z2.ASGN_D4),0)   AS ASGN_D4," ).append("\n"); 
		query.append("                                                 NVL(SUM(Z2.ASGN_RD),0)   AS ASGN_RD,                                                                                                " ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 Z2.DEST_LOC_CD,        " ).append("\n"); 
		query.append("                                                 Z2.USA_BKG_MOD_CD," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.SLS_RGN_OFC_CD)   AS GO2, --20140826" ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.SLS_OFC_CD)       AS GO1," ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.POD_CD)           AS GP1," ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.USA_BKG_MOD_CD)   AS GU1," ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.DEST_LOC_CD   )   AS GD1," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                 Z2.CTRL_D2  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_D4  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_RD  ," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 Z2.CTRL_PORT," ).append("\n"); 
		query.append("                                                 Z2.CTRL_HC  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_45  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_53  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_RF  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_WGT ," ).append("\n"); 
		query.append("                                                 '' AS T" ).append("\n"); 
		query.append("                                            FROM (" ).append("\n"); 
		query.append("                                                    SELECT V.POL_ETB_DT     ," ).append("\n"); 
		query.append("                                                           AL.REP_TRD_CD    ," ).append("\n"); 
		query.append("                                                           AL.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                                                           AL.TRD_CD        ," ).append("\n"); 
		query.append("                                                           AL.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                                                           AL.RLANE_CD      ," ).append("\n"); 
		query.append("                                                           V.COST_WK        ," ).append("\n"); 
		query.append("                                                           AL.VSL_CD        ," ).append("\n"); 
		query.append("                                                           AL.SKD_VOY_NO    ," ).append("\n"); 
		query.append("                                                           AL.SKD_DIR_CD    ," ).append("\n"); 
		query.append("                                                           DECODE(AL.TS_FLG, 'Y', 'T/S', DECODE(AL.IOC_CD, 'O', 'OCN', 'I', 'IPC')) AS IOC_CD," ).append("\n"); 
		query.append("                                                           DECODE(AL.SLS_OFC_CD, AL.SLS_RHQ_CD, 1, AL.SLS_RGN_OFC_CD, 2, 3) AS FLG," ).append("\n"); 
		query.append("                                                           AL.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                                                           AL.SLS_AQ_CD     ," ).append("\n"); 
		query.append("                                                           AL.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("                                                           AL.SLS_OFC_CD    ," ).append("\n"); 
		query.append("                                                           SUBSTR(AL.POD_YD_CD, 1, 5) AS POD_CD," ).append("\n"); 
		query.append("                                                           V.POD_SEQ," ).append("\n"); 
		query.append("                                                           AL.ASGN_TTL_QTY         AS ASGN_TTL," ).append("\n"); 
		query.append("                                                           AL.ASGN_40FT_HC_QTY     AS ASGN_HC ," ).append("\n"); 
		query.append("                                                           AL.ASGN_45FT_HC_QTY     AS ASGN_45 ," ).append("\n"); 
		query.append("                                                           AL.ASGN_53FT_QTY        AS ASGN_53 ," ).append("\n"); 
		query.append("                                                           AL.ASGN_RF_QTY          AS ASGN_RF ," ).append("\n"); 
		query.append("                                                           AL.ASGN_TTL_WGT         AS ASGN_WGT," ).append("\n"); 
		query.append("                                                           AL.BKG_AVAL_TTL_QTY     AS AVAL_TTL," ).append("\n"); 
		query.append("                                                           AL.BKG_AVAL_40FT_HC_QTY AS AVAL_HC ," ).append("\n"); 
		query.append("                                                           AL.BKG_AVAL_45FT_HC_QTY AS AVAL_45 ," ).append("\n"); 
		query.append("                                                           AL.BKG_AVAL_53FT_QTY    AS AVAL_53 ," ).append("\n"); 
		query.append("                                                           AL.BKG_AVAL_RF_QTY      AS AVAL_RF ," ).append("\n"); 
		query.append("                                                           AL.BKG_AVAL_TTL_WGT     AS AVAL_WGT," ).append("\n"); 
		query.append("                                                           " ).append("\n"); 
		query.append("                                                           -- 20140723 추가" ).append("\n"); 
		query.append("                                                           AL.ASGN_20FT_DRY_QTY    AS ASGN_D2 ," ).append("\n"); 
		query.append("                                                           AL.ASGN_40FT_DRY_QTY    AS ASGN_D4 ," ).append("\n"); 
		query.append("                                                           AL.ASGN_RD_QTY          AS ASGN_RD , " ).append("\n"); 
		query.append("                                                           " ).append("\n"); 
		query.append("                                                           AL.BKG_AVAL_20FT_DRY_QTY AS AVAL_D2 ," ).append("\n"); 
		query.append("                                                           AL.BKG_AVAL_40FT_DRY_QTY AS AVAL_D4 ," ).append("\n"); 
		query.append("                                                           AL.BKG_AVAL_RD_QTY       AS AVAL_RD , " ).append("\n"); 
		query.append("                                                                                                         		   		   " ).append("\n"); 
		query.append("                                                    	   AL.DEST_LOC_CD,        " ).append("\n"); 
		query.append("                                                           AL.USA_BKG_MOD_CD," ).append("\n"); 
		query.append("                                                           V.CTRL_D2  ," ).append("\n"); 
		query.append("                                                           V.CTRL_D4  ," ).append("\n"); 
		query.append("                                                           V.CTRL_RD  ," ).append("\n"); 
		query.append("                                                           " ).append("\n"); 
		query.append("                                                           V.CTRL_PORT," ).append("\n"); 
		query.append("                                                           V.CTRL_HC  ," ).append("\n"); 
		query.append("                                                           V.CTRL_45  ," ).append("\n"); 
		query.append("                                                           V.CTRL_53  ," ).append("\n"); 
		query.append("                                                           V.CTRL_RF  ," ).append("\n"); 
		query.append("                                                           V.CTRL_WGT" ).append("\n"); 
		query.append("                                                      FROM SPC_ALOC_POL_POD AL," ).append("\n"); 
		query.append("                                                           PORT_SKD         V" ).append("\n"); 
		query.append("                                                     WHERE AL.REP_TRD_CD     = V.REP_TRD_CD" ).append("\n"); 
		query.append("                                                       AND AL.REP_SUB_TRD_CD = V.REP_SUB_TRD_CD" ).append("\n"); 
		query.append("                                                       AND AL.RLANE_CD       = V.RLANE_CD" ).append("\n"); 
		query.append("                                                       AND AL.DIR_CD         = V.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                       AND AL.VSL_CD         = V.VSL_CD" ).append("\n"); 
		query.append("                                                       AND AL.SKD_VOY_NO     = V.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                       AND AL.SKD_DIR_CD     = V.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                       AND SUBSTR(AL.POL_YD_CD, 1, LENGTH(V.POL_CD)) = V.POL_CD" ).append("\n"); 
		query.append("                                                       AND SUBSTR(AL.POD_YD_CD, 1, LENGTH(V.POD_CD)) = V.POD_CD" ).append("\n"); 
		query.append("                                                       AND (V.IOC_CD IS NULL OR DECODE(AL.TS_FLG, 'Y', 'T/S', DECODE(AL.IOC_CD, 'O', 'OCN', 'I', 'IPC')) = V.IOC_CD)" ).append("\n"); 
		query.append("                                                       AND (V.ORG IS NULL OR V.ORG = AL.SLS_OFC_CD)" ).append("\n"); 
		query.append("                                                 ) Z2" ).append("\n"); 
		query.append("                                        GROUP BY Z2.POL_ETB_DT    ," ).append("\n"); 
		query.append("                                                 Z2.REP_TRD_CD    ," ).append("\n"); 
		query.append("                                                 Z2.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                                                 Z2.TRD_CD        ," ).append("\n"); 
		query.append("                                                 Z2.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                                                 Z2.RLANE_CD      ," ).append("\n"); 
		query.append("                                                 Z2.COST_WK       ," ).append("\n"); 
		query.append("                                                 Z2.VSL_CD        ," ).append("\n"); 
		query.append("                                                 Z2.SKD_VOY_NO    ," ).append("\n"); 
		query.append("                                                 Z2.SKD_DIR_CD    ," ).append("\n"); 
		query.append("                                                 Z2.IOC_CD        ," ).append("\n"); 
		query.append("                                                 Z2.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                                                 Z2.SLS_AQ_CD     ," ).append("\n"); 
		query.append("                                                 Z2.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("                                                 Z2.CTRL_PORT     ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_HC       ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_45       ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_53       ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_RF       ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_WGT      ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_D2  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_D4  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_RD  ," ).append("\n"); 
		query.append("                                                 CUBE(Z2.SLS_OFC_CD, Z2.USA_BKG_MOD_CD, Z2.POD_CD, Z2.DEST_LOC_CD) --20140826" ).append("\n"); 
		query.append("                                       ) Z3" ).append("\n"); 
		query.append("                                 WHERE NOT ( --20140826" ).append("\n"); 
		query.append("                                               GO1||GU1||GP1||GD1 = 1110" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 0110" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1 = 110" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 1010" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 0010" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 0101" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 0100" ).append("\n"); 
		query.append("                                           ) " ).append("\n"); 
		query.append("                                   AND (" ).append("\n"); 
		query.append("                                        (SLS_RHQ_CD IN ('NYCRA', 'HAMRU') AND IOC_CD = 'T/S' AND SLS_RGN_OFC_CD IS NULL and SLS_OFC_CD is null) " ).append("\n"); 
		query.append("                                        OR( SLS_RHQ_CD <>'HAMRU' AND SLS_RHQ_CD <>'NYCRA')) " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                UNION ALL" ).append("\n"); 
		query.append("--                                --BOOKING" ).append("\n"); 
		query.append("                                SELECT Z4.ETB_DT        ," ).append("\n"); 
		query.append("                                       Z4.REP_TRD_CD    ," ).append("\n"); 
		query.append("                                       Z4.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                                       Z4.TRD_CD        ," ).append("\n"); 
		query.append("                                       Z4.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                                       Z4.RLANE_CD      ," ).append("\n"); 
		query.append("                                       Z4.COST_WK       ," ).append("\n"); 
		query.append("                                       Z4.VVD           ," ).append("\n"); 
		query.append("                                       Z4.IOC_CD        ," ).append("\n"); 
		query.append("                                       Z4.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                                       Z4.SLS_AQ_CD     ," ).append("\n"); 
		query.append("                                       NVL(Z4.SLS_RGN_OFC_CD, ' ') AS SLS_RGN_OFC_CD,  --20140826" ).append("\n"); 
		query.append("                                       Z4.SLS_OFC_CD    ," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       Z4.USA_BKG_MOD   ," ).append("\n"); 
		query.append("                                       SUBSTR(Z4.POD_CD, 1, 5) AS POD_CD,   --20140829" ).append("\n"); 
		query.append("                                       --Z4.POD_CD        ," ).append("\n"); 
		query.append("                                       Z4.POD_SEQ       ," ).append("\n"); 
		query.append("                                       Z4.DEST_LOC_CD   ," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                            		   --Z4.GO1||Z4.GU1||Z4.GP1||Z4.GD1," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       NULL AS FCAST_TTL," ).append("\n"); 
		query.append("                                       NULL AS FCAST_HC ," ).append("\n"); 
		query.append("                                       NULL AS FCAST_45 ," ).append("\n"); 
		query.append("                                       NULL AS FCAST_53 ," ).append("\n"); 
		query.append("                                       NULL AS FCAST_RF ," ).append("\n"); 
		query.append("                                       NULL AS FCAST_WGT," ).append("\n"); 
		query.append("                                       NULL AS ASGN_TTL ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_HC  ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_45  ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_53  ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_RF  ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_WGT ," ).append("\n"); 
		query.append("                                       Z4.BKG_TTL       ," ).append("\n"); 
		query.append("                                       Z4.BKG_20        ," ).append("\n"); 
		query.append("                                       Z4.BKG_40        ," ).append("\n"); 
		query.append("                                       Z4.BKG_HC        ," ).append("\n"); 
		query.append("                                       Z4.BKG_45        ," ).append("\n"); 
		query.append("                                       Z4.BKG_53        ," ).append("\n"); 
		query.append("                                       Z4.BKG_RF20      ," ).append("\n"); 
		query.append("                                       Z4.BKG_RF40      ," ).append("\n"); 
		query.append("                                       Z4.BKG_WGT       , BKG_VOL_VGM,BKG_WGT_VGM," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       -- 20140723 추가" ).append("\n"); 
		query.append("                                       NULL AS FCAST_D2 ," ).append("\n"); 
		query.append("                                       NULL AS FCAST_D4 ," ).append("\n"); 
		query.append("                                       NULL AS FCAST_RD ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_D2  ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_D4  ," ).append("\n"); 
		query.append("                                       NULL AS ASGN_RD  ," ).append("\n"); 
		query.append("                                       Z4.BKG_D2        ," ).append("\n"); 
		query.append("                                       Z4.BKG_D4        ," ).append("\n"); 
		query.append("                                       Z4.BKG_RD20      ," ).append("\n"); 
		query.append("                                       Z4.BKG_RD40      ," ).append("\n"); 
		query.append("                                     " ).append("\n"); 
		query.append("                                       Z4.CTRL_D2  ," ).append("\n"); 
		query.append("                                       Z4.CTRL_D4  ," ).append("\n"); 
		query.append("                                       Z4.CTRL_RD  ," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       Z4.CTRL_HC       ," ).append("\n"); 
		query.append("                                       Z4.CTRL_45       ," ).append("\n"); 
		query.append("                                       Z4.CTRL_53       ," ).append("\n"); 
		query.append("                                       Z4.CTRL_RF       ," ).append("\n"); 
		query.append("                                       Z4.CTRL_WGT" ).append("\n"); 
		query.append("                                  FROM (" ).append("\n"); 
		query.append("                                          SELECT Z2.POL_ETB_DT AS ETB_DT," ).append("\n"); 
		query.append("                                                 Z2.REP_TRD_CD," ).append("\n"); 
		query.append("                                                 Z2.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                                                 Z2.TRD_CD," ).append("\n"); 
		query.append("                                                 Z2.SUB_TRD_CD," ).append("\n"); 
		query.append("                                                 Z2.RLANE_CD," ).append("\n"); 
		query.append("                                                 Z2.COST_WK," ).append("\n"); 
		query.append("                                                 Z2.VSL_CD||Z2.SKD_VOY_NO||Z2.SKD_DIR_CD AS VVD," ).append("\n"); 
		query.append("                                                 Z2.IOC_CD," ).append("\n"); 
		query.append("                                                 O.N2ND_PRNT_OFC_CD                AS SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                                                 NVL(MAX(O.N3RD_PRNT_OFC_CD), ' ') AS SLS_AQ_CD     ," ).append("\n"); 
		query.append("                                                 O.N4TH_PRNT_OFC_CD                AS SLS_RGN_OFC_CD,   --20140826" ).append("\n"); 
		query.append("                                                 NVL(DECODE(O.OFC_KND_CD, '6', DECODE(Z2.SLS_OFC_CD, O.N4TH_PRNT_OFC_CD, O.N4TH_PRNT_OFC_CD, O.N5TH_PRNT_OFC_CD), Z2.SLS_OFC_CD), ' ') AS SLS_OFC_CD," ).append("\n"); 
		query.append("                                                 NVL(Z2.POD_CD, ' ')     AS POD_CD ," ).append("\n"); 
		query.append("                                                 NVL(MIN(Z2.POD_SEQ), 0) AS POD_SEQ," ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,   1, 14), 0)))  AS BKG_TTL ," ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  15, 14), 0)))  AS BKG_20  ," ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  29, 14), 0)))  AS BKG_40  ," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  43, 14), 0)))  AS BKG_D2  ," ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  57, 14), 0)))  AS BKG_D4  ," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  71, 14), 0)))  AS BKG_HC  ," ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  85, 14), 0)))  AS BKG_45  ," ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  99, 14), 0)))  AS BKG_53  ," ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  113,14), 0)))  AS BKG_RF20," ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  127,14), 0)))  AS BKG_RF40," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  141,14), 0)))  AS BKG_RD20," ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  155,14), 0)))  AS BKG_RD40," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  169, 14), 0))) AS BKG_WGT , SUM(NVL(BKG_VOL_VGM,0)) AS BKG_VOL_VGM,SUM(NVL(BKG_WGT_VGM,0)) AS BKG_WGT_VGM," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 -- 20140723 추가" ).append("\n"); 
		query.append("                                                 NVL(Z2.DEST_LOC_CD,' ')              AS DEST_LOC_CD," ).append("\n"); 
		query.append("                                        		 NVL(Z2.USA_BKG_MOD,' ')              AS USA_BKG_MOD," ).append("\n"); 
		query.append("                                        		 " ).append("\n"); 
		query.append("                                                 GROUPING_ID(O.N4TH_PRNT_OFC_CD)      AS GO2,   --20140826" ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.USA_BKG_MOD)          AS GU1," ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.DEST_LOC_CD)          AS GD1," ).append("\n"); 
		query.append("                                                 GROUPING_ID(DECODE(O.OFC_KND_CD, '6', DECODE(Z2.SLS_OFC_CD, O.N4TH_PRNT_OFC_CD, O.N4TH_PRNT_OFC_CD, O.N5TH_PRNT_OFC_CD), Z2.SLS_OFC_CD)) AS GO1," ).append("\n"); 
		query.append("                                                 GROUPING_ID(Z2.POD_CD)               AS GP1," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 Z2.CTRL_D2  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_D4  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_RD  ," ).append("\n"); 
		query.append("                                                 --Z2.CTRL_USA ," ).append("\n"); 
		query.append("                                                 --Z2.CTRL_ACCT," ).append("\n"); 
		query.append("                                                 --Z2.CTRL_DEST," ).append("\n"); 
		query.append("                                                 --Z2.CTRL_DEST_LVL, -- D = BKG_POD, T = BKG_DEL" ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 Z2.CTRL_PORT," ).append("\n"); 
		query.append("                                                 Z2.CTRL_HC  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_45  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_53  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_RF  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_WGT" ).append("\n"); 
		query.append("                                            FROM BOOKING     Z2," ).append("\n"); 
		query.append("                                                 SPC_OFC_LVL O" ).append("\n"); 
		query.append("                                           WHERE Z2.SLS_OFC_CD = O.OFC_CD" ).append("\n"); 
		query.append("                                             AND Z2.COST_YR || Z2.COST_WK BETWEEN O.OFC_APLY_FM_YRWK AND O.OFC_APLY_TO_YRWK" ).append("\n"); 
		query.append("                                        GROUP BY Z2.POL_ETB_DT     ," ).append("\n"); 
		query.append("                                                 Z2.REP_TRD_CD     ," ).append("\n"); 
		query.append("                                                 Z2.REP_SUB_TRD_CD ," ).append("\n"); 
		query.append("                                                 Z2.TRD_CD         ," ).append("\n"); 
		query.append("                                                 Z2.SUB_TRD_CD     ," ).append("\n"); 
		query.append("                                                 Z2.RLANE_CD       ," ).append("\n"); 
		query.append("                                                 Z2.COST_WK        ," ).append("\n"); 
		query.append("                                                 Z2.VSL_CD         ," ).append("\n"); 
		query.append("                                                 Z2.SKD_VOY_NO     ," ).append("\n"); 
		query.append("                                                 Z2.SKD_DIR_CD     ," ).append("\n"); 
		query.append("                                                 Z2.IOC_CD         ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_PORT      ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_HC        ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_45        ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_53        ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_RF        ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_WGT       ," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 Z2.CTRL_D2  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_D4  ," ).append("\n"); 
		query.append("                                                 Z2.CTRL_RD  ," ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 O.N2ND_PRNT_OFC_CD," ).append("\n"); 
		query.append("                                                 --O.N4TH_PRNT_OFC_CD," ).append("\n"); 
		query.append("                                                 CUBE(O.N4TH_PRNT_OFC_CD, DECODE(O.OFC_KND_CD, '6', DECODE(Z2.SLS_OFC_CD, O.N4TH_PRNT_OFC_CD, O.N4TH_PRNT_OFC_CD, O.N5TH_PRNT_OFC_CD), Z2.SLS_OFC_CD), " ).append("\n"); 
		query.append("                                                      Z2.POD_CD,Z2.DEST_LOC_CD,Z2.USA_BKG_MOD" ).append("\n"); 
		query.append("                                                     )   --20140826" ).append("\n"); 
		query.append("                                       ) Z4" ).append("\n"); 
		query.append("                                 WHERE NOT (--20140826                          " ).append("\n"); 
		query.append("                                               GO1||GU1||GP1||GD1 = 1110" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 0110" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1 = 110" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 1010" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 0010" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 0101" ).append("\n"); 
		query.append("                                            OR GO1||GU1||GP1||GD1 = 0100" ).append("\n"); 
		query.append("                                           )                                             " ).append("\n"); 
		query.append("                                    AND NOT (SLS_RGN_OFC_CD IS NULL AND IOC_CD != 'T/S') " ).append("\n"); 
		query.append("                                    AND NOT (SLS_RHQ_CD NOT IN ('NYCRA', 'HAMRU') AND SLS_RGN_OFC_CD IS NULL) " ).append("\n"); 
		query.append("                                    AND NOT (IOC_CD = 'T/S' AND SLS_RGN_OFC_CD IS NULL AND SLS_OFC_CD != ' ')" ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                             ) Z5" ).append("\n"); 
		query.append("                    GROUP BY Z5.ETB_DT        ," ).append("\n"); 
		query.append("                             Z5.REP_TRD_CD    ," ).append("\n"); 
		query.append("                             Z5.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                             Z5.TRD_CD        ," ).append("\n"); 
		query.append("                             Z5.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                             Z5.RLANE_CD      ," ).append("\n"); 
		query.append("                             Z5.COST_WK       ," ).append("\n"); 
		query.append("                             Z5.VVD           ," ).append("\n"); 
		query.append("                             Z5.IOC_CD        ," ).append("\n"); 
		query.append("                             Z5.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                             Z5.SLS_AQ_CD     ," ).append("\n"); 
		query.append("                             Z5.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("                             Z5.SLS_OFC_CD    ," ).append("\n"); 
		query.append("                             -- 20140723        " ).append("\n"); 
		query.append("						     Z5.USA_BKG_MOD_CD,  " ).append("\n"); 
		query.append("                             Z5.POD_CD        ," ).append("\n"); 
		query.append("                        	 Z5.DEST_LOC_CD  " ).append("\n"); 
		query.append("                    ORDER BY Z5.ETB_DT        ," ).append("\n"); 
		query.append("                             Z5.REP_TRD_CD    ," ).append("\n"); 
		query.append("                             Z5.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                             Z5.TRD_CD        ," ).append("\n"); 
		query.append("                             Z5.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                             Z5.RLANE_CD      ," ).append("\n"); 
		query.append("                             Z5.COST_WK       ," ).append("\n"); 
		query.append("                             Z5.VVD           ," ).append("\n"); 
		query.append("                             Z5.IOC_CD        ," ).append("\n"); 
		query.append("                             Z5.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                             Z5.SLS_AQ_CD     ," ).append("\n"); 
		query.append("                             Z5.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("                             Z5.SLS_OFC_CD    ," ).append("\n"); 
		query.append("                             -- 20140723        " ).append("\n"); 
		query.append("						     Z5.USA_BKG_MOD_CD,  " ).append("\n"); 
		query.append("                             Z5.POD_CD        ," ).append("\n"); 
		query.append("                        	 Z5.DEST_LOC_CD  " ).append("\n"); 
		query.append("                   ) Z6" ).append("\n"); 
		query.append("            UNION ALL" ).append("\n"); 
		query.append("            --DISCHARGE BOOKING" ).append("\n"); 
		query.append("            SELECT Z3.POL_ETB_DT AS ETB_DT," ).append("\n"); 
		query.append("                   Z3.REP_TRD_CD    ," ).append("\n"); 
		query.append("                   Z3.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                   Z3.TRD_CD        ," ).append("\n"); 
		query.append("                   Z3.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                   Z3.RLANE_CD      ," ).append("\n"); 
		query.append("                   Z3.COST_WK       ," ).append("\n"); 
		query.append("                   Z3.VSL_CD||Z3.SKD_VOY_NO||Z3.SKD_DIR_CD AS VVD," ).append("\n"); 
		query.append("                   Z3.IOC_CD        ," ).append("\n"); 
		query.append("                   Z3.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                   Z3.SLS_AQ_CD     ," ).append("\n"); 
		query.append("                   Z3.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("                   RANK() OVER ( PARTITION BY Z3.POL_ETB_DT, Z3.REP_TRD_CD, Z3.REP_SUB_TRD_CD, Z3.TRD_CD, Z3.SUB_TRD_CD, Z3.RLANE_CD, Z3.COST_WK, Z3.VSL_CD, Z3.SKD_VOY_NO, Z3.SKD_DIR_CD, Z3.IOC_CD, Z3.SLS_RHQ_CD, Z3.SLS_AQ_CD, Z3.SLS_RGN_OFC_CD ORDER BY ROWNUM) AS RK," ).append("\n"); 
		query.append("                   ' '  AS SLS_OFC_CD   ," ).append("\n"); 
		query.append("                   ' '  AS USA_BKG_MOD  ," ).append("\n"); 
		query.append("                   --Z3.USA_BKG_MOD       ," ).append("\n"); 
		query.append("                   ' '  AS POD_CD       ," ).append("\n"); 
		query.append("                   ' '  AS DEST_LOC_CD1  ," ).append("\n"); 
		query.append("                   --Z3.DEST_LOC_CD       ,    " ).append("\n"); 
		query.append("                   NULL AS FCAST_TTL    ," ).append("\n"); 
		query.append("                   NULL AS FCAST_HC     ," ).append("\n"); 
		query.append("                   NULL AS FCAST_45     ," ).append("\n"); 
		query.append("                   NULL AS FCAST_53     ," ).append("\n"); 
		query.append("                   NULL AS FCAST_RF     ," ).append("\n"); 
		query.append("                   NULL AS FCAST_WGT    ," ).append("\n"); 
		query.append("                   NULL AS FCAST_D2     ," ).append("\n"); 
		query.append("                   NULL AS FCAST_D4     ," ).append("\n"); 
		query.append("                   NULL AS FCAST_RD     ," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   NULL AS ASGN_TTL     ," ).append("\n"); 
		query.append("                   NULL AS ASGN_HC      ," ).append("\n"); 
		query.append("                   NULL AS ASGN_45      ," ).append("\n"); 
		query.append("                   NULL AS ASGN_53      ," ).append("\n"); 
		query.append("                   NULL AS ASGN_RF      ," ).append("\n"); 
		query.append("                   NULL AS ASGN_WGT     ," ).append("\n"); 
		query.append("                   NULL AS ASGN_D2      ," ).append("\n"); 
		query.append("                   NULL AS ASGN_D4      ," ).append("\n"); 
		query.append("                   NULL AS ASGN_RD      ," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   NULL AS DIF_TTL      ," ).append("\n"); 
		query.append("                   NULL AS DIF_HC       ," ).append("\n"); 
		query.append("                   NULL AS DIF_45       ," ).append("\n"); 
		query.append("                   NULL AS DIF_53       ," ).append("\n"); 
		query.append("                   NULL AS DIF_RF       ," ).append("\n"); 
		query.append("                   NULL AS DIF_WGT      ," ).append("\n"); 
		query.append("                   NULL AS DIF_D2       ," ).append("\n"); 
		query.append("                   NULL AS DIF_D4       ," ).append("\n"); 
		query.append("                   NULL AS DIF_RD       ," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   NULL AS BKG_TTL      ," ).append("\n"); 
		query.append("                   NULL AS BKG_S20      ," ).append("\n"); 
		query.append("                   NULL AS BKG_S40      ," ).append("\n"); 
		query.append("                   NULL AS BKG_20       ," ).append("\n"); 
		query.append("                   NULL AS BKG_40       ," ).append("\n"); 
		query.append("                   NULL AS BKG_HC       ," ).append("\n"); 
		query.append("                   NULL AS BKG_45       ," ).append("\n"); 
		query.append("                   NULL AS BKG_53       ," ).append("\n"); 
		query.append("                   NULL AS BKG_RF20     ," ).append("\n"); 
		query.append("                   NULL AS BKG_RF40     ," ).append("\n"); 
		query.append("                   NULL AS BKG_WGT      ,NULL AS BKG_VOL_VGM,NULL AS BKG_WGT_VGM," ).append("\n"); 
		query.append("                   NULL AS BKG_D2       ," ).append("\n"); 
		query.append("                   NULL AS BKG_D4       ," ).append("\n"); 
		query.append("                   NULL AS BKG_RD20     ," ).append("\n"); 
		query.append("                   NULL AS BKG_RD40     ," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   Z3.PRE_REP_TRD_CD    ," ).append("\n"); 
		query.append("                   Z3.PRE_REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                   Z3.PRE_RLANE_CD      ," ).append("\n"); 
		query.append("                   Z3.PRE_VSL_CD||Z3.PRE_SKD_VOY_NO||Z3.PRE_SKD_DIR_CD AS PRE_VVD," ).append("\n"); 
		query.append("                   (" ).append("\n"); 
		query.append("                     SELECT TO_CHAR(MAX(V.VPS_ETB_DT) KEEP(DENSE_RANK FIRST ORDER BY DECODE(V.SKD_CNG_STS_CD, 'S', '2', '1'), V.CLPT_IND_SEQ), 'YYYY.MM.DD')" ).append("\n"); 
		query.append("                       FROM VSK_VSL_PORT_SKD V" ).append("\n"); 
		query.append("                      WHERE V.VSL_CD = Z3.PRE_VSL_CD" ).append("\n"); 
		query.append("                        AND V.SKD_VOY_NO = Z3.PRE_SKD_VOY_NO" ).append("\n"); 
		query.append("                        AND V.SKD_DIR_CD = Z3.PRE_SKD_DIR_CD" ).append("\n"); 
		query.append("                        AND V.VPS_PORT_CD = SUBSTR(Z3.POD_CD, 1, 5)" ).append("\n"); 
		query.append("                        AND NVL(V.SKD_CNG_STS_CD, ' ') <> 'S'" ).append("\n"); 
		query.append("                   ) AS PRE_ETB_DT," ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   Z3.BKG_TTL_QTY     AS DIS_TTL ," ).append("\n"); 
		query.append("                   Z3.BKG_20FT_QTY    AS DIS_S20 , -- R2는 20에 포함됨" ).append("\n"); 
		query.append("                   Z3.BKG_40FT_QTY + Z3.BKG_40FT_HC_QTY + Z3.BKG_45FT_HC_QTY + Z3.BKG_53FT_QTY AS DIS_S40, --40/HC/45에 R4,R7,R5가 포함되어 있음" ).append("\n"); 
		query.append("                   Z3.BKG_20FT_QTY    AS DIS_20  ," ).append("\n"); 
		query.append("                   Z3.BKG_40FT_QTY    AS DIS_40  ," ).append("\n"); 
		query.append("                   Z3.BKG_40FT_HC_QTY AS DIS_HC  ," ).append("\n"); 
		query.append("                   Z3.BKG_45FT_HC_QTY AS DIS_45  ," ).append("\n"); 
		query.append("                   Z3.BKG_53FT_QTY    AS DIS_53  ," ).append("\n"); 
		query.append("                   Z3.BKG_RF20_QTY    AS DIS_RF20," ).append("\n"); 
		query.append("                   Z3.BKG_RF40_QTY    AS DIS_RF40," ).append("\n"); 
		query.append("                   Z3.BKG_TTL_WGT     AS DIS_WGT , DIS_VOL_VGM ,DIS_WGT_VGM ," ).append("\n"); 
		query.append("                   Z3.BKG_D2_QTY      AS DIS_D2  ," ).append("\n"); 
		query.append("                   Z3.BKG_D4_QTY      AS DIS_D4  ," ).append("\n"); 
		query.append("                   Z3.BKG_RD20_QTY    AS DIS_RD20," ).append("\n"); 
		query.append("                   Z3.BKG_RD40_QTY    AS DIS_RD40, " ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   Z3.CTRL_HC ," ).append("\n"); 
		query.append("                   Z3.CTRL_45 ," ).append("\n"); 
		query.append("                   Z3.CTRL_53 ," ).append("\n"); 
		query.append("                   Z3.CTRL_RF ," ).append("\n"); 
		query.append("                   Z3.CTRL_WGT,                                                    " ).append("\n"); 
		query.append("                   Z3.CTRL_D2," ).append("\n"); 
		query.append("                   Z3.CTRL_D4," ).append("\n"); 
		query.append("                   Z3.CTRL_RD" ).append("\n"); 
		query.append("              FROM (" ).append("\n"); 
		query.append("                      SELECT Z2.POL_ETB_DT    ," ).append("\n"); 
		query.append("                             Z2.REP_TRD_CD    ," ).append("\n"); 
		query.append("                             Z2.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                             Z2.TRD_CD        ," ).append("\n"); 
		query.append("                             Z2.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                             Z2.RLANE_CD      ," ).append("\n"); 
		query.append("                             Z2.COST_WK       ," ).append("\n"); 
		query.append("                             Z2.VSL_CD        ," ).append("\n"); 
		query.append("                             Z2.SKD_VOY_NO    ," ).append("\n"); 
		query.append("                             Z2.SKD_DIR_CD    ," ).append("\n"); 
		query.append("                             Z2.IOC_CD        ," ).append("\n"); 
		query.append("                             NVL(O.N2ND_PRNT_OFC_CD, ' ') AS SLS_RHQ_CD    ," ).append("\n"); 
		query.append("                             NVL(O.N3RD_PRNT_OFC_CD, ' ') AS SLS_AQ_CD     ," ).append("\n"); 
		query.append("                             NVL(O.N4TH_PRNT_OFC_CD, ' ') AS SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                             Z2.USA_BKG_MOD,  " ).append("\n"); 
		query.append("                             Z2.POD_CD        ," ).append("\n"); 
		query.append("                             Z2.DEST_LOC_CD   ,  " ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                             NVL(RL.RLANE_CD  , 'RBCCO')  AS PRE_RLANE_CD  ," ).append("\n"); 
		query.append("                             NVL(RL.REP_TRD_CD, 'IAS')    AS PRE_REP_TRD_CD," ).append("\n"); 
		query.append("                             SPC_GET_REP_SUB_TRD_FNC(NVL(RL.RLANE_CD, 'RBCCO')) AS PRE_REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                             Z2.PRE_VSL_CD    ," ).append("\n"); 
		query.append("                             Z2.PRE_SKD_VOY_NO," ).append("\n"); 
		query.append("                             Z2.PRE_SKD_DIR_CD,                           " ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,   1, 14), 0))) AS BKG_TTL_QTY    ," ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  15, 14), 0))) AS BKG_20FT_QTY   ," ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  29, 14), 0))) AS BKG_40FT_QTY   ," ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  43, 14), 0))) AS BKG_D2_QTY   ," ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  57, 14), 0))) AS BKG_D4_QTY   ," ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  71, 14), 0))) AS BKG_40FT_HC_QTY," ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  85, 14), 0))) AS BKG_45FT_HC_QTY," ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL,  99, 14), 0))) AS BKG_53FT_QTY   ," ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL, 113, 14), 0))) AS BKG_RF20_QTY   ," ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL, 127, 14), 0))) AS BKG_RF40_QTY   ," ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL, 141, 14), 0))) AS BKG_RD20_QTY   ," ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL, 155, 14), 0))) AS BKG_RD40_QTY   ," ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                             SUM(TO_NUMBER(NVL(SUBSTR(Z2.VAL, 169, 14), 0))) AS BKG_TTL_WGT    ,SUM(NVL(Z2.DIS_VOL_VGM,0)) AS DIS_VOL_VGM,SUM(NVL(Z2.DIS_WGT_VGM,0)) AS DIS_WGT_VGM," ).append("\n"); 
		query.append("                             MAX(Z2.CTRL_HC)  AS CTRL_HC ," ).append("\n"); 
		query.append("                             MAX(Z2.CTRL_45)  AS CTRL_45 ," ).append("\n"); 
		query.append("                             MAX(Z2.CTRL_53)  AS CTRL_53 ," ).append("\n"); 
		query.append("                             MAX(Z2.CTRL_RF)  AS CTRL_RF ," ).append("\n"); 
		query.append("                             MAX(Z2.CTRL_WGT) AS CTRL_WGT," ).append("\n"); 
		query.append("                             -- 20140723 추가                    " ).append("\n"); 
		query.append("                             MAX(Z2.CTRL_D2)   AS CTRL_D2," ).append("\n"); 
		query.append("                             MAX(Z2.CTRL_D4)   AS CTRL_D4," ).append("\n"); 
		query.append("                             MAX(Z2.CTRL_RD)   AS CTRL_RD" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                        FROM (" ).append("\n"); 
		query.append("                                SELECT V.POL_ETB_DT    ," ).append("\n"); 
		query.append("                                       V.REP_TRD_CD    ," ).append("\n"); 
		query.append("                                       V.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                                       V.TRD_CD        ," ).append("\n"); 
		query.append("                                       V.SUB_TRD_CD    ," ).append("\n"); 
		query.append("                                       V.RLANE_CD      ," ).append("\n"); 
		query.append("                                       V.COST_YR       ," ).append("\n"); 
		query.append("                                       V.COST_WK       ," ).append("\n"); 
		query.append("                                       V.VSL_CD        ," ).append("\n"); 
		query.append("                                       V.SKD_VOY_NO    ," ).append("\n"); 
		query.append("                                       V.SKD_DIR_CD    ," ).append("\n"); 
		query.append("                                       V.IOC_CD        ," ).append("\n"); 
		query.append("                                       NVL(BV.VSL_CD    , ' ') AS PRE_VSL_CD    ," ).append("\n"); 
		query.append("                                       NVL(BV.SKD_VOY_NO, ' ') AS PRE_SKD_VOY_NO," ).append("\n"); 
		query.append("                                       NVL(BV.SKD_DIR_CD, ' ') AS PRE_SKD_DIR_CD," ).append("\n"); 
		query.append("                                       NVL(BV.SLAN_CD   , ' ') AS SLAN_CD       ," ).append("\n"); 
		query.append("                                       SPC_SCR_OFC_CONV_FNC(B.OB_SLS_OFC_CD) AS SLS_OFC_CD," ).append("\n"); 
		query.append("                                       V.POL_CD AS POD_CD," ).append("\n"); 
		query.append("                                       (" ).append("\n"); 
		query.append("                                          SELECT    TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD),  '2', 1, 2)*Q.OP_CNTR_QTY), 'FM0000000000.000')" ).append("\n"); 
		query.append("                                                 || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD),  '2', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                                                 || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD),  '4', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 -- 20140723 추가" ).append("\n"); 
		query.append("                                                 || TO_CHAR(SUM(DECODE(SUBSTR(Q.CNTR_TPSZ_CD,1,2), 'D2', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000') -- 20에 포함되어 있음" ).append("\n"); 
		query.append("                        				         || TO_CHAR(SUM(DECODE(SUBSTR(Q.CNTR_TPSZ_CD,1,2), 'D4', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000') -- 40에 포함되어 있음" ).append("\n"); 
		query.append("                				       " ).append("\n"); 
		query.append("                                                 || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD),  '5', Q.OP_CNTR_QTY, '9', Q.OP_CNTR_QTY, '8', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')	--R9,R8에 대해서 R5과 동일하게 HC으로 처리되도록 추가" ).append("\n"); 
		query.append("                                                 || TO_CHAR(SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Q.CNTR_TPSZ_CD),  '7', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                                                 || TO_CHAR(SUM(DECODE(Q.CNTR_TPSZ_CD, 'DW', Q.OP_CNTR_QTY, 'DX', Q.OP_CNTR_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                                                 || TO_CHAR(SUM(DECODE(Q.CNTR_TPSZ_CD, 'R2', Q.OP_CNTR_QTY - Q.EQ_SUBST_CGO_QTY, 0)), 'FM0000000000.000')" ).append("\n"); 
		query.append("                                                 || TO_CHAR(SUM(CASE WHEN SUBSTR(Q.CNTR_TPSZ_CD, 1, 1) = 'R' AND Q.CNTR_TPSZ_CD <> 'R2' THEN Q.OP_CNTR_QTY - Q.EQ_SUBST_CGO_QTY ELSE 0 END), 'FM0000000000.000')" ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 -- 20140723 추가" ).append("\n"); 
		query.append("                                                 || TO_CHAR(SUM(CASE WHEN Q.CNTR_TPSZ_CD LIKE 'R%' AND Q.EQ_SUBST_CNTR_TPSZ_CD = 'D2' THEN Q.EQ_SUBST_CGO_QTY ELSE 0 END), 'FM0000000000.000')--RD2" ).append("\n"); 
		query.append("                                                 || TO_CHAR(SUM(CASE WHEN Q.CNTR_TPSZ_CD LIKE 'R%' AND Q.EQ_SUBST_CNTR_TPSZ_CD <> 'D2' THEN Q.EQ_SUBST_CGO_QTY ELSE 0 END), 'FM0000000000.000')--RD4" ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("                                                 || TO_CHAR((MAX(D.ACT_WGT) * DECODE(MAX(D.WGT_UT_CD), 'LBS', 0.00045, 0.001)) + SUM(Q.OP_CNTR_QTY * ( SELECT TS.CNTR_TPSZ_TARE_WGT" ).append("\n"); 
		query.append("                                                                                                                                                         FROM MDM_CNTR_TP_SZ TS" ).append("\n"); 
		query.append("                                                                                                                                                        WHERE TS.CNTR_TPSZ_CD = Q.CNTR_TPSZ_CD)) * 0.001, 'FM0000000000.000')" ).append("\n"); 
		query.append("                                            FROM BKG_QUANTITY Q" ).append("\n"); 
		query.append("                                           WHERE B.BKG_NO = Q.BKG_NO" ).append("\n"); 
		query.append("                                       ) AS VAL," ).append("\n"); 
		query.append("                     " ).append("\n"); 
		query.append("                                       V.CTRL_HC ," ).append("\n"); 
		query.append("                                       V.CTRL_45 ," ).append("\n"); 
		query.append("                                       V.CTRL_53 ," ).append("\n"); 
		query.append("                                       V.CTRL_RF ," ).append("\n"); 
		query.append("                                       V.CTRL_WGT," ).append("\n"); 
		query.append("                                       -- 20140723 추가" ).append("\n"); 
		query.append("                                       V.DEST_LOC_CD,          " ).append("\n"); 
		query.append("                                       V.USA_BKG_MOD,                                       " ).append("\n"); 
		query.append("                                       V.CTRL_D2  ," ).append("\n"); 
		query.append("                                       V.CTRL_D4  ," ).append("\n"); 
		query.append("                                       V.CTRL_RD " ).append("\n"); 
		query.append("									  ,(" ).append("\n"); 
		query.append("										SELECT SUM(DECODE(SPC_GET_CNTR_SZ_FNC(Z.CNTR_TPSZ_CD), '2', 1, 2)* Z.OP_CNTR_QTY) " ).append("\n"); 
		query.append("										FROM BKG_QUANTITY Z " ).append("\n"); 
		query.append("										WHERE Z.BKG_NO= B.BKG_NO AND OP_CNTR_QTY > 0 " ).append("\n"); 
		query.append("										AND EXISTS ( SELECT 1 FROM BKG_CONTAINER C WHERE C.BKG_NO= Z.BKG_NO AND VGM_WGT>0 AND VGM_WGT IS NOT NULL )" ).append("\n"); 
		query.append("										) AS DIS_VOL_VGM" ).append("\n"); 
		query.append("									   ,(SELECT SUM(NVL(Z.VGM_WGT,0) * DECODE(Z.VGM_WGT_UT_CD,'LBS',0.00045,0.001)) FROM BKG_CONTAINER Z WHERE Z.BKG_NO= B.BKG_NO AND VGM_WGT>0 AND VGM_WGT IS NOT NULL) AS DIS_WGT_VGM " ).append("\n"); 
		query.append("                                  FROM BKG_BOOKING B ," ).append("\n"); 
		query.append("                                       BKG_VVD     BV," ).append("\n"); 
		query.append("                                       BOOKING     V ," ).append("\n"); 
		query.append("                                       BKG_BL_DOC  D" ).append("\n"); 
		query.append("                                 WHERE V.BKG_NO = BV.BKG_NO" ).append("\n"); 
		query.append("                                   AND DECODE(V.VSL_PRE_PST_CD, 'T', 'S', 'U', 'T') = BV.VSL_PRE_PST_CD -- 대상 항차 직전 항차만 조회되도록 수정" ).append("\n"); 
		query.append("                                   AND (V.ORG IS NULL OR SPC_SCR_OFC_CONV_FNC(B.OB_SLS_OFC_CD) = V.ORG)" ).append("\n"); 
		query.append("                                   AND B.BKG_NO         = BV.BKG_NO" ).append("\n"); 
		query.append("                                   AND B.BKG_STS_CD    IN('W','F')" ).append("\n"); 
		query.append("                                   AND B.BKG_CGO_TP_CD <> 'P'" ).append("\n"); 
		query.append("                                   AND B.BKG_NO         = D.BKG_NO" ).append("\n"); 
		query.append("                              ) Z2," ).append("\n"); 
		query.append("                              SPC_OFC_LVL  O ," ).append("\n"); 
		query.append("                              MDM_REV_LANE RL" ).append("\n"); 
		query.append("                        WHERE Z2.SLS_OFC_CD     = O.OFC_CD" ).append("\n"); 
		query.append("                          AND Z2.COST_YR || Z2.COST_WK BETWEEN O.OFC_APLY_FM_YRWK AND O.OFC_APLY_TO_YRWK" ).append("\n"); 
		query.append("                          AND RL.DELT_FLG   (+) = 'N'" ).append("\n"); 
		query.append("                          AND RL.VSL_TP_CD  (+) = 'C'" ).append("\n"); 
		query.append("                          AND RL.VSL_SLAN_CD(+) = Z2.SLAN_CD" ).append("\n"); 
		query.append("                     GROUP BY Z2.POL_ETB_DT     ," ).append("\n"); 
		query.append("                              Z2.REP_TRD_CD     ," ).append("\n"); 
		query.append("                              Z2.REP_SUB_TRD_CD ," ).append("\n"); 
		query.append("                              Z2.TRD_CD         ," ).append("\n"); 
		query.append("                              Z2.SUB_TRD_CD     ," ).append("\n"); 
		query.append("                              Z2.RLANE_CD       ," ).append("\n"); 
		query.append("                              Z2.COST_WK        ," ).append("\n"); 
		query.append("                              Z2.VSL_CD         ," ).append("\n"); 
		query.append("                              Z2.SKD_VOY_NO     ," ).append("\n"); 
		query.append("                              Z2.SKD_DIR_CD     ," ).append("\n"); 
		query.append("                              Z2.IOC_CD         ," ).append("\n"); 
		query.append("                              O.N2ND_PRNT_OFC_CD," ).append("\n"); 
		query.append("                              O.N3RD_PRNT_OFC_CD," ).append("\n"); 
		query.append("                              O.N4TH_PRNT_OFC_CD," ).append("\n"); 
		query.append("                              Z2.PRE_VSL_CD     ," ).append("\n"); 
		query.append("                              Z2.PRE_SKD_VOY_NO ," ).append("\n"); 
		query.append("                              Z2.PRE_SKD_DIR_CD ," ).append("\n"); 
		query.append("                              NVL(RL.RLANE_CD, 'RBCCO')," ).append("\n"); 
		query.append("                              NVL(RL.REP_TRD_CD, 'IAS')," ).append("\n"); 
		query.append("                              Z2.POD_CD        ,                                 " ).append("\n"); 
		query.append("                              Z2.USA_BKG_MOD    ," ).append("\n"); 
		query.append("                    	      Z2.DEST_LOC_CD" ).append("\n"); 
		query.append("                     ORDER BY Z2.POL_ETB_DT     ," ).append("\n"); 
		query.append("                              Z2.REP_TRD_CD     ," ).append("\n"); 
		query.append("                              Z2.REP_SUB_TRD_CD ," ).append("\n"); 
		query.append("                              Z2.TRD_CD         ," ).append("\n"); 
		query.append("                              Z2.SUB_TRD_CD     ," ).append("\n"); 
		query.append("                              Z2.RLANE_CD       ," ).append("\n"); 
		query.append("                              Z2.COST_WK        ," ).append("\n"); 
		query.append("                              Z2.VSL_CD         ," ).append("\n"); 
		query.append("                              Z2.SKD_VOY_NO     ," ).append("\n"); 
		query.append("                              Z2.SKD_DIR_CD     ," ).append("\n"); 
		query.append("                              Z2.IOC_CD         ," ).append("\n"); 
		query.append("                              O.N4TH_PRNT_OFC_CD," ).append("\n"); 
		query.append("                              Z2.USA_BKG_MOD    ," ).append("\n"); 
		query.append("                              Z2.POD_CD         , " ).append("\n"); 
		query.append("                              Z2.DEST_LOC_CD    ," ).append("\n"); 
		query.append("                              PRE_RLANE_CD      ," ).append("\n"); 
		query.append("                              PRE_REP_TRD_CD    ," ).append("\n"); 
		query.append("                              PRE_REP_SUB_TRD_CD," ).append("\n"); 
		query.append("                              NVL(Z2.PRE_VSL_CD , '0')," ).append("\n"); 
		query.append("                              Z2.PRE_SKD_VOY_NO ," ).append("\n"); 
		query.append("                              Z2.PRE_SKD_DIR_CD " ).append("\n"); 
		query.append("                              " ).append("\n"); 
		query.append("                    	      " ).append("\n"); 
		query.append("                   ) Z3" ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("                   " ).append("\n"); 
		query.append("         ) Z7" ).append("\n"); 
		query.append("GROUP BY Z7.ETB_DT        ," ).append("\n"); 
		query.append("         Z7.REP_TRD_CD    ," ).append("\n"); 
		query.append("         Z7.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("         Z7.TRD_CD        ," ).append("\n"); 
		query.append("         Z7.SUB_TRD_CD    ," ).append("\n"); 
		query.append("         Z7.RLANE_CD      ," ).append("\n"); 
		query.append("         Z7.COST_WK       ," ).append("\n"); 
		query.append("         Z7.VVD           ," ).append("\n"); 
		query.append("         Z7.IOC_CD        ," ).append("\n"); 
		query.append("         Z7.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("         Z7.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("         Z7.RK " ).append("\n"); 
		query.append("         " ).append("\n"); 
		query.append("ORDER BY Z7.ETB_DT        ," ).append("\n"); 
		query.append("         Z7.REP_TRD_CD    ," ).append("\n"); 
		query.append("         Z7.REP_SUB_TRD_CD," ).append("\n"); 
		query.append("         Z7.TRD_CD        ," ).append("\n"); 
		query.append("         Z7.SUB_TRD_CD    ," ).append("\n"); 
		query.append("         Z7.RLANE_CD      ," ).append("\n"); 
		query.append("         Z7.COST_WK       ," ).append("\n"); 
		query.append("         Z7.VVD           ," ).append("\n"); 
		query.append("         Z7.IOC_CD        ," ).append("\n"); 
		query.append("         Z7.SLS_RHQ_CD    ," ).append("\n"); 
		query.append("         Z7.SLS_RGN_OFC_CD," ).append("\n"); 
		query.append("		 Z7.RK" ).append("\n"); 

	}
}