<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TRIProposalDBDAOPriTriRtRateSurchageCmpbScgVOUSQL">
			<desc><![CDATA[ ]]></desc>
			<sql><![CDATA[
MERGE INTO PRI_TRI_RT RT
USING (
        SELECT SUM(ADJ_SCG_USD_AMT)  AS ADJ_SCG_AMT
                ,TRI_PROP_NO ,AMDT_SEQ 
        FROM PRI_TRI_RT_SCG
        WHERE   TRI_PROP_NO = @[tri_prop_no]
            AND AMDT_SEQ = @[amdt_seq]
        GROUP BY TRI_PROP_NO ,AMDT_SEQ
) SCG
ON (
        RT.TRI_PROP_NO               = SCG.TRI_PROP_NO
        AND RT.AMDT_SEQ          = SCG.AMDT_SEQ
)  
WHEN MATCHED THEN
        UPDATE SET 
                  RT.PRS_SCG_AMT        =  SCG.ADJ_SCG_AMT
                , RT.PRS_RESPB_CMPB_AMT =  SCG.ADJ_SCG_AMT + RT.PROP_FRT_RT_AMT - RT.PRS_RESPB_CM_UC_AMT
                , RT.PRS_PFIT_CMPB_AMT  =  SCG.ADJ_SCG_AMT + RT.PROP_FRT_RT_AMT - RT.PRS_PFIT_CM_UC_AMT
                , RT.PRS_RESPB_OPB_AMT  =  SCG.ADJ_SCG_AMT + RT.PROP_FRT_RT_AMT - RT.PRS_RESPB_OPFIT_UC_AMT
                , RT.UPD_USR_ID            =  @[upd_usr_id]
                , RT.UPD_DT                =  SYSDATE			]]></sql>
			<params>
				<param name="tri_prop_no" type="12" value="" out="N"/>
				<param name="amdt_seq" type="2" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
