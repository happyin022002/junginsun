<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TCharterIOConsultationDBDAOSearchInterfaceStatusListVORSQL">
			<desc><![CDATA[Invoice Interface Status]]></desc>
			<sql><![CDATA[
SELECT 	AH.CSR_NO, 
		AH.VNDR_NO VNDR_SEQ,
		(SELECT VNDR_CNT_CD FROM MDM_VENDOR WHERE VNDR_SEQ = AH.VNDR_NO) VNDR_CNT_CD, 
		AH.GL_DT EFF_DT, AH.CSR_CURR_CD, AH.CSR_AMT, AH.INV_DESC CSR_DESC
#if (${condition} == 'E')
        , AH.IF_ERR_RSN
#else
        , AH.RCV_ERR_RSN IF_ERR_RSN
#end

FROM 	AP_INV_HDR AH 
WHERE   EXISTS (SELECT 	NULL 
				FROM 	FMS_CONSULTATION FI
				WHERE   SUBSTR(AH.CSR_NO,1,2)  = FI.SLP_TP_CD
				AND		SUBSTR(AH.CSR_NO,3,1)  = FI.SLP_FUNC_CD
				AND		SUBSTR(AH.CSR_NO,4,6)  = FI.SLP_OFC_CD
				AND		SUBSTR(AH.CSR_NO,10,6) = FI.SLP_ISS_DT
				AND		SUBSTR(AH.CSR_NO,16,5) = FI.SLP_SER_NO
				AND     FI.APRO_FLG = 'Y'
                AND     NVL(FI.AP_CXL_FLG, 'N') = 'N')
#if (${condition} == 'E') 
	AND 	AH.IF_FLG = 'E'
#else
	AND 	AH.IF_FLG = 'Y' AND AH.RCV_ERR_FLG = 'E'
#end
AND AH.SRC_CTNT = 'CDAM'
--PDT 승인 결재로 인하여 삭제 민정호(201407)
--AND AH.TJ_OFC_CD  = slp_ofc_cd
#if (${search_csr_no} != '') 
	AND		AH.CSR_NO LIKE @[search_csr_no]||'%'
#end
#if (${fr_duration} != '') 
	AND 	AH.GL_DT >= REPLACE(@[fr_duration],'-','')
#end
#if (${to_duration} != '') 
	AND 	AH.GL_DT <= REPLACE(@[to_duration],'-','')
#end			]]></sql>
			<params>
				<param name="search_csr_no" type="12" value="" out="N"/>
				<param name="fr_duration" type="12" value="" out="N"/>
				<param name="to_duration" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
