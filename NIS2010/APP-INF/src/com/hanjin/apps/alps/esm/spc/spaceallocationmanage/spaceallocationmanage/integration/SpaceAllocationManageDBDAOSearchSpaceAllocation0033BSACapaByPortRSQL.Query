<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SpaceAllocationManageDBDAOSearchSpaceAllocation0033BSACapaByPortRSQL">
			<desc><![CDATA[SearchSpaceAllocation0033BSACapaByPort

2013.11.26 진마리아 [CHM-201326854] SAQ project로 인한 SPC 변경건_FNC 우선제거
2017.1.23 SM상선 전환에 따른 소스변경]]></desc>
			<sql><![CDATA[
SELECT DISTINCT
         A.PORT_BSA_CAPA AS CODE,
		 A.PORT_BSA_CAPA AS NAME
    FROM BSA_VVD_PORT_DWN A,
         MAS_LANE_RGST    B,
         (
            SELECT /*+ INDEX (P, XPKMAS_WK_PRD) */
                   P.COST_YR||P.COST_WK AS COST_YRWK
              FROM MAS_WK_PRD P
             WHERE P.SLS_FM_DT >= REPLACE(@[eff_fm_dt],'-','')
               AND P.SLS_TO_DT <= REPLACE(@[eff_to_dt],'-','')
         ) P,
         MAS_MON_VVD     M
   WHERE SUBSTR(M.SLS_YRMON, 1, 4)||M.COST_WK = P.COST_YRWK
     AND (M.DELT_FLG IS NULL OR M.DELT_FLG = 'N')
     AND SPC_GET_REP_TRD_FNC(M.RLANE_CD)   = @[rep_trd_cd]
     AND M.SUB_TRD_CD   = @[sub_trd_cd]
     AND M.RLANE_CD     = @[rlane_cd]
     --AND M.RLANE_CD    IN ('IMUAE','IMUTA','PSGIA','PSGTP')
     AND A.PORT_CD      = @[pol_cd]
     AND B.TRD_CD       = A.TRD_CD
     AND B.RLANE_CD     = A.RLANE_CD
     AND B.DIR_CD       = A.SKD_DIR_CD
     AND M.TRD_CD       = A.TRD_CD    
     AND M.RLANE_CD     = A.RLANE_CD  
     AND M.VSL_CD       = A.VSL_CD    
     AND M.SKD_VOY_NO   = A.SKD_VOY_NO
     AND M.DIR_CD       = A.SKD_DIR_CD
     AND A.BSA_OP_JB_CD = '007' 
     AND B.STUP_FLG     = 'Y'
     AND A.CRR_CD       = 'SML'
     AND A.PORT_CD     != 'XXXXX'
#if (${vvd} != '')                 
     AND M.VSL_CD       = NVL( SUBSTR(@[vvd],1,4) ,M.VSL_CD)      -- 변수처리
     AND M.SKD_VOY_NO   = NVL( SUBSTR(@[vvd],5,4) ,M.SKD_VOY_NO)  -- 변수처리
     AND M.DIR_CD       = NVL( SUBSTR(@[vvd],9,1),M.DIR_CD)         -- 변수처리
#end
     AND NOT (A.PORT_BSA_CAPA IS NULL OR A.PORT_BSA_CAPA = 0)
ORDER BY CODE			]]></sql>
			<params>
				<param name="eff_fm_dt" type="12" value="" out="N"/>
				<param name="eff_to_dt" type="12" value="" out="N"/>
				<param name="rep_trd_cd" type="12" value="" out="N"/>
				<param name="sub_trd_cd" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
