<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CommonDBDAOAddBkgSokeupCalcCSQL">
			<desc><![CDATA[AddBkgSokeupCalc]]></desc>
			<sql><![CDATA[
MERGE INTO COA_BKG_COST_CALC K USING
(
SELECT BKG_NO, COA_BAT_RMK, CRE_USR_ID 
FROM COA_BKG_RTRO_HIS 
WHERE BKG_NO IN (
#if($expVal.size() != 0)
	#foreach(${key} in ${expVal})
		#if($velocityCount < $expVal.size())
                            '${key}',
                        #else
                            '${key}'
        #end
    #end
#end
)
AND COA_BAT_SEQ = @[max_seq]
) B2
ON( K.BKG_NO = B2.BKG_NO)              
WHEN NOT MATCHED THEN
         INSERT
                (                
                        K.BKG_NO
                      , K.COA_BAT_CD
                      , K.COA_BAT_SEQ
                      , K.COA_BAT_DT
                      , K.COA_BAT_RMK
                      , K.COA_MNL_BAT_SEQ
                      , K.CRE_USR_ID
                      , K.CRE_DT
                      , K.UPD_USR_ID
                      , K.UPD_DT
                )
                VALUES
                (
                        B2.BKG_NO
                      , 'E' -- HARD CODING
                      , '2' -- HARD CODING
                      , SYSDATE
                      , B2.COA_BAT_RMK
                      , '0' -- HARD CODING
                      , B2.CRE_USR_ID
                      , SYSDATE
                      , B2.CRE_USR_ID
                      , SYSDATE            
                )			]]></sql>
			<params>
				<param name="max_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
