<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ModelManageDBDAOAddSmpMainHistoryCSQL">
			<desc><![CDATA[SMP history를 저장합니다.
[CHM-201322502-01] SPC 프로젝트 - 성수기 선복운영 개선을 위한 T/F추진
2014.02.04 [CHM-201428383-01] RFA 로직 추가
2014.11.13 [CHM-201432794] SMP 사용 편의기능 보완 요청
2014.11.13 박은주 [CHM-201432794] SMP 사용 편의기능 보완 요청(RHQ Add/DEL, OFC/Lane Load Guide가 0 인것들 일과 삭제, RHQ Load Guide 변경시 OFC Load Guide 배부로직 제거)]]></desc>
			<sql><![CDATA[
INSERT INTO SPC_MDL_CUST_REV_LANE_HIS (
    TRD_CD
  , COST_YRWK
  , VER_SEQ
  , MODI_SEQ
  , CUST_CNT_CD
  , CUST_SEQ
  , SC_NO
  , RFA_NO
  , SUB_TRD_CD
  , SLS_RHQ_CD
  , CTRT_OFC_CD
  , CUST_CTRL_CD
#if (${modi_usr_id} == '1') 
  , CUST_ADJ_QTY
  , OLD_CUST_ADJ_QTY
#elseif (${modi_usr_id} == '2')
  , SLS_RGN_OFC_CD
  , OLD_SLS_RGN_OFC_CD
  , SUB_TRD_ADJ_QTY
  , OLD_SUB_TRD_ADJ_QTY
#elseif (${modi_usr_id} == '3')
  , SLS_RGN_OFC_CD
  , OLD_SLS_RGN_OFC_CD
  , RLANE_CD
  , OLD_RLANE_CD
  , RLANE_ADJ_QTY
  , OLD_RLANE_ADJ_QTY
#elseif (${modi_usr_id} == '4')
  , SLS_RGN_OFC_CD
  , OLD_SLS_RGN_OFC_CD
  , RLANE_CD
  , OLD_RLANE_CD
  , SPC_CTRL_MDL_RMK
  , OLD_SPC_CTRL_MDL_RMK
#end
  , CNG_ITM_NM
  , MODI_USR_ID
  , MODI_GDT
  , MDL_ADD_FLG
  , DELT_FLG
  , CRE_USR_ID
  , CRE_DT
  , UPD_USR_ID
  , UPD_DT
) VALUES (
    @[trd_cd]
  , @[cost_yrwk]
  , @[ver_seq]
  , (SELECT NVL(MAX(MODI_SEQ)+1,1)
       FROM SPC_MDL_CUST_REV_LANE_HIS
      WHERE TRD_CD = @[trd_cd]
        AND COST_YRWK = @[cost_yrwk]
        AND VER_SEQ = @[ver_seq]
    )
  , @[cust_cnt_cd]
  , @[cust_seq]
  , @[sc_no]
  , @[rfa_no]
  , @[sub_trd_cd]
  , @[sls_rhq_cd]
  , @[ctrt_ofc_cd]
  , @[cust_ctrl_cd]
#if (${modi_usr_id} == '1') 
  , @[cust_adj_qty]
  , @[old_cust_adj_qty]
#elseif (${modi_usr_id} == '2')
  , @[sls_rgn_ofc_cd]
  , @[old_sls_rgn_ofc_cd]
  , @[sub_trd_adj_qty]
  , @[old_sub_trd_adj_qty]
#elseif (${modi_usr_id} == '3')
  , @[sls_rgn_ofc_cd]
  , @[old_sls_rgn_ofc_cd]
  , @[rlane_cd]
  , @[old_rlane_cd]
  , @[rlane_adj_qty]
  , @[old_rlane_adj_qty]
#elseif (${modi_usr_id} == '4')
  , @[sls_rgn_ofc_cd]
  , @[old_sls_rgn_ofc_cd]
  , @[rlane_cd]
  , @[old_rlane_cd]
  , @[spc_ctrl_mdl_rmk]
  , @[old_spc_ctrl_mdl_rmk]
#end

#if (${flg} == 'HO')
 #if (${cng_itm_nm} == 'REUSE') 
  , 'OFC REUSE'
 #else 
  #if(${g1_cng_usr} != '' &&  ${mdl_add_flg} != '')
  , 'RHQ'
  #elseif(${g1_cng_usr} != '')
  , 'RHQ Guide'
  #elseif(${g2_cng_usr} !='' && ${mdl_add_flg} != '')
  , 'OFC'
  #elseif(${g2_cng_usr} !='')
  , 'OFC Guide'
  #elseif(${g2_cng_usr} == 'AUTO')
  , 'AUTO'
  #else
  , ''
  #end
 #end
#elseif (${flg} == 'RHQ') 
 #if (${cng_itm_nm} == 'REUSE') 
  , 'LANE REUSE'
 #else
  #if(${mdl_add_flg} != '')
  , 'LANE'
  #elseif(${g3_cng_usr} == 'USER')
  , 'LANE Guide'
  #else
  , ''
  #end
 #end
#elseif (${modi_usr_id} == '4')
  , 'REMARK'
#else
  , ''
#end
  , DECODE(@[flg], 'HO', DECODE(@[modi_usr_id], '1', DECODE(@[g1_cng_usr], 'USER', @[cre_usr_id], 'SYSTEM'), DECODE(@[g2_cng_usr], 'USER', @[cre_usr_id], @[g2_cng_usr]))
                 , 'RHQ', DECODE(@[modi_usr_id], '3', @[cre_usr_id], 'SYSTEM')
                 , 'LOFC', DECODE(@[modi_usr_id], '4', @[cre_usr_id], 'SYSTEM'))
  , CAST(SYS_EXTRACT_UTC(TO_TIMESTAMP(@[modi_gdt], 'YYYY/MM/DD HH24:MI:SS')) AS DATE)
  , @[mdl_add_flg]
  , 'N'
  , @[cre_usr_id]
  , SYSDATE
  , @[cre_usr_id]
  , SYSDATE
)			]]></sql>
			<params>
				<param name="trd_cd" type="12" value="" out="N"/>
				<param name="cost_yrwk" type="12" value="" out="N"/>
				<param name="ver_seq" type="12" value="" out="N"/>
				<param name="cust_cnt_cd" type="12" value="" out="N"/>
				<param name="cust_seq" type="12" value="" out="N"/>
				<param name="sc_no" type="12" value="" out="N"/>
				<param name="rfa_no" type="12" value="" out="N"/>
				<param name="sub_trd_cd" type="12" value="" out="N"/>
				<param name="sls_rhq_cd" type="12" value="" out="N"/>
				<param name="ctrt_ofc_cd" type="12" value="" out="N"/>
				<param name="cust_ctrl_cd" type="12" value="" out="N"/>
				<param name="cust_adj_qty" type="12" value="" out="N"/>
				<param name="old_cust_adj_qty" type="12" value="" out="N"/>
				<param name="sls_rgn_ofc_cd" type="12" value="" out="N"/>
				<param name="old_sls_rgn_ofc_cd" type="12" value="" out="N"/>
				<param name="sub_trd_adj_qty" type="12" value="" out="N"/>
				<param name="old_sub_trd_adj_qty" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="old_rlane_cd" type="12" value="" out="N"/>
				<param name="rlane_adj_qty" type="12" value="" out="N"/>
				<param name="old_rlane_adj_qty" type="12" value="" out="N"/>
				<param name="spc_ctrl_mdl_rmk" type="12" value="" out="N"/>
				<param name="old_spc_ctrl_mdl_rmk" type="12" value="" out="N"/>
				<param name="flg" type="12" value="" out="N"/>
				<param name="modi_usr_id" type="12" value="" out="N"/>
				<param name="g1_cng_usr" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="g2_cng_usr" type="12" value="" out="N"/>
				<param name="modi_gdt" type="12" value="" out="N"/>
				<param name="mdl_add_flg" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
