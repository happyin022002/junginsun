<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TCharterIOInquiryDBDAOSearchRfStatusPortCdListRSQL">
			<desc><![CDATA[VVD로 RF 상태를 상세 조회 할 Port를 조회한다.]]></desc>
			<sql><![CDATA[
WITH SKD AS (
    SELECT 
      S.VPS_PORT_CD 	AS port,
      S.CLPT_IND_SEQ 	AS indicator,
      S.YD_CD 			AS yard
      ,DECODE(P.CHK_MTY_PLN_FLG, 'Y', 'E', 'F') AS PLANTYPE
      ,S.CLPT_SEQ
    FROM 
      VSK_VSL_PORT_SKD S,
      STO_PLN_VSL_PORT_SKD P
    WHERE S.VSL_CD = SUBSTR(@[vvd], 1, 4)
      AND S.SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
      AND S.SKD_DIR_CD = SUBSTR(@[vvd], 9, 1)
      AND S.TURN_PORT_IND_CD <> 'V'
      AND S.TURN_PORT_IND_CD <> 'F'
      AND S.TURN_PORT_IND_CD <> 'D'
      AND (S.SKD_CNG_STS_CD IS NULL OR S.SKD_CNG_STS_CD <> 'S')
      AND S.VPS_PORT_CD <> 'PAPAC'
      AND S.VPS_PORT_CD <> 'EGSUZ'
      AND S.VSL_CD = P.VSL_CD
      AND S.SKD_VOY_NO = P.SKD_VOY_NO
      AND S.SKD_DIR_CD = P.SKD_DIR_CD
      AND S.VPS_PORT_CD = P.VPS_PORT_CD
      AND S.CLPT_IND_SEQ = P.CLPT_IND_SEQ
	  AND (P.CHK_FNL_PLN_FLG = 'Y' OR P.CHK_MTY_PLN_FLG = 'Y')
)
SELECT 
  S.port,
  S.indicator,
  S.yard
  ,NVL(LAG(S.PLANTYPE,1) OVER (ORDER by S.CLPT_SEQ),'F') AS preplantype
FROM SKD S
ORDER BY S.CLPT_SEQ			]]></sql>
			<params>
				<param name="vvd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
