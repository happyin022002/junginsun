<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="Jp24ManifestListDownloadDBDAOSearchBkgBookingRSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
SELECT BL_NO,
       POR_CD,
       POL_CD,
       DEL_CD,
       BB_CGO_FLG,
	   PCK_QTY,
       PCK_TP_CD,
       CASE
          WHEN ACT_WGT > 999999.999
             THEN ROUND(ACT_WGT * 0.001, 3)
          ELSE ACT_WGT
       END AS ACT_WGT,
       CASE
          WHEN ACT_WGT > 999999.999
             THEN 'TNE'
          ELSE KGS
       END AS KGS,
       MEAS_QTY,
       CBM,
       RCV_TERM_CD,
       DE_TERM_CD,
       DCGO_FLG,
       BDR_FLG,
       BRD_DT,
       BDR_CNG_FLG,
       CMDT_CD,
       BKG_CGO_TP_CD,
       POD_CD,
       BKG_CGO_TP_CD2,
       UN_NO,
       CLSS_CD

 FROM
       (SELECT A.BL_NO,
               A.POR_CD,
               A.POL_CD,
               A.DEL_CD,
               A.BB_CGO_FLG,
			   B.PCK_QTY,
               B.PCK_TP_CD,
               DECODE(B.WGT_UT_CD, 'LBS', B.ACT_WGT*0.4536, NVL(B.ACT_WGT, 0)) AS ACT_WGT,
               'KGS' AS KGS,
               DECODE(B.MEAS_UT_CD, 'CBF', B.MEAS_QTY*0.0283, NVL(B.MEAS_QTY, 0)) AS MEAS_QTY,
               'CBM' AS CBM,
               A.RCV_TERM_CD,
               A.DE_TERM_CD,
               A.DCGO_FLG,
               B.BDR_FLG,
               TO_CHAR(B.BDR_DT, 'YYYYMMDDHH24MISS') AS BRD_DT,
               B.BDR_CNG_FLG,
               A.CMDT_CD,
               DECODE(A.BKG_CGO_TP_CD, 'P', 'M', 'R', 'M', 'F') AS BKG_CGO_TP_CD,
               A.POD_CD,
               DECODE(A.BKG_CGO_TP_CD, 'P', 'M', 'F') AS BKG_CGO_TP_CD2,
       (
        select /*+ INDEX_DESC(DG XPKBKG_DG_CGO) */
          IMDG_UN_NO
        from BKG_DG_CGO DG
        where bkg_no = @[bkg_no]
          and IMDG_UN_NO is not null
          and rownum = 1) AS UN_NO,
       (
        select /*+ INDEX_DESC(DG XPKBKG_DG_CGO) */
          IMDG_CLSS_CD
        from BKG_DG_CGO DG
        where bkg_no = @[bkg_no]
          and IMDG_UN_NO is not null
          and rownum = 1) AS CLSS_CD

          FROM BKG_BOOKING A,
               BKG_BL_DOC B

         WHERE A.BKG_NO = @[bkg_no]
           AND A.BKG_NO = B.BKG_NO
           AND ROWNUM = 1
       )			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
