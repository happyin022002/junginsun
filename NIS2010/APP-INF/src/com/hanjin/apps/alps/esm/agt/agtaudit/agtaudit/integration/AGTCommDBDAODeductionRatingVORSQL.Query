<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AGTCommDBDAODeductionRatingVORSQL">
			<desc><![CDATA[ESM_AGT_0012  화면의 Rating 정보 조회]]></desc>
			<sql><![CDATA[
SELECT 
	DISTINCT A.CHG_CD AS CHG_CD,
       A.CURR_CD CURR_CD,
       ROUND(A.CHG_UT_AMT, 2) AS CHG_UT_AMT,
       A.RAT_AS_QTY AS RAT_AS_QTY,
       A.RAT_UT_CD AS RAT_UT_CD,
       ROUND(A.CHG_AMT, 2) AS CHG_AMT,
       ROUND(A.CHG_AMT/DECODE(A.CURR_CD, 'USD', 1, NVL(C.USD_LOCL_XCH_RT, 0)), 2) AS CHG_AMT_RT,
       A.FRT_INCL_XCLD_DIV_CD AS INCL_OFT_FLG,
       NVL(A.N3PTY_CUST_CNT_CD, ' ')||REPLACE(TO_CHAR(A.N3PTY_CUST_SEQ, 'FM000000'), '000000', ' ') AS CUST_PAYER,
       A.CGO_CATE_CD AS CGO_CATE_CD ,
       A.RCV_TERM_CD AS RCV_TERM_CD,
       A.DE_TERM_CD AS DE_TERM_CD,
       A.RT_SEQ AS RT_SEQ
FROM   BKG_CHG_RT A,
       AGT_AGN_COMM B,
       GL_MON_XCH_RT C
WHERE  B.BKG_NO = @[bkg_no]
AND NVL(A.FRT_INCL_XCLD_DIV_CD,'N') = 'N'
AND    A.BKG_NO = B.BKG_NO
AND    B.AGN_CD = @[agn_cd]
AND    B.IO_BND_CD = @[io_bnd_cd]
AND    B.AC_TP_CD <> 'T'
AND    B.AC_SEQ = @[ac_seq]
AND    C.ACCT_XCH_RT_YRMON = DECODE(SIGN(TO_DATE(SUBSTR(NVL(B.SAIL_ARR_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), 1, 6), 'YYYYMM') - SYSDATE), 1, TO_CHAR(SYSDATE, 'YYYYMM'), SUBSTR(NVL(B.SAIL_ARR_DT, TO_CHAR(SYSDATE, 'YYYYMMDD')), 1, 6) )
AND    C.ACCT_XCH_RT_LVL = '1'
AND    A.CURR_CD = C.CURR_CD
ORDER BY A.RT_SEQ			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="Y"/>
				<param name="agn_cd" type="12" value="" out="Y"/>
				<param name="io_bnd_cd" type="12" value="" out="Y"/>
				<param name="ac_seq" type="12" value="" out="Y"/>
			</params>
		</query>
	</querys>
</sqls>
