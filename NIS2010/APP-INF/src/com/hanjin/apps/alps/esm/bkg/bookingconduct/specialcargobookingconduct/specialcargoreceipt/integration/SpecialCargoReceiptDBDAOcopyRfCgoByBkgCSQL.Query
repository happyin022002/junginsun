<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SpecialCargoReceiptDBDAOcopyRfCgoByBkgCSQL">
			<desc><![CDATA[copyRfCgoByBkg]]></desc>
			<sql><![CDATA[
INSERT INTO BKG_RF_CGO(BKG_NO
        , RC_SEQ
        , CNTR_TPSZ_CD
        , CNTR_NO
        , PCK_TP_CD
        , PCK_QTY
        , NET_WGT
        , GRS_WGT
        , WGT_UT_CD
        , CMDT_CD
        , CMDT_DESC
#if(${copy_mode_cd} != 'C')
        , FDO_TEMP
        , CDO_TEMP
#end
        , CNTR_VENT_TP_CD
        , VENT_RTO
        , HUMID_NO
        , DIFF_RMK
        , RF_DCGO_SEQ
        , PWR_SPL_CBL_FLG
        , VLTG_NO
        , CTRL_ATMS_FLG
        , MODI_ATMS_FLG
        , HUMID_CTRL_FLG
        , CNTR_DRN_CD
        , CLNG_TP_CD
#if(${copy_mode_cd} != 'C')
        , RQST_DT
        , RQST_USR_ID
        , SPCL_CGO_APRO_CD
#end
        , CRE_USR_ID
        , CRE_DT
        , UPD_USR_ID
        , UPD_DT
        , CNTR_VOL_QTY
        , CBM_PER_HR_QTY
        , ATFC_ATMS_FLG)
SELECT @[mst_bkg_no] BKG_NO
		,(SELECT /*+index_desc (bkg_rf_cgo XPKBKG_RF_CGO)*/
					NVL(SUM(RC_SEQ),0)+RF.RC_SEQ
					FROM BKG_RF_CGO 
					WHERE RC_SEQ >= 0
					AND ROWNUM <= 1
					AND BKG_NO = @[mst_bkg_no]) RC_SEQ
        , CNTR_TPSZ_CD
        , CNTR_NO
        , PCK_TP_CD
        , PCK_QTY
        , NET_WGT
        , GRS_WGT
        , WGT_UT_CD
        , CMDT_CD
        , CMDT_DESC
#if(${copy_mode_cd} != 'C')
        , FDO_TEMP
        , CDO_TEMP
#end
        , CNTR_VENT_TP_CD
        , VENT_RTO
        , HUMID_NO
        , DIFF_RMK
        , RF_DCGO_SEQ
        , PWR_SPL_CBL_FLG
        , VLTG_NO
        , CTRL_ATMS_FLG
        , MODI_ATMS_FLG
        , HUMID_CTRL_FLG
        , CNTR_DRN_CD
        , CLNG_TP_CD
#if(${copy_mode_cd} != 'C')
        , RQST_DT
        , RQST_USR_ID
        , SPCL_CGO_APRO_CD
#end
        , @[usr_id] CRE_USR_ID
        , SYSDATE
        , @[usr_id] UPD_USR_ID
        , SYSDATE
        , nvl((select cntr.CNTR_VOL_QTY 
                 from bkg_container cntr 
                where cntr.bkg_no  = @[mst_bkg_no]
                  and cntr.cntr_no = rf.cntr_no), 1)
        , CBM_PER_HR_QTY
        , ATFC_ATMS_FLG
  FROM BKG_RF_CGO RF
 WHERE BKG_NO = @[bkg_no]
   AND (CNTR_NO IS NULL
		OR 
		CNTR_NO NOT IN (SELECT NVL(CNTR_NO, 'X')
                         FROM BKG_RF_CGO
						WHERE BKG_NO = @[mst_bkg_no])
		)			]]></sql>
			<params>
				<param name="mst_bkg_no" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
