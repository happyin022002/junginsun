<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BLIssuanceDBDAOSearchBlIssInfoRSQL">
			<desc><![CDATA[B/L Issue 정보 조회]]></desc>
			<sql><![CDATA[
SELECT 
    M.BKG_NO ,
    BL_NO||DECODE(BL_TP_CD,'W','W',DECODE(SURRENDER, 'Y', 'S', '')) AS BL_NO,
    TVVD ,
    BKG_STS ,
    BDR ,
    SHPR_NAME ,
    SHPR_ADDRESS ,
    SHPR_CNT_CD ,
    SHPR_SEQ ,
    F_FWD_NAME ,
    F_FWD_ADDRESS ,
    VESSEL_DIRECTION ,
    PRE_CARRIAGE_BY ,
    NVL(POR_CODE, NPOR_CODE) AS POR_CODE ,
    NVL(POR_NAME, NPOR_NAME) AS POR_NAME,  
    NVL(POL_CODE, NPOL_CODE) AS POL_CODE ,
    NVL(POL_NAME, NPOL_NAME) AS POL_NAME ,
    NVL(POD_CODE, NPOD_CODE) AS POD_CODE ,
    NVL(POD_NAME, NPOD_NAME) AS POD_NAME ,
    NVL(DEL_CODE, NDEL_CODE) AS DEL_CODE ,
    NVL(DEL_NAME, NDEL_NAME) AS DEL_NAME,    
    MOVE_TYPE ,
    FINAL_DEST ,
    PPD_CONFIRM ,
    TRD_PPD_CONFIRM ,
    CCT_CONFIRM ,
    TRD_CCT_CONFIRM ,
    BL_READY_CHECKBOX ,
    BL_READY_BY ,
    TO_CHAR(BL_READY_DATE, 'YYYY-MM-DD') BL_READY_DATE ,
    BL_READY_OFFICE ,
    BL_READY_TYPE ,  
    ON_BOARD_TYPE ,
    TO_CHAR(ON_BOARD_DATE, 'YYYY-MM-DD') ON_BOARD_DATE ,
    
    BL_PROOFBYSHIPPER_CHECKBOX,
    BL_PROOFBYSHIPPER_OFFICE,
    BL_PROOFBYSHIPPER_BY,
    BL_PROOFBYSHIPPER_DATE,
    (SELECT CNTC_PSON_EML FROM BKG_CNTC_PSON WHERE BKG_NO= @[bkg_no] AND BKG_CNTC_PSON_TP_CD = 'BL') AS CNTC_PSON_EML,
    
    BL_ISSUEBL_TYPE ,
    BL_ISSUE_NO ,
    TO_CHAR(BL_ISSUE_DATE, 'YYYY-MM-DD') BL_ISSUE_DATE ,
    BL_ISSUE_RELEASE ,
    BL_ISSUE_AT ,
    BL_ISSUE_BY ,
    ISSUED ,
    RELEASED ,
    CUST_TO_ORD_FLG ,
    DECODE(ORG_PPD_RCV_UPD_OFC_CD,null,   
                                	(
                                     SELECT PPD_RCV_OFC_CD
                                     FROM BKG_RATE
                                     WHERE BKG_NO= @[bkg_no]),
         ORG_PPD_RCV_UPD_OFC_CD ) PPD_RCV_USER_OFFICE ,
    PPD_RCV_USER_ID ,
    PPD_RCV_DT ,
    DECODE(ORG_N3PTY_PPD_UPD_OFC_CD,null, 
                                  (
                                    SELECT N3PTY_RCV_OFC_CD
                                    FROM BKG_CHG_RT
                                    WHERE BKG_NO= @[bkg_no]
                                      AND FRT_TERM_CD = 'P'
                                	  AND N3PTY_RCV_OFC_CD IS NOT NULL
                                      AND ROWNUM =1),
        ORG_N3PTY_PPD_UPD_OFC_CD) TRD_PPD_RCV_USER_OFFICE ,
    TRD_PPD_RCV_USER_ID ,
    TRD_PPD_RCV_DT ,
    DECODE(DEST_CLT_RCV_UPD_OFC_CD,null, 
                                	(
                                    SELECT CLT_OFC_CD
                                    FROM BKG_RATE
                                    WHERE BKG_NO= @[bkg_no]),
        DEST_CLT_RCV_UPD_OFC_CD) CCT_RCV_USER_OFFICE ,
    CCT_RCV_USER_ID ,
    CCT_RCV_DT ,
    DECODE(DEST_N3PTY_CLT_UPD_OFC_CD,null, 
                                    	(
                                        SELECT N3PTY_RCV_OFC_CD
                                        FROM BKG_CHG_RT
                                        WHERE BKG_NO= @[bkg_no]
                                          AND FRT_TERM_CD = 'C'
                                    	  AND N3PTY_RCV_OFC_CD IS NOT NULL
                                          AND ROWNUM =1),
        DEST_N3PTY_CLT_UPD_OFC_CD) TRD_CCT_RCV_USER_OFFICE ,
    TRD_CCT_RCV_USER_ID ,
    TRD_CCT_RCV_DT ,
    NVL(O_BLRECEIVE_TYPE, DECODE(NVL(O_BLRECEIVE_AT, '*'), '*', BL_ISSUEBL_TYPE, NVL(BL_ISSUEBL_TYPE, 'B'))) AS O_BLRECEIVE_TYPE ,
    O_BLRECEIVE_NO ,
    TO_CHAR(O_BLRECEIVE_DATE, 'YYYY-MM-DD') O_BLRECEIVE_DATE ,
    O_BLRECEIVE_AT ,
    O_BLRECEIVE_BY ,
    SURRENDER ,
    DO_ISSUE_NO ,
    TO_CHAR(DO_ISSUE_DATE, 'YYYY-MM-DD') DO_ISSUE_DATE ,
    DO_ISSUE_AT ,
    DO_ISSUE_BY ,
    PRINT_OPTION ,
    DOC_REQUEST_FLAG ,
    INTERNET_AUTH ,
    OBL_PRN_FLG ,
    TO_CHAR(POL_ETD_DT, 'YYYY-MM-DD') POL_ETD_DT ,
    TO_CHAR(C.CGO_RCV_DT, 'YYYY-MM-DD') CGO_RCV_DT,
    CASE WHEN (
    SELECT COUNT(BKG_NO)
    FROM BKG_CHG_RT
    WHERE BKG_NO=M.BKG_NO) > 0
    OR (
    SELECT COUNT(BKG_NO)
    FROM BKG_RATE
    WHERE BKG_NO = M.BKG_NO
      AND RT_BL_TP_CD IN ('C', 'B')) > 0
    OR (
    SELECT COUNT(BKG_NO)
    FROM BKG_BOOKING
    WHERE BKG_NO = M.BKG_NO
      AND CHN_AGN_CD IS NOT NULL) > 0 THEN 'Y' ELSE 'N' END FLG_RATE ,
    CASE WHEN (
    SELECT COUNT(BKG_NO)
    FROM BKG_BL_MK_DESC
    WHERE BKG_NO=M.BKG_NO
      AND CMDT_DESC IS NOT NULL) > 0 THEN 'Y' ELSE 'N' END FLG_MD ,
    PPD_CONFIRM AS FLG_PPD ,
    TRD_PPD_CONFIRM AS TRD_FLG_PPD ,
    CUST_TO_ORD_FLG AS FLG_TO_ORDER ,
    CASE WHEN DO_ISSUE_NO != ' ' THEN 'Y' ELSE 'N' END FLG_DO,
    OBL_ISS_RMK
	, BL_HLD_FLG
	, BL_HLD_RSN_CD
	, BL_HLD_DT
    , TO_CHAR(BL_HLD_DT, 'YYYY-MM-DD') BL_HLD_DT
	, BL_HLD_USR_ID
	, POD_NOD_CD
    , DEL_NOD_CD
    , POR_NOD_CD
    , WBL_EML
    , WBL_RT_TP_CD   
    ,CASE WHEN  CERTI_RQST_CNT = 0 AND CERTI_CMPL_CNT > 0  AND CERTI_ATCH_FLG != 'Y' THEN 'G'
          WHEN  CERTI_RQST_CNT = 0 AND CERTI_CMPL_CNT = 0  AND CERTI_ATCH_FLG != 'Y' THEN 'X'
          ELSE 'R' 
     END AS IMG_FLG
    ,CASE WHEN  WEB_CUST_AUTH_FLAG = 'ON' AND AUTH_FLAG = 'Y' THEN 'Y'
          ELSE 'N' 
     END AS AUTH_FLAG
FROM (
    SELECT 
            BL.BKG_NO AS BKG_NO ,
            BL.BDR_FLG AS BDR ,
            BL.VSL_NM AS VESSEL_DIRECTION ,
            BL.PRE_VSL_NM AS PRE_CARRIAGE_BY ,
            BL.POR_CD AS POR_CODE ,
            BL.POR_NM AS POR_NAME ,
            BL.POL_CD AS POL_CODE ,
            BL.POL_NM AS POL_NAME ,
            BL.POD_CD AS POD_CODE ,
            BL.POD_NM AS POD_NAME ,
            BL.DEL_CD AS DEL_CODE ,
            BL.DEL_NM AS DEL_NAME ,
            BL.BL_MV_TP_NM AS MOVE_TYPE ,
            BL.FNL_DEST_NM AS FINAL_DEST ,
            ISS.ORG_PPD_RCV_CD AS PPD_CONFIRM ,
            ISS.ORG_N3PTY_PPD_CD AS TRD_PPD_CONFIRM ,
            ISS.DEST_CLT_RCV_CD AS CCT_CONFIRM ,
            ISS.DEST_N3PTY_CLT_CD AS TRD_CCT_CONFIRM ,
            ISS.BL_RDY_FLG AS BL_READY_CHECKBOX ,
            ISS.BL_RDY_USR_ID AS BL_READY_BY ,
            ISS.BL_RDY_DT AS BL_READY_DATE ,
            ISS.BL_RDY_OFC_CD AS BL_READY_OFFICE ,
            ISS.BL_RDY_TP_CD AS BL_READY_TYPE ,
            ISS.ORG_PPD_RCV_UPD_OFC_CD,
            ISS.ORG_N3PTY_PPD_UPD_OFC_CD,
            ISS.DEST_CLT_RCV_UPD_OFC_CD,
            ISS.DEST_N3PTY_CLT_UPD_OFC_CD,
            BL.BL_OBRD_TP_CD AS ON_BOARD_TYPE ,
            BL.BL_OBRD_DT AS ON_BOARD_DATE ,
            ISS.BL_CPY_KNT AS BL_ISSUE_NO ,
            ISS.OBL_ISS_DT AS BL_ISSUE_DATE ,
            ISS.OBL_RLSE_FLG AS BL_ISSUE_RELEASE ,
            ISS.OBL_ISS_OFC_CD AS BL_ISSUE_AT ,
            ISS.OBL_ISS_USR_ID AS BL_ISSUE_BY ,
            ISS.OBL_ISS_FLG AS ISSUED ,
            ISS.OBL_RLSE_FLG AS RELEASED ,
            ISS.ORG_PPD_RCV_UPD_USR_ID AS PPD_RCV_USER_ID ,
            ISS.ORG_PPD_RCV_UPD_DT AS PPD_RCV_DT ,
            ISS.ORG_N3PTY_PPD_UPD_USR_ID AS TRD_PPD_RCV_USER_ID ,
            ISS.ORG_N3PTY_PPD_UPD_DT AS TRD_PPD_RCV_DT ,
            ISS.DEST_CLT_RCV_UPD_USR_ID AS CCT_RCV_USER_ID ,
            ISS.DEST_CLT_RCV_UPD_DT AS CCT_RCV_DT ,
            ISS.DEST_N3PTY_CLT_UPD_USR_ID AS TRD_CCT_RCV_USER_ID ,
            ISS.DEST_N3PTY_CLT_UPD_DT AS TRD_CCT_RCV_DT ,
            CASE WHEN ISS.OTR_DOC_CGOR_FLG = 'Y' THEN 'L' ELSE BKG.BL_TP_CD END O_BLRECEIVE_TYPE ,
            ISS.OBL_RDEM_KNT AS O_BLRECEIVE_NO ,
            CASE WHEN ISS.OTR_DOC_CGOR_FLG = 'Y' THEN ISS.OTR_DOC_RCV_DT ELSE ISS.OBL_RDEM_DT END O_BLRECEIVE_DATE ,
            CASE WHEN ISS.OTR_DOC_CGOR_FLG = 'Y' THEN ISS.OTR_DOC_RCV_OFC_CD ELSE ISS.OBL_RDEM_OFC_CD END O_BLRECEIVE_AT ,
            CASE WHEN ISS.OTR_DOC_CGOR_FLG = 'Y' THEN ISS.OTR_DOC_RCV_USR_ID ELSE ISS.OBL_RDEM_USR_ID END O_BLRECEIVE_BY ,
            ISS.OBL_SRND_FLG AS SURRENDER ,
            ISS.BL_PRF_SHPR_FLG AS BL_PROOFBYSHIPPER_CHECKBOX,
            ISS.BL_PRF_SHPR_OFC_CD AS BL_PROOFBYSHIPPER_OFFICE,
            ISS.BL_PRF_SHPR_USR_ID AS BL_PROOFBYSHIPPER_BY,
            ISS.OBL_ISS_RMK,
            TO_CHAR(ISS.BL_PRF_SHPR_DT, 'YYYY-MM-DD') BL_PROOFBYSHIPPER_DATE ,
            (SELECT DOT_PRN_FLG
               FROM BKG_USR_DFLT_SET
              WHERE USR_ID = @[usr_id] ) AS PRINT_OPTION ,
            CASE WHEN ISS.RQST_BL_TP_CD != NULL THEN 'Y' 
                 WHEN ISS.OBL_RT_INCL_KNT != NULL THEN 'Y' 
                 WHEN ISS.OBL_RT_XCLD_KNT != NULL THEN 'Y' 
                 WHEN ISS.OBL_TTL_KNT != NULL THEN 'Y' 
                 WHEN ISS.NON_NEGO_RT_INCL_KNT != NULL THEN 'Y' 
                 WHEN ISS.NON_NEGO_RT_XCLD_KNT != NULL THEN 'Y' 
                 WHEN ISS.CPY_TTL_KNT != NULL THEN 'Y' 
                 WHEN ISS.RQST_ISS_PLC_NM != NULL THEN 'Y' 
                 WHEN ISS.RQST_ISS_DT != NULL THEN 'Y' 
                 WHEN ISS.BL_DE_TO_CD != NULL THEN 'Y' 
                 WHEN ISS.BL_DE_MZD_CD != NULL THEN 'Y' 
                 WHEN ISS.BL_DOC_RQST_RMK != NULL THEN 'Y' 
             ELSE 'N' END DOC_REQUEST_FLAG ,
            NVL((SELECT 
				 CASE WHEN NVL(INET_AUTH_LMT_FLG,'N') = 'Y' THEN 'Y'
		              WHEN NVL(INET_AUTH_LMT_FLG,'N') = 'N' AND (SELECT COUNT(1) FROM BKG_INET_BL_PRN_AUTH AUTH WHERE BKG_NO = @[bkg_no] AND (AUTH_DT IS NOT NULL OR AUTH_OFC_CD > ' ')) < 3 THEN 'Y'
                 ELSE 'N'
	             END AUTH_FLAG
                FROM BKG_INET_AUTH
                WHERE USR_ID= @[usr_id] AND DELT_FLG='N'),'N') AUTH_FLAG ,
            NVL((SELECT 'ON'
                  FROM BKG_CUSTOMER CUS
                 WHERE CUS.BKG_NO = @[bkg_no]
                   AND CUS.BKG_CUST_TP_CD IN ('S','N','F','C')
                   AND EXISTS (SELECT 'Y'
                                 FROM BKG_WEB_OBL_AUTH_CUST A1
                                     ,MDM_CUSTOMER A2
                                WHERE A1.DELT_FLG = 'N'
                                  AND A1.CUST_CNT_CD = A2.CUST_CNT_CD
                                  AND A1.CUST_SEQ = A2.CUST_SEQ
                                  AND A2.SLS_DELT_EFF_DT IS NULL
                                  AND ((A1.CUST_CNT_CD = CUS.CUST_CNT_CD
                                  AND A1.CUST_SEQ = CUS.CUST_SEQ)
                                   OR  (A1.ATTY_CUST_CNT_CD = CUS.CUST_CNT_CD
                                  AND A1.ATTY_CUST_SEQ = CUS.CUST_SEQ
                                  AND A1.ATTY_CUST_CNT_CD IS NOT NULL))
                                  AND ROWNUM = 1)
                   AND ROWNUM = 1),(SELECT ATTR_CTNT2 
                                                      FROM BKG_HRD_CDG_CTNT 
                                                     WHERE HRD_CDG_ID = 'BKG_VALIDATION'  
                                                       AND ATTR_CTNT1 = 'BKG_INET_AUTH')) WEB_CUST_AUTH_FLAG,
            ISS.OBL_INET_FLG AS INTERNET_AUTH ,
            DECODE(INET_FLG, 'Y', 'Y', ISS.OBL_PRN_FLG) OBL_PRN_FLG 
            , ISS.BL_HLD_FLG
            , ISS.BL_HLD_RSN_CD
            , ISS.BL_HLD_DT
            , ISS.BL_HLD_USR_ID
            , ISS.WBL_EML
            , ISS.WBL_RT_TP_CD
			, BKG.POD_NOD_CD
			, BKG.DEL_NOD_CD
            , BKG.POR_NOD_CD
            , NVL((SELECT 'Y' FROM BKG_IMG_STO K WHERE K.BKG_NO = BKG.BKG_NO AND K.RIDR_TP_CD = 'K' AND ROWNUM =1 ),'N') AS CERTI_ATCH_FLG
            ,(SELECT count(*) FROM BKG_BL_CERTI K WHERE K.BL_NO = BKG.BL_NO AND K.BL_CERTI_STS_CD in ('I') AND K.TMPLT_FLG = 'N') AS CERTI_RQST_CNT
            ,(SELECT count(*) FROM BKG_BL_CERTI K WHERE K.BL_NO = BKG.BL_NO AND K.BL_CERTI_STS_CD = 'C' AND K.TMPLT_FLG = 'N') AS CERTI_CMPL_CNT
        FROM BKG_BL_DOC BL,
          	 BKG_BL_ISS ISS,
    		 BKG_BOOKING BKG,
    		 (SELECT BKG.BKG_NO, DECODE(NVL(INET.BKG_NO, '*'), '*', 'N', 'Y') INET_FLG
              FROM BKG_BOOKING BKG,
                    (SELECT BKG_NO, MAX(INFO_SEQ) INFO_SEQ
                       FROM BKG_INET_BL_PRN_AUTH
                     WHERE BKG_NO = @[bkg_no]
                       AND DELT_FLG = 'N'
                       AND N1ST_PRN_DT IS NOT NULL
                     GROUP BY BKG_NO) INET
              WHERE BKG.BKG_NO = @[bkg_no]
                AND BKG.BKG_NO = INET.BKG_NO(+)
              ) AUTH
        WHERE BKG.BKG_NO = BL.BKG_NO
    	  AND BL.BKG_NO = ISS.BKG_NO(+)
          AND BL.BKG_NO = @[bkg_no]
          AND BKG.BKG_NO = AUTH.BKG_NO ) M ,
        (
        SELECT *
        FROM (
            SELECT BKG_NO ,
              BL_NO ,
    		  BL_TP_CD ,
              VSL_CD || SKD_VOY_NO || SKD_DIR_CD AS TVVD ,
              BKG_STS_CD AS BKG_STS ,
              BL_TP_CD AS BL_ISSUEBL_TYPE ,
              POR_CD AS NPOR_CODE,
              CUST_TO_ORD_FLG ,
              (
                SELECT NVL((SELECT ATTR_CTNT2 FROM BKG_HRD_CDG_CTNT WHERE HRD_CDG_ID = 'YARD_NM_CONV' AND ATTR_CTNT1 = POR_NOD_CD AND ATTR_CTNT3 = '2'),LOC_NM)
                FROM MDM_LOCATION
                WHERE LOC_CD =POR_CD) AS NPOR_NAME ,
              POL_CD AS NPOL_CODE ,
              (
                SELECT LOC_NM
                FROM MDM_LOCATION
                WHERE LOC_CD =POL_CD) AS NPOL_NAME ,
              POD_CD AS NPOD_CODE ,
              (
                SELECT LOC_NM
                FROM MDM_LOCATION
                WHERE LOC_CD =POD_CD) AS NPOD_NAME ,
              DEL_CD AS NDEL_CODE ,
              (
                SELECT NVL((SELECT ATTR_CTNT2 FROM BKG_HRD_CDG_CTNT WHERE HRD_CDG_ID = 'YARD_NM_CONV' AND ATTR_CTNT1 = DEL_NOD_CD AND ATTR_CTNT3 = '2'),LOC_NM)
                FROM MDM_LOCATION
                WHERE LOC_CD =DEL_CD) AS NDEL_NAME ,
              (
                SELECT SKD.VPS_ETD_DT
                FROM VSK_VSL_PORT_SKD SKD,
                    (
                    SELECT VSL_CD,
                      SKD_VOY_NO,
                      SKD_DIR_CD,
                      POL_CD,
                      POL_CLPT_IND_SEQ
                    FROM BKG_VVD
                    WHERE BKG_NO = @[bkg_no]
                      AND VSL_PRE_PST_CD||VSL_SEQ = (
                                                     SELECT MIN(VSL_PRE_PST_CD||VSL_SEQ)
                                                     FROM BKG_VVD
                                                     WHERE BKG_NO = @[bkg_no])) VVD
                WHERE SKD.VSL_CD = VVD.VSL_CD
                  AND SKD.SKD_VOY_NO = VVD.SKD_VOY_NO
                  AND SKD.SKD_DIR_CD = VVD.SKD_DIR_CD
                  AND SKD.VPS_PORT_CD = VVD.POL_CD
                  AND SKD.CLPT_IND_SEQ = VVD.POL_CLPT_IND_SEQ ) AS POL_ETD_DT
            FROM BKG_BOOKING BKG
            WHERE BKG_NO = @[bkg_no] ) BKG,
            (
            SELECT  MAX(BKG_NO) BKG_NO,
                    MAX(DECODE(BKG_CUST_TP_CD, 'S', CUST_NM, '')) AS SHPR_NAME,
                    MAX(DECODE(BKG_CUST_TP_CD, 'S', CUST_ADDR, '')) AS SHPR_ADDRESS,
                    MAX(DECODE(BKG_CUST_TP_CD, 'S', CUST_CNT_CD, '')) AS SHPR_CNT_CD,
                    MAX(DECODE(BKG_CUST_TP_CD, 'S', CUST_SEQ, '')) AS SHPR_SEQ,
                    MAX(DECODE(BKG_CUST_TP_CD, 'F', CUST_NM, '')) AS F_FWD_NAME,
                    MAX(DECODE(BKG_CUST_TP_CD, 'F', CUST_ADDR, '')) AS F_FWD_ADDRESS
            FROM (
                  SELECT    BKG_NO,
                            BKG_CUST_TP_CD,
                            CUST_NM ,
                            CUST_ADDR ,
                            CUST_CNT_CD , 
                            CUST_SEQ
                   FROM BKG_CUSTOMER
                  WHERE BKG_NO = @[bkg_no]
                    AND BKG_CUST_TP_CD IN ('S', 'F'))) CUS,
            (
            SELECT DTL.BKG_NO,
                   (SELECT DO_NO FROM BKG_DO WHERE BKG_NO = DTL.BKG_NO  AND RLSE_SEQ= DTL.RLSE_SEQ ) AS DO_ISSUE_NO,
                   EVNT_DT AS DO_ISSUE_DATE,
                   EVNT_OFC_CD AS DO_ISSUE_AT,
                   EVNT_USR_ID AS DO_ISSUE_BY
            FROM BKG_DO_DTL DTL,
                 BKG_BOOKING BKG
            WHERE DTL.BKG_NO = @[bkg_no]
              AND BKG.BKG_NO = DTL.BKG_NO
              AND DTL.RLSE_STS_CD = DECODE(SUBSTR(BKG.DEL_CD, 1, 2), 'JP', 'D', 'R')
              
            UNION ALL
            SELECT BKG.BKG_NO,
                   '' AS DO_ISSUE_NO,
                   CGO.MRN_TML_EDI_LST_SND_DT AS DO_ISSUE_DATE,
                   '' AS DO_ISSUE_AT,
                   '' AS DO_ISSUE_BY
            FROM BKG_BOOKING BKG,
                   BKG_CGO_RLSE CGO,
                   BKG_CSTMS_ADV_BL AMS
            WHERE BKG.BKG_NO = @[bkg_no]
              AND BKG.BL_NO = CGO.BL_NO
              AND CGO.FRT_CLT_FLG = 'Y'
              AND CGO.OBL_RDEM_FLG = 'Y'
              AND CGO.CSTMS_CLR_CD = 'Y'
              AND CGO.BL_NO = AMS.BL_NO
              AND AMS.CNT_CD = 'US'
            ) DO
        
        WHERE BKG.BKG_NO = CUS.BKG_NO(+)
          AND BKG.BKG_NO = DO.BKG_NO(+)
        ) S,
(SELECT MAX(CGO_RCV_DT) AS CGO_RCV_DT FROM BKG_CONTAINER
WHERE BKG_NO = @[bkg_no]
) C			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
