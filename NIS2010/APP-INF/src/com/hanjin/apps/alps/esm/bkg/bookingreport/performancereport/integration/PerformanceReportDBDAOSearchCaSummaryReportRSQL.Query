<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PerformanceReportDBDAOSearchCaSummaryReportRSQL">
			<desc><![CDATA[PerformanceReportDBDAOSearchCaSummaryReportRSQL]]></desc>
			<sql><![CDATA[
SELECT B.GUBUN, 
       DECODE(B.GUBUN, 2, 'RHQ Sub Total', 3, 'Grand Total', A.SLS_RHQ_CD) SLS_RHQ_CD, 
       DECODE(B.GUBUN, 1, A.BKG_OFC_CD,     '') BKG_OFC_CD,
       DECODE(B.GUBUN, 1, A.CORR_OFC_CD,    '') CORR_OFC_CD,
       DECODE(B.GUBUN, 1, A.CTRT_OFC_CD,    '') CTRT_OFC_CD,
       DECODE(B.GUBUN, 1, A.POR_CD,         '') POR_CD,
       DECODE(B.GUBUN, 1, A.POL_CD,         '') POL_CD,
       DECODE(B.GUBUN, 1, A.POD_CD,         '') POD_CD,
       DECODE(B.GUBUN, 1, A.DEL_CD,         '') DEL_CD, 
       
       DECODE(B.GUBUN, 1, COUNT(A.BL_NO),   '') BL_NO_CNT, 
       DECODE(B.GUBUN, 1, COUNT(A.CORR_NO), '') CORR_NO_CNT, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'M', 1)), 0) CA_RSN_CD_M, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'C', 1)), 0) CA_RSN_CD_C, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'G', 1)), 0) CA_RSN_CD_G, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'A', 1)), 0) CA_RSN_CD_A, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'R', 1)), 0) CA_RSN_CD_R,   
       
       NVL(SUM(DECODE(A.RAT_FLG,   'Y', 1)), 0)  HAUL_C, 
       NVL(SUM(DECODE(A.EXPN_FLG,  'Y', 1)), 0)  HAUL_M,
       DECODE(COUNT(A.DOC_PERF_EXPT_CD), 0, SUM(DECODE(A.RAT_FLG, 'Y', 1)), 
                                            COUNT(A.DOC_PERF_EXPT_CD)) EXERRPT, 
             
       NVL(SUM(DECODE(A.RAT_FLG,   'Y', 1)), 0) RAT_FLG_Y, 
       NVL(SUM(DECODE(A.RAT_FLG,   'N', 1)), 0) RAT_FLG_N, 
       NVL(SUM(DECODE(A.EXPN_FLG,  'Y', 1)), 0) EXPN_FLG, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'A', 1)), 0) CA_KIND_A, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'B', 1)), 0) CA_KIND_B, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'C', 1)), 0) CA_KIND_C, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'D', 1)), 0) CA_KIND_D, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'E', 1)), 0) CA_KIND_E, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'G', 1)), 0) CA_KIND_F, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'G', 1)), 0) CA_KIND_G, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'H', 1)), 0) CA_KIND_H, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'I', 1)), 0) CA_KIND_I, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'J', 1)), 0) CA_KIND_J, 
       NVL(SUM(DECODE(A.CA_RSN_CD, 'K', 1)), 0) CA_KIND_K
  FROM (
        SELECT /*+ INDEX(BKG XAK3BKG_BOOKING) USE_NL(BKG, CA) */ 
               BKG.SLS_RGN_OFC_CD SLS_RHQ_CD, 
               CA.CORR_OFC_CD, 
               BKG.BKG_OFC_CD, 
               BKG.CTRT_OFC_CD, 
               BKG.POR_CD,
               BKG.POL_CD,
               BKG.POD_CD,
               BKG.DEL_CD,
               BKG.BL_NO, 
               CA.CORR_NO, 
               CA.CA_RSN_CD, 
               CA.RAT_FLG, 
               CA.EXPN_FLG, 
               CA.DOC_PERF_EXPT_CD  
          FROM BKG_CORRECTION CA, 
               BKG_BOOKING    BKG  
         WHERE CA.BKG_NO = BKG.BKG_NO 
           AND BKG.BKG_CRE_DT BETWEEN TO_DATE('2009-01-01', 'YYYY-MM-DD') 
                                  AND TO_DATE('2009-02-01'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')  
           AND CA.CORR_DT BETWEEN TO_DATE('2009-01-01', 'YYYY-MM-DD') 
                              AND TO_DATE('2009-02-01'||' 23:59:59', 'YYYY-MM-DD HH24:MI:SS')  

           AND BKG.BKG_STS_CD IN ('F','S')
           AND BKG_CGO_TP_CD = 'F'  
       ) A, 
       (SELECT ROWNUM GUBUN
          FROM COM_ERR_MSG
         WHERE ROWNUM <= 3 
       ) B
  GROUP BY B.GUBUN, 
           DECODE(B.GUBUN, 3, '', A.SLS_RHQ_CD), 
           DECODE(B.GUBUN, 2, 'RHQ Sub Total', 3, 'Grand Total', A.SLS_RHQ_CD),  
           DECODE(B.GUBUN, 1, A.BKG_OFC_CD, ''), 
           DECODE(B.GUBUN, 1, A.CORR_OFC_CD, ''), 
           DECODE(B.GUBUN, 1, A.CTRT_OFC_CD, ''), 
           DECODE(B.GUBUN, 1, A.POR_CD, ''),
           DECODE(B.GUBUN, 1, A.POL_CD, ''),
           DECODE(B.GUBUN, 1, A.POD_CD, ''),
           DECODE(B.GUBUN, 1, A.DEL_CD, '') 
  ORDER BY DECODE(B.GUBUN, 3, '', A.SLS_RHQ_CD), 
           B.GUBUN, 
           DECODE(B.GUBUN, 1, A.BKG_OFC_CD, ''), 
           DECODE(B.GUBUN, 1, A.CORR_OFC_CD, ''), 
           DECODE(B.GUBUN, 1, A.CTRT_OFC_CD, ''), 
           DECODE(B.GUBUN, 1, A.POR_CD, ''),
           DECODE(B.GUBUN, 1, A.POL_CD, ''),
           DECODE(B.GUBUN, 1, A.POD_CD, ''),
           DECODE(B.GUBUN, 1, A.DEL_CD, '')			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
