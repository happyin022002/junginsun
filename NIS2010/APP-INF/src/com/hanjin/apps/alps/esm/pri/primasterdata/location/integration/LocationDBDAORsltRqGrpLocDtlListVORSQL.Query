<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="LocationDBDAORsltRqGrpLocDtlListVORSQL">
			<desc><![CDATA[pri_rq_grp_loc_dtl 조회]]></desc>
			<sql><![CDATA[
#if (${org_dest_cd} == 'B')
SELECT LOC_CD
     , LOC_NM
     , RGN_CD
     , SCONTI_CD 
  FROM (
        SELECT A.LOC_CD
        	 , C.LOC_NM
        	 , C.RGN_CD
        	 , C.SCONTI_CD
          FROM PRI_RQ_GRP_LOC_DTL A
             , PRI_RQ_MN M
        	 , MDM_SVC_SCP_LMT B
             , MDM_LOCATION C
         WHERE A.QTTN_NO        = M.QTTN_NO
           AND A.QTTN_VER_NO    = M.QTTN_VER_NO
           AND A.LOC_CD			= C.LOC_CD
           AND M.SVC_SCP_CD		= B.SVC_SCP_CD
           AND B.RGN_CD			= C.RGN_CD
           AND A.QTTN_NO        = @[qttn_no]
           AND A.QTTN_VER_NO    = @[qttn_ver_no]
           AND A.GRP_LOC_SEQ    = @[grp_loc_seq]
           AND B.DELT_FLG		= 'N' 
     ) 
 GROUP BY LOC_CD, LOC_NM, RGN_CD, SCONTI_CD HAVING COUNT(*)>1
 ORDER BY LOC_CD ASC

#elseif (${org_dest_cd} == 'O' || ${org_dest_cd} == 'D') 
SELECT A.LOC_CD
	 , C.LOC_NM
	 , C.RGN_CD
	 , C.SCONTI_CD
  FROM PRI_RQ_GRP_LOC_DTL A
     , PRI_RQ_MN M
	 , MDM_SVC_SCP_LMT B
	 , MDM_LOCATION C
 WHERE A.QTTN_NO        = M.QTTN_NO
   AND A.QTTN_VER_NO    = M.QTTN_VER_NO
   AND A.LOC_CD			= C.LOC_CD
   AND M.SVC_SCP_CD		= B.SVC_SCP_CD
   AND B.RGN_CD			= C.RGN_CD
   AND A.QTTN_NO        = @[qttn_no]
   AND A.QTTN_VER_NO    = @[qttn_ver_no]
   AND A.GRP_LOC_SEQ    = @[grp_loc_seq]
   AND B.ORG_DEST_CD	= @[org_dest_cd]
   AND B.DELT_FLG		= 'N'
 ORDER BY A.LOC_CD ASC

#else 
SELECT A.LOC_CD
	 , B.LOC_NM
	 , B.RGN_CD
	 , B.SCONTI_CD
  FROM PRI_RQ_GRP_LOC_DTL A
	 , MDM_LOCATION B
 WHERE A.LOC_CD = B.LOC_CD
   AND A.QTTN_NO        = @[qttn_no]
   AND A.QTTN_VER_NO    = @[qttn_ver_no]
   AND A.GRP_LOC_SEQ    = @[grp_loc_seq]
 ORDER BY A.LOC_CD ASC

#end
 			]]></sql>
			<params>
				<param name="qttn_no" type="12" value="" out="N"/>
				<param name="qttn_ver_no" type="12" value="" out="N"/>
				<param name="grp_loc_seq" type="12" value="" out="N"/>
				<param name="org_dest_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
