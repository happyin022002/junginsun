<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SurchargeDBDAOPriScgRtVOUSQL">
			<desc><![CDATA[PRI_SCG_RT 테이블 수정
2013.03.07 전윤주 [CHM-201323465] Reefer condition type 추가
2013.04.17 전윤주 [CHM-201324203] 전윤주 Contract date 추가
2013.10.01 전윤주 [CHM-201326927] MDM rating flag와 연계하여 Auto 항목 추가
2013.10.01 전윤주 [CHM-201326929] BL Printing시 숨길 수 있는 Hide 항목 추가
2014.03.20 전윤주 [CHM-201429456] Food Grade 항목 추가
2014.04.10 전윤주 [CHM-201429656] State code 항목 추가  
2015.04.10 전지예 [CHM-201535041] Arrival Date 항목 추가]]></desc>
			<sql><![CDATA[
MERGE INTO PRI_SCG_RQST_RT RT
USING (
SELECT 
        @[scg_seq] as SCG_SEQ
       ,@[svc_scp_cd] as SVC_SCP_CD
       ,@[chg_cd] as CHG_CD
       ,@[scg_rqst_proc_cd] as SCG_RQST_PROC_CD
  FROM DUAL
) TMP
   ON(
          RT.SCG_SEQ = TMP.SCG_SEQ
     AND  RT.SVC_SCP_CD = TMP.SVC_SCP_CD
     AND  RT.CHG_CD = TMP.CHG_CD
     AND  RT.SCG_RQST_PROC_CD = TMP.SCG_RQST_PROC_CD
   
   )
   WHEN MATCHED THEN
       UPDATE SET
       RT.EFF_DT = TO_DATE(@[eff_dt],'YYYY-MM-DD')
	 , RT.EXP_DT = DECODE(@[exp_dt], NULL, TO_DATE('99991231', 'YYYY-MM-DD') ,TO_DATE(@[exp_dt],'YYYY-MM-DD'))
	 , RT.SUB_TRD_CD = @[sub_trd_cd]
	 , RT.VSL_SLAN_CD = @[vsl_slan_cd]
	 , RT.POR_TP_CD = @[por_tp_cd]
	 , RT.POR_DEF_CD = @[por_def_cd]
	 , RT.POL_TP_CD = @[pol_tp_cd]
	 , RT.POL_DEF_CD = @[pol_def_cd]
	 , RT.POD_TP_CD = @[pod_tp_cd]
	 , RT.POD_DEF_CD = @[pod_def_cd]
	 , RT.DEL_TP_CD = @[del_tp_cd]
	 , RT.DEL_DEF_CD = @[del_def_cd]
	 , RT.TS_PORT_CD = @[ts_port_cd]
	 , RT.TML_CD = @[tml_cd]
	 , RT.ORG_TRSP_MOD_CD = @[org_trsp_mod_cd]
	 , RT.DEST_TRSP_MOD_CD = @[dest_trsp_mod_cd]
	 , RT.USA_SVC_MOD_CD = @[usa_svc_mod_cd]
	 , RT.PRC_RCV_TERM_CD = @[prc_rcv_term_cd]
	 , RT.PRC_DE_TERM_CD = @[prc_de_term_cd]
	 , RT.PRC_HNGR_BAR_TP_CD = @[prc_hngr_bar_tp_cd]
	 , RT.DIR_CALL_FLG = @[dir_call_flg]
	 , RT.MIN_CGO_WGT = @[min_cgo_wgt]
	 , RT.MAX_CGO_WGT = @[max_cgo_wgt]
	 , RT.CMDT_CD = @[cmdt_cd]
	 , RT.SCG_GRP_CMDT_CD = @[scg_grp_cmdt_cd]
	 , RT.PRC_CGO_TP_CD = @[prc_cgo_tp_cd]
	 , RT.SCG_IMDG_CLSS_CD = @[scg_imdg_clss_cd]
	 , RT.RAT_UT_CD = @[rat_ut_cd]
	 , RT.CURR_CD = @[curr_cd]
	 , RT.SCG_AMT = @[scg_amt]
	 , RT.PAY_TERM_CD = @[pay_term_cd]
	 , RT.WDR_FLG = DECODE(@[wdr_flg], '0', 'N', 'Y')
	 , RT.SOC_FLG = @[soc_flg]
	 , RT.IO_GA_CD = @[io_ga_cd]
	 , RT.CNL_TZ_CD = @[cnl_tz_cd]
	 , RT.DELT_FLG = NVL(@[delt_flg], 'N')
	 , RT.SCG_RMK = @[scg_rmk]
     , RT.SCG_CRTE_DY_KNT = @[scg_crte_dy_knt] 
     , RT.SCG_PRD_TP_CD = @[scg_prd_tp_cd]
     , RT.SCG_PRD_CRTE_CD = @[scg_prd_crte_cd]
     , RT.PSA_NO = @[psa_no]
     , RT.RC_AIR_COND_TP_CD = @[rc_air_cond_tp_cd]
     , RT.CTRT_DT = TO_DATE(@[ctrt_dt],'YYYY-MM-DD')
     , RT.ACT_RAT_FLG = @[act_rat_flg]
     , RT.PRN_HDN_FLG =  DECODE(@[prn_hdn_flg],'1', 'Y', '')
     , RT.FD_GRD_FLG = @[fd_grd_flg]
     , RT.CNT_CD = @[cnt_cd]
     , RT.STE_CD = @[ste_cd]
     , RT.ARR_DT = TO_DATE(@[arr_dt],'YYYY-MM-DD')
	 , RT.UPD_USR_ID = @[upd_usr_id]
	 , RT.UPD_DT = SYSDATE
	 , RT.SCG_RQST_STS_CD = @[scg_rqst_sts_cd]

   
   
   WHEN NOT MATCHED THEN
   INSERT
   (
       SVC_SCP_CD
     , CHG_CD
	 , SCG_SEQ
     , SCG_RQST_SEQ
     , SCG_RQST_STS_CD
     , SCG_RQST_PROC_CD
	 , EFF_DT
	 , EXP_DT
	 , SUB_TRD_CD
	 , VSL_SLAN_CD
	 , POR_TP_CD
	 , POR_DEF_CD
	 , POL_TP_CD
	 , POL_DEF_CD
	 , POD_TP_CD
	 , POD_DEF_CD
	 , DEL_TP_CD
	 , DEL_DEF_CD
	 , TS_PORT_CD
	 , TML_CD
	 , ORG_TRSP_MOD_CD
	 , DEST_TRSP_MOD_CD
	 , USA_SVC_MOD_CD
	 , PRC_RCV_TERM_CD
	 , PRC_DE_TERM_CD
	 , PRC_HNGR_BAR_TP_CD
	 , DIR_CALL_FLG
	 , MIN_CGO_WGT
	 , MAX_CGO_WGT
	 , CMDT_CD
	 , SCG_GRP_CMDT_CD
	 , PRC_CGO_TP_CD
	 , SCG_IMDG_CLSS_CD
	 , RAT_UT_CD
	 , CURR_CD
	 , SCG_AMT
	 , PAY_TERM_CD
	 , WDR_FLG
	 , SOC_FLG
	 , IO_GA_CD
	 , DELT_FLG
	 , SCG_RMK
     , SCG_CRTE_DY_KNT
     , SCG_PRD_TP_CD
     , SCG_PRD_CRTE_CD
	 , PSA_NO
     , RC_AIR_COND_TP_CD
     , CTRT_DT
     , ACT_RAT_FLG
     , PRN_HDN_FLG
     , FD_GRD_FLG
     , CNT_CD
     , STE_CD
     , ARR_DT
	 , CRE_USR_ID
	 , CRE_DT
	 , UPD_USR_ID
	 , UPD_DT
	 , CNL_TZ_CD
   
   )
   VALUES
   (
            @[svc_scp_cd] 
        ,	@[chg_cd] 
        ,	@[scg_seq]
        ,   (SELECT NVL(MAX(SCG_RQST_SEQ), 0)+1 FROM PRI_SCG_RQST_RT WHERE SVC_SCP_CD = @[svc_scp_cd] AND CHG_CD = @[chg_cd] AND SCG_SEQ = @[scg_seq])
        ,   @[scg_rqst_sts_cd]
        ,   @[scg_rqst_proc_cd]
        ,	TO_DATE(@[eff_dt],'YYYY-MM-DD') 
        ,	DECODE(@[exp_dt], NULL, TO_DATE('99991231', 'YYYY-MM-DD') ,TO_DATE(@[exp_dt],'YYYY-MM-DD')) 
        ,	@[sub_trd_cd] 
        ,	@[vsl_slan_cd] 
        ,	@[por_tp_cd] 
        ,	@[por_def_cd] 
        ,	@[pol_tp_cd] 
        ,	@[pol_def_cd] 
        ,	@[pod_tp_cd] 
        ,	@[pod_def_cd] 
        ,	@[del_tp_cd]
        ,	@[del_def_cd] 
        ,	@[ts_port_cd] 
        ,	@[tml_cd] 
        ,	@[org_trsp_mod_cd] 
        ,	@[dest_trsp_mod_cd] 
        ,	@[usa_svc_mod_cd] 
        ,	@[prc_rcv_term_cd] 
        ,	@[prc_de_term_cd] 
        ,	@[prc_hngr_bar_tp_cd] 
        ,	@[dir_call_flg] 
        ,	@[min_cgo_wgt] 
        ,	@[max_cgo_wgt] 
        ,	@[cmdt_cd] 
        ,	@[scg_grp_cmdt_cd] 
        ,	@[prc_cgo_tp_cd] 
        ,	@[scg_imdg_clss_cd] 
        ,	@[rat_ut_cd] 
        ,	@[curr_cd] 
        ,	@[scg_amt] 
        ,	@[pay_term_cd]
        ,	DECODE(@[wdr_flg], '1', 'Y', 'N') 
        ,   @[soc_flg] 
        ,   @[io_ga_cd] 
        ,	NVL(@[delt_flg], 'N')
        ,	@[scg_rmk] 
        ,   @[scg_crte_dy_knt] 
        ,   @[scg_prd_tp_cd]
        ,   @[scg_prd_crte_cd] 
        ,   @[psa_no]
        ,   @[rc_air_cond_tp_cd] 
        ,   TO_DATE(@[ctrt_dt],'YYYY-MM-DD')
        ,   @[act_rat_flg] 
        ,   DECODE(@[prn_hdn_flg], 1, 'Y', '')
        ,   @[fd_grd_flg] 
        ,   @[cnt_cd] 
        ,   @[ste_cd] 
        ,   TO_DATE(@[arr_dt],'YYYY-MM-DD') 
        ,	@[cre_usr_id] 
        ,	SYSDATE
        ,	@[upd_usr_id] 
        ,	SYSDATE
        ,	@[cnl_tz_cd]
   )			]]></sql>
			<params>
				<param name="scg_seq" type="2" value="" out="N"/>
				<param name="svc_scp_cd" type="12" value="" out="N"/>
				<param name="chg_cd" type="12" value="" out="N"/>
				<param name="scg_rqst_proc_cd" type="12" value="" out="N"/>
				<param name="eff_dt" type="12" value="" out="N"/>
				<param name="exp_dt" type="12" value="" out="N"/>
				<param name="sub_trd_cd" type="12" value="" out="N"/>
				<param name="vsl_slan_cd" type="12" value="" out="N"/>
				<param name="por_tp_cd" type="12" value="" out="N"/>
				<param name="por_def_cd" type="12" value="" out="N"/>
				<param name="pol_tp_cd" type="12" value="" out="N"/>
				<param name="pol_def_cd" type="12" value="" out="N"/>
				<param name="pod_tp_cd" type="12" value="" out="N"/>
				<param name="pod_def_cd" type="12" value="" out="N"/>
				<param name="del_tp_cd" type="12" value="" out="N"/>
				<param name="del_def_cd" type="12" value="" out="N"/>
				<param name="ts_port_cd" type="12" value="" out="N"/>
				<param name="tml_cd" type="12" value="" out="N"/>
				<param name="org_trsp_mod_cd" type="12" value="" out="N"/>
				<param name="dest_trsp_mod_cd" type="12" value="" out="N"/>
				<param name="usa_svc_mod_cd" type="12" value="" out="N"/>
				<param name="prc_rcv_term_cd" type="12" value="" out="N"/>
				<param name="prc_de_term_cd" type="12" value="" out="N"/>
				<param name="prc_hngr_bar_tp_cd" type="12" value="" out="N"/>
				<param name="dir_call_flg" type="12" value="" out="N"/>
				<param name="min_cgo_wgt" type="6" value="" out="N"/>
				<param name="max_cgo_wgt" type="6" value="" out="N"/>
				<param name="cmdt_cd" type="12" value="" out="N"/>
				<param name="scg_grp_cmdt_cd" type="12" value="" out="N"/>
				<param name="prc_cgo_tp_cd" type="12" value="" out="N"/>
				<param name="scg_imdg_clss_cd" type="12" value="" out="N"/>
				<param name="rat_ut_cd" type="12" value="" out="N"/>
				<param name="curr_cd" type="12" value="" out="N"/>
				<param name="scg_amt" type="6" value="" out="N"/>
				<param name="pay_term_cd" type="12" value="" out="N"/>
				<param name="wdr_flg" type="12" value="" out="N"/>
				<param name="soc_flg" type="12" value="" out="N"/>
				<param name="io_ga_cd" type="12" value="" out="N"/>
				<param name="cnl_tz_cd" type="12" value="" out="N"/>
				<param name="delt_flg" type="12" value="" out="N"/>
				<param name="scg_rmk" type="12" value="" out="N"/>
				<param name="scg_crte_dy_knt" type="12" value="" out="N"/>
				<param name="scg_prd_tp_cd" type="12" value="" out="N"/>
				<param name="scg_prd_crte_cd" type="12" value="" out="N"/>
				<param name="psa_no" type="12" value="" out="N"/>
				<param name="rc_air_cond_tp_cd" type="12" value="" out="N"/>
				<param name="ctrt_dt" type="12" value="" out="N"/>
				<param name="act_rat_flg" type="12" value="" out="N"/>
				<param name="prn_hdn_flg" type="12" value="" out="N"/>
				<param name="fd_grd_flg" type="12" value="" out="N"/>
				<param name="cnt_cd" type="12" value="" out="N"/>
				<param name="ste_cd" type="12" value="" out="N"/>
				<param name="arr_dt" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="scg_rqst_sts_cd" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
