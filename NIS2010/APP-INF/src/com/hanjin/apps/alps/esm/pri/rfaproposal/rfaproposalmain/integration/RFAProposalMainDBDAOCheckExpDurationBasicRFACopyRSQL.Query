<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RFAProposalMainDBDAOCheckExpDurationBasicRFACopyRSQL">
			<desc><![CDATA[RFAProposalMainDBDAOCheckDurationBasicRFACopyRSQL

* history
* 2016.07.20 [CHM-201642287] Basic RFA의 amdt가 0일때는 Copy한 Master의 Exp date를, amdt가 0이 아닐 때는 auto amend 대상 amdt의 Exp date를 취득한다.]]></desc>
			<sql><![CDATA[
SELECT B.PROP_NO
     , MAX(B.AMDT_SEQ) AMDT_SEQ
     , MAX(TO_CHAR(B.EXP_DT, 'YYYYMMDD')) AS ORG_EXP_DT
  FROM PRI_RP_HDR A
     , PRI_RP_MN B
 WHERE A.PROP_NO    = B.PROP_NO
   AND A.RFA_NO     = (SELECT A.MST_RFA_NO   FROM PRI_RP_HDR A WHERE A.PROP_NO  = @[prop_no])
#if (${amdt_seq} == '0') 
  -- Copyed Basic
   AND B.AMDT_SEQ   = (SELECT A.MST_AMDT_SEQ FROM PRI_RP_HDR A WHERE A.PROP_NO  = @[prop_no])
#else 
  -- Basic Auto Amend
   AND PROP_STS_CD = 'A'
#end
 GROUP BY B.PROP_NO			]]></sql>
			<params>
				<param name="prop_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
