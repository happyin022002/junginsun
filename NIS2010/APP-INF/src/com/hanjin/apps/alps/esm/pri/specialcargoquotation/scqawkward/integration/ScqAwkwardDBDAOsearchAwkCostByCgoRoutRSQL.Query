<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ScqAwkwardDBDAOsearchAwkCostByCgoRoutRSQL">
			<desc><![CDATA[Cargo - Route 별 비용 리스트]]></desc>
			<sql><![CDATA[
SELECT  A.CGO_SEQ, B.ROUT_SEQ
    ,   A.CNTR_QTY
    ,   SUM ( DECODE ( C.COST_TP_CD, 'N', C.SUM_AMT ) ) AS N_COST
    ,   SUM ( DECODE ( C.COST_TP_CD, 'W', C.SUM_AMT ) ) AS W_COST
    ,   SUM ( DECODE ( C.COST_TP_CD, 'G', C.SUM_AMT ) ) AS G_COST
    ,   DECODE(SUM ( DECODE ( C.COST_TP_CD, 'A', C.SUM_AMT ) ),'',SUM ( DECODE ( C.COST_TP_CD, 'T', C.SUM_AMT ) )) AS T_COST
    ,   SUM ( DECODE ( C.COST_TP_CD, 'S', C.SUM_AMT ) ) AS S_COST
    ,   SUM ( DECODE ( C.COST_TP_CD, 'A', C.SUM_AMT ) ) AS A_COST
FROM    PRI_SCQ_AWK_CGO A
    ,   PRI_SCQ_AWK_ROUT B
    ,
    (
        SELECT  CGO_SEQ, ROUT_SEQ, COST_TP_CD, SUM ( USD_AMT ) AS SUM_AMT
        FROM    PRI_SCQ_AWK_YD_DTL
        WHERE   SCQ_RQST_NO = @[scq_rqst_no]
        AND     SCQ_VER_NO  = @[scq_ver_no]
        GROUP   BY CGO_SEQ, ROUT_SEQ, COST_TP_CD
        UNION ALL
        SELECT  CGO_SEQ, ROUT_SEQ, COST_TP_CD, SUM ( USD_AMT )
        FROM    PRI_SCQ_AWK_ROUT_DTL
        WHERE   SCQ_RQST_NO = @[scq_rqst_no]
        AND     SCQ_VER_NO  = @[scq_ver_no]
        GROUP   BY CGO_SEQ, ROUT_SEQ, COST_TP_CD ) C
WHERE   A.SCQ_RQST_NO = @[scq_rqst_no]
AND     A.SCQ_VER_NO  = @[scq_ver_no]
AND     A.SCQ_RQST_NO = B.SCQ_RQST_NO
AND     A.SCQ_VER_NO  = B.SCQ_VER_NO
AND     A.CGO_SEQ     = C.CGO_SEQ
AND     B.ROUT_SEQ    = C.ROUT_SEQ
GROUP   BY A.CGO_SEQ, B.ROUT_SEQ, A.CNTR_QTY
ORDER   BY A.CGO_SEQ, B.ROUT_SEQ			]]></sql>
			<params>
				<param name="scq_rqst_no" type="12" value="" out="N"/>
				<param name="scq_ver_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
