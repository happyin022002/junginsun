<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EBookingReceiptDBDAOUpdateXterShipperUSQL">
			<desc><![CDATA[해당 rqst에 customer 정보(country code, customer seq)를 update한다.
(단, alps 의 customer 정보가 null 일 경우엔 대상에서 제외한다.)]]></desc>
			<sql><![CDATA[
merge 
	into bkg_xter_cust xter 
using 
(
    select XTER_SNDR_ID, XTER_RQST_NO, XTER_RQST_SEQ, BKG_CUST_TP_CD, CUST_CNT_CD,  CUST_SEQ
        from 
        (SELECT bxr.XTER_SNDR_ID, 
                bxr.XTER_RQST_NO,
                bxr.XTER_RQST_SEQ,
                BKC.BKG_CUST_TP_CD,BKC.CUST_CNT_CD, BKC.CUST_SEQ
           FROM BKG_XTER_RQST_MST BXR, BKG_CUSTOMER BKC
          WHERE 1=1
            AND BKC.BKG_NO = BXR.BKG_NO
            and BXR.XTER_SNDR_ID = @[sender_id]
            AND BXR.XTER_RQST_NO = @[rqst_no]
            AND BXR.XTER_RQST_SEQ = @[rqst_seq]
            ) alps
        where alps.cust_cnt_cd is not null 
          and alps.cust_seq is not null
) alps on (xter.XTER_SNDR_ID = alps.XTER_SNDR_ID and  
            xter.XTER_RQST_NO = alps.XTER_RQST_NO and 
            xter.XTER_RQST_SEQ = alps.XTER_RQST_SEQ and 
            xter.xter_cust_tp_Cd = alps.BKG_CUST_TP_CD) 
when matched then update set xter.cnt_cd = alps.cust_cnt_cd, xter.cust_seq = alps.cust_seq			]]></sql>
			<params>
				<param name="sender_id" type="12" value="" out="N"/>
				<param name="rqst_no" type="12" value="" out="N"/>
				<param name="rqst_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
