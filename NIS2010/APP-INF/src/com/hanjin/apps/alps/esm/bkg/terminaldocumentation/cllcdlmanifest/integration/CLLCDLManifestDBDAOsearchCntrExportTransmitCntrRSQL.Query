<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CLLCDLManifestDBDAOsearchCntrExportTransmitCntrRSQL">
			<desc><![CDATA[Container Export EDI 전송시 Container정보를 구하는 쿼리.]]></desc>
			<sql><![CDATA[
SELECT  NVL(c.cntr_no,' ') CNTRNBR,
    	NVL(c.PCK_TP_CD,' ') PUNIT,
    	NVL(c.PCK_QTY,'') PKG,
    	DECODE(NVL(C.WGT_UT_CD,DOC.WGT_UT_CD),'LBS',ROUND(NVL(DECODE(c.CNTR_WGT,0,NULL,c.CNTR_WGT),ROUND(DOC.ACT_WGT / QTY.QTY, 0))*0.4536,0),NVL(DECODE(c.CNTR_WGT,0,NULL,c.CNTR_WGT),ROUND(DOC.ACT_WGT / QTY.QTY, 0))) CNTRWGT,
		DECODE(DECODE(NVL(c.WGT_UT_CD,DOC.WGT_UT_CD),'LBS',ROUND(NVL(DECODE(c.CNTR_WGT,0,NULL,c.CNTR_WGT),ROUND(DOC.ACT_WGT / QTY.QTY, 0))*0.4536,0),NVL(DECODE(c.CNTR_WGT,0,NULL,c.CNTR_WGT),ROUND(DOC.ACT_WGT / QTY.QTY, 0))),NULL,NULL,0,NULL,'0',NULL,DECODE(NVL(DECODE(c.CNTR_WGT,0,NULL,c.CNTR_WGT),DOC.WGT_UT_CD),'LBS',ROUND(NVL(DECODE(c.CNTR_WGT,0,NULL,c.CNTR_WGT),ROUND(DOC.ACT_WGT / QTY.QTY, 0))*0.4536,2),NVL(DECODE(c.CNTR_WGT,0,NULL,c.CNTR_WGT),ROUND(DOC.ACT_WGT / QTY.QTY, 0))) + DECODE(NVL(S.TARE_WGT, 0), 0, DECODE(NVL(T.CNTR_TPSZ_TARE_WGT, 0), 0, DECODE(O.CNTR_TPSZ_CD, 'T2', 3600, 'T4', 5200, 0), T.CNTR_TPSZ_TARE_WGT), S.TARE_WGT  ) ) CNTRGWGT,
    	'KGM' CNTR_WGT_UNIT,
    	DECODE(NVL(S.TARE_WGT, 0), 0, DECODE(NVL(T.CNTR_TPSZ_TARE_WGT, 0), 0, DECODE(O.CNTR_TPSZ_CD, 'T2', 3600, 'T4', 5200, 0), T.CNTR_TPSZ_TARE_WGT), S.TARE_WGT  ) CNTRTRW,
    	NVL(c.CNTR_TPSZ_CD,' ') CNTRTYPE,
		--C.VGM_VRFY_DT,

		TO_CHAR(C.VGM_VRFY_DT,'YYYYMMDDHH24MI') VGM_VRFY_DT,
		--DECODE(NVL(C.VGM_WGT_UT_CD, 0), 'LBS', ROUND (NVL(C.VGM_WGT, 0)*0.4536, 3), NVL(C.VGM_WGT, 0)) VGM_WGT,
		C.VGM_WGT,
		C.VGM_WGT_UT_CD,
		C.VGM_VRFY_SIG_CTNT,
        C.VGM_MZD_TP_CD,
		(  SELECT MIN(CNTR_SEAL_NO) CNTR_SEAL_NO
			 FROM BKG_CNTR_SEAL_NO
  			WHERE BKG_NO = C.BKG_NO
    		  AND CNTR_NO = C.CNTR_NO
              AND CNTR_SEAL_SEQ = 1) SEALNBR,
    	DECODE(BK.BKG_CGO_TP_CD,'F','F','M') FM_IND,
    	BK.RC_FLG RF_IND,
    	BK.DCGO_FLG DG_IND,
    	BK.AWK_CGO_FLG AK_IND,
    	BK.BB_CGO_FLG BK_IND,
    	'' TEMP,
    	'' TUNIT,
    	'' VENT,
    	NVL(c.MEAS_QTY,'') MEASURE,
    	NVL(c.MEAS_UT_CD,' ') MEASURE_UNIT,
    	NVL(c.RCV_TERM_CD,' ')||NVL(c.DE_TERM_CD,' ') RDTYPE,
    	Translate(NVL(COM.CMDT_NM,' '),chr(13)||chr(10),' ') CMDT_DESC,
    	NVL(BK.cmdt_cd,' ') CMDTCD,
    	'' RF_REMARK,
    	DECODE(BK.RD_CGO_FLG,'Y','1','0') RFDRY_IND,
    	'' OVF,
    	'' OVR,
    	'' OVH,
    	'' OVLW,
    	'' OVRW,
    	'' OVWGT,
    	'' OVWGT_UNIT,
    	'' VOID_SLOT,
    	'' STWG_REQ,
    	nvl(C.SOC_FLG,' ') SOCIND,
    	'' HAULAGE,
    	'' BKWGT,
    	'' BKWGTU,
    	'' BKW,
    	'' BKH,
    	'' BKL,
    	NVL(O.OWNR_CO_CD,' ') CNTROWN,
    	NVL(O.LSTM_CD,' ') CNTRTRM,
    	C.cntr_no CNTR_NO
FROM	BKG_BOOKING BK, 
    	BKG_BL_DOC DOC,
    	BKG_CONTAINER C, 
    	MST_CONTAINER O, 
		MST_CNTR_SPEC S,
    	MDM_CNTR_TP_SZ T,
		MDM_COMMODITY COM,
		( 	SELECT 	BKG_NO,
					SUM(NVL(OP_CNTR_QTY,0)) QTY 
			FROM 	BKG_QUANTITY
    		WHERE 	BKG_NO = @[form_bkg_no]
      		AND 	CNTR_TPSZ_CD NOT IN ('Q2','Q4')
      		GROUP BY BKG_NO ) QTY
WHERE	BK.BKG_NO				= @[form_bkg_no]
AND	    BK.BKG_NO 				= DOC.BKG_NO
and		BK.BKG_NO				= C.BKG_NO
AND     BK.BKG_NO               = QTY.BKG_NO(+)
and		C.CNTR_NO				= O.CNTR_NO(+)
AND     O.CNTR_SPEC_NO          = S.CNTR_SPEC_NO(+)
and		O.CNTR_TPSZ_CD 			= T.CNTR_TPSZ_CD(+)
AND 	BK.CMDT_CD            	= COM.CMDT_CD(+)
and		NVL(C.DCGO_FLG,'N')		= 'N'
and		NVL(C.BB_CGO_FLG,'N')	= 'N'
and		NVL(C.AWK_CGO_FLG,'N')	= 'N'
and		NVL(C.RC_FLG,'N')		= 'N'			]]></sql>
			<params>
				<param name="form_bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
