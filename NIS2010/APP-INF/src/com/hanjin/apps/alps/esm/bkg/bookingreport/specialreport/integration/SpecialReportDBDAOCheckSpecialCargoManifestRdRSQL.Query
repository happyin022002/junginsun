<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SpecialReportDBDAOCheckSpecialCargoManifestRdRSQL">
			<desc><![CDATA[SpecialCargo Manifest의 RD 존재 유무 조회]]></desc>
			<sql><![CDATA[
SELECT DECODE(SUM(CASE WHEN SP.BKG_SPE_DG = 'Y' 
                        THEN (SELECT COUNT(*) FROM BKG_DG_CGO DG
                              WHERE DG.BKG_NO = SP.BKG_NO
                              AND SP.BKG_SPE_DG = 'Y'
                              AND NVL(DG.SPCL_CGO_APRO_CD,'') <> 'C')
                        ELSE 0 END), 0, 'N', 'Y') DG,
       DECODE(SUM(CASE WHEN SP.BKG_SPE_AK = 'Y'
                        THEN (SELECT COUNT(*) FROM BKG_AWK_CGO AWK
                              WHERE AWK.BKG_NO = SP.BKG_NO
                              AND SP.BKG_SPE_AK = 'Y'
                              AND NVL(AWK.SPCL_CGO_APRO_CD,' ') <> 'C')
                        ELSE 0 END), 0, 'N', 'Y') AWK,
       DECODE(SUM(CASE WHEN SP.BKG_SPE_BB = 'Y'
                        THEN (SELECT COUNT(*) FROM BKG_BB_CGO BB
                              WHERE BB.BKG_NO = SP.BKG_NO
                              AND SP.BKG_SPE_BB = 'Y'
                              AND NVL(BB.SPCL_CGO_APRO_CD,' ') <> 'C')
                        ELSE 0 END), 0, 'N', 'Y') BB,
       DECODE(SUM(CASE WHEN SP.BKG_SPE_RF = 'Y'
                        THEN (SELECT COUNT(*) FROM BKG_RF_CGO RF
                              WHERE RF.BKG_NO = SP.BKG_NO
                              AND SP.BKG_SPE_RF = 'Y'
                              AND NVL(RF.SPCL_CGO_APRO_CD,' ') <> 'C')
                        ELSE 0 END), 0, 'N', 'Y') RF,
       DECODE(SUM(DECODE(BKG.STWG_CD, NULL, 0, 1)), 0, 'N', 'Y') STWG
FROM BKG_SP_V SP, BKG_BOOKING BKG
WHERE 1=1
#if(${rdo_in_out} == 'IN')
	#if(${rdo_local_ts} == 'LOCAL')
	AND BKG.POD_CD = SP.VVD_POD
	#elseif(${rdo_local_ts} == 'TS')
	AND BKG.POD_CD <> SP.VVD_POD
	#end
#elseif(${rdo_in_out} == 'OUT')
	#if(${rdo_local_ts} == 'LOCAL')
	AND BKG.POL_CD = SP.VVD_POL
	#elseif(${rdo_local_ts} == 'TS')
	AND BKG.POD_CD <> SP.VVD_POL
	#end
#end
AND SP.VSL_CD = @[vsl_cd]  /*VVD*/
AND SP.SKD_VOY_NO = @[skd_voy_no]  /*VVD*/
AND SP.SKD_DIR_CD = @[skd_dir_cd]  /*VVD*/
#if(${vvd_pol} != '')
AND SP.VVD_POL = @[vvd_pol]  /*VVD_POL*/
#end
#if(${vvd_pod} != '')
AND SP.VVD_POD = @[vvd_pod]  /*VVD_POD*/
#end
#if(${pol_yd_cd} != '')
AND NVL(SUBSTR(SP.POL_YD_CD, 6, 2), ' ') = @[pol_yd_cd]
#end
#if(${pod_yd_cd} != '')
AND NVL(SUBSTR(SP.POD_YD_CD, 6, 2), ' ') = @[pod_yd_cd]
#end
AND SP.BKG_NO = BKG.BKG_NO
#if(${por_cd} != '')
AND BKG.POR_CD = @[por_cd]
#end
#if(${pol_cd} != '')
AND BKG.POL_CD = @[pol_cd]
#end
#if(${pod_cd} != '')
AND BKG.POD_CD = @[pod_cd]
#end
#if(${del_cd} != '')
AND BKG.DEL_CD = @[del_cd]
#end			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="vvd_pol" type="12" value="" out="N"/>
				<param name="vvd_pod" type="12" value="" out="N"/>
				<param name="pol_yd_cd" type="12" value="" out="N"/>
				<param name="pod_yd_cd" type="12" value="" out="N"/>
				<param name="por_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
				<param name="del_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
