<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SalesRPTDBDAOSearchMonthlyAvgUC0057ListRSQL">
			<desc><![CDATA[Monthly Average U/C]]></desc>
			<sql><![CDATA[
SELECT 
   REV_POL_CD 
  ,REV_POD_CD 
  ,RLANE_CD 
  ,TPSZ_CODE 
  ,LOAD 
  ,BKG_REV                           AS REV  /* REV(BKG_REV+BKG_OFT_REV) */
  ,CM_COST                           AS CM_COST 
  ,BKG_REV+MISC_REV-CM_COST          AS CM  /* REV(BKG_REV+BKG_OFT_REV+BKG_MISC_REV+SCR_CHG_REV)-CM_COST */
  ,OP_COST                           AS OP_COST 
  ,BKG_REV+MISC_REV-CM_COST-OP_COST  AS OP 
FROM ( 
    SELECT 
       H.REV_POL_CD 
      ,H.REV_POD_CD 
      ,H.RLANE_CD 
      ,H.SPCL_CNTR_TPSZ_CD TPSZ_CODE 
      ,SUM(NVL(H.BKG_QTY,0)) LOAD 
      ,SUM(NVL(H.BKG_REV,0)+NVL(H.BKG_OFT_REV,0)) BKG_REV  /* REV(BKG_REV+BKG_OFT_REV) */
      ,SUM(NVL(H.BKG_MISC_REV,0)+NVL(H.SCR_CHG_REV,0)) MISC_REV 
      ,SUM(NVL(H.DMDT_COM_AMT,0)) DEM_DET 
      ,SUM(DECODE('${f_pro_vw}', 'P', NVL(H.PA_CM_COST_TTL_AMT, 0) , 'R', NVL(H.RA_CM_COST_TTL_AMT, 0))) CM_COST 
      ,SUM(DECODE('${f_pro_vw}', 'P', 0 , 'R', NVL(H.RA_OP_COST_TTL_AMT, 0))) OP_COST 
    FROM 
      COA_BKG_EXPN_DTL H 
    WHERE  1=1 
      
      AND H.COST_YRMON      = REPLACE('${f_cost_yrmon}', '-','') 
      #if (${f_kind} == '1')  /* from:pol, to:pod*/
        AND H.REV_POL_CD      = '${f_from}'
        AND H.REV_POD_CD      = '${f_to}'
      #else  /* from:Origin, to:Dest   from:por, to:del*/
        AND H.BKG_POR_CD      = '${f_from}' 
        AND H.BKG_DEL_CD      = '${f_to}'
      #end
      #if(${f_cntr_tpsz_cd} != '')           
        AND H.SPCL_CNTR_TPSZ_CD  = '${f_cntr_tpsz_cd}'
      #end
      #if(${f_rcv_term} != '')     
        AND H.BKG_RCV_TERM_CD = '${f_rcv_term}'
      #end
      #if(${f_de_term} != '')   
        AND H.BKG_DE_TERM_CD  = '${f_de_term}'
      #end
      
      AND NVL(H.DELT_FLG,'N')  = 'N'
      AND H.BL_NO_TP        IN ('M','0') 
      AND H.BKG_STS_CD      IN ('F','S') 
      AND H.BKG_CGO_TP_CD   <> 'P' 
    GROUP BY H.REV_POL_CD
      ,H.REV_POD_CD
      ,H.RLANE_CD
      ,H.SPCL_CNTR_TPSZ_CD
)
ORDER BY REV_POL_CD
  ,REV_POD_CD
  ,RLANE_CD
  ,TPSZ_CODE			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
