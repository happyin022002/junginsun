<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BookingHistoryMgtDBDAOSearchHistBkgUsaCstmsFileNoRSQL">
			<desc><![CDATA[BookingHistoryMgtDBDAOSearchHistBkgUsaCstmsFileNoRSQL]]></desc>
			<sql><![CDATA[
WITH OLD AS
(SELECT @[bkg_no] BKG_NO
, @[usa_cstms_file_no] USA_CSTMS_FILE_NO
, @[pck_qty] PCK_QTY
, @[scac_cd] SCAC_CD
FROM DUAL)
SELECT HIS_CATE_NM
     , PRE_CTNT
     , CRNT_CTNT
  FROM 
    (
        SELECT 'AMS FILE NO' HIS_CATE_NM
                , OLD.USA_CSTMS_FILE_NO||
                  '/'||OLD.PCK_QTY||
                  '/'||OLD.SCAC_CD PRE_CTNT
                , NOW.USA_CSTMS_FILE_NO||
                  '/'||NOW.PCK_QTY||
                  '/'||NOW.SCAC_CD CRNT_CTNT
          FROM OLD
#if (${ca_flg} == 'Y')
             , BKG_USA_CSTMS_FILE_NO_HIS NOW
         WHERE NOW.BKG_NO(+)  = OLD.BKG_NO
	       AND NOW.CORR_NO(+) = 'TMP0000001' 
#else
             , BKG_USA_CSTMS_FILE_NO NOW
         WHERE NOW.BKG_NO(+) = OLD.BKG_NO
#end

           AND NOW.USA_CSTMS_FILE_NO(+) = OLD.USA_CSTMS_FILE_NO
    )    
 WHERE NVL(TRIM(PRE_CTNT), ' ') <> NVL(TRIM(CRNT_CTNT), ' ')			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="usa_cstms_file_no" type="12" value="" out="N"/>
				<param name="pck_qty" type="12" value="" out="N"/>
				<param name="scac_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
