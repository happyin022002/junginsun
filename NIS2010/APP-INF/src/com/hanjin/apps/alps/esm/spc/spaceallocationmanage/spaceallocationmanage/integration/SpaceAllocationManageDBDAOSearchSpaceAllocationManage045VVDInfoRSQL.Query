<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SpaceAllocationManageDBDAOSearchSpaceAllocationManage045VVDInfoRSQL">
			<desc><![CDATA[2013.06.13 진마리아 SELCDO 팀코드 변경 (SELCTY)]]></desc>
			<sql><![CDATA[
SELECT COST_YRWK,RLANE_CD,VVD,RHQ
  FROM ( 
SELECT DISTINCT SUBSTR(MV.SLS_YRMON, 1, 4)||MV.COST_WK     AS COST_YRWK,
       MV.RLANE_CD AS RLANE_CD,
       MV.VSL_CD|| MV.SKD_VOY_NO|| MV.DIR_CD VVD,
       (SELECT NVL(N2ND_PRNT_OFC_CD, OFC_CD) 
         FROM SPC_OFC_LVL 
        WHERE OFC_CD = @[ofc_cd]
          AND SUBSTR(MV.SLS_YRMON, 1, 4)||MV.COST_WK BETWEEN OFC_APLY_FM_YRWK AND OFC_APLY_TO_YRWK) RHQ,
       MV.DIR_CD,
       RL.VSL_SLAN_CD
    FROM VSK_VSL_SKD      TVPS,
         VSK_VSL_PORT_SKD VPS ,
         MAS_MON_VVD      MV  ,
         MDM_REV_LANE     RL
   WHERE TVPS.VSL_CD    (+) = VPS.VSL_CD
     AND TVPS.SKD_VOY_NO(+) = VPS.TURN_SKD_VOY_NO
     AND TVPS.SKD_DIR_CD(+) = VPS.TURN_SKD_DIR_CD
     AND VPS.VSL_CD         = MV.VSL_CD
     AND VPS.SKD_VOY_NO     = MV.SKD_VOY_NO
     AND VPS.SKD_DIR_CD     = MV.DIR_CD
     AND (VPS.SKD_CNG_STS_CD IS NULL OR VPS.SKD_CNG_STS_CD <> 'S')
     AND MV.DELT_FLG  = 'N'
     AND MV.RLANE_CD  = RL.RLANE_CD
     AND MV.TRD_CD    = RL.REP_TRD_CD
     AND RL.VSL_TP_CD = 'C' 
     AND MV.VSL_CD     = SUBSTR(@[in_vvd],1,4)
     and MV.SKD_VOY_NO = SUBSTR(@[in_vvd],5,4)
     and MV.DIR_CD     = SUBSTR(@[in_vvd],9,1)
)     
WHERE RHQ IN ( 
  DECODE(RLANE_CD, 'IMUTA', DECODE(DIR_CD, 'W', 'HAMRU', 'E', 'NYCRA'), 
                   'IMUAE', DECODE(DIR_CD, 'E', 'HAMRU', 'W', 'SHARC')) 
, DECODE(RLANE_CD ,'IMUAE', DECODE(DIR_CD, 'W', 'SINRS')) 
, DECODE(RLANE_CD ,'IMUAE', DECODE(DIR_CD, 'W', 'SELCDO'))
, DECODE(RLANE_CD ,'IMUAE', DECODE(DIR_CD, 'W', 'SELCTY'))
, DECODE(VSL_SLAN_CD,'IMU','XXXXX',RHQ) -- IMU가 아닐때
)			]]></sql>
			<params>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="in_vvd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
