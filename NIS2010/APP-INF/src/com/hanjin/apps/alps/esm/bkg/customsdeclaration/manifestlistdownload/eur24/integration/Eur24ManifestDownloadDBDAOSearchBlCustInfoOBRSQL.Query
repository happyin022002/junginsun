<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="Eur24ManifestDownloadDBDAOSearchBlCustInfoOBRSQL">
			<desc><![CDATA[BKG_CSTMS_EUR_IO_CUST table의 Customer정보를 VVD와 BL No.로 검색해 오는 SQL]]></desc>
			<sql><![CDATA[
SELECT 
  S.BL_NO BL_NO,
  S.VSL_CD||S.SKD_VOY_NO||S.SKD_DIR_CD VVD,
  S.CSTMS_PORT_CD CSTMS_PORT_CD,
  S.BKG_CUST_TP_CD S_BKG_CUST_TP_CD,
  S.CUST_CNT_CD S_CUST_CNT_CD,
  S.CUST_SEQ S_CUST_SEQ,
  S.CUST_NM S_CUST_NM,
  S.CUST_ADDR S_CUST_ADDR,
  S.CUST_CTY_NM S_CUST_CTY_NM,
  S.CSTMS_DECL_CNT_CD S_CSTMS_DECL_CNT_CD,
  S.CUST_ZIP_ID S_CUST_ZIP_ID,
  S.EUR_CSTMS_ST_NM S_EUR_CSTMS_ST_NM,
  S.EORI_NO S_EORI_NO,
  DECODE(S.BL_NO, '', 'I', 'U') S_IBFLAG,

  F.BKG_CUST_TP_CD F_BKG_CUST_TP_CD,
  F.CUST_CNT_CD F_CUST_CNT_CD,
  F.CUST_SEQ F_CUST_SEQ,
  F.CUST_NM F_CUST_NM,
  F.CUST_ADDR F_CUST_ADDR,
  F.CUST_CTY_NM F_CUST_CTY_NM,
  F.CSTMS_DECL_CNT_CD F_CSTMS_DECL_CNT_CD,
  F.CUST_ZIP_ID F_CUST_ZIP_ID,
  F.EUR_CSTMS_ST_NM F_EUR_CSTMS_ST_NM,
  F.EORI_NO F_EORI_NO,
  DECODE(F.BL_NO, '', 'I', 'U') F_IBFLAG,
  
  C.BKG_CUST_TP_CD C_BKG_CUST_TP_CD,
  C.CUST_CNT_CD C_CUST_CNT_CD,
  C.CUST_SEQ C_CUST_SEQ,
  C.CUST_NM C_CUST_NM,
  C.CUST_ADDR C_CUST_ADDR,
  C.CUST_CTY_NM C_CUST_CTY_NM,
  C.CSTMS_DECL_CNT_CD C_CSTMS_DECL_CNT_CD,
  C.CUST_ZIP_ID C_CUST_ZIP_ID,
  C.EUR_CSTMS_ST_NM C_EUR_CSTMS_ST_NM,
  C.EORI_NO C_EORI_NO, 
  DECODE(C.BL_NO, '', 'I', 'U') C_IBFLAG,
  
  N.BKG_CUST_TP_CD N_BKG_CUST_TP_CD,
  N.CUST_CNT_CD N_CUST_CNT_CD,
  N.CUST_SEQ N_CUST_SEQ,
  N.CUST_NM N_CUST_NM,
  N.CUST_ADDR N_CUST_ADDR,
  N.CUST_CTY_NM N_CUST_CTY_NM,
  N.CSTMS_DECL_CNT_CD N_CSTMS_DECL_CNT_CD,
  N.CUST_ZIP_ID N_CUST_ZIP_ID,
  N.EUR_CSTMS_ST_NM N_EUR_CSTMS_ST_NM,
  N.EORI_NO N_EORI_NO,
  DECODE(N.BL_NO, '', 'I', 'U') N_IBFLAG
FROM BKG_CSTMS_EUR_IO_CUST S, BKG_CSTMS_EUR_IO_CUST F, BKG_CSTMS_EUR_IO_CUST C, BKG_CSTMS_EUR_IO_CUST N
WHERE S.BL_NO = @[bl_no]
  AND S.VSL_CD = SUBSTR(@[vvd], 1, 4)
  AND S.SKD_VOY_NO = SUBSTR(@[vvd], 5, 4)
  AND S.SKD_DIR_CD = SUBSTR(@[vvd], 9, 1)
  AND S.CSTMS_PORT_CD = @[cstms_port_cd]
  AND S.CSTMS_PORT_CD = F.CSTMS_PORT_CD(+)
  AND S.CSTMS_PORT_CD = C.CSTMS_PORT_CD(+)
  AND S.CSTMS_PORT_CD = N.CSTMS_PORT_CD(+)
  AND S.BKG_CUST_TP_CD = 'S'
  AND F.BKG_CUST_TP_CD(+) = 'F'
  AND C.BKG_CUST_TP_CD(+) = 'C'
  AND N.BKG_CUST_TP_CD(+) = 'N'
  AND S.BL_NO = F.BL_NO(+)
  AND S.BL_NO = C.BL_NO(+)
  AND S.BL_NO = N.BL_NO(+)
  AND S.BND_TP_CD = 'O'
  AND F.BND_TP_CD = 'O'
  AND C.BND_TP_CD = 'O'
  AND N.BND_TP_CD = 'O'
  AND S.VSL_CD = F.VSL_CD(+)
  AND S.SKD_VOY_NO = F.SKD_VOY_NO(+)
  AND S.SKD_DIR_CD = F.SKD_DIR_CD(+)
  AND S.VSL_CD = C.VSL_CD(+)
  AND S.SKD_VOY_NO = C.SKD_VOY_NO(+)
  AND S.SKD_DIR_CD = C.SKD_DIR_CD(+)
  AND S.VSL_CD = N.VSL_CD(+)
  AND S.SKD_VOY_NO = N.SKD_VOY_NO(+)
  AND S.SKD_DIR_CD = N.SKD_DIR_CD(+)			]]></sql>
			<params>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="cstms_port_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
