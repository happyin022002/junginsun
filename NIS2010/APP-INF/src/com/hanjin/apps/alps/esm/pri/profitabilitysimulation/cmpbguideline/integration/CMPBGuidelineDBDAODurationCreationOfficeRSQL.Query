<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CMPBGuidelineDBDAODurationCreationOfficeRSQL">
			<desc><![CDATA[service scope 선택시 duration 조회]]></desc>
			<sql><![CDATA[
SELECT  A1.SVC_SCP_CD
,       A1.CRE_OFC_CD
,       A1.GLINE_SEQ
,       TO_CHAR(A1.EFF_DT,'YYYY-MM-DD') AS EFF_DT
,       TO_CHAR(A1.EXP_DT,'YYYY-MM-DD') AS EXP_DT
,       DECODE(NVL(A1.CFM_FLG,''),'','N',A1.CFM_FLG) AS CFM_FLG
,       B1.PRS_CUST_TP_CD
,       TO_CHAR(A1.CRE_DT,'YYYY-MM-DD') AS CRE_DT
,       B1.CUST_CNT_CD
,       B1.CUST_SEQ
,		A1.CRE_USR_ID
,		A1.CRE_DT
,		A1.UPD_USR_ID
,		A1.UPD_DT
,		'' AS MAX_GLINE_SEQ
,		'' AS CRE_OFC_CD_HIDDEN
,		'' AS PRS_CUST_TP_CD_BEFORE
,		(A1.GLINE_SEQ || ';' || A1.CRE_OFC_CD || ';' || B1.PRS_CUST_TP_CD) AS DURATION_KEY
FROM    PRI_CMPB_GLINE_MN A1
,       PRI_CMPB_GLINE_CUST B1
WHERE   A1.SVC_SCP_CD = B1.SVC_SCP_CD
AND     A1.CRE_OFC_CD = B1.CRE_OFC_CD
AND     A1.GLINE_SEQ = B1.GLINE_SEQ
AND     A1.SVC_SCP_CD = @[svc_scp_cd]
AND		TO_NUMBER(TO_CHAR(A1.EFF_DT,'YYYYMMDD')) >= TO_NUMBER(TO_CHAR(ADD_MONTHS(SYSDATE, -12),'YYYYMMDD'))
ORDER   BY A1.EFF_DT DESC, A1.EXP_DT DESC			]]></sql>
			<params>
				<param name="svc_scp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
