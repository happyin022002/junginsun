<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralBookingReceiptDBDAOSearchConfirmBookingNoticeRSQL">
			<desc><![CDATA[Confirm Booking notice]]></desc>
			<sql><![CDATA[
SELECT BCP.CNTC_PSON_EML CNTC_PSON_EML
FROM BKG_BOOKING BB
     ,BKG_XTER_RQST_MST BXRM
     ,BKG_CNTC_PSON BCP
WHERE BB.BKG_NO = @[bkg_no]
AND BB.BKG_STS_CD = 'F'
AND BB.NON_RT_STS_CD = 'F'
AND BB.ALOC_STS_CD = 'F'
AND BB.BKG_NO = BXRM.BKG_NO
AND BXRM.DOC_TP_CD = 'B'
AND BXRM.XTER_RQST_VIA_CD = 'WEB'
AND BXRM.AUTO_EML_FLG = 'Y'
AND BB.BKG_NO = BCP.BKG_NO
AND BCP.BKG_CNTC_PSON_TP_CD = 'BK'
AND BCP.CNTC_PSON_EML IS NOT NULL
AND NOT EXISTS (SELECT 'X' FROM BKG_NTC_HIS BNH WHERE BNH.BKG_NO = BB.BKG_NO AND BNH.NTC_VIA_CD = 'M' AND BNH.NTC_KND_CD = 'BK')
AND ROWNUM = 1			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
