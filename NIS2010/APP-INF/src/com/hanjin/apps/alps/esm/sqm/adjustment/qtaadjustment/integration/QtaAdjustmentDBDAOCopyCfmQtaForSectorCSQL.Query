<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="QtaAdjustmentDBDAOCopyCfmQtaForSectorCSQL">
			<desc><![CDATA[COPY VVD 기준의 SQM_SCTR_CFM_QTA 데이터를 복사한다.
* 2015.06.15 김용습 [CHM-201536164] 주간 MAS Open에 따른 타모듈 프로그램 적용 요청
* 2015.10.29 김용습 [CHM-201538492] [CSR 전환건] QTA Adjustment by VVD for IAS Sector 화면 보완 (Adjusting VVD Select, BSA Flag 칼럼 추가)]]></desc>
			<sql><![CDATA[
INSERT INTO SQM_SCTR_CFM_QTA(QTA_RLSE_VER_NO, BSE_TP_CD, BSE_YR, BSE_QTR_CD, OFC_VW_CD, RLANE_CD, DIR_CD, VSL_CD, SKD_VOY_NO, SKD_DIR_CD, RGN_OFC_CD, POL_CD, POD_CD, PF_GRP_CD, TRD_CD, SUB_TRD_CD, RHQ_CD, AQ_CD, FNL_BSA_CAPA, LOD_QTY, GRS_RPB_REV, PA_CM_UC_AMT, RA_CM_UC_AMT, POL_CALL_SEQ, POD_CALL_SEQ, SQM_CNG_TP_CD, CRE_USR_ID, CRE_DT, UPD_USR_ID, UPD_DT )
SELECT QTA_RLSE_VER_NO
      ,BSE_TP_CD
      ,BSE_YR
      ,BSE_QTR_CD
      ,OFC_VW_CD
      ,RLANE_CD
      ,DIR_CD
      ,DECODE(@[adj_vvd], 'Y', SUBSTR(@[vvd],1,4), SUBSTR(@[mas_vvd],1,4)) AS VSL_CD
      ,DECODE(@[adj_vvd], 'Y', SUBSTR(@[vvd],5,4), SUBSTR(@[mas_vvd],5,4)) AS SKD_VOY_NO
      ,DECODE(@[adj_vvd], 'Y', SUBSTR(@[vvd],9,1), SUBSTR(@[mas_vvd],9,1)) AS SKD_DIR_CD     
      ,RGN_OFC_CD
      ,POL_CD
      ,POD_CD
      ,PF_GRP_CD
      ,TRD_CD
      ,SUB_TRD_CD
      ,RHQ_CD
      ,AQ_CD
      ,FNL_BSA_CAPA
      ,LOD_QTY
      ,GRS_RPB_REV
      ,PA_CM_UC_AMT
      ,RA_CM_UC_AMT
      ,POL_CALL_SEQ
      ,POD_CALL_SEQ
      ,SQM_CNG_TP_CD
      ,@[usr_id] AS CRE_USR_ID
      ,SYSDATE   AS CRE_DT
      ,@[usr_id] AS UPD_USR_ID
      ,SYSDATE   AS UPD_DT 
  FROM SQM_SCTR_CFM_QTA
 WHERE 1=1
   AND QTA_RLSE_VER_NO = SUBSTR(@[bse_yr],-2) ||@[bse_qtr_cd]||'02'
   AND BSE_TP_CD       = @[bse_tp_cd]
   AND BSE_YR          = @[bse_yr]
   AND BSE_QTR_CD      = @[bse_qtr_cd]
   AND RLANE_CD        = @[rlane_cd]
   AND DIR_CD          = @[dir_cd]
   AND VSL_CD          = SUBSTR(@[copy_vvd],1,4)
   AND SKD_VOY_NO      = SUBSTR(@[copy_vvd],5,4)
   AND SKD_DIR_CD      = SUBSTR(@[copy_vvd],9,1)			]]></sql>
			<params>
				<param name="adj_vvd" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="mas_vvd" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="bse_yr" type="12" value="" out="N"/>
				<param name="bse_qtr_cd" type="12" value="" out="N"/>
				<param name="bse_tp_cd" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="copy_vvd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
