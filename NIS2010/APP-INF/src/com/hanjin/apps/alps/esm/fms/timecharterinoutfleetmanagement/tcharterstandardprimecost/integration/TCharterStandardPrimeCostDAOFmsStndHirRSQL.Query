<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TCharterStandardPrimeCostDAOFmsStndHirRSQL">
			<desc><![CDATA[Hire Creation Select]]></desc>
			<sql><![CDATA[
SELECT 
	A.FLET_CTRT_NO,
	A.HB_YRMON,
	A.VSL_CD,
	A.FLET_CTRT_TP_CD,
	B.VSL_ENG_NM, 
	B.VSL_KRN_NM,
	C.VSL_CNT_CD,
	DECODE(A.MKT_RT_APLY_FLG,'Y',1,0) MKT_RT_APLY_FLG,
	A.VSL_DZND_CAPA,
	A.BSE_14TON_VSL_CAPA,
	A.HIR_RT_N1ST_AMT,
	A.HIR_RT_N2ND_AMT,
	A.MAX_TEU_RT_AMT,
	A.STND_MAX_HIR_AMT,
	DECODE(D.HIR_APLY_FLG,'Y', TRUNC((E.HIR_RT_TTL_AMT / E.VSL_DZND_TTL_QTY) * E.VSL_DZND_CAPA, 2),
	   						  	     (E.HIR_RT_N1ST_AMT + E.HIR_RT_N2ND_AMT)) STND_MAX_HIR_AMT1,
	A.DIFF_STND_MAX_HIR_AMT,
    DECODE(D.HIR_APLY_FLG,'Y', (E.HIR_RT_N1ST_AMT + E.HIR_RT_N2ND_AMT) - 
                               (TRUNC((E.HIR_RT_TTL_AMT / E.VSL_DZND_TTL_QTY) * E.VSL_DZND_CAPA, 2)),
                               0) DIFF_STND_MAX_HIR_AMT1,
	A.TEU_14TON_RT_AMT,
	A.STND_14TON_HIR_AMT,
	DECODE(D.HIR_APLY_FLG,'Y',TRUNC((E.HIR_RT_TTL_AMT / E.BSE_14TON_VSL_TTL_QTY) * E.BSE_14TON_VSL_CAPA, 2),
                                    (E.HIR_RT_N1ST_AMT + E.HIR_RT_N2ND_AMT)) STND_14TON_HIR_AMT1,
	A.DIFF_STND_14TON_HIR_AMT,
	DECODE(D.HIR_APLY_FLG,'Y', (E.HIR_RT_N1ST_AMT + E.HIR_RT_N2ND_AMT) -
                               (TRUNC((E.HIR_RT_TTL_AMT / E.BSE_14TON_VSL_TTL_QTY) * E.BSE_14TON_VSL_CAPA, 2)),
                               0) DIFF_STND_14TON_HIR_AMT1,
	NVL((SELECT MKT_RT_AMT
           FROM FMS_MKT_RT
          WHERE MKT_RT_YRMON = @[hb_yrmon]
            AND NVL(DELT_FLG,'N') = 'N'
            AND A.VSL_DZND_CAPA BETWEEN RNG_FM_QTY AND RNG_TO_QTY
            AND ROWNUM = 1),0) MKT_RT_AMT
FROM FMS_STND_HIR A, 
     MDM_VSL_CNTR B, 
     FMS_CONTRACT C,
     FMS_TEU_RNG D,
     FMS_STND_HIR_BSE E
WHERE	A.VSL_CD = B.VSL_CD
AND A.FLET_CTRT_NO = C.FLET_CTRT_NO
AND A.HB_YRMON = @[hb_yrmon]
AND A.VSL_DZND_CAPA BETWEEN D.RNG_FM_QTY AND D.RNG_TO_QTY
AND D.RNG_YR = SUBSTR(@[hb_yrmon],1,4)
AND A.FLET_CTRT_NO = E.FLET_CTRT_NO
AND A.HB_YRMON = E.HB_YRMON
AND A.VSL_CD = E.VSL_CD
ORDER BY A.FLET_CTRT_TP_CD, A.VSL_DZND_CAPA, A.VSL_CD			]]></sql>
			<params>
				<param name="hb_yrmon" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
