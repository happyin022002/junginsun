/*=========================================================
*Copyright(c) 2015 CyberLogitec
*@FileName : BlRatingDBDAOModifyRateCntCdUSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2015.04.22
*@LastModifier : 
*@LastVersion : 1.0
* 2015.04.22 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esm.bkg.outbounddocumentation.blrating.blrating.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class BlRatingDBDAOModifyRateCntCdUSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * ModifyRateCntCd
	  * </pre>
	  */
	public BlRatingDBDAOModifyRateCntCdUSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("bkg_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("user_id",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esm.bkg.outbounddocumentation.blrating.blrating.integration").append("\n"); 
		query.append("FileName : BlRatingDBDAOModifyRateCntCdUSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if (${ca_flg} =='Y')" ).append("\n"); 
		query.append("	#if(${bkg_no} !='')" ).append("\n"); 
		query.append("UPDATE /*+ bypass_ujvc */" ).append("\n"); 
		query.append("    (" ).append("\n"); 
		query.append("    SELECT " ).append("\n"); 
		query.append("           RT.PPD_PAYR_CNT_CD AS ORG_PPD_PAYR_CNT_CD," ).append("\n"); 
		query.append("           RT.PPD_PAYR_CUST_SEQ AS ORG_PPD_PAYR_CUST_SEQ," ).append("\n"); 
		query.append("           RT.CLT_PAYR_CNT_CD AS ORG_CLT_PAYR_CNT_CD," ).append("\n"); 
		query.append("           RT.CLT_PAYR_CUST_SEQ AS ORG_CLT_PAYR_CUST_SEQ," ).append("\n"); 
		query.append("           CR_RT_P.CUST_CNT_CD AS CR_RT_P_CUST_CNT_CD," ).append("\n"); 
		query.append("           CR_RT_P.CUST_SEQ AS CR_RT_P_CUST_SEQ," ).append("\n"); 
		query.append("           CR_RT_C.CUST_CNT_CD AS CR_RT_C_CUST_CNT_CD," ).append("\n"); 
		query.append("           CR_RT_C.CUST_SEQ AS CR_RT_C_CUST_SEQ," ).append("\n"); 
		query.append("           CASE WHEN (POR_L.CONTI_CD ='F' OR POR_L.CONTI_CD = 'E') AND(F.CUST_SEQ IS NOT NULL AND NVL(F.CUST_SEQ,'') <> '0') AND EXISTS (SELECT 'Y' FROM MDM_LOCATION FL " ).append("\n"); 
		query.append("                                                                        WHERE  FL.CONTI_CD ='E' " ).append("\n"); 
		query.append("                                                                          AND  FL.DELT_FLG ='N'" ).append("\n"); 
		query.append("                                                                          AND  FL.CNT_CD = F.CUST_CNT_CD" ).append("\n"); 
		query.append("                                                                          AND ROWNUM =1 )" ).append("\n"); 
		query.append("                THEN F.CUST_CNT_CD" ).append("\n"); 
		query.append("                WHEN BK.BKG_OFC_CD IN (SELECT ATTR_CTNT1" ).append("\n"); 
		query.append("                                       FROM BKG_HRD_CDG_CTNT" ).append("\n"); 
		query.append("                                       WHERE HRD_CDG_ID = 'PPD_PAYER_EXCEPTION')                 " ).append("\n"); 
		query.append("                THEN F.CUST_CNT_CD" ).append("\n"); 
		query.append("           ELSE CR_RT_P.CUST_CNT_CD" ).append("\n"); 
		query.append("           END UP_PPD_PAYR_CNT_CD," ).append("\n"); 
		query.append("           CASE WHEN (POR_L.CONTI_CD ='F' OR POR_L.CONTI_CD = 'E') AND(F.CUST_SEQ IS NOT NULL AND NVL(F.CUST_SEQ,'') <> '0') AND EXISTS (SELECT 'Y' FROM MDM_LOCATION FL " ).append("\n"); 
		query.append("                                                                        WHERE  FL.CONTI_CD ='E' " ).append("\n"); 
		query.append("                                                                          AND  FL.DELT_FLG ='N'" ).append("\n"); 
		query.append("                                                                          AND  FL.CNT_CD = F.CUST_CNT_CD" ).append("\n"); 
		query.append("                                                                          AND ROWNUM =1 )" ).append("\n"); 
		query.append("                THEN F.CUST_SEQ" ).append("\n"); 
		query.append("                WHEN BK.BKG_OFC_CD IN (SELECT ATTR_CTNT1" ).append("\n"); 
		query.append("                                       FROM BKG_HRD_CDG_CTNT" ).append("\n"); 
		query.append("                                       WHERE HRD_CDG_ID = 'PPD_PAYER_EXCEPTION')  " ).append("\n"); 
		query.append("                THEN F.CUST_SEQ" ).append("\n"); 
		query.append("           ELSE CR_RT_P.CUST_SEQ" ).append("\n"); 
		query.append("           END UP_PPD_PAYR_CUST_SEQ," ).append("\n"); 
		query.append("           CASE WHEN BK.CUST_TO_ORD_FLG='Y' AND ( NVL(N.CUST_CNT_CD,'')||N.CUST_SEQ = '0' OR N.CUST_CNT_CD||N.CUST_SEQ IS NULL OR N.CUST_SEQ IS NULL )" ).append("\n"); 
		query.append("                THEN OFC.REP_CUST_CNT_CD --FIN_OFC 의 AR CUSTOMER" ).append("\n"); 
		query.append("                WHEN BK.CUST_TO_ORD_FLG='Y' AND ( NVL(N.CUST_CNT_CD,'')||N.CUST_SEQ <> '0' AND N.CUST_CNT_CD||N.CUST_SEQ IS NOT NULL AND N.CUST_SEQ IS NOT NULL )" ).append("\n"); 
		query.append("                THEN N.CUST_CNT_CD    -- NOTIFY" ).append("\n"); 
		query.append("                ELSE CR_RT_C.CUST_CNT_CD  -- NOT NULL 을 위해 DEFALUT " ).append("\n"); 
		query.append("                END UP_CLT_PAYR_CNT_CD," ).append("\n"); 
		query.append("           CASE WHEN BK.CUST_TO_ORD_FLG='Y' AND ( NVL(N.CUST_CNT_CD,'')||N.CUST_SEQ = '0' OR N.CUST_CNT_CD||N.CUST_SEQ IS NULL OR N.CUST_SEQ IS NULL)" ).append("\n"); 
		query.append("                THEN OFC.REP_CUST_SEQ   --FIN_OFC 의 AR CUSTOMER" ).append("\n"); 
		query.append("                WHEN BK.CUST_TO_ORD_FLG='Y' AND ( NVL(N.CUST_CNT_CD,'')||N.CUST_SEQ <> '0' AND N.CUST_CNT_CD||N.CUST_SEQ IS NOT NULL AND N.CUST_SEQ IS NOT NULL)" ).append("\n"); 
		query.append("                THEN N.CUST_SEQ       -- NOTIFY" ).append("\n"); 
		query.append("                ELSE CR_RT_C.CUST_SEQ -- NOT NULL 을 위해 DEFALUT " ).append("\n"); 
		query.append("                END UP_CLT_PAYR_CUST_SEQ," ).append("\n"); 
		query.append("                F.CUST_CNT_CD AS F_CUST_CNT_CD," ).append("\n"); 
		query.append("		RT.UPD_USR_ID," ).append("\n"); 
		query.append("		@[user_id] AS UP_USR," ).append("\n"); 
		query.append("		RT.UPD_DT," ).append("\n"); 
		query.append("		SYSDATE AS UP_DT" ).append("\n"); 
		query.append("         FROM  BKG_BKG_HIS BK, BKG_RT_HIS RT, BKG_CUST_HIS F, BKG_CUST_HIS N, MDM_LOCATION POR_L, MDM_LOCATION DEL_L," ).append("\n"); 
		query.append("                MDM_ORGANIZATION OFC, " ).append("\n"); 
		query.append("                (SELECT ROWNUM,A.* FROM " ).append("\n"); 
		query.append("				    (" ).append("\n"); 
		query.append("					--PPD" ).append("\n"); 
		query.append("					SELECT BKG.BKG_NO BKG_NO," ).append("\n"); 
		query.append("					        11 AS FLG," ).append("\n"); 
		query.append("					        'S' AS BKG_CUST_TP_CD," ).append("\n"); 
		query.append("						 CR_CLT_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("					        BCUST.CUST_CNT_CD CUST_CNT_CD," ).append("\n"); 
		query.append("					        BCUST.CUST_SEQ CUST_SEQ," ).append("\n"); 
		query.append("					        BCUST.CUST_LGL_ENG_NM CUST_NM" ).append("\n"); 
		query.append("					FROM   MDM_CR_CUST CUST," ).append("\n"); 
		query.append("					       BKG_BKG_HIS BKG," ).append("\n"); 
		query.append("					       (SELECT S.CUST_CNT_CD, S.CUST_SEQ, C.CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("					       FROM BKG_CUST_HIS S, " ).append("\n"); 
		query.append("					            MDM_CUSTOMER C" ).append("\n"); 
		query.append("					        WHERE  S.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					        AND S.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("					        AND S.CUST_CNT_CD = C.CUST_CNT_CD" ).append("\n"); 
		query.append("					        AND S.CUST_SEQ = C.CUST_SEQ" ).append("\n"); 
		query.append("						AND C.DELT_FLG ='N'" ).append("\n"); 
		query.append("						AND NVL(C.NMD_CUST_FLG,'N') ='N'" ).append("\n"); 
		query.append("						AND S.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("					        ) BCUST" ).append("\n"); 
		query.append("					WHERE  BKG.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					AND    (CUST.CUST_CNT_CD, CUST.CUST_SEQ) = (SELECT CUST_CNT_CD, CUST_SEQ" ).append("\n"); 
		query.append("					                                    FROM   BKG_BKG_HIS B, BKG_CUST_HIS S" ).append("\n"); 
		query.append("					                                    WHERE  B.BKG_NO = @[bkg_no] " ).append("\n"); 
		query.append("					                                    AND S.BKG_NO = B.BKG_NO " ).append("\n"); 
		query.append("					                                    AND S.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("														AND S.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("														AND B.CORR_NO ='TMP0000001')" ).append("\n"); 
		query.append("					AND    0 < CUST.OB_CR_TERM_DYS" ).append("\n"); 
		query.append("					AND    CUST.CR_ST_DT  <= (SELECT TO_CHAR(BKG_CRE_DT,'RRRRMMDD') FROM BKG_BKG_HIS WHERE BKG_NO = @[bkg_no] AND CORR_NO ='TMP0000001')" ).append("\n"); 
		query.append("					AND    CUST.CR_END_DT >= (SELECT TO_CHAR(BKG_CRE_DT,'RRRRMMDD') FROM BKG_BKG_HIS WHERE BKG_NO = @[bkg_no] AND CORR_NO ='TMP0000001')" ).append("\n"); 
		query.append("					AND    CUST.DELT_FLG ='N'" ).append("\n"); 
		query.append("					AND	   BKG.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("					UNION" ).append("\n"); 
		query.append("					--PPD OFFICE CODE2" ).append("\n"); 
		query.append("					--비신용화주중에 MDM OFFICE 에 OFC_TP_CD가 QT 인경우 POR 의 FINC_CTRL_OFC_CD 넣어줌" ).append("\n"); 
		query.append("					SELECT B.BKG_NO BKG_NO," ).append("\n"); 
		query.append("					        12 AS FLG," ).append("\n"); 
		query.append("					        'S' AS BKG_CUST_TP_CD," ).append("\n"); 
		query.append("					        DECODE(O.OFC_TP_CD,'QT',L.FINC_CTRL_OFC_CD,C.OFC_CD) OFC_CD," ).append("\n"); 
		query.append("					        C.CUST_CNT_CD," ).append("\n"); 
		query.append("					        C.CUST_SEQ," ).append("\n"); 
		query.append("					        C.CUST_LGL_ENG_NM AS CUST_NM" ).append("\n"); 
		query.append("					FROM    BKG_BKG_HIS B," ).append("\n"); 
		query.append("					        BKG_CUST_HIS S," ).append("\n"); 
		query.append("					        MDM_CUSTOMER C," ).append("\n"); 
		query.append("							MDM_ORGANIZATION O," ).append("\n"); 
		query.append("							MDM_LOCATION L" ).append("\n"); 
		query.append("					WHERE  B.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					AND    S.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("					AND    S.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("					AND    S.CUST_CNT_CD = C.CUST_CNT_CD" ).append("\n"); 
		query.append("					AND    S.CUST_SEQ = C.CUST_SEQ" ).append("\n"); 
		query.append("					AND    C.DELT_FLG ='N'" ).append("\n"); 
		query.append("					AND    O.DELT_FLG ='N'" ).append("\n"); 
		query.append("					AND    L.DELT_FLG ='N'" ).append("\n"); 
		query.append("					AND    C.OFC_CD = O.OFC_CD " ).append("\n"); 
		query.append("					AND    NVL(C.NMD_CUST_FLG,'N') ='N'	" ).append("\n"); 
		query.append("					AND    B.POR_CD = L.LOC_CD" ).append("\n"); 
		query.append("					AND	   S.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("					AND    B.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("					ORDER BY FLG" ).append("\n"); 
		query.append("					) A" ).append("\n"); 
		query.append("					WHERE ROWNUM = 1) CR_RT_P," ).append("\n"); 
		query.append("					(SELECT ROWNUM,A.* FROM " ).append("\n"); 
		query.append("					(" ).append("\n"); 
		query.append("					--CCT" ).append("\n"); 
		query.append("					SELECT  BKG.BKG_NO AS BKG_NO," ).append("\n"); 
		query.append("					        21 AS FLG," ).append("\n"); 
		query.append("					        'C' AS BKG_CUST_TP_CD," ).append("\n"); 
		query.append("					        CR_CLT_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("					        BCUST.CUST_CNT_CD AS CUST_CNT_CD," ).append("\n"); 
		query.append("					        BCUST.CUST_SEQ AS CUST_SEQ," ).append("\n"); 
		query.append("					        MCUST.CUST_LGL_ENG_NM AS CUST_NM" ).append("\n"); 
		query.append("					FROM    MDM_CR_CUST CUST," ).append("\n"); 
		query.append("					        BKG_BKG_HIS BKG," ).append("\n"); 
		query.append("					        BKG_CUST_HIS BCUST," ).append("\n"); 
		query.append("					        MDM_CUSTOMER MCUST" ).append("\n"); 
		query.append("					WHERE  BKG.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					AND    BKG.BKG_NO = BCUST.BKG_NO" ).append("\n"); 
		query.append("					AND    BCUST.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("					AND    CUST.CUST_CNT_CD = BCUST.CUST_CNT_CD" ).append("\n"); 
		query.append("					AND    CUST.CUST_SEQ = BCUST.CUST_SEQ" ).append("\n"); 
		query.append("					AND    BCUST.CUST_CNT_CD = MCUST.CUST_CNT_CD" ).append("\n"); 
		query.append("					AND    BCUST.CUST_SEQ = MCUST.CUST_SEQ    " ).append("\n"); 
		query.append("					AND    IB_CR_TERM_DYS > 0" ).append("\n"); 
		query.append("					AND    CR_ST_DT  <= (SELECT TO_CHAR(BKG_CRE_DT,'RRRRMMDD') FROM BKG_BKG_HIS WHERE BKG_NO = @[bkg_no] AND CORR_NO ='TMP0000001')" ).append("\n"); 
		query.append("					AND    CR_END_DT >= (SELECT TO_CHAR(BKG_CRE_DT,'RRRRMMDD') FROM BKG_BKG_HIS WHERE BKG_NO = @[bkg_no] AND CORR_NO ='TMP0000001')" ).append("\n"); 
		query.append("					AND    MCUST.DELT_FLG ='N'" ).append("\n"); 
		query.append("					AND    NVL(MCUST.NMD_CUST_FLG,'N') ='N'" ).append("\n"); 
		query.append("					AND    CUST.DELT_FLG ='N'" ).append("\n"); 
		query.append("					AND    BKG.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("					AND    BCUST.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("					UNION" ).append("\n"); 
		query.append("					--CCT OFFICE CODE2" ).append("\n"); 
		query.append("					SELECT B.BKG_NO BKG_NO," ).append("\n"); 
		query.append("					        22 AS FLG," ).append("\n"); 
		query.append("					        'C' AS BKG_CUST_TP_CD," ).append("\n"); 
		query.append("					        FINC_CTRL_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("					        S.CUST_CNT_CD  AS CUST_CNT_CD," ).append("\n"); 
		query.append("					        NVL(S.CUST_SEQ,'1') AS CUST_SEQ," ).append("\n"); 
		query.append("					        C.CUST_LGL_ENG_NM AS CUST_NM" ).append("\n"); 
		query.append("					FROM    MDM_LOCATION M, " ).append("\n"); 
		query.append("					        BKG_BKG_HIS B, " ).append("\n"); 
		query.append("					        BKG_CUST_HIS S," ).append("\n"); 
		query.append("					        MDM_CUSTOMER C" ).append("\n"); 
		query.append("					WHERE  B.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					AND    S.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("					AND    S.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("					AND    S.CUST_CNT_CD = C.CUST_CNT_CD" ).append("\n"); 
		query.append("					AND    S.CUST_SEQ = C.CUST_SEQ" ).append("\n"); 
		query.append("					AND    B.DEL_CD = M.LOC_CD" ).append("\n"); 
		query.append("					AND    C.DELT_FLG = 'N'" ).append("\n"); 
		query.append("					AND	NVL(C.NMD_CUST_FLG,'N') ='N'" ).append("\n"); 
		query.append("					AND B.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("					AND S.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("					UNION" ).append("\n"); 
		query.append("					--REP CUSTOMER" ).append("\n"); 
		query.append("					SELECT BKG_NO," ).append("\n"); 
		query.append("					        31 AS FLG," ).append("\n"); 
		query.append("					        'R'AS BKG_CUST_TP_CD," ).append("\n"); 
		query.append("					        (SELECT  FINC_CTRL_OFC_CD" ).append("\n"); 
		query.append("					            FROM MDM_LOCATION" ).append("\n"); 
		query.append("					            WHERE LOC_CD = (SELECT DEL_CD" ).append("\n"); 
		query.append("					                            FROM  BKG_BKG_HIS" ).append("\n"); 
		query.append("					                            WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("												AND CORR_NO ='TMP0000001')) AS OFC_CD," ).append("\n"); 
		query.append("					        REP_CUST_CNT_CD AS CUST_CNT_CD," ).append("\n"); 
		query.append("					        REP_CUST_SEQ AS CUST_SEQ," ).append("\n"); 
		query.append("					        MCUST.CUST_LGL_ENG_NM AS CUST_NM" ).append("\n"); 
		query.append("					FROM   MDM_ORGANIZATION OFC, " ).append("\n"); 
		query.append("					        BKG_BKG_HIS BKG," ).append("\n"); 
		query.append("					        MDM_CUSTOMER MCUST" ).append("\n"); 
		query.append("					WHERE  BKG.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					AND    REP_CUST_CNT_CD = MCUST.CUST_CNT_CD" ).append("\n"); 
		query.append("					AND    REP_CUST_SEQ = MCUST.CUST_SEQ" ).append("\n"); 
		query.append("					AND    MCUST.DELT_FLG ='N'" ).append("\n"); 
		query.append("					AND	NVL(MCUST.NMD_CUST_FLG,'N') ='N'" ).append("\n"); 
		query.append("					AND BKG.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("					AND    OFC.OFC_CD = NVL((SELECT CR_CLT_OFC_CD" ).append("\n"); 
		query.append("					                        FROM MDM_CR_CUST" ).append("\n"); 
		query.append("					                        WHERE (CUST_CNT_CD, CUST_SEQ) = (SELECT CUST_CNT_CD, CUST_SEQ" ).append("\n"); 
		query.append("					                                                            FROM   BKG_BKG_HIS B," ).append("\n"); 
		query.append("					                                                                    BKG_CUST_HIS C" ).append("\n"); 
		query.append("					                                                            WHERE  B.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					                                                            AND    C.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("																				AND B.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("																				AND C.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("					                                                            AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("																				)" ).append("\n"); 
		query.append("					                        AND 0 < IB_CR_TERM_DYS" ).append("\n"); 
		query.append("											AND MCUST.DELT_FLG ='N'" ).append("\n"); 
		query.append("					                        AND CR_ST_DT  <= (SELECT TO_CHAR(BKG_CRE_DT,'RRRRMMDD') FROM BKG_BKG_HIS WHERE BKG_NO = @[bkg_no] AND CORR_NO ='TMP0000001')" ).append("\n"); 
		query.append("					                        AND CR_END_DT >= (SELECT TO_CHAR(BKG_CRE_DT,'RRRRMMDD') FROM BKG_BKG_HIS WHERE BKG_NO = @[bkg_no] AND CORR_NO ='TMP0000001'))," ).append("\n"); 
		query.append("					                    (SELECT  FINC_CTRL_OFC_CD" ).append("\n"); 
		query.append("					                        FROM MDM_LOCATION" ).append("\n"); 
		query.append("					                        WHERE LOC_CD = (SELECT DEL_CD" ).append("\n"); 
		query.append("					                                        FROM  BKG_BKG_HIS" ).append("\n"); 
		query.append("					                                        WHERE BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("															AND CORR_NO ='TMP0000001')" ).append("\n"); 
		query.append("					                    )" ).append("\n"); 
		query.append("					                    )" ).append("\n"); 
		query.append("					                    ORDER BY FLG" ).append("\n"); 
		query.append("					) A" ).append("\n"); 
		query.append("					WHERE " ).append("\n"); 
		query.append("					ROWNUM = 1) CR_RT_C" ).append("\n"); 
		query.append("					" ).append("\n"); 
		query.append("         WHERE  BK.BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("           AND  BK.BKG_STS_CD <>'X'" ).append("\n"); 
		query.append("           AND  BK.BKG_NO = RT.BKG_NO" ).append("\n"); 
		query.append("           AND  BK.BKG_NO = N.BKG_NO" ).append("\n"); 
		query.append("           AND  BK.BKG_NO = F.BKG_NO" ).append("\n"); 
		query.append("           AND  N.BKG_CUST_TP_CD ='N'" ).append("\n"); 
		query.append("           AND  F.BKG_CUST_TP_CD ='F'" ).append("\n"); 
		query.append("           AND  BK.POR_CD = POR_L.LOC_CD" ).append("\n"); 
		query.append("           AND  POR_L.DELT_FLG ='N'" ).append("\n"); 
		query.append("           AND  BK.DEL_CD = DEL_L.LOC_CD" ).append("\n"); 
		query.append("           AND  DEL_L.DELT_FLG ='N'" ).append("\n"); 
		query.append("           AND  DEL_L.FINC_CTRL_OFC_CD = OFC.OFC_CD" ).append("\n"); 
		query.append("           AND  OFC.DELT_FLG='N'" ).append("\n"); 
		query.append("           AND  BK.BKG_NO = CR_RT_P.BKG_NO(+)" ).append("\n"); 
		query.append("           AND  BK.BKG_NO = CR_RT_C.BKG_NO(+)" ).append("\n"); 
		query.append("		   AND  BK.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("  		   AND  RT.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("   		   AND  N.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append("   		   AND  F.CORR_NO ='TMP0000001'" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("SET ORG_PPD_PAYR_CNT_CD = UP_PPD_PAYR_CNT_CD," ).append("\n"); 
		query.append("    ORG_PPD_PAYR_CUST_SEQ = UP_PPD_PAYR_CUST_SEQ," ).append("\n"); 
		query.append("    ORG_CLT_PAYR_CNT_CD = UP_CLT_PAYR_CNT_CD," ).append("\n"); 
		query.append("    ORG_CLT_PAYR_CUST_SEQ = UP_CLT_PAYR_CUST_SEQ," ).append("\n"); 
		query.append("    UPD_USR_ID = UP_USR," ).append("\n"); 
		query.append("    UPD_DT = UP_DT" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	#if(${bkg_no} !='')" ).append("\n"); 
		query.append("UPDATE /*+ bypass_ujvc+*/" ).append("\n"); 
		query.append("    (" ).append("\n"); 
		query.append("    SELECT " ).append("\n"); 
		query.append("           RT.PPD_PAYR_CNT_CD AS ORG_PPD_PAYR_CNT_CD," ).append("\n"); 
		query.append("           RT.PPD_PAYR_CUST_SEQ AS ORG_PPD_PAYR_CUST_SEQ," ).append("\n"); 
		query.append("           RT.CLT_PAYR_CNT_CD AS ORG_CLT_PAYR_CNT_CD," ).append("\n"); 
		query.append("           RT.CLT_PAYR_CUST_SEQ AS ORG_CLT_PAYR_CUST_SEQ," ).append("\n"); 
		query.append("           CR_RT_P.CUST_CNT_CD AS CR_RT_P_CUST_CNT_CD," ).append("\n"); 
		query.append("           CR_RT_P.CUST_SEQ AS CR_RT_P_CUST_SEQ," ).append("\n"); 
		query.append("           CR_RT_C.CUST_CNT_CD AS CR_RT_C_CUST_CNT_CD," ).append("\n"); 
		query.append("           CR_RT_C.CUST_SEQ AS CR_RT_C_CUST_SEQ," ).append("\n"); 
		query.append("           CASE WHEN (POR_L.CONTI_CD ='F' OR POR_L.CONTI_CD = 'E') AND(F.CUST_SEQ IS NOT NULL AND NVL(F.CUST_SEQ,'') <> '0') AND EXISTS (SELECT 'Y' FROM MDM_LOCATION FL " ).append("\n"); 
		query.append("                                                                        WHERE  FL.CONTI_CD ='E' " ).append("\n"); 
		query.append("                                                                          AND  FL.DELT_FLG ='N'" ).append("\n"); 
		query.append("                                                                          AND  FL.CNT_CD = F.CUST_CNT_CD" ).append("\n"); 
		query.append("                                                                          AND ROWNUM =1 )" ).append("\n"); 
		query.append("                THEN F.CUST_CNT_CD" ).append("\n"); 
		query.append("                WHEN BK.BKG_OFC_CD IN (SELECT ATTR_CTNT1" ).append("\n"); 
		query.append("                                       FROM BKG_HRD_CDG_CTNT" ).append("\n"); 
		query.append("                                       WHERE HRD_CDG_ID = 'PPD_PAYER_EXCEPTION') " ).append("\n"); 
		query.append("                THEN F.CUST_CNT_CD" ).append("\n"); 
		query.append("           ELSE CR_RT_P.CUST_CNT_CD" ).append("\n"); 
		query.append("           END UP_PPD_PAYR_CNT_CD," ).append("\n"); 
		query.append("           CASE WHEN (POR_L.CONTI_CD ='F' OR POR_L.CONTI_CD = 'E') AND(F.CUST_SEQ IS NOT NULL AND NVL(F.CUST_SEQ,'') <> '0') AND EXISTS (SELECT 'Y' FROM MDM_LOCATION FL " ).append("\n"); 
		query.append("                                                                        WHERE  FL.CONTI_CD ='E' " ).append("\n"); 
		query.append("                                                                          AND  FL.DELT_FLG ='N'" ).append("\n"); 
		query.append("                                                                          AND  FL.CNT_CD = F.CUST_CNT_CD" ).append("\n"); 
		query.append("                                                                          AND ROWNUM =1 )" ).append("\n"); 
		query.append("                THEN F.CUST_SEQ" ).append("\n"); 
		query.append("                WHEN BK.BKG_OFC_CD IN (SELECT ATTR_CTNT1" ).append("\n"); 
		query.append("                                       FROM BKG_HRD_CDG_CTNT" ).append("\n"); 
		query.append("                                       WHERE HRD_CDG_ID = 'PPD_PAYER_EXCEPTION') " ).append("\n"); 
		query.append("                THEN F.CUST_SEQ" ).append("\n"); 
		query.append("           ELSE CR_RT_P.CUST_SEQ" ).append("\n"); 
		query.append("           END UP_PPD_PAYR_CUST_SEQ," ).append("\n"); 
		query.append("           CASE WHEN BK.CUST_TO_ORD_FLG='Y' AND ( NVL(N.CUST_CNT_CD,'')||N.CUST_SEQ = '0' OR N.CUST_CNT_CD||N.CUST_SEQ IS NULL OR N.CUST_SEQ IS NULL)" ).append("\n"); 
		query.append("                THEN OFC.REP_CUST_CNT_CD --FIN_OFC 의 AR CUSTOMER" ).append("\n"); 
		query.append("                WHEN BK.CUST_TO_ORD_FLG='Y' AND ( NVL(N.CUST_CNT_CD,'')||N.CUST_SEQ <> '0' AND N.CUST_CNT_CD||N.CUST_SEQ IS NOT NULL AND N.CUST_SEQ IS NOT NULL )" ).append("\n"); 
		query.append("                THEN N.CUST_CNT_CD    -- NOTIFY" ).append("\n"); 
		query.append("                ELSE CR_RT_C.CUST_CNT_CD  -- NOT NULL 을 위해 DEFALUT " ).append("\n"); 
		query.append("                END UP_CLT_PAYR_CNT_CD," ).append("\n"); 
		query.append("           CASE WHEN BK.CUST_TO_ORD_FLG='Y' AND ( NVL(N.CUST_CNT_CD,'')||N.CUST_SEQ = '0' OR N.CUST_CNT_CD||N.CUST_SEQ IS NULL OR N.CUST_SEQ IS NULL)" ).append("\n"); 
		query.append("                THEN OFC.REP_CUST_SEQ   --FIN_OFC 의 AR CUSTOMER" ).append("\n"); 
		query.append("                WHEN BK.CUST_TO_ORD_FLG='Y' AND ( NVL(N.CUST_CNT_CD,'')||N.CUST_SEQ <> '0' AND N.CUST_CNT_CD||N.CUST_SEQ IS NOT NULL AND N.CUST_SEQ IS NOT NULL)" ).append("\n"); 
		query.append("                THEN N.CUST_SEQ       -- NOTIFY" ).append("\n"); 
		query.append("                ELSE CR_RT_C.CUST_SEQ -- NOT NULL 을 위해 DEFALUT " ).append("\n"); 
		query.append("                END UP_CLT_PAYR_CUST_SEQ," ).append("\n"); 
		query.append("                F.CUST_CNT_CD AS F_CUST_CNT_CD," ).append("\n"); 
		query.append("		RT.UPD_USR_ID," ).append("\n"); 
		query.append("		@[user_id] AS UP_USR," ).append("\n"); 
		query.append("		RT.UPD_DT," ).append("\n"); 
		query.append("		SYSDATE AS UP_DT" ).append("\n"); 
		query.append("         FROM  BKG_BOOKING BK, BKG_RATE RT, BKG_CUSTOMER F, BKG_CUSTOMER N, MDM_LOCATION POR_L, MDM_LOCATION DEL_L," ).append("\n"); 
		query.append("                MDM_ORGANIZATION OFC, " ).append("\n"); 
		query.append("                (SELECT ROWNUM,A.* FROM " ).append("\n"); 
		query.append("				    (" ).append("\n"); 
		query.append("					--PPD" ).append("\n"); 
		query.append("					SELECT BKG.BKG_NO BKG_NO," ).append("\n"); 
		query.append("					        11 AS FLG," ).append("\n"); 
		query.append("					        'S' AS BKG_CUST_TP_CD," ).append("\n"); 
		query.append("						 CR_CLT_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("					        BCUST.CUST_CNT_CD CUST_CNT_CD," ).append("\n"); 
		query.append("					        BCUST.CUST_SEQ CUST_SEQ," ).append("\n"); 
		query.append("					        BCUST.CUST_LGL_ENG_NM CUST_NM" ).append("\n"); 
		query.append("					FROM   MDM_CR_CUST CUST," ).append("\n"); 
		query.append("					       BKG_BOOKING BKG," ).append("\n"); 
		query.append("					       (SELECT S.CUST_CNT_CD, S.CUST_SEQ, C.CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("					       FROM BKG_CUSTOMER S, " ).append("\n"); 
		query.append("					            MDM_CUSTOMER C" ).append("\n"); 
		query.append("					        WHERE  S.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					        AND S.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("					        AND S.CUST_CNT_CD = C.CUST_CNT_CD" ).append("\n"); 
		query.append("					        AND S.CUST_SEQ = C.CUST_SEQ" ).append("\n"); 
		query.append("						AND C.DELT_FLG ='N'" ).append("\n"); 
		query.append("						AND NVL(C.NMD_CUST_FLG,'N') ='N'" ).append("\n"); 
		query.append("					        ) BCUST" ).append("\n"); 
		query.append("					WHERE  BKG.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					AND    (CUST.CUST_CNT_CD, CUST.CUST_SEQ) = (SELECT CUST_CNT_CD, CUST_SEQ" ).append("\n"); 
		query.append("					                                    FROM   BKG_BOOKING B, BKG_CUSTOMER S" ).append("\n"); 
		query.append("					                                    WHERE  B.BKG_NO = @[bkg_no] " ).append("\n"); 
		query.append("					                                    AND S.BKG_NO = B.BKG_NO " ).append("\n"); 
		query.append("					                                    AND S.BKG_CUST_TP_CD = 'S')" ).append("\n"); 
		query.append("					AND    0 < CUST.OB_CR_TERM_DYS" ).append("\n"); 
		query.append("					AND    CUST.CR_ST_DT  <= (SELECT TO_CHAR(BKG_CRE_DT,'RRRRMMDD') FROM BKG_BOOKING WHERE BKG_NO = @[bkg_no])" ).append("\n"); 
		query.append("					AND    CUST.CR_END_DT >= (SELECT TO_CHAR(BKG_CRE_DT,'RRRRMMDD') FROM BKG_BOOKING WHERE BKG_NO = @[bkg_no])" ).append("\n"); 
		query.append("					AND    CUST.DELT_FLG ='N'" ).append("\n"); 
		query.append("					UNION" ).append("\n"); 
		query.append("					--PPD OFFICE CODE2" ).append("\n"); 
		query.append("					--비신용화주중에 MDM OFFICE 에 OFC_TP_CD가 QT 인경우 POR 의 FINC_CTRL_OFC_CD 넣어줌" ).append("\n"); 
		query.append("					SELECT B.BKG_NO BKG_NO," ).append("\n"); 
		query.append("					        12 AS FLG," ).append("\n"); 
		query.append("					        'S' AS BKG_CUST_TP_CD," ).append("\n"); 
		query.append("					        DECODE(O.OFC_TP_CD,'QT',L.FINC_CTRL_OFC_CD,C.OFC_CD) OFC_CD," ).append("\n"); 
		query.append("					        C.CUST_CNT_CD," ).append("\n"); 
		query.append("					        C.CUST_SEQ," ).append("\n"); 
		query.append("					        C.CUST_LGL_ENG_NM AS CUST_NM" ).append("\n"); 
		query.append("					FROM    BKG_BOOKING B," ).append("\n"); 
		query.append("					        BKG_CUSTOMER S," ).append("\n"); 
		query.append("					        MDM_CUSTOMER C," ).append("\n"); 
		query.append("							MDM_ORGANIZATION O," ).append("\n"); 
		query.append("							MDM_LOCATION L" ).append("\n"); 
		query.append("					WHERE  B.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					AND    S.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("					AND    S.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("					AND    S.CUST_CNT_CD = C.CUST_CNT_CD" ).append("\n"); 
		query.append("					AND    S.CUST_SEQ = C.CUST_SEQ" ).append("\n"); 
		query.append("					AND    C.DELT_FLG ='N'" ).append("\n"); 
		query.append("					AND    O.DELT_FLG ='N'" ).append("\n"); 
		query.append("					AND    L.DELT_FLG ='N'" ).append("\n"); 
		query.append("					AND    C.OFC_CD = O.OFC_CD " ).append("\n"); 
		query.append("					AND    NVL(C.NMD_CUST_FLG,'N') ='N'	" ).append("\n"); 
		query.append("					AND    B.POR_CD = L.LOC_CD" ).append("\n"); 
		query.append("					ORDER BY FLG" ).append("\n"); 
		query.append("					) A" ).append("\n"); 
		query.append("					WHERE ROWNUM = 1) CR_RT_P," ).append("\n"); 
		query.append("					(SELECT ROWNUM,A.* FROM " ).append("\n"); 
		query.append("					(" ).append("\n"); 
		query.append("					--CCT" ).append("\n"); 
		query.append("					SELECT  BKG.BKG_NO AS BKG_NO," ).append("\n"); 
		query.append("					        21 AS FLG," ).append("\n"); 
		query.append("					        'C' AS BKG_CUST_TP_CD," ).append("\n"); 
		query.append("					        CR_CLT_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("					        BCUST.CUST_CNT_CD AS CUST_CNT_CD," ).append("\n"); 
		query.append("					        BCUST.CUST_SEQ AS CUST_SEQ," ).append("\n"); 
		query.append("					        MCUST.CUST_LGL_ENG_NM AS CUST_NM" ).append("\n"); 
		query.append("					FROM    MDM_CR_CUST CUST," ).append("\n"); 
		query.append("					        BKG_BOOKING BKG," ).append("\n"); 
		query.append("					        BKG_CUSTOMER BCUST," ).append("\n"); 
		query.append("					        MDM_CUSTOMER MCUST" ).append("\n"); 
		query.append("					WHERE  BKG.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					AND    BKG.BKG_NO = BCUST.BKG_NO" ).append("\n"); 
		query.append("					AND    BCUST.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("					AND    CUST.CUST_CNT_CD = BCUST.CUST_CNT_CD" ).append("\n"); 
		query.append("					AND    CUST.CUST_SEQ = BCUST.CUST_SEQ" ).append("\n"); 
		query.append("					AND    BCUST.CUST_CNT_CD = MCUST.CUST_CNT_CD" ).append("\n"); 
		query.append("					AND    BCUST.CUST_SEQ = MCUST.CUST_SEQ    " ).append("\n"); 
		query.append("					AND    IB_CR_TERM_DYS > 0" ).append("\n"); 
		query.append("					AND    CR_ST_DT  <= (SELECT TO_CHAR(BKG_CRE_DT,'RRRRMMDD') FROM BKG_BOOKING WHERE BKG_NO = @[bkg_no])" ).append("\n"); 
		query.append("					AND    CR_END_DT >= (SELECT TO_CHAR(BKG_CRE_DT,'RRRRMMDD') FROM BKG_BOOKING WHERE BKG_NO = @[bkg_no])" ).append("\n"); 
		query.append("					AND    MCUST.DELT_FLG ='N'" ).append("\n"); 
		query.append("					AND    NVL(MCUST.NMD_CUST_FLG,'N') ='N'" ).append("\n"); 
		query.append("					AND    CUST.DELT_FLG ='N'" ).append("\n"); 
		query.append("					UNION" ).append("\n"); 
		query.append("					--CCT OFFICE CODE2" ).append("\n"); 
		query.append("					SELECT B.BKG_NO BKG_NO," ).append("\n"); 
		query.append("					        22 AS FLG," ).append("\n"); 
		query.append("					        'C' AS BKG_CUST_TP_CD," ).append("\n"); 
		query.append("					        FINC_CTRL_OFC_CD AS OFC_CD," ).append("\n"); 
		query.append("					        S.CUST_CNT_CD  AS CUST_CNT_CD," ).append("\n"); 
		query.append("					        NVL(S.CUST_SEQ,'1') AS CUST_SEQ," ).append("\n"); 
		query.append("					        C.CUST_LGL_ENG_NM AS CUST_NM" ).append("\n"); 
		query.append("					FROM    MDM_LOCATION M, " ).append("\n"); 
		query.append("					        BKG_BOOKING B, " ).append("\n"); 
		query.append("					        BKG_CUSTOMER S," ).append("\n"); 
		query.append("					        MDM_CUSTOMER C" ).append("\n"); 
		query.append("					WHERE  B.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					AND    S.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("					AND    S.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("					AND    S.CUST_CNT_CD = C.CUST_CNT_CD" ).append("\n"); 
		query.append("					AND    S.CUST_SEQ = C.CUST_SEQ" ).append("\n"); 
		query.append("					AND    B.DEL_CD = M.LOC_CD" ).append("\n"); 
		query.append("					AND    C.DELT_FLG = 'N'" ).append("\n"); 
		query.append("					AND	NVL(C.NMD_CUST_FLG,'N') ='N'" ).append("\n"); 
		query.append("					UNION" ).append("\n"); 
		query.append("					--REP CUSTOMER" ).append("\n"); 
		query.append("					SELECT BKG_NO," ).append("\n"); 
		query.append("					        31 AS FLG," ).append("\n"); 
		query.append("					        'R'AS BKG_CUST_TP_CD," ).append("\n"); 
		query.append("					        (SELECT  FINC_CTRL_OFC_CD" ).append("\n"); 
		query.append("					            FROM MDM_LOCATION" ).append("\n"); 
		query.append("					            WHERE LOC_CD = (SELECT DEL_CD" ).append("\n"); 
		query.append("					                            FROM  BKG_BOOKING" ).append("\n"); 
		query.append("					                            WHERE BKG_NO =@[bkg_no])) AS OFC_CD," ).append("\n"); 
		query.append("					        REP_CUST_CNT_CD AS CUST_CNT_CD," ).append("\n"); 
		query.append("					        REP_CUST_SEQ AS CUST_SEQ," ).append("\n"); 
		query.append("					        MCUST.CUST_LGL_ENG_NM AS CUST_NM" ).append("\n"); 
		query.append("					FROM   MDM_ORGANIZATION OFC, " ).append("\n"); 
		query.append("					        BKG_BOOKING BKG," ).append("\n"); 
		query.append("					        MDM_CUSTOMER MCUST" ).append("\n"); 
		query.append("					WHERE  BKG.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					AND    REP_CUST_CNT_CD = MCUST.CUST_CNT_CD" ).append("\n"); 
		query.append("					AND    REP_CUST_SEQ = MCUST.CUST_SEQ" ).append("\n"); 
		query.append("					AND    MCUST.DELT_FLG ='N'" ).append("\n"); 
		query.append("					AND	NVL(MCUST.NMD_CUST_FLG,'N') ='N'" ).append("\n"); 
		query.append("					AND    OFC.OFC_CD = NVL((SELECT CR_CLT_OFC_CD" ).append("\n"); 
		query.append("					                        FROM MDM_CR_CUST" ).append("\n"); 
		query.append("					                        WHERE (CUST_CNT_CD, CUST_SEQ) = (SELECT CUST_CNT_CD, CUST_SEQ" ).append("\n"); 
		query.append("					                                                            FROM   BKG_BOOKING B," ).append("\n"); 
		query.append("					                                                                    BKG_CUSTOMER C" ).append("\n"); 
		query.append("					                                                            WHERE  B.BKG_NO = @[bkg_no]" ).append("\n"); 
		query.append("					                                                            AND    C.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("					                                                            AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("																				)" ).append("\n"); 
		query.append("					                        AND 0 < IB_CR_TERM_DYS" ).append("\n"); 
		query.append("											AND MCUST.DELT_FLG ='N'" ).append("\n"); 
		query.append("					                        AND CR_ST_DT  <= (SELECT TO_CHAR(BKG_CRE_DT,'RRRRMMDD') FROM BKG_BOOKING WHERE BKG_NO = @[bkg_no])" ).append("\n"); 
		query.append("					                        AND CR_END_DT >= (SELECT TO_CHAR(BKG_CRE_DT,'RRRRMMDD') FROM BKG_BOOKING WHERE BKG_NO = @[bkg_no]))," ).append("\n"); 
		query.append("					                    (SELECT  FINC_CTRL_OFC_CD" ).append("\n"); 
		query.append("					                        FROM MDM_LOCATION" ).append("\n"); 
		query.append("					                        WHERE LOC_CD = (SELECT DEL_CD" ).append("\n"); 
		query.append("					                                        FROM  BKG_BOOKING" ).append("\n"); 
		query.append("					                                        WHERE BKG_NO =@[bkg_no])" ).append("\n"); 
		query.append("					                    )" ).append("\n"); 
		query.append("					                    )" ).append("\n"); 
		query.append("					                    ORDER BY FLG" ).append("\n"); 
		query.append("					) A" ).append("\n"); 
		query.append("					WHERE " ).append("\n"); 
		query.append("					ROWNUM = 1) CR_RT_C" ).append("\n"); 
		query.append("					" ).append("\n"); 
		query.append("         WHERE  BK.BKG_NO =@[bkg_no]" ).append("\n"); 
		query.append("           AND  BK.BKG_STS_CD <>'X'" ).append("\n"); 
		query.append("           AND  BK.BKG_NO = RT.BKG_NO" ).append("\n"); 
		query.append("           AND  BK.BKG_NO = N.BKG_NO" ).append("\n"); 
		query.append("           AND  BK.BKG_NO = F.BKG_NO" ).append("\n"); 
		query.append("           AND  N.BKG_CUST_TP_CD ='N'" ).append("\n"); 
		query.append("           AND  F.BKG_CUST_TP_CD ='F'" ).append("\n"); 
		query.append("           AND  BK.POR_CD = POR_L.LOC_CD" ).append("\n"); 
		query.append("           AND  POR_L.DELT_FLG ='N'" ).append("\n"); 
		query.append("           AND  BK.DEL_CD = DEL_L.LOC_CD" ).append("\n"); 
		query.append("           AND  DEL_L.DELT_FLG ='N'" ).append("\n"); 
		query.append("           AND  DEL_L.FINC_CTRL_OFC_CD = OFC.OFC_CD" ).append("\n"); 
		query.append("           AND  OFC.DELT_FLG='N'" ).append("\n"); 
		query.append("           AND  BK.BKG_NO = CR_RT_P.BKG_NO(+)" ).append("\n"); 
		query.append("           AND  BK.BKG_NO = CR_RT_C.BKG_NO(+)" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("SET ORG_PPD_PAYR_CNT_CD = UP_PPD_PAYR_CNT_CD," ).append("\n"); 
		query.append("    ORG_PPD_PAYR_CUST_SEQ = UP_PPD_PAYR_CUST_SEQ," ).append("\n"); 
		query.append("    ORG_CLT_PAYR_CNT_CD = UP_CLT_PAYR_CNT_CD," ).append("\n"); 
		query.append("    ORG_CLT_PAYR_CUST_SEQ = UP_CLT_PAYR_CUST_SEQ," ).append("\n"); 
		query.append("    UPD_USR_ID = UP_USR," ).append("\n"); 
		query.append("    UPD_DT = UP_DT" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 

	}
}