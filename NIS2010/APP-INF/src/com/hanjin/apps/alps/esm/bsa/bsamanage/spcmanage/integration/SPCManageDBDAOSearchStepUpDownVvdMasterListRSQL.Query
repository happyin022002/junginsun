<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SPCManageDBDAOSearchStepUpDownVvdMasterListRSQL">
			<desc><![CDATA[ESM_BSA_0032 화면의 Master Data 조회 쿼리
2014.04.28 김시몬 [CHM-201429944] MONTH 조회시 SLS_YRMON으로 조회되도록
2015.06.08 김용습 [CHM-201536164] 주간 MAS Open에 따른 타모듈 프로그램 적용 요청
2016.01.29 김성욱 [CHM-201539410] BSA System 개선의 건 / 동일 날짜에 서로 다른 항차 BSA 입력 가능 실현]]></desc>
			<sql><![CDATA[
SELECT 
nvl(B.MNL_FLG,'N') MNL_FLG ,
#if (${chkprd} == 'M')
  SUBSTR(A.SLS_YRMON, 1, 4) || A.COST_WK AS COST_YRWK,
#elseif (${chkprd} == 'W')
  SUBSTR(A.SLS_YRMON, 1, 4) || A.COST_WK AS COST_YRWK,
#end 
      A.SUB_TRD_CD,
      A.SLAN_CD ,
      B.TRD_CD,
      B.RLANE_CD,
      B.VSL_CD,
      B.SKD_VOY_NO,
      B.SKD_DIR_CD,
      B.BSA_OP_CD ,
      DECODE(B.BSA_OP_CD, 'J', 'J/O', 'S', 'S/C', B.BSA_OP_CD) AS BSA_OP_NM ,
      B.IOC_CD,
      B.VOP_CD,
      B.VSL_CAPA,
      B.BSA_CAPA,
      C.PORT_BSA_CAPA ,
      C.CRR_CD,
      C.BSA_OP_JB_CD,
      DECODE(D.STUP_FLG, 'Y', '1', '0') STUP_FLG,
      DECODE(B.PORT_BSA_CFM_FLG, 'Y', '1', '0') PORT_BSA_CFM_FLG
FROM MAS_MON_VVD A ,
      BSA_VVD_MST B ,
      BSA_VVD_PORT_DWN C ,
      MAS_LANE_RGST D
WHERE A.TRD_CD      = B.TRD_CD
  AND A.RLANE_CD    = B.RLANE_CD
  AND A.VSL_CD      = B.VSL_CD
  AND A.SKD_VOY_NO  = B.SKD_VOY_NO
  AND A.DIR_CD      = B.SKD_DIR_CD
  AND B.TRD_CD      = C.TRD_CD
  AND B.RLANE_CD    = C.RLANE_CD
  AND B.VSL_CD      = C.VSL_CD
  AND B.SKD_VOY_NO  = C.SKD_VOY_NO
  AND B.SKD_DIR_CD  = C.SKD_DIR_CD
  AND A.TRD_CD      = D.TRD_CD
  AND A.RLANE_CD    = D.RLANE_CD
  AND A.DIR_CD      = D.DIR_CD
  AND NVL(A.DELT_FLG, 'N') = 'N'
  AND NVL(D.STUP_FLG, 'N') = 'Y' 
  AND NVL(D.DELT_FLG, 'N') = 'N'
#if (${chkprd} == 'M')
  AND A.SLS_YRMON BETWEEN @[txtyear]||@[txtfmmonth] AND @[txtyear]||@[txttomonth] 
#elseif (${chkprd} == 'W')
  AND A.SLS_YRMON LIKE @[txtyear] || '%'
  AND A.COST_WK BETWEEN @[txtfmweek] AND @[txttoweek] 
#end 
#if (${cobtrade} != '')
  AND A.TRD_CD = @[cobtrade] 
#end 
#if (${coblane} != '')
  AND A.RLANE_CD = @[coblane] 
#end 
#if (${cobdir} != '')
  AND A.DIR_CD = @[cobdir] 
#end 
#if (${cobioc} != '')
  AND A.IOC_CD = @[cobioc] 
#end 
  AND C.CRR_CD        = @[cobcarrier]
  AND C.BSA_OP_JB_CD  = @[rdocode]
  AND C.PORT_SEQ      = 999
  AND C.PORT_CD       = 'XXXXX'
ORDER BY 
#if (${chkprd} == 'M')
  SUBSTR(A.SLS_YRMON, 1, 4) || A.COST_WK ,
#elseif (${chkprd} == 'W')
  SUBSTR(A.SLS_YRMON, 1, 4) || A.COST_WK ,
#end 
	  A.SUB_TRD_CD,
      A.SLAN_CD ,
      B.TRD_CD,
      B.RLANE_CD,     
      B.SKD_DIR_CD,
      B.BSA_OP_CD			]]></sql>
			<params>
				<param name="txtyear" type="12" value="" out="N"/>
				<param name="txtfmmonth" type="12" value="" out="N"/>
				<param name="txttomonth" type="12" value="" out="N"/>
				<param name="txtfmweek" type="12" value="" out="N"/>
				<param name="txttoweek" type="12" value="" out="N"/>
				<param name="cobtrade" type="12" value="" out="N"/>
				<param name="coblane" type="12" value="" out="N"/>
				<param name="cobdir" type="12" value="" out="N"/>
				<param name="cobioc" type="12" value="" out="N"/>
				<param name="cobcarrier" type="12" value="" out="N"/>
				<param name="rdocode" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
