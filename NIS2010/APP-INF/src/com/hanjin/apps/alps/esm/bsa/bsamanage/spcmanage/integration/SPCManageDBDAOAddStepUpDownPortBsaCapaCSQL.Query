<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="SPCManageDBDAOAddStepUpDownPortBsaCapaCSQL">
			<desc><![CDATA[CRR_CD에 해당 하는 값이 PORT_DWN 테이블에 없는 경우 입력함.

2016.01.29 김성욱 [CHM-201539410] BSA System 개선의 건 / 동일 날짜에 서로 다른 항차 BSA 입력 가능 실현]]></desc>
			<sql><![CDATA[
INSERT INTO BSA_VVD_PORT_DWN (
    TRD_CD, RLANE_CD, VSL_CD, SKD_VOY_NO, SKD_DIR_CD,
    BSA_OP_JB_CD, CRR_CD, PORT_SEQ, PORT_CD, PORT_BSA_CAPA,
    CRE_USR_ID, CRE_DT, UPD_USR_ID, UPD_DT
)
(
SELECT TRD_CD,RLANE_CD,VSL_CD,SKD_VOY_NO,SKD_DIR_CD,
    BSA_OP_JB_CD,@[crr_cd], PORT_SEQ,PORT_CD,'0',
    @[upd_usr_id],SYSDATE,@[upd_usr_id],SYSDATE 
FROM BSA_VVD_PORT_DWN
WHERE trd_cd       = @[trd_cd]
        AND rlane_cd     = @[lane_cd]
        AND vsl_cd       = @[vsl_cd]
        AND skd_voy_no   = @[voy_no]
        AND skd_dir_cd   = @[dir_cd]
        AND bsa_op_jb_cd = @[jb_cd] -- BSA : 007, Slot Price : 015
        AND CRR_CD = 'SML'  --고정값 / 
        AND NOT EXISTS (
            SELECT *
            FROM BSA_VVD_PORT_DWN 
            WHERE trd_cd       = @[trd_cd]
                AND rlane_cd     = @[lane_cd]
                AND vsl_cd       = @[vsl_cd]
                AND skd_voy_no   = @[voy_no]
                AND skd_dir_cd   = @[dir_cd]
                AND bsa_op_jb_cd = @[jb_cd] -- BSA : 007, Slot Price : 015
                AND crr_cd       = @[crr_cd]
        )
)			]]></sql>
			<params>
				<param name="crr_cd" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="trd_cd" type="12" value="" out="N"/>
				<param name="lane_cd" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="voy_no" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="jb_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
