<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TCharterIOContractDAOSearchContractRSQL">
			<desc><![CDATA[TCharterIOContractDAOSearchContractRSQL]]></desc>
			<sql><![CDATA[
SELECT FLET_CTRT_NO,
	   VSL_CD,
	   VSL_ENG_NM,
	   FLET_CTRT_TP_CD,
	   VNDR_SEQ,
	   CUST_CNT_CD,
	   CUST_SEQ,
	   VNDR_LGL_ENG_NM,
	   OWNR_NM,
	   VSL_CNT_CD,
	   CNT_NM,
	   FLET_CTRT_FACT_CD,
	   CP_DT,
	   EFF_DT,
	   FROM_TIME,
	   EXP_DT,
	   TO_TIME,
	   DECL_FLG,
	   ACMM_RT_AMT,
	   FLET_BROG_RT_AMT,
	   FLET_OLAY_COMM_RT_AMT,
	   OA_RSV_AMT,
	   OA_RSV_CURR_CD,
	   ACT_FOIL_BOD_QTY,
	   ACT_DOIL_BOD_QTY,
	   ACT_FOIL_BOR_QTY,
	   ACT_DOIL_BOR_QTY,
	   FOIL_BOD_OUT_PRC,
	   DOIL_BOD_OUT_PRC,
	   FOIL_BOR_OUT_PRC,
	   DOIL_BOR_OUT_PRC,
	   VSL_BLD_DT,
	   VSL_DZND_CAPA,
	   BSE_14TON_VSL_CAPA,
	   DDWT_CGO_CAPA_QTY,
	   GRS_WGT,
	   NRT_WGT,
	   CHTR_PRD_OPT_CTNT,
	   RDE_RNG_CTNT,
	   RDE_NTC_CTNT,
	   RF_CNTR_PLG_QTY,
	   GR_FLG,
	   SHP_SPD_QTY,
	   FLET_GMT_LMT_CD,
	   BOD_PORT_CD,
	   BOR_PORT_CD,
  	   AGMT_DOC_NO,		-- GW 문서 번호 
 	   AGMT_DOC_DESC,	-- GW 문서 명
	   ACT_LOW_SULP_FOIL_BOD_QTY,
       ACT_LOW_SULP_GAS_OIL_BOD_QTY,
       ACT_LOW_SULP_FOIL_BOR_QTY,
       ACT_LOW_SULP_GAS_OIL_BOR_QTY,
       LOW_SULP_FOIL_BOD_OUT_PRC,
       LOW_SULP_GAS_OIL_BOD_OUT_PRC,
       LOW_SULP_FOIL_BOR_OUT_PRC,
       LOW_SULP_GAS_OIL_BOR_OUT_PRC
  FROM (
		SELECT 
				FLET_CTRT_NO,
				VSL_CD,
				(SELECT VSL_ENG_NM 
				   FROM MDM_VSL_CNTR 
                  WHERE VSL_CD = FC.VSL_CD 
                    AND ROWNUM =1) VSL_ENG_NM,
				FLET_CTRT_TP_CD,
				VNDR_SEQ,
				CUST_CNT_CD,
				CUST_SEQ,
				CASE WHEN FC.FLET_CTRT_TP_CD = 'TO' THEN
						  (SELECT MV.CUST_LGL_ENG_NM
							 FROM MDM_CUSTOMER MV, FMS_OWNER FO
							WHERE CUST_CNT_CD = FC.CUST_CNT_CD
							  AND CUST_SEQ = FC.CUST_SEQ
							  AND MV.FLET_MGMT_OWNR_CUST_SEQ = FO.OWNR_SEQ
							  AND ROWNUM =1)
				 ELSE 
					(SELECT MV.VNDR_LGL_ENG_NM
					  FROM MDM_VENDOR MV, FMS_OWNER FO
					 WHERE VNDR_SEQ = FC.VNDR_SEQ
					   AND MV.FLET_MGMT_OWNR_VNDR_SEQ = FO.OWNR_SEQ
				  	   AND ROWNUM =1)
			    END VNDR_LGL_ENG_NM,

                CASE WHEN FC.OWNR_SEQ IS NULL THEN
                   (        
                      CASE WHEN FC.FLET_CTRT_TP_CD = 'TO' THEN
                        (SELECT FO.OWNR_NM
                         FROM MDM_CUSTOMER MV, FMS_OWNER FO
                         WHERE CUST_CNT_CD = FC.CUST_CNT_CD
                         AND CUST_SEQ = FC.CUST_SEQ
                         AND MV.FLET_MGMT_OWNR_CUST_SEQ = FO.OWNR_SEQ
                         AND ROWNUM =1)
                     ELSE
                        (SELECT FO.OWNR_NM
                         FROM MDM_VENDOR MV, FMS_OWNER FO
                         WHERE VNDR_SEQ = FC.VNDR_SEQ
                         AND MV.FLET_MGMT_OWNR_VNDR_SEQ = FO.OWNR_SEQ
                         AND ROWNUM =1)
                    END )        
                ELSE  
                  (SELECT FO.OWNR_NM
                   FROM FMS_OWNER FO
                   WHERE FC.OWNR_SEQ = FO.OWNR_SEQ
                   AND ROWNUM =1)
                END OWNR_NM,

				VSL_CNT_CD,
				(SELECT CNT_NM FROM MDM_COUNTRY WHERE CNT_CD = FC.VSL_CNT_CD) CNT_NM,
				FLET_CTRT_FACT_CD,
				DECODE(CP_DT,NULL,CP_DT,SUBSTR(CP_DT,1,4) || '-' || SUBSTR(CP_DT,5,2) || '-' || SUBSTR(CP_DT,7,2)) CP_DT,
				TO_CHAR(EFF_DT,'YYYY-MM-DD') EFF_DT,
				TO_CHAR(EFF_DT,'HH24:MI') FROM_TIME,
				TO_CHAR(EXP_DT,'YYYY-MM-DD') EXP_DT,
				TO_CHAR(EXP_DT,'HH24:MI') TO_TIME,
				DECL_FLG,
				TO_CHAR(ACMM_RT_AMT,'FM999,999,999,999.00') ACMM_RT_AMT,
				TO_CHAR(FLET_BROG_RT_AMT,'FM999,999,999,999.00') FLET_BROG_RT_AMT,
				TO_CHAR(FLET_OLAY_COMM_RT_AMT,'FM999,999,999,999.00') FLET_OLAY_COMM_RT_AMT,
				TO_CHAR(OA_RSV_AMT,'FM999,999,999,999.00') OA_RSV_AMT,
				OA_RSV_CURR_CD,
				TO_CHAR(ACT_FOIL_BOD_QTY,'FM999,999,990.000') ACT_FOIL_BOD_QTY,
				TO_CHAR(ACT_DOIL_BOD_QTY,'FM999,999,990.000') ACT_DOIL_BOD_QTY,
				TO_CHAR(ACT_FOIL_BOR_QTY,'FM999,999,990.000') ACT_FOIL_BOR_QTY,
				TO_CHAR(ACT_DOIL_BOR_QTY,'FM999,999,990.000') ACT_DOIL_BOR_QTY,
				TO_CHAR(FOIL_BOD_OUT_PRC,'FM999,999,999,990.00') FOIL_BOD_OUT_PRC,
				TO_CHAR(DOIL_BOD_OUT_PRC,'FM999,999,999,990.00') DOIL_BOD_OUT_PRC,
				TO_CHAR(FOIL_BOR_OUT_PRC,'FM999,999,999,990.00') FOIL_BOR_OUT_PRC,
				TO_CHAR(DOIL_BOR_OUT_PRC,'FM999,999,999,990.00') DOIL_BOR_OUT_PRC,
				DECODE(VSL_BLD_DT,NULL,VSL_BLD_DT,SUBSTR(VSL_BLD_DT,1,4) || '-' || SUBSTR(VSL_BLD_DT,5,2) || '-' || SUBSTR(VSL_BLD_DT,7,2)) VSL_BLD_DT,
				VSL_DZND_CAPA,
				BSE_14TON_VSL_CAPA,
				TO_CHAR(DDWT_CGO_CAPA_QTY,'FM999,990.00') DDWT_CGO_CAPA_QTY,
				GRS_WGT,
				NRT_WGT,
				CHTR_PRD_OPT_CTNT,
				RDE_RNG_CTNT,
				RDE_NTC_CTNT,
				RF_CNTR_PLG_QTY,
				GR_FLG,
				TO_CHAR(SHP_SPD_QTY,'FM999,990.00') SHP_SPD_QTY,
				FLET_GMT_LMT_CD,
				BOD_PORT_CD,
				BOR_PORT_CD,
				AGMT_DOC_NO,		-- GW 문서 번호 
				AGMT_DOC_DESC,		-- GW 문서 명
      			TO_CHAR(ACT_LOW_SULP_FOIL_BOD_QTY,'FM999,999,990.000') ACT_LOW_SULP_FOIL_BOD_QTY,
    			TO_CHAR(ACT_LOW_SULP_GAS_OIL_BOD_QTY,'FM999,999,990.000') ACT_LOW_SULP_GAS_OIL_BOD_QTY,
      			TO_CHAR(ACT_LOW_SULP_FOIL_BOR_QTY,'FM999,999,990.000') ACT_LOW_SULP_FOIL_BOR_QTY,
     		    TO_CHAR(ACT_LOW_SULP_GAS_OIL_BOR_QTY,'FM999,999,990.000') ACT_LOW_SULP_GAS_OIL_BOR_QTY,
     			TO_CHAR(LOW_SULP_FOIL_BOD_OUT_PRC,'FM999,999,999,990.00') LOW_SULP_FOIL_BOD_OUT_PRC,
       			TO_CHAR(LOW_SULP_GAS_OIL_BOD_OUT_PRC,'FM999,999,999,990.00') LOW_SULP_GAS_OIL_BOD_OUT_PRC,
       			TO_CHAR(LOW_SULP_FOIL_BOR_OUT_PRC,'FM999,999,999,990.00') LOW_SULP_FOIL_BOR_OUT_PRC,
       			TO_CHAR(LOW_SULP_GAS_OIL_BOR_OUT_PRC,'FM999,999,999,990.00') LOW_SULP_GAS_OIL_BOR_OUT_PRC
		  FROM  FMS_CONTRACT FC
		 WHERE  FLET_CTRT_NO = @[flet_ctrt_no]
	   )			]]></sql>
			<params>
				<param name="flet_ctrt_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
