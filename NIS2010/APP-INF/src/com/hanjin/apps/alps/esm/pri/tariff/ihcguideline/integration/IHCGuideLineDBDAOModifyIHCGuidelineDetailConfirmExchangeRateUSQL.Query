<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="IHCGuideLineDBDAOModifyIHCGuidelineDetailConfirmExchangeRateUSQL">
			<desc><![CDATA[exchange special cargo guideline rate
* History
2013.03.16 전지예 [CHM-201534279] Pricing Feeder/IHC tariff 45" 칼럼 추가 안]]></desc>
			<sql><![CDATA[
UPDATE PRI_TRF_IHC_RT RTMN
   SET ( GLINE_LOCL_CURR_20FT_AMT
       , GLINE_LOCL_CURR_40FT_AMT
       , GLINE_LOCL_CURR_45FT_AMT -- 45' Cost 추가
       , GLINE_LOCL_CURR_DG_20FT_AMT
       , GLINE_LOCL_CURR_DG_40FT_AMT
       , GLINE_LOCL_CURR_DG_45FT_AMT -- 45' Cost 추가
       , GLINE_LOCL_CURR_OVR_20FT_AMT
       , GLINE_LOCL_CURR_OVR_40FT_AMT
       , GLINE_LOCL_CURR_OVR_45FT_AMT -- 45' Cost 추가
       )
   = (
        SELECT ROUND(TPB_GET_LOCL_AMT_FNC(RT.GLINE_20FT_FRT_RT_AMT, RT.LOCL_CURR_CD,
                (  SELECT TO_DATE(MAX(R.ACCT_XCH_RT_YRMON), 'YYYYMM') ACCT_XCH_RT_YRMON FROM GL_MON_XCH_RT R WHERE R.ACCT_XCH_RT_LVL = '1' AND DELT_FLG = 'N' AND R.CURR_CD = RT.LOCL_CURR_CD )),0) LOCL_CURR_COST_20FT
             , ROUND(TPB_GET_LOCL_AMT_FNC(RT.GLINE_40FT_FRT_RT_AMT, RT.LOCL_CURR_CD,
                (  SELECT TO_DATE(MAX(R.ACCT_XCH_RT_YRMON), 'YYYYMM') ACCT_XCH_RT_YRMON FROM GL_MON_XCH_RT R WHERE R.ACCT_XCH_RT_LVL = '1' AND DELT_FLG = 'N' AND R.CURR_CD = RT.LOCL_CURR_CD )),0) LOCL_CURR_COST_40FT
              -- 45' Cost 추가
             , ROUND(TPB_GET_LOCL_AMT_FNC(RT.GLINE_45FT_FRT_RT_AMT, RT.LOCL_CURR_CD,
                (  SELECT TO_DATE(MAX(R.ACCT_XCH_RT_YRMON), 'YYYYMM') ACCT_XCH_RT_YRMON FROM GL_MON_XCH_RT R WHERE R.ACCT_XCH_RT_LVL = '1' AND DELT_FLG = 'N' AND R.CURR_CD = RT.LOCL_CURR_CD )),0) LOCL_CURR_COST_45FT
             , ROUND(TPB_GET_LOCL_AMT_FNC(RT.GLINE_DG_20FT_FRT_RT_AMT, RT.LOCL_CURR_CD,
                (  SELECT TO_DATE(MAX(R.ACCT_XCH_RT_YRMON), 'YYYYMM') ACCT_XCH_RT_YRMON FROM GL_MON_XCH_RT R WHERE R.ACCT_XCH_RT_LVL = '1' AND DELT_FLG = 'N' AND R.CURR_CD = RT.LOCL_CURR_CD )),0) LOCL_DG_20FT
             , ROUND(TPB_GET_LOCL_AMT_FNC(RT.GLINE_DG_40FT_FRT_RT_AMT, RT.LOCL_CURR_CD,
                (  SELECT TO_DATE(MAX(R.ACCT_XCH_RT_YRMON), 'YYYYMM') ACCT_XCH_RT_YRMON FROM GL_MON_XCH_RT R WHERE R.ACCT_XCH_RT_LVL = '1' AND DELT_FLG = 'N' AND R.CURR_CD = RT.LOCL_CURR_CD )),0) LOCL_DG_40FT
              -- 45' Cost 추가
             , ROUND(TPB_GET_LOCL_AMT_FNC(RT.GLINE_DG_45FT_FRT_RT_AMT, RT.LOCL_CURR_CD,
                (  SELECT TO_DATE(MAX(R.ACCT_XCH_RT_YRMON), 'YYYYMM') ACCT_XCH_RT_YRMON FROM GL_MON_XCH_RT R WHERE R.ACCT_XCH_RT_LVL = '1' AND DELT_FLG = 'N' AND R.CURR_CD = RT.LOCL_CURR_CD )),0) LOCL_DG_45FT
             , ROUND(TPB_GET_LOCL_AMT_FNC(RT.GLINE_OVR_WGT_20FT_FRT_RT_AMT, RT.LOCL_CURR_CD,
                (  SELECT TO_DATE(MAX(R.ACCT_XCH_RT_YRMON), 'YYYYMM') ACCT_XCH_RT_YRMON FROM GL_MON_XCH_RT R WHERE R.ACCT_XCH_RT_LVL = '1' AND DELT_FLG = 'N' AND R.CURR_CD = RT.LOCL_CURR_CD )),0) LOCL_OV_20FT
             , ROUND(TPB_GET_LOCL_AMT_FNC(RT.GLINE_OVR_WGT_40FT_FRT_RT_AMT, RT.LOCL_CURR_CD,
                (  SELECT TO_DATE(MAX(R.ACCT_XCH_RT_YRMON), 'YYYYMM') ACCT_XCH_RT_YRMON FROM GL_MON_XCH_RT R WHERE R.ACCT_XCH_RT_LVL = '1' AND DELT_FLG = 'N' AND R.CURR_CD = RT.LOCL_CURR_CD )),0) LOCL_OV_40FT
              -- 45' Cost 추가
             , ROUND(TPB_GET_LOCL_AMT_FNC(RT.GLINE_OVR_WGT_45FT_FRT_RT_AMT, RT.LOCL_CURR_CD,
                (  SELECT TO_DATE(MAX(R.ACCT_XCH_RT_YRMON), 'YYYYMM') ACCT_XCH_RT_YRMON FROM GL_MON_XCH_RT R WHERE R.ACCT_XCH_RT_LVL = '1' AND DELT_FLG = 'N' AND R.CURR_CD = RT.LOCL_CURR_CD )),0) LOCL_OV_45FT
          FROM PRI_TRF_IHC_RT RT
         WHERE 1=1
           AND RT.SVC_SCP_CD = RTMN.SVC_SCP_CD
           AND RT.ORG_DEST_TP_CD = RTMN.ORG_DEST_TP_CD
           AND RT.IHC_TRF_NO = RTMN.IHC_TRF_NO
           AND RT.AMDT_SEQ   = RTMN.AMDT_SEQ
           AND RT.IHC_CGO_TP_CD = RTMN.IHC_CGO_TP_CD
           AND RT.RT_SEQ     = RTMN.RT_SEQ
     )
    
 WHERE 1 = 1
   AND RTMN.SVC_SCP_CD = @[svc_scp_cd]
   AND RTMN.IHC_TRF_NO = @[ihc_trf_no]
   AND RTMN.AMDT_SEQ   = @[amdt_seq]
   AND RTMN.ORG_DEST_TP_CD = @[org_dest_tp_cd]			]]></sql>
			<params>
				<param name="svc_scp_cd" type="12" value="" out="N"/>
				<param name="ihc_trf_no" type="12" value="" out="N"/>
				<param name="amdt_seq" type="12" value="" out="N"/>
				<param name="org_dest_tp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
