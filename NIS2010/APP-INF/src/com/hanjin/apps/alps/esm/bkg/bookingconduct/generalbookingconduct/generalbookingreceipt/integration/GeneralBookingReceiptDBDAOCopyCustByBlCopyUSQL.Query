<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralBookingReceiptDBDAOCopyCustByBlCopyUSQL">
			<desc><![CDATA[BL Copy 화면에서 Customer 정보를 Copy한다.]]></desc>
			<sql><![CDATA[
MERGE INTO BKG_CUSTOMER CUST
USING (
    SELECT
          BKG_NO
        , BKG_CUST_TP_CD
        , CUST_CNT_CD
        , CUST_SEQ
        , CUST_NM
        , CUST_ADDR
        , CUST_CTY_NM
        , CUST_STE_CD
        , CSTMS_DECL_CNT_CD
        , CUST_ZIP_ID
        , CUST_FAX_NO
        , CUST_EML
        , CUST_TP_CD
        , REF_NO
        , ADDR_PRN_FLG
        , VAL_NM
        , VAL_FAX_NO
		, EUR_CSTMS_ST_NM
		, EORI_NO
    FROM BKG_CUSTOMER
    WHERE BKG_NO = @[bkg_no]
    AND BKG_CUST_TP_CD <> 'B'
) T
ON (CUST.BKG_NO = @[copy_bkg_no] AND CUST.BKG_CUST_TP_CD = T.BKG_CUST_TP_CD)
WHEN MATCHED THEN
    UPDATE SET
          CUST_CNT_CD       = T.CUST_CNT_CD
        , CUST_SEQ          = T.CUST_SEQ
        , CUST_NM           = T.CUST_NM
        , CUST_ADDR         = T.CUST_ADDR
        , CUST_CTY_NM       = T.CUST_CTY_NM
        , CUST_STE_CD       = T.CUST_STE_CD
        , CSTMS_DECL_CNT_CD = T.CSTMS_DECL_CNT_CD
        , CUST_ZIP_ID       = T.CUST_ZIP_ID
        , CUST_FAX_NO       = T.CUST_FAX_NO
        , CUST_EML          = T.CUST_EML
        , CUST_TP_CD        = T.CUST_TP_CD
        , REF_NO            = T.REF_NO
        , ADDR_PRN_FLG      = T.ADDR_PRN_FLG
        , VAL_NM            = NULL
        , VAL_FAX_NO        = NULL
        , VAL_CD            = NULL
		, VAL_USR_ID        = NULL
		, VAL_OFC_CD        = NULL
        , VAL_DT            = NULL
        , MTCH_FLG          = 'N'
        , AN_SND_FLG        = 'N'
        , CHG_DP_FLG        = 'N'
        , ORG_CUST_CNT_CD   = T.CUST_CNT_CD
        , ORG_CUST_SEQ      = T.CUST_SEQ
        , IB_CUST_NM        = NULL
        , IB_CUST_ADDR      = NULL
        , OB_EV_CD          = NULL
        , IB_EV_CD          = NULL
        , HQ_EV_CD          = NULL
        , UPD_USR_ID        = @[usr_id]
        , UPD_DT            = SYSDATE
		, EUR_CSTMS_ST_NM   = T.EUR_CSTMS_ST_NM
		, EORI_NO			= T.EORI_NO
WHEN NOT MATCHED THEN
    INSERT (
          BKG_NO
        , BKG_CUST_TP_CD
        , CUST_CNT_CD
        , CUST_SEQ
        , CUST_NM
        , CUST_ADDR
        , CUST_CTY_NM
        , CUST_STE_CD
        , CSTMS_DECL_CNT_CD
        , CUST_ZIP_ID
        , CUST_FAX_NO
        , CUST_EML
        , CUST_TP_CD
        , REF_NO
        , ADDR_PRN_FLG
        , VAL_NM
        , VAL_FAX_NO
		, VAL_CD
		, VAL_USR_ID
		, VAL_OFC_CD
        , VAL_DT
        , MTCH_FLG
        , AN_SND_FLG
        , CHG_DP_FLG
        , ORG_CUST_CNT_CD
        , ORG_CUST_SEQ
        , IB_CUST_NM
        , IB_CUST_ADDR
        , OB_EV_CD
        , IB_EV_CD
        , HQ_EV_CD
        , CRE_USR_ID
        , CRE_DT
        , UPD_USR_ID
        , UPD_DT
		, EUR_CSTMS_ST_NM
		, EORI_NO
    ) VALUES (
          @[copy_bkg_no]
        , T.BKG_CUST_TP_CD
        , T.CUST_CNT_CD
        , T.CUST_SEQ
        , T.CUST_NM
        , T.CUST_ADDR
        , T.CUST_CTY_NM
        , T.CUST_STE_CD
        , T.CSTMS_DECL_CNT_CD
        , T.CUST_ZIP_ID
        , T.CUST_FAX_NO
        , T.CUST_EML
        , T.CUST_TP_CD
        , T.REF_NO
        , T.ADDR_PRN_FLG
        , NULL
        , NULL
        , NULL
        , NULL
        , NULL
        , NULL
        , 'N'
        , 'N'
        , 'N'
        , T.CUST_CNT_CD
        , T.CUST_SEQ
        , NULL
        , NULL
        , NULL
        , NULL
        , NULL
        , @[usr_id]
        , SYSDATE
        , @[usr_id]
        , SYSDATE
		, T.EUR_CSTMS_ST_NM
		, T.EORI_NO
    )			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="copy_bkg_no" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
