<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CargoReleaseOrderDBDAOMergeOtsUSQL">
			<desc><![CDATA[...]]></desc>
			<sql><![CDATA[
MERGE INTO BKG_OUTSTANDING A
USING (SELECT  @[ofc_cd]                                            AS OFC_CD             
              ,@[clt_bl_no]                                         AS CLT_BL_NO          
              ,@[inv_no]                                            AS INV_NO             
              ,@[ofc_curr_cd]                                       AS OFC_CURR_CD        
              ,@[ots_bkg_no]                                        AS OTS_BKG_NO   
              ,@[cr_flg]                                            AS CR_FLG        
              ,TO_DATE(@[ots_due_dt],'YYYY-MM-DD HH24:MI:SS')       AS OTS_DUE_DT         
              ,@[ots_stl_flg]                                       AS OTS_STL_FLG        
              ,@[xch_rt_tp_cd]                                      AS XCH_RT_TP_CD 
              ,@[bil_to_cust_cd]                                    AS BIL_TO_CUST_CD         
              ,@[clt_rmk]                                           AS CLT_RMK            
              ,@[ots_grp_tp_cd]                                     AS OTS_GRP_TP_CD      
              ,@[ots_occr_tp_cd]                                    AS OTS_OCCR_TP_CD     
              ,TO_DATE(@[n1st_clt_rqst_dt],'YYYY-MM-DD HH24:MI:SS') AS N1ST_CLT_RQST_DT   
              ,TO_DATE(@[n2nd_clt_rqst_dt],'YYYY-MM-DD HH24:MI:SS') AS N2ND_CLT_RQST_DT   
              ,TO_DATE(@[n3rd_clt_rqst_dt],'YYYY-MM-DD HH24:MI:SS') AS N3RD_CLT_RQST_DT   
              ,@[lst_clt_ofc_cd]                                    AS LST_CLT_OFC_CD     
              ,TO_DATE(@[lst_upd_chk_dt],'YYYY-MM-DD HH24:MI:SS')   AS LST_UPD_CHK_DT     
              ,@[ots_bnd_tp_cd]                                     AS OTS_BND_TP_CD   
              ,NULL 						    AS XTRA_RMK1
              ,NULL 						    AS XTRA_RMK2
              ,NULL						        AS XTRA_RMK3     
              ,@[ots_tj_seq]						        AS OTS_TJ_SEQ     
              ,SYSDATE                                              AS CRE_DT             
              ,'BKG_ESM071'                                         AS CRE_USR_ID         
              ,SYSDATE                                              AS UPD_DT             
              ,'BKG_ESM071'                                         AS UPD_USR_ID         
       FROM DUAL
      ) B
ON (A.OFC_CD = B.OFC_CD AND A.CLT_BL_NO = B.CLT_BL_NO AND A.INV_NO = B.INV_NO )

WHEN MATCHED THEN

UPDATE  SET CR_FLG = B.CR_FLG
       ,BIL_TO_CUST_CD    = B.BIL_TO_CUST_CD
       ,OFC_CURR_CD       = B.OFC_CURR_CD
       ,OTS_BKG_NO        = B.OTS_BKG_NO
       ,OTS_DUE_DT        = B.OTS_DUE_DT
       ,OTS_STL_FLG       = B.OTS_STL_FLG
       ,XCH_RT_TP_CD      = B.XCH_RT_TP_CD
       ,CLT_RMK           = B.CLT_RMK
       ,OTS_GRP_TP_CD     = B.OTS_GRP_TP_CD
       ,OTS_OCCR_TP_CD    = B.OTS_OCCR_TP_CD
       ,N1ST_CLT_RQST_DT  = B.N1ST_CLT_RQST_DT
       ,N2ND_CLT_RQST_DT  = B.N2ND_CLT_RQST_DT
       ,N3RD_CLT_RQST_DT  = B.N3RD_CLT_RQST_DT
       ,LST_CLT_OFC_CD    = B.LST_CLT_OFC_CD
       ,LST_UPD_CHK_DT    = B.LST_UPD_CHK_DT
       ,OTS_BND_TP_CD     = B.OTS_BND_TP_CD
       ,OTS_TJ_SEQ        = B.OTS_TJ_SEQ
       ,CRE_DT            = B.CRE_DT
       ,CRE_USR_ID        = B.CRE_USR_ID
       ,UPD_DT            = B.UPD_DT
       ,UPD_USR_ID        = B.UPD_USR_ID

WHEN NOT MATCHED THEN

INSERT ( CR_FLG
               ,BIL_TO_CUST_CD
               ,OFC_CD
               ,CLT_BL_NO
               ,INV_NO
               ,OFC_CURR_CD
               ,OTS_BKG_NO
               ,OTS_DUE_DT
               ,OTS_STL_FLG
               ,XCH_RT_TP_CD
               ,CLT_RMK
               ,OTS_GRP_TP_CD
               ,OTS_OCCR_TP_CD
               ,N1ST_CLT_RQST_DT
               ,N2ND_CLT_RQST_DT
               ,N3RD_CLT_RQST_DT
               ,LST_CLT_OFC_CD
               ,LST_UPD_CHK_DT
               ,OTS_BND_TP_CD
               ,OTS_TJ_SEQ
               ,CRE_DT
               ,CRE_USR_ID
               ,UPD_DT
               ,UPD_USR_ID
) VALUES( B.CR_FLG             
         ,B.BIL_TO_CUST_CD     
         ,B.OFC_CD             
         ,B.CLT_BL_NO          
         ,B.INV_NO             
         ,B.OFC_CURR_CD        
         ,B.OTS_BKG_NO         
         ,B.OTS_DUE_DT         
         ,B.OTS_STL_FLG        
         ,B.XCH_RT_TP_CD       
         ,B.CLT_RMK            
         ,B.OTS_GRP_TP_CD      
         ,B.OTS_OCCR_TP_CD     
         ,B.N1ST_CLT_RQST_DT   
         ,B.N2ND_CLT_RQST_DT   
         ,B.N3RD_CLT_RQST_DT   
         ,B.LST_CLT_OFC_CD     
         ,B.LST_UPD_CHK_DT     
         ,B.OTS_BND_TP_CD  
         ,B.OTS_TJ_SEQ    
         ,B.CRE_DT             
         ,B.CRE_USR_ID         
         ,B.UPD_DT             
         ,B.UPD_USR_ID         
)			]]></sql>
			<params>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="clt_bl_no" type="12" value="" out="N"/>
				<param name="inv_no" type="12" value="" out="N"/>
				<param name="ofc_curr_cd" type="12" value="" out="N"/>
				<param name="ots_bkg_no" type="12" value="" out="N"/>
				<param name="cr_flg" type="12" value="" out="N"/>
				<param name="ots_due_dt" type="12" value="" out="N"/>
				<param name="ots_stl_flg" type="12" value="" out="N"/>
				<param name="xch_rt_tp_cd" type="12" value="" out="N"/>
				<param name="bil_to_cust_cd" type="12" value="" out="N"/>
				<param name="clt_rmk" type="12" value="" out="N"/>
				<param name="ots_grp_tp_cd" type="12" value="" out="N"/>
				<param name="ots_occr_tp_cd" type="12" value="" out="N"/>
				<param name="n1st_clt_rqst_dt" type="12" value="" out="N"/>
				<param name="n2nd_clt_rqst_dt" type="12" value="" out="N"/>
				<param name="n3rd_clt_rqst_dt" type="12" value="" out="N"/>
				<param name="lst_clt_ofc_cd" type="12" value="" out="N"/>
				<param name="lst_upd_chk_dt" type="12" value="" out="N"/>
				<param name="ots_bnd_tp_cd" type="12" value="" out="N"/>
				<param name="ots_tj_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
