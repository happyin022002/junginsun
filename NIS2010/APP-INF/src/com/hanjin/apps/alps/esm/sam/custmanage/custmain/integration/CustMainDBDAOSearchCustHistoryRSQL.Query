<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CustMainDBDAOSearchCustHistoryRSQL">
			<desc><![CDATA[Customer history]]></desc>
			<sql><![CDATA[
SELECT MCHD.HIS_SEQ
       ,MCHD.HIS_DTL_SEQ
       ,MCHD.TBL_NM ITEM_HDR
       ,MCHD.COL_NM
       ,MCHD.HIS_CATE_NM
       ,CASE WHEN BHC.ATTR_CTNT6 IS NOT NULL
             THEN (SELECT COD.INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL COD WHERE COD.INTG_CD_ID = BHC.ATTR_CTNT6 AND MCHD.PRE_CTNT = COD.INTG_CD_VAL_CTNT AND ROWNUM = 1)
             ELSE MCHD.PRE_CTNT
        END PRE_CTNT
        ,CASE WHEN BHC.ATTR_CTNT6 IS NOT NULL
             THEN (SELECT COD.INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL COD WHERE COD.INTG_CD_ID = BHC.ATTR_CTNT6 AND MCHD.CRNT_CTNT = COD.INTG_CD_VAL_CTNT AND ROWNUM = 1)
             ELSE MCHD.CRNT_CTNT
        END CRNT_CTNT
       ,CU.USR_NM CRE_USR_ID
       ,CU.OFC_CD OFFICE
       ,TO_CHAR(GLOBALDATE_PKG.TIME_CONV_FNC('KRSEL',MCHD.CRE_DT,BKG_COM_USER_LOC_FNC(MCHD.CRE_USR_ID)), 'YYYY-MM-DD HH24:MI') CRE_DT
       ,TO_CHAR(GLOBALDATE_PKG.TIME_CONV_FNC('KRSEL',MCHD.CRE_DT,'GMT'), 'YYYY-MM-DD HH24:MI') GMT_DT
FROM MDM_CUST_HIS_DTL MCHD
     ,COM_USER CU
     ,BKG_HRD_CDG_CTNT BHC
WHERE MCHD.CUST_CNT_CD = @[cust_cnt_cd]
AND MCHD.CUST_SEQ = @[cust_seq]
AND MCHD.CRE_USR_ID = CU.USR_ID
AND BHC.HRD_CDG_ID(+) = 'MDM_CUSTOMER_HIST'
AND MCHD.COL_NM = BHC.ATTR_CTNT2(+)
ORDER BY MCHD.HIS_SEQ, MCHD.HIS_DTL_SEQ			]]></sql>
			<params>
				<param name="cust_cnt_cd" type="12" value="" out="N"/>
				<param name="cust_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
