<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WeeklyCMDBDAOOnewayCntrUploadCSQL">
			<desc><![CDATA[Oneway Container Upload 의 정보를 삽입 후 저장한다.]]></desc>
			<sql><![CDATA[
MERGE INTO MAS_OFFH_BKG_LIST A USING 
(
        SELECT  @[bkg_no]  BKG_NO
              , @[cntr_no] CNTR_NO 
              , @[tpsz_cd] TPSZ_CD
              , @[term_cd] TERM_CD
              , @[mvmt_cd] MVMT_CD
              , REPLACE(@[onh_dt],'-','') ONH_DT
              , @[onh_yd_cd] ONH_YD_CD
              , REPLACE(@[offh_dt],'-','') OFFH_DT
              , @[offh_yd_cd] OFFH_YD_CD
           FROM DUAL 
) B 
ON (    
        A.BKG_NO   = B.BKG_NO 
    AND A.CNTR_NO  = B.CNTR_NO 
)

WHEN MATCHED THEN
 UPDATE
    SET A.TPSZ_CD       = B.TPSZ_CD
      , A.TERM_CD       = B.TERM_CD
	  , A.MVMT_CD       = B.MVMT_CD    
      , A.ONH_DT        = TO_DATE(B.ONH_DT, 'YYYYMMDD')
      , A.ONH_YD_CD     = B.ONH_YD_CD     
      , A.OFFH_DT       = TO_DATE(B.OFFH_DT, 'YYYYMMDD')
      , A.OFFH_YD_CD    = B.OFFH_YD_CD
      , A.UPD_USR_ID    = @[upd_usr_id]
      , A.UPD_DT        = SYSDATE 

WHEN NOT MATCHED THEN
 INSERT
        (
            BKG_NO
           ,CNTR_NO
           ,TPSZ_CD
           ,TERM_CD
           ,MVMT_CD
           ,ONH_DT
           ,ONH_YD_CD
           ,OFFH_DT
           ,OFFH_YD_CD
           ,CRE_USR_ID
           ,CRE_DT
           ,UPD_USR_ID
           ,UPD_DT
        ) VALUES( 
            @[bkg_no]
           ,@[cntr_no]
           ,@[tpsz_cd]
           ,@[term_cd]
           ,@[mvmt_cd]
           ,TO_DATE(@[onh_dt], 'YYYYMMDD')
           ,@[onh_yd_cd]	
           ,TO_DATE(@[offh_dt], 'YYYYMMDD')
           ,@[offh_yd_cd]	
           ,@[cre_usr_id]
           ,SYSDATE
           ,@[upd_usr_id]
           ,SYSDATE
        )			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
				<param name="tpsz_cd" type="12" value="" out="N"/>
				<param name="term_cd" type="12" value="" out="N"/>
				<param name="mvmt_cd" type="12" value="" out="N"/>
				<param name="onh_dt" type="12" value="" out="N"/>
				<param name="onh_yd_cd" type="12" value="" out="N"/>
				<param name="offh_dt" type="12" value="" out="N"/>
				<param name="offh_yd_cd" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
