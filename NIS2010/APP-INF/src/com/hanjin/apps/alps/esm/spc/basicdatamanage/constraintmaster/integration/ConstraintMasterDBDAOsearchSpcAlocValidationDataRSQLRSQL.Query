<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ConstraintMasterDBDAOsearchSpcAlocValidationDataRSQLRSQL">
			<desc><![CDATA[시트 입력값 체크]]></desc>
			<sql><![CDATA[
#if (${val_type} == 'CARRIER NAME') 
 SELECT CRR_CD AS LOC_CD
       ,CRR_NM 
    FROM MDM_CARRIER
    WHERE DELT_FLG = 'N'
#if (${crr_cd} != '') 
    AND UPPER(CRR_CD) = UPPER(@[crr_cd])
#end
#if (${crr_nm} != '') 
    AND UPPER(CRR_NM) LIKE UPPER('%'||@[crr_nm]||'%')
#end
#else 
SELECT SUM(VAL_CNT) VAL_CNT
FROM (
    SELECT  COUNT(*) VAL_CNT
    FROM    MDM_VSL_SVC_LANE_DIR
    WHERE   VSL_SLAN_CD = @[val_value]
    AND     DELT_FLG    = 'N' 
    AND     'LANE' = @[val_type]
  UNION ALL
    SELECT  COUNT(*)
    FROM    MDM_VSL_SVC_LANE_DIR
    WHERE   VSL_SLAN_DIR_CD = @[val_value]
    AND     DELT_FLG    = 'N'   
    AND     'BOUND' = @[val_type]
  UNION ALL
    SELECT  COUNT(*)
    FROM    MDM_COMMODITY
    WHERE   CMDT_CD = TRIM(TO_CHAR(@[val_value],'000000')) 
    AND     DELT_FLG    = 'N'  
    AND     'COMMODITY' = @[val_type]
  UNION ALL
    SELECT  COUNT(*)
    FROM    PRI_SCG_GRP_CMDT PSC
    WHERE   PSC.SVC_SCP_CD = 'TPW'
    AND     PSC.CHG_CD = 'GRI'
    AND     PSC.SCG_GRP_CMDT_SEQ = @[val_value]
    AND     'GRP_COMMODITY' = @[val_type]
  UNION ALL
    SELECT COUNT(*) 
    FROM PRI_SP_HDR HD, PRI_SP_MN MN
    WHERE HD.SC_NO =@[val_value] /* SC_NO */
    AND HD.PROP_NO = MN.PROP_NO
    AND MN.PROP_STS_CD ='F'
    AND 'SC NO' = @[val_type]
    AND MN.AMDT_SEQ IN 
    		( SELECT AMDT_SEQ FROM PRI_SP_MN K WHERE K.PROP_NO = MN.PROP_NO AND PROP_STS_CD ='F')
  UNION ALL
    SELECT COUNT(*)
    FROM MDM_CNTR_TP_SZ
    WHERE DELT_FLG='N'
    AND CNTR_TPSZ_CD = DECODE(@[val_value],'ALL',CNTR_TPSZ_CD,@[val_value])
    AND 'CNTR TPSZ' = @[val_type]
  UNION ALL
    SELECT COUNT(*)
    FROM MDM_CUSTOMER CUST
    WHERE CUST_CNT_CD = SUBSTR(@[val_value],1,2)
    AND CUST_SEQ = SUBSTR(@[val_value],3)
    AND NVL(NMD_CUST_FLG, 'N') = 'N'
    AND CNTR_DIV_FLG = 'Y'
    AND 'CUSTOMER' = @[val_type]
  UNION ALL
    SELECT COUNT(*)
    FROM MDM_CUST_PERF_GRP
    WHERE CUST_GRP_ID = @[val_value]
    AND NVL(DELT_FLG , 'N') = 'N'
    AND 'CUST_GRP_ID' = @[val_type]
  UNION ALL
    SELECT COUNT(*)
    FROM MDM_CUSTOMER CUST
    WHERE CUST_CNT_CD = SUBSTR(@[val_value],1,2)
    AND CUST_SEQ = SUBSTR(@[val_value],3)
    AND NVL(NMD_CUST_FLG, 'N') = 'N'
    AND CNTR_DIV_FLG = 'Y'
	AND NVL(CUST_GRP_ID,'*') = NVL(@[val_value2],NVL(CUST_GRP_ID,'*'))
    AND 'CUSTOMER_GRP' = @[val_type]
  UNION ALL
    SELECT COUNT(*)
    FROM MDM_LOCATION
    WHERE DELT_FLG='N'
    AND LOC_CD = @[val_value]
    AND ('Location' = @[val_type] OR 'Location/Node' = @[val_type])  
  UNION ALL
    SELECT COUNT(*)
    FROM MDM_EQ_ORZ_CHT
    WHERE DELT_FLG='N'
    AND SCC_CD = @[val_value]
    AND 'SCC' = @[val_type]
  UNION ALL
    SELECT COUNT(*)
    FROM MDM_YARD 
    WHERE YD_CD = @[val_value]
    AND DELT_FLG = 'N'
    AND ('NODE' = @[val_type] OR 'Location/Node' = @[val_type])
  UNION ALL
    SELECT COUNT(*)
    FROM PRI_RP_HDR 
    WHERE RFA_NO = @[val_value]
    AND  'RFA NO' = @[val_type]
  UNION ALL
    SELECT COUNT(*)
    FROM MDM_COUNTRY MC
    WHERE MC.CNT_CD = @[val_value]
    AND MC.DELT_FLG = 'N'
    AND 'CNT' = @[val_type]
  UNION ALL
    SELECT COUNT(*)
    FROM MDM_CUSTOMER CUST
    WHERE CUST_CNT_CD = SUBSTR(@[val_value],1,2)
    AND CUST_SEQ = SUBSTR(@[val_value],3)
    AND NVL(NMD_CUST_FLG, 'N') = 'N'
    AND CNTR_DIV_FLG = 'Y'
    AND 'Actual_Customer' = @[val_type]
  UNION ALL
	SELECT COUNT(*)
	  FROM MAS_LANE_RGST 
	 WHERE TRD_CD = CASE  
	               	WHEN null IS NULL AND @[val_value] IS NULL 
    	             THEN '' 
  	                WHEN null IS NULL AND @[val_value] IS NOT NULL 
                     THEN TRD_CD 
  	                ELSE null
                   END
       AND SUB_TRD_CD = NVL(@[val_value],SUB_TRD_CD) 
       AND NVL(DELT_FLG,'N') = 'N'
  UNION ALL
    SELECT COUNT(*)
    FROM MDM_CARRIER
    WHERE DELT_FLG= 'N'
    AND CRR_CD = @[val_value]
    AND 'CARRIER' = @[val_type]
)
#end			]]></sql>
			<params>
				<param name="crr_cd" type="12" value="" out="N"/>
				<param name="crr_nm" type="12" value="" out="N"/>
				<param name="val_value" type="12" value="" out="N"/>
				<param name="val_type" type="12" value="" out="N"/>
				<param name="val_value2" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
