<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BookingMasterMgtDBDAOBkgEdiGrpUSQL">
			<desc><![CDATA[BkgEdiGrp]]></desc>
			<sql><![CDATA[
MERGE INTO BKG_EDI_GRP TA
USING ( SELECT @[esvc_grp_cd] AS ESVC_GRP_CD,
               SUBSTRB(@[co_cd],1,1) AS CO_CD,
               @[esvc_grp_nm] AS ESVC_GRP_NM,
               @[cust_trd_prnr_id] AS CUST_TRD_PRNR_ID,
               @[mchn_trd_prnr_id] AS MCHN_TRD_PRNR_ID,
               @[esvc_grp_delt_flg] AS ESVC_GRP_DELT_FLG
        FROM   DUAL ) TB
ON    ( TA.ESVC_GRP_CD = TB.ESVC_GRP_CD
        AND TA.CO_CD = TB.CO_CD )
WHEN MATCHED THEN
      UPDATE SET
             ESVC_GRP_NM       = TB.ESVC_GRP_NM,
             CUST_TRD_PRNR_ID  = TB.CUST_TRD_PRNR_ID,
             MCHN_TRD_PRNR_ID  = TB.MCHN_TRD_PRNR_ID,
             ESVC_GRP_DELT_FLG = DECODE(TB.ESVC_GRP_DELT_FLG,'1','Y','Y','Y','N'),
             UPD_USR_ID        = 'System',
             UPD_DT            = SYSDATE      
WHEN NOT MATCHED THEN 
      INSERT ( ESVC_GRP_CD,      CO_CD,
               ESVC_GRP_NM,      CUST_TRD_PRNR_ID,
               MCHN_TRD_PRNR_ID, ESVC_GRP_DELT_FLG, 
               CRE_USR_ID,       CRE_DT,
               UPD_USR_ID,       UPD_DT )
      VALUES ( TB.ESVC_GRP_CD,      TB.CO_CD,
               TB.ESVC_GRP_NM,      TB.CUST_TRD_PRNR_ID,
               TB.MCHN_TRD_PRNR_ID, DECODE(TB.ESVC_GRP_DELT_FLG,'1','Y','Y','Y','N'),
               'System', SYSDATE,
               'System', SYSDATE )			]]></sql>
			<params>
				<param name="esvc_grp_cd" type="12" value="" out="N"/>
				<param name="co_cd" type="12" value="" out="N"/>
				<param name="esvc_grp_nm" type="12" value="" out="N"/>
				<param name="cust_trd_prnr_id" type="12" value="" out="N"/>
				<param name="mchn_trd_prnr_id" type="12" value="" out="N"/>
				<param name="esvc_grp_delt_flg" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
