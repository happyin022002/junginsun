<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RFARateQuotationDBDAORsltPriCommodityRouteVORSQL">
			<desc><![CDATA[   ]]></desc>
			<sql><![CDATA[
SELECT CMDT.QTTN_NO,
       CMDT.QTTN_VER_NO,
       CMDT.CMDT_HDR_SEQ,
       SUBSTR(MAX(SYS_CONNECT_BY_PATH(PRC_CMDT_DEF_CD, ' / ')), 3) AS CMDT_NM
  FROM (SELECT A.QTTN_NO,
               A.QTTN_VER_NO,
               A.CMDT_HDR_SEQ,
               A.CMDT_SEQ,
               A.PRC_CMDT_DEF_CD,
               ROW_NUMBER() OVER(PARTITION BY A.QTTN_NO, A.QTTN_VER_NO, A.CMDT_HDR_SEQ ORDER BY A.QTTN_NO, A.QTTN_VER_NO, DECODE(A.PRC_CMDT_TP_CD, 'G', 1, DECODE(A.PRC_CMDT_TP_CD, 'R', 2, 3)), A.CMDT_HDR_SEQ, A.CMDT_SEQ) AS RN
          FROM PRI_RQ_RT_CMDT     A,
               PRI_RQ_RT_CMDT_HDR X
         WHERE A.QTTN_NO = @[qttn_no]
               AND A.QTTN_VER_NO = @[qttn_ver_no]
               AND A.QTTN_NO = X.QTTN_NO
               AND A.QTTN_VER_NO = X.QTTN_VER_NO
               AND A.CMDT_HDR_SEQ = X.CMDT_HDR_SEQ
               AND NVL(X.FIC_RT_TP_CD, 'G') = NVL(@[fic_rt_tp_cd], 'G')        
        ) CMDT
 START WITH RN = 1
CONNECT BY PRIOR CMDT.CMDT_HDR_SEQ = CMDT.CMDT_HDR_SEQ
           AND PRIOR CMDT.RN = CMDT.RN - 1
 GROUP BY CMDT.QTTN_NO,
          CMDT.QTTN_VER_NO,
          CMDT.CMDT_HDR_SEQ
 ORDER BY CMDT.CMDT_HDR_SEQ			]]></sql>
			<params>
				<param name="qttn_no" type="12" value="" out="N"/>
				<param name="qttn_ver_no" type="12" value="" out="N"/>
				<param name="fic_rt_tp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
