<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralBookingSearchDBDAOsearchTmnl301BlMain2RSQL">
			<desc><![CDATA[searchTmnl301BlMain2]]></desc>
			<sql><![CDATA[
SELECT 'CANCEL_BIT:'		|| BB.BKG_STS_CD											|| CHR(10)
	|| 'CARGOTYPE:'			|| BB.BKG_CGO_TP_CD											|| CHR(10)
	|| 'DR_IND:'			|| decode(BB.DCGO_FLG,'Y','1','0')							|| CHR(10)
	|| 'RF_IND:'			|| decode(BB.RC_FLG,'Y','1','0')							|| CHR(10)
	|| 'AK_IND:'			|| decode(BB.AWK_CGO_FLG,'Y','1','0') 				 		|| CHR(10)
	|| 'BB_IND:'			|| decode(BB.BB_CGO_FLG,'Y','1','0')						|| CHR(10)
	|| 'HD_IND:'			|| decode(BB.SPCL_HIDE_FLG,'Y','1','0')				 		|| CHR(10)
	|| 'UD_IND:'			|| decode(nvl(length(trim(BB.STWG_CD)),0),0,'0','1')		|| CHR(10)
	|| 'UD_CD:'				|| BB.STWG_CD     									 		|| CHR(10)
	|| 'RD_IND:'			|| decode(BB.RD_CGO_FLG,'Y','1','0')				 		|| CHR(10)
	|| 'FG_IND:'			|| decode(BB.FD_GRD_FLG,'Y','1','0')						|| CHR(10)
	|| 'RF_CA:'				|| RF.CTRL_ATMS_FLG											|| CHR(10)
	|| 'RF_MA:'				|| RF.MODI_ATMS_FLG											|| CHR(10)
	|| 'SOC_IND:'			|| decode(BB.SOC_FLG,'Y','1','0')							|| CHR(10)
	|| 'HANGER_IND:'		|| decode(BB.HNGR_FLG,'Y','1','0')							|| CHR(10)
	|| 'EQSUB_IND:'			|| decode(BB.EQ_SUBST_FLG,'Y','1','0')						|| CHR(10)
	|| 'SALES_OFFICE:'		|| BB.OB_SLS_OFC_CD											|| CHR(10)
	|| 'SALES_NAME:'		|| MSR.SREP_NM												|| CHR(10)
	|| 'BKG_STF:'	   	 	|| BB.DOC_USR_ID											|| CHR(10)
	|| 'BKG_STF_NAME:'		|| CU.USR_NM												|| CHR(10)
	|| 'BKG_STF_TEL:'		|| CU.XTN_PHN_NO				                 	       	|| CHR(10)
	|| 'BKG_STF_FAX:'		|| CU.FAX_NO  											    || CHR(10)
	|| 'CONTACT_NAME:'		|| BCP.CNTC_PSON_NM											|| CHR(10)
	|| 'CONTACT_TEL:'		|| BCP.CNTC_PSON_PHN_NO										|| CHR(10)
	|| 'CONTACT_MOBILE:'	|| BCP.CNTC_PSON_MPHN_NO									|| CHR(10)
#if (${rcv_id} == 'KTNETPCS')
	|| 'CONTACT_FAX:'		|| BCP.CNTC_PSON_FAX_NO										|| CHR(10)	
#end
	|| 'BOUND_IND:'			|| 'E'														|| CHR(10)
	|| 'REGIONAL_BKGNBR:'	|| BP_PSA.CUST_REF_NO_CTNT									|| CHR(10)
	|| 'CUST_REF_NO:'		|| BB.XTER_BKG_RQST_REF_NO									|| CHR(10)
	|| 'REF_VOYAGE:'	                                                    		    || CHR(10)
	|| 'SO_NO:'				|| BB.TWN_SO_NO											    || CHR(10)
	|| 'BLKSTWG:'   		||BB.BLCK_STWG_CD                           				|| CHR(10)
	|| 'EQPICKDT:'			||TO_CHAR(BB.MTY_PKUP_DT,'RRRRMMDDHH24MI')				    || CHR(10)
	|| 'EQRTN:'	    		||BB.FULL_RTN_YD_CD						                    || CHR(10)
	|| 'OLDEQRTN:'			||@[edi_old_rtn]											|| CHR(10)
	|| 'FINAL_CFM_DT:'		||(SELECT TO_CHAR(EVNT_DT, 'YYYYMMDDHH24MI')
								 FROM BKG_DOC_PROC_SKD SKD
								WHERE BKG_DOC_PROC_TP_CD = 'CNTCFM'
								  AND SKD.BKG_NO = BB.BKG_NO
								  AND SKD.DOC_PERF_DELT_FLG = 'N')						|| CHR(10)
	|| 'PUCY_CNT:'  		||PU_CY.N1ST_VNDR_CNT_CD									|| CHR(10)
	|| 'PUCY_NM:'   		||replace(replace(PU_CY.YD_NM, chr(13), ' '), chr(10), '')	|| CHR(10)
	|| 'PUCY_ADDR1:'		||SCE_TOKEN_NL_FNC(replace(replace(PU_CY.yd_addr, chr(13), ' '), chr(10), ' '), 1) || CHR(10)
	|| 'PUCY_ADDR2:'		||SCE_TOKEN_NL_FNC(replace(replace(PU_CY.yd_addr, chr(13), ' '), chr(10), ' '), 2) || CHR(10)
	|| 'PUCY_ADDR3:'		||SCE_TOKEN_NL_FNC(replace(replace(PU_CY.yd_addr, chr(13), ' '), chr(10), ' '), 3) || CHR(10)
	|| 'PUCY_ADDR4:'		||SCE_TOKEN_NL_FNC(replace(replace(PU_CY.yd_addr, chr(13), ' '), chr(10), ' '), 4) || CHR(10)
	|| 'PUCY_ADDR5:'		||SCE_TOKEN_NL_FNC(replace(replace(PU_CY.yd_addr, chr(13), ' '), chr(10), ' '), 5) || CHR(10)
	|| 'RTCY_CNT:'  		||RT_CY.N1ST_VNDR_CNT_CD                                    || CHR(10)
	|| 'RTCY_NM:'   		||replace(replace(RT_CY.YD_NM, chr(13), ' '), chr(10), '')  || CHR(10)
	|| 'RTCY_ADDR1:'		||SCE_TOKEN_NL_FNC(replace(replace(RT_CY.yd_addr, chr(13), ' '), chr(10), ' '), 1) || CHR(10)
	|| 'RTCY_ADDR2:'		||SCE_TOKEN_NL_FNC(replace(replace(RT_CY.yd_addr, chr(13), ' '), chr(10), ' '), 2) || CHR(10)
	|| 'RTCY_ADDR3:'		||SCE_TOKEN_NL_FNC(replace(replace(RT_CY.yd_addr, chr(13), ' '), chr(10), ' '), 3) || CHR(10)
	|| 'RTCY_ADDR4:'		||SCE_TOKEN_NL_FNC(replace(replace(RT_CY.yd_addr, chr(13), ' '), chr(10), ' '), 4) || CHR(10)
	|| 'RTCY_ADDR5:'		||SCE_TOKEN_NL_FNC(replace(replace(RT_CY.yd_addr, chr(13), ' '), chr(10), ' '), 5) || CHR(10)
	|| 'BL_PO_NO:'			||replace(replace(BP_PO.CUST_REF_NO_CTNT, chr(13), ''), chr(10), '')   || CHR(10)
	|| 'BL_SI_NO:'  		||BB.XTER_SI_REF_NO											|| CHR(10)
	|| 'DST_TRANS:' 		||BB.DEST_TRNS_MOD_CD										|| CHR(10)
	|| 'BKG_FLEX_IND:' 		||NVL(decode(BB.FLEX_HGT_FLG,'Y','1','0'),'0')				|| CHR(10)
	|| 'BL_EXPORT_MRN:' 	||replace(replace(BP_XMRN.CUST_REF_NO_CTNT, chr(13), ''), chr(10), '')	|| CHR(10)
	|| 'PRECAUTION:'  		||BB.PRCT_FLG 										|| CHR(10) BL_MAIN2
FROM	BKG_BOOKING	BB,
        BKG_VVD VVD,
        VSK_VSL_PORT_SKD VVPS1,
		BKG_RF_CGO RF, 
		COM_USER CU, 
		MDM_YARD PU_CY, 
		MDM_YARD RT_CY,
		BKG_CNTC_PSON BCP, 
		BKG_REFERENCE BP_PSA, 
		BKG_REFERENCE BP_PO,
		BKG_REFERENCE BP_XMRN,
		MDM_SLS_REP MSR
WHERE	BB.BKG_NO	   = @[bkg_no]
AND     BB.BKG_NO          = VVD.BKG_NO(+)
AND     BB.POL_CD          = VVD.POL_CD(+)	
AND     BB.BKG_NO          = RF.BKG_NO(+)	
AND     BB.BKG_NO          = BCP.BKG_NO(+)
AND     BCP.BKG_CNTC_PSON_TP_CD(+) = 'BK'	
AND     BB.BKG_NO          = BP_PSA.BKG_NO(+)
AND     BP_PSA.bkg_ref_tp_cd(+) = 'PSAN'
AND     BB.BKG_NO          = BP_PO.BKG_NO(+)
AND     BP_PO.bkg_ref_tp_cd(+) = 'BKPO'	
AND     BB.BKG_NO          = BP_XMRN.BKG_NO(+)
AND     BP_XMRN.bkg_ref_tp_cd(+) = 'XMRN'	
AND     VVD.VSL_CD		   = VVPS1.VSL_CD(+)
AND     VVD.SKD_VOY_NO	   = VVPS1.SKD_VOY_NO(+)
AND     VVD.SKD_DIR_CD	   = VVPS1.SKD_DIR_CD(+)
AND     VVD.POL_CD 		   = VVPS1.VPS_PORT_CD(+)
AND     VVD.POL_CLPT_IND_SEQ = VVPS1.CLPT_IND_SEQ(+)
AND     UPPER(BB.DOC_USR_ID) = UPPER(CU.USR_ID(+))
AND     BB.OB_SREP_CD   = MSR.SREP_CD(+)
AND     BB.MTY_PKUP_YD_CD = PU_CY.yd_cd(+)
AND     BB.FULL_RTN_YD_CD = RT_CY.yd_cd(+)			]]></sql>
			<params>
				<param name="edi_old_rtn" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="SEL900684700" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
