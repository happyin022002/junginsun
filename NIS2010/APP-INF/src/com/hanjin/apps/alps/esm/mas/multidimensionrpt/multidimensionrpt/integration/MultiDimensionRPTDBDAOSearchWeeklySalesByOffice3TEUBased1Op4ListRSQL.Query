<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="MultiDimensionRPTDBDAOSearchWeeklySalesByOffice3TEUBased1Op4ListRSQL">
			<desc><![CDATA[P&L by Lane OP4]]></desc>
			<sql><![CDATA[
SELECT    
	 DECODE(GROUPING(RPT_ITM_DESC), 1, '1', '2') AS LV 
	,MIN(SEQ) AS SEQ 
	,DECODE(RPT_ITM_DESC, NULL, SGRP_COST_CD_DESC, RPT_ITM_DESC) AS ITM_DESC 
	,STND_COST_CD 
	,SGRP_COST_CD_DESC 
	,RPT_ITM_DESC 
	,RPT_ITM_COLR_FLG 
	
	#foreach($key in ${allcols}) 
		,SUM(HH_AMT$velocityCount) AS HH_AMT$velocityCount
		,SUM(BH_AMT$velocityCount) AS BH_AMT$velocityCount
		,SUM(TRD_AMT$velocityCount)   AS TRD_AMT$velocityCount
	#end 
			
	,SUM (TTL_AMT)   AS TTL_AMT 
	,COUNT (1)       AS CNT 
FROM ( 
	SELECT C2.RPT_DP_SEQ AS SEQ 
		,C2.SGRP_COST_CD 
		,C2.STND_COST_CD 
		,C2.SGRP_COST_CD_DESC 
		, CASE  WHEN @[f_op_view] ='OP1' AND C2.RPT_ITM_DESC = 'OPCOST01' THEN 'OP Cost Total(Pooling)'
			WHEN @[f_op_view] ='OP1' AND C2.RPT_ITM_DESC = 'OPCOST02' THEN 'OP-OP5'
			WHEN @[f_op_view] ='OP4' AND C2.RPT_ITM_DESC = 'OPCOST01' THEN 'OP Cost Total(OP6)'
			WHEN @[f_op_view] ='OP4' AND C2.RPT_ITM_DESC = 'OPCOST02' THEN 'OP4-OP6'
			WHEN @[f_op_view] ='OP5' AND C2.RPT_ITM_DESC = 'OPCOST01' THEN 'OP Cost Total(OP5)'
			WHEN @[f_op_view] ='OP6' AND C2.RPT_ITM_DESC = 'OPCOST01' THEN 'OP Cost Total(OP6)'
			ELSE  C2.RPT_ITM_DESC END AS RPT_ITM_DESC
		,C2.RPT_ITM_COLR_FLG 
		
		#foreach($key in ${allcols}) 
			,SUM(CASE WHEN (C2.TRD_CD = '$key' AND C2.HUL_BND_CD = 'HH') THEN NVL (C1.AMT, 0) ELSE 0 END) AS HH_AMT$velocityCount
			,SUM(CASE WHEN (C2.TRD_CD = '$key' AND C2.HUL_BND_CD = 'BH') THEN NVL (C1.AMT, 0) ELSE 0 END) AS BH_AMT$velocityCount
			,SUM(CASE WHEN  C2.TRD_CD = '$key' THEN NVL (C1.AMT, 0) ELSE 0 END) AS TRD_AMT$velocityCount
		#end 
		
		,SUM(NVL(C1.AMT, 0)) AS TTL_AMT 
	FROM ( 
		 /* 계정별 비용집계 */
		SELECT   /*+ ORDERED */ 
			 B1.TRD_CD 
			,L1.HUL_BND_CD 
			,B2.STND_COST_CD 
			,SUM (DECODE (@[f_pro_vw] 
							,'P', DECODE (B2.STND_COST_CD  
											,'LOAD0000', DECODE(SUBSTR (B2.CNTR_TPSZ_CD, -1),'2', B2.N4TH_ESTM_PL_AMT, '3', B2.N4TH_ESTM_PL_AMT, B2.N4TH_ESTM_PL_AMT * 2) 
											,'BSA00000', B2.N4TH_ESTM_PL_AMT 
											,DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', B2.N4TH_CO_AMT,'O|BIZ', B2.N4TH_ESTM_PL_AMT,B2.N4TH_ESTM_PL_AMT) 
										) 
							,'R', DECODE (B2.STND_COST_CD 
										,'LOAD0000', DECODE(SUBSTR(B2.CNTR_TPSZ_CD, -1),'2', B2.RA_PL_AMT, '3', B2.RA_PL_AMT, B2.RA_PL_AMT * 2) 
										,'92404011', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, B2.RA_PL_AMT)) 
										,B2.RA_PL_AMT 
									) 
						) 
			) AS AMT 
		FROM MAS_MON_VVD B1 
			,MAS_PFIT_LSS_SMRY B2 
			,MAS_PFIT_LSS_RPT_ITM B3 
			,MAS_OFC_LVL B4 
            , MAS_LANE_RGST L1
		WHERE B1.VSL_CD        = B2.VSL_CD 
			AND B1.SKD_VOY_NO    = B2.SKD_VOY_NO 
			AND B1.DIR_CD        = B2.SKD_DIR_CD 
			AND B1.TRD_CD        = B2.TRD_CD 
			AND B1.RLANE_CD      = B2.RLANE_CD 
			AND B1.IOC_CD        = B2.IOC_CD 
				
            AND B1.RLANE_CD = L1.RLANE_CD
            AND B1.DIR_CD = L1.DIR_CD
            AND B1.TRD_CD = L1.TRD_CD
            AND B1.IOC_CD = L1.IOC_CD

			#if(${f_chkprd} =='M')
				AND B1.COST_YRMON    BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON   
			#elseif (${f_chkprd} =='W')
				AND B1.SLS_YRMON     BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON  
			#end /*ofc_월별 관리*/
		#if(${f_init_cost} == 'Y')
			AND B2.STND_COST_CD  NOT IN 
                      (SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV','OF','VF') AND STND_COST_CD <> '54600000')
		#end /* 배부 이전 원가 */           
			AND B2.STND_COST_CD  NOT IN ('91401011')  /* STP REV 제외 */
			AND B2.STND_COST_CD  = B3.STND_COST_CD 
			AND B1.DELT_FLG      <> 'Y' 		
		
			#if(${f_chkprd} =='M')
				AND B1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   
			#elseif (${f_chkprd} =='W')
				AND B1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    
				AND B1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   
			#end		
		
			#if(${f_trd_cd} !='') 
				AND B1.TRD_CD    = @[f_trd_cd]  
			#end
			#if(${f_rlane_cd} !='') 
				AND B1.RLANE_CD  = @[f_rlane_cd]
			#end
			#if(${f_dir_cd} !='')   
				AND B1.DIR_CD    = @[f_dir_cd] 
			#end
			#if(${f_vsl_cd} !='') 
				AND B1.VSL_CD    = @[f_vsl_cd] 
			#end
			#if(${f_skd_voy_no} !='')  
				AND B1.SKD_VOY_NO    = @[f_skd_voy_no] 
			#end
			#if(${f_skd_dir_cd} !='') 
				AND B1.DIR_CD     = @[f_skd_dir_cd] 
		    #end  
			#if(${f_sub_trd_cd} !='') 
				AND B1.SUB_TRD_CD = @[f_sub_trd_cd] 
		    #end             
			#if(${f_ias_rgn_cd} !='') 
				AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] 
			#end
			#if(${f_trd_dir_cd} !='') 
				AND L1.HUL_BND_CD = @[f_trd_dir_cd] 
			#end 
		              
			AND B3.RPT_VW_CD = @[f_pro_vw] 
			AND DECODE (@[f_ofc_vw], 'C', B2.AGMT_SGN_OFC_CD, 'L', B2.SLS_OFC_CD) = B4.OFC_CD  
		
			#if(${f_ofc_cd} !='')
				#if(${f_excl_sts} =='')
					/* N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAA', 'SINWA', '') */
					AND DECODE (@[f_ofc_lvl] ,'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  
				#else
					AND B4.OFC_CD = @[f_ofc_cd]  
				#end
			#else
				/* N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAA', 'SINWA', '') */
				AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) IS NOT NULL  
				AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_TP_CD,'3', B4.OFC_N3RD_LVL_TP_CD
				           ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', B1.COST_YRMON, B1.SLS_YRMON), 1, 4), '2008', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCNA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)
				                                                   , '2007', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCNA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)
				                                                   , DECODE(B4.OFC_N4TH_LVL_CD, 'SHADSC', B4.OFC_N4TH_LVL_TP_CD, B4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA*/
				           ,'5', B4.OFC_N5TH_LVL_TP_CD,'6', B4.OFC_N6TH_LVL_TP_CD,'7', B4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  
			#end
		
			#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
				AND (B3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* strDisplay( f_pro_obj P->O,A,B) */
					OR B3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
			#else
				#if( ${f_pro_lvl} =='C')
					AND B3.STND_COST_TP_CD IN ('S','C') 
				#elseif (${f_pro_lvl} =='O')
					AND B3.STND_COST_TP_CD IN ('S','C','O') 
				#end
			#end
		
		 GROUP BY B1.TRD_CD, L1.HUL_BND_CD, B2.STND_COST_CD 
		 UNION ALL 
#if(${f_init_cost} == 'Y')
		 /* 계정별 비용집계 */
		SELECT   /*+ ORDERED */ 
			 B1.TRD_CD 
			,L1.HUL_BND_CD 
			,B2.STND_COST_CD 
			,SUM (DECODE (@[f_pro_vw] 
							,'P', DECODE (B2.STND_COST_CD  
											,'LOAD0000', DECODE(SUBSTR (B2.CNTR_TPSZ_CD, -1),'2', B2.N4TH_ESTM_PL_AMT, '3', B2.N4TH_ESTM_PL_AMT, B2.N4TH_ESTM_PL_AMT * 2) 
											,'BSA00000', B2.N4TH_ESTM_PL_AMT 
											,DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', B2.N4TH_CO_AMT,'O|BIZ', B2.N4TH_ESTM_PL_AMT,V.NTWK_HIR_COST_AMT) 
										) 
							,'R', DECODE (B2.STND_COST_CD 
										,'LOAD0000', DECODE(SUBSTR(B2.CNTR_TPSZ_CD, -1),'2', B2.RA_PL_AMT, '3', B2.RA_PL_AMT, B2.RA_PL_AMT * 2) 
										,'92404011', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, B2.RA_PL_AMT)) 
										,B2.RA_PL_AMT 
									) 
						) 
			) AS AMT 
		FROM MAS_MON_VVD B1 
			,MAS_PFIT_LSS_SMRY B2 
			,MAS_PFIT_LSS_RPT_ITM B3 
			,MAS_OFC_LVL B4 
            , MAS_LANE_RGST L1
			,MAS_VVD_HIR V
		WHERE B1.VSL_CD        = B2.VSL_CD 
			AND B1.SKD_VOY_NO    = B2.SKD_VOY_NO 
			AND B1.DIR_CD        = B2.SKD_DIR_CD 
			AND B1.TRD_CD        = B2.TRD_CD 
			AND B1.RLANE_CD      = B2.RLANE_CD 
			AND B1.IOC_CD        = B2.IOC_CD 
				
            AND B1.RLANE_CD = L1.RLANE_CD
            AND B1.DIR_CD = L1.DIR_CD
            AND B1.TRD_CD = L1.TRD_CD
            AND B1.IOC_CD = L1.IOC_CD

			#if(${f_chkprd} =='M')
				AND B1.COST_YRMON    BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON   
			#elseif (${f_chkprd} =='W')
				AND B1.SLS_YRMON     BETWEEN B4.OFC_APLY_FM_YRMON AND B4.OFC_APLY_TO_YRMON  
			#end /*ofc_월별 관리*/
		#if(${f_init_cost} == 'Y')
			AND B2.STND_COST_CD  IN 
                      (SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV','OF','VF') AND STND_COST_CD <> '54600000')
		#end /* 배부 이전 원가 */           
			AND B2.STND_COST_CD  NOT IN ('91401011')  /* STP REV 제외 */
		AND V.VSL_CD        = B2.VSL_CD 
		AND V.SKD_VOY_NO    = B2.SKD_VOY_NO 
		AND V.DIR_CD        = B2.SKD_DIR_CD 
		AND V.TRD_CD        = B2.TRD_CD 
		AND V.RLANE_CD      = B2.RLANE_CD 
		AND V.IOC_CD        = B2.IOC_CD 
		AND V.STND_COST_CD  = B2.STND_COST_CD
			AND B2.STND_COST_CD  = B3.STND_COST_CD 
			AND B1.DELT_FLG      <> 'Y' 		
		
			#if(${f_chkprd} =='M')
				AND B1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon]   
			#elseif (${f_chkprd} =='W')
				AND B1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'    
				AND B1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]   
			#end		
		
			#if(${f_trd_cd} !='') 
				AND B1.TRD_CD    = @[f_trd_cd]  
			#end
			#if(${f_rlane_cd} !='') 
				AND B1.RLANE_CD  = @[f_rlane_cd]
			#end
			#if(${f_dir_cd} !='')   
				AND B1.DIR_CD    = @[f_dir_cd] 
			#end
			#if(${f_vsl_cd} !='') 
				AND B1.VSL_CD    = @[f_vsl_cd] 
			#end
			#if(${f_skd_voy_no} !='')  
				AND B1.SKD_VOY_NO    = @[f_skd_voy_no] 
			#end
			#if(${f_skd_dir_cd} !='') 
				AND B1.DIR_CD     = @[f_skd_dir_cd] 
		    #end  
			#if(${f_sub_trd_cd} !='') 
				AND B1.SUB_TRD_CD = @[f_sub_trd_cd] 
		    #end             
			#if(${f_ias_rgn_cd} !='') 
				AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] 
			#end
			#if(${f_trd_dir_cd} !='') 
				AND L1.HUL_BND_CD = @[f_trd_dir_cd] 
			#end 
		              
			AND B3.RPT_VW_CD = @[f_pro_vw] 
			AND DECODE (@[f_ofc_vw], 'C', B2.AGMT_SGN_OFC_CD, 'L', B2.SLS_OFC_CD) = B4.OFC_CD  
		
			#if(${f_ofc_cd} !='')
				#if(${f_excl_sts} =='')
					/* N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAA', 'SINWA', '') */
					AND DECODE (@[f_ofc_lvl] ,'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  
				#else
					AND B4.OFC_CD = @[f_ofc_cd]  
				#end
			#else
				/* N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAA', 'SINWA', '') */
				AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_CD,'3', B4.OFC_N3RD_LVL_CD,'4', B4.OFC_N4TH_LVL_CD,'5', B4.OFC_N5TH_LVL_CD,'6', B4.OFC_N6TH_LVL_CD,'7', B4.OFC_N7TH_LVL_CD) IS NOT NULL  
				AND DECODE (@[f_ofc_lvl],'1', B4.OFC_N1ST_LVL_CD,'2', B4.OFC_N2ND_LVL_TP_CD,'3', B4.OFC_N3RD_LVL_TP_CD
				           ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', B1.COST_YRMON, B1.SLS_YRMON), 1, 4), '2008', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCNA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)
				                                                   , '2007', DECODE(B4.OFC_N4TH_LVL_CD, 'NYCNA', B4.OFC_N4TH_LVL_CD, B4.OFC_N4TH_LVL_TP_CD)
				                                                   , DECODE(B4.OFC_N4TH_LVL_CD, 'SHADSC', B4.OFC_N4TH_LVL_TP_CD, B4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA*/
				           ,'5', B4.OFC_N5TH_LVL_TP_CD,'6', B4.OFC_N6TH_LVL_TP_CD,'7', B4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  
			#end
		
			#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
				AND (B3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* strDisplay( f_pro_obj P->O,A,B) */
					OR B3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
			#else
				#if( ${f_pro_lvl} =='C')
					AND B3.STND_COST_TP_CD IN ('S','C') 
				#elseif (${f_pro_lvl} =='O')
					AND B3.STND_COST_TP_CD IN ('S','C','O') 
				#end
			#end
		
		 GROUP BY B1.TRD_CD, L1.HUL_BND_CD, B2.STND_COST_CD 
		 UNION ALL 
#end

		 /*-- SUMMRY 비용집계 -----*/
		SELECT TRD_CD 
			,HUL_BND_CD
			,DECODE (B2.RNUM 
			       ,1, 'VOYAGE00' 
			       ,2, 'LOADFACT' 
			       ,3, 'REVENUE0' 
			       ,4, 'RPB00000' 
			       ,5, 'OTHINCOM' 
			       ,6, 'INCOMTTL' 
			       ,7, 'CMCOST00' 
			       ,8, 'CMCB0000' 
			       ,9, 'CMCTOTAL' 
			       ,10, 'CMB00000' 
			       ,11, 'OPCOST00' 
			       ,12, 'OPCB000X' 
			       ,13, 'OPCTOTAL' 
			       ,14, 'OPB00000' 
			       ,15, 'TSCTRB01' 
			       ,16, 'CMMT0001' 
			       ,17, 'BCMTOTAL' 
			       ,18, 'BCMB0000' 
			       ,19, '65901023'   
			       ,20, 'BLN00001'    
			       ,21, 'BLN00002'   
			       ,22, 'BLNTOTAL'   
			       ,23, 'BOPTOTAL' 
			       ,24, 'BOPB000X' 
			       ,25, 'EQCOST00' 
				   ,26, 'OPCOST01' 	
			   	   ,27, 'OPCOST02' 
				   ,28, 'NTCOINIT' 	
			   	   ,29, 'NTMASLOC'	
			   	   ,30, '65010001'  
				   ,31, 'OPCOSTEX' 	
			   	   ,32, 'OPCOSTIN' 	
			   	   ,33, 'OPCB0000' 	
			   	   ,34, 'BOPTTLEX' 	
			   	   ,35, 'BOPTTLIN' 	
			   	   ,36, 'BOPB0000' 		
			       ) STND_COST_CD 
			,DECODE 
			   (B2.RNUM 
			   ,1, VOYAGE                                            /* VOYAGE00 */
			   ,2, DECODE (SUPPLY, 0, 0, LOAD_TEU / SUPPLY) * 100    /* LOADFACT */
			   ,3, REVENUE                                           /* REVENUE0 */
			   ,4, DECODE (LOAD_TEU, 0, 0, REVENUE / LOAD_TEU)       /* RPB00000 (REV / TEU) */
			   ,5, OTHER_INCOME                                      /* OTHINCOM */
			   ,6, INCOME_TOTAL                                      /* INCOMTTL */
			   ,7, DECODE(@[f_pro_vw]  
                       ,'P', CM_COST 
                       ,'R', DECODE (@[f_ofc_lvl],'1', (CM_COST + SPC_CHTR) ,CM_COST )  
                       )      /* CMCOST00 (COST1 TOTAL) */
               ,8, DECODE (LOAD_TEU 
                          ,0, 0 
                          ,DECODE (@[f_pro_vw]  
                                     ,'P', CM_COST 
                                     ,'R', DECODE (@[f_ofc_lvl],'1', (CM_COST + SPC_CHTR),CM_COST)  
                                     ) 
                            / LOAD_TEU 
                          )        /* CMCB0000 (Cost1/TEU) */
               ,9, (INCOME_TOTAL - (CM_COST + SPC_CHTR))   /* CMCTOTAL (CM(Net Revenue) Total) */
               ,10, DECODE (LOAD_TEU,0, 0, (INCOME_TOTAL - (CM_COST + SPC_CHTR)) / LOAD_TEU)   /* CMB00000 (CM(Net Revenue)/TEU) */
			   ,11, OP_COST 
			   ,12, DECODE (LOAD_TEU, 0, 0, OP_COST / LOAD_TEU) 
			   ,13, DECODE (@[f_pro_vw] 
                           ,'P', 0 
                           ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE (@[f_ofc_lvl],'1', 0, (INCOME_TOTAL) - (CM_COST) + (STP_REV-ABC_OTH_COND) + (ABC_OTH - STP_COST) - OP_COST)) 
                           )  /* OPCTOTAL (Branch CM-cost2) */ 
               ,14, DECODE (LOAD_TEU 
                           ,0, 0 
                           ,   DECODE (@[f_pro_vw] 
                                      ,'P', 0 
                                      ,'R',DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE (@[f_ofc_lvl],'1', 0,(INCOME_TOTAL) - (CM_COST) + (STP_REV-ABC_OTH_COND) + (ABC_OTH - STP_COST) - OP_COST)) 
                                      ) 
                             / LOAD_TEU 
                           ) /* OPB00000(OPCTOTAL/load) */
			   ,15, (INCOME_TOTAL + TS_COST) - (CM_COST + OP_COST)   /* TSCTRB01 */ 
			   ,16, ((INCOME_TOTAL - CM_COST) - N4TH_ESTM_PL_AMT - N4TH_CO_AMT - CMMT_COST - INTER_TS)   /* CMMT0001 */ 
			   ,17, DECODE (@[f_pro_vw]
                           ,'P', 0 
                           ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE (@[f_ofc_lvl],'1', 0, (INCOME_TOTAL) - (CM_COST + SPC_CHTR) + (STP_REV-ABC_OTH_COND) + (ABC_OTH - STP_COST))) 
                           )   /* BCMTOTAL (Branch CM) */ 
               ,18, DECODE (LOAD_TEU 
                           ,0, 0 
                           ,   DECODE (@[f_pro_vw] 
                                      ,'P', 0 
                                      ,'R',DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE (@[f_ofc_lvl],'1', 0,(INCOME_TOTAL) - (CM_COST + SPC_CHTR) + (STP_REV-ABC_OTH_COND) + (ABC_OTH - STP_COST))) 
                                      ) 
                             / LOAD_TEU  
                           )   /* BCMB0000 (Branch CM / TEU) */
			   ,19, DECODE (@[f_pro_vw],'P', 0 ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, ABC_OTH)))                /* 65901023 */
			   ,20, DECODE (@[f_pro_vw],'P', 0 ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, STP_REV-ABC_OTH_COND)))   /* BLN00001 */
			   ,21, DECODE (@[f_pro_vw],'P', 0 ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C', DECODE(@[f_ofc_lvl],'1',0, STP_COST - ABC_OTH)))       /*BLN00002 */
			   ,22, DECODE (@[f_pro_vw],'P', 0 ,'R', DECODE(@[f_ofc_vw],'L', 0, 'C',DECODE(@[f_ofc_lvl],'1',0, (STP_REV-ABC_OTH_COND)-(STP_COST - ABC_OTH))))   /* BLNTOTAL */
			   ,23, DECODE (@[f_pro_vw] 
                           ,'P', INCOME_TOTAL - (CM_COST + OP_COST) 
                           ,'R', DECODE (@[f_ofc_lvl] 
                                        ,'1', INCOME_TOTAL - (CM_COST + OP_COST) 
                                        , INCOME_TOTAL - (CM_COST + OP_COST) 
                                        ) 
                           )   /* BOPTOTAL */ 
               ,24, DECODE (LOAD_TEU 
                           ,0, 0 
                           , (  DECODE (@[f_pro_vw] 
                                      ,'P', INCOME_TOTAL - (CM_COST + OP_COST) 
                                      ,'R', DECODE (@[f_ofc_lvl] 
                                                   ,'1', INCOME_TOTAL - (CM_COST + OP_COST) 
                                                   , INCOME_TOTAL - (CM_COST + OP_COST) 
                                                   ) 
                                        ) 
                             ) 
                             / LOAD_TEU 
                           )  /* BOPB0000 ((BOPTOTAL)/TEU) */
			   ,25, EQ_COST 
			   ,26, OP_COST01 			   		
		   	   ,27, OP_COST02 	
			   ,28, INIT_COST 			   		
		   	   ,29, TS_ALOC			   		
		   	   ,30, GEN_EXPN
   			   ,31, (OP_COST - VSL_INT)	
			   ,32, OP_COST 
			   ,33, DECODE (LOAD_TEU, 0, 0, (OP_COST - VSL_INT) / LOAD_TEU)
			   ,34, (INCOME_TOTAL - CM_COST) - (OP_COST - VSL_INT)  /* OP(excluding interest) */ 
               ,35, (INCOME_TOTAL - CM_COST) - OP_COST              /* OP(including interest) */ 
               ,36, DECODE (LOAD_TEU,0,0, ((INCOME_TOTAL - CM_COST) - (OP_COST - VSL_INT)) / LOAD_TEU )  /* OP(excluding)/TEU */
			   ) AS AMT 
			   
		FROM ( 
		  /*-- SUMMRY : 계정별비용집계 ------*/
			SELECT   TRD_CD 
				,HUL_BND_CD
				,SUM (VOYAGE) VOYAGE 
				,SUM (SUPPLY) SUPPLY 
				,SUM (LOAD_TEU) LOAD_TEU 
				,SUM (REVENUE) REVENUE 
				,SUM (OTHER_INCOME) OTHER_INCOME 
				,SUM (SPC_CHTR) SPC_CHTR 
				,SUM (INCOME_TOTAL) INCOME_TOTAL 
				,SUM (CM_COST) CM_COST 
				,SUM (ABC_OWN) ABC_OWN 
				,SUM (STP_COST) STP_COST 
				,SUM (STP_REV) STP_REV 
				,SUM (ABC_OTH) ABC_OTH  /*65901021 ABC FOR STP EXPENSE(MINUS COST)*/
				,SUM (ABC_OTH_COND) ABC_OTH_COND 
				,SUM (OP_COST) + SUM (GEN_EXPN) OP_COST 
				,SUM (TS_COST) TS_COST 
				,SUM (CMMT_COST) CMMT_COST 
				,SUM (N4TH_ESTM_PL_AMT) N4TH_ESTM_PL_AMT 
				,SUM (N4TH_CO_AMT) N4TH_CO_AMT 
				,SUM (INTER_TS) INTER_TS 
				,SUM (EQ_COST) EQ_COST 
				,SUM (DEM_DET) DEM_DET 
				,SUM (OP_COST01) + SUM (GEN_EXPN) OP_COST01
				,SUM (OP_COST) - SUM (OP_COST01) OP_COST02
				,SUM (INIT_COST) INIT_COST
				,SUM (TS_ALOC) TS_ALOC
				,SUM (GEN_EXPN) GEN_EXPN
				,SUM (VSL_INT) VSL_INT
			FROM (                        
				SELECT   /*+ ORDERED */  
					 A1.TRD_CD 
					,L1.HUL_BND_CD 
					,COUNT(DISTINCT A2.TRD_CD|| A2.RLANE_CD || A2.IOC_CD || A2.VSL_CD || A2.SKD_VOY_NO || A2.SKD_DIR_CD)  AS VOYAGE 
					,NVL(SUM(DECODE(A3.STND_COST_CD,'BSA00000', DECODE (@[f_pro_vw],'P', A2.N4TH_ESTM_PL_AMT,'R', A2.RA_PL_AMT),0)),0) AS SUPPLY 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'LOAD0000', DECODE (@[f_pro_vw] 
					                                     ,'P', DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1),'2', A2.N4TH_ESTM_PL_AMT, '3', A2.N4TH_ESTM_PL_AMT, A2.N4TH_ESTM_PL_AMT * 2) 
					                                     ,'R', DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1),'2', A2.RA_PL_AMT, '3', A2.RA_PL_AMT, A2.RA_PL_AMT * 2) 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS LOAD_TEU 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'41101011', DECODE (@[f_pro_vw] 
					                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT, A2.N4TH_ESTM_PL_AMT) 
					                                     ,'R', A2.RA_PL_AMT 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS REVENUE 
					,NVL(SUM(CASE 
					           WHEN A3.STND_COST_CD IN ('43102011', '43201011', '43207011') THEN 
					           			DECODE (@[f_pro_vw] 
                                           ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT, A2.N4TH_ESTM_PL_AMT) 
                                           ,'R', A2.RA_PL_AMT 
                                           ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS OTHER_INCOME 
					,NVL(SUM(CASE 
					           WHEN A3.STND_COST_CD IN ('43102011') THEN 
					           		DECODE (@[f_pro_vw]
                                           ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
                                           ,'R', A2.RA_PL_AMT 
                                           ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS SPC_CHTR 
					,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
					                 ,'S', DECODE (@[f_pro_vw]
					                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT, A2.N4TH_ESTM_PL_AMT) 
					                              ,'R', A2.RA_PL_AMT 
					                              ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS INCOME_TOTAL 
					,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
					                 ,'C', DECODE (A3.STND_COST_CD 
					                              ,'BSA00000', 0 /* 공급량 */
					                              ,'LOAD0000', 0 /* 수송량 */
					                              ,'91401011', 0 /* STP Revenue */ 
					                              ,'92404011', 0 /* STP Cost  65901021 */ 
					                              ,DECODE (@[f_pro_vw]
					                                      ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                                      ,'R', A2.RA_PL_AMT 
					                                      ) 
					                              ) 
					                 ) 
					         ) 
					    ,0 
					    ) AS CM_COST 
					,NVL(SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('65901011') THEN 
					           		DECODE (@[f_pro_vw]
                                           ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
                                           ,'R', A2.RA_PL_AMT 
                                           ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS ABC_OWN 
					,NVL 
					   (SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('92404011') THEN 
					           		DECODE (@[f_pro_vw]
                                           ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
                                           ,'R', A2.RA_PL_AMT 
                                           ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS STP_COST 
					,NVL 
					   (SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('65901021') THEN 
					           		DECODE (@[f_pro_vw]
                                           ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
                                           ,'R', A2.RA_PL_AMT 
                                           ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS ABC_OTH 
					,0 AS STP_REV 
					,0 AS ABC_OTH_COND 
					,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
					                 ,'O', DECODE (@[f_pro_vw]
					                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                              ,'R', A2.RA_PL_AMT 
					                              ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS OP_COST 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'TSCTRB00', DECODE (@[f_pro_vw]
					                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                                     ,'R', A2.RA_PL_AMT 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS TS_COST 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'CMMT0000', DECODE (@[f_pro_vw]
					                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                                     ,'R', A2.RA_PL_AMT 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS CMMT_COST 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'HJSAMT00', DECODE (@[f_pro_vw]
					                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                                     ,'R', A2.RA_PL_AMT 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS N4TH_ESTM_PL_AMT 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'CHTOUT00', DECODE (@[f_pro_vw]
					                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                                     ,'R', A2.RA_PL_AMT 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS N4TH_CO_AMT 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'INTTRDTS', DECODE (@[f_pro_vw]
					                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                                     ,'R', A2.RA_PL_AMT 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS INTER_TS 
					,NVL 
					   (SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('92202013','92202014') THEN 
					           		DECODE (@[f_pro_vw]
                                           ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
                                           ,'R', A2.RA_PL_AMT 
                                           ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS EQ_COST 
					,NVL 
					   (SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('43201011') THEN 
					           		DECODE (@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS DEM_DET 
					   ,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
				                 ,'O', DECODE (@[f_pro_vw]
				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_HJS_SLS_AMT,A2.N4TH_ESTM_PL_AMT) 
				                              ,'R', A2.RA_PL_AMT 
				                              ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS OP_COST01 
                    -- Initial Network Cost(SML Sales/Slot Cht-out->All Network Cost by VVD->Total)
                    , SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF' ,'VF') AND STND_COST_CD <> '54600000') 
                               THEN NVL(A2.N4TH_HJS_SLS_AMT,0) + NVL(A2.N4TH_CO_AMT,0) - NVL(A2.N4TH_ASGN_AMT,0) ELSE 0 END) INIT_COST
                    -- T/S Cost Amount
                    , SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF', 'VF') AND STND_COST_CD <> '54600000') 
                               THEN A2.N4TH_ASGN_AMT ELSE 0 END) TS_ALOC
					,0 AS GEN_EXPN
					, NVL 
					   (SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('72100000') THEN 
					           		DECODE (@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_HJS_SLS_AMT,A2.N4TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS VSL_INT
					,NVL 
					   (SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('43207011') THEN 
					           		DECODE (@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_HJS_SLS_AMT,A2.N4TH_ESTM_PL_AMT)
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS MISC 
				FROM MAS_MON_VVD A1 
					,MAS_PFIT_LSS_SMRY A2 
					,MAS_PFIT_LSS_RPT_ITM A3 
					,MAS_OFC_LVL A4 
					, MAS_LANE_RGST L1
				WHERE A1.VSL_CD       = A2.VSL_CD 
					AND A1.SKD_VOY_NO   = A2.SKD_VOY_NO 
					AND A1.DIR_CD       = A2.SKD_DIR_CD 
					AND A1.TRD_CD       = A2.TRD_CD 
					AND A1.RLANE_CD     = A2.RLANE_CD 
					AND A1.IOC_CD       = A2.IOC_CD 
	
					AND A1.RLANE_CD = L1.RLANE_CD
					AND A1.DIR_CD = L1.DIR_CD
					AND A1.TRD_CD = L1.TRD_CD
					AND A1.IOC_CD = L1.IOC_CD

					#if(${f_chkprd} =='M')
						AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
					#elseif (${f_chkprd} =='W')
						AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
					#end
					
					AND A2.STND_COST_CD NOT IN ('91401011')   /*, '65901021' STP REV, ABC OTH 제외 */
				#if(${f_init_cost} == 'Y')
					AND A2.STND_COST_CD  NOT IN 
                      (SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV','OF','VF') AND STND_COST_CD <> '54600000')
				#end
					AND A2.STND_COST_CD = A3.STND_COST_CD 
					AND A1.DELT_FLG     <> 'Y' 
	
					#if(${f_chkprd} =='M')
						AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] 
					#elseif (${f_chkprd} =='W')
						AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%' 
						AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]
					#end
					
					#if(${f_trd_cd} !='') 
						AND A1.TRD_CD    = @[f_trd_cd]  
					#end
					#if(${f_rlane_cd} !='') 
						AND A1.RLANE_CD  = @[f_rlane_cd]
					#end
					#if(${f_dir_cd} !='')   
						AND A1.DIR_CD    = @[f_dir_cd] 
					#end
					#if(${f_vsl_cd} !='') 
						AND A1.VSL_CD    = @[f_vsl_cd] 
					#end
					#if(${f_skd_voy_no} !='')  
						AND A1.SKD_VOY_NO    = @[f_skd_voy_no] 
					#end
					#if(${f_skd_dir_cd} !='') 
						AND A1.DIR_CD     = @[f_skd_dir_cd] 
				    #end
			        #if(${f_sub_trd_cd} !='') 
				        AND A1.SUB_TRD_CD = @[f_sub_trd_cd] 
		            #end               
					#if(${f_ias_rgn_cd} !='') 
						AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] 
					#end
					#if(${f_trd_dir_cd} !='') 
						AND L1.HUL_BND_CD = @[f_trd_dir_cd] 
					#end 					
						
					AND A3.RPT_VW_CD     = @[f_pro_vw]  
					AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD	
	
					#if(${f_ofc_cd} !='')
						#if(${f_excl_sts} =='')
							/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAA', 'SINWA', '')*/
							AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  
						#else
							AND A4.OFC_CD        = @[f_ofc_cd]  
						#end
					#else
						/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAA', 'SINWA', '')*/
						AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL  
						
						AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD
						                                 ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCNA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
						                                                                         , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCNA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
						                                                                         , DECODE(A4.OFC_N4TH_LVL_CD, 'SHADSC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */
						                                 ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  
					#end
					
					#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
						AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */
							OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
					#else
						AND A3.STND_COST_TP_CD IN ('S','C','O') 
					#end	
		                                       
				GROUP BY a1.trd_cd, L1.HUL_BND_CD
				UNION ALL 
#if(${f_init_cost} == 'Y')
				SELECT   /*+ ORDERED */  
					 A1.TRD_CD 
					,L1.HUL_BND_CD 
					,0 AS VOYAGE 
					,NVL(SUM(DECODE(A3.STND_COST_CD,'BSA00000', DECODE (@[f_pro_vw],'P', A2.N4TH_ESTM_PL_AMT,'R', A2.RA_PL_AMT),0)),0) AS SUPPLY 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'LOAD0000', DECODE (@[f_pro_vw] 
					                                     ,'P', DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1),'2', A2.N4TH_ESTM_PL_AMT, '3', A2.N4TH_ESTM_PL_AMT, A2.N4TH_ESTM_PL_AMT * 2) 
					                                     ,'R', DECODE(SUBSTR(A2.CNTR_TPSZ_CD,-1),'2', A2.RA_PL_AMT, '3', A2.RA_PL_AMT, A2.RA_PL_AMT * 2) 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS LOAD_TEU 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'41101011', DECODE (@[f_pro_vw] 
					                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT, A2.N4TH_ESTM_PL_AMT) 
					                                     ,'R', A2.RA_PL_AMT 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS REVENUE 
					,NVL(SUM(CASE 
					           WHEN A3.STND_COST_CD IN ('43102011', '43201011', '43207011') THEN 
					           			DECODE (@[f_pro_vw] 
                                           ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT, A2.N4TH_ESTM_PL_AMT) 
                                           ,'R', A2.RA_PL_AMT 
                                           ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS OTHER_INCOME 
					,NVL(SUM(CASE 
					           WHEN A3.STND_COST_CD IN ('43102011') THEN 
					           		DECODE (@[f_pro_vw]
                                           ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
                                           ,'R', A2.RA_PL_AMT 
                                           ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS SPC_CHTR 
					,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
					                 ,'S', DECODE (@[f_pro_vw]
					                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT, A2.N4TH_ESTM_PL_AMT) 
					                              ,'R', A2.RA_PL_AMT 
					                              ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS INCOME_TOTAL 
					,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
					                 ,'C', DECODE (A3.STND_COST_CD 
					                              ,'BSA00000', 0 /* 공급량 */
					                              ,'LOAD0000', 0 /* 수송량 */
					                              ,'91401011', 0 /* STP Revenue */ 
					                              ,'92404011', 0 /* STP Cost  65901021 */ 
					                              ,DECODE (@[f_pro_vw]
					                                      ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                                      ,'R', A2.RA_PL_AMT 
					                                      ) 
					                              ) 
					                 ) 
					         ) 
					    ,0 
					    ) AS CM_COST 
					,NVL(SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('65901011') THEN 
					           		DECODE (@[f_pro_vw]
                                           ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
                                           ,'R', A2.RA_PL_AMT 
                                           ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS ABC_OWN 
					,NVL 
					   (SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('92404011') THEN 
					           		DECODE (@[f_pro_vw]
                                           ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
                                           ,'R', A2.RA_PL_AMT 
                                           ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS STP_COST 
					,NVL 
					   (SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('65901021') THEN 
					           		DECODE (@[f_pro_vw]
                                           ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
                                           ,'R', A2.RA_PL_AMT 
                                           ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS ABC_OTH 
					,0 AS STP_REV 
					,0 AS ABC_OTH_COND 
				-- Initial Network Cost Display 일경우 OP Cost Total 에 T/S cost Amount 를 더한다.
					,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
					                 ,'O', DECODE (@[f_pro_vw]
					                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,V.NTWK_HIR_COST_AMT) 
					                              ,'R', A2.RA_PL_AMT 
					                              ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) + SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF', 'VF') AND STND_COST_CD <> '54600000') 
                               THEN A2.N4TH_ASGN_AMT ELSE 0 END) AS OP_COST 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'TSCTRB00', DECODE (@[f_pro_vw]
					                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                                     ,'R', A2.RA_PL_AMT 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS TS_COST 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'CMMT0000', DECODE (@[f_pro_vw]
					                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                                     ,'R', A2.RA_PL_AMT 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS CMMT_COST 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'HJSAMT00', DECODE (@[f_pro_vw]
					                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                                     ,'R', A2.RA_PL_AMT 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS N4TH_ESTM_PL_AMT 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'CHTOUT00', DECODE (@[f_pro_vw]
					                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                                     ,'R', A2.RA_PL_AMT 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS N4TH_CO_AMT 
					,NVL (SUM (DECODE (A3.STND_COST_CD 
					                 ,'INTTRDTS', DECODE (@[f_pro_vw]
					                                     ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
					                                     ,'R', A2.RA_PL_AMT 
					                                     ) 
					                 ,0 
					                 ) 
					         ) 
					    ,0 
					    ) AS INTER_TS 
					,NVL 
					   (SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('92202013','92202014') THEN 
					           		DECODE (@[f_pro_vw]
                                           ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
                                           ,'R', A2.RA_PL_AMT 
                                           ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS EQ_COST 
					,NVL 
					   (SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('43201011') THEN 
					           		DECODE (@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_ESTM_PL_AMT,A2.N4TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS DEM_DET 
					   ,NVL (SUM (DECODE (A3.STND_COST_TP_CD 
				                 ,'O', DECODE (@[f_pro_vw]
				                              ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N6TH_CO_AMT,'O|BIZ', A2.N6TH_HJS_SLS_AMT,A2.N6TH_ESTM_PL_AMT) 
				                              ,'R', A2.RA_PL_AMT 
				                              ) 
				                 ,0 
				                 ) 
				         ) 
				    ,0 
				    ) AS OP_COST01 
                    -- Initial Network Cost(SML Sales/Slot Cht-out->All Network Cost by VVD->Total)
                    , SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF', 'VF') AND STND_COST_CD <> '54600000') 
                               THEN NVL(A2.N4TH_HJS_SLS_AMT,0) + NVL(A2.N4TH_CO_AMT,0) - NVL(A2.N4TH_ASGN_AMT,0) ELSE 0 END) INIT_COST
                    -- T/S Cost Amount
                    , SUM(CASE WHEN A3.STND_COST_CD IN ( SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV', 'OF' 'VF') AND STND_COST_CD <> '54600000') 
                               THEN A2.N4TH_ASGN_AMT ELSE 0 END) TS_ALOC
					,0 AS GEN_EXPN
					, NVL 
					   (SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('72100000') THEN 
					           		DECODE (@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.N4TH_CO_AMT,'O|BIZ', A2.N4TH_HJS_SLS_AMT,A2.N4TH_ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS VSL_INT
					,NVL 
					   (SUM 
					       (CASE 
					           WHEN A3.STND_COST_CD IN ('43207011') THEN 
					           		DECODE (@[f_pro_vw]
	                                       ,'P', DECODE(@[f_pro_lvl]||'|'||@[f_chtbiz],'O|CHT', A2.CO_AMT,'O|BIZ', A2.HJS_SLS_AMT,A2.ESTM_PL_AMT) 
	                                       ,'R', A2.RA_PL_AMT 
	                                       ) 
					           ELSE 0 
					        END 
					       ) 
					   ,0 
					   ) AS MISC 
				FROM MAS_MON_VVD A1 
					,MAS_PFIT_LSS_SMRY A2 
					,MAS_PFIT_LSS_RPT_ITM A3 
					,MAS_OFC_LVL A4 
					, MAS_LANE_RGST L1
					,MAS_VVD_HIR V
				WHERE A1.VSL_CD       = A2.VSL_CD 
					AND A1.SKD_VOY_NO   = A2.SKD_VOY_NO 
					AND A1.DIR_CD       = A2.SKD_DIR_CD 
					AND A1.TRD_CD       = A2.TRD_CD 
					AND A1.RLANE_CD     = A2.RLANE_CD 
					AND A1.IOC_CD       = A2.IOC_CD 
	
					AND A1.RLANE_CD = L1.RLANE_CD
					AND A1.DIR_CD = L1.DIR_CD
					AND A1.TRD_CD = L1.TRD_CD
					AND A1.IOC_CD = L1.IOC_CD

					#if(${f_chkprd} =='M')
						AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
					#elseif (${f_chkprd} =='W')
						AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
					#end
					
					AND A2.STND_COST_CD NOT IN ('91401011')   /*, '65901021' STP REV, ABC OTH 제외 */
				#if(${f_init_cost} == 'Y')
					AND A2.STND_COST_CD  IN 
                      (SELECT STND_COST_CD FROM MAS_STND_ACCT WHERE MGRP_COST_CD IN ('OV','OF','VF') AND STND_COST_CD <> '54600000')
				#end
					AND A2.STND_COST_CD = A3.STND_COST_CD 
				AND V.VSL_CD        = A2.VSL_CD 
				AND V.SKD_VOY_NO    = A2.SKD_VOY_NO 
				AND V.DIR_CD        = A2.SKD_DIR_CD 
				AND V.TRD_CD        = A2.TRD_CD 
				AND V.RLANE_CD      = A2.RLANE_CD 
				AND V.IOC_CD        = A2.IOC_CD 
				AND V.STND_COST_CD  = A2.STND_COST_CD
					AND A1.DELT_FLG     <> 'Y' 
	
					#if(${f_chkprd} =='M')
						AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] 
					#elseif (${f_chkprd} =='W')
						AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%' 
						AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]
					#end
					
					#if(${f_trd_cd} !='') 
						AND A1.TRD_CD    = @[f_trd_cd]  
					#end
					#if(${f_rlane_cd} !='') 
						AND A1.RLANE_CD  = @[f_rlane_cd]
					#end
					#if(${f_dir_cd} !='')   
						AND A1.DIR_CD    = @[f_dir_cd] 
					#end
					#if(${f_vsl_cd} !='') 
						AND A1.VSL_CD    = @[f_vsl_cd] 
					#end
					#if(${f_skd_voy_no} !='')  
						AND A1.SKD_VOY_NO    = @[f_skd_voy_no] 
					#end
					#if(${f_skd_dir_cd} !='') 
						AND A1.DIR_CD     = @[f_skd_dir_cd] 
				    #end
			        #if(${f_sub_trd_cd} !='') 
				        AND A1.SUB_TRD_CD = @[f_sub_trd_cd] 
		            #end               
					#if(${f_ias_rgn_cd} !='') 
						AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] 
					#end
					#if(${f_trd_dir_cd} !='') 
						AND L1.HUL_BND_CD = @[f_trd_dir_cd] 
					#end 					
						
					AND A3.RPT_VW_CD     = @[f_pro_vw]  
					AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD	
	
					#if(${f_ofc_cd} !='')
						#if(${f_excl_sts} =='')
							/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAA', 'SINWA', '')*/
							AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  
						#else
							AND A4.OFC_CD        = @[f_ofc_cd]  
						#end
					#else
						/*N200902110080   MAS_SINWA 실적 조회 권한 관련 DECODE(SUBSTR(?, 1, 4), 'SHAA', 'SINWA', '')*/
						AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL  
						
						AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD
						                                 ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCNA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
						                                                                         , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCNA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
						                                                                         , DECODE(A4.OFC_N4TH_LVL_CD, 'SHADSC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */
						                                 ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  
					#end
					
					#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
						AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */
							OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
					#else
						AND A3.STND_COST_TP_CD IN ('S','C','O') 
					#end	
		                                       
				GROUP BY a1.trd_cd, L1.HUL_BND_CD
				UNION ALL 
#end

					/* General Expense */
				   SELECT A1.TRD_CD 
						, L1.HUL_BND_CD 
						, 0 AS VOYAGE 
						, 0 AS SUPPLY 
						, 0 AS LOAD_TEU 
						, 0 AS REVENUE 
						, 0 AS OTHER_INCOME 
						, 0 AS SPC_CHTR 
						, 0 AS INCOME_TOTAL 
						, 0 AS CM_COST 
						, 0 AS ABC_OWN 
						, 0 AS STP_COST 
						, 0 AS ABC_OTH 
						, 0 AS STP_REV 
						, 0 AS ABC_OTH_COND 
						, 0 AS OP_COST 
						, 0 AS TS_COST 
						, 0 AS CMMT_COST 
						, 0 AS HJS_SLS_AMT 
						, 0 AS CO_AMT 
						, 0 AS INTER_TS 
						, 0 AS EQ_COST 
						, 0 AS DEM_DET 
						, 0 AS OP_COST01 
						, 0 AS INIT_COST
						, 0 AS TS_ALOC
						, SUM(DECODE(A3.STND_COST_CD, '65010001', DECODE (@[f_pro_vw], 'P', A2.ESTM_PL_AMT, 'R', A2.RA_PL_AMT), 0)) AS GEN_EXPN
					, 0 AS VSL_INT
					, 0 AS MISC
					 FROM MAS_MON_VVD A1 
						, MAS_PFIT_LSS_GEN_EXPN A2 
						, MAS_PFIT_LSS_RPT_ITM A3 
						, MAS_OFC_LVL A4 
						, MAS_LANE_RGST L1
					WHERE A1.VSL_CD        = A2.VSL_CD 
					  AND A1.SKD_VOY_NO    = A2.SKD_VOY_NO 
					  AND A1.DIR_CD        = A2.SKD_DIR_CD 
					  AND A1.TRD_CD        = A2.TRD_CD 
					  AND A1.RLANE_CD      = A2.RLANE_CD 
					  AND A1.IOC_CD        = A2.IOC_CD 
			
					  AND A1.RLANE_CD      = L1.RLANE_CD
					  AND A1.DIR_CD        = L1.DIR_CD
					  AND A1.TRD_CD        = L1.TRD_CD
					  AND A1.IOC_CD        = L1.IOC_CD

					#if(${f_chkprd} =='M')
					  AND A1.COST_YRMON    BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
					#elseif (${f_chkprd} =='W')
					  AND A1.SLS_YRMON     BETWEEN A4.OFC_APLY_FM_YRMON AND A4.OFC_APLY_TO_YRMON
					#end /*ofc_월별 관리*/
							
					  AND A2.STND_COST_CD  = '65010001' 
					  AND A2.STND_COST_CD  = A3.STND_COST_CD 
					  AND A1.DELT_FLG      <> 'Y' 
					  AND A2.OFC_VW_CD     = @[f_ofc_vw] /* Office view code 별로 expense 관리 */
			
					#if(${f_chkprd} =='M')
					  AND A1.COST_YRMON    BETWEEN @[f_year]||@[f_fm_mon] AND @[f_year]||@[f_to_mon] 
					#elseif (${f_chkprd} =='W')
					  AND A1.SLS_YRMON     LIKE @[f_year]||@[f_sls_mon]||'%'  
					  AND A1.COST_WK       BETWEEN @[f_fm_wk] AND @[f_to_wk]
					#end
							
					#if(${f_trd_cd} !='') 
					  AND A1.TRD_CD    = @[f_trd_cd]  
					#end
					#if(${f_rlane_cd} !='') 
					  AND A1.RLANE_CD  = @[f_rlane_cd]
					#end
					#if(${f_dir_cd} !='')   
					  AND A1.DIR_CD    = @[f_dir_cd] 
					#end
					#if(${f_vsl_cd} !='') 
					  AND A1.VSL_CD    = @[f_vsl_cd] 
					#end
					#if(${f_skd_voy_no} !='')  
					  AND A1.SKD_VOY_NO    = @[f_skd_voy_no] 
					#end
					#if(${f_skd_dir_cd} !='') 
					  AND A1.DIR_CD     = @[f_skd_dir_cd] 
					#end 
					#if(${f_sub_trd_cd} !='') 
					  AND A1.SUB_TRD_CD = @[f_sub_trd_cd] 
					#end           
					#if(${f_ias_rgn_cd} !='') 
					  AND L1.IAS_RGN_CD = @[f_ias_rgn_cd] 
					#end
					#if(${f_trd_dir_cd} !='') 
					  AND L1.HUL_BND_CD = @[f_trd_dir_cd] 
					#end		
													
					  AND A3.RPT_VW_CD     = @[f_pro_vw]  
					  AND DECODE (@[f_ofc_vw], 'C', A2.AGMT_SGN_OFC_CD, 'L', A2.SLS_OFC_CD) = A4.OFC_CD  
			
					#if(${f_ofc_cd} !='')
						#if(${f_excl_sts} =='')
					  AND DECODE (@[f_ofc_lvl] ,'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) = @[f_ofc_cd]  
						#else
					  AND A4.OFC_CD  = @[f_ofc_cd]  
						#end
					#else
							
					  AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_CD,'3', A4.OFC_N3RD_LVL_CD,'4', A4.OFC_N4TH_LVL_CD,'5', A4.OFC_N5TH_LVL_CD,'6', A4.OFC_N6TH_LVL_CD,'7', A4.OFC_N7TH_LVL_CD) IS NOT NULL 
					  AND DECODE (@[f_ofc_lvl],'1', A4.OFC_N1ST_LVL_CD,'2', A4.OFC_N2ND_LVL_TP_CD,'3', A4.OFC_N3RD_LVL_TP_CD
									      ,'4', DECODE(SUBSTR(DECODE(@[f_chkprd], 'M', A1.COST_YRMON, A1.SLS_YRMON), 1, 4), '2008', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCNA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
											   , '2007', DECODE(A4.OFC_N4TH_LVL_CD, 'NYCNA', A4.OFC_N4TH_LVL_CD, A4.OFC_N4TH_LVL_TP_CD)
											   , DECODE(A4.OFC_N4TH_LVL_CD, 'SHADSC', A4.OFC_N4TH_LVL_TP_CD, A4.OFC_N4TH_LVL_CD)) /* SHADSC만 AREA */
									      ,'5', A4.OFC_N5TH_LVL_TP_CD,'6', A4.OFC_N6TH_LVL_TP_CD,'7', A4.OFC_N7TH_LVL_TP_CD) IS NOT NULL  
					#end
			
					#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
					  AND (A3.STND_COST_TP_CD IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */
							OR A3.STND_COST_CD IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
					#else
					  AND A3.STND_COST_TP_CD IN ('S','C','O')  
					#end	                
							       
					GROUP BY A1.TRD_CD, L1.HUL_BND_CD 
					) 
				GROUP BY TRD_CD, HUL_BND_CD
				) B1 
				, (SELECT CPY_NO AS RNUM 
					FROM COM_CPY_NO 
					WHERE CPY_NO BETWEEN 1 AND 36 
				) B2 
			) C1 
			, (
				SELECT A1.TRD_CD 
					,A2.SGRP_COST_CD 
					,A2.STND_COST_CD 
					,A2.RPT_VW_CD 
					,A1.HUL_BND_CD 
					,DECODE (@[f_iskorean], '1', A2.SGRP_KR_DESC, A2.SGRP_COST_CD_DESC) SGRP_COST_CD_DESC   /*조건:한글여부 //f_isKorean */
					,DECODE (@[f_iskorean], '1', A2.KR_RPT_ITM_DESC, A2.RPT_ITM_DESC) RPT_ITM_DESC 
					,A2.RPT_DP_SEQ 
					,A2.RPT_ITM_COLR_FLG 
				FROM ( 
					SELECT DISTINCT TRD_CD 
						,HUL_BND_CD 
					FROM MAS_LANE_RGST 
					WHERE DELT_FLG = 'N'
					) A1 
					,MAS_PFIT_LSS_RPT_ITM A2 
				WHERE A2.RPT_VW_CD       = @[f_pro_vw] 
		
				#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')
					AND (a2.stnd_cost_tp_cd IN ('S','C','O',@[str_display])  /* f_pro_obj P->O,A,B */
						OR a2.stnd_cost_cd IN ('OPCTOTAL','OPB00000','BOPTOTAL','BOPB0000')) 
				#else
					#if( ${f_pro_lvl} =='C')
						AND A2.STND_COST_TP_CD IN ('S','C') 
					#elseif (${f_pro_lvl} =='O')
						AND A2.STND_COST_TP_CD IN ('S','C','O') 
					#end
				#end	

			) C2 
		WHERE C1.STND_COST_CD(+) = C2.STND_COST_CD 
			AND C1.TRD_CD(+)       = C2.TRD_CD 
			AND C1.HUL_BND_CD(+)       = C2.HUL_BND_CD
		GROUP BY C2.RPT_DP_SEQ
			,C2.SGRP_COST_CD
			,C2.STND_COST_CD
			,C2.SGRP_COST_CD_DESC
			,C2.RPT_ITM_DESC 
			,C2.RPT_ITM_COLR_FLG 
		ORDER BY SEQ 
	) D1 
WHERE 1=1
	#if(${f_pro_vw} =='P' && ${f_pro_lvl} =='O')  /* Trade Profit + OP */
		#if(${f_op_view} =='OP5' || ${f_op_view} =='OP6')
			AND STND_COST_CD != 'OPCOST02'
		#end
	#end
GROUP BY GROUPING SETS ((SGRP_COST_CD_DESC), (STND_COST_CD, SGRP_COST_CD_DESC, RPT_ITM_DESC, RPT_ITM_COLR_FLG)) 
ORDER BY SEQ, LV			]]></sql>
			<params>
				<param name="f_op_view" type="12" value="" out="N"/>
				<param name="f_pro_vw" type="12" value="" out="N"/>
				<param name="f_pro_lvl" type="12" value="" out="N"/>
				<param name="f_chtbiz" type="12" value="" out="N"/>
				<param name="f_ofc_vw" type="12" value="" out="N"/>
				<param name="f_ofc_lvl" type="12" value="" out="N"/>
				<param name="f_year" type="12" value="" out="N"/>
				<param name="f_fm_mon" type="12" value="" out="N"/>
				<param name="f_to_mon" type="12" value="" out="N"/>
				<param name="f_sls_mon" type="12" value="" out="N"/>
				<param name="f_fm_wk" type="12" value="" out="N"/>
				<param name="f_to_wk" type="12" value="" out="N"/>
				<param name="f_trd_cd" type="12" value="" out="N"/>
				<param name="f_rlane_cd" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_vsl_cd" type="12" value="" out="N"/>
				<param name="f_skd_voy_no" type="12" value="" out="N"/>
				<param name="f_skd_dir_cd" type="12" value="" out="N"/>
				<param name="f_sub_trd_cd" type="12" value="" out="N"/>
				<param name="f_ias_rgn_cd" type="12" value="" out="N"/>
				<param name="f_trd_dir_cd" type="12" value="" out="N"/>
				<param name="f_ofc_cd" type="12" value="" out="N"/>
				<param name="f_chkprd" type="12" value="" out="N"/>
				<param name="str_display" type="12" value="" out="N"/>
				<param name="f_iskorean" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
