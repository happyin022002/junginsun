/*=========================================================
*Copyright(c) 2017 CyberLogitec
*@FileName : StatusReportDBDAOSearchCustVipReport1RSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2017.01.24
*@LastModifier : 
*@LastVersion : 1.0
* 2017.01.24 
* 1.0 Creation
=========================================================*/
package com.hanjin.apps.alps.esm.bkg.bookingreport.statusreport.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.hanjin.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class StatusReportDBDAOSearchCustVipReport1RSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * StatusReportDBDAOSearchCustVipReport1RSQL
	  * 2010.09.10 김영철 [ ] VIP REPORT 부분 오류 수정 ( 반영일 : 2010.09.24 )
	  * 2010.09.29 김영철 [ ] VIP REPORT 부분 SQL문 오류인하여 수정함.
	  * 2011.06.16 변종건 [CHM-201111601-01] VIP Report -조회조건추가 (RFA#컬럼 )
	  * 2011.06.23 변종건 [CHM-201111602-01] VIP Report - Group Customer 기준 변경 (Contract Customer)
	  * 2013.02.06 김진주 [CHM-201322646] VIP Report Item 추가 요청 - Discharging at TS Port
	  * 2013.03.13 임재관 [CHM-201323518] VIP Report 보완 - Final destination name 로직 추가, Partial 선적의 Pick up yard 누락 보완
	  * </pre>
	  */
	public StatusReportDBDAOSearchCustVipReport1RSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("scac_flg",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vps_eta_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("taa_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("agmt_act_cnt_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_seq",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pol_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("init_dt_fm",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sp_cargo_rf",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("init_dt_to",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_nm",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pol_yard_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sp_cargo_dg",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sp_cargo_bb",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("in_out_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("agmt_act_cust_seq",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("edi_id",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("curr_page",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_cnt_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("gcust",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rows_per_page",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("del_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("por_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sp_cargo_ak",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("eq_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vps_etd_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sc_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pod_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pod_yard_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rfa_no",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.hanjin.apps.alps.esm.bkg.bookingreport.statusreport.integration").append("\n"); 
		query.append("FileName : StatusReportDBDAOSearchCustVipReport1RSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT YY.*" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT XX.*, COUNT(ROWNUM) OVER() TOTAL_CNT, " ).append("\n"); 
		query.append("ROWNUM RNUM" ).append("\n"); 
		query.append("FROM ( " ).append("\n"); 
		query.append("SELECT DISTINCT ${select_list}" ).append("\n"); 
		query.append("--     , COUNT(BKG_NO) OVER() TOTAL_CNT " ).append("\n"); 
		query.append("FROM ( " ).append("\n"); 
		query.append("   SELECT " ).append("\n"); 
		query.append("           (SELECT ACT_NM FROM MDM_ACTIVITY WHERE ACT_CD = Y2.STS_CD) STS_NM" ).append("\n"); 
		query.append("          ,(SELECT YD_NM FROM MDM_YARD WHERE YD_CD = Y2.EVNT_PLC_CD) EVNT_PLC" ).append("\n"); 
		query.append("		  ,BKG_GET_TOKEN_FNC( Y2.PRE_VVD_N_NM,1) AS PRE_VVD" ).append("\n"); 
		query.append("		  ,BKG_GET_TOKEN_FNC( Y2.PRE_VVD_N_NM,2) AS PRE_VVD_NM" ).append("\n"); 
		query.append("		  ,BKG_GET_TOKEN_FNC( Y2.POST_VVD_N_NM,1) AS POST_VVD" ).append("\n"); 
		query.append("		  ,BKG_GET_TOKEN_FNC( Y2.POST_VVD_N_NM,2) AS POST_VVD_NM" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("          ,BKG_GET_TOKEN_FNC( Y2.NIST_POL_ETA_ETD_DT2,1) AS POL1_ETA_DT" ).append("\n"); 
		query.append("          ,BKG_GET_TOKEN_FNC( Y2.NIST_POL_ETA_ETD_DT2,2) AS POL1_ETD_DT" ).append("\n"); 
		query.append("          ,BKG_GET_TOKEN_FNC( Y2.NIST_POD_ETA_ETD_DT2,1) AS POD1_ETA_DT" ).append("\n"); 
		query.append("          ,BKG_GET_TOKEN_FNC( Y2.NIST_POD_ETA_ETD_DT2,2) AS POD1_ETD_DT" ).append("\n"); 
		query.append("          ,(SELECT CUST_REF_NO_CTNT" ).append("\n"); 
		query.append("              FROM BKG_REFERENCE" ).append("\n"); 
		query.append("             WHERE BKG_NO = Y2.BKG_NO" ).append("\n"); 
		query.append("               AND BKG_REF_TP_CD ='HPDP'" ).append("\n"); 
		query.append("               AND ROWNUM =1" ).append("\n"); 
		query.append("           ) AS DEPT_NO" ).append("\n"); 
		query.append("          ,(SELECT CUST_ADDR" ).append("\n"); 
		query.append("              FROM BKG_CUSTOMER" ).append("\n"); 
		query.append("             WHERE BKG_NO = Y2.BKG_NO" ).append("\n"); 
		query.append("               AND BKG_CUST_TP_CD ='N'" ).append("\n"); 
		query.append("            ) AS NTFY_ADDR" ).append("\n"); 
		query.append("          ,(SELECT  DEST_TRNS_SVC_MOD_CD " ).append("\n"); 
		query.append("              FROM    BKG_BOOKING BK" ).append("\n"); 
		query.append("             WHERE   BK.BKG_NO = Y2.BKG_NO" ).append("\n"); 
		query.append("            ) AS  DEST_SVC_MOD_CD " ).append("\n"); 
		query.append("          ,(SELECT CUST_REF_NO_CTNT" ).append("\n"); 
		query.append("		      FROM BKG_REFERENCE" ).append("\n"); 
		query.append("             WHERE BKG_NO = Y2.BKG_NO" ).append("\n"); 
		query.append("               AND BKG_REF_TP_CD = 'FINV'" ).append("\n"); 
		query.append("               AND ROWNUM =1 " ).append("\n"); 
		query.append("           ) AS CUST_INV_NO" ).append("\n"); 
		query.append("          ,(SELECT CUST_REF_NO_CTNT     " ).append("\n"); 
		query.append("		      FROM BKG_REFERENCE" ).append("\n"); 
		query.append("             WHERE BKG_NO = Y2.BKG_NO" ).append("\n"); 
		query.append("               AND BKG_REF_TP_CD = 'EBRF'" ).append("\n"); 
		query.append("               AND ROWNUM =1" ).append("\n"); 
		query.append("           ) AS CUST_BKG_REF_NO" ).append("\n"); 
		query.append("          ,(SELECT CUST_REF_NO_CTNT" ).append("\n"); 
		query.append("		      FROM BKG_REFERENCE" ).append("\n"); 
		query.append("             WHERE BKG_NO = Y2.BKG_NO" ).append("\n"); 
		query.append("               AND BKG_REF_TP_CD = 'ESRF'" ).append("\n"); 
		query.append("               AND ROWNUM =1" ).append("\n"); 
		query.append("           ) AS CUST_SI_REF_NO           " ).append("\n"); 
		query.append("          ,(SELECT TO_CHAR(SUBSTR(CMDT_DESC, 1, 200)) FROM BKG_BL_MK_DESC MD WHERE MD.BKG_NO=Y2.BKG_NO AND MK_SEQ=1) AS MK_DESC" ).append("\n"); 
		query.append("          ,'' AS DEL_FT_DT" ).append("\n"); 
		query.append("          ,Y2.*" ).append("\n"); 
		query.append("     FROM (" ).append("\n"); 
		query.append("     SELECT " ).append("\n"); 
		query.append("             /* 2014.12.08 1.Event Date-Time 2.Status 3.Event Place 4.Days since last movement 추가 요청 김미선 부장 */" ).append("\n"); 
		query.append("             BKG_GET_TOKEN_FNC(COP_COLS,2) AS EVNT_DT_TM" ).append("\n"); 
		query.append("            ,BKG_GET_TOKEN_FNC(COP_COLS,3) AS STS_CD" ).append("\n"); 
		query.append("            ,BKG_GET_TOKEN_FNC(COP_COLS,4) AS EVNT_PLC_CD" ).append("\n"); 
		query.append("            ,TRUNC(SYSDATE) - TRUNC(TO_DATE(BKG_GET_TOKEN_FNC(COP_COLS,2),'YYYY-MM-DD HH24:MI')) AS DYS_LST_MVMT " ).append("\n"); 
		query.append("            ,(SELECT TO_CHAR(VPS_ETA_DT,'YYYY-MM-DD')||','||TO_CHAR(VPS_ETD_DT,'YYYY-MM-DD')" ).append("\n"); 
		query.append("               FROM VSK_VSL_PORT_SKD POL" ).append("\n"); 
		query.append("              WHERE 1=1" ).append("\n"); 
		query.append("                AND POL.VSL_CD       = BKG_GET_TOKEN_FNC(Y1.NIST_POL_ETA_ETD_DT1,1)" ).append("\n"); 
		query.append("                AND POL.SKD_VOY_NO   = BKG_GET_TOKEN_FNC(Y1.NIST_POL_ETA_ETD_DT1,2)" ).append("\n"); 
		query.append("                AND POL.SKD_DIR_CD   = BKG_GET_TOKEN_FNC(Y1.NIST_POL_ETA_ETD_DT1,3)" ).append("\n"); 
		query.append("                AND POL.VPS_PORT_CD  = BKG_GET_TOKEN_FNC(Y1.NIST_POL_ETA_ETD_DT1,4)" ).append("\n"); 
		query.append("                AND POL.CLPT_IND_SEQ = BKG_GET_TOKEN_FNC(Y1.NIST_POL_ETA_ETD_DT1,5)  " ).append("\n"); 
		query.append("             ) AS NIST_POL_ETA_ETD_DT2" ).append("\n"); 
		query.append("            ,(SELECT TO_CHAR(VPS_ETA_DT,'YYYY-MM-DD')||','||TO_CHAR(VPS_ETD_DT,'YYYY-MM-DD')" ).append("\n"); 
		query.append("                FROM VSK_VSL_PORT_SKD POD" ).append("\n"); 
		query.append("               WHERE 1=1" ).append("\n"); 
		query.append("                 AND POD.VSL_CD       = BKG_GET_TOKEN_FNC(Y1.NIST_POD_ETA_ETD_DT1,1)" ).append("\n"); 
		query.append("                 AND POD.SKD_VOY_NO   = BKG_GET_TOKEN_FNC(Y1.NIST_POD_ETA_ETD_DT1,2)" ).append("\n"); 
		query.append("                 AND POD.SKD_DIR_CD   = BKG_GET_TOKEN_FNC(Y1.NIST_POD_ETA_ETD_DT1,3)" ).append("\n"); 
		query.append("                 AND POD.VPS_PORT_CD  = BKG_GET_TOKEN_FNC(Y1.NIST_POD_ETA_ETD_DT1,4)" ).append("\n"); 
		query.append("                 AND POD.CLPT_IND_SEQ = BKG_GET_TOKEN_FNC(Y1.NIST_POD_ETA_ETD_DT1,5)  " ).append("\n"); 
		query.append("             ) AS NIST_POD_ETA_ETD_DT2" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("            ,DECODE(IN_OUT_CD, 'OUT'  ,TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'YYYYMMDD')" ).append("\n"); 
		query.append("                                        - (  TO_DATE(SUBSTR(Y1.F_POL_ETAETD,9,8),'YYYYMMDD') " ).append("\n"); 
		query.append("                                           + DECODE(NVL(Y1.OB_CUST_CRTERM, 0),0, Y1.OB_OFC_CRTERM, Y1.OB_CUST_CRTERM ))" ).append("\n"); 
		query.append("                                      ,TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'YYYYMMDD')" ).append("\n"); 
		query.append("                                         - (  TO_DATE(SUBSTR(Y1.L_POD_ETAETD,1,8),'YYYYMMDD')  " ).append("\n"); 
		query.append("                                            + DECODE(NVL(Y1.IB_CUST_CRTERM, 0),0, Y1.IB_OFC_CRTERM, Y1.IB_CUST_CRTERM ))" ).append("\n"); 
		query.append("                     ) AS OVERDUE" ).append("\n"); 
		query.append("                                                 " ).append("\n"); 
		query.append("            ,DECODE(IN_OUT_CD, 'OUT', TO_CHAR(TO_DATE(SUBSTR(Y1.F_POL_ETAETD,9,8),'YYYYMMDD')  " ).append("\n"); 
		query.append("                                               + DECODE(NVL(Y1.OB_CUST_CRTERM, 0),0, Y1.OB_OFC_CRTERM, Y1.OB_CUST_CRTERM ),'YYYYMMDD')" ).append("\n"); 
		query.append("                                        , TO_CHAR((TO_DATE(SUBSTR(Y1.L_POD_ETAETD,1,8),'YYYYMMDD')  " ).append("\n"); 
		query.append("                                                 + DECODE(NVL(Y1.IB_CUST_CRTERM, 0),0, Y1.IB_OFC_CRTERM ,Y1.IB_CUST_CRTERM)),'YYYYMMDD')" ).append("\n"); 
		query.append("                   ) AS DUE_DATE " ).append("\n"); 
		query.append("            ,Y1.*" ).append("\n"); 
		query.append("      FROM (" ).append("\n"); 
		query.append("            SELECT " ).append("\n"); 
		query.append("            --  ROWNUM RNUM" ).append("\n"); 
		query.append("            --, COUNT(BKG_NO) OVER() TOTAL_CNT " ).append("\n"); 
		query.append("            --, " ).append("\n"); 
		query.append("			 (SELECT VSL_ENG_NM FROM MDM_VSL_CNTR WHERE VSL_CD = Y.VSL_CD) AS TRUNK_VESSEL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("   		     /* 1st POL ETA,1st POL ETD */" ).append("\n"); 
		query.append("            ,(SELECT /*+ INDEX_ASC(V1 XPKBKG_VVD )*/" ).append("\n"); 
		query.append("                    V1.VSL_CD||','||V1.SKD_VOY_NO||','||V1.SKD_DIR_CD||','|| V1.POL_CD||','||V1.POl_CLPT_IND_SEQ" ).append("\n"); 
		query.append("               FROM BKG_VVD V1" ).append("\n"); 
		query.append("              WHERE V1.BKG_NO = Y.BKG_NO" ).append("\n"); 
		query.append("                AND ROWNUM =1 /* 첫 배를 가져옴*/" ).append("\n"); 
		query.append("             ) AS NIST_POL_ETA_ETD_DT1" ).append("\n"); 
		query.append("             ,(SELECT /*+ INDEX_ASC(V1 XPKBKG_VVD )*/" ).append("\n"); 
		query.append("                      V1.VSL_CD||','||V1.SKD_VOY_NO||','||V1.SKD_DIR_CD||','|| V1.POD_CD||','||V1.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                 FROM BKG_VVD V1" ).append("\n"); 
		query.append("                WHERE V1.BKG_NO = Y.BKG_NO" ).append("\n"); 
		query.append("                  AND ROWNUM =1 /* 첫 배를 가져옴*/" ).append("\n"); 
		query.append("               ) AS NIST_POD_ETA_ETD_DT1" ).append("\n"); 
		query.append("            , Y.*" ).append("\n"); 
		query.append("            ,(  SELECT " ).append("\n"); 
		query.append("                      MAX( LPAD(B.COP_DTL_SEQ,5,'0')||','||" ).append("\n"); 
		query.append("                           TO_CHAR(NVL(B.ACT_DT, B.ESTM_DT),'YYYY-MM-DD HH24:MI') ||','||" ).append("\n"); 
		query.append("                           B.ACT_CD ||','||" ).append("\n"); 
		query.append("                           B.NOD_CD" ).append("\n"); 
		query.append("                         ) AS COP_COLS" ).append("\n"); 
		query.append("                      FROM SCE_COP_HDR A" ).append("\n"); 
		query.append("                         , SCE_COP_DTL B" ).append("\n"); 
		query.append("                     WHERE 1 =1" ).append("\n"); 
		query.append("                       AND A.COP_STS_CD <> 'X'" ).append("\n"); 
		query.append("                       AND A.COP_NO = B.COP_NO" ).append("\n"); 
		query.append("                       AND B.ACT_DT IS NOT NULL           " ).append("\n"); 
		query.append("                       AND A.BKG_NO =  Y.BKG_NO" ).append("\n"); 
		query.append("                       AND A.CNTR_NO = Y.CNTR_NO" ).append("\n"); 
		query.append("            ) COP_COLS" ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CR2.IB_CR_TERM_DYS),0) " ).append("\n"); 
		query.append("            FROM MDM_CR_CUST CR2" ).append("\n"); 
		query.append("           WHERE CR2.CUST_CNT_CD = SUBSTR(Y.SHIPPER,1,2)" ).append("\n"); 
		query.append("             AND CR2.CUST_SEQ    =  SUBSTR(Y.SHIPPER,3,6) ) AS OB_CUST_CRTERM" ).append("\n"); 
		query.append("        ,(SELECT M2.IB_CR_TERM_DYS " ).append("\n"); 
		query.append("            FROM MDM_ORGANIZATION M1, MDM_ORGANIZATION M2" ).append("\n"); 
		query.append("           WHERE M1.OFC_CD = Y.PPD_OFC" ).append("\n"); 
		query.append("             AND M2.OFC_CD = M1.AR_OFC_CD                 )  AS OB_OFC_CRTERM" ).append("\n"); 
		query.append("             " ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CR.IB_CR_TERM_DYS),0) " ).append("\n"); 
		query.append("            FROM MDM_CR_CUST CR" ).append("\n"); 
		query.append("           WHERE CR.CUST_CNT_CD = SUBSTR(Y.CONSIGNEE,1,2)" ).append("\n"); 
		query.append("             AND CR.CUST_SEQ    = SUBSTR(Y.CONSIGNEE,3,6) )  AS IB_CUST_CRTERM  " ).append("\n"); 
		query.append("        ,(SELECT M2.IB_CR_TERM_DYS " ).append("\n"); 
		query.append("            FROM  MDM_ORGANIZATION M1, MDM_ORGANIZATION M2" ).append("\n"); 
		query.append("           WHERE  M1.OFC_CD  = Y.CCT_OFC" ).append("\n"); 
		query.append("             AND  M2.OFC_CD  = M1.AR_OFC_CD               )  AS IB_OFC_CRTERM             " ).append("\n"); 
		query.append("             " ).append("\n"); 
		query.append("                       " ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(V1.VPS_ETA_DT,'YYYYMMDD')||TO_CHAR(V1.VPS_ETD_DT,'YYYYMMDD') AS ETAETD" ).append("\n"); 
		query.append("              FROM   VSK_VSL_PORT_SKD V1" ).append("\n"); 
		query.append("              WHERE  V1.VSL_CD       = SUBSTR(Y.FST_VVD,1,4)" ).append("\n"); 
		query.append("              AND    V1.SKD_VOY_NO   = SUBSTR(Y.FST_VVD,5,4)" ).append("\n"); 
		query.append("              AND    V1.SKD_DIR_CD   = SUBSTR(Y.FST_VVD,9,1)" ).append("\n"); 
		query.append("              AND    V1.VPS_PORT_CD  = Y.POL_CD" ).append("\n"); 
		query.append("              AND    V1.CLPT_IND_SEQ = (SELECT MAX(V2.CLPT_IND_SEQ)" ).append("\n"); 
		query.append("                                        FROM   VSK_VSL_PORT_SKD V2" ).append("\n"); 
		query.append("                                        WHERE  V2.VSL_CD      = SUBSTR(Y.FST_VVD,1,4)" ).append("\n"); 
		query.append("                                        AND    V2.SKD_VOY_NO  = SUBSTR(Y.FST_VVD,5,4)" ).append("\n"); 
		query.append("                                        AND    V2.SKD_DIR_CD  = SUBSTR(Y.FST_VVD,9,1)" ).append("\n"); 
		query.append("                                        AND    V2.VPS_PORT_CD = Y.POL_CD)" ).append("\n"); 
		query.append("            ) AS F_POL_ETAETD " ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("            ,(SELECT TO_CHAR(V3.VPS_ETA_DT,'YYYYMMDD')||TO_CHAR(V3.VPS_ETD_DT,'YYYYMMDD') AS ETAETD " ).append("\n"); 
		query.append("              FROM VSK_VSL_PORT_SKD V3" ).append("\n"); 
		query.append("              WHERE   V3.VSL_CD = SUBSTR(Y.LST_VVD,1,4)" ).append("\n"); 
		query.append("              AND     V3.SKD_VOY_NO = SUBSTR(Y.LST_VVD,5,4)" ).append("\n"); 
		query.append("              AND     V3.SKD_DIR_CD = SUBSTR(Y.LST_VVD,9,1)" ).append("\n"); 
		query.append("              AND     V3.VPS_PORT_CD = Y.POD_CD" ).append("\n"); 
		query.append("              AND     V3.CLPT_IND_SEQ = (SELECT MAX(V4.CLPT_IND_SEQ)" ).append("\n"); 
		query.append("                                         FROM   VSK_VSL_PORT_SKD V4" ).append("\n"); 
		query.append("                                         WHERE  V4.VSL_CD     = SUBSTR(Y.LST_VVD,1,4)" ).append("\n"); 
		query.append("                                         AND    V4.SKD_VOY_NO = SUBSTR(Y.LST_VVD,5,4)" ).append("\n"); 
		query.append("                                         AND    V4.SKD_DIR_CD = SUBSTR(Y.LST_VVD,9,1)" ).append("\n"); 
		query.append("                                         AND    V4.VPS_PORT_CD =  Y.POD_CD)" ).append("\n"); 
		query.append("            ) AS L_POD_ETAETD" ).append("\n"); 
		query.append("            FROM (" ).append("\n"); 
		query.append("                    SELECT " ).append("\n"); 
		query.append("				 	X.BKG_NO," ).append("\n"); 
		query.append("				    X.CNTR_NO," ).append("\n"); 
		query.append("				    X.BKG_OFC_CD," ).append("\n"); 
		query.append("				    decode(@[scac_flg] ,'Y','SMLM','')||X.BL_NO  BL_NO," ).append("\n"); 
		query.append("				    X.TRUNK_VVD," ).append("\n"); 
		query.append("				    X.VSL_CD," ).append("\n"); 
		query.append("				    X.SKD_VOY_NO," ).append("\n"); 
		query.append("				    X.SKD_DIR_CD," ).append("\n"); 
		query.append("				    X.POR_CD," ).append("\n"); 
		query.append("				    X.POL_CD," ).append("\n"); 
		query.append("				    X.POD_CD," ).append("\n"); 
		query.append("				    X.DEL_CD," ).append("\n"); 
		query.append("				    X.PRE_RLY_PORT_CD," ).append("\n"); 
		query.append("				    X.PST_RLY_PORT_CD," ).append("\n"); 
		query.append("				    X.CMDT_CD," ).append("\n"); 
		query.append("				    X.PCT_QTY," ).append("\n"); 
		query.append("				    X.PCK_TP_CD," ).append("\n"); 
		query.append("				    X.REP_CMDT," ).append("\n"); 
		query.append("				    X.CUST_REF_NO," ).append("\n"); 
		query.append("				    X.ACT_WGT," ).append("\n"); 
		query.append("				    X.WGT_UT_CD," ).append("\n"); 
		query.append("				    X.RCV_TERM_CD," ).append("\n"); 
		query.append("				    X.DE_TERM_CD," ).append("\n"); 
		query.append("				    X.LANE_CD," ).append("\n"); 
		query.append("				    X.SCAC_CD," ).append("\n"); 
		query.append("				    X.OBL_ISS_DT," ).append("\n"); 
		query.append("				    X.BL_OBRD_DT," ).append("\n"); 
		query.append("					X.SVC_SCP_CD," ).append("\n"); 
		query.append("				    X.VSL_ENG_NM," ).append("\n"); 
		query.append("				    X.POR_NM," ).append("\n"); 
		query.append("				    X.POL_NM," ).append("\n"); 
		query.append("				    X.POD_NM," ).append("\n"); 
		query.append("				    X.DEL_NM," ).append("\n"); 
		query.append("				    X.SHPR_CODE," ).append("\n"); 
		query.append("				    X.SHPR_NAME," ).append("\n"); 
		query.append("				    X.CNEE_CODE," ).append("\n"); 
		query.append("				    X.CNEE_NAME," ).append("\n"); 
		query.append("				    X.NTFY_CODE," ).append("\n"); 
		query.append("				    X.NTFY_NAME," ).append("\n"); 
		query.append("				    X.SC_NO,   " ).append("\n"); 
		query.append("				    X.RFA_NO,         " ).append("\n"); 
		query.append("				    X.PPD_OFC,          " ).append("\n"); 
		query.append("				    X.CCT_OFC,          " ).append("\n"); 
		query.append("				    X.CSTMS_DESC,       " ).append("\n"); 
		query.append("				    X.USA_CSTMS_FILE_CD," ).append("\n"); 
		query.append("				    X.CND_CSTMS_FILE_CD," ).append("\n"); 
		query.append("				    X.CNTR_WGT,         " ).append("\n"); 
		query.append("				    X.CNTR_WGT_UT_CD," ).append("\n"); 
		query.append("				    X.SPC_CGO," ).append("\n"); 
		query.append("				    X.MEAS_QTY,      " ).append("\n"); 
		query.append("				    X.CNTR_MEAS_UT_CD,    " ).append("\n"); 
		query.append("				    X.CNTR_TPSZ_CD,  " ).append("\n"); 
		query.append("                    X.CNTR_VOL_QTY, " ).append("\n"); 
		query.append("				    X.PCK_QTY,       " ).append("\n"); 
		query.append("				    X.CNTR_PCK_TP_CD," ).append("\n"); 
		query.append("				    X.CNTR_PRT_FLG,  " ).append("\n"); 
		query.append("				    X.BDR_FLG,       " ).append("\n"); 
		query.append("				    X.POR_CNTY,      " ).append("\n"); 
		query.append("				    X.DEL_CNTY," ).append("\n"); 
		query.append("				    X.RMK," ).append("\n"); 
		query.append("				    X.CGO_RCV_DT," ).append("\n"); 
		query.append("				    X.SCAC," ).append("\n"); 
		query.append("				    X.CNTR_SIZE," ).append("\n"); 
		query.append("				    X.CHG_AMT," ).append("\n"); 
		query.append("				    X.G_CUST_SHPR," ).append("\n"); 
		query.append("				    X.G_CUST_CNEE," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.CA_ITNO,1) AS CA_ITNO," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.CA_ITNO,2) AS CNRR_REF_NO," ).append("\n"); 
		query.append("				    X.ATD," ).append("\n"); 
		query.append("				    X.ATA," ).append("\n"); 
		query.append("				    X.ATA_T," ).append("\n"); 
		query.append("				    X.ATD_T," ).append("\n"); 
		query.append("				    X.F_POL_ETA," ).append("\n"); 
		query.append("				    X.F_POL_ETD," ).append("\n"); 
		query.append("				    X.F_POD_ETA," ).append("\n"); 
		query.append("				    X.F_POD_ETD," ).append("\n"); 
		query.append("				    X.T_POL_ETA," ).append("\n"); 
		query.append("				    X.T_POL_ETD," ).append("\n"); 
		query.append("				    X.T_POD_ETA," ).append("\n"); 
		query.append("				    X.T_POD_ETD," ).append("\n"); 
		query.append("				    X.PPD_Charge," ).append("\n"); 
		query.append("				    X.CCT_Charge," ).append("\n"); 
		query.append("				    X.AN_SEND_DT," ).append("\n"); 
		query.append("				    X.DEL_STATE," ).append("\n"); 
		query.append("				    X.CNTR_SEAL_NO," ).append("\n"); 
		query.append("				    X.BL_PO_NO," ).append("\n"); 
		query.append("                    X.ITEM_PO_NO," ).append("\n"); 
		query.append("				    X.CNTR_PO_NO,    " ).append("\n"); 
		query.append("				    X.POL_ETD," ).append("\n"); 
		query.append("				    X.POD_ETA," ).append("\n"); 
		query.append("                    X.POD_ETB," ).append("\n"); 
		query.append("                    X.ACT_CUST_CODE," ).append("\n"); 
		query.append("                    X.ACT_CUST_NAME," ).append("\n"); 
		query.append("				    X.EQ_CTRL_OFC," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FREE_DT,1) AS FREE_DT," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FREE_DT,2) AS PKUP_NO," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FREE_DT,3) AS PKUP_NOD_CD," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FREE_DT,4) AS AVAL_DT," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.IBD_TRSP_ISS_DT,1) AS IBD_TRSP_ISS_DT," ).append("\n"); 
		query.append("				    X.HUB_LOC_CD," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.IBD_TRSP_ISS_DT,2) AS IT_NO," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FRT_CLT_FLG,1) AS FRT_CLT_FLG," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FRT_CLT_FLG,2) AS OBL_RDEM_FLG," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FRT_CLT_FLG,3) AS CUSTOMS_RLS_DT," ).append("\n"); 
		query.append("				    BKG_GET_TOKEN_FNC(X.FRT_CLT_FLG,4) AS CSTMS_CLR_CD," ).append("\n"); 
		query.append("				    X.CNTR_OC_DATE," ).append("\n"); 
		query.append("				    X.DCHG_TS_PORT_DT," ).append("\n"); 
		query.append("				    X.DSPO_CD," ).append("\n"); 
		query.append("				    X.CGO_STS_CD," ).append("\n"); 
		query.append("				    X.POD_ATATIC_DT," ).append("\n"); 
		query.append("				    X.DEL_ATA," ).append("\n"); 
		query.append("				    X.DEL_DT," ).append("\n"); 
		query.append("				    X.POR_GATE_IN_DT," ).append("\n"); 
		query.append("				    X.MT_RETURN_DT," ).append("\n"); 
		query.append("				    X.DEL_ETA_DT," ).append("\n"); 
		query.append("				    X.EXPORT_REF_NO," ).append("\n"); 
		query.append("				    X.FIRMS_CODE," ).append("\n"); 
		query.append("				    X.CBKG_NO," ).append("\n"); 
		query.append("				    X.TOT_MEAS," ).append("\n"); 
		query.append("				    X.MEAS_UT_CD," ).append("\n"); 
		query.append("                    X.SHIP_ID," ).append("\n"); 
		query.append("                    X.PRT_NO," ).append("\n"); 
		query.append("                    X.BKG_RCT_SND_DT_FAX," ).append("\n"); 
		query.append("                    X.DBL_SND_DT_FAX," ).append("\n"); 
		query.append("                    X.WBL_SND_DT_FAX," ).append("\n"); 
		query.append("                    X.DBL_SND_DT_EDI," ).append("\n"); 
		query.append("                    X.BKG_RCT_SND_DT_EDI," ).append("\n"); 
		query.append("                    X.UVD_MAX_ACT_DT," ).append("\n"); 
		query.append("                    X.UVD_MAX_ACT_DT2," ).append("\n"); 
		query.append("                    X.RLN_MAX_ACT_DT," ).append("\n"); 
		query.append("                    X.URN_MAX_ACT_DT," ).append("\n"); 
		query.append("                    X.OAN_MAX_ACT_DT," ).append("\n"); 
		query.append("                    X.OAN_MAX_ACT_DT2," ).append("\n"); 
		query.append("                    X.D_MAX_ACT_DT," ).append("\n"); 
		query.append("                    X.WEB_PRT," ).append("\n"); 
		query.append("					'' CCT_EX_RT," ).append("\n"); 
		query.append("					'' PPD_EX_RT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("					X.FNL_DEST_NM FINAL_DEST_NM," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                   (SELECT BKG.VSL_CD||BKG.SKD_VOY_NO||BKG.SKD_DIR_CD " ).append("\n"); 
		query.append("                           ||','||(SELECT CVSL.VSL_ENG_NM FROM MDM_VSL_CNTR     CVSL WHERE CVSL.VSL_CD = PRE.VSL_CD) " ).append("\n"); 
		query.append("                      FROM BKG_BOOKING BKG" ).append("\n"); 
		query.append("                         , BKG_VVD PRE" ).append("\n"); 
		query.append("                     WHERE BKG.BKG_NO          = PRE.BKG_NO" ).append("\n"); 
		query.append("                       AND BKG.PRE_RLY_PORT_CD = PRE.POD_CD" ).append("\n"); 
		query.append("                       AND 'S'                 = PRE.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                       AND  BKG.BKG_NO         = X.BKG_NO" ).append("\n"); 
		query.append("					) AS  PRE_VVD_N_NM," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                   (SELECT BKG.VSL_CD||BKG.SKD_VOY_NO||BKG.SKD_DIR_CD " ).append("\n"); 
		query.append("                           ||','||(SELECT CVSL.VSL_ENG_NM FROM MDM_VSL_CNTR     CVSL WHERE CVSL.VSL_CD = PST.VSL_CD)" ).append("\n"); 
		query.append("                      FROM BKG_BOOKING BKG" ).append("\n"); 
		query.append("                         , BKG_VVD PST" ).append("\n"); 
		query.append("                     WHERE BKG.BKG_NO          = PST.BKG_NO" ).append("\n"); 
		query.append("                       AND BKG.PST_RLY_PORT_CD = PST.POL_CD" ).append("\n"); 
		query.append("                       AND 'U'                 = PST.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                       AND BKG.BKG_NO          = X.BKG_NO" ).append("\n"); 
		query.append("                    ) AS POST_VVD_N_NM," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("					'' G_CNEE_CODE," ).append("\n"); 
		query.append("					'' G_SHPR_CODE," ).append("\n"); 
		query.append("					'' FRD_CUST_CODE," ).append("\n"); 
		query.append("					X.FRD_CUST_NM," ).append("\n"); 
		query.append("					X.FRD_CUST_CD," ).append("\n"); 
		query.append("					'' BL_ISS_OFC," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    /* CUSTOMER  */   " ).append("\n"); 
		query.append("                    (SELECT C7.CUST_CNT_CD||LPAD(TO_CHAR(C7.CUST_SEQ),6,'0')" ).append("\n"); 
		query.append("                        FROM BKG_CUSTOMER C7" ).append("\n"); 
		query.append("                        WHERE C7.BKG_NO=X.BKG_NO AND C7.BKG_CUST_TP_CD ='S' ) AS SHIPPER," ).append("\n"); 
		query.append("                    ( SELECT C1.CUST_CNT_CD||LPAD(TO_CHAR(C1.CUST_SEQ),6,'0')" ).append("\n"); 
		query.append("                        FROM   BKG_CUSTOMER C1" ).append("\n"); 
		query.append("                       WHERE  C1.BKG_NO = X.BKG_NO AND C1.BKG_CUST_TP_CD ='C' ) AS CONSIGNEE," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                        " ).append("\n"); 
		query.append("                    (SELECT /*+ INDEX( K5 XPKBKG_VVD ) */" ).append("\n"); 
		query.append("                            K5.VSL_CD||K5.SKD_VOY_NO||K5.SKD_DIR_CD " ).append("\n"); 
		query.append("                        FROM  BKG_VVD K5" ).append("\n"); 
		query.append("                        WHERE K5.BKG_NO = X.BKG_NO  AND  ROWNUM = 1) AS FST_VVD," ).append("\n"); 
		query.append("                    (SELECT /*+ INDEX_DESC( K6 XPKBKG_VVD ) */ " ).append("\n"); 
		query.append("                                     K6.VSL_CD||K6.SKD_VOY_NO||K6.SKD_DIR_CD " ).append("\n"); 
		query.append("                              FROM  BKG_VVD K6" ).append("\n"); 
		query.append("                              WHERE K6.BKG_NO = X.BKG_NO" ).append("\n"); 
		query.append("                              AND  ROWNUM = 1)     AS LST_VVD, " ).append("\n"); 
		query.append("                      @[in_out_cd] AS IN_OUT_CD" ).append("\n"); 
		query.append("                      ,X.INIT_POL_ETA_DT,INIT_POL_ETD_DT,INIT_POD_ETA_DT" ).append("\n"); 
		query.append("                      ,X.LOAD_ID" ).append("\n"); 
		query.append("					  ,X.VGM_WGT AS VGM_WGT" ).append("\n"); 
		query.append("                      ,X.VGM_WGT_UT_CD AS VGM_WGT_UT_CD" ).append("\n"); 
		query.append("                      ,X.VGM_VRFY_SIG_CTNT AS VGM_VRFY_SIG_CTNT" ).append("\n"); 
		query.append("                      ,X.VGM_MZD_TP_CD AS VGM_MZD_TP_CD" ).append("\n"); 
		query.append("                    FROM (" ).append("\n"); 
		query.append("                                SELECT " ).append("\n"); 
		query.append("                                    B.BKG_NO      AS BKG_NO," ).append("\n"); 
		query.append("                                    CNTR.CNTR_NO  AS CNTR_NO," ).append("\n"); 
		query.append("                                    B.BKG_OFC_CD  AS BKG_OFC_CD," ).append("\n"); 
		query.append("                                    B.BL_NO       AS BL_NO," ).append("\n"); 
		query.append("                                    B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD AS TRUNK_VVD," ).append("\n"); 
		query.append("                                    B.VSL_CD      AS VSL_CD, " ).append("\n"); 
		query.append("                                    B.SKD_VOY_NO  AS SKD_VOY_NO, " ).append("\n"); 
		query.append("                                    B.SKD_DIR_CD  AS SKD_DIR_CD, " ).append("\n"); 
		query.append("                                    B.POR_CD      AS POR_CD," ).append("\n"); 
		query.append("                                    B.POL_CD      AS POL_CD," ).append("\n"); 
		query.append("                                    B.POD_CD      AS POD_CD," ).append("\n"); 
		query.append("                                    B.DEL_CD      AS DEL_CD," ).append("\n"); 
		query.append("                                    B.PRE_RLY_PORT_CD AS PRE_RLY_PORT_CD," ).append("\n"); 
		query.append("                                    B.PST_RLY_PORT_CD AS PST_RLY_PORT_CD," ).append("\n"); 
		query.append("                                    B.CMDT_CD     AS CMDT_CD," ).append("\n"); 
		query.append("                                    D.PCK_QTY     AS PCT_QTY," ).append("\n"); 
		query.append("                                    D.PCK_TP_CD   AS PCK_TP_CD,   " ).append("\n"); 
		query.append("                                    D.MEAS_QTY    AS TOT_MEAS," ).append("\n"); 
		query.append("                                    D.MEAS_UT_CD  AS MEAS_UT_CD,   " ).append("\n"); 
		query.append("                                    L.REP_CMDT_NM AS REP_CMDT, " ).append("\n"); 
		query.append("                                    (SELECT CUST_REF_NO_CTNT " ).append("\n"); 
		query.append("                                     FROM BKG_REFERENCE R " ).append("\n"); 
		query.append("                                     WHERE R.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                       AND BKG_REF_TP_CD = 'EBRF' ) AS CUST_REF_NO, " ).append("\n"); 
		query.append("                                    D.ACT_WGT     AS ACT_WGT, " ).append("\n"); 
		query.append("                                    D.WGT_UT_CD   AS WGT_UT_CD, " ).append("\n"); 
		query.append("                                    B.RCV_TERM_CD AS RCV_TERM_CD," ).append("\n"); 
		query.append("                                    B.DE_TERM_CD  AS DE_TERM_CD," ).append("\n"); 
		query.append("                                    B.SLAN_CD     AS LANE_CD," ).append("\n"); 
		query.append("                                    B.SCAC_CD     AS SCAC_CD," ).append("\n"); 
		query.append("									B.SVC_SCP_CD  AS SVC_SCP_CD," ).append("\n"); 
		query.append("                                    TO_CHAR(H.OBL_ISS_DT, 'YYYY-MM-DD')  AS OBL_ISS_DT," ).append("\n"); 
		query.append("                                    TO_CHAR(D.BL_OBRD_DT, 'YYYY-MM-DD')  AS BL_OBRD_DT," ).append("\n"); 
		query.append("                                    D.VSL_NM         AS VSL_ENG_NM," ).append("\n"); 
		query.append("                                    D.POR_NM         AS POR_NM," ).append("\n"); 
		query.append("                                    D.POL_NM         AS POL_NM," ).append("\n"); 
		query.append("                                    D.POD_NM         AS POD_NM," ).append("\n"); 
		query.append("                                    D.DEL_NM         AS DEL_NM," ).append("\n"); 
		query.append("                                    MAX(DECODE(C.BKG_CUST_TP_CD, 'S', C.CUST_CNT_CD, ''))||MAX(DECODE(C.BKG_CUST_TP_CD, 'S', LPAD(C.CUST_SEQ,6,'0'), '')) AS SHPR_CODE," ).append("\n"); 
		query.append("                                    REPLACE(MAX(DECODE(C.BKG_CUST_TP_CD,'S',C.CUST_NM,'')),chr(13)||chr(10),' ') AS SHPR_NAME," ).append("\n"); 
		query.append("                                    MAX(DECODE(C.BKG_CUST_TP_CD, 'C', C.CUST_CNT_CD, ''))||MAX(DECODE(C.BKG_CUST_TP_CD, 'C', LPAD(C.CUST_SEQ,6,'0'), '')) AS CNEE_CODE," ).append("\n"); 
		query.append("                                    REPLACE(MAX(DECODE(C.BKG_CUST_TP_CD,'C',C.CUST_NM,'')),chr(13)||chr(10),' ') AS CNEE_NAME," ).append("\n"); 
		query.append("                                    MAX(DECODE(C.BKG_CUST_TP_CD, 'N', C.CUST_CNT_CD, ''))||MAX(DECODE(C.BKG_CUST_TP_CD, 'N', LPAD(C.CUST_SEQ,6,'0'), '')) AS NTFY_CODE," ).append("\n"); 
		query.append("                                    REPLACE(MAX(DECODE(C.BKG_CUST_TP_CD,'N',C.CUST_NM,'')),chr(13)||chr(10),' ') AS NTFY_NAME," ).append("\n"); 
		query.append("									MAX(DECODE(C.BKG_CUST_TP_CD, 'F', C.CUST_CNT_CD, ''))||MAX(DECODE(C.BKG_CUST_TP_CD, 'F', LPAD(C.CUST_SEQ,6,'0'), '')) AS FRD_CUST_CD," ).append("\n"); 
		query.append("                                    REPLACE(MAX(DECODE(C.BKG_CUST_TP_CD,'F',C.CUST_NM,'')),chr(13)||chr(10),' ') AS FRD_CUST_NM," ).append("\n"); 
		query.append("                                    B.SC_NO             AS SC_NO," ).append("\n"); 
		query.append("                                    B.RFA_NO            AS RFA_NO," ).append("\n"); 
		query.append("                                    R.PPD_RCV_OFC_CD    AS PPD_OFC," ).append("\n"); 
		query.append("                                    R.CLT_OFC_CD        AS CCT_OFC," ).append("\n"); 
		query.append("                                    D.CSTMS_DESC        AS CSTMS_DESC," ).append("\n"); 
		query.append("                                    B.USA_CSTMS_FILE_CD AS USA_CSTMS_FILE_CD," ).append("\n"); 
		query.append("                                    B.CND_CSTMS_FILE_CD AS CND_CSTMS_FILE_CD,  " ).append("\n"); 
		query.append("                                    CNTR.CNTR_WGT       AS CNTR_WGT," ).append("\n"); 
		query.append("                                    CNTR.WGT_UT_CD      AS CNTR_WGT_UT_CD," ).append("\n"); 
		query.append("                                    DECODE(CNTR.DCGO_FLG, 'Y', 'DG', DECODE(CNTR.RC_FLG, 'Y', 'RF', " ).append("\n"); 
		query.append("                                                                           DECODE(CNTR.BB_CGO_FLG, 'Y', 'BB', " ).append("\n"); 
		query.append("                                                                            DECODE(CNTR.AWK_CGO_FLG, 'Y', 'AK', " ).append("\n"); 
		query.append("                                                                             DECODE(CNTR.RD_CGO_FLG, 'RD', " ).append("\n"); 
		query.append("                                                                              DECODE(CNTR.SOC_FLG, 'Y', 'SOC', '')))))) AS SPC_CGO,   " ).append("\n"); 
		query.append("                                    CNTR.MEAS_QTY       AS MEAS_QTY," ).append("\n"); 
		query.append("                                    CNTR.MEAS_UT_CD     AS CNTR_MEAS_UT_CD," ).append("\n"); 
		query.append("                                    CNTR.CNTR_TPSZ_CD   AS CNTR_TPSZ_CD," ).append("\n"); 
		query.append("                                    CNTR.CNTR_VOL_QTY   AS CNTR_VOL_QTY, " ).append("\n"); 
		query.append("                                    CNTR.PCK_QTY        AS PCK_QTY," ).append("\n"); 
		query.append("                                    CNTR.PCK_TP_CD      AS CNTR_PCK_TP_CD," ).append("\n"); 
		query.append("                                    CNTR.CNTR_PRT_FLG   AS CNTR_PRT_FLG," ).append("\n"); 
		query.append("                                    ( SELECT CUST_REF_NO_CTNT " ).append("\n"); 
		query.append("                                       FROM BKG_REFERENCE A" ).append("\n"); 
		query.append("                                       WHERE A.BKG_NO = CNTR.BKG_NO" ).append("\n"); 
		query.append("                                       AND  A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("									   AND A.BKG_REF_TP_CD = 'CTPO'" ).append("\n"); 
		query.append("									   AND ROWNUM = 1" ).append("\n"); 
		query.append("                                    ) AS CNTR_PO_NO," ).append("\n"); 
		query.append("								    BKG_JOIN_FNC( CURSOR(" ).append("\n"); 
		query.append("								                    SELECT PO_NO" ).append("\n"); 
		query.append("								                      FROM BKG_REF_DTL DTL" ).append("\n"); 
		query.append("								                     WHERE DTL.BKG_NO = CNTR.BKG_NO" ).append("\n"); 
		query.append("								                      AND DTL.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("								                      AND DE_NO IS NULL" ).append("\n"); 
		query.append("								                      AND PRT_NO IS NULL" ).append("\n"); 
		query.append("								                      AND PO_NO IS NOT NULL" ).append("\n"); 
		query.append("								                      AND ROWNUM <=10 /* 10개 까지만 제공 */" ).append("\n"); 
		query.append("								    )) AS ITEM_PO_NO," ).append("\n"); 
		query.append("                                    J.DE_NO SHIP_ID," ).append("\n"); 
		query.append("                                    J.PRT_NO," ).append("\n"); 
		query.append("                                    D.BDR_FLG           AS BDR_FLG," ).append("\n"); 
		query.append("                                    SUBSTR(B.POR_CD,1,2) AS POR_CNTY," ).append("\n"); 
		query.append("                                    SUBSTR(B.DEL_CD,1,2) AS DEL_CNTY," ).append("\n"); 
		query.append("                                    REPLACE(B.XTER_RMK,chr(13)||chr(10),' ')           AS RMK," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    TO_CHAR(R.CGO_RCV_DT,'YYYY-MM-DD') AS CGO_RCV_DT, " ).append("\n"); 
		query.append("                                    'SMLM'               AS SCAC," ).append("\n"); 
		query.append("                                    (SELECT U.RAT_UT_CD " ).append("\n"); 
		query.append("                                     FROM PRI_RAT_UT U, PRI_RAT_UT C" ).append("\n"); 
		query.append("                                     WHERE U.RAT_UT_CD IN ('20','40','45')" ).append("\n"); 
		query.append("                                     AND U.CNTR_SZ_CD = C.CNTR_SZ_CD" ).append("\n"); 
		query.append("                                     AND C.RAT_UT_CD = CNTR.CNTR_TPSZ_CD) CNTR_SIZE,                      " ).append("\n"); 
		query.append("                                                                                               " ).append("\n"); 
		query.append("                                    (SELECT CHG_AMT " ).append("\n"); 
		query.append("                                      FROM BKG_CHG_RT A" ).append("\n"); 
		query.append("                                     WHERE A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                       AND A.RT_SEQ = (SELECT MAX(RT_SEQ)" ).append("\n"); 
		query.append("                                                       FROM BKG_CHG_RT C" ).append("\n"); 
		query.append("                                                       WHERE C.BKG_NO = B.BKG_NO)" ).append("\n"); 
		query.append("                                    ) AS CHG_AMT, " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT CUST_GRP_ID " ).append("\n"); 
		query.append("                                       FROM MDM_CUSTOMER A, BKG_CUSTOMER SCUST" ).append("\n"); 
		query.append("                                      WHERE  A.CUST_CNT_CD = SCUST.CUST_CNT_CD" ).append("\n"); 
		query.append("                                        AND  A.CUST_SEQ = SCUST.CUST_SEQ " ).append("\n"); 
		query.append("                                        AND  SCUST.BKG_CUST_TP_CD ='S'" ).append("\n"); 
		query.append("                                        AND  SCUST.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS G_CUST_SHPR," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT CUST_GRP_ID " ).append("\n"); 
		query.append("                                       FROM MDM_CUSTOMER A, BKG_CUSTOMER SCUST" ).append("\n"); 
		query.append("                                      WHERE  A.CUST_CNT_CD = SCUST.CUST_CNT_CD" ).append("\n"); 
		query.append("                                        AND  A.CUST_SEQ = SCUST.CUST_SEQ " ).append("\n"); 
		query.append("                                        AND  SCUST.BKG_CUST_TP_CD ='C'" ).append("\n"); 
		query.append("                                        AND  SCUST.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS G_CUST_CNEE    ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT USA_IB_TRSP_NO||','||RAIL_CRR_REF_NO" ).append("\n"); 
		query.append("										FROM BKG_CSTMS_ADV_CNTR A" ).append("\n"); 
		query.append("										WHERE A.CNT_CD = 'CA'" ).append("\n"); 
		query.append("										AND B.BL_NO = A.BL_NO" ).append("\n"); 
		query.append("										AND CNTR.CNTR_NO = A.CNTR_NO" ).append("\n"); 
		query.append("									) AS CA_ITNO," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(S2.ACT_DT,'YYYY-MM-DD hh24:mi')   " ).append("\n"); 
		query.append("                                       FROM BKG_VVD S1, SCE_COP_DTL S2" ).append("\n"); 
		query.append("                                       WHERE S1.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                        AND S1.VSL_CD = S2.VSL_CD" ).append("\n"); 
		query.append("                                        AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND S1.SKD_DIR_CD = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND S1.POL_CD = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                        AND S1.VSL_PRE_PST_CD||S1.VSL_SEQ = (SELECT MIN(VSL_PRE_PST_CD||VSL_SEQ)" ).append("\n"); 
		query.append("                                                                             FROM bkg_vvd" ).append("\n"); 
		query.append("                                                                             WHERE BKG_NO = B.BKG_NO)" ).append("\n"); 
		query.append("                                                                             AND S2.COP_NO IN ( SELECT MAX(COP_NO)" ).append("\n"); 
		query.append("                                                                                                  FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                                                                 WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                                                                   AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                        AND S2.ACT_CD LIKE 'F__MDO'" ).append("\n"); 
		query.append("                                    ) AS ATD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(S2.ACT_DT,'YYYY-MM-DD hh24:mi')   " ).append("\n"); 
		query.append("                                       FROM BKG_VVD S1, SCE_COP_DTL S2" ).append("\n"); 
		query.append("                                       WHERE S1.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                        AND S1.VSL_CD = S2.VSL_CD" ).append("\n"); 
		query.append("                                        AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND S1.SKD_DIR_CD = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND S1.POL_CD = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                        AND S1.VSL_PRE_PST_CD = 'T'" ).append("\n"); 
		query.append("                                        AND S1.VSL_SEQ = '0'" ).append("\n"); 
		query.append("                                        AND S2.COP_NO IN (SELECT MAX(COP_NO)" ).append("\n"); 
		query.append("                                                            FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                           WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                             AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                        AND S2.ACT_CD LIKE 'F__MDO'" ).append("\n"); 
		query.append("                                    ) AS ATD_T, " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(S2.ACT_DT,'YYYY-MM-DD hh24:mi')   " ).append("\n"); 
		query.append("                                       FROM BKG_VVD S1, SCE_COP_DTL S2" ).append("\n"); 
		query.append("                                       WHERE S1.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                        AND S1.VSL_CD = S2.VSL_CD" ).append("\n"); 
		query.append("                                        AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND S1.SKD_DIR_CD = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND S1.POD_CD = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                        AND S1.VSL_PRE_PST_CD||S1.VSL_SEQ = (SELECT MAX(VSL_PRE_PST_CD||VSL_SEQ)" ).append("\n"); 
		query.append("                                                                               FROM bkg_vvd" ).append("\n"); 
		query.append("                                                                              WHERE BKG_NO = B.BKG_NO)" ).append("\n"); 
		query.append("                                                                                AND S2.COP_NO IN ( SELECT MAX(COP_NO)" ).append("\n"); 
		query.append("                                                                                                     FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                                                                    WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                                                                      AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                        AND S2.ACT_CD LIKE 'F__MAD'" ).append("\n"); 
		query.append("                                    )AS ATA," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                     " ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(S2.ACT_DT,'YYYY-MM-DD hh24:mi')   " ).append("\n"); 
		query.append("                                       FROM BKG_VVD S1, SCE_COP_DTL S2" ).append("\n"); 
		query.append("                                       WHERE S1.BKG_NO = B.BKG_NO  " ).append("\n"); 
		query.append("                                        AND S1.VSL_CD = S2.VSL_CD" ).append("\n"); 
		query.append("                                        AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND S1.SKD_DIR_CD = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND S1.POD_CD = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                        AND S1.VSL_PRE_PST_CD = 'T'" ).append("\n"); 
		query.append("                                        AND S1.VSL_SEQ = '0'" ).append("\n"); 
		query.append("                                        AND S2.COP_NO IN ( SELECT MAX(COP_NO)" ).append("\n"); 
		query.append("                                                             FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                            WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                              AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                        AND S2.ACT_CD LIKE 'F__MAD'" ).append("\n"); 
		query.append("                                    )AS ATA_T," ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("									( " ).append("\n"); 
		query.append("									SELECT TO_CHAR(S2.VPS_ETA_DT, 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD       = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("									   AND ( S1.BKG_NO, S1.VSL_PRE_PST_CD, S1.VSL_SEQ ) IN (" ).append("\n"); 
		query.append("                                         SELECT BKG_NO, SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),1,1), SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),2,1) " ).append("\n"); 
		query.append("                                           FROM BKG_VVD" ).append("\n"); 
		query.append("                                          WHERE BKG_NO = S1.BKG_NO" ).append("\n"); 
		query.append("                                          GROUP BY BKG_NO ) " ).append("\n"); 
		query.append("                                    ) AS F_POL_ETA," ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("									SELECT TO_CHAR(S2.VPS_ETD_DT, 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("									   AND ( S1.BKG_NO, S1.VSL_PRE_PST_CD, S1.VSL_SEQ ) IN (" ).append("\n"); 
		query.append("                                         SELECT BKG_NO, SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),1,1), SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),2,1) " ).append("\n"); 
		query.append("                                           FROM BKG_VVD" ).append("\n"); 
		query.append("                                          WHERE BKG_NO = S1.BKG_NO" ).append("\n"); 
		query.append("                                          GROUP BY BKG_NO ) " ).append("\n"); 
		query.append("                                    ) AS F_POL_ETD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("									SELECT TO_CHAR(S2.VPS_ETA_DT, 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        =  B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("									   AND ( S1.BKG_NO, S1.VSL_PRE_PST_CD, S1.VSL_SEQ ) IN (" ).append("\n"); 
		query.append("                                         SELECT BKG_NO, SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),1,1), SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),2,1) " ).append("\n"); 
		query.append("                                           FROM BKG_VVD" ).append("\n"); 
		query.append("                                          WHERE BKG_NO = S1.BKG_NO" ).append("\n"); 
		query.append("                                          GROUP BY BKG_NO ) " ).append("\n"); 
		query.append("                                    ) AS F_POD_ETA," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("									SELECT TO_CHAR(S2.VPS_ETD_DT, 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        =  B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("									   AND ( S1.BKG_NO, S1.VSL_PRE_PST_CD, S1.VSL_SEQ ) IN (" ).append("\n"); 
		query.append("                                         SELECT BKG_NO, SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),1,1), SUBSTR(MAX(VSL_PRE_PST_CD||VSL_SEQ),2,1) " ).append("\n"); 
		query.append("                                           FROM BKG_VVD" ).append("\n"); 
		query.append("                                          WHERE BKG_NO = S1.BKG_NO" ).append("\n"); 
		query.append("                                          GROUP BY BKG_NO )       " ).append("\n"); 
		query.append("                                    ) AS F_POD_ETD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MIN(MAX(S2.VPS_ETA_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_PRE_PST_CD        = 'T'" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                     GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS T_POL_ETA," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                     (SELECT TO_CHAR(MIN(MIN(S2.VPS_ETD_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        =  B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_PRE_PST_CD        = 'T'" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POL_CD      = S2.VPS_PORT_CD  " ).append("\n"); 
		query.append("                                       AND S1.POL_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                       GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS T_POL_ETD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT TO_CHAR(MAX(MAX(S2.VPS_ETA_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                     FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        =  B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_PRE_PST_CD        = 'T'" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                     GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS T_POD_ETA, " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MAX(MIN(S2.VPS_ETD_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                     WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                       AND S1.VSL_PRE_PST_CD        = 'T'" ).append("\n"); 
		query.append("                                       AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                       AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                     GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS T_POD_ETD," ).append("\n"); 
		query.append("                                     " ).append("\n"); 
		query.append("                                    ( SELECT TRIM(TO_CHAR(SUM(CHG_AMT/USD_LOCL_XCH_RT) ,'99,999,999.99'))" ).append("\n"); 
		query.append("                                        FROM BKG_CHG_RT R," ).append("\n"); 
		query.append("                                          GL_MON_XCH_RT A" ).append("\n"); 
		query.append("                                        WHERE TO_CHAR(R.CRE_DT, 'YYYYMM') = A.ACCT_XCH_RT_YRMON" ).append("\n"); 
		query.append("                                          AND A.ACCT_XCH_RT_LVL = '1'" ).append("\n"); 
		query.append("                                          AND FRT_TERM_CD = 'P'" ).append("\n"); 
		query.append("                                          AND R.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("										  AND R.CURR_CD = A.CURR_CD" ).append("\n"); 
		query.append("										  AND R.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("                                    ) AS PPD_CHARGE," ).append("\n"); 
		query.append("                                          " ).append("\n"); 
		query.append("                                    ( SELECT TRIM(TO_CHAR(SUM(CHG_AMT/USD_LOCL_XCH_RT) ,'99,999,999.99'))" ).append("\n"); 
		query.append("                                        FROM BKG_CHG_RT R," ).append("\n"); 
		query.append("                                          GL_MON_XCH_RT A" ).append("\n"); 
		query.append("                                        WHERE TO_CHAR(R.CRE_DT, 'YYYYMM') = A.ACCT_XCH_RT_YRMON" ).append("\n"); 
		query.append("                                          AND A.ACCT_XCH_RT_LVL = '1'" ).append("\n"); 
		query.append("                                          AND FRT_TERM_CD = 'C'" ).append("\n"); 
		query.append("                                          AND R.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("										  AND R.CURR_CD = A.CURR_CD" ).append("\n"); 
		query.append("										  AND R.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("                                    ) AS CCT_CHARGE," ).append("\n"); 
		query.append("                                          " ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MAX(T.SND_DT), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM BKG_NTC_HIS T" ).append("\n"); 
		query.append("                                        WHERE T.NTC_VIA_CD IN ('F','M')" ).append("\n"); 
		query.append("                                          AND T.NTC_KND_CD ='AN'" ).append("\n"); 
		query.append("                                          AND T.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS AN_SEND_DT, " ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                    ( SELECT V.STE_NM " ).append("\n"); 
		query.append("                                      FROM MDM_location U, MDM_state V" ).append("\n"); 
		query.append("                                      WHERE U.STE_CD    = V.STE_CD(+)" ).append("\n"); 
		query.append("                                        AND U.cnt_cd       = V.cnt_cd" ).append("\n"); 
		query.append("                                        AND U.loc_cd       = B.DEL_CD" ).append("\n"); 
		query.append("                                    ) AS DEL_STATE," ).append("\n"); 
		query.append("                                     " ).append("\n"); 
		query.append("                                    BKG_JOIN_FNC(CURSOR(SELECT C.CNTR_SEAL_NO" ).append("\n"); 
		query.append("                                      FROM BKG_CNTR_SEAL_NO C" ).append("\n"); 
		query.append("                                      WHERE 1=1" ).append("\n"); 
		query.append("                                        AND C.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                        AND C.BKG_NO = B.BKG_NO                   " ).append("\n"); 
		query.append("                                    )) AS CNTR_SEAL_NO," ).append("\n"); 
		query.append("                                      " ).append("\n"); 
		query.append("                                    ( SELECT CUST_REF_NO_CTNT" ).append("\n"); 
		query.append("                                       FROM BKG_REFERENCE A" ).append("\n"); 
		query.append("                                       WHERE A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("									   AND A.BKG_REF_TP_CD = 'BKPO'" ).append("\n"); 
		query.append("									   AND ROWNUM = 1" ).append("\n"); 
		query.append("                                    ) AS BL_PO_NO," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MIN(MIN(S2.VPS_ETD_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                        WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                          AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                          AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                          AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                          AND S1.POL_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                          AND S1.POL_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                          GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS POL_ETD," ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                     (SELECT TO_CHAR(MAX(MAX(S2.VPS_ETA_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                       FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                      WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                        AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                        AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                        AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                        GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS POD_ETA," ).append("\n"); 
		query.append("                                    " ).append("\n"); 
		query.append("                                    (SELECT TO_CHAR(MAX(MAX(S2.VPS_ETB_DT)), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                       FROM BKG_VVD S1, VSK_VSL_PORT_SKD S2" ).append("\n"); 
		query.append("                                      WHERE S1.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("                                        AND S1.VSL_CD        = S2.VSL_CD" ).append("\n"); 
		query.append("                                        AND S1.SKD_VOY_NO = S2.SKD_VOY_NO" ).append("\n"); 
		query.append("                                        AND S1.SKD_DIR_CD    = S2.SKD_DIR_CD" ).append("\n"); 
		query.append("                                        AND S1.POD_CD       = S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                        AND S1.POD_CLPT_IND_SEQ = S2.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                        GROUP BY S2.VSL_CD, S2.SKD_VOY_NO, S2.SKD_DIR_CD, S2.VPS_PORT_CD" ).append("\n"); 
		query.append("                                    ) AS POD_ETB," ).append("\n"); 
		query.append("                                    " ).append("\n"); 
		query.append("                                    (SELECT B.AGMT_ACT_CNT_CD||LPAD(B.AGMT_ACT_CUST_SEQ,6,'0')" ).append("\n"); 
		query.append("                                   FROM MDM_CUSTOMER ACT_CUST" ).append("\n"); 
		query.append("                                   WHERE ACT_CUST.CUST_CNT_CD = B.AGMT_ACT_CNT_CD" ).append("\n"); 
		query.append("                                   AND ACT_CUST.CUST_SEQ = B.AGMT_ACT_CUST_SEQ) ACT_CUST_CODE," ).append("\n"); 
		query.append("                                   " ).append("\n"); 
		query.append("                                   (SELECT ACT_CUST.CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("                                   FROM MDM_CUSTOMER ACT_CUST" ).append("\n"); 
		query.append("                                   WHERE ACT_CUST.CUST_CNT_CD = B.AGMT_ACT_CNT_CD" ).append("\n"); 
		query.append("                                   AND ACT_CUST.CUST_SEQ = B.AGMT_ACT_CUST_SEQ) ACT_CUST_NAME," ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                    (SELECT EQ_CTRL_OFC_CD" ).append("\n"); 
		query.append("                                       FROM MDM_LOCATION U" ).append("\n"); 
		query.append("									 WHERE U.LOC_CD       = B.DEL_CD" ).append("\n"); 
		query.append("									) AS EQ_CTRL_OFC," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT SO.LST_FREE_DT||','||SO.PKUP_NO||','||SO.PKUP_YD_CD||','||SO.PKUP_AVAL_DT" ).append("\n"); 
		query.append("										FROM BKG_PKUP_NTC_PKUP_NO SO, BKG_BOOKING C, MDM_LOCATION M, SCE_COP_HDR SCA, SCE_COP_HDR SCB" ).append("\n"); 
		query.append("										WHERE 1=1" ).append("\n"); 
		query.append("                    					AND SCA.BKG_NO = CNTR.BKG_NO" ).append("\n"); 
		query.append("                   						AND SCA.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                    					AND SCB.COP_STS_CD <> 'X'" ).append("\n"); 
		query.append("                    					AND SCA.COP_STS_CD <> 'X'" ).append("\n"); 
		query.append("                    					AND SCA.MST_COP_NO = SCB.COP_NO" ).append("\n"); 
		query.append("                    					AND SCB.BKG_NO =  SO.BKG_NO" ).append("\n"); 
		query.append("                    					AND SCB.CNTR_NO = SO.CNTR_NO" ).append("\n"); 
		query.append("                    					AND C.BKG_NO = SO.BKG_NO" ).append("\n"); 
		query.append("                    					AND C.DEL_CD = M.LOC_CD" ).append("\n"); 
		query.append("                    					AND SO.OFC_CD = DECODE(SUBSTR(C.DEL_CD,1,2),'US','PHXSA',M.EQ_CTRL_OFC_CD) " ).append("\n"); 
		query.append("									) AS FREE_DT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT IBD_TRSP_ISS_DT||','||IBD_TRSP_NO" ).append("\n"); 
		query.append("										FROM BKG_CSTMS_ADV_IBD A" ).append("\n"); 
		query.append("										WHERE A.BL_NO = B.BL_NO" ).append("\n"); 
		query.append("									) AS IBD_TRSP_ISS_DT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT HUB_LOC_CD" ).append("\n"); 
		query.append("                                       FROM BKG_CSTMS_ADV_BL A" ).append("\n"); 
		query.append("                                      WHERE A.BL_NO = B.BL_NO" ).append("\n"); 
		query.append("										AND A.CNT_CD ='US'" ).append("\n"); 
		query.append("                                    ) AS HUB_LOC_CD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT FRT_CLT_FLG||','||OBL_RDEM_FLG||','||TO_CHAR(CSTMS_CLR_LST_DT,'YYYY-MM-DD')||','||CSTMS_CLR_CD" ).append("\n"); 
		query.append("										FROM BKG_CGO_RLSE A" ).append("\n"); 
		query.append("										WHERE A.BL_NO = B.BL_NO" ).append("\n"); 
		query.append("									) AS FRT_CLT_FLG," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM SCE_COP_DTL" ).append("\n"); 
		query.append("                                       WHERE COP_NO = ( SELECT MAX(COP_NO) FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                                             WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                                 AND CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                                                 AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                                                 AND ACT_STS_MAPG_CD = 'OC'" ).append("\n"); 
		query.append("                                                                                               ) AS CNTR_OC_DATE," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MIN(ACT_DT),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM SCE_COP_DTL" ).append("\n"); 
		query.append("                                       WHERE COP_NO = ( SELECT MAX(COP_NO) " ).append("\n"); 
		query.append("                                                        FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                        WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                        AND CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                                        AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                        AND ACT_CD IN ('FTVMUD','FTWMUD')) AS DCHG_TS_PORT_DT," ).append("\n"); 
		query.append("                                                                                               " ).append("\n"); 
		query.append("                                    (SELECT DSPO_CD " ).append("\n"); 
		query.append("                                       FROM BKG_CSTMS_ADV_RSLT A" ).append("\n"); 
		query.append("                                      WHERE A.CNT_CD ='US'" ).append("\n"); 
		query.append("                                        AND A.BL_NO = B.BL_NO" ).append("\n"); 
		query.append("                                        AND A.CSTMS_SEQ = (SELECT MAX(CSTMS_SEQ)" ).append("\n"); 
		query.append("                                                             FROM BKG_CSTMS_ADV_RSLT C" ).append("\n"); 
		query.append("                                                            WHERE C.CNT_CD ='US'" ).append("\n"); 
		query.append("                                                              AND C.BL_NO = B.BL_NO) " ).append("\n"); 
		query.append("                                    ) AS DSPO_CD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT CNMV_STS_CD " ).append("\n"); 
		query.append("                                       FROM MST_CONTAINER A" ).append("\n"); 
		query.append("                                      WHERE A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                    )AS CGO_STS_CD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT TO_CHAR(MIN(MV_IC.CNMV_EVNT_DT),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM CTM_MOVEMENT MV_IC" ).append("\n"); 
		query.append("                                     WHERE MV_IC.CNTR_NO        = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                       AND MV_IC.CNMV_CYC_NO    = CNTR.CNMV_CYC_NO" ).append("\n"); 
		query.append("                                       AND MV_IC.MVMT_STS_CD    = 'IC'" ).append("\n"); 
		query.append("                                       AND MV_IC.ORG_YD_CD      LIKE B.POD_CD||'%'" ).append("\n"); 
		query.append("                                    ) AS POD_ATATIC_DT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                   (SELECT TO_CHAR(MIN(MV_IC.CNMV_EVNT_DT),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                      FROM CTM_MOVEMENT MV_IC" ).append("\n"); 
		query.append("                                     WHERE MV_IC.CNTR_NO        = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                       AND MV_IC.CNMV_CYC_NO = CNTR.CNMV_CYC_NO" ).append("\n"); 
		query.append("                                       AND MV_IC.MVMT_STS_CD        = 'IC'" ).append("\n"); 
		query.append("                                       AND MV_IC.ORG_YD_CD      LIKE B.DEL_CD||'%'" ).append("\n"); 
		query.append("                                    ) AS DEL_ATA," ).append("\n"); 
		query.append("									" ).append("\n"); 
		query.append("									(SELECT MIN(TO_CHAR(CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI'))" ).append("\n"); 
		query.append("									 FROM 	CTM_MOVEMENT" ).append("\n"); 
		query.append("									 WHERE	BKG_NO IS NOT NULL" ).append("\n"); 
		query.append("										AND CNTR_NO	= CNTR.CNTR_NO" ).append("\n"); 
		query.append("										AND CNMV_CYC_NO = ( SELECT MAX(CNMV_CYC_NO) " ).append("\n"); 
		query.append("                                							FROM BKG_CONTAINER" ).append("\n"); 
		query.append("                                  							WHERE BKG_NO = CNTR.BKG_NO" ).append("\n"); 
		query.append("                                  							AND CNTR_NO =  CNTR.CNTR_NO )" ).append("\n"); 
		query.append("										AND MVMT_STS_CD = 'ID' ) DEL_DT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ( SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM SCE_COP_DTL" ).append("\n"); 
		query.append("                                       WHERE COP_NO = ( SELECT MAX(COP_NO) FROM SCE_COP_HDR" ).append("\n"); 
		query.append("                                                                             WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                                                 AND CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                                                 AND COP_STS_CD != 'X' )" ).append("\n"); 
		query.append("                                                                 AND ACT_STS_MAPG_CD = 'OC'" ).append("\n"); 
		query.append("                                                                                               ) AS POR_GATE_IN_DT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("									( SELECT MIN(TO_CHAR(CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI'))" ).append("\n"); 
		query.append("										FROM CTM_MOVEMENT" ).append("\n"); 
		query.append("									   WHERE BKG_NO IS NOT NULL" ).append("\n"); 
		query.append("										AND CNTR_NO	= CNTR.CNTR_NO" ).append("\n"); 
		query.append("										AND CNMV_CYC_NO = ( SELECT MAX(CNMV_CYC_NO) " ).append("\n"); 
		query.append("                                							FROM BKG_CONTAINER" ).append("\n"); 
		query.append("                                  							WHERE BKG_NO = CNTR.BKG_NO" ).append("\n"); 
		query.append("                                  							AND CNTR_NO =  CNTR.CNTR_NO )" ).append("\n"); 
		query.append("										AND MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("									) MT_RETURN_DT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT NVL(DEL_ARR_DT,POD_ARR_DT)" ).append("\n"); 
		query.append("                                       FROM BKG_ARR_NTC A" ).append("\n"); 
		query.append("                                       WHERE A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS DEL_ETA_DT," ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                    ( SELECT REF_NO" ).append("\n"); 
		query.append("                                       FROM BKG_CUSTOMER A" ).append("\n"); 
		query.append("                                       WHERE A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                       AND A.BKG_CUST_TP_CD ='E'" ).append("\n"); 
		query.append("                                    ) AS EXPORT_REF_NO," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    (SELECT S2.YD_CSTMS_NO" ).append("\n"); 
		query.append("                                       FROM BKG_BOOKING S1, MDM_YARD S2" ).append("\n"); 
		query.append("                                      WHERE S1.BKG_NO        = B.BKG_NO   " ).append("\n"); 
		query.append("                                        AND S1.POD_NOD_CD  = S2.YD_CD(+)" ).append("\n"); 
		query.append("                                    ) AS FIRMS_CODE,  " ).append("\n"); 
		query.append("                                     CNTR.BKG_NO   AS CBKG_NO," ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("                                        SELECT TO_CHAR(MAX(" ).append("\n"); 
		query.append("                                                           DECODE(NTC_VIA_CD,'F',NVL((SELECT XPT_DT FROM COM_FAX_SND_INFO WHERE FAX_SND_NO = SND_ID),NVL((SELECT UPD_DT FROM COM_FAX_SND_INFO WHERE FAX_SND_NO = SND_ID),SND_RQST_DT))" ).append("\n"); 
		query.append("                                                                                ,NVL((SELECT EML_DT FROM COM_EML_SND_INFO WHERE EML_SND_NO = SND_ID),SND_RQST_DT)" ).append("\n"); 
		query.append("                                                                 )" ).append("\n"); 
		query.append("                                                          ),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM   BKG_NTC_HIS" ).append("\n"); 
		query.append("                                        WHERE  NTC_VIA_CD IN ('F','M')" ).append("\n"); 
		query.append("                                        AND    NTC_KND_CD = 'BK'" ).append("\n"); 
		query.append("                                        AND    BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS BKG_RCT_SND_DT_FAX," ).append("\n"); 
		query.append("								    (" ).append("\n"); 
		query.append("                                        SELECT TO_CHAR(MAX(" ).append("\n"); 
		query.append("                                                           DECODE(NTC_VIA_CD,'F',NVL((SELECT XPT_DT FROM COM_FAX_SND_INFO WHERE FAX_SND_NO = SND_ID),NVL((SELECT UPD_DT FROM COM_FAX_SND_INFO WHERE FAX_SND_NO = SND_ID),SND_RQST_DT))" ).append("\n"); 
		query.append("                                                                                ,NVL((SELECT EML_DT FROM COM_EML_SND_INFO WHERE EML_SND_NO = SND_ID),SND_RQST_DT)" ).append("\n"); 
		query.append("                                                                 )" ).append("\n"); 
		query.append("                                                          ),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM   BKG_NTC_HIS" ).append("\n"); 
		query.append("                                        WHERE  NTC_VIA_CD IN ('F','M')" ).append("\n"); 
		query.append("                                        AND    NTC_KND_CD = 'BL'" ).append("\n"); 
		query.append("                                        AND    BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS DBL_SND_DT_FAX," ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("                                        SELECT TO_CHAR(MAX(" ).append("\n"); 
		query.append("                                                           DECODE(NTC_VIA_CD,'F',NVL((SELECT XPT_DT FROM COM_FAX_SND_INFO WHERE FAX_SND_NO = SND_ID),NVL((SELECT UPD_DT FROM COM_FAX_SND_INFO WHERE FAX_SND_NO = SND_ID),SND_RQST_DT))" ).append("\n"); 
		query.append("                                                                                ,NVL((SELECT EML_DT FROM COM_EML_SND_INFO WHERE EML_SND_NO = SND_ID),SND_RQST_DT)" ).append("\n"); 
		query.append("                                                                 )" ).append("\n"); 
		query.append("                                                          ),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM   BKG_NTC_HIS" ).append("\n"); 
		query.append("                                        WHERE  NTC_VIA_CD IN ('F','M')" ).append("\n"); 
		query.append("                                        AND    NTC_KND_CD = 'WB'" ).append("\n"); 
		query.append("                                        AND    BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS WBL_SND_DT_FAX," ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("                                        SELECT TO_CHAR(MAX(SND_RQST_DT), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM   BKG_NTC_HIS" ).append("\n"); 
		query.append("                                        WHERE  NTC_VIA_CD = 'E'" ).append("\n"); 
		query.append("                                        AND    NTC_KND_CD = 'BL'" ).append("\n"); 
		query.append("                                        AND    BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS DBL_SND_DT_EDI," ).append("\n"); 
		query.append("                                    (" ).append("\n"); 
		query.append("                                        SELECT TO_CHAR(MAX(SND_RQST_DT), 'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                        FROM   BKG_NTC_HIS" ).append("\n"); 
		query.append("                                        WHERE  NTC_VIA_CD = 'E'" ).append("\n"); 
		query.append("                                        AND    NTC_KND_CD = 'BK'" ).append("\n"); 
		query.append("                                        AND    BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                                    ) AS BKG_RCT_SND_DT_EDI," ).append("\n"); 
		query.append("									(" ).append("\n"); 
		query.append("										SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD hh24:mi')" ).append("\n"); 
		query.append("										FROM SCE_EDI_SND_RSLT A" ).append("\n"); 
		query.append("										WHERE EDI_STS_CD = 'UVD'" ).append("\n"); 
		query.append("  										AND A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("  										AND A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("									) AS UVD_MAX_ACT_DT," ).append("\n"); 
		query.append("									(" ).append("\n"); 
		query.append("										SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD hh24:mi')" ).append("\n"); 
		query.append("										FROM SCE_EDI_SND_RSLT A" ).append("\n"); 
		query.append("										WHERE EDI_STS_CD = 'RLN'" ).append("\n"); 
		query.append("  										AND A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("  										AND A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("									) AS RLN_MAX_ACT_DT," ).append("\n"); 
		query.append("									(" ).append("\n"); 
		query.append("										SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD hh24:mi')" ).append("\n"); 
		query.append("										FROM SCE_EDI_SND_RSLT A" ).append("\n"); 
		query.append("										WHERE EDI_STS_CD = 'URN'" ).append("\n"); 
		query.append("  										AND A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("  										AND A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("									) AS URN_MAX_ACT_DT," ).append("\n"); 
		query.append("									(" ).append("\n"); 
		query.append("										SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD hh24:mi')" ).append("\n"); 
		query.append("										FROM SCE_EDI_SND_RSLT A " ).append("\n"); 
		query.append("										WHERE EDI_STS_CD = 'OAN'" ).append("\n"); 
		query.append("  										AND A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("  										AND A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("									) AS OAN_MAX_ACT_DT," ).append("\n"); 
		query.append("									(" ).append("\n"); 
		query.append("										SELECT TO_CHAR(MAX(ACT_DT),'YYYY-MM-DD hh24:mi')" ).append("\n"); 
		query.append("										FROM SCE_EDI_SND_RSLT A " ).append("\n"); 
		query.append("										WHERE EDI_STS_CD = 'D'" ).append("\n"); 
		query.append("  										AND A.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("  										AND A.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("									) AS D_MAX_ACT_DT," ).append("\n"); 
		query.append("									NVL((" ).append("\n"); 
		query.append("										SELECT 'Y' " ).append("\n"); 
		query.append("          								FROM BKG_INET_BL_PRN_AUTH A" ).append("\n"); 
		query.append("          								WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("          								AND DELT_FLG ='N' " ).append("\n"); 
		query.append("          								AND N1ST_PRN_DT IS NOT NULL" ).append("\n"); 
		query.append("          								AND AUTH_DT = (SELECT MAX(AUTH_DT) FROM  BKG_INET_BL_PRN_AUTH WHERE BKG_NO = A.BKG_NO AND DELT_FLG ='N' AND N1ST_PRN_DT IS NOT NULL )  " ).append("\n"); 
		query.append("        							),'N') AS WEB_PRT" ).append("\n"); 
		query.append("									, D.FNL_DEST_NM" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("									/* 2014.11.20 VIP Customer Report에 Unloaded at POD / I/B Outgate item option 추가 요청 */" ).append("\n"); 
		query.append("									,( SELECT TO_CHAR(MAX(DTL.ACT_DT),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                         FROM SCE_COP_HDR HDR" ).append("\n"); 
		query.append("                                            , SCE_COP_DTL DTL" ).append("\n"); 
		query.append("                                        WHERE HDR.BKG_NO  = B.BKG_NO" ).append("\n"); 
		query.append("                                          AND HDR.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                          AND HDR.COP_NO  = DTL.COP_NO" ).append("\n"); 
		query.append("                                          AND DTL.STND_EDI_STS_CD = 'UVD'" ).append("\n"); 
		query.append("                                          AND HDR.COP_STS_CD <> 'X'" ).append("\n"); 
		query.append("                                    ) AS UVD_MAX_ACT_DT2 /* Unloaded at POD(CTM) */   " ).append("\n"); 
		query.append("								  ,( SELECT TO_CHAR(MAX(DTL.ACT_DT),'YYYY-MM-DD HH24:MI')" ).append("\n"); 
		query.append("                                         FROM SCE_COP_HDR HDR" ).append("\n"); 
		query.append("                                            , SCE_COP_DTL DTL" ).append("\n"); 
		query.append("                                        WHERE HDR.BKG_NO  = B.BKG_NO" ).append("\n"); 
		query.append("                                          AND HDR.CNTR_NO = CNTR.CNTR_NO" ).append("\n"); 
		query.append("                                          AND HDR.COP_NO  = DTL.COP_NO" ).append("\n"); 
		query.append("                                          AND DTL.STND_EDI_STS_CD = 'OAN'  " ).append("\n"); 
		query.append("                                          AND HDR.COP_STS_CD <> 'X'" ).append("\n"); 
		query.append("                                    ) AS OAN_MAX_ACT_DT2 /* IB OUTGATE(CTM) */" ).append("\n"); 
		query.append("                                       ,TO_CHAR (OVR.PRE_ETA_DT,'YYYY-MM-DD HH24:MI')  INIT_POL_ETA_DT                                " ).append("\n"); 
		query.append("                                       ,TO_CHAR (OVR.PRE_ETD_DT,'YYYY-MM-DD HH24:MI') INIT_POL_ETD_DT " ).append("\n"); 
		query.append("                                       ,TO_CHAR (OVR.PRE_BKG_POD_ETA_DT, 'YYYY-MM-DD HH24:MI') INIT_POD_ETA_DT" ).append("\n"); 
		query.append("                                       , BR.CUST_REF_NO_CTNT LOAD_ID" ).append("\n"); 
		query.append("									   ,CNTR.VGM_WGT AS VGM_WGT" ).append("\n"); 
		query.append("                                       ,CNTR.VGM_WGT_UT_CD AS VGM_WGT_UT_CD" ).append("\n"); 
		query.append("                                       ,CNTR.VGM_VRFY_SIG_CTNT AS VGM_VRFY_SIG_CTNT" ).append("\n"); 
		query.append("                                       ,CNTR.VGM_MZD_TP_CD AS VGM_MZD_TP_CD" ).append("\n"); 
		query.append("                                     FROM BKG_BOOKING B, BKG_CONTAINER CNTR, MDM_COMMODITY K, BKG_BL_DOC D, BKG_RATE R," ).append("\n"); 
		query.append("                                          BKG_VVD E, VSK_VSL_PORT_SKD F, VSK_VSL_PORT_SKD G, BKG_BL_ISS H, MDM_REP_CMDT L, BKG_REF_DTL J," ).append("\n"); 
		query.append("                                          BKG_CUSTOMER C , BKG_ROLL_OVR OVR" ).append("\n"); 
		query.append("                                          ,BKG_REFERENCE BR" ).append("\n"); 
		query.append("#if( ${gcust} != '')" ).append("\n"); 
		query.append("                                           /* GCUST*/" ).append("\n"); 
		query.append("                                         ,(  SELECT BKG_NO" ).append("\n"); 
		query.append("                                             FROM   BKG_BOOKING" ).append("\n"); 
		query.append("                                             WHERE  RFA_NO IN (  SELECT RFA_NO" ).append("\n"); 
		query.append("                                                                 FROM   PRI_RP_HDR" ).append("\n"); 
		query.append("                                                                 WHERE  PROP_NO IN (" ).append("\n"); 
		query.append("                                                                                      SELECT DISTINCT PROP_NO" ).append("\n"); 
		query.append("                                                                                      FROM   PRI_RP_MN" ).append("\n"); 
		query.append("                                                                                      WHERE  (CTRT_CUST_CNT_CD,CTRT_CUST_SEQ ) IN (  SELECT DISTINCT CUST_CNT_CD,CUST_SEQ " ).append("\n"); 
		query.append("                                                                                                                                     FROM   MDM_CUSTOMER" ).append("\n"); 
		query.append("                                                                                                                                     WHERE  CUST_GRP_ID = @[gcust]" ).append("\n"); 
		query.append("                                                                                                                                  )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                                                      AND    PROP_STS_CD = 'A'" ).append("\n"); 
		query.append("                                                                                   )" ).append("\n"); 
		query.append("                                                              )" ).append("\n"); 
		query.append("                                             UNION" ).append("\n"); 
		query.append("                                             SELECT BKG_NO" ).append("\n"); 
		query.append("                                             FROM   BKG_BOOKING" ).append("\n"); 
		query.append("                                             WHERE  TAA_NO IN (  SELECT TAA_NO" ).append("\n"); 
		query.append("                                                                 FROM   PRI_TAA_HDR" ).append("\n"); 
		query.append("                                                                 WHERE  TAA_PROP_NO IN (" ).append("\n"); 
		query.append("                                                                                          SELECT DISTINCT TAA_PROP_NO" ).append("\n"); 
		query.append("                                                                                          FROM   PRI_TAA_MN" ).append("\n"); 
		query.append("                                                                                          WHERE  (CTRT_CUST_CNT_CD,CTRT_CUST_SEQ ) IN (  SELECT DISTINCT CUST_CNT_CD,CUST_SEQ " ).append("\n"); 
		query.append("                                                                                                                                         FROM   MDM_CUSTOMER" ).append("\n"); 
		query.append("                                                                                                                                         WHERE  CUST_GRP_ID = @[gcust]" ).append("\n"); 
		query.append("                                                                                                                                      )" ).append("\n"); 
		query.append("                                                                                          AND    CFM_FLG = 'Y'" ).append("\n"); 
		query.append("                                                                                       )" ).append("\n"); 
		query.append("                                                              )" ).append("\n"); 
		query.append("                                             UNION" ).append("\n"); 
		query.append("                                             SELECT BKG_NO" ).append("\n"); 
		query.append("                                             FROM   BKG_BOOKING" ).append("\n"); 
		query.append("                                             WHERE  SC_NO IN (  SELECT SC_NO" ).append("\n"); 
		query.append("                                                                FROM   PRI_SP_HDR" ).append("\n"); 
		query.append("                                                                WHERE  PROP_NO IN (" ).append("\n"); 
		query.append("                                                                                     SELECT DISTINCT PROP_NO" ).append("\n"); 
		query.append("                                                                                     FROM   PRI_SP_MN" ).append("\n"); 
		query.append("                                                                                     WHERE  PROP_NO IN (" ).append("\n"); 
		query.append("                                                                                                          SELECT DISTINCT PROP_NO" ).append("\n"); 
		query.append("                                                                                                          FROM   PRI_SP_CTRT_PTY" ).append("\n"); 
		query.append("                                                                                                          WHERE  (CUST_CNT_CD,CUST_SEQ ) IN (  SELECT DISTINCT CUST_CNT_CD,CUST_SEQ " ).append("\n"); 
		query.append("                                                                                                                                                 FROM   MDM_CUSTOMER" ).append("\n"); 
		query.append("                                                                                                                                                WHERE  CUST_GRP_ID = @[gcust]" ).append("\n"); 
		query.append("                                                                                                                                                      )" ).append("\n"); 
		query.append("                                                                                                          AND    PRC_CTRT_PTY_TP_CD = 'C'" ).append("\n"); 
		query.append("                                                                                                       )" ).append("\n"); 
		query.append("                                                                                     AND PROP_STS_CD = 'F'" ).append("\n"); 
		query.append("                                                                                  )" ).append("\n"); 
		query.append("                                                             )" ).append("\n"); 
		query.append("                                           ) GRP_CUST" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                     WHERE B.BKG_STS_CD <>'X'" ).append("\n"); 
		query.append("                                       AND B.BKG_CGO_TP_CD <>'P'" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = CNTR.BKG_NO" ).append("\n"); 
		query.append("#if( ${gcust} != '')" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = GRP_CUST.BKG_NO" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = D.BKG_NO" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = R.BKG_NO" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = E.BKG_NO" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = C.BKG_NO" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = H.BKG_NO(+)" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = J.BKG_NO(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       AND CNTR.BKG_NO = BR.BKG_NO(+) " ).append("\n"); 
		query.append("                                       AND BR. BKG_REF_TP_CD(+)='MSLD'" ).append("\n"); 
		query.append("                                       AND CNTR.CNTR_NO = BR.CNTR_NO(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       AND B.CMDT_CD = K.CMDT_CD" ).append("\n"); 
		query.append("                                       AND B.REP_CMDT_CD = L.REP_CMDT_CD" ).append("\n"); 
		query.append("                                       AND C.BKG_CUST_TP_CD IN ('S','C','E','N','F')" ).append("\n"); 
		query.append("                                       AND F.VSL_CD(+) = E.VSL_CD" ).append("\n"); 
		query.append("                                       AND F.SKD_VOY_NO(+) = E.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND F.SKD_DIR_CD(+) = E.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND G.VSL_CD(+) = E.VSL_CD" ).append("\n"); 
		query.append("                                       AND G.SKD_VOY_NO(+) = E.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND G.SKD_DIR_CD(+) = E.SKD_DIR_CD" ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("                                       /* I/B O/B VPS_ETD_DT*/" ).append("\n"); 
		query.append("			                	       #if( ${in_out_cd} == 'IN')" ).append("\n"); 
		query.append("			                	         /* I/B VPS_ETD_DT*/" ).append("\n"); 
		query.append("				                         #if( ${vps_eta_dt} != '')" ).append("\n"); 
		query.append("										 AND B.POD_CD = E.POD_CD" ).append("\n"); 
		query.append("										 AND G.VPS_PORT_CD(+) = E.POD_CD  " ).append("\n"); 
		query.append("			                	         AND G.CLPT_IND_SEQ(+) = E.POD_CLPT_IND_SEQ " ).append("\n"); 
		query.append("   				                         AND G.VPS_ETA_DT >= TO_DATE(@[vps_eta_dt],'YYYY-MM-DD')" ).append("\n"); 
		query.append("				                		 #end" ).append("\n"); 
		query.append("					                	 #if( ${vps_etd_dt} != '')" ).append("\n"); 
		query.append("				                         AND G.VPS_ETA_DT <= TO_DATE(@[vps_etd_dt],'YYYY-MM-DD') +0.99999" ).append("\n"); 
		query.append("					                	 #end" ).append("\n"); 
		query.append("                                       #else" ).append("\n"); 
		query.append("                                         /* O/B VPS_ETD_DT*/" ).append("\n"); 
		query.append("				                         #if( ${vps_eta_dt} != '')" ).append("\n"); 
		query.append("										 AND B.POL_CD = E.POL_CD" ).append("\n"); 
		query.append("										 AND F.VPS_PORT_CD(+) = E.POL_CD  " ).append("\n"); 
		query.append("			                	         AND F.CLPT_IND_SEQ(+) = E.POL_CLPT_IND_SEQ " ).append("\n"); 
		query.append("   				                         AND F.VPS_ETD_DT >= TO_DATE(@[vps_eta_dt],'YYYY-MM-DD')" ).append("\n"); 
		query.append("					                     #end" ).append("\n"); 
		query.append("						                 #if( ${vps_etd_dt} != '')" ).append("\n"); 
		query.append("				                         AND F.VPS_ETD_DT <= TO_DATE(@[vps_etd_dt],'YYYY-MM-DD') +0.99999" ).append("\n"); 
		query.append("						                 #end" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                                  " ).append("\n"); 
		query.append("                                       /* VVD_CD CRWI0142E AEF58888*/" ).append("\n"); 
		query.append("				                       #if( ${vvd_cd} != '')" ).append("\n"); 
		query.append("                                       AND B.VSL_CD     = SUBSTR(@[vvd_cd], 1, 4)" ).append("\n"); 
		query.append("                                       AND B.SKD_VOY_NO = SUBSTR(@[vvd_cd], 5, 4)" ).append("\n"); 
		query.append("                                       AND B.SKD_DIR_CD = SUBSTR(@[vvd_cd], 9, 1)       " ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("                                                         " ).append("\n"); 
		query.append("                                         " ).append("\n"); 
		query.append("                                       /* POL_CD*/" ).append("\n"); 
		query.append("                				       #if( ${pol_cd} != '')" ).append("\n"); 
		query.append("                                       AND B.POL_CD LIKE @[pol_cd]||'%'" ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       /* POL_YARD_CD */" ).append("\n"); 
		query.append("                				       #if( ${pol_yard_cd} != '')" ).append("\n"); 
		query.append("                                       AND SUBSTR(B.POL_NOD_CD, -2) = @[pol_yard_cd]" ).append("\n"); 
		query.append("                				       #end" ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                       /* POD_CD*/" ).append("\n"); 
		query.append("				                       #if( ${pod_cd} != '')" ).append("\n"); 
		query.append("                                       AND B.POD_CD LIKE @[pod_cd]||'%'" ).append("\n"); 
		query.append("                				       #end" ).append("\n"); 
		query.append("                                                       " ).append("\n"); 
		query.append("                                       /* POD_YARD_CD */" ).append("\n"); 
		query.append("                				       #if( ${pod_yard_cd} != '')" ).append("\n"); 
		query.append("                                       AND SUBSTR(B.POD_NOD_CD, -2) = @[pod_yard_cd]" ).append("\n"); 
		query.append("                				       #end" ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("                                       /* POR_CD*/" ).append("\n"); 
		query.append("                				       #if( ${por_cd} != '')" ).append("\n"); 
		query.append("                                       AND B.POR_CD LIKE @[por_cd]||'%'" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       /* DEL_CD*/" ).append("\n"); 
		query.append("				                       #if( ${del_cd} != '')" ).append("\n"); 
		query.append("                                       AND B.DEL_CD LIKE @[del_cd]||'%'" ).append("\n"); 
		query.append("                				       #end" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       #if( ${sc_no} != '' || ${rfa_no} != '' || ${taa_no} != '' )" ).append("\n"); 
		query.append("                                       AND (     1 = 0" ).append("\n"); 
		query.append("                                             /* SC_NO*/" ).append("\n"); 
		query.append("                                             #if( ${sc_no} != '')" ).append("\n"); 
		query.append("                                             OR  B.SC_NO = @[sc_no]" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                               " ).append("\n"); 
		query.append("                                             /* RFA_NO*/" ).append("\n"); 
		query.append("                                             #if( ${rfa_no} != '')" ).append("\n"); 
		query.append("                                             OR  B.RFA_NO = @[rfa_no]" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                               " ).append("\n"); 
		query.append("                                             /* TAA_NO*/" ).append("\n"); 
		query.append("                                             #if( ${taa_no} != '')" ).append("\n"); 
		query.append("                                             OR  B.TAA_NO = @[taa_no]" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                           )" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("                                       /* CUST_TP_CD*/" ).append("\n"); 
		query.append("                				       #if( ${cust_tp_cd} != '')" ).append("\n"); 
		query.append("                				       AND C.BKG_CUST_TP_CD IN (${cust_tp_cd})" ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("				                       /* CUST_CNT_CD */" ).append("\n"); 
		query.append("				                       #if( ${cust_cnt_cd} != '')" ).append("\n"); 
		query.append("                                       AND C.CUST_CNT_CD = @[cust_cnt_cd]" ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       /* CUST_SEQ */" ).append("\n"); 
		query.append("				                       #if( ${cust_seq} != '')" ).append("\n"); 
		query.append("                                       AND C.CUST_SEQ = @[cust_seq]" ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       /* CUST_NM */" ).append("\n"); 
		query.append("				                       #if( ${cust_nm} != '')" ).append("\n"); 
		query.append("                                       AND C.CUST_NM LIKE '%'||@[cust_nm]||'%'" ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("				                       /* EDI ID */" ).append("\n"); 
		query.append("				                       #if( ${edi_id} != '')" ).append("\n"); 
		query.append("										AND EXISTS ( SELECT 'Y'" ).append("\n"); 
		query.append("                                                 FROM EDI_GROUP AA, EDI_GRP_CUST BB" ).append("\n"); 
		query.append("                                                WHERE AA.EDI_GRP_CD = BB.EDI_GRP_CD" ).append("\n"); 
		query.append("                                                  AND AA.DELT_FLG ='N'" ).append("\n"); 
		query.append("                                                  AND AA.EDI_GRP_CD = @[edi_id]" ).append("\n"); 
		query.append("                                                  AND AA.CO_DIV_CD = BB.CO_DIV_CD" ).append("\n"); 
		query.append("                                                  AND AA.CO_DIV_CD ='SML'" ).append("\n"); 
		query.append("                                                  AND ( DECODE(BB.BKG_CTRT_DIV_CD,'1',SC_NO)  IN (B.SC_NO,B.RFA_NO)" ).append("\n"); 
		query.append("                                                        OR DECODE(BB.BKG_CTRT_DIV_CD,'1',NULL,BB.CUST_CNT_CD||BB.CUST_SEQ )  = C.CUST_CNT_CD||C.CUST_SEQ " ).append("\n"); 
		query.append("                                                      )" ).append("\n"); 
		query.append("                                                  )" ).append("\n"); 
		query.append("				                       #end" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       /* A/Customer */" ).append("\n"); 
		query.append("				                       #if( ${agmt_act_cnt_cd} != '' )" ).append("\n"); 
		query.append("                                        AND B.AGMT_ACT_CNT_CD = @[agmt_act_cnt_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if( ${agmt_act_cust_seq} != '' )" ).append("\n"); 
		query.append("                                        AND B.AGMT_ACT_CUST_SEQ = TO_NUMBER(@[agmt_act_cust_seq])" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("										/* CHM-201639822 WMS Multi PO 옵션 2016-01-15  */" ).append("\n"); 
		query.append("				                       #if( ${wms_multi_po} != '' )" ).append("\n"); 
		query.append("										AND EXISTS ( SELECT 'Y'" ).append("\n"); 
		query.append("										               FROM BKG_BL_MK_DESC MK" ).append("\n"); 
		query.append("										              WHERE MK.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("										                AND (   INSTR(MK.CMDT_DESC,'PO NO',1,2)                 > 0" ).append("\n"); 
		query.append("										                     OR INSTR(MK.CMDT_DESC,'PO#',1,2)                   > 0 " ).append("\n"); 
		query.append("										                     OR INSTR(MK.CMDT_DESC,'PURCHASE ORDER NO',1,2)     > 0 " ).append("\n"); 
		query.append("										                     OR INSTR(MK.CMDT_DESC,'PURCHASE ORDER NUMBER',1,2) > 0 " ).append("\n"); 
		query.append("										                     OR INSTR(MK.CMDT_DESC,'REPACK',1,1)                > 0" ).append("\n"); 
		query.append("										                     )                        " ).append("\n"); 
		query.append("										             )" ).append("\n"); 
		query.append("									" ).append("\n"); 
		query.append("									   #end" ).append("\n"); 
		query.append("                                       AND B.BKG_NO = OVR.BKG_NO" ).append("\n"); 
		query.append("                                       AND OVR.ROLL_OVR_SEQ = (SELECT MAX(ROLL_OVR_SEQ) FROM BKG_ROLL_OVR RR WHERE B.BKG_NO = RR.BKG_NO )" ).append("\n"); 
		query.append("                                       " ).append("\n"); 
		query.append("                                       /* CHM-201640759 Split01-VIP Report에 조회 옵션 추가 _initial POL ETAPOL ETDPOD ETA_ BKG 생성 시점 및 VVD 변경 시점 기준*/" ).append("\n"); 
		query.append("									   #if( ${init_dt_fm} != '' && ${init_dt_to} != '')" ).append("\n"); 
		query.append("                                         #if( ${init_pol_pod_cd} =='A') --PRE_ETD_DT NEW_ETD_DT NEW_ETA_DT NEW_BKG_POD_ETA_DT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                            AND PRE_ETA_DT >= TO_DATE(@[init_dt_fm], 'YYYY-MM-DD')" ).append("\n"); 
		query.append("                                            AND PRE_ETA_DT <= TO_DATE(@[init_dt_to], 'YYYY-MM-DD') +0.99999 " ).append("\n"); 
		query.append("                                         #end" ).append("\n"); 
		query.append("                                         #if( ${init_pol_pod_cd} =='B') --PRE_ETD_DT NEW_ETD_DT NEW_ETA_DT NEW_BKG_POD_ETA_DT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                            AND PRE_ETD_DT >= TO_DATE(@[init_dt_fm], 'YYYY-MM-DD')" ).append("\n"); 
		query.append("                                            AND PRE_ETD_DT <= TO_DATE(@[init_dt_to], 'YYYY-MM-DD') +0.99999 " ).append("\n"); 
		query.append("                                         #end" ).append("\n"); 
		query.append("                                         #if( ${init_pol_pod_cd} =='C') --PRE_ETD_DT NEW_ETD_DT NEW_ETA_DT NEW_BKG_POD_ETA_DT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                            AND PRE_BKG_POD_ETA_DT >= TO_DATE(@[init_dt_fm], 'YYYY-MM-DD')" ).append("\n"); 
		query.append("                                            AND PRE_BKG_POD_ETA_DT <= TO_DATE(@[init_dt_to], 'YYYY-MM-DD') +0.99999 " ).append("\n"); 
		query.append("                                         #end" ).append("\n"); 
		query.append("                                       #end	" ).append("\n"); 
		query.append("                                   GROUP BY   B.BKG_NO," ).append("\n"); 
		query.append("                                    CNTR.CNTR_NO," ).append("\n"); 
		query.append("                                    CNMV_CYC_NO," ).append("\n"); 
		query.append("                                    B.BKG_OFC_CD," ).append("\n"); 
		query.append("                                    B.BL_NO," ).append("\n"); 
		query.append("                                    B.VSL_CD ," ).append("\n"); 
		query.append("                                    B.SKD_VOY_NO ," ).append("\n"); 
		query.append("                                    B.SKD_DIR_CD ," ).append("\n"); 
		query.append("                                    B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD," ).append("\n"); 
		query.append("                                    B.POR_CD," ).append("\n"); 
		query.append("                                    B.POL_CD," ).append("\n"); 
		query.append("                                    B.POD_CD," ).append("\n"); 
		query.append("                                    B.DEL_CD," ).append("\n"); 
		query.append("                                    B.XTER_RMK," ).append("\n"); 
		query.append("                                    B.PRE_RLY_PORT_CD," ).append("\n"); 
		query.append("                                    B.PST_RLY_PORT_CD," ).append("\n"); 
		query.append("                                    B.CMDT_CD," ).append("\n"); 
		query.append("                                    D.PCK_QTY," ).append("\n"); 
		query.append("                                    D.PCK_TP_CD,    " ).append("\n"); 
		query.append("                                    B.REP_CMDT_CD," ).append("\n"); 
		query.append("                                    L.REP_CMDT_NM, " ).append("\n"); 
		query.append("                                    D.ACT_WGT,   " ).append("\n"); 
		query.append("                                    D.MEAS_QTY,  " ).append("\n"); 
		query.append("                                    B.RCV_TERM_CD," ).append("\n"); 
		query.append("                                    B.DE_TERM_CD," ).append("\n"); 
		query.append("                                    B.SLAN_CD," ).append("\n"); 
		query.append("                                    B.SCAC_CD," ).append("\n"); 
		query.append("                                    H.OBL_ISS_OFC_CD, " ).append("\n"); 
		query.append("                                    H.OBL_ISS_DT," ).append("\n"); 
		query.append("                                    D.BL_OBRD_DT," ).append("\n"); 
		query.append("									B.SVC_SCP_CD," ).append("\n"); 
		query.append("                                    D.VSL_NM," ).append("\n"); 
		query.append("                                    D.POR_NM," ).append("\n"); 
		query.append("                                    D.POL_NM," ).append("\n"); 
		query.append("                                    D.POD_NM," ).append("\n"); 
		query.append("                                    D.DEL_NM," ).append("\n"); 
		query.append("                                    B.SC_NO," ).append("\n"); 
		query.append("                                    R.PPD_RCV_OFC_CD,  " ).append("\n"); 
		query.append("                                    R.CLT_OFC_CD," ).append("\n"); 
		query.append("                                    D.CSTMS_DESC," ).append("\n"); 
		query.append("                                    B.USA_CSTMS_FILE_CD," ).append("\n"); 
		query.append("                                    B.CND_CSTMS_FILE_CD,  " ).append("\n"); 
		query.append("                                    CNTR.CNTR_WGT," ).append("\n"); 
		query.append("                                    CNTR.WGT_UT_CD," ).append("\n"); 
		query.append("                                    CNTR.MEAS_QTY," ).append("\n"); 
		query.append("                                    CNTR.MEAS_UT_CD," ).append("\n"); 
		query.append("                                    CNTR.CNTR_TPSZ_CD," ).append("\n"); 
		query.append("                                    CNTR.CNTR_VOL_QTY," ).append("\n"); 
		query.append("                                    CNTR.DCGO_FLG," ).append("\n"); 
		query.append("                                    CNTR.BB_CGO_FLG," ).append("\n"); 
		query.append("                                    CNTR.AWK_CGO_FLG," ).append("\n"); 
		query.append("                                    CNTR.RC_FLG," ).append("\n"); 
		query.append("                                    CNTR.RD_CGO_FLG," ).append("\n"); 
		query.append("                                    CNTR.SOC_FLG," ).append("\n"); 
		query.append("                                    CNTR.PCK_QTY," ).append("\n"); 
		query.append("                                    CNTR.PCK_TP_CD," ).append("\n"); 
		query.append("                                    CNTR.CNTR_PRT_FLG," ).append("\n"); 
		query.append("                                    CNTR.PO_NO," ).append("\n"); 
		query.append("                                    J.DE_NO," ).append("\n"); 
		query.append("                                    J.PRT_NO," ).append("\n"); 
		query.append("                                    D.BDR_FLG," ).append("\n"); 
		query.append("                                    B.POR_CD," ).append("\n"); 
		query.append("                                    B.DEL_CD," ).append("\n"); 
		query.append("                                    R.CGO_RCV_DT," ).append("\n"); 
		query.append("                                    B.AGMT_ACT_CNT_CD," ).append("\n"); 
		query.append("                                    B.AGMT_ACT_CUST_SEQ," ).append("\n"); 
		query.append("									CNTR.BKG_NO, D.MEAS_QTY, D.MEAS_UT_CD, D.WGT_UT_CD, B.RFA_NO" ).append("\n"); 
		query.append("									,D.FNL_DEST_NM" ).append("\n"); 
		query.append("	                                ,OVR.PRE_ETA_DT                                  " ).append("\n"); 
		query.append("                                    ,OVR.PRE_ETD_DT --WORK PRE_VSL_CD PRE_ETD_DT  PRE_ETA_DT PRE_BKG_POD_ETA_DT" ).append("\n"); 
		query.append("                                    ,OVR.PRE_BKG_POD_ETA_DT" ).append("\n"); 
		query.append("                                    ,CUST_REF_NO_CTNT" ).append("\n"); 
		query.append("									,CNTR.VGM_WGT" ).append("\n"); 
		query.append("                                    ,CNTR.VGM_WGT_UT_CD" ).append("\n"); 
		query.append("                                    ,CNTR.VGM_VRFY_SIG_CTNT" ).append("\n"); 
		query.append("                                    ,CNTR.VGM_MZD_TP_CD" ).append("\n"); 
		query.append("                            ) X" ).append("\n"); 
		query.append("                    WHERE 1=1" ).append("\n"); 
		query.append("                    /* EQ Office*/ " ).append("\n"); 
		query.append("                    #if( ${eq_ofc_cd} != '')" ).append("\n"); 
		query.append("                    AND X.EQ_CTRL_OFC = @[eq_ofc_cd]" ).append("\n"); 
		query.append("                    #end" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("                    #if (${sp_cargo_rf} != '' || ${sp_cargo_dg} != '' || ${sp_cargo_ak} != '' || ${sp_cargo_bb} != '' )" ).append("\n"); 
		query.append("					AND X.SPC_CGO IN (@[sp_cargo_rf], @[sp_cargo_dg], @[sp_cargo_ak], @[sp_cargo_bb])					" ).append("\n"); 
		query.append("				    #end" ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append("                    ORDER BY BKG_NO" ).append("\n"); 
		query.append("                  ) Y" ).append("\n"); 
		query.append("                ) Y1" ).append("\n"); 
		query.append("            ) Y2" ).append("\n"); 
		query.append("       ) Z" ).append("\n"); 
		query.append(") XX" ).append("\n"); 
		query.append(") YY" ).append("\n"); 
		query.append("WHERE RNUM BETWEEN NVL(@[rows_per_page],50) * (NVL(@[curr_page],1) - 1) + 1" ).append("\n"); 
		query.append("           AND     NVL(@[rows_per_page],50) *  NVL(@[curr_page],1)" ).append("\n"); 

	}
}