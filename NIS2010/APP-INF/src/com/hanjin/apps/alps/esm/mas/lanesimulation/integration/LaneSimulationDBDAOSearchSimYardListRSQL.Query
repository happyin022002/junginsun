<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="LaneSimulationDBDAOSearchSimYardListRSQL">
			<desc><![CDATA[Yard 를 조회 한다.]]></desc>
			<sql><![CDATA[
SELECT SUBSTR(M.YD_CD,6,8) PORT_CY,M.YD_NM YD_NM,TRIM(N.PORT_TRF_AMT) PORT_USD_AMT
	   ,SUBSTR(M.YD_CD,6,8) CODE,  SUBSTR(M.YD_CD,6,8) || '	' || M.YD_NM || '	' || TRIM(N.PORT_TRF_AMT) AS NAME
FROM MDM_YARD M,
    (SELECT B1.TML_CD
            ,SUM(B1.PORT_TRF_AMT / DECODE(B1.CURR_CD, 'USD', 1, NVL(B2.USD_LOCL_XCH_RT, 0))) PORT_TRF_AMT
       FROM (SELECT
                A1.YD_CD           TML_CD
               ,A2.ACCT_CD         PORT_COST_CD
               ,A1.BSE_YR          COST_YR
               ,A1.CNTR_VSL_CLSS_CAPA     PORT_CLSS_CAPA
               ,A1.CURR_CD         CURR_CD
               ,A1.TTL_CHG_AMT     PORT_TRF_AMT
               ,RANK() OVER (PARTITION BY A1.YD_CD ORDER BY A1.CNTR_VSL_CLSS_CAPA DESC) NUM
             FROM PSO_VSL_CLSS_TRF A1
                 ,TES_LGS_COST A2
            WHERE A1.LGS_COST_CD = A2.LGS_COST_CD
            ) B1
           ,GL_MON_XCH_RT B2
       WHERE B1.COST_YR = TO_CHAR(SYSDATE,'YYYY')
         AND B1.CURR_CD            = B2.CURR_CD
         AND B2.ACCT_XCH_RT_LVL(+) = '1'
         AND B2.ACCT_XCH_RT_YRMON(+) = '200906' --TO_CHAR(SYSDATE,'YYYYMM')
         AND B1.NUM = 1
         AND SUBSTR(B1.TML_CD,0,5) = @[port_cd]
       GROUP BY DECODE(SUBSTR(B1.TML_CD, 1, 5)
              ,'EGSUZ', '53102000'
              ,'PAPAC', '53102000'
              ,DECODE(SUBSTR(B1.PORT_COST_CD, 1, 4), '5119', '53102000', '53101000')
       )
       ,B1.COST_YR
       ,B2.ACCT_XCH_RT_YRMON
       ,B1.PORT_CLSS_CAPA
       ,B1.TML_CD
       ,NVL(B2.USD_LOCL_XCH_RT, 0)) N
  WHERE M.YD_CD=N.TML_CD(+)
    AND DELT_FLG = 'N'
    AND YD_FCTY_TP_MRN_TML_FLG = 'Y'
    AND SUBSTR(YD_CD,0,5) = @[port_cd]
  UNION ALL 
  SELECT 'XX' PORT_CY,'NEW TERMIAL' YD_NM, '' PORT_USD_AMT, 'XX' AS CODE,'XX' || '	'||'NEW TERMIAL' || '	'||'' AS  NAME FROM DUAL			]]></sql>
			<params>
				<param name="port_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
