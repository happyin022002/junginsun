<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="NetworkCostDBDAOAverageUCVesselRSQL">
			<desc><![CDATA[AverageUCVessel]]></desc>
			<sql><![CDATA[
SELECT A.COST_YRMON
     , A.STND_COST_CD
     , A.VSL_CLSS_CAPA
     , A.VSL_CD
     , A.DHIR_AMT
     , A.VSL_KNT
     , B.PRE_DHIR_AMT
     , '' AS UPD_USR_ID
  FROM (
        SELECT COST_YRMON
             , STND_COST_CD
             , VSL_CLSS_CAPA
             , VSL_CD
             , DHIR_AMT
             , VSL_KNT
          FROM MAS_POOL_VSL_DLY_HIR
         WHERE VSL_CD = 'XXXX'
           AND COST_YRMON   = REPLACE(@[f_yearweek], '-', '')
           AND STND_COST_CD = @[f_cobcost]
#if(${f_selclass} != '')
           AND VSL_CLSS_CAPA = @[f_selclass]
#end
       ) A,
       (
        SELECT REPLACE(@[f_yearweek], '-', '') AS COST_YRMON
             , STND_COST_CD
             , VSL_CLSS_CAPA
             , VSL_CD
             , DHIR_AMT AS PRE_DHIR_AMT
             , VSL_KNT
          FROM MAS_POOL_VSL_DLY_HIR
         WHERE VSL_CD = 'XXXX'
           AND COST_YRMON   = TO_CHAR(ADD_MONTHS(TO_DATE(REPLACE(@[f_yearweek], '-', '')||'01','YYYYMMDD'), -1), 'YYYYMM')
           AND STND_COST_CD = @[f_cobcost]
#if(${f_selclass} != '')
           AND VSL_CLSS_CAPA = @[f_selclass]
#end
       ) B
 WHERE A.COST_YRMON   = B.COST_YRMON(+)
   AND A.STND_COST_CD = B.STND_COST_CD(+)
   AND A.VSL_CLSS_CAPA = B.VSL_CLSS_CAPA(+)
ORDER BY VSL_CLSS_CAPA ASC 			]]></sql>
			<params>
				<param name="f_yearweek" type="12" value="" out="N"/>
				<param name="f_cobcost" type="12" value="" out="N"/>
				<param name="f_selclass" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
