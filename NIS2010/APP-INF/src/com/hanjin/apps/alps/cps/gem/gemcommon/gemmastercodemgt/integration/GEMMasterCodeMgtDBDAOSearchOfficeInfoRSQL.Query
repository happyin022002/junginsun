<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GEMMasterCodeMgtDBDAOSearchOfficeInfoRSQL">
			<desc><![CDATA[select]]></desc>
			<sql><![CDATA[
SELECT A.OFC_CD OFC_CD
      ,A.OFC_ENG_NM OFC_ENG_NM
      ,A.CTR_CD CTR_CD
      ,A.AP_CTRL_OFC_CD AP_CTRL_OFC_CD
      ,A.GEN_EXPN_OFC_LVL GEN_EXPN_OFC_LVL
      ,A.PRNT_OFC_CD PRNT_OFC_CD
      ,A.RGN_OFC_FLG RGN_OFC_FLG
      ,A.SLS_OFC_FLG SLS_OFC_FLG
      ,A.OFC_CO_DIV_CD OFC_CO_DIV_CD
      ,A.LOCL_CURR_CD LOCL_CURR_CD
      ,A.RQST_UT_VAL RQST_UT_VAL
      ,DECODE(A.RQST_AUTH_FLG,'Y','1','0') RQST_AUTH_FLG
      ,DECODE(A.RHQ_AUTH_FLG,'Y','1','0') RHQ_AUTH_FLG
      ,DECODE(A.TIC_AUTH_FLG,'Y','1','0') TIC_AUTH_FLG
      ,DECODE(A.CMIT_AUTH_FLG,'Y','1','0') CMIT_AUTH_FLG
      ,A.EXPN_SMRY_OFC_CD EXPN_SMRY_OFC_CD
      ,TO_CHAR(TO_DATE(A.EXPN_SMRY_YRMON,'yyyy-MM'),'yyyy-MM') EXPN_SMRY_YRMON
      ,A.DELT_FLG DELT_FLG
      ,A.CRE_DT CRE_DT
      ,A.CRE_USR_ID CRE_USR_ID
      ,A.UPD_USR_ID UPD_USR_ID
      ,A.UPD_DT UPD_DT
	  ,(SELECT MAX (DECODE (EXP_DT, NULL, 1, 0)) CNT FROM GEM_OFC_HIS WHERE OFC_CD = A.OFC_CD) OFC_HIS_CNT
  FROM GEM_OFFICE A
 WHERE 1=1
#if(${sch_lvl1} != '' || ${sch_lvl2} != '' || ${sch_lvl3} != '')
   AND A.OFC_CD IN (   
        SELECT OFC_CD
          FROM GEM_OFFICE		   		
		   #if(${sch_lvl1} != '' && ${sch_lvl2} != '' && ${sch_lvl3} != '') START WITH OFC_CD = @[sch_lvl3] #end
		   #if(${sch_lvl1} != '' && ${sch_lvl2} != '' && ${sch_lvl3} == '') START WITH OFC_CD = @[sch_lvl2] #end
		   #if(${sch_lvl1} != '' && ${sch_lvl2} == '' && ${sch_lvl3} == '') START WITH OFC_CD = @[sch_lvl1] #end
		 CONNECT BY PRIOR OFC_CD = PRNT_OFC_CD
   )
#end

#if(${sch_hohq_gbn} != '')
   AND A.RGN_OFC_FLG = @[sch_hohq_gbn]
#end	

#if(${sch_office_gbn} == 'Y')
   #if(${sch_office_code} != '')
   AND A.OFC_CD LIKE @[sch_office_code]||'%'
   #end
#end

#if(${sch_office_gbn} == 'N')
   #if(${sch_office_code} != '')
   AND A.PRNT_OFC_CD LIKE @[sch_office_code]||'%'
   #end
#end

#if(${sch_office_gbn} == 'C')
   #if(${sch_office_code} != '')
   AND A.CTR_CD LIKE @[sch_office_code]||'%'
   #end
#end

#if(${sch_office_lvl} != '')
   AND A.GEN_EXPN_OFC_LVL = @[sch_office_lvl]
#end

#if(${sch_com_div} != '')
   AND A.OFC_CO_DIV_CD = @[sch_com_div]
#end

#if(${str_app_div_sql} != '')
   ${str_app_div_sql}
#end

#if(${sch_sumup_gbn} == 'Y')
   #if(${sch_sumup_office} != '')
   AND A.EXPN_SMRY_OFC_CD = @[sch_sumup_office]
   #end
#end

#if(${sch_delt_flg} == 'Y')
   AND A.DELT_FLG = 'Y'
#else
   AND A.DELT_FLG = 'N'
#end

ORDER BY A.OFC_CD, A.CTR_CD			]]></sql>
			<params>
				<param name="sch_lvl3" type="12" value="" out="N"/>
				<param name="sch_lvl2" type="12" value="" out="N"/>
				<param name="sch_lvl1" type="12" value="" out="N"/>
				<param name="sch_hohq_gbn" type="12" value="" out="N"/>
				<param name="sch_office_code" type="12" value="" out="N"/>
				<param name="sch_office_lvl" type="12" value="" out="N"/>
				<param name="sch_com_div" type="12" value="" out="N"/>
				<param name="sch_sumup_office" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
