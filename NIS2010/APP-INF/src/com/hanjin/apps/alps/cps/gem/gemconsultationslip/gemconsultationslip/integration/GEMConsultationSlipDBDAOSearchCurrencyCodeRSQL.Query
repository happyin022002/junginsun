<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GEMConsultationSlipDBDAOSearchCurrencyCodeRSQL">
			<desc><![CDATA[office 별 currecy code를 조회를 해온다]]></desc>
			<sql><![CDATA[
SELECT A.OFC_CD
,A.RQST_AUTH_FLG || A.RHQ_AUTH_FLG || A.TIC_AUTH_FLG || A.CMIT_AUTH_FLG AUTH_FLG
,A.RQST_UT_VAL
,DECODE(A.OFC_CD,'NYCRA','CAD',A.LOCL_CURR_CD) LOCL_CURR_CD
,DECODE(A.OFC_CD, 'NYCRA', (SELECT C.USD_LOCL_XCH_RT FROM GEM_XCH_RT C
                            WHERE C.CURR_CD='CAD' AND C.ACCT_XCH_RT_YRMON = TO_CHAR(SYSDATE,'YYYY') || '00'), B.USD_LOCL_XCH_RT) USD_LOCL_XCH_RT
FROM GEM_OFFICE A, GEM_XCH_RT B
WHERE A.OFC_CD =@[subs_ofc_cd]
#if (${subs_ofc_cd} != 'SELBPG') 
AND    A.OFC_CO_DIV_CD = 'S'
#end
AND    A.DELT_FLG = 'N'
AND    A.LOCL_CURR_CD = B.CURR_CD
AND    B.GEN_EXPN_XCH_RT_DIV_CD = 'I'
AND    B.ACCT_XCH_RT_YRMON = TO_CHAR(SYSDATE,'YYYY') || '00'
UNION ALL
SELECT A.OFC_CD
,A.RQST_AUTH_FLG || A.RHQ_AUTH_FLG || A.TIC_AUTH_FLG || A.CMIT_AUTH_FLG AUTH_FLG
,A.RQST_UT_VAL
,'USD' LOCL_CURR_CD
, 1 USD_LOCL_XCH_RT
FROM GEM_OFFICE A, GEM_XCH_RT B
WHERE A.OFC_CD = @[subs_ofc_cd]
#if (${subs_ofc_cd} != 'SELBPG') 
AND    A.OFC_CO_DIV_CD = 'S'
#end
AND    A.DELT_FLG = 'N'
AND    A.LOCL_CURR_CD = B.CURR_CD
AND    B.GEN_EXPN_XCH_RT_DIV_CD = 'I'
AND    B.ACCT_XCH_RT_YRMON = TO_CHAR(SYSDATE,'YYYY') || '00'			]]></sql>
			<params>
				<param name="subs_ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
