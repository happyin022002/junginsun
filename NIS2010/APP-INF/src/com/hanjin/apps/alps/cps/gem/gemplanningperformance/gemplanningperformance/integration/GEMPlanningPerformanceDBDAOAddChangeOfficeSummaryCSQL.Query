<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GEMPlanningPerformanceDBDAOAddChangeOfficeSummaryCSQL">
			<desc><![CDATA[2011.04.18 [CHM-201108838-01] 이준범
Title : OFC code Change 설정 시 Assigned Expense Data 변경 요청
DESC :   월별 예산 신청 금액을 조정한다.]]></desc>
			<sql><![CDATA[
MERGE INTO GEM_RSLT_SMRY
 USING DUAL
 ON( RSLT_YRMON			= SUBSTR(@[rslt_yrmon],1,6)
     AND OFC_CD         = @[ofc_cd]
     AND SUB_OFC_CD     = @[sub_ofc_cd]
     AND GEN_EXPN_CD    = @[gen_expn_cd]
     AND SUB_GEN_EXPN_CD= @[sub_gen_expn_cd]
     AND OFC_CO_DIV_CD  = @[ofc_co_div_cd]
 )
 WHEN MATCHED THEN
 UPDATE 
    SET GEN_EXPN_INIT_AMT = GEN_EXPN_INIT_AMT + TO_NUMBER(NVL(@[gen_expn_init_amt],'0'))
       ,GEN_EXPN_ADD_AMT  = GEN_EXPN_ADD_AMT  + TO_NUMBER(NVL(@[gen_expn_add_amt],'0'))
       ,GEN_EXPN_TRNS_AMT = GEN_EXPN_TRNS_AMT + TO_NUMBER(NVL(@[gen_expn_trns_amt],'0'))
       ,UPD_USR_ID        = @[upd_usr_id]
       ,UPD_DT            = SYSDATE
 WHEN NOT MATCHED THEN
INSERT (
        RSLT_YRMON
       ,OFC_CD
       ,SUB_OFC_CD
       ,GEN_EXPN_CD
       ,SUB_GEN_EXPN_CD
       ,OFC_CO_DIV_CD
       ,GEN_EXPN_INIT_AMT
       ,GEN_EXPN_ADD_AMT
       ,GEN_EXPN_TRNS_AMT
       ,SLP_PERF_AMT
       ,GEN_EXPN_OVR_RTO_RSN
       ,CRE_USR_ID
       ,CRE_DT
       ,UPD_USR_ID
       ,UPD_DT
       )
VALUES (
        SUBSTR(@[rslt_yrmon],1,6)
       ,@[ofc_cd]
       ,@[sub_ofc_cd]
       ,@[gen_expn_cd]
       ,@[sub_gen_expn_cd]
       ,@[ofc_co_div_cd]
       ,@[gen_expn_init_amt]
       ,@[gen_expn_add_amt]
       ,@[gen_expn_trns_amt]
       ,0
       ,@[gen_expn_ovr_rto_rsn]
       ,@[cre_usr_id]
       ,sysdate
       ,@[upd_usr_id]
       ,sysdate
       )			]]></sql>
			<params>
				<param name="rslt_yrmon" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="sub_ofc_cd" type="12" value="" out="N"/>
				<param name="gen_expn_cd" type="12" value="" out="N"/>
				<param name="sub_gen_expn_cd" type="12" value="" out="N"/>
				<param name="ofc_co_div_cd" type="12" value="" out="N"/>
				<param name="gen_expn_init_amt" type="12" value="" out="N"/>
				<param name="gen_expn_add_amt" type="12" value="" out="N"/>
				<param name="gen_expn_trns_amt" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="gen_expn_ovr_rto_rsn" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
