<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ClaimMainDBDAOSearchFindListRSQL">
			<desc><![CDATA[Find 조회]]></desc>
			<sql><![CDATA[
SELECT
    CGO_CLM_DIV_CD
  , CGO_CLM_NO
  , CGO_CLM_REF_BL_NO
  , CGO_CLM_REF_CNTR_NO
  , TRNK_REF_VVD_NO
  , CLM_AREA_CD
  , HDLR_OFC_CD
  , HDLR_USR_ID
  , STS_CD
  , FMAL_CLM_RCV_DT
  , CGO_CLM_INCI_NO
  , CRM_VOC_NO
  , UPD_DT
  , CLMT_CLM_TP_CD
  , CLAIMANT
  , CLMT_LOCL_AMT
  , CLMT_LOCL_CURR_CD
  , CLMT_USD_AMT
  , CGO_CLM_STL_TP_CD
  , CGO_CLM_STL_LOCL_AMT
  , CGO_CLM_STL_LOCL_CURR_CD
  , CGO_CLM_STL_USD_AMT
  , LIABLE_PARTY
  , CLM_PTY_ABBR_NM
  , INSUR_REF_NO
  , PAST_CGO_CLM_NO
  , ROW_NUM
  , TOTAL
FROM
    (
	SELECT
	    CLM.CGO_CLM_DIV_CD 												
	  , CLM.CGO_CLM_NO                                                  
	  , BL_DTL.CGO_CLM_REF_BL_NO                                        
	  , CNTR_DTL.CGO_CLM_REF_CNTR_NO                                    
	  , CLM.TRNK_REF_VVD_NO                                             
	  , CLM.CLM_AREA_CD                                                 
	  , CLM.HDLR_OFC_CD                                                 
	  , CLM.HDLR_USR_ID                                                 
	  , CGO_CLM_CLZ_CD||CGO_CLM_STS_CD                      			AS STS_CD
	  , CLM.FMAL_CLM_RCV_DT                                             
	  , CLM.CGO_CLM_INCI_NO                                             
	  , CLM.CRM_VOC_NO                                                  
	  , TO_CHAR(CLM.UPD_DT,'YYYYMMDD')									AS UPD_DT
      , CLMT_CLM_TP_CD													
          , (
                SELECT
                    PTY_NM
                FROM
                    CNI_PARTY
                WHERE
                    CLM_PTY_NO = CLM.CLMT_CLM_PTY_NO
            )                        AS CLAIMANT
          , CLM.CLMT_LOCL_AMT
          , CLM.CLMT_LOCL_CURR_CD
          , CLM.CLMT_USD_AMT
          , CLM.CGO_CLM_STL_TP_CD    
          , CLM.CGO_CLM_STL_LOCL_AMT
		  , CLM.CGO_CLM_STL_LOCL_CURR_CD
          , CLM.CGO_CLM_STL_USD_AMT
          , (
                SELECT
                    PTY_NM
                FROM
                    CNI_PARTY
                WHERE
                    CLM_PTY_NO = CLM.LABL_CLM_PTY_NO
            ) AS LIABLE_PARTY
          , (
                SELECT
                    CLM_PTY_ABBR_NM
                FROM
                    CNI_PARTY
                WHERE
                    CLM_PTY_NO = CLM.INSUR_CLM_PTY_NO
            )                   AS CLM_PTY_ABBR_NM
          , CLM.INSUR_REF_NO    
          , CLM.PAST_CGO_CLM_NO 
          , ROW_NUMBER () OVER (ORDER BY CLM.CGO_CLM_NO DESC) ROW_NUM
          , COUNT ( *) OVER () TOTAL
        FROM
            CNI_CLM_V CLM
          , (
                SELECT
                    CGO_CLM_NO
                  , CGO_CLM_REF_BL_NO
                FROM
                    CNI_CGO_CLM_BL_DTL
				#if(${sch_cond} != 'BL_NO')
                WHERE
                    MN_BL_FLG = 'Y' --대표 B/L 번호
				#end
            )
            BL_DTL
          , (
                SELECT
                    CGO_CLM_NO
                  , CGO_CLM_REF_CNTR_NO
                FROM
                    CNI_CGO_CLM_CNTR_DTL
				#if(${sch_cond} != 'CNTR_NO')
                WHERE
                    MN_CNTR_FLG = 'Y'--대표 컨테이너 번호
				#end
            )
            CNTR_DTL
           , CNI_AREA_OFC AREA
        WHERE
            CLM.CGO_CLM_NO = BL_DTL.CGO_CLM_NO(+)
            AND CLM.CGO_CLM_NO = CNTR_DTL.CGO_CLM_NO (+)
			AND CLM.CRE_OFC_CD  = AREA.OFC_CD(+)
            #if(${sch_cond} == 'CLM_NO')
            AND CLM.CGO_CLM_NO LIKE @[sch_str]||'%'
            #end
            #if(${sch_cond} == 'BL_NO')
            AND BL_DTL.CGO_CLM_REF_BL_NO LIKE @[sch_str]||'%'
            #end
            #if(${sch_cond} == 'CNTR_NO')
            AND CNTR_DTL.CGO_CLM_REF_CNTR_NO LIKE @[sch_str]||'%' 
            #end
            #if(${sch_cond} == 'VVD')
            AND CLM.TRNK_REF_VVD_NO LIKE @[sch_str]||'%'
            #end
            #if(${sch_cond} == 'INCI_NO')
            AND CLM.CGO_CLM_INCI_NO LIKE @[sch_str]||'%'
            #end
            #if(${sch_cond} == 'VOC_NO')
            AND CLM.CRM_VOC_NO LIKE @[sch_str]||'%'
            #end
            #if(${sch_cond} == 'INSURER_REF')
            AND CLM.INSUR_REF_NO LIKE @[sch_str]||'%'
            #end
            #if(${sch_cond} == 'IMS_NO')
            AND CLM.PAST_CGO_CLM_NO LIKE @[sch_str]||'%'
            #end
			#if(${misc_cd} != '')
            AND CLM.CLM_AREA_CD = @[misc_cd]
            #end
			#if(${vt} != '')
            AND CLM.CGO_CLM_DIV_CD = @[vt]
            #end
)
#if (${start_page} != '') 
WHERE ROW_NUM BETWEEN ${start_page} AND ${end_page}
#end			]]></sql>
			<params>
				<param name="sch_str" type="12" value="" out="N"/>
				<param name="misc_cd" type="12" value="" out="N"/>
				<param name="vt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
