<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="UserRoleApprovalDBDAOModuleRoleRSQL">
			<desc><![CDATA[모듈의 role을 가져온다]]></desc>
			<sql><![CDATA[
select a.usr_role_cd,
  a.usr_role_cd || ' - ' ||usr_role_nm as usr_role_nm
from com_usr_role a,
  (select usr_role_cd
    from com_usr_role_mtch
    where usr_id = @[usr_id]
    and substr(usr_role_cd, 1, 3) = @[sub_sys_cd] )b,
  (select a.apro_rqst_no,
      a.rqst_usr_id,
      b.usr_role_cd,
      c.apsts_cd
    from com_apro_role_rqst_hdr a,
      com_apro_role_dtl b,
      com_apro_role_rqst_rout c
    where 1 =1
      and a.apro_rqst_no = b.apro_rqst_no
      and a.apro_rqst_no = c.apro_rqst_no
      and a.rqst_usr_id = @[usr_id]
      and c.apsts_cd = 'P') c
where a.usr_role_cd = b.usr_role_cd (+)
  and a.usr_role_cd = c.usr_role_cd (+)
  and (a.usr_role_tp_cd is null or a.usr_role_tp_cd <> 'J')
  and substr(a.usr_role_cd, 1, 3) = @[sub_sys_cd]
  and (b.usr_role_cd is null and c.usr_role_cd is null)
order by a.usr_role_cd 			]]></sql>
			<params>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="sub_sys_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
