<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="KorManifestListDBDAOaddVVDInfoInKorCstmCSQL">
			<desc><![CDATA[전송되었거나 데이터가 없는 경우 추가]]></desc>
			<sql><![CDATA[
INSERT INTO BKG_CSTMS_KR_VVD_SMRY
( MRN_NO , MRN_CHK_NO , VSL_CD , SKD_VOY_NO , SKD_DIR_CD , OB_DECL_TP_CD ,
  VVD_SEQ , PORT_CD , IO_BND_CD , VSL_CNT_CD , VSL_NM , KR_VSL_CALL_SGN_CD ,
  ETA_DT , ETD_DT , MST_BL_KNT , CNSL_BL_KNT , MTY_BL_KNT , TTL_WGT ,
  TTL_MEAS_QTY , TTL_PCK_QTY , TTL_FULL_KNT , TTL_MTY_KNT , TTL_LC_TEU_QTY ,
  TTL_LC_FEU_QTY , TTL_LC_45FT_QTY, TTL_TS_TEU_QTY , TTL_TS_FEU_QTY , TTL_TS_45FT_QTY,
  TTL_MTY_TEU_QTY , TTL_MTY_FEU_QTY , TTL_MTY_45FT_QTY,
  JO_CRR_KNT , CRE_DT , CRE_USR_ID , UPD_DT , UPD_USR_ID ,
  MF_SND_DT , MF_SND_USR_ID , RSPN_RCV_DT , CSTMS_DCHG_CD , DCHG_RPT_SND_DT , DCHG_RPT_SND_USR_ID,
  CALL_KNT, DCHG_MZD_CD, IO_TML_LOC_CD)
SELECT  MRN_NO, MRN_CHK_NO, VSL_CD, SKD_VOY_NO, SKD_DIR_CD, @[in_type], @[vvd_seq]+1,
        PORT_CD, IO_BND_CD, VSL_CNT_CD, VSL_NM, KR_VSL_CALL_SGN_CD, ETA_DT, ETD_DT,
		@[mst_bl_knt] , @[cnsl_bl_knt] , @[mty_bl_knt] , NVL(@[ttl_wgt],0) ,
	    NVL(@[ttl_meas_qty],0) , NVL(@[ttl_pck_qty],0) , @[ttl_full_knt] , @[ttl_mty_knt] , NVL(@[ttl_lc_teu_qty],0) ,
  		NVL(@[ttl_lc_feu_qty],0) , NVL(@[ttl_lc_45ft_qty],0), NVL(@[ttl_ts_teu_qty],0) , NVL(@[ttl_ts_feu_qty],0) , NVL(@[ttl_ts_45ft_qty],0),
  		NVL(@[ttl_mty_teu_qty],0) , NVL(@[ttl_mty_feu_qty],0) , NVL(@[ttl_mty_45ft_qty],0),
        JO_CRR_KNT, SYSDATE, CRE_USR_ID, SYSDATE, @[user_id], NULL, NULL,
        NULL, DECODE(PORT_CD,'KRPUS','030197004','KRKAN','062112001','KRINC','020104002','KRPTK','016105001','KRUSN','110109004','KRGIN','020112001','030197004'), NULL, NULL,
        0, NULL, NULL
FROM    BKG_CSTMS_KR_VVD_SMRY KV
WHERE   KV.VSL_CD        = SUBSTR(@[vvd],1,4)
AND     KV.SKD_VOY_NO    = SUBSTR(@[vvd],5,4)
AND     KV.SKD_DIR_CD    = SUBSTR(@[vvd],9,1)
AND     KV.MRN_NO        = @[mrn_no]
AND     KV.MRN_CHK_NO    = @[mrn_chk_no]
#if(${in_type}!='D')
AND     ((@[in_type] IN ('A','B','C') AND KV.OB_DECL_TP_CD IN ('A','B','C')) OR
         (@[in_type] = 'N' AND KV.OB_DECL_TP_CD = @[in_type]))
#end
AND     KV.VVD_SEQ        = @[vvd_seq]
AND     ROWNUM = 1			]]></sql>
			<params>
				<param name="in_type" type="12" value="" out="N"/>
				<param name="vvd_seq" type="12" value="" out="N"/>
				<param name="mst_bl_knt" type="12" value="" out="N"/>
				<param name="cnsl_bl_knt" type="12" value="" out="N"/>
				<param name="mty_bl_knt" type="12" value="" out="N"/>
				<param name="ttl_wgt" type="12" value="" out="N"/>
				<param name="ttl_meas_qty" type="12" value="" out="N"/>
				<param name="ttl_pck_qty" type="12" value="" out="N"/>
				<param name="ttl_full_knt" type="12" value="" out="N"/>
				<param name="ttl_mty_knt" type="12" value="" out="N"/>
				<param name="ttl_lc_teu_qty" type="12" value="" out="N"/>
				<param name="ttl_lc_feu_qty" type="12" value="" out="N"/>
				<param name="ttl_lc_45ft_qty" type="12" value="" out="N"/>
				<param name="ttl_ts_teu_qty" type="12" value="" out="N"/>
				<param name="ttl_ts_feu_qty" type="12" value="" out="N"/>
				<param name="ttl_ts_45ft_qty" type="12" value="" out="N"/>
				<param name="ttl_mty_teu_qty" type="12" value="" out="N"/>
				<param name="ttl_mty_feu_qty" type="12" value="" out="N"/>
				<param name="ttl_mty_45ft_qty" type="12" value="" out="N"/>
				<param name="user_id" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="mrn_no" type="12" value="" out="N"/>
				<param name="mrn_chk_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
