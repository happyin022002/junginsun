//AS-IS message
msgs['DMT00001'] = "Data was saved successfully.";
msgs['DMT00002'] = "Data was retrieved successfully";
msgs['DMT00003'] = "Failed to save {?msg1}. Please try it again.";
msgs['DMT00004'] = "Failed to delete {?msg1}. Please try it again.";
msgs['DMT00005'] = "BKG No. is invalid";
msgs['DMT00006'] = "Failed to retrieve {?msg1}. Please try it again.";
msgs['DMT00007'] = 'Saved successfully!';
msgs['DMT00008'] = "Failed to {?msg1}. Please try it again.";
msgs['DMT00009'] = "At least one row needs to be selected";

msgs['DMT01001'] = "There is an invoice issued for this container. Please cancel the issued invoice first and change DR data!";
msgs['DMT01002'] = 'Already Invoiced';
msgs['DMT01003'] = 'DR Date must be later than current date !';
msgs['DMT01010'] = 'You can only transfer Finished status charge to the other RHQ!';
msgs['DMT01019'] = 'Only Finished, Long staying status can be transferred!';
msgs['DMT01020'] = 'To date should be same or later than From date';
msgs['DMT01021'] = 'Choose Should Read(Office)!';
msgs['DMT01022'] = 'Date for partial payment must be earlier than the current date!';
msgs['DMT01023'] = 'Date should be between the From date and next To date!';
msgs['DMT01024'] = "It's already interfaced to A/R!";
msgs['DMT01025'] = "For this container, it's already invoiced. Will you make a revised invoice with partial amount?";
msgs['DMT01026'] = "It's already invoiced. You can't inactive it!";
msgs['DMT01027'] = 'MT Notification will be canceled. Do you want to change the TO Date?';
msgs['DMT01028'] = 'To Date must be between From Date and Next To Date!! Please Check the Date!!';
msgs['DMT01029'] = 'Invoiced Container should have charge';
msgs['DMT01030'] = 'There is a balance charge !';
msgs['DMT01031'] = '{?msg1} should be same or later than {?msg2}';
msgs['DMT01032'] = '{?msg1} Up to should be larger than From number';
msgs['DMT01036'] = 'There is an invoice issued for this container. Please cancel the issued invoice first and change DR data!';
msgs['DMT01037'] = 'Are you sure to cancel the Web Empty Notification?';
msgs['DMT01038'] = 'Input the reason in remark(more than 10 letters)!';
msgs['DMT01039'] = 'Are you sure to delete all Balance charge for this cntr?';
msgs['DMT01040'] = 'There are no Finished, Confirmed, Invoiced, Long Staying or Unfinished cntr for Demand.';
msgs['DMT01041'] = 'There are no Confirmed cntr for billing!';
msgs['DMT01042'] = 'Pls select cntr in Deleted status';
msgs['DMT01043'] = 'There is a balance charge in Invoiced status. Please cancel the issued invoice first before deleting balance charges!';
msgs['DMT01044'] = 'Choose Should Read(Other Office)!';
msgs['DMT01045'] = 'Input the reason!';
msgs['DMT01046'] = 'Date should be earlier than the current date, if last To MVMT Status is DR';
msgs['DMT01047'] = 'Date should be between the From date and next To date!';
msgs['DMT01048'] = 'To date should be same or later than From date';
msgs['DMT01049'] = 'Please select inactivation reason on the list!';
msgs['DMT01050'] = 'Input the reason in remark(more than 10 letters)!';
msgs['DMT01051'] = 'Pls update Payer code and Tax Rate first!';
msgs['DMT01052'] = 'Pls update Payer code first!';
msgs['DMT01053'] = 'Calculation Type discrepancy! [{?msg1}] ? [Combined]';
msgs['DMT01054'] = 'Charge already generated!';
msgs['DMT01055'] = 'Gap with ETA date is allowed upto 10 days. CNTR [{?msg1}]';
msgs['DMT01056'] = 'Manual batch program will run to generate charges based on your from date entries. Are you sure to proceed?';
msgs['DMT01057'] = 'There is already a balance charge!';
msgs['DMT01058'] = 'Balance Charge can be created only for Finished, Confirmed, Invoiced charge with D/R(Delivery & Return) Date';
msgs['DMT01059'] = 'D/R date should be later than From date';
msgs['DMT01060'] = 'Please check the charge status! D/R date can be updated only for Finished charge with D/R date, Unfinished and Long Staying cntrs';
msgs['DMT01061'] = 'Charge not generated!';
msgs['DMT01062'] = 'From Date should be same or later than current date';
msgs['DMT01063'] = 'Do you want to cancel inactivation?';
msgs['DMT01064'] = '{?msg1} missing! CNTR [{?msg2}]';
msgs['DMT01065'] = 'CNTR [{?msg1}] is duplicated!';
msgs['DMT01066'] = 'Please select one office at a time';
msgs['DMT01067'] = "Only one of 'Long Staying' and 'All Long Staying' can be selected";
msgs['DMT01068'] = "It's already invoiced. You can't {?msg1} it!";
msgs['DMT01069'] = "Balance Charge will be created. Are you sure to proceed?";
msgs['DMT01070'] = "First row cannot be deleted!";
msgs['DMT01071'] = "Only inserted rows can be deleted! Pls use D/R cancel for balance charge deletion.";
msgs['DMT01073'] = "Date should be between the F/T End date and next To date!";
msgs['DMT01074'] = "Office Tranfer was successful!";
msgs['DMT01075'] = "Vessel's schedule is not found!";
msgs['DMT01076'] = "Please check the status. Only confirmed cntrs can be selected for {?msg1}";
msgs['DMT01077'] = "Please check the status. Error, No Charge or Deleted cntrs cannot be selected for Demand";
msgs['DMT01078'] = "D/R Date should be later than from date for balance charge!";
msgs['DMT01079'] = 'Gap with ETA date is allowed upto 10 days. VVD [{?msg1}]';
msgs['DMT01080'] = 'Limited up to {?msg1} at a time!';

msgs['DMT02001'] = 'Dual Type Exception already applied in S/C Exception Tariff or Before Booking DAR. Pls delete S/C Exception Tariff or cancel/reject Before Booking DAR before deleting Dual Type Exception customer[{?msg1}]! S/C Proposal No[{?msg2}], Before BKG[{?msg3}]';
msgs['DMT02002'] = '{?msg1} Missing!';
msgs['DMT02003'] = 'Pls recheck Seq. {?msg1}. Calculation Type discrepancy! [{?msg2}] - [Dual]';
msgs['DMT02004'] = 'Pls recheck Seq. {?msg1}. Only one of Add day or Total day can be input';
msgs['DMT02005'] = 'Pls recheck Seq. {?msg1}. The last “Up to” CNTR Q’ty of Tiered Free Time should be null!';
msgs['DMT02006'] = 'Pls recheck Seq. {?msg1}. The last “Up to” Over Day of Rate Adjustment should be null!';
msgs['DMT02007'] = 'Will you delete this version?';
msgs['DMT02008'] = 'Discrepancy with Coverage continent!';
msgs['DMT02009'] = 'This is an approved row. If you delete this row, it won’t be effective any more. Are you sure to proceed ?';
msgs['DMT02010'] = 'Pls check the Type option!';
msgs['DMT02011'] = 'Pls recheck Seq. {?msg1}. Free Time or D/C Amount or Ratio is mandatory!';
msgs['DMT02012'] = 'Pls recheck Seq. {?msg1}. Only one of D/C Amount or Ratio can be input';
msgs['DMT02013'] = 'Pls recheck Seq. {?msg1}. Duplicated BKG. DAR No. [{?msg2}]';
msgs['DMT02015'] = 'Pls recheck Seq. {?msg1}. CNTR[XXXX] with Balance Charge cannot be applied of this DAR! Pls contact DEM/DET Office [XXXXX]';
msgs['DMT02016'] = 'Please input the [Tariff Type] first.';
msgs['DMT02017'] = 'Duplicated! DEM/DET Office [{?msg1}] for ID [{?msg2}]';
msgs['DMT02018'] = 'Please input country code or port code !';
msgs['DMT02028'] = 'Pls recheck Seq. {?msg1}. Free Time or Rate Adjustment should be selected!';
msgs['DMT02029'] = 'There is no charge found!';
msgs['DMT02030'] = 'There is no BKG No. or B/L No. found!';
msgs['DMT02031'] = 'Dual Type Exception already applied in S/C Exception Tariff. Pls delete S/C Exception Tariff before deleting Dual Type Exception customer [{?msg1}]!   S/C Proposal No. [{?msg2}]';
msgs['DMT02032'] = 'Dual Type Exception already applied in Before Booking DAR. Pls cancel/reject Before Booking DAR before deleting Dual Type Exception customer [{?msg1}]!   DAR [{?msg2}]';

msgs['DMT03017'] = "Failed to retrieve {?msg1}. Please try it again.";
msgs['DMT03018'] = 'Please check the status before you confirm it. You can confirm only Finished status';
msgs['DMT03022'] = 'Already interfaced Invoice No!';
msgs['DMT03024'] = 'Only Issue Office({?msg1}) can cancel the invoice. Please recheck your login Office code.( ""{?msg2}"" => Issue Office Code)"';
msgs['DMT03025'] = 'Will you cancel this invoice?';
msgs['DMT03026'] = 'Do you want to interface this invoice?';
msgs['DMT03027'] = 'A/R I/F Success! Invoice No:{?msg1}';
msgs['DMT03028'] = '{?msg1} missing!';
msgs['DMT03033'] = 'Pls load excel the necessary data before auditing. {?msg1} is mandatory item.';
msgs['DMT03051'] = 'Get To MVMT already done. Are you sure to proceed?';
msgs['DMT03052'] = 'Calculate already done. Are you sure to proceed?';
msgs['DMT03053'] = 'Pls click Get To MVMT first!';
msgs['DMT03054'] = 'Charge needs to be calculated in advance!';
msgs['DMT03055'] = 'Charge is not in Finished status!';
msgs['DMT03056'] = 'No Invoice No.! Pls create invoice first!';
msgs['DMT03057'] = 'Only for DEM/DET Manual Invoice!';
msgs['DMT03069'] = '{?msg1} blocked for Dual Type Exception!';
msgs['DMT03071'] = 'Please check Seq. {?msg1}. DEM/DET office not under your authorization.';

msgs['DMT04001'] = 'Dual Type Exception already applied in S/C Exception Tariff or Before Booking DAR. Pls correct the expiration date in S/C Exception Tariff or Before Booking DAR before expiring Dual Type Exception customer[{?msg1}]! S/C Proposal No[{?msg2}], Before BKG[{?msg3}]!';
msgs['DMT04011'] = 'Dual Type Exception already applied in S/C Exception Tariff. Pls correct the expiration date in S/C Exception Tariff expiring Dual Type Exception customer [{?msg1}]!   S/C Proposal No. [{?msg2}]';
msgs['DMT04012'] = 'Dual Type Exception already applied in Before Booking DAR. Pls correct the expiration date in Before Booking DAR before deleting Dual Type Exception customer Dual Type Exception customer [{?msg1}]!   DAR [{?msg2}]';

msgs['DMT05014'] = 'Pls input {?msg1}!';
msgs['DMT05015'] = 'Only country or location code!';

msgs['DMT06001'] = 'No Data Found!';
msgs['DMT06015'] = '"No Data", "Do you want to reuse Last year\'s table?"';


//add message
msgs['DMT00101'] = 'Please enter a valid date format for({?msg1}) : MMDD';
msgs['DMT00102'] = 'Please enter {?msg1}';
msgs['DMT00103'] = 'Period cannot be over 3 weeks!';
msgs['DMT00104'] = '{?msg1} cannot be over {?msg2} bytes!';
msgs['DMT00105'] = 'PERIOD OVERLAPPED DATA EXISTS!';
msgs['DMT00106'] = 'Clock Stop is already cancelled!';
msgs['DMT00107'] = 'You can inquire \'Sub Office\' for one office code at a time';
msgs['DMT00108'] = 'Pls recheck Seq.{?msg1}. {?msg2} missing!'
msgs['DMT00109'] = 'Holiday duplicated! [{?msg1}]';
msgs['DMT00110'] = 'Invalid {?msg1} Code';
msgs['DMT00111'] = 'Pls update holiday before saving';
msgs['DMT00112'] = 'No authority to cancel';
msgs['DMT00113'] = 'Pls recheck Seq. {?msg1}. Total Day only for Dual Type Exception!';
msgs['DMT00114'] = 'Pls recheck Seq. {?msg1}. Rate Adjustment mandatory for Dual Type Exception!';
msgs['DMT00115'] = 'Pls recheck Seq. {?msg1}. {?msg2} must be over 2 rows!';
msgs['DMT00116'] = 'Pls expire the previous tariff first!';
msgs['DMT00117'] = 'Expiration Date different! Pls create tariff group separately!';
msgs['DMT00118'] = 'Already confirmed!';
msgs['DMT00119'] = '{?msg1} must be {?msg2} characters long.';
msgs['DMT00120'] = '{?msg1} must be {?msg2} numbers long.';
msgs['DMT00121'] = 'Pls create tariff for all 10 CNTR & Cargo Types!';
msgs['DMT00122'] = 'Are you sure to confirm?';
msgs['DMT00123'] = 'Not in confirmed staus!';
msgs['DMT00124'] = 'Only for future tariff!';
msgs['DMT00125'] = 'Already expired!';
msgs['DMT00126'] = 'Pls make sure to create new tariff!';
msgs['DMT00127'] = 'Effective Date different! Pls update tariff group separately!';
msgs['DMT00128'] = 'No data for saving!';
msgs['DMT00129'] = 'Pls recheck Seq. {?msg1}. Rate Adjustment mandatory for Dual Type Exception!';
msgs['DMT00130'] = 'At First, Pls choose Coverage CN';
msgs['DMT00131'] = 'Pls save the data after update!';
msgs['DMT00132'] = 'Pls recheck Seq. {?msg1}. Calculation Type discrepancy! [{?msg2}] - [Combined]';
msgs['DMT00133'] = 'Do you want to update the data?';
msgs['DMT00134'] = 'Maximun 2 characters are allowed';
msgs['DMT00135'] = 'Do you want to {?msg1}?';
msgs['DMT00136'] = 'Pls make sure to click Request button for request!';
msgs['DMT00137'] = 'Do not delete this row if you need to keep it effective. Are you sure to delete this row?';
msgs['DMT00138'] = 'Pls recheck Seq. {?msg1}. Duplicate data Found! {?msg2}';
msgs['DMT00139'] = 'This version is not requested. Do you want to close without requesting it?';
msgs['DMT00140'] = 'Pls select {?msg1}';
msgs['DMT00143'] = 'Are you sure to delete ?';
msgs['DMT00144'] = 'Duplicated {?msg1}!';
msgs['DMT00145'] = 'Will you delete Commodity ?';
msgs['DMT00146'] = 'Effective Date must be later than today for {?msg1}!';
msgs['DMT00147'] = 'Data was changed. Do you want to close without saving it?';
msgs['DMT00148'] = 'At First, Pls enter {?msg1}';
msgs['DMT00149'] = 'The last [Up to] CNTR Q\'ty of Free Time should be null!';
msgs['DMT00150'] = 'The last [Up to] Over Day of Rate should be null!';
msgs['DMT00151'] = 'Pls select comment to input your comment';
msgs['DMT00152'] = 'Pls recheck Seq. {?msg1}. Free Time mandatory for Dual Type Exception!';
msgs['DMT00153'] = 'To Tariff already exists!';
msgs['DMT00154'] = 'Pls select dual type exception to {?msg1} on the list!';
msgs['DMT00155'] = 'Pls recheck Seq. {?msg1}. Tariff Type/BKG No. is duplicated with DAR No. [{?msg2}]';
msgs['DMT00156'] = 'There is no Finished charge!';
msgs['DMT00157'] = 'Number of containers exceeds maximum number 1,000.';
msgs['DMT00158'] = 'Period cannot be over {?msg1} year!';
msgs['DMT00159'] = 'Pls recheck Seq. {?msg1}. Different S/C or RFA No or TAA No! Different DAR should be made for this BKG';
msgs['DMT00160'] = 'DAR is {?msg1}';
msgs['DMT00161'] = 'Pls recheck Seq. {?msg1}. Tariff Type/BKG No. is duplicated';
msgs['DMT00162'] = 'Period cannot be over {?msg1}!';
msgs['DMT00163'] = 'Customer Code is not valid!';
msgs['DMT00164'] = 'Demand note should have CNTR!';
msgs['DMT00165'] = '{?msg1} is invalid!';
msgs['DMT00166'] = 'Please enter DAR No. or APVL No.';
msgs['DMT00167'] = 'It\'s already interfaced to A/R!\nAre you sure to request adjustment?';
msgs['DMT00168'] = 'Pls recheck Seq. {?msg1}. input D/C Amount or Ratio';
msgs['DMT00169'] = 'Invoice should have billable amount';
msgs['DMT00170'] = 'Invoice was updated successfully';
msgs['DMT00171'] = 'Pls check {?msg1}';
msgs['DMT00172'] = 'F/T CMNC date should be same or next day of From Date';
msgs['DMT00173'] = 'Please select invoice cancel reason on the list!';
msgs['DMT00174'] = 'Duplicated CNTR No[{?msg1}]!';
msgs['DMT00175'] = 'Calling port unmatch!';
msgs['DMT00176'] = '[{?msg1}] was already deleted';
msgs['DMT00177'] = 'Data will be replaced. Do you want to copy?';
msgs['DMT00178'] = 'Pls select one row';
msgs['DMT00179'] = 'Detail for Live status only!';
msgs['DMT00180'] = 'Please enter only one of S/C No. or RFA No. or Proposal No. or DAR No. or APVL No.';
msgs['DMT00181'] = 'Please enter only one of S/C No. or RFA No. or Proposal No. or DAR No. or APVL No. or BKG No. or B/L No.';
msgs['DMT00182'] = 'Pls update Payer code first!';
msgs['DMT00183'] = 'Invoice should have billing amount!';
msgs['DMT00184'] = 'Discrepancy found in Tax Rate between Invoice and Sheet Option. Are you sure to save?';
msgs['DMT00185'] = 'Pls use Customer code as payer!';
msgs['DMT00186'] = 'Do you want to interface the selected invoices?';
msgs['DMT00187'] = 'Attention Info for Invoice sheet cannot be deleted!';
msgs['DMT00188'] = 'Please recheck Seq. {?msg1}. Attention/Tel./Fax/E-mail duplicated!';
msgs['DMT01081'] = 'This has been done already.';
msgs['DMT01089'] = '{?msg1} should be later than {?msg2}';
msgs['DMT01090'] = 'Fax No missing! Pls input Fax No in Payer Info';
msgs['DMT01091'] = 'E-mail address missing! Pls input E-mail address in Payer Info';
msgs['DMT01092'] = 'Do you want to send fax? \nFax No.:{?msg1}';
msgs['DMT01093'] = 'Do you want to send e-mail? \nEmail No.:{?msg1}';
msgs['DMT01094'] = 'Pls recheck seq. :{?msg1}\nInvoice No already created! Pls go to detail screen to update data';
msgs['DMT01095'] = 'Please select one DEM/DET office at a time';
msgs['DMT01096'] = 'Please create Sheet Set first!';
msgs['DMT01097'] = 'Pls recheck seq. :{?msg1}\nNo Invoice No.! Pls create invoice first!';
msgs['DMT01098'] = 'Pls recheck Seq. :{?msg1}\nAlready interfaced Invoice No.';
msgs['DMT01099'] = 'Sender E-mail address missing!';
msgs['DMT01100'] = '[Maximum Period is [3 Months or 12 weeks]';
msgs['DMT01101'] = 'OTS Sheet should have invoices.';
msgs['DMT01102'] = 'When Credit Term is 0, Due Date should be either Issue Date or *******';
msgs['DMT01103'] = 'Only Issue Office can save the data!';
msgs['DMT01104'] = 'Tariff Type Duplicated for Credit Term';
msgs['DMT01105'] = 'Tariff Type Duplicated for Customized Title [{?msg1}]';
msgs['DMT01106'] = 'Input the reason in remark(more than 10 letters)!';
msgs['DMT01107'] = 'Please select invoice hold reason on the list!';
msgs['DMT01108'] = 'Pls go to SZPSC DEM Billing menu to {?msg1}';
msgs['DMT01109'] = 'Payer Code was updated successfully!';
msgs['DMT01110'] = 'Tariff Type missing for {?msg1}';
msgs['DMT01111'] = 'Seq.{?msg1} 가 {?msg2} 되었습니다. 저장 하시겠습까?';
msgs['DMT01112'] = 'Data was changed. Do you want to {?msg1}?';
msgs['DMT01113'] = 'There is no changed data';
msgs['DMT01114'] = 'When the new version is accepted, version [{?msg1}] will be deleted. Do you want to update to the new version?';
msgs['DMT01115'] = '먼저, 변경된 내용을 저장하세요.';
msgs['DMT01116'] = 'Data was {?msg1} successfully.';
msgs['DMT01117'] = 'There are no data for {?msg1}';
msgs['DMT01118'] = 'There are no data. Do you want to delete this version?';
msgs['DMT01119'] =  'This is the last row. Do you want to delete this version?';
msgs['DMT01120'] = 'Please create Sheet Set first! {?msg1}';
msgs['DMT01121'] = 'Same version cannot be copied!';
msgs['DMT01122'] = 'When the new version is approved, Approved version [{?msg1}] will be cancelled. Do you want to update to the new version?';
msgs['DMT01123'] = 'Last row cannot be deleted. Cancel this version if necessary';
msgs['DMT01124'] = '{?msg1}. duplicated. Are you sure proceed?';
msgs['DMT01125'] = 'Unexpected system error occurred during data processing';
msgs['DMT01126'] = 'Do you want to save(cancel)?';
msgs['DMT01127'] = 'Clock Stop will be immediately cancelled. Are you sure to proceed?';
msgs['DMT01128'] = '{?msg1} should be larger than {?msg2}';
msgs['DMT01129'] = 'Location code is not in your area';
msgs['DMT01130'] = 'Approval cannot be cancelled. Do you want to approve?';
msgs['DMT01131'] = 'Do you want to expire this tariff group?';
msgs['DMT01132'] = 'Do you want to save this sheet set?';
msgs['DMT01133'] = 'Only Issue Office can save the data!';
msgs['DMT01134'] = 'Are you sure to delete this sheet set?';
msgs['DMT01135'] = 'Only Issue Office can delete the data!';
msgs['DMT01136'] = 'Data was changed. Do you want to approve with changed data?';
msgs['DMT01137'] = 'Do you want to cancel confirmation?';
msgs['DMT01138'] = 'Free Time is 0. Do you want to save?';
msgs['DMT01139'] = 'Do you want to send E-mail to selected payers?';
msgs['DMT01140'] = 'Do you want to send Fax to selected payers?';
msgs['DMT01141'] = 'Limited up to 100 invoices at a time';
msgs['DMT01142'] = 'System performance can be slow with "No Charge" included.\nDo you want to proceed?';
msgs['DMT01143'] = 'Please check payer code';
msgs['DMT01144'] = '{?msg1} cannot be the same country as Coverage';
msgs['DMT01145'] = 'You have no authority to {?msg1}!';
msgs['DMT01146'] = 'Please enter {?msg1} route or use common VVD CFDRYYMME';
msgs['DMT01147'] = 'Are you sure to delete this tariff group?';
msgs['DMT01148'] = 'Version status has changed. Please click {?msg1} button';
msgs['DMT01149'] = 'Is this tariff group correct? If not, instead of expiration, pls contact system manager to delete the data';
msgs['DMT01150'] = 'Please select {?msg1} to send!';
msgs['DMT01151'] = "S/C party can't be inputted here";
msgs['DMT01152'] = "There is no B/L No";
msgs['DMT01153'] = "The case is requested for inactivation, so it can’t be transferred to other office.";
msgs['DMT01154'] = "The case is requested for inactivation, so it can't be invoiced.";
msgs['DMT01155'] = "The case is requested for inactivation.";
msgs['DMT01156'] = "[Warning]\nAfter-BKG-DAR is not applied to any charge made after DR(Partial).{?msg1}";
msgs['DMT01157'] = "User Log-in Office is different from the charge office.";
msgs['DMT01158'] = "DR charge can not be deleted. If necessary, it should be cancelled.";
msgs['DMT01159'] = "Please calculate and check D/C AMT first.";
msgs['DMT01160'] = "{?msg1} is the correct Approval Office.";
msgs['DMT01161'] = "Pls recheck Seq.{?msg1}. Your input value should be over '0'.";
msgs['DMT01162'] = "Ratio is limited to 100%";
msgs['DMT01163'] = "Check Validity.";
msgs['DMT01164'] = "Effective date should be same as today or later.";
msgs['DMT01165'] = "E-mail Address is missing or not correct format."
msgs['DMT01166'] = 'BackEndJob Request Fail!';
msgs['DMT01167'] = 'Created BackEndJob File exist already!';

msgs['DMT01168'] = 'Alert message : Rate should be over "1".({?msg1})';

msgs['DMT01169'] = 'Alert message : No Coincidence.({?msg1})';

msgs['DMT01170'] = "There is discrepancy between Login office and approval office.";

msgs['DMT01171'] = 'Do you want to cancel {?msg1}?';
msgs['DMT01172'] = '{?msg1} was cancelled successfully';
msgs['DMT01173'] = 'There is a virtual invoice for this booking no.\nif you create new invoice, then the virtual invoice will be cancelled\nDo you want to create invoice?';
msgs['DMT01174'] = 'Please select no virtual invoice on the list!';

msgs['DMT01175'] = 'It is impossible to send for payer because of red color payer, please send after adjust to omit for red payer on the click and confirm red invoice by save in the red payer';

msgs['DMT01176'] = '{?msg1} / {?msg2} / {?msg3} is processing Inactive';
msgs['DMT01177'] = 'The case is not requested for inactivation';
msgs['DMT01178'] = '{?msg1}Expiration DT should be inputted within 365days based on effective date.'
msgs['DMT01179'] = "The case is requested for inactivation, so it can't be recalculated.";

msgs['DMT01180'] = "Do you want to save ( {?msg1} ) ?"; 
		
msgs['DMT01181'] = "You must delete from last row";

msgs['DMT01182'] = 'Please enter only one of Inactive No. or APVL No. or BKG No. or Inactive Reason or Specific Reason';
msgs['DMT01183'] = 'Payer is not Logistics vendor';

msgs['DMT01184'] = "These are not {?msg1}."; 

msgs['DMT01185'] = "Please check DMT office ({?msg1})."; 

msgs['DMT01186'] = "Please request it after inputting Details.({?msg1})."; 

msgs['DMT01187'] = "Please check Payer Info and save first!";

msgs['DMT01188'] = "Please select 'differenct' of by CNTR due to difference DMT office.";

msgs['DMT01189'] = "This INV was already Cancelled and recheck INV nbr.";

	/**
	 *
	 * 초기값 날짜 셋팅 :ex)21 : 오늘부터 21일 전 날짜. <br>
	 * <b>Example :</b>
	 *
	 * <pre>
	 *  var set_day = 21;
	 *  var formObject = document.form ;
	 *  var data = getDefaultDate(set_day).split(&quot;|&quot;);
	 * formObject.fm_dt.value = data[1];
	 * formObject.to_dt.value = data[0];
	 * &lt;pre&gt;
	 * @return 현재날짜 | 과거날짜
	 * @see #링크연결
	 * @author 최성환
	 * @version 2009.05.13
	 *
	 */
	
	function getDefaultDate(set_day) {
		var default_set_day = set_day;
		var today = new Date();
		var year = today.getYear();
		var month = today.getMonth() + 1;
		var day = today.getDate();
		if (month < 10) {
			month = "0" + month;
		}
		if (day < 10) {
			day = "0" + day;
		}
		var currDate = year + "-" + month + "-" + day;// 현재 날짜 생성

		var beforeDate = new Date(today.valueOf()
				- (default_set_day * 24 * 60 * 60 * 1000)); // default_set_day * 24*60*60*1000
		var beforeyear = beforeDate.getYear();
		var beforemonth = beforeDate.getMonth() + 1;
		var beforeday = beforeDate.getDate();

		if (beforemonth < 10) {
			beforemonth = "0" + beforemonth;
		}
		if (beforeday < 10) {
			beforeday = "0" + beforeday;
		}
		var beforeDate = beforeyear + "-" + beforemonth + "-" + beforeday;
		// 날짜 생성

		return currDate + "|" + beforeDate;
	}


	/**
	 * 	 * 멀티콤보 클릭 이벤트  <br>
	 * <b>Example :</b>
	 *
	 * @param comboObj	멀티콤보 오브젝트
	 * @param index		멀티콤보 index
	 * @param code		멀티콤보 code
	 * @return
	 */
	function setMultiCombo(comboObj, index, code) {
		//All 인 경우
	    if(index==0) {
	    	//checked
	    	if(comboObj.CheckIndex(index)) {
	    		for(var i = 1 ; i < comboObj.GetCount () ; i++) {
	    			comboObj.checkIndex(i) = true;
	    		}

	    	} else {
	    		for(var i = 1 ; i < comboObj.GetCount () ; i++) {
	    			comboObj.checkIndex(i) = false;
	    		}
	    	}
		//All 이 아닌 경우
	    } else {
	    	var checkCnt = 0;
    		for(var i = 1 ; i < comboObj.GetCount () ; i++) {
    			if(comboObj.checkIndex(i)) {
    				checkCnt++;
    			}
    		}
    		if(checkCnt == comboObj.GetCount ()-1) {
    			comboObj.checkIndex(0) = true;
    		}else{
    			comboObj.checkIndex(0) = false;
    		}
	    }
	}

	/**
	 * 키보드입력 값이 대문자인 경우 true 아니면 false
	 * @return
	 * @author:김태균
	 * @version:2009.06.16
	 */
	function isAlpha() {
		var keyValue = event.keyCode;

		if(keyValue >= 65 && keyValue <= 90){            //대문자
			return true;
        }else{
        	return false;
        }
	}
	 
	/**
	 * 키보드입력 값이 대문자, 숫자인 경우 true 아니면 false
	 * @return
	 * @author:김태균
	 * @version:2011.03.23
	 */
	function isAlphaNum() {
		var keyValue = event.keyCode;

		if((keyValue >= 65 && keyValue <= 90) 
				|| (keyValue >= 48 && keyValue <= 57) 
				|| (keyValue >= 96 && keyValue <= 105)){	//대문자,숫자
			return true;
        }else{
        	return false;
        }
	}

	/**
	 * 기존 ComKeyOnlyAlphabet(sFlag) 함수기능에서 예외문자 입력가능 기능 추가
	 * @param {string} sFlag 	선택,영문모드, default=""
     *                              영문모드+특수문자+숫자+공백 ("upperchar")
     * @param {string} sSubChar 선택,숫자이외의 부가 글자
     * @returns 없음
     * @author: 황효근
	 */
	function DmtComKeyOnlyAlphabet(sFlag, sSubChar)
    {
        try {
	        var keyValue = event.keyCode ? event.keyCode : event.which ? event.which : event.charCode;
            var bCanNum  = false;
            //ComDebug('key  = '+keyValue);

            if (sFlag==undefined || sFlag==null || sFlag.constructor!=String) sFlag="";
            sFlag = sFlag.toLowerCase();

            if(sFlag == 'upperall') {
            	if(keyValue >= 97 && keyValue <= 122){
            		event.keyCode = keyValue + 65 - 97;
            		event.returnValue = true;
            	} 
            	return;
            }else if(sFlag == "upperchar") {
            	if(keyValue >= 97 && keyValue <= 122){
            		event.keyCode = keyValue + 65 - 97;
            		event.returnValue = true;
            	} else if (keyValue >= 33 && keyValue <= 47){//
            		event.returnValue = true;
            	} else if(keyValue >= 48 && keyValue <= 57) {//숫자
            		event.returnValue = true;
            	} else if (keyValue >= 58 && keyValue <= 64){//
            		event.returnValue = true;
            	} else if (keyValue >= 91 && keyValue <= 96){//
            		event.returnValue = true;
            	} else if (keyValue >= 123 && keyValue <= 127){//
            		event.returnValue = true;
            	} 
            	return;
            }

            if (sFlag.length >= 3){
                if (sFlag.substr(sFlag.length-3)=="num") bCanNum=true;
                if (sFlag.length > 5) sFlag = sFlag.substr(0,5);
            }

        	if(keyValue >= 97 && keyValue <= 122){           //소문자
                if (sFlag=="upper") event.keyCode = keyValue + 65 - 97;
                event.returnValue = true;
            } else if(keyValue >= 65 && keyValue <= 90){            //대문자
                if (sFlag=="lower") event.keyCode = keyValue + 97 - 65;
                event.returnValue = true;
            } else if(bCanNum && keyValue >= 48 && keyValue <= 57) {//숫자
                event.returnValue = true;
            } else if(sSubChar != undefined && sSubChar != null && sSubChar.constructor==String && sSubChar.length > 0) {
            	//SubChar가 여러개 설정된 경우 여러개 글자 모두 처리한다.
            	for(var i=0; i<sSubChar.length; i++) {
            		//ComDebug("sSubChar.charAt(" + i + ")=" + sSubChar.charAt(i));
            		if (keyValue == sSubChar.charCodeAt(i)) {
		                event.returnValue = true;
		                return;
            		}
            	}
                event.returnValue = false;
            } else {
                event.returnValue = false;
            }
            return true;
        } catch(err) { ComFuncErrMsg(err.message); }
    }


	/**
	 * 여러개의 버튼 스타일을 Enable/Disable 상태로 한다.
	 * @param bEnable	boolean (true:Enable, false:Disable)
	 * @param objs		String (버튼 name)
	 * @return	없음
	 * @author	황효근
	 */
	function DmtComEnableManyBtns(bEnable, objs) {
        try {
            var args = arguments;
            if (args.length < 2) return;

            if(bEnable) {
				for(var i=1; i<args.length; i++) {
					ComBtnEnable(args[i]);
				}
            } else {
				for(var i=1; i<args.length; i++) {
					ComBtnDisable(args[i]);
				}
            }
        } catch(err) { ComFuncErrMsg(err.message); }
	}


	/**
	 * 여러 HTML Object의 Style Sheet ClassName을 지정한다.
	 * @param clsNm
	 * @param objs
	 * @return 없음
	 * @author	황효근
	 */
	function DmtComSetClassManyObjects(clsNm, objs) {
        try {
            var args = arguments;
            if (args.length < 2) return;

            for(var i=1; i<args.length; i++) {
                if (args[i].tagName != undefined) {
                	args[i].className = clsNm;
                }
            }
        } catch(err) { ComFuncErrMsg(err.message); }
    }


    /**
     * 입력값이 알파벳인지 여부를 확인한다. sFlag 인자는 다음과 같이 설정한다.<br>
     * sFlag="u" : 문자열이 모두 알파벳 대문자 인지 여부를 확인한다.<br>
     * sFlag="l" : 문자열이 모두 알파벳 소문자 인지 여부를 확인한다.<br>
     * sFlag="n" : 문자열이 알파벳과 숫자로만 구성된지 여부를 확인한다.<br>
     * sFlag="nl": 문자열이 알파벳 소문자과 숫자로만 구성된지 여부를 확인한다.<br>
     * sFlag="nu": 문자열이 알파벳 대문자과 숫자로만 구성된지 여부를 확인한다.<br>
     * sFlag=""  : 문자열이 모두 알파벳인지 여부를 확인한다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     ret = ComIsAlphabet("abcABC")       // 결과 : true
     *     ret = ComIsAlphabet("abcdef", "l")  // 결과 : true
     *     ret = ComIsAlphabet("ABCDEF", "u")  // 결과 : true
     *     ret = ComIsAlphabet("abc123", "n")  // 결과 : true
     *     ret = ComIsAlphabet("abc123")       // 결과 : false
     *     ret = ComIsAlphabet(txtName)        // 결과 : false, txtName="한진해운"인 경우
     * </pre>
     * @param {string,object} obj   필수,문자열 또는 HTML태그(Object)
     * @param {string}        sFlag 선택,결과선택인자, default=""
     * @returns bool<br>
     *          true-알파벳일 경우<br>
     *          false-알파벳이 아닐 경우
     * @see #ComIsKorean
     */
    function DMTComIsAlphabet(obj, sFlag) {
        try {
            //첫번째 인자가 문자열 또는 HTML태그(Object)인 경우 처리
            var sVal = getArgValue(obj);

            if (sVal=="") return false;

            var re;
            if (sFlag==undefined || sFlag==null) sFlag = "";
            switch (sFlag.toLowerCase())
            {
                case "u":   //only upper
                    re = /[^A-Z]/;
                    break;
                case "l":   //only lower
                    re = /[^a-z]/;
                    break;
                case "n":   //alpha number
                    re = /[^a-z|A-Z|0-9|]/;
                    break;
                case "nl":   //alpha number
                    re = /[^a-z|0-9|]/;
                    break;
                case "nu":   //alpha number
                    re = /[^A-Z|0-9|]/;
                    break;
                default:    //alphabet
                    re = /[^a-z|A-Z]/;
                    break;
            }
            return !re.test(sVal)
        } catch(err) { ComFuncErrMsg(err.message); }
    }

    function DMTtrimCurrencyAmount(curr_cd, amt) {
    	var prm_cur = "";
    	var prm_amt = 0.0;
    	var tmp_amt = 0.0;

		prm_cur = curr_cd;
		prm_amt = amt;

		switch(prm_cur) {
			case "KRW":
			case "JPY":
			case "BEF":
			case "DJF":
			case "ESP":
			case "GRD":
			case "ITL":
			case "LAK":
			case "MGF":
			case "MRO":
			case "MXP":
			case "PTE":
			case "SDD":
			case "MXN":
				// 소수점 이하 절삭
				tmp_amt = ComTrunc(prm_amt, 0);
				break;
				
			case "TWD":
			case "IDR":
			case "VND":		
				// 소수점 이하 반올림
				tmp_amt = ComRound(prm_amt, 0);
				break;
				
			default:
				// 소수점 2자리 반올림
				tmp_amt = ComRound(prm_amt, 2);
		}
		
		return tmp_amt;
    }

     /**
      * 요청 데이타에서 포맷 지정.
      * @param data
      * @return ComAddComma2(ComRound(data, 2)+'' ,"#,###.00")
 	  * @author	최성환
      */
	function DmtComSetComma(data){
		return ComAddComma2(ComRound(data, 2)+'' ,"#,###.00");
	}

	/**
	 * Payer Code를 입력시 Payer Name을 조회하는 함수
	 * @param {ibsheet}	sheet_obj
	 * @param {form}	formObj
	 * @param {object}	obj_code
	 * @param {object}	obj_name
	 * @author	김태균
	 */
	function DmtComPayer(sheetObj, formObj, obj_code, obj_name) {
		sheetObj.ShowDebugMsg = false;
		sheetObj.WaitImageVisible = false;

		var cust_len = parseInt(ComGetLenByByte(ComGetObjValue(obj_code)));

		if(cust_len == 0){
			ComSetObjValue(obj_code, "");
			ComSetObjValue(obj_name, "");
			ComSetObjValue(formObj.s_cust_cd, "");
			ComSetObjValue(formObj.s_cust_gubun, "");
			return;
		}

		var cre_cnt_cd = "";

		if(cust_len > 2) {
			var char_chk = ComGetObjValue(obj_code).substring(0,2);
			//2자리가 영문자이면 CUSTOMER 조회
			if(ComIsAlphabet(char_chk)) {
				ComSetObjValue(formObj.s_cust_gubun, "2");
			//아니면 VENDOR 조회
			}else{
				ComSetObjValue(formObj.s_cust_gubun, "1");
			}
		}else{
			ComShowCodeMessage("DMT00165", "Payer");
			ComSetObjValue(obj_code, "");
			ComSetObjValue(obj_name, "");
			ComSetObjValue(formObj.s_cust_cd, "");
			ComSetObjValue(formObj.s_cust_gubun, "");
			return;
		}

		ComSetObjValue(formObj.f_cmd, "SEARCH20");

		var sXml 	= sheetObj.GetSearchXml("DMTCommonFinderGS.do", FormQueryString(formObj));
		var cust_cd = ComGetEtcData(sXml, "PAYER_CODE");
		var cust_nm = ComGetEtcData(sXml, "PAYER_NM");
		var delt_flg = ComGetEtcData(sXml, "DELT_FLG");

		if(cust_nm == null || cust_nm == "") {
			ComSetObjValue(formObj.s_cust_gubun, "");
			ComSetObjValue(formObj.s_cust_cd, "");
			ComSetObjValue(obj_code, "");
			ComSetObjValue(obj_name, "");
			ComShowCodeMessage("DMT00165", "Payer");
			ComSetFocus(obj_code);
		}else{
			ComSetObjValue(obj_code, cust_cd);
			ComSetObjValue(obj_name, cust_nm);
		}

	    sheetObj.WaitImageVisible = true;
	}

	/**
	 * Payer Code를 입력시 Payer Name을 조회하는 함수(입력화면용)
	 * @param {ibsheet}	sheet_obj
	 * @param {form}	formObj
	 * @param {object}	obj_code				PAYER_CODE
	 * @param {object}	obj_name				PAYER_NAME
	 * @param {string} session_cnt_cd			SESSION 국가코드
	 * @param {string} invoice_create_cnt_cd	INVOICE CREATE 국가코드
	 */
	function DmtComPayerModify(sheetObj, formObj, obj_code, obj_name, session_cnt_cd, invoice_create_cnt_cd) {

		sheetObj.ShowDebugMsg = false;
		sheetObj.WaitImageVisible = false;

			var cust_len = parseInt(ComGetLenByByte(ComGetObjValue(obj_code)));

			if(cust_len == 0){
				ComSetObjValue(obj_code, "");
				ComSetObjValue(obj_name, "");
				ComSetObjValue(formObj.s_cust_cd, "");
				ComSetObjValue(formObj.s_cust_gubun, "");
				return;
			}

			var cre_cnt_cd = "";

			if(cust_len > 2) {
				//Invoice 생성전
				if(ComGetObjValue(formObj.invoice_issue) == "1" ) {
					cre_cnt_cd = session_cnt_cd;
				//Invoice 생성후
				}else if(ComGetObjValue(formObj.invoice_issue) == "2" ) {
					cre_cnt_cd = invoice_create_cnt_cd;
				}

				//vendor, customer 조회 가능
				if(cre_cnt_cd == "CA" || cre_cnt_cd == "US") {
					var char_chk = ComGetObjValue(obj_code).substring(0,2);
					//2자리가 영문자이면 CUSTOMER 조회
					if(ComIsAlphabet(char_chk)) {
						if(cust_len == 8){
							ComSetObjValue(formObj.s_cust_gubun, "2");
						}else{
							ComShowCodeMessage("DMT00165", "Payer");
							return;
						}
					//아니면 VENDOR 조회
					}else{
						if(cust_len == 6){
							ComSetObjValue(formObj.s_cust_gubun, "1");
						}else{
							ComShowCodeMessage("DMT00165", "Payer");
							return;
						}
					}
				//customer 만 조회 가능
				}else{
					//2자리가 영문자이면 CUSTOMER 조회
					if(ComIsAlphabet(char_chk)) {
						ComSetObjValue(formObj.s_cust_gubun, "2");
					//아니면 에러
					}else{
						ComShowCodeMessage("DMT00165", "Payer");
						return;
					}
				}
			}else{
				ComShowCodeMessage("DMT00165", "Payer");
				ComSetObjValue(formObj.s_cust_gubun, "");
				ComSetObjValue(formObj.s_cust_cd, "");
				ComSetObjValue(obj_code, "");
				ComSetObjValue(obj_name, "");
				return;
			}

			ComSetObjValue(formObj.f_cmd, "SEARCH20");

			var sXml 	= sheetObj.GetSearchXml("DMTCommonFinderGS.do", FormQueryString(formObj));
			var cust_cd = ComGetEtcData(sXml, "PAYER_CODE");
			var cust_nm = ComGetEtcData(sXml, "PAYER_NM");
			var delt_flg = ComGetEtcData(sXml, "DELT_FLG");

			if(cust_nm == null || cust_nm == "") {
				ComSetObjValue(formObj.s_cust_gubun, "");
				ComSetObjValue(formObj.s_cust_cd, "");
				ComSetObjValue(obj_code, "");
				ComSetObjValue(obj_name, "");
				ComShowCodeMessage("DMT00165", "Payer");
				ComSetFocus(obj_code);
			}else{
				ComSetObjValue(obj_code, cust_cd);
				ComSetObjValue(obj_name, cust_nm);

			}

	    sheetObj.WaitImageVisible = true;
	}
	 

	/**
	 * 해당 페이지가 메뉴/팝업 형식 모두 지원할 경우, 각 형식에 따른 navigation, title 영역 태그를 써준다.
	 * @param bPopup 팝업여부
	 * @return 없음
	 * @author 황효근
	 */
	function DmtComPageTitle(bPopup) {
			
		try {
            var sTag = "";
            
            if (bPopup== undefined || bPopup== null) bPopup = false;
            
            sTag += '<tr><td class="history">';
            
            if(bPopup) {
            	sTag += '<span id="navigation"></span></td></tr>\n';
            	sTag += '<tr><td class="title"><img src="img/icon_title_dot.gif" align="absmiddle"><span id="title2"></span></td></tr>\n';
            } else {
            	sTag += '<img src="img/icon_history_dot.gif" align="absmiddle"><span id="navigation"></span></td></tr>\n';
            	sTag += '<tr><td class="title"><img src="img/icon_title_dot.gif" align="absmiddle"><span id="title"></span></td></tr>\n';
            }
            
            document.write(sTag);
            
        } catch(err) { ComFuncErrMsg(err.message); }
	}
	
	/**
	 * 로그인 사용자의 Office 에 해당되는 현재 날짜를 조회 합니다.
	 * @param {form}	formObj
	 * @return {string} ofc_curr_day
	 * @author 이성훈
	 */	 
	function DmtComOfficeCurrDate(sheetObj, formObj) {
		 
		//1.조회전 파라미터를 입력하거나 선택된 값으로 설정해준다.
		ComSetObjValue(formObj.f_cmd, SEARCHLIST11);
		
		// Waiting Image 비활성화
		sheetObj.WaitImageVisible=false;
		
		//2.조회조건으로 조회실행
		var sXml = sheetObj.GetSearchXml("DMTCommonFinderGS.do", FormQueryString(formObj));
		
		// Waiting Image 활성화
		sheetObj.WaitImageVisible=true;
		
		//3.조회결과를 설정해준다.
		var ofcCurrDay = ComGetEtcData(sXml, "OFC_CURR_DAY");
		
	    if (ofcCurrDay != undefined && ofcCurrDay != "")
	    	return ComGetMaskedValue(ofcCurrDay, "ymd");
	    else
	    	return ComGetNowInfo();
	}	 
	
	
	   /**
	   *<PRE>
  * IN조건문에  1000개 이상 데이타가 입력되어야 할경우
  * 피봇팅 함수를 사용하여 가상 테이블로  IN 조건문에 대입해야한다.
  * 즉 BKG_SPLIT_CLOB_FNC메소드를 사용해서 피봇팅을 해야 하는데,
  * 문제는 4000바이트 이상 입력되면 에러가 발생한다.
  *
  * 따라서 아래 메소드를 사용하여, 문제를 해결한다.
  *
  * <br><b>Example :</b>
  * WHERE BKG_NO IN ( SELECT COLUMN_VALUE FROM table(BKG_SPLIT_CLOB_FNC(:bkg_nos)) )
  *  getStringToClobString("SEL000086100,SEL000088300,SEL000089400,SEL000090300",3)
  * :bkg_nos>> to_clob('SEL000086100,SEL000088300,SEL000089400,') || to_clob('SEL000090300')
  * <br>
  * </pre>
  * @param {string} src 조회대상, 필수
  * @param {number} cnt 묶음 개수 , default = 1
  * @param {string} 델리미터, default = ","
  * @param {string} before_str 묶음 앞 문자 default = "to_clob("
  * @param {string} after_str  묶음 뒤 문자 default = ")"
  * @return String
  * @author 김경섭
  * @version 2010.03.25
  */
	function getStringToClobString(src, cnt, del_str ,before_str, after_str){
	 if( src == null) return "";

	 if(before_str == null || before_str =="") before_str = "to_clob(";
	 if(after_str == null  || after_str  =="") after_str  = ")";
	 if(cnt == null  || eval(cnt) == 0 ) cnt = 1;
	 if(del_str == null  || del_str =="" ) del_str = ",";

	 if (typeof(src) =="string")
			return getArrayToClobString(src.split(del_str), cnt, before_str, after_str,del_str);
	 else if (typeof(src) =="object")
			return getArrayToClobString(src, cnt, before_str, after_str,del_str);
	}

	//getStringToClobString 내부 메소드
	function getArrayToClobString(src, cnt, before_str, after_str,del_str){

		 var result_str = "";
		 var real_cnt = 1;
		 for (var i = 0; i < src.length ; i++) {

				if(src[i] == null  || src[i] =="") continue;

				// 시작부분
				if( cnt == 1 || real_cnt%cnt ==1) {
				   //연결부분
					 if(real_cnt != 1 ) {
							result_str += "||";
					 }
					 result_str += before_str+"'";
				}

				//데이타 부분
				result_str += ComTrim(src[i]);

				if(i != src.length -1) {
					result_str +=del_str;
				}

				//마감부분
				if(cnt == 1 || (real_cnt != 1 && real_cnt%cnt ==0) ) {
					result_str += "'"+after_str;
				}

				real_cnt++;

		 }

				//마감부분
				if(cnt != 1 && (real_cnt-1)%cnt !=0)  {
					result_str += "'"+after_str;
				}


		 return result_str;
	}
	
	function DmtIsEmailAddr(obj) {
 		try {
            //첫번째 인자가 문자열 또는 HTML태그(Object)인 경우 처리
            var retArr = obj.split(";");

            for ( var i = 0; i < retArr.length; i++) {

            	if(retArr[i].trim() != ""){ 
	            	var sVal = getArgValue(retArr[i]);
	            	var format =  /^\s*[\w\~\-\.]+\@[\w\~\-]+(\.[\w\~\-]+)+\s*$/g;
	            	
	            	if(sVal.search(format) == -1&& sVal != ""){
	            		break;
		            }
            	}else{
            		if(sVal == "" || sVal == null||sVal == undefined){
            			return;
            		}
            		
            		break;
            	}
            }

            return (sVal.search(format) != -1);
            
        } catch(err) { ComFuncErrMsg(err.message); }
	}        
       
	/**
	 * Charge Deletion 요청이 가능한 상태인지를 체크합니다.
	 * @param {string}	cntrNo
	 * @param {string}	chgDeltRqstSts
	 * @return {boolean}
	 * @author 이성훈
	 */	     
	function isValidChgDeltRqst(bkgNo, cntrNo, trfCd, chgDeltRqstSts) {
		
		var isValid = false;
		/*
		 * N : Charge Deletion 요청상태가 아님
		 * B : BBG Approval
		 * E : BBG Reject
		 * Q : RHQ Approval
		 * F : RHQ Reject
		 * H : HO  Approval
		 * G : HO  Reject
		 * C : Request Cancel
		 * R : Request
		 * X : Charge Deletion 요청에 대한 필수최종승인처리가 완료된 상태(Charge Deletion 요청 불가, Charge Deletion Cancel 불가)
		 */

		if (chgDeltRqstSts == "N" || chgDeltRqstSts == "J"||chgDeltRqstSts == "E"||chgDeltRqstSts == "F"||chgDeltRqstSts == "G"||chgDeltRqstSts == "R") {
			isValid = true;
		}
//		else if (chgDeltRqstSts == "R") {
//			ComShowCodeMessage('DMT01155');
//		}
		else {
			// Charge Deletion 요청에 대한 승인이력이 존재합니다.
			// DMT01176 : BKG nbr / CNTR / DMT type is processing Inactive
			ComShowCodeMessage('DMT01176', bkgNo, cntrNo, trfCd);
		}
		
		return isValid;
	}

	/**
	 * Charge Deletion 요청을 취소할 수 있는지 여부를 체크합니다.
	 * @param {string}	bkgNo
	 * @param {string}	cntrNo
	 * @param {string}	trfCd
	 * @param {string}	chgDeltRqstSts
	 * @return {boolean}
	 * @author 이성훈
	 */	
	function isValidChgDeltRqstCancel(bkgNo, cntrNo, trfCd, chgDeltRqstSts) {
		
		var isValid = false;
		/*
		 * N : Charge Deletion 요청상태가 아님
		 * B : BBG Approval
		 * E : BBG Reject
		 * Q : RHQ Approval
		 * F : RHQ Reject
		 * H : HO  Approval
		 * G : HO  Reject
		 * C : Request Cancel
		 * R : Request
		 * X : Charge Deletion 요청에 대한 필수최종승인처리가 완료된 상태(Charge Deletion 요청 불가, Charge Deletion Cancel 불가)
		 */
		if (chgDeltRqstSts == "R") {
			isValid = true;
		}
		else if (chgDeltRqstSts == "N") {
			// DMT01177 : The case is not requested for deletion
			ComShowCodeMessage('DMT01177');
		}
		else {
			// DMT01176 : BKG nbr / CNTR / DMT type is processing Inactive
			ComShowCodeMessage('DMT01176', bkgNo, cntrNo, trfCd);
		}

		return isValid;
	}
	
	/**
	 * Charge Deletion 요청중 상태인지 체크합니다.
	 * @param {string}	chgDeltRqstSts
	 * @return {boolean}
	 * @author 이성훈
	 */	
	function isProcessingInactive(chgDeltRqstSts) {
		
		var isValid = false;
		/*
		 * N : Charge Deletion 요청상태가 아님
		 * B : BBG Approval
		 * E : BBG Reject
		 * Q : RHQ Approval
		 * F : RHQ Reject
		 * H : HO  Approval
		 * G : HO  Reject
		 * C : Request Cancel
		 * R : Request
		 * X : Charge Deletion 요청에 대한 필수최종승인처리가 완료된 상태(Charge Deletion 요청 불가, Charge Deletion Cancel 불가)
		 */
		
		switch (chgDeltRqstSts) {
			case "B":		// BB Approval
//			case "E":		// BB Reject
			case "Q":		// RHQ Approval
//			case "F":		// RHQ Reject
			case "H":		// HO Approval
//			case "G":		// HO Reject
				isValid = true
			break;
		}

		return isValid;
	}	
	

	/**
	 * Charge Deletion Reject 상태인지 체크합니다.
	 * @param {string}	chgDeltRqstSts
	 * @return {boolean}
	 * @author 이성훈
	 */	
	function isProcessingInactiveReject(chgDeltRqstSts) {
		
		var isValid = false;
		/*
		 * N : Charge Deletion 요청상태가 아님
		 * B : BBG Approval
		 * E : BBG Reject
		 * Q : RHQ Approval
		 * F : RHQ Reject
		 * H : HO  Approval
		 * G : HO  Reject
		 * C : Request Cancel
		 * R : Request
		 * X : Charge Deletion 요청에 대한 필수최종승인처리가 완료된 상태(Charge Deletion 요청 불가, Charge Deletion Cancel 불가)
		 */
		
		switch (chgDeltRqstSts) {
//			case "B":		// BB Approval
			case "E":		// BB Reject
//			case "Q":		// RHQ Approval
			case "F":		// RHQ Reject
//			case "H":		// HO Approval
			case "G":		// HO Reject
			case "J":		// Deletion Reject
				isValid = true
			break;
		}

		return isValid;
	}	
	
	/**
	 * --------------------------------------------------------
	 * 이하 INVOICE 공통 함수
	 * 사용화면 : EES_DMT_3109, EES_DMT_4002, EES_DMT_4004
	 * --------------------------------------------------------*/	
	var EES_DMT_4002_WIDTH  = "1036";
	var EES_DMT_4002_HEIGHT = "770";

	var EES_DMT_3109_WIDTH  = "1036";
	var EES_DMT_3109_HEIGHT = "770";
	
	var IBSEARCH_IDA_TAX = 101;	// 인도세법 변경 후 Payer 에 따라 인도TAX RATIO 를 조회합니다.
	var IBSEARCH_ATTN    = 110;	// Payer 의 Attention 목록을 조회합니다.
	
	/*
	 * 인도TAX 관련 정보조회를 실행하는 공통함수
	 * 사용화면 : 
	 * EES_DMT_3108 ( Demand Note Issue by Group )
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * EES_DMT_4004 ( Manual Invoice Creation & Issue )
	 * EES_DMT_4013 ( Invoice Creation - Group )
	 */
    // Sheet관련 프로세스 처리
    function DMTComDoActionIBSheet(sheetObj, formObj, sAction) {
        sheetObj.ShowDebugMsg = false;
        
        switch(sAction) {
    	//=================================================================================================        
    	// 변경일자 : 2017.07.27 
		// 변경요건 : 인도 TAX 변경에 따른 수정        
    	// 변경내용 : 화면 Load 시점에 필요한 기본정보를 조회한다.( User Country, India Tax... )
    	//=================================================================================================
        case IBSEARCH_INIT:
    		
    		// 1.조회전 파라미터를 입력하거나 선택된 값으로 설정해준다.
    		ComSetObjValue(formObj.f_cmd, SEARCH03);
    		
    		// 2.조회조건으로 조회실행					
    		var sXml = sheetObj.GetSearchXml("EES_DMT_4002GS.do", FormQueryString(formObj)); 
    		
    		// 3.조회후 결과처리
    		ComSetObjValue(formObj.usr_cnt_cd,       ComGetEtcData(sXml, "USR_CNT_CD"));
    		ComSetObjValue(formObj.ida_tax_appl_tm,  ComGetEtcData(sXml, "IDA_TAX_APPL_TM"));
        	ComSetObjValue(formObj.ida_bank_acct_no, ComGetEtcData(sXml, "IDA_BANK_ACCT_NO"));
        	ComSetObjValue(formObj.ida_bank_ifsc_cd, ComGetEtcData(sXml, "IDA_BANK_IFSC_CD"));
    		
    		var pgmId = ComGetObjValue(formObj.pgm_id);
    		// 메뉴 ( EES_DMT_4002, EES_DMT_4004, EES_DMT_4013 ) 에 따라서 존재여부가 달라지는 항목들에 대한 처리
    		switch (pgmId) {
    			case "4002":
    			case "4004":
	    		case "4013":
    				ComSetObjValue(formObj.ofc_curr_date, ComGetEtcData(sXml, "OFC_CURR_DAY"));
	    			break;
    		}

    		// Manual Invoice 에만 필요한 초기항목 설정!!
    		if (pgmId == "4004") {
				// 1. Tariff Type
				var tariffList 		= ComGetEtcData(sXml, "TARIFF").replace("All=All|", "");
				addMultiComboItem(comboObjects[0], tariffList.split(ROWMARK));
				
				// 2. Manual Invoice Reason
				var mnlInvRsnList	= " " + FIELDMARK + " " + ROWMARK + ComGetEtcData(sXml, "INV_RSN");
				addComboItem(formObj.reason, mnlInvRsnList, false, true);
				
				// 3.Receive Term
				ComClearCombo(formObj.rcvTermCd);
				rcvTermList 	= " " + FIELDMARK + " " + ROWMARK + ComGetEtcData(sXml, "RCV_TERM");
				addComboItem(formObj.rcvTermCd, rcvTermList, false, true);
				
				// 4.Delivery Term
				ComClearCombo(formObj.deTermCd);
				deTermList 		= " " + FIELDMARK + " " + ROWMARK + ComGetEtcData(sXml, "DE_TERM");
				addComboItem(formObj.deTermCd, deTermList, false, true);
				
				// 5.User Country Code
				ComSetObjValue(formObj.usr_cnt_cd,  ComGetEtcData(sXml, "USR_CNT_CD"));
				
				// 6.Invoice Currency
				ComClearCombo(formObj.inv_curr_cd);
				invCurrList	= ComGetEtcData(sXml, "AR_CURRENCY");
				addComboItem(formObj.inv_curr_cd, invCurrList, true);
				
            	//2011.03.10. kimtk. invoiceCurrency default no select
            	formObj.inv_curr_cd.selectedIndex = -1;    

            	// 7. 인도 TAX
            	ComSetObjValue(formObj.ida_tax_appl_tm,      ComGetEtcData(sXml, "IDA_TAX_APPL_TM"));
            	ComSetObjValue(formObj.ida_expn_tax_rt,      ComGetEtcData(sXml, "IDA_EXPN_TAX_RT"));
            	ComSetObjValue(formObj.ida_edu_tax_rt,       ComGetEtcData(sXml, "IDA_EDU_TAX_RT"));
            	ComSetObjValue(formObj.ida_high_edu_tax_rt,  ComGetEtcData(sXml, "IDA_HIGH_EDU_TAX_RT"));
            	ComSetObjValue(formObj.ida_locl_tax_rt,      ComGetEtcData(sXml, "IDA_LOCL_TAX_RT"));
            	ComSetObjValue(formObj.ida_n2nd_locl_tax_rt, ComGetEtcData(sXml, "IDA_N2ND_LOCL_TAX_RT"));
            	
            	// 8.India Tax 관련항목을 보여준다.
            	DmtComDisplayIdaTax();            	
    		}
    		
    		break;
    		
       	//=================================================================================================        
       	// 변경일자 : 2017.07.27 
   		// 변경요건 : 인도 TAX 변경에 따른 수정        
       	// 변경내용 : 인도세법 변경 후, Payer 정보가 변경될 때 마다, TAX 를 조회합니다.
       	//=================================================================================================
       	case IBSEARCH_IDA_TAX:
       		//1.조회전 파라미터를 입력하거나 선택된 값으로 설정해준다.
       		var payerCd = ComGetObjValue(formObj.payer_cd);
       		var custVndrDivCd = payerCd.length == 8 ? "C" : "V";
       		ComSetObjValue(formObj.cust_vndr_div_cd, custVndrDivCd);
       		if (custVndrDivCd == "C") {
       			ComSetObjValue(formObj.cust_cnt_cd, payerCd.substring(0, 2));
       			ComSetObjValue(formObj.cust_seq,    payerCd.substring(2));
       			ComSetObjValue(formObj.vndr_seq,    "");
       		}
       		else {
       			ComSetObjValue(formObj.cust_cnt_cd, "");
       			ComSetObjValue(formObj.cust_seq,    "");        			
       			ComSetObjValue(formObj.vndr_seq,    payerCd);
       		}
       		var ioBnd = ComGetObjValue(formObj.dmdt_trf_cd).substring(3, 4);
       		var portCd = ioBnd == "O" ? ComGetObjValue(formObj.por_cd) : ComGetObjValue(formObj.del_cd);
       		ComSetObjValue(formObj.port_cd, portCd);
       		ComSetObjValue(formObj.cond_ida_sac_cd, "996719");
       		ComSetObjValue(formObj.f_cmd, SEARCH04);
       		
       		//2.조회조건으로 조회실행					
       		var sXml = sheetObj.GetSearchXml("EES_DMT_4002GS.do", FormQueryString(formObj)); 
       		
       		//3.조회후 결과처리 ( 인도Tax 는 미세조정을 위해서 수정이 가능해야 됨 )
       		var idaCgstRto = ComGetEtcData(sXml, "IDA_CGST_RTO");
			var idaSgstRto = ComGetEtcData(sXml, "IDA_SGST_RTO");
			var idaIgstRto = ComGetEtcData(sXml, "IDA_IGST_RTO");
			var idaUgstRto = ComGetEtcData(sXml, "IDA_UGST_RTO");
			
			DmtComSetIdaTaxObj(formObj.ida_cgst_amt, formObj.ida_cgst_rto, idaCgstRto);
			DmtComSetIdaTaxObj(formObj.ida_sgst_amt, formObj.ida_sgst_rto, idaSgstRto);
			DmtComSetIdaTaxObj(formObj.ida_igst_amt, formObj.ida_igst_rto, idaIgstRto);
			DmtComSetIdaTaxObj(formObj.ida_ugst_amt, formObj.ida_ugst_rto, idaUgstRto);
       		
       		ComSetObjValue(formObj.ida_gst_rgst_no, ComGetEtcData(sXml, "IDA_GST_RGST_NO"));
       		ComSetObjValue(formObj.ida_gst_rgst_sts_nm, ComGetEtcData(sXml, "IDA_GST_RGST_STS_NM"));
       		ComSetObjValue(formObj.ida_ste_cd, ComGetEtcData(sXml, "IDA_STE_CD"));
       		ComSetObjValue(formObj.ida_ste_nm, ComGetEtcData(sXml, "IDA_STE_NM"));
       		ComSetObjValue(formObj.ida_sac_cd, ComGetEtcData(sXml, "IDA_SAC_CD"));
       		ComSetObjValue(formObj.ida_sac_nm, ComGetEtcData(sXml, "IDA_SAC_NM"));

       		break;  
       		
        }
    }
    
    /*
     * 인도 Tax Ratio, Tax Amount 항목의 상태와 값을 설정해 줍니다.
     */
    function DmtComSetIdaTaxObj(objTaxAmt, objTaxRto, valTaxRto) {
    	var formObj = document.form;
    	
    	var isEnableObj = false; 
    	// Tax Amount 는 A/R I/F 전에만 수행가능합니다.
    	// Tax Ratio 가 0 인 Tax Amount 는 미세조정할 금액이 존재하지 않으므로 비활성화 시켜준다.
    	if (ComGetObjValue(formObj.dmdt_ar_if_cd) != "Y") {
    		isEnableObj = valTaxRto == "0" ? false : true;
    	}

    	// 활성화/비활성화된 Tax Amount 항목의 배경색을 변경해 줍니다.
    	var objClsName  = isEnableObj ? "input1" : "input2";
    	
    	// Tax Ratio 항목에 조회된 Ratio 값을 설정해 줍니다.
    	ComSetObjValue(objTaxRto, valTaxRto);
    	// Tax Ratio 에 따라 Tax Amount 항목을 활성화/비활성화 시켜줍니다.
    	ComEnableObject(objTaxAmt, isEnableObj);
    	// Tax Amount 항목의 활성화/비활성화 상태에 따라 배경색을 변경해 줍니다.
    	objTaxAmt.className = objClsName;
    }
        
    /*
     * 화면 콤보항목에 대한 데이터를 조회해서 Load 시켜줍니다.
     */
    function DMTComDoActionIBCombo(sheetObj, formObj, sAction) {
        sheetObj.ShowDebugMsg = false;
		sheetObj.WaitImageVisible = false;
		
        switch(sAction) {    	
        //=================================================================================================        
        // 변경일자 : 2017.07.27 
       	// 변경요건 : 인도 TAX 변경에 따른 수정        		
        // 변경내용 : Payer 의 Attention List를 조회한다.
        //=================================================================================================
        case IBSEARCH_ATTN:
			//1.조회전 파라미터를 입력하거나 선택된 값으로 설정해준다.
			ComSetObjValue(formObj.f_cmd, SEARCHLIST03);

			//2.조회조건으로 조회실행
			//*********************************************************************************
			ComOpenWait(true);
			sheetObj.WaitImageVisible = false;
			//*********************************************************************************
			
			var sXml = sheetObj.GetSearchXml("DMTCommonFinderGS.do", FormQueryString(formObj));

			//*********************************************************************************
			ComOpenWait(false);
			//*********************************************************************************
			
			//3.조회후 결과처리
			var attnList = ComGetEtcData(sXml, "ATTENTION");
			
			//3-1.Attention 에 기존 목록 삭제 후 조회된 데이터로 목록 재생성
			var cboAttention = ComGetObjValue(formObj.pgm_id) == "4004" ? comboObjects[1] : comboObjects[0];
			cboAttention.RemoveAll();
			if (attnList != undefined && attnList.length > 0) {
				DmtComLoadComboData(cboAttention, attnList.split(ROWMARK));
			}    	
			
			break;
        }
        
        sheetObj.WaitImageVisible = true;
    }
    
	/**
     * Attention 콤보필드에 데이터를 추가해준다.
     */	
	function DmtComLoadComboData(comboObj, comboItems) {
    	for (var i = 0 ; i < comboItems.length ; i++) {
    		var comboItem = comboItems[i].split(FIELDMARK);
			comboObj.InsertItem(i, comboItem[0]+"|"+comboItem[1]+"|"+comboItem[2]+"|"+comboItem[3], comboItem[4]);	
    	}   		
	}    
    
	/**
     * Attention 의 선택이 변경되면 변경되어진 Attention 의 Tel., Fax, E-mail 정보를 설정해준다. 
     */	
	function DmtComSetAttention() {
		
		var formObj = document.form;

		var cboAttention = ComGetObjValue(formObj.pgm_id) == "4004" ? comboObjects[1] : comboObjects[0];

		ComSetObjValue(formObj.dmdt_payr_cntc_pnt_nm, cboAttention.GetText(cboAttention.Code,0));
		ComSetObjValue(formObj.payr_cntc_pnt_phn_no,  cboAttention.GetText(cboAttention.Code,1));	//텍스트 컬럼 보여주기
		ComSetObjValue(formObj.payr_cntc_pnt_fax_no,  cboAttention.GetText(cboAttention.Code,2));	//텍스트 컬럼 보여주기
		ComSetObjValue(formObj.payr_cntc_pnt_eml,     cboAttention.GetText(cboAttention.Code,3));	//텍스트 컬럼 보여주기
		
		var codes = cboAttention.Code.split("^");			//code
		if (codes != undefined || codes != "") {
			ComSetObjValue(formObj.cust_cntc_pnt_seq, codes[1]);
		}		
	}
	
	/**
	 * --------------------------------------------------------
	 * Tax Amount 변경시 Invoice Amt 를 계산한다.
	 * --------------------------------------------------------
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * 인도TAX 관련 정보조회를 실행하는 공통함수
	 * 사용화면 : 
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * EES_DMT_4004 ( Manual Invoice Creation & Issue )
	 * --------------------------------------------------------
	 * */	
	function DmtComCalcInvAmtByCngTaxAmt(obj) {
		var formObj = document.form;
		
		// obj : 인도 TAX AMT 항목 ( SGST AMT, CGST AMT, IGST AMT ,UGST AMT )
		
		// Invoice Amount 계산 로직을 실행하기 전, Tax Amount 변경에 의해서 실행됨을 알려준다.
		ComSetObjValue(formObj.calc_by_cng_ida_tax_amt, "Y");

		DmtComCalcInvAmtByTaxAmt();
		
		// Invoice Amount 계산 로직 실행종료 후, Tax Amount 도 Tax Ratio 에 기반해서 계산되도록 원복해준다.
		ComSetObjValue(formObj.calc_by_cng_ida_tax_amt, "N");
	}
	
	/**
	 * --------------------------------------------------------
	 * INV Cur 변경시 ExRate를 조회하고 Invoice Amt 를 계산한다.
	 * --------------------------------------------------------
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * 인도TAX 관련 정보조회를 실행하는 공통함수
	 * 사용화면 : 
	 * EES_DMT_3108 ( Demand Note Issue by Group )
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * EES_DMT_4004 ( Manual Invoice Creation & Issue )
	 * EES_DMT_4013 ( Invoice Creation - Group )
	 * --------------------------------------------------------
	 */
	function DmtComCalcInvAmtByTaxAmt() {
		var formObj = document.form;

		var pgmId = ComGetObjValue(formObj.pgm_id);
		// Group Demand Note, Group Invoice 메뉴화면의 Tax Amount, Invoice Amount 계산
		if (pgmId == "3108" || pgmId == "4013") {
			// 사용화면 : EES_DMT_3108, EES_DMT_4013
			DmtComGroupCalcInvAmtByTaxAmt();
		}
		// Manual Invoice 메뉴화면의 Tax Amount, Invoice Amount 계산
		else if (pgmId == "4004") {
			// 사용화면 : EES_DMT_4004
			DmtComManualCalcInvAmtByTaxAmt();
		}
		// Demand Note, Invoice 메뉴화면의 Tax Amount, Invoice Amount 계산
		else {
			// 사용화면 : EES_DMT_3109, EES_DMT_4002
			DmtComGeneralCalcInvAmtByTaxAmt();
		}
		
		// 금액으로 표시함.
		DmtComDisplayCurrency();
		//====================================================================================================================================================
	}
	
	/**
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * Tax Amount, Invoice Amount 금액 계산
	 * --------------------------------------------------------
	 * 사용화면 : 
	 * EES_DMT_3108 ( Demand Note Issue by Group )
	 * EES_DMT_4013 ( Invoice Creation - Group )
	 * --------------------------------------------------------*/
	function DmtComGroupCalcInvAmtByTaxAmt() {
		var formObj  = document.form;
		var sheetObj = sheetObjects[0];
		
		// Invoice 을 생성하는 방식에 따라서 계산하는 방식이 각각 달라진다.
		// GRP : 다수개의 BKG 를 1개의 Invoice 로 생성, BKG : BKG 당 1개의 Invoice 로 생성
		var invCreTpCd = ComGetObjValue(formObj.s_group_inv); 
		var invCurrCd  = ComGetObjValue(formObj.inv_curr_cd);
		
		var invChgAmt = 0;
		var rowcount  = sheetObj.TotalRows+2;
		for (var i=2; i<rowcount; i++) {
			if (sheetObj.CellValue(i, "check_box") == 1) {
				invChgAmt += parseFloat(sheetObj.CellValue(i, "inv_amt"));
			}
		}
		
		// Billing AMT (화폐단위별로 소수점 처리를 해준다.)
		invChgAmt = parseFloat(DMTtrimCurrencyAmount(invCurrCd, invChgAmt));
		ComSetObjValue(formObj.inv_chg_amt, invChgAmt);

		if (invCreTpCd == "GRP") {
			
			// GRP : 다수개의 BKG 를 1개의 Invoice 로 생성시에만 사용함.
			// 계산 공통 로직 ( Tax AMT, Payable AMT 계산 )
			DmtComCommonCalcInvAmtByTaxAmt();
		}
		// 각 Row ( BKG ) 단위로 Tax(%), Tax AMT, Payable AMT 항목이 나타나므로 계산된 금액정보를 보여줘야 합니다.  
		else {
			var cntCd = ComGetObjValue(formObj.invoice_issue) == "2" ? ComGetObjValue(formObj.cre_cnt_cd) : ComGetObjValue(formObj.usr_cnt_cd);
			
			var totTaxAmt = 0;
			var totInvAmt = 0;
			
			var taxAmt = 0;
			var invAmt = 0;
			
			//tax 처리 로직
			var taxRto = parseFloat(ComGetObjValue(formObj.tax_rto_dis));
			
			for (var i=2; i<rowcount; i++) {

				var invChgAmt = parseFloat(sheetObj.CellValue(i, "inv_amt"));
				
				// 인도일 경우
				if (cntCd == "IN") {
					// 인도지역일 경우, Tax Amount, Invoice Amount 를 아래 함수에서 계산해 줍니다.
					DmtComCalcIdaTaxAmt(invChgAmt);
					
					sheetObj.CellValue2(i, "ida_cgst_amt") = ComGetObjValue(formObj.ida_cgst_amt);
					sheetObj.CellValue2(i, "ida_sgst_amt") = ComGetObjValue(formObj.ida_sgst_amt);
					sheetObj.CellValue2(i, "ida_igst_amt") = ComGetObjValue(formObj.ida_igst_amt);
					sheetObj.CellValue2(i, "ida_ugst_amt") = ComGetObjValue(formObj.ida_ugst_amt);
					
					taxAmt  = parseFloat(ComGetObjValue(formObj.tax_amt));
					invAmt	= parseFloat(ComGetObjValue(formObj.inv_amt));					
					
					// 인도일 경우 자체 Tax Ratio 를 사용하기 때문에 여기에서는 보여주지 않습니다.
					taxRto = "";
				}
				else {
					// 베트남일 경우
					if (cntCd == "VN") {
						taxAmt = (invChgAmt / (1 - taxRto * 0.01)) * (taxRto * 0.01);
					}
					else {
						taxAmt = (taxRto * 0.01) * invChgAmt;
					}
					
					taxAmt  = parseFloat(DMTtrimCurrencyAmount(invCurrCd, taxAmt));
					invAmt	= parseFloat(DMTtrimCurrencyAmount(invCurrCd, parseFloat(invChgAmt) + taxAmt));
				}
				
				//반올림, 절사 처리
				sheetObj.CellValue2(i, "inv_tax_rto")     = taxRto;	// Tax Ratio
				sheetObj.CellValue2(i, "inv_tax_amt")     = taxAmt;	// Tax AMT
				sheetObj.CellValue2(i, "inv_payable_amt") = invAmt;	// Payable AMT						
				
				// 선택된 항목만 금액으로 계산을 해줍니다.
				if (sheetObj.CellValue(i, "check_box") == 1) {
					totTaxAmt += parseFloat(taxAmt);
					totInvAmt += parseFloat(invAmt);
				}
			}
			
			// Tax AMT, Invoice AMT (화폐단위별로 소수점 처리를 해준다.)
			totTaxAmt = parseFloat(DMTtrimCurrencyAmount(invCurrCd, totTaxAmt));
			totInvAmt = parseFloat(DMTtrimCurrencyAmount(invCurrCd, totInvAmt));
			
			ComSetObjValue(formObj.tax_amt, totTaxAmt);
			ComSetObjValue(formObj.inv_amt, totInvAmt);
		}
	}
	
	/**
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * Tax Amount, Invoice Amount 금액 계산
	 * --------------------------------------------------------
	 * 사용화면 : 
	 * EES_DMT_4004 ( Manual Invoice Creation & Issue )
	 * --------------------------------------------------------*/
	function DmtComManualCalcInvAmtByTaxAmt() {
	   	var formObj 		= document.form;

    	var incCntrDtl   = ComGetObjValue(formObj.incCntrDtail);
    	var invCurrCd    = ComGetObjValue(formObj.inv_curr_cd);  
    	var invAmtCalcTp = ComGetObjValue(formObj.inv_amt_calc_tp);
    	
    	if (invCurrCd == "") return false;

		// Amount
    	var billAmt  = parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.mn_bil_amt), "float"));
		var invXchRt = ComRound(ComGetObjValue(formObj.inv_xch_rt), 6);	//소숫점 6자리 반올림
		var totAmt   = incCntrDtl == "Y" ?  invXchRt * parseFloat(billAmt) : parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.tot_amt), "float"));

		// Exchange Rate 적용된 금액
		totAmt = DMTtrimCurrencyAmount(invCurrCd, totAmt);

		var invChgAmt = 0;
		var dcAmt     = 0;
		
		// Manual Invoice Logic 어디에서 호출했는지에 따라서 billingAmt, dcAmt 계산하는 Logic 이 달라진다.
		// inv_amt_calc_tp : R ( 조회 후 호출됨 )
		if (invAmtCalcTp == "R") {
			invChgAmt 	= DMTtrimCurrencyAmount(invCurrCd, parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.inv_chg_amt), "float")));
			dcAmt		= DMTtrimCurrencyAmount(invCurrCd, (totAmt - invChgAmt));
		}
		//계산에 관련된 필드 수정으로 인한 이벤트가 발생하여 계산수행
		else {
			if (incCntrDtl == "Y") {
				dcAmt	  = DMTtrimCurrencyAmount(invCurrCd, parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.dc_amt), "float")));
				invChgAmt = DMTtrimCurrencyAmount(invCurrCd, (totAmt - dcAmt));
			}
			else {
				dcAmt	  = DMTtrimCurrencyAmount(invCurrCd, 0);
				invChgAmt = totAmt - dcAmt;
			}
		}
		
		if (totAmt > 0 && totAmt < dcAmt) {
			ComShowCodeMessage("DMT00183");
			ComClearObject(formObj.dc_amt);
			ComSetFocus(formObj.dc_amt);
			dcAmt = 0;
		}
		
		ComSetObjValue(formObj.inv_xch_rt,  invXchRt);		// Ex. Rate
		ComSetObjValue(formObj.tot_amt,     totAmt);		// Total AMT
		ComSetObjValue(formObj.dc_amt,      dcAmt);			// D/C by AMT or %
		ComSetObjValue(formObj.inv_chg_amt, invChgAmt);		// Billing AMT
		
		//=========================================================================
		// 계산 공통 로직 ( Tax AMT, Payable AMT 계산 )
		//=========================================================================
		// invoice 발행 후 조회한 경우에는 등록된 정보를 그대로 보여줘야 함.
		// 그럴경우, 아래 계산 로직을 실행하면 안됨. ( inv_amt_calc_tp : R  )
		//=========================================================================
		if (invAmtCalcTp != "R")
			DmtComCommonCalcInvAmtByTaxAmt();
	}
	
	/**
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * Tax Amount, Invoice Amount 금액 계산
	 * --------------------------------------------------------
	 * 사용화면 : 
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * --------------------------------------------------------*/
	function DmtComGeneralCalcInvAmtByTaxAmt() {
		var formObj = document.form;
		
		var chgCurrCd = ComGetObjValue(formObj.chg_curr_cd);
		var invCurrCd = ComGetObjValue(formObj.inv_curr_cd);

		if (chgCurrCd == "" || invCurrCd == "")	return;

		var chgDcAmt  = 0;  // Discount AMT
		var billAmt   = 0;	// Billable AMT
		
		var invXchRt  = 0;	// Ex. Rate
		
		var totAmt    = 0;	// Total AMT
		var dcAmt     = 0;	// D/C by AMT or %
		var invChgAmt = 0;	// Billing AMT
		
		var orgBillAmt = 0;
		var totBillAmt = 0;
		
		//Invoice 전에는 total 금액 구하는 부분이 있다.
		if (ComGetObjValue(formObj.invoice_issue) == "1") {
			billAmt 	= parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.mn_bil_amt), "float"));	//Billable AMT
			chgDcAmt	= parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.chg_dc_amt), "float"));	//Discount AMT

			if (chgCurrCd == invCurrCd) {
				ComSetObjValue(formObj.inv_xch_rt, 1);	//invXchRt = 1 로 셋팅
			}
			else {
				doActionIBSheet(sheetObjects[1], formObj, IBSEARCH);
			}
			
			invXchRt = ComGetObjValue(formObj.inv_xch_rt);
			invXchRt = ComRound(invXchRt, 6);	//소숫점 6자리 반올림

			var rowcount = sheetObjects[0].TotalRows+2;

			//totAmt 계산 로직 변경
			for (var i = 2; i < rowcount; i++) {
               // currency 변경으로 금액차이 발생 billAmt로 계산되도록 조정. 2012.08.09 Kim hyun Hwa
				orgBillAmt = parseFloat(sheetObjects[0].CellValue(i, "bil_amt"));
				
				sheetObjects[0].CellValue(i, "inv_chg_tot")  = orgBillAmt * invXchRt;
				sheetObjects[0].CellValue(i, "inv_bill_amt") = orgBillAmt * invXchRt;

				if (sheetObjects[0].CellValue(i, "checkBox") == 1) {
					totAmt     += parseFloat(sheetObjects[0].CellValue(i, "inv_chg_tot"));
					totBillAmt += parseFloat(sheetObjects[0].CellValue(i, "inv_bill_amt"));
				}
			}

			totAmt 	  = DMTtrimCurrencyAmount(invCurrCd, totAmt);
			invChgAmt = DMTtrimCurrencyAmount(invCurrCd, totBillAmt);

			dcAmt = totAmt - totBillAmt;
			dcAmt = DMTtrimCurrencyAmount(invCurrCd, dcAmt);
			
			ComSetObjValue(formObj.inv_xch_rt,  invXchRt);		// Ex. Rate
			ComSetObjValue(formObj.tot_amt,     totAmt);		// Total AMT
			ComSetObjValue(formObj.dc_amt,      dcAmt);			// D/C by AMT or %
			ComSetObjValue(formObj.inv_chg_amt, invChgAmt);		// Billing AMT
		}

		// 계산 공통 로직 ( Tax AMT, Payable AMT 계산 )
		DmtComCommonCalcInvAmtByTaxAmt();
	}
	
	/**
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * Invoice Amount Calculation 공통로직 
	 * --------------------------------------------------------
	 * 사용화면 : 
	 * EES_DMT_3108 ( Demand Note Issue by Group )
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * EES_DMT_4004 ( Manual Invoice Creation & Issue )
	 * EES_DMT_4013 ( Invoice Creation - Group )
	 * --------------------------------------------------------*/	
	function DmtComCommonCalcInvAmtByTaxAmt() {
		var formObj = document.form;

		//====================================================================================================================================================
		// Invoice Amount Calculation 공통로직 
		//====================================================================================================================================================
		var cntCd     = ComGetObjValue(formObj.invoice_issue) == "2" ? ComGetObjValue(formObj.cre_cnt_cd) : ComGetObjValue(formObj.usr_cnt_cd);
		var invChgAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.inv_chg_amt), "float");
		
		// 인도일 경우
		if (cntCd == "IN") {
			DmtComCalcIdaTaxAmt(invChgAmt);
		}
		else {
			var taxAmt = 0;	// Tax Rate/ AMT
			var invAmt = 0;	// Payable AMT
			
			//tax 처리 로직
			var taxRto = parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.tax_rto_dis), "float")); //Tax Rate
			
			// 베트남일 경우
			if (cntCd == "VN") {
				taxAmt = (invChgAmt / (1 - taxRto * 0.01)) * (taxRto * 0.01);
			}
			else {
				taxAmt = (taxRto * 0.01) * invChgAmt;
			}
			var invCurrCd = ComGetObjValue(formObj.inv_curr_cd);
			
			taxAmt  = DMTtrimCurrencyAmount(invCurrCd, taxAmt);
			invAmt	= DMTtrimCurrencyAmount(invCurrCd, parseFloat(invChgAmt) + parseFloat(taxAmt));

			//반올림, 절사 처리
			ComSetObjValue(formObj.tax_amt, taxAmt);	// Tax Rate/ AMT
			ComSetObjValue(formObj.inv_amt, invAmt);	// Payable AMT
		}		
	}
	
    /*
     * 입력된 Payer 정보가 삭제된 경우, 인도TAX RATIO 를 모두 Clear 시키기 때문에, Invoice Amount 를 다시 계산해야 합니다.
     */
    function DmtComClearIdaTaxRto() {
    	var formObj = document.form;

		var pgmId = ComGetObjValue(formObj.pgm_id);
		
		// Group Demand Note, Group Invoice 메뉴화면은 GST 정보를 보여주는 항목이 존재하지 않기 때문에
		// GST 정보 초기화 작업을 실행하는 로직이 없다.
		if (pgmId != "3108" && pgmId != "4013") {
			// GST 항목의 데이터 초기화
			ComSetObjValue(formObj.ida_gst_rgst_sts_nm, "");
			ComSetObjValue(formObj.ida_gst_rgst_no, "");
			ComSetObjValue(formObj.ida_ste_cd, "");
			ComSetObjValue(formObj.ida_ste_nm, "");
			ComSetObjValue(formObj.ida_sac_cd, "");
			ComSetObjValue(formObj.ida_sac_nm, "");		
		}
		
    	// IDA TAX RATIO 가 모두 CLEAR 되었으므로, INVOICE AMOUNT 를 다시 계산해야 합니다.
		var idaCgstRto = "0";
		var idaSgstRto = "0";
		var idaIgstRto = "0";
		var idaUgstRto = "0";
		
    	ComSetObjValue(formObj.ida_cgst_rto, idaCgstRto);
    	ComSetObjValue(formObj.ida_sgst_rto, idaSgstRto);
    	ComSetObjValue(formObj.ida_igst_rto, idaIgstRto);
    	ComSetObjValue(formObj.ida_ugst_rto, idaUgstRto);
    	
		DmtComSetIdaTaxObj(formObj.ida_cgst_amt, formObj.ida_cgst_rto, idaCgstRto);
		DmtComSetIdaTaxObj(formObj.ida_sgst_amt, formObj.ida_sgst_rto, idaSgstRto);
		DmtComSetIdaTaxObj(formObj.ida_igst_amt, formObj.ida_igst_rto, idaIgstRto);
		DmtComSetIdaTaxObj(formObj.ida_ugst_amt, formObj.ida_ugst_rto, idaUgstRto);	
		
    	DmtComCalcInvAmtByTaxAmt();
    }
   
	/*
	 * 인도지역 Tax Amount 계산 로직
	 */
	function DmtComCalcIdaTaxAmt(invChgAmt) {
		var formObj = document.form;
		
		// 인도지역 Tax Ratio 변경 시점
		var idaTaxApplTm = ComGetObjValue(formObj.ida_tax_appl_tm);
		var invCurrCd    = ComGetObjValue(formObj.inv_curr_cd);

		// Tax Amount
		var taxAmt = 0;
		// Invoice Amount
		var invAmt = 0;
		
		// 인도지역 Tax Ratio 변경 전
		if (idaTaxApplTm == "B") {
			var idaExpnTaxRto      = parseFloat(ComGetObjValue(formObj.ida_expn_tax_rt));
			var idaExpnTaxAmt      = 0;
			var idaEduTaxRto       = parseFloat(ComGetObjValue(formObj.ida_edu_tax_rt));
			var idaEduTaxAmt       = 0;
			var idaHighEduTaxRto   = parseFloat(ComGetObjValue(formObj.ida_high_edu_tax_rt));
			var idaHighEduTaxAmt   = 0;
			var idaLoclTaxRto      = parseFloat(ComGetObjValue(formObj.ida_locl_tax_rt));
			var idaLoclTaxAmt      = 0;	// SBC Tax Amount
			var idaN2ndLoclTaxRto  = parseFloat(ComGetObjValue(formObj.ida_n2nd_locl_tax_rt));
			var idaN2ndLoclTaxAmt  = 0;	// KKC Tax Amount
			 
			// Service Tax
			idaExpnTaxAmt = ComRound( (invChgAmt * idaExpnTaxRto * 0.01), 2 )
			ComSetObjValue(formObj.ida_expn_tax, idaExpnTaxAmt);
			
			// Education Cess
			idaEduTaxAmt = ComRound( (idaExpnTaxAmt * idaEduTaxRto * 0.01), 2 )
			ComSetObjValue(formObj.ida_edu_tax, idaEduTaxAmt);
			
			// Higher Edu Cess
			idaHighEduTaxAmt = ComRound( (idaExpnTaxAmt * idaHighEduTaxRto * 0.01), 2 )
			ComSetObjValue(formObj.ida_high_edu_tax, idaHighEduTaxAmt);
			 
			// SBC Tax
			idaLoclTaxAmt = ComRound( (invChgAmt * idaLoclTaxRto * 0.01), 2 )
			ComSetObjValue(formObj.ida_locl_tax, idaLoclTaxAmt);

			// KKC Tax
			idaN2ndLoclTaxAmt = ComRound( (invChgAmt * idaN2ndLoclTaxRto * 0.01), 2 )
			ComSetObjValue(formObj.ida_n2nd_locl_tax, idaN2ndLoclTaxAmt);
			
			// Total Service Tax
			taxAmt = parseFloat(idaExpnTaxAmt) + parseFloat(idaEduTaxAmt) + parseFloat(idaHighEduTaxAmt) ;

			taxAmt	= DMTtrimCurrencyAmount(invCurrCd, taxAmt);
			invAmt	= parseFloat(invChgAmt) + parseFloat(taxAmt) + parseFloat(idaLoclTaxAmt) + parseFloat(idaN2ndLoclTaxAmt);
			invAmt	= DMTtrimCurrencyAmount(invCurrCd, invAmt);			
		}
		// 인도지역 Tax Ratio 변경 후
		else { 
			// Tax 금액 미세조정을 위해서 변경된 경우에는 Tax Amount 를 다시 계산하지 않고 입력된 Amount 로 계산을 수행합니다.
			var calcByCngIdaTaxAmt = ComGetObjValue(formObj.calc_by_cng_ida_tax_amt);
			
			var idaCgstAmt = 0;
			var idaSgstAmt = 0;
			var idaIgstAmt = 0;
			var idaUgstAmt = 0;
			
			if (calcByCngIdaTaxAmt == "Y") {
				
				idaCgstAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.ida_cgst_amt), "float");
				idaSgstAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.ida_sgst_amt), "float");
				idaIgstAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.ida_igst_amt), "float");
				idaUgstAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.ida_ugst_amt), "float");
			}
			else {
				// Tax Ratio
				var idaCgstRto = ComGetObjValue(formObj.ida_cgst_rto) == "" ? 0 : parseFloat(ComGetObjValue(formObj.ida_cgst_rto));
				var idaSgstRto = ComGetObjValue(formObj.ida_sgst_rto) == "" ? 0 : parseFloat(ComGetObjValue(formObj.ida_sgst_rto));
				var idaIgstRto = ComGetObjValue(formObj.ida_igst_rto) == "" ? 0 : parseFloat(ComGetObjValue(formObj.ida_igst_rto));
				var idaUgstRto = ComGetObjValue(formObj.ida_ugst_rto) == "" ? 0 : parseFloat(ComGetObjValue(formObj.ida_ugst_rto));
				
				// Tax Amount
				idaCgstAmt = ComRound((invChgAmt * idaCgstRto * 0.01), 2);
				idaSgstAmt = ComRound((invChgAmt * idaSgstRto * 0.01), 2);
				idaIgstAmt = ComRound((invChgAmt * idaIgstRto * 0.01), 2);
				idaUgstAmt = ComRound((invChgAmt * idaUgstRto * 0.01), 2);
			}
			
			ComSetObjValue(formObj.ida_cgst_amt, idaCgstAmt);
			ComSetObjValue(formObj.ida_sgst_amt, idaSgstAmt);
			ComSetObjValue(formObj.ida_igst_amt, idaIgstAmt);
			ComSetObjValue(formObj.ida_ugst_amt, idaUgstAmt);
			
			// Total Service Tax
			taxAmt = parseFloat(idaCgstAmt) + parseFloat(idaSgstAmt) + parseFloat(idaIgstAmt) +  parseFloat(idaUgstAmt);
			
			taxAmt = DMTtrimCurrencyAmount(invCurrCd, taxAmt);
			invAmt = parseFloat(invChgAmt) + parseFloat(taxAmt);
			invAmt = DMTtrimCurrencyAmount(invCurrCd, invAmt);
		}
	
		//반올림, 절사 처리
		ComSetObjValue(formObj.tax_amt, taxAmt);
		ComSetObjValue(formObj.inv_amt, invAmt);
	}
	
	/**
	 * Tax 를 적용할지 여부를 선택하게 되면, 그에 따라 Tax 를 적용/미적용한 후 금액을 다시 계산한다.
	 */
	function DmtComApplTaxRto() {
		var formObj = document.form;

		var isChecked = formObj.chk_tax.checked;
		if (isChecked) {
			ComSetObjValue(formObj.tax_rto_dis, ComGetObjValue(formObj.tax_rto));
		}
		else {
			ComSetObjValue(formObj.tax_rto_dis, "0");
		}

		DmtComCalcInvAmtByTaxAmt();
	}
	
	/*
	 * Invoice Booking 조회된 결과정보를 Form 항목으로 binding 시켜줍니다.
     * 사용화면 : EES_DMT_3109, EES_DMT_4002, EES_DMT_4004
	 */
	function DmtComEtcDataToForm() {
		var formObj  = document.form;
		var sheetObj = sheetObjects[0];

		//=======================< Logic 은 하기와 같이 순차적으로 처리되어야 합니다. >=========================================
		
		// 1. Invoice Booking 정보 조회결과를 화면 해당 항목에 바인딩
		ComEtcDataToForm(formObj, sheetObj);
		
		// 2. OFC 가 인도지역일 경우 인도 Tax 관련 항목을 보여줍니다.
		DmtComDisplayIdaTax();
		
		// 3. 조회한 결과 정보로 Tax Ratio 항목의 값과 상태를 초기화 시켜줍니다.
		DmtComInitTaxRto();
		
		// 4.1 Invoice 발행 전 일 경우 실행해야될 Logic 
    	if (ComGetObjValue(formObj.invoice_issue) == "1") {
    		// Tax Amount 및 Invoice Amount 을 계산해 줍니다.
    		DmtComCalcInvAmtByTaxAmt();
    	}
    	// 4.2 Invoice 발행 후 처리해야될 Logic
    	// 조회실행 후 조회결과를 화면필드에 매핑해주는 처리를 하는데, 
    	// invoice 발행 후 일 경우에는 Payer 관련된 Logic 처리를 하지 않기 때문에, 인도 Tax Amount 필드의 상태를 여기에서 처리해줘야 합니다.
    	else {
    		var cntCd = ComGetObjValue(formObj.invoice_issue) == "2" ? ComGetObjValue(formObj.cre_cnt_cd) : ComGetObjValue(formObj.usr_cnt_cd);
    		
    		if (cntCd == "IN") {
    			var idaCgstRto = ComGetObjValue(formObj.ida_cgst_rto);
    			var idaSgstRto = ComGetObjValue(formObj.ida_sgst_rto);
    			var idaIgstRto = ComGetObjValue(formObj.ida_igst_rto);
    			var idaUgstRto = ComGetObjValue(formObj.ida_ugst_rto);
    			
	    		// invoice 발행 후 A/R I/F 처리한 경우에는 비활성화 처리해야 함.
	    		DmtComSetIdaTaxObj(formObj.ida_cgst_amt, formObj.ida_cgst_rto, idaCgstRto);
	    		DmtComSetIdaTaxObj(formObj.ida_sgst_amt, formObj.ida_sgst_rto, idaSgstRto);
	    		DmtComSetIdaTaxObj(formObj.ida_igst_amt, formObj.ida_igst_rto, idaIgstRto);
	    		DmtComSetIdaTaxObj(formObj.ida_ugst_amt, formObj.ida_ugst_rto, idaUgstRto);	
    		}
    	}
    	
		// 5. 금액필드에 데이터를 금액형식으로 표현해 줍니다.
		DmtComDisplayCurrency();
		//======================================================================================================================
	}	
	
	/*
	 * 인도세법 변경 전/후 여부에 따라서 화면에 보여줄 TAX 항목들이 다르기 때문에, 이 부분을 제어해 줍니다.
     * 사용화면 : EES_DMT_3108, EES_DMT_3109, EES_DMT_4002, EES_DMT_4004
	 */	
	/**
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * 인도세법 변경 전/후 여부에 따라서 화면에 보여줄 TAX 항목들이 다르기 때문에, 이 부분을 제어해 줍니다.
	 * --------------------------------------------------------
	 * 사용화면 : 
	 * EES_DMT_3108 ( Demand Note Issue by Group )
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * EES_DMT_4004 ( Manual Invoice Creation & Issue )
	 * --------------------------------------------------------*/		
    function DmtComDisplayIdaTax() {
    	var formObj = document.form;
    	
       	// India Tax Amount ( Tax Ratio 변경 전/후 보여주는 항목이 다름 ) =============================================================================
       	// 변경일자 : 2017.07.26
    	var cntCd = ComGetObjValue(formObj.invoice_issue) == "2" ? ComGetObjValue(formObj.cre_cnt_cd) : ComGetObjValue(formObj.usr_cnt_cd);
    	
       	if (cntCd == "IN") {
       		
       		// 인도 Tax 변경 전 일 경우에는 조회한 인도 Tax Ratio 를 조회한다.
       		if (ComGetObjValue(formObj.ida_tax_appl_tm) == "B") { // B(efore) : 변경 전, A(fter) : 변경 후
       			ComSetDisplay("ida_gst_info", false);
       			
       			if (ComGetObjValue(formObj.pgm_id) != "3108") {
	       			ComSetDisplay("ida_tax_bef_tm", true);
	       			ComSetDisplay("ida_tax_aft_tm", false);
       			}
       		}
       		// 인도 Tax 변경 후 일 경우에는 Payer 정보에 따라서 인도 Tax Ratio 를 조회한다.
       		else {
       			ComSetDisplay("ida_gst_info", true);
       			
       			if (ComGetObjValue(formObj.pgm_id) != "3108") {	//
       				ComSetDisplay("ida_tax_bef_tm", false);
       				ComSetDisplay("ida_tax_aft_tm", true);
       			}
       		}
       	}
       	//=============================================================================================================================================    	
    }
    
    /*
     * 인도 OFC 에서 발행한 invoice 인 경우, Payer 정보가 변경되면 Payer 에 해당되는 India Tax Ratio 를 조회해서 Invoice Amount 를 재계산합니다.
     */    
    function DmtComSearchIdaTaxRtoByPayer() {
    	var formObj = document.form;

    	// Invoice 발행 후 조회한 경우에는 등록된 내용으로 화면에 보여줘야 되기 때문에 Calculation 을 실행하면 안됩니다.
    	var invAmtCalcTp = ComGetObjValue(formObj.inv_amt_calc_tp);
    	
    	var cntCd = ComGetObjValue(formObj.invoice_issue) == "2" ? ComGetObjValue(formObj.cre_cnt_cd) : ComGetObjValue(formObj.usr_cnt_cd);
    	if (cntCd == "IN" && ComGetObjValue(formObj.ida_tax_appl_tm) == "A") {
    		if (ComGetObjValue(formObj.payer_cd) != "") {
	    		//============================================================================================
	        	// 변경일자 : 2017.07.27 
	        	// 변경요건 : 인도 TAX 변경에 따른 수정
	        	// 변경내용 : Payer 정보가 입력될 때, Tax 정보를 조회한다. ( 고객 State, 지점 state 비교 )
	    		//============================================================================================ 
	    		DMTComDoActionIBSheet(sheetObjects[0], formObj, IBSEARCH_IDA_TAX);
	    		
	    		// Invoice 가 발행된 경우에는 등록된 Tax Amount 를 그대로 보여줘야 한다.
	    		// 그래서, 아래 Tax Amount 를 다시 계산해주는 로직을 실행하면 안됩니다.
	    		if (invAmtCalcTp == "R") return;	
	    		
	    		// Payer 에 대한 Tax 가 조회되면, Invoice Amount 를 다시 계산합니다.
	    		DmtComCalcInvAmtByTaxAmt();
    		}
    		else {
    			// Payer 가 없을 경우, Tax 를 모두 Clear 시키고, Invoice Amount 를 다시 계산합니다.
   				DmtComClearIdaTaxRto();
    		}
    	}
    }
    
	/*
	 * 조회한 결과 정보로 Tax Ratio 항목의 값과 상태를 초기화 시켜줍니다.
	 */
	function DmtComInitTaxRto() {
		var formObj = document.form;
		
   		// 인도 OFC 에서 발행한 invoice 는 시스템 내부에서 지정된 Tax Ratio 를 사용하기 때문에, OFC 별로 지정된 Tax Ratio 를 사용하지 않는다.
   		// 그래서, 무조건 Tax 가 적용되기 때문에 Tax 적용여부 체크박스를 선택표시 해준다.
		var cntCd = ComGetObjValue(formObj.invoice_issue) == "2" ? ComGetObjValue(formObj.cre_cnt_cd) : ComGetObjValue(formObj.usr_cnt_cd);
		if (cntCd == "IN") {
			formObj.chk_tax.checked = true;
			ComEnableObject(formObj.chk_tax, false);
        	ComSetObjValue(formObj.tax_rto_dis, "");
		}
		else {
	    	// invoice 를 생성한 후에는 Tax 포함 가격일 경우만 체크한다.
			if (ComGetObjValue(formObj.invoice_issue) == "2") {
				
				if (ComGetObjValue(formObj.tax_amt) == "0.00") {
					formObj.chk_tax.checked = false;
					ComSetObjValue(formObj.tax_rto_dis, "0");				
				}
				else {
					//office별 tax_rto와 invoice에 저장된 tax_rto 값을 비교한다.
					if (ComGetObjValue(formObj.tax_rto) == ComGetObjValue(formObj.inv_tax_rto)) {
						formObj.chk_tax.checked = true;
						ComSetObjValue(formObj.tax_rto_dis, ComGetObjValue(formObj.tax_rto));
					}
					else {
						formObj.chk_tax.checked = false;
						ComSetObjValue(formObj.tax_rto_dis, ComGetObjValue(formObj.inv_tax_rto));
					}
				}				
			}
			// invoice 를 생성하기 전
			else {
				formObj.chk_tax.checked = true;
				ComSetObjValue(formObj.tax_rto_dis, ComGetObjValue(formObj.tax_rto));
			}
		}
	}   
	
	/**
	 * --------------------------------------------------------
	 *  Amount 필드에 데이터를 금액표시로 나타내준다.
	 * --------------------------------------------------------
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * 인도TAX 관련 정보조회를 실행하는 공통함수
	 * 사용화면 : 
	 * EES_DMT_3108 ( Demand Note Issue by Group )
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * EES_DMT_4004 ( Manual Invoice Creation & Issue )
	 * EES_DMT_4013 ( Invoice Creation - Group )
	 * --------------------------------------------------------
	 */	
    function DmtComDisplayCurrency() {
    	var formObj = document.form;
    	
    	var pgmId = ComGetObjValue(formObj.pgm_id);
    	
    	// 3109, 4002 화면에만 존재하는 금액필드에 대한 금액표시
    	if (pgmId == "3109" || pgmId == "4002") {
			// Charge Amount ( EES_DMT_3109, EES_DMT_4002 )
			var orgChgAmt	 = ComAddComma2(ComGetObjValue(formObj.mn_org_chg_amt), "#,###.00");
			var dmdtExptAmt	 = ComAddComma2(ComGetObjValue(formObj.dmdt_expt_amt),  "#,###.00");
			var chgDcAmt	 = ComAddComma2(ComGetObjValue(formObj.chg_dc_amt),     "#,###.00");
			var aftInvAdjAmt = ComAddComma2(ComGetObjValue(formObj.aft_inv_adj_amt),"#,###.00");
	
			ComSetObjValue(formObj.mn_org_chg_amt,  orgChgAmt);
			ComSetObjValue(formObj.dmdt_expt_amt,   dmdtExptAmt);
			ComSetObjValue(formObj.chg_dc_amt,      chgDcAmt);
			ComSetObjValue(formObj.aft_inv_adj_amt, aftInvAdjAmt);
    	}
		
    	// 3109, 4002, 4004 화면에만 존재하는 금액필드에 대한 금액표시
    	if (pgmId == "3109" || pgmId == "4002" || pgmId == "4004") {
	    	// Charge Amount
			var bilAmt	     = ComAddComma2(ComGetObjValue(formObj.mn_bil_amt),     "#,###.00");
	
			// Invoice Amount
			var totAmt	     = ComAddComma2(ComGetObjValue(formObj.tot_amt),        "#,###.00");
			var dcAmt	     = ComAddComma2(ComGetObjValue(formObj.dc_amt),         "#,###.00");
			var invXchRt     = parseFloat(ComGetObjValue(formObj.inv_xch_rt)).toFixed(6);
	
			ComSetObjValue(formObj.mn_bil_amt,      bilAmt);
			ComSetObjValue(formObj.tot_amt,         totAmt);
			ComSetObjValue(formObj.dc_amt,          dcAmt);
			ComSetObjValue(formObj.inv_xch_rt,      invXchRt);

			var cntCd = ComGetObjValue(formObj.invoice_issue) == "2" ?  ComGetObjValue(formObj.cre_cnt_cd) : ComGetObjValue(formObj.usr_cnt_cd);
	
			// India Tax 일 경우 관련 Tax Amount 도 금액정보로 표현해 줍니다.
			if (cntCd == "IN") {
				if (ComGetObjValue(formObj.ida_tax_appl_tm) == "B") {
					var sbcAmt = ComAddComma2(ComGetObjValue(formObj.ida_locl_tax),        "#,###.00");
					var kkcAmt = ComAddComma2(ComGetObjValue(formObj.ida_n2nd_locl_tax),   "#,###.00");
					
					ComSetObjValue(formObj.ida_locl_tax,      sbcAmt);
					ComSetObjValue(formObj.ida_n2nd_locl_tax, kkcAmt);				
				}
				else {
					var cgstAmt = ComAddComma2(ComGetObjValue(formObj.ida_cgst_amt),       "#,###.00");
					var sgstAmt = ComAddComma2(ComGetObjValue(formObj.ida_sgst_amt),       "#,###.00");
					var igstAmt = ComAddComma2(ComGetObjValue(formObj.ida_igst_amt),       "#,###.00");
					var ugstAmt = ComAddComma2(ComGetObjValue(formObj.ida_ugst_amt),       "#,###.00");
					
					ComSetObjValue(formObj.ida_cgst_amt, cgstAmt);
					ComSetObjValue(formObj.ida_sgst_amt, sgstAmt);
					ComSetObjValue(formObj.ida_igst_amt, igstAmt);
					ComSetObjValue(formObj.ida_ugst_amt, ugstAmt);				
				}
			}
    	}
    	
    	// 이 함수를 사용하는 모든 화면에 존재하는 금액필드에 대한 금액표시
		var invChgAmt = ComAddComma2(ComGetObjValue(formObj.inv_chg_amt),    "#,###.00");
		var taxAmt	  = ComAddComma2(ComGetObjValue(formObj.tax_amt),        "#,###.00");
		var invAmt	  = ComAddComma2(ComGetObjValue(formObj.inv_amt),        "#,###.00");	
		
		ComSetObjValue(formObj.inv_chg_amt, invChgAmt);
		ComSetObjValue(formObj.tax_amt,     taxAmt);
		ComSetObjValue(formObj.inv_amt,     invAmt);    	
    }	
    
	/**
	 * --------------------------------------------------------
	 *  서버로 저장요청시 금액부분에 ',' 가 표시되면 오류가 발생됨
	 *  그래서, 서버로 저장요청시 해당 ',' 를 삭제해 주는 함수
	 * --------------------------------------------------------
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * 인도TAX 관련 정보조회를 실행하는 공통함수
	 * 사용화면 : 
	 * EES_DMT_3108 ( Demand Note Issue by Group )
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * EES_DMT_4013 ( Invoice Creation - Group )
	 * --------------------------------------------------------
	 */	    
    function DmtComRemoveCurrency() {
       	var formObj = document.form;
       	
       	var pgmId = ComGetObjValue(formObj.pgm_id);
    	// 3109, 4002, 4004 화면에만 존재하는 금액필드에 금액정보를 숫자로 변환해 줍니다.
    	if (pgmId == "3109" || pgmId == "4002") {       	
			//Charge 3자리 콤마 제거
			var orgChgAmt	 = ComGetUnMaskedValue(ComGetObjValue(formObj.mn_org_chg_amt),  "float");
			var dmdtExptAmt	 = ComGetUnMaskedValue(ComGetObjValue(formObj.dmdt_expt_amt),   "float");
			var chgDcAmt	 = ComGetUnMaskedValue(ComGetObjValue(formObj.chg_dc_amt),      "float");
			var bilAmt		 = ComGetUnMaskedValue(ComGetObjValue(formObj.mn_bil_amt),      "float");
			var aftInvAdjAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.aft_inv_adj_amt), "float");
			//Invoice
			var totAmt		= ComGetUnMaskedValue(ComGetObjValue(formObj.tot_amt),          "float");
			var dcAmt		= ComGetUnMaskedValue(ComGetObjValue(formObj.dc_amt),           "float");
			
			ComSetObjValue(formObj.mn_org_chg_amt,  orgChgAmt);
			ComSetObjValue(formObj.dmdt_expt_amt,   dmdtExptAmt);
			ComSetObjValue(formObj.chg_dc_amt,      chgDcAmt);
			ComSetObjValue(formObj.mn_bil_amt,      bilAmt);
			ComSetObjValue(formObj.aft_inv_adj_amt, aftInvAdjAmt);
			ComSetObjValue(formObj.tot_amt,         totAmt);
			ComSetObjValue(formObj.dc_amt,          dcAmt);
    	}
		
		var cntCd = ComGetObjValue(formObj.invoice_issue) == "2" ?  ComGetObjValue(formObj.cre_cnt_cd) : ComGetObjValue(formObj.usr_cnt_cd);
		
		// India Tax 일 경우 관련 Tax Amount 를 서버에 저장하기 위해서 금액으로 변경해준다.
		if (cntCd == "IN") {
			if (ComGetObjValue(formObj.ida_tax_appl_tm) == "B") {
				var sbcAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.ida_locl_tax),        "float");
				var kkcAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.ida_n2nd_locl_tax),   "float");
				
				ComSetObjValue(formObj.ida_locl_tax,      sbcAmt);
				ComSetObjValue(formObj.ida_n2nd_locl_tax, kkcAmt);				
			}
			else {
				var cgstAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.ida_cgst_amt),       "float");
				var sgstAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.ida_sgst_amt),       "float");
				var igstAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.ida_igst_amt),       "float");
				var ugstAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.ida_ugst_amt),       "float");
				
				ComSetObjValue(formObj.ida_cgst_amt, cgstAmt);
				ComSetObjValue(formObj.ida_sgst_amt, sgstAmt);
				ComSetObjValue(formObj.ida_igst_amt, igstAmt);
				ComSetObjValue(formObj.ida_ugst_amt, ugstAmt);				
			}
		}
		
    	// 이 함수를 사용하는 모든 화면에 존재하는 금액필드에 금액정보를 숫자로 변환해 줍니다.
		var invChgAmt = ComGetUnMaskedValue(ComGetObjValue(formObj.inv_chg_amt), "float");
		var dcAmt	  = ComGetUnMaskedValue(ComGetObjValue(formObj.dc_amt),      "float");
		var taxAmt	  = ComGetUnMaskedValue(ComGetObjValue(formObj.tax_amt),     "float");
		var invAmt	  = ComGetUnMaskedValue(ComGetObjValue(formObj.inv_amt),     "float");

		ComSetObjValue(formObj.inv_chg_amt, invChgAmt);
		ComSetObjValue(formObj.dc_amt,      dcAmt);
		ComSetObjValue(formObj.tax_amt,     taxAmt);
		ComSetObjValue(formObj.inv_amt,     invAmt);		
    }
    
	/**
	 * --------------------------------------------------------
	 *  Payer, Trucker 정보가 입력/수정/삭제시 처리를 담당하는 함수
	 * --------------------------------------------------------
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * 인도TAX 관련 정보조회를 실행하는 공통함수
	 * 사용화면 : 
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * EES_DMT_4004 ( Manual Invoice Creation & Issue )
	 * --------------------------------------------------------
	 */	     
    function DmtComDoActionText(sheetObj, formObj, object, formCmd) {
		sheetObj.ShowDebugMsg = false;
		sheetObj.WaitImageVisible = false;
		
	    //Payer 체크
		if (object.name == "payer_cd") {
			
	    	var isValidation = DmtComValidPayer();

	    	// Payer 정보가 변경되면 Payer 에 해당되는 India Tax Ratio 를 조회해서 Invoice Amount 를 재계산합니다.
	    	DmtComSearchIdaTaxRtoByPayer();
	    	
	    	if (!isValidation) return false;
			
			DmtComSearchAttentionList();
			
			//setting
			var cboAttention = ComGetObjValue(formObj.pgm_id) == "4004" ? comboObjects[1] : comboObjects[0];
			
			if (ComGetObjValue(formObj.payer_cd) == "") {
				cboAttention.Index = -1;
				ComSetObjValue(formObj.payr_cntc_pnt_phn_no, "");
				ComSetObjValue(formObj.payr_cntc_pnt_fax_no, "");
				ComSetObjValue(formObj.payr_cntc_pnt_eml,    "");
			} 
			else {
				var setCode = ComGetObjValue(formObj.cust_cnt_cd)+"^"+ComGetObjValue(formObj.cust_cntc_pnt_seq)+"^"+ComParseInt(ComGetObjValue(formObj.cust_seq));
				//Attention Setting
				cboAttention.Code = setCode;
				if (cboAttention.Code == "") {
					cboAttention.Index = 0;
				}
			}
		}
		else if (object.name == "trucker_cd") {
			//vndr_cd
			ComSetObjValue(formObj.vndr_cd, ComGetObjValue(formObj.trucker_cd));
	
			var vndr_len = parseInt(ComGetLenByByte(ComGetObjValue(formObj.vndr_cd)));
			
			//변경
			if (vndr_len == 0) {
				ComSetObjValue(formObj.vndr_cd, "");
				ComSetObjValue(formObj.trucker_cd, "");
				ComSetObjValue(formObj.trucker_nm, "");
				return;
			}

			ComSetObjValue(formObj.f_cmd, formCmd);
			
			var sXml 	= sheetObj.GetSearchXml("DMTCommonFinderGS.do", FormQueryString(formObj));
			var vndr_cd = ComGetEtcData(sXml, "VNDR_CD");	//추가
			var vndr_nm = ComGetEtcData(sXml, "VNDR_NM");
			
			if (vndr_nm == null || vndr_nm == "") {
				ComSetObjValue(formObj.vndr_cd,    "");
				ComSetObjValue(formObj.trucker_cd, "");
				ComSetObjValue(formObj.trucker_nm, "");
				ComSetFocus(formObj.trucker_cd);
			}
			else {
				ComSetObjValue(formObj.trucker_cd, vndr_cd);	//변경
				ComSetObjValue(formObj.trucker_nm, vndr_nm);
			}			
		}
        sheetObj.WaitImageVisible = true;
    }   
    
    /*
     * Payer 정보의 유효성을 체크하는 함수
     */
	function DmtComValidPayer() {

		var formObj  = document.form;
		var sheetObj = sheetObjects[0];

		//cust_cd
		ComSetObjValue(formObj.s_cust_cd, ComGetObjValue(formObj.payer_cd));
		var custlen = parseInt(ComGetLenByByte(ComGetObjValue(formObj.s_cust_cd)));

		if (custlen == 0) {
			DmtComClearAttention();
			return false;
		}
		
		var cntCd = ComGetObjValue(formObj.invoice_issue) == "2" ?  ComGetObjValue(formObj.cre_cnt_cd) : ComGetObjValue(formObj.usr_cnt_cd);

		//미주 : customer + vendor 
		if (cntCd == "CA" || cntCd == "US") {
			
			var trfCd = ComGetObjValue(formObj.dmdt_trf_cd).substring(1,2);
			
			if (custlen > 2) {
				var char_chk = ComGetObjValue(formObj.s_cust_cd).substring(0,2);

				//2자리가 영문자이면 CUSTOMER 조회
				if (ComIsAlphabet(char_chk)) {
					ComSetObjValue(formObj.s_cust_gubun, "2");
				}
				else {
					//service provider는 Detention 만 가능하게 함
					if (trfCd == 'T') {
						ComSetObjValue(formObj.s_cust_gubun, "1");
					} 
					else {
						ComShowCodeMessage("DMT00165", "Payer");
						DmtComClearAttention();
						return false;
					}
				}
			} 
			else {
				//service provider는 Detention 만 가능하게 함
				if (trfCd == 'T') {
					ComSetObjValue(formObj.s_cust_gubun, "1");
				} 
				else {
					ComShowCodeMessage("DMT00165", "Payer");
					DmtComClearAttention();
					return false;
				}
			}
		} 
		else {
			//미주 외 : customer만 적용 ( vendor 는 제외 에러 처리) 
			if (custlen > 2) {
				var char_chk = ComGetObjValue(formObj.s_cust_cd).substring(0,2);
				//2자리가 영문자이면 CUSTOMER 조회
				if (ComIsAlphabet(char_chk)) {
					ComSetObjValue(formObj.s_cust_gubun, "2");
				}
				else {
					ComShowCodeMessage("DMT00165", "Payer");
					DmtComClearAttention();
					return false;
				}
			} 
			else {
				ComShowCodeMessage("DMT00165", "Payer");
				DmtComClearAttention();
				return false;
			}
		}

		ComSetObjValue(formObj.f_cmd, SEARCH20);

		var sXml 	     = sheetObj.GetSearchXml("DMTCommonFinderGS.do", FormQueryString(formObj));
		var cust_cd      = ComGetEtcData(sXml, "PAYER_CODE");
		var cust_nm      = ComGetEtcData(sXml, "PAYER_NM");
		var delt_flg     = ComGetEtcData(sXml, "DELT_FLG");
		var lgs_flg      = ComGetEtcData(sXml, "LGS_FLG");
		var nmd_cust_flg = ComGetEtcData(sXml, "NMD_CUST_FLG");
		
		if (cust_nm == null || cust_nm == "") {
			DmtComClearAttention();
			ComShowCodeMessage("DMT00165", "Payer");
			ComSetFocus(formObj.payer_cd);	
			return false;
		}
		
		if (lgs_flg == "N") {
			DmtComClearPayerCond();
			ComShowCodeMessage("DMT01183");
			ComSetFocus(formObj.payer_cd);			
			return false;
		}
		if (nmd_cust_flg == "Y") {
			DmtComClearPayerCond();
			ComShowCodeMessage("DMT02002", "Payer Code - Named Customer");
			ComSetFocus(formObj.payer_cd);			
			return false;
		}

		ComSetObjValue(formObj.payer_cd, cust_cd);
		ComSetObjValue(formObj.payer_nm, cust_nm);
		return true;
	}
	
	/*
	 * Payer Name 조회시 사용되는 조회조건 초기화
	 */
	function DmtComClearPayerCond() {
		var formObj = document.form;
		
		ComSetObjValue(formObj.s_cust_gubun, "");
		ComSetObjValue(formObj.s_cust_cd,    "");
		ComSetObjValue(formObj.payer_cd,     "");
		ComSetObjValue(formObj.payer_nm,     "");		
	}
	
	/**
	 * --------------------------------------------------------
	 * Payer 정보가 삭제된 경우, 관련정보를 모두 삭제합니다.
	 * 관련정보 : Payer 정보조회조건, Attention 정보
	 * --------------------------------------------------------
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * 인도TAX 관련 정보조회를 실행하는 공통함수
	 * 사용화면 : 
	 * EES_DMT_3108 ( Demand Note Issue by Group )
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * EES_DMT_4004 ( Manual Invoice Creation & Issue )
	 * EES_DMT_4013 ( Invoice Creation - Group )
	 * --------------------------------------------------------
	 */	 	
	function DmtComClearAttention() {
		var formObj = document.form;

		// Payer Name 조회에 사용된 조회조건 초기화.
		DmtComClearPayerCond();
		
		// Group Demand Note, Group Invoice 는 Attention 항목이 존재하지 않는다.
		var pgmId = ComGetObjValue(formObj.pgm_id);
		if (pgmId == "3108" ||pgmId == "4013") return;
		
		// Attention 목록 초기화
		var cboAttention = pgmId == "4004" ? comboObjects[1] : comboObjects[0];
		cboAttention.RemoveAll();
     	
		// Attention 선택에 따라 보여줄 TEL, FAX, EMAIL 항목 초기화
     	ComSetObjValue(formObj.dmdt_payr_cntc_pnt_nm, "");
     	ComSetObjValue(formObj.payr_cntc_pnt_phn_no,  "");
     	ComSetObjValue(formObj.payr_cntc_pnt_fax_no,  "");
     	ComSetObjValue(formObj.payr_cntc_pnt_eml,     "");
     	ComSetObjValue(formObj.cust_cntc_pnt_seq,     "");
	} 
	
	/*
	 * Payer 에 따라 Attention 항목을 설정해줍니다.
	 * 사용메뉴화면 : EES_DMT_3109, EES_DMT_4002, EED_DMT_4004
	 */	
	/**
	 * --------------------------------------------------------
	 * Payer 정보가 입력되면, 관련정보를 조회해서 설정해줍니다.
	 * 관련정보 : Attention 정보
	 * --------------------------------------------------------
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * 인도TAX 관련 정보조회를 실행하는 공통함수
	 * 사용화면 : 
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * EES_DMT_4004 ( Manual Invoice Creation & Issue )
	 * --------------------------------------------------------
	 */		
	function DmtComInitPayerAttention() {
		var formObj = document.form;
		
		// 1. Payer 의 Attention 목록을 조회합니다.
		DmtComSearchAttentionList();
		
		// 2. Payer 의 Attention 목록 중 기존에 지정한 항목이 있을 경우, 자동선택해 줍니다. 없을 경우에는 첫번째 항목을 자동선택해 줍니다.
		var cboAttention = ComGetObjValue(formObj.pgm_id) == "4004" ? comboObjects[1] : comboObjects[0];
    	if (cboAttention.GetCount() > 0) {
    		var setCode = ComGetObjValue(formObj.cust_cnt_cd)+"^"+ComGetObjValue(formObj.cust_cntc_pnt_seq)+"^"+ComParseInt(ComGetObjValue(formObj.cust_seq));
    		//Attention Setting
   			cboAttention.Code = setCode;
   			if (cboAttention.Code == ""){
   				cboAttention.Index = 0;
    		}
    	}

    	// 3. Payer 의 Attention 목록 중 자동선택된 정보로 Tel, Fax, Email 항목을 설정해 줍니다.
 		DmtComSetAttention();
	}
	
	/*
	 * Payer 의 Attention 정보를 조회합니다.
	 * 사용메뉴화면 : EES_DMT_3109, EES_DMT_4002, EED_DMT_4004
	 */
	function DmtComSearchAttentionList() {
		
		var formObj  = document.form;
		var cboAttention = ComGetObjValue(formObj.pgm_id) == "4004" ? comboObjects[1] : comboObjects[0];
		
		// Payer 의 Attention 정보 조회를 위한 조회매개변수를 설정해줍니다.
		DmtComSetAttentionParams();
		
		// Payer 가 없을 경우, Attention 정보를 Clear 시켜줍니다.
		if (ComGetObjValue(formObj.payer_cd) == null || ComGetObjValue(formObj.payer_cd) == "") {
			DmtComClearAttention();
			return;
		}

		//Invoice Issue 전
		if (ComGetObjValue(formObj.pgm_id) == "4002") {
			if (ComGetObjValue(formObj.invoice_issue) == "1" || ComGetObjValue(formObj.dmdt_vt_inv_yn) == "Y") {
				ComSetObjValue(formObj.ofc_cd, ComGetObjValue(formObj.session_ofc_cd));
			//Invoice Issue 후
			}
			else {
				ComSetObjValue(formObj.ofc_cd, ComGetObjValue(formObj.cre_ofc_cd));
			}
		}

		// Payer 의 Attention 정보를 조회합니다.
		DMTComDoActionIBCombo(sheetObjects[1], formObj, IBSEARCH_ATTN);
	}

	
	/**
	 * --------------------------------------------------------
	 * US, CA 로직 적용 Payer Code 적용설정  (2015-09-10 CA 로직 제거)
	 * --------------------------------------------------------
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * 인도TAX 관련 정보조회를 실행하는 공통함수
	 * 사용화면 : 
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * EES_DMT_4004 ( Manual Invoice Creation & Issue )
	 * --------------------------------------------------------
	 */	
	function DmtComSetPayer() {
		var formObj = document.form;
		
		var polCd     = ComGetObjValue(formObj.pol_cd);
		var podCd     = ComGetObjValue(formObj.pod_cd);
		var porCd     = ComGetObjValue(formObj.por_cd);
		var delCd     = ComGetObjValue(formObj.del_cd);
		
		var dmdtTrfCd = ComGetObjValue(formObj.pgm_id) == "4004" ? comboObjects[0].Text              : ComGetObjValue(formObj.dmdt_trf_cd);
		var rcvTermCd = ComGetObjValue(formObj.pgm_id) == "4004" ? ComGetObjValue(formObj.rcvTermCd) : ComGetObjValue(formObj.rd).substring(0,1);
		var delTermCd = ComGetObjValue(formObj.pgm_id) == "4004" ? ComGetObjValue(formObj.deTermCd)  : ComGetObjValue(formObj.rd).substring(2,3);
		
		var payerCd = "";
		var payerNm = "";
		
		if (	(dmdtTrfCd.indexOf("TI") > 0 && delTermCd == "Y" && delCd.substring(0,2) == "US")
			||  (dmdtTrfCd.indexOf("TO") > 0 && rcvTermCd == "Y" && porCd.substring(0,2) == "US")) {
			
			payerCd = ComGetObjValue(formObj.trucker_cd);
			payerNm = ComGetObjValue(formObj.trucker_nm);			
		}
		else {
			var ioBnd = dmdtTrfCd.substring(2,3);
			if (ioBnd == "O" && ( porCd.substring(0,2) == "US" || porCd.substring(0,2) == "CA" )) {
				
				payerCd = ComGetObjValue(formObj.bkg_cust_cd);
				payerNm = ComGetObjValue(formObj.bkg_cust_nm);	
			}
			else if (ioBnd == "I" && ( delCd.substring(0,2) == "US" || delCd.substring(0,2) == "CA" )) {
				
				payerCd = ComGetObjValue(formObj.bkg_cust_cd);
				payerNm = ComGetObjValue(formObj.bkg_cust_nm);
			}
			else {
				if (ComGetObjValue(formObj.pgm_id) == "4004") {
					payerCd = ComGetObjValue(formObj.act_cust_cd);
					payerNm = ComGetObjValue(formObj.act_cust_nm);
				}
				else {
					payerCd = ComGetObjValue(formObj.payer_cd);
					payerNm = ComGetObjValue(formObj.payer_nm);					
				}
			}
		}
		
		if (ComGetObjValue(formObj.pgm_id) == "4004") {
			ComSetObjValue(formObj.payer_cd, payerCd);
			ComSetObjValue(formObj.payer_nm, payerNm);
		}
		else {
			ComSetObjValue(formObj.h_payer_cd, payerCd);
			ComSetObjValue(formObj.h_payer_nm, payerNm);
		}
	}
	
	/*
	 * Payer Code 를 Customer Code 에 설정해 줍니다.
	 * 사용메뉴화면 : EES_DMT_3109, EES_DMT_4002, EED_DMT_4004
	 */
	function DmtComSetAttentionParams() {
    	var formObj = document.form;
    	
    	var payerCd	  = ComGetObjValue(formObj.payer_cd);
    	var custCntCd = "";
    	var custSeq   = "";
    	
    	switch (payerCd.length) {
    	//Service Provider
    	case 6:
    		custCntCd = "00";
    		custSeq   = payerCd;    		
    		break;
    		
    	case 8:
    		custCntCd = payerCd.substring(0,2);
    		custSeq   = payerCd.substring(2);    		
    		break;
    		
    	default:
    		ComSetObjValue(formObj.payer_cd,    "");
			ComSetObjValue(formObj.cust_cnt_cd, "");
			ComSetObjValue(formObj.cust_seq,    "");  
    		
    	}
    	
    	ComSetObjValue(formObj.cust_cnt_cd, custCntCd);
    	ComSetObjValue(formObj.cust_seq,    custSeq);
	}
	
	/**
	 * --------------------------------------------------------
	 * 발행할 Invoice 를 구성하고 있는 Charge 항목을 
	 * 선택 및 선택해제시 비용을 계산해주는 함수 
	 * --------------------------------------------------------
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * 인도TAX 관련 정보조회를 실행하는 공통함수
	 * 사용화면 : 
	 * EES_DMT_3109 ( Demand Note Issue - Booking )
	 * EES_DMT_4002 ( Invoice Creation & Issue - Booking )  
	 * --------------------------------------------------------
	 */		
	function DmtComCalcAmt(sheetObj, row, checkedValue) {
		var formObj = document.form;
		
		var invCurrCd = ComGetObjValue(formObj.inv_curr_cd);
		
		if (checkedValue == 1) {
			//Incurrend AMT
			var orgChgAmt 		= parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.mn_org_chg_amt),"float")) + parseFloat(sheetObj.CellValue(row, "org_chg_amt"));
			orgChgAmt 			= DMTtrimCurrencyAmount(invCurrCd, orgChgAmt);
			ComSetObjValue(formObj.mn_org_chg_amt, orgChgAmt);
			//Exception AMT
			var exptAmt 		= parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.dmdt_expt_amt),"float")) + parseFloat(sheetObj.CellValue(row, "expt_amt"));
			exptAmt 			= DMTtrimCurrencyAmount(invCurrCd, exptAmt);
			ComSetObjValue(formObj.dmdt_expt_amt, exptAmt);
			//Discount AMT
			var aftExptDcAmt	= parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.chg_dc_amt),"float")) + parseFloat(sheetObj.CellValue(row, "aft_expt_dc_amt"));
			aftExptDcAmt 		= DMTtrimCurrencyAmount(invCurrCd, aftExptDcAmt);
			ComSetObjValue(formObj.chg_dc_amt, aftExptDcAmt);
			//Billable AMT
			var bilAmt 			= parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.mn_bil_amt),"float")) + parseFloat(sheetObj.CellValue(row, "bil_amt"));
			bilAmt 				= DMTtrimCurrencyAmount(invCurrCd, bilAmt);
			ComSetObjValue(formObj.mn_bil_amt, bilAmt);
		} 
		else if (checkedValue == 0) {
			//Incurrend AMT
			var orgChgAmt 		= parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.mn_org_chg_amt),"float")) - parseFloat(sheetObj.CellValue(row, "org_chg_amt"));
			orgChgAmt 			= DMTtrimCurrencyAmount(invCurrCd, orgChgAmt);
			ComSetObjValue(formObj.mn_org_chg_amt, orgChgAmt);
			//Exception AMT
			var exptAmt 		= parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.dmdt_expt_amt),"float")) - parseFloat(sheetObj.CellValue(row, "expt_amt"));
			exptAmt 			= DMTtrimCurrencyAmount(invCurrCd, exptAmt);
			ComSetObjValue(formObj.dmdt_expt_amt, exptAmt);
			//Discount AMT
			var aftExptDcAmt 	= parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.chg_dc_amt),"float")) - parseFloat(sheetObj.CellValue(row, "aft_expt_dc_amt"));
			aftExptDcAmt 		= DMTtrimCurrencyAmount(invCurrCd, aftExptDcAmt);
			ComSetObjValue(formObj.chg_dc_amt, aftExptDcAmt);
			//Billable AMT
			var bilAmt 			= parseFloat(ComGetUnMaskedValue(ComGetObjValue(formObj.mn_bil_amt),"float")) - parseFloat(sheetObj.CellValue(row, "bil_amt"));
			bilAmt 				= DMTtrimCurrencyAmount(invCurrCd, bilAmt);
			ComSetObjValue(formObj.mn_bil_amt, bilAmt);
		}
		
		var iCnt = 0;
		for(var i = 2; i < sheetObj.Totalrows+2; i++) {
			if(sheetObj.CellValue(i, "checkBox") == 1) {
				iCnt++;
			}
		}
		ComSetObjValue(formObj.cntr_cnt, iCnt);		
		
		// Tax Amount, Invoice Amount 를 계산해 줍니다.
		DmtComCalcInvAmtByTaxAmt();
	}
	
	/**
	 * --------------------------------------------------------
	 * 발행할 Invoice 를 구성하고 있는 Charge 항목을 
	 * 선택 및 선택해제시 비용을 계산해주는 함수 
	 * --------------------------------------------------------
	 * [ 사용화면 ] 
	 * --------------------------------------------------------
	 * 인도TAX 관련 정보조회를 실행하는 공통함수
	 * 사용화면 : 
	 * EES_DMT_3007 ( Demand Preview )
	 * EES_DMT_4003 ( Invoice Preview )
	 * --------------------------------------------------------
	 * [ Params ]  
	 * --------------------------------------------------------
	 * dmdtShTpCd ( D : Demand, I : Invoice )
	 * grpFlg     ( Group 여부 )
	 * usrCntCd   ( RD 문서 발행 국가 )
	 * locDivCd   ( Bil To Location Division Code (R : Right, L : Left))
	 * isOnlyFile ( 파일경로를 제외한 파일명만 가져올 것인지 여부)
	 * --------------------------------------------------------
	 */	
	function DmtComGetRdFileNm(dmdtShTpCd, grpFlg, usrCntCd, locDivCd, isOnlyFile) {
		var path = "";
		var file = "";
		var extn = ".mrd";
		
		if (typeof(isOnlyFile) == "undefined") isOnlyFile = false;
		
		switch(dmdtShTpCd) {
		case "D":	//Demand 일 경우
			path = "apps/alps/ees/dmt/dmtinvoicemgt/demandnotesend/report/";

			if (grpFlg == "Y") {	// Group Demand 일 경우
				if (usrCntCd == "IN") {	// India 일 경우
					file = locDivCd == "R" ? "EES_DMT_3908" : "EES_DMT_3907";
	    		}
	    		else {
	    			file = locDivCd == "R" ? "EES_DMT_3904" : "EES_DMT_3903";
	    		}
			}
			else {
				if (usrCntCd == "IN") {
					file = locDivCd == "R" ? "EES_DMT_3906" : "EES_DMT_3905";
	    		}
	    		else {
	    			file = locDivCd == "R" ? "EES_DMT_3902" : "EES_DMT_3901";
	    		}				
			}

			break;
		}
		
		var rdfile = isOnlyFile ? file + extn : path + file + extn;
		
		return rdfile;
	}	
	
	/**
	 * --------------------------------------------------------
	 * REPORT 카테고리 이하 모든 메뉴에서 사용함.
	 * --------------------------------------------------------*/	
	var REPORT_INQUIRY_PERIOD  = 12;	// 조회기간 12개월	
	
	/**
	 * --------------------------------------------------------
	 * CoFormControl 에 있는 함수 (DMT 에 맞게 수정함)
	 * --------------------------------------------------------*/	
    function DmtComEnableObject(obj, bEnable) {
        try {
        	//disabled나 readOnly 설정하기
            switch( obj.type ) {
                case "password" :
                case "text" :
                	obj.readOnly = !bEnable;
                    break;
                default:
                     if(obj.tagName != "OBJECT")  //20150127 Ibsheet exit
                      obj.disabled = !bEnable;
            }

			//설정에 따라 css 처리하기
            switch( obj.type ) {
                case "textarea":
                    if (bEnable){
                    	obj.className = "textarea";
                    } else {
                    	obj.className = "textarea2";
                    }
                    break;

				default :
                    if (obj.tagName=="IMG") {
                        if (bEnable){
                            obj.style.cursor = "hand";
                            obj.style.filter="";
                        } else {
                            obj.style.cursor = "default";
                            obj.style.filter="progid:DXImageTransform.Microsoft.BasicImage(grayScale=1)";
                        }
                    }
            }
        } catch(err) { ComFuncErrMsg(err.message); }
    }	
	