
var sheetObjects = new Array();
var sheetCnt = 0;

/* ???????????????????????? ?????? ???????????? ?????????????????? ?????? */
document.onclick = processButtonClick;

/* ?????? ???????????? ???????????? ??????????????? ?????????????????? ?????????????????? */
    function processButtonClick(){
         /***** ?????? ????????? 2??? ????????? ????????? ?????? ???????????? ???????????? ????????? *****/
         var sheetObject = sheetObjects[0];

         /*******************************************************/
         var formObject = document.form;

    	try {
    		var srcName = window.event.srcElement.getAttribute("name");

            switch(srcName) {

        	    case "btn_retrieve":
    	            doActionIBSheet(sheetObject,formObject,IBSEARCH);
        	        break;

        	    case "btn_createcop":
                     doActionIBSheet(sheetObject,formObject,IBINSERT);
        	        break;


            } // end switch
    	}catch(e) {
    		if( e == "[object Error]") {
    			alert("????????? ???????????? ?????? ????????????");
    		} else {
    			ComShowMessage(e);
    		}
    	}
    }

    /**
     * IBSheet Object??? ????????? ??????
     * ?????? ?????? ???????????? ??????????????? ????????? ?????? ??? ????????? ?????? ??????????????? ????????? ??? ??????
     * ????????? ?????? ????????? ??????
     */
    function setSheetObject(sheet_obj){

       sheetObjects[sheetCnt++] = sheet_obj;


    }

    /**
     * Sheet ?????? ?????? ??? ?????????
     * body ????????? onLoad ?????????????????? ??????
     * ????????? ?????????????????? ????????? ?????? ??????????????? ?????? ????????? ????????????
     */
    function loadPage() {

        for(i=0;i<sheetObjects.length;i++){

        //khlee-?????? ?????? ?????? ?????? ?????? ??????
            ComConfigSheet(sheetObjects[i]);

            initSheet(sheetObjects[i],i+1);
        //khlee-????????? ?????? ?????? ?????? ??????
            ComEndConfigSheet(sheetObjects[i]);
        }


    }

   /**
     * ?????? ???????????????, ?????? ??????
     * param : sheetObj ==> ??????????????????, sheetNo ==> ?????????????????? ????????? ???????????? ?????? ????????????
     * ????????? ????????? ?????? ?????? ????????? case??? ???????????? ?????? ?????????????????? ????????????
     */
    function initSheet(sheetObj,sheetNo) {

        var cnt = 0;

        switch(sheetNo) {
            case 1:      //IBSheet1 init
                with (sheetObj) {
                    //?????? ?????? ??????
                    style.height = 395 ;
                    SheetWidth = mainTable.clientWidth;

                    //Host?????? ??????[??????][HostIp, Port, PagePath]
                    if (location.hostname != "") InitHostInfo(location.hostname, location.port, page_path);

                    //??????Merge ?????? [??????, Default msNone]
                    MergeSheet = msHeaderOnly;

                    //??????Edit ?????? ?????? [??????, Default false]
                    Editable = true;

                    //???????????????[??????][HEADROWS,DATAROWS,VIEWROWS,ONEPAGEROWS=100]
                    InitRowInfo( 1, 1, 9, 100);

                   //??????????????????[??????][COLS,FROZENCOL,LEFTHEADCOLS=0,FROZENMOVE=false]
                    InitColumnInfo(13, 0, 0, true);

                    // ???????????? ????????? ??? ?????? ?????? ????????? ????????????
                    InitHeadMode(true, true, true, true, false,false)

                    //var HeadTitle = "Chk|Product Catalog No.|Booking No.|Creation User ID|Creation Date|Creation Time" ;
                    var HeadTitle = "|STS|BKG Receive Date|BKG Receive SEQ|COP Event SEQ|BKG Event Type|BKG No.|BKG No.|Container\nType/Size|Container No.|BKG Event\nDate/Time|BKG Event\nDate/Time|BKG Interface\nStatus" ;

                    //???????????????[??????][ROW,HEADTEXT,ROWMERGE=false, HIDDEN=false]
                    InitHeadRow(0, HeadTitle, true);

                    //???????????????    [ROW, COL,  DATATYPE,   WIDTH, DATAALIGN, COLMERGE, 	SAVENAME,  				KEYFIELD, CALCULOGIC, DATAFORMAT, POINTCOUNT, UPDATEEDIT, INSERTEDIT, EDITLEN, FULLINPUT, SORTENABLE, TOOLTIP, ALLCHECK, SAVESTATUS, FORMATFIX]
                    InitDataProperty(0, cnt++ , dtCheckBox,   30,    daCenter,  false,    "r_chk",				false,          "",       dfNone,     	0,     true,       true);
                    InitDataProperty(0, cnt++ , dtHiddenStatus,     30,    daCenter,  false,    "ib_flag",			false,          "",       dfNone,     	0,     true,       true);
                    InitDataProperty(0, cnt++ , dtData,      100,    daCenter,  false,    "r_bkg_rcv_dt",		false,          "",       dfDateYmd,   	0,     false,       true);
                    InitDataProperty(0, cnt++ , dtData,      100,    daCenter,  false,    "r_bkg_rcv_no",		false,          "",       dfNone,   	0,     false,       true);
                    InitDataProperty(0, cnt++ , dtData,       90,    daCenter,  false,    "r_cop_evnt_seq",     false,          "",       dfNone,   	0,     false,       true);
                    InitDataProperty(0, cnt++ , dtData,       90,    daCenter,  false,    "r_bkg_evnt_tp_cd",   false,          "",       dfNone,   	0,     false,       true);
                    InitDataProperty(0, cnt++ , dtData,       86,    daCenter,  false,    "r_bkg_no",	        false,          "",       dfNone,   	0,     false,       true);
                    InitDataProperty(0, cnt++ , dtData,       30,    daCenter,  false,    "r_bkg_no_split",     false,          "",       dfNone,   	0,     false,       true);
                    InitDataProperty(0, cnt++ , dtData,       80,    daCenter,  false,    "r_cntr_tpsz_cd",     false,          "",       dfNone,   	0,     false,       true);
                    InitDataProperty(0, cnt++ , dtData,       83,    daCenter,  false,    "r_cntr_no",          false,          "",       dfNone,   	0,     false,       true);
                    InitDataProperty(0, cnt++ , dtData,       70,    daCenter,  false,    "r_bkg_evnt_date",    false,          "",       dfDateYmd,   	0,     false,       true);
                    InitDataProperty(0, cnt++ , dtData,       35,    daCenter,  false,    "r_bkg_evnt_time",    false,          "",       dfTimeHm,   	0,     false,       true);
                    InitDataProperty(0, cnt++ , dtData,       80,    daCenter,  false,    "r_bkg_if_sts_cd",    false,          "",       dfNone,   	0,     false,       true);
                    
               }
                break;

        }
    }

  // Sheet?????? ???????????? ??????
    function doActionIBSheet(sheetObj,formObj,sAction) {
		sheetObj.ShowDebugMsg = false ;
		switch(sAction) {
		   case IBSEARCH:	  //??????
                formObj.f_cmd.value = SEARCHLIST01 ;
                formObj.target = "_self" ;
                sheetObj.DoSearch4Post("/hanjin/ESD_SCE_0031Search.do", SceFrmQryString(formObj));           
				break;

           case IBINSERT:	  //??????
                formObj.f_cmd.value = ADD ;
                formObj.target = "_self" ;
                //sheetObj.DoSearch4Post("/hanjin/ESD_SCE_0031Search.do", SceFrmQryString(formObj));
                sheetObj.DoSave("/hanjin/ESD_SCE_0031Search.do", SceFrmQryString(formObj));              
				break;

		}
	}


   /**
     * ?????? ??????????????? ?????? ??????????????? ???????????? ??????
     */
    function validateForm(sheetObj,formObj,sAction){
        with(formObj){
//            if (!isNumber(iPage)) {
//
//                return false;
//            }
        }

        return true;
    }
    
    function sheet1_OnAfterColumnMove(sheetObj, col, newPos){
    	var newColName = sheetObj.ColSaveName(newPos) ;
    	switch (newColName) {
    		case "r_bkg_no":
    			if (col > newPos){
    				 newPos = newPos+1;
    			}
    			
      			sheetObj.MoveColumnPos("r_bkg_no_split", newPos, false);
    			break;

    		default:
    			break;
    	}

    }
