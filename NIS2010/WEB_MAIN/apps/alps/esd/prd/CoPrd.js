	// PRD - product catalog 추가  
	msgs['PRD90001'] = 'Please select one of Geographical Hierarchy Code.';
	msgs['PRD90002'] = 'Please select one of Country, Location or Yard.';
	msgs['PRD90003'] = 'Please select one of Country, Location or Zone.';
	msgs['PRD90004'] = 'Please enter (Port & Hub Location) or (Port & Location).';
	msgs['PRD90005'] = 'Please enter (Port) or (Hub Location).';
	msgs['PRD90006'] = 'There is no basic data for saving.\n\n Please check your input data.';
	msgs['PRD90007'] = 'There is no basic data for retrieving.\n\n Please check your input data.';
	msgs['PRD90008'] = 'Please enter Port Codes.';
	msgs['PRD90009'] = 'Please enter Service Provider Codes.';
	msgs['PRD90010'] = 'Completed searching.';
	msgs['PRD90011'] = 'You can not select different Location.';
	msgs['PRD90012'] =  '4th T/S POD does not match the last POD.';
	msgs['PRD90013'] =  'There is no data retrieved.';
	msgs['PRD90014'] =  'Please enter 4 digits all (DD.HH).'; 
	msgs['PRD90015'] =  'Hours must be under 24 (HH < 24).'; 
	msgs['PRD90016'] =  'English numbers must be entered.';
	msgs['PRD90017'] =  'In case of USA, you must select INV BILLING.';
	msgs['PRD90018'] =  'In case of USA, you must select Route Plan.';
	msgs['PRD90019'] =  'In case of USA, you must select WRS(F).';
	msgs['PRD90020'] =  'In case of USA, you must select WRS(M).';
	msgs['PRD90021'] =  'Combined Mode setting is wrong.\n\n Please check data!';
	msgs['PRD90022'] =  'It differs from 1st selected Service provider.';
	msgs['PRD90023'] =  'Data must be more than 2 items.';
	msgs['PRD90024'] =  'Selected one must be more than 2 items.';
	msgs['PRD90025'] =  'There is a link undefined.';
	msgs['PRD90026'] =  'There is a Route undefined.';
	msgs['PRD90027'] =  'Start of router differs from end.';
	msgs['PRD90028'] =  'The router does not match retrieve option.';
	msgs['PRD90029'] =  'Start & end Node of details differs from selected Route.';
	msgs['PRD90030'] =  'Route connection is wrong.';
	msgs['PRD90031'] =  'There is unmatched Route with retrieve option.';
	msgs['PRD90032'] =  'The Route does not match retrieve option.';
	msgs['PRD90033'] =  'Please check the Constraint, because relevant Route has been adapted with the Constraint.';
	msgs['PRD90034'] =  'Selected INV Billing & INV Pattern differ from checked one.';
	msgs['PRD90035'] =  'Please select it after save Inland Each Link.';
	msgs['PRD90037'] =  'In case of USA Rail, AGMT NO(Reference No) is mandatory item.';
	msgs['PRD90038'] =  'In case of USA Rail, C/T OFC is mandatory item.';
	msgs['PRD90039'] =  'There is no authority to use the function.';
	msgs['PRD90040'] =  'You just select a interim route which makes irregular route possible to a certain booking.\n\n It may contain incorrect cost or transit time, and cause unnecessary rehandling.\n\n Please, make sure your route with your supervisor or other reference available.';
	msgs['PRD90041'] =  'If Rail is included on Transportation mode in USA area, it is impossible to save changing Link & Mode.\n\n Please use SAVE AS!';
	msgs['PRD90042'] =  'In case of no-change, could not create duplicated IRG.';
	msgs['PRD90043'] =  'Do you want to save it as new root?';
	msgs['PRD90044'] =  'If you delete inland each links, inland routes composed of those inland each links will be deleted too.\n\n Do you want to continue? ';
	msgs['PRD90045'] =  'Each link composed of pseudo yard cannot be saved.[$s]';
	msgs['PRD90046'] =  'Each link composed of invalid node cannot be saved.[$s]';
	msgs['PRD90047'] =  'Each link composed of invalid service provider cannot be saved.';
//	msgs['PRD90047'] =  'Each link composed of invalid service provider cannot be saved.[ {?msg1} ]';
	msgs['PRD90048'] = ' Change of INV Billing &INV Pattern ,Route Plan is not allowed, Please use SAVE AS!';
    msgs['PRD90049'] = ' AGMT No is Rail attribute.';
    msgs['PRD90050'] = ' Reference NO is Rail attribute.';
    msgs['PRD90051'] = ' C/TOFC is Rail attribute.';
    msgs['PRD90052'] = ' Junction is Rail attribute.';
    msgs['PRD90053'] = ' You Select IRR Ocean Route(Doubt Route) ! Will You Create This IRR Route ?';
    msgs['PRD90054'] = ' The service is not available now.';
    msgs['PRD90055'] = ' Unmatched commodity code!!';
    msgs['PRD90056'] = ' Please select the \'CNTR TYPE\'!! - ROW[{?msg1}]';
    msgs['PRD90057'] = ' Effective Date must be in 365 days.';
    msgs['PRD90058'] = ' Unmatched container type!!';
    msgs['PRD90059'] = ' Invalid Location/Node Code.';
    msgs['PRD90060'] = ' Invalid Port Code.';
    msgs['PRD90061'] = ' Invalid Node Code.';
    msgs['PRD90062'] = ' Already exists.';
    msgs['PRD90063'] = ' Floating pop-up is not enough information dispaly properties.';
    msgs['PRD90064'] = ' This node can not be registered because the PSEUDO CODE.[ {?msg1} ] \n';
    msgs['PRD90065'] = ' This node can not be registered because it was not saved.[ {?msg1} ] \n';
    msgs['PRD90066'] = ' The following can not be registered because it was not registered VENDOR.[ {?msg1} ]';
    msgs['PRD90067'] = ' Destination node must be different from orgin node';
    msgs['PRD90068'] = ' The correspondence route does not exist it will not be able to amend Reference number to Inland Route.[ {?msg1} ] \n';
    msgs['PRD90069'] = ' When agreement no does not blong to S/P code, it will not be able to amend Reference number in IRG.[ {?msg1} ] \n';
    msgs['PRD90070'] = ' When agreement no does not blong to S/P code, it will not be able to amend Reference number in IRG.\n';
    msgs['PRD90071'] = ' POL/POD and POR/DEL should not be same Code';
    msgs['PRD90072'] = ' Duplicated Route already exists. Please check the routes and proceed accordingly.';
    msgs['PRD90073'] = ' Your requested Data is Deleted Stauts. And it will be changed Live Status';
    msgs['PRD90074'] = 'Only the countries in Europe, Asia can be available';
    msgs['PRD90075'] = 'When combinedMode select , must be difference transper mode';
    msgs['PRD90076'] = 'AGMT No is US Rail attribute.';
    msgs['PRD90077'] = 'S/P Name Search Popup Open!! row= {?msg1}';
    msgs['PRD90078'] = 'If you are deleting this, you won\'t be able to retrieve the same route again,Are you sure to delete it?';
    msgs['PRD90079'] = 'Latest information WRS(M) no information is allowed to select';
    msgs['PRD90080'] = 'If Rail is included on Transportation mode in USA area, it is impossible to save changing Link & Mode.';
    msgs['PRD90081'] = 'Input data check Junction';
    msgs['PRD90082'] = 'Empty irg  first mode & last mode RD';
    msgs['PRD90083'] = 'Details of the selected Node Route starting and ending with the different.';
    msgs['PRD90084'] = 'If you are deleting this, you won\'t be able to retrieve the same route again,Are you sure to delete it';
    msgs['PRD90085'] = 'WRS CHECK, Is not a condition satisfactorily';
    msgs['PRD90086'] = 'Latest information WRS(F) no information is allowed to select';
    msgs['PRD90087'] = 'WRS indicator is duplicated for the same corridor. \n Please select one WRS indicator only for this route and try it once again. Continue?';
    msgs['PRD90088'] = 'The prioirity will be changed to \'1\' automatically. Continue?';
    msgs['PRD90089'] = 'When Priority is  0, Can\'t cheak BKG .';
    msgs['PRD90090'] = 'Not select Value 0.';
    msgs['PRD90091'] = 'Org cd is 5 or 7 characters long.';
    msgs['PRD90092'] = 'Org cd is 5 characters long.';
    msgs['PRD90093'] = 'Dest cd is 5 or 7 characters long';
    msgs['PRD90094'] = 'Dest cd is 5 characters long.';
    msgs['PRD90095'] = 'Hub CD is 5 or 7 characters long.';
    msgs['PRD90096'] = 'Please enter (Loc & Hub Location) or (Loc & Loc)';
    msgs['PRD90097'] = 'Only the countries in America can be available.';
    msgs['PRD90098'] = 'You can not enter FDR lane!';  
    msgs['PRD90099'] = 'You can not enter more than 100 days';
    msgs['PRD90100'] = 'Ocn Flag is mandatory!!';
    msgs['PRD90101'] = '{?msg1} requires.';
    msgs['PRD90102'] = 'Please select a type of temp flag';
    msgs['PRD90103'] = 'Please input Rmk';
    msgs['PRD90104'] = 'You can\'t choose the \'{?msg1}\' flag.!!';
    msgs['PRD90105'] = 'include invalid link, check link info.';
    msgs['PRD90106'] = 'checked route list';
    msgs['PRD90107'] = 'RMK is mandatory!!';
    msgs['PRD90108'] = 'Please enter a mandatory';
    msgs['PRD90109'] = 'Only US, CA, MX can be input.';
    msgs['PRD90110'] = 'node_type_div [{?msg1}] value \'GGY\', \'Z\' is not.';
    msgs['PRD90111'] = 'Empty IRG is only for the countries in America.';
    msgs['PRD90112'] = '{?msg1} Record {?msg2} is mandatory item.';
  	msgs['PRD90113'] = 'This shipment is under the network constraint.\n Please check a constraint item at the bottom of right side by clicking \'Constraints\' button.';
  	msgs['PRD90114'] = 'Exceptional error occurred while replaning P/C of this booking.\nPlease report this to the system administrator.';
  	msgs['PRD90115'] = 'If you change an Inland link\'s inforamtion,\nthe all relevant route\'s inforamtion also can be changed.\nDo you really change an inland link\'s information now ?';
  	msgs['PRD90116'] = 'A specific lane code can\'t be inputted,\nso each and all specific lane code was automatically changed to \'FDR\' code';
  	msgs['PRD90117'] = 'Please enter  Port or Hub Location or Location.';
  	msgs['PRD90118'] = 'You don\'t have the authority to set a constraint for all ports or all lanes.\nPlease contact COL - TN / BA part if you want to set a constraint for all ports or all lanes with details.';
  	msgs['PRD90119'] = 'At leaset {?msg1} column(s) with {?msg2} digits should be inputted for data inquiry.';
  	msgs['PRD90120'] = 'At least \'{?msg1}\' digits in mandatory fields should be inputted.';
  	msgs['PRD90121'] = 'Please input Country Code(2 digits) or Location Code(5 digits)';
  	msgs['PRD90122'] = 'When using \'Auto\'/\'Manual Creation\' function, POL/POD should be filled with location code.';
    msgs['PRD90123'] = 'Please tick \'CHK\' column off in the row to be changed in order to verify the row for route creation.';
    msgs['PRD90124'] = 'In case Type is \'The Others\', \'Note\' column is mandatory.';
    msgs['PRD90125'] = 'The route has been already registered.';
    msgs['PRD90126'] = 'HQ Ocean Link which was automatically created by VSL P/F can\'t be manually deleted';
    msgs['PRD90127'] = 'An error occured during HQ Link Save.';
    msgs['PRD90128'] = 'If you delete the HQ Ocean Link, all ocean routes including\nthe HQ Ocean Link will be also deleted.\nDo you really want to delete ?';
    msgs['PRD90129'] = 'While {?msg1}, network problem or system shutdown occured';
    msgs['PRD90130'] = 'You don\'t have the authority to change constranit information.\nPlease request a creation office or COL - TN';
    msgs['PRD90131'] = "All rows can be saved. Do you really want to save all rows?";
    msgs['PRD90132'] = "Please check each row's Verification Result \nand try to save again after modification";
    msgs['PRD90133'] = "The lane code & VVD Code are not matching, please check it!";
    msgs['PRD90134'] = "VVD can be inputted when Point of Port is one of ALL, POL, T/S or POD.";
    msgs['PRD90135'] = "Lane & VVD can be inputted when Mode is only Water (Trunk & FDR)";
    msgs['PRD90136'] = "Optimum IRG has 2 Links at the most.\nBefore optimum flag set-up, Plz recheck and try.";
    msgs['PRD90137'] = "Under Optimum Flag Check, BKG Flag uncheck and Temp Flag check is impossible.\nPlz recheck status of Optimum Flag";
    msgs['PRD90138'] = "In case of adding IRG whose link is more than two on this leg,\nplz recheck whether we have already Optimum IRG or not on this leg.\nIf not, plz set up Optimum IRG that has two or less links in advance."; // db에 등록(서버 메시지)
    msgs['PRD90139'] = "There is an improper data, Please check your input data";
    msgs['PRD90140'] = "Route for TMNL Shuttle can't have optimum flag.";
    msgs['PRD90141'] = "Optimum flagged route can be deleted only in the below case ;\n\n1) if optimum flag is automatically unchecked, after other optimum route replace it\n\n2) if we don't have any other alternative route on this leg";
    msgs['PRD90142'] = "Validation date should be input within 90days from today"; //30일 이상일때
    msgs['PRD90143'] = "Validation date should be input within 90days from today"; //Validation date를 입력하지 않았을 때
    msgs['PRD90144'] = "You cannot select both Optimum and Alternative Optimum \nfor one IRG.\nPlease select either Optimum or Alternative Optimum."; 
    msgs['PRD90145'] = "You only can choose the \'{?msg1}\' flag!!";
    msgs['PRD90146'] = "You can revive manual link only as Temporary";
    msgs['PRD90147'] = "Expiration date should be input within 90 days from today"; // expiration date를 입력하지 않았을 때
    msgs['PRD90148'] = "Expiration date should be input within 90 days from today"; // expiration date가 90일 초과 일 때
    msgs['PRD90149'] = "You can save and use it";


////////////////////////////////////////////////////////////////////////////////////////////////////
// PrdCommon.js  에 있던 소스
////////////////////////////////////////////////////////////////////////////////////////////////////

//Axon 이벤트 처리2. 이벤트처리함수
function obj_deactivate(){
	ComChkObjValid(event.srcElement);
}

// axon_event.addListenerFormat() 용
function obj_activate(){
	ComClearSeparator(event.srcElement);
}

// axon_event.addListenerFormat() 용 dataformat 속성 처리 함수
function obj_keypress(){
	obj = event.srcElement;
	if(obj.dataformat == null) return;
	window.defaultStatus = obj.dataformat;

	switch(obj.dataformat) {
		case "ymd":
		case "ym":
		case "hms":
		case "hm":
		case "jumin":
		case "saupja":
			ComKeyOnlyNumber(obj);
			break;
		case "int":
			if(obj.name=="txtInt") ComKeyOnlyNumber(obj, "-")
			else ComKeyOnlyNumber(obj);
			break;
		case "float":
			ComKeyOnlyNumber(obj, "-.");
			break;
		case "eng":
			ComKeyOnlyAlphabet(); break;
		case "engup":
			ComKeyOnlyAlphabet('uppernum');
			break;
		case "engup2":
			ComKeyOnlyAlphabet('upper');
			break;
		case "engdn":
			 ComKeyOnlyAlphabet('lowernum');
		case "engdn2":
			ComKeyOnlyAlphabet('lower');
			break;
	}
}

// axon_event.addListener()용 엔터치면 Retrieve 하는 래퍼 함수
function PrdComKeyEnter(){
	ComKeyEnter('search');
}

/**
 * sheetObj.GetSaveXml() 함수로 xml 문자열 값을 이용하여 콤보 박스에 맞는 문자열을 리턴한다.
 * 예) 서울|부산|대구|광주|목포
 */
function PrdComEtcDataToComboString(xml){
	var xmlObject = new ActiveXObject("Msxml2.DOMDocument");
	xmlObject.loadXML(xml);
	var etcNodes = xmlObject.documentElement.childNodes[1];
	var buffer = "";
	for(i=0; i<etcNodes.childNodes.length; i++ ){
		var laneCode = etcNodes.childNodes[i].firstChild.text;
		if(laneCode.length < 3) continue;
		buffer += "|"+ laneCode;
	}
	return buffer.substring(1, buffer.length);
}

var popupArray; // 팝업 호출 후 팝업에서 받은 배열 값 저장 객체
/**
 * html 폼용으로 호출시 PrdComPopup("location", document.form.input1);
 * sheet 폼용으로 호출시 PrdComPopup("location", null, sheetObj, row, "colName");
 */
function PrdComPopup(searchType, formObject, sheetObject, row, colName){
	var paramValue;
	if(sheetObject == null){ // HTML 폼 객체면
		paramValue = formObject.value;
	}else{ // sheet 객체면
		paramValue = sheetObject.CellValue(row, colName);
	}
	var outValue = "";
	if(searchType == "location"){
		ComOpenPopup('/hanjin/COM_ENS_051.do' + "?loc_cd="+paramValue, 770, 470, 'PrdSetPopupArray', "1,0,1,1,1,1,1,1,1,1,1,1", true);
		if(popupArray != null){ // 선택 안하고 종료하면 에러난다. 그래서 검사
			outValue = popupArray[0][3];
		}
	}else if(searchType == "yard"){
		ComOpenPopup('/hanjin/COM_ENS_061.do' + "?node_cd="+paramValue, 770, 470, 'PrdSetPopupArray', "1,0,1,1,1,1,1,1,1,1,1,1", true);
		if(popupArray != null){
			outValue = popupArray[0][3];
		}
	}else if(searchType == "lane"){
		ComOpenPopup('/hanjin/COM_ENS_081.do' + "?lane_cd="+paramValue, 770, 470, 'PrdSetPopupArray', "1,0,1,1,1,1,1,1,1,1,1,1", true);
		if(popupArray != null){
			outValue = popupArray[0][3];
		}
	}
	// 폼이나 쉬트 컬럼에 값주기
	if(sheetObject == null){ // HTML 폼이면
		formObject.value = outValue;
	}else{ // sheet 객체면
		sheetObject.CellValue2(row, colName) = outValue;
	}
}

function PrdSetPopupArray(popupArray){
	this.popupArray = popupArray;

	// debug 확인용 TODO 정리 noh
	if(confirm("배열 값을 debug 하시겠습니까?")){
		var ao = popupArray[0];
		for(i=0; i<ao.length; i++){
			ComShowMessage(i + " | "+ao[i]);
		}
	}
}

////////////////////////////////////////////////////////////////////////////////////////////////////
// Util.js  에 있던 소스
////////////////////////////////////////////////////////////////////////////////////////////////////

document.onkeypress = processEnterKey;
jsLEng  = "ABCDEFGHIJKLMNOPQRSTUVWXYZ" ;
jsSEng  = "abcdefghijklmnopqrstuvwxyz" ;
jsEng   = jsLEng + jsSEng ;
jsNum   = "0123456789";
jsSChar = "!@#$%^&*()_+=-,./<>?;':\"{}[]" ;

prdToolTipId_1 = "Delevery due date";
prdToolTipId_2 = "Return CY";
sheet1 ="sheet1";
sheet2 ="sheet2";
sheet3 ="sheet3";


/**
 *  enterKey 처리
 */
function processEnterKey() {
    try {
            var srcObj=window.event.srcElement.nodeName;
			var keyObj=window.event.keyCode;
            if((srcObj =='INPUT'|| srcObj =='SELECT')&& keyObj ==13) {

                processButtonClick()
            }
    }catch(e) {
    }
}

function onEnterKey(srcName) {
		// 버튼이 disable 인지 확인한다.
        if(srcName != null && !isEmpty2(srcName)) {
            var btnDis  = eval("document.form."+srcName+".disabled");
            if (btnDis) return;
        }
        /****************************
         enterKey 처리
        *****************************/
        var srcObj=window.event.srcElement.nodeName;
        var keyObj=window.event.keyCode;
        if(srcObj =='INPUT' && keyObj ==13) {
            validateData = eval('document.form.'+srcName+'.value');
            eval('document.form.'+srcName+'.value=\''+validateData.toUpperCase()+'\'' );
            srcName ='btn_retrieve';
        }
        return srcName;
        /****************************/
}
 /**
  * 대상 Img Object를 enable 시킨다.
  * @param  obj   대상 폼태그(Object)
  * @return
  */
function bntImgEnable(obj, gb) {

  var objNm = obj.name;
  var btnStyle = eval("document."+objNm+".style");

  if (gb){
       obj.disabled = false;
       btnStyle.cursor = "hand";
       btnStyle.filter="";
  } else {
       obj.disabled = true;
       btnStyle.cursor = "default";
       btnStyle.filter="progid:DXImageTransform.Microsoft.BasicImage(grayScale=1)";
  }
}

 /**
  * 대상 같은 이름의 Img Object를 enable,disable 시킨다.
  * @param  obj   대상 폼태그(Object)
  * @param  idx   같은 이름의 이미지 인덱스 , 9999 일때 전체 적용
  * @param  gb    true, false 로 true 일때 활성화
  * ex:  bntImgEnable2(document.form.ib_org_loc_btn[1], 0, true);
  * @return
  */
function bntImgEnable2(obj, idx, gb) {

//  alert(obj[0].name);
  var objNm = obj[0].name;
  //alert(document.getElementsByName(objNm).length);
  var aInput = document.getElementsByName(objNm);
  var btnStyle;
  if(idx!= 9999){
      btnStyle =  aInput[idx].style;
  }
//  var btnStyle = eval("document."+objNm[idx]+".style");

  if (gb){
       if(idx== 9999){
           aInput.disabled = false;
           for(var index=0; index<aInput.length; index++) {
               btnStyle =  aInput[index].style;
           	   btnStyle.cursor = "hand";
           	   btnStyle.filter="";
           }
       } else {
           aInput[idx].disabled = false;
           btnStyle.cursor = "hand";
           btnStyle.filter="";
       }

  } else {
       if(idx== 9999){
           aInput.disabled = true;
           for(var index=0; index<aInput.length; index++) {
               btnStyle =  aInput[index].style;
           	   btnStyle.cursor = "default";
           	   btnStyle.filter="progid:DXImageTransform.Microsoft.BasicImage(grayScale=1)";
           }
       } else {
           aInput[idx].disabled = true;
           btnStyle.cursor = "default";
           btnStyle.filter="progid:DXImageTransform.Microsoft.BasicImage(grayScale=1)";
       }
//       aInput[idx].disabled = true;
//       btnStyle.cursor = "none";
//       btnStyle.filter="progid:DXImageTransform.Microsoft.BasicImage(grayScale=1)";
  }
}

/**
 * 왼쪽에 ch 문자 채우기
 */
function lpad(newValue, len, ch){

     var strlen = trim(newValue).length;
     var ret = "";
     var alen = len - strlen;
     var astr = "";

     //부족한 숫자만큼  len 크기로 ch 문자로 채우기
     for (i=0; i<alen; ++i)
     {
      astr = astr + ch;
     }

     ret = astr + trim(newValue); //앞에서 채우기
     return ret;
}

function inputUpper(obj) {
	var objNm = obj.name;
    var objVal = eval('document.form.'+objNm+'.value');
    var objEle = eval('document.form.'+objNm);
    validateData = objVal.toUpperCase();
    eval('document.form.'+objNm+'.value=\''+validateData+'\'' );
}

/**
 * 입력된값을 대문자로 바꾸고
 */
function inputChkUpper(obj, e, cmd) {
	var objNm = obj.name;
	
    var objVal = eval('document.form.'+objNm+'.value');
    var objEle = eval('document.form.'+objNm);
	re = /^[a-zA-Z0-9]+$/;
	te = /\t/;
    validateData = objVal.toUpperCase();
    eval('document.form.'+objNm+'.value=\''+validateData+'\'' );
    var isManagedCmd = false;

	if(e==9) {
	    if(objVal.length>0) {
	        
	    	// port code check
	        if(cmd =='SEARCH01') {
	        	isManagedCmd = true;
	        	doActionIBSheet(sheetObjects[0],document.form,SEARCH01);

            // location search
		    }else if(cmd =='SEARCH02') {
		    	isManagedCmd = true;
    		    doActionIBSheet(sheetObjects[0],document.form,SEARCH02);
            // node search
		    }else if(cmd =='SEARCH04' && objVal.length ==7) {
		    	isManagedCmd = true;
    		    doActionIBSheet(sheetObjects[0],document.form,SEARCH04);
            // Terminal search
		    } else if(cmd =='SEARCH05') {
		    	isManagedCmd = true;
    		    doActionIBSheet(sheetObjects[0],document.form,SEARCH05);

            // country code check
		    } else if(cmd =='SEARCH06') {
		    	isManagedCmd = true;
    		    doActionIBSheet(sheetObjects[0],document.form,SEARCH06);

            // lane code check
		    } else if(cmd =='SEARCH07') {
		    	isManagedCmd = true;
    		    doActionIBSheet(sheetObjects[0],document.form,SEARCH07);
            // Calling Tml Mtx lane code check
		    } else if(cmd =='SEARCH10') {
		    	isManagedCmd = true;
    		    doActionIBSheet(sheetObjects[0],document.form,SEARCH10);

            // S/P check
		    } else if(cmd =='SEARCH08') {
		    	isManagedCmd = true;
    		    doActionIBSheet(sheetObjects[0],document.form,SEARCH08);
		    }
	    	if (isManagedCmd && (isNaN(parseInt(retValidate))|| parseInt(retValidate) < 1)) { 
	    		if(objEle.type =='select-one') {
	    			
	    			objEle.selectedIndex ;
                }else if (objEle.type == 'text' ) {
                	objEle.select();
                }
                objEle.focus();
		    } else {
        	    // 다음 포커스로 이동
                tmp = GetObjectByTabIndex(document.form,objEle.tabIndex);
                if (tmp == null) tmp = GetObjectByTabIndex(document.form,0);
                if (tmp != null) tmp.focus();
		    }
	    	
//	        if((retValidate == null || parseInt(retValidate) == 0 || parseInt(retValidate) < 1) && cmd !="") {
//	        	alert("'" + retValidate + "'" + cmd);
//		        if (objEle.tabIndex == 1) {
//		        	objEle.focus();
//	                objEle.select();
//                } else {
//                    tmp = GetObjectByTabIndex(document.form,objEle.tabIndex - 1);
//                    if (tmp == null) tmp = GetObjectByTabIndex(document.form,1);
//                    if (tmp != null) {
//                        if(tmp.type =='select-one') {
//                            tmp.selectedIndex ;
//                        }else if (tmp.type == 'text' ) {
//                        	tmp.select();
//                        }
//                        tmp.focus();
//                    }                	
//                }
//                
//                return false;
//        	} else if(cmd !="") { // 어떤 command를 수행후 정상일때
//        	    // 다음 포커스로 이동
//                tmp = GetObjectByTabIndex(document.form,objEle.tabIndex);
//                if (tmp == null) tmp = GetObjectByTabIndex(document.form,1);
//                if (tmp != null) {
//                    if(tmp.type =='select-one') {
//                        tmp.selectedIndex ;
//                    }else if (tmp.type == 'text' ) {
//                    	tmp.select();
//                    }
//                    tmp.focus();
//                //objEle.focus();
//                }
//                return true;
//        	}
//
//
//	    } else {
//    	    // 다음 포커스로 이동
//            tmp = GetObjectByTabIndex(document.form,objEle.tabIndex);
//            if (tmp == null) tmp = GetObjectByTabIndex(document.form,1);
//
//            if (tmp != null) {
//            	if(tmp.type =='select-one') {
//                    tmp.selectedIndex ;
//            	}else if (tmp.type == 'text' ) {
//            		tmp.select(); 
//            	}
//                tmp.focus();
//            }
//            return false;
	    }

	} else
	if (e==8 || e==46 || (e>=37 && e<=40)){
	} else {
	    if(objVal.length>0) {
		    //대문자로 변경, 알파벳,숫자인지 체크
			if(re.test(objVal)) {
			    objEle.value  = objVal.toUpperCase();
                return false;
			} else {
			    ComShowMessage(getMsg('PRD90016'));
			}
	    }

	}
}

/**
 * 입력된값을 대문자로 바꾸고 validation check
 */
function inputChkUpper2(obj, e) {
	var objNm = obj.name;
    var objVal = eval('document.form.'+objNm+'.value');
    var objEle = eval('document.form.'+objNm);
	re = /^[a-zA-Z0-9]+$/;
	te = /\t/;
    validateData = objVal.toUpperCase();
	if(e==9) {
		//validation check
		doActionIBSheet(sheetObjects[0],document.form,SEARCH02);
		if(retValidate < 1) {
            objEle.focus();
    	}
    	else {
//    	    // 다음 포커스로 이동
//            tmp = GetObjectByTabIndex(document.form,objEle.tabIndex+1);
//            if (tmp == null) tmp = GetObjectByTabIndex(1);
//            if (tmp != null) tmp.focus();

            //objEle.focus();
    	}
	} else if (e==8 || e==46 || (e>=37 && e<=40)){
		//('bs del 방향키 무시 ');
	} else {
		if(re.test(objVal)) {
		    objEle.value  = objVal.toUpperCase();
		} else {
		    ComShowMessage(getMsg('PRD90016'));
		}
	}
}

/**
 * 입력한 tabIndex로 객체리턴
 */
function GetObjectByTabIndex(formObj,index){

    for (i = 0; i < formObj.length; i++){
        tmp = formObj.elements[i];
        if (tmp.tabIndex == index){
            return tmp;
        }
    }
    return null;
}

/**
 * 탭 이동
 */
function move_next_tab(obj) {
    var objNm = obj.name;
    var objVal = eval('document.form.'+objNm+'.value');
    var objEle = eval('document.form.'+objNm);
    // 다음 포커스로 이동
    tmp = GetObjectByTabIndex(document.form,objEle.tabIndex+1);
    if (tmp == null) tmp = GetObjectByTabIndex(document.form,1);
//   alert(tmp.name);

    if (tmp != null) {
        tmp.focus();
        if(tmp.type =='select-one') {
            tmp.selectedIndex ;
        }else {

            tmp.select();
        }
    }
//    return false;
}
/**
 * 필드 유혀성 체크
 *
 * @param obj Field Object
 * @param type Check type
 * @param upper 대문자 변환여부
 * @param maxLen 최대길이
 * @param pchar 허용 문자
 * @param format Format
 */

function chkField(obj, type, upper, maxLen, pchar, format){
	switch (type) {
		case "eng_num" :
			chkEngNumObj(obj, upper, maxLen) ;
			break;
		case "eng" :
			chkEngObj(obj, upper, maxLen) ;
			break ;
		case "leng" :
			chkLEngObj(obj, upper, maxLen) ;
			break ;
		case "seng" :
			chkSEngObj(obj, upper, maxLen) ;
			break ;
		case "num" :
			chkNumObj(obj, maxLen, format) ;
			break ;
		case "custmoer" :
			chkCharObj(obj, pchar, upper, maxLen) ;
			break ;
		case "date" :
			dateFormatObj(obj, format) ;
		default:
			break;
	}
}

function dateFormatObj(obj, format){
	var value = obj.value ;
	obj.value = dateFormatValue(value, format)
}




function dateFormatValue(value, format) {
	var oldValue = chkCharValue(value, jsNum, false) ;
	var newValue = "" ;
	var chkValue = "" ;
	var oneChar  = null ;
	var maxLen   = 8 + (format.length*2)

	for(i=0; i<oldValue.length; i++){
		oneChar = oldValue.charAt(i) ;

		if(newValue.length<maxLen){
			if(i==4){
				if(oneChar>1){
					newValue = newValue + format + "0" + oneChar ;
				}
				else{
					newValue = newValue + format + oneChar ;
				}
			}
			else if(i==6){
				if(oneChar>3){
					newValue = newValue + format + "0" + oneChar ;
				}
				else{
					newValue = newValue + format + oneChar ;
				}
			}
			else {
				newValue += oneChar ;
			}
		}
	}

	chkValue = oldValue.substring(0,8) ;
	if(!chkDateValue(chkValue)){
		newValue = newValue.substring(0, newValue.length-1) ;
	}

	return newValue ;
}

function chkCharValue(value, pchar, upper, maxLen){
	var newValue = "" ;
	var oneChar  = null ;

	for(i=0;i<value.length; i++){
		oneChar = value.charAt(i) ;
		if(pchar.indexOf(oneChar)!=-1 && (maxLen==null || newValue.length<maxLen)){
			newValue += oneChar ;
		}
	}

	newValue = upper ? newValue.toUpperCase() : newValue ;

	return newValue ;
}


function chkDateValue(value){
	var yyyy = value.substring(0,4) ;
	var mm   = value.substring(4,6) ;
	var dd   = value.substring(6) ;

	var daysInMonth = new Array(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31) ;

	// 월체크
	if(mm>12) {
		return false ;
	}

	// 윤달
	if(mm==2){
		daysInMonth[1] = yyyy%400==0 || ((yyyy%4==0) && (yyyy%100!=0)) ? 29 : 28 ;
	}

	// 일체크
	if(dd!="" && mm!="" && dd>daysInMonth[mm-1]){
		return false ;
	}

	return true ;
}

function toolTip() {

	oObj = document.forms[0].elements;
	for(i=0;i< oObj.length;i++){
		atr1=oObj[i];
        if(atr1.id != '')
		eval('document.all.'+atr1.id+'.title='+atr1.id  );
	}

}


/**
 * max 입력길이만큼 입력시 다음 항목으로
 *
 * @param size max 입력길이
 */
function go_next(size){


	var  el = event.srcElement;
	var i=0
   while (el != el.form.elements[i] )  i++


	next_pos = i + 1;
	value = el.form.elements[i].value;

	len = value.length;
	is_num = Number(value);

//체크 사항 필요시 추가
//	if(!is_num) {
//		if((len > 0) && (value != '0') && (value != '00') && (value != '000')) {
//			alert('숫자를 넣어주세요');
//			el.form.elements[i].select();
//			el.form.elements[i].focus();
//			return false;
//		}
//	}

	if(len == size){
		el.form.elements[next_pos].focus();
		return true;
	}
}


/**
* ToolTip
*/

function balloonHint(Id)
{
    balloonHint.layerId = Id;

    document.addEventListener('mouseover', balloonHint.Show, false);
    document.addEventListener('mouseout', balloonHint.Hide, false);
}
balloonHint.layerId = null;
balloonHint.Show = function (evt) {
    if (typeof evt == "undefined" || typeof evt.target == "undefined") {
        (evt=event).target = event.srcElement;
    }
	var hint = eval(event.srcElement.id);
    //var hint = evt.target.getAttribute("hint");
    if (hint == null || hint.length == 0 || hint == "undefined") return;
    if (balloonHint.layer == null) balloonHint.makeLayer();

    with (balloonHint.layer) {
        innerHTML = sourceHTML.replace("{{hint}}", hint);
        show(evt.clientX, evt.clientY);
    }
}

balloonHint.Hide = function (evt) {
    if (typeof evt == "undefined" || typeof evt.target == "undefined") {
        (evt=event).target = event.srcElement;
    }

    var hint = evt.target.getAttribute("hint");
    if (hint == null || hint.length == 0) return;

    balloonHint.layer.hide();
}

balloonHint.makeLayer = function()
{
    if (typeof document.body == "undefined") {
        document.body = document.getElementsByTagName("BODY")[0];
    }

    balloonHint.layer = document.getElementById(balloonHint.layerId);
    balloonHint.layer.sourceHTML = balloonHint.layer.innerHTML;
    balloonHint.layer.style.position = "absolute";

    if (typeof window.createPopup == "undefined") {
        balloonHint.layer.show = function(x, y) {
            balloonHint.layer.style.display = "block";
            balloonHint.layer.style.left = (x+document.body.scrollLeft+1) + "px";
            balloonHint.layer.style.top = (y+document.body.scrollTop+1) + "px";
        }
        balloonHint.layer.hide = function() {
            balloonHint.layer.style.display = "none";
        }
    } else {
        balloonHint.layer.popup = window.createPopup();
        balloonHint.layer.show = function(x, y) {
            with (balloonHint.layer) {
                style.display = "block";
                var w = offsetWidth, h = offsetHeight;
                style.display = "none";
                popup.document.body.innerHTML = innerHTML;
                popup.show(x, y, w+55, h+55, document.body);
            }
        }
        balloonHint.layer.hide = function() {
            balloonHint.layer.popup.hide();
        }
    }
}

if (typeof document.addEventListener == "undefined") {
    if (typeof document.attachEvent != "undefined") {
        document.addEventListener = function (eventType, listener) {
            document.attachEvent("on"+eventType, listener);
        }
        document.removeEventListener = function (eventType, listener) {
            document.detachEvent("on"+eventType, listener);
        }
    }
}


/**
 * IBSheetInfo.js에 있는 메소드를 PRD 에 맞게 수정
 * Form오브젝트 안에 있는 컨트롤을 QueryString으로 구성한다. 이때, 한글은 인코딩하지 않는다. <br>
 * <br><b>Example :</b>
 * <pre>
 *     var sCondParam=PrdFQString(document.frmSearch); //결과:"txtname=이경희&rdoYn=1&sltMoney=원화";
 * </pre>
 * @param {form} form Form 오브젝트
 * @return string
 * @version 1.0.0.0
 * @see 
 */
function PrdFQString(form) {

    if (typeof form != "object" || form.tagName != "FORM") {
        alert("Error : Please contact the administrator\n" + "Detail : Parameter of PrdFQString Function is not a FORM Tag.");
        return "";
    }

    var name = new Array(form.elements.length);
    var value = new Array(form.elements.length);
    var j = 0;
    var plain_text="";

    //사용가능한 컨트롤을 배열로 생성한다.
    len = form.elements.length;
    for (i = 0; i < len; i++) {
      //클래스 아이디로 제품을 구분함-아래는 HTMl제품
      if(form.elements[i].classid==undefined){
    	  //전송전에 폼의 마스크를 제거한다.
//    	  ComClearSeparator(form.elements[i]);
      switch (form.elements[i].type) {
        case "button":
        case "reset":
        case "submit":
          break;
        case "radio":
        case "checkbox":
                    if (form.elements[i].checked == true) {
                        name[j] = form.elements[i].name;
                        value[j] = form.elements[i].value;
                        j++;
                    }
                    break;
            case "select-one":
                    name[j] = form.elements[i].name;
                    var ind = form.elements[i].selectedIndex;
                    if(ind >= 0) {
                        if (form.elements[i].options[ind].value != '')
                            value[j] = form.elements[i].options[ind].value;
                        else
                            value[j] = '';
                    } else {
                        value[j] = "";
                    }
                    j++;
                    break;
            case "select-multiple":
                    name[j] = form.elements[i].name;
                    var llen = form.elements[i].length;
                    var increased = 0;
                    for( k = 0; k < llen; k++) {
                        if (form.elements[i].options[k].selected) {
                            name[j] = form.elements[i].name;
                            if (form.elements[i].options[k].value != '')
                                value[j] = form.elements[i].options[k].value;
                            else
                                value[j] = '';
                            j++;
                            increased++;
                        }
                    }
                    if(increased > 0) {
                        j--;
                    } else {
                        value[j] = "";
                    }
                    j++;
                    break;
                default :
                	if(form.elements[i].value.length >0 ) {
	                    name[j] = form.elements[i].name;
	                    value[j] = form.elements[i].value;
	                    j++;
                	}
        }
	  	//전송후에 폼의 마스크를 다시 셋팅한다.
//      ComAddSeparator(form.elements[i]);
    //IB에서 제공하는 컨트롤의 값을 조합한다.
    }else{
      switch(form.elements[i].classid){
        case "CLSID:BFED6FBB-30E3-4402-B5D6-C31F40B56A0E":  // IBMaskEdit 경우
          name[j] = form.elements[i].name==""?form.elements[i].id:form.elements[i].name;
                value[j] = form.elements[i].Value;
                j++;
          break;
        case CLSID_IBMCOMBO: // IBMultiCombo 경우
          name[j] = form.elements[i].name==""?form.elements[i].id:form.elements[i].name;
          		if(form.elements[i].UseCode)
          			value[j] = form.elements[i].Code;
          		else
          			value[j] = form.elements[i].Text;
                j++;
                break;
      }
    }
    }

    // QueryString을 조합한다.
    //   1) Explorer 5.5 이상일 경우, encodeURIComponent() 를 이용하여 URL Encode
    //   2) 기타 경우는 IB Sheet 를 이용하여 URL Encode
    var webBrowserName = navigator.appName;
    var webBrowserVer  = navigator.appVersion.substring(navigator.appVersion.indexOf("MSIE") + 5,
                                                        navigator.appVersion.indexOf("MSIE") + 8)

    if(webBrowserName == "Microsoft Internet Explorer" && webBrowserVer >= 5.5) {
        for (i = 0; i < j; i++) {
            // if (name[i] != '') plain_text += name[i]+ "=" + value[i] + "&";
            if (name[i] != '') plain_text += name[i]+ "=" + encodeURIComponent(value[i]) + "&";
        }
    } else {
        var tmpUrlEncodeSheet    = document.getElementById("formquerystring");

        if( tmpUrlEncodeSheet == undefined || tmpUrlEncodeSheet == null || tmpUrlEncodeSheet == '')
        {
            //인코딩을 위해 숨겨진IBSheet를 만든다.
            var sTag = ComGetSheetObjectTag("formquerystring");
            form.insertAdjacentHTML('afterEnd', sTag);
        }

        for (i = 0; i < j; i++) {
            // if (name[i] != '') plain_text += name[i]+ "=" + value[i] + "&";
            if (name[i] != '') plain_text += name[i]+ "=" + formquerystring.UrlEncoding(value[i]) + "&";
        }
    }


  //마지막에 &를 없애기 위함
  if (plain_text != "")
    plain_text = plain_text.substr(0, plain_text.length -1);
    return plain_text;
}

