/*=========================================================
*Copyright(c) 2014 CyberLogitec. All Rights Reserved.
*@FileName   : CoPri.js
*@FileTitle  : PRI 공통 자바스크립트
*@author     : CLT
*@version    : 1.0
*@since      : 2014/04/08
=========================================================*/
    // PRI공통
    msgs['PRI00001'] = 'Do you want to save?';
    msgs['PRI00002'] = 'Do you want to delete?';
    msgs['PRI00003'] = 'Do you want to confirm?';
    msgs['PRI00004'] = 'Do you want to cancel confirmation?';
    msgs['PRI00005'] = 'Deleting will delete sub-data as well. Do you want to continue?';
    msgs['PRI00006'] = 'Data was changed. Do you want to save?';
    msgs['PRI00007'] = 'It can not be saved without input of detailed information.';
    msgs['PRI00008'] = 'Do you want to accept?';
    msgs['PRI00009'] = 'Do you want to cancel acceptance?';
    msgs['PRI00010'] = 'Data was changed. Do you want to proceed without saving the changes?';
    msgs['PRI00011'] = 'Selected row does not exist.';
    msgs['PRI00012'] = 'Do you want to copy?';
    msgs['PRI00013'] = 'Data does not exist.';
    msgs['PRI00014'] = 'Do you want to Apply?';
    msgs['PRI00015'] = 'Do you want to Cancel?';
    msgs['PRI00016'] = 'Do you want to paste?';
    msgs['PRI00017'] = 'Detail data does not exist .\nDo you want to delete?';
    msgs['PRI00018'] = 'There is no data to search.';
    msgs['PRI00019'] = 'Please check [{?msg1}] row and [{?msg2}] row.';
    msgs['PRI00020'] = 'All contents have been deleted.\nDo you also want to delete Title?';
    msgs['PRI00021'] = 'All detail codes have been deleted.\nDo you also want to delete Group code?';

    msgs['PRI00101'] = 'Data saved successfully.';
    msgs['PRI00102'] = 'Data deleted successfully.';
    msgs['PRI00103'] = 'Data confirmed successfully.';
    msgs['PRI00104'] = 'Confirmation has been canceled successfully.';
    msgs['PRI00105'] = 'Data has been confirmed already.';
    msgs['PRI00106'] = 'Confirmation has been canceled already.';
    msgs['PRI00108'] = 'Data accepted successfully.';
    msgs['PRI00109'] = 'Canceled accept request successfully.';
    msgs['PRI00110'] = 'Data copied successfully.';
    msgs['PRI00114'] = 'Apply has been completed.';
    msgs['PRI00115'] = 'Cancel has been completed.';
    msgs['PRI00116'] = 'Paste completed.';
    msgs['PRI00117'] = 'For code inquiry, Please input minimum {?msg1} alpha.';
    msgs['PRI00118'] = 'Are you sure to send a mail?';

    msgs['PRI00201'] = 'Problem occurred while saving data.';
    msgs['PRI00202'] = 'Problem occurred while deleting data.';
    msgs['PRI00203'] = 'Failed to confirm.';
    msgs['PRI00204'] = 'Failed to cancel confirmation.';

    msgs['PRI00301'] = 'There is no data to save.';
    msgs['PRI00302'] = 'Duplicate data found, please recheck.';
    msgs['PRI00303'] = 'Duplicate data found in seq. no. {?msg2} in [{?msg1}].';
    msgs['PRI00304'] = 'Data already exist for period entered.';
    msgs['PRI00305'] = '{?msg1} start date can not be greater than end date.';
    msgs['PRI00306'] = 'Effective date can not be greater than expiry date.';
    msgs['PRI00307'] = '{?msg1} exceeds the field length.';
    msgs['PRI00308'] = 'Please {?msg1} {?msg2}.';
    msgs['PRI00309'] = 'Changed {?msg1} sheet data must be saved first.';
    msgs['PRI00310'] = 'Please select 1 row only.';
    msgs['PRI00311'] = 'Only numeric value is allowed.';
    msgs['PRI00312'] = 'Please upload excel file.';
    msgs['PRI00313'] = 'This sequence can not be selected.';
    msgs['PRI00314'] = '{?msg1} alphabets only allowed for input.';
    msgs['PRI00315'] = 'This is an unvalid code, please check again.';
    msgs['PRI00316'] = 'Mandatory items [{?msg1}] are required.';
    msgs['PRI00317'] = 'Only 4 alpha is allowed for Group code input.';
    msgs['PRI00318'] = 'Only 5 alpha is allowed for Location code input';
    msgs['PRI00319'] = 'Please input the details under {?msg1}.';
    msgs['PRI00320'] = '{?msg1} alphabets or digits only allowed for input.';
    msgs['PRI00321'] = '[{?msg1}] should be greater than {?msg2}.';
    msgs['PRI00322'] = 'Please enter valid date format for {?msg1} : YYYY-MM-DD.';
    msgs['PRI00323'] = 'Please enter the year within duration.';
    msgs['PRI00324'] = 'Please input duration including the year.';
    msgs['PRI00325'] = 'Please choose between [{?msg1}] and [{?msg2}] for input.';
    msgs['PRI00326'] = 'You can not select [<] or [>].';
    msgs['PRI00327'] = 'Please select more than 1 sequence to copy.';
    msgs['PRI00328'] = 'There is no data to paste.';
    msgs['PRI00329'] = 'All data have been accepted already.';
    msgs['PRI00330'] = 'None of data is accepted.';
    msgs['PRI00331'] = '[{?msg1}] Subject data does not exist.';
    msgs['PRI00332'] = 'Duplicate {?msg1} exists.';
    msgs['PRI00333'] = '{?msg1} can not be selected.';
    msgs['PRI00334'] = 'Please input at [{?msg1}] [{?msg2}].';
    msgs['PRI00335'] = '[{?msg1}] has not been inputted.';
    msgs['PRI00336'] = '[{?msg1}] should be smaller than {?msg2}.';
    msgs['PRI00337'] = '[{?msg1}] has not been selected.';
    msgs['PRI00338'] = 'Failed to download. Please try again.';
    msgs['PRI00339'] = 'Data was downloaded successfully.';
    msgs['PRI00342'] = 'Duplicate data exist in [{?msg1}], Please check it again.';
    msgs['PRI00343'] = 'Duplicate data exist in [{?msg1}], are you sure to proceed this proposal?';
    msgs['PRI00344'] = 'Duplicate data exist in [{?msg1}], are you sure to approve this proposal?';
    msgs['PRI00345'] = 'Expiration date must be later than effective date.';
    msgs['PRI00346'] = 'Effective date must be earlier than Expiration date.';
    msgs['PRI00347'] = '[New Publication Date] must be earlier than Expiration date.';
    msgs['PRI00348'] = 'You may not update [Exclude] condition without any GRI application. Please update GRI [Include] condition first.';
    msgs['PRI00349'] = 'If there is no commodity group saved, it will be deleted. Do you want to input commodity group?';
    msgs['PRI00350'] = 'If there is no route detail saved, it will be deleted. Do you want to input route detail?';
    msgs['PRI00351'] = 'There is no data to apply';
    msgs['PRI00352'] = 'There is no data to be canceled';
    msgs['PRI00353'] = 'Effective date must be earlier than [{?msg1}]';
    msgs['PRI00354'] = 'Effective date must be later than [{?msg1}]';
    msgs['PRI00355'] = 'Effective date must be later than [{?msg1}]';
    msgs['PRI00356'] = 'Publication Date must be later than [{?msg1}]';

    // SCGuideline
    msgs['PRI08001'] = 'Please select [Service Scope] and [Duration] first.';
    msgs['PRI08002'] = 'Please select Service Scope first.';
    msgs['PRI08003'] = '[Awkward] can be selected only when [Per] is A,F,O,Q,S,P type.';
    msgs['PRI08004'] = 'Guideline Copy is available when there is no Commodity Group.';
    msgs['PRI08005'] = 'There is no data to be confirmed under tabs.';
    msgs['PRI08006'] = 'Do you want to copy selected guideline?';
    msgs['PRI08007'] = 'This boiler plate is used in the S/C.';
    // SCGuideline - MQC Popup
    msgs['PRI08008'] = '[MAX] should be bigger than [MIN]';
    msgs['PRI08009'] = '[Max] should be [MIN] value minus 1 in next row.';
    // 그리드 필수입력 체크를 수동으로 할 경우 메세지
    msgs['PRI08010'] = '{?msg1} Record [{?msg2}]is mandatory item.';
    msgs['PRI08011'] = 'You can not amend cargo type, please check per type first.';
    msgs['PRI08012'] = 'You can not save. Please check cargo type first.';
    msgs['PRI08013'] = 'There are same location codes btwn Point and B.Port.';
    msgs['PRI08014'] = 'Please check VIA information.';
    msgs['PRI08015'] = 'Please save first to use.';
    msgs['PRI08016'] = 'You can not exceed the main duration.';
    msgs['PRI08017'] = 'This is used data in Rate Tab, Please delete it in Rate Tab first.';
    msgs['PRI08018'] = 'Your inserted duration is over-lapped with existing guideline,\nplease re-check your duration date.';
    msgs['PRI08019'] = 'It is using data, please delete it first. \n {?msg1}';
    msgs['PRI08020'] = 'There exist Commodity Group with no route detail in Rate tab.';

    // Contract
    msgs['PRI01001'] = 'Mandatory items are needed.';
    msgs['PRI01002'] = 'Please check valid row.';
    msgs['PRI01003'] = 'The duration of this {?msg3} is {?msg1} ~ {?msg2}.\nIndividual SVC Scope’s duration cannot exceed the main duraion';
    msgs['PRI01004'] = 'Please create master data first.';
    msgs['PRI01005'] = '[Guideline copy] can be performed only when there is no data to be inputted.';
    msgs['PRI01006'] = 'Data is not currently registered. \nDo you want to copy guideline?';
    msgs['PRI01007'] = 'Please select Service Scope first.';
    msgs['PRI01008'] = 'MQC sum of SVC Scope(s) should be less than main MQC.';
    msgs['PRI01009'] = 'Do you want to copy guideline?';
    msgs['PRI01010'] = 'Do you want to cancel accept all data?';
    msgs['PRI01011'] = 'Row has been amended already.';
    msgs['PRI01012'] = 'Row was not amended.';
    msgs['PRI01013'] = 'Customer name and address should be inputted in {?msg1}row.';
    msgs['PRI01014'] = 'Customer code should be inputted in {?msg1}row.';
    msgs['PRI01015'] = 'Do you want to accept all data?';
    msgs['PRI01016'] = 'There is no guideline available.\nPlease inquire guideline first.'; //There is no guideline available.
    msgs['PRI01017'] = 'Guideline copied successfully.'; //The Guideline has been copied successfully.
    msgs['PRI01018'] = 'Amend date should be between {?msg1} \nand {?msg2} on main screen.';
    msgs['PRI01019'] = 'You can not copy because there is no boiler plate guideline for contract year.';
    msgs['PRI01020'] = 'You can not input base port same as point.';
    msgs['PRI01021'] = 'Proposal number does not exist';
    msgs['PRI01022'] = 'You can not modity/delete data in use. {?msg1}';
    msgs['PRI01023'] = 'Please select location type.';
    msgs['PRI01024'] = 'Please check duration.';
    msgs['PRI01025'] = 'Do you also want to change the main duration?';
    msgs['PRI01026'] = 'Save is canceled.';
    msgs['PRI01027'] = 'Location group code does not exist on Location Group code in guideline to be copied. \nPlease register location group code first.';
    msgs['PRI01028'] = 'Commodity group code does not exist on Commodity group code in guideline to be copied. \nPlease register commodity group code first.';
    msgs['PRI01029'] = 'Please input service scope.';
    msgs['PRI01030'] = 'Please input main duration.';
    msgs['PRI01031'] = 'There is service scope which is not accepted.';
    msgs['PRI01032'] = 'Do you want to proceed {?msg1}?';
    msgs['PRI01033'] = 'You have no authority. [{?msg1}]';
    msgs['PRI01034'] = 'Please check status.';
    msgs['PRI01035'] = 'Do you want to accept all data?';
    msgs['PRI01036'] = 'Service scope only added under the current amendment sequence can be deleted.';
    msgs['PRI01037'] = 'Row has been accepted already.';
    msgs['PRI01038'] = 'Row was not accepted.';
    msgs['PRI01039'] = 'There is initial data.';
    msgs['PRI01040'] = 'You can not copy because there is no arbitrary guideline for contract year.';
    msgs['PRI01041'] = 'You can not copy because there is no GOH guideline for contract year.';
    msgs['PRI01042'] = 'Please input {?msg1}.';
    msgs['PRI01043'] = 'Selected item does not exist.';
    msgs['PRI01044'] = 'C.Offered rate is the same as proposal rate.';
    msgs['PRI01045'] = '{?msg1} is completed.';
    msgs['PRI01046'] = 'Do you want to cancel and return to previous status?';
    msgs['PRI01047'] = 'The status is changed';
    msgs['PRI01048'] = '{?msg1} should start from {?msg2}';
    msgs['PRI01049'] = '[{?msg1}] should be continous numbers.';
    msgs['PRI01050'] = 'Do you want to delete all data in current Amend Sequence?';
    msgs['PRI01051'] = 'Please delete data in Terms first.';
    msgs['PRI01052'] = 'You should input more than 1 data in [{?msg1}].';
    msgs['PRI01053'] = 'Please check filing Date.';
    msgs['PRI01054'] = 'Filing Date is 10 days greater than the Amendment Effective Date. \nDo you want to proceed?';
    msgs['PRI01055'] = 'There is no Proposal number or Amendment Number.';
    msgs['PRI01056'] = 'Do you want to create S/C number?';
    msgs['PRI01057'] = 'Updated data exists, Please save it first.';
    msgs['PRI01058'] = 'Added data exist, Please proceed button click.';
    msgs['PRI01059'] = 'Amendment effective date is later than Filing date, \nDo you want to update Effective date as Filing date?';
    msgs['PRI01060'] = 'There is no data to copy';
    msgs['PRI01061'] = 'Please check S/C number.';
    msgs['PRI01062'] = 'S/C No is duplicated. Please input S/C No again.';
    msgs['PRI01063'] = 'There is no Standard Note to copy in guideline. \nPlease register Standard Note in advance.';
    msgs['PRI01064'] = 'Master data does not exist.';
    msgs['PRI01065'] = 'You can input [{?msg1}] after inputting {?msg2}';
    msgs['PRI01066'] = 'GRI Calculation cannot be applied.';
    msgs['PRI01067'] = 'GRI application cannot be canceled.';
    msgs['PRI01068'] = 'Detailed data dose not exist. GRI calculation cannot be applied/canceled.';
    msgs['PRI01069'] = 'Please select application item.';
    msgs['PRI01070'] = 'Please input amount.';
    msgs['PRI01071'] = 'Please input percentage(%).';
    msgs['PRI01072'] = 'Applied successfully.';
    msgs['PRI01073'] = 'Canceled successfully.';
    msgs['PRI01074'] = 'Please select among {?msg1}.';
    msgs['PRI01075'] = 'Please check [{?msg1}] Duration.';
    msgs['PRI01076'] = 'There is no OTI information.';
    msgs['PRI01077'] = 'The duration of each SVC scope has not been changed.';
    msgs['PRI01078'] = 'Same [Point] and [Base Port] cannot be inputted.';
    msgs['PRI01079'] = 'Please delete Real Customer first.';
    msgs['PRI01080'] = 'Please select Excel file format. [Yes : Vertical, No : Horizontal]';
    msgs['PRI01081'] = 'Filing Date is ahead of current date.';
    msgs['PRI01082'] = 'Do you want to create proposal?';
    msgs['PRI01083'] = 'Main Duration do not cover Scope Duration.';
    msgs['PRI01084'] = 'This is unvalid S/C No format.(Alphabet 3 digit + Number 6 digit)';
    msgs['PRI01085'] = 'This is an unvalid S/C Prefix. Please check again.';
    msgs['PRI01086'] = 'Do you want to Change Duration?';
    msgs['PRI01087'] = 'New Duration can not be longer than 1 year.';
    msgs['PRI01088'] = 'Amend EFF must be between {?msg1}.';
    msgs['PRI01089'] = 'New Duration Date can not earlier than Possible Effective Date.';
    msgs['PRI01090'] = 'Please create DEM/DET Conversion.';
    msgs['PRI01091'] = 'Free Time term is Exception. Please create Before BKG DAR.';
    msgs['PRI01092'] = 'RFA Duration is amended. Please amend related DAR Duration as well.';
    msgs['PRI01094'] = 'The duration of {?msg1} scope is {?msg2} ~ {?msg3}. \nPlease input filing date no later than {?msg3}.';
    msgs['PRI01095'] = 'Please register Locaton Group first. Location Group is used in G/L to be copied.';
    msgs['PRI01096'] = 'Please check duration of each service scope.';
    msgs['PRI01097'] = 'There is no arbitrary to apply GRI.';
    msgs['PRI01098'] = 'Please select Org/Dst column.';
    msgs['PRI01099'] = '[{?msg1}] cannot be used at [{?msg2}] side in this SVC scope.';
    msgs['PRI01100'] = 'Please input more than 1 item among S/C No, Proposal No, Effective date.';
    msgs['PRI01101'] = 'Please input more than 1 item among RFA No, Proposal No, Access Date, SVC scope, Customer.';
    msgs['PRI01102'] = 'Please check your entered date.';
    msgs['PRI01103'] = 'You are not authorized for retroactive approval.\nThis can be approved by the relevant pricing staff only in each regional HQ.(ASG,WSG,NSG,USG)';
    msgs['PRI01104'] = 'Expiration date must be later than effective date.';
    msgs['PRI01105'] = 'There is no amended data.';
    msgs['PRI01106'] = 'Please approve DAR for DEM/DET exception clause firstly.';
    msgs['PRI01107'] = 'It can not be canceled since this RFA no [{?msg1}] is used in BKG data.';
    msgs['PRI01108'] = 'Please delete DAR first.';
    msgs['PRI01109'] = 'Do you also want to change the scope duration?';
    msgs['PRI01110'] = 'This is not registered surcharge code in [{?msg1}] scope. Please check again.';
    msgs['PRI01111'] = 'Please copy again for Commodity Group, Rate and Standard Note if copied from guideline.';
    msgs['PRI01112'] = 'Do you also want to accept duration of the scope?';
    msgs['PRI01113'] = 'This is used data in S/C Prefix & Scope Mapping Creation. Please delete it first.';
    msgs['PRI01114'] = 'There is no valid DAR. Please change the free time term or update DAR again.';
    msgs['PRI01115'] = 'There is valid DAR, Pleaes change the free time term again.';
    msgs['PRI01116'] = 'This Proposal no is used in DAR, you can not cancel  this Proposal.';
    msgs['PRI01117'] = 'This is wrong type of excel format. please select it again.';
    msgs['PRI01118'] = 'Have you updated all conversion data form this amendment?';
    msgs['PRI01119'] = 'Filing date should be later than previous amendment effective date.';
    msgs['PRI01120'] = 'Please create DEM/DET conversion.';
    msgs['PRI01121'] = 'There is DAR under this proposal.Please check DEM/DET conversion.';
    msgs['PRI01122'] = 'Please approve DAR first.';
    msgs['PRI01123'] = 'Do you want to cancel this proposal ? please delete DAR first.';
    msgs['PRI01124'] = 'Do you want to delete this proposal?';
    msgs['PRI01125'] = 'Please input rate(s) of this route.';
    msgs['PRI01126'] = 'This code has been used in [{?msg1}] tab,\nplease delete it in [{?msg1}] tab first.';
    msgs['PRI01127'] = 'Please register the group code in [{?msg1}] first.';
    msgs['PRI01128'] = 'Please check contract parties information by clicking [Customer] button in main page.\nYou need to change [please input] data.';
    msgs['PRI01129'] = 'Approver has already started accepting your proposal.\nYou may not cancel the request.';
    msgs['PRI01130'] = 'You can not amend this transited RFA.\nPlease create new RFA with copying this.';
    msgs['PRI01131'] = 'It can not be canceled since this RFA is used in BKG data. ({?msg1})';
    msgs['PRI01132'] = 'There is already accepted data under this item. You may not delete it. \n {?msg1}';
    msgs['PRI01133'] = 'Do you also want to change the main MQC?';
    msgs['PRI01134'] = 'Do you also want to change the scope MQC?';
    msgs['PRI01135'] = 'Please search this [{?msg1}] again as other user changed the data.';    
    msgs['PRI01136'] = 'In general rate, actual customer cannot be exist. Pls recheck it.';
    msgs['PRI01137'] = 'Location indicated is not included within SVC Scope.';
    msgs['PRI01138'] = 'This RFA No. already existed. Please input another RFA No.';
    msgs['PRI01139'] = '{?msg1} indicated is not included within SVC Scope.';
    msgs['PRI01140'] = 'Conversion updated, please click "OK" button.';
    msgs['PRI01141'] = 'Please use S/C No. Assign Button to make contract number.';
    msgs['PRI01142'] = 'Selected Commodity has valid Route and Rate information. Please delete the Route and Rate first.';
    msgs['PRI01143'] = 'To utilize Commodity Group drop down to furthur limit search, select S/C No., SVC Scope and Rate Type.';
    
    // Surcharge
    msgs['PRI02001'] = 'Unchecking will delete sub-data as well. Do you want to continue?';
    msgs['PRI02002'] = 'When you select [Percentage], [Currency Code] will be deleted, \nDo you want to proceed?';
    msgs['PRI02003'] = 'There is [0] value in amount column, Do you want proceed?';
    msgs['PRI02004'] = 'Please select Service Scope and Charge.';
    msgs['PRI02005'] = 'Pleae select Percentage Type.';
    msgs['PRI02006'] = '[{?msg1}]should not be less than 2 characters.';
    msgs['PRI02007'] = 'Please select [Service Scope] and [Charge].';
    msgs['PRI02008'] = 'You can proceed it after inquiry.';
    msgs['PRI02009'] = 'Please input Effective Date.';
    msgs['PRI02010'] = 'Please select at least one coloum among [Service Scope], [Location] and [Charge code]';
    msgs['PRI02011'] = '[Cargo Type] Awkward can be selected, only if [Per] is A,F,O,Q,S,P,20,40,HC,BX Type.';
    msgs['PRI02012'] = 'Update Date is greater than Access Date.';
    msgs['PRI02013'] = 'You should input 9 digits for S/C and RFA no.';
    msgs['PRI02014'] = 'This S/C no does not exist.';
    msgs['PRI02015'] = 'This RFA no does not exist.';
    msgs['PRI02016'] = 'Row {?msg1} and row {?msg2} are duplicated in this sheet.';
    msgs['PRI02017'] = '{?msg1} row is duplicated with pre-existing data in this sheet.';
    msgs['PRI02018'] = '[{?msg1}] will be unregistered from [{?msg2}].\nDo you want to continue?';
    msgs['PRI02019'] = 'Below rows are duplicated with pre-existing data.\nPlease check and upload again.\n\n[Point] - [Base Port] (Per)\n{?msg1}';
    msgs['PRI02020'] = 'Search option was changed, please click "Retrieve" button again.';
    msgs['PRI02021'] = 'Results file size is too big. Please retrieve again with more specific condition.';
    msgs['PRI02022'] = '{?msg1} row doesn\'t have note content. Do you want to proceed without note?';
    msgs['PRI02023'] = 'Please input another note sequence on {?msg1} row. The note sequence is already assigned to different note content.';
    msgs['PRI02024'] = 'There are some unmatched note sequences. Do you want to synchronize the note sequences based on note contents?';
    
    // PRS & CMTX
    msgs['PRI03001'] = 'Sub-data was changed. Do you want to save with it?';
    msgs['PRI03002'] = 'Please select download mode. [Yes:Quick Mode, No:Standard Mode]';
    msgs['PRI03003'] = 'There is {?msg1} inputted. Do you want to create a new Quotation?';
    msgs['PRI03004'] = 'Inputted {?msg1} does not exist.';
    msgs['PRI03005'] = 'Only 4 alpha is allowed for Group code input.';
    msgs['PRI03006'] = 'Do you want to copy guideline?';
    msgs['PRI03007'] = 'Do you want to {?msg1}?';

    msgs['PRI03009'] = 'Please save {?msg1} first.';
    msgs['PRI03010'] = 'CMPB Guide1line has been already created earlier than 1 year.\nPlease make sure it from CMPB Guideline Inquiry.';
    msgs['PRI03011'] = '[{?msg1}] date should be included in [{?msg2}] period.';
    msgs['PRI03012'] = '[Actual PFMC for estimate] date should be included in Summary period but shouldn\'t be greater than this week.';
    msgs['PRI03013'] = 'Simulation date should be between {?msg1}(Year-Week) and {?msg2}(Year-Week).';
    msgs['PRI03014'] = 'Please input region code only for US.';
    msgs['PRI03015'] = 'Simulation period can not exceed duration period.({?msg1})';
    msgs['PRI03017'] = 'Please save first and click "OK" for calculation.';
    msgs['PRI03018'] = '[{?msg1}] doesn\'t exist. Please check duration(Year-Week).';
    msgs['PRI03020'] = 'Please click [Calculate] under [Rate] tab in advance to check estimated CMPB(OPB)/CM(OP).\nThen, [{?msg1}] will be active.';
    msgs['PRI03021'] = '[Route Detail] doesn\'t exist. Please check.';
    msgs['PRI03022'] = 'Please click [Calculate] in advance to check estimated CMPB(OPB)/CM(OP).\nThen, [{?msg1}] will be active.';
    msgs['PRI03023'] = 'In case you input the same data in [{?msg1}] except other columns for each simulation data ,system  recognizes it as duplicated. \n\nBefore system  is upgraded, please input simulation data not to be duplicated';
    msgs['PRI03024'] = 'This is an invalid code. Please input country code except US(United states, Region code only).';
    msgs['PRI03025'] = 'Calculation is completed successfully.';    
    msgs['PRI03026'] = 'Changed data must be saved first for calculation.';    
    msgs['PRI03027'] = '** Subject to calculation ** {?msg1}\n\nPlease click [Calculate] under [Rate] tab in advance to check estimated CMPB(OPB)/CM(OP).\nThen, [{?msg2}] will be active.';    
    msgs['PRI03028'] = 'Please select Service Scope first.';
    msgs['PRI03029'] = 'SVC Scope doesn\'t cover for [Origin] or [Destination] you inputted.\nPlease check input data.';   
    msgs['PRI03030'] = 'You cannot select more than one row with the same sizetype for "CM Detail". ';
    msgs['PRI03031'] = 'You cannot select more than one row for "RV Detail". ';
    msgs['PRI03032'] = 'Problem occurred while saving data. ';
    msgs['PRI03033'] = 'Problem occurred while check data. ';
    msgs['PRI03034'] = 'should not be blank between ; and ; in {?msg1}. ';
    msgs['PRI03035'] = 'should not be inputted to {?msg1} in the same time. ';
    msgs['PRI03036'] = 'should not be inputted to {?msg1} without CMDT Seq. ';
    msgs['PRI03037'] = 'For mixed Term or transmode case, user should not be able to modify {?msg1}. ';
   
    // PRIMasterData
    msgs['PRI04001'] = 'Please input more than {?msg1}digit, when you inquire by code.';
    msgs['PRI04002'] = 'Please input more than {?msg1}digit, when you inquire by code name.';
    msgs['PRI04003'] = 'You can input [{?msg1}] after inputting {?msg2}.';
    msgs['PRI04004'] = 'You should insert [{?msg1}] in {?msg2} with no more than {?msg3}.';
    msgs['PRI04005'] = 'You have to input more than one item between [{?msg1}] and [{?msg2}]';
    msgs['PRI04006'] = 'There is no selected data.';
    msgs['PRI04007'] = 'You should select [{?msg1}].';
    
    // TRI
    msgs['PRI05001'] = '[{?msg1}] is(are) invalid with TAA duration.\nPlease delete [{?msg1}] or amend TAA duration.';
    msgs['PRI05002'] = 'There is no TRI to be confirmed. Please input TRI.';
    msgs['PRI05003'] = 'It can not be canceled since this TAA is used in BKG data. ({?msg1})';
    msgs['PRI05004'] = 'TRI No. Assigned.';
    msgs['PRI05005'] = 'Do you want to cancel and return to previous status?';
    msgs['PRI05006'] = 'Amend effective date should be later than {?msg1}.';
    msgs['PRI05007'] = 'TRI published successfully.';
    msgs['PRI05008'] = 'There is(are) TRI [{?msg1}] in initial status which has(have) been applied this GRI. Please proceed or cancel the current status for [{?msg1}] before applying new GRI Calc.';
    msgs['PRI05009'] = 'Duplicate data exist in?[{?msg1}], you can not assign new TRI No.';
    msgs['PRI05010'] = 'If you want to change scope, please delete registered TRIs first.';
    msgs['PRI05011'] = 'Do you want to create new GRI?';
    msgs['PRI05012'] = 'Duration should not be less than 30 days for Tariff Rate Publishing.';
    msgs['PRI05013'] = 'There is(are) TRI(s) which has(have) validity period less than 30 days';
    msgs['PRI05014'] = 'Tariff Rate should be valid at least 30 days, Please update actual filed expiry date in ‘New Expiration Date‘ column.';
    
    // TARIFF AUTOMATION + MOT Filing
    msgs['PRI06001'] = 'Do you want to Request?';
    msgs['PRI06002'] = 'Do you want to Approve?';
    msgs['PRI06003'] = 'Tariff Code is not available';
    msgs['PRI06004'] = 'Selected Tariff Code No. is currently used, please check detail ';
    msgs['PRI06005'] = 'Do you want to publish the selected {?msg1}?';
    msgs['PRI06006'] = 'Please check effective date (30 day validation)';
    msgs['PRI06007'] = 'Amendment effective date is earlier than publish date, \nDo you want to update effective date as publish date?';
    msgs['PRI06008'] = 'Publish date must be later than [{?msg1}].';
    msgs['PRI06009'] = 'Please input publish date within 9 days of creation date';
    msgs['PRI06010'] = 'Selected service scope [$s] is used other Tariff Code. Please select another service scope.';    
    msgs['PRI06011'] = 'If there is Location Information data , it will be deleted. Do you want to load Excel?';
    msgs['PRI06012'] = 'Please select 2 rows to compare.'
    msgs['PRI06013'] = 'Processing may take several minutes depending upon size of the data.'
    msgs['PRI06014'] = 'Selected Inland Rates Name does not exist. Please select another Inland Rates Name.'    	
    msgs['PRI06015'] = 'There is no data to Save. Please check again.'
    msgs['PRI06016'] = 'There is modified data.Do you want to continue?'	
    msgs['PRI06017'] = '[{?msg1}] Location code doesn\'t exist.\nPlease input another code.'	
    msgs['PRI06018'] = '[{?msg1}] and [{?msg2}] are same.'	
    msgs['PRI06019'] = 'The scope [{?msg1}] doesn\'t include [{?msg2}].\nPlease input right location for that scope.'	
    msgs['PRI06020'] = 'You should check either [{?msg1}] or [{?msg2}]'	
    msgs['PRI06021'] = 'If there is commission data , it will be deleted. Do you want to load Excel?';
    
    //CMTX Msg    
    msgs['PRI07001'] = 'BackEndJob Request Fail!';
    msgs['PRI07002'] = 'Created BackEndJob File exist already!';
    msgs['PRI07003'] = 'Data has been retrieved already. Do you want to create route and calculate again?';
    msgs['PRI07004'] = 'All data has been calulated already.';  

    
    //Group Location 을 구분하는  전역 변수
    PRI_RG          = 0;  // RFA Guideline
    PRI_RP_SCP      = 1;  // RFA Proposal
    PRI_SG          = 2;  // S/C Guideline
    PRI_SP_SCP      = 3;  // S/C Proposal
    PRI_SCG         = 4;  // Surcharge
    PRI_CMPB        = 5;  // CMPB Guideline
    PRI_SQ          = 6;  // SQ Guideline
    PRI_RQ          = 7;  // RQ Guideline

    var LOCATION_TYPE1 = new Array();
    LOCATION_TYPE1[0] = " |L|C";
    LOCATION_TYPE1[1] = " |Location|Country";

    var LOCATION_TYPE2 = new Array();
    LOCATION_TYPE2[0] = " |L|G";
    LOCATION_TYPE2[1] = " |Location|Location Group";

    var LOCATION_TYPE3 = new Array();
    LOCATION_TYPE3[0] = " |L|C|R";
    LOCATION_TYPE3[1] = " |Location|Country|Region";

    var LOCATION_TYPE4 = new Array();
    LOCATION_TYPE4[0] = " |L|G|C";
    LOCATION_TYPE4[1] = " |Location|Location Group|Country";

    var COMODITY_TYPE1 = new Array();
    COMODITY_TYPE1[0] = " |C|G";
    COMODITY_TYPE1[1] = " |Commodity|Commodity Group";

    var COMODITY_TYPE2 = new Array();
    COMODITY_TYPE2[0] = "R|C";
    COMODITY_TYPE2[1] = "Rep. Commodity|Commodity";

    var COMODITY_TYPE3 = new Array();
    COMODITY_TYPE3[0] = " |C|R|G";
    COMODITY_TYPE3[1] = " |Commodity|Rep. Commodity|Commodity Group";

    // Text입력시 영문을 제외하고 허용가능한 character
    var PRI_VALID_CHAR = "01234567890 !@#$%^&*()-=\\_+|[]{},.<>/?;':`~\"\r\n\t";

    // IE6 에서 팝업을 호출할 경우 height 값을 더하여 팝업호출
    var IE6_ADD_HEIGHT = 25;
    // IE6 에서 팝업을 호출할때 하단 status 를 감안할 경우 값을 더하여 팝업호출
    var IE6_ADD_STATUS_HEIGHT = 20;
    // IE6 에서 팝업을 호출할때 Thema 에 따라 달라지는 사이즈를 감안하여 추가로 값을 더하여 팝업호출
    var IE6_ADD_THEMA_HEIGHT = 5;
    // IE6 에서 팝업을 호출할 경우 width 값을 더하여 팝업호출
    var IE6_ADD_WIDTH = 5;
    /**
     * scrollBar를 초기화 한다 <br>
     * @author 문동규
     * @version 2009.11.09
     **/
//    try {
//        top.showFlashMenu();
//        top.document.body.scrollTop = 0;
//    } catch(err) { }

    /**
     * IBSheet에서 Amend를 고려한 중복체크를 실행한다.
     * 이전 Amend Sequence를 가진 행이나, Amend Delete(AD)된 행은 제외하고 체크한다.
     * 중복된 행이 없으면 -1을, 중복된 행이 있으면 해당 행의 row Index를 반환한다.(0 이상 값)  <br>
     * <br><b>Example :</b>
     * <pre>
     *     var dupRow = ComPriAmendDupCheck(sheetObj, "prc_cmdt_tp_cd|prc_cmdt_def_cd", formObj.amdt_seq.value);
     *     if (dupRow >= 0) {
     *         sheetObj.SelectRow = dupRow;
     *         ComShowCodeMessage("PRI00302");
     *         return false;
     *     }
     * </pre>
     * @param {ibsheet} sheetObj    필수,IBSheet Object
     * @param {string}  sCol        필수, 중복검사시 기준이 되는 컬럼의 SaveName. "|"로 연결
     * @param {string}  amdtSeq     필수, 현재 amend sequence.(document.form.amdt_seq.value)
     * @return int <br>
     *         -1   : 중복된 행이 없을 경우
     *         0이상 : 중복된 Row의 Row Index
     * @author 박성수
     * @version 2009.06.10
     */
    function ComPriAmendDupCheck(sheetObj, sCol, amdtSeq) {
        try {
            if ((!sheetObj) || (!sheetObj.IBSheetVersion))  return;
            if (sCol == undefined || sCol == null || sCol == "")  return;
            if (sheetObj.RowCount()<= 0)  return -1;
            var dupRow = sheetObj.ColValueDupRows(sCol, false, true);
            if (dupRow == null || dupRow == "")  return -1;

            var arrCol=sCol.split("|");
            var arrTemp=dupRow.split("|");
            var arrBaseRow=arrTemp[0].split(",");
            var arrDesRow=arrTemp[1].split(",");
            for (var i=arrDesRow.length - 1; i >= 0; i--) {
            	if (sheetObj.GetCellValue(arrDesRow[i], "amdt_seq") != amdtSeq
            			|| sheetObj.GetCellValue(arrDesRow[i], "src_info_cd") == "AD") {
                    arrDesRow.splice(i, 1);
                }
            }
            for (var i=arrBaseRow.length - 1; i >= 0; i--) {
            	if (sheetObj.GetCellValue(arrBaseRow[i], "amdt_seq") != amdtSeq
            			|| sheetObj.GetCellValue(arrBaseRow[i], "src_info_cd") == "AD") {
                    for (var j=0; j < arrDesRow.length; j++) {
                        var isSame=true;
                        for (var k=0; k < arrCol.length; k++) {
                        	if (sheetObj.GetCellValue(arrBaseRow[i], arrCol[k]) != sheetObj.GetCellValue(arrDesRow[j], arrCol[k])) {
                                isSame=false;
                                break;
                            }
                        }
                        if (isSame) {
                            arrDesRow.splice(j, 1);
                            break;
                        }
                    }
                    arrBaseRow.splice(i, 1);
                }
            }
            if (arrDesRow.length > 0) {
                return arrDesRow[0];
            } else {
                return -1;
            }
        } catch(err) { ComFuncErrMsg(err.message); }
    }
    /**
     * IBSheet에서 주어진 조건에 맞는 행 또는 모든 데이터행을 조회XML로 구성하여 반환한다. <br>
     * saveColName 파라미터를 이용하여 원하는 컬럼을 지정할수 있고, <br>
     * sCol, sValue 파라미터를 이용하여 원하는 행의 조건을 줄수 있다.(필터링) <br>
     * saveColName의 값이 없으면 전체 컬럼을 대상으로 진행되고, <br>
     * sCol, sValue 값이 없으면 전체 행을 대상으로 진행된다. <br>
     * Sheet의 전체 데이터에 대해 스캔이 이루어지므로, 데이터양이 너무 많을 경우 속도가 저하될수 있음에 유의한다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     sXml = ComPriSheet2Xml(sheetObj);
     *     sXml = ComPriSheet2Xml(sheetObj, "col1|col2|col3|col4");
     *     sXml = ComPriSheet2Xml(sheetObj, null, "svc_scp_cd|gline_seq", "ACE|1", true);
     * </pre>
     * @param {ibsheet} sheetObj    필수,IBSheet Object
     * @param {string}  saveColName 선택,특정 컬럼만 배열로 만들경우 SaveName을 "|"로 연결한 문자열 설정
     *                              지정하지 않으면, 전체 컬럼을 대상으로 한다.
     * @param {string}  sCol        선택, 행조회시 기준이 되는 컬럼의 SaveName. "|"로 연결
     *                              지정하지 않으면, 전체 행을 대상으로 한다.
     * @param {string}  sValue      선택, 행조회시 기준이 되는 컬럼의 값(Value). "|"로 연결
     *                              지정하지 않으면, 전체 행을 대상으로 한다.
     * @param {bool}    bRowDel     선택, 원본행삭제여부, default=false.
     * @param {bool}    bIsStyled   선택, 열과 행의 색상 Editable정보 포함 여부, default=false. ComPriSheet2StyledXml 참조
     * @return string,  Sheet의 데이터를 조회XML로 구성한 문자열
     * @author 박성수
     * @version 2009.05.07
     */
    function ComPriSheet2Xml(sheetObj, saveColName, sCol, sValue, bRowDel, bIsStyled)  {
        try {
            if ((!sheetObj) || (!sheetObj.IBSheetVersion))  return "";
            var allXml="";
            var sColSep="☜☞";
            var allRows=false;
            var arrPrcdRow=new Array();
            if (saveColName == undefined || saveColName == null || saveColName == "") {
                saveColName=IBS_ConcatSaveName(sheetObj);
            }
            var arrCol=saveColName.split("|");
            var condNames=new Array();
            var condValues=new Array();
            if (sCol == undefined || sCol == null || sCol == "" || sValue == undefined || sValue == null || sValue == "") {
                allRows=true;
            } else {
                condNames=sCol.split("|");
                condValues=sValue.split("|");
            }
            var aryTR=new Array();
            var aryTD=new Array(arrCol.length);
            if (sheetObj.RowCount()> 0) {
                for (var i=sheetObj.HeaderRows(); i <= sheetObj.LastRow(); i++) {
                    var isMatch=true;
                    if (!allRows) {
                        for (var j=0; j < condNames.length; j++) {
                            isMatch=true;
                            if (sheetObj.GetCellValue(i, condNames[j]) != condValues[j]) {
                                isMatch=false;
                                break;
                            }
                        }
                    }
                    
                    if (!isMatch)  continue;

                    if (bIsStyled) {
                        var sheetFontColor=sheetObj.GetDataFontColor();
                        var sheetBackColor=sheetObj.GetDataBackColor();
                        var sheetBackColorAlt=sheetObj.GetDataAlternateBackColor();
                        var sTr="";
                        sTr += "\t<TR";
                        var rowFontColor=sheetObj.GetRowFontColor(i);
                        if (rowFontColor !=  "" && rowFontColor != sheetFontColor) {
                            var radixVal=parseInt(rowFontColor.substring(0, 2), 16) + "," + parseInt(rowFontColor.substring(2, 4), 16) + "," + parseInt(rowFontColor.substring(4, 6), 16);
                            sTr += " COLOR=\"" + radixVal + "\"";
                        }
                        var rowBackColor=sheetObj.GetRowBackColor(i);
                        if (rowBackColor !=  "" && rowBackColor != sheetBackColor && rowBackColor != sheetBackColorAlt) {
                            var radixVal=parseInt(rowBackColor.substring(0, 2), 16) + "," + parseInt(rowBackColor.substring(2, 4), 16) + "," + parseInt(rowBackColor.substring(4, 6), 16);
                            sTr += " BGCOLOR=\"" + radixVal + "\"";
                        }
                        var rowEditable=new String(sheetObj.GetRowEditable(i)).toUpperCase();
                        sTr += " EDIT=\"" + rowEditable + "\"";
                        for (var j=0; j < arrCol.length; j++) {
                            aryTD[j]="";
                            aryTD[j] += "\t\t<TD";
                            var cellFontColor=sheetObj.GetCellFontColor(i, arrCol[j]);
                            if (cellFontColor !=  "" && cellFontColor != sheetFontColor && cellFontColor != rowFontColor) {
                                var radixVal=parseInt(cellFontColor.substring(0, 2), 16) + "," + parseInt(cellFontColor.substring(2, 4), 16) + "," + parseInt(cellFontColor.substring(4, 6), 16);
                                aryTD[j] += " COLOR=\"" + radixVal + "\"";
                            }
                            var cellBackColor=sheetObj.GetCellBackColor(i, arrCol[j]);
                            if (cellBackColor !=  "" && cellBackColor != sheetBackColor
                                    && cellBackColor != sheetBackColorAlt && cellBackColor != rowBackColor) {
                                var radixVal=parseInt(cellBackColor.substring(0, 2), 16) + "," + parseInt(cellBackColor.substring(2, 4), 16) + "," + parseInt(cellBackColor.substring(4, 6), 16);
                                aryTD[j] += " BGCOLOR=\"" + radixVal + "\"";
                            }
                            var cellEditable=new String(sheetObj.GetCellEditable(i, arrCol[j])).toUpperCase()
                            if (cellEditable !=  "" && cellEditable != rowEditable) {
                                aryTD[j] += " EDIT=\"" + cellEditable + "\"";
                            }
                            if (sheetObj.GetToolTipText(i, arrCol[j]) != "") {
                                var sTxt=sheetObj.GetToolTipText(i, arrCol[j]).replace(/&/g, "&amp;").replace(/\"/g, "&quot;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
                                aryTD[j] += " TOOL-TIP=\"" + sTxt + "\"";
                            }
                            aryTD[j] += "><![CDATA[" + new String(sheetObj.GetCellValue(i, arrCol[j])) + "]]></TD>";
                        }
                        sTr += ">\n" + aryTD.join("\n")+ "\t</TR>";
                        aryTR.push(sTr);
                    } else {
                        for (var j=0; j < arrCol.length; j++) {
                        	aryTD[j]=String(sheetObj.GetCellValue(i, arrCol[j]));
                        }
                        aryTR.push("\t<TR><![CDATA[" + aryTD.join(sColSep)+ "]]></TR>");
                    }
                    arrPrcdRow.push(i);
                }
            }
            allXml += "<?xml version='1.0'  ?>\n";
            allXml += "<SHEET>\n";
            allXml += "  <DATA TOTAL='" + arrPrcdRow.length + "' COLORDER='" + saveColName + "'";
            if (!bIsStyled) {
                allXml += " COLSEPARATOR='" + sColSep + "'";
            }
            allXml += ">\n";
            allXml += aryTR.join("\n");
            allXml += "  </DATA>\n";
            allXml += "</SHEET>";
            if (bRowDel) {
                if (allRows) {
                    sheetObj.RemoveAll();
                } else {
                    sheetObj.RowDelete(arrPrcdRow.join("|"), false);
                }
            }
            return allXml;
        } catch(err) { ComFuncErrMsg(err.message); }
    }
    /**
     * IBSheet에서 주어진 조건에 맞는 행 또는 모든 데이터행을 조회XML로 구성하여 반환한다. <br>
     * ComPriSheet2Xml함수에서 StyledXML 이용을 쉽게하기 위해 추가된 함수.<br>
     * 기본적인 사용법은 ComPriSheet2Xml함수를 참조하도록 한다. <br>
     * Sheet의 XML을 가져올때 기본형태인 TR-COLSEPARATOR 조합의 형태가 아닌 <br>
     * TR-TD형태로 만들어준다. 따라서 각 ROW이나 CELL별로 색상, 배경색, 수정가능여부 등의 설정이 가능하다.<br>
     * IBSheet도움말의 조회XML부분을 참조하라. IBSheet의 특성상 모든 기능을 사용할 수는 없고,
     * 현재 TR요소에서 BGCOLOR, COLOR, EDIT가 사용가능하고,<br>
     * TD요소에서 BGCOLOR, COLOR, EDIT, TOOL-TIP 속성이 사용가능하다.<br>
     * 추후 IBSheet패치여부에 따라 FontStrike도 적용 예정임.
     * <br><b>Example :</b>
     * <pre>
     *     sXml = ComPriSheet2StyledXml(sheetObj);
     *     sXml = ComPriSheet2StyledXml(sheetObj, "col1|col2|col3|col4");
     *     sXml = ComPriSheet2StyledXml(sheetObj, null, "svc_scp_cd|gline_seq", "ACE|1", true);
     * </pre>
     * @param {ibsheet} sheetObj    필수,IBSheet Object
     * @param {string}  saveColName 선택,특정 컬럼만 배열로 만들경우 SaveName을 "|"로 연결한 문자열 설정
     *                              지정하지 않으면, 전체 컬럼을 대상으로 한다.
     * @param {string}  sCol        선택, 행조회시 기준이 되는 컬럼의 SaveName. "|"로 연결
     *                              지정하지 않으면, 전체 행을 대상으로 한다.
     * @param {string}  sValue      선택, 행조회시 기준이 되는 컬럼의 값(Value). "|"로 연결
     *                              지정하지 않으면, 전체 행을 대상으로 한다.
     * @param {bool}    bRowDel     선택, 원본행삭제여부, default=false.
     * @return string,  Sheet의 데이터를 조회XML로 구성한 문자열
     * @author 박성수
     * @version 2009.05.07
     */
    function ComPriSheet2StyledXml(sheetObj, saveColName, sCol, sValue, bRowDel)  {
        return ComPriSheet2Xml(sheetObj, saveColName, sCol, sValue, bRowDel, true);
    }
    /**
     * 주어진 sheetObj에 IBSheet의 SearchXM을 로드한다. <br>
     * AppendMode에 따라 원본sheet 내용의 전체 또는 일부분을 클리어하고 로드하거나, Append할 수 있다.<br>
     * <br><b>Example :</b>
     * <pre>
     *     sXml = ComPriXml2Sheet(sheetObj, sXml);
     *     sXml = ComPriXml2Sheet(sheetObj, sXml, 2);
     *     sXml = ComPriXml2Sheet(sheetObj, sXml, 1, "svc_scp_cd|gline_seq", "ACE|1");
     * </pre>
     * @param {ibsheet} sheetObj    필수, IBSheet Object
     * @param {string}  sXml        필수, Sheet에 로드할 Search XML.
     * @param {int}    bAppendMode  선택, 원본Sheet(sheetObj)의 내용의 처리방법. default=0<br>
     *                              0 : Clear, 원본Sheet의 내용을 모두 삭제하고 sXml의 내용을 sheetObj에 Load한다.<br>
     *                              1 : Replace, 원본Sheet의 내용 중, sCol/sValue의 조건에 해당하는 부분만 삭제하고 Load.<br>
     *                              2 : Append, 원본Sheet의 내용을 변경하지 않고, 뒷부분에 Append한다.
     * @param {string}  sCol        선택, bAppendMode가 1일 경우, 삭제 대상이 되는 조건 컬럼의 SaveName. "|"로 연결.
     * @param {string}  sValue      선택, bAppendMode가 1일 경우, 삭제 대상이 되는 조건의 값. "|"로 연결.
     * @return 없음.
     * @author 박성수
     * @version 2009.05.13
     */
    function ComPriXml2Sheet(sheetObj, sXml, bAppendMode, sCol, sValue)  {
        try {
        	if ((!sheetObj) || (!sheetObj.IBSheetVersion)) return
            if (sXml == undefined || sXml == null || sXml == "")  return;
        	
            if (bAppendMode == undefined || bAppendMode == null || bAppendMode == "")  bAppendMode=0;

            if (bAppendMode == 0) {
                sheetObj.RemoveAll();
            } else if (bAppendMode == 1) {
                var arrCol=sCol.split("|");
                var arrValue=sValue.split("|");
                for (var i=sheetObj.LastRow(); i >= sheetObj.HeaderRows(); i--) {
                    var isMatch=true;
                    for (var j=0; j < arrCol.length; j++) {
                    	if (sheetObj.GetCellValue(i, arrCol[j]) != arrValue[j]) {
                            isMatch=false;
                            break;
                        }
                    }
                    if (isMatch) {
                        sheetObj.RowDelete(i, false);
                    }
                }
            }
            sheetObj.LoadSearchData(sXml,{Append:1 , Sync:1} );
        } catch(err) { ComFuncErrMsg(err.message); }
    }
    /**
     * 한 화면에 여러개의 Sheet가 있는 경우, SaveString에 prefix를 붙여준다 <br>
     *
     * @param {string} sStr 필수, QueryString from IBSheet.GetSaveString().
     * @param {string} sPrefix 필수, Prefix.
     * @return string 쿼리스트링의 각 name앞에, 주어진 prefix가 붙여진 쿼리스트링.
     * @author 박성수
     * @version 2009.04.22
     */
    function ComPriSetPrifix(sStr, sPrefix) {
        if (sStr == null || sStr == "" || sPrefix == null || sPrefix == "") {
            return sStr;
        }
        var regexp=RegExp(/&/g);
        sStr=sPrefix + sStr.replace(regexp, "&" + sPrefix);
        return sStr;
    }
    /**
     * IBSheet의 row들을 주어진 값과 일치하는 row의 Index를 배열형태로 반환한다 <br>
     *
     * @param {object} sheetObj 필수, IBSheet Object.
     * @param {string} sCol 필수, 키 컬럼명(Savename). "|"로 연결한다.
     * @param {string} sValue 필수, 키 데이터. "|"로 연결한다.
     * @return array 주어진 조건에 일치하는 행의 Index로 이루어진 배열.
     * @author 박성수
     * @version 2009.04.22
     */
    function ComPriSheetFilterRows(sheetObj, sCol, sValue) {
        if (sheetObj == null || sCol == null || sCol == "" || sValue == null || sValue == "") {
            return;
        }
        var rtnArr=new Array();
        var arrCol=sCol.split("|");
        var arrValue=sValue.split("|");
        for (var i=sheetObj.HeaderRows(); i <= sheetObj.LastRow(); i++) {
            var isMatch=true;
            for (var j=0; j < arrCol.length; j++) {
            	if (sheetObj.GetCellValue(i, arrCol[j]) != arrValue[j]) {
                    isMatch=false;
                    break;
                }
            }
            if (isMatch) {
                rtnArr.push(i);
            }
        }
        return rtnArr;
    }
    /**
     * IBSheet의 row들을 주어진 값과 일치하는 row만 보이도록 필터링 한다. <br>
     * 필터링 후 필터된 row중 첫번째 row를 select해 준다. <br>
     *
     * @param {object} sheetObj 필수, IBSheet Object.
     * @param {string} sCol 필수, 키 컬럼명(Savename). "|"로 연결한다.
     * @param {string} sValue 필수, 키 데이터. "|"로 연결한다.
     * @return 없음
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriSheetFilter(sheetObj, sCol, sValue, bSelectLast) {
        if (sheetObj == null || sCol == null || sCol == "" || sValue == null || sValue == "") {
            return;
        }
        var arrCol=sCol.split("|");
        var arrValue=sValue.split("|");
        var firstRow=-1;
        
        for (var i=sheetObj.HeaderRows(); i<=sheetObj.LastRow(); i++) {
        	if (sheetObj.GetRowStatus(i) == "D")  continue;
            var doHide=0;
            for (var j=0; j < arrCol.length; j++) {
            	if (sheetObj.GetCellValue(i, arrCol[j]) != arrValue[j]) {
                    doHide=1;
                    break;
                }
            }
            if (doHide==0 && (bSelectLast || firstRow == -1))  firstRow=i;
            sheetObj.SetRowHidden(i,doHide);
        }

        if (firstRow > 0) {
            sheetObj.SetSelectRow(firstRow);
        }
    }
    /**
     * Master/Detail로 이루어진 2개의 IBSheet에서 Master에서 선택된 row에 해당하는 내용만 Detail에 보이도록 필터링 한다. <br>
     *
     * @param {object} sheetObjM 필수, Master IBSheet Object.
     * @param {object} sheetObjD 필수, Detail IBSheet Object.
     * @param {string} sCol 필수, 키 컬럼명(Savename). "|"로 연결한다.
     * @return 없음
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriMDSheetFilter(sheetObjM, sheetObjD, sCol) {
        if (sheetObjM == null || sheetObjD == null || sCol == null || sCol == "") {
            return;
        }
        var idx=sheetObjM.GetSelectRow();
        var arrCol=sCol.split("|");
        var sValue="";
        for (var i=0; i < arrCol.length; i++) {
        	sValue += sheetObjM.GetCellValue(idx, arrCol[i]);
            if (i < arrCol.length - 1) {
                sValue += "|";
            }
        }
        ComPriSheetFilter(sheetObjD, sCol, sValue);
    }
    /**
     * SHEET에서 CHECK된 ROW의 INDEX를 배열로 리턴한다. <br>
     * <br><b>Example :</b>
     * <pre>
     *  var chkArr = ComPriSheetCheckedRows(sheetObj, "chk");
     *  for(var i=0;i < chkArr.length;i++){
     *      ComDebug(sheetObj.CellValue(Number(chkArr[i]), "note_seq"));
     *  }
     * </pre>
     * @param  {ibsheet} sheetObj 필수 IBSheet Object
     * @param  {string} Column Index(SaveName)
     * @return chkArr Array
     * @author 최성민
     * @version 2009.08.13
     */
    function ComPriSheetCheckedRows(sheetObj, selChk) {
     var chkArr=new Array();
     var iCheckRow=sheetObj.FindCheckedRow(selChk);
     if(iCheckRow != "") {
         chkArr=iCheckRow.split("|");
     }
     return chkArr;
    }
    /**
     * 주어진 컬럼의 Max값 구하기 <br>
     *
     * @param {object} sheetObj 필수, IBSheet Object.
     * @param {string} sCol 필수, Max값을 구할 컬럼명(Savename).
     * @return int Max값
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriGetMax(sheetObj, sCol) {
        var max=0;
        for (var i=sheetObj.HeaderRows(); sheetObj.RowCount()> 0 && i <= sheetObj.LastRow(); i++) {
        	if (parseInt(sheetObj.GetCellValue(i, sCol)) > max) {
        		max=sheetObj.GetCellValue(i, sCol);
            }
        }
        return max;
    }
    /**
     * 삭제된 row를 제외한 컬럼의 Max값 구하기 <br>
     *
     * @param {object} sheetObj 필수, IBSheet Object.
     * @param {string} sCol 필수, Max값을 구할 컬럼명(Savename).
     * @return int Max값
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriGetMaxExceptDelete(sheetObj, sCol) {
        var max=0;
        for (var i=sheetObj.HeaderRows(); sheetObj.RowCount()> 0 && i <= sheetObj.LastRow(); i++) {
        	if(sheetObj.GetRowStatus(i) == "D") continue;
        	if (parseInt(sheetObj.GetCellValue(i, sCol), 10) > max) {
        		max=sheetObj.GetCellValue(i, sCol);
            }
        }
        return max;
    }
    /**
     * IBSheet의 GetSearchXml함수를 통해 가져온 XML 데이터를 Array형태로 변환한다. <br>
     * <b>Example :</b>
     *
     * <pre>
     * var sXml = mySheet.GetSearchXml(&quot;aaa.do&quot;); // 조회결과 35건.
     * var arrData = ComPriXml2Array(xmlStr, &quot;user_id|user_nm|status&quot;);
     *
     * 결과: 35X 3 크기의 결과 Array.
     * </pre>
     *
     * @param {string} xmlStr 필수, IBSheet를 통해 받아온 xml 문자열
     * @param {string} colList 필수, XML문자열에서 추출하고자하는 컬럼명(Savename). "|"로 연결한다.
     * @return array   [조회된row수 X 컬럼수] 크기의 string array.
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriXml2Array(xmlStr, colList) {
        var rtnArr=new Array();
        if (xmlStr == null || xmlStr == "" || colList == null || colList == "") {
            return;
        }
        try {
            var xmlDoc = ComGetXmlDoc(xmlStr);
            if (xmlDoc == null) return;
            var xmlRoot = xmlDoc.documentElement;            
            if (xmlRoot == null)  return;

            var dataNode=xmlRoot.getElementsByTagName("DATA").item(0);
            if (dataNode == null || dataNode.attributes.length < 2) {
                return;
            }
            var col=dataNode.getAttribute("COLORDER");
            var colArr=col.split("|");
            var sep=dataNode.getAttribute("COLSEPARATOR");
            var total=dataNode.getAttribute("TOTAL");
            var dataChildNodes=dataNode.childNodes;
            if (dataChildNodes == null) {
                return;
            }
            var colListArr=colList.split("|");
            var colListIdx=Array();
            for (var i=0; i < colListArr.length; i++) {
                for (var j=0; j < colArr.length; j++) {
                    if (colListArr[i] == colArr[j]) {
                        colListIdx[i]=j;
                        break;
                    }
                }
            }
            var rtnIdx = 0;
            for (var i=0; i < dataChildNodes.length; i++) {
                if (dataChildNodes[i].nodeType != 1) {
                    continue;
                }
                var arrData=null;
                if (sep == null || sep == "") {
                    arrData=new Array();
                    var trChildNodes=dataChildNodes[i].childNodes;
                    for (var j=0; j < trChildNodes.length; j++) {
                        if (trChildNodes[j].nodeType != 1) {
                            continue;
                        }
                        arrData.push(trChildNodes[j].firstChild.nodeValue);
                    }
                } else {
                    arrData=dataChildNodes[i].firstChild.nodeValue.split(sep);
                }
                var subDataArr=new Array();
                for (var j=0; j < colListIdx.length; j++) {
                    subDataArr[j]=arrData[colListIdx[j]];
                }
                rtnArr[rtnIdx++]=(subDataArr);
            }
        } catch (err) {
            ComFuncErrMsg(err.message);
        }
        return rtnArr;
    }
    /**
     * IBSheet의 GetSearchXml함수를 통해 가져온 XML 데이터를 <br>
     * IBMultiCombo의 item으로 insert 해준다.<br>
     * <b>Example :</b>
     *
     * <pre>
     * var sXml = mySheet.GetSearchXml(&quot;aaa.do&quot;); // 조회결과 35건.
     * var arrData = ComPriXml2ComboItem(xmlStr, combo1, &quot;cd&quot;, &quot;nm&quot;);
     *
     * </pre>
     *
     * @param {string} xmlStr 필수, IBSheet를 통해 받아온 xml 문자열.
     * @param {object} cmbObj 필수, insert하고자 하는 IBMultiCombo Object.
     * @param {string} codeCol 필수, Combo의 Code컬럼명.
     * @param {string} textCol 필수, Combo의 Text컬럼명. 다수일 경우 '|' 로 연결
     * @param {boolean} bClear 선택, Combo의 기존 내용을 Clear할지 여부(combo.RemoveAll()). 기본값=true.
     * @return 없음.
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriXml2ComboItem(xmlStr, cmbObj, codeCol, textCol, bClear) {
        if (xmlStr == null || xmlStr == "" || cmbObj == null || cmbObj == "") {
            return;
        }
        if (codeCol == null || codeCol == "" || textCol == null || textCol == "") {
            return;
        }
        try {
            if (bClear != false) {
                cmbObj.RemoveAll();
            }
            var xmlDoc = ComGetXmlDoc(xmlStr);
            if (xmlDoc == null) return;
            var xmlRoot = xmlDoc.documentElement;            
            if (xmlRoot == null)  return;
            
            var dataNode=xmlRoot.getElementsByTagName("DATA").item(0);
            if (dataNode == null || dataNode.attributes.length < 2) { //original 3) {
                return;
            }
            var col=dataNode.getAttribute("COLORDER");
            var colArr=col.split("|");
            var sep=dataNode.getAttribute("COLSEPARATOR");
            var total=dataNode.getAttribute("TOTAL");
            var dataChildNodes=dataNode.childNodes;
            if (dataChildNodes == null) {
                return;
            }
            var colListIdx=Array();
            var arrText=textCol.split("|");
            for (var i=0; i < colArr.length; i++) {
                if (colArr[i] == codeCol) {
                    colListIdx[0]=i;
                }
                for (var j=0; j < arrText.length; j++) {
                    if (colArr[i] == arrText[j]) {
                        colListIdx[j+1]=i;
                    }
                }
            }
            for (var i=0; i < dataChildNodes.length; i++) {
                if (dataChildNodes[i].nodeType != 1) {
                    continue;
                }
                var arrData=null;
                if (sep == null || sep == "") {
                    arrData=new Array();
                    var trChildNodes=dataChildNodes[i].childNodes;
                    for (var j=0; j < trChildNodes.length; j++) {
                        if (trChildNodes[j].nodeType != 1) {
                            continue;
                        }
                        arrData.push(trChildNodes[j].firstChild.nodeValue);
                    }
                } else {
                    arrData=dataChildNodes[i].firstChild.nodeValue.split(sep);
                }
                var item="";
                for (var j=1; j < colListIdx.length; j++) {
                    item += arrData[colListIdx[j]];
                    if (j < colListIdx.length - 1) {
                        item += "|";
                    }
                }
                cmbObj.InsertItem(-1, item, arrData[colListIdx[0]]);
            }
        } catch (err) {
            ComFuncErrMsg(err.message);
        }
    }
    /**
     * IBSheet의 GetSearchXml함수를 통해 가져온 XML 데이터를 <br>
     * IBSheet의 Combo에 연결할수 있는 문자열형태로 반환한다.(&quot;|&quot;로 연결된 문자열)<br>
     * Return되는 배열의 0번째는 Code문자열, 1번째는 Text문자열이 담겨있다.
     * <b>Example :</b>
     *
     * <pre>
     * var sXml = mySheet.GetSearchXml(&quot;aaa.do&quot;); // 조회결과 35건.
     * var arrData = ComPriXml2ComboString(xmlStr, &quot;cd&quot;, &quot;nm&quot;);
     *
     * </pre>
     *
     * @param {string} xmlStr 필수, IBSheet를 통해 받아온 xml 문자열.
     * @param {string} codeCol 필수, Combo의 Code컬럼명.
     * @param {string} textCol 필수, Combo의 Text컬럼명.
     * @return array   Code연결 문자열과 Text연결 문자열이 담긴 배열.
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriXml2ComboString(xmlStr, codeCol, textCol) {
        var rtnArr=new Array();
        if (xmlStr == null || xmlStr == "") {
            return;
        }
        if (codeCol == null || codeCol == "" || textCol == null || textCol == "") {
            return;
        }
        try {
            var xmlDoc = ComGetXmlDoc(xmlStr);
            if (xmlDoc == null) return;
            var xmlRoot = xmlDoc.documentElement;            
            if (xmlRoot == null)  return;

            var dataNode=xmlRoot.getElementsByTagName("DATA").item(0);
            if (dataNode == null || dataNode.attributes.length < 3) {
                return;
            }
            var col=dataNode.getAttribute("COLORDER");
            var colArr=col.split("|");
            var sep=dataNode.getAttribute("COLSEPARATOR");
            var total=dataNode.getAttribute("TOTAL");
            var dataChildNodes=dataNode.childNodes;
            if (dataChildNodes == null) {
                return;
            }
            var colListIdx=Array();
            for (var i=0; i < colArr.length; i++) {
                if (colArr[i] == codeCol) {
                    colListIdx[0]=i;
                }
                if (colArr[i] == textCol) {
                    colListIdx[1]=i;
                }
            }
            var sCode="";
            var sText="";
            for (var i=0; i < dataChildNodes.length; i++) {
                if (dataChildNodes[i].nodeType != 1) {
                    continue;
                }
                var arrData=null;
                if (sep == null || sep == "") {
                    arrData=new Array();
                    var trChildNodes=dataChildNodes[i].childNodes;
                    for (var j=0; j < trChildNodes.length; j++) {
                        if (trChildNodes[j].nodeType != 1) {
                            continue;
                        }
                        arrData.push(trChildNodes[j].firstChild.nodeValue);
                    }
                } else {
                    arrData=dataChildNodes[i].firstChild.nodeValue.split(sep);
                }
                sCode += arrData[colListIdx[0]];
                sText += arrData[colListIdx[1]];
                if (i != dataChildNodes.length - 1) {
                    sCode += "|";
                    sText += "|";
                }
            }
            //Park Young Jin Modify 2014.06.23
            if(sCode.substring(Number(sCode.length)-1,Number(sCode.length)) == "|") {
            	sCode = sCode.substring(0,Number(sCode.length)-1);
            	sText = sText.substring(0,Number(sText.length)-1);
            }
            
            rtnArr.push(sCode);
            rtnArr.push(sText);
        } catch (err) {
            ComFuncErrMsg(err.message);
        }
        return rtnArr;
    }
    /**
     * IBSheet의 GetSearchXml함수를 통해 가져온 XML String에서 데이터 Row Count를 구한다.(TOTAL) <br>
     * <b>Example :</b>
     *
     * <pre>
     * var sXml = mySheet.GetSearchXml(&quot;aaa.do&quot;); // 조회결과 35건.
     * var cnt = ComPriGetRowCountFromXML(xmlStr);
     *
     * </pre>
     *
     * @param {string} xmlStr 필수, IBSheet를 통해 받아온 xml 문자열
     * @return int   XML String에 포함된 데이터행의 갯수
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriGetRowCountFromXML(xmlStr) {
        var rtn=-1;
        if (xmlStr == null || xmlStr == "") {
            return rtn;
        }
        try {
            var xmlDoc = ComGetXmlDoc(xmlStr);
            if (xmlDoc == null) return;
            var xmlRoot = xmlDoc.documentElement;            
            if (xmlRoot == null)  return;

            var dataNode=xmlRoot.getElementsByTagName("DATA").item(0);
            if (dataNode == null || dataNode.attributes.length < 3) {
                return rtn;
            }
            rtn=dataNode.getAttribute("TOTAL");
        } catch (err) {
            ComFuncErrMsg(err.message);
        }
        return rtn;
    }
    /**
     * Save 전, 확인 메시지<br>
     *
     * @param 없음
     * @returns bool <br>
     *          true : 확인메시지에서 "확인"을 누른 경우<br>
     *          false : 확인메시지에서 "취소"을 누른 경우<br>
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriConfirmSave() {
        return ComShowCodeConfirm('PRI00001');
    }
      /**
       * 변경내역 Proceed 전, 확인 메시지<br>
       *
       * @param 없음
       * @returns bool <br>
       *          true : 확인메시지에서 "확인"을 누른 경우<br>
       *          false : 확인메시지에서 "취소"을 누른 경우<br>
        * @author 변영주
        * @version 2009.06.02
       */
      function ComPriClearChange() {
          return ComShowCodeConfirm('PRI00010');
      }
    /**
     * Delete 전, 확인 메시지<br>
     *
     * @param 없음
     * @returns bool <br>
     *          true : 확인메시지에서 "확인"을 누른 경우<br>
     *          false : 확인메시지에서 "취소"을 누른 경우<br>
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriConfirmDelete() {
        return ComShowCodeConfirm('PRI00002');
    }
    /**
     * Delete 전, 확인 메시지<br>
     *
     * @param 없음
     * @returns bool <br>
     *          true : 확인메시지에서 "확인"을 누른 경우<br>
     *          false : 확인메시지에서 "취소"을 누른 경우<br>
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriConfirmDeleteAll() {
        return ComShowCodeConfirm('PRI00005');
    }
    /**
     * Confirm 전, 확인 메시지<br>
     *
     * @param 없음
     * @returns bool <br>
     *          true : 확인메시지에서 "확인"을 누른 경우<br>
     *          false : 확인메시지에서 "취소"을 누른 경우<br>
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriConfirmConfirm() {
        return ComShowCodeConfirm('PRI00003');
    }
    /**
     * Cancel Confirm 전, 확인 메시지<br>
     *
     * @param 없음
     * @returns bool <br>
     *          true : 확인메시지에서 "확인"을 누른 경우<br>
     *          false : 확인메시지에서 "취소"을 누른 경우<br>
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriConfirmCancelConfirm() {
        return ComShowCodeConfirm('PRI00004');
    }
    /**
     * Save 후, 성공 메시지<br>
     *
     * @param 없음
     * @return 없음
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriSaveCompleted() {
        ComShowCodeMessage('PRI00101');
    }
    /**
     * Delete 후, 성공 메시지<br>
     *
     * @param 없음
     * @return 없음
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriDeleteCompleted() {
        ComShowCodeMessage('PRI00102');
    }
    /**
     * Confirm 후, 성공 메시지<br>
     *
     * @param 없음
     * @return 없음
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriConfirmCompleted() {
        ComShowCodeMessage('PRI00103');
    }
    /**
     * Confirm Cancel 후, 성공 메시지<br>
     *
     * @param 없음
     * @return 없음
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriCancelConfirmCompleted() {
        ComShowCodeMessage('PRI00104');
    }
    /**
     * Save 후, 실패 메시지<br>
     *
     * @param 없음
     * @return 없음
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriSaveFailed() {
        ComShowCodeMessage('PRI00201');
    }
    /**
     * 진행여부 체크 메세지<br>
     *
     * @param 메시지1 object
     * @return 없음
      * @author 이승준
      * @version 2009.05.11
     */
    function ComPriProcessYn(msg1) {
        return ComShowCodeConfirm("PRI03007",msg1);
    }
    /**
     * 성공 메세지<br>
     *
     * @param 메시지1 object
     * @return 없음
      * @author 이승준
      * @version 2009.05.11
     */
    function ComPriProcessSuccess(msg1) {
        ComShowCodeMessage("PRI01045",msg1);
    }
    /**
     * Delete 후, 실패 메시지<br>
     *
     * @param 없음
     * @return 없음
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriDeleteFailed() {
        ComShowCodeMessage('PRI00202');
    }
    /**
     * Confirm 후, 실패 메시지<br>
     *
     * @param 없음
     * @return 없음
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriConfirmFailed() {
        ComShowCodeMessage('PRI00203');
    }
    /**
     * Confirm Cancel 후, 실패 메시지<br>
     *
     * @param 없음
     * @return 없음
      * @author 박성수
      * @version 2009.04.22
     */
    function ComPriCancelConfirmFailed() {
        ComShowCodeMessage('PRI00204');
    }
    /**
     * input box  등 필수 값 입력 메세지<br>
     *
     * @param 메시지1, 메시지2, input box 등 object
     * @return 없음
      * @author 이승준
      * @version 2009.05.11
     */
    function ComPriInputValueFailed(msg1,msg2,input) {
        ComShowCodeMessage("PRI00308",msg1,msg2);
        	
        if(input.type == 'text' || input.type =="select-one")
            input.focus();
        return;
    }
    /**
     * 날짜 포멧 실패 메세지 - IBCOMBO 용<br>
     *
     * @param 메시지1
     * @return 없음
      * @author 이승준
      * @version 2009.06.15
     */
    function ComPriDateFormatFailed(msg1) {
        ComShowCodeMessage("PRI00322",msg1);
    }
    /**
     * IBSheet의 중복컬럼을 체크한다. <br>
     * 중복이 되었다면 중복된 row 를 return 하고 중복된 row가 없다면 <br>
     * -1을  return 한다.
     *
     * <b>Example :</b>
     *
     * <pre>
     * var dupRow = jsDupCheck(col);  // 중복 체크할 컬럼을 | 로구분하여 입력한다.
     * </pre>
     *
     * @param {string} col 필수
     * @return int   -1 이면 중복 없음, 중복된 row
     * @author
     * @version 2009.04.22
     */
    function jsDupCheck(ColStr)
    {
        var sText,ir, ic;
        var Row, Col, aryCol, bNext;
        var sheetObject1=sheetObjects[0];
        
        ColStr = "";
        aryCol=ColStr.split("|");
        
        //가능한 유효 컬럼을 찾는다
        for (ic=0; ic < aryCol.length; ic++) {
            if (aryCol[ic] >= 0 && aryCol[ic] <= sheetObject1.LastCol())
            {
            	ColStr += (ColStr==""?"":"|") + aryCol[ic];
            }
        }
        
        return sheetObject1.ColValueDup(ColStr);

        /*
        Col=-1;
        aryCol=ColStr.split("|");
        ColStr="";
        
        //한개 컬럼의 중복 여부를 확인하는 경우
        if (ColStr == "") {
            if (Col != -1) return sheetObject1.ColValueDup(Col);
            //다중 컬럼의 중복 여부를 확인하는 경우
        } else {        	
            aryCol=ColStr.split("|")
            for (ir=1; ir<= sheetObject1.LastRow(); ir++) {
                //첫번째 컬럼의 값으로 중복된 행번호를 가져옴
                sText=sheetObject1.GetCellText(ir, Col);
                Row=sheetObject1.FindText(Col, sText, ir + 1, true);
                //해당 값으로 중복된 모든 행을 확인
                while (Row > 0) {
                    bNext=false;
                    //중복된 행이 있는 경우 나머지 컬럼 값 일치 여부 확인
                    for (ic=0; ic<aryCol.length; ic++){
                        if (sheetObject1.GetCellText(ir, aryCol[ic]) != sheetObject1.GetCellText(Row, aryCol[ic]) ){
                            //하나라도 값이 다르면 그냥 처리 중단, 다음 중복 확인
                            bNext=true;
                            break;
                        }
                    }
                    //모든 컬럼 값이 같으므로 중복 행번 반환
                    if (bNext == false) return Row;
                    Row=sheetObject1.FindText(Col, sText, Row + 1, true);
                }
            }
        }*/
        return -1;
    }
    /**
     * 전체 Row 중에 Checkbox의 체크가 되어있는 Row들을 숨기고 상태를 삭제로 변경한다.<br>
     * isSelectDel 파라메터를 주면 check된 Checkbox가 없을 경우 현재 선택된 row를 삭제한다.<br>
     * <br><b>Example :</b>
     * <pre>
     *     deleteRowCheck(sheetObj);
     *     deleteRowCheck(sheetObj, "chk");
     *     deleteRowCheck(sheetObj, "chk", true);
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @param {string} selColName 선택 화면에 보여지는 checkbox의 SaveName.
     *                               default="sel_chk"
     * @param {bool} isSelectDel 선택 현재 선택되어있는 row를 삭제할지 여부
     *                                 true : 체크된 row가 없으면 선택되어 있는 row를 삭제
     *                                 그 외 : 체크된 row 만 삭제
     * @return ComRowHideDelete() 함수 return 값
     * @author 문동규
     * @version 2009.04.22
     */
    function deleteRowCheck(sheetObj, selColName, isSelectDel, isSelAllDel) {
        if (arguments.length == 1) {
            selColName="sel_chk";
        }
        var checkRow=sheetObj.FindCheckedRow(selColName);
        var selRow=sheetObj.GetSelectRow();
        var delRowCount=0;
        var nextVisibleRow = sheetObj.GetSelectRow();
        var fireEventPostDelete=false;
        // 삭제대상중에 현재 로우가 포함되어있는지 체크
        if ((checkRow == "" && isSelectDel)
                || ("|" + checkRow).indexOf("|" + sheetObj.GetSelectRow()) >= 0) {
            fireEventPostDelete=true;
        }
        // IBSheet의 마지막 로우를 Delete하면(중간 Row를 Delete하는 경우와는 다르게) 이벤트가 발생한다.
        // X같은 IBSheet의 넘치는 버그 중 하나... 따라서 이런 경우 이벤트를 강제로 발생시키지 않도록 처리.
        if (sheetObj.GetRowStatus(selRow) == "I" && sheetObj.GetSelectRow()== sheetObj.LastRow()) {
            fireEventPostDelete=false;
        }
        if (checkRow == "") {
            if (isSelectDel) {
                // check된 row가 없고 선택된 row 상태가 Delete가 아니면 선택된 row를 삭제
            	if (selRow != 0 && sheetObj.GetRowStatus(selRow) != "D") {
                    // 선택된 row를 삭제하기위해 checkbox를 check한다.
                    sheetObj.SetCellValue(sheetObj.GetSelectRow(), selColName,1,0);
                    delRowCount=ComRowHideDelete(sheetObj, selColName);
                }
            } else {
                return;
            }
        } else {
            delRowCount=ComRowHideDelete(sheetObj, selColName);
        }
        nextVisibleRow = sheetObj.GetSelectRow();
        if (sheetObj.RowCount()> 0 && delRowCount> 0) {
        	if (sheetObj.GetRowStatus(sheetObj.GetSelectRow()) == "D" && sheetObj.GetRowHidden(sheetObj.GetSelectRow())) {
                nextVisibleRow=-1;
//              for (var i = sheetObj.SelectRow; i <= sheetObj.LastRow; i++) {
//                  if (!sheetObj.RowHidden(i) && sheetObj.RowStatus(i) != "D") {
//                      nextVisibleRow = i;
//                      break;
//                  }
//              }
//              if (nextVisibleRow < 0) {
//                  for (var i = sheetObj.SelectRow; i >= sheetObj.HeaderRows; i--) {
//                      if (!sheetObj.RowHidden(i) && sheetObj.RowStatus(i) != "D") {
//                          nextVisibleRow = i;
//                          break;
//                      }
//                  }
//              }
// IBSheet 버그가 해결될때까지 Row를 삭제 후,아래 행이 아닌 윗 행으로 이동한다. 2010-01-05.
                for (var i=sheetObj.GetSelectRow(); i >= sheetObj.HeaderRows(); i--) {
                	if (!sheetObj.GetRowHidden(i) && sheetObj.GetRowStatus(i) != "D") {
                        nextVisibleRow=i;
                        break;
                    }
                }
                if (nextVisibleRow < 0) {
                    for (var i=sheetObj.GetSelectRow(); i <= sheetObj.LastRow(); i++) {
                    	if (!sheetObj.GetRowHidden(i) && sheetObj.GetRowStatus(i) != "D") {
                            nextVisibleRow=i;
                            break;
                        }
                    }
                }
            }
            if (fireEventPostDelete && nextVisibleRow > 0) {
                try {
                    eval(sheetObj.id + "_OnSelectCell(sheetObj, -2, " + sheetObj.GetSelectCol()+ ", " + nextVisibleRow + ", " + sheetObj.GetSelectCol()+ ", false)");
                } catch (err) {
                }
            }
//          nextVisibleRow = nextVisibleRow > sheetObj.LastRow ? sheetObj.LastRow : nextVisibleRow;
// IBSheet 버그가 해결될때까지 Row를 삭제 후,아래 행이 아닌 윗 행으로 이동한다. 2010-01-05.
            nextVisibleRow = nextVisibleRow < sheetObj.HeaderRows() ? sheetObj.HeaderRows() : nextVisibleRow;            
            if (nextVisibleRow > 0) {
            	//2014.09.17 main row 삭제시 detail의 event 발생 안하게 처리. 
            	if (isSelAllDel == false || isSelAllDel == undefined || isSelAllDel == "" || isSelAllDel == null) {
            		sheetObj.SetSelectRow(nextVisibleRow, false);
            	}
            }            
        }
        return delRowCount;
    }
    /**
     * IBSheet의 콤보 컬럼에 데이터를 setting한다. <br>
     * <b>Example :</b>
     * <pre>
     * setIBCombo(sheetObj,sXml,"rcv_de_term_cd",false,1);
     * </pre>
     *
     * @param {string} sheetObj 필수
     * @param {string} sXml 필수, Combo에 채울 데이터(IBSheet를 통해 받아온 xml 문자열.)
     * @param {string} title 필수, Combo field명(IBSheet SaveName).
     * @param {string} iBlank 선택, Combo의 첫번째로우를 블랭크로 설정
     * @param {string} sCol 선택, 멀티콤보일경우 콤보를 선택하면 콤보에 보여질 순서설정(0:코드 or 1:description)
     * @param {string} dCode 선택, 신규 "입력" 상태일 때 기본으로 선택되어야 할 Item에 대한 Code값
     * @param {string} dText 선택, 신규 "입력" 상태일 때 기본으로 선택되어야 할 Item에 대한 Text값
     * @param {string} bFlag multicombo 용 XML 파일을 Sheet 내에서 Combo 형태로 사용할 경우, Text 에 Code+"\t"+Text 형태로 만들어 사용할 수 있게 해 줌
     * (코드|디스크립션 형태가 아닐 경우는 0으로 설정해야함)
     * @return
     * @author 공백진
     * @version 2009.04.30
     */
    function setIBCombo(sheetObj, sXml, title, iBlank, sCol, dCode, dText, bFlag){
        var showCol=0;
        if (bFlag == undefined || bFlag == "") bFlag=false;
        if (sCol != undefined && sCol !="") showCol=sCol;
        if (iBlank == undefined || iBlank == "") iBlank=false;

        var arrData=ComPriXml2ComboString(sXml, "cd", "nm");
        
        
        if (bFlag == true && arrData != null){
            var arrCode=arrData[0].split("|");
            var arrName=arrData[1].split("|");
            var conData="";
            for(i=0; i < arrName.length;i++){
                if(i==0){
                    arrName[i]=arrCode[i]+"\t"+arrName[i];
                }else{
                	arrName[i]="|"+arrCode[i]+"\t"+arrName[i];
                }
                
                conData=conData.concat(arrName[i]);
            }
            arrData[1]=conData;
        }
        if(iBlank){
            if (arrData != null){
                arrData[0]="|" + arrData[0];
                arrData[1]="|" + arrData[1];
            }
        }
        if (arrData != null){
            sheetObj.SetColProperty(title, {ComboText:arrData[1] ,ComboCode:arrData[0]} );
        }
    }
    /**
     * IBSheet에서 선택된 멀티콤보의 Text 중 Description의 내용을 해당 컬럼에 보여준다. <br>
     * Text 내용은 Code [Tab] Description으로 구성되어있다.
     * 멀티콤보의 SaveName과 Description이 들어가는 Cell의 SaveName을 각각 "|"로 연결하여 조합한다.
     * <br><b>Example :</b>
     * <pre>
     *     getSheetMultiComboText(sheetObj, 3, "svc_scp_cd", "svc_scp_nm");
     *     getSheetMultiComboText(sheetObj, 2, "svc_scp_cd|sconti_cd", "svc_scp_nm|sconti_nm");
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @param {int} Row 필수 이벤트가 발생한 Cell의 Row Index
     * @param {string} CodeCols 필수 멀티콤보의 SaveName
     * @param {string} DescCols 필수 Description이 보여지는 Cell의 SaveName
     * @return 없음
     * @author 문동규
     * @version 2009.04.22
     */
    function getSheetMultiComboText(sheetObj, Row, CodeCols, DescCols)
    {
        var arrCode=CodeCols.split("|");
        var len=arrCode.length;
        if (len > 0) {
            var arrDesc=DescCols.split("|");
            var sText="";
            var arrText;
            var idx=0;
            var selectedText="";
            for (var i=0; i < len; i++) {
                // 콤보텍스트를 가져온다.
                sText=sheetObj.GetComboInfo(0, arrCode[i], "Text");
                // 각각 배열로 구성한다.
                arrText=sText.split("|");
                idx=sheetObj.GetComboInfo(Row, arrCode[i], "SelectedIndex");
                // 선택된 행이 없으면 입력된 값을 지움.
                if (idx < 0) {
                    sheetObj.SetCellValue(Row, arrCode[i],"",0);
                    sheetObj.SetCellValue(Row, arrDesc[i]," ",0);
                    continue;
                }
                selectedText=arrText[idx];
                sheetObj.SetCellValue(Row, arrDesc[i],selectedText.substring(selectedText.indexOf("\t")+1),0);
            }
        }
    }
    /**
     * Status가 D가 아닌 이전 Row의 Row Index를 가져온다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     validRow = getPrevValidRow(sheetObj, 3);
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @param {int} Row 필수 기준 Row의 Row Index
     * @return int <br>
     *         0   : 유효한 이전 Row가 없을 경우
     *         int : 유효한 이전 Row의 Row Index
     * @author 문동규
     * @version 2009.04.28
     */
    function getPrevValidRow(sheetObj, Row) {
        var cnt=Row;
        var rtn=0;
        for (var i=cnt-1; i > 0; i--) {
        	if (sheetObj.GetRowStatus(i) != "D") {
                rtn=i;
                break;
            }
        }
        return rtn;
    }
    /**
     * Status가 D가 아닌 다음 Row의 Row Index를 가져온다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     validRow = getNextValidRow(sheetObj, 3);
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @param {int} Row 필수 기준 Row의 Row Index
     * @return int <br>
     *         0   : 유효한 다음 Row가 없을 경우
     *         int : 유효한 다음 Row의 Row Index
     * @author 문동규
     * @version 2009.04.29
     */
    function getNextValidRow(sheetObj, Row) {
        var cnt=sheetObj.RowCount();
        var rtn=0;
        for (var i=Row+1; i <= cnt; i++) {
        	if (sheetObj.GetRowStatus(i) != "D") {
                rtn=i;
                break;
            }
        }
        return rtn;
    }
    /**
     * Status가 "D"가 아닌 row의 갯수를 가져온다 <br>
     * <br><b>Example :</b>
     * <pre>
     *     rowCnt = getValidRowCount(sheetObj);
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @return int sheet내의 유효한 row수
     * @author 박성수
     * @version 2009.05.13
     */
    function getValidRowCount(sheetObj) {
    	//2014.09.11 update check whether sheetObj is null or isn't
    	var rowCnt = 0;
    	if(sheetObj == null || sheetObj == "undefined") return rowCnt;
    	rowCnt = (sheetObj.RowCount() - sheetObj.RowCount("D"));
        return rowCnt;
    }
    /**
     * Sheet의 row의 갯수를 가져온다 <br>
     * Status가 "D"이거나, 이전 Amend Sequence인 경우, AmendDelete된 경우는 제외한다.
     * <br><b>Example :</b>
     * <pre>
     *     rowCnt = getAmendValidRowCount(sheetObj, formObj.amdt_seq.value);
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @return int sheet내의 유효한 row수
     * @author 박성수
     * @version 2009.05.13
     */
    function getAmendValidRowCount(sheetObj, amdtSeq) {
    	//2014.09.11 update check whether sheetObj is null or isn't
    	if(sheetObj == null || sheetObj == "undefined") return 0;
        var cnt = getValidRowCount(sheetObj);
        for (var i=sheetObj.HeaderRows(); i <= sheetObj.LastRow(); i++) {
        	if (sheetObj.GetCellValue(i, "amdt_seq") != amdtSeq
        			|| sheetObj.GetCellValue(i, "src_info_cd") == "AD") {
                cnt--;
            }
        }
        return cnt;
    }
    /**
     * 주어진 조건에 맞고, Status가 D가 아닌 이전 Row의 Row Index를 가져온다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     validRow = getPrevValidRowCond(sheetObj, 3, "rout_seq|rat_ut_cd", "1|DR");
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @param {int} Row 필수 기준 Row의 Row Index
     * @param {string} sCol 필수, 조회조건이 되는 키 컬럼명(Savename). "|"로 연결한다.
     * @param {string} sValue 필수, 조회조건이 되는 데이터. "|"로 연결한다.
     * @return int <br>
     *         0   : 유효한 이전 Row가 없을 경우
     *         int : 유효한 이전 Row의 Row Index
     * @author 박성수
     * @version 2009.05.13
     */
    function getPrevValidRowCond(sheetObj, Row, sCol, sValue) {
        if (sheetObj == null || Row == null || sCol == null || sCol == "" || sValue == null || sValue == "") {
            return 0;
        }
        var rtn=0;
        var arrCol=sCol.split("|");
        var arrValue=sValue.split("|");
        for (var i=Row - 1; i >= sheetObj.HeaderRows(); i--) {
        	if (sheetObj.GetRowStatus(i) == "D") {
                continue;
            }
            var isMatch=true;
            for (var j=0; j < arrCol.length; j++) {
            	if (sheetObj.GetCellValue(i, arrCol[j]) != arrValue[j]) {
                    isMatch=false;
                    break;
                }
            }
            if (isMatch) {
                rtn=i;
                break;
            }
        }
        return rtn;
    }
    /**
     * 주어진 조건에 맞고, Status가 D가 아닌 다음 Row의 Row Index를 가져온다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     validRow = getNextValidRowCond(sheetObj, 3, "rout_seq|rat_ut_cd", "1|DR");
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @param {int} Row 필수 기준 Row의 Row Index
     * @param {string} sCol 필수, 조회조건이 되는 키 컬럼명(Savename). "|"로 연결한다.
     * @param {string} sValue 필수, 조회조건이 되는 데이터. "|"로 연결한다.
     * @return int <br>
     *         0   : 유효한 다음 Row가 없을 경우
     *         int : 유효한 다음 Row의 Row Index
     * @author 박성수
     * @version 2009.05.13
     */
    function getNextValidRowCond(sheetObj, Row, sCol, sValue) {
        if (sheetObj == null || Row == null || sCol == null || sCol == "" || sValue == null || sValue == "") {
            return 0;
        }
        var rtn=0;
        var arrCol=sCol.split("|");
        var arrValue=sValue.split("|");
        for (var i=Row + 1; i <= sheetObj.LastRow(); i++) {
        	if (sheetObj.GetRowStatus(i) == "D") {
                continue;
            }
            var isMatch=true;
            for (var j=0; j < arrCol.length; j++) {
            	if (sheetObj.GetCellValue(i, arrCol[j]) != arrValue[j]) {
                    isMatch=false;
                    break;
                }
            }
            if (isMatch) {
                rtn=i;
                break;
            }
        }
        return rtn;
    }
    /**
     * 주어진 조건에 맞고, Status가 D가 아닌 다음 Row의 갯수를 반환한다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     validRow = getNextValidRowCond(sheetObj, 3, "rout_seq|rat_ut_cd", "1|DR");
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @param {string} sCol 필수, 조회조건이 되는 키 컬럼명(Savename). "|"로 연결한다.
     * @param {string} sValue 필수, 조회조건이 되는 데이터. "|"로 연결한다.
     * @return int 조건에 맞고, 유효한 Row갯수.
     * @author 박성수
     * @version 2009.05.13
     */
    function getValidRowCountCond(sheetObj, sCol, sValue) {
        if (sheetObj == null || sCol == null || sCol == "" || sValue == null || sValue == "") {
            return 0;
        }
        var rtn=0;
        var arrCol=sCol.split("|");
        var arrValue=sValue.split("|");
        for (var i=sheetObj.HeaderRows(); i <= sheetObj.LastRow(); i++) {
        	if (sheetObj.GetRowStatus(i) == "D") {
                continue;
            }
            var isMatch=true;
            for (var j=0; j < arrCol.length; j++) {
            	if (sheetObj.GetCellValue(i, arrCol[j]) != arrValue[j]) {
                    isMatch=false;
                    break;
                }
            }
            if (isMatch) {
                rtn++;
                break;
            }
        }
        return rtn;
    }
    /**
     * 주어진 조건에 맞고, 유효한 Row의 갯수를 반환한다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     validRow = getNextValidRowCond(sheetObj, 3, "rout_seq|rat_ut_cd", "1|DR");
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @param {string} sCol 필수, 조회조건이 되는 키 컬럼명(Savename). "|"로 연결한다.
     * @param {string} sValue 필수, 조회조건이 되는 데이터. "|"로 연결한다.
     * @param {string} amdtSeq 필수, 현재 Amend Seq.
     * @return int 조건에 맞고, 유효한 Row갯수.
     * @author 박성수
     * @version 2009.05.13
     */
    function getAmendValidRowCountCond(sheetObj, sCol, sValue, amdtSeq) {
        if (sheetObj == null || sCol == null || sCol == "" || sValue == null || sValue == "") {
            return 0;
        }
        var rtn=0;
        var arrCol=sCol.split("|");
        var arrValue=sValue.split("|");
        for (var i=sheetObj.HeaderRows(); sheetObj.RowCount()> 0 && i <= sheetObj.LastRow(); i++) {
        	if (sheetObj.GetRowStatus(i) == "D"
        		|| sheetObj.GetCellValue(i, "amdt_seq") != amdtSeq
        		|| sheetObj.GetCellValue(i, "src_info_cd") == "AD") {
                continue;
            }
            var isMatch=true;
            for (var j=0; j < arrCol.length; j++) {
            	if (sheetObj.GetCellValue(i, arrCol[j]) != arrValue[j]) {
                    isMatch=false;
                    break;
                }
            }
            if (isMatch) {
                rtn++;
                break;
            }
        }
        return rtn;
    }
    /**
     * CheckBox를 선택했을때, 하위 sheet를 모두 check하고, 전체에서 1개가 해제된 상태라면 상위 check를 풀어준다. <br>
     * 하위sheet가 check/uncheck 될때는, sheet내의 모든 행이 대상이 되고, <br>
     * 상위sheet의 check가 풀릴때는, 현재 선택된 행이 대상이 된다. <br>
     * <br><b>Example :</b>
     * <pre>
     *    if (colName == "chk") {
     *        ComPriCheckWithPnS(sheetObjects.slice(0, 2), 0, Row, Col);
     *    }
     * </pre>
     * @param {ibsheet[]} arrSheetObjs 필수 IBSheet Object 배열, 상위sheet부터 하위sheet까지 순차적으로 모두 담아준다.<br>
     *                    화면에서 제외해야할 sheet가 있다면 slice함수 등을 이용하여 필요한 부분만 넘겨준다.
     * @param {int}       curIdx 필수, 사용자가 클릭한 현재 sheet index.
     * @param {int}       Row 필수, OnBeforeCheck이벤트에서 Row로 받은 값을 그대로 넘겨준다.
     * @param {int}       Col 필수, OnBeforeCheck이벤트에서 Col로 받은 값을 그대로 넘겨준다.<br>
     *                    Savename도 사용가능하다. Check컬럼의 위치가 sheet마다 다를 경우, savename을 통일한 후 이용가능하다.
     * @param {int}       skipReadonly 선택, Editable된 checkbox는 제외할지 여부. default = true(제외)
     * @author 박성수
     * @version 2009.05.19
     */
    function ComPriCheckWithPnS(arrSheetObjs, curIdx, Row, Col, skipReadonly) {
        if (arrSheetObjs == null || arrSheetObjs.length <= 0) {
            return;
        }
        if (skipReadonly == null || skipReadonly == "") {
            skipReadonly=true;
        }
        var iValue=arrSheetObjs[curIdx].GetCellValue(Row, Col) == 1 ? 0 : 1;
        // 하위 sheet가 있는경우, 하위 쉬트를 모두 체크해준다.
        if (arrSheetObjs.length > curIdx + 1) {
            for (var i=curIdx + 1; i < arrSheetObjs.length; i++) {
                for (var j=arrSheetObjs[i].HeaderRows(); j <= arrSheetObjs[i].LastRow(); j++) {
                    if (skipReadonly && !arrSheetObjs[i].GetCellEditable(j, Col)) {
                        continue;
                    }
                    arrSheetObjs[i].SetCellValue(j, Col,iValue);
                }
            }
        }
        // 상위 sheet가 있고, 현재sheet의 전체체크가 풀어진경우, 상위sheet도 uncheck한다.
        if (iValue == 0 && curIdx > 0) {
            if (arrSheetObjs[curIdx].CheckedRows(Col) == arrSheetObjs[curIdx].RowCount()) {
                for (var i=curIdx - 1; i >= 0; i--) {
                    if (skipReadonly && !arrSheetObjs[i].GetCellEditable(j, Col)) {
                        continue;
                    }
                    arrSheetObjs[i].SetCellValue(arrSheetObjs[i].GetSelectRow(), Col,iValue);
                }
            }
        }
    }
    /**
     * Button Name으로 Button을 감싸고 있는 table element 를 찾는다. <br>
     *  <br>
     * <br><b>Example :</b>
     * <pre>
     *     tblObj = getButtonTable("btn_Save");
     * </pre>
     * @param {string} btnName 필수, Button의 name
     * @return object, table element. 못찾을 경우 null을 return
     * @author 문동규
     * @version 2009.05.19
     */
     function getButtonTable(btnName) {
         return ComGetObject(btnName);
     }
    /**
     * Button Name으로 Button에 해당하는 td element 를 찾는다. <br>
     *  <br>
     * <br><b>Example :</b>
     * <pre>
     *     tdObj = getButtonObj("btn_Save");
     * </pre>
     * @param {string} btnName 필수, Button의 name
     * @return object, td element. 못찾을 경우 null을 return
     * @author 문동규
     * @version 2009.05.19
     */
     function getButtonObj(btnName) {
         return ComGetObject(btnName);
         /*
         var coll=document.all;
         var obj=null;
         // button name
         if (coll != null) {
             for (var i=0; i < coll.length; i++) {
                 if (coll.item(i).getAttribute("name") == btnName) {
                     obj=coll.item(i);
                     break;
                 }
             }
         }
         return obj;
         */
     }
    /**
     * Button의 Text를 비활성화(회색)처리해서 Disable <br>
     * 이 function에서는 디자인만 비활성화처리 해주는것으로 click 이벤트를 막는것은
     * processButtonClick()에서 따로 처리를 해주어야 한다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     disableButton("btn_Save");
     * </pre>
     * @param {string} btnName 필수 disable 처리할 Button의 name
     * @return 없음
     * @author 문동규
     * @version 2009.05.19
     */
    function disableButton(btnName) {
        var bObj=getButtonObj(btnName);
        ComEnableObject(bObj, false);
        /*
        if (tobj != null) {
            if( tobj.disabled != true){
                tobj.disabled=true;
                var btnObj=getButtonObj(btnName)
                btnObj.style.cursor="default";
            }
        }*/
    }
    /**
     * 비활성화(회색)처리된 Button을 Enable <br>
     * 이 function에서는 디자인만 활성화처리 해주는것으로 click 이벤트를 풀어주는 것은
     * processButtonClick()에서 따로 처리를 해주어야 한다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     enableButton("btn_Save");
     * </pre>
     * @param {string} btnName 필수 enable 처리할 Button의 name
     * @return 없음
     * @author 문동규
     * @version 2009.05.19
     */
    function enableButton(btnName) {
        var bObj=getButtonObj(btnName);
        ComEnableObject(bObj, true);
        /*
        var tobj=getButtonTable(btnName);
        if (tobj != null) {
            if( tobj.disabled != false){
                tobj.disabled=false;
                var btnObj=getButtonObj(btnName)
                btnObj.style.cursor="hand";
            }
        }*/
    }
    /**
     * Button을 Hidden처리해서 Disable <br>
     * <br><b>Example :</b>
     * <pre>
     *     hiddenButton("btn_Save");
     * </pre>
     * @param {string} btnName 필수 disable 처리할 Button의 name
     * @return 없음
     * @author 문동규
     * @version 2009.05.19
     */
    function hiddenButton(btnName) {
        var bObj=getButtonObj(btnName);
        if (bObj != null) {
        	bObj.style.display="none";
        }
    }
    /**
     * Hidden처리된 Button을 Enable <br>
     * <br><b>Example :</b>
     * <pre>
     *     showButton("btn_Save");
     * </pre>
     * @param {string} btnName 필수 enable 처리할 Button의 name
     * @return 없음
     * @author 문동규
     * @version 2009.05.19
     */
    function showButton(btnName) {
        var bObj=getButtonObj(btnName);
        if (bObj != null) {
        	bObj.style.display="inline";
        }
    }
    /**
     * Button의 상태를 가져온다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     getButtonDisableStatus("btn_Save");
     * </pre>
     * @param {string} btnName 필수 disabled 의 상태값을 가져올 Button의 name
     * @return 없음
     * @author 공백진
     * @version 2009.06.12
     */
    function getButtonDisableStatus (btnName){
        var bObj=getButtonObj(btnName);

        if (bObj != null){
            return bObj.disabled;
        }else{
            return false;
        }
    }
    /**
     * sheet 조회 후 font 설정을 변경한다.  <br>
     * <br><b>Example :</b>
     * <pre>
     *     searchEndFontChange(sheetObj, "ctrt_exp_dt","Y");
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @param {string} colName 필수, 조회조건이 되는 키 컬럼명(Savename). "|"로 연결한다.
     * @param {string} colName 선택, 메인의 lgcy_if_flg 값.
     * @return 없음
     * @author 공백진
     * @version 2009.06.12
     */
    function searchEndFontChange(sheetObj, sCols,lgcyIfFlg){
        var arrCols=sCols.split("|");
        var amdt_seq=document.form.amdt_seq.value;
        if(amdt_seq==0 || lgcyIfFlg == "Y"){
            return;
        }
        for(i=1 ; i <= sheetObj.LastRow(); i++){
        	if(sheetObj.GetCellValue(i, "amdt_seq") != amdt_seq){
        		ComSetRangeFont(sheetObj, "FontStrikethru", 1, i, 1, i, sheetObj.LastCol());
        		
                for (j=0; j < arrCols.length; j++){
                    sheetObj.SetCellEditable(i,arrCols[j],0);
                }
            } else if(sheetObj.GetCellValue(i,"n1st_cmnc_amdt_seq") == amdt_seq){
            	ComSetRangeFont(sheetObj, "FontColor","#FF0000", i, 1, i, sheetObj.LastCol());
            	if (sheetObj.GetCellValue(i, "src_info_cd") != "AD"){
                    for (j=0; j < arrCols.length; j++){
                        sheetObj.SetCellEditable(i,arrCols[j],1);
                    }
                }
            }
        }
    }
    /**
     * 주어진 조건에 맞는 row 에 대해서 특정 컬럼들을 일괄 업데이트 한다.
     * <br><b>Example :</b>
     * <pre>
     *     validRow = comChangeValue(sheetObj, "amdt_seq|svc_cp_cd", "1|TES", "prc_prog_sts_cd|src_info_cd", "I|NW");
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @param {string} colName 필수, 변경을 원하는 키 컬럼명(Savename). "|"로 연결한다.
     * @param {string} colValue 필수, 변경 대상의 데이터. "|"로 연결한다.
     * @param {string} conCol 필수, 조회조건이 되는 키 컬럼명(Savename). "|"로 연결한다.
     * @param {string} conVal 필수, 조회조건이 되는 데이터. "|"로 연결한다.
     * @return void
     * @author 변영주
     * @version 2009.05.20
     */
    function comChangeValue(sheetObj, colName, colValue, conCol, conVal) {
        if (sheetObj == null || colName == null || colName == "" || colValue == null || colValue == "" ) {
            return;
        }
        if (conCol == null || conCol == "" || conVal == null || conVal == "" ) {
            conCol="";
            conVal="";
        }
        var arrColName=colName.split("|");
        var arrColValue=colValue.split("|");
        var arrConCol=conCol.split("|");
        var arrConVal=conVal.split("|");
        var isValid=true;
        for (var i=sheetObj.HeaderRows(), n=sheetObj.LastRow(); i <= n; i++) {
            isValid=true;
            for (var j=0, m=arrConCol.length ; j < m ; j++) {
            	if (((arrConCol[j] == "ibflag") ? sheetObj.GetRowStatus(i) : sheetObj.GetCellValue(i, arrConCol[j])) != arrConVal[j]) {
                	isValid=false;
                    break;
                }
            }
            if (!isValid) {
                continue;
            } else {
                for (var k=0, l=arrColName.length ; k < l ; k++) {
                    if (arrColName[k] == "ibflag") {
                        sheetObj.SetRowStatus(i,arrColValue[k]);
                    } else {
                        sheetObj.SetCellValue(i, arrColName[k],arrColValue[k],0);
                    }
                }
            }
        }
    }
    /**
     * 팝업 가로 size를 IE 버전에 따라 조정한다. <br>
     * IE버전에 따라 팝업창 사이즈 계산방식이 달라 팝업 사이즈가 다르게 나오는 문제해결. <br>
     * parameter는 IE6에 맞는 width를 넘기면 IE버전에 따라 계산된 width를 리턴한다.
     * <br><b>Example :</b>
     * <pre>
     *     win = window.open('sample.jsp', 'sample', 'width='+getWidth(600)+'px');
     * </pre>
     * @param {int} wth 필수 IE6에 맞는 팝업 width
     * @return {int} IE버전에 맞는 팝업 width
     * @author 문동규
     * @version 2009.05.27
     */
    function getWidth(wth) {
        if (getIEVersion() == "IE7") {
            wth=Number(wth) - 2;
        }
        return wth;
    }
    /**
     * 팝업 세로 size를 IE 버전에 따라 조정한다. <br>
     * IE버전에 따라 팝업창 사이즈 계산방식이 달라 팝업 사이즈가 다르게 나오는 문제해결. <br>
     * parameter는 IE6에 맞는 height를 넘기면 IE버전에 따라 계산된 height를 리턴한다.
     * <br><b>Example :</b>
     * <pre>
     *     win = window.open('sample.jsp', 'sample', 'height='+getHeight(300)+'px');
     * </pre>
     * @param {int} hgt 필수 IE6에 맞는 팝업 height
     * @return {int} IE버전에 맞는 팝업 height
     * @author 문동규
     * @version 2009.05.27
     */
    function getHeight(hgt) {
        if (getIEVersion() == "IE7") {
            hgt=Number(hgt) - 50;
        }
        return hgt;
    }
    /**
     * Internet Explorer 버전을 가져온다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     iever = getIEVersion();
     * </pre>
     * @return {string} IE버전. default 는 "".
     *         IE6 : Internet Explorer 6.x
     *         IE7 : Internet Explorer 7.x 이상
     *         ""  : 그 외 버전
     * @author 문동규
     * @version 2009.05.27
     */
    function getIEVersion() {
        var iever="";
        if (navigator.appName.indexOf("Microsoft") > -1) { // IE?
            if (navigator.appVersion().indexOf("MSIE 6") > -1) { // IE6?
                iever="IE6";
            }
            else if (navigator.appVersion().indexOf((navigator.appVersion.indexOf( "MSIE 7") > -1))) { // IE7?
                iever="IE7";
            }
        }
        return iever;
    }
     /**
     * 대상 ROW 를 Amend 처리한다. <br>
     * sheetObj    : 처리 대상 sheet object
     * formObj     : 처리 대상 form object
     * sRow        : 처리 대상 Row
     * sAction     : M : Update Amend, D : Delete Amend
     * sCols       : n1st_cmnc_amdt_seq, src_info_cd, prc_prog_sts_cd 를 제외한 copy 대상 입력 column. "|"로 연결된 형태
     *          ex) comSheetAmendRow(sheetObjects[1],document.form,sheetObjects[1].SelectRow,"A", "loc_cd|ofc_cd");
     * @return {string}
     * @author 변영주
     * @version 2009.05.29
     */
    function comSheetAmendRow(sheetObj,formObj,sRow,sAction, sCols){
        var prop_no=formObj.prop_no.value;
        var amdt_seq=formObj.amdt_seq.value;
        var pre_amdt_seq=formObj.pre_amdt_seq.value;
        var eff_dt=formObj.eff_dt.value;
        var exp_dt=formObj.exp_dt.value;
        var pre_exp_dt=formObj.pre_exp_dt.value;
        var dur_dup_flg=formObj.dur_dup_flg.value;
        var arrCols=sCols.split("|");
        // chebox 를 이용할 경우 해당 chk 를 제거
        sheetObj.SetCellValue(sRow,"chk",0);
        // delete / modify Amend 중 이미 amend 된 과거 row 는 제외
        if(sheetObj.GetCellValue(sRow,"amdt_seq")!= amdt_seq || sheetObj.GetCellValue(sRow,"n1st_cmnc_amdt_seq")== amdt_seq){
            ComShowCodeMessage("PRI00313");
            return false;
        }
        // DataCopy/ Insert 기준 row 를 잡기 위해 sRow 설정
        sheetObj.SetSelectRow(sRow);
        var idx=sheetObj.DataCopy();     // 신규 row
        var idx2=idx-1;                  // 기존 row
        // A/M/D 공통 신규 row 생성
        sheetObj.SetCellValue(idx,"eff_dt",eff_dt,0);
        sheetObj.SetCellValue(idx,"n1st_cmnc_amdt_seq",amdt_seq,0);
        sheetObj.SetCellValue(idx,"prc_prog_sts_cd","I",0);
        sheetObj.SetCellValue(idx,"src_info_cd","AM",0);
        sheetObj.SetRowStatus(idx,"U");
        for(x=0;x<arrCols.length;x++){
            sheetObj.SetCellEditable(idx,arrCols[x],1);
        }
        
        ComSetRangeFont(sheetObj, "FontColor", "#FF0000", idx, 1, idx, sheetObj.LastCol());
        ComSetRangeFont(sheetObj, "FontStrikethru", 1, idx2, 1, idx2, sheetObj.LastCol());
        
        if(dur_dup_flg=="Y"){
            sheetObj.SetCellValue(idx2,"exp_dt",pre_exp_dt,0);
        }
        sheetObj.SetCellValue(idx2,"amdt_seq",pre_amdt_seq,0);
        sheetObj.SetRowEditable(idx2,0);
        // D, A 일 경우  신규 Row 를 update
        if(sAction=="D"){
            sheetObj.SetCellValue(idx,"src_info_cd","AD",0);
            for(z=0;z<arrCols.length;z++){
                sheetObj.SetCellEditable(idx,arrCols[z],0);
            }
        }
        sheetObj.SetRowStatus(idx2,"R");// 기존 Row 의 상태를 R로 변경해서 저장되지 않도록 함
        changeSelectBackColor(sheetObj, sheetObj.GetCellValue(idx, "n1st_cmnc_amdt_seq"), document.form.amdt_seq.value);
        return true;
    }
    /**
     * 대상 ROW 를 Amend Cancel 처리한다.
     * sheetObj    : 처리 대상 sheet object
     * formObj     : 처리 대상 form object
     * sRow        : 처리 대상 Row
     * sAction     : A : Insert Amend, M : Update Amend, D : Delete Amend
     * sCols       : n1st_cmnc_amdt_seq, src_info_cd, prc_prog_sts_cd 를 제외한 copy 대상 입력 column. "|"로 연결된 형태
     *           ex) comSheetAmendCancelRow(sheetObjects[1],document.form,sheetObjects[1].SelectRow,"A", "loc_cd|ofc_cd");
     * @return {string}
     * @author 변영주
     * @version 2009.05.29
     */
    function comSheetAmendCancelRow(sheetObj,formObj,sRow,sAction, sCols){
        var amdt_seq=formObj.amdt_seq.value;
        var eff_dt=formObj.eff_dt.value;
        var exp_dt=formObj.exp_dt.value;
        var arrCols=sCols.split("|");
        var pre_amdt_seq=formObj.pre_amdt_seq.value;
        var dur_dup_flg=formObj.dur_dup_flg.value;
        sheetObj.SetCellValue(sRow,"chk",0);
        //  A/M/D 동일하게 n1st_cmnc_amdt_seq == amdt_seq 일 경우에만 처리해줌
        if(sheetObj.GetCellValue(sRow,"n1st_cmnc_amdt_seq")!= amdt_seq || sheetObj.GetCellValue(sRow,"prc_prog_sts_cd")!= "I"){
            ComShowCodeMessage("PRI00313");
            return false;
        }
        var idx=sRow-1;
        var idx2=sRow;
        if(sAction=="A"&&(sheetObj.GetCellValue(sRow,"src_info_cd")=="NW"||sheetObj.GetCellValue(sRow,"src_info_cd")=="GM"||sheetObj.GetCellValue(sRow,"src_info_cd")=="GC")){
            sheetObj.SetRowStatus(sRow,"D");
            sheetObj.SetRowEditable(sRow,0);
            sheetObj.SetRowHidden(sRow,1);
            return false;
        }else{
        	if(sheetObj.GetCellValue(sRow,"src_info_cd")!="AD"&&sheetObj.GetCellValue(sRow,"src_info_cd")!="AM"){
                ComShowCodeMessage("PRI00313");
                return false;
            }
            if(dur_dup_flg=="Y"){
                sheetObj.SetCellValue(idx,"exp_dt",exp_dt,0);
            }
            ComSetRangeFont(sheetObj, "FontStrikethru", 0, idx, 1, idx, sheetObj.LastCol());
            ComSetRangeFont(sheetObj, "FontItalic", 0, idx, 1, idx, 1, idx, sheetObj.LastCol());

            sheetObj.SetCellValue(idx,"amdt_seq",sheetObj.GetCellValue(idx2,"amdt_seq"),0);
            sheetObj.SetRowEditable(idx,1);
            sheetObj.SetRowStatus(idx,"U");
            sheetObj.SelectCell(idx,"chk");
            sheetObj.RowDelete(idx2, false);
        }
        return true;
    }

    /**
     * sheet 에 대하여 check 된 Row 를 Accept 처리한다.
     * sheetObj    : 처리 대상 sheet object
     * formObj     : 처리 대상 form object
     * sUrl        : 처리 대상 Row
     * isAll       : 대상 Row 전체에 적용할 것인지 여부
     *           ex) comSheetAcceptCheckedRows(sheetObjects[1],document.form,"ESM_PRI_0003GS.do",true);
     * @return {string}
     * @author 변영주
     * @version 2009.05.29
     */
    function comSheetAcceptCheckedRows(sheetObj,formObj,sUrl, isAll){
        var amdt_seq=formObj.amdt_seq.value;
        var prop_sts_cd=formObj.prop_sts_cd.value;
        var eff_dt=formObj.eff_dt.value;
        if(isAll == undefined || isAll ==""){
            isAll=false;
        }
        if(prop_sts_cd == "R") {
            if(isAll){
                comChangeValue(sheetObj, "chk", "0");
                comChangeValue(sheetObj, "chk", "1", "n1st_cmnc_amdt_seq|prc_prog_sts_cd", amdt_seq+"|R");
                if(sheetObj.CheckedRows("chk") == 0) {
                    ComShowCodeMessage("PRI00301");
                    return false;
                }
            }
            var chkArr=ComPriSheetFilterRows(sheetObj, "chk", "1")
            if(chkArr.length == 0){
                sheetObj.SetCellValue(sheetObj.GetSelectRow(),"chk","1",0);
                chkArr[0]=sheetObj.GetSelectRow();
            }
            for(i=0;i<chkArr.length;i++){
            	if(sheetObj.GetCellValue(chkArr[i],"prc_prog_sts_cd")!="R" || sheetObj.GetCellValue(chkArr[i],"n1st_cmnc_amdt_seq")!=amdt_seq){
                    sheetObj.SetCellValue(chkArr[i],"chk","0",0);
                    ComShowCodeMessage("PRI00313");
                    return false;
                }
            }
            comChangeValue(sheetObj, "prc_prog_sts_cd|prc_prog_sts_dtl|ibflag", "A|Accepted|U", "chk", "1");
            var sParam=FormQueryString(formObj);
            var sParamSheet=sheetObj.GetSaveString(false, true, "chk");
            sParam=sParam + "&" + sParamSheet;
            var sXml=sheetObj.GetSaveData(sUrl, sParam);
            //sheetObj.LoadSaveData(sXml, false, "chk");	//check-ibleaders
            sheetObj.LoadSaveData(sXml);
            
            comChangeValue(sheetObj, "chk|ibflag", "0|R", "chk", "1");
        } else {
            if(isAll){
                comChangeValue(sheetObj, "chk", "0");
                comChangeValue(sheetObj, "chk", "1", "n1st_cmnc_amdt_seq|prc_prog_sts_cd", amdt_seq+"|I");
                if(sheetObj.CheckedRows("chk")==0){
                    //ComShowCodeMessage("PRI00301");
                    ComShowCodeMessage("PRI00329");
                    return false;
                }
            }
            var chkArr=ComPriSheetFilterRows(sheetObj, "chk", "1")
            if(chkArr.length == 0){
                sheetObj.SetCellValue(sheetObj.GetSelectRow(),"chk","1",0);
                chkArr[0]=sheetObj.GetSelectRow();
            }
            for(i=0;i<chkArr.length;i++){
            	if(sheetObj.GetCellValue(chkArr[i],"prc_prog_sts_cd")!="I"){
                    sheetObj.SetCellValue(chkArr[i],"chk","0",0);
                    ComShowCodeMessage("PRI01037");
                    return false;
                }
            	if(sheetObj.GetCellValue(chkArr[i],"n1st_cmnc_amdt_seq")!=amdt_seq){
                    sheetObj.SetCellValue(chkArr[i],"chk","0",0);
                    ComShowCodeMessage("PRI00313");
                    return false;
                }
            }
            comChangeValue(sheetObj, "prc_prog_sts_cd|prc_prog_sts_dtl|ibflag", "A|Accepted|U", "chk", "1");
            var sParam=FormQueryString(formObj);
            var sParamSheet=sheetObj.GetSaveString(false, true, "chk");
            sParam=sParam + "&" + sParamSheet;
            var sXml=sheetObj.GetSaveData(sUrl, sParam);
            //sheetObj.LoadSaveData(sXml, false, "chk");	//check-ibleaders
            sheetObj.LoadSaveData(sXml);
            comChangeValue(sheetObj, "chk|ibflag", "0|R", "chk", "1");
        }
        return true;
    }
    /**
     * sheet 에 대하여 check 된 Row 를 Accept Cancel 처리한다.
     * sheetObj    : 처리 대상 sheet object
     * formObj     : 처리 대상 form object
     * sUrl        : 처리 대상 Row
     * isAll       : 대상 Row 전체에 적용할 것인지 여부
     *           ex) comSheetAcceptCancelCheckedRows(sheetObjects[1],document.form,"ESM_PRI_0003GS.do",true);
     * @return {string}
     * @author 변영주
     * @version 2009.05.29
     */
    function comSheetAcceptCancelCheckedRows(sheetObj,formObj,sUrl,isAll){
        var eff_dt=formObj.eff_dt.value;
        var amdt_seq=formObj.amdt_seq.value;
        if(isAll == undefined || isAll ==""){
            isAll=false;
        }
        if(isAll){
            comChangeValue(sheetObj, "chk", "0");
            comChangeValue(sheetObj, "chk", "1", "n1st_cmnc_amdt_seq|prc_prog_sts_cd", amdt_seq+"|A");
            if(sheetObj.CheckedRows("chk")==0){
                ComShowCodeMessage("PRI00301");
                return false;
            }
        }
        var chkArr=ComPriSheetFilterRows(sheetObj, "chk", "1")
        if(chkArr.length == 0){
            sheetObj.SetCellValue(sheetObj.GetSelectRow(),"chk","1",0);
            chkArr[0]=sheetObj.GetSelectRow();
        }
        for(i=0;i<chkArr.length;i++){
        	if(sheetObj.GetCellValue(chkArr[i],"prc_prog_sts_cd")!="A" || sheetObj.GetCellValue(chkArr[i],"n1st_cmnc_amdt_seq")!=amdt_seq){
                sheetObj.SetCellValue(chkArr[i],"chk","0",0);
                ComShowCodeMessage("PRI00313");
                return false;
            }
        }
        comChangeValue(sheetObj, "prc_prog_sts_cd|prc_prog_sts_dtl|ibflag", "I|Initial|U", "chk", "1");
        var sParam=FormQueryString(formObj);
        var sParamSheet=sheetObj.GetSaveString(false, true, "chk");
        sParam=sParam + "&" + sParamSheet;
        var sXml=sheetObj.GetSaveData(sUrl, sParam);
        //sheetObj.LoadSaveData(sXml, false, "chk");	//check-ibleaders
        sheetObj.LoadSaveData(sXml);
        comChangeValue(sheetObj, "chk|ibflag", "0|R", "chk", "1");
        return true;
    }
    /**
     * IE 버전별 팝업사이즈를 조절하기위한 함수. 사이즈를 조절한 후에 ComOpenWindowCenter 공통함수를 호출한다.<br>
     * <br>
     * <b>Example :</b>
     *
     * <pre>
     * ComPriOpenWindowCenter(&quot;ESM_PRI_0001.do&quot;, &quot;ESD_TPB_911&quot;, 755, 460);
     * ComPriOpenWindowCenter(&quot;ESM_PRI_0001.do&quot;, null, 755, 460);
     * pWin = ComPriOpenWindowCenter(&quot;ESM_PRI_0001.do&quot;, null, 755, 460); //pWin은 팝업창 window object이다.
     * </pre>
     *
     * @param {string}
     *            sUrl 선택,팝업창의 Url, default="about:blank"
     * @param {string}
     *            sWinName 선택,팝업창의 name 또는 dialogArguments, default=null
     * @param {string}
     *            iWidth 선택,팝업창의 넓이로 픽셀단위이며 최소100이상 설정
     * @param {string}
     *            iHeight 선택,IE7 이상에서 팝업창의 높이로 픽셀단위이며 최소100이상 설정
     * @param {bool}
     *            bModal 선택,팝업의 Modal 여부 (true:Modal, false:일반팝업), default=false
     * @param {String}
     *            sScroll 선택, 스크롤바 생성 여부 (no | yes), default=no
     * @returns object<br>
     *          bModal=false로 오픈된 경우 리턴값 : 팝업창의 window Object bModal=true로 오픈된 경우
     *          리턴값 : 팝업창의 window.returnValue값
     * @see #ComOpenWindow
     */
    function ComPriOpenWindowCenter(sUrl,sWinName,iWidth,iHeight, bModal, sScroll) {
        if (iHeight != null) {
            var idx=window.navigator.userAgent.indexOf("MSIE");
            if (idx != -1 && bModal == true && parseInt(window.navigator.userAgent.charAt(idx + 5)) < 7) {
                iHeight += IE6_ADD_HEIGHT;
                // 하단 status 부분
                iHeight += IE6_ADD_STATUS_HEIGHT;
                // Thema 차이에 의한 크기 감안
                iHeight += IE6_ADD_THEMA_HEIGHT;
            }
        }
        return ComOpenWindowCenter(sUrl,sWinName,iWidth,iHeight, bModal, sScroll);
    }
    /**
     * IE 버전별 팝업사이즈를 조절하기위한 함수. 사이즈를 조절한 후에 ComOpenWindow 공통함수를 호출한다.<br>
     * height를 별도로 지정하므로 option값에서 height는 제외해야 한다.
     * <br>
     * <b>Example :</b>
     *
     * <pre>
     * ComPriOpenWindow(
     *      &quot;ESM_PRI_0001.do&quot;,
     *      &quot;ESM_PRI_0001&quot;,
     *      &quot;toolbar=no,location=no,status=no,menubar=no,scrollbars=auto,resizable=no,alwaysRaised,dependent,titlebar=no,width=755,height=460&quot;);
     * ComPriOpenWindow(&quot;ESM_PRI_0001.do&quot;, null, &quot;width=755,height=460&quot;);
     * pWin = ComPriOpenWindow(&quot;ESM_PRI_0001.do&quot;, null, &quot;width=755,height=460&quot;); //pWin은 팝업창 window object이다.
     * </pre>
     *
     * @param {string}
     *            sUrl 선택,팝업창의 Url, default="about:blank"
     * @param {string}
     *            sWinName 선택,팝업창의 name 또는 dialogArguments, default=null
     * @param {string}
     *            sFeatures 선택,height를 제외한 팝업창의 세부 설정, default=""
     * @param {string}
     *            iHeight 선택,IE7 이상에서 팝업창의 높이로 픽셀단위이며 최소100이상 설정.
     * @param {bool}
     *            bModal 선택,팝업의 Modal 여부 (true:Modal, false:일반팝업), default=false
     * @returns object<br>
     *          bModal=false로 오픈된 경우 리턴값 : 팝업창의 window Object bModal=true로 오픈된 경우
     *          리턴값 : 팝업창의 window.returnValue값
     * @see #ComOpenWindow
     */
    function ComPriOpenWindow(sUrl, sWinName, sFeatures, iHeight, bModal) {
        if (iHeight != null) {
            var idx=window.navigator.userAgent.indexOf("MSIE");
            if (idx != -1 && bModal == true && parseInt(window.navigator.userAgent.charAt(idx + 5)) < 7) {
                iHeight += IE6_ADD_HEIGHT;
                // 하단 status 부분
                iHeight += IE6_ADD_STATUS_HEIGHT;
                // Thema 차이에 의한 크기 감안
                iHeight += IE6_ADD_THEMA_HEIGHT;
            }
            if (bModal) {
                if (sFeatures == null || sFeatures == "") {
                    sFeatures="dialogHeight:" + iHeight;
                } else {
                    sFeatures += "; dialogHeight:" + iHeight + ";";
                }
            } else {
                if (sFeatures == null || sFeatures == "") {
                    sFeatures="height=" + iHeight;
                } else {
                    sFeatures += ", height=" + iHeight
                }
            }
        }
        return ComOpenWindow(sUrl, sWinName, sFeatures, bModal);
    }
    /**
     * 공통 팝업창 호출하고, 팝업창에서 마지막 처리는 부모페이지(opener)의 특정함수를 호출하도록 지정한다. <br>
     * 부모페이지(opener)의 특정함수는 첫번째 인자는 팝업창에서 선택된 데이터의 배열이다. <br>
     * bModal 인자값에 따라 팝업창이 Modal 인지 Modaless(일반팝업) 인지 선택하며
     * {@link #ComOpenWindowCenter} 함수를 이용한다. <br>
     * 부모창(opener)의 Sheet의 특정 Cell에서 공통 팝업을 호출하는 경우 iRow, iCol, iSheetIdx 인자를 설정하여
     * 호출한다. <br>
     * 1) iRow, iCol 인자 : 해당 Cell 정보(row, col)로 팝업URL에 "&row=iRow인자값&col=iCol인자값"으로
     * 전달된다. <br>
     * 2) iSheetIdx 인자 : Sheet의 sheetObjects 배열 Index로 팝업URL에
     * "&sheetIdx=iSheetIdx인자값"으로 전달된다. <br>
     * 인자를 설정하면 url에 다음 querystring이 추가되어 조회된다. <br>
     * url?pop_mode=1&display=sDisplay인자값&func=sFunc
     * 인자값&sheet=2&row=iRow인자값&col=iCol인자값&sheetIdx=iSheetIdx인자값 <br>
     * row와 col인자를 설정하여 호출하는 경우 부모페이지(opener)의 특정함수는 첫번째 인자는 팝업창에서 선택된 데이터의 배열이고,
     * 2번째인자는 row, 3번째 인자는 col, 4번째 인자는 sheetIdx이다. <br>
     * <b>Example :</b>
     * 
     * <pre>
     *     //Modaless(일반팝업)로 팝업이 표시되고, 팝업이 닫힐때 부모(opener)의 getVVD 함수를 호출한다.
     *     ComOpenPopup('/opuscntr/COM_ENS_0B2.do?sdate=20080901&amp;edate=20081231', 770, 470, 'getVVD', '1,0,1,1,1,1,1,1');
     *     function getVVD(aryPopupData)
     *     //부모창(opener)의 sheetObjects[0] Sheet의 Cell(3,10)에서 팝업을 열었다. Modal로 팝업을 표시하고, 팝업이 닫힐때 부모(opener)의 setCntInfoInSheet함수를 호출한다.
     *     ComOpenPopup('/opuscntr/COM_ENS_0M1.do?cnt_cd=123&amp;classId=cls', 565, 480, 'setCntInfoInSheet', &quot;1,0,1,1,1,1,1&quot;, true, false, 3, 10, 0);
     *     function setCntInfoInSheet(aryPopupData, row, col, sheetIdx)
     * </pre>
     * 
     * @param {string}
     *            sUrl 필수,호출될 팝업 주소
     * @param {int}
     *            iWidth 필수,팝업 창의 넓이
     * @param {int}
     *            iHeight 필수,팝업 창의 높이
     * @param {string}
     *            sFunc 필수,팝업에서 최종 확인을 했을때 데이터를 받을 부모창(opener)의 자바스크립트 함수명
     * @param {string}
     *            sDisplay 필수,팝업창에 있는 그리드의 컬럼 히든여부 설정(1:보임, 0:숨김)
     * @param {bool}
     *            bModal 선택,팝업의 Modal 여부 (true:Modal, false:일반팝업), default=false
     * @param {bool}
     *            b2ndSheet 선택,Sheet 2개인 팝업 오픈시 true 1개인 팝업 오픈시 false, default=false
     * @param {int}
     *            iRow 선택,Sheet의 Cell의 Row Index
     * @param {int}
     *            iCol 선택,Sheet의 Cell의 Col Index
     * @param {int}
     *            iSheetIdx 선택,Sheet의 sheetObjects 배열 Index
     * @param {string}
     *            sWinName 선택,팝업창의 name 또는 dialogArguments, default=compopup
     * @param {String}
     *            sScroll 선택, 스크롤바 생성 여부 (no | yes), default=no
     * @returns object<br>
     *          bModal=false로 오픈된 경우 리턴값 : 팝업창의 window Object bModal=true로 오픈된 경우
     *          리턴값 : 팝업창의 window.returnValue값
     * @see #ComOpenWindowCenter
     * @see #ComOpenPopupWithTarget
     */
    function ComPriOpenPopup(sUrl, iWidth, iHeight, sFunc, sDisplay, bModal,
    		 b2ndSheet, iRow, iCol, iSheetIdx, sWinName, sScroll) {
        if (iHeight != null) {
            var idx=window.navigator.userAgent.indexOf("MSIE");
            if (idx != -1 && bModal == true && parseInt(window.navigator.userAgent.charAt(idx + 5)) < 7) {
                iHeight += IE6_ADD_HEIGHT;
                // 하단 status 부분
                iHeight += IE6_ADD_STATUS_HEIGHT;
                // Thema 차이에 의한 크기 감안
                iHeight += IE6_ADD_THEMA_HEIGHT;
            }
        }
        return ComOpenPopup(sUrl, iWidth, iHeight, sFunc, sDisplay, bModal,
       		 b2ndSheet, iRow, iCol, iSheetIdx, sWinName, sScroll);
     }
    /**
     * <form>에 Radio Button을 value의 값으로 check해주는 메소드.
     *
     * 사용 예 )
     * ComPriCheckRadioButton(formObj.loc_type,arrParams["loc_type"]);
     *
     * radioObj    : 처리 대상 Radio Object
     * value  : check를 하고자 하는 value
     *
     * @author 송민석
     * @version 2009.07.10
     */
    function ComPriCheckRadioButton(radioObj,value){
    	ComSetObjValue(radioObj,value);
    }
    /**
     * <form>에 Radio Button의 check된 value를 return
     *
     * 사용 예 )
     * var value = ComPriCheckRadioButton(formObj.loc_type);
     *
     * @param radioObj    : 처리 대상 Radio Object
     * @return  : check된 value
     *
     * @author 송민석
     * @version 2009.07.10
     */
    function ComPriGetCheckedRadioButtonValue(radioObj){
    	return ComGetObjValue(radioObj);
    }
    /**
     * 버튼이 3개인 MsgBox를 보여주고 '예(Yes)'일경우 sheet의 SpeedDown2Excel을 실행하고
     * '아니오(No)'일경우 Down2Excel을 실행해 format이 있는 Excel을 Download한다.
     * '취소(Cancel)'일경우 아무 동작하지 않는다.
     * 사용 예 )
     * ComPriShowDialogExcel(sheetObject1,ComGetMsg("PRI03002"));
     *
     * sheetObj    : Excel로 Download하고자 하는 sheet
     * msgStr  : 보여주고자 하는 메시지
     *
     * @author 송민석
     * @version 2009.08.06
     */
    function ComPriShowDialogExcel(sheetObj,msgStr){
       if(sheetObj.RowCount()== 0 ) return;
       if (ComShowConfirm(msgStr)){
    	   sheetObj.Down2Excel({ HiddenColumn:-1});
       } else if (rtn == 7) {
    	   sheetObj.Down2Excel({ HiddenColumn:-1,Merge:true});
       }
    }
    /**
     * 화면 로딩시 가져온 데이터를 IBMultiCombo의 item으로 insert 해준다.<br>
     * <b>Example :</b>
     *
     * <pre>
     * ComPriTxt2ComboItem(xmlStr, combo1, &quot;cd&quot;, &quot;nm&quot;);
     *
     * </pre>
     *
     * @param {string} txtStr 필수 Combo item으로 사용할 데이터. code
     * @param {object} cmbObj 필수 insert하고자 하는 IBMultiCombo Object.
     * @param {string} codeCol 필수 Combo의 Code컬럼명.
     * @param {string} textCol 필수 Combo의 Text컬럼명. 다수일 경우 '|' 로 연결
     * @param {string} dim1 선택 Combo item의 code와 name을 구분하는 delimiter.
     *                           default : "Φ"
     *                           "" : "Φ"
     *                           그외 : 해당값
     * @param {string} dim2 선택 Combo item을 구분하는 delimiter.
     *                           default : "Ω"
     *                           "" : "Ω"
     *                           그외 : 해당값
     * @return 없음.
     * @author 문동규
     * @version 2009.07.17
     */
    function ComPriTxt2ComboItem(txtStr, cmbObj, codeCol, textCol, dim1, dim2) {
        if (txtStr == null || txtStr == "" || cmbObj == null || cmbObj == "")  return;
        if (codeCol == null || codeCol == "" || textCol == null || textCol == "")  return;

        try {
            cmbObj.RemoveAll();
            if (dim1 == null || dim1 == "")  dim1="Φ";
            if (dim2 == null || dim2 == "")  dim2="Ω";

            var arr=txtStr.split("Φ");
            var item;
            for (var i=0, n=arr.length ; i < n ; i++) {
                if (arr[i].length == 2) {
                    item=arr[i].split("Ω");
                    cmbObj.InsertItem(-1, item[0], item[1]);
                }
            }
        } catch (err) {
            ComFuncErrMsg(err.message);
        }
    }
    /**
     * ComboObjects Array에서 Object ID로 Combo Object를 가져온다.<br>
     * <b>Example :</b>
     * <pre>
     * comboObj = getComboObject(comboObjects, "combo1");
     * </pre>
     *
     * @param {array} comboObjs 필수 ComboObject 배열
     * @param {string} objId 필수 해당 ComboObject의 id
     * @return {object} comboObject 해당 ComboObject
     * @author 문동규
     * @version 2009.07.17
     */
    function getComboObject(comboObjs, objId) {
        if (comboObjs != null) {
            for (var i=0, n=comboObjs.length ; i < n ; i++) {
                if (comboObjs[i].options.id == objId) {
                    return comboObjs[i];
                }
            }
        }
        return null;
    }
    /**
     * Oracle의 NVL 함수와 같이 변수의 값이 null일경우 대치할수 있는 값을 return한다.
     *
     * <pre>
     * var v = "";
     * comboObj = ComPriNvl(v, "NULL");
     * </pre>
     *
     * @param {string} value
     * @param {string} repValue
     * @return {object} comboObject 해당 ComboObject
     * @author 송민석
     * @version 2009.07.27
     */
    function ComPriNvl(value,repValue){
        if(value == ""){
            return repValue;
        }
        return value;
    }
    /**
     *   jsp에서 페이지 최초 로딩시 아래와 같이 combo를 위한 값을 구성하고 script에서 multi combo에 값을 assign 하고자 할경우
     *   그 값을 파싱해 multi combo에 assign 해준다.
     *   JSP의 Value 예시)
     *    var appOfcCdComboText = "HAMUR  EUROPE REGIONAL HEADQUARTERS|NYCNA  AMERICA REGIONAL HEADQUARTERS|SAOBB San Paulo Branch Office|SELSKM  KEY ACCOUNT GROUP|SELSTA    Trans-pacific Trade Group|SELSTE    European Trade Group|SELSTI Intra-Asia Trade Group|SHAAS    ASIA REGIONAL HEADQUARTERS";
     *    var appOfcCdComboValue = "HAMUR|NYCNA|SAOBB|SELSKM|SELSTA|SELSTE|SELSTI|SHAAS";
     *
     *    var profitViewComboText = "Trade Profit|Office Profit";
     *    var profitViewComboValue = "P|R";
     *  사용 예시
     * <pre>
     *    ComPriTextCode2ComboItem(appOfcCdComboValue,appOfcCdComboText, formObj.frm_svc_scp_cd ,"|","\t" );
     *    ComPriTextCode2ComboItem(profitViewComboValue,profitViewComboText, formObj.prop_apro_ofc_cd);
     * </pre>
     *
     * @param {string} codeStr MultiCombo에 assign될 rowSeparator(아래 예제에서는 '|')로 구분된 Code String
     *                 <BR> 예) "HAMUR|NYCNA|SAOBB|SELSKM|SELSTA|SELSTE|SELSTI|SHAAS";
     * @param {string} textStr MultiCombo에 assign될 rowSeparator과 colSeparator로 구분된 Text String
     *                 <BR> combo를 다중컬럼으로 보여줄경우 colSeparator로 구분해서 값을 구성한다.
     *                 <BR> 예) 1. 하나의 컬럼일경우 textStr값
     *                            "Trade Profit|Office Profit";
     *                 <BR>     2. 다중컬럼으로 구성했을경우 textStr값
     *                 <BR>       이때의 rowSeparator는 '|'이되고 colSeparator는 '\t"가 된다.
     *                              "HAMUR    EUROPE REGIONAL HEADQUARTERS|NYCNA  AMERICA REGIONAL HEADQUARTERS|SAOBB San Paulo Branch Office|SELSKM  KEY ACCOUNT GROUP|SELSTA    Trans-pacific Trade Group|SELSTE    European Trade Group|SELSTI Intra-Asia Trade Group|SHAAS    ASIA REGIONAL HEADQUARTERS";
     *
     * @param {object} cmbObj 해당 ComboObject
     * @param (stirng) rowSeparator code,text에서 공통으로 쓰이는 구분자로 combo의 row를 구분하는 구분자 default : '|'
     * @param (stirng) colSeparator combo의 text에서만 사용하는 구분자로 다중컬럼을 보여줄때 각 컬럼의 값을 구분하는 구분자다 default : '\t'
     * @param (stirng) showCellIdx  textStr의 값은 colSeparator로 구분된 여러 값이 들어 있으나 다중컬럼으로 보여주지 않고
     *                 <BR>  showCellIdx번째 cell을 보여주고자 할때 사용한다., 0부터 시작,  default : 넘어온 textStr의 컬럼 갯수만큼 컬럼을 보여줌
     * @author 송민석
     * @version 2009.08.14
     */
    function ComPriTextCode2ComboItem(codeStr,textStr, cmbObj,rowSeparator,colSeparator,showCellIdx ){
        if( rowSeparator  == undefined ){
            rowSeparator="|"
        }
        if( colSeparator  == undefined ){
            colSeparator="\t"
        }
        var isSplit=true;
        var isShowSpclCol=false;
        var arrCode=codeStr.split(rowSeparator);
        var arrText=textStr.split(rowSeparator);
        if( colSeparator == "|"){
            isSplit=false;
        }
        if( showCellIdx != undefined && ( ComIsNumber(showCellIdx) ||  showCellIdx == "0")
                && showCellIdx < (arrText[0].split(colSeparator)).length ){
            isShowSpclCol=true;
        }
        for(var idx=0;idx < arrCode.length; idx++ ){
            var text=arrText[idx];
            //특정 Text값을 보여준다.
            if( isShowSpclCol ){
                text=text.split(colSeparator)[showCellIdx];
            }else if( isSplit ){
                    text=text.replace(colSeparator,"|");
            }
            cmbObj.InsertItem(-1, text, arrCode[idx]);
        }
    }
    /**
     *   image button 또는 table로 만든 버튼의 활성화 비활성화 여부를 return한다.
     *
     * <pre>
     *    if( !ComPriGetButtonStatus(window.event.srcElement) ){
     *        return false;
     *    }
     *
     * </pre>
     *
     * @param {object} obj 필수, 검사하고자 하는 Button Object
     * @return boolean, true : 버튼이 활성화 돼 있음. false : 버튼이 비활성화 돼 있음.
     * @author 송민석
     * @version 2009.11.11
     */
    function ComPriGetButtonStatus(obj){
    	return !obj.disabled;
    }
    /**
     * StringBuffer 기능을 스크립트로 구현함. <br>
     * <br><b>Example :</b>
     * <pre>
     *     sbStr = new StringBuffer();  // 선언
     *     sbStr.append("Sample");      // append
     *     sbStr.toString();            // 문자열로 변환
     * </pre>
     * @return 없음
     * @author 문동규
     * @version 2009.06.26
     */
    function StringBuffer(){
        this.buffer=[];
    }
    StringBuffer.prototype.append=function append(str){
        this.buffer.push(str);
        return this;
    }
    StringBuffer.prototype.toString=function toString(){
        return this.buffer.join("");
    }
    /**
     * sheet에서 delete된 로우가 있는지 체크한다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     isDeleted(sheetObj)
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @return bool <br>
     *          true  :  delete된 로우가 있는 경우<br>
     *          false :  delete된 로우가 없는 경우
     * @author 이승준
     * @version 2009.04.17
     */
    function isDeleted(sheetObj) {
        var isDeleted=false;
        for(var i=1; i<=sheetObj.RowCount(); i++) {
        	if(sheetObj.GetRowStatus(i) == "D") {
                isDeleted=true;
                break;
            }
        }
        return isDeleted;
    }
    var baseSelectBackColor=null; // 기존 Highlight 색
    var newSelectBackColor=null;  // 변경된 Highlight 색
    /**
     * Highlight 변경시 사용하는 색상값을 가져온다.<br>
     * <b>Example :</b>
     * <pre>
     *     color = getPriHighlightColor(sheetObj, "basic");
     * </pre>
     *
     * @param {sheet} sheetObj 필수, SheetObject
     * @param {string} type 필수, 색상종류. basic:기존 Highlight 색 new:변경된 Highlight 색
     * @return number, 해당 색상값
     * @author 문동규
     * @version 2010.01.07
     */
    function getPriHighlightColor(sheetObj, type) {
        if (type == "basic") {
            return "#6db3fe";
        } else if (type == "new") {
            return "#FFFFCC";  // 변경된 Highlight 색
        } else {
        }
    }
    /**
     * Amend Row의 Highlight 색상을 다르게 표시한다.<br>
     * <b>Example :</b>
     * <pre>
     *     changeSelectBackColor(sheetObj, source, target);
     * </pre>
     *
     * @param {sheet} sheetObj 필수, SheetObject
     * @param {string} source 필수, 색상변경 기준이 되는 데이터
     * @param {string} target 필수, 색상변경 기준과 비교하는 데이터
     * @return 없음
     * @author 문동규
     * @version 2009.11.13
     */
    function changeSelectBackColor(sheetObj, source, target) {
        if (baseSelectBackColor == null) {
            baseSelectBackColor = getPriHighlightColor(sheetObj, "basic");
        }
        if (newSelectBackColor == null) {
            newSelectBackColor = getPriHighlightColor(sheetObj, "new");
        }
        var lgcyIfFlg=null;
        if (document.form.lgcy_if_flg == null) {
            lgcyIfFlg="N";
        } else {
            lgcyIfFlg=document.form.lgcy_if_flg.value;
        }
        lgcyIfFlg="N"; // OPUS에서는 모든 데이터가 N이다
        
        if (Number(target) > 0 && source == target && lgcyIfFlg == "N") {
            if (sheetObj.GetRowBackColor(sheetObj.GetSelectRow()) != newSelectBackColor) {
            	sheetObj.SetRowBackColor( sheetObj.GetSelectRow() , newSelectBackColor );
            }
        } else {
        	if (sheetObj.GetRowBackColor(sheetObj.GetSelectRow()) != newSelectBackColor) {
            	sheetObj.SetRowBackColor( sheetObj.GetSelectRow() , baseSelectBackColor );
            }
        }
    }
    /**
     * Amend Row의 Highlight 색상을 다르게 표시한다.<br>
     * Rate용 버전입니다. 물론 다른 화면에서도 쓸 수 있습니다.<br>
     * 선택된 Row의 RowFontColor나 CellFontColor Property를 읽어 색상을 변경합니다.<br>
     * <b>Example :</b>
     * <pre>
     *     changeSelectBackColor4Rate(sheetObj);
     * </pre>
     *
     * @param {sheet} sheetObj 필수, SheetObject
     * @return 없음
     * @author 박성수
     * @version 2009.12.31
     */
    function changeSelectBackColor4Rate(sheetObj) {
        if (baseSelectBackColor == null) {
            baseSelectBackColor = getPriHighlightColor(sheetObj, "basic");
        }
        if (newSelectBackColor == null) {
            newSelectBackColor = getPriHighlightColor(sheetObj, "new");
        }

        if (sheetObj.GetRowFontColor(sheetObj.GetSelectRow()) != 0 || sheetObj.GetCellFontColor(sheetObj.GetSelectRow(), 1) != 0) {
        	sheetObj.SetRowBackColor( sheetObj.GetSelectRow() , newSelectBackColor );
        } else {
        	sheetObj.SetRowBackColor( sheetObj.GetSelectRow() , baseSelectBackColor );
        }
    }
    /**
     * Amend Row의 Highlight 색상을 다르게 표시한다.<br>
     * Master / Detail 화면에서 Master에 적용할때 사용한다. <br>
     * 선택된 Row의 RowFontColor나 CellFontColor Property를 읽어 색상을 변경합니다.<br>
     * <b>Example :</b>
     * <pre>
     *     changeSelectBackColor4Master(sheetObj, formObj);
     * </pre>
     *
     * @param {sheet} sheetObj 필수, SheetObject
     * @param {form}  formobj   필수,html의 Form 오브젝트 Name
     * @return 없음
     * @author 최성민
     * @version 2009.12.31
     */
    function changeSelectBackColor4Master(sheetObj, formObj) {
        var amdtSeq=formObj.amdt_seq.value;
        if (baseSelectBackColor == null) {
            baseSelectBackColor = getPriHighlightColor(sheetObj, "basic");
        }
        if (newSelectBackColor == null) {
            newSelectBackColor = getPriHighlightColor(sheetObj, "new");
        }

        if (sheetObj.GetRowFontColor(sheetObj.GetSelectRow()) != 0 || sheetObj.GetCellFontColor(sheetObj.GetSelectRow(), 1) != 0
|| (amdtSeq > 0 && sheetObj.GetRowStatus(sheetObj.GetSelectRow()) == "I")){
        	sheetObj.SetRowBackColor( sheetObj.GetSelectRow() , newSelectBackColor );
        } else {
        	sheetObj.SetRowBackColor( sheetObj.GetSelectRow() , baseSelectBackColor );
        }
    }
    /**
     * Amend Row의 Highlight 색상을 다르게 표시한다. S/C, RFA 메인에서 사용한다.<br>
     * <b>Example :</b>
     * <pre>
     *     changeSelectBackColor4Main(sheetObj);
     * </pre>
     *
     * @param {sheet} sheetObj 필수, SheetObject
     * @return 없음
     * @author 공백진
     * @version 2009.11.13
     */
    function changeSelectBackColor4Main(sheetObj) {
//    	var lgcyIfFlg=sheetObjects[0].GetCellValue(1, "lgcy_if_flg");
//        lgcyIfFlg="N"; // OPUS에서는 모든 데이터가 N이다
//        if (baseSelectBackColor == null) {
//            baseSelectBackColor = getPriHighlightColor(sheetObj, "basic");
//        }
//        if (newSelectBackColor == null) {
//            newSelectBackColor = getPriHighlightColor(sheetObj, "new");
//        }
//        var amdtSeq=document.form.amdt_seq.value;
//
//        if (sheetObj.GetRowFontColor(sheetObj.GetSelectRow()) != 0 || sheetObj.GetCellFontColor(sheetObj.GetSelectRow(), 1) != 0
//|| (amdtSeq > 0 && sheetObj.GetRowStatus(sheetObj.GetSelectRow()) == "I") && lgcyIfFlg == "N"){
//            sheetObj.SetRowBackColor( sheetObj.GetSelectRow() , newSelectBackColor );
//        } else {
//        	sheetObj.SetRowBackColor( sheetObj.GetSelectRow() , baseSelectBackColor );
//        }
    }
    /////////////////////////////////////////////////////////////////////////////////////////////////////////////
    /**
     * Sheet의 특정행의 값을 Form의 각 컨트롤에 값을 복사한다. <br>
     * <br><b>Example :</b>
     * <pre>
     *     IBS_CopyRowToForm(mySheet, document.mainForm);
     *     IBS_CopyRowToForm(mySheet, document.mainForm, mySheet.SelectedRow);
     *     IBS_CopyRowToForm(mySheet, document.mainForm, 1, "str_");
     *
     *     &lt;script for="mySheet" event="OnSelectCell(or,oc,nr,nc)"&gt;
     *       if(nr &lt; HeaderRows || nr &gt; LastRow||RowCount  == 0) return mainForm.reset();
     *       if(or==nr) return;
     *
     *       IBS_CopyRowToForm(mySheet, mainForm);
     *     &lt;/script&gt;
     * </pre>
     * @param   {ibsheet} sheetobj  필수,IBSheet Object ID
     * @param   {form}    formobj   필수,html의 Form 오브젝트 Name
     * @param   {int}     row       선택,IBSheet의 복사할 행번호, 인자를 설정하지 않으면 현재 선택된 행이 됨
     * @param   {string}  prefix    선택,Form 안에 있는 컨트롤의 이름앞에 붙는 문자열, 예)"obj_CardNo"이면 이인자는 "obj_"임, 인자를 설정하지 않으면 "frm_"가 기본임
     * @return  없음
     * @version 2009.11.27
     */
    function ComPriCopyRowToForm(sheetobj, formobj, row, prefix){
        //함수의 인자 유효성 확인-시작
    	if ((!sheetobj) || (!sheetobj.IBSheetVersion)) {
            return ComFuncErrMsg("sheetobj 인자는 IBSheet 태그가 아닙니다.");
        } else if (formobj==null || typeof formobj != "object" || formobj.tagName != "FORM") {
            return ComFuncErrMsg(" formobj 인자는 FORM 태그가 아닙니다.");
        } else if (row!=null && (isNaN(row) || row < 0 || row > sheetobj.LastRow())) {
            return ComFuncErrMsg("row 인자값이 잘못되었습니다.");
        }
        //함수의 인자 유효성 확인-종료
        // HTML컨트롤의 name 앞에 붙는 글자
        if (prefix == null) prefix="";
        if (row == null) row=sheetobj.GetSelectRow();
        // Sheet의 컬럼개수만큼 찾아서 HTML의 Form 각 Control에 값을 설정한다.
        // 컬럼개수만큼 루프 실행
        for(var col=0;col<=sheetobj.LastCol();col++){
            //컬럼의 별명을 문자열로 가져온다.
            var col_alias=sheetobj.ColSaveName(col)
            if (col_alias=="") continue;
            var sheetvalue=sheetobj.GetCellValue(row,col);
            // 폼에 있는 해당 이름의 컨트롤을 가져온다.예)"frm_CardNo"
            var frmchild=formobj.elements(prefix +col_alias);
            // 폼에 해당하는 이름의 컨트롤이 없는 경우는 계속 진행한다.
            if(frmchild==null) continue;
            var sType=frmchild.type;
            // radio의 경우 frmchild가 배열형태가 되므로, frmchild.type으로는 타입을 알수 없다.
            if (sType==undefined && frmchild.length>0) sType=frmchild[0].type;
            // 타입별로 값을 설정한다.
            switch(sType) {
                case "button":
                case "reset":
                case "submit":
                    break;
                case "radio":
                    for (idx=0; idx<frmchild.length; idx++) {
                        if(frmchild[idx].value == sheetvalue) {
                            frmchild[idx].checked=true;
                            break;
                        }
                    }
                    break;
                case "checkbox":
                    frmchild.checked=(sheetvalue==1);
                    break;
                default :
                    frmchild.value=sheetvalue;
            }//end of switch
        }//end of for(col)
    }
    /**
     * 주어진 컬럼의 값과 일치하는 row를 리턴한다.
     * 없으면 -1을 리턴한다.
     * <br><b>Example :</b>
     * <pre>
     *     validRow = ComGetValidRow(sheetObj, "cmdt_seq", "5");
     * </pre>
     * @param {ibsheet} sheetObj 필수 IBSheet Object
     * @param {string} colName 필수, 조회조건이 되는 키 컬럼명(Savename).
     * @param {string} colValue 필수, 찾고자 하는 값.
     * @return int
     * @author 이승준
     * @version 2009.12.22
     */
    function ComGetValidRow(sheetObj, colName, colValue) {
        if (sheetObj == null || colName == null || colName == "")  return -1;
        
        var row=-1;
        for (var i=sheetObj.LastRow(); i >= 0; i--) {
        	if(sheetObj.GetCellValue(i,colName) == colValue) {
                row=i;
                break;
            }
        }
        return row;
    }
    /**
     * com.clt.syscommon.common.util.ScheduleUtil.getJobStatus(String id, String pgmNo)에서 return된
     * 수행상태코드값을 text로 변환
     * <br><b>Example :</b>
     * <pre>
     *
     * </pre>
     * @param {string} status,상태코드
     * @return string, text
     * @author 송민석
     * @version 2009.10.01
     */
    function getScheduleUtilStatusStr(status){
        switch(status){
            case "0" :
                return "Nothing";
                break;
            case "80" : // 기존에 nothing으로 표현 하던 내용으로 pri_prs_bat에는 데이터가 있으나 batch에서 null을 return할때
                return "Running..";
                break;                
            case "1" :
                return "Running";
                break;
            case "3" :
                return "Starting";
                break;
            case "4" :
                return "Success";
                break;
            case "5" :
                return "Failure";
                break;
            case "6" :
                return "Terminated";
                break;
            case "7" :
                return "ON_ICE";
                break;
            case "8" :
                return "Inactive";
                break;
            case "9" :
                return "Activated";
                break;
            case "10" :
                return "Restart";
                break;
            case "11" :
                return "ON_HOLD";
                break;
            case "12" :
                return "Que Wait";
                break;
            case "90" : // 배치 프로그램 상의 Exception에 의한 Failure
                return "Failure";
                break;                
            case "99" : // 일정시간이 지나도록 배치에서 응답이 없는 것에 의한 Failure
                return "Failure";
                break;
            default :
                return "Unknown";
        }
    }
    /**
     * html 의 object중 id로 이름이 주어진 object에 대한
     * 이벤트를 실행시킨다.
     * <br><b>Example :</b>
     * <pre>
     *  ComPriFireEvent("btn1_Retrieve", "onclick");
     * </pre>
     * @param {string} obj, Event를 fire시키고자 하는 object의 name또는 Object
     * @param {string} eventNm, Event Name ex) onclick
     * @return boolean, false : event 실행 실패, true : event 실행 성공,
     * @author 송민석
     * @version 2010.01.22
     */
    function ComPriFireEvent(obj, eventNm){
        var isSuccess=false;
        if( obj.constructor == String ){
            obj=ComGetObject(obj);
        }
        if (obj){
            try{
            	switch(eventNm){
            		case "click":
            			$(obj).click();
            			break;
            		default:
            			obj.fireEvent(eventNm);
            			break;
            	}                
                isSuccess=true;
            }catch(e){
            }
        }
        return isSuccess
    }

     /**
      * 개발자 컴퓨터에서 개발중인지 서버에서 동작중인지 판단 할수 있도록 <BR>
      * localhost 여부를 return해 준다.
      * 
      * <br><b>Example :</b>
      * <pre>
      *   
      * </pre>
      * @return boolean, true : localhost, false : 그외
      * @author 송민석
      *   
      */
     function ComPriIsLocalhost() {
     	if(location.hostname == "localhost" 
    		|| location.hostname == "127.0.0.1" 
    		|| location.hostname == "ms-pc"
    		|| location.hostname == "sspark-pc"){
    		return true ;
    	}    	
     	return false;
     }
    /**
     * 팝업 호출. <br>
     * <br><b>Example :</b>
     * <pre>
     * </pre>
     * @param {string} popProgId  : 팝업할 화면 id </br>
     * @param {string} callProgId : 호출하는 부모 화면 id </br>
     * @param {string} popParams  : 파라미터
     * @param {string} callEtc    : 기타
     * @return 없음
     * @author 김대호
     * @version 2010.01.29
     */
    function comCallPop(popProgId, callProgId, popParams, callEtc, parentPgmNo) {
        var isMenuWin=true;
        var winNm="popWin" + popProgId + "_" + callProgId;
        /***** 메뉴포함 POP - Start *****/
        var pgmNo=popProgId;
        var pgmUrl="/opuscntr/" + popProgId + ".do";
        if(parentPgmNo == null){
        	var parentPgmNo=pgmNo.substring(0, 8) + 'M001';
        }
        var src="&pgmUrl=" + ComReplaceStr(pgmUrl,"/","^") + "&pgmNo=" + pgmNo;   
        var sFeatures="status=no, width=1024, height=700, resizable=yes, scrollbars=yes";
        /****** 메뉴포함 POP - Edn ********************************************************/
        /***** 일반 POP - Start *****/
        /* ComOpenWindowCenter(sUrl, sWinName, iWidth, iHeight, bModal, sScroll); */
        var popWidth=1024;
        var popHeight=700;
        var isModal=false;
        var popScroll="no";
        /***** 일반 POP - End *****/
        switch(popProgId) {
            case "ESM_PRI_0003": break; // 0060, 0062
            case "ESM_PRI_0057": break; // 0062
            case "ESM_PRI_0061":        // 0062
                isMenuWin=false; popWidth=1024; popHeight=750; isModal=true;
                break;
            case "ESM_PRI_0111":        // 0108_01, 0108_02
                isMenuWin=false; popWidth=900; popHeight=520; 	        
                break;
            case "ESM_PRI_2003": break; // 2042, 2043
            case "ESM_PRI_2041": break; // 2043
        }
        if(isMenuWin){
            var winObj=window.open(pgmUrl+"?pid=" + parentPgmNo +"&"+ popParams, winNm);
        }else{
            ComOpenWindowCenter(pgmUrl + "?" + popParams, winNm, popWidth, popHeight, isModal, popScroll);	        
        }
    }
    
    /**
     * make the note automatically by the Rule Code to be in sheet<br>
     * <br><b>Example :</b>
     * <pre>
     * </pre>
     * @param {object} sheet's Object</br>
     * @param {string} Rule Multi Combo Texts</br>
     * @param {string} Rule Multi Combo Values</br>
     * @param {string} previous note text (2012.12.02 ADD)</br>
     * @return String : Notes to be maden automatically 
     * @author NYK
     * @version 2015.06.09
     */
	function makeAutoNote(sheetObj, ruleComboTexts, ruleComboValues, preNoteText) {

		var strResult = "";
		
		var realRowCnt = sheetObj.RowCount() - sheetObj.RowCount("D");
		if(realRowCnt == undefined || realRowCnt == 0) {
			if(preNoteText != undefined && preNoteText != null && preNoteText !=""){
				strResult = preNoteText;
			}
			return strResult;
		}

		var formObj = document.form;
		var sheetRD = sheetObj; //Route Detail
	    if (sheetRD.RowCount() > 0 ) {
	    	
	    	var cntI = 0;
	    	var cntS = 0;
	    	var cntNA = 0;
	    	var cntF = 0;
	    	
	    	var cntN = 0;
	    	var cntN_N = 0;
	    	var cntN_I = 0;

	    	var ruleArrI = new Array();
	    	var ruleArrS = new Array();
	    	var ruleArrNA = new Array();
	    	var ruleArrF = new Array();
	    	
	    	var ruleArrN = new Array();
	    	
	    	var baseNoteN_N = "Rates are not subject to any other surcharges in the governing tariff.";
	    	var baseNoteN_I = "Rates are subject to all other surcharges, including those, if any, specified in the contract and those published in the Governing Tariff(s) at the time of shipment.";
	    	
			for(var i = sheetRD.HeaderRows(); i <= sheetRD.LastRow(); i++) {
				var v_rt_appl_tp_cd = sheetRD.GetCellValue(i, "rt_appl_tp_cd");
				var v_note_conv_tp_cd = sheetRD.GetCellValue(i, "note_conv_tp_cd");
				var v_note_conv_rule_cd = sheetRD.GetCellValue(i, "note_conv_rule_cd");
				var ruleCd = sheetRD.GetCellValue(i, "chg_rule_def_cd");
				var ruleTp = sheetRD.GetCellValue(i, "chg_rule_tp_cd");
				var ruleNm = getRulCdName(ruleCd, ruleComboTexts, ruleComboValues, ruleTp);
				 
				//2016.06.19 히든된 로우는 제외한다
				var isHidden = sheetRD.GetRowHidden(i);
				if(isHidden) {
					continue;
				}
				
				if( ruleCd == "NOT" && v_rt_appl_tp_cd == "N"){
					cntN_N++;
				}
				if( ruleCd == "NOT" && v_rt_appl_tp_cd == "I"){
					cntN_I++;
				}
				if( ruleCd == "NOT"){
					cntN++;
				}

				//2016.06.19 auto word에서 제외되는 코드
				if(	ruleCd == "APP" || ruleCd == "RAS" || ruleCd == "TYP" || ruleCd == "RAC" || ruleCd == "RAR" || 
					ruleCd == "RAP" || ruleCd == "DOR" || ruleCd == "ARB" || ruleCd == "NOT" ) {
					continue;
				}
				// 2016-04-25 : Rule과 동일한 Charge code를 적용하기 위해 추가 
				if (ruleCd == "ADD" && ruleTp == "R"){
					continue;				
				}

				if(v_rt_appl_tp_cd == "I") { //Include
					if(!checkRuleDup(ruleArrI, ruleCd)) {
						continue;
					}
					var obj = new Object();
					obj.cd = ruleCd;
					obj.nm = ruleNm;
					ruleArrI[cntI] = obj;
					cntI++;
				} else if(v_rt_appl_tp_cd == "N") { //Not Applicable
					if(!checkRuleDup(ruleArrNA, ruleCd)) {
						continue;
					}
					var obj = new Object();
					obj.cd = ruleCd;
					obj.nm = ruleNm;
					ruleArrNA[cntNA] = obj;
					cntNA++;
				} else if(v_rt_appl_tp_cd == "F") {
					//not defined yet
					
					
				} else if(v_rt_appl_tp_cd == "S") { //Subject
					if(!checkRuleDup(ruleArrS, ruleCd)) {
						continue;
					}
					var obj = new Object();
					obj.cd = ruleCd;
					obj.nm = ruleNm;
					ruleArrS[cntS] = obj;
					cntS++;
				}
			}
			
			var baseNoteI_ST = "Rates are inclusive of the";
			var baseNoteI_ED = "and the";
			var baseNoteNA_ED = "not applicable.";
			var baseNoteS_ST = "Rates are subject to";

			//Include
			if(ruleArrI.length > 0) {
				var ruleString = "";
				for(var i = 0; i < ruleArrI.length; i++) {
					var cd = ruleArrI[i].cd;
					var nm = ruleArrI[i].nm;
					if(ruleArrI.length >= 1 && i == 0) {
						if(ruleArrI.length == 1) {
							ruleString = baseNoteI_ST + " " + nm +"("+cd+").";
						} else {
							ruleString = baseNoteI_ST + " " + nm +"("+cd+") ";
						}
						
					} else if(ruleArrI.length > 1 && i == ruleArrI.length - 1) {
						ruleString += baseNoteI_ED + " " + nm +"("+cd+").";
					} else {
						ruleString += ", "+ nm +"("+cd+") ";
					}
				}
				
				if(ruleString.length > 0) {
					strResult += ruleString;
				}
			}
			
			//Not Applicable
			if(ruleArrNA.length > 0) {
				var ruleString = "";
				for(var i = 0; i < ruleArrNA.length; i++) {
					var cd = ruleArrNA[i].cd;
					var nm = ruleArrNA[i].nm;
					if(ruleArrNA.length >= 1 && i == 0) {
						if(ruleArrNA.length == 1) {
							ruleString = " " + nm +"("+cd+") is " + baseNoteNA_ED;
						} else {
							ruleString = " " + nm +"("+cd+") ";
						}
						
					} else if(ruleArrNA.length > 1 && i == ruleArrNA.length - 1) {
						ruleString += ", " + nm +"("+cd+") are " + baseNoteNA_ED;
					} else {
						ruleString += ", "+ nm +"("+cd+") ";
					}
				}
				
				if(strResult.length > 0 && ruleString.length > 0) {
					strResult += " "+ ruleString;
				} else if(strResult.length == 0 && ruleString.length > 0) {
					strResult += ruleString;
				}
			}
			//Fixed
			//not defined yet
			
			//Subject
			if(ruleArrS.length > 0) {
				var ruleString = "";
				for(var i = 0; i < ruleArrS.length; i++) {
					var cd = ruleArrS[i].cd;
					var nm = ruleArrS[i].nm;
					if(ruleArrS.length >= 1 && i == 0) {
						if(ruleArrS.length == 1) {
							ruleString = baseNoteS_ST + " " + nm +"("+cd+").";
						} else {
							ruleString = baseNoteS_ST + " " + nm +"("+cd+") ";
						}
						
					} else if(ruleArrS.length > 1 && i == ruleArrS.length - 1) {
						ruleString += ", " + nm +"("+cd+").";
					} else {
						ruleString += ", "+ nm +"("+cd+") ";
					}
				}
				
				if(strResult.length > 0 && ruleString.length > 0) {
					strResult += " "+ ruleString;
				} else if(strResult.length == 0 && ruleString.length > 0) {
					strResult += ruleString;
				}
			}

			
			//NOT
			if(realRowCnt > 0 && cntN_N > 0) {
				strResult += " " + baseNoteN_N;
			} 
			if(realRowCnt > 0 && (cntN_I > 0 || cntN == 0)) {
				strResult += " " + baseNoteN_I;
				
			}

			
		
	    }
	    
	    //2015.12.02 APPEND LOGIC ADD
	    if(strResult != "" && preNoteText != undefined && preNoteText != null && preNoteText !=""){
	    	strResult = preNoteText + "\n--------------------------------------------------------------------------------\n" + strResult;
	    }
		
		return strResult;
	}
	
	/**
     * Rule MultiCombo에 해당하는 Texts와 Values를 이용해서 Value에 따라 명칭을 얻는다. <br>
     * <br><b>Example :</b>
     * <pre>
     * </pre>
     * @param {String} Rule Cd</br>
     * @param {String} Rule Texts</br>
     * @param {String} Rule Values</br>
     * @return String : Rule 명칭
     * @author NYK
     * @version 2015.06.09
     */
	function getRulCdName(strRuleCd, ruleCboTexts, ruleCboValus, ruleTp){
		var strResult = "";
		//콤보코드와 텍스트를 가져온다.
    	var sText = ruleCboTexts;
    	var sCode = ruleCboValus;
    	
    	//각각 배열로 구성한다.
    	var arrText = sText.split("|");
    	var arrCode = sCode.split("|");	
    	
    	var addCount = 0 ;
    	for(i=1; i<arrCode.length; i++) {
   		 	var sVal = strRuleCd;
   		 	if(sVal == arrCode[i]) {

            	var desc = arrText[i].substring(4);
            	var splitDesc = desc.split("|");    
            	strResult = splitDesc[0];
            	
            	//(2016.04.26) there is two "ADD" Code that are different description.
            	//should be display second "ADD" description.
            	//therefore, do loop until comes from second "ADD" Code
            	if(sVal == "ADD" && ruleTp == "C"){
            		if(addCount > 0){
        				break;
        			} else {
        				addCount ++;
        			}
            	} else {
            		break;
            	}
            	
            }
    	}
    	return strResult;
	}
	
	/**
     * 배열에서 이미 존재하는 값인지 체크한다. <br>
     * <br><b>Example :</b>
     * <pre>
     * </pre>
     * @param {object} Array</br>
     * @param {String} 찾을 값</br>
     * @return {boolean} : True / False
     * @author NYK
     * @version 2015.06.09
     */
	function checkRuleDup(arrObj, strRuleCd) {
		if(strRuleCd == "") {
			return false;
		}
		if(arrObj.length > 0) {
			for(var i = 0; i < arrObj.length; i++){
				if(strRuleCd == arrObj[i].cd) {
					return false;
				}
			}
		}
		
		return true;
	}
	
	/**
     * Get the name from Combo object's value <br>
     * <br><b>Example :</b>
     * <pre>
     * </pre>
     * @param {object} IBMultiCombo</br>
     * @param {String} Combo object's value</br>
     * @return {String} : name
     * @author NYK
     * @version 2015.11.05
     */
	function ComPriGetNameFromComboVal(comboObj, newVal){
		var result = "";
		var formObj=document.form;		
		var code=comboObj.FindItem(newVal, 0);
		if (code != null && code != "") {
			var text=comboObj.GetText(newVal, 1);
			if (text != null && text != "") {
				result = text;
			} else {
				result = "";
			}
		}
		if (code == -1){
			result = "";
		}
		
		return result
	}
