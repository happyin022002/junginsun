<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="IMDGCodeMgtDBDAOUNNumberListOptionVORSQL">
			<desc><![CDATA[UNNumberListOption 조회]]></desc>
			<sql><![CDATA[
SELECT	A.IMDG_UN_NO
	,	A.IMDG_UN_NO_SEQ
	,	A.PRP_SHP_NM
	,	A.PRP_SHP_NM_VAR_RMK
	,	A.IMDG_CLSS_CD
	,	A.IMDG_COMP_GRP_CD
	,	A.IMDG_SUBS_RSK_LBL_RMK
	,	A.IMDG_MRN_POLUT_CD
	,	A.IMDG_PCK_GRP_CD
	,	A.IMDG_LMT_QTY
	,	A.IMDG_LMT_QTY_MEAS_UT_CD
	,	A.IMDG_LMT_QTY_DESC
	,	A.IMDG_EXPT_QTY_CD
	,	A.IMDG_EXPT_QTY_DESC
	,	A.IMDG_EMER_NO
	,	A.IMDG_STWG_CATE_CD
	,	A.FLSH_PNT_TEMP_CTNT
	,	A.EMER_RSPN_GID_NO
	,	A.EMER_RSPN_GID_CHR_NO
	,	A.PSA_NO
	,	A.N1ST_BOM_PORT_TRST_NO
	,	A.N2ND_BOM_PORT_TRST_NO
	,	A.N3RD_BOM_PORT_TRST_NO
	,	A.N4TH_BOM_PORT_TRST_NO
	,	A.PKG_AUTH_NO
	,	A.LK_PORT_AUTH_NO
	,	A.IMDG_SBST_PPT_DESC
	,	A.CFR_RPT_QTY
	,	A.CFR_PSN_INH_ZN_CD
	,	A.CFR_TOXC_CD
	,	A.CFR_DG_WET_CD
	,	A.CFR_RSTR_PORT_NM
	,	A.CFR_RSTR_OPR_NM
	,	A.CFR_XTD_CLSS_CD
	,	A.HCDG_FLG
	,	A.HCDG_DPND_QTY_FLG
	,	A.HCDG_RMK
    , A.N1ST_IMDG_PCK_INSTR_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N1ST_IMDG_PCK_INSTR_CD AND ROWNUM=1) AS N1ST_IMDG_PCK_INSTR_FILE
    , A.N2ND_IMDG_PCK_INSTR_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N2ND_IMDG_PCK_INSTR_CD AND ROWNUM=1) AS N2ND_IMDG_PCK_INSTR_FILE
    , A.N3RD_IMDG_PCK_INSTR_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N3RD_IMDG_PCK_INSTR_CD AND ROWNUM=1) AS N3RD_IMDG_PCK_INSTR_FILE
    , A.N1ST_IMDG_PCK_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N1ST_IMDG_PCK_PROVI_CD AND ROWNUM=1) AS N1ST_IMDG_PCK_PROVI_FILE
    , A.N2ND_IMDG_PCK_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N2ND_IMDG_PCK_PROVI_CD AND ROWNUM=1) AS N2ND_IMDG_PCK_PROVI_FILE
    , A.N3RD_IMDG_PCK_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N3RD_IMDG_PCK_PROVI_CD AND ROWNUM=1) AS N3RD_IMDG_PCK_PROVI_FILE
    , A.N4TH_IMDG_PCK_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N4TH_IMDG_PCK_PROVI_CD AND ROWNUM=1) AS N4TH_IMDG_PCK_PROVI_FILE
    , A.N5TH_IMDG_PCK_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N5TH_IMDG_PCK_PROVI_CD AND ROWNUM=1) AS N5TH_IMDG_PCK_PROVI_FILE
    , A.N1ST_IMDG_IBC_INSTR_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N1ST_IMDG_IBC_INSTR_CD AND ROWNUM=1) AS N1ST_IMDG_IBC_INSTR_FILE
    , A.N2ND_IMDG_IBC_INSTR_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N2ND_IMDG_IBC_INSTR_CD AND ROWNUM=1) AS N2ND_IMDG_IBC_INSTR_FILE
    , A.N3RD_IMDG_IBC_INSTR_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N3RD_IMDG_IBC_INSTR_CD AND ROWNUM=1) AS N3RD_IMDG_IBC_INSTR_FILE
    , A.N4TH_IMDG_IBC_INSTR_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N4TH_IMDG_IBC_INSTR_CD AND ROWNUM=1) AS N4TH_IMDG_IBC_INSTR_FILE
    , A.N5TH_IMDG_IBC_INSTR_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N5TH_IMDG_IBC_INSTR_CD AND ROWNUM=1) AS N5TH_IMDG_IBC_INSTR_FILE
    , A.N1ST_IMDG_IBC_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N1ST_IMDG_IBC_PROVI_CD AND ROWNUM=1) AS N1ST_IMDG_IBC_PROVI_FILE
    , A.N2ND_IMDG_IBC_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N2ND_IMDG_IBC_PROVI_CD AND ROWNUM=1) AS N2ND_IMDG_IBC_PROVI_FILE
    , A.N3RD_IMDG_IBC_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N3RD_IMDG_IBC_PROVI_CD AND ROWNUM=1) AS N3RD_IMDG_IBC_PROVI_FILE
    , A.N4TH_IMDG_IBC_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N4TH_IMDG_IBC_PROVI_CD AND ROWNUM=1) AS N4TH_IMDG_IBC_PROVI_FILE
    , A.N5TH_IMDG_IBC_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N5TH_IMDG_IBC_PROVI_CD AND ROWNUM=1) AS N5TH_IMDG_IBC_PROVI_FILE
    , A.N1ST_IMDG_UN_TNK_INSTR_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N1ST_IMDG_UN_TNK_INSTR_CD AND ROWNUM=1) AS N1ST_IMDG_UN_TNK_INSTR_FILE
    , A.N2ND_IMDG_UN_TNK_INSTR_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N2ND_IMDG_UN_TNK_INSTR_CD AND ROWNUM=1) AS N2ND_IMDG_UN_TNK_INSTR_FILE
    , A.N1ST_IMDG_TNK_INSTR_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N1ST_IMDG_TNK_INSTR_PROVI_CD AND ROWNUM=1) AS N1ST_IMDG_TNK_INSTR_PROVI_FILE
    , A.N2ND_IMDG_TNK_INSTR_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N2ND_IMDG_TNK_INSTR_PROVI_CD AND ROWNUM=1) AS N2ND_IMDG_TNK_INSTR_PROVI_FILE
    , A.N3RD_IMDG_TNK_INSTR_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N3RD_IMDG_TNK_INSTR_PROVI_CD AND ROWNUM=1) AS N3RD_IMDG_TNK_INSTR_PROVI_FILE
    , A.N4TH_IMDG_TNK_INSTR_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N4TH_IMDG_TNK_INSTR_PROVI_CD AND ROWNUM=1) AS N4TH_IMDG_TNK_INSTR_PROVI_FILE
    , A.N5TH_IMDG_TNK_INSTR_PROVI_CD, (SELECT /*+ INDEX_DESC(B XPKSCG_IMDG_PCK_INSTR) */ FILE_SAV_ID FROM SCG_IMDG_PCK_INSTR B WHERE IMDG_PCK_INSTR_CD = A.N5TH_IMDG_TNK_INSTR_PROVI_CD AND ROWNUM=1) AS N5TH_IMDG_TNK_INSTR_PROVI_FILE
	,	A.HCDG_PCK_RSTR_DESC
	,	A.HCDG_INTMD_BC_RSTR_DESC
	,	A.HCDG_TNK_RSTR_DESC
	,	A.SEGR_DESC
    --2016-05-27 
    ,   A.N1ST_ADD_SEGR_DESC
    ,   A.N2ND_ADD_SEGR_DESC
    --2016-05-27
	,	A.CLR_LIV_QTR_STWG_FLG
	,	A.IMDG_FD_STUF_STWG_CD
	,	A.IMDG_HT_SRC_STWG_CD
	,	A.SEGR_AS_FOR_IMDG_CLSS_FLG
	,	A.SEGR_AS_FOR_IMDG_CLSS_CD
	,	A.AWAY_FM_IMDG_CLSS_FLG
	,	A.SPRT_FM_IMDG_CLSS_FLG
	,	A.SPRT_HLD_FM_IMDG_CLSS_FLG
	,	A.SPRT_LON_FM_IMDG_CLSS_FLG
	,	A.AWAY_FM_IMDG_SEGR_GRP_FLG
	,	A.SPRT_FM_IMDG_SEGR_GRP_FLG
	,	A.IMDG_UN_NO_HLD_FLG
	,	A.CRE_USR_ID
	,	A.CRE_DT
	,	A.UPD_USR_ID
	,	TO_CHAR(NVL(GLOBALDATE_PKG.TIME_CONV_FNC(COM_ConstantMgr_PKG.COM_getBaseLocationCode_FNC(),A.UPD_DT,'GMT'),A.UPD_DT),'YYYY-MM-DD HH24:MI') AS UPD_DT
	,	A.CFR_FLG

	,	B.IMDG_ORG_RACT_TP_CD
	,	B.IMDG_TEC_NM
	,	B.IMDG_CONC_RT_CTNT
	,	B.IMDG_PCK_MZD_CD
	,	B.IMDG_CTRL_TEMP
	,	B.IMDG_EMER_TEMP

	,   C.IMDG_CRR_RSTR_EXPT_CD
	,   C.IMDG_CRR_RSTR_EXPT_NM

	,	(	SELECT 	SUBSTR(XMLAGG(XMLELEMENT(X, '/' || IMDG_SUBS_RSK_LBL_CD) ORDER BY IMDG_SUBS_RSK_LBL_CD).EXTRACT('//text()'), 2) AS IMDG_SUBS_RSK_LBL_CD
			FROM SCG_IMDG_SUBS_RSK_LBL
			WHERE 	IMDG_UN_NO  = A.IMDG_UN_NO
			AND 	IMDG_UN_NO_SEQ = A.IMDG_UN_NO_SEQ
			GROUP BY IMDG_UN_NO, IMDG_UN_NO_SEQ ) AS IMDG_SUBS_RSK_LBL_CD
	, 	(	SELECT 	SUBSTR(XMLAGG(XMLELEMENT(X, '/' || IMDG_SPCL_PROVI_NO) ORDER BY DP_SEQ).EXTRACT('//text()'), 2) AS IMDG_SPCL_PROVI_NO
			FROM SCG_IMDG_UN_NO_SPCL_PROVI
			WHERE 	IMDG_UN_NO  = A.IMDG_UN_NO
			AND 	IMDG_UN_NO_SEQ = A.IMDG_UN_NO_SEQ
			GROUP BY IMDG_UN_NO, IMDG_UN_NO_SEQ ) AS IMDG_SPCL_PROVI_NO

	,	'' AWAY_FM_IMDG_CLSS_CD
	,	'' SPRT_FM_IMDG_CLSS_CD
	,	'' SPRT_HLD_FM_IMDG_CLSS_CD
	,	'' SPRT_LON_FM_IMDG_CLSS_CD

	-- For VO
	, '' IMDG_SUBS_RSK_LBL_CD1
	, '' IMDG_SUBS_RSK_LBL_CD2
	, '' IMDG_SUBS_RSK_LBL_CD3
	, '' IMDG_SUBS_RSK_LBL_CD4
	, '' IMDG_SPCL_PROVI_NO1
	, '' IMDG_SPCL_PROVI_NO2
	, '' IMDG_SPCL_PROVI_NO3
	, '' IMDG_SPCL_PROVI_NO4
	, '' IMDG_SPCL_PROVI_NO5
	, '' IMDG_SPCL_PROVI_NO6
	, '' IMDG_SPCL_PROVI_NO7
	, '' IMDG_SPCL_PROVI_NO8
	, '' AWAY_DP_SEQ
	, '' SPRT_DP_SEQ
	, '' HCDG_TNK_RSTR_DESC1
	, '' HCDG_TNK_RSTR_DESC2
	, '' HCDG_TNK_RSTR_DESC3
	, '' HCDG_TNK_RSTR_DESC4

FROM 	SCG_IMDG_UN_NO A
	, 	SCG_IMDG_UN_NO_ORG_RACT B
	, 	(	SELECT 	IMDG_UN_NO
				, 	IMDG_UN_NO_SEQ
				,	SUBSTR(XMLAGG(XMLELEMENT(X, ', ' || IMDG_CRR_RSTR_EXPT_CD) ORDER BY IMDG_CRR_RSTR_EXPT_CD).EXTRACT('//text()'), 2) AS IMDG_CRR_RSTR_EXPT_CD
				,	SUBSTR(XMLAGG(XMLELEMENT(X, ', ' || DECODE(IMDG_CRR_RSTR_EXPT_CD,	'P','Prohibited',
																						'R','Restricted',
																						'C','Excepted fm Class Prohibition',
																						'T','T/S Prohibited',
																						'L','Prohibited on '||SLAN_CD||' Lane') ) 
								  ORDER BY IMDG_CRR_RSTR_EXPT_CD).EXTRACT('//text()'), 2) AS IMDG_CRR_RSTR_EXPT_NM
			FROM SCG_IMDG_CRR_RSTR 
			WHERE VSL_OPR_TP_CD = COM_CONSTANTMGR_PKG.COM_GETCOMPANYCODE_FNC()
			GROUP BY IMDG_UN_NO, IMDG_UN_NO_SEQ) C

WHERE	A.IMDG_UN_NO = B.IMDG_UN_NO(+)
AND 	A.IMDG_UN_NO_SEQ = B.IMDG_UN_NO_SEQ(+)
AND		A.IMDG_UN_NO = C.IMDG_UN_NO(+)
AND 	A.IMDG_UN_NO_SEQ = C.IMDG_UN_NO_SEQ(+)
#if (${imdg_amdt_no} != '') 
    AND (IMDG_AMDT_NO = @[imdg_amdt_no] OR CFR_FLG = 'Y')
#end
#if (${imdg_un_no} != '')
	AND	A.IMDG_UN_NO LIKE @[imdg_un_no]||'%'
#end
#if (${imdg_un_no_seq} != '')
	AND	A.IMDG_UN_NO_SEQ = @[imdg_un_no_seq]
#end
#if (${imdg_clss_cd} != '')                                              
	AND	A.IMDG_CLSS_CD = @[imdg_clss_cd]
#end
#if (${imdg_comp_grp_cd} != '')                                              
	AND	A.IMDG_COMP_GRP_CD = @[imdg_comp_grp_cd]
#end
#if (${imdg_crr_rstr_expt_cd} != '')
	#if (${imdg_crr_rstr_expt_cd} == 'N')
		AND	C.IMDG_CRR_RSTR_EXPT_CD is null
	#else
		AND	C.IMDG_CRR_RSTR_EXPT_CD LIKE '%'||@[imdg_crr_rstr_expt_cd]||'%'
	#end
#end
#if (${imdg_tec_nm} != '')
	AND	(A.PRP_SHP_NM LIKE '%'||@[imdg_tec_nm]||'%')
#end
ORDER BY A.IMDG_UN_NO, A.IMDG_UN_NO_SEQ			]]></sql>
			<params>
				<param name="imdg_amdt_no" type="12" value="" out="N"/>
				<param name="imdg_un_no" type="12" value="" out="N"/>
				<param name="imdg_un_no_seq" type="12" value="" out="N"/>
				<param name="imdg_clss_cd" type="12" value="" out="N"/>
				<param name="imdg_comp_grp_cd" type="12" value="" out="N"/>
				<param name="imdg_crr_rstr_expt_cd" type="12" value="" out="N"/>
				<param name="imdg_tec_nm" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
