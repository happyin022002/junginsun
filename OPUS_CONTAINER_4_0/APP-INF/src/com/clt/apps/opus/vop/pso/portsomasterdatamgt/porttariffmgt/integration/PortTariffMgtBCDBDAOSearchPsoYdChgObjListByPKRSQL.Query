<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PortTariffMgtBCDBDAOSearchPsoYdChgObjListByPKRSQL">
			<desc><![CDATA[PSO_YD_CHG_OBJ_LIST <select>]]></desc>
			<sql><![CDATA[
SELECT X.OBJ_LIST_NO
     ,X.OBJ_LIST_NM
     ,X.PSO_OBJ_CD
     ,X.PSO_OBJ_CD_DSP
     ,X.PSO_MEAS_UT_CD
     ,X.PSO_MEAS_UT_CD_DSP
     ,A.DFLT_VAL
     ,A.YD_CHG_NO
     ,A.YD_CHG_VER_SEQ
     ,A.DFLT_CTNT
     ,A.DFLT_VAL
     ,DECODE(X.PSO_MEAS_UT_CD, '12', A.DFLT_FLG, A.DFLT_VAL) REGULAR_VALUE
     ,A.DFLT_FLG
  FROM PSO_YD_CHG_OBJ_LIST A
     ,( SELECT DISTINCT B.OBJ_LIST_NO
             ,B.OBJ_LIST_NM
             ,B.PSO_OBJ_CD PSO_OBJ_CD
             ,B.OBJ_LIST_NM PSO_OBJ_CD_DSP
             ,B.PSO_MEAS_UT_CD PSO_MEAS_UT_CD
             ,C2.INTG_CD_VAL_DP_DESC PSO_MEAS_UT_CD_DSP
          FROM PSO_OBJ_LIST B
             ,COM_INTG_CD_DTL C2
         WHERE 1=1
           AND B.PSO_MEAS_UT_CD = C2.INTG_CD_VAL_CTNT
           AND C2.INTG_CD_ID = 'CD01848'  ) X
     , (
         SELECT DISTINCT DECODE(Q.RNUM, 1, P.OBJ_LIST_NO, P.RT_OBJ_LIST_NO) OBJ_LIST_NO
           FROM (SELECT BB.OBJ_LIST_NO
                      , BB.RT_OBJ_LIST_NO    
                   FROM (SELECT D.FOML_NO
                              , D.COND_NO
                           FROM PSO_YD_CHG      A
                              , PSO_YD_CHG_XPR  B
                              , PSO_CHG_XPR     C
                              , PSO_CHG_XPR_DTL D
                          WHERE A.YD_CHG_NO = B.YD_CHG_NO
                            AND A.YD_CHG_VER_SEQ = B.YD_CHG_VER_SEQ
                            AND C.CHG_XPR_NO = B.CHG_XPR_NO
                            AND C.CHG_XPR_NO = D.CHG_XPR_NO
                            AND A.YD_CHG_NO = @[yd_chg_no]
                            AND A.YD_CHG_VER_SEQ = @[yd_chg_ver_seq]) A
                      , PSO_FORMULA B
                      , PSO_FOML_DTL BB
                  WHERE 1 = 1
                    AND A.FOML_NO = B.FOML_NO
                    AND B.FOML_NO = BB.FOML_NO
                    AND BB.OBJ_LIST_NO IS NOT NULL
               ) P
              ,(SELECT LEVEL RNUM FROM DUAL CONNECT BY LEVEL <= 2) Q  
         WHERE DECODE(Q.RNUM, 1, P.OBJ_LIST_NO, P.RT_OBJ_LIST_NO) IS NOT NULL 
         UNION
        SELECT DISTINCT DECODE(Q.RNUM, 1, P.OBJ_LIST_NO, P.RT_OBJ_LIST_NO) OBJ_LIST_NO
          FROM (SELECT CC.OBJ_LIST_NO
                     ,CC.RT_OBJ_LIST_NO
                  FROM (SELECT D.FOML_NO
                             ,D.COND_NO
                          FROM PSO_YD_CHG A
                             ,PSO_YD_CHG_XPR B
                             ,PSO_CHG_XPR C
                             ,PSO_CHG_XPR_DTL D
                         WHERE A.YD_CHG_NO = B.YD_CHG_NO
                           AND A.YD_CHG_VER_SEQ = B.YD_CHG_VER_SEQ
                           AND C.CHG_XPR_NO = B.CHG_XPR_NO
                           AND C.CHG_XPR_NO = D.CHG_XPR_NO
                           AND A.YD_CHG_NO = @[yd_chg_no]
                           AND A.YD_CHG_VER_SEQ = @[yd_chg_ver_seq]) A
                     ,PSO_CONDITION C
                     ,PSO_COND_DTL CC
                 WHERE 1 = 1
                   AND A.COND_NO = C.COND_NO
                   AND C.COND_NO = CC.COND_NO
                   AND CC.OBJ_LIST_NO IS NOT NULL
                   AND CC.OBJ_LIST_NO != -1) P
             ,(SELECT LEVEL RNUM FROM DUAL CONNECT BY LEVEL <= 2) Q
         WHERE DECODE(Q.RNUM, 1, P.OBJ_LIST_NO, P.RT_OBJ_LIST_NO) IS NOT NULL 
     ) Y
     , PSO_OBJ_LIST Z
 WHERE 1=1
   AND Y.OBJ_LIST_NO = X.OBJ_LIST_NO
   AND Y.OBJ_LIST_NO = Z.OBJ_LIST_NO
   AND Y.OBJ_LIST_NO = A.OBJ_LIST_NO(+)
   AND A.YD_CHG_NO (+)= @[yd_chg_no]
   AND A.YD_CHG_VER_SEQ (+)= @[yd_chg_ver_seq]
   AND Z.PSO_OBJ_LIST_TP_CD IN ('A', 'M')
 ORDER BY X.PSO_OBJ_CD_DSP			]]></sql>
			<params>
				<param name="yd_chg_no" type="12" value="" out="N"/>
				<param name="yd_chg_ver_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
