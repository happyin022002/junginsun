<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralInvoiceAuditDBDAOsearchEffDateByIssDateRSQL">
			<desc><![CDATA[searchEffDateByIssDate]]></desc>
			<sql><![CDATA[
SELECT DECODE (a.sts, 'O', @[rcv_dt], 'C', substr(b.dt, 1,4)||'-'||substr(b.dt, 5,2)||'-'||substr(b.dt, 7)) EFF_DT
          FROM 
          (SELECT clz_sts_cd sts 
                  FROM ap_period 
                 WHERE sys_div_cd = 13
                   AND ar_ap_div_cd = 'P'
                   AND ofc_cd IN (SELECT ar_hd_qtr_ofc_cd  FROM MDM_ORGANIZATION  WHERE OFC_CD = @[ofc_cd])
                   AND eff_yrmon = SUBSTR (replace(@[rcv_dt],'-',''), 1, 6)
           ) a 
           , (SELECT MIN (eff_yrmon) || '01' dt 
                  FROM ap_period 
                 WHERE sys_div_cd = 13
                   AND ar_ap_div_cd = 'P'
                   AND ofc_cd IN (SELECT ar_hd_qtr_ofc_cd  FROM MDM_ORGANIZATION  WHERE OFC_CD = @[ofc_cd])
                   AND clz_sts_cd = 'O' AND eff_yrmon >= SUBSTR(replace(@[rcv_dt],'-',''), 1, 6) 
          ) b			]]></sql>
			<params>
				<param name="rcv_dt" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
