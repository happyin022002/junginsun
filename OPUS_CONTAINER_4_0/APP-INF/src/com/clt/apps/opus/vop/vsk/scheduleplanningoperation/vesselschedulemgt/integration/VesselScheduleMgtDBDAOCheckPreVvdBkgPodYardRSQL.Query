<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="VesselScheduleMgtDBDAOCheckPreVvdBkgPodYardRSQL">
			<desc><![CDATA[CheckPreVvdBkgPodYard]]></desc>
			<sql><![CDATA[
SELECT 		DISTINCT 
    		BFR_VSL_CD
		,	BFR_SKD_VOY_NO
		,	BFR_SKD_DIR_CD
		,	BFR_VPS_PORT_CD
		,	BFR_CLPT_IND_SEQ
		,	BFR_YD_CD
		,	BFR_VSL_SLAN_CD
		,	BFR_VPS_ETA_DT
		,	BFR_VPS_ETB_DT
		,	BFR_VPS_ETD_DT
		,	VSL_DLAY_RSN_CD
FROM 		(
			SELECT 		T1.VSL_CD 		BFR_VSL_CD
					,	T1.SKD_VOY_NO 	BFR_SKD_VOY_NO
					,	T1.SKD_DIR_CD 	BFR_SKD_DIR_CD
					,	T1.VPS_PORT_CD 	BFR_VPS_PORT_CD
					,	T1.CLPT_IND_SEQ BFR_CLPT_IND_SEQ
					,	T1.YD_CD 		BFR_YD_CD
					,	T1.SLAN_CD 		BFR_VSL_SLAN_CD
					,	TO_CHAR(T1.VPS_ETA_DT, 'YYYYMMDDHH24MI') BFR_VPS_ETA_DT
					,	TO_CHAR(T1.VPS_ETB_DT, 'YYYYMMDDHH24MI') BFR_VPS_ETB_DT
					,	TO_CHAR(T1.VPS_ETD_DT, 'YYYYMMDDHH24MI') BFR_VPS_ETD_DT
					,	T1.VSL_DLAY_RSN_CD
			FROM   		VSK_VSL_PORT_SKD 	T1
					,	BKG_VVD 			T2
					,	BKG_BOOKING 		T3
			WHERE  		1 = 1
			AND    		T1.VSL_CD 			= T2.VSL_CD
			AND    		T1.SKD_VOY_NO 		= T2.SKD_VOY_NO
			AND    		T1.SKD_DIR_CD 		= T2.SKD_DIR_CD
			AND    		T1.VPS_PORT_CD 		= T2.POD_CD
			AND			T1.CLPT_IND_SEQ		= T2.POD_CLPT_IND_SEQ
			AND    		T2.BKG_NO 			= T3.BKG_NO
			AND    		T3.BKG_STS_CD 		IN ('F','W')
			AND    		T1.VSL_CD 			= @[vsl_cd]
			AND    		T1.SKD_VOY_NO 		= @[turn_skd_voy_no]
			AND    		T1.SKD_DIR_CD 		= @[turn_skd_dir_cd]
			AND    		T1.TURN_PORT_IND_CD IN ('D','V','F')

			--UNION ALL

			--SELECT 		T1.VSL_CD 		BFR_VSL_CD
			--		,	T1.SKD_VOY_NO 	BFR_SKD_VOY_NO
			--		,	T1.SKD_DIR_CD 	BFR_SKD_DIR_CD
			--		,	T1.VPS_PORT_CD 	BFR_VPS_PORT_CD
			--		,	T1.CLPT_IND_SEQ BFR_CLPT_IND_SEQ
			--		,	T1.YD_CD 		BFR_YD_CD
			--		,	T1.SLAN_CD 		BFR_VSL_SLAN_CD
			--		,	TO_CHAR(T1.VPS_ETA_DT, 'YYYYMMDDHH24MI') BFR_VPS_ETA_DT
			--		,	TO_CHAR(T1.VPS_ETB_DT, 'YYYYMMDDHH24MI') BFR_VPS_ETB_DT
			--		,	TO_CHAR(T1.VPS_ETD_DT, 'YYYYMMDDHH24MI') BFR_VPS_ETD_DT
			--		,	T1.VSL_DLAY_RSN_CD
			--FROM   		VSK_VSL_PORT_SKD 	T1
			--		,	BKG_VVD 			T2
			--		,	BKG_BOOKING 		T3
			--WHERE  		1 = 1
			--AND    		T1.VSL_CD 			= T2.VSL_CD
			--AND    		T1.SKD_VOY_NO 		= T2.SKD_VOY_NO
			--AND    		T1.SKD_DIR_CD 		= T2.SKD_DIR_CD
			--AND    		T1.VPS_PORT_CD 		= T2.POD_CD
			--AND    		T2.BKG_NO 			= T3.BKG_NO
			--AND    		T3.BKG_STS_CD 		IN ('F','W')
			--AND    		T1.VSL_CD 			= [vsl_cd]
			--AND    		T1.SKD_VOY_NO 		= [skd_voy_no]
			--AND    		T1.SKD_DIR_CD 		= [skd_dir_cd]
			----AND    		T1.TURN_PORT_IND_CD IN ('Y','N')

			----ORDER BY 	CLPT_SEQ
			)
 			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="turn_skd_voy_no" type="12" value="" out="N"/>
				<param name="turn_skd_dir_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
