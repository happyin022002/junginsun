<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InterfaceScheduleToExternalDBDAOSearchPairPortScheduleListRSQL">
			<desc><![CDATA[Searching for port schudule list of pair VVD]]></desc>
			<sql><![CDATA[
SELECT		D.VSL_CD
		,	D.SKD_VOY_NO
		,	D.SKD_DIR_CD
		,	D.VIPS_IF_SEQ
		,	D.VPS_PORT_CD
		,	D.CLPT_IND_SEQ
	     	
		,	D.CLPT_SEQ
		,	D.PORT_SKD_STS_CD
		,	D.YD_CD
		,	D.CALL_YD_IND_SEQ
		,	D.SKD_CNG_STS_CD
	     	
		,	D.VIPS_IB_CONSORTIUM_VOY_NO 
		,	D.VIPS_OB_CONSORTIUM_VOY_NO 
		,	TO_CHAR(D.PF_ETA_DT   		,'YYYYMMDDHH24MI')	AS PF_ETA_DT   		
		,	TO_CHAR(D.PF_ETB_DT         ,'YYYYMMDDHH24MI')	AS PF_ETB_DT           	
		,	TO_CHAR(D.PF_ETD_DT         ,'YYYYMMDDHH24MI')	AS PF_ETD_DT           	
		,	TO_CHAR(D.INIT_ETA_DT       ,'YYYYMMDDHH24MI')	AS INIT_ETA_DT         	      
		,	TO_CHAR(D.INIT_ETB_DT       ,'YYYYMMDDHH24MI')	AS INIT_ETB_DT         	
		,	TO_CHAR(D.INIT_ETD_DT       ,'YYYYMMDDHH24MI')	AS INIT_ETD_DT         	      
		,	TO_CHAR(D.VIPS_VPS_ETA_DT   ,'YYYYMMDDHH24MI')	AS VIPS_VPS_ETA_DT     	
	  	,	TO_CHAR(D.VIPS_VPS_ETB_DT   ,'YYYYMMDDHH24MI')	AS VIPS_VPS_ETB_DT     	
	  	,	TO_CHAR(D.VIPS_VPS_ETD_DT   ,'YYYYMMDDHH24MI')	AS VIPS_VPS_ETD_DT     	
	  	,	TO_CHAR(D.VIPS_ACT_ARR_DT   ,'YYYYMMDDHH24MI')	AS VIPS_ACT_ARR_DT     	
	  	,	TO_CHAR(D.VIPS_ACT_BRTH_DT  ,'YYYYMMDDHH24MI')	AS VIPS_ACT_BRTH_DT    	
	  	,	TO_CHAR(D.VIPS_ACT_DEP_DT   ,'YYYYMMDDHH24MI')	AS VIPS_ACT_DEP_DT     	
	  	,	D.TURN_PORT_FLG
	  	,	D.TURN_PORT_IND_CD
	  	,	D.TURN_SKD_VOY_NO 
	  	,	D.TURN_SKD_DIR_CD
	  	,	D.TURN_CLPT_IND_SEQ
	  	,	D.VIPS_LOD_IND_CD
	  	,	D.VIPS_DCHG_IND_CD
	  	,	D.VIPS_PASS_IND_CD
	  	,	D.SKD_UPD_USR_ID
	  	,	D.SKD_UPD_USR_NM
	  	,	TO_CHAR(D.SKD_UPD_DT,'YYYYMMDDHH24MI')	AS SKD_UPD_DT
	  	,	D.ADD_CALL_FLG
	  	,	D.VT_ADD_CALL_FLG      
	  	,	D.CRE_USR_ID
	  	,	TO_CHAR(D.CRE_DT,'YYYYMMDDHH24MI')		AS CRE_DT 
	  	,	D.UPD_USR_ID
	  	,	TO_CHAR(D.UPD_DT,'YYYYMMDDHH24MI')		AS UPD_DT
FROM    	VSK_VSL_SKD_VIPS_IF_DTL D
WHERE   	1 = 1
AND       	D.VSL_CD                				= @[vsl_cd]
AND       	D.SKD_VOY_NO            				= @[skd_voy_no]
AND       	D.SKD_DIR_CD            				= @[skd_dir_cd]

--AND     	D.VIPS_IF_SEQ           				= (	SELECT	MAX(H.VIPS_IF_SEQ)
--                                   					FROM    VSK_VSL_SKD_VIPS_IF_HDR  H
--                                   					WHERE   H.VSL_CD                = [vsl_cd]
--                                   					AND     H.SKD_VOY_NO            = [skd_voy_no]
--														AND		H.INSF_CNQE_VAL			= 'S'
--                                 						)

AND       	D.VIPS_IF_SEQ                   		= (SELECT  MAX(HH.VIPS_IF_SEQ)
                                                       FROM    VSK_VSL_SKD_VIPS_IF_HDR  HH              
                                                            ,  VSK_VSL_SKD_VIPS_IF_MST  MM              
                                                            ,  VSK_VSL_SKD_VIPS_IF_DTL  DD              
                                                       WHERE   1 = 1                                    
                                                       AND     HH.VSL_CD                = MM.VSL_CD     
                                                       AND     HH.SKD_VOY_NO            = MM.SKD_VOY_NO 
                                                       AND     HH.VIPS_IF_SEQ           = MM.VIPS_IF_SEQ
                                                       AND     MM.VSL_CD                = DD.VSL_CD     
                                                       AND     MM.SKD_VOY_NO            = DD.SKD_VOY_NO 
                                                       AND     MM.SKD_DIR_CD            = DD.SKD_DIR_CD 
                                                       AND     MM.VIPS_IF_SEQ           = DD.VIPS_IF_SEQ
                                                       AND     MM.VSL_CD                = @[vsl_cd]     
                                                       AND     MM.SKD_VOY_NO            = @[skd_voy_no] 
                                                       AND     MM.SKD_DIR_CD            = @[skd_dir_cd] 
                                                       )                                                                                                                                                                                             
 
			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
