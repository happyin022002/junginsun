<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PortLimitManagmentDBDAOSearchPortLimitsDgTtlWgtRSQL">
			<desc><![CDATA[Lane & Port의 조건을 통해 Port Limits 별  DG Total Weight 정보를 체크한다.]]></desc>
			<sql><![CDATA[
-- INLINE VIEW LIST -----------------------------------------
-- upper DEPTH	A	: 
-- upper DEPTH  B	: 
-- 		SECOND		: PLMT - PORT LIMIT REGULATION
-- 		SECOND		: DCGO - OWN + PARTNER DANGEROUS CARGO
------------------------------------------------------------- 


SELECT 		PORT_CD
    	,	PORT_LMT_SEQ
    	,	PORT_LMT_REP_DESC
    	,	LMT_WGT_TP_CD
    	,	VSL_CD
		,   PLMT_VVD
    	,	SLAN_CD
    	,	CUR_PORT_CD
    	,	PIER_TP_CD
    	,	FLSH_PNT_TEMP

		,	ARRIVAL_BKG_NO
		,	DISCHARGE_BKG_NO
		,	LOAD_BKG_NO
		,	DEPARTURE_BKG_NO 

    	--,	IMDG_CLSS_CD
    	--,	IMDG_CLSS_CD_DESC
    	--,	IMDG_COMP_GRP_CD
    	--,	IMDG_SUBS_RSK_LBL_CD
    	--,	IMDG_UN_NO

    	,	IMDG_PCK_GRP_CD
    	,	CNTR_TP_CD
    	,	ARR_DEP_PROHI_FLG
    	,	LDIS_APLY_TGT_FLG

    		--Arrival
    	,	ARR_CGO_WGT
    	,	DECODE(ARR_MAX_LMT, 0, NULL, ROUND((ARR_CGO_WGT / ARR_MAX_LMT  * 100), 2)) 		AS ARR_LMT_RTO
    	,	DECODE(ARR_DEP_PROHI_FLG, 'Y', NULL, DECODE(ARR_MAX_LMT, 0, NULL, ARR_MAX_LMT)) AS ARR_MAX_LMT

    		--Discharge
    	,	DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DCHG_CGO_WGT) 								AS DCHG_CGO_WGT
    	,	DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DECODE(DCHG_MAX_LMT, 0, NULL, ROUND((DCHG_CGO_WGT/ DCHG_MAX_LMT * 100), 2))) AS DCHG_LMT_RTO
    	,	DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DECODE(DCHG_MAX_LMT, 0, NULL, DCHG_MAX_LMT)) AS DCHG_MAX_LMT

    		--Load
    	,	DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, LOD_CGO_WGT) 								AS LOD_CGO_WGT
    	,	DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DECODE(LOD_MAX_LMT, 0, NULL, ROUND((LOD_CGO_WGT / LOD_MAX_LMT  * 100), 2))) AS LOD_LMT_RTO
    	,	DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DECODE(LOD_MAX_LMT, 0, NULL, LOD_MAX_LMT)) AS LOD_MAX_LMT

    		--Depature
		,	DEP_CGO_WGT
    	,	DECODE(DEP_MAX_LMT, 0, NULL, ROUND((DEP_CGO_WGT / DEP_MAX_LMT  * 100), 2)) 		AS DEP_LMT_RTO
    	,	DECODE(ARR_DEP_PROHI_FLG, 'Y', NULL, DECODE(DEP_MAX_LMT, 0, NULL, DEP_MAX_LMT)) AS DEP_MAX_LMT
		,   PLMT_CLPT_IND_SEQ

FROM 		(

			--==========================================================================================================
            SELECT 	 A.PORT_CD
                  ,  A.PORT_LMT_SEQ
                  ,  A.PORT_LMT_REP_DESC
                  ,  A.LMT_WGT_TP_CD
                  ,  A.VSL_CD
				  ,  A.PLMT_VVD

                  ,  A.SLAN_CD
                  ,  A.CUR_PORT_CD
                  ,  A.PIER_TP_CD
                  ,  A.FLSH_PNT_TEMP

                  ,  substr(xmlagg(xmlelement(a, DECODE(A.ARRIVAL_BKG_NO, '', '', ',') ||A.ARRIVAL_BKG_NO) order by A.ARRIVAL_BKG_NO).extract('//text()').getClobVal(), 2)                       AS ARRIVAL_BKG_NO
                  ,  substr(xmlagg(xmlelement(a, DECODE(A.DISCHARGE_BKG_NO, '', '', ',') ||A.DISCHARGE_BKG_NO) order by A.DISCHARGE_BKG_NO).extract('//text()').getClobVal(), 2)                       AS DISCHARGE_BKG_NO
                  ,  substr(xmlagg(xmlelement(a, DECODE(A.LOAD_BKG_NO, '', '', ',') ||A.LOAD_BKG_NO) order by A.LOAD_BKG_NO).extract('//text()').getClobVal(), 2)                       AS LOAD_BKG_NO
                  ,  substr(xmlagg(xmlelement(a, DECODE(A.DEPARTURE_BKG_NO, '', '', ',') ||A.DEPARTURE_BKG_NO) order by A.DEPARTURE_BKG_NO).extract('//text()').getClobVal(), 2)                       AS DEPARTURE_BKG_NO

                  --,  substr(xmlagg(xmlelement(a, DECODE(A.IMDG_CLSS_CD, '', '', ',') ||A.IMDG_CLSS_CD) order by A.IMDG_CLSS_CD).extract('//text()').getClobVal(), 2) 						AS IMDG_CLSS_CD
                  --,  substr(xmlagg(xmlelement(a, DECODE(A.IMDG_CLSS_CD_DESC, '', '', ',') ||A.IMDG_CLSS_CD_DESC) order by A.IMDG_CLSS_CD_DESC).extract('//text()').getClobVal(), 2) 		AS IMDG_CLSS_CD_DESC
                  --,  substr(xmlagg(xmlelement(a, DECODE(A.IMDG_COMP_GRP_CD, '', '', ',') ||A.IMDG_COMP_GRP_CD) order by A.IMDG_COMP_GRP_CD).extract('//text()').getClobVal(), 2) 			AS IMDG_COMP_GRP_CD
                  --,  substr(xmlagg(xmlelement(a, DECODE(A.IMDG_SUBS_RSK_LBL_CD, '', '', ',') ||A.IMDG_SUBS_RSK_LBL_CD) order by A.IMDG_SUBS_RSK_LBL_CD).extract('//text()').getClobVal(),2) AS IMDG_SUBS_RSK_LBL_CD
                  --,  substr(xmlagg(xmlelement(a, DECODE(A.IMDG_UN_NO, '', '', ',') ||A.IMDG_UN_NO) order by A.IMDG_UN_NO).extract('//text()').getClobVal(), 2) 							AS IMDG_UN_NO
                    
                  ,  MAX(A.IMDG_PCK_GRP_CD) 		AS IMDG_PCK_GRP_CD
                  ,  MAX(A.CNTR_TP_CD) 				AS CNTR_TP_CD
                  ,  MAX(A.ARR_DEP_PROHI_FLG) 		AS ARR_DEP_PROHI_FLG
                  ,  MAX(A.LDIS_APLY_TGT_FLG) 		AS LDIS_APLY_TGT_FLG
                  ,  NVL(MAX(A.ARR_MAX_LMT)	, 0)  	AS ARR_MAX_LMT
                  ,  NVL(MAX(A.DCHG_MAX_LMT), 0) 	AS DCHG_MAX_LMT
                  ,  NVL(MAX(A.LOD_MAX_LMT)	, 0)  	AS LOD_MAX_LMT
                  ,  NVL(MAX(A.DEP_MAX_LMT)	, 0)  	AS DEP_MAX_LMT
                  ,  NVL(SUM(A.ARR_CGO_WGT)	, 0)  	AS ARR_CGO_WGT
                  ,  NVL(SUM(A.DCHG_CGO_WGT), 0) 	AS DCHG_CGO_WGT
                  ,  NVL(SUM(A.LOD_CGO_WGT)	, 0)  	AS LOD_CGO_WGT
                  ,  NVL(SUM(A.DEP_CGO_WGT)	, 0)  	AS DEP_CGO_WGT
				  ,  PLMT_CLPT_IND_SEQ
            FROM     
					(SELECT 	PORT_CD
                          ,		PORT_LMT_SEQ
                          ,		PORT_LMT_REP_DESC
                          ,		SLAN_CD
                          ,		CUR_PORT_CD
                          ,		PIER_TP_CD
                          ,		VSL_CD
						  ,     PLMT_VVD
                          ,		IMDG_CLSS_CD 
                          ,		FLSH_PNT_TEMP
                          ,		IMDG_CLSS_CD_DESC
                          ,		LMT_WGT_TP_CD
                          ,		IMDG_COMP_GRP_CD
                          ,		IMDG_PCK_GRP_CD
                          ,		IMDG_SUBS_RSK_LBL_CD
                          ,		IMDG_UN_NO
                          ,		CNTR_TP_CD
                          ,		ARR_DEP_PROHI_FLG
                          ,		LDIS_APLY_TGT_FLG
                          ,		ARR_MAX_LMT
                          ,		DCHG_MAX_LMT
                          ,		LOD_MAX_LMT
                          ,		DEP_MAX_LMT
                          ,		ARR_CGO_WGT 
                          ,		DCHG_CGO_WGT
                          ,		LOD_CGO_WGT 
                          ,		DEP_CGO_WGT 

                          ,    ARRIVAL_BKG_NO
                          ,    DISCHARGE_BKG_NO
                          ,    LOAD_BKG_NO
                          ,    DEPARTURE_BKG_NO
						  ,    PLMT_CLPT_IND_SEQ

                      FROM 		(

                      SELECT 	PORT_CD
                          ,		PORT_LMT_SEQ
                          ,		PORT_LMT_REP_DESC
                          ,		LMT_WGT_TP_CD
                          ,		VSL_CD
						  ,     PLMT_VVD
                          ,		SLAN_CD

                          ,    	ARRIVAL_BKG_NO
                          ,    	DISCHARGE_BKG_NO
                          ,    	LOAD_BKG_NO
                          ,    	DEPARTURE_BKG_NO
                          		
                          ,		MAX(CUR_PORT_CD)                                 			CUR_PORT_CD
                          ,		MAX(PIER_TP_CD)                         				PIER_TP_CD
                          ,		MAX(IMDG_CLSS_CD)                     					IMDG_CLSS_CD 
                          ,		MAX(FLSH_PNT_TEMP)                 						FLSH_PNT_TEMP
                          ,		MAX(IMDG_CLSS_CD_DESC)         							IMDG_CLSS_CD_DESC
                          ,		MAX(IMDG_COMP_GRP_CD)             						IMDG_COMP_GRP_CD
                          ,		MAX(IMDG_PCK_GRP_CD)             						IMDG_PCK_GRP_CD
                          ,		MAX(IMDG_SUBS_RSK_LBL_CD)    							IMDG_SUBS_RSK_LBL_CD
                          ,		MAX(IMDG_UN_NO)                         				IMDG_UN_NO
                          ,		MAX(CNTR_TP_CD)                         				CNTR_TP_CD
                          ,		MAX(ARR_DEP_PROHI_FLG)       							ARR_DEP_PROHI_FLG
                          ,		MAX(LDIS_APLY_TGT_FLG)          						LDIS_APLY_TGT_FLG
                          ,		MAX(ARR_MAX_LMT)                      					ARR_MAX_LMT
                          ,		MAX(DECODE(LDIS_APLY_TGT_FLG, 'N', '' ,DCHG_MAX_LMT))  	DCHG_MAX_LMT
                          ,		MAX(DECODE(LDIS_APLY_TGT_FLG, 'N', '' ,LOD_MAX_LMT))    LOD_MAX_LMT
                          ,		MAX(DEP_MAX_LMT)                      					DEP_MAX_LMT                          		
                          ,		SUM(ARR_CGO_WGT) 										ARR_CGO_WGT

                          --,		DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '',  DECODE(MAX(DCHG_MAX_LMT), NULL, '', SUM(DCHG_CGO_WGT))) AS DCHG_CGO_WGT
                          --,		DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '',  DECODE(MAX(LOD_MAX_LMT),  NULL, '', SUM(LOD_CGO_WGT)))  AS LOD_CGO_WGT
                          ,		DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '',  SUM(DCHG_CGO_WGT)) AS DCHG_CGO_WGT
                          ,		DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '',  SUM(LOD_CGO_WGT))  AS LOD_CGO_WGT
                          ,		SUM(DEP_CGO_WGT) AS DEP_CGO_WGT
                          		
                          ,		DECODE(MAX(ARR_DEP_PROHI_FLG), 'Y', '', DECODE(SUM(ARR_CGO_WGT),0,'',NVL(ROUND( ((SUM(ARR_CGO_WGT)/  MAX(ARR_MAX_LMT))  * 100), 2), 0))) 	AS ARR_LMT_RTO
                          ,		DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '', DECODE(SUM(DCHG_CGO_WGT),0,'',NVL(ROUND( ((SUM(DCHG_CGO_WGT)/ MAX(DCHG_MAX_LMT)) * 100), 2), 0))) 	AS DCHG_LMT_RTO
                          ,		DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '', DECODE(SUM(LOD_CGO_WGT),0,'',NVL(ROUND( ((SUM(LOD_CGO_WGT)/  MAX(LOD_MAX_LMT))  * 100), 2), 0))) 	AS LOD_LMT_RTO
                          ,		DECODE(MAX(ARR_DEP_PROHI_FLG), 'Y', '', DECODE(SUM(DEP_CGO_WGT),0,'',NVL(ROUND( ((SUM(DEP_CGO_WGT)/  MAX(DEP_MAX_LMT))  * 100), 2), 0))) 	AS DEP_LMT_RTO
						  ,     PLMT_CLPT_IND_SEQ

                      
                      FROM 		
                        (
            
                        SELECT 	CASE WHEN PLMT.PORT_LMT_KND = '1ARRIVAL' THEN DCGO.BKG_NO
                                      ELSE ''
                                 END  AS ARRIVAL_BKG_NO
                            ,    CASE WHEN PLMT.PORT_LMT_KND = '2DISCHARGE' THEN DCGO.BKG_NO
                                      ELSE ''
                                 END  AS DISCHARGE_BKG_NO
                            ,    CASE WHEN PLMT.PORT_LMT_KND = '3LOAD' THEN DCGO.BKG_NO
                                      ELSE ''
                                 END  AS LOAD_BKG_NO
                            ,    CASE WHEN PLMT.PORT_LMT_KND = '4DEPARTURE' THEN DCGO.BKG_NO
                                      ELSE ''
                                 END  AS DEPARTURE_BKG_NO

                          	,	DCGO.SLAN_CD --PLMT.SLAN_CD,
                          	,	DCGO.CUR_PORT_CD --PLMT.UN_LOC_CD,
                          	,	PLMT.PIER_TP_CD 
                          	,	PLMT.PORT_CD
                          	,	PLMT.PORT_LMT_SEQ
                          	,	DCGO.POL_CD AS POL_CD
                          	,	DCGO.POD_CD AS POD_CD
                          	,	DCGO.VSL_CD							
							,	DECODE(SUBSTR(DCGO.VVD,1,5) , SUBSTR(DCGO.VVD,6,10), SUBSTR(DCGO.VVD,1,5) , SUBSTR(DCGO.VVD,1,5)||'/'||SUBSTR(DCGO.VVD,6,10)) AS PLMT_VVD 
                          	,	DECODE(PLMT.LMT_WGT_TP_CD, 'GR', 'GROSS', 'NT', 'NET', 'NP', 'NET POWDER') 	AS LMT_WGT_TP_CD
                          	,	PLMT.IMDG_COMP_GRP_CD
                          	,	PLMT.IMDG_PCK_GRP_CD
                          	,	PLMT.IMDG_SUBS_RSK_LBL_CD
                          	,	PLMT.IMDG_UN_NO
                          	,	PLMT.CNTR_TP_CD
                          	,	PLMT.IMDG_CLSS_CD
                          	,	PLMT.FLSH_PNT_TEMP
                          	,	DCGO.FLSH_PNT_CDO_TEMP
                          	,  (SELECT 	SICC.IMDG_CLSS_CD_DESC
                          		FROM 	SCG_IMDG_CLSS_CD 		SICC
                          		WHERE 	1 = 1
                          		AND 	SICC.IMDG_CLSS_CD 		= PLMT.IMDG_CLSS_CD
								) 																			AS IMDG_CLSS_CD_DESC
                          	,	PLMT.PORT_LMT_KND
							,	PLMT.PORT_LMT_REP_DESC, LDIS_APLY_TGT_FLG, ARR_DEP_PROHI_FLG 				-- :2016-04-16:--

                          		--------------------------
                          	,	DECODE(PLMT.PORT_LMT_KND, DCGO.PORT_LMT_KND,
                          				NVL(DECODE(PLMT.LMT_WGT_TP_CD, 'NT', DCGO.ARR_NET_WGT, 'NP', DCGO.ARR_NET_EXPLO_WGT, 'GR', DCGO.ARR_GRS_WGT), 0), 0) 	AS ARR_CGO_WGT
                          	,	DECODE(PLMT.PORT_LMT_KND, DCGO.PORT_LMT_KND,
                          				NVL(DECODE(PLMT.LMT_WGT_TP_CD,'NT', DCGO.DCHG_NET_WGT,'NP', DCGO.DCHG_NET_EXPLO_WGT,'GR', DCGO.DCHG_GRS_WGT), 0), 0) 	AS DCHG_CGO_WGT
                          	,	DECODE(PLMT.PORT_LMT_KND, DCGO.PORT_LMT_KND,
                          				NVL(DECODE(PLMT.LMT_WGT_TP_CD, 'NT', DCGO.LOD_NET_WGT, 'NP', DCGO.LOD_NET_EXPLO_WGT, 'GR', DCGO.LOD_GRS_WGT), 0), 0) 	AS LOD_CGO_WGT
                          	,	DECODE(PLMT.PORT_LMT_KND, DCGO.PORT_LMT_KND,
                          				NVL(DECODE(PLMT.LMT_WGT_TP_CD, 'NT', DCGO.DEP_NET_WGT, 'NP', DCGO.DEP_NET_EXPLO_WGT, 'GR', DCGO.DEP_GRS_WGT), 0), 0) 	AS DEP_CGO_WGT
                          	,	PLMT.ARR_MAX_QTY   				AS ARR_MAX_LMT
                          	,	PLMT.DCHG_MAX_QTY 				AS DCHG_MAX_LMT
                          	,	PLMT.LOD_MAX_QTY   				AS LOD_MAX_LMT
                          	,	PLMT.DEP_MAX_QTY   				AS DEP_MAX_LMT
                          	,	DECODE(PLMT.PPT_EXPLO_FLG, 'Y', 'Explosive ', '')||DECODE(PLMT.PPT_PROHI_FLG, 'Y', 'Prohibited', '') 							AS PPT_FLG_RMK
							,   DCGO.CLPT_IND_SEQ AS PLMT_CLPT_IND_SEQ
                        
                          FROM (


                        --=================== START OF UNION ALL STATEMENT ==================================================
                           		SELECT  	PORT_CD
										, 	PORT_LMT_SEQ
										,	IMDG_CLSS_CD
										, 	FLSH_PNT_TEMP
										,	LMT_WGT_TP_CD
										, 	IMDG_COMP_GRP_CD
										,	IMDG_PCK_GRP_CD
										, 	IMDG_SUBS_RSK_LBL_CD
										,	IMDG_UN_NO
										, 	CNTR_TP_CD
										,	PIER_TP_CD
										,	'1ARRIVAL' 					AS PORT_LMT_KND
										,	ARR_MAX_QTY
										, 	DCHG_MAX_QTY
										, 	LOD_MAX_QTY
										, 	DEP_MAX_QTY
										,	PPT_EXPLO_FLG
										, 	PPT_PROHI_FLG
										, 	PORT_LMT_REP_DESC
										,	ARR_DEP_PROHI_FLG
										, 	LDIS_APLY_TGT_FLG
                              FROM  		(
                                      SELECT      A.PIER_TP_CD
                                               ,  A.PORT_CD
                                               ,  A.PORT_LMT_SEQ
                                               ,  A.FLSH_PNT_TEMP
                                               ,  A.LMT_WGT_TP_CD
                                               ,  A.IMDG_PCK_GRP_CD
                                               ,  E.IMDG_SUBS_RSK_LBL_CD
                                               ,  A.CNTR_TP_CD
                                               ,  B.IMDG_CLSS_CD
                                               ,  C.IMDG_COMP_GRP_CD 
                                               ,  D.IMDG_UN_NO
                                               ,  DECODE(A.ARR_MAX_QTY	, 0, null, A.ARR_MAX_QTY	)	AS ARR_MAX_QTY
                                               ,  DECODE(A.DCHG_MAX_QTY	, 0, null, A.DCHG_MAX_QTY	)   AS DCHG_MAX_QTY
                                               ,  DECODE(A.LOD_MAX_QTY	, 0, null, A.LOD_MAX_QTY	)   AS LOD_MAX_QTY
                                               ,  DECODE(A.DEP_MAX_QTY	, 0, null, A.DEP_MAX_QTY	)   AS DEP_MAX_QTY
                                               ,  A.PPT_EXPLO_FLG
                                               ,  A.PPT_PROHI_FLG
                                               ,  A.PORT_LMT_REP_DESC
                                               ,  A.ARR_DEP_PROHI_FLG
                                               ,  A.LDIS_APLY_TGT_FLG
                                          FROM    SCG_IMDG_PORT_LMT_MST          A
                                               ,  SCG_IMDG_PORT_LMT_CLSS_CD      B
                                               ,  SCG_IMDG_PORT_LMT_COMP_GRP     C
                                               ,  SCG_IMDG_PORT_LMT_UN_NO        D
                                               ,  SCG_IMDG_PORT_LMT_SUBS_RSK     E
                                         WHERE    1 = 1
										 AND	  A.PORT_CD						 = @[plmt_port_cd]
										 AND	  A.PORT_CD                      = B.PORT_CD		(+)
                                         AND      A.PORT_LMT_SEQ                 = B.PORT_LMT_SEQ	(+)
                                         AND      B.PORT_CD                      = C.PORT_CD		(+)
                                         AND      B.PORT_LMT_SEQ                 = C.PORT_LMT_SEQ	(+)
										 AND      B.IMDG_CLSS_CD                 = C.IMDG_CLSS_CD   (+) /* 2016-04-21 */
                                         AND      A.PORT_CD                      = D.PORT_CD		(+)
                                         AND      A.PORT_LMT_SEQ                 = D.PORT_LMT_SEQ	(+)
                                         AND      A.PORT_CD                      = E.PORT_CD		(+)
                                         AND      A.PORT_LMT_SEQ                 = E.PORT_LMT_SEQ	(+) 
                                       	)
                  
                           		UNION ALL

                           		SELECT  	PORT_CD
										, 	PORT_LMT_SEQ
										,	IMDG_CLSS_CD
										, 	FLSH_PNT_TEMP
										,	LMT_WGT_TP_CD
										, 	IMDG_COMP_GRP_CD
										,	IMDG_PCK_GRP_CD
										, 	IMDG_SUBS_RSK_LBL_CD
										,	IMDG_UN_NO
										, 	CNTR_TP_CD
										,	PIER_TP_CD
										,	'2DISCHARGE' 					AS PORT_LMT_KND
										,	ARR_MAX_QTY
										, 	DCHG_MAX_QTY
										, 	LOD_MAX_QTY
										, 	DEP_MAX_QTY
										,	PPT_EXPLO_FLG
										, 	PPT_PROHI_FLG
										, 	PORT_LMT_REP_DESC
										,	ARR_DEP_PROHI_FLG
										, 	LDIS_APLY_TGT_FLG
                              FROM  		(
                                      SELECT      A.PIER_TP_CD
                                               ,  A.PORT_CD
                                               ,  A.PORT_LMT_SEQ
                                               ,  A.FLSH_PNT_TEMP
                                               ,  A.LMT_WGT_TP_CD
                                               ,  A.IMDG_PCK_GRP_CD
                                               ,  E.IMDG_SUBS_RSK_LBL_CD
                                               ,  A.CNTR_TP_CD
                                               ,  B.IMDG_CLSS_CD
                                               ,  C.IMDG_COMP_GRP_CD 
                                               ,  D.IMDG_UN_NO
                                               ,  DECODE(A.ARR_MAX_QTY	, 0, null, A.ARR_MAX_QTY	)	AS ARR_MAX_QTY
                                               ,  DECODE(A.DCHG_MAX_QTY	, 0, null, A.DCHG_MAX_QTY	)   AS DCHG_MAX_QTY
                                               ,  DECODE(A.LOD_MAX_QTY	, 0, null, A.LOD_MAX_QTY	)   AS LOD_MAX_QTY
                                               ,  DECODE(A.DEP_MAX_QTY	, 0, null, A.DEP_MAX_QTY	)   AS DEP_MAX_QTY
                                               ,  A.PPT_EXPLO_FLG
                                               ,  A.PPT_PROHI_FLG
                                               ,  A.PORT_LMT_REP_DESC
                                               ,  A.ARR_DEP_PROHI_FLG
                                               ,  A.LDIS_APLY_TGT_FLG
                                          FROM    SCG_IMDG_PORT_LMT_MST          A
                                               ,  SCG_IMDG_PORT_LMT_CLSS_CD      B
                                               ,  SCG_IMDG_PORT_LMT_COMP_GRP     C
                                               ,  SCG_IMDG_PORT_LMT_UN_NO        D
                                               ,  SCG_IMDG_PORT_LMT_SUBS_RSK     E
                                         WHERE    1 = 1
										 AND	  A.PORT_CD						 = @[plmt_port_cd]
										 AND	  A.PORT_CD                      = B.PORT_CD		(+)
                                         AND      A.PORT_LMT_SEQ                 = B.PORT_LMT_SEQ	(+)
                                         AND      B.PORT_CD                      = C.PORT_CD		(+)
                                         AND      B.PORT_LMT_SEQ                 = C.PORT_LMT_SEQ	(+)
										 AND      B.IMDG_CLSS_CD                 = C.IMDG_CLSS_CD   (+) /* 2016-04-21 */
                                         AND      A.PORT_CD                      = D.PORT_CD		(+)
                                         AND      A.PORT_LMT_SEQ                 = D.PORT_LMT_SEQ	(+)
                                         AND      A.PORT_CD                      = E.PORT_CD		(+)
                                         AND      A.PORT_LMT_SEQ                 = E.PORT_LMT_SEQ	(+) 
                                       	)
                  
                           		UNION ALL

                           		SELECT  	PORT_CD
										, 	PORT_LMT_SEQ
										,	IMDG_CLSS_CD
										, 	FLSH_PNT_TEMP
										,	LMT_WGT_TP_CD
										, 	IMDG_COMP_GRP_CD
										,	IMDG_PCK_GRP_CD
										, 	IMDG_SUBS_RSK_LBL_CD
										,	IMDG_UN_NO
										, 	CNTR_TP_CD
										,	PIER_TP_CD
										,	'3LOAD' 					AS PORT_LMT_KND
										,	ARR_MAX_QTY
										, 	DCHG_MAX_QTY
										, 	LOD_MAX_QTY
										, 	DEP_MAX_QTY
										,	PPT_EXPLO_FLG
										, 	PPT_PROHI_FLG
										, 	PORT_LMT_REP_DESC
										,	ARR_DEP_PROHI_FLG
										, 	LDIS_APLY_TGT_FLG
                              FROM  		(
                                      SELECT      A.PIER_TP_CD
                                               ,  A.PORT_CD
                                               ,  A.PORT_LMT_SEQ
                                               ,  A.FLSH_PNT_TEMP
                                               ,  A.LMT_WGT_TP_CD
                                               ,  A.IMDG_PCK_GRP_CD
                                               ,  E.IMDG_SUBS_RSK_LBL_CD
                                               ,  A.CNTR_TP_CD
                                               ,  B.IMDG_CLSS_CD
                                               ,  C.IMDG_COMP_GRP_CD 
                                               ,  D.IMDG_UN_NO
                                               ,  DECODE(A.ARR_MAX_QTY	, 0, null, A.ARR_MAX_QTY	)	AS ARR_MAX_QTY
                                               ,  DECODE(A.DCHG_MAX_QTY	, 0, null, A.DCHG_MAX_QTY	)   AS DCHG_MAX_QTY
                                               ,  DECODE(A.LOD_MAX_QTY	, 0, null, A.LOD_MAX_QTY	)   AS LOD_MAX_QTY
                                               ,  DECODE(A.DEP_MAX_QTY	, 0, null, A.DEP_MAX_QTY	)   AS DEP_MAX_QTY
                                               ,  A.PPT_EXPLO_FLG
                                               ,  A.PPT_PROHI_FLG
                                               ,  A.PORT_LMT_REP_DESC
                                               ,  A.ARR_DEP_PROHI_FLG
                                               ,  A.LDIS_APLY_TGT_FLG
                                          FROM    SCG_IMDG_PORT_LMT_MST          A
                                               ,  SCG_IMDG_PORT_LMT_CLSS_CD      B
                                               ,  SCG_IMDG_PORT_LMT_COMP_GRP     C
                                               ,  SCG_IMDG_PORT_LMT_UN_NO        D
                                               ,  SCG_IMDG_PORT_LMT_SUBS_RSK     E
                                         WHERE    1 = 1
										 AND	  A.PORT_CD						 = @[plmt_port_cd]
										 AND	  A.PORT_CD                      = B.PORT_CD		(+)
                                         AND      A.PORT_LMT_SEQ                 = B.PORT_LMT_SEQ	(+)
                                         AND      B.PORT_CD                      = C.PORT_CD		(+)
                                         AND      B.PORT_LMT_SEQ                 = C.PORT_LMT_SEQ	(+)
										 AND      B.IMDG_CLSS_CD                 = C.IMDG_CLSS_CD   (+) /* 2016-04-21 */
                                         AND      A.PORT_CD                      = D.PORT_CD		(+)
                                         AND      A.PORT_LMT_SEQ                 = D.PORT_LMT_SEQ	(+)
                                         AND      A.PORT_CD                      = E.PORT_CD		(+)
                                         AND      A.PORT_LMT_SEQ                 = E.PORT_LMT_SEQ	(+) 
                                       	)
                  
                  
                           		UNION ALL

                           		SELECT  	PORT_CD
										, 	PORT_LMT_SEQ
										,	IMDG_CLSS_CD
										, 	FLSH_PNT_TEMP
										,	LMT_WGT_TP_CD
										, 	IMDG_COMP_GRP_CD
										,	IMDG_PCK_GRP_CD
										, 	IMDG_SUBS_RSK_LBL_CD
										,	IMDG_UN_NO
										, 	CNTR_TP_CD
										,	PIER_TP_CD
										,	'4DEPARTURE' 					AS PORT_LMT_KND
										,	ARR_MAX_QTY
										, 	DCHG_MAX_QTY
										, 	LOD_MAX_QTY
										, 	DEP_MAX_QTY
										,	PPT_EXPLO_FLG
										, 	PPT_PROHI_FLG
										, 	PORT_LMT_REP_DESC
										,	ARR_DEP_PROHI_FLG
										, 	LDIS_APLY_TGT_FLG
                              FROM  		(
                                      SELECT      A.PIER_TP_CD
                                               ,  A.PORT_CD
                                               ,  A.PORT_LMT_SEQ
                                               ,  A.FLSH_PNT_TEMP
                                               ,  A.LMT_WGT_TP_CD
                                               ,  A.IMDG_PCK_GRP_CD
                                               ,  E.IMDG_SUBS_RSK_LBL_CD
                                               ,  A.CNTR_TP_CD
                                               ,  B.IMDG_CLSS_CD
                                               ,  C.IMDG_COMP_GRP_CD 
                                               ,  D.IMDG_UN_NO
                                               ,  DECODE(A.ARR_MAX_QTY	, 0, null, A.ARR_MAX_QTY	)	AS ARR_MAX_QTY
                                               ,  DECODE(A.DCHG_MAX_QTY	, 0, null, A.DCHG_MAX_QTY	)   AS DCHG_MAX_QTY
                                               ,  DECODE(A.LOD_MAX_QTY	, 0, null, A.LOD_MAX_QTY	)   AS LOD_MAX_QTY
                                               ,  DECODE(A.DEP_MAX_QTY	, 0, null, A.DEP_MAX_QTY	)   AS DEP_MAX_QTY
                                               ,  A.PPT_EXPLO_FLG
                                               ,  A.PPT_PROHI_FLG
                                               ,  A.PORT_LMT_REP_DESC
                                               ,  A.ARR_DEP_PROHI_FLG
                                               ,  A.LDIS_APLY_TGT_FLG
                                          FROM    SCG_IMDG_PORT_LMT_MST          A
                                               ,  SCG_IMDG_PORT_LMT_CLSS_CD      B
                                               ,  SCG_IMDG_PORT_LMT_COMP_GRP     C
                                               ,  SCG_IMDG_PORT_LMT_UN_NO        D
                                               ,  SCG_IMDG_PORT_LMT_SUBS_RSK     E
                                         WHERE    1 = 1
										 AND	  A.PORT_CD						 = @[plmt_port_cd]
										 AND	  A.PORT_CD                      = B.PORT_CD		(+)
                                         AND      A.PORT_LMT_SEQ                 = B.PORT_LMT_SEQ	(+)
                                         AND      B.PORT_CD                      = C.PORT_CD		(+)
                                         AND      B.PORT_LMT_SEQ                 = C.PORT_LMT_SEQ	(+)
										 AND      B.IMDG_CLSS_CD                 = C.IMDG_CLSS_CD   (+) /* 2016-04-21 */
                                         AND      A.PORT_CD                      = D.PORT_CD		(+)
                                         AND      A.PORT_LMT_SEQ                 = D.PORT_LMT_SEQ	(+)
                                         AND      A.PORT_CD                      = E.PORT_CD		(+)
                                         AND      A.PORT_LMT_SEQ                 = E.PORT_LMT_SEQ	(+) 
                                       	)
                                                                         
                        --=================== END OF UNION ALL STATEMENT ==================================================  
                             
            
                    ) PLMT,
                    
            --*************************************************************************************************************
            --2016-04-13 START
            --*************************************************************************************************************
                   (
            
                      SELECT SLAN_CD, VSL_CD, VVD,  CUR_PORT_CD, CLPT_IND_SEQ, POL_CD, POD_CD, WGT_UT_CD, IMDG_CLSS_CD, FLSH_PNT_CDO_TEMP, PORT_LMT_KND, VPS_ETA_DT,IMDG_PCK_GRP_CD,
                             IMDG_COMP_GRP_CD, IMDG_UN_NO, IMDG_UN_NO_SEQ, CNTR_TP_CD,IMDG_SUBS_RSK_LBL_CD1, IMDG_SUBS_RSK_LBL_CD2, IMDG_SUBS_RSK_LBL_CD3, IMDG_SUBS_RSK_LBL_CD4, BKG_NO,
                             ------------------------
                             SUM(ARR_NET_WGT) AS ARR_NET_WGT, SUM(ARR_GRS_WGT) AS ARR_GRS_WGT, SUM(ARR_NET_EXPLO_WGT) AS ARR_NET_EXPLO_WGT,
                             SUM(DCHG_NET_WGT) AS DCHG_NET_WGT, SUM(DCHG_GRS_WGT) AS DCHG_GRS_WGT, SUM(DCHG_NET_EXPLO_WGT) AS DCHG_NET_EXPLO_WGT,
                             SUM(LOD_NET_WGT) AS LOD_NET_WGT, SUM(LOD_GRS_WGT) AS LOD_GRS_WGT, SUM(LOD_NET_EXPLO_WGT) AS LOD_NET_EXPLO_WGT,
                             SUM(DEP_NET_WGT) AS DEP_NET_WGT, SUM(DEP_GRS_WGT) AS DEP_GRS_WGT, SUM(DEP_NET_EXPLO_WGT) AS DEP_NET_EXPLO_WGT
                        FROM (
            
                                    SELECT BKG_NO,DCGO_SEQ,SLAN_CD,VSL_CD,VVD,CUR_PORT_CD,CLPT_IND_SEQ,POL_CD,POD_CD,WGT_UT_CD,IMDG_CLSS_CD,FLSH_PNT_CDO_TEMP, IMDG_COMP_GRP_CD, IMDG_UN_NO,IMDG_UN_NO_SEQ,
                                     CNTR_TP_CD,IMDG_SUBS_RSK_LBL_CD1,IMDG_SUBS_RSK_LBL_CD2,IMDG_SUBS_RSK_LBL_CD3,IMDG_SUBS_RSK_LBL_CD4,ARR_NET_WGT,ARR_GRS_WGT,ARR_NET_EXPLO_WGT,
                                     DCHG_NET_WGT,DCHG_GRS_WGT,DCHG_NET_EXPLO_WGT,LOD_NET_WGT,LOD_GRS_WGT,LOD_NET_EXPLO_WGT,DEP_NET_WGT,DEP_GRS_WGT,DEP_NET_EXPLO_WGT,VPS_ETA_DT,IMDG_PCK_GRP_CD,PORT_LMT_KND
                                      FROM
                                          (
                                          
            --ARRIVAL SELECT 2016-04-13 START  
                                      SELECT   A.BKG_NO
											,  A.DCGO_SEQ,
                                               A.SLAN_CD,
                                               A.VSL_CD,
											   A.VVD,
                                               A.CUR_PORT_CD,
                                               A.CLPT_IND_SEQ,
                                               A.POL_CD,
 											   A.POL_CLPT_IND_SEQ,
                                               A.POD_CLPT_IND_SEQ,
                                               A.POD_CD,
                                               A.WGT_UT_CD,
                                               A.IMDG_CLSS_CD,
                                               A.FLSH_PNT_CDO_TEMP,
                                               A.IMDG_COMP_GRP_CD,
                                               A.IMDG_UN_NO,
                                               A.IMDG_UN_NO_SEQ,
                                               A.CNTR_TP_CD,
                                               A.IMDG_SUBS_RSK_LBL_CD1,
                                               A.IMDG_SUBS_RSK_LBL_CD2,
                                               A.IMDG_SUBS_RSK_LBL_CD3,
                                               A.IMDG_SUBS_RSK_LBL_CD4,
                                               ---------------------------------
                                                NET_WGT AS ARR_NET_WGT, GRS_WGT AS ARR_GRS_WGT, NET_EXPLO_WGT AS ARR_NET_EXPLO_WGT,
                                                0 AS DCHG_NET_WGT, 0 AS DCHG_GRS_WGT, 0 AS DCHG_NET_EXPLO_WGT,
                                                0 AS LOD_NET_WGT, 0 AS LOD_GRS_WGT, 0 AS LOD_NET_EXPLO_WGT,
                                                0 AS DEP_NET_WGT, 0 AS DEP_GRS_WGT, 0 AS DEP_NET_EXPLO_WGT,
                                               A.VPS_ETA_DT, A.IMDG_PCK_GRP_CD,
                                               '1ARRIVAL' PORT_LMT_KND
                                      FROM (

											--=========== TOP.TOP.TOP ==============================================================--
											--=========== TOP.TOP.TOP ==============================================================--
													SELECT	A.BKG_NO               
														,	A.DCGO_SEQ             
														,	A.SLAN_CD              
														,	A.VSL_CD    
														,   A.VVD          
       													,	A.CUR_PORT_CD
                                                        ,   A.CLPT_IND_SEQ
														,	A.CUR_PORT_MAX_SEQ     
														,	A.CUR_PORT_MIN_SEQ     
														,	A.POL_CD
 														,   A.POL_CLPT_IND_SEQ           
														,	A.BKG_POL_SEQ          
														,	A.POD_CD
                                                        ,   A.POD_CLPT_IND_SEQ                   
														,	A.BKG_POD_SEQ          
														,	A.WGT_UT_CD            
														,	A.IMDG_CLSS_CD         
														,	A.FLSH_PNT_CDO_TEMP    
														,	A.IMDG_COMP_GRP_CD     
														,	A.IMDG_UN_NO           
														,	A.IMDG_UN_NO_SEQ       
														,	A.CNTR_TP_CD           
														,	A.IMDG_SUBS_RSK_LBL_CD1
														,	A.IMDG_SUBS_RSK_LBL_CD2
														,	A.IMDG_SUBS_RSK_LBL_CD3
														,	A.IMDG_SUBS_RSK_LBL_CD4
														,	A.NET_WGT,A.GRS_WGT
														,	A.NET_EXPLO_WGT    
														,	A.VPS_ETA_DT       
														,	A.IMDG_PCK_GRP_CD  
													FROM	(
													        
                                                    SELECT 	A.BKG_NO
                                                    	,	A.DCGO_SEQ
                                                    	,	A.SLAN_CD
                                                    	,	A.VSL_CD
														,   A.VVD
                                                    	,	A.CUR_PORT_CD
                                                        ,   A.CLPT_IND_SEQ
                                                    	,	A.CUR_PORT_MAX_SEQ
                                                    	,	A.CUR_PORT_MIN_SEQ
                                                    	,	A.POL_CD
                                                        ,   A.POL_CLPT_IND_SEQ   
                                                    	,	A.BKG_POL_SEQ
                                                    	,	A.POD_CD
                                                        ,   A.POD_CLPT_IND_SEQ    
                                                    	,	A.BKG_POD_SEQ
                                                    	,	A.WGT_UT_CD
                                                    	,	A.IMDG_CLSS_CD
                                                    	,	A.FLSH_PNT_CDO_TEMP
                                                      ,  A.IMDG_COMP_GRP_CD
                                                      ,  A.IMDG_UN_NO
                                                      ,  A.IMDG_UN_NO_SEQ
                                                      ,  A.CNTR_TP_CD
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD1
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD2
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD3
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD4
                                                      ,  A.NET_WGT,A.GRS_WGT
                                                      ,  A.NET_EXPLO_WGT
                                                      ,  A.VPS_ETA_DT
                                                      ,  A.IMDG_PCK_GRP_CD
                                                      ,  ROW_NUMBER() OVER (PARTITION BY NVL(G.BKG_NO,A.BKG_NO), NVL(G.SPCL_CGO_APRO_RQST_SEQ,A.SPCL_CGO_APRO_RQST_SEQ), NVL(G.VSL_PRE_PST_CD,A.VSL_PRE_PST_CD), NVL(G.VSL_SEQ,A.VSL_SEQ), NVL(G.DCGO_SEQ,A.DCGO_SEQ) ORDER BY G.DCGO_SEQ ASC) CORR_AUTH_SEQ
                                                      
                                                      FROM
                                                             (
                                                -- Own BKG`s SPCL CGO Info
                                                SELECT 		SDC.BKG_NO
														,	SDC.SPCL_CGO_APRO_CD,
                                                           SDC.DCGO_SEQ,
                                                           VVPS.SLAN_CD,
                                                           VVPS.VSL_CD,
														  (SELECT 
                                                           DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| 
                                                           DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||
                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||
                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD
                                                           FROM VSK_VSL_PORT_SKD 
                                                           WHERE VSL_CD = VVPS.VSL_CD
                                                           AND   SKD_VOY_NO = VVPS.SKD_VOY_NO
                                                           AND   SKD_DIR_CD = VVPS.SKD_DIR_CD
                                                           AND   VPS_PORT_CD = VVPS.VPS_PORT_CD
                                                           AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ
                                                           ) AS VVD,		
                                                          
                                                           @[plmt_port_cd]  AS CUR_PORT_CD,
                                                           VVPS.CLPT_IND_SEQ,

                                                           (SELECT MAX(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD
                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD
															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MAX_SEQ,
                                                           (SELECT MIN(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD
                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD
															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                                AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MIN_SEQ,                                                   
                                                           SVAR.POL_CD,
	                                                       SVAR.POL_CLPT_IND_SEQ,    
                                                           (SELECT SVVPS.CLPT_SEQ
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD
                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.CLPT_IND_SEQ = BVD.POL_CLPT_IND_SEQ
                                                               AND SVVPS.VPS_PORT_CD  = BVD.POL_CD
                                                               ) AS BKG_POL_SEQ,
                                                            SVAR.POD_CD,
															SVAR.POD_CLPT_IND_SEQ,

                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------
                                                               (
                                                               SELECT   T1.CLPT_SEQ
                                                               FROM     VSK_VSL_PORT_SKD             T1
                                                               WHERE    T1.VSL_CD                    = BVD.VSL_CD
                                                               AND      T1.SKD_VOY_NO                = BVD.SKD_VOY_NO
                                                               AND      T1.SKD_DIR_CD                = BVD.SKD_DIR_CD
                                                               AND      T1.VPS_PORT_CD               = BVD.POD_CD
                                                               AND      T1.CLPT_IND_SEQ              = BVD.POD_CLPT_IND_SEQ
                                                               )    AS BKG_POD_SEQ,
                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------

                                                           NVL(SDC.WGT_UT_CD, 'KGS') AS WGT_UT_CD,
                                                           SDC.IMDG_CLSS_CD,
                                                           SDC.FLSH_PNT_CDO_TEMP,
                                                           SDC.IMDG_COMP_GRP_CD,
                                                           SDC.IMDG_UN_NO,
                                                           SDC.IMDG_UN_NO_SEQ,
                                                           SUBSTR(SDC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD1,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD2,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD3,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD4,
                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_WGT), SDC.NET_WGT) AS NET_WGT,
                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.GRS_WGT), SDC.GRS_WGT) AS GRS_WGT,
                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_EXPLO_WGT), SDC.NET_EXPLO_WGT) AS NET_EXPLO_WGT,
                                                           VVPS.VPS_ETA_DT, SDC.IMDG_PCK_GRP_CD,
                                                           SVAR.VSL_PRE_PST_CD, SVAR.VSL_SEQ  , SAR.SPCL_CGO_APRO_RQST_SEQ
                                                  FROM BKG_DG_CGO        SDC,
                                                       SCG_APRO_RQST     SAR,
                                                       SCG_VVD_APRO_RQST SVAR,
                                                       BKG_VVD           BVD,
                                                       VSK_VSL_PORT_SKD  VVPS
                                                  WHERE 1 = 1
                                                   AND SDC.BKG_NO                 = SAR.BKG_NO
                                                   AND SAR.BKG_NO                 = SVAR.BKG_NO
                                                   AND SAR.SPCL_CGO_APRO_RQST_SEQ = SVAR.SPCL_CGO_APRO_RQST_SEQ
												   -- BDR 이후 POST VVD만 Request오는 경우 고려, LST_RQST_DAT_FLG='Y' 조건 대신 적용
                                                   AND SVAR.SPCL_CGO_APRO_RQST_SEQ = (SELECT MAX(RV.SPCL_CGO_APRO_RQST_SEQ) 
                                                                            			FROM SCG_VVD_APRO_RQST RV,
                                                                                             SCG_APRO_RQST RV2
                                                                                     	WHERE RV.VSL_CD = BVD.VSL_CD
                                                                                     	AND   RV.SKD_VOY_NO = BVD.SKD_VOY_NO
                                                                                     	AND   RV.SKD_DIR_CD = BVD.SKD_DIR_CD
                                                                                     	AND   RV.BKG_NO = BVD.BKG_NO                                                                                                      
                                                                                        AND   RV2.BKG_No = RV.BKG_NO
                                                                                        AND RV.SPCL_CGO_APRO_RQST_SEQ = RV2.SPCL_CGO_APRO_RQST_SEQ
                                                                                        AND   RV2.SPCL_CGO_CATE_CD = 'DG'
                                                                                       )
                                                   AND SVAR.BKG_NO                = BVD.BKG_NO
                                                   AND SVAR.VSL_PRE_PST_CD        = BVD.VSL_PRE_PST_CD
                                                   AND SVAR.VSL_SEQ               = BVD.VSL_SEQ
                                                   AND SVAR.VSL_CD                = VVPS.VSL_CD
                                                   AND SVAR.SKD_VOY_NO            = VVPS.SKD_VOY_NO
                                                   AND SVAR.SKD_DIR_CD            = VVPS.SKD_DIR_CD
                                                   --2016-08-18 ETA from Current Port
                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD
                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD
                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB
                                                                             WHERE SUB.VSL_CD = SVAR.VSL_CD
                                                                             AND   SUB.SKD_VOY_NO = SVAR.SKD_VOY_NO
                                                                             AND   SUB.SKD_DIR_CD = SVAR.SKD_DIR_CD
                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  
                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')
                                                                           )        
                                                   --2016-08-18 ETA from Current Port
                                                   --AND SVAR.POL_CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ
                                                   AND SDC.SPCL_CGO_APRO_CD IS NOT NULL
                                                   AND SDC.SPCL_CGO_APRO_CD NOT IN ('C','D','N')
                                                   --AND SAR.LST_RQST_DAT_FLG = 'Y'
                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                 AND EXISTS (
                                                              SELECT 1
                                                                FROM BKG_BOOKING C
                                                               WHERE SDC.BKG_NO = C.BKG_NO
                                                                 AND C.BKG_STS_CD <> 'X'
                                                            )
            
                                                   #if (${slan_cd1} != '')
                                                    AND SVAR.SLAN_CD = @[slan_cd1]
                                                   #end
                                                   #if (${imdg_clss_cd} != '')
                                                    AND SDC.IMDG_CLSS_CD = @[imdg_clss_cd]
                                                   #end
                                                   #if (${vsl_cd} != '')
                                                    AND VVPS.VSL_CD = @[vsl_cd]
                                                   #end
                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')
                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])
                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])
														)
                                                   #end
										   
											   

                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                   #end
            
                                                    ) A
                        						,  SCG_AUTHORIZATION G

                                             WHERE   A.BKG_NO                             = G.BKG_NO           (+)
                                             AND   A.SPCL_CGO_APRO_RQST_SEQ       = G.SPCL_CGO_APRO_RQST_SEQ   (+)
                                             AND   A.VSL_PRE_PST_CD                   = G.VSL_PRE_PST_CD       (+)
                                             AND   A.VSL_SEQ                           = G.VSL_SEQ         (+)
                                             AND   A.DCGO_SEQ                     = G.DCGO_SEQ         (+)
            
                                             #if (${auth_flg} == 'P')
                                              AND  G.SPCL_CGO_AUTH_CD                 = 'P'
                                             #end
                                             #if (${auth_flg} == 'R')
                                              AND  NVL(G.SPCL_CGO_AUTH_CD,'R')     = 'R'
                                             #end
                                             #if (${auth_flg} == 'Y')
                                              AND  G.SPCL_CGO_AUTH_CD                 = 'Y'
                                             #end

                                              AND   A.SPCL_CGO_APRO_CD           IN ('P','R','Y')
                                              
                                              ) A
                                              WHERE CORR_AUTH_SEQ                = 1
											--=========== TOP.TOP.TOP ==============================================================--
											--=========== TOP.TOP.TOP ==============================================================--


                                                UNION ALL
            

                                                -- Partner Lines SPCL CGO Info
                                                SELECT SPAR.BKG_REF_NO,
                                                       SPAC.DCGO_SEQ,
                                                       SPAR.SLAN_CD,
                                                       SPAR.VSL_CD,
													  (SELECT 
                                                       DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| 
                                                       DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||
                                                       DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||
                                                       DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD
                                                       FROM VSK_VSL_PORT_SKD 
                                                       WHERE VSL_CD = VVPS.VSL_CD
                                                       AND   SKD_VOY_NO = VVPS.SKD_VOY_NO
                                                       AND   SKD_DIR_CD = VVPS.SKD_DIR_CD
                                                       AND   VPS_PORT_CD = VVPS.VPS_PORT_CD
                                                       AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ
                                                       ) AS VVD,	
														@[plmt_port_cd]	AS CUR_PORT_CD,
                                                        VVPS.CLPT_IND_SEQ,
                                                           (SELECT MAX(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD
                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD
															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MAX_SEQ,
                                                           (SELECT MIN(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD
                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD
									                           AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MIN_SEQ,                                                   
                                                           SPAR.POL_CD,
														   SPAR.POL_CLPT_IND_SEQ,
                                                           (SELECT SVVPS.CLPT_SEQ
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD
                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.CLPT_IND_SEQ = NVL(SPAR.POL_CLPT_IND_SEQ,1)
                                                               AND SVVPS.VPS_PORT_CD  = SPAR.POL_CD
                                                               ) AS BKG_POL_SEQ,
                                                            SPAR.POD_CD,
															SPAR.POD_CLPT_IND_SEQ,

                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------
                                                               (
                                                               SELECT   T1.CLPT_SEQ
                                                               FROM     VSK_VSL_PORT_SKD             T1
                                                               WHERE    T1.VSL_CD                    = SPAR.VSL_CD
                                                               AND      T1.SKD_VOY_NO                = SPAR.SKD_VOY_NO
                                                               AND      T1.SKD_DIR_CD                = SPAR.SKD_DIR_CD
                                                               AND      T1.VPS_PORT_CD               = SPAR.POD_CD
                                                               AND      T1.CLPT_IND_SEQ              = NVL(SPAR.POD_CLPT_IND_SEQ,1)
                                                               )		AS BKG_POD_SEQ,                                                               
                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------

                                                           NVL(SPAC.WGT_UT_CD, 'KGS') AS WGT_UT_CD,
                                                           SPAC.IMDG_CLSS_CD,
                                                           SPAC.FLSH_PNT_CDO_TEMP,
                                                           (SELECT IMDG_COMP_GRP_CD FROM SCG_IMDG_UN_NO WHERE  IMDG_UN_NO = SPAC.IMDG_UN_NO AND  IMDG_UN_NO_SEQ = SPAC.IMDG_UN_NO_SEQ) AS IMDG_COMP_GRP_CD,
                                                              SPAC.IMDG_UN_NO,
                                                           SPAC.IMDG_UN_NO_SEQ,
                                                            SUBSTR(SPAC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD,
                                                            SPAC.N1ST_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD1,
                                                            SPAC.N2ND_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD2,
                                                            SPAC.N3RD_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD3,
                                                            SPAC.N4TH_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD4,
                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_WGT), SPAC.NET_WGT) AS NET_WGT,
                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.GRS_WGT), SPAC.GRS_WGT) AS GRS_WGT,
                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_EXPLO_WGT), SPAC.NET_EXPLO_WGT) AS NET_EXPLO_WGT,
                                                           VVPS.VPS_ETA_DT,
                                                           SPAC.IMDG_PCK_GRP_CD
                                                 FROM  SCG_PRNR_APRO_RQST      SPAR,
                                                       SCG_PRNR_APRO_RQST_CGO  SPAC,
                                                       VSK_VSL_PORT_SKD        VVPS
                                                 WHERE 1=1
                                                   AND SPAR.CRR_CD            = SPAC.CRR_CD
                                                   AND SPAR.BKG_REF_NO        = SPAC.BKG_REF_NO
												   AND SPAR.PRNR_CGO_RQST_SEQ = SPAC.PRNR_CGO_RQST_SEQ
                                                   AND SPAR.SPCL_CGO_RQST_SEQ = SPAC.SPCL_CGO_RQST_SEQ
                                                   AND SPAR.VSL_CD            = VVPS.VSL_CD
                                                   AND SPAR.SKD_VOY_NO        = VVPS.SKD_VOY_NO
                                                   AND SPAR.SKD_DIR_CD        = VVPS.SKD_DIR_CD
                                                   --AND NVL(SPAR.POL_CLPT_IND_SEQ,1)  = VVPS.CLPT_IND_SEQ                                                 
                                                   --2016-08-18 ETA from Current Port
                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD
                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD
                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB
                                                                             WHERE SUB.VSL_CD = SPAR.VSL_CD
                                                                             AND   SUB.SKD_VOY_NO = SPAR.SKD_VOY_NO
                                                                             AND   SUB.SKD_DIR_CD = SPAR.SKD_DIR_CD
                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  
                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')
                                                                           )
                                                   --2016-08-18 ETA from Current Port                                                   
                                                   --AND VVPS.TURN_PORT_IND_CD      IN ('Y','N')
                                                   AND SPAR.DG_FLG            = 'Y'
                                                   AND SPAR.LST_RQST_DAT_FLG  = 'Y'
                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'
            
                                                   #if (${auth_flg} == 'P')
                                                   AND    SPAC.AUTH_STS_CD          = 'P'
                                                   #end
                                                   #if (${auth_flg} == 'R')
                                                   AND SPAC.AUTH_STS_CD = 'R'
                                                   #end
                                                   #if (${auth_flg} == 'Y')
                                                   AND SPAC.AUTH_STS_CD             = 'Y'
                                                   #end
                                                   AND SPAC.AUTH_STS_CD IN('P','R','Y')
                                                   --AND SPAC.AUTH_STS_CD IN('Y','N','R','P')
            
                                                   #if (${slan_cd1} != '')
                                                    AND SPAR.SLAN_CD = @[slan_cd1]
                                                   #end
                                                   #if (${imdg_clss_cd} != '')
                                                    AND SPAC.IMDG_CLSS_CD = @[imdg_clss_cd]
                                                   #end
                                                   #if (${vsl_cd} != '')
                                                    AND VVPS.VSL_CD = @[vsl_cd]
                                                   #end
                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')
                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])
                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])
														)
                                                   #end
                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                   #end
            
                                                ) 	A
                                               --ARRIVAL 2016-04-13 WHERE CONDITION START--   

										WHERE	(BKG_POL_SEQ < CUR_PORT_MIN_SEQ AND BKG_POD_SEQ >= CUR_PORT_MIN_SEQ )
                                    			 OR
                                  				(BKG_POL_SEQ < CUR_PORT_MAX_SEQ AND BKG_POD_SEQ >= CUR_PORT_MAX_SEQ)
													
                                               --ARRIVAL 2016-04-13 WHERE CONDITION END--
            --ARRIVAL SELECT 2016-04-13 END   
            
                                    UNION ALL
            
            --DISCHARGE SELECT 2016-04-13 START  
                                      SELECT   A.BKG_NO,
  											   A.DCGO_SEQ,
                                               A.SLAN_CD,
                                               A.VSL_CD,
											   A.VVD,
                                               A.CUR_PORT_CD,
                                               A.CLPT_IND_SEQ,
                                               A.POL_CD,
											   A.POL_CLPT_IND_SEQ,
                                               A.POD_CD,
											   A.POD_CLPT_IND_SEQ,
                                               A.WGT_UT_CD,
                                               A.IMDG_CLSS_CD,
                                               A.FLSH_PNT_CDO_TEMP,
                                               A.IMDG_COMP_GRP_CD,
                                               A.IMDG_UN_NO,
                                               A.IMDG_UN_NO_SEQ,
                                               A.CNTR_TP_CD,
                                               A.IMDG_SUBS_RSK_LBL_CD1,
                                               A.IMDG_SUBS_RSK_LBL_CD2,
                                               A.IMDG_SUBS_RSK_LBL_CD3,
                                               A.IMDG_SUBS_RSK_LBL_CD4,
                                               ---------------------------------
                                                0 AS ARR_NET_WGT, 0 AS ARR_GRS_WGT, 0 AS ARR_NET_EXPLO_WGT,
                                                NET_WGT AS DCHG_NET_WGT, GRS_WGT AS DCHG_GRS_WGT, NET_EXPLO_WGT AS DCHG_NET_EXPLO_WGT,
                                                0 AS LOD_NET_WGT, 0 AS LOD_GRS_WGT, 0 AS LOD_NET_EXPLO_WGT,
                                                0 AS DEP_NET_WGT, 0 AS DEP_GRS_WGT, 0 AS DEP_NET_EXPLO_WGT,
                                               A.VPS_ETA_DT, A.IMDG_PCK_GRP_CD,
                                               '2DISCHARGE' PORT_LMT_KND
                                      FROM (
            
											--=========== TOP.TOP.TOP ==============================================================--
											--=========== TOP.TOP.TOP ==============================================================--
													SELECT	A.BKG_NO               
														,	A.DCGO_SEQ             
														,	A.SLAN_CD              
														,	A.VSL_CD 
                                                        ,   A.VVD             
      													,	A.CUR_PORT_CD
                                                        ,   A.CLPT_IND_SEQ
														,	A.CUR_PORT_MAX_SEQ     
														,	A.CUR_PORT_MIN_SEQ     
														,	A.POL_CD
 														,   A.POL_CLPT_IND_SEQ           
														,	A.BKG_POL_SEQ          
														,	A.POD_CD
                                                        ,   A.POD_CLPT_IND_SEQ                   
														,	A.BKG_POD_SEQ          
														,	A.WGT_UT_CD            
														,	A.IMDG_CLSS_CD         
														,	A.FLSH_PNT_CDO_TEMP    
														,	A.IMDG_COMP_GRP_CD     
														,	A.IMDG_UN_NO           
														,	A.IMDG_UN_NO_SEQ       
														,	A.CNTR_TP_CD           
														,	A.IMDG_SUBS_RSK_LBL_CD1
														,	A.IMDG_SUBS_RSK_LBL_CD2
														,	A.IMDG_SUBS_RSK_LBL_CD3
														,	A.IMDG_SUBS_RSK_LBL_CD4
														,	A.NET_WGT,A.GRS_WGT
														,	A.NET_EXPLO_WGT    
														,	A.VPS_ETA_DT       
														,	A.IMDG_PCK_GRP_CD  
													FROM	(
													        
                                                    SELECT 	A.BKG_NO
                                                    	,	A.DCGO_SEQ
                                                    	,	A.SLAN_CD
                                                    	,	A.VSL_CD
													    ,   A.VVD
                                                    	,	A.CUR_PORT_CD
                                                        ,   A.CLPT_IND_SEQ
                                                    	,	A.CUR_PORT_MAX_SEQ
                                                    	,	A.CUR_PORT_MIN_SEQ
                                                    	,	A.POL_CD
                                                        ,   A.POL_CLPT_IND_SEQ   
                                                    	,	A.BKG_POL_SEQ
                                                    	,	A.POD_CD
                                                        ,   A.POD_CLPT_IND_SEQ    
                                                    	,	A.BKG_POD_SEQ
                                                    	,	A.WGT_UT_CD
                                                    	,	A.IMDG_CLSS_CD
                                                    	,	A.FLSH_PNT_CDO_TEMP
                                                      ,  A.IMDG_COMP_GRP_CD
                                                      ,  A.IMDG_UN_NO
                                                      ,  A.IMDG_UN_NO_SEQ
                                                      ,  A.CNTR_TP_CD
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD1
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD2
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD3
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD4
                                                      ,  A.NET_WGT,A.GRS_WGT
                                                      ,  A.NET_EXPLO_WGT
                                                      ,  A.VPS_ETA_DT
                                                      ,  A.IMDG_PCK_GRP_CD
                                                      ,  ROW_NUMBER() OVER (PARTITION BY NVL(G.BKG_NO,A.BKG_NO), NVL(G.SPCL_CGO_APRO_RQST_SEQ,A.SPCL_CGO_APRO_RQST_SEQ), NVL(G.VSL_PRE_PST_CD,A.VSL_PRE_PST_CD), NVL(G.VSL_SEQ,A.VSL_SEQ), NVL(G.DCGO_SEQ,A.DCGO_SEQ) ORDER BY G.DCGO_SEQ ASC) CORR_AUTH_SEQ
                                                      
                                                      FROM
                                                             (
                                                -- Own BKG`s SPCL CGO Info
                                                SELECT 		SDC.BKG_NO
														,	SDC.SPCL_CGO_APRO_CD,
                                                           SDC.DCGO_SEQ,
                                                           VVPS.SLAN_CD,
                                                           VVPS.VSL_CD,
                                                           (SELECT 
                                                           DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| 
                                                           DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||
                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||
                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD
                                                           FROM VSK_VSL_PORT_SKD 
                                                           WHERE VSL_CD = VVPS.VSL_CD
                                                           AND   SKD_VOY_NO = VVPS.SKD_VOY_NO
                                                           AND   SKD_DIR_CD = VVPS.SKD_DIR_CD
                                                           AND   VPS_PORT_CD = VVPS.VPS_PORT_CD
                                                           AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ
                                                           ) AS VVD,                                                     
                                                           @[plmt_port_cd]  AS CUR_PORT_CD,
                                                           VVPS.CLPT_IND_SEQ,

                                                           (SELECT MAX(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD
                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD
											                   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MAX_SEQ,
                                                           (SELECT MIN(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD
                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD
													           AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                                AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MIN_SEQ,                                                   
                                                           SVAR.POL_CD,
	                                                       SVAR.POL_CLPT_IND_SEQ,    
                                                           (SELECT SVVPS.CLPT_SEQ
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD
                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.CLPT_IND_SEQ = BVD.POL_CLPT_IND_SEQ
                                                               AND SVVPS.VPS_PORT_CD  = BVD.POL_CD
                                                               ) AS BKG_POL_SEQ,
                                                            SVAR.POD_CD,
															SVAR.POD_CLPT_IND_SEQ,

                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------
                                                               (
                                                               SELECT   T1.CLPT_SEQ
                                                               FROM     VSK_VSL_PORT_SKD             T1
                                                               WHERE    T1.VSL_CD                    = BVD.VSL_CD
                                                               AND      T1.SKD_VOY_NO                = BVD.SKD_VOY_NO
                                                               AND      T1.SKD_DIR_CD                = BVD.SKD_DIR_CD
                                                               AND      T1.VPS_PORT_CD               = BVD.POD_CD
                                                               AND      T1.CLPT_IND_SEQ              = BVD.POD_CLPT_IND_SEQ
                                                               )    AS BKG_POD_SEQ,
                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------

                                                           NVL(SDC.WGT_UT_CD, 'KGS') AS WGT_UT_CD,
                                                           SDC.IMDG_CLSS_CD,
                                                           SDC.FLSH_PNT_CDO_TEMP,
                                                           SDC.IMDG_COMP_GRP_CD,
                                                           SDC.IMDG_UN_NO,
                                                           SDC.IMDG_UN_NO_SEQ,
                                                           SUBSTR(SDC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD1,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD2,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD3,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD4,
                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_WGT), SDC.NET_WGT) AS NET_WGT,
                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.GRS_WGT), SDC.GRS_WGT) AS GRS_WGT,
                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_EXPLO_WGT), SDC.NET_EXPLO_WGT) AS NET_EXPLO_WGT,
                                                           VVPS.VPS_ETA_DT, SDC.IMDG_PCK_GRP_CD,
                                                           SVAR.VSL_PRE_PST_CD, SVAR.VSL_SEQ  , SAR.SPCL_CGO_APRO_RQST_SEQ
                                                  FROM BKG_DG_CGO        SDC,
                                                       SCG_APRO_RQST     SAR,
                                                       SCG_VVD_APRO_RQST SVAR,
                                                       BKG_VVD           BVD,
                                                       VSK_VSL_PORT_SKD  VVPS
                                                  WHERE 1 = 1
                                                   AND SDC.BKG_NO                 = SAR.BKG_NO
                                                   AND SAR.BKG_NO                 = SVAR.BKG_NO
                                                   AND SAR.SPCL_CGO_APRO_RQST_SEQ = SVAR.SPCL_CGO_APRO_RQST_SEQ
												   -- BDR 이후 POST VVD만 Request오는 경우 고려, LST_RQST_DAT_FLG='Y' 조건 대신 적용
                                                   AND SVAR.SPCL_CGO_APRO_RQST_SEQ = (SELECT MAX(RV.SPCL_CGO_APRO_RQST_SEQ) 
                                                                            			FROM SCG_VVD_APRO_RQST RV,
                                                                                             SCG_APRO_RQST RV2
                                                                                     	WHERE RV.VSL_CD = BVD.VSL_CD
                                                                                     	AND   RV.SKD_VOY_NO = BVD.SKD_VOY_NO
                                                                                     	AND   RV.SKD_DIR_CD = BVD.SKD_DIR_CD
                                                                                     	AND   RV.BKG_NO = BVD.BKG_NO                                                                                                      
                                                                                        AND   RV2.BKG_No = RV.BKG_NO
                                                                                        AND RV.SPCL_CGO_APRO_RQST_SEQ = RV2.SPCL_CGO_APRO_RQST_SEQ
                                                                                        AND   RV2.SPCL_CGO_CATE_CD = 'DG'
                                                                                       )
                                                   AND SVAR.BKG_NO                = BVD.BKG_NO
                                                   AND SVAR.VSL_PRE_PST_CD        = BVD.VSL_PRE_PST_CD
                                                   AND SVAR.VSL_SEQ               = BVD.VSL_SEQ
                                                   AND SVAR.VSL_CD                = VVPS.VSL_CD
                                                   AND SVAR.SKD_VOY_NO            = VVPS.SKD_VOY_NO
                                                   AND SVAR.SKD_DIR_CD            = VVPS.SKD_DIR_CD
                                                   --2016-08-18 ETA from Current Port
                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD
                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD
                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB
                                                                             WHERE SUB.VSL_CD = SVAR.VSL_CD
                                                                             AND   SUB.SKD_VOY_NO = SVAR.SKD_VOY_NO
                                                                             AND   SUB.SKD_DIR_CD = SVAR.SKD_DIR_CD
                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  
                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')
                                                                           )        
                                                   --2016-08-18 ETA from Current Port
                                                   --AND SVAR.POL_CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ
                                                   AND SDC.SPCL_CGO_APRO_CD IS NOT NULL
                                                   AND SDC.SPCL_CGO_APRO_CD NOT IN ('C','D','N')
                                                   --AND SAR.LST_RQST_DAT_FLG = 'Y'
                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                 AND EXISTS (
                                                              SELECT 1
                                                                FROM BKG_BOOKING C
                                                               WHERE SDC.BKG_NO = C.BKG_NO
                                                                 AND C.BKG_STS_CD <> 'X'
                                                            )
            
                                                   #if (${slan_cd1} != '')
                                                    AND SVAR.SLAN_CD = @[slan_cd1]
                                                   #end
                                                   #if (${imdg_clss_cd} != '')
                                                    AND SDC.IMDG_CLSS_CD = @[imdg_clss_cd]
                                                   #end
                                                   #if (${vsl_cd} != '')
                                                    AND VVPS.VSL_CD = @[vsl_cd]
                                                   #end
                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')
                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])
                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])
														)
                                                   #end
                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                   #end
            
                                                    ) A
                        						,  SCG_AUTHORIZATION G

                                             WHERE   A.BKG_NO                             = G.BKG_NO           (+)
                                             AND   A.SPCL_CGO_APRO_RQST_SEQ       = G.SPCL_CGO_APRO_RQST_SEQ   (+)
                                             AND   A.VSL_PRE_PST_CD                   = G.VSL_PRE_PST_CD       (+)
                                             AND   A.VSL_SEQ                           = G.VSL_SEQ         (+)
                                             AND   A.DCGO_SEQ                     = G.DCGO_SEQ         (+)
            
                                             #if (${auth_flg} == 'P')
                                              AND  G.SPCL_CGO_AUTH_CD                 = 'P'
                                             #end
                                             #if (${auth_flg} == 'R')
                                              AND  NVL(G.SPCL_CGO_AUTH_CD,'R')     = 'R'
                                             #end
                                             #if (${auth_flg} == 'Y')
                                              AND  G.SPCL_CGO_AUTH_CD                 = 'Y'
                                             #end

                                              AND   A.SPCL_CGO_APRO_CD           IN ('P','R','Y')
                                              
                                              ) A
                                              WHERE CORR_AUTH_SEQ                = 1
											--=========== TOP.TOP.TOP ==============================================================--
											--=========== TOP.TOP.TOP ==============================================================--


                                                UNION ALL
            

                                                -- Partner Lines SPCL CGO Info
                                                SELECT SPAR.BKG_REF_NO,
                                                       SPAC.DCGO_SEQ,
                                                       SPAR.SLAN_CD,
                                                       SPAR.VSL_CD,
                                                       (SELECT 
                                                        DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| 
                                                        DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||
                                                        DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||
                                                        DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD
                                                        FROM VSK_VSL_PORT_SKD 
                                                        WHERE VSL_CD = VVPS.VSL_CD
                                                        AND   SKD_VOY_NO = VVPS.SKD_VOY_NO
                                                        AND   SKD_DIR_CD = VVPS.SKD_DIR_CD
                                                        AND   VPS_PORT_CD = VVPS.VPS_PORT_CD
                                                        AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ
                                                        ) AS VVD,
														@[plmt_port_cd]	AS CUR_PORT_CD,
                                                        VVPS.CLPT_IND_SEQ,
                                                           (SELECT MAX(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD
                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD
															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MAX_SEQ,
                                                           (SELECT MIN(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD
                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MIN_SEQ,                                                   
                                                           SPAR.POL_CD,
														   SPAR.POL_CLPT_IND_SEQ,
                                                           (SELECT SVVPS.CLPT_SEQ
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD
                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD
														       AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.CLPT_IND_SEQ = NVL(SPAR.POL_CLPT_IND_SEQ,1)
                                                               AND SVVPS.VPS_PORT_CD  = SPAR.POL_CD
                                                               ) AS BKG_POL_SEQ,
                                                            SPAR.POD_CD,
															SPAR.POD_CLPT_IND_SEQ,

                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------
                                                               (
                                                               SELECT   T1.CLPT_SEQ
                                                               FROM     VSK_VSL_PORT_SKD             T1
                                                               WHERE    T1.VSL_CD                    = SPAR.VSL_CD
                                                               AND      T1.SKD_VOY_NO                = SPAR.SKD_VOY_NO
                                                               AND      T1.SKD_DIR_CD                = SPAR.SKD_DIR_CD
                                                               AND      T1.VPS_PORT_CD               = SPAR.POD_CD
                                                               AND      T1.CLPT_IND_SEQ              = NVL(SPAR.POD_CLPT_IND_SEQ,1)
                                                               )		AS BKG_POD_SEQ,                                                               
                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------

                                                           NVL(SPAC.WGT_UT_CD, 'KGS') AS WGT_UT_CD,
                                                           SPAC.IMDG_CLSS_CD,
                                                           SPAC.FLSH_PNT_CDO_TEMP,
                                                           (SELECT IMDG_COMP_GRP_CD FROM SCG_IMDG_UN_NO WHERE  IMDG_UN_NO = SPAC.IMDG_UN_NO AND  IMDG_UN_NO_SEQ = SPAC.IMDG_UN_NO_SEQ) AS IMDG_COMP_GRP_CD,
                                                              SPAC.IMDG_UN_NO,
                                                           SPAC.IMDG_UN_NO_SEQ,
                                                            SUBSTR(SPAC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD,
                                                            SPAC.N1ST_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD1,
                                                            SPAC.N2ND_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD2,
                                                            SPAC.N3RD_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD3,
                                                            SPAC.N4TH_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD4,
                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_WGT), SPAC.NET_WGT) AS NET_WGT,
                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.GRS_WGT), SPAC.GRS_WGT) AS GRS_WGT,
                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_EXPLO_WGT), SPAC.NET_EXPLO_WGT) AS NET_EXPLO_WGT,
                                                           VVPS.VPS_ETA_DT,
                                                           SPAC.IMDG_PCK_GRP_CD
                                                 FROM  SCG_PRNR_APRO_RQST      SPAR,
                                                       SCG_PRNR_APRO_RQST_CGO  SPAC,
                                                       VSK_VSL_PORT_SKD        VVPS
                                                 WHERE 1=1
                                                   AND SPAR.CRR_CD            = SPAC.CRR_CD
                                                   AND SPAR.BKG_REF_NO        = SPAC.BKG_REF_NO
												   AND SPAR.PRNR_CGO_RQST_SEQ = SPAC.PRNR_CGO_RQST_SEQ
                                                   AND SPAR.SPCL_CGO_RQST_SEQ = SPAC.SPCL_CGO_RQST_SEQ
                                                   AND SPAR.VSL_CD            = VVPS.VSL_CD
                                                   AND SPAR.SKD_VOY_NO        = VVPS.SKD_VOY_NO
                                                   AND SPAR.SKD_DIR_CD        = VVPS.SKD_DIR_CD
                                                   --AND NVL(SPAR.POL_CLPT_IND_SEQ,1)  = VVPS.CLPT_IND_SEQ                                                 
                                                   --2016-08-18 ETA from Current Port
                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD
                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD
                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB
                                                                             WHERE SUB.VSL_CD = SPAR.VSL_CD
                                                                             AND   SUB.SKD_VOY_NO = SPAR.SKD_VOY_NO
                                                                             AND   SUB.SKD_DIR_CD = SPAR.SKD_DIR_CD
                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  
                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')
                                                                           )
                                                   --2016-08-18 ETA from Current Port                                                   
                                                   --AND VVPS.TURN_PORT_IND_CD      IN ('Y','N')
                                                   AND SPAR.DG_FLG            = 'Y'
                                                   AND SPAR.LST_RQST_DAT_FLG  = 'Y'
                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'
            
                                                   #if (${auth_flg} == 'P')
                                                   AND    SPAC.AUTH_STS_CD          = 'P'
                                                   #end
                                                   #if (${auth_flg} == 'R')
                                                   AND SPAC.AUTH_STS_CD = 'R'
                                                   #end
                                                   #if (${auth_flg} == 'Y')
                                                   AND SPAC.AUTH_STS_CD             = 'Y'
                                                   #end
                                                   AND SPAC.AUTH_STS_CD IN('P','R','Y')
                                                   --AND SPAC.AUTH_STS_CD IN('Y','N','R','P')
            
                                                   #if (${slan_cd1} != '')
                                                    AND SPAR.SLAN_CD = @[slan_cd1]
                                                   #end
                                                   #if (${imdg_clss_cd} != '')
                                                    AND SPAC.IMDG_CLSS_CD = @[imdg_clss_cd]
                                                   #end
                                                   #if (${vsl_cd} != '')
                                                    AND VVPS.VSL_CD = @[vsl_cd]
                                                   #end
                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')
                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])
                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])
														)
                                                   #end
                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                   #end
            
                                                ) 	A
                                         --DISCHARGE 2016-04-13 WHERE CONDITION START--       
                                         WHERE 	(BKG_POD_SEQ = CUR_PORT_MIN_SEQ OR BKG_POD_SEQ = CUR_PORT_MAX_SEQ)
										   AND  POD_CLPT_IND_SEQ = CLPT_IND_SEQ
                                         
                                         --DISCHARGE 2016-04-13 WHERE CONDITION END--
                                         
            --DISCHARGE SELECT 2016-04-13 END     
            
                                    UNION ALL
                                    
            --LOAD SELECT 2016-04-13 START
            
                                   SELECT A.BKG_NO, A.DCGO_SEQ,
                                              A.SLAN_CD,
                                              A.VSL_CD,
											  A.VVD,
                                              A.CUR_PORT_CD,
                                              A.CLPT_IND_SEQ,
                                              A.POL_CD,
											  A.POL_CLPT_IND_SEQ,
                                              A.POD_CD,
											  A.POD_CLPT_IND_SEQ,
                                              A.WGT_UT_CD,
                                              A.IMDG_CLSS_CD,
                                              A.FLSH_PNT_CDO_TEMP,
                                              A.IMDG_COMP_GRP_CD,
                                              A.IMDG_UN_NO,
                                              A.IMDG_UN_NO_SEQ,
                                              A.CNTR_TP_CD,
                                              A.IMDG_SUBS_RSK_LBL_CD1,
                                              A.IMDG_SUBS_RSK_LBL_CD2,
                                              A.IMDG_SUBS_RSK_LBL_CD3,
                                              A.IMDG_SUBS_RSK_LBL_CD4,
                                              0 AS ARR_NET_WGT, 0 AS ARR_GRS_WGT, 0 AS ARR_NET_EXPLO_WGT,
                                              0 AS DCHG_NET_WGT, 0 AS DCHG_GRS_WGT, 0 AS DCHG_NET_EXPLO_WGT,
                                              NET_WGT AS LOD_NET_WGT, GRS_WGT AS LOD_GRS_WGT, NET_EXPLO_WGT AS LOD_NET_EXPLO_WGT,
                                              0 AS DEP_NET_WGT, 0 AS DEP_GRS_WGT, 0 AS DEP_NET_EXPLO_WGT,
                                              A.VPS_ETA_DT, A.IMDG_PCK_GRP_CD,
                                               '3LOAD' PORT_LMT_KND
                                      FROM (
            
											--=========== TOP.TOP.TOP ==============================================================--
											--=========== TOP.TOP.TOP ==============================================================--
													SELECT	A.BKG_NO               
														,	A.DCGO_SEQ             
														,	A.SLAN_CD              
														,	A.VSL_CD  
														,   A.VVD             
     													,	A.CUR_PORT_CD
                                                        ,   A.CLPT_IND_SEQ
														,	A.CUR_PORT_MAX_SEQ     
														,	A.CUR_PORT_MIN_SEQ     
														,	A.POL_CD
 														,   A.POL_CLPT_IND_SEQ           
														,	A.BKG_POL_SEQ          
														,	A.POD_CD
                                                        ,   A.POD_CLPT_IND_SEQ                   
														,	A.BKG_POD_SEQ          
														,	A.WGT_UT_CD            
														,	A.IMDG_CLSS_CD         
														,	A.FLSH_PNT_CDO_TEMP    
														,	A.IMDG_COMP_GRP_CD     
														,	A.IMDG_UN_NO           
														,	A.IMDG_UN_NO_SEQ       
														,	A.CNTR_TP_CD           
														,	A.IMDG_SUBS_RSK_LBL_CD1
														,	A.IMDG_SUBS_RSK_LBL_CD2
														,	A.IMDG_SUBS_RSK_LBL_CD3
														,	A.IMDG_SUBS_RSK_LBL_CD4
														,	A.NET_WGT,A.GRS_WGT
														,	A.NET_EXPLO_WGT    
														,	A.VPS_ETA_DT       
														,	A.IMDG_PCK_GRP_CD  
													FROM	(
													        
                                                    SELECT 	A.BKG_NO
                                                    	,	A.DCGO_SEQ
                                                    	,	A.SLAN_CD
                                                    	,	A.VSL_CD
														,   A.VVD
                                                    	,	A.CUR_PORT_CD
                                                        ,   A.CLPT_IND_SEQ
                                                    	,	A.CUR_PORT_MAX_SEQ
                                                    	,	A.CUR_PORT_MIN_SEQ
                                                    	,	A.POL_CD
                                                        ,   A.POL_CLPT_IND_SEQ   
                                                    	,	A.BKG_POL_SEQ
                                                    	,	A.POD_CD
                                                        ,   A.POD_CLPT_IND_SEQ    
                                                    	,	A.BKG_POD_SEQ
                                                    	,	A.WGT_UT_CD
                                                    	,	A.IMDG_CLSS_CD
                                                    	,	A.FLSH_PNT_CDO_TEMP
                                                      ,  A.IMDG_COMP_GRP_CD
                                                      ,  A.IMDG_UN_NO
                                                      ,  A.IMDG_UN_NO_SEQ
                                                      ,  A.CNTR_TP_CD
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD1
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD2
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD3
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD4
                                                      ,  A.NET_WGT,A.GRS_WGT
                                                      ,  A.NET_EXPLO_WGT
                                                      ,  A.VPS_ETA_DT
                                                      ,  A.IMDG_PCK_GRP_CD
                                                      ,  ROW_NUMBER() OVER (PARTITION BY NVL(G.BKG_NO,A.BKG_NO), NVL(G.SPCL_CGO_APRO_RQST_SEQ,A.SPCL_CGO_APRO_RQST_SEQ), NVL(G.VSL_PRE_PST_CD,A.VSL_PRE_PST_CD), NVL(G.VSL_SEQ,A.VSL_SEQ), NVL(G.DCGO_SEQ,A.DCGO_SEQ) ORDER BY G.DCGO_SEQ ASC) CORR_AUTH_SEQ
                                                      
                                                      FROM
                                                             (
                                                -- Own BKG`s SPCL CGO Info
                                                SELECT 		SDC.BKG_NO
														,	SDC.SPCL_CGO_APRO_CD,
                                                           SDC.DCGO_SEQ,
                                                           VVPS.SLAN_CD,
                                                           VVPS.VSL_CD,
                                                           (SELECT 
                                                           DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| 
                                                           DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||
                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||
                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD
                                                           FROM VSK_VSL_PORT_SKD 
                                                           WHERE VSL_CD = VVPS.VSL_CD
                                                           AND   SKD_VOY_NO = VVPS.SKD_VOY_NO
                                                           AND   SKD_DIR_CD = VVPS.SKD_DIR_CD
                                                           AND   VPS_PORT_CD = VVPS.VPS_PORT_CD
                                                           AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ
                                                           ) AS VVD,
                                                          
                                                           @[plmt_port_cd]  AS CUR_PORT_CD,
                                                           VVPS.CLPT_IND_SEQ,

                                                           (SELECT MAX(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD
                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD
															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MAX_SEQ,
                                                           (SELECT MIN(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD
                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD
															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                                AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MIN_SEQ,                                                   
                                                           SVAR.POL_CD,
	                                                       SVAR.POL_CLPT_IND_SEQ,    
                                                           (SELECT SVVPS.CLPT_SEQ
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD
                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.CLPT_IND_SEQ = BVD.POL_CLPT_IND_SEQ
                                                               AND SVVPS.VPS_PORT_CD  = BVD.POL_CD
                                                               ) AS BKG_POL_SEQ,
                                                            SVAR.POD_CD,
															SVAR.POD_CLPT_IND_SEQ,

                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------
                                                               (
                                                               SELECT   T1.CLPT_SEQ
                                                               FROM     VSK_VSL_PORT_SKD             T1
                                                               WHERE    T1.VSL_CD                    = BVD.VSL_CD
                                                               AND      T1.SKD_VOY_NO                = BVD.SKD_VOY_NO
                                                               AND      T1.SKD_DIR_CD                = BVD.SKD_DIR_CD
                                                               AND      T1.VPS_PORT_CD               = BVD.POD_CD
                                                               AND      T1.CLPT_IND_SEQ              = BVD.POD_CLPT_IND_SEQ
                                                               )    AS BKG_POD_SEQ,
                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------

                                                           NVL(SDC.WGT_UT_CD, 'KGS') AS WGT_UT_CD,
                                                           SDC.IMDG_CLSS_CD,
                                                           SDC.FLSH_PNT_CDO_TEMP,
                                                           SDC.IMDG_COMP_GRP_CD,
                                                           SDC.IMDG_UN_NO,
                                                           SDC.IMDG_UN_NO_SEQ,
                                                           SUBSTR(SDC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD1,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD2,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD3,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD4,
                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_WGT), SDC.NET_WGT) AS NET_WGT,
                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.GRS_WGT), SDC.GRS_WGT) AS GRS_WGT,
                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_EXPLO_WGT), SDC.NET_EXPLO_WGT) AS NET_EXPLO_WGT,
                                                           VVPS.VPS_ETA_DT, SDC.IMDG_PCK_GRP_CD,
                                                           SVAR.VSL_PRE_PST_CD, SVAR.VSL_SEQ  , SAR.SPCL_CGO_APRO_RQST_SEQ
                                                  FROM BKG_DG_CGO        SDC,
                                                       SCG_APRO_RQST     SAR,
                                                       SCG_VVD_APRO_RQST SVAR,
                                                       BKG_VVD           BVD,
                                                       VSK_VSL_PORT_SKD  VVPS
                                                  WHERE 1 = 1
                                                   AND SDC.BKG_NO                 = SAR.BKG_NO
                                                   AND SAR.BKG_NO                 = SVAR.BKG_NO
                                                   AND SAR.SPCL_CGO_APRO_RQST_SEQ = SVAR.SPCL_CGO_APRO_RQST_SEQ
												   -- BDR 이후 POST VVD만 Request오는 경우 고려, LST_RQST_DAT_FLG='Y' 조건 대신 적용
                                                   AND SVAR.SPCL_CGO_APRO_RQST_SEQ = (SELECT MAX(RV.SPCL_CGO_APRO_RQST_SEQ) 
                                                                            			FROM SCG_VVD_APRO_RQST RV,
                                                                                             SCG_APRO_RQST RV2
                                                                                     	WHERE RV.VSL_CD = BVD.VSL_CD
                                                                                     	AND   RV.SKD_VOY_NO = BVD.SKD_VOY_NO
                                                                                     	AND   RV.SKD_DIR_CD = BVD.SKD_DIR_CD
                                                                                     	AND   RV.BKG_NO = BVD.BKG_NO                                                                                                      
                                                                                        AND   RV2.BKG_No = RV.BKG_NO
                                                                                        AND RV.SPCL_CGO_APRO_RQST_SEQ = RV2.SPCL_CGO_APRO_RQST_SEQ
                                                                                        AND   RV2.SPCL_CGO_CATE_CD = 'DG'
                                                                                       )
                                                   AND SVAR.BKG_NO                = BVD.BKG_NO
                                                   AND SVAR.VSL_PRE_PST_CD        = BVD.VSL_PRE_PST_CD
                                                   AND SVAR.VSL_SEQ               = BVD.VSL_SEQ
                                                   AND SVAR.VSL_CD                = VVPS.VSL_CD
                                                   AND SVAR.SKD_VOY_NO            = VVPS.SKD_VOY_NO
                                                   AND SVAR.SKD_DIR_CD            = VVPS.SKD_DIR_CD
                                                   --2016-08-18 ETA from Current Port
                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD
                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD
                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB
                                                                             WHERE SUB.VSL_CD = SVAR.VSL_CD
                                                                             AND   SUB.SKD_VOY_NO = SVAR.SKD_VOY_NO
                                                                             AND   SUB.SKD_DIR_CD = SVAR.SKD_DIR_CD
                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  
                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')
                                                                           )        
                                                   --2016-08-18 ETA from Current Port
                                                   --AND SVAR.POL_CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ
                                                   AND SDC.SPCL_CGO_APRO_CD IS NOT NULL
                                                   AND SDC.SPCL_CGO_APRO_CD NOT IN ('C','D','N')
                                                   --AND SAR.LST_RQST_DAT_FLG = 'Y'
                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                 AND EXISTS (
                                                              SELECT 1
                                                                FROM BKG_BOOKING C
                                                               WHERE SDC.BKG_NO = C.BKG_NO
                                                                 AND C.BKG_STS_CD <> 'X'
                                                            )
            
                                                   #if (${slan_cd1} != '')
                                                    AND SVAR.SLAN_CD = @[slan_cd1]
                                                   #end
                                                   #if (${imdg_clss_cd} != '')
                                                    AND SDC.IMDG_CLSS_CD = @[imdg_clss_cd]
                                                   #end
                                                   #if (${vsl_cd} != '')
                                                    AND VVPS.VSL_CD = @[vsl_cd]
                                                   #end
                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')
                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])
                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])
														)
                                                   #end
                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                   #end
            
                                                    ) A
                        						,  SCG_AUTHORIZATION G

                                             WHERE   A.BKG_NO                             = G.BKG_NO           (+)
                                             AND   A.SPCL_CGO_APRO_RQST_SEQ       = G.SPCL_CGO_APRO_RQST_SEQ   (+)
                                             AND   A.VSL_PRE_PST_CD                   = G.VSL_PRE_PST_CD       (+)
                                             AND   A.VSL_SEQ                           = G.VSL_SEQ         (+)
                                             AND   A.DCGO_SEQ                     = G.DCGO_SEQ         (+)
            
                                             #if (${auth_flg} == 'P')
                                              AND  G.SPCL_CGO_AUTH_CD                 = 'P'
                                             #end
                                             #if (${auth_flg} == 'R')
                                              AND  NVL(G.SPCL_CGO_AUTH_CD,'R')     = 'R'
                                             #end
                                             #if (${auth_flg} == 'Y')
                                              AND  G.SPCL_CGO_AUTH_CD                 = 'Y'
                                             #end

                                              AND   A.SPCL_CGO_APRO_CD           IN ('P','R','Y')
                                              
                                              ) A
                                              WHERE CORR_AUTH_SEQ                = 1
											--=========== TOP.TOP.TOP ==============================================================--
											--=========== TOP.TOP.TOP ==============================================================--


                                                UNION ALL
            

                                                -- Partner Lines SPCL CGO Info
                                                SELECT SPAR.BKG_REF_NO,
                                                       SPAC.DCGO_SEQ,
                                                       SPAR.SLAN_CD,
                                                       SPAR.VSL_CD,
                                                       (SELECT 
                                                        DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| 
                                                        DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||
                                                        DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||
                                                        DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD
                                                        FROM VSK_VSL_PORT_SKD 
                                                        WHERE VSL_CD = VVPS.VSL_CD
                                                        AND   SKD_VOY_NO = VVPS.SKD_VOY_NO
                                                        AND   SKD_DIR_CD = VVPS.SKD_DIR_CD
                                                        AND   VPS_PORT_CD = VVPS.VPS_PORT_CD
                                                        AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ
                                                        ) AS VVD,
														@[plmt_port_cd]	AS CUR_PORT_CD,
                                                        VVPS.CLPT_IND_SEQ,
                                                           (SELECT MAX(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD
                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD
														       AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MAX_SEQ,
                                                           (SELECT MIN(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD
                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD
	                                                           AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MIN_SEQ,                                                   
                                                           SPAR.POL_CD,
														   SPAR.POL_CLPT_IND_SEQ,
                                                           (SELECT SVVPS.CLPT_SEQ
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD
                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.CLPT_IND_SEQ = NVL(SPAR.POL_CLPT_IND_SEQ,1)
                                                               AND SVVPS.VPS_PORT_CD  = SPAR.POL_CD
                                                               ) AS BKG_POL_SEQ,
                                                            SPAR.POD_CD,
															SPAR.POD_CLPT_IND_SEQ,

                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------
                                                               (
                                                               SELECT   T1.CLPT_SEQ
                                                               FROM     VSK_VSL_PORT_SKD             T1
                                                               WHERE    T1.VSL_CD                    = SPAR.VSL_CD
                                                               AND      T1.SKD_VOY_NO                = SPAR.SKD_VOY_NO
                                                               AND      T1.SKD_DIR_CD                = SPAR.SKD_DIR_CD
                                                               AND      T1.VPS_PORT_CD               = SPAR.POD_CD
                                                               AND      T1.CLPT_IND_SEQ              = NVL(SPAR.POD_CLPT_IND_SEQ,1)
                                                               )		AS BKG_POD_SEQ,                                                               
                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------

                                                           NVL(SPAC.WGT_UT_CD, 'KGS') AS WGT_UT_CD,
                                                           SPAC.IMDG_CLSS_CD,
                                                           SPAC.FLSH_PNT_CDO_TEMP,
                                                           (SELECT IMDG_COMP_GRP_CD FROM SCG_IMDG_UN_NO WHERE  IMDG_UN_NO = SPAC.IMDG_UN_NO AND  IMDG_UN_NO_SEQ = SPAC.IMDG_UN_NO_SEQ) AS IMDG_COMP_GRP_CD,
                                                              SPAC.IMDG_UN_NO,
                                                           SPAC.IMDG_UN_NO_SEQ,
                                                            SUBSTR(SPAC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD,
                                                            SPAC.N1ST_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD1,
                                                            SPAC.N2ND_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD2,
                                                            SPAC.N3RD_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD3,
                                                            SPAC.N4TH_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD4,
                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_WGT), SPAC.NET_WGT) AS NET_WGT,
                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.GRS_WGT), SPAC.GRS_WGT) AS GRS_WGT,
                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_EXPLO_WGT), SPAC.NET_EXPLO_WGT) AS NET_EXPLO_WGT,
                                                           VVPS.VPS_ETA_DT,
                                                           SPAC.IMDG_PCK_GRP_CD
                                                 FROM  SCG_PRNR_APRO_RQST      SPAR,
                                                       SCG_PRNR_APRO_RQST_CGO  SPAC,
                                                       VSK_VSL_PORT_SKD        VVPS
                                                 WHERE 1=1
                                                   AND SPAR.CRR_CD            = SPAC.CRR_CD
                                                   AND SPAR.BKG_REF_NO        = SPAC.BKG_REF_NO
												   AND SPAR.PRNR_CGO_RQST_SEQ = SPAC.PRNR_CGO_RQST_SEQ
                                                   AND SPAR.SPCL_CGO_RQST_SEQ = SPAC.SPCL_CGO_RQST_SEQ
                                                   AND SPAR.VSL_CD            = VVPS.VSL_CD
                                                   AND SPAR.SKD_VOY_NO        = VVPS.SKD_VOY_NO
                                                   AND SPAR.SKD_DIR_CD        = VVPS.SKD_DIR_CD
                                                   --AND NVL(SPAR.POL_CLPT_IND_SEQ,1)  = VVPS.CLPT_IND_SEQ                                                 
                                                   --2016-08-18 ETA from Current Port
                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD
                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD
                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB
                                                                             WHERE SUB.VSL_CD = SPAR.VSL_CD
                                                                             AND   SUB.SKD_VOY_NO = SPAR.SKD_VOY_NO
                                                                             AND   SUB.SKD_DIR_CD = SPAR.SKD_DIR_CD
                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  
                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')
                                                                           )
                                                   --2016-08-18 ETA from Current Port                                                   
                                                   --AND VVPS.TURN_PORT_IND_CD      IN ('Y','N')
                                                   AND SPAR.DG_FLG            = 'Y'
                                                   AND SPAR.LST_RQST_DAT_FLG  = 'Y'
                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'
            
                                                   #if (${auth_flg} == 'P')
                                                   AND    SPAC.AUTH_STS_CD          = 'P'
                                                   #end
                                                   #if (${auth_flg} == 'R')
                                                   AND SPAC.AUTH_STS_CD = 'R'
                                                   #end
                                                   #if (${auth_flg} == 'Y')
                                                   AND SPAC.AUTH_STS_CD             = 'Y'
                                                   #end
                                                   AND SPAC.AUTH_STS_CD IN('P','R','Y')
                                                   --AND SPAC.AUTH_STS_CD IN('Y','N','R','P')
            
                                                   #if (${slan_cd1} != '')
                                                    AND SPAR.SLAN_CD = @[slan_cd1]
                                                   #end
                                                   #if (${imdg_clss_cd} != '')
                                                    AND SPAC.IMDG_CLSS_CD = @[imdg_clss_cd]
                                                   #end
                                                   #if (${vsl_cd} != '')
                                                    AND VVPS.VSL_CD = @[vsl_cd]
                                                   #end
                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')
                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])
                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])
														)
                                                   #end
                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                   #end
            
                                                ) 	A
                                                 --LOAD 2016-04-13 WHERE CONDITION START--
                                                 WHERE (BKG_POL_SEQ = CUR_PORT_MIN_SEQ OR BKG_POL_SEQ = CUR_PORT_MAX_SEQ)
												   AND POL_CLPT_IND_SEQ = CLPT_IND_SEQ
                                                --LOAD 2016-04-13 WHERE CONDITION END--
             
            --LOAD SELECT 2016-04-13 END 
            
                                        UNION ALL
                                        
            --DEPARTURE SELECT 2016-04-13 START   
            
                                 SELECT A.BKG_NO, A.DCGO_SEQ,
                                              A.SLAN_CD,
                                              A.VSL_CD,
											  A.VVD,
                                              A.CUR_PORT_CD,
                                              A.CLPT_IND_SEQ,
                                              A.POL_CD,
											  A.POL_CLPT_IND_SEQ,
                                              A.POD_CD,
											  A.POD_CLPT_IND_SEQ,
                                              A.WGT_UT_CD,
                                              A.IMDG_CLSS_CD,
                                              A.FLSH_PNT_CDO_TEMP,
                                              A.IMDG_COMP_GRP_CD,
                                              A.IMDG_UN_NO,
                                              A.IMDG_UN_NO_SEQ,
                                              A.CNTR_TP_CD,
                                              A.IMDG_SUBS_RSK_LBL_CD1,
                                              A.IMDG_SUBS_RSK_LBL_CD2,
                                              A.IMDG_SUBS_RSK_LBL_CD3,
                                              A.IMDG_SUBS_RSK_LBL_CD4,
                                              0 AS ARR_NET_WGT, 0 AS ARR_GRS_WGT, 0 AS ARR_NET_EXPLO_WGT,
                                              0 AS DCHG_NET_WGT, 0 AS DCHG_GRS_WGT, 0 AS DCHG_NET_EXPLO_WGT,
                                              0 AS LOD_NET_WGT, 0 AS LOD_GRS_WGT, 0 AS LOD_NET_EXPLO_WGT,
                                              NET_WGT AS DEP_NET_WGT, GRS_WGT AS DEP_GRS_WGT, NET_EXPLO_WGT AS DEP_NET_EXPLO_WGT,
                                              A.VPS_ETA_DT, A.IMDG_PCK_GRP_CD,
                                               '4DEPARTURE' PORT_LMT_KND
                                      FROM (
            
											--=========== TOP.TOP.TOP ==============================================================--
											--=========== TOP.TOP.TOP ==============================================================--
													SELECT	A.BKG_NO               
														,	A.DCGO_SEQ             
														,	A.SLAN_CD              
														,	A.VSL_CD   
														,   A.VVD           
       													,	A.CUR_PORT_CD
                                                        ,   A.CLPT_IND_SEQ
														,	A.CUR_PORT_MAX_SEQ     
														,	A.CUR_PORT_MIN_SEQ     
														,	A.POL_CD
 														,   A.POL_CLPT_IND_SEQ           
														,	A.BKG_POL_SEQ          
														,	A.POD_CD
                                                        ,   A.POD_CLPT_IND_SEQ                   
														,	A.BKG_POD_SEQ          
														,	A.WGT_UT_CD            
														,	A.IMDG_CLSS_CD         
														,	A.FLSH_PNT_CDO_TEMP    
														,	A.IMDG_COMP_GRP_CD     
														,	A.IMDG_UN_NO           
														,	A.IMDG_UN_NO_SEQ       
														,	A.CNTR_TP_CD           
														,	A.IMDG_SUBS_RSK_LBL_CD1
														,	A.IMDG_SUBS_RSK_LBL_CD2
														,	A.IMDG_SUBS_RSK_LBL_CD3
														,	A.IMDG_SUBS_RSK_LBL_CD4
														,	A.NET_WGT,A.GRS_WGT
														,	A.NET_EXPLO_WGT    
														,	A.VPS_ETA_DT       
														,	A.IMDG_PCK_GRP_CD  
													FROM	(
													        
                                                    SELECT 	A.BKG_NO
                                                    	,	A.DCGO_SEQ
                                                    	,	A.SLAN_CD
                                                    	,	A.VSL_CD
														,   A.VVD
                                                    	,	A.CUR_PORT_CD
                                                        ,   A.CLPT_IND_SEQ
                                                    	,	A.CUR_PORT_MAX_SEQ
                                                    	,	A.CUR_PORT_MIN_SEQ
                                                    	,	A.POL_CD
                                                        ,   A.POL_CLPT_IND_SEQ   
                                                    	,	A.BKG_POL_SEQ
                                                    	,	A.POD_CD
                                                        ,   A.POD_CLPT_IND_SEQ    
                                                    	,	A.BKG_POD_SEQ
                                                    	,	A.WGT_UT_CD
                                                    	,	A.IMDG_CLSS_CD
                                                    	,	A.FLSH_PNT_CDO_TEMP
                                                      ,  A.IMDG_COMP_GRP_CD
                                                      ,  A.IMDG_UN_NO
                                                      ,  A.IMDG_UN_NO_SEQ
                                                      ,  A.CNTR_TP_CD
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD1
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD2
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD3
                                                      ,  A.IMDG_SUBS_RSK_LBL_CD4
                                                      ,  A.NET_WGT,A.GRS_WGT
                                                      ,  A.NET_EXPLO_WGT
                                                      ,  A.VPS_ETA_DT
                                                      ,  A.IMDG_PCK_GRP_CD
                                                      ,  ROW_NUMBER() OVER (PARTITION BY NVL(G.BKG_NO,A.BKG_NO), NVL(G.SPCL_CGO_APRO_RQST_SEQ,A.SPCL_CGO_APRO_RQST_SEQ), NVL(G.VSL_PRE_PST_CD,A.VSL_PRE_PST_CD), NVL(G.VSL_SEQ,A.VSL_SEQ), NVL(G.DCGO_SEQ,A.DCGO_SEQ) ORDER BY G.DCGO_SEQ ASC) CORR_AUTH_SEQ
                                                      
                                                      FROM
                                                             (
                                                -- Own BKG`s SPCL CGO Info
                                                SELECT 		SDC.BKG_NO
														,	SDC.SPCL_CGO_APRO_CD,
                                                           SDC.DCGO_SEQ,
                                                           VVPS.SLAN_CD,
                                                           VVPS.VSL_CD,
                                                           (SELECT 
                                                           DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| 
                                                           DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||
                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||
                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD
                                                           FROM VSK_VSL_PORT_SKD 
                                                           WHERE VSL_CD = VVPS.VSL_CD
                                                           AND   SKD_VOY_NO = VVPS.SKD_VOY_NO
                                                           AND   SKD_DIR_CD = VVPS.SKD_DIR_CD
                                                           AND   VPS_PORT_CD = VVPS.VPS_PORT_CD
                                                           AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ
                                                           ) AS VVD,
                                                           
                                                           @[plmt_port_cd]  AS CUR_PORT_CD,
                                                           VVPS.CLPT_IND_SEQ,

                                                           (SELECT MAX(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD
                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD
															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MAX_SEQ,
                                                           (SELECT MIN(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD
                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD
													           AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                                AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MIN_SEQ,                                                   
                                                           SVAR.POL_CD,
	                                                       SVAR.POL_CLPT_IND_SEQ,    
                                                           (SELECT SVVPS.CLPT_SEQ
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD
                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.CLPT_IND_SEQ = BVD.POL_CLPT_IND_SEQ
                                                               AND SVVPS.VPS_PORT_CD  = BVD.POL_CD
                                                               ) AS BKG_POL_SEQ,
                                                            SVAR.POD_CD,
															SVAR.POD_CLPT_IND_SEQ,

                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------
                                                               (
                                                               SELECT   T1.CLPT_SEQ
                                                               FROM     VSK_VSL_PORT_SKD             T1
                                                               WHERE    T1.VSL_CD                    = BVD.VSL_CD
                                                               AND      T1.SKD_VOY_NO                = BVD.SKD_VOY_NO
                                                               AND      T1.SKD_DIR_CD                = BVD.SKD_DIR_CD
                                                               AND      T1.VPS_PORT_CD               = BVD.POD_CD
                                                               AND      T1.CLPT_IND_SEQ              = BVD.POD_CLPT_IND_SEQ
                                                               )    AS BKG_POD_SEQ,
                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------

                                                           NVL(SDC.WGT_UT_CD, 'KGS') AS WGT_UT_CD,
                                                           SDC.IMDG_CLSS_CD,
                                                           SDC.FLSH_PNT_CDO_TEMP,
                                                           SDC.IMDG_COMP_GRP_CD,
                                                           SDC.IMDG_UN_NO,
                                                           SDC.IMDG_UN_NO_SEQ,
                                                           SUBSTR(SDC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD1,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD2,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD3,
                                                           SDC.IMDG_SUBS_RSK_LBL_CD4,
                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_WGT), SDC.NET_WGT) AS NET_WGT,
                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.GRS_WGT), SDC.GRS_WGT) AS GRS_WGT,
                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_EXPLO_WGT), SDC.NET_EXPLO_WGT) AS NET_EXPLO_WGT,
                                                           VVPS.VPS_ETA_DT, SDC.IMDG_PCK_GRP_CD,
                                                           SVAR.VSL_PRE_PST_CD, SVAR.VSL_SEQ  , SAR.SPCL_CGO_APRO_RQST_SEQ
                                                  FROM BKG_DG_CGO        SDC,
                                                       SCG_APRO_RQST     SAR,
                                                       SCG_VVD_APRO_RQST SVAR,
                                                       BKG_VVD           BVD,
                                                       VSK_VSL_PORT_SKD  VVPS
                                                  WHERE 1 = 1
                                                   AND SDC.BKG_NO                 = SAR.BKG_NO
                                                   AND SAR.BKG_NO                 = SVAR.BKG_NO
                                                   AND SAR.SPCL_CGO_APRO_RQST_SEQ = SVAR.SPCL_CGO_APRO_RQST_SEQ
												   -- BDR 이후 POST VVD만 Request오는 경우 고려, LST_RQST_DAT_FLG='Y' 조건 대신 적용
                                                   AND SVAR.SPCL_CGO_APRO_RQST_SEQ = (SELECT MAX(RV.SPCL_CGO_APRO_RQST_SEQ) 
                                                                            			FROM SCG_VVD_APRO_RQST RV,
                                                                                             SCG_APRO_RQST RV2
                                                                                     	WHERE RV.VSL_CD = BVD.VSL_CD
                                                                                     	AND   RV.SKD_VOY_NO = BVD.SKD_VOY_NO
                                                                                     	AND   RV.SKD_DIR_CD = BVD.SKD_DIR_CD
                                                                                     	AND   RV.BKG_NO = BVD.BKG_NO                                                                                                      
                                                                                        AND   RV2.BKG_No = RV.BKG_NO
                                                                                        AND RV.SPCL_CGO_APRO_RQST_SEQ = RV2.SPCL_CGO_APRO_RQST_SEQ
                                                                                        AND   RV2.SPCL_CGO_CATE_CD = 'DG'
                                                                                       )
                                                   AND SVAR.BKG_NO                = BVD.BKG_NO
                                                   AND SVAR.VSL_PRE_PST_CD        = BVD.VSL_PRE_PST_CD
                                                   AND SVAR.VSL_SEQ               = BVD.VSL_SEQ
                                                   AND SVAR.VSL_CD                = VVPS.VSL_CD
                                                   AND SVAR.SKD_VOY_NO            = VVPS.SKD_VOY_NO
                                                   AND SVAR.SKD_DIR_CD            = VVPS.SKD_DIR_CD
                                                   --2016-08-18 ETA from Current Port
                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD
                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD
                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB
                                                                             WHERE SUB.VSL_CD = SVAR.VSL_CD
                                                                             AND   SUB.SKD_VOY_NO = SVAR.SKD_VOY_NO
                                                                             AND   SUB.SKD_DIR_CD = SVAR.SKD_DIR_CD
                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  
                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')
                                                                           )        
                                                   --2016-08-18 ETA from Current Port
                                                   --AND SVAR.POL_CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ
                                                   AND SDC.SPCL_CGO_APRO_CD IS NOT NULL
                                                   AND SDC.SPCL_CGO_APRO_CD NOT IN ('C','D','N')
                                                   --AND SAR.LST_RQST_DAT_FLG = 'Y'
                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                   AND EXISTS (
                                                              SELECT 1
                                                                FROM BKG_BOOKING C
                                                               WHERE SDC.BKG_NO = C.BKG_NO
                                                                 AND C.BKG_STS_CD <> 'X'
                                                            )
            
                                                   #if (${slan_cd1} != '')
                                                    AND SVAR.SLAN_CD = @[slan_cd1]
                                                   #end
                                                   #if (${imdg_clss_cd} != '')
                                                    AND SDC.IMDG_CLSS_CD = @[imdg_clss_cd]
                                                   #end
                                                   #if (${vsl_cd} != '')
                                                    AND VVPS.VSL_CD = @[vsl_cd]
                                                   #end
                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')
                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])
                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])
														)
                                                   #end
                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                   #end
            
                                                    ) A
                        						,  SCG_AUTHORIZATION G

                                             WHERE   A.BKG_NO                             = G.BKG_NO           (+)
                                             AND   A.SPCL_CGO_APRO_RQST_SEQ       = G.SPCL_CGO_APRO_RQST_SEQ   (+)
                                             AND   A.VSL_PRE_PST_CD                   = G.VSL_PRE_PST_CD       (+)
                                             AND   A.VSL_SEQ                           = G.VSL_SEQ         (+)
                                             AND   A.DCGO_SEQ                     = G.DCGO_SEQ         (+)
            
                                             #if (${auth_flg} == 'P')
                                              AND  G.SPCL_CGO_AUTH_CD                 = 'P'
                                             #end
                                             #if (${auth_flg} == 'R')
                                              AND  NVL(G.SPCL_CGO_AUTH_CD,'R')     = 'R'
                                             #end
                                             #if (${auth_flg} == 'Y')
                                              AND  G.SPCL_CGO_AUTH_CD                 = 'Y'
                                             #end

                                              AND   A.SPCL_CGO_APRO_CD           IN ('P','R','Y')
                                              
                                              ) A
                                              WHERE CORR_AUTH_SEQ                = 1
											--=========== TOP.TOP.TOP ==============================================================--
											--=========== TOP.TOP.TOP ==============================================================--


                                                UNION ALL
            

                                                -- Partner Lines SPCL CGO Info
                                                SELECT SPAR.BKG_REF_NO,
                                                       SPAC.DCGO_SEQ,
                                                       SPAR.SLAN_CD,
                                                       SPAR.VSL_CD,
                                                       (SELECT 
                                                       DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| 
                                                       DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||
                                                       DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||
                                                       DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD
                                                       FROM VSK_VSL_PORT_SKD 
                                                       WHERE VSL_CD = VVPS.VSL_CD
                                                       AND   SKD_VOY_NO = VVPS.SKD_VOY_NO
                                                       AND   SKD_DIR_CD = VVPS.SKD_DIR_CD
                                                       AND   VPS_PORT_CD = VVPS.VPS_PORT_CD
                                                       AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ
                                                       ) AS VVD,
														@[plmt_port_cd]	AS CUR_PORT_CD,
                                                        VVPS.CLPT_IND_SEQ,
                                                           (SELECT MAX(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD
                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD
									                           AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MAX_SEQ,
                                                           (SELECT MIN(SVVPS.CLPT_SEQ)
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD
                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD
											                   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]
                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                               #end
                                                               ) AS CUR_PORT_MIN_SEQ,                                                   
                                                           SPAR.POL_CD,
														   SPAR.POL_CLPT_IND_SEQ,
                                                           (SELECT SVVPS.CLPT_SEQ
                                                              FROM VSK_VSL_PORT_SKD  SVVPS
                                                             WHERE 1=1
                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD
                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD
                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO
                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD
                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')
                                                               AND SVVPS.CLPT_IND_SEQ = NVL(SPAR.POL_CLPT_IND_SEQ,1)
                                                               AND SVVPS.VPS_PORT_CD  = SPAR.POL_CD
                                                               ) AS BKG_POL_SEQ,
                                                            SPAR.POD_CD,
															SPAR.POD_CLPT_IND_SEQ,

                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------
                                                               (
                                                               SELECT   T1.CLPT_SEQ
                                                               FROM     VSK_VSL_PORT_SKD             T1
                                                               WHERE    T1.VSL_CD                    = SPAR.VSL_CD
                                                               AND      T1.SKD_VOY_NO                = SPAR.SKD_VOY_NO
                                                               AND      T1.SKD_DIR_CD                = SPAR.SKD_DIR_CD
                                                               AND      T1.VPS_PORT_CD               = SPAR.POD_CD
                                                               AND      T1.CLPT_IND_SEQ              = NVL(SPAR.POD_CLPT_IND_SEQ,1)
                                                               )		AS BKG_POD_SEQ,                                                               
                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------

                                                           NVL(SPAC.WGT_UT_CD, 'KGS') AS WGT_UT_CD,
                                                           SPAC.IMDG_CLSS_CD,
                                                           SPAC.FLSH_PNT_CDO_TEMP,
                                                           (SELECT IMDG_COMP_GRP_CD FROM SCG_IMDG_UN_NO WHERE  IMDG_UN_NO = SPAC.IMDG_UN_NO AND  IMDG_UN_NO_SEQ = SPAC.IMDG_UN_NO_SEQ) AS IMDG_COMP_GRP_CD,
                                                              SPAC.IMDG_UN_NO,
                                                           SPAC.IMDG_UN_NO_SEQ,
                                                            SUBSTR(SPAC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD,
                                                            SPAC.N1ST_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD1,
                                                            SPAC.N2ND_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD2,
                                                            SPAC.N3RD_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD3,
                                                            SPAC.N4TH_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD4,
                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_WGT), SPAC.NET_WGT) AS NET_WGT,
                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.GRS_WGT), SPAC.GRS_WGT) AS GRS_WGT,
                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_EXPLO_WGT), SPAC.NET_EXPLO_WGT) AS NET_EXPLO_WGT,
                                                           VVPS.VPS_ETA_DT,
                                                           SPAC.IMDG_PCK_GRP_CD
                                                 FROM  SCG_PRNR_APRO_RQST      SPAR,
                                                       SCG_PRNR_APRO_RQST_CGO  SPAC,
                                                       VSK_VSL_PORT_SKD        VVPS
                                                 WHERE 1=1
                                                   AND SPAR.CRR_CD            = SPAC.CRR_CD
                                                   AND SPAR.BKG_REF_NO        = SPAC.BKG_REF_NO
												   AND SPAR.PRNR_CGO_RQST_SEQ = SPAC.PRNR_CGO_RQST_SEQ
                                                   AND SPAR.SPCL_CGO_RQST_SEQ = SPAC.SPCL_CGO_RQST_SEQ
                                                   AND SPAR.VSL_CD            = VVPS.VSL_CD
                                                   AND SPAR.SKD_VOY_NO        = VVPS.SKD_VOY_NO
                                                   AND SPAR.SKD_DIR_CD        = VVPS.SKD_DIR_CD
                                                   --AND NVL(SPAR.POL_CLPT_IND_SEQ,1)  = VVPS.CLPT_IND_SEQ                                                 
                                                   --2016-08-18 ETA from Current Port
                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD
                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD
                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB
                                                                             WHERE SUB.VSL_CD = SPAR.VSL_CD
                                                                             AND   SUB.SKD_VOY_NO = SPAR.SKD_VOY_NO
                                                                             AND   SUB.SKD_DIR_CD = SPAR.SKD_DIR_CD
                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  
                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')
                                                                           )
                                                   --2016-08-18 ETA from Current Port                                                   
                                                   --AND VVPS.TURN_PORT_IND_CD      IN ('Y','N')
                                                   AND SPAR.DG_FLG            = 'Y'
                                                   AND SPAR.LST_RQST_DAT_FLG  = 'Y'
                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'
            
                                                   #if (${auth_flg} == 'P')
                                                   AND    SPAC.AUTH_STS_CD          = 'P'
                                                   #end
                                                   #if (${auth_flg} == 'R')
                                                   AND SPAC.AUTH_STS_CD = 'R'
                                                   #end
                                                   #if (${auth_flg} == 'Y')
                                                   AND SPAC.AUTH_STS_CD             = 'Y'
                                                   #end
                                                   AND SPAC.AUTH_STS_CD IN('P','R','Y')
                                                   --AND SPAC.AUTH_STS_CD IN('Y','N','R','P')
            
                                                   #if (${slan_cd1} != '')
                                                    AND SPAR.SLAN_CD = @[slan_cd1]
                                                   #end
                                                   #if (${imdg_clss_cd} != '')
                                                    AND SPAC.IMDG_CLSS_CD = @[imdg_clss_cd]
                                                   #end
                                                   #if (${vsl_cd} != '')
                                                    AND VVPS.VSL_CD = @[vsl_cd]
                                                   #end
                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')
                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])
                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])
														)
                                                   #end
                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')
                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999
                                                   #end
            
                                                ) 	A

                                                 --DEPARTURE 2016-04-13 WHERE CONDITION START--
                                                  WHERE	
														(BKG_POL_SEQ <= CUR_PORT_MIN_SEQ AND BKG_POD_SEQ > CUR_PORT_MIN_SEQ)
                   										OR
                  										(BKG_POL_SEQ <= CUR_PORT_MAX_SEQ AND BKG_POD_SEQ > CUR_PORT_MAX_SEQ)    
											
                                                 --DEPARTURE 2016-04-13 WHERE CONDITION END--                               
            
            --DEPARTURE SELECT 2016-04-13 END 
            
                                         )
                                        GROUP BY BKG_NO, DCGO_SEQ,SLAN_CD,VSL_CD,VVD,CUR_PORT_CD,CLPT_IND_SEQ,POL_CD,POD_CD,WGT_UT_CD,IMDG_CLSS_CD,FLSH_PNT_CDO_TEMP,IMDG_COMP_GRP_CD,IMDG_UN_NO,IMDG_UN_NO_SEQ,
                                                    CNTR_TP_CD,IMDG_SUBS_RSK_LBL_CD1,IMDG_SUBS_RSK_LBL_CD2,IMDG_SUBS_RSK_LBL_CD3,IMDG_SUBS_RSK_LBL_CD4,ARR_NET_WGT,ARR_GRS_WGT,ARR_NET_EXPLO_WGT,
                                                    DCHG_NET_WGT,DCHG_GRS_WGT,DCHG_NET_EXPLO_WGT,LOD_NET_WGT,LOD_GRS_WGT,LOD_NET_EXPLO_WGT,DEP_NET_WGT,DEP_GRS_WGT,DEP_NET_EXPLO_WGT,VPS_ETA_DT,IMDG_PCK_GRP_CD,PORT_LMT_KND
                             )
                        GROUP BY SLAN_CD, VSL_CD, VVD, CUR_PORT_CD,CLPT_IND_SEQ, POL_CD, POD_CD, WGT_UT_CD, IMDG_CLSS_CD, FLSH_PNT_CDO_TEMP, PORT_LMT_KND, VPS_ETA_DT, IMDG_PCK_GRP_CD,
                                  IMDG_COMP_GRP_CD,IMDG_UN_NO, IMDG_UN_NO_SEQ, CNTR_TP_CD, IMDG_SUBS_RSK_LBL_CD1, IMDG_SUBS_RSK_LBL_CD2, IMDG_SUBS_RSK_LBL_CD3, IMDG_SUBS_RSK_LBL_CD4, BKG_NO
            
                    ) DCGO
            --*************************************************************************************************************
            --2016-04-13 END
            --*************************************************************************************************************
            
			WHERE	1 = 1
			AND		PLMT.PORT_CD             				= DCGO.CUR_PORT_CD
			AND		PLMT.PORT_LMT_KND 						= DCGO.PORT_LMT_KND

--      		AND		CASE	WHEN PLMT.IMDG_COMP_GRP_CD IS NOT NULL THEN PLMT.IMDG_CLSS_CD||PLMT.IMDG_COMP_GRP_CD
--                 			ELSE PLMT.IMDG_CLSS_CD
--            		END                             		=	CASE	WHEN PLMT.IMDG_COMP_GRP_CD IS NOT NULL THEN DCGO.IMDG_CLSS_CD||DCGO.IMDG_COMP_GRP_CD
--                                                   						ELSE DCGO.IMDG_CLSS_CD
--                                              					END


      		AND		CASE	WHEN PLMT.IMDG_COMP_GRP_CD IS NOT NULL THEN PLMT.IMDG_CLSS_CD||PLMT.IMDG_COMP_GRP_CD
                 			ELSE 
                                CASE WHEN PLMT.IMDG_CLSS_CD IS NOT NULL THEN PLMT.IMDG_CLSS_CD
                                     ELSE PLMT.IMDG_UN_NO
                                END
            		END			=	CASE	WHEN PLMT.IMDG_COMP_GRP_CD IS NOT NULL THEN DCGO.IMDG_CLSS_CD||DCGO.IMDG_COMP_GRP_CD
                                			ELSE 
                                            	CASE WHEN PLMT.IMDG_CLSS_CD IS NOT NULL THEN DCGO.IMDG_CLSS_CD
                                                	 ELSE DCGO.IMDG_UN_NO
                                                END
                                    END

			AND		(PLMT.IMDG_UN_NO 			IS NULL OR PLMT.IMDG_UN_NO 				=  DCGO.IMDG_UN_NO			)
			AND		(PLMT.CNTR_TP_CD 			IS NULL OR PLMT.CNTR_TP_CD 				=  DCGO.CNTR_TP_CD			)
			AND		(PLMT.IMDG_SUBS_RSK_LBL_CD 	IS NULL OR PLMT.IMDG_SUBS_RSK_LBL_CD 	IN (DCGO.IMDG_SUBS_RSK_LBL_CD1, DCGO.IMDG_SUBS_RSK_LBL_CD2, DCGO.IMDG_SUBS_RSK_LBL_CD3, DCGO.IMDG_SUBS_RSK_LBL_CD4))
			AND		(PLMT.FLSH_PNT_TEMP 		IS NULL OR PLMT.FLSH_PNT_TEMP 			>= DCGO.FLSH_PNT_CDO_TEMP	)
			AND		(PLMT.IMDG_PCK_GRP_CD 		IS NULL OR PLMT.IMDG_PCK_GRP_CD 		=  DCGO.IMDG_PCK_GRP_CD		)
			AND		DCGO.CUR_PORT_CD 						= @[plmt_port_cd]
 			) B
            

			GROUP BY 	PORT_CD
				,		PORT_LMT_SEQ
				,		PORT_LMT_REP_DESC
			
				,		ARRIVAL_BKG_NO
				,		DISCHARGE_BKG_NO
				,		LOAD_BKG_NO
				,		DEPARTURE_BKG_NO    
			
				,		SLAN_CD
				,		CUR_PORT_CD
				,		PIER_TP_CD
				,		VSL_CD
				,       PLMT_VVD
				,   	IMDG_CLSS_CD 
				,		FLSH_PNT_TEMP
				,		IMDG_CLSS_CD_DESC
				,		LMT_WGT_TP_CD
				,		IMDG_COMP_GRP_CD
				,		IMDG_PCK_GRP_CD
				,		IMDG_SUBS_RSK_LBL_CD
				,		IMDG_UN_NO
				,		CNTR_TP_CD
				,		ARR_DEP_PROHI_FLG
				,		LDIS_APLY_TGT_FLG
				,		ARR_MAX_LMT
				,		DCHG_MAX_LMT
				,		LOD_MAX_LMT
				,		DEP_MAX_LMT
				,       PLMT_CLPT_IND_SEQ

				) A
            
			) A
GROUP BY	A.PORT_CD
		,	A.PORT_LMT_SEQ
		,	A.PORT_LMT_REP_DESC
		,	A.LMT_WGT_TP_CD
		,	A.VSL_CD
		,   A.PLMT_VVD 
		,	A.SLAN_CD
		,	A.CUR_PORT_CD
		,	A.PIER_TP_CD
		,	A.FLSH_PNT_TEMP 
		,   PLMT_CLPT_IND_SEQ

ORDER BY 	(	SELECT 	B.DP_SEQ 
				FROM 	SCG_IMDG_PORT_LMT_MST 	B
      			WHERE 	B.PORT_CD 				= A.PORT_CD 
				AND 	B.LMT_WGT_TP_CD 		= DECODE(A.LMT_WGT_TP_CD, 'GROSS', 'GR', 'NET', 'NT', 'NET POWDER', 'NP', NULL) 
				AND 	B.PORT_LMT_SEQ 			= A.PORT_LMT_SEQ
			)
 
              	
			--==========================================================================================================
			) 			]]></sql>
			<params>
				<param name="plmt_port_cd" type="12" value="" out="N"/>
				<param name="from_eta_dt" type="12" value="" out="N"/>
				<param name="to_eta_dt" type="12" value="" out="N"/>
				<param name="slan_cd1" type="12" value="" out="N"/>
				<param name="imdg_clss_cd" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
