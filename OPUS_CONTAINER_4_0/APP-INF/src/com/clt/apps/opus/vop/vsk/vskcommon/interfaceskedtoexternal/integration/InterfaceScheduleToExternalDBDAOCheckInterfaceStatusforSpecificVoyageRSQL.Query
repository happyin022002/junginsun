<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InterfaceScheduleToExternalDBDAOCheckInterfaceStatusforSpecificVoyageRSQL">
			<desc><![CDATA[Voyage 기준의 VIPS I/F 확인]]></desc>
			<sql><![CDATA[
SELECT      NVL(MAX(Y.INSF_CNQE_VAL)	,'*')   AS INSF_CNQE_VAL      	--: 'S':SUCCESS, 'E':ERROR :-
         ,  NVL(MAX(Y.INSF_DV_CD)		,'*')   AS INSF_DV_CD         	--: 'I':INSERT, 'U':UPDATE, 'D':DELETE :--
         ,  NVL(MAX(Y.VIPS_IF_TGT_FLG)	,'*')  	AS VIPS_IF_TGT_FLG    	--: 'Y':To be interfaced, 'N':Interfaced already :-- 
         ,  MAX(Y.VIPS_IF_SEQ)               	AS VIPS_IF_SEQ
         ,  NVL(MAX(Y.LATEST_IF_RSLT_CD),'*') 	AS LATEST_IF_RSLT_CD 	--: 'S':SUCCESS, 'E':ERROR :-
		 ,  NVL(MAX(Y.LATEST_INSF_DV_CD),'*') 	AS LATEST_INSF_DV_CD 	--: 'I':INSERT, 'U':UPDATE, 'D':DELETE :--
         
         ,  MAX(Y.VSL_CD)                     	AS VSL_CD
         ,  MAX(Y.SKD_VOY_NO)                 	AS SKD_VOY_NO
FROM        (
            ----------------------------------------------------------------------
            SELECT		XX.INSF_CNQE_VAL  
					,	XX.INSF_DV_CD    
                    ,   XX.VIPS_IF_TGT_FLG   
                    ,   XX.VIPS_IF_SEQ
                	
          			,	XX.INSF_CNQE_VAL LATEST_IF_RSLT_CD                   
          			,	XX.INSF_DV_CD LATEST_INSF_DV_CD   

                    ,  	XX.VSL_CD
					,	XX.SKD_VOY_NO               
            FROM       VSK_VSL_SKD_VIPS_IF_HDR   			XX
            WHERE      XX.VSL_CD                  			= @[vsl_cd]
            AND        XX.SKD_VOY_NO              			= @[skd_voy_no]   
            AND        XX.VIPS_IF_SEQ                   	= (	SELECT   MAX(HH.VIPS_IF_SEQ)
                                                             	FROM     VSK_VSL_SKD_VIPS_IF_HDR   HH
                                                             	WHERE    HH.VSL_CD                 = XX.VSL_CD
                                                             	AND      HH.SKD_VOY_NO             = XX.SKD_VOY_NO
                                                             	--AND      HH.INSF_CNQE_VAL          IS NOT NULL
																AND      HH.INSF_CNQE_VAL          = 'S'	--:SUCCESS:--
                                                               )  
            ----------------------------------------------------------------------
            ) Y			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
