<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TerminalDepartureReportDBDAOLoadImportSGVORSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
SELECT 		COM_ConstantMgr_PKG.COM_getCompanyCode_FNC() AS OPR_CD
	,		V.POD_CD AS POD

	--,		SUM(DECODE(C.DCGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,1,0),0))             DG_20_QTY
	--,		SUM(DECODE(C.DCGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,C.CNTR_WGT,0),0))    DG_20_WGT
	--,		SUM(DECODE(C.DCGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,0,1),0))             DG_40_QTY
	--,		SUM(DECODE(C.DCGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,0,C.CNTR_WGT),0))    DG_40_WGT
	--,		SUM(DECODE(C.RC_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,1,0),0))               RF_20_QTY
	--,		SUM(DECODE(C.RC_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,C.CNTR_WGT,0),0))      RF_20_WGT
	--,		SUM(DECODE(C.RC_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,0,1),0))               RF_40_QTY
	--,		SUM(DECODE(C.RC_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,0,C.CNTR_WGT),0))      RF_40_WGT
	--,		SUM(DECODE(C.AWK_CGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,1,0),0))          AK_20_QTY
	--,		SUM(DECODE(C.AWK_CGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,C.CNTR_WGT,0),0)) AK_20_WGT
	--,		SUM(DECODE(C.AWK_CGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,0,1),0))          AK_40_QTY
	--,		SUM(DECODE(C.AWK_CGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,0,C.CNTR_WGT),0)) AK_40_WGT

	,		ROUND(SUM(DECODE(C.DCGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,1,0),0))
				+ SUM(DECODE(C.DCGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),'A',1,0),0))           	,2)	DG_20_QTY

	,		ROUND(SUM(DECODE(C.DCGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,C.CNTR_WGT,0),0))
				+ SUM(DECODE(C.DCGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),'A',C.CNTR_WGT,0),0))  	,2)	DG_20_WGT

	,		ROUND(SUM(DECODE(C.DCGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,0,1),0))             
				+ SUM(DECODE(C.DCGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),'B',1,0),0))			 	,2)	DG_40_QTY

	,		ROUND(SUM(DECODE(C.DCGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,0,C.CNTR_WGT),0))
				+ SUM(DECODE(C.DCGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),'B',C.CNTR_WGT,0),0))  	,2)	DG_40_WGT	
	
	,		ROUND(SUM(DECODE(C.RC_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,1,0),0)) 
				+ SUM(DECODE(C.RC_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),'A',1,0),0))             	,2)	RF_20_QTY

	,		ROUND(SUM(DECODE(C.RC_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,C.CNTR_WGT,0),0))
				+ SUM(DECODE(C.RC_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),'A',C.CNTR_WGT,0),0))      	,2)	RF_20_WGT

	,		ROUND(SUM(DECODE(C.RC_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,0,1),0))
				+ SUM(DECODE(C.RC_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),'B',1,0),0))               	,2)	RF_40_QTY

	,		ROUND(SUM(DECODE(C.RC_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,0,C.CNTR_WGT),0))
				+ SUM(DECODE(C.RC_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),'B',C.CNTR_WGT,0),0))      	,2)	RF_40_WGT

	,		ROUND(SUM(DECODE(C.AWK_CGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,1,0),0))
				+ SUM(DECODE(C.AWK_CGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),'A',1,0),0))          	,2)	AK_20_QTY

	,		ROUND(SUM(DECODE(C.AWK_CGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,C.CNTR_WGT,0),0))
				+ SUM(DECODE(C.AWK_CGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),'A',C.CNTR_WGT,0),0)) 	,2)	AK_20_WGT

	,		ROUND(SUM(DECODE(C.AWK_CGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,0,1),0))
				+ SUM(DECODE(C.AWK_CGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),'B',1,0),0))          	,2)	AK_40_QTY

	,		ROUND(SUM(DECODE(C.AWK_CGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),2,0,C.CNTR_WGT),0))
				+ SUM(DECODE(C.AWK_CGO_FLG,'Y',DECODE(SUBSTR(C.CNTR_TPSZ_CD,2,1),'B',C.CNTR_WGT,0),0)) 	,2)	AK_40_WGT

FROM		VSK_VSL_PORT_SKD 		S
	,		BKG_VVD 				V
	,		BKG_CONTAINER 			C
	,		BKG_BOOKING 			B
WHERE  		S.VSL_CD       			= @[vsl_cd]
AND    		S.SKD_VOY_NO   			= @[voy_no]
AND    		S.SKD_DIR_CD   			= @[dir_cd]
AND    		S.YD_CD        			= @[yd_cd]
AND    		S.CLPT_IND_SEQ 			= @[clpt_ind_seq]
AND    		S.VSL_CD       			= V.VSL_CD
AND    		S.SKD_VOY_NO   			= V.SKD_VOY_NO
AND    		S.SKD_DIR_CD   			= V.SKD_DIR_CD
AND    		S.VPS_PORT_CD  			= V.POL_CD
AND    		S.CLPT_IND_SEQ 			= NVL(V.POL_CLPT_IND_SEQ,1)
AND    		V.BKG_NO     			= C.BKG_NO
AND    		V.BKG_NO     			= B.BKG_NO
AND    		NVL(B.BKG_STS_CD,'N') 	NOT IN ('X','A')
AND    		DECODE(C.DCGO_FLG,'Y','Y',DECODE(C.RC_FLG,'Y','Y',DECODE(C.AWK_CGO_FLG,'Y','Y','N'))) = 'Y'
GROUP BY 	V.POD_CD
ORDER BY 	V.POD_CD			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="voy_no" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="yd_cd" type="12" value="" out="N"/>
				<param name="clpt_ind_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
