/*=========================================================
*Copyright(c) 2015 CyberLogitec
*@FileName : PortLimitManagmentDBDAOSearchPortLimitsDgTtlWgtShaRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2015.12.04
*@LastModifier : 
*@LastVersion : 1.0
* 2015.12.04 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.vop.scg.specialcargoutilitymanagement.portlimitmanagement.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class PortLimitManagmentDBDAOSearchPortLimitsDgTtlWgtShaRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * PortLimitManagmentDBDAOSearchPortLimitsDgTtlWgtRSQL/CNSHA
	  * </pre>
	  */
	public PortLimitManagmentDBDAOSearchPortLimitsDgTtlWgtShaRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vsl_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("skd_dir_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("imdg_clss_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("from_eta_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("skd_voy_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("slan_cd1",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_eta_dt",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.vop.scg.specialcargoutilitymanagement.portlimitmanagement.integration").append("\n"); 
		query.append("FileName : PortLimitManagmentDBDAOSearchPortLimitsDgTtlWgtShaRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT PORT_CD," ).append("\n"); 
		query.append("    PORT_LMT_SEQ," ).append("\n"); 
		query.append("    PORT_LMT_REP_DESC," ).append("\n"); 
		query.append("    LMT_WGT_TP_CD," ).append("\n"); 
		query.append("    VSL_CD," ).append("\n"); 
		query.append("    SKD_VOY_NO," ).append("\n"); 
		query.append("    SKD_DIR_CD," ).append("\n"); 
		query.append("    SLAN_CD," ).append("\n"); 
		query.append("    PRT_CD," ).append("\n"); 
		query.append("    PIER_TP_CD," ).append("\n"); 
		query.append("    FLSH_PNT_TEMP," ).append("\n"); 
		query.append("    BKG_NO," ).append("\n"); 
		query.append("    IMDG_CLSS_CD," ).append("\n"); 
		query.append("    IMDG_CLSS_CD_DESC," ).append("\n"); 
		query.append("    IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("    IMDG_SUBS_RSK_LBL_CD," ).append("\n"); 
		query.append("    IMDG_UN_NO," ).append("\n"); 
		query.append("    IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("    CNTR_TP_CD," ).append("\n"); 
		query.append("    ARR_DEP_PROHI_FLG," ).append("\n"); 
		query.append("    LDIS_APLY_TGT_FLG," ).append("\n"); 
		query.append("    --Arrival" ).append("\n"); 
		query.append("    ARR_CGO_WGT," ).append("\n"); 
		query.append("    DECODE(ARR_MAX_LMT, 0, NULL, ROUND((ARR_CGO_WGT / ARR_MAX_LMT  * 100), 2)) AS ARR_LMT_RTO," ).append("\n"); 
		query.append("    DECODE(ARR_DEP_PROHI_FLG, 'Y', NULL, DECODE(ARR_MAX_LMT, 0, NULL, ARR_MAX_LMT)) AS ARR_MAX_LMT," ).append("\n"); 
		query.append("    --Discharge" ).append("\n"); 
		query.append("    DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DCHG_CGO_WGT) AS DCHG_CGO_WGT," ).append("\n"); 
		query.append("    DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DECODE(DCHG_MAX_LMT, 0, NULL, ROUND((DCHG_CGO_WGT/ DCHG_MAX_LMT * 100), 2))) AS DCHG_LMT_RTO," ).append("\n"); 
		query.append("    DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DCHG_MAX_LMT) AS DCHG_MAX_LMT," ).append("\n"); 
		query.append("    --Load" ).append("\n"); 
		query.append("    DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, LOD_CGO_WGT) AS LOD_CGO_WGT," ).append("\n"); 
		query.append("    DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DECODE(LOD_MAX_LMT, 0, NULL, ROUND((LOD_CGO_WGT / LOD_MAX_LMT  * 100), 2))) AS LOD_LMT_RTO," ).append("\n"); 
		query.append("    DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, LOD_MAX_LMT) AS LOD_MAX_LMT," ).append("\n"); 
		query.append("    --Depature" ).append("\n"); 
		query.append("	DEP_CGO_WGT," ).append("\n"); 
		query.append("    DECODE(DEP_MAX_LMT, 0, NULL, ROUND((DEP_CGO_WGT / DEP_MAX_LMT  * 100), 2)) AS DEP_LMT_RTO," ).append("\n"); 
		query.append("    DECODE(ARR_DEP_PROHI_FLG, 'Y', NULL, DECODE(DEP_MAX_LMT, 0, NULL, DEP_MAX_LMT)) AS DEP_MAX_LMT" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT --A.RN," ).append("\n"); 
		query.append("    A.PORT_CD," ).append("\n"); 
		query.append("    A.PORT_LMT_SEQ," ).append("\n"); 
		query.append("    A.PORT_LMT_REP_DESC," ).append("\n"); 
		query.append("    A.LMT_WGT_TP_CD," ).append("\n"); 
		query.append("    A.VSL_CD," ).append("\n"); 
		query.append("    A.SKD_VOY_NO," ).append("\n"); 
		query.append("    A.SKD_DIR_CD," ).append("\n"); 
		query.append("    A.SLAN_CD," ).append("\n"); 
		query.append("    A.PRT_CD," ).append("\n"); 
		query.append("    A.PIER_TP_CD," ).append("\n"); 
		query.append("    A.FLSH_PNT_TEMP," ).append("\n"); 
		query.append("    substr(xmlagg(xmlelement(a, DECODE(A.BKG_NO, '', '', ',') ||A.BKG_NO) order by A.BKG_NO).extract('//text()'), 2) BKG_NO," ).append("\n"); 
		query.append("    substr(xmlagg(xmlelement(a, DECODE(A.IMDG_CLSS_CD, '', '', ',') ||A.IMDG_CLSS_CD) order by A.IMDG_CLSS_CD).extract('//text()'), 2) AS IMDG_CLSS_CD," ).append("\n"); 
		query.append("    substr(xmlagg(xmlelement(a, DECODE(A.IMDG_CLSS_CD_DESC, '', '', ',') ||A.IMDG_CLSS_CD_DESC) order by A.IMDG_CLSS_CD_DESC).extract('//text()'), 2) AS IMDG_CLSS_CD_DESC," ).append("\n"); 
		query.append("    substr(xmlagg(xmlelement(a, DECODE(A.IMDG_COMP_GRP_CD, '', '', ',') ||A.IMDG_COMP_GRP_CD) order by A.IMDG_COMP_GRP_CD).extract('//text()'), 2) AS IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("    substr(xmlagg(xmlelement(a, DECODE(A.IMDG_SUBS_RSK_LBL_CD, '', '', ',') ||A.IMDG_SUBS_RSK_LBL_CD) order by A.IMDG_SUBS_RSK_LBL_CD).extract('//text()'), 2) AS IMDG_SUBS_RSK_LBL_CD," ).append("\n"); 
		query.append("    substr(xmlagg(xmlelement(a, DECODE(A.IMDG_UN_NO, '', '', ',') ||A.IMDG_UN_NO) order by A.IMDG_UN_NO).extract('//text()'), 2) AS IMDG_UN_NO," ).append("\n"); 
		query.append("    MAX(A.IMDG_PCK_GRP_CD) AS IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("    MAX(A.CNTR_TP_CD) AS CNTR_TP_CD," ).append("\n"); 
		query.append("    MAX(A.ARR_DEP_PROHI_FLG) AS ARR_DEP_PROHI_FLG," ).append("\n"); 
		query.append("    MAX(A.LDIS_APLY_TGT_FLG) AS LDIS_APLY_TGT_FLG," ).append("\n"); 
		query.append("    NVL(MAX(A.ARR_MAX_LMT), 0)  AS ARR_MAX_LMT," ).append("\n"); 
		query.append("    NVL(MAX(A.DCHG_MAX_LMT), 0) AS DCHG_MAX_LMT," ).append("\n"); 
		query.append("    NVL(MAX(A.LOD_MAX_LMT), 0)  AS LOD_MAX_LMT," ).append("\n"); 
		query.append("	  NVL(MAX(A.DEP_MAX_LMT), 0)  AS DEP_MAX_LMT," ).append("\n"); 
		query.append("    NVL(SUM(A.ARR_CGO_WGT), 0)  AS ARR_CGO_WGT," ).append("\n"); 
		query.append("	  NVL(SUM(A.DCHG_CGO_WGT), 0) AS DCHG_CGO_WGT," ).append("\n"); 
		query.append("	  NVL(SUM(A.LOD_CGO_WGT), 0)  AS LOD_CGO_WGT," ).append("\n"); 
		query.append("	  NVL(SUM(A.DEP_CGO_WGT), 0)  AS DEP_CGO_WGT" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT RN," ).append("\n"); 
		query.append("    PORT_CD," ).append("\n"); 
		query.append("    PORT_LMT_SEQ," ).append("\n"); 
		query.append("    PORT_LMT_REP_DESC," ).append("\n"); 
		query.append("    SLAN_CD," ).append("\n"); 
		query.append("    PRT_CD," ).append("\n"); 
		query.append("    PIER_TP_CD," ).append("\n"); 
		query.append("    VSL_CD," ).append("\n"); 
		query.append("    SKD_VOY_NO ," ).append("\n"); 
		query.append("    SKD_DIR_CD ," ).append("\n"); 
		query.append("    IMDG_CLSS_CD ," ).append("\n"); 
		query.append("    FLSH_PNT_TEMP," ).append("\n"); 
		query.append("    IMDG_CLSS_CD_DESC," ).append("\n"); 
		query.append("    LMT_WGT_TP_CD," ).append("\n"); 
		query.append("    IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("    IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("    IMDG_SUBS_RSK_LBL_CD," ).append("\n"); 
		query.append("    IMDG_UN_NO," ).append("\n"); 
		query.append("    CNTR_TP_CD," ).append("\n"); 
		query.append("    ARR_DEP_PROHI_FLG," ).append("\n"); 
		query.append("    LDIS_APLY_TGT_FLG," ).append("\n"); 
		query.append("    ARR_MAX_LMT," ).append("\n"); 
		query.append("    DCHG_MAX_LMT," ).append("\n"); 
		query.append("    LOD_MAX_LMT," ).append("\n"); 
		query.append("    DEP_MAX_LMT," ).append("\n"); 
		query.append("     ARR_CGO_WGT ," ).append("\n"); 
		query.append("     DCHG_CGO_WGT," ).append("\n"); 
		query.append("     LOD_CGO_WGT ," ).append("\n"); 
		query.append("     DEP_CGO_WGT ," ).append("\n"); 
		query.append("     BKG_NO||" ).append("\n"); 
		query.append("       (CASE WHEN ARR_LMT_RTO > 100 OR (ARR_DEP_PROHI_FLG = 'Y' AND ARR_CGO_WGT > 0) THEN 'R'" ).append("\n"); 
		query.append("            WHEN 75 <= ARR_LMT_RTO  AND ARR_LMT_RTO <= 100 THEN 'Y'" ).append("\n"); 
		query.append("            WHEN ARR_LMT_RTO >= 0 THEN 'G'" ).append("\n"); 
		query.append("            ELSE 'B'" ).append("\n"); 
		query.append("       END)||" ).append("\n"); 
		query.append("       (CASE WHEN DCHG_LMT_RTO > 100  THEN 'R'" ).append("\n"); 
		query.append("            WHEN 75 <= DCHG_LMT_RTO  AND DCHG_LMT_RTO <= 100 THEN 'Y'" ).append("\n"); 
		query.append("            WHEN DCHG_LMT_RTO >= 0 THEN 'G'" ).append("\n"); 
		query.append("            ELSE 'B'" ).append("\n"); 
		query.append("       END)||" ).append("\n"); 
		query.append("       (CASE WHEN LOD_LMT_RTO > 100  THEN 'R'" ).append("\n"); 
		query.append("            WHEN 75 <= LOD_LMT_RTO  AND LOD_LMT_RTO <= 100 THEN 'Y'" ).append("\n"); 
		query.append("            WHEN LOD_LMT_RTO >= 0 THEN 'G'" ).append("\n"); 
		query.append("            ELSE 'B'" ).append("\n"); 
		query.append("       END)||" ).append("\n"); 
		query.append("       (CASE WHEN DEP_LMT_RTO > 100 OR (ARR_DEP_PROHI_FLG = 'Y' AND DEP_CGO_WGT > 0) THEN 'R'" ).append("\n"); 
		query.append("            WHEN 75 <= DEP_LMT_RTO  AND DEP_LMT_RTO <= 100 THEN 'Y'" ).append("\n"); 
		query.append("            WHEN DEP_LMT_RTO >= 0 THEN 'G'" ).append("\n"); 
		query.append("            ELSE 'B'" ).append("\n"); 
		query.append("       END) AS BKG_NO" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT RN," ).append("\n"); 
		query.append("    PORT_CD," ).append("\n"); 
		query.append("    PORT_LMT_SEQ," ).append("\n"); 
		query.append("    PORT_LMT_REP_DESC," ).append("\n"); 
		query.append("    LMT_WGT_TP_CD," ).append("\n"); 
		query.append("    VSL_CD," ).append("\n"); 
		query.append("    SKD_VOY_NO," ).append("\n"); 
		query.append("    SKD_DIR_CD," ).append("\n"); 
		query.append("    SLAN_CD," ).append("\n"); 
		query.append("    BKG_NO," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    MAX(PRT_CD)                                 PRT_CD," ).append("\n"); 
		query.append("    MAX(PIER_TP_CD)                         PIER_TP_CD," ).append("\n"); 
		query.append("    MAX(IMDG_CLSS_CD)                     IMDG_CLSS_CD ," ).append("\n"); 
		query.append("    MAX(FLSH_PNT_TEMP)                 FLSH_PNT_TEMP," ).append("\n"); 
		query.append("    MAX(IMDG_CLSS_CD_DESC)         IMDG_CLSS_CD_DESC," ).append("\n"); 
		query.append("    MAX(IMDG_COMP_GRP_CD)             IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("    MAX(IMDG_PCK_GRP_CD)             IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("    MAX(IMDG_SUBS_RSK_LBL_CD)    IMDG_SUBS_RSK_LBL_CD," ).append("\n"); 
		query.append("    MAX(IMDG_UN_NO)                         IMDG_UN_NO," ).append("\n"); 
		query.append("    MAX(CNTR_TP_CD)                         CNTR_TP_CD," ).append("\n"); 
		query.append("    MAX(ARR_DEP_PROHI_FLG)       ARR_DEP_PROHI_FLG," ).append("\n"); 
		query.append("    MAX(LDIS_APLY_TGT_FLG)          LDIS_APLY_TGT_FLG," ).append("\n"); 
		query.append("    MAX(ARR_MAX_LMT)                      ARR_MAX_LMT," ).append("\n"); 
		query.append("    MAX(DECODE(LDIS_APLY_TGT_FLG, 'N', '' ,DCHG_MAX_LMT))  DCHG_MAX_LMT," ).append("\n"); 
		query.append("    MAX(DECODE(LDIS_APLY_TGT_FLG, 'N', '' ,LOD_MAX_LMT))     LOD_MAX_LMT," ).append("\n"); 
		query.append("    MAX(DEP_MAX_LMT)                      DEP_MAX_LMT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("            SUM(ARR_CGO_WGT)                                                                                                                          AS ARR_CGO_WGT," ).append("\n"); 
		query.append("        -- LMT 0일 때에도 CNTR Counting 2015-12-04 --" ).append("\n"); 
		query.append("        DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '', SUM(DCHG_CGO_WGT))                                                                                AS DCHG_CGO_WGT," ).append("\n"); 
		query.append("        DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '',  SUM(LOD_CGO_WGT))                                                                                AS LOD_CGO_WGT," ).append("\n"); 
		query.append("        SUM(DEP_CGO_WGT)                                                                                                                          AS DEP_CGO_WGT," ).append("\n"); 
		query.append("        DECODE(MAX(ARR_DEP_PROHI_FLG), 'Y', '', DECODE(SUM(ARR_CGO_WGT),0,'',NVL(ROUND( ((SUM(ARR_CGO_WGT)  / MAX(ARR_MAX_LMT)) * 100), 2), 0)))  AS ARR_LMT_RTO," ).append("\n"); 
		query.append("        DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '', DECODE(SUM(DCHG_CGO_WGT),0,'',NVL(ROUND( ((SUM(DCHG_CGO_WGT)/ MAX(DCHG_MAX_LMT)) * 100), 2), 0))) AS DCHG_LMT_RTO," ).append("\n"); 
		query.append("        DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '', DECODE(SUM(LOD_CGO_WGT),0,'',NVL(ROUND( ((SUM(LOD_CGO_WGT)  / MAX(LOD_MAX_LMT)) * 100), 2), 0)))  AS LOD_LMT_RTO," ).append("\n"); 
		query.append("        DECODE(MAX(ARR_DEP_PROHI_FLG), 'Y', '', DECODE(SUM(DEP_CGO_WGT),0,'',NVL(ROUND( ((SUM(DEP_CGO_WGT)  / MAX(DEP_MAX_LMT)) * 100), 2), 0)))  AS DEP_LMT_RTO" ).append("\n"); 
		query.append("      FROM(" ).append("\n"); 
		query.append("     SELECT DISTINCT A.RN," ).append("\n"); 
		query.append("            A.PORT_CD," ).append("\n"); 
		query.append("            A.PORT_LMT_SEQ," ).append("\n"); 
		query.append("            A.PORT_LMT_REP_DESC," ).append("\n"); 
		query.append("            B.BKG_NO," ).append("\n"); 
		query.append("            B.SLAN_CD," ).append("\n"); 
		query.append("            B.PRT_CD        AS PRT_CD," ).append("\n"); 
		query.append("            A.PIER_TP_CD    AS PIER_TP_CD," ).append("\n"); 
		query.append("            B.VSL_CD             AS VSL_CD," ).append("\n"); 
		query.append("            B.SKD_VOY_NO         AS SKD_VOY_NO ," ).append("\n"); 
		query.append("            B.SKD_DIR_CD         AS SKD_DIR_CD ," ).append("\n"); 
		query.append("            A.IMDG_CLSS_CD  AS IMDG_CLSS_CD ," ).append("\n"); 
		query.append("            A.FLSH_PNT_TEMP AS FLSH_PNT_TEMP," ).append("\n"); 
		query.append("            B.IMDG_CLSS_CD_DESC AS IMDG_CLSS_CD_DESC," ).append("\n"); 
		query.append("                      A.LMT_WGT_TP_CD     AS LMT_WGT_TP_CD," ).append("\n"); 
		query.append("            A.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("            A.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("            A.IMDG_SUBS_RSK_LBL_CD," ).append("\n"); 
		query.append("            A.IMDG_UN_NO," ).append("\n"); 
		query.append("            A.CNTR_TP_CD," ).append("\n"); 
		query.append("            ---------------------------------------" ).append("\n"); 
		query.append("            B.ARR_CGO_WGT ," ).append("\n"); 
		query.append("            B.DCHG_CGO_WGT," ).append("\n"); 
		query.append("            B.LOD_CGO_WGT ," ).append("\n"); 
		query.append("            B.DEP_CGO_WGT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("            NVL(B.ARR_MAX_LMT,   A.ARR_MAX_QTY)  AS ARR_MAX_LMT," ).append("\n"); 
		query.append("            NVL(B.DCHG_MAX_LMT, A.DCHG_MAX_QTY) AS DCHG_MAX_LMT," ).append("\n"); 
		query.append("            NVL(B.LOD_MAX_LMT,   A.LOD_MAX_QTY)   AS LOD_MAX_LMT," ).append("\n"); 
		query.append("            NVL(B.DEP_MAX_LMT,   A.DEP_MAX_QTY)  AS DEP_MAX_LMT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("            A.ARR_DEP_PROHI_FLG AS ARR_DEP_PROHI_FLG," ).append("\n"); 
		query.append("            A.LDIS_APLY_TGT_FLG AS LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("  FROM" ).append("\n"); 
		query.append("       (" ).append("\n"); 
		query.append("         SELECT  ROWNUM RN," ).append("\n"); 
		query.append("                      PORT_CD, PORT_LMT_SEQ," ).append("\n"); 
		query.append("                      IMDG_CLSS_CD, FLSH_PNT_TEMP," ).append("\n"); 
		query.append("                      LMT_WGT_TP_CD, IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                      IMDG_PCK_GRP_CD, IMDG_SUBS_RSK_LBL_CD," ).append("\n"); 
		query.append("                      IMDG_UN_NO, CNTR_TP_CD," ).append("\n"); 
		query.append("                      PIER_TP_CD," ).append("\n"); 
		query.append("                      '2DISCHARGE' PORT_LMT_KND," ).append("\n"); 
		query.append("                      ARR_MAX_QTY, DCHG_MAX_QTY, LOD_MAX_QTY, DEP_MAX_QTY," ).append("\n"); 
		query.append("                      PPT_EXPLO_FLG, PPT_PROHI_FLG, PORT_LMT_REP_DESC," ).append("\n"); 
		query.append("                      ARR_DEP_PROHI_FLG,             LDIS_APLY_TGT_FLG," ).append("\n"); 
		query.append("            YD_CD" ).append("\n"); 
		query.append("            FROM  (" ).append("\n"); 
		query.append("                    SELECT   A.PIER_TP_CD, A.PORT_CD, A.PORT_LMT_SEQ, A.FLSH_PNT_TEMP," ).append("\n"); 
		query.append("                                  A.LMT_WGT_TP_CD, A.IMDG_PCK_GRP_CD, E.IMDG_SUBS_RSK_LBL_CD, A.CNTR_TP_CD," ).append("\n"); 
		query.append("                                  B.IMDG_CLSS_CD, C.IMDG_COMP_GRP_CD , D.IMDG_UN_NO," ).append("\n"); 
		query.append("                                  DECODE(A.ARR_MAX_QTY, 0, NULL, A.ARR_MAX_QTY)   AS ARR_MAX_QTY," ).append("\n"); 
		query.append("                DECODE(A.DCHG_MAX_TEU_QTY, 0, NULL, A.DCHG_MAX_TEU_QTY) AS DCHG_MAX_QTY," ).append("\n"); 
		query.append("                DECODE(A.LOD_MAX_TEU_QTY, 0, NULL, A.LOD_MAX_TEU_QTY)   AS LOD_MAX_QTY," ).append("\n"); 
		query.append("                                  DECODE(A.DEP_MAX_QTY, 0, NULL, A.DEP_MAX_QTY)    AS DEP_MAX_QTY," ).append("\n"); 
		query.append("                                  A.PPT_EXPLO_FLG,  A.PPT_PROHI_FLG, A.PORT_LMT_REP_DESC," ).append("\n"); 
		query.append("                                              A.ARR_DEP_PROHI_FLG,               A.LDIS_APLY_TGT_FLG," ).append("\n"); 
		query.append("              A.YD_CD" ).append("\n"); 
		query.append("                        FROM SCG_IMDG_PORT_LMT_MST A," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_CLSS_CD B," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_COMP_GRP C," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_UN_NO D," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_SUBS_RSK E" ).append("\n"); 
		query.append("                       WHERE A.PORT_CD = B.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND A.PORT_LMT_SEQ = B.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            AND B.PORT_CD = C.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND B.PORT_LMT_SEQ = C.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            AND A.PORT_CD = D.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND A.PORT_LMT_SEQ = D.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            AND A.PORT_CD = E.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND A.PORT_LMT_SEQ = E.PORT_LMT_SEQ(+) " ).append("\n"); 
		query.append("                            -- Target unckecked 제외 2015-12-04 --" ).append("\n"); 
		query.append("                            AND A.LDIS_APLY_TGT_FLG = 'Y'      " ).append("\n"); 
		query.append("                     )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("         SELECT  ROWNUM RN," ).append("\n"); 
		query.append("                      PORT_CD, PORT_LMT_SEQ," ).append("\n"); 
		query.append("                      IMDG_CLSS_CD, FLSH_PNT_TEMP," ).append("\n"); 
		query.append("                      LMT_WGT_TP_CD, IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                      IMDG_PCK_GRP_CD, IMDG_SUBS_RSK_LBL_CD," ).append("\n"); 
		query.append("                      IMDG_UN_NO, CNTR_TP_CD," ).append("\n"); 
		query.append("                      PIER_TP_CD," ).append("\n"); 
		query.append("                      '3LOAD' AS PORT_LMT_KND," ).append("\n"); 
		query.append("                      ARR_MAX_QTY, DCHG_MAX_QTY, LOD_MAX_QTY, DEP_MAX_QTY," ).append("\n"); 
		query.append("                      PPT_EXPLO_FLG, PPT_PROHI_FLG, PORT_LMT_REP_DESC," ).append("\n"); 
		query.append("                      ARR_DEP_PROHI_FLG,             LDIS_APLY_TGT_FLG," ).append("\n"); 
		query.append("            YD_CD" ).append("\n"); 
		query.append("            FROM  (" ).append("\n"); 
		query.append("                    SELECT   A.PIER_TP_CD, A.PORT_CD, A.PORT_LMT_SEQ, A.FLSH_PNT_TEMP," ).append("\n"); 
		query.append("                                  A.LMT_WGT_TP_CD, A.IMDG_PCK_GRP_CD, E.IMDG_SUBS_RSK_LBL_CD, A.CNTR_TP_CD," ).append("\n"); 
		query.append("                                  B.IMDG_CLSS_CD, C.IMDG_COMP_GRP_CD , D.IMDG_UN_NO," ).append("\n"); 
		query.append("                                  DECODE(A.ARR_MAX_QTY, 0, NULL, A.ARR_MAX_QTY)   AS ARR_MAX_QTY," ).append("\n"); 
		query.append("                DECODE(A.DCHG_MAX_TEU_QTY, 0, NULL, A.DCHG_MAX_TEU_QTY) AS DCHG_MAX_QTY," ).append("\n"); 
		query.append("                DECODE(A.LOD_MAX_TEU_QTY, 0, NULL, A.LOD_MAX_TEU_QTY)   AS LOD_MAX_QTY," ).append("\n"); 
		query.append("                                  DECODE(A.DEP_MAX_QTY, 0, NULL, A.DEP_MAX_QTY)    AS DEP_MAX_QTY," ).append("\n"); 
		query.append("                                  A.PPT_EXPLO_FLG,  A.PPT_PROHI_FLG, A.PORT_LMT_REP_DESC," ).append("\n"); 
		query.append("                                              A.ARR_DEP_PROHI_FLG,               A.LDIS_APLY_TGT_FLG," ).append("\n"); 
		query.append("              A.YD_CD" ).append("\n"); 
		query.append("                        FROM SCG_IMDG_PORT_LMT_MST A," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_CLSS_CD B," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_COMP_GRP C," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_UN_NO D," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_SUBS_RSK E" ).append("\n"); 
		query.append("                       WHERE A.PORT_CD = B.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND A.PORT_LMT_SEQ = B.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            AND B.PORT_CD = C.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND B.PORT_LMT_SEQ = C.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            AND A.PORT_CD = D.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND A.PORT_LMT_SEQ = D.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            AND A.PORT_CD = E.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND A.PORT_LMT_SEQ = E.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            -- Target unckecked 제외 2015-12-04 --" ).append("\n"); 
		query.append("                            AND A.LDIS_APLY_TGT_FLG = 'Y'   " ).append("\n"); 
		query.append("                     )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(") A," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT DISTINCT SIPL.RN," ).append("\n"); 
		query.append("            RANK() OVER(ORDER BY SIPL.RN) AS RNK," ).append("\n"); 
		query.append("            DGIF.BKG_NO," ).append("\n"); 
		query.append("            DGIF.SLAN_CD, --SIPL.SLAN_CD," ).append("\n"); 
		query.append("            DGIF.PRT_CD, --SIPL.UN_LOC_CD," ).append("\n"); 
		query.append("            SIPL.PIER_TP_CD," ).append("\n"); 
		query.append("            SIPL.PORT_CD," ).append("\n"); 
		query.append("            SIPL.PORT_LMT_SEQ," ).append("\n"); 
		query.append("            DGIF.POL_CD AS POL_CD," ).append("\n"); 
		query.append("            DGIF.POD_CD AS POD_CD," ).append("\n"); 
		query.append("            DGIF.VSL_CD," ).append("\n"); 
		query.append("            DGIF.SKD_VOY_NO," ).append("\n"); 
		query.append("            DGIF.SKD_DIR_CD," ).append("\n"); 
		query.append("            SIPL.LMT_WGT_TP_CD AS LMT_WGT_TP_CD," ).append("\n"); 
		query.append("            SIPL.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("            SIPL.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("            SIPL.IMDG_SUBS_RSK_LBL_CD," ).append("\n"); 
		query.append("            SIPL.IMDG_UN_NO," ).append("\n"); 
		query.append("            SIPL.CNTR_TP_CD," ).append("\n"); 
		query.append("            SIPL.IMDG_CLSS_CD," ).append("\n"); 
		query.append("            SIPL.FLSH_PNT_TEMP," ).append("\n"); 
		query.append("            DGIF.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("            (SELECT SICC.IMDG_CLSS_CD_DESC" ).append("\n"); 
		query.append("               FROM SCG_IMDG_CLSS_CD SICC" ).append("\n"); 
		query.append("              WHERE 1=1" ).append("\n"); 
		query.append("                AND SICC.IMDG_CLSS_CD = SIPL.IMDG_CLSS_CD) AS IMDG_CLSS_CD_DESC," ).append("\n"); 
		query.append("            SIPL.PORT_LMT_KND," ).append("\n"); 
		query.append("            --------------------------" ).append("\n"); 
		query.append("            0                 AS ARR_CGO_WGT," ).append("\n"); 
		query.append("            DGIF.DCHG_GRS_WGT AS DCHG_CGO_WGT," ).append("\n"); 
		query.append("            DGIF.LOD_GRS_WGT  AS LOD_CGO_WGT," ).append("\n"); 
		query.append("            0                 AS DEP_CGO_WGT," ).append("\n"); 
		query.append("            SIPL.ARR_MAX_QTY   AS ARR_MAX_LMT," ).append("\n"); 
		query.append("            SIPL.DCHG_MAX_QTY AS DCHG_MAX_LMT," ).append("\n"); 
		query.append("            SIPL.LOD_MAX_QTY   AS LOD_MAX_LMT," ).append("\n"); 
		query.append("            SIPL.DEP_MAX_QTY   AS DEP_MAX_LMT," ).append("\n"); 
		query.append("            DECODE(SIPL.PPT_EXPLO_FLG, 'Y', 'Explosive ', '')||DECODE(SIPL.PPT_PROHI_FLG, 'Y', 'Prohibited', '') AS PPT_FLG_RMK," ).append("\n"); 
		query.append("            SIPL.YD_CD" ).append("\n"); 
		query.append("  FROM (" ).append("\n"); 
		query.append("         SELECT  ROWNUM RN," ).append("\n"); 
		query.append("                      PORT_CD, PORT_LMT_SEQ," ).append("\n"); 
		query.append("                      IMDG_CLSS_CD, FLSH_PNT_TEMP," ).append("\n"); 
		query.append("                      LMT_WGT_TP_CD, IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                      IMDG_PCK_GRP_CD, IMDG_SUBS_RSK_LBL_CD," ).append("\n"); 
		query.append("                      IMDG_UN_NO, CNTR_TP_CD," ).append("\n"); 
		query.append("                      PIER_TP_CD," ).append("\n"); 
		query.append("                      '2DISCHARGE' PORT_LMT_KND," ).append("\n"); 
		query.append("                      ARR_MAX_QTY, DCHG_MAX_QTY, LOD_MAX_QTY, DEP_MAX_QTY," ).append("\n"); 
		query.append("                      PPT_EXPLO_FLG,               PPT_PROHI_FLG," ).append("\n"); 
		query.append("              YD_CD" ).append("\n"); 
		query.append("            FROM  (" ).append("\n"); 
		query.append("                    SELECT   A.PIER_TP_CD, A.PORT_CD, A.PORT_LMT_SEQ, A.FLSH_PNT_TEMP," ).append("\n"); 
		query.append("                                  A.LMT_WGT_TP_CD, A.IMDG_PCK_GRP_CD, E.IMDG_SUBS_RSK_LBL_CD, A.CNTR_TP_CD," ).append("\n"); 
		query.append("                                  B.IMDG_CLSS_CD, C.IMDG_COMP_GRP_CD , D.IMDG_UN_NO," ).append("\n"); 
		query.append("                                  DECODE(A.ARR_MAX_QTY, 0, NULL, A.ARR_MAX_QTY)   AS ARR_MAX_QTY," ).append("\n"); 
		query.append("                DECODE(A.DCHG_MAX_TEU_QTY, 0, NULL, A.DCHG_MAX_TEU_QTY) AS DCHG_MAX_QTY," ).append("\n"); 
		query.append("                DECODE(A.LOD_MAX_TEU_QTY, 0, NULL, A.LOD_MAX_TEU_QTY)   AS LOD_MAX_QTY," ).append("\n"); 
		query.append("                                  DECODE(A.DEP_MAX_QTY, 0, NULL, A.DEP_MAX_QTY)    AS DEP_MAX_QTY," ).append("\n"); 
		query.append("                                  A.PPT_EXPLO_FLG," ).append("\n"); 
		query.append("                                                  A.PPT_PROHI_FLG," ).append("\n"); 
		query.append("                A.YD_CD" ).append("\n"); 
		query.append("                        FROM SCG_IMDG_PORT_LMT_MST A," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_CLSS_CD B," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_COMP_GRP C," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_UN_NO D," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_SUBS_RSK E" ).append("\n"); 
		query.append("                       WHERE A.PORT_CD = B.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND A.PORT_LMT_SEQ = B.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            AND B.PORT_CD = C.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND B.PORT_LMT_SEQ = C.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            AND A.PORT_CD = D.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND A.PORT_LMT_SEQ = D.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            AND A.PORT_CD = E.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND A.PORT_LMT_SEQ = E.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            -- Target unckecked 제외 2015-12-04 --" ).append("\n"); 
		query.append("                            AND A.LDIS_APLY_TGT_FLG = 'Y'         " ).append("\n"); 
		query.append("                     )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("         SELECT  ROWNUM RN," ).append("\n"); 
		query.append("                      PORT_CD, PORT_LMT_SEQ," ).append("\n"); 
		query.append("                      IMDG_CLSS_CD, FLSH_PNT_TEMP," ).append("\n"); 
		query.append("                      LMT_WGT_TP_CD, IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                      IMDG_PCK_GRP_CD, IMDG_SUBS_RSK_LBL_CD," ).append("\n"); 
		query.append("                      IMDG_UN_NO, CNTR_TP_CD," ).append("\n"); 
		query.append("                      PIER_TP_CD," ).append("\n"); 
		query.append("                      '3LOAD' AS PORT_LMT_KND," ).append("\n"); 
		query.append("                      ARR_MAX_QTY, DCHG_MAX_QTY, LOD_MAX_QTY, DEP_MAX_QTY," ).append("\n"); 
		query.append("                      PPT_EXPLO_FLG, PPT_PROHI_FLG, YD_CD" ).append("\n"); 
		query.append("            FROM  (" ).append("\n"); 
		query.append("                    SELECT   A.PIER_TP_CD, A.PORT_CD, A.PORT_LMT_SEQ, A.FLSH_PNT_TEMP," ).append("\n"); 
		query.append("                                  A.LMT_WGT_TP_CD, A.IMDG_PCK_GRP_CD, E.IMDG_SUBS_RSK_LBL_CD, A.CNTR_TP_CD," ).append("\n"); 
		query.append("                                  B.IMDG_CLSS_CD, C.IMDG_COMP_GRP_CD , D.IMDG_UN_NO," ).append("\n"); 
		query.append("                                  DECODE(A.ARR_MAX_QTY, 0, NULL, A.ARR_MAX_QTY)   AS ARR_MAX_QTY," ).append("\n"); 
		query.append("                DECODE(A.DCHG_MAX_TEU_QTY, 0, NULL, A.DCHG_MAX_TEU_QTY) AS DCHG_MAX_QTY," ).append("\n"); 
		query.append("                DECODE(A.LOD_MAX_TEU_QTY, 0, NULL, A.LOD_MAX_TEU_QTY)   AS LOD_MAX_QTY," ).append("\n"); 
		query.append("                                  DECODE(A.DEP_MAX_QTY, 0, NULL, A.DEP_MAX_QTY)    AS DEP_MAX_QTY," ).append("\n"); 
		query.append("                                  A.PPT_EXPLO_FLG," ).append("\n"); 
		query.append("                                                  A.PPT_PROHI_FLG," ).append("\n"); 
		query.append("                A.YD_CD" ).append("\n"); 
		query.append("                        FROM SCG_IMDG_PORT_LMT_MST A," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_CLSS_CD B," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_COMP_GRP C," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_UN_NO D," ).append("\n"); 
		query.append("                                  SCG_IMDG_PORT_LMT_SUBS_RSK E" ).append("\n"); 
		query.append("                       WHERE A.PORT_CD = B.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND A.PORT_LMT_SEQ = B.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            AND B.PORT_CD = C.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND B.PORT_LMT_SEQ = C.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            AND A.PORT_CD = D.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND A.PORT_LMT_SEQ = D.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            AND A.PORT_CD = E.PORT_CD(+)" ).append("\n"); 
		query.append("                            AND A.PORT_LMT_SEQ = E.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("                            -- Target unckecked 제외 2015-12-04 --" ).append("\n"); 
		query.append("                            AND A.LDIS_APLY_TGT_FLG = 'Y'        " ).append("\n"); 
		query.append("                     )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        ) SIPL," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("       (" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("          SELECT SLAN_CD, VSL_CD, SKD_VOY_NO, SKD_DIR_CD, PRT_CD, POL_CD, POD_CD, WGT_UT_CD, IMDG_CLSS_CD, FLSH_PNT_CDO_TEMP, PORT_LMT_KND, VPS_ETA_DT,IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                 IMDG_COMP_GRP_CD, IMDG_UN_NO, IMDG_UN_NO_SEQ, CNTR_TP_CD,IMDG_SUBS_RSK_LBL_CD1, IMDG_SUBS_RSK_LBL_CD2, IMDG_SUBS_RSK_LBL_CD3, IMDG_SUBS_RSK_LBL_CD4,               BKG_NO," ).append("\n"); 
		query.append("              YD_CD," ).append("\n"); 
		query.append("                 ------------------------" ).append("\n"); 
		query.append("                 MAX(ARR_NET_WGT) AS ARR_NET_WGT, MAX(ARR_GRS_WGT) AS ARR_GRS_WGT, MAX(ARR_NET_EXPLO_WGT) AS ARR_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                 MAX(DCHG_NET_WGT) AS DCHG_NET_WGT, MAX(DCHG_GRS_WGT) AS DCHG_GRS_WGT, MAX(DCHG_NET_EXPLO_WGT) AS DCHG_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                 MAX(LOD_NET_WGT) AS LOD_NET_WGT, MAX(LOD_GRS_WGT) AS LOD_GRS_WGT, MAX(LOD_NET_EXPLO_WGT) AS LOD_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                 MAX(DEP_NET_WGT) AS DEP_NET_WGT, MAX(DEP_GRS_WGT) AS DEP_GRS_WGT, MAX(DEP_NET_EXPLO_WGT) AS DEP_NET_EXPLO_WGT" ).append("\n"); 
		query.append("            FROM (" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                        SELECT BKG_NO,DCGO_SEQ,SLAN_CD,VSL_CD,SKD_VOY_NO,SKD_DIR_CD,PRT_CD,POL_CD,POD_CD,WGT_UT_CD,IMDG_CLSS_CD,FLSH_PNT_CDO_TEMP, IMDG_COMP_GRP_CD, IMDG_UN_NO,IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                         CNTR_TP_CD,IMDG_SUBS_RSK_LBL_CD1,IMDG_SUBS_RSK_LBL_CD2,IMDG_SUBS_RSK_LBL_CD3,IMDG_SUBS_RSK_LBL_CD4,ARR_NET_WGT,ARR_GRS_WGT,ARR_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                         DCHG_NET_WGT,DCHG_GRS_WGT,DCHG_NET_EXPLO_WGT,LOD_NET_WGT,LOD_GRS_WGT,LOD_NET_EXPLO_WGT,DEP_NET_WGT,DEP_GRS_WGT,DEP_NET_EXPLO_WGT,VPS_ETA_DT,IMDG_PCK_GRP_CD, PORT_LMT_KND," ).append("\n"); 
		query.append("                YD_CD" ).append("\n"); 
		query.append("                          FROM" ).append("\n"); 
		query.append("                              (" ).append("\n"); 
		query.append("                          SELECT  A.BKG_NO, A.DCGO_SEQ," ).append("\n"); 
		query.append("                                        A.SLAN_CD," ).append("\n"); 
		query.append("                                   A.VSL_CD," ).append("\n"); 
		query.append("                                   A.SKD_VOY_NO," ).append("\n"); 
		query.append("                                   A.SKD_DIR_CD," ).append("\n"); 
		query.append("                                   A.PRT_CD," ).append("\n"); 
		query.append("                                   A.POL_CD," ).append("\n"); 
		query.append("                                   A.POD_CD," ).append("\n"); 
		query.append("                                   A.WGT_UT_CD," ).append("\n"); 
		query.append("                                   A.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                   A.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                   A.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                   A.IMDG_UN_NO," ).append("\n"); 
		query.append("                                   A.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                   A.CNTR_TP_CD," ).append("\n"); 
		query.append("                                   A.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                   A.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                   A.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                   A.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                   ---------------------------------" ).append("\n"); 
		query.append("                                    0 AS ARR_NET_WGT, 0 AS ARR_GRS_WGT, 0 AS ARR_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                    NET_WGT AS DCHG_NET_WGT, GRS_WGT AS DCHG_GRS_WGT, NET_EXPLO_WGT AS DCHG_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                    0 AS LOD_NET_WGT, 0 AS LOD_GRS_WGT, 0 AS LOD_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                    0 AS DEP_NET_WGT, 0 AS DEP_GRS_WGT, 0 AS DEP_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                   A.VPS_ETA_DT, A.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                                     '2DISCHARGE' PORT_LMT_KND," ).append("\n"); 
		query.append("                  A.YD_CD" ).append("\n"); 
		query.append("                          FROM (" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                        SELECT A.BKG_NO,A.DCGO_SEQ,A.SLAN_CD,A.VSL_CD,A.SKD_VOY_NO,A.SKD_DIR_CD,A.PRT_CD,A.PRT_SEQ,A.POL_CD,A.POL_SEQ,A.POD_CD,A.POD_SEQ," ).append("\n"); 
		query.append("                                                    A.WGT_UT_CD,A.IMDG_CLSS_CD,A.FLSH_PNT_CDO_TEMP,A.IMDG_COMP_GRP_CD,A.IMDG_UN_NO,A.IMDG_UN_NO_SEQ,A.CNTR_TP_CD,A.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                                    A.IMDG_SUBS_RSK_LBL_CD2,A.IMDG_SUBS_RSK_LBL_CD3,A.IMDG_SUBS_RSK_LBL_CD4,A.NET_WGT,A.GRS_WGT,A.NET_EXPLO_WGT,A.VPS_ETA_DT,A.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                    A.YD_CD" ).append("\n"); 
		query.append("                                          FROM" ).append("\n"); 
		query.append("                                                 (" ).append("\n"); 
		query.append("                                    -- Own BKG`s SPCL CGO Info" ).append("\n"); 
		query.append("                                    SELECT SDC.BKG_NO,SDC.SPCL_CGO_APRO_CD," ).append("\n"); 
		query.append("                                               SDC.DCGO_SEQ," ).append("\n"); 
		query.append("                                               VVPS.SLAN_CD," ).append("\n"); 
		query.append("                                               VVPS.VSL_CD," ).append("\n"); 
		query.append("                      VVPS.SKD_VOY_NO," ).append("\n"); 
		query.append("                      VVPS.SKD_DIR_CD," ).append("\n"); 
		query.append("                      VVPS.YD_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = 'CNSHA'" ).append("\n"); 
		query.append("                                                   ) AS PRT_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = 'CNSHA'" ).append("\n"); 
		query.append("                                                   ) AS PRT_SEQ," ).append("\n"); 
		query.append("                                               SVAR.POL_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.CLPT_IND_SEQ = BVD.POL_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = BVD.POL_CD" ).append("\n"); 
		query.append("                                                   ) AS POL_SEQ," ).append("\n"); 
		query.append("                                                SVAR.POD_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.CLPT_IND_SEQ = BVD.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = BVD.POD_CD" ).append("\n"); 
		query.append("                                                   ) AS POD_SEQ," ).append("\n"); 
		query.append("                                               NVL(SDC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                               SDC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                               SDC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                               SDC.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                               SDC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                               SDC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                               SUBSTR(SDC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                               SDC.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                               SDC.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                               SDC.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                               SDC.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                              1 AS NET_WGT," ).append("\n"); 
		query.append("                                              ( SELECT COUNT(DISTINCT DG_CNTR_SEQ) FROM BKG_DG_CGO  " ).append("\n"); 
		query.append("                                                 WHERE BKG_NO = SDC.BKG_NO" ).append("\n"); 
		query.append("                                                 AND IMDG_CLSS_CD = SDC.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                                 AND SPCL_CGO_APRO_CD IS NOT NULL" ).append("\n"); 
		query.append("                                                 AND SPCL_CGO_APRO_CD NOT IN ('C','D')) AS GRS_WGT," ).append("\n"); 
		query.append("                                               1 AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                               VVPS.VPS_ETA_DT, SDC.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                                 SVAR.VSL_PRE_PST_CD, SVAR.VSL_SEQ  , SAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                      FROM BKG_DG_CGO        SDC," ).append("\n"); 
		query.append("                                           SCG_APRO_RQST     SAR," ).append("\n"); 
		query.append("                                           SCG_VVD_APRO_RQST SVAR," ).append("\n"); 
		query.append("                                           BKG_VVD           BVD," ).append("\n"); 
		query.append("                                           VSK_VSL_PORT_SKD  VVPS" ).append("\n"); 
		query.append("                                                                        WHERE 1 = 1" ).append("\n"); 
		query.append("                                       AND SDC.BKG_NO                 = SAR.BKG_NO" ).append("\n"); 
		query.append("                                       AND SAR.BKG_NO                 = SVAR.BKG_NO" ).append("\n"); 
		query.append("                                       AND SAR.SPCL_CGO_APRO_RQST_SEQ = SVAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                       AND SVAR.BKG_NO                = BVD.BKG_NO" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_PRE_PST_CD        = BVD.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_SEQ               = BVD.VSL_SEQ" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_CD                = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                       AND SVAR.SKD_VOY_NO            = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND SVAR.SKD_DIR_CD            = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND (SVAR.POL_CD                = VVPS.VPS_PORT_CD  OR SVAR.POD_CD                = VVPS.VPS_PORT_CD)" ).append("\n"); 
		query.append("                                       AND NVL(SVAR.POL_CLPT_IND_SEQ, 1) = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                       AND SDC.SPCL_CGO_APRO_CD IS NOT NULL" ).append("\n"); 
		query.append("                                       AND SDC.SPCL_CGO_APRO_CD NOT IN ('C','D')" ).append("\n"); 
		query.append("                                       AND SAR.LST_RQST_DAT_FLG = 'Y'" ).append("\n"); 
		query.append("                                       AND (VVPS.SKD_CNG_STS_CD <> 'S' OR VVPS.SKD_CNG_STS_CD IS NULL)" ).append("\n"); 
		query.append("                                     AND EXISTS (" ).append("\n"); 
		query.append("                                                  SELECT 1" ).append("\n"); 
		query.append("                                                    FROM BKG_BOOKING C" ).append("\n"); 
		query.append("                                                   WHERE SDC.BKG_NO = C.BKG_NO" ).append("\n"); 
		query.append("                                                     AND C.BKG_STS_CD <> 'X'" ).append("\n"); 
		query.append("                                                )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                        AND SDC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${skd_voy_no} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.SKD_VOY_NO = @[skd_voy_no]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.SKD_DIR_CD = @[skd_dir_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                        AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                              )A,SCG_AUTHORIZATION G" ).append("\n"); 
		query.append("                                                                      WHERE A.BKG_NO                           = G.BKG_NO (+)" ).append("\n"); 
		query.append("                                                                     AND A.SPCL_CGO_APRO_RQST_SEQ = G.SPCL_CGO_APRO_RQST_SEQ (+)" ).append("\n"); 
		query.append("                                                                     AND A.VSL_PRE_PST_CD               = G.VSL_PRE_PST_CD (+)" ).append("\n"); 
		query.append("                                                                     AND A.VSL_SEQ                           = G.VSL_SEQ (+)" ).append("\n"); 
		query.append("                                                                     AND A.DCGO_SEQ               = G.DCGO_SEQ (+)" ).append("\n"); 
		query.append("                                                                        #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                                                            AND    G.SPCL_CGO_AUTH_CD             = 'P'" ).append("\n"); 
		query.append("                                                                        #end" ).append("\n"); 
		query.append("                                                                        #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                                                            AND NVL(G.SPCL_CGO_AUTH_CD,'R') = 'R'" ).append("\n"); 
		query.append("                                                                        #end" ).append("\n"); 
		query.append("                                                                        #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                                                            AND G.SPCL_CGO_AUTH_CD             = 'Y'" ).append("\n"); 
		query.append("                                                                        #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       AND A.SPCL_CGO_APRO_CD IN('P','R','Y')" ).append("\n"); 
		query.append("                                UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    -- Own BKG`s SPCL CGO Info" ).append("\n"); 
		query.append("                                    SELECT SDC.BKG_NO," ).append("\n"); 
		query.append("                                               SDC.DCGO_SEQ," ).append("\n"); 
		query.append("                                               VVPS.SLAN_CD," ).append("\n"); 
		query.append("                                               VVPS.VSL_CD," ).append("\n"); 
		query.append("                                               VVPS.SKD_VOY_NO," ).append("\n"); 
		query.append("                                               VVPS.SKD_DIR_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = 'CNSHA'" ).append("\n"); 
		query.append("                                                   ) AS PRT_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = 'CNSHA'" ).append("\n"); 
		query.append("                                                   ) AS PRT_SEQ," ).append("\n"); 
		query.append("                                               SVAR.POL_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.CLPT_IND_SEQ = BVD.POL_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = BVD.POL_CD" ).append("\n"); 
		query.append("                                                   ) AS POL_SEQ," ).append("\n"); 
		query.append("                                                SVAR.POD_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.CLPT_IND_SEQ = BVD.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = BVD.POD_CD" ).append("\n"); 
		query.append("                                                   ) AS POD_SEQ," ).append("\n"); 
		query.append("                                               NVL(SDC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                               SDC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                               SDC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                               SDC.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                               SDC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                               SDC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                               SUBSTR(SDC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                               SDC.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                               SDC.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                               SDC.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                               SDC.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                              1 AS NET_WGT," ).append("\n"); 
		query.append("                                              ( SELECT COUNT(DISTINCT DG_CNTR_SEQ) FROM SCG_DG_CGO  " ).append("\n"); 
		query.append("                                                 WHERE BKG_NO = SDC.BKG_NO" ).append("\n"); 
		query.append("                                                 AND IMDG_CLSS_CD = SDC.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                                 AND SPCL_CGO_APRO_CD IS NOT NULL" ).append("\n"); 
		query.append("                                                 AND SPCL_CGO_APRO_CD NOT IN ('C','D')) AS GRS_WGT," ).append("\n"); 
		query.append("                                              1 AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                               VVPS.VPS_ETA_DT," ).append("\n"); 
		query.append("                                                                   SDC.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                    VVPS.YD_CD" ).append("\n"); 
		query.append("                                      FROM SCG_DG_CGO        SDC," ).append("\n"); 
		query.append("                                           SCG_APRO_RQST     SAR," ).append("\n"); 
		query.append("                                           SCG_VVD_APRO_RQST SVAR," ).append("\n"); 
		query.append("                                           BKG_VVD           BVD," ).append("\n"); 
		query.append("                                           VSK_VSL_PORT_SKD  VVPS," ).append("\n"); 
		query.append("                                                                                 SCG_AUTHORIZATION G" ).append("\n"); 
		query.append("                                                                        WHERE SDC.BKG_NO                           = G.BKG_NO" ).append("\n"); 
		query.append("                                                                         AND SDC.SPCL_CGO_APRO_RQST_SEQ = G.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                                                         AND SVAR.VSL_PRE_PST_CD               = G.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                                                         AND SVAR.VSL_SEQ                           = G.VSL_SEQ" ).append("\n"); 
		query.append("                                                                         AND SDC.DCGO_SEQ               = G.DCGO_SEQ" ).append("\n"); 
		query.append("                                       AND SDC.BKG_NO                 = SAR.BKG_NO" ).append("\n"); 
		query.append("                                       AND SDC.SPCL_CGO_APRO_RQST_SEQ = SAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                       AND SAR.BKG_NO                 = SVAR.BKG_NO" ).append("\n"); 
		query.append("                                       AND SAR.SPCL_CGO_APRO_RQST_SEQ = SVAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                       AND SVAR.BKG_NO                = BVD.BKG_NO" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_PRE_PST_CD        = BVD.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_SEQ               = BVD.VSL_SEQ" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_CD                = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                       AND SVAR.SKD_VOY_NO            = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND SVAR.SKD_DIR_CD            = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND (SVAR.POL_CD                = VVPS.VPS_PORT_CD  OR SVAR.POD_CD                = VVPS.VPS_PORT_CD)" ).append("\n"); 
		query.append("                                       AND NVL(SVAR.POL_CLPT_IND_SEQ, 1) = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                       AND SDC.SPCL_CGO_APRO_CD IS NOT NULL" ).append("\n"); 
		query.append("                                       AND SDC.SPCL_CGO_APRO_CD NOT IN ('C','D')" ).append("\n"); 
		query.append("                                       AND SAR.LST_RQST_DAT_FLG = 'Y'" ).append("\n"); 
		query.append("                                       AND (VVPS.SKD_CNG_STS_CD <> 'S' OR VVPS.SKD_CNG_STS_CD IS NULL)" ).append("\n"); 
		query.append("                                     AND EXISTS (" ).append("\n"); 
		query.append("                                                  SELECT 1" ).append("\n"); 
		query.append("                                                    FROM BKG_BOOKING C" ).append("\n"); 
		query.append("                                                   WHERE SDC.BKG_NO = C.BKG_NO" ).append("\n"); 
		query.append("                                                     AND C.BKG_STS_CD <> 'X'" ).append("\n"); 
		query.append("                                                )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                                        #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                                                            AND    G.SPCL_CGO_AUTH_CD             = 'P'" ).append("\n"); 
		query.append("                                                                        #end" ).append("\n"); 
		query.append("                                                                        #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                                                            AND NVL(G.SPCL_CGO_AUTH_CD,'R') = 'R'" ).append("\n"); 
		query.append("                                                                        #end" ).append("\n"); 
		query.append("                                                                        #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                                                            AND G.SPCL_CGO_AUTH_CD             = 'Y'" ).append("\n"); 
		query.append("                                                                        #end" ).append("\n"); 
		query.append("                                       AND SPCL_CGO_APRO_CD IN('P','R','Y')" ).append("\n"); 
		query.append("                                       #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                        AND SDC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${skd_voy_no} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.SKD_VOY_NO = @[skd_voy_no]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.SKD_DIR_CD = @[skd_dir_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                        AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    -- Partner Lines SPCL CGO Info" ).append("\n"); 
		query.append("                                    SELECT SPAR.BKG_REF_NO," ).append("\n"); 
		query.append("                                           SPAC.SPCL_CGO_SEQ," ).append("\n"); 
		query.append("                                           SPAR.SLAN_CD," ).append("\n"); 
		query.append("                                           SPAR.VSL_CD," ).append("\n"); 
		query.append("                                           SPAR.SKD_VOY_NO," ).append("\n"); 
		query.append("                                           SPAR.SKD_DIR_CD," ).append("\n"); 
		query.append("                                           (SELECT SVVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = 'CNSHA'" ).append("\n"); 
		query.append("                                                   ) AS PRT_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = 'CNSHA'" ).append("\n"); 
		query.append("                                                   ) AS PRT_SEQ," ).append("\n"); 
		query.append("                                               SPAR.POL_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.CLPT_IND_SEQ = SPAR.POL_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = SPAR.POL_CD" ).append("\n"); 
		query.append("                                                   ) AS POL_SEQ," ).append("\n"); 
		query.append("                                                SPAR.POD_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.CLPT_IND_SEQ = NVL(SPAR.POD_CLPT_IND_SEQ,1)" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = SPAR.POD_CD" ).append("\n"); 
		query.append("                                                   ) AS POD_SEQ," ).append("\n"); 
		query.append("                                               NVL(SPAC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                               SPAC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                               SPAC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                               (SELECT IMDG_COMP_GRP_CD FROM SCG_IMDG_UN_NO WHERE  IMDG_UN_NO = SPAC.IMDG_UN_NO AND  IMDG_UN_NO_SEQ = SPAC.IMDG_UN_NO_SEQ) AS IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                                  SPAC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                               SPAC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                                SUBSTR(SPAC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                                SPAC.N1ST_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                                SPAC.N2ND_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                                SPAC.N3RD_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                                SPAC.N4TH_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                               1 AS NET_WGT," ).append("\n"); 
		query.append("                                               (SELECT COUNT(DISTINCT SPCL_CNTR_SEQ) FROM SCG_PRNR_APRO_RQST_CGO  " ).append("\n"); 
		query.append("                                                WHERE CRR_CD = SPAC.CRR_CD" ).append("\n"); 
		query.append("                                                AND BKG_REF_NO = SPAC.BKG_REF_NO" ).append("\n"); 
		query.append("                                                AND IMDG_CLSS_CD = SPAC.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                                AND SPCL_CGO_RQST_SEQ = SPAC.SPCL_CGO_RQST_SEQ) AS GRS_WGT," ).append("\n"); 
		query.append("                                               1 AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                               VVPS.VPS_ETA_DT," ).append("\n"); 
		query.append("                                               SPAC.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                              VVPS.YD_CD" ).append("\n"); 
		query.append("                                     FROM  SCG_PRNR_APRO_RQST      SPAR," ).append("\n"); 
		query.append("                                           (" ).append("\n"); 
		query.append("                                                                                 SELECT T.*" ).append("\n"); 
		query.append("                                                                                      , AVG(DECODE(T.AUTH_STS_CD,'Y',1,'N',2,-999)) OVER(PARTITION BY T.CRR_CD, T.BKG_REF_NO, T.SPCL_CGO_RQST_SEQ) STS_CT" ).append("\n"); 
		query.append("                                                                                   FROM SCG_PRNR_APRO_RQST_CGO T" ).append("\n"); 
		query.append("                                                                             ) SPAC," ).append("\n"); 
		query.append("                                           VSK_VSL_PORT_SKD        VVPS" ).append("\n"); 
		query.append("                                     WHERE 1=1" ).append("\n"); 
		query.append("                                       AND SPAR.CRR_CD            = SPAC.CRR_CD" ).append("\n"); 
		query.append("                                       AND SPAR.BKG_REF_NO        = SPAC.BKG_REF_NO" ).append("\n"); 
		query.append("                                       AND SPAR.SPCL_CGO_RQST_SEQ = SPAC.SPCL_CGO_RQST_SEQ" ).append("\n"); 
		query.append("                                       AND SPAR.VSL_CD            = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                       AND SPAR.SKD_VOY_NO        = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND SPAR.SKD_DIR_CD        = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND NVL(SPAR.POL_CLPT_IND_SEQ,1)  = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                       AND SPAR.POD_CD            = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND SPAR.DG_FLG            = 'Y'" ).append("\n"); 
		query.append("                                       AND SPAR.LST_RQST_DAT_FLG  = 'Y'" ).append("\n"); 
		query.append("                                       AND (VVPS.SKD_CNG_STS_CD <> 'S' OR VVPS.SKD_CNG_STS_CD IS NULL)" ).append("\n"); 
		query.append("                                       AND SPAC.STS_CT < 2" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                                        #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                                                            AND    SPAC.AUTH_STS_CD            = 'P'" ).append("\n"); 
		query.append("                                                                        #end" ).append("\n"); 
		query.append("                                                                        #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                                                            AND SPAC.AUTH_STS_CD = 'R'" ).append("\n"); 
		query.append("                                                                        #end" ).append("\n"); 
		query.append("                                                                        #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                                                            AND SPAC.AUTH_STS_CD             = 'Y'" ).append("\n"); 
		query.append("                                                                        #end" ).append("\n"); 
		query.append("                                       AND SPAC.AUTH_STS_CD IN('P','R','Y')" ).append("\n"); 
		query.append("                                       --AND SPAC.AUTH_STS_CD IN('Y','N','R','P')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                        AND SPAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                        AND SPAC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                        AND SPAR.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${skd_voy_no} != '')" ).append("\n"); 
		query.append("                                        AND SPAR.SKD_VOY_NO = @[skd_voy_no]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                        AND SPAR.SKD_DIR_CD = @[skd_dir_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                        AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ) A" ).append("\n"); 
		query.append("                             WHERE PRT_SEQ = POD_SEQ --DISCHARGE" ).append("\n"); 
		query.append("                        UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                       SELECT A.BKG_NO, A.DCGO_SEQ," ).append("\n"); 
		query.append("                                  A.SLAN_CD," ).append("\n"); 
		query.append("                                  A.VSL_CD," ).append("\n"); 
		query.append("                                  A.SKD_VOY_NO," ).append("\n"); 
		query.append("                                  A.SKD_DIR_CD," ).append("\n"); 
		query.append("                                  A.PRT_CD," ).append("\n"); 
		query.append("                                  A.POL_CD," ).append("\n"); 
		query.append("                                  A.POD_CD," ).append("\n"); 
		query.append("                                  A.WGT_UT_CD," ).append("\n"); 
		query.append("                                  A.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                  A.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                  A.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                  A.IMDG_UN_NO," ).append("\n"); 
		query.append("                                  A.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                  A.CNTR_TP_CD," ).append("\n"); 
		query.append("                                  A.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                  A.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                  A.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                  A.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                  0 AS ARR_NET_WGT, 0 AS ARR_GRS_WGT, 0 AS ARR_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                  0 AS DCHG_NET_WGT, 0 AS DCHG_GRS_WGT, 0 AS DCHG_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                  NET_WGT AS LOD_NET_WGT, GRS_WGT AS LOD_GRS_WGT, NET_EXPLO_WGT AS LOD_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                  0 AS DEP_NET_WGT, 0 AS DEP_GRS_WGT, 0 AS DEP_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                  A.VPS_ETA_DT, A.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                  '3LOAD' PORT_LMT_KND," ).append("\n"); 
		query.append("                                  A.YD_CD" ).append("\n"); 
		query.append("                          FROM (" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                        SELECT A.BKG_NO,A.DCGO_SEQ,A.SLAN_CD,A.VSL_CD,A.SKD_VOY_NO,A.SKD_DIR_CD,A.PRT_CD,A.PRT_SEQ,A.POL_CD,A.POL_SEQ,A.POD_CD,A.POD_SEQ," ).append("\n"); 
		query.append("                                                    A.WGT_UT_CD,A.IMDG_CLSS_CD,A.FLSH_PNT_CDO_TEMP,A.IMDG_COMP_GRP_CD,A.IMDG_UN_NO,A.IMDG_UN_NO_SEQ,A.CNTR_TP_CD,A.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                                    A.IMDG_SUBS_RSK_LBL_CD2,A.IMDG_SUBS_RSK_LBL_CD3,A.IMDG_SUBS_RSK_LBL_CD4,A.NET_WGT,A.GRS_WGT,A.NET_EXPLO_WGT,A.VPS_ETA_DT,A.IMDG_PCK_GRP_CD,A.YD_CD" ).append("\n"); 
		query.append("                                          FROM" ).append("\n"); 
		query.append("                                                 (" ).append("\n"); 
		query.append("                                    -- Own BKG`s SPCL CGO Info" ).append("\n"); 
		query.append("                                    SELECT SDC.BKG_NO," ).append("\n"); 
		query.append("                                      SDC.SPCL_CGO_APRO_CD," ).append("\n"); 
		query.append("                                      SDC.DCGO_SEQ," ).append("\n"); 
		query.append("                                      VVPS.SLAN_CD," ).append("\n"); 
		query.append("                                      VVPS.VSL_CD," ).append("\n"); 
		query.append("                                      VVPS.SKD_VOY_NO," ).append("\n"); 
		query.append("                                      VVPS.SKD_DIR_CD," ).append("\n"); 
		query.append("                                      (SELECT SVVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                      FROM VSK_VSL_PORT_SKD SVVPS" ).append("\n"); 
		query.append("                                      WHERE 1               =1" ).append("\n"); 
		query.append("                                      AND SVVPS.SLAN_CD     = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                      AND SVVPS.VSL_CD      = BVD.VSL_CD" ).append("\n"); 
		query.append("                                      AND SVVPS.SKD_VOY_NO  = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                      AND SVVPS.SKD_DIR_CD  = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                      AND SVVPS.VPS_PORT_CD = 'CNSHA'" ).append("\n"); 
		query.append("                                      ) AS PRT_CD," ).append("\n"); 
		query.append("                                      (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                      FROM VSK_VSL_PORT_SKD SVVPS" ).append("\n"); 
		query.append("                                      WHERE 1               =1" ).append("\n"); 
		query.append("                                      AND SVVPS.SLAN_CD     = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                      AND SVVPS.VSL_CD      = BVD.VSL_CD" ).append("\n"); 
		query.append("                                      AND SVVPS.SKD_VOY_NO  = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                      AND SVVPS.SKD_DIR_CD  = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                      AND SVVPS.VPS_PORT_CD = 'CNSHA'" ).append("\n"); 
		query.append("                                      ) AS PRT_SEQ," ).append("\n"); 
		query.append("                                      SVAR.POL_CD," ).append("\n"); 
		query.append("                                      (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                      FROM VSK_VSL_PORT_SKD SVVPS" ).append("\n"); 
		query.append("                                      WHERE 1                =1" ).append("\n"); 
		query.append("                                      AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                      AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                      AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                      AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                      AND SVVPS.CLPT_IND_SEQ = BVD.POL_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                      AND SVVPS.VPS_PORT_CD  = BVD.POL_CD" ).append("\n"); 
		query.append("                                      ) AS POL_SEQ," ).append("\n"); 
		query.append("                                      SVAR.POD_CD," ).append("\n"); 
		query.append("                                      (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                      FROM VSK_VSL_PORT_SKD SVVPS" ).append("\n"); 
		query.append("                                      WHERE 1                =1" ).append("\n"); 
		query.append("                                      AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                      AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                      AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                      AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                      AND SVVPS.CLPT_IND_SEQ = BVD.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                      AND SVVPS.VPS_PORT_CD  = BVD.POD_CD" ).append("\n"); 
		query.append("                                      )                         AS POD_SEQ," ).append("\n"); 
		query.append("                                      NVL(SDC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                      SDC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                      SDC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                      SDC.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                      SDC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                      SDC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                      SUBSTR(SDC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                      SDC.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                      SDC.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                      SDC.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                      SDC.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                      1 AS NET_WGT," ).append("\n"); 
		query.append("                                       ( SELECT COUNT(DISTINCT DG_CNTR_SEQ) FROM BKG_DG_CGO  " ).append("\n"); 
		query.append("                                       WHERE BKG_NO = SDC.BKG_NO" ).append("\n"); 
		query.append("                                       AND IMDG_CLSS_CD = SDC.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                       AND SPCL_CGO_APRO_CD IS NOT NULL" ).append("\n"); 
		query.append("                                       AND SPCL_CGO_APRO_CD NOT IN ('C','D')) AS GRS_WGT," ).append("\n"); 
		query.append("                                      1 AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                      VVPS.VPS_ETA_DT," ).append("\n"); 
		query.append("                                      SDC.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                      SVAR.VSL_PRE_PST_CD," ).append("\n"); 
		query.append("                                      SVAR.VSL_SEQ," ).append("\n"); 
		query.append("                                      SAR.SPCL_CGO_APRO_RQST_SEQ," ).append("\n"); 
		query.append("                                      VVPS.YD_CD" ).append("\n"); 
		query.append("                                    FROM BKG_DG_CGO SDC," ).append("\n"); 
		query.append("                                      SCG_APRO_RQST SAR," ).append("\n"); 
		query.append("                                      SCG_VVD_APRO_RQST SVAR," ).append("\n"); 
		query.append("                                      BKG_VVD BVD," ).append("\n"); 
		query.append("                                      VSK_VSL_PORT_SKD VVPS" ).append("\n"); 
		query.append("                                                                        WHERE 1 = 1" ).append("\n"); 
		query.append("                                       AND SDC.BKG_NO                 = SAR.BKG_NO" ).append("\n"); 
		query.append("                                       AND SAR.BKG_NO                 = SVAR.BKG_NO" ).append("\n"); 
		query.append("                                       AND SAR.SPCL_CGO_APRO_RQST_SEQ = SVAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                       AND SVAR.BKG_NO                = BVD.BKG_NO" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_PRE_PST_CD        = BVD.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_SEQ               = BVD.VSL_SEQ" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_CD                = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                       AND SVAR.SKD_VOY_NO            = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND SVAR.SKD_DIR_CD            = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND (SVAR.POL_CD                = VVPS.VPS_PORT_CD  OR SVAR.POD_CD                = VVPS.VPS_PORT_CD)" ).append("\n"); 
		query.append("                                       AND NVL(SVAR.POL_CLPT_IND_SEQ, 1) = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                       AND SDC.SPCL_CGO_APRO_CD IS NOT NULL" ).append("\n"); 
		query.append("                                       AND SDC.SPCL_CGO_APRO_CD NOT IN ('C','D')" ).append("\n"); 
		query.append("                                       AND SAR.LST_RQST_DAT_FLG = 'Y'" ).append("\n"); 
		query.append("                                       AND (VVPS.SKD_CNG_STS_CD <> 'S' OR VVPS.SKD_CNG_STS_CD IS NULL)" ).append("\n"); 
		query.append("                                     AND EXISTS (" ).append("\n"); 
		query.append("                                                  SELECT 1" ).append("\n"); 
		query.append("                                                    FROM BKG_BOOKING C" ).append("\n"); 
		query.append("                                                   WHERE SDC.BKG_NO = C.BKG_NO" ).append("\n"); 
		query.append("                                                     AND C.BKG_STS_CD <> 'X'" ).append("\n"); 
		query.append("                                                )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                       #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                        AND SDC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${skd_voy_no} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.SKD_VOY_NO = @[skd_voy_no]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.SKD_DIR_CD = @[skd_dir_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                        AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                              )A,SCG_AUTHORIZATION G" ).append("\n"); 
		query.append("                                                                      WHERE A.BKG_NO                           = G.BKG_NO (+)" ).append("\n"); 
		query.append("                                                                     AND A.SPCL_CGO_APRO_RQST_SEQ = G.SPCL_CGO_APRO_RQST_SEQ (+)" ).append("\n"); 
		query.append("                                                                     AND A.VSL_PRE_PST_CD               = G.VSL_PRE_PST_CD (+)" ).append("\n"); 
		query.append("                                                                     AND A.VSL_SEQ                           = G.VSL_SEQ (+)" ).append("\n"); 
		query.append("                                                                     AND A.DCGO_SEQ               = G.DCGO_SEQ (+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                                        #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                                                            AND    G.SPCL_CGO_AUTH_CD             = 'P'" ).append("\n"); 
		query.append("                                                                        #end" ).append("\n"); 
		query.append("                                                                        #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                                                            AND NVL(G.SPCL_CGO_AUTH_CD,'R') = 'R'" ).append("\n"); 
		query.append("                                                                        #end" ).append("\n"); 
		query.append("                                                                        #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                                                            AND G.SPCL_CGO_AUTH_CD             = 'Y'" ).append("\n"); 
		query.append("                                                                        #end" ).append("\n"); 
		query.append("                                       AND A.SPCL_CGO_APRO_CD IN('P','R','Y')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                   UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    -- Own BKG`s SPCL CGO Info" ).append("\n"); 
		query.append("                                    SELECT SDC.BKG_NO," ).append("\n"); 
		query.append("                                           SDC.DCGO_SEQ," ).append("\n"); 
		query.append("                                           VVPS.SLAN_CD," ).append("\n"); 
		query.append("                                           VVPS.VSL_CD," ).append("\n"); 
		query.append("                                           VVPS.SKD_VOY_NO," ).append("\n"); 
		query.append("                                           VVPS.SKD_DIR_CD," ).append("\n"); 
		query.append("                                           (SELECT SVVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                             WHERE 1=1" ).append("\n"); 
		query.append("                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                               AND SVVPS.VPS_PORT_CD  = 'CNSHA'" ).append("\n"); 
		query.append("                                               ) AS PRT_CD," ).append("\n"); 
		query.append("                                           (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                             WHERE 1=1" ).append("\n"); 
		query.append("                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                               AND SVVPS.VPS_PORT_CD  = 'CNSHA'" ).append("\n"); 
		query.append("                                               ) AS PRT_SEQ," ).append("\n"); 
		query.append("                                           SVAR.POL_CD," ).append("\n"); 
		query.append("                                           (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                             WHERE 1=1" ).append("\n"); 
		query.append("                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                               AND SVVPS.CLPT_IND_SEQ = BVD.POL_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                               AND SVVPS.VPS_PORT_CD  = BVD.POL_CD" ).append("\n"); 
		query.append("                                               ) AS POL_SEQ," ).append("\n"); 
		query.append("                                            SVAR.POD_CD," ).append("\n"); 
		query.append("                                           (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                             WHERE 1=1" ).append("\n"); 
		query.append("                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                               AND SVVPS.CLPT_IND_SEQ = BVD.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                               AND SVVPS.VPS_PORT_CD  = BVD.POD_CD" ).append("\n"); 
		query.append("                                               ) AS POD_SEQ," ).append("\n"); 
		query.append("                                           NVL(SDC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                           SDC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                                                                SDC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                           SDC.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                              SDC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                           SDC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                          SUBSTR(SDC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                           SDC.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                           SDC.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                           SDC.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                           SDC.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                          1 AS NET_WGT," ).append("\n"); 
		query.append("                                           ( SELECT COUNT(DISTINCT DG_CNTR_SEQ) FROM SCG_DG_CGO  " ).append("\n"); 
		query.append("                                           WHERE BKG_NO = SDC.BKG_NO" ).append("\n"); 
		query.append("                                           AND IMDG_CLSS_CD = SDC.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                           AND SPCL_CGO_APRO_CD IS NOT NULL" ).append("\n"); 
		query.append("                                           AND SPCL_CGO_APRO_CD NOT IN ('C','D')) AS GRS_WGT," ).append("\n"); 
		query.append("                                          1 AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                          VVPS.VPS_ETA_DT," ).append("\n"); 
		query.append("                                          SDC.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                          VVPS.YD_CD" ).append("\n"); 
		query.append("                                      FROM SCG_DG_CGO        SDC," ).append("\n"); 
		query.append("                                           SCG_APRO_RQST     SAR," ).append("\n"); 
		query.append("                                           SCG_VVD_APRO_RQST SVAR," ).append("\n"); 
		query.append("                                           BKG_VVD           BVD," ).append("\n"); 
		query.append("                                           VSK_VSL_PORT_SKD  VVPS," ).append("\n"); 
		query.append("                                           SCG_AUTHORIZATION G" ).append("\n"); 
		query.append("                                      WHERE SDC.BKG_NO                           = G.BKG_NO" ).append("\n"); 
		query.append("                                       AND SDC.SPCL_CGO_APRO_RQST_SEQ = G.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_PRE_PST_CD               = G.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_SEQ                           = G.VSL_SEQ" ).append("\n"); 
		query.append("                                       AND SDC.DCGO_SEQ               = G.DCGO_SEQ" ).append("\n"); 
		query.append("                                       AND SDC.BKG_NO                 = SAR.BKG_NO" ).append("\n"); 
		query.append("                                       AND SDC.SPCL_CGO_APRO_RQST_SEQ = SAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                       AND SAR.BKG_NO                 = SVAR.BKG_NO" ).append("\n"); 
		query.append("                                       AND SAR.SPCL_CGO_APRO_RQST_SEQ = SVAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                       AND SVAR.BKG_NO                = BVD.BKG_NO" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_PRE_PST_CD        = BVD.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_SEQ               = BVD.VSL_SEQ" ).append("\n"); 
		query.append("                                       AND SVAR.VSL_CD                = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                       AND SVAR.SKD_VOY_NO            = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND SVAR.SKD_DIR_CD            = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND (SVAR.POL_CD                = VVPS.VPS_PORT_CD  OR SVAR.POD_CD                = VVPS.VPS_PORT_CD)" ).append("\n"); 
		query.append("                                       AND NVL(SVAR.POL_CLPT_IND_SEQ, 1) = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                       AND SDC.SPCL_CGO_APRO_CD IS NOT NULL" ).append("\n"); 
		query.append("                                       AND SDC.SPCL_CGO_APRO_CD NOT IN ('C','D')" ).append("\n"); 
		query.append("                                       AND SAR.LST_RQST_DAT_FLG = 'Y'" ).append("\n"); 
		query.append("                                       AND (VVPS.SKD_CNG_STS_CD <> 'S' OR VVPS.SKD_CNG_STS_CD IS NULL)" ).append("\n"); 
		query.append("                                     AND EXISTS (" ).append("\n"); 
		query.append("                                                  SELECT 1" ).append("\n"); 
		query.append("                                                    FROM BKG_BOOKING C" ).append("\n"); 
		query.append("                                                   WHERE SDC.BKG_NO = C.BKG_NO" ).append("\n"); 
		query.append("                                                     AND C.BKG_STS_CD <> 'X'" ).append("\n"); 
		query.append("                                                )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                        #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                            AND    G.SPCL_CGO_AUTH_CD             = 'P'" ).append("\n"); 
		query.append("                                        #end" ).append("\n"); 
		query.append("                                        #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                            AND NVL(G.SPCL_CGO_AUTH_CD,'R') = 'R'" ).append("\n"); 
		query.append("                                        #end" ).append("\n"); 
		query.append("                                        #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                            AND G.SPCL_CGO_AUTH_CD             = 'Y'" ).append("\n"); 
		query.append("                                        #end" ).append("\n"); 
		query.append("                                        AND SPCL_CGO_APRO_CD IN('P','R','Y')" ).append("\n"); 
		query.append("                                       #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                        AND SDC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${skd_voy_no} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.SKD_VOY_NO = @[skd_voy_no]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                        AND SVAR.SKD_DIR_CD = @[skd_dir_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                        AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    UNION ALL" ).append("\n"); 
		query.append("                                    -- Partner Lines SPCL CGO Info" ).append("\n"); 
		query.append("                                    SELECT SPAR.BKG_REF_NO," ).append("\n"); 
		query.append("                                           SPAC.SPCL_CGO_SEQ," ).append("\n"); 
		query.append("                                           SPAR.SLAN_CD," ).append("\n"); 
		query.append("                                           SPAR.VSL_CD," ).append("\n"); 
		query.append("                                           SPAR.SKD_VOY_NO," ).append("\n"); 
		query.append("                                           SPAR.SKD_DIR_CD," ).append("\n"); 
		query.append("                                           (SELECT SVVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = 'CNSHA'" ).append("\n"); 
		query.append("                                                   ) AS PRT_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = 'CNSHA'" ).append("\n"); 
		query.append("                                                   ) AS PRT_SEQ," ).append("\n"); 
		query.append("                                               SPAR.POL_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.CLPT_IND_SEQ = NVL(SPAR.POL_CLPT_IND_SEQ,1)" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = SPAR.POL_CD" ).append("\n"); 
		query.append("                                                   ) AS POL_SEQ," ).append("\n"); 
		query.append("                                                SPAR.POD_CD," ).append("\n"); 
		query.append("                                               (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                  FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   AND SVVPS.CLPT_IND_SEQ = NVL(SPAR.POD_CLPT_IND_SEQ,1)" ).append("\n"); 
		query.append("                                                   AND SVVPS.VPS_PORT_CD  = SPAR.POD_CD" ).append("\n"); 
		query.append("                                                   ) AS POD_SEQ," ).append("\n"); 
		query.append("                                           NVL(SPAC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                           SPAC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                                                                SPAC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                           (SELECT IMDG_COMP_GRP_CD FROM SCG_IMDG_UN_NO WHERE  IMDG_UN_NO = SPAC.IMDG_UN_NO AND  IMDG_UN_NO_SEQ = SPAC.IMDG_UN_NO_SEQ) AS IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                             SPAC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                           SPAC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                            SUBSTR(SPAC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                            SPAC.N1ST_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                            SPAC.N2ND_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                            SPAC.N3RD_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                            SPAC.N4TH_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                            1 AS NET_WGT," ).append("\n"); 
		query.append("                                            (SELECT COUNT(DISTINCT SPCL_CNTR_SEQ) FROM SCG_PRNR_APRO_RQST_CGO  " ).append("\n"); 
		query.append("                                              WHERE CRR_CD = SPAC.CRR_CD" ).append("\n"); 
		query.append("                                              AND BKG_REF_NO = SPAC.BKG_REF_NO" ).append("\n"); 
		query.append("                                              AND IMDG_CLSS_CD = SPAC.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                              AND SPCL_CGO_RQST_SEQ = SPAC.SPCL_CGO_RQST_SEQ) AS GRS_WGT," ).append("\n"); 
		query.append("                                            1 AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                            VVPS.VPS_ETA_DT," ).append("\n"); 
		query.append("                                            SPAC.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                            VVPS.YD_CD" ).append("\n"); 
		query.append("                                     FROM  SCG_PRNR_APRO_RQST      SPAR," ).append("\n"); 
		query.append("                                           (" ).append("\n"); 
		query.append("                                               SELECT T.*" ).append("\n"); 
		query.append("                                                    , AVG(DECODE(T.AUTH_STS_CD,'Y',1,'N',2,-999)) OVER(PARTITION BY T.CRR_CD, T.BKG_REF_NO, T.SPCL_CGO_RQST_SEQ) STS_CT" ).append("\n"); 
		query.append("                                                 FROM SCG_PRNR_APRO_RQST_CGO T" ).append("\n"); 
		query.append("                                           ) SPAC," ).append("\n"); 
		query.append("                                           VSK_VSL_PORT_SKD        VVPS" ).append("\n"); 
		query.append("                                     WHERE 1=1" ).append("\n"); 
		query.append("                                       AND SPAR.CRR_CD            = SPAC.CRR_CD" ).append("\n"); 
		query.append("                                       AND SPAR.BKG_REF_NO        = SPAC.BKG_REF_NO" ).append("\n"); 
		query.append("                                       AND SPAR.SPCL_CGO_RQST_SEQ = SPAC.SPCL_CGO_RQST_SEQ" ).append("\n"); 
		query.append("                                       AND SPAR.VSL_CD            = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                       AND SPAR.SKD_VOY_NO        = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                       AND SPAR.SKD_DIR_CD        = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                       AND NVL(SPAR.POL_CLPT_IND_SEQ,1)  = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                       AND SPAR.POL_CD            = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                       AND SPAR.DG_FLG            = 'Y'" ).append("\n"); 
		query.append("                                       AND SPAR.LST_RQST_DAT_FLG  = 'Y'" ).append("\n"); 
		query.append("                                       AND (VVPS.SKD_CNG_STS_CD <> 'S' OR VVPS.SKD_CNG_STS_CD IS NULL)" ).append("\n"); 
		query.append("                                       AND SPAC.STS_CT < 2" ).append("\n"); 
		query.append("                                        #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                            AND    SPAC.AUTH_STS_CD            = 'P'" ).append("\n"); 
		query.append("                                        #end" ).append("\n"); 
		query.append("                                        #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                            AND SPAC.AUTH_STS_CD = 'R'" ).append("\n"); 
		query.append("                                        #end" ).append("\n"); 
		query.append("                                        #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                            AND SPAC.AUTH_STS_CD             = 'Y'" ).append("\n"); 
		query.append("                                        #end" ).append("\n"); 
		query.append("                                       AND SPAC.AUTH_STS_CD IN('P','R','Y')" ).append("\n"); 
		query.append("                                       #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                        AND SPAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                        AND SPAC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                        AND SPAR.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${skd_voy_no} != '')" ).append("\n"); 
		query.append("                                        AND SPAR.SKD_VOY_NO = @[skd_voy_no]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                        AND SPAR.SKD_DIR_CD = @[skd_dir_cd]" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("                                       #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                        AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                       #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                    ) A" ).append("\n"); 
		query.append("                                WHERE PRT_SEQ = POL_SEQ --LOAD" ).append("\n"); 
		query.append("                             )" ).append("\n"); 
		query.append("                            GROUP BY BKG_NO, DCGO_SEQ,SLAN_CD,VSL_CD,SKD_VOY_NO,SKD_DIR_CD,PRT_CD,POL_CD,POD_CD,WGT_UT_CD,IMDG_CLSS_CD,FLSH_PNT_CDO_TEMP,IMDG_COMP_GRP_CD,IMDG_UN_NO,IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                        CNTR_TP_CD,IMDG_SUBS_RSK_LBL_CD1,IMDG_SUBS_RSK_LBL_CD2,IMDG_SUBS_RSK_LBL_CD3,IMDG_SUBS_RSK_LBL_CD4,ARR_NET_WGT,ARR_GRS_WGT,ARR_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                        DCHG_NET_WGT,DCHG_GRS_WGT,DCHG_NET_EXPLO_WGT,LOD_NET_WGT,LOD_GRS_WGT,LOD_NET_EXPLO_WGT,DEP_NET_WGT,DEP_GRS_WGT,DEP_NET_EXPLO_WGT,VPS_ETA_DT,IMDG_PCK_GRP_CD,PORT_LMT_KND,YD_CD" ).append("\n"); 
		query.append("                 )" ).append("\n"); 
		query.append("            GROUP BY SLAN_CD, VSL_CD, SKD_VOY_NO, SKD_DIR_CD, PRT_CD, POL_CD, POD_CD, WGT_UT_CD, IMDG_CLSS_CD, FLSH_PNT_CDO_TEMP, PORT_LMT_KND, VPS_ETA_DT, IMDG_PCK_GRP_CD, IMDG_COMP_GRP_CD,IMDG_UN_NO, IMDG_UN_NO_SEQ, CNTR_TP_CD, IMDG_SUBS_RSK_LBL_CD1, IMDG_SUBS_RSK_LBL_CD2, IMDG_SUBS_RSK_LBL_CD3, IMDG_SUBS_RSK_LBL_CD4, BKG_NO, YD_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        ) DGIF" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("  WHERE 1=1" ).append("\n"); 
		query.append("    AND SIPL.PORT_CD             = DGIF.PRT_CD" ).append("\n"); 
		query.append("    AND (SIPL.IMDG_CLSS_CD IS NULL OR SIPL.IMDG_CLSS_CD = DGIF.IMDG_CLSS_CD)" ).append("\n"); 
		query.append("    AND (SIPL.IMDG_COMP_GRP_CD IS NULL OR SIPL.IMDG_COMP_GRP_CD = DGIF.IMDG_COMP_GRP_CD)" ).append("\n"); 
		query.append("    AND (SIPL.PORT_LMT_KND IS NULL OR SIPL.PORT_LMT_KND = DGIF.PORT_LMT_KND)" ).append("\n"); 
		query.append("    AND (SIPL.IMDG_UN_NO IS NULL OR SIPL.IMDG_UN_NO = DGIF.IMDG_UN_NO)" ).append("\n"); 
		query.append("    AND (SIPL.CNTR_TP_CD IS NULL OR SIPL.CNTR_TP_CD = DGIF.CNTR_TP_CD)" ).append("\n"); 
		query.append("    AND (SIPL.IMDG_SUBS_RSK_LBL_CD IS NULL OR SIPL.IMDG_SUBS_RSK_LBL_CD IN (DGIF.IMDG_SUBS_RSK_LBL_CD1, DGIF.IMDG_SUBS_RSK_LBL_CD2, DGIF.IMDG_SUBS_RSK_LBL_CD3, DGIF.IMDG_SUBS_RSK_LBL_CD4) )" ).append("\n"); 
		query.append("    AND (SIPL.FLSH_PNT_TEMP IS NULL OR SIPL.FLSH_PNT_TEMP >= DGIF.FLSH_PNT_CDO_TEMP)" ).append("\n"); 
		query.append("    AND (SIPL.IMDG_PCK_GRP_CD IS NULL OR SIPL.IMDG_PCK_GRP_CD = DGIF.IMDG_PCK_GRP_CD)" ).append("\n"); 
		query.append("    AND DGIF.PRT_CD = 'CNSHA'" ).append("\n"); 
		query.append("    AND SIPL.YD_CD = DGIF.YD_CD" ).append("\n"); 
		query.append("   ) B" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("WHERE A.RN = B.RN(+)" ).append("\n"); 
		query.append("    AND A.PORT_CD = B.PORT_CD(+)" ).append("\n"); 
		query.append("    AND A.PORT_LMT_KND = B.PORT_LMT_KND(+)" ).append("\n"); 
		query.append("    AND A.PORT_LMT_SEQ = B.PORT_LMT_SEQ(+)" ).append("\n"); 
		query.append("    AND A.YD_CD        = B.YD_CD" ).append("\n"); 
		query.append("    AND B.VSL_CD IS NOT NULL" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY RN," ).append("\n"); 
		query.append("    PORT_CD," ).append("\n"); 
		query.append("    PORT_LMT_SEQ," ).append("\n"); 
		query.append("    PORT_LMT_REP_DESC," ).append("\n"); 
		query.append("    BKG_NO," ).append("\n"); 
		query.append("    SLAN_CD," ).append("\n"); 
		query.append("    PRT_CD," ).append("\n"); 
		query.append("    PIER_TP_CD," ).append("\n"); 
		query.append("    VSL_CD," ).append("\n"); 
		query.append("    SKD_VOY_NO ," ).append("\n"); 
		query.append("    SKD_DIR_CD ," ).append("\n"); 
		query.append("    IMDG_CLSS_CD ," ).append("\n"); 
		query.append("    FLSH_PNT_TEMP," ).append("\n"); 
		query.append("    IMDG_CLSS_CD_DESC," ).append("\n"); 
		query.append("    LMT_WGT_TP_CD," ).append("\n"); 
		query.append("    IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("    IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("    IMDG_SUBS_RSK_LBL_CD," ).append("\n"); 
		query.append("    IMDG_UN_NO," ).append("\n"); 
		query.append("    CNTR_TP_CD," ).append("\n"); 
		query.append("    ARR_DEP_PROHI_FLG," ).append("\n"); 
		query.append("    LDIS_APLY_TGT_FLG," ).append("\n"); 
		query.append("    ARR_MAX_LMT," ).append("\n"); 
		query.append("    DCHG_MAX_LMT," ).append("\n"); 
		query.append("    LOD_MAX_LMT," ).append("\n"); 
		query.append("    DEP_MAX_LMT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(") A" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(") A" ).append("\n"); 
		query.append("GROUP BY A.PORT_CD," ).append("\n"); 
		query.append("    A.PORT_LMT_SEQ," ).append("\n"); 
		query.append("    A.PORT_LMT_REP_DESC," ).append("\n"); 
		query.append("    A.LMT_WGT_TP_CD," ).append("\n"); 
		query.append("    A.VSL_CD," ).append("\n"); 
		query.append("    A.SKD_VOY_NO," ).append("\n"); 
		query.append("    A.SKD_DIR_CD," ).append("\n"); 
		query.append("    A.SLAN_CD," ).append("\n"); 
		query.append("    A.PRT_CD," ).append("\n"); 
		query.append("    A.PIER_TP_CD," ).append("\n"); 
		query.append("    A.FLSH_PNT_TEMP" ).append("\n"); 
		query.append("ORDER BY (SELECT B.DP_SEQ FROM SCG_IMDG_PORT_LMT_MST B" ).append("\n"); 
		query.append("      WHERE B.PORT_CD = A.PORT_CD AND B.LMT_WGT_TP_CD IS NULL AND B.PORT_LMT_SEQ = A.PORT_LMT_SEQ)" ).append("\n"); 
		query.append(")" ).append("\n"); 

	}
}