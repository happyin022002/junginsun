<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PSOCodeFinderDBDAOgetTurnPortIndCdRSQL">
			<desc><![CDATA[getTurnPortIndCd
[2015.07.21]Virtual Add Calling 처리. VSK_VSL_PORT_SKD.NVL(VT_ADD_CALL_FLG, 'N') = 'N'
[2015.09.10]Virtual Port와 전체 Count 가 같으면 Virtual 만 존재하므로  D 코드 리턴, 그외는 N 코드 리턴
                  D 일때 화면에서 입력하지 못하도록 처리함.]]></desc>
			<sql><![CDATA[
SELECT CASE WHEN VT_CNT = TOT_CNT THEN 'D'
            ELSE 'N'
       END AS TURN_PORT_IND_CD
  FROM (SELECT SUM(DECODE(VPS.TURN_PORT_IND_CD,'D',1,'V',1,'F',1,0)) AS VT_CNT /*Virtual Port Count*/
             , COUNT(VPS.VSL_CD||VPS.SKD_VOY_NO||VPS.SKD_DIR_CD||VPS.YD_CD) AS TOT_CNT /*All Count*/
             --, VPS.VSL_CD||VPS.SKD_VOY_NO||VPS.SKD_DIR_CD AS VVD
             --, VPS.YD_CD
          FROM VSK_VSL_PORT_SKD VPS
         WHERE VSL_CD = @[vsl_cd]
           AND SKD_VOY_NO =  @[skd_voy_no]
           AND SKD_DIR_CD = @[skd_dir_cd]
           AND YD_CD = @[yd_cd]
           AND NVL(SKD_CNG_STS_CD, ' ') != 'S' /*skip port 는 제외.*/
           AND NVL(VT_ADD_CALL_FLG, 'N') = 'N' /*2015.07.21 Add*/
         --GROUP BY VPS.VSL_CD||VPS.SKD_VOY_NO||VPS.SKD_DIR_CD, VPS.YD_CD 
        )			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="ACKT" out="N"/>
				<param name="skd_voy_no" type="12" value="0024" out="N"/>
				<param name="skd_dir_cd" type="12" value="S" out="N"/>
				<param name="yd_cd" type="12" value="KRPUS01" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
