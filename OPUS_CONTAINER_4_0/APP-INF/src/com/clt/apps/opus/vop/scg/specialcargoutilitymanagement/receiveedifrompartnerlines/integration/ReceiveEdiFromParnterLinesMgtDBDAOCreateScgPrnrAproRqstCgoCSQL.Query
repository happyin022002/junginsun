<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ReceiveEdiFromParnterLinesMgtDBDAOCreateScgPrnrAproRqstCgoCSQL">
			<desc><![CDATA[Partner사 승인요청 Cargo Detail]]></desc>
			<sql><![CDATA[
INSERT INTO  SCG_PRNR_APRO_RQST_CGO
    (  CRR_CD
    ,  BKG_REF_NO
    ,  SPCL_CGO_RQST_SEQ
	,  PRNR_CGO_RQST_SEQ

    ,  SPCL_CNTR_SEQ
    ,  SPCL_CGO_SEQ
    ,  CGO_OPR_CD
    ,  SPCL_CGO_CATE_CD
    ,  CNTR_REF_NO
    ,  CNTR_TPSZ_CD
    ,  IMDG_UN_NO
    ,  IMDG_UN_NO_SEQ
    ,  IMDG_CLSS_CD

    ,  N1ST_IMDG_SUBS_RSK_LBL_CD
    ,  N2ND_IMDG_SUBS_RSK_LBL_CD
    ,  N3RD_IMDG_SUBS_RSK_LBL_CD
    ,  N4TH_IMDG_SUBS_RSK_LBL_CD
    ,  N5TH_IMDG_SUBS_RSK_LBL_CD
    ,  N6TH_IMDG_SUBS_RSK_LBL_CD
    ,  N7TH_IMDG_SUBS_RSK_LBL_CD
    ,  N8TH_IMDG_SUBS_RSK_LBL_CD

    ,  IMDG_CO_GRP_CD
    ,  IMDG_PCK_GRP_CD
    ,  IMDG_LMT_QTY_FLG
    ,  IMDG_EXPT_QTY_FLG
    ,  MRN_POLUT_FLG
    ,  FLSH_PNT_CDO_TEMP
    ,  PRP_SHP_NM
    ,  HZD_DESC

    --,  DCGO_STS_CD

    ----,  MEAS_QTY
    ,  MEAS_TP_CD
    ----,  PCK_QTY
    ,  PCK_TP_CD
    ----,  CLOD_FLG
    ,  SPCL_STWG_RQST_DESC
    ,  CGO_LCL_FLG
    ,  EMER_RSPN_GID_NO
    ,  EMER_RSPN_GID_CHR_NO
    ,  EMER_CNTC_PHN_NO
    ,  EMER_CNTC_PSON_NM
    ,  EMER_TEMP_CTNT
    ,  CTRL_TEMP_CTNT
    ,  EMS_NO
    ,  CMDT_DESC

    ,  NET_WGT
    ,  GRS_WGT
    ,  WGT_UT_CD
    ,  PSA_NO
    ,  CERTI_NO
    ,  IN_N1ST_IMDG_PCK_QTY
    ,  IN_N1ST_IMDG_PCK_CD
    ,  IN_N2ND_IMDG_PCK_QTY
    ,  IN_N2ND_IMDG_PCK_CD
    ,  INTMD_N1ST_IMDG_PCK_QTY
    ,  INTMD_N1ST_IMDG_PCK_CD
    ,  INTMD_N2ND_IMDG_PCK_QTY
    ,  INTMD_N2ND_IMDG_PCK_CD
    ,  OUT_N1ST_IMDG_PCK_QTY
    ,  OUT_N1ST_IMDG_PCK_CD
    ,  OUT_N2ND_IMDG_PCK_QTY
    ,  OUT_N2ND_IMDG_PCK_CD
    ,  MAX_IN_PCK_QTY
    ,  MAX_IN_PCK_TP_CD
    ,  CNEE_DTL_DESC
    ,  NET_EXPLO_WGT
    ,  RADA_SKD_NO
    ,  RADA_AMT
    ,  RADA_UT_CD
    ,  DIFF_RMK
    ,  CGO_RQST_DT
    ,  AUTH_DT
    ,  AUTH_OFC_CD
    ,  AUTH_USR_ID
    ,  AUTH_STS_CD

    -- ::2015-09-24:by TOP:: --,  APRO_REF_NO

    ,  CRE_USR_ID
    ,  CRE_DT
    ,  UPD_USR_ID
    ,  UPD_DT
    ,  RADA_TRSP_NO
    ,  CFR_FLG
    ,  CGO_UPD_STS_CD
    ,  MVMT_SPCL_TP_CD
    ,  ORG_PRP_SHP_NM
    ,  ESP_NO
    ,  IMDG_PPR_NO
    ,  MFAG_NO
    ,  IMDG_TEC_NM
    ,  OUT_N1ST_IMDG_PCK_DESC
    ,  INTMD_N1ST_IMDG_PCK_DESC
    ,  IN_N1ST_IMDG_PCK_DESC
    ,  CFR_NO
    ,  RSD_FLG
    ,  CNTR_DMY_REF_NO
    ,  REF_NO
    ,  SPCL_CGO_AUTH_RJCT_CD
    ,  SPCL_CGO_AUTH_RMK

    --,  IMDG_SEGR_GRP_NO

    ,  DCGO_REF_NO
    ,  SPCL_RQST_FLG
    ,  EDW_UPD_DT
    ,  IMDG_AMDT_NO
    
    ,  DCGO_SEQ  
	,  EDI_PRP_SHP_NM

	,  EDI_CGO_UNMAP_DTL_CD
    
	--::2015-10-22::--
	,  DCGO_STS_CD
	,  IMDG_SEGR_GRP_NO
	)

SELECT       
       X.EDI_RCVR_ID        					/* CRR_CD            			*/                    
    ,  X.BKG_REF_NO                         	/* BKG_REF_NO                   */   
    ,  @[spcl_cgo_rqst_seq]						/* SPCL_CGO_RQST_SEQ            */   
	,  @[prnr_cgo_rqst_seq]			 			/* PRNR_CGO_RQST_SEQ 			*/

    ,  Y.CNTR_SEQ               				/* SPCL_CNTR_SEQ                */   
    ,  Y.CGO_SEQ           						/* SPCL_CGO_SEQ                 */   
    ,  X.CGO_OPR_CD                     		/* CGO_OPR_CD                   */   
    ,  X.SPCL_CGO_CATE_CD                 		/* SPCL_CGO_CATE_CD             */   
    ,  Y.CNTR_REF_NO               				/* CNTR_REF_NO                  */   
    ,  Y.CNTR_TPSZ_CD_CTNT                		/* CNTR_TPSZ_CD                 */   
    ,  Y.IMDG_UN_NO_CTNT                        /* IMDG_UN_NO                   */   
    ,  Y.IMDG_UN_NO_SEQ                         /* IMDG_UN_NO_SEQ               */   
    ,  Y.IMDG_CLSS_CD_CTNT                		/* IMDG_CLSS_CD                 */   

	-- ::2015-07-25:by TOP:: --
    ,  (SELECT CL.IMDG_CLSS_CD FROM SCG_IMDG_CLSS_CD CL WHERE CL.IMDG_CLSS_CD = Y.N1ST_IMDG_SUBS_RSK_LBL_CD)	/* N1ST_IMDG_SUBS_RSK_LBL_CD    */
    ,  (SELECT CL.IMDG_CLSS_CD FROM SCG_IMDG_CLSS_CD CL WHERE CL.IMDG_CLSS_CD = Y.N2ND_IMDG_SUBS_RSK_LBL_CD)	/* N2ND_IMDG_SUBS_RSK_LBL_CD    */
    ,  (SELECT CL.IMDG_CLSS_CD FROM SCG_IMDG_CLSS_CD CL WHERE CL.IMDG_CLSS_CD = Y.N3RD_IMDG_SUBS_RSK_LBL_CD)	/* N3RD_IMDG_SUBS_RSK_LBL_CD    */
    ,  (SELECT CL.IMDG_CLSS_CD FROM SCG_IMDG_CLSS_CD CL WHERE CL.IMDG_CLSS_CD = Y.N4TH_IMDG_SUBS_RSK_LBL_CD)	/* N4TH_IMDG_SUBS_RSK_LBL_CD    */
    ,  (SELECT CL.IMDG_CLSS_CD FROM SCG_IMDG_CLSS_CD CL WHERE CL.IMDG_CLSS_CD = Y.N5TH_IMDG_SUBS_RSK_LBL_CD)	/* N5TH_IMDG_SUBS_RSK_LBL_CD    */
    ,  (SELECT CL.IMDG_CLSS_CD FROM SCG_IMDG_CLSS_CD CL WHERE CL.IMDG_CLSS_CD = Y.N6TH_IMDG_SUBS_RSK_LBL_CD)	/* N6TH_IMDG_SUBS_RSK_LBL_CD    */
    ,  (SELECT CL.IMDG_CLSS_CD FROM SCG_IMDG_CLSS_CD CL WHERE CL.IMDG_CLSS_CD = Y.N7TH_IMDG_SUBS_RSK_LBL_CD)	/* N7TH_IMDG_SUBS_RSK_LBL_CD    */
    ,  (SELECT CL.IMDG_CLSS_CD FROM SCG_IMDG_CLSS_CD CL WHERE CL.IMDG_CLSS_CD = Y.N8TH_IMDG_SUBS_RSK_LBL_CD)	/* N8TH_IMDG_SUBS_RSK_LBL_CD    */
                                                                        
    ,  Y.IMDG_COMP_GRP_CD          				/* IMDG_CO_GRP_CD               */

    ,  DECODE(LTRIM(RTRIM(Y.IMDG_PCK_GRP_CD_CTNT)),'I','1','II','2','III','3',LTRIM(RTRIM(Y.IMDG_PCK_GRP_CD_CTNT)))	/* IMDG_PCK_GRP_CD              */
   
    ,  Y.IMDG_LMT_QTY_FLG_CTNT    				/* IMDG_LMT_QTY_FLG             */   
    ,  Y.IMDG_EXPT_QTY_FLG_CTNT        			/* IMDG_EXPT_QTY_FLG            */   
    ,  Y.IMDG_MRN_POLUT_FLG        				/* MRN_POLUT_FLG                */   
    ,  Y.FLSH_PNT_TEMP_CTNT       				/* FLSH_PNT_CDO_TEMP            */   
    ,  Y.PRP_SHP_NM           					/* PRP_SHP_NM                   */   

    ----,  Y.HZD_DESC                        		/* HZD_DESC                     */   
    ,  Y.IMDG_TEC_NM                       		/*IMDG_TEC_NM                   */   

	-- ::2015-07-25:by TOP:: --
    --,  ''                      					/* DCGO_STS_CD                  */    

    ----,  ''                     					/* MEAS_QTY                     */   
    ,  ''               						/* MEAS_TP_CD                   */   
    ----,  ''                     					/* PCK_QTY                      */   
    ,  ''    									/* PCK_TP_CD                    */   
    ----,  ''                  						/* CLOD_FLG                     */   
    ,  ''                         				/* SPCL_STWG_RQST_DESC          */   
    ,  ''                         				/* CGO_LCL_FLG                  */   
    ,  ''             							/* EMER_RSPN_GID_NO             */   
    ,  ''              							/* EMER_RSPN_GID_CHR_NO         */   
    ,  Y.EMER_CNTC_PHN_NO            			/* EMER_CNTC_PHN_NO             */   
    ,  Y.EMER_CNTC_PSON_NM                      /* EMER_CNTC_PSON_NM            */   
    ,  ''                         				/* EMER_TEMP_CTNT               */   
    ,  Y.CTRL_TEMP_CTNT            				/* CTRL_TEMP_CTNT               */   
    ,  Y.EMS_NO              					/* EMS_NO                       */   
    ,  ''          								/* CMDT_DESC                    */   


    ,  Y.NET_WGT_CTNT                    		/* NET_WGT                      */   
    ,  Y.GRS_WGT_CTNT                        	/* GRS_WGT                      */   
    ,  Y.GRS_WGT_UT_CD_CTNT                		/* WGT_UT_CD                    */   
    ,  Y.PSA_NO               					/* PSA_NO                       */   
    ,  ''                          				/* CERTI_NO                     */   
    ,  NVL(Y.IN_N1ST_IMDG_PCK_QTY_CTNT,0)             	/* IN_N1ST_IMDG_PCK_QTY         */   
    ,  Y.IN_N1ST_IMDG_PCK_CD_CTNT               /* IN_N1ST_IMDG_PCK_CD          */   
    ,  0                  						/* IN_N2ND_IMDG_PCK_QTY         */   
    ,  ''                						/* IN_N2ND_IMDG_PCK_CD          */   
    ,  NVL(Y.INTMD_N1ST_IMDG_PCK_QTY_CTNT,0)           /* INTMD_N1ST_IMDG_PCK_QTY      */   
    ,  Y.INTMD_N1ST_IMDG_PCK_CD_CTNT            /* INTMD_N1ST_IMDG_PCK_CD       */   
    ,  0                          				/* INTMD_N2ND_IMDG_PCK_QTY      */   
    ,  ''                      					/* INTMD_N2ND_IMDG_PCK_CD       */   
    ,  NVL(Y.OUT_N1ST_IMDG_PCK_QTY_CTNT,0)             /* OUT_N1ST_IMDG_PCK_QTY        */   
    ,  Y.OUT_N1ST_IMDG_PCK_CD_CTNT              /* OUT_N1ST_IMDG_PCK_CD         */   
    ,  0                      					/* OUT_N2ND_IMDG_PCK_QTY        */   
    ,  ''                        				/* OUT_N2ND_IMDG_PCK_CD         */   
    ,  0                    					/* MAX_IN_PCK_QTY               */   
    ,  ''                     					/* MAX_IN_PCK_TP_CD             */   
    ,  ''                                       /*   CNEE_DTL_DESC              */   
    ,  Y.NET_EXPLO_WGT_CTNT                     /*   NET_EXPLO_WGT              */   
    ,  ''                      					/*   RADA_SKD_NO                */   
    ,  0                                       	/*   RADA_AMT                   */   
    ,  ''                                       /*   RADA_UT_CD                 */   
    ,  Y.DIFF_RMK                               /*   DIFF_RMK                   */   
    ,  SYSDATE                                  /*   CGO_RQST_DT                */   
    ,  ''                                       /*   AUTH_DT                    */   
    ,  ''                                       /*   AUTH_OFC_CD                */   
    ,  ''                                       /*   AUTH_USR_ID                */   
    
	,  @[auth_sts_cd]							/*   AUTH_STS_CD >> 'R':REQUEST */   

    -- ::2015-09-24:by TOP:: --,  [apro_ref_no]                           /*   APRO_REF_NO                */   
    ,  'EDI_AUTO_REQUEST'                       /*   CRE_USR_ID                 */   
    ,  SYSDATE                                  /*   CRE_DT                     */   
    ,  'EDI_AUTO_REQUEST'                       /*   UPD_USR_ID                 */   
    ,  SYSDATE                                  /*   UPD_DT                     */   
    ,  ''                                       /*   RADA_TRSP_NO               */   
    ,  Y.CFR_FLG                                /*   CFR_FLG                    */   

	-- ::2015-07-25:by TOP:: --
    ,  Y.CGO_UPD_STS_CD                         /*   CGO_UPD_STS_CD             */   
    ,  ''                                       /*   MVMT_SPCL_TP_CD            */   
    ,  Y.PRP_SHP_NM                             /*   ORG_PRP_SHP_NM             */   
    ,  Y.ESP_NO                                 /*   ESP_NO                     */   
    ,  Y.IMDG_PPR_NO                            /*   IMDG_PPR_NO                */   
    ,  Y.MFAG_NO                                /*   MFAG_NO                    */   
    ,  Y.IMDG_TEC_NM                            /*   IMDG_TEC_NM                */   
    ,  Y.OUT_N1ST_IMDG_PCK_DESC                 /*   OUT_N1ST_IMDG_PCK_DESC     */   
    ,  Y.INTMD_N1ST_IMDG_PCK_DESC               /*   INTMD_N1ST_IMDG_PCK_DESC   */   
    ,  Y.IN_N1ST_IMDG_PCK_DESC                  /*   IN_N1ST_IMDG_PCK_DESC      */   
    ,  Y.CFR_NO                                 /*   CFR_NO                     */   
    ,  Y.RSD_FLG_CTNT                           /*   RSD_FLG                    */   
    ,  Y.CNTR_DMY_REF_NO                        /*   CNTR_DMY_REF_NO            */   
    ,  ''                                       /*   REF_NO                     */   
    ,  ''                                       /*   SPCL_CGO_AUTH_RJCT_CD      */   
    ,  ''                                       /*   SPCL_CGO_AUTH_RMK          */ 

	--::2015-10-22::-- 
    --,  Y.IMDG_ADD_SEGR_GRP_NO                   /*   IMDG_SEGR_GRP_NO           */
   
    ,  Y.DCGO_REF_NO                            /*   DCGO_REF_NO                */   
    ,  ''                                       /*   SPCL_RQST_FLG              */   
    ,  ''                                       /*   EDW_UPD_DT                 */   
    ,  Y.IMDG_AMDT_NO                           /*   IMDG_AMDT_NO               */   
    
    ,	CASE	WHEN @[edi_trsm_sts_cd] = 'N' THEN	Y.DCGO_SEQ
				ELSE NULL
		END            							/*     DCGO_SEQ  				*/

	,	Y.PRP_SHP_NM           					/* PRP_SHP_NM                   */ 

	,	Y.EDI_CGO_UNMAP_DTL_CD

	--::2015-10-22::--
	,	Y.DCGO_DTL_STS_CD
	,	Y.IMDG_ADD_SEGR_GRP_NO
FROM    SCG_PRNR_SPCL_CGO_TRSM_HDR     			X
     ,  SCG_PRNR_SPCL_CGO_TRSM_DTL     			Y
WHERE   X.TRSM_BND_CD                  			= Y.TRSM_BND_CD
AND     X.TRSM_DT                      			= Y.TRSM_DT
AND     X.SPCL_CGO_CATE_CD             			= Y.SPCL_CGO_CATE_CD
AND     X.PRNR_SPCL_CGO_SEQ            			= Y.PRNR_SPCL_CGO_SEQ                                                           
AND		X.TRSM_BND_CD							= 'I'
AND     X.SPCL_CGO_CATE_CD             			= 'DG'
AND     X.TRSM_MZD_CD                  			= 'EDI'
AND		X.TRSM_DT								= TO_DATE(@[trsm_dt],'YYYYMMDD')
AND		X.PRNR_SPCL_CGO_SEQ						= @[prnr_spcl_cgo_seq]			]]></sql>
			<params>
				<param name="spcl_cgo_rqst_seq" type="12" value="" out="N"/>
				<param name="prnr_cgo_rqst_seq" type="12" value="" out="N"/>
				<param name="auth_sts_cd" type="12" value="" out="N"/>
				<param name="edi_trsm_sts_cd" type="12" value="" out="N"/>
				<param name="trsm_dt" type="12" value="" out="N"/>
				<param name="prnr_spcl_cgo_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
