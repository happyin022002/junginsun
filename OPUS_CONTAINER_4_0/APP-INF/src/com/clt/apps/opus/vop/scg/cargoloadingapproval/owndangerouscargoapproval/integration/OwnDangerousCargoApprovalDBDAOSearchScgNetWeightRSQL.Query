<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="OwnDangerousCargoApprovalDBDAOSearchScgNetWeightRSQL">
			<desc><![CDATA[MPA 1 Cargo 의 Net Weight 조회]]></desc>
			<sql><![CDATA[
SELECT SUM(NET_WGT) AS NET_WGT
FROM (
    SELECT SUM(DG.NET_WGT) AS NET_WGT
    FROM SCG_DG_CGO DG
         , SCG_VVD_APRO_RQST SV
         , SCG_AUTHORIZATION SA   
         , VSK_VSL_PORT_SKD V1
         , VSK_VSL_PORT_SKD V2
         , VSK_VSL_PORT_SKD VV
    WHERE SV.BKG_NO                 = DG.BKG_NO
    AND SV.SPCL_CGO_APRO_RQST_SEQ = DG.SPCL_CGO_APRO_RQST_SEQ
    AND SV.VSL_CD                 = V1.VSL_CD
    AND SV.SKD_VOY_NO             = V1.SKD_VOY_NO
    AND SV.SKD_DIR_CD             = V1.SKD_DIR_CD
    AND NVL(SV.POD_CD,' ')        = V1.VPS_PORT_CD
    AND SV.VSL_CD                 = V2.VSL_CD
    AND SV.SKD_VOY_NO             = V2.SKD_VOY_NO
    AND SV.SKD_DIR_CD             = V2.SKD_DIR_CD
    AND NVL(SV.POD_CD,' ')        = V2.VPS_PORT_CD
    AND SV.VSL_CD                 = VV.VSL_CD
    AND SV.SKD_VOY_NO             = VV.SKD_VOY_NO
    AND SV.SKD_DIR_CD             = VV.SKD_DIR_CD
    AND VV.VPS_PORT_CD           = 'SGSIN'
    AND VV.CLPT_SEQ BETWEEN V1.CLPT_SEQ AND V2.CLPT_SEQ
    AND ( DG.PSA_NO = '1' OR DG.FLSH_PNT_CDO_TEMP < -25 )
    
    AND SV.BKG_NO = SA.BKG_NO
    AND SV.SPCL_CGO_APRO_RQST_SEQ = SA.SPCL_CGO_APRO_RQST_SEQ
    AND SV.VSL_PRE_PST_CD = SA.VSL_PRE_PST_CD
    AND SV.VSL_SEQ = SA.VSL_SEQ
    AND SA.SPCL_CGO_AUTH_CD = 'Y'
    AND SV.VSL_CD = @[vsl_cd]
    AND SV.SKD_VOY_NO = @[skd_voy_no]
    AND SV.SKD_DIR_CD = @[skd_dir_cd]
    
    UNION ALL
    
    SELECT SUM(CGO.NET_WGT) AS NET_WGT    
    FROM SCG_PRNR_APRO_RQST RQS
        , SCG_PRNR_APRO_RQST_CGO CGO
        , VSK_VSL_PORT_SKD V1                                         
        , VSK_VSL_PORT_SKD V2                                         
        , VSK_VSL_PORT_SKD VV                                         
    WHERE RQS.VSL_CD           = V1.VSL_CD                           
    AND RQS.SKD_VOY_NO        = V1.SKD_VOY_NO                       
    AND RQS.SKD_DIR_CD        = V1.SKD_DIR_CD                       
    AND NVL(RQS.POD_CD,' ')   = V1.VPS_PORT_CD                      
    AND RQS.VSL_CD            = V2.VSL_CD                           
    AND RQS.SKD_VOY_NO        = V2.SKD_VOY_NO                       
    AND RQS.SKD_DIR_CD        = V2.SKD_DIR_CD                       
    AND NVL(RQS.POD_CD,' ')   = V2.VPS_PORT_CD                      
    AND RQS.VSL_CD            = VV.VSL_CD                           
    AND RQS.SKD_VOY_NO        = VV.SKD_VOY_NO                       
    AND RQS.SKD_DIR_CD        = VV.SKD_DIR_CD                       
    AND VV.VPS_PORT_CD       = 'SGSIN'                              
    AND VV.CLPT_SEQ BETWEEN V1.CLPT_SEQ AND V2.CLPT_SEQ               
    AND ( CGO.PSA_NO = 1 OR CGO.FLSH_PNT_CDO_TEMP < -25 )
       
    AND CGO.AUTH_STS_CD = 'Y'
    AND RQS.VSL_CD = @[vsl_cd]
    AND RQS.SKD_VOY_NO = @[skd_voy_no]
    AND RQS.SKD_DIR_CD = @[skd_dir_cd]
    )			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
