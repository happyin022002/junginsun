<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ReceiveEdiFromParnterLinesMgtDBDAOSearchChkSystemByManualRSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
SELECT 		DECODE(A.SRC_TP_CD, 'MNL', 'M', 'EDI', DECODE(A.MAPG_EDI_TRSM_STS_CD, 'R', '', 'E'), '') SRC_TP_CD
FROM 		SCG_PRNR_APRO_RQST 		A
		,	SCG_PRNR_APRO_RQST_CGO	B
WHERE 		1 = 1
AND			A.CRR_CD				= B.CRR_CD
AND			A.BKG_REF_NO			= B.BKG_REF_NO
AND     	A.SPCL_CGO_RQST_SEQ 	= B.SPCL_CGO_RQST_SEQ
AND     	A.PRNR_CGO_RQST_SEQ 	= B.PRNR_CGO_RQST_SEQ

AND			B.CGO_OPR_CD			= @[cgo_opr_cd]
AND			A.BKG_REF_NO            = @[bkg_ref_no]
AND 		A.DG_FLG                = 'Y'	AND A.AWK_FLG			= 'N'
AND 		(
				(A.SRC_TP_CD        = 'EDI'	AND A.LST_RQST_DAT_FLG	= 'Y')
         		 OR	 
				 A.SRC_TP_CD       	<> 'EDI'
			)

AND   		A.VSL_CD             	= @[vsl_cd]
AND   		A.SKD_VOY_NO         	= @[skd_voy_no]
AND   		A.SKD_DIR_CD         	= @[skd_dir_cd]
AND   		A.POL_CD             	= @[pol_cd]
AND   		A.POD_CD             	= NVL(@[pod_cd],A.POD_CD)	/* Empty in case of cancellation EDI */			]]></sql>
			<params>
				<param name="cgo_opr_cd" type="12" value="" out="N"/>
				<param name="bkg_ref_no" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
