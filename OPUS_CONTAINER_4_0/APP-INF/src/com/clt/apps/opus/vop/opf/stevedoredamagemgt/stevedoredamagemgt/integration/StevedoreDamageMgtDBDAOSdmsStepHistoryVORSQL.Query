<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="StevedoreDamageMgtDBDAOSdmsStepHistoryVORSQL">
			<desc><![CDATA[OpfStvDmgStepHis Table Select Query]]></desc>
			<sql><![CDATA[
SELECT H.STV_DMG_NO,
       M.VSL_CD,
       M.SKD_VOY_NO,
       M.SKD_DIR_CD,
       M.VPS_PORT_CD,
       (SELECT SLAN_CD
	    FROM   VSK_VSL_PORT_SKD
	    WHERE  VSL_CD      = M.VSL_CD
	    AND    SKD_VOY_NO  = M.SKD_VOY_NO
	    AND    SKD_DIR_CD  = M.SKD_DIR_CD
	    AND    VPS_PORT_CD  = M.VPS_PORT_CD)    AS SLAN_CD,
       TO_CHAR(M.STV_DMG_EVNT_DT, 'YYYY-MM-DD') AS STV_DMG_EVNT_DT,
       (SELECT INTG_CD_VAL_DESC
	    FROM   COM_INTG_CD_DTL
	    WHERE  INTG_CD_ID = 'CD02122'
	    AND    INTG_CD_VAL_CTNT = M.VSL_OSHP_CNTR_BLK_TP_CD) AS VSL_OSHP_CNTR_BLK_TP_CD,
       M.STV_DMG_REF_NO,
       M.CLM_HNDL_OFC_CD,
       DECODE(H.STV_DMG_PROC_CD,'D',(SELECT INTG_CD_VAL_DP_DESC
                                     FROM   COM_INTG_CD_DTL
                                     WHERE  INTG_CD_ID = 'CD01888'
                                     AND    INTG_CD_VAL_CTNT = H.STV_DMG_CRNT_PROC_STS_CD),NULL) AS STV_DMG_PROC_CD,
       H.STV_DMG_STEP_HIS_SEQ,
       DECODE(H.STV_DMG_PROC_CD,'R',(SELECT INTG_CD_VAL_DP_DESC
                                     FROM   COM_INTG_CD_DTL
                                     WHERE  INTG_CD_ID = 'CD01887'
                                     AND    INTG_CD_VAL_CTNT = H.STV_DMG_CRNT_PROC_STS_CD),NULL) AS RPR_STS_CD,
       DECODE(H.STV_DMG_PROC_CD,'C',(SELECT INTG_CD_VAL_DP_DESC
                                     FROM   COM_INTG_CD_DTL
                                     WHERE  INTG_CD_ID = 'CD01884'
                                     AND    INTG_CD_VAL_CTNT = H.STV_DMG_CRNT_PROC_STS_CD),NULL) AS CMPN_STS_CD,
       DECODE(H.STV_DMG_PROC_CD,'S',(SELECT INTG_CD_VAL_DP_DESC
                                     FROM   COM_INTG_CD_DTL
                                     WHERE  INTG_CD_ID = 'CD01889'
                                     AND    INTG_CD_VAL_CTNT = H.STV_DMG_CRNT_PROC_STS_CD),NULL) AS STL_STS_CD,
       (SELECT OFC_CD 
	    FROM   COM_USER
	    WHERE  USR_ID = H.UPD_USR_ID) AS CRE_USR_OFC_CD,
       (SELECT USR_NM 
	    FROM   COM_USER
	    WHERE  USR_ID = H.UPD_USR_ID) AS CRE_USR_NM,
       H.UPD_USR_ID AS CRE_USR_ID,
       TO_CHAR(H.UPD_DT,'YYYY-MM-DD') AS CRE_DT,
       TO_CHAR(H.UPD_DT,'HH24:MI')    AS CRE_TIME
FROM   OPF_STV_DMG_STEP_HIS H, OPF_STV_DMG M 
WHERE  M.STV_DMG_NO = @[stv_dmg_no]
AND    H.STV_DMG_NO(+) = M.STV_DMG_NO 
ORDER BY H.STV_DMG_STEP_HIS_SEQ, H.UPD_DT			]]></sql>
			<params>
				<param name="stv_dmg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
