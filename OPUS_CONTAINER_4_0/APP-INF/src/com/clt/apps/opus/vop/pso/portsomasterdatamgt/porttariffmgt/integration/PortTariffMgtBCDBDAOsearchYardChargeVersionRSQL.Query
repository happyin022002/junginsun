<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PortTariffMgtBCDBDAOsearchYardChargeVersionRSQL">
			<desc><![CDATA[searchYardChargeVersion]]></desc>
			<sql><![CDATA[
SELECT YD_CHG_VER_SEQ RN
     , YD_CHG_NO
     , YD_CHG_VER_SEQ
     , UPD_USR_ID
     , UPD_DT
     , UPD_MNU_NO
  FROM (SELECT YD_CHG_NO
             , YD_CHG_VER_SEQ
             , UPD_USR_ID
             , TO_CHAR(UPD_DT, 'YYYY-MM-DD HH24:MI:SS') AS UPD_DT
             , (SELECT MAX(CX.UPD_MNU_NO)
                  FROM PSO_YD_CHG_XPR YX
                     , PSO_CHG_XPR CX
                 WHERE 1=1
                   AND YX.YD_CHG_NO = Y.YD_CHG_NO
                   AND YX.YD_CHG_VER_SEQ = Y.YD_CHG_VER_SEQ
                   AND YX.CHG_XPR_NO = CX.CHG_XPR_NO) AS UPD_MNU_NO /*2016.11.22 S,C 구분 추가.*/
          FROM PSO_YD_CHG Y
         WHERE 1=1
           AND YD_CD        = @[yd_cd]
           AND VNDR_SEQ     = @[vndr_seq]
           AND LGS_COST_CD  = @[lgs_cost_cd]
           AND TO_CHAR(EFF_DT, 'YYYY-MM-DD') =  regexp_substr(@[eff_dt], '[^~]+', 1, 1)
           AND TO_CHAR(EXP_DT, 'YYYY-MM-DD') =  regexp_substr(@[eff_dt], '[^~]+', 1, 2)
         ORDER BY YD_CHG_VER_SEQ DESC 
         )			]]></sql>
			<params>
				<param name="yd_cd" type="12" value="" out="N"/>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="lgs_cost_cd" type="12" value="" out="N"/>
				<param name="eff_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
