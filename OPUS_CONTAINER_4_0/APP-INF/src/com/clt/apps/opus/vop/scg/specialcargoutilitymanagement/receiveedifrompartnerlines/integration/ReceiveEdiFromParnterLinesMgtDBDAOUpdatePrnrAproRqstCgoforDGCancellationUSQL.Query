<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ReceiveEdiFromParnterLinesMgtDBDAOUpdatePrnrAproRqstCgoforDGCancellationUSQL">
			<desc><![CDATA[DG EDI Cancellation]]></desc>
			<sql><![CDATA[
UPDATE 	SCG_PRNR_APRO_RQST_CGO 				X
SET		X.AUTH_STS_CD 						= 'C'					-- :CANCELLATION: --
     , 	X.UPD_USR_ID  						= @[upd_usr_id]
     , 	X.UPD_DT      						= SYSDATE
WHERE 	X.CRR_CD            				= @[crr_cd]
AND 	X.BKG_REF_NO        				= @[bkg_ref_no]
--AND 	X.AUTH_STS_CD       				<> 'C'					-- :2015-07-25 'C' << 'X': --
AND   	X.CGO_OPR_CD            			= @[cgo_opr_cd] 
AND   	EXISTS                  			(	SELECT   ''
                               		 			FROM     SCG_PRNR_APRO_RQST   XX
                               		 			WHERE    XX.DG_FLG            = 'Y'
                               		 			AND      XX.CRR_CD            = X.CRR_CD
                               		 			AND      XX.BKG_REF_NO        = X.BKG_REF_NO
                               		 			AND      XX.SPCL_CGO_RQST_SEQ = X.SPCL_CGO_RQST_SEQ
                               		 			AND      XX.PRNR_CGO_RQST_SEQ = X.PRNR_CGO_RQST_SEQ  
                               		 			AND      XX.VSL_CD            = @[vsl_cd]
                               		 			AND      XX.SKD_VOY_NO        = @[skd_voy_no]
                               		 			AND      XX.SKD_DIR_CD        = @[skd_dir_cd]
                               		 			AND      XX.POL_CD            = @[pol_cd]
                               		 			AND      XX.POD_CD            = NVL(@[pod_cd],XX.POD_CD)	/* Empty in case of cancellation EDI */
												AND      XX.LST_RQST_DAT_FLG  = 'Y'
                               				)			]]></sql>
			<params>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="crr_cd" type="12" value="" out="N"/>
				<param name="bkg_ref_no" type="12" value="" out="N"/>
				<param name="cgo_opr_cd" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="pol_cd" type="12" value="" out="N"/>
				<param name="pod_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
