<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="VesselScheduleMgtDBDAOSearchBunkerQtyBySpeedRSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
SELECT  (
            SELECT  ACT_PRC AS BNK_PRICE_BY_TON
            FROM    VSK_BNK_PRC T1,
                    (
                        SELECT  MAX(TO_CHAR(ACT_BRTH_DT, 'YYYYMMDD') || VPS_PORT_CD ) CURR_PORT
                        FROM    VSK_DEP_RPT
                        WHERE   VSL_CD          = @[vsl_cd]
                        AND     SPL_FOIL_WGT    > 0
                    )
            WHERE   1 = 1
            AND     PORT_CD             = SUBSTR(CURR_PORT, 9)
            AND     FOIL_DOIL_DIV_CD    = 'F'
            AND     EVNT_DT             = TO_DATE(SUBSTR(CURR_PORT, 1, 8), 'YYYYMMDD')
        ) AS BNK_UNIT_AMT
        , (
			SELECT  ROUND((FOC_HR / POWER(SPD_P, 3)) * POWER((@[spd] / (1 - (SLIP / 100))), 3) * 24, 1)
			FROM    (
						SELECT  T1.*,
								ROUND(((SPD_P - SPD_O)/SPD_P) * 100, 1)   AS SLIP,
								ROUND(BUNK_CONS / (DIST_O / SPD_O), 2)  AS FOC_HR
						FROM    (
									SELECT  /*+INDEX_DESC(T XPKVSK_NOON_RPT) */
											NXT_PORT_CD     AS NXT_PORT_CD,
											NXT_PORT_ETA_DT AS NXT_PORT_ETA_DT,
											NVGT_DIST       AS DIST_O,
											ENG_ML_DIST     AS DIST_P,
											CRNT_ACT_SPD    AS SPD_O,
											ROUND(ENG_ML_DIST / (NVGT_DIST / CRNT_ACT_SPD),1) AS SPD_P,
											ROUND(FOIL_CSM_WGT)    AS BUNK_CONS
									FROM    VSK_NOON_RPT T
									WHERE   VSL_CD      = @[vsl_cd]
									AND     ROWNUM      = 1
								) T1
					)
        ) AS BNK_UNIT_QTY
FROM    DUAL			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="spd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
