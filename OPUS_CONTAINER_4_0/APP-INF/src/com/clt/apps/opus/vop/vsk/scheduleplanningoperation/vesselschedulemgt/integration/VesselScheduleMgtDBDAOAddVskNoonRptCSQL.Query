<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="VesselScheduleMgtDBDAOAddVskNoonRptCSQL">
			<desc><![CDATA[VMS 시스템에서 입력 받은 Noon Report를 생성한다.]]></desc>
			<sql><![CDATA[
MERGE INTO VSK_NOON_RPT A
USING DUAL ON (A.VSL_CD          = @[vsl_cd]	
               AND A.SKD_VOY_NO  = @[skd_voy_no]
               AND A.SKD_DIR_CD  = @[skd_dir_cd]	
               AND A.NOON_RPT_DT = TO_DATE(@[noon_rpt_dt], 'YYYYMMDDHH24MISS'))
WHEN MATCHED THEN 

      UPDATE SET 
             NXT_PORT_CD      	=             @[nxt_port_cd]													                                			
            ,NXT_PORT_ETA_DT  	=             TO_DATE(@[nxt_port_eta_dt], 'YYYYMMDDHH24MISS')											    			
            ,ACT_GDT          	=             TO_DATE(@[act_gdt], 'YYYYMMDDHH24MISS')																	
            ,PORT_LAT         	=             NVL(@[port_lat]         ,0)
            ,PORT_LON         	=             NVL(@[port_lon]         ,0)
            ,SAIL_HRMNT       	=             @[sail_hrmnt]													                                			
            ,NVGT_DIST        	=             NVL(@[nvgt_dist]        ,0)
            ,ENG_ML_DIST      	=             NVL(@[eng_ml_dist]      ,0)
            ,WND_DIR_CTNT     	=             @[wnd_dir_ctnt]												                                			
            ,WND_SCL_NO       	=             NVL(@[wnd_scl_no]       ,0)
            ,OCN_CRNT_CTNT    	=             @[ocn_crnt_ctnt]
            ,SEA_STE_NO       	=             NVL(@[sea_ste_no]       ,0)
            ,VIS_RNG_NO       	=             NVL(@[vis_rng_no]       ,0)
            ,CRNT_ACT_SPD     	=             NVL(@[crnt_act_spd]     ,0)
            ,CRNT_ACT_RPM_PWR 	=             NVL(@[crnt_act_rpm_pwr] ,0)
            ,SLP_RT           	=             NVL(@[slp_rt]           ,0)
            ,RMN_DIST         	=             NVL(@[rmn_dist]         ,0)
            ,RMN_AVG_SPD      	=             NVL(@[rmn_avg_spd]      ,0)
            ,FOIL_CSM_WGT     	=             NVL(@[foil_csm_wgt]     ,0)
            ,DOIL_CSM_WGT     	=             NVL(@[doil_csm_wgt]     ,0)
            ,CRS_NO           	=             NVL(@[crs_no]           ,0)
            ,LOD_IND_QTY      	=             NVL(@[lod_ind_qty]      ,0)
            ,UPD_USR_ID       	=             @[cre_usr_id]
            ,UPD_DT           	=             SYSDATE   
      WHERE  1=1
      AND    A.VSL_CD      = @[vsl_cd]	
      AND    A.SKD_VOY_NO  = @[skd_voy_no]
      AND    A.SKD_DIR_CD  = @[skd_dir_cd]	
      AND    A.NOON_RPT_DT = TO_DATE(@[noon_rpt_dt], 'YYYYMMDDHH24MISS')   
  
WHEN NOT MATCHED THEN 

      INSERT (
             VSL_CD           	--VARCHAR2(4) not null,          				
            ,SKD_VOY_NO       	--VARCHAR2(4) not null,          				
            ,SKD_DIR_CD       	--VARCHAR2(1) not null,          				
            ,NOON_RPT_DT      	--DATE not null,                 				
            ,NXT_PORT_CD      	--VARCHAR2(5),                   				
            ,NXT_PORT_ETA_DT  	--DATE,                          				
            ,ACT_GDT          	--DATE default SYSDATE,          				
            ,PORT_LAT         	--NUMBER(8,5),                   				
            ,PORT_LON         	--NUMBER(8,5),                   				
            ,SAIL_HRMNT       	--VARCHAR2(4),                   				
            ,NVGT_DIST        	--NUMBER(6) default 0,           				
            ,ENG_ML_DIST      	--NUMBER(6) default 0,           				
            ,WND_DIR_CTNT     	--VARCHAR2(50),                  				
            ,WND_SCL_NO       	--NUMBER(4) default 0,           				
            ,OCN_CRNT_CTNT    	--VARCHAR2(50),                  				
            ,SEA_STE_NO       	--NUMBER(4) default 0,           				
            ,VIS_RNG_NO       	--NUMBER(4) default 0,           				
            ,CRNT_ACT_SPD     	--NUMBER(5,3) default 0,         				
            ,CRNT_ACT_RPM_PWR 	--NUMBER(6) default 0,           				
            ,SLP_RT           	--NUMBER(5,2) default 0,         				
            ,RMN_DIST         	--NUMBER(6) default 0,           				
            ,RMN_AVG_SPD      	--NUMBER(5,3) default 0,         				
            ,FOIL_CSM_WGT     	--NUMBER(13,3) default 0,        				
            ,DOIL_CSM_WGT     	--NUMBER(13,3) default 0,        				
            ,CRS_NO           	--NUMBER(4) default 0,           				
            ,LOD_IND_QTY      	--NUMBER(8,2) default 0,         				
            ,CRE_USR_ID       	--VARCHAR2(20) not null,         				
            ,CRE_DT           	--DATE default SYSDATE not null, 				
            ,UPD_USR_ID       	--VARCHAR2(20) not null,         				
            ,UPD_DT           	--DATE default SYSDATE not null  				
            ) VALUES( 
             @[vsl_cd]														
            ,@[skd_voy_no]													
            ,@[skd_dir_cd]													
            ,TO_DATE(@[noon_rpt_dt], 'YYYYMMDDHH24MISS')	
            ,@[nxt_port_cd]													
            ,TO_DATE(@[nxt_port_eta_dt], 'YYYYMMDDHH24MISS')											
            ,TO_DATE(@[act_gdt], 'YYYYMMDDHH24MISS')														
            ,NVL(@[port_lat]        ,0)
            ,NVL(@[port_lon]        ,0)
            ,@[sail_hrmnt]													
            ,NVL(@[nvgt_dist]       ,0)
            ,NVL(@[eng_ml_dist]     ,0)
            ,@[wnd_dir_ctnt]												
            ,NVL(@[wnd_scl_no]      ,0)
            ,@[ocn_crnt_ctnt]												
            ,NVL(@[sea_ste_no]      ,0)
            ,NVL(@[vis_rng_no]      ,0)
            ,NVL(@[crnt_act_spd]    ,0)
            ,NVL(@[crnt_act_rpm_pwr],0)
            ,NVL(@[slp_rt]          ,0)
            ,NVL(@[rmn_dist]        ,0)
            ,NVL(@[rmn_avg_spd]     ,0)
            ,NVL(@[foil_csm_wgt]    ,0)
            ,NVL(@[doil_csm_wgt]    ,0)
            ,NVL(@[crs_no]          ,0)
            ,NVL(@[lod_ind_qty]     ,0)
            ,@[cre_usr_id]													
            ,SYSDATE														
            ,@[cre_usr_id]													
            ,SYSDATE
      )			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="noon_rpt_dt" type="12" value="" out="N"/>
				<param name="nxt_port_cd" type="12" value="" out="N"/>
				<param name="nxt_port_eta_dt" type="12" value="" out="N"/>
				<param name="act_gdt" type="12" value="" out="N"/>
				<param name="port_lat" type="12" value="" out="N"/>
				<param name="port_lon" type="12" value="" out="N"/>
				<param name="sail_hrmnt" type="12" value="" out="N"/>
				<param name="nvgt_dist" type="12" value="" out="N"/>
				<param name="eng_ml_dist" type="12" value="" out="N"/>
				<param name="wnd_dir_ctnt" type="12" value="" out="N"/>
				<param name="wnd_scl_no" type="12" value="" out="N"/>
				<param name="ocn_crnt_ctnt" type="12" value="" out="N"/>
				<param name="sea_ste_no" type="12" value="" out="N"/>
				<param name="vis_rng_no" type="12" value="" out="N"/>
				<param name="crnt_act_spd" type="12" value="" out="N"/>
				<param name="crnt_act_rpm_pwr" type="12" value="" out="N"/>
				<param name="slp_rt" type="12" value="" out="N"/>
				<param name="rmn_dist" type="12" value="" out="N"/>
				<param name="rmn_avg_spd" type="12" value="" out="N"/>
				<param name="foil_csm_wgt" type="12" value="" out="N"/>
				<param name="doil_csm_wgt" type="12" value="" out="N"/>
				<param name="crs_no" type="12" value="" out="N"/>
				<param name="lod_ind_qty" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
