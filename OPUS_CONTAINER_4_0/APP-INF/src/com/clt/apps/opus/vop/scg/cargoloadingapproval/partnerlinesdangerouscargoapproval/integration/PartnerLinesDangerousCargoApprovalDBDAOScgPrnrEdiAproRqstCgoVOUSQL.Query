<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PartnerLinesDangerousCargoApprovalDBDAOScgPrnrEdiAproRqstCgoVOUSQL">
			<desc><![CDATA[SPCL CGO APVL for Partner Lines 의 Request Cago 수정]]></desc>
			<sql><![CDATA[
UPDATE 	SCG_PRNR_APRO_RQST_CGO 		X
SET		X.AUTH_STS_CD 				= DECODE(X.AUTH_STS_CD,NULL,NULL,'C')	-- :2015-07-25 'C'-canceled << 'X': --
     , 	X.UPD_USR_ID  				= @[upd_usr_id]
     , 	X.UPD_DT      				= SYSDATE
WHERE 	X.CRR_CD            		= COM_ConstantMgr_PKG.COM_getCompanyCode_FNC()

AND 	X.BKG_REF_NO        		= @[bkg_ref_no]
--AND 	X.SPCL_CGO_RQST_SEQ 		= [spcl_cgo_rqst_seq]

AND 	X.DCGO_REF_NO       		= @[dcgo_ref_no]
AND 	NVL(X.AUTH_STS_CD,'*') 		NOT IN ('Y','N')						-- ::2015-07-25 'C' << 'X': 'Y'-approved,'N'-rejected:: --

AND   	X.CGO_OPR_CD            	= @[cgo_opr_cd] 

AND   	EXISTS                  	(SELECT   ''
                               		 FROM     SCG_PRNR_APRO_RQST   XX
                               		 WHERE    XX.DG_FLG            = 'Y'
                               		 AND      XX.CRR_CD            = X.CRR_CD
                               		 AND      XX.BKG_REF_NO        = X.BKG_REF_NO
                               		 AND      XX.SPCL_CGO_RQST_SEQ = X.SPCL_CGO_RQST_SEQ
                               		 AND      XX.PRNR_CGO_RQST_SEQ = X.PRNR_CGO_RQST_SEQ  
                               		 AND      XX.VSL_CD            = @[vsl_cd]
                               		 AND      XX.SKD_VOY_NO        = @[skd_voy_no]
                               		 AND      XX.SKD_DIR_CD        = @[skd_dir_cd]
                               		 ----AND      XX.POL_CD        = NVL([pol_cd],XX.POL_CD)
                               		 ----AND      XX.POD_CD        = NVL([pod_cd],XX.POD_CD)
									 AND	  XX.LST_RQST_DAT_FLG  = 'Y'
									 AND	  XX.SRC_TP_CD		   = 'EDI'	-- ::'EDI','MNL':: --
                               		)			]]></sql>
			<params>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="bkg_ref_no" type="12" value="" out="N"/>
				<param name="dcgo_ref_no" type="12" value="" out="N"/>
				<param name="cgo_opr_cd" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
