<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PortTariffMgtBCDBDAOSearchAccountAndCostByConditionRSQL">
			<desc><![CDATA[Account Code Search.]]></desc>
			<sql><![CDATA[
SELECT A.ACCT_CD ACCT_CD
     , B.ACCT_ENG_NM ACCT_NM
     , A.LGS_COST_CD COST_CD
     , A.LGS_COST_FULL_NM COST_NM
  FROM TES_LGS_COST A
     , MDM_ACCOUNT B
     , PSO_YD_CHG C
     , PSO_YD_CHG_XPR C2
     , PSO_CHG_XPR C3
 WHERE 1=1
   AND A.ACCT_CD = B.ACCT_CD
   AND A.LGS_COST_SUBJ_CD IN ('PT', 'CN')
   AND A.LGS_COST_CD_CLSS_LVL = 'A'
   AND C.LGS_COST_CD = A.LGS_COST_CD 
   #if( ${port_cd}!='')
   AND SUBSTR (C.YD_CD, 1, 5) = @[port_cd] 
   #end 
   #if( ${yd_cd}!='')
   AND SUBSTR (C.YD_CD, 6) IN (
         #foreach( $key IN ${arr_yd_cd}) 
               #if($velocityCount < $arr_yd_cd.size()) '$key' , #else '$key' #end 
         #end
         ) 
   #end 
   #if( ${year} != '' )
   AND C.EFF_DT <= TO_DATE(@[year]||'1231', 'YYYYMMDD')
   AND C.EXP_DT >= TO_DATE(@[year]||'0101', 'YYYYMMDD') 
   #end
   AND C.YD_CHG_NO = C2.YD_CHG_NO
   AND C.YD_CHG_VER_SEQ = C2.YD_CHG_VER_SEQ
   AND C2.CHG_XPR_NO = C3.CHG_XPR_NO
   AND C2.PSO_CHG_TP_CD = 'B'
   #if( ${upd_mnu_no} != '' )
   AND C3.UPD_MNU_NO = TO_NUMBER(@[upd_mnu_no]) -- 1 : 단순, 2 : 복합
   #end
 GROUP BY A.ACCT_CD
     , A.LGS_COST_CD
     , ACCT_ENG_NM
     , A.LGS_COST_CD
     , A.LGS_COST_FULL_NM
 ORDER BY A.ACCT_CD
     , A.LGS_COST_CD			]]></sql>
			<params>
				<param name="port_cd" type="12" value="" out="N"/>
				<param name="year" type="12" value="" out="N"/>
				<param name="upd_mnu_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
