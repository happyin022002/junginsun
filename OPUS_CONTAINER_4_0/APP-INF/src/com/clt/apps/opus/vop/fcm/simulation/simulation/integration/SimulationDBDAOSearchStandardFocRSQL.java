/*=========================================================
*Copyright(c) 2014 CyberLogitec
*@FileName : SimulationDBDAOSearchStandardFocRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2014.10.27
*@LastModifier : 
*@LastVersion : 1.0
* 2014.10.27 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.vop.fcm.simulation.simulation.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class SimulationDBDAOSearchStandardFocRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * Standard FOC 화면 조회
	  * 2014.04.16 [CHM-201429874] Standard FOC 생성 및 단계별 저장 기능 개발
	  * 2014.05.28 [CHM-201430380] Standard FOC 칼럼 추가 및 조회 로직 수정
	  * 2014.06.26 [CHM-201430859] Standard FOC내 previous 칼럼 로직 수정
	  * 2014.08.22 [CHM-201431484] Previous 칼럼 말풍선 도움말 및 T actal 칼럼 로직 변경
	  * 2014.10.31 [CHM-201432489] Standard FOC Calling Sequence 조인 로직 변경건
	  * </pre>
	  */
	public SimulationDBDAOSearchStandardFocRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("skd_dir_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd_seq",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("skd_voy_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vsl_cd",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.vop.fcm.simulation.simulation.integration").append("\n"); 
		query.append("FileName : SimulationDBDAOSearchStandardFocRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("WITH FCM_DEP_RPT_TMP AS (" ).append("\n"); 
		query.append("    SELECT" ).append("\n"); 
		query.append("        VSL_CD" ).append("\n"); 
		query.append("        , SKD_VOY_NO" ).append("\n"); 
		query.append("        , SKD_DIR_CD" ).append("\n"); 
		query.append("        , DEP_PORT_CD" ).append("\n"); 
		query.append("        , RANK() OVER (PARTITION BY VSL_CD, SKD_VOY_NO, SKD_DIR_CD, DEP_PORT_CD ORDER BY CLPT_IND_SEQ) AS CLPT_IND_SEQ" ).append("\n"); 
		query.append("		, NXT_PORT_CD" ).append("\n"); 
		query.append("        , AFT_UNBRTH_ANK_DRP_DT" ).append("\n"); 
		query.append("        , AFT_UNBRTH_ANK_OFF_DT" ).append("\n"); 
		query.append("        , BFR_BRTH_ANK_DRP_DT" ).append("\n"); 
		query.append("        , BFR_BRTH_ANK_OFF_DT" ).append("\n"); 
		query.append("        , VPS_ETD_DT" ).append("\n"); 
		query.append("        , NXT_PORT_ETA_DT" ).append("\n"); 
		query.append("        , RUP_DT" ).append("\n"); 
		query.append("        , SB_ENG_DT" ).append("\n"); 
		query.append("        , VPS_ETB_DT" ).append("\n"); 
		query.append("        , AVG_SPD" ).append("\n"); 
		query.append("        , PORT_MN_FOIL_CSM_QTY" ).append("\n"); 
		query.append("        , PORT_GNR_FOIL_CSM_QTY" ).append("\n"); 
		query.append("        , PORT_BLR_FOIL_CSM_QTY" ).append("\n"); 
		query.append("        , PORT_MN_LOW_SULP_FOIL_CSM_QTY" ).append("\n"); 
		query.append("        , PORT_GNR_LOW_SULP_FOIL_CSM_QTY" ).append("\n"); 
		query.append("        , PORT_BLR_LOW_SULP_FOIL_CSM_QTY" ).append("\n"); 
		query.append("        , PORT_MN_DOIL_CSM_QTY" ).append("\n"); 
		query.append("        , PORT_GNR_DOIL_CSM_QTY" ).append("\n"); 
		query.append("        , PORT_BLR_DOIL_CSM_QTY" ).append("\n"); 
		query.append("        , PORT_MN_LOW_SULP_DOIL_CSM_QTY" ).append("\n"); 
		query.append("        , PORT_GNR_LOW_SULP_DOIL_CSM_QTY" ).append("\n"); 
		query.append("        , PORT_BLR_LOW_SULP_DOIL_CSM_QTY" ).append("\n"); 
		query.append("        , SEA_MN_FOIL_CSM_QTY" ).append("\n"); 
		query.append("        , SEA_GNR_FOIL_CSM_QTY" ).append("\n"); 
		query.append("        , SEA_BLR_FOIL_CSM_QTY" ).append("\n"); 
		query.append("        , SEA_MN_LOW_SULP_FOIL_CSM_QTY" ).append("\n"); 
		query.append("        , SEA_GNR_LOW_SULP_FOIL_CSM_QTY" ).append("\n"); 
		query.append("        , SEA_BLR_LOW_SULP_FOIL_CSM_QTY" ).append("\n"); 
		query.append("        , SEA_MN_DOIL_CSM_QTY" ).append("\n"); 
		query.append("        , SEA_GNR_DOIL_CSM_QTY" ).append("\n"); 
		query.append("        , SEA_BLR_DOIL_CSM_QTY" ).append("\n"); 
		query.append("        , SEA_MN_LOW_SULP_DOIL_CSM_QTY" ).append("\n"); 
		query.append("        , SEA_GNR_LOW_SULP_DOIL_CSM_QTY" ).append("\n"); 
		query.append("        , SEA_BLR_LOW_SULP_DOIL_CSM_QTY" ).append("\n"); 
		query.append("        , NVGT_ML_DIST" ).append("\n"); 
		query.append("        , MNVR_IN_ML_DIST" ).append("\n"); 
		query.append("        , MNVR_OUT_ML_DIST" ).append("\n"); 
		query.append("        , ENG_ML_DIST" ).append("\n"); 
		query.append("    FROM FCM_DEP_RPT" ).append("\n"); 
		query.append("    WHERE VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT T61.VVD_SEQ" ).append("\n"); 
		query.append("        ,T61.CLPT_IND_SEQ" ).append("\n"); 
		query.append("        ,T61.CLPT_SEQ" ).append("\n"); 
		query.append("        ,T61.VSL_SLAN_CD" ).append("\n"); 
		query.append("        ,T61.VSL_CD" ).append("\n"); 
		query.append("        ,T61.SKD_VOY_NO" ).append("\n"); 
		query.append("        ,T61.SKD_DIR_CD" ).append("\n"); 
		query.append("        ,T61.VVD" ).append("\n"); 
		query.append("        ,T61.VPS_PORT_CD" ).append("\n"); 
		query.append("        ,T61.TML_CD" ).append("\n"); 
		query.append("        ,T61.YD_CD" ).append("\n"); 
		query.append("        ,T61.PORT_SKD_STS_CD" ).append("\n"); 
		query.append("        ,T61.SKD_CNG_STS_CD" ).append("\n"); 
		query.append("        ,T61.VPS_ETA_DT" ).append("\n"); 
		query.append("        ,T61.VPS_ETB_DT" ).append("\n"); 
		query.append("        ,T61.VPS_ETD_DT" ).append("\n"); 
		query.append("        ,T62.INIT_FOIL_CSM" ).append("\n"); 
		query.append("        ,T62.RVIS_FOIL_CSM" ).append("\n"); 
		query.append("        ,T62.TRND_LINE_FOIL_CSM" ).append("\n"); 
		query.append("        ,T62.ACT_FOIL_CSM" ).append("\n"); 
		query.append("        ,T62.INIT_PORT_FOIL_CSM" ).append("\n"); 
		query.append("        ,T62.RVIS_PORT_FOIL_CSM" ).append("\n"); 
		query.append("        ,T62.TRND_LINE_PORT_FOIL_CSM" ).append("\n"); 
		query.append("        ,T62.ACT_PORT_FOIL_CSM" ).append("\n"); 
		query.append("        ,DECODE(COUNT(T62.VSL_CD) OVER (PARTITION BY T62.VSL_CD), 0, COALESCE(DIST_OPMZ, DIST_OPMZ_TO_ALL, DIST_OPMZ_FM_ALL, DIST_OPMZ_ALL), T62.OPMZ_DIST) AS OPMZ_DIST" ).append("\n"); 
		query.append("        ,T62.OPMZ_SEA_SPD" ).append("\n"); 
		query.append("        ,T61.PF_SEA_TM_HRS" ).append("\n"); 
		query.append("        ,T61.OPMZ_SEA_TM_HRS" ).append("\n"); 
		query.append("        ,T61.ACT_OPMZ_SEA_TM_HRS" ).append("\n"); 
		query.append("        ,T61.LNK_DIST AS DIST_PF_LNK" ).append("\n"); 
		query.append("        ,COALESCE(DIST_OPMZ, DIST_OPMZ_TO_ALL, DIST_OPMZ_FM_ALL, DIST_OPMZ_ALL) AS DIST_OPMZ" ).append("\n"); 
		query.append("        ,T61.SPD_PF_LNK" ).append("\n"); 
		query.append("        ,(SELECT (   NVL(SEA_MN_FOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                   + NVL(SEA_GNR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                   + NVL(SEA_BLR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                   + NVL(SEA_MN_LOW_SULP_FOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                   + NVL(SEA_GNR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                   + NVL(SEA_BLR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                   + NVL(SEA_MN_DOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                   + NVL(SEA_GNR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                   + NVL(SEA_BLR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                   + NVL(SEA_MN_LOW_SULP_DOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                   + NVL(SEA_GNR_LOW_SULP_DOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                   + NVL(SEA_BLR_LOW_SULP_DOIL_CSM_QTY, 0))" ).append("\n"); 
		query.append("            FROM FCM_DEP_RPT_TMP D" ).append("\n"); 
		query.append("           WHERE D.VSL_CD       = SUBSTR(T61.NXT_VVD, 1, 4)" ).append("\n"); 
		query.append("             AND D.SKD_VOY_NO   = SUBSTR(T61.NXT_VVD, 5, 4)" ).append("\n"); 
		query.append("             AND D.SKD_DIR_CD   = SUBSTR(T61.NXT_VVD, 9, 4)" ).append("\n"); 
		query.append("             AND D.DEP_PORT_CD  = T61.NXT_PORT_CD" ).append("\n"); 
		query.append("             AND D.CLPT_IND_SEQ = T61.NXT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("             AND D.NXT_PORT_CD  = T61.NXT_NXT_PORT_CD  ) AS ACT_FOIL_CSM_CAL" ).append("\n"); 
		query.append("        ,(SELECT (   NVL(PORT_MN_FOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                   + NVL(PORT_GNR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                   + NVL(PORT_BLR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                   + NVL(PORT_MN_LOW_SULP_FOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                   + NVL(PORT_GNR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                   + NVL(PORT_BLR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                   + NVL(PORT_MN_DOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                   + NVL(PORT_GNR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                   + NVL(PORT_BLR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                   + NVL(PORT_MN_LOW_SULP_DOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                   + NVL(PORT_GNR_LOW_SULP_DOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                   + NVL(PORT_BLR_LOW_SULP_DOIL_CSM_QTY, 0))" ).append("\n"); 
		query.append("            FROM FCM_DEP_RPT_TMP D" ).append("\n"); 
		query.append("           WHERE D.VSL_CD       = SUBSTR(T61.NXT_VVD, 1, 4)" ).append("\n"); 
		query.append("             AND D.SKD_VOY_NO   = SUBSTR(T61.NXT_VVD, 5, 4)" ).append("\n"); 
		query.append("             AND D.SKD_DIR_CD   = SUBSTR(T61.NXT_VVD, 9, 4)" ).append("\n"); 
		query.append("             AND D.DEP_PORT_CD  = T61.NXT_PORT_CD" ).append("\n"); 
		query.append("             AND D.CLPT_IND_SEQ = T61.NXT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("             AND D.NXT_PORT_CD  = T61.NXT_NXT_PORT_CD  ) AS ACT_PORT_FOIL_CSM_CAL" ).append("\n"); 
		query.append("        ,NVL((SELECT AVG(   NVL(SEA_MN_FOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                          + NVL(SEA_GNR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                          + NVL(SEA_BLR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                          + NVL(SEA_MN_LOW_SULP_FOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                          + NVL(SEA_GNR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                          + NVL(SEA_BLR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                          + NVL(SEA_MN_DOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                          + NVL(SEA_GNR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                          + NVL(SEA_BLR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                          + NVL(SEA_MN_LOW_SULP_DOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                          + NVL(SEA_GNR_LOW_SULP_DOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                          + NVL(SEA_BLR_LOW_SULP_DOIL_CSM_QTY, 0))" ).append("\n"); 
		query.append("                FROM FCM_DEP_RPT_TMP D" ).append("\n"); 
		query.append("               WHERE D.VSL_CD       = SUBSTR(T61.NXT_VVD, 1, 4)" ).append("\n"); 
		query.append("                 AND D.SKD_VOY_NO  IN (TO_CHAR(SUBSTR(T61.NXT_VVD, 5, 4) - 1, 'FM0000'), TO_CHAR(SUBSTR(T61.NXT_VVD, 5, 4) - 2, 'FM0000'), TO_CHAR(SUBSTR(T61.NXT_VVD, 5, 4) - 3, 'FM0000'))" ).append("\n"); 
		query.append("                 AND D.SKD_DIR_CD   = SUBSTR(T61.NXT_VVD, 9, 4)" ).append("\n"); 
		query.append("                 AND D.DEP_PORT_CD  = T61.NXT_PORT_CD" ).append("\n"); 
		query.append("                 AND D.CLPT_IND_SEQ = T61.NXT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                 AND D.NXT_PORT_CD  = T61.NXT_NXT_PORT_CD  ), 0) AS ACT_FOIL_CSM_AVG" ).append("\n"); 
		query.append("        ,NVL((SELECT AVG(   NVL(PORT_MN_FOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                          + NVL(PORT_GNR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                          + NVL(PORT_BLR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                          + NVL(PORT_MN_LOW_SULP_FOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                          + NVL(PORT_GNR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                          + NVL(PORT_BLR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                          + NVL(PORT_MN_DOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                          + NVL(PORT_GNR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                          + NVL(PORT_BLR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                          + NVL(PORT_MN_LOW_SULP_DOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                          + NVL(PORT_GNR_LOW_SULP_DOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                          + NVL(PORT_BLR_LOW_SULP_DOIL_CSM_QTY, 0))" ).append("\n"); 
		query.append("                FROM FCM_DEP_RPT_TMP D" ).append("\n"); 
		query.append("               WHERE D.VSL_CD       = SUBSTR(T61.NXT_VVD, 1, 4)" ).append("\n"); 
		query.append("                 AND D.SKD_VOY_NO  IN (TO_CHAR(SUBSTR(T61.NXT_VVD, 5, 4) - 1, 'FM0000'), TO_CHAR(SUBSTR(T61.NXT_VVD, 5, 4) - 2, 'FM0000'), TO_CHAR(SUBSTR(T61.NXT_VVD, 5, 4) - 3, 'FM0000'))" ).append("\n"); 
		query.append("                 AND D.SKD_DIR_CD   = SUBSTR(T61.NXT_VVD, 9, 4)" ).append("\n"); 
		query.append("                 AND D.DEP_PORT_CD  = T61.NXT_PORT_CD" ).append("\n"); 
		query.append("                 AND D.CLPT_IND_SEQ = T61.NXT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                 AND D.NXT_PORT_CD  = T61.NXT_NXT_PORT_CD  ), 0) AS ACT_PORT_FOIL_CSM_AVG" ).append("\n"); 
		query.append("        ,T62.INIT_FOIL_CSM      AS S_INIT_FOIL_CSM" ).append("\n"); 
		query.append("        ,T62.INIT_PORT_FOIL_CSM AS S_INIT_PORT_FOIL_CSM" ).append("\n"); 
		query.append("        ,T62.OPMZ_DIST          AS S_OPMZ_DIST" ).append("\n"); 
		query.append("        ,T62.OPMZ_SEA_SPD       AS S_OPMZ_SEA_SPD" ).append("\n"); 
		query.append("        ,T62.PF_SEA_TM_HRS      AS S_PF_SEA_TM_HRS" ).append("\n"); 
		query.append("        ,T62.OPMZ_SEA_TM_HRS    AS S_OPMZ_SEA_TM_HRS" ).append("\n"); 
		query.append("        ,T63.AVG_SPD            AS DEP_AVG_SPD" ).append("\n"); 
		query.append("        ,DECODE(COUNT(T62.VSL_CD) OVER (PARTITION BY T62.VSL_CD), 0, 'N', 'Y') AS SAVE_FLG" ).append("\n"); 
		query.append("        ,T61.PORT_TIME" ).append("\n"); 
		query.append("        ,T61.ACT_PORT_TIME" ).append("\n"); 
		query.append("        ,(SELECT NVL(MNVR_CSM_WGT, 0) AS MNVR_CSM_WGT" ).append("\n"); 
		query.append("            FROM MDM_VSL_CNTR      T1" ).append("\n"); 
		query.append("                ,FCM_VSL_CNTR_RGST T2" ).append("\n"); 
		query.append("           WHERE T1.VSL_CD   = T61.VSL_CD" ).append("\n"); 
		query.append("             AND T1.VSL_CD   = T2.VSL_CD" ).append("\n"); 
		query.append("             AND T1.DELT_FLG = 'N'" ).append("\n"); 
		query.append("         ) AS MNVR_CSM_WGT" ).append("\n"); 
		query.append("        ,(SELECT NVL(OP_MIN_SPD, 0) AS OP_MIN_SPD" ).append("\n"); 
		query.append("            FROM MDM_VSL_CNTR      T1" ).append("\n"); 
		query.append("                ,FCM_VSL_CNTR_RGST T2" ).append("\n"); 
		query.append("           WHERE T1.VSL_CD   = T61.VSL_CD" ).append("\n"); 
		query.append("             AND T1.VSL_CD   = T2.VSL_CD" ).append("\n"); 
		query.append("             AND T1.DELT_FLG = 'N'" ).append("\n"); 
		query.append("         ) AS OP_MIN_SPD" ).append("\n"); 
		query.append("        ,(SELECT NVL(OP_GNR_SPD, 0) AS OP_GNR_SPD" ).append("\n"); 
		query.append("            FROM MDM_VSL_CNTR      T1" ).append("\n"); 
		query.append("                ,FCM_VSL_CNTR_RGST T2" ).append("\n"); 
		query.append("           WHERE T1.VSL_CD   = T61.VSL_CD" ).append("\n"); 
		query.append("             AND T1.VSL_CD   = T2.VSL_CD" ).append("\n"); 
		query.append("             AND T1.DELT_FLG = 'N'" ).append("\n"); 
		query.append("         ) AS OP_GNR_SPD" ).append("\n"); 
		query.append("        ,T61.PF_MNVR_IN_HRS" ).append("\n"); 
		query.append("        ,T61.PF_MNVR_OUT_HRS" ).append("\n"); 
		query.append("        ,(CASE" ).append("\n"); 
		query.append("               WHEN     T63.VPS_ETB_DT          IS NOT NULL" ).append("\n"); 
		query.append("                    AND T63.SB_ENG_DT           IS NOT NULL" ).append("\n"); 
		query.append("                    AND T63.BFR_BRTH_ANK_DRP_DT IS NOT NULL" ).append("\n"); 
		query.append("                    AND T63.BFR_BRTH_ANK_OFF_DT IS NOT NULL     THEN (TO_CHAR(T63.BFR_BRTH_ANK_DRP_DT - T63.SB_ENG_DT) * 24) + (TO_CHAR(T63.VPS_ETB_DT - T63.BFR_BRTH_ANK_OFF_DT) * 24)" ).append("\n"); 
		query.append("               WHEN     T63.VPS_ETB_DT          IS NOT NULL" ).append("\n"); 
		query.append("                    AND T63.SB_ENG_DT           IS NOT NULL     THEN TO_CHAR(T63.VPS_ETB_DT - T63.SB_ENG_DT) * 24" ).append("\n"); 
		query.append("          END) AS DEP_MNVR_IN_HRS" ).append("\n"); 
		query.append("        ,(CASE" ).append("\n"); 
		query.append("               WHEN     T63.VPS_ETD_DT            IS NOT NULL" ).append("\n"); 
		query.append("                    AND T63.RUP_DT                IS NOT NULL" ).append("\n"); 
		query.append("                    AND T63.AFT_UNBRTH_ANK_DRP_DT IS NOT NULL" ).append("\n"); 
		query.append("                    AND T63.AFT_UNBRTH_ANK_OFF_DT IS NOT NULL   THEN (TO_CHAR(T63.AFT_UNBRTH_ANK_DRP_DT - T63.VPS_ETD_DT) * 24) + (TO_CHAR(T63.RUP_DT - T63.AFT_UNBRTH_ANK_OFF_DT) * 24)" ).append("\n"); 
		query.append("               WHEN     T63.VPS_ETD_DT            IS NOT NULL" ).append("\n"); 
		query.append("                    AND T63.RUP_DT                IS NOT NULL   THEN TO_CHAR(T63.RUP_DT - T63.VPS_ETD_DT) * 24" ).append("\n"); 
		query.append("          END) AS DEP_MNVR_OUT_HRS" ).append("\n"); 
		query.append("        ,ROUND((TO_CHAR(T63.NXT_PORT_ETA_DT - T63.VPS_ETD_DT) * 24) + (T61.GMT_HRS - T61.NXT_GMT_HRS) / 60 - NVL(T61.PF_MNVR_OUT_HRS, 0), 2) AS INIT_TACTUAL_SEA_TM_HRS" ).append("\n"); 
		query.append("        ,(SELECT D.NVGT_ML_DIST" ).append("\n"); 
		query.append("            FROM FCM_DEP_RPT_TMP D" ).append("\n"); 
		query.append("           WHERE D.VSL_CD       = SUBSTR(T61.NXT_VVD, 1, 4)" ).append("\n"); 
		query.append("             AND D.SKD_VOY_NO   = SUBSTR(T61.NXT_VVD, 5, 4)" ).append("\n"); 
		query.append("             AND D.SKD_DIR_CD   = SUBSTR(T61.NXT_VVD, 9, 4)" ).append("\n"); 
		query.append("             AND D.DEP_PORT_CD  = T61.NXT_PORT_CD" ).append("\n"); 
		query.append("             AND D.CLPT_IND_SEQ = T61.NXT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("             AND D.NXT_PORT_CD  = T61.NXT_NXT_PORT_CD" ).append("\n"); 
		query.append("        ) AS NVGT_ML_DIST" ).append("\n"); 
		query.append("	  ,(CASE" ).append("\n"); 
		query.append("		WHEN T63.BFR_BRTH_ANK_DRP_DT IS NOT NULL" ).append("\n"); 
		query.append("			AND T63.BFR_BRTH_ANK_OFF_DT IS NOT NULL" ).append("\n"); 
		query.append("			AND T63.AFT_UNBRTH_ANK_DRP_DT IS NOT NULL" ).append("\n"); 
		query.append("			AND T63.AFT_UNBRTH_ANK_OFF_DT IS NOT NULL" ).append("\n"); 
		query.append("		THEN ROUND(T61.ACT_PORT_TIME + (TO_CHAR(T63.BFR_BRTH_ANK_OFF_DT - T63.BFR_BRTH_ANK_DRP_DT) * 24) + (TO_CHAR(T63.AFT_UNBRTH_ANK_OFF_DT - T63.AFT_UNBRTH_ANK_DRP_DT) * 24), 2)" ).append("\n"); 
		query.append("		WHEN T63.BFR_BRTH_ANK_DRP_DT IS NOT NULL" ).append("\n"); 
		query.append("			AND T63.BFR_BRTH_ANK_OFF_DT IS NOT NULL" ).append("\n"); 
		query.append("		THEN ROUND(T61.ACT_PORT_TIME + (TO_CHAR(T63.BFR_BRTH_ANK_OFF_DT - T63.BFR_BRTH_ANK_DRP_DT) * 24), 2)" ).append("\n"); 
		query.append("		WHEN T63.AFT_UNBRTH_ANK_DRP_DT IS NOT NULL" ).append("\n"); 
		query.append("			AND T63.AFT_UNBRTH_ANK_OFF_DT IS NOT NULL" ).append("\n"); 
		query.append("		THEN ROUND(T61.ACT_PORT_TIME + (TO_CHAR(T63.AFT_UNBRTH_ANK_OFF_DT - T63.AFT_UNBRTH_ANK_DRP_DT) * 24), 2)" ).append("\n"); 
		query.append("		ELSE T61.ACT_PORT_TIME" ).append("\n"); 
		query.append("		END" ).append("\n"); 
		query.append("	  ) AS INIT_TACTUAL_PORT_TIME" ).append("\n"); 
		query.append("        ,(SELECT D.SKD_VOY_NO || D.SKD_DIR_CD" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(TO_NUMBER(D.NVGT_ML_DIST), 'FM999,999')" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(TO_NUMBER(D.ENG_ML_DIST), 'FM999,999')" ).append("\n"); 
		query.append("				|| '\t' || CASE WHEN D.ENG_ML_DIST != '0' THEN ROUND((TO_NUMBER(D.ENG_ML_DIST) - TO_NUMBER(D.NVGT_ML_DIST)) / TO_NUMBER(D.ENG_ML_DIST) * 100, 2)" ).append("\n"); 
		query.append("							ELSE 0" ).append("\n"); 
		query.append("							END || '%'" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(TO_NUMBER(T63.MNVR_IN_ML_DIST) + TO_NUMBER(D.MNVR_OUT_ML_DIST), 'FM999,999')" ).append("\n"); 
		query.append("				|| '\t' || ROUND(TO_CHAR(T63.VPS_ETD_DT - T63.VPS_ETB_DT) * 24, 2)" ).append("\n"); 
		query.append("				|| '\t' || D.AVG_SPD" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(NVL(D.SEA_MN_FOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_GNR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_BLR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_MN_LOW_SULP_FOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_GNR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_BLR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_MN_DOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_GNR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_BLR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_MN_LOW_SULP_DOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_GNR_LOW_SULP_DOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_BLR_LOW_SULP_DOIL_CSM_QTY, 0), 'FM999,999.9')" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(NVL(T63.PORT_MN_FOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_GNR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_BLR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_MN_LOW_SULP_FOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_GNR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_BLR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_MN_DOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_GNR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_BLR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_MN_LOW_SULP_DOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_GNR_LOW_SULP_DOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_BLR_LOW_SULP_DOIL_CSM_QTY, 0), 'FM999,999.9')" ).append("\n"); 
		query.append("                FROM FCM_DEP_RPT_TMP D" ).append("\n"); 
		query.append("               WHERE D.VSL_CD       = SUBSTR(T61.NXT_VVD, 1, 4)" ).append("\n"); 
		query.append("                 AND D.SKD_VOY_NO   = TO_CHAR(SUBSTR(T61.NXT_VVD, 5, 4) - 1, 'FM0000')" ).append("\n"); 
		query.append("                 AND D.SKD_DIR_CD   = SUBSTR(T61.NXT_VVD, 9, 4)" ).append("\n"); 
		query.append("                 AND D.DEP_PORT_CD  = T61.NXT_PORT_CD" ).append("\n"); 
		query.append("                 AND D.CLPT_IND_SEQ = T61.NXT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                 AND D.NXT_PORT_CD  = T61.NXT_NXT_PORT_CD  ) AS ONE_AGO_PREVIOUS" ).append("\n"); 
		query.append("        ,(SELECT D.SKD_VOY_NO || D.SKD_DIR_CD" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(TO_NUMBER(D.NVGT_ML_DIST), 'FM999,999')" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(TO_NUMBER(D.ENG_ML_DIST), 'FM999,999')" ).append("\n"); 
		query.append("				|| '\t' || CASE WHEN D.ENG_ML_DIST != '0' THEN ROUND((TO_NUMBER(D.ENG_ML_DIST) - TO_NUMBER(D.NVGT_ML_DIST)) / TO_NUMBER(D.ENG_ML_DIST) * 100, 2)" ).append("\n"); 
		query.append("							ELSE 0" ).append("\n"); 
		query.append("							END || '%'" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(TO_NUMBER(T63.MNVR_IN_ML_DIST) + TO_NUMBER(D.MNVR_OUT_ML_DIST), 'FM999,999')" ).append("\n"); 
		query.append("				|| '\t' || ROUND(TO_CHAR(T63.VPS_ETD_DT - T63.VPS_ETB_DT) * 24, 2)" ).append("\n"); 
		query.append("				|| '\t' || D.AVG_SPD" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(NVL(D.SEA_MN_FOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_GNR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_BLR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_MN_LOW_SULP_FOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_GNR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_BLR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_MN_DOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_GNR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_BLR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_MN_LOW_SULP_DOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_GNR_LOW_SULP_DOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_BLR_LOW_SULP_DOIL_CSM_QTY, 0), 'FM999,999.9')" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(NVL(T63.PORT_MN_FOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_GNR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_BLR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_MN_LOW_SULP_FOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_GNR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_BLR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_MN_DOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_GNR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_BLR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_MN_LOW_SULP_DOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_GNR_LOW_SULP_DOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_BLR_LOW_SULP_DOIL_CSM_QTY, 0), 'FM999,999.9')" ).append("\n"); 
		query.append("                FROM FCM_DEP_RPT_TMP D" ).append("\n"); 
		query.append("               WHERE D.VSL_CD       = SUBSTR(T61.NXT_VVD, 1, 4)" ).append("\n"); 
		query.append("                 AND D.SKD_VOY_NO   = TO_CHAR(SUBSTR(T61.NXT_VVD, 5, 4) - 2, 'FM0000')" ).append("\n"); 
		query.append("                 AND D.SKD_DIR_CD   = SUBSTR(T61.NXT_VVD, 9, 4)" ).append("\n"); 
		query.append("                 AND D.DEP_PORT_CD  = T61.NXT_PORT_CD" ).append("\n"); 
		query.append("                 AND D.CLPT_IND_SEQ = T61.NXT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                 AND D.NXT_PORT_CD  = T61.NXT_NXT_PORT_CD  ) AS TWO_AGO_PREVIOUS" ).append("\n"); 
		query.append("        ,(SELECT D.SKD_VOY_NO || D.SKD_DIR_CD" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(TO_NUMBER(D.NVGT_ML_DIST), 'FM999,999')" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(TO_NUMBER(D.ENG_ML_DIST), 'FM999,999')" ).append("\n"); 
		query.append("				|| '\t' || CASE WHEN D.ENG_ML_DIST != '0' THEN ROUND((TO_NUMBER(D.ENG_ML_DIST) - TO_NUMBER(D.NVGT_ML_DIST)) / TO_NUMBER(D.ENG_ML_DIST) * 100, 2)" ).append("\n"); 
		query.append("							ELSE 0" ).append("\n"); 
		query.append("							END || '%'" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(TO_NUMBER(T63.MNVR_IN_ML_DIST) + TO_NUMBER(D.MNVR_OUT_ML_DIST), 'FM999,999')" ).append("\n"); 
		query.append("				|| '\t' || ROUND(TO_CHAR(T63.VPS_ETD_DT - T63.VPS_ETB_DT) * 24, 2)" ).append("\n"); 
		query.append("				|| '\t' || D.AVG_SPD" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(NVL(D.SEA_MN_FOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_GNR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_BLR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_MN_LOW_SULP_FOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_GNR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_BLR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_MN_DOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_GNR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_BLR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_MN_LOW_SULP_DOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_GNR_LOW_SULP_DOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(D.SEA_BLR_LOW_SULP_DOIL_CSM_QTY, 0), 'FM999,999.9')" ).append("\n"); 
		query.append("				|| '\t' || TO_CHAR(NVL(T63.PORT_MN_FOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_GNR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_BLR_FOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_MN_LOW_SULP_FOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_GNR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_BLR_LOW_SULP_FOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_MN_DOIL_CSM_QTY          , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_GNR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_BLR_DOIL_CSM_QTY         , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_MN_LOW_SULP_DOIL_CSM_QTY , 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_GNR_LOW_SULP_DOIL_CSM_QTY, 0)" ).append("\n"); 
		query.append("                           + NVL(T63.PORT_BLR_LOW_SULP_DOIL_CSM_QTY, 0), 'FM999,999.9')" ).append("\n"); 
		query.append("                FROM FCM_DEP_RPT_TMP D" ).append("\n"); 
		query.append("               WHERE D.VSL_CD       = SUBSTR(T61.NXT_VVD, 1, 4)" ).append("\n"); 
		query.append("                 AND D.SKD_VOY_NO   = TO_CHAR(SUBSTR(T61.NXT_VVD, 5, 4) - 3, 'FM0000')" ).append("\n"); 
		query.append("                 AND D.SKD_DIR_CD   = SUBSTR(T61.NXT_VVD, 9, 4)" ).append("\n"); 
		query.append("                 AND D.DEP_PORT_CD  = T61.NXT_PORT_CD" ).append("\n"); 
		query.append("                 AND D.CLPT_IND_SEQ = T61.NXT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                 AND D.NXT_PORT_CD  = T61.NXT_NXT_PORT_CD  ) AS THREE_AGO_PREVIOUS" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("            SELECT T51.VVD_SEQ" ).append("\n"); 
		query.append("                  ,T51.VSL_CD" ).append("\n"); 
		query.append("                  ,T51.SKD_VOY_NO" ).append("\n"); 
		query.append("                  ,T51.SKD_DIR_CD" ).append("\n"); 
		query.append("                  ,T51.VSL_SLAN_CD" ).append("\n"); 
		query.append("                  ,T51.VSL_CD || T51.SKD_VOY_NO || T51.SKD_DIR_CD AS VVD" ).append("\n"); 
		query.append("                  ,T51.PF_SKD_TP_CD" ).append("\n"); 
		query.append("                  ,T51.ST_PORT_CD" ).append("\n"); 
		query.append("                  ,T51.VPS_PORT_CD" ).append("\n"); 
		query.append("                  ,T51.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                  ,T51.CLPT_SEQ" ).append("\n"); 
		query.append("                  ,T51.SLAN_CD" ).append("\n"); 
		query.append("                  ,T51.PORT_SKD_STS_CD" ).append("\n"); 
		query.append("                  ,T51.YD_CD" ).append("\n"); 
		query.append("                  ,DECODE(T51.YD_CD, NULL, '', SUBSTR(T51.YD_CD, 6, 2)) AS TML_CD" ).append("\n"); 
		query.append("                  ,T51.CALL_YD_IND_SEQ" ).append("\n"); 
		query.append("                  ,TO_CHAR(T51.PF_ETA_DT  , 'YYYY-MM-DD HH24:MI') AS PF_ETA_DT" ).append("\n"); 
		query.append("                  ,TO_CHAR(T51.PF_ETB_DT  , 'YYYY-MM-DD HH24:MI') AS PF_ETB_DT" ).append("\n"); 
		query.append("                  ,TO_CHAR(T51.PF_ETD_DT  , 'YYYY-MM-DD HH24:MI') AS PF_ETD_DT" ).append("\n"); 
		query.append("                  ,TO_CHAR(T51.NXT_ETA_DT , 'YYYY-MM-DD HH24:MI') AS NXT_ETA_DT" ).append("\n"); 
		query.append("                  ,TO_CHAR(T51.NXT_ETD_DT , 'YYYY-MM-DD HH24:MI') AS NXT_ETD_DT" ).append("\n"); 
		query.append("                  ,TO_CHAR(T51.INIT_ETA_DT, 'YYYY-MM-DD HH24:MI') AS INIT_ETA_DT" ).append("\n"); 
		query.append("                  ,TO_CHAR(T51.INIT_ETB_DT, 'YYYY-MM-DD HH24:MI') AS INIT_ETB_DT" ).append("\n"); 
		query.append("                  ,TO_CHAR(T51.INIT_ETD_DT, 'YYYY-MM-DD HH24:MI') AS INIT_ETD_DT" ).append("\n"); 
		query.append("                  ,TO_CHAR(T51.VPS_ETA_DT , 'YYYY-MM-DD HH24:MI') AS VPS_ETA_DT" ).append("\n"); 
		query.append("                  ,TO_CHAR(T51.VPS_ETB_DT , 'YYYY-MM-DD HH24:MI') AS VPS_ETB_DT" ).append("\n"); 
		query.append("                  ,TO_CHAR(T51.VPS_ETD_DT , 'YYYY-MM-DD HH24:MI') AS VPS_ETD_DT" ).append("\n"); 
		query.append("                  ,T51.SKD_CNG_STS_CD" ).append("\n"); 
		query.append("                  ,T51.TURN_PORT_FLG" ).append("\n"); 
		query.append("                  ,T51.TURN_PORT_IND_CD" ).append("\n"); 
		query.append("                  ,T51.TURN_SKD_VOY_NO" ).append("\n"); 
		query.append("                  ,T51.TURN_SKD_DIR_CD" ).append("\n"); 
		query.append("                  ,T51.TURN_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                  ,NVL(T51.LNK_DIST    , NVL(T52.LNK_DIST    , 0)) AS LNK_DIST" ).append("\n"); 
		query.append("                  ,NVL(T51.LNK_SPD     , NVL(T52.LNK_SPD     , 0)) AS LNK_SPD" ).append("\n"); 
		query.append("                  ,NVL(T51.SEA_BUF_HRS , NVL(T52.SEA_BUF_HRS , 0)) AS SEA_BUF_HRS" ).append("\n"); 
		query.append("                  ,NVL(T51.PORT_BUF_HRS, NVL(T52.PORT_BUF_HRS, 0)) AS PORT_BUF_HRS" ).append("\n"); 
		query.append("                  ,NVL(T51.TZTM_HRS    , NVL(T52.TZTM_HRS    , 0)) AS TZTM_HRS" ).append("\n"); 
		query.append("                  ,NVL(T51.PORT_WRK_HRS, NVL(T52.ACT_WRK_HRS , 0)) AS ACT_WRK_HRS" ).append("\n"); 
		query.append("                  ,NVL(T51.MNVR_OUT_HRS, NVL(T52.MNVR_OUT_HRS, 0)) AS MNVR_OUT_HRS" ).append("\n"); 
		query.append("                  ,NVL(T51.MNVR_IN_HRS , NVL(T52.MNVR_IN_HRS , 0)) AS MNVR_IN_HRS" ).append("\n"); 
		query.append("                  ,NVL(T52.LNK_DIST    , 0) AS DIST_PF_LNK" ).append("\n"); 
		query.append("                  ,NVL(T52.LNK_SPD     , 0) AS SPD_PF_LNK" ).append("\n"); 
		query.append("                  ,NVL(T52.SEA_BUF_HRS , 0) AS PF_SEA_BUF_HRS" ).append("\n"); 
		query.append("                  ,NVL(T52.PORT_BUF_HRS, 0) AS PF_PORT_BUF_HRS" ).append("\n"); 
		query.append("                  ,NVL(T52.TZTM_HRS    , 0) AS PF_SEA_TM_HRS" ).append("\n"); 
		query.append("                  ,NVL(T52.ACT_WRK_HRS , 0) AS PF_ACT_WRK_HRS" ).append("\n"); 
		query.append("                  ,NVL(T52.MNVR_OUT_HRS, 0) AS PF_MNVR_OUT_HRS" ).append("\n"); 
		query.append("                  ,NVL(T52.MNVR_IN_HRS , 0) AS PF_MNVR_IN_HRS" ).append("\n"); 
		query.append("                  ,ROUND((TO_CHAR(T51.NXT_ETA_DT - T51.VPS_ETD_DT) * 24) + (T51.GMT_HRS - T51.NXT_GMT_HRS) / 60 - NVL(T52.MNVR_OUT_HRS, 0), 2) AS OPMZ_SEA_TM_HRS" ).append("\n"); 
		query.append("                  ,ROUND((TO_CHAR(T51.VPS_ETD_DT - T51.VPS_ETB_DT) * 24), 2) AS PORT_TIME" ).append("\n"); 
		query.append("                  ,ROUND((TO_CHAR(LEAD(T54.ACT_ARR_DT) OVER (ORDER BY DECODE(T51.SKD_CNG_STS_CD, 'S', 'X', 'A'), T51.VVD_SEQ, T51.VSL_CD, T51.SKD_VOY_NO, T51.SKD_DIR_CD, T51.CLPT_SEQ) - T54.ACT_DEP_DT) * 24) + (T51.GMT_HRS - T51.NXT_GMT_HRS) / 60 - NVL(T52.MNVR_OUT_HRS, 0), 2) AS ACT_OPMZ_SEA_TM_HRS" ).append("\n"); 
		query.append("                  ,ROUND((TO_CHAR(T54.ACT_DEP_DT - T54.ACT_BRTH_DT) * 24), 2) AS ACT_PORT_TIME" ).append("\n"); 
		query.append("                  ,T51.NXT_VVD" ).append("\n"); 
		query.append("                  ,T51.NXT_PORT_CD" ).append("\n"); 
		query.append("                  ,T51.NXT_NXT_PORT_CD" ).append("\n"); 
		query.append("                  ,T51.NXT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                  ,(SELECT OPMZ_DIST" ).append("\n"); 
		query.append("                      FROM VSK_PORT_OPMZ_DIST D" ).append("\n"); 
		query.append("                     WHERE D.FM_YD_CD     = T51.VPS_PORT_CD" ).append("\n"); 
		query.append("                       AND D.TO_YD_CD     = T51.NXT_PORT_CD" ).append("\n"); 
		query.append("                       AND D.FM_YD_GRP_ID = T51.YD_GRP_ID" ).append("\n"); 
		query.append("                       AND D.TO_YD_GRP_ID = T51.NXT_YD_GRP_ID ) AS DIST_OPMZ" ).append("\n"); 
		query.append("                  ,(SELECT OPMZ_DIST" ).append("\n"); 
		query.append("                      FROM VSK_PORT_OPMZ_DIST D" ).append("\n"); 
		query.append("                     WHERE D.FM_YD_CD     = T51.VPS_PORT_CD" ).append("\n"); 
		query.append("                       AND D.TO_YD_CD     = T51.NXT_PORT_CD" ).append("\n"); 
		query.append("                       AND D.FM_YD_GRP_ID = T51.YD_GRP_ID" ).append("\n"); 
		query.append("                       AND D.TO_YD_GRP_ID = 'All'             ) AS DIST_OPMZ_TO_ALL" ).append("\n"); 
		query.append("                   ,(SELECT OPMZ_DIST" ).append("\n"); 
		query.append("                      FROM VSK_PORT_OPMZ_DIST D" ).append("\n"); 
		query.append("                     WHERE D.FM_YD_CD     = T51.VPS_PORT_CD" ).append("\n"); 
		query.append("                       AND D.TO_YD_CD     = T51.NXT_PORT_CD" ).append("\n"); 
		query.append("                       AND D.FM_YD_GRP_ID = 'All'" ).append("\n"); 
		query.append("                       AND D.TO_YD_GRP_ID = T51.NXT_YD_GRP_ID ) AS DIST_OPMZ_FM_ALL" ).append("\n"); 
		query.append("                   ,(SELECT OPMZ_DIST" ).append("\n"); 
		query.append("                      FROM VSK_PORT_OPMZ_DIST D" ).append("\n"); 
		query.append("                     WHERE D.FM_YD_CD     = T51.VPS_PORT_CD" ).append("\n"); 
		query.append("                       AND D.TO_YD_CD     = T51.NXT_PORT_CD" ).append("\n"); 
		query.append("                       AND D.FM_YD_GRP_ID = 'All'" ).append("\n"); 
		query.append("                       AND D.TO_YD_GRP_ID = 'All'             ) AS DIST_OPMZ_ALL" ).append("\n"); 
		query.append("                   ,T51.GMT_HRS" ).append("\n"); 
		query.append("                   ,T51.NXT_GMT_HRS" ).append("\n"); 
		query.append("              FROM (" ).append("\n"); 
		query.append("                      SELECT T41.LVL AS VVD_SEQ" ).append("\n"); 
		query.append("                            ,T41.VSL_SLAN_CD" ).append("\n"); 
		query.append("                            ,T41.SKD_STS_CD" ).append("\n"); 
		query.append("                            ,T41.SKD_VOY_TP_CD" ).append("\n"); 
		query.append("                            ,T41.SKD_USD_IND_CD" ).append("\n"); 
		query.append("                            ,T41.PF_SKD_TP_CD" ).append("\n"); 
		query.append("                            ,T41.ST_PORT_CD" ).append("\n"); 
		query.append("                            ,T41.N1ST_PORT_BRTH_DT" ).append("\n"); 
		query.append("                            ,T41.PSDO_VVD_CD" ).append("\n"); 
		query.append("                            ,T41.CO_CD" ).append("\n"); 
		query.append("                            ,T41.SKD_RMK" ).append("\n"); 
		query.append("                            ,T41.CRE_USR_ID AS SKD_CRE_USE_ID" ).append("\n"); 
		query.append("                            ,T41.CRE_DT     AS SKD_CRE_DT" ).append("\n"); 
		query.append("                            ,T41.UPD_USR_ID AS SKD_UPD_USE_ID" ).append("\n"); 
		query.append("                            ,T41.UPD_DT     AS SKD_UPD_DT" ).append("\n"); 
		query.append("                            ,T42.*" ).append("\n"); 
		query.append("                            ,LEAD(T42.VSL_CD||T42.SKD_VOY_NO||T42.SKD_DIR_CD)  OVER (ORDER BY DECODE(T42.SKD_CNG_STS_CD, 'S', 'X', 'A'), T41.LVL, T41.VSL_CD, T41.SKD_VOY_NO, T41.SKD_DIR_CD, CLPT_SEQ) AS NXT_VVD" ).append("\n"); 
		query.append("                            ,LEAD(T42.VPS_PORT_CD)    OVER (ORDER BY DECODE(T42.SKD_CNG_STS_CD, 'S', 'X', 'A'), T41.LVL, T41.VSL_CD, T41.SKD_VOY_NO, T41.SKD_DIR_CD, CLPT_SEQ) AS NXT_PORT_CD" ).append("\n"); 
		query.append("                            ,LEAD(T42.VPS_PORT_CD, 2) OVER (ORDER BY DECODE(T42.SKD_CNG_STS_CD, 'S', 'X', 'A'), T41.LVL, T41.VSL_CD, T41.SKD_VOY_NO, T41.SKD_DIR_CD, CLPT_SEQ) AS NXT_NXT_PORT_CD" ).append("\n"); 
		query.append("                            ,LEAD(T42.CLPT_IND_SEQ)   OVER (ORDER BY DECODE(T42.SKD_CNG_STS_CD, 'S', 'X', 'A'), T41.LVL, T41.VSL_CD, T41.SKD_VOY_NO, T41.SKD_DIR_CD, CLPT_SEQ) AS NXT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                            ,LEAD(T42.VPS_ETA_DT )    OVER (ORDER BY DECODE(T42.SKD_CNG_STS_CD, 'S', 'X', 'A'), T41.LVL, T41.VSL_CD, T41.SKD_VOY_NO, T41.SKD_DIR_CD, CLPT_SEQ) AS NXT_ETA_DT" ).append("\n"); 
		query.append("                            ,LEAD(T42.VPS_ETD_DT )    OVER (ORDER BY DECODE(T42.SKD_CNG_STS_CD, 'S', 'X', 'A'), T41.LVL, T41.VSL_CD, T41.SKD_VOY_NO, T41.SKD_DIR_CD, CLPT_SEQ) AS NXT_ETD_DT" ).append("\n"); 
		query.append("                            ,T43.GMT_HRS" ).append("\n"); 
		query.append("                            ,LEAD(T43.GMT_HRS) OVER (ORDER BY DECODE(T42.SKD_CNG_STS_CD, 'S', 'X', 'A'), T41.LVL, T41.VSL_CD, T41.SKD_VOY_NO, T41.SKD_DIR_CD, CLPT_SEQ) AS NXT_GMT_HRS" ).append("\n"); 
		query.append("                            ,NVL(T44.YD_GRP_ID, 'All') AS YD_GRP_ID" ).append("\n"); 
		query.append("                            ,NVL(LEAD(T44.YD_GRP_ID) OVER (ORDER BY DECODE(T42.SKD_CNG_STS_CD, 'S', 'X', 'A'), T41.LVL, T41.VSL_CD, T41.SKD_VOY_NO, T41.SKD_DIR_CD, CLPT_SEQ), 'All') AS NXT_YD_GRP_ID" ).append("\n"); 
		query.append("                            ,T41.VVD_SEQ AS VVD_CNT" ).append("\n"); 
		query.append("                        FROM (" ).append("\n"); 
		query.append("                                SELECT T31.LVL" ).append("\n"); 
		query.append("                                      ,T32.*" ).append("\n"); 
		query.append("                                      ,ROW_NUMBER() OVER (ORDER BY LVL) AS VVD_SEQ" ).append("\n"); 
		query.append("                                      ,COUNT(*) OVER () - 1 AS MAX_VVD" ).append("\n"); 
		query.append("                                  FROM (  /* 조회 조건의 이전 항차 */" ).append("\n"); 
		query.append("                                          SELECT DISTINCT" ).append("\n"); 
		query.append("                                                 -LEVEL AS LVL" ).append("\n"); 
		query.append("                                                ,VSL_CD" ).append("\n"); 
		query.append("                                                ,TURN_SKD_VOY_NO AS SKD_VOY_NO" ).append("\n"); 
		query.append("                                                ,TURN_SKD_DIR_CD AS SKD_DIR_CD" ).append("\n"); 
		query.append("                                                ,'LAG' AS DIR" ).append("\n"); 
		query.append("                                            FROM VSK_VSL_PORT_SKD" ).append("\n"); 
		query.append("                                           WHERE LEVEL <= FLOOR(TO_NUMBER(@[vvd_seq]) / 2)" ).append("\n"); 
		query.append("                                             AND (TURN_SKD_VOY_NO IS NOT NULL OR TURN_SKD_DIR_CD IS NOT NULL)" ).append("\n"); 
		query.append("                                      START WITH VSL_CD                = @[vsl_cd]" ).append("\n"); 
		query.append("                                             AND SKD_VOY_NO            = @[skd_voy_no]" ).append("\n"); 
		query.append("                                             AND SKD_DIR_CD            = @[skd_dir_cd]" ).append("\n"); 
		query.append("                                             AND TURN_PORT_IND_CD     IN ('Y', 'N')" ).append("\n"); 
		query.append("                                      CONNECT BY PRIOR TURN_SKD_VOY_NO = SKD_VOY_NO" ).append("\n"); 
		query.append("                                             AND PRIOR TURN_SKD_DIR_CD = SKD_DIR_CD" ).append("\n"); 
		query.append("                                             AND PRIOR VSL_CD          = VSL_CD" ).append("\n"); 
		query.append("                                             AND TURN_PORT_IND_CD     IN ('Y', 'N')" ).append("\n"); 
		query.append("                                             AND LEVEL <= FLOOR(TO_NUMBER(@[vvd_seq]) / 2)" ).append("\n"); 
		query.append("                                          UNION ALL" ).append("\n"); 
		query.append("                                          /* 조회 조건의 항차 */" ).append("\n"); 
		query.append("                                          SELECT 0 AS LVL" ).append("\n"); 
		query.append("                                                ,@[vsl_cd]     AS VSL_CD" ).append("\n"); 
		query.append("                                                ,@[skd_voy_no] AS SKD_VOY_NO" ).append("\n"); 
		query.append("                                                ,@[skd_dir_cd] AS SKD_DIR_CD" ).append("\n"); 
		query.append("                                                ,NULL          AS DIR" ).append("\n"); 
		query.append("                                            FROM DUAL" ).append("\n"); 
		query.append("                                          UNION ALL" ).append("\n"); 
		query.append("                                          /* 조회 조건의 이후 항차 */" ).append("\n"); 
		query.append("                                          SELECT DISTINCT" ).append("\n"); 
		query.append("                                                 LEVEL AS LVL" ).append("\n"); 
		query.append("                                                ,VSL_CD" ).append("\n"); 
		query.append("                                                ,TURN_SKD_VOY_NO AS SKD_VOY_NO" ).append("\n"); 
		query.append("                                                ,TURN_SKD_DIR_CD AS SKD_DIR_CD" ).append("\n"); 
		query.append("                                                ,'LEAD' AS DIR" ).append("\n"); 
		query.append("                                            FROM VSK_VSL_PORT_SKD" ).append("\n"); 
		query.append("                                           WHERE LEVEL <= FLOOR(TO_NUMBER(@[vvd_seq]) / 2) + 1" ).append("\n"); 
		query.append("                                             AND (TURN_SKD_VOY_NO IS NOT NULL OR TURN_SKD_DIR_CD IS NOT NULL)" ).append("\n"); 
		query.append("                                      START WITH VSL_CD                = @[vsl_cd]" ).append("\n"); 
		query.append("                                             AND SKD_VOY_NO            = @[skd_voy_no]" ).append("\n"); 
		query.append("                                             AND SKD_DIR_CD            = @[skd_dir_cd]" ).append("\n"); 
		query.append("                                             AND TURN_PORT_IND_CD     IN ('D', 'V', 'F')" ).append("\n"); 
		query.append("                                      CONNECT BY PRIOR TURN_SKD_VOY_NO = SKD_VOY_NO" ).append("\n"); 
		query.append("                                             AND PRIOR TURN_SKD_DIR_CD = SKD_DIR_CD" ).append("\n"); 
		query.append("                                             AND PRIOR VSL_CD          = VSL_CD" ).append("\n"); 
		query.append("                                             AND TURN_PORT_IND_CD IN ('D', 'V', 'F')" ).append("\n"); 
		query.append("                                             AND LEVEL <= FLOOR(TO_NUMBER(@[vvd_seq]) / 2) + 1" ).append("\n"); 
		query.append("                                       ) T31" ).append("\n"); 
		query.append("                                      ,VSK_VSL_SKD T32" ).append("\n"); 
		query.append("                                 WHERE T31.VSL_CD     = T32.VSL_CD" ).append("\n"); 
		query.append("                                   AND T31.SKD_VOY_NO = T32.SKD_VOY_NO" ).append("\n"); 
		query.append("                                   AND T31.SKD_DIR_CD = T32.SKD_DIR_CD" ).append("\n"); 
		query.append("                             ) T41" ).append("\n"); 
		query.append("                            ,VSK_VSL_PORT_SKD T42" ).append("\n"); 
		query.append("                            ,MDM_LOCATION     T43" ).append("\n"); 
		query.append("                            ,VSK_YD_GRP       T44" ).append("\n"); 
		query.append("                       WHERE T41.VSL_CD     = T42.VSL_CD" ).append("\n"); 
		query.append("                         AND T41.SKD_VOY_NO = T42.SKD_VOY_NO" ).append("\n"); 
		query.append("                         AND T41.SKD_DIR_CD = T42.SKD_DIR_CD" ).append("\n"); 
		query.append("                         AND T42.TURN_PORT_IND_CD NOT IN ('D', 'V', 'F')" ).append("\n"); 
		query.append("                         AND T42.VPS_PORT_CD = T43.LOC_CD" ).append("\n"); 
		query.append("                         AND T42.YD_CD       = T44.YD_CD (+)" ).append("\n"); 
		query.append("                   ) T51" ).append("\n"); 
		query.append("                  ,(" ).append("\n"); 
		query.append("                      SELECT T1.VSL_SLAN_CD" ).append("\n"); 
		query.append("                            ,T1.PF_SVC_TP_CD" ).append("\n"); 
		query.append("                            ,T1.PORT_CD" ).append("\n"); 
		query.append("                            ,DECODE(VIRT_FLG, 'V', T1.DIR_CD2, T2.SKD_DIR_CD) AS SKD_DIR_CD" ).append("\n"); 
		query.append("                            ,T1.CLPT_SEQ" ).append("\n"); 
		query.append("                            ,T2.PORT_ROTN_SEQ" ).append("\n"); 
		query.append("                            ,T2.YD_CD" ).append("\n"); 
		query.append("                            ,CALL_YD_IND_SEQ" ).append("\n"); 
		query.append("                            ,TURN_PORT_FLG" ).append("\n"); 
		query.append("                            ,TURN_PORT_IND_CD" ).append("\n"); 
		query.append("                            ,ETB_DY_CD" ).append("\n"); 
		query.append("                            ,ETB_DY_NO" ).append("\n"); 
		query.append("                            ,ETB_TM_HRMNT" ).append("\n"); 
		query.append("                            ,ETD_DY_CD" ).append("\n"); 
		query.append("                            ,ETD_DY_NO" ).append("\n"); 
		query.append("                            ,ETD_TM_HRMNT" ).append("\n"); 
		query.append("                            ,LNK_DIST" ).append("\n"); 
		query.append("                            ,LNK_SPD" ).append("\n"); 
		query.append("                            ,TZTM_HRS" ).append("\n"); 
		query.append("                            ,SEA_BUF_HRS" ).append("\n"); 
		query.append("                            ,SEA_BUF_SPD" ).append("\n"); 
		query.append("                            ,MNVR_IN_HRS" ).append("\n"); 
		query.append("                            ,MNVR_OUT_HRS" ).append("\n"); 
		query.append("                            ,IB_IPCGO_QTY" ).append("\n"); 
		query.append("                            ,IB_OCN_CGO_QTY" ).append("\n"); 
		query.append("                            ,OB_IPCGO_QTY" ).append("\n"); 
		query.append("                            ,OB_OCN_CGO_QTY" ).append("\n"); 
		query.append("                            ,TML_PROD_QTY" ).append("\n"); 
		query.append("                            ,CRN_KNT" ).append("\n"); 
		query.append("                            ,ACT_WRK_HRS" ).append("\n"); 
		query.append("                            ,PORT_BUF_HRS" ).append("\n"); 
		query.append("                            ,CRE_USR_ID" ).append("\n"); 
		query.append("                            ,CRE_DT" ).append("\n"); 
		query.append("                            ,UPD_USR_ID" ).append("\n"); 
		query.append("                            ,UPD_DT" ).append("\n"); 
		query.append("                            ,LEAD(T1.PORT_CD) OVER (ORDER BY T1.VSL_SLAN_CD, T1.PF_SVC_TP_CD, DIR_CD2, T2.PORT_ROTN_SEQ) AS NXT_PORT" ).append("\n"); 
		query.append("                        FROM (" ).append("\n"); 
		query.append("                                SELECT NVL(T3.VSL_SLAN_CD , T1.VSL_SLAN_CD ) AS VSL_SLAN_CD" ).append("\n"); 
		query.append("                                      ,NVL(T3.PF_SVC_TP_CD, T1.PF_SVC_TP_CD) AS PF_SVC_TP_CD" ).append("\n"); 
		query.append("                                      ,NVL(T3.PORT_CD     , T1.PORT_CD     ) AS PORT_CD" ).append("\n"); 
		query.append("                                      ,DECODE(T3.SKD_DIR_CD, NULL, ( SELECT S.VSL_SLAN_DIR_CD" ).append("\n"); 
		query.append("                                                                       FROM MDM_VSL_SVC_LANE_DIR S" ).append("\n"); 
		query.append("                                                                      WHERE T1.VSL_SLAN_CD = S.VSL_SLAN_CD" ).append("\n"); 
		query.append("                                                                        AND T1.SKD_DIR_CD != S.VSL_SLAN_DIR_CD" ).append("\n"); 
		query.append("                                                                        AND S.DELT_FLG     = 'N'" ).append("\n"); 
		query.append("                                                                        AND ROWNUM = 1 ), T1.SKD_DIR_CD) AS SKD_DIR_CD" ).append("\n"); 
		query.append("                                      ,DECODE(T3.CLPT_SEQ, NULL, ( SELECT T1.CLPT_SEQ" ).append("\n"); 
		query.append("                                                                     FROM VSK_PF_SKD_DTL M" ).append("\n"); 
		query.append("                                                                    WHERE T1.VSL_SLAN_CD      = M.VSL_SLAN_CD" ).append("\n"); 
		query.append("                                                                      AND T1.PF_SVC_TP_CD     = M.PF_SVC_TP_CD" ).append("\n"); 
		query.append("                                                                      AND T1.SKD_DIR_CD       = ( SELECT S.VSL_SLAN_DIR_CD" ).append("\n"); 
		query.append("                                                                                                    FROM MDM_VSL_SVC_LANE_DIR S" ).append("\n"); 
		query.append("                                                                                                   WHERE T1.VSL_SLAN_CD = S.VSL_SLAN_CD" ).append("\n"); 
		query.append("                                                                                                     AND T1.SKD_DIR_CD  = S.VSL_SLAN_DIR_CD" ).append("\n"); 
		query.append("                                                                                                     AND S.DELT_FLG     = 'N' )" ).append("\n"); 
		query.append("                                                                      AND T1.PORT_CD          = M.PORT_CD" ).append("\n"); 
		query.append("                                                                      AND T1.CLPT_SEQ         = M.CLPT_SEQ" ).append("\n"); 
		query.append("                                                                      AND M.TURN_PORT_IND_CD != 'F' ), T1.CLPT_SEQ) AS CLPT_SEQ" ).append("\n"); 
		query.append("                                      ,DECODE(T3.SKD_DIR_CD, NULL, 'V', 'N') AS VIRT_FLG" ).append("\n"); 
		query.append("                                      ,T1.SKD_DIR_CD AS DIR_CD2" ).append("\n"); 
		query.append("                                  FROM VSK_PF_CALL_PORT     T1" ).append("\n"); 
		query.append("                                      ,MDM_VSL_SVC_LANE_DIR T2" ).append("\n"); 
		query.append("                                      ,VSK_PF_SKD_DTL       T3" ).append("\n"); 
		query.append("                                 WHERE T1.VSL_SLAN_CD  = T2.VSL_SLAN_CD" ).append("\n"); 
		query.append("                                   AND T1.SKD_DIR_CD   = T2.VSL_SLAN_DIR_CD" ).append("\n"); 
		query.append("                                   AND T1.VSL_SLAN_CD  = T3.VSL_SLAN_CD  (+)" ).append("\n"); 
		query.append("                                   AND T1.PF_SVC_TP_CD = T3.PF_SVC_TP_CD (+)" ).append("\n"); 
		query.append("                                   AND T1.SKD_DIR_CD   = T3.SKD_DIR_CD   (+)" ).append("\n"); 
		query.append("                                   AND T1.PORT_CD      = T3.PORT_CD      (+)" ).append("\n"); 
		query.append("                                   AND T1.CLPT_SEQ     = T3.CLPT_SEQ     (+)" ).append("\n"); 
		query.append("                                   AND T3.TURN_PORT_IND_CD (+) != 'F'" ).append("\n"); 
		query.append("                             ) T1" ).append("\n"); 
		query.append("                            ,VSK_PF_SKD_DTL T2" ).append("\n"); 
		query.append("                       WHERE T1.VSL_SLAN_CD  = T2.VSL_SLAN_CD" ).append("\n"); 
		query.append("                         AND T1.PF_SVC_TP_CD = T2.PF_SVC_TP_CD" ).append("\n"); 
		query.append("                         AND T1.PORT_CD      = T2.PORT_CD" ).append("\n"); 
		query.append("                         AND T1.SKD_DIR_CD   = T2.SKD_DIR_CD" ).append("\n"); 
		query.append("                         AND T1.CLPT_SEQ     = T2.CLPT_SEQ" ).append("\n"); 
		query.append("                   ) T52" ).append("\n"); 
		query.append("                  ,VSK_PORT_OPMZ_DIST T53" ).append("\n"); 
		query.append("                  ,VSK_ACT_PORT_SKD   T54" ).append("\n"); 
		query.append("             WHERE T51.VSL_SLAN_CD   = T52.VSL_SLAN_CD  (+)" ).append("\n"); 
		query.append("               AND T51.PF_SKD_TP_CD  = T52.PF_SVC_TP_CD (+)" ).append("\n"); 
		query.append("               AND T51.SKD_DIR_CD    = T52.SKD_DIR_CD   (+)" ).append("\n"); 
		query.append("               AND T51.VPS_PORT_CD   = T52.PORT_CD      (+)" ).append("\n"); 
		query.append("               AND T51.CLPT_IND_SEQ  = T52.CLPT_SEQ     (+)" ).append("\n"); 
		query.append("               AND T51.VPS_PORT_CD   = T53.FM_YD_CD     (+)" ).append("\n"); 
		query.append("               AND T51.NXT_PORT_CD   = T53.TO_YD_CD     (+)" ).append("\n"); 
		query.append("               AND T51.YD_GRP_ID     = T53.FM_YD_GRP_ID (+)" ).append("\n"); 
		query.append("               AND T51.NXT_YD_GRP_ID = T53.TO_YD_GRP_ID (+)" ).append("\n"); 
		query.append("               AND T51.VSL_CD        = T54.VSL_CD       (+)" ).append("\n"); 
		query.append("               AND T51.SKD_VOY_NO    = T54.SKD_VOY_NO   (+)" ).append("\n"); 
		query.append("               AND T51.SKD_DIR_CD    = T54.SKD_DIR_CD   (+)" ).append("\n"); 
		query.append("               AND T51.VPS_PORT_CD   = T54.VPS_PORT_CD  (+)" ).append("\n"); 
		query.append("               AND T51.CLPT_IND_SEQ  = T54.CLPT_IND_SEQ (+)" ).append("\n"); 
		query.append("               AND T51.VVD_CNT      <= @[vvd_seq]" ).append("\n"); 
		query.append("         ) T61" ).append("\n"); 
		query.append("        ,FCM_VSL_PORT_STND_FUEL_OIL T62" ).append("\n"); 
		query.append("        ,FCM_DEP_RPT_TMP            T63" ).append("\n"); 
		query.append("   WHERE T61.VSL_CD       = T62.VSL_CD       (+)" ).append("\n"); 
		query.append("     AND T61.SKD_VOY_NO   = T62.SKD_VOY_NO   (+)" ).append("\n"); 
		query.append("     AND T61.SKD_DIR_CD   = T62.SKD_DIR_CD   (+)" ).append("\n"); 
		query.append("     AND T61.VPS_PORT_CD  = T62.VPS_PORT_CD  (+)" ).append("\n"); 
		query.append("     AND T61.CLPT_IND_SEQ = T62.CLPT_IND_SEQ (+)" ).append("\n"); 
		query.append("     AND T61.VSL_CD       = T63.VSL_CD       (+)" ).append("\n"); 
		query.append("     AND T61.SKD_VOY_NO   = T63.SKD_VOY_NO   (+)" ).append("\n"); 
		query.append("     AND T61.SKD_DIR_CD   = T63.SKD_DIR_CD   (+)" ).append("\n"); 
		query.append("     AND T61.VPS_PORT_CD  = T63.DEP_PORT_CD  (+)" ).append("\n"); 
		query.append("     AND T61.CLPT_IND_SEQ = T63.CLPT_IND_SEQ (+)" ).append("\n"); 
		query.append("ORDER BY VVD_SEQ" ).append("\n"); 
		query.append("        ,CLPT_SEQ" ).append("\n"); 

	}
}