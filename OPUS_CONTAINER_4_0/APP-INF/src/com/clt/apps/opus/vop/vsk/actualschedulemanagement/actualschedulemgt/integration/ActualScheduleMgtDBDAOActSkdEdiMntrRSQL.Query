<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ActualScheduleMgtDBDAOActSkdEdiMntrRSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
SELECT  A.RCV_SEQ
        , (SELECT VSL_SLAN_CD 
		     FROM VSK_VSL_SKD
		    WHERE VSL_CD = A.VSL_CD
			  AND SKD_VOY_NO = A.SKD_VOY_NO
			  AND SKD_DIR_CD = A.SKD_DIR_CD
		  ) AS VSL_SLAN_CD
        , A.VPS_PORT_CD
		, A.CLPT_IND_SEQ
        , A.YD_CD
        , SUBSTR(A.YD_CD, 6) AS TML_CD
        , A.EDI_VSL_NM
        , A.EDI_SKD_VOY_NO
        , A.EDI_SKD_DIR_NM
        , A.EDI_VSL_NM || A.EDI_SKD_VOY_NO || A.EDI_SKD_DIR_NM AS EDI_VVD
        , A.VSL_CD
        , A.SKD_VOY_NO
        , A.SKD_DIR_CD
        , A.VSL_CD || A.SKD_VOY_NO || A.SKD_DIR_CD AS VVD
        , TO_CHAR(A.EDI_ACT_ARR_DT, 'YYYYMMDDHH24MI') AS EDI_ACT_ARR_DT
        , TO_CHAR(A.EDI_ACT_BRTH_DT, 'YYYYMMDDHH24MI') AS EDI_ACT_BRTH_DT
        , TO_CHAR(A.EDI_ACT_DEP_DT, 'YYYYMMDDHH24MI') AS EDI_ACT_DEP_DT
        , TO_CHAR(A.ACT_ARR_DT, 'YYYYMMDDHH24MI') AS ACT_ARR_DT
        , TO_CHAR(A.ACT_BRTH_DT, 'YYYYMMDDHH24MI') AS ACT_BRTH_DT
        , TO_CHAR(A.ACT_DEP_DT, 'YYYYMMDDHH24MI') AS ACT_DEP_DT
        , TO_CHAR(A.RCV_DT, 'YYYYMMDD') AS RCV_DT
        , A.SCS_FLG
        , A.RSLT_MSG
		, A.SNDR_TRD_PRNR_ID
		, A.RCVR_TRD_PRNR_ID
		, A.EDI_MSG_TP_ID
		, A.EDI_MSG_PROC_ID
        , A.LLOYD_NO
        , A.CALL_SGN_NO
        , A.SHP_CALL_NO
		, A.CRE_USR_ID
		, TO_CHAR(A.CRE_DT, 'YYYYMMDDHH24MI') AS CRE_DT
		, A.UPD_USR_ID
		, A.UPD_DT
		, '' AS FM_DT
		, '' AS TO_DT
		, B.VSKD_PORT_RHQ_CD
		, B.SLS_OFC_CD

		, TO_CHAR(A.DCHG_CMPL_DT, 'YYYYMMDDHH24MI') AS DCHG_CMPL_DT

FROM    VSK_ACT_PORT_SKD_EDI_LOG A
		, MDM_LOCATION B
WHERE   1 = 1
AND     A.VPS_PORT_CD          = B.LOC_CD
#if (${vps_port_cd} != '') 
AND     A.VPS_PORT_CD LIKE @[vps_port_cd] || '%'
#end
#if (${yd_cd} != '') 
AND     A.YD_CD IN  (
		#foreach($key IN ${yd_cd}) 
			#if($velocityCount < $yd_cd.size())
				'$key',
			#else
				'$key'
			#end
		#end
					)
#end

AND     A.RCV_DT BETWEEN TO_DATE(@[fm_dt], 'YYYY-MM-DD') AND TO_DATE(@[to_dt], 'YYYY-MM-DD') + 0.99999
#if (${vsl_cd} != '') 
AND     A.VSL_CD = @[vsl_cd]
#end
#if (${skd_voy_no} != '') 
AND     A.SKD_VOY_NO = @[skd_voy_no]
#end
#if (${skd_dir_cd} != '') 
AND     A.SKD_DIR_CD = @[skd_dir_cd]
#end
#if (${scs_flg} != '' && ${scs_flg} != 'ALL' && ${rcv_dt} == '')
AND     A.SCS_FLG      = @[scs_flg]		/* RCV_DT 가 조회조건에 있으면 해당 조건제거 */
#end
#if (${lloyd_no} != '')
AND     UPPER(A.LLOYD_NO)     LIKE UPPER(@[lloyd_no]) || '%'
#end
#if (${call_sgn_no} != '')
AND     UPPER(A.CALL_SGN_NO)  LIKE UPPER(@[call_sgn_no]) || '%'
#end
#if (${vskd_port_rhq_cd} != '' && ${vskd_port_rhq_cd} != 'ALL')
AND     B.VSKD_PORT_RHQ_CD = @[vskd_port_rhq_cd]
#end
#if (${sls_ofc_cd} != '' && ${sls_ofc_cd} != 'ALL')
AND     B.SLS_OFC_CD = @[sls_ofc_cd]
#end
#if (${rcv_dt} != '') 
AND     A.RCV_DT = TO_DATE(@[rcv_dt], 'YYYYMMDD')
#end
#if (${rcv_seq} != '') 
AND     A.RCV_SEQ = @[rcv_seq]
#end
ORDER BY RCV_DT, RCV_SEQ			]]></sql>
			<params>
				<param name="vps_port_cd" type="12" value="" out="N"/>
				<param name="fm_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="scs_flg" type="12" value="" out="N"/>
				<param name="lloyd_no" type="12" value="" out="N"/>
				<param name="call_sgn_no" type="12" value="" out="N"/>
				<param name="vskd_port_rhq_cd" type="12" value="" out="N"/>
				<param name="sls_ofc_cd" type="12" value="" out="N"/>
				<param name="rcv_dt" type="12" value="" out="N"/>
				<param name="rcv_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
