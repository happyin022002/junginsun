<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ActualScheduleMgtDBDAOSearchCallingIndicatorRSQL">
			<desc><![CDATA[SearchCallingIndicator]]></desc>
			<sql><![CDATA[
SELECT VPS.CLPT_IND_SEQ
  FROM (SELECT VPS.*
             , RANK() OVER (ORDER BY VPS.DIFF_ETA_DT) AS ETA_RANK
          FROM (SELECT VSL_CD||SKD_VOY_NO||SKD_DIR_CD VVD
                     , CLPT_IND_SEQ
                     , VPS_PORT_CD
                     , VPS_ETA_DT
                     , VPS_ETB_DT
                     , VPS_ETD_DT
                     , ABS(ROUND(TO_DATE(TO_CHAR(VPS_ETA_DT,'YYYYMMDDHH24MI'),'YYYYMMDDHH24MI') - TO_DATE(@[act_arr_dt],'YYYYMMDDHH24MI'),2)) AS DIFF_ETA_DT
                  FROM VSK_VSL_PORT_SKD
                 WHERE 1=1
                   AND VSL_CD = @[vsl_cd] 
                   AND SKD_VOY_NO = @[skd_voy_no]
                   AND SKD_DIR_CD = @[skd_dir_cd]
                   AND VPS_PORT_CD = @[vps_port_cd] 
				   AND VT_ADD_CALL_FLG IS NULL
            ) VPS 
       ) VPS
 WHERE 1=1
   AND VPS.ETA_RANK = 1			]]></sql>
			<params>
				<param name="act_arr_dt" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="vps_port_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
