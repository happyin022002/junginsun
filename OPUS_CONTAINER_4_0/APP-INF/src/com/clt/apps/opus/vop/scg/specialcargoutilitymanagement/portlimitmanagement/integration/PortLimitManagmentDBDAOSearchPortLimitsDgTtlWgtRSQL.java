/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : PortLimitManagmentDBDAOSearchPortLimitsDgTtlWgtRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.12.12
*@LastModifier : 
*@LastVersion : 1.0
* 2016.12.12 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.vop.scg.specialcargoutilitymanagement.portlimitmanagement.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class PortLimitManagmentDBDAOSearchPortLimitsDgTtlWgtRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * Lane & Port의 조건을 통해 Port Limits 별  DG Total Weight 정보를 체크한다.
	  * </pre>
	  */
	public PortLimitManagmentDBDAOSearchPortLimitsDgTtlWgtRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vsl_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("plmt_port_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("skd_dir_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("from_eta_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("imdg_clss_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("skd_voy_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("slan_cd1",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_eta_dt",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.vop.scg.specialcargoutilitymanagement.portlimitmanagement.integration").append("\n"); 
		query.append("FileName : PortLimitManagmentDBDAOSearchPortLimitsDgTtlWgtRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("-- INLINE VIEW LIST -----------------------------------------" ).append("\n"); 
		query.append("-- upper DEPTH	A	: " ).append("\n"); 
		query.append("-- upper DEPTH  B	: " ).append("\n"); 
		query.append("-- 		SECOND		: PLMT - PORT LIMIT REGULATION" ).append("\n"); 
		query.append("-- 		SECOND		: DCGO - OWN + PARTNER DANGEROUS CARGO" ).append("\n"); 
		query.append("------------------------------------------------------------- " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT 		PORT_CD" ).append("\n"); 
		query.append("    	,	PORT_LMT_SEQ" ).append("\n"); 
		query.append("    	,	PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("    	,	LMT_WGT_TP_CD" ).append("\n"); 
		query.append("    	,	VSL_CD" ).append("\n"); 
		query.append("		,   PLMT_VVD" ).append("\n"); 
		query.append("    	,	SLAN_CD" ).append("\n"); 
		query.append("    	,	CUR_PORT_CD" ).append("\n"); 
		query.append("    	,	PIER_TP_CD" ).append("\n"); 
		query.append("    	,	FLSH_PNT_TEMP" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		,	ARRIVAL_BKG_NO" ).append("\n"); 
		query.append("		,	DISCHARGE_BKG_NO" ).append("\n"); 
		query.append("		,	LOAD_BKG_NO" ).append("\n"); 
		query.append("		,	DEPARTURE_BKG_NO " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    	--,	IMDG_CLSS_CD" ).append("\n"); 
		query.append("    	--,	IMDG_CLSS_CD_DESC" ).append("\n"); 
		query.append("    	--,	IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("    	--,	IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("    	--,	IMDG_UN_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    	,	IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("    	,	CNTR_TP_CD" ).append("\n"); 
		query.append("    	,	ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("    	,	LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    		--Arrival" ).append("\n"); 
		query.append("    	,	ARR_CGO_WGT" ).append("\n"); 
		query.append("    	,	DECODE(ARR_MAX_LMT, 0, NULL, ROUND((ARR_CGO_WGT / ARR_MAX_LMT  * 100), 2)) 		AS ARR_LMT_RTO" ).append("\n"); 
		query.append("    	,	DECODE(ARR_DEP_PROHI_FLG, 'Y', NULL, DECODE(ARR_MAX_LMT, 0, NULL, ARR_MAX_LMT)) AS ARR_MAX_LMT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    		--Discharge" ).append("\n"); 
		query.append("    	,	DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DCHG_CGO_WGT) 								AS DCHG_CGO_WGT" ).append("\n"); 
		query.append("    	,	DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DECODE(DCHG_MAX_LMT, 0, NULL, ROUND((DCHG_CGO_WGT/ DCHG_MAX_LMT * 100), 2))) AS DCHG_LMT_RTO" ).append("\n"); 
		query.append("    	,	DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DECODE(DCHG_MAX_LMT, 0, NULL, DCHG_MAX_LMT)) AS DCHG_MAX_LMT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    		--Load" ).append("\n"); 
		query.append("    	,	DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, LOD_CGO_WGT) 								AS LOD_CGO_WGT" ).append("\n"); 
		query.append("    	,	DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DECODE(LOD_MAX_LMT, 0, NULL, ROUND((LOD_CGO_WGT / LOD_MAX_LMT  * 100), 2))) AS LOD_LMT_RTO" ).append("\n"); 
		query.append("    	,	DECODE(LDIS_APLY_TGT_FLG, 'N', NULL, DECODE(LOD_MAX_LMT, 0, NULL, LOD_MAX_LMT)) AS LOD_MAX_LMT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    		--Depature" ).append("\n"); 
		query.append("		,	DEP_CGO_WGT" ).append("\n"); 
		query.append("    	,	DECODE(DEP_MAX_LMT, 0, NULL, ROUND((DEP_CGO_WGT / DEP_MAX_LMT  * 100), 2)) 		AS DEP_LMT_RTO" ).append("\n"); 
		query.append("    	,	DECODE(ARR_DEP_PROHI_FLG, 'Y', NULL, DECODE(DEP_MAX_LMT, 0, NULL, DEP_MAX_LMT)) AS DEP_MAX_LMT" ).append("\n"); 
		query.append("		,   PLMT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM 		(" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			--==========================================================================================================" ).append("\n"); 
		query.append("            SELECT 	 A.PORT_CD" ).append("\n"); 
		query.append("                  ,  A.PORT_LMT_SEQ" ).append("\n"); 
		query.append("                  ,  A.PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("                  ,  A.LMT_WGT_TP_CD" ).append("\n"); 
		query.append("                  ,  A.VSL_CD" ).append("\n"); 
		query.append("				  ,  A.PLMT_VVD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                  ,  A.SLAN_CD" ).append("\n"); 
		query.append("                  ,  A.CUR_PORT_CD" ).append("\n"); 
		query.append("                  ,  A.PIER_TP_CD" ).append("\n"); 
		query.append("                  ,  A.FLSH_PNT_TEMP" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                  ,  substr(xmlagg(xmlelement(a, DECODE(A.ARRIVAL_BKG_NO, '', '', ',') ||A.ARRIVAL_BKG_NO) order by A.ARRIVAL_BKG_NO).extract('//text()').getClobVal(), 2)                       AS ARRIVAL_BKG_NO" ).append("\n"); 
		query.append("                  ,  substr(xmlagg(xmlelement(a, DECODE(A.DISCHARGE_BKG_NO, '', '', ',') ||A.DISCHARGE_BKG_NO) order by A.DISCHARGE_BKG_NO).extract('//text()').getClobVal(), 2)                       AS DISCHARGE_BKG_NO" ).append("\n"); 
		query.append("                  ,  substr(xmlagg(xmlelement(a, DECODE(A.LOAD_BKG_NO, '', '', ',') ||A.LOAD_BKG_NO) order by A.LOAD_BKG_NO).extract('//text()').getClobVal(), 2)                       AS LOAD_BKG_NO" ).append("\n"); 
		query.append("                  ,  substr(xmlagg(xmlelement(a, DECODE(A.DEPARTURE_BKG_NO, '', '', ',') ||A.DEPARTURE_BKG_NO) order by A.DEPARTURE_BKG_NO).extract('//text()').getClobVal(), 2)                       AS DEPARTURE_BKG_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                  --,  substr(xmlagg(xmlelement(a, DECODE(A.IMDG_CLSS_CD, '', '', ',') ||A.IMDG_CLSS_CD) order by A.IMDG_CLSS_CD).extract('//text()').getClobVal(), 2) 						AS IMDG_CLSS_CD" ).append("\n"); 
		query.append("                  --,  substr(xmlagg(xmlelement(a, DECODE(A.IMDG_CLSS_CD_DESC, '', '', ',') ||A.IMDG_CLSS_CD_DESC) order by A.IMDG_CLSS_CD_DESC).extract('//text()').getClobVal(), 2) 		AS IMDG_CLSS_CD_DESC" ).append("\n"); 
		query.append("                  --,  substr(xmlagg(xmlelement(a, DECODE(A.IMDG_COMP_GRP_CD, '', '', ',') ||A.IMDG_COMP_GRP_CD) order by A.IMDG_COMP_GRP_CD).extract('//text()').getClobVal(), 2) 			AS IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("                  --,  substr(xmlagg(xmlelement(a, DECODE(A.IMDG_SUBS_RSK_LBL_CD, '', '', ',') ||A.IMDG_SUBS_RSK_LBL_CD) order by A.IMDG_SUBS_RSK_LBL_CD).extract('//text()').getClobVal(),2) AS IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("                  --,  substr(xmlagg(xmlelement(a, DECODE(A.IMDG_UN_NO, '', '', ',') ||A.IMDG_UN_NO) order by A.IMDG_UN_NO).extract('//text()').getClobVal(), 2) 							AS IMDG_UN_NO" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("                  ,  MAX(A.IMDG_PCK_GRP_CD) 		AS IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                  ,  MAX(A.CNTR_TP_CD) 				AS CNTR_TP_CD" ).append("\n"); 
		query.append("                  ,  MAX(A.ARR_DEP_PROHI_FLG) 		AS ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("                  ,  MAX(A.LDIS_APLY_TGT_FLG) 		AS LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("                  ,  NVL(MAX(A.ARR_MAX_LMT)	, 0)  	AS ARR_MAX_LMT" ).append("\n"); 
		query.append("                  ,  NVL(MAX(A.DCHG_MAX_LMT), 0) 	AS DCHG_MAX_LMT" ).append("\n"); 
		query.append("                  ,  NVL(MAX(A.LOD_MAX_LMT)	, 0)  	AS LOD_MAX_LMT" ).append("\n"); 
		query.append("                  ,  NVL(MAX(A.DEP_MAX_LMT)	, 0)  	AS DEP_MAX_LMT" ).append("\n"); 
		query.append("                  ,  NVL(SUM(A.ARR_CGO_WGT)	, 0)  	AS ARR_CGO_WGT" ).append("\n"); 
		query.append("                  ,  NVL(SUM(A.DCHG_CGO_WGT), 0) 	AS DCHG_CGO_WGT" ).append("\n"); 
		query.append("                  ,  NVL(SUM(A.LOD_CGO_WGT)	, 0)  	AS LOD_CGO_WGT" ).append("\n"); 
		query.append("                  ,  NVL(SUM(A.DEP_CGO_WGT)	, 0)  	AS DEP_CGO_WGT" ).append("\n"); 
		query.append("				  ,  PLMT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("            FROM     " ).append("\n"); 
		query.append("					(SELECT 	PORT_CD" ).append("\n"); 
		query.append("                          ,		PORT_LMT_SEQ" ).append("\n"); 
		query.append("                          ,		PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("                          ,		SLAN_CD" ).append("\n"); 
		query.append("                          ,		CUR_PORT_CD" ).append("\n"); 
		query.append("                          ,		PIER_TP_CD" ).append("\n"); 
		query.append("                          ,		VSL_CD" ).append("\n"); 
		query.append("						  ,     PLMT_VVD" ).append("\n"); 
		query.append("                          ,		IMDG_CLSS_CD " ).append("\n"); 
		query.append("                          ,		FLSH_PNT_TEMP" ).append("\n"); 
		query.append("                          ,		IMDG_CLSS_CD_DESC" ).append("\n"); 
		query.append("                          ,		LMT_WGT_TP_CD" ).append("\n"); 
		query.append("                          ,		IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("                          ,		IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                          ,		IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("                          ,		IMDG_UN_NO" ).append("\n"); 
		query.append("                          ,		CNTR_TP_CD" ).append("\n"); 
		query.append("                          ,		ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("                          ,		LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("                          ,		ARR_MAX_LMT" ).append("\n"); 
		query.append("                          ,		DCHG_MAX_LMT" ).append("\n"); 
		query.append("                          ,		LOD_MAX_LMT" ).append("\n"); 
		query.append("                          ,		DEP_MAX_LMT" ).append("\n"); 
		query.append("                          ,		ARR_CGO_WGT " ).append("\n"); 
		query.append("                          ,		DCHG_CGO_WGT" ).append("\n"); 
		query.append("                          ,		LOD_CGO_WGT " ).append("\n"); 
		query.append("                          ,		DEP_CGO_WGT " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                          ,    ARRIVAL_BKG_NO" ).append("\n"); 
		query.append("                          ,    DISCHARGE_BKG_NO" ).append("\n"); 
		query.append("                          ,    LOAD_BKG_NO" ).append("\n"); 
		query.append("                          ,    DEPARTURE_BKG_NO" ).append("\n"); 
		query.append("						  ,    PLMT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                      FROM 		(" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                      SELECT 	PORT_CD" ).append("\n"); 
		query.append("                          ,		PORT_LMT_SEQ" ).append("\n"); 
		query.append("                          ,		PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("                          ,		LMT_WGT_TP_CD" ).append("\n"); 
		query.append("                          ,		VSL_CD" ).append("\n"); 
		query.append("						  ,     PLMT_VVD" ).append("\n"); 
		query.append("                          ,		SLAN_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                          ,    	ARRIVAL_BKG_NO" ).append("\n"); 
		query.append("                          ,    	DISCHARGE_BKG_NO" ).append("\n"); 
		query.append("                          ,    	LOAD_BKG_NO" ).append("\n"); 
		query.append("                          ,    	DEPARTURE_BKG_NO" ).append("\n"); 
		query.append("                          		" ).append("\n"); 
		query.append("                          ,		MAX(CUR_PORT_CD)                                 			CUR_PORT_CD" ).append("\n"); 
		query.append("                          ,		MAX(PIER_TP_CD)                         				PIER_TP_CD" ).append("\n"); 
		query.append("                          ,		MAX(IMDG_CLSS_CD)                     					IMDG_CLSS_CD " ).append("\n"); 
		query.append("                          ,		MAX(FLSH_PNT_TEMP)                 						FLSH_PNT_TEMP" ).append("\n"); 
		query.append("                          ,		MAX(IMDG_CLSS_CD_DESC)         							IMDG_CLSS_CD_DESC" ).append("\n"); 
		query.append("                          ,		MAX(IMDG_COMP_GRP_CD)             						IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("                          ,		MAX(IMDG_PCK_GRP_CD)             						IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                          ,		MAX(IMDG_SUBS_RSK_LBL_CD)    							IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("                          ,		MAX(IMDG_UN_NO)                         				IMDG_UN_NO" ).append("\n"); 
		query.append("                          ,		MAX(CNTR_TP_CD)                         				CNTR_TP_CD" ).append("\n"); 
		query.append("                          ,		MAX(ARR_DEP_PROHI_FLG)       							ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("                          ,		MAX(LDIS_APLY_TGT_FLG)          						LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("                          ,		MAX(ARR_MAX_LMT)                      					ARR_MAX_LMT" ).append("\n"); 
		query.append("                          ,		MAX(DECODE(LDIS_APLY_TGT_FLG, 'N', '' ,DCHG_MAX_LMT))  	DCHG_MAX_LMT" ).append("\n"); 
		query.append("                          ,		MAX(DECODE(LDIS_APLY_TGT_FLG, 'N', '' ,LOD_MAX_LMT))    LOD_MAX_LMT" ).append("\n"); 
		query.append("                          ,		MAX(DEP_MAX_LMT)                      					DEP_MAX_LMT                          		" ).append("\n"); 
		query.append("                          ,		SUM(ARR_CGO_WGT) 										ARR_CGO_WGT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                          --,		DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '',  DECODE(MAX(DCHG_MAX_LMT), NULL, '', SUM(DCHG_CGO_WGT))) AS DCHG_CGO_WGT" ).append("\n"); 
		query.append("                          --,		DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '',  DECODE(MAX(LOD_MAX_LMT),  NULL, '', SUM(LOD_CGO_WGT)))  AS LOD_CGO_WGT" ).append("\n"); 
		query.append("                          ,		DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '',  SUM(DCHG_CGO_WGT)) AS DCHG_CGO_WGT" ).append("\n"); 
		query.append("                          ,		DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '',  SUM(LOD_CGO_WGT))  AS LOD_CGO_WGT" ).append("\n"); 
		query.append("                          ,		SUM(DEP_CGO_WGT) AS DEP_CGO_WGT" ).append("\n"); 
		query.append("                          		" ).append("\n"); 
		query.append("                          ,		DECODE(MAX(ARR_DEP_PROHI_FLG), 'Y', '', DECODE(SUM(ARR_CGO_WGT),0,'',NVL(ROUND( ((SUM(ARR_CGO_WGT)/  MAX(ARR_MAX_LMT))  * 100), 2), 0))) 	AS ARR_LMT_RTO" ).append("\n"); 
		query.append("                          ,		DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '', DECODE(SUM(DCHG_CGO_WGT),0,'',NVL(ROUND( ((SUM(DCHG_CGO_WGT)/ MAX(DCHG_MAX_LMT)) * 100), 2), 0))) 	AS DCHG_LMT_RTO" ).append("\n"); 
		query.append("                          ,		DECODE(MAX(LDIS_APLY_TGT_FLG), 'N', '', DECODE(SUM(LOD_CGO_WGT),0,'',NVL(ROUND( ((SUM(LOD_CGO_WGT)/  MAX(LOD_MAX_LMT))  * 100), 2), 0))) 	AS LOD_LMT_RTO" ).append("\n"); 
		query.append("                          ,		DECODE(MAX(ARR_DEP_PROHI_FLG), 'Y', '', DECODE(SUM(DEP_CGO_WGT),0,'',NVL(ROUND( ((SUM(DEP_CGO_WGT)/  MAX(DEP_MAX_LMT))  * 100), 2), 0))) 	AS DEP_LMT_RTO" ).append("\n"); 
		query.append("						  ,     PLMT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                      " ).append("\n"); 
		query.append("                      FROM 		" ).append("\n"); 
		query.append("                        (" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                        SELECT 	CASE WHEN PLMT.PORT_LMT_KND = '1ARRIVAL' THEN DCGO.BKG_NO" ).append("\n"); 
		query.append("                                      ELSE ''" ).append("\n"); 
		query.append("                                 END  AS ARRIVAL_BKG_NO" ).append("\n"); 
		query.append("                            ,    CASE WHEN PLMT.PORT_LMT_KND = '2DISCHARGE' THEN DCGO.BKG_NO" ).append("\n"); 
		query.append("                                      ELSE ''" ).append("\n"); 
		query.append("                                 END  AS DISCHARGE_BKG_NO" ).append("\n"); 
		query.append("                            ,    CASE WHEN PLMT.PORT_LMT_KND = '3LOAD' THEN DCGO.BKG_NO" ).append("\n"); 
		query.append("                                      ELSE ''" ).append("\n"); 
		query.append("                                 END  AS LOAD_BKG_NO" ).append("\n"); 
		query.append("                            ,    CASE WHEN PLMT.PORT_LMT_KND = '4DEPARTURE' THEN DCGO.BKG_NO" ).append("\n"); 
		query.append("                                      ELSE ''" ).append("\n"); 
		query.append("                                 END  AS DEPARTURE_BKG_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                          	,	DCGO.SLAN_CD --PLMT.SLAN_CD," ).append("\n"); 
		query.append("                          	,	DCGO.CUR_PORT_CD --PLMT.UN_LOC_CD," ).append("\n"); 
		query.append("                          	,	PLMT.PIER_TP_CD " ).append("\n"); 
		query.append("                          	,	PLMT.PORT_CD" ).append("\n"); 
		query.append("                          	,	PLMT.PORT_LMT_SEQ" ).append("\n"); 
		query.append("                          	,	DCGO.POL_CD AS POL_CD" ).append("\n"); 
		query.append("                          	,	DCGO.POD_CD AS POD_CD" ).append("\n"); 
		query.append("                          	,	DCGO.VSL_CD							" ).append("\n"); 
		query.append("							,	DECODE(SUBSTR(DCGO.VVD,1,5) , SUBSTR(DCGO.VVD,6,10), SUBSTR(DCGO.VVD,1,5) , SUBSTR(DCGO.VVD,1,5)||'/'||SUBSTR(DCGO.VVD,6,10)) AS PLMT_VVD " ).append("\n"); 
		query.append("                          	,	DECODE(PLMT.LMT_WGT_TP_CD, 'GR', 'GROSS', 'NT', 'NET', 'NP', 'NET POWDER') 	AS LMT_WGT_TP_CD" ).append("\n"); 
		query.append("                          	,	PLMT.IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("                          	,	PLMT.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                          	,	PLMT.IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("                          	,	PLMT.IMDG_UN_NO" ).append("\n"); 
		query.append("                          	,	PLMT.CNTR_TP_CD" ).append("\n"); 
		query.append("                          	,	PLMT.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                          	,	PLMT.FLSH_PNT_TEMP" ).append("\n"); 
		query.append("                          	,	DCGO.FLSH_PNT_CDO_TEMP" ).append("\n"); 
		query.append("                          	,  (SELECT 	SICC.IMDG_CLSS_CD_DESC" ).append("\n"); 
		query.append("                          		FROM 	SCG_IMDG_CLSS_CD 		SICC" ).append("\n"); 
		query.append("                          		WHERE 	1 = 1" ).append("\n"); 
		query.append("                          		AND 	SICC.IMDG_CLSS_CD 		= PLMT.IMDG_CLSS_CD" ).append("\n"); 
		query.append("								) 																			AS IMDG_CLSS_CD_DESC" ).append("\n"); 
		query.append("                          	,	PLMT.PORT_LMT_KND" ).append("\n"); 
		query.append("							,	PLMT.PORT_LMT_REP_DESC, LDIS_APLY_TGT_FLG, ARR_DEP_PROHI_FLG 				-- :2016-04-16:--" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                          		--------------------------" ).append("\n"); 
		query.append("                          	,	DECODE(PLMT.PORT_LMT_KND, DCGO.PORT_LMT_KND," ).append("\n"); 
		query.append("                          				NVL(DECODE(PLMT.LMT_WGT_TP_CD, 'NT', DCGO.ARR_NET_WGT, 'NP', DCGO.ARR_NET_EXPLO_WGT, 'GR', DCGO.ARR_GRS_WGT), 0), 0) 	AS ARR_CGO_WGT" ).append("\n"); 
		query.append("                          	,	DECODE(PLMT.PORT_LMT_KND, DCGO.PORT_LMT_KND," ).append("\n"); 
		query.append("                          				NVL(DECODE(PLMT.LMT_WGT_TP_CD,'NT', DCGO.DCHG_NET_WGT,'NP', DCGO.DCHG_NET_EXPLO_WGT,'GR', DCGO.DCHG_GRS_WGT), 0), 0) 	AS DCHG_CGO_WGT" ).append("\n"); 
		query.append("                          	,	DECODE(PLMT.PORT_LMT_KND, DCGO.PORT_LMT_KND," ).append("\n"); 
		query.append("                          				NVL(DECODE(PLMT.LMT_WGT_TP_CD, 'NT', DCGO.LOD_NET_WGT, 'NP', DCGO.LOD_NET_EXPLO_WGT, 'GR', DCGO.LOD_GRS_WGT), 0), 0) 	AS LOD_CGO_WGT" ).append("\n"); 
		query.append("                          	,	DECODE(PLMT.PORT_LMT_KND, DCGO.PORT_LMT_KND," ).append("\n"); 
		query.append("                          				NVL(DECODE(PLMT.LMT_WGT_TP_CD, 'NT', DCGO.DEP_NET_WGT, 'NP', DCGO.DEP_NET_EXPLO_WGT, 'GR', DCGO.DEP_GRS_WGT), 0), 0) 	AS DEP_CGO_WGT" ).append("\n"); 
		query.append("                          	,	PLMT.ARR_MAX_QTY   				AS ARR_MAX_LMT" ).append("\n"); 
		query.append("                          	,	PLMT.DCHG_MAX_QTY 				AS DCHG_MAX_LMT" ).append("\n"); 
		query.append("                          	,	PLMT.LOD_MAX_QTY   				AS LOD_MAX_LMT" ).append("\n"); 
		query.append("                          	,	PLMT.DEP_MAX_QTY   				AS DEP_MAX_LMT" ).append("\n"); 
		query.append("                          	,	DECODE(PLMT.PPT_EXPLO_FLG, 'Y', 'Explosive ', '')||DECODE(PLMT.PPT_PROHI_FLG, 'Y', 'Prohibited', '') 							AS PPT_FLG_RMK" ).append("\n"); 
		query.append("							,   DCGO.CLPT_IND_SEQ AS PLMT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                        " ).append("\n"); 
		query.append("                          FROM (" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                        --=================== START OF UNION ALL STATEMENT ==================================================" ).append("\n"); 
		query.append("                           		SELECT  	PORT_CD" ).append("\n"); 
		query.append("										, 	PORT_LMT_SEQ" ).append("\n"); 
		query.append("										,	IMDG_CLSS_CD" ).append("\n"); 
		query.append("										, 	FLSH_PNT_TEMP" ).append("\n"); 
		query.append("										,	LMT_WGT_TP_CD" ).append("\n"); 
		query.append("										, 	IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("										,	IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("										, 	IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("										,	IMDG_UN_NO" ).append("\n"); 
		query.append("										, 	CNTR_TP_CD" ).append("\n"); 
		query.append("										,	PIER_TP_CD" ).append("\n"); 
		query.append("										,	'1ARRIVAL' 					AS PORT_LMT_KND" ).append("\n"); 
		query.append("										,	ARR_MAX_QTY" ).append("\n"); 
		query.append("										, 	DCHG_MAX_QTY" ).append("\n"); 
		query.append("										, 	LOD_MAX_QTY" ).append("\n"); 
		query.append("										, 	DEP_MAX_QTY" ).append("\n"); 
		query.append("										,	PPT_EXPLO_FLG" ).append("\n"); 
		query.append("										, 	PPT_PROHI_FLG" ).append("\n"); 
		query.append("										, 	PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("										,	ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("										, 	LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("                              FROM  		(" ).append("\n"); 
		query.append("                                      SELECT      A.PIER_TP_CD" ).append("\n"); 
		query.append("                                               ,  A.PORT_CD" ).append("\n"); 
		query.append("                                               ,  A.PORT_LMT_SEQ" ).append("\n"); 
		query.append("                                               ,  A.FLSH_PNT_TEMP" ).append("\n"); 
		query.append("                                               ,  A.LMT_WGT_TP_CD" ).append("\n"); 
		query.append("                                               ,  A.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                                               ,  E.IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("                                               ,  A.CNTR_TP_CD" ).append("\n"); 
		query.append("                                               ,  B.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                               ,  C.IMDG_COMP_GRP_CD " ).append("\n"); 
		query.append("                                               ,  D.IMDG_UN_NO" ).append("\n"); 
		query.append("                                               ,  DECODE(A.ARR_MAX_QTY	, 0, null, A.ARR_MAX_QTY	)	AS ARR_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  DECODE(A.DCHG_MAX_QTY	, 0, null, A.DCHG_MAX_QTY	)   AS DCHG_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  DECODE(A.LOD_MAX_QTY	, 0, null, A.LOD_MAX_QTY	)   AS LOD_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  DECODE(A.DEP_MAX_QTY	, 0, null, A.DEP_MAX_QTY	)   AS DEP_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  A.PPT_EXPLO_FLG" ).append("\n"); 
		query.append("                                               ,  A.PPT_PROHI_FLG" ).append("\n"); 
		query.append("                                               ,  A.PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("                                               ,  A.ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("                                               ,  A.LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("                                          FROM    SCG_IMDG_PORT_LMT_MST          A" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_CLSS_CD      B" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_COMP_GRP     C" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_UN_NO        D" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_SUBS_RSK     E" ).append("\n"); 
		query.append("                                         WHERE    1 = 1" ).append("\n"); 
		query.append("										 AND	  A.PORT_CD						 = @[plmt_port_cd]" ).append("\n"); 
		query.append("										 AND	  A.PORT_CD                      = B.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_LMT_SEQ                 = B.PORT_LMT_SEQ	(+)" ).append("\n"); 
		query.append("                                         AND      B.PORT_CD                      = C.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      B.PORT_LMT_SEQ                 = C.PORT_LMT_SEQ	(+)" ).append("\n"); 
		query.append("										 AND      B.IMDG_CLSS_CD                 = C.IMDG_CLSS_CD   (+) /* 2016-04-21 */" ).append("\n"); 
		query.append("                                         AND      A.PORT_CD                      = D.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_LMT_SEQ                 = D.PORT_LMT_SEQ	(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_CD                      = E.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_LMT_SEQ                 = E.PORT_LMT_SEQ	(+) " ).append("\n"); 
		query.append("                                       	)" ).append("\n"); 
		query.append("                  " ).append("\n"); 
		query.append("                           		UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                           		SELECT  	PORT_CD" ).append("\n"); 
		query.append("										, 	PORT_LMT_SEQ" ).append("\n"); 
		query.append("										,	IMDG_CLSS_CD" ).append("\n"); 
		query.append("										, 	FLSH_PNT_TEMP" ).append("\n"); 
		query.append("										,	LMT_WGT_TP_CD" ).append("\n"); 
		query.append("										, 	IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("										,	IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("										, 	IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("										,	IMDG_UN_NO" ).append("\n"); 
		query.append("										, 	CNTR_TP_CD" ).append("\n"); 
		query.append("										,	PIER_TP_CD" ).append("\n"); 
		query.append("										,	'2DISCHARGE' 					AS PORT_LMT_KND" ).append("\n"); 
		query.append("										,	ARR_MAX_QTY" ).append("\n"); 
		query.append("										, 	DCHG_MAX_QTY" ).append("\n"); 
		query.append("										, 	LOD_MAX_QTY" ).append("\n"); 
		query.append("										, 	DEP_MAX_QTY" ).append("\n"); 
		query.append("										,	PPT_EXPLO_FLG" ).append("\n"); 
		query.append("										, 	PPT_PROHI_FLG" ).append("\n"); 
		query.append("										, 	PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("										,	ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("										, 	LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("                              FROM  		(" ).append("\n"); 
		query.append("                                      SELECT      A.PIER_TP_CD" ).append("\n"); 
		query.append("                                               ,  A.PORT_CD" ).append("\n"); 
		query.append("                                               ,  A.PORT_LMT_SEQ" ).append("\n"); 
		query.append("                                               ,  A.FLSH_PNT_TEMP" ).append("\n"); 
		query.append("                                               ,  A.LMT_WGT_TP_CD" ).append("\n"); 
		query.append("                                               ,  A.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                                               ,  E.IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("                                               ,  A.CNTR_TP_CD" ).append("\n"); 
		query.append("                                               ,  B.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                               ,  C.IMDG_COMP_GRP_CD " ).append("\n"); 
		query.append("                                               ,  D.IMDG_UN_NO" ).append("\n"); 
		query.append("                                               ,  DECODE(A.ARR_MAX_QTY	, 0, null, A.ARR_MAX_QTY	)	AS ARR_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  DECODE(A.DCHG_MAX_QTY	, 0, null, A.DCHG_MAX_QTY	)   AS DCHG_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  DECODE(A.LOD_MAX_QTY	, 0, null, A.LOD_MAX_QTY	)   AS LOD_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  DECODE(A.DEP_MAX_QTY	, 0, null, A.DEP_MAX_QTY	)   AS DEP_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  A.PPT_EXPLO_FLG" ).append("\n"); 
		query.append("                                               ,  A.PPT_PROHI_FLG" ).append("\n"); 
		query.append("                                               ,  A.PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("                                               ,  A.ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("                                               ,  A.LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("                                          FROM    SCG_IMDG_PORT_LMT_MST          A" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_CLSS_CD      B" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_COMP_GRP     C" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_UN_NO        D" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_SUBS_RSK     E" ).append("\n"); 
		query.append("                                         WHERE    1 = 1" ).append("\n"); 
		query.append("										 AND	  A.PORT_CD						 = @[plmt_port_cd]" ).append("\n"); 
		query.append("										 AND	  A.PORT_CD                      = B.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_LMT_SEQ                 = B.PORT_LMT_SEQ	(+)" ).append("\n"); 
		query.append("                                         AND      B.PORT_CD                      = C.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      B.PORT_LMT_SEQ                 = C.PORT_LMT_SEQ	(+)" ).append("\n"); 
		query.append("										 AND      B.IMDG_CLSS_CD                 = C.IMDG_CLSS_CD   (+) /* 2016-04-21 */" ).append("\n"); 
		query.append("                                         AND      A.PORT_CD                      = D.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_LMT_SEQ                 = D.PORT_LMT_SEQ	(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_CD                      = E.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_LMT_SEQ                 = E.PORT_LMT_SEQ	(+) " ).append("\n"); 
		query.append("                                       	)" ).append("\n"); 
		query.append("                  " ).append("\n"); 
		query.append("                           		UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                           		SELECT  	PORT_CD" ).append("\n"); 
		query.append("										, 	PORT_LMT_SEQ" ).append("\n"); 
		query.append("										,	IMDG_CLSS_CD" ).append("\n"); 
		query.append("										, 	FLSH_PNT_TEMP" ).append("\n"); 
		query.append("										,	LMT_WGT_TP_CD" ).append("\n"); 
		query.append("										, 	IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("										,	IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("										, 	IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("										,	IMDG_UN_NO" ).append("\n"); 
		query.append("										, 	CNTR_TP_CD" ).append("\n"); 
		query.append("										,	PIER_TP_CD" ).append("\n"); 
		query.append("										,	'3LOAD' 					AS PORT_LMT_KND" ).append("\n"); 
		query.append("										,	ARR_MAX_QTY" ).append("\n"); 
		query.append("										, 	DCHG_MAX_QTY" ).append("\n"); 
		query.append("										, 	LOD_MAX_QTY" ).append("\n"); 
		query.append("										, 	DEP_MAX_QTY" ).append("\n"); 
		query.append("										,	PPT_EXPLO_FLG" ).append("\n"); 
		query.append("										, 	PPT_PROHI_FLG" ).append("\n"); 
		query.append("										, 	PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("										,	ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("										, 	LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("                              FROM  		(" ).append("\n"); 
		query.append("                                      SELECT      A.PIER_TP_CD" ).append("\n"); 
		query.append("                                               ,  A.PORT_CD" ).append("\n"); 
		query.append("                                               ,  A.PORT_LMT_SEQ" ).append("\n"); 
		query.append("                                               ,  A.FLSH_PNT_TEMP" ).append("\n"); 
		query.append("                                               ,  A.LMT_WGT_TP_CD" ).append("\n"); 
		query.append("                                               ,  A.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                                               ,  E.IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("                                               ,  A.CNTR_TP_CD" ).append("\n"); 
		query.append("                                               ,  B.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                               ,  C.IMDG_COMP_GRP_CD " ).append("\n"); 
		query.append("                                               ,  D.IMDG_UN_NO" ).append("\n"); 
		query.append("                                               ,  DECODE(A.ARR_MAX_QTY	, 0, null, A.ARR_MAX_QTY	)	AS ARR_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  DECODE(A.DCHG_MAX_QTY	, 0, null, A.DCHG_MAX_QTY	)   AS DCHG_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  DECODE(A.LOD_MAX_QTY	, 0, null, A.LOD_MAX_QTY	)   AS LOD_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  DECODE(A.DEP_MAX_QTY	, 0, null, A.DEP_MAX_QTY	)   AS DEP_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  A.PPT_EXPLO_FLG" ).append("\n"); 
		query.append("                                               ,  A.PPT_PROHI_FLG" ).append("\n"); 
		query.append("                                               ,  A.PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("                                               ,  A.ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("                                               ,  A.LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("                                          FROM    SCG_IMDG_PORT_LMT_MST          A" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_CLSS_CD      B" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_COMP_GRP     C" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_UN_NO        D" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_SUBS_RSK     E" ).append("\n"); 
		query.append("                                         WHERE    1 = 1" ).append("\n"); 
		query.append("										 AND	  A.PORT_CD						 = @[plmt_port_cd]" ).append("\n"); 
		query.append("										 AND	  A.PORT_CD                      = B.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_LMT_SEQ                 = B.PORT_LMT_SEQ	(+)" ).append("\n"); 
		query.append("                                         AND      B.PORT_CD                      = C.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      B.PORT_LMT_SEQ                 = C.PORT_LMT_SEQ	(+)" ).append("\n"); 
		query.append("										 AND      B.IMDG_CLSS_CD                 = C.IMDG_CLSS_CD   (+) /* 2016-04-21 */" ).append("\n"); 
		query.append("                                         AND      A.PORT_CD                      = D.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_LMT_SEQ                 = D.PORT_LMT_SEQ	(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_CD                      = E.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_LMT_SEQ                 = E.PORT_LMT_SEQ	(+) " ).append("\n"); 
		query.append("                                       	)" ).append("\n"); 
		query.append("                  " ).append("\n"); 
		query.append("                  " ).append("\n"); 
		query.append("                           		UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                           		SELECT  	PORT_CD" ).append("\n"); 
		query.append("										, 	PORT_LMT_SEQ" ).append("\n"); 
		query.append("										,	IMDG_CLSS_CD" ).append("\n"); 
		query.append("										, 	FLSH_PNT_TEMP" ).append("\n"); 
		query.append("										,	LMT_WGT_TP_CD" ).append("\n"); 
		query.append("										, 	IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("										,	IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("										, 	IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("										,	IMDG_UN_NO" ).append("\n"); 
		query.append("										, 	CNTR_TP_CD" ).append("\n"); 
		query.append("										,	PIER_TP_CD" ).append("\n"); 
		query.append("										,	'4DEPARTURE' 					AS PORT_LMT_KND" ).append("\n"); 
		query.append("										,	ARR_MAX_QTY" ).append("\n"); 
		query.append("										, 	DCHG_MAX_QTY" ).append("\n"); 
		query.append("										, 	LOD_MAX_QTY" ).append("\n"); 
		query.append("										, 	DEP_MAX_QTY" ).append("\n"); 
		query.append("										,	PPT_EXPLO_FLG" ).append("\n"); 
		query.append("										, 	PPT_PROHI_FLG" ).append("\n"); 
		query.append("										, 	PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("										,	ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("										, 	LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("                              FROM  		(" ).append("\n"); 
		query.append("                                      SELECT      A.PIER_TP_CD" ).append("\n"); 
		query.append("                                               ,  A.PORT_CD" ).append("\n"); 
		query.append("                                               ,  A.PORT_LMT_SEQ" ).append("\n"); 
		query.append("                                               ,  A.FLSH_PNT_TEMP" ).append("\n"); 
		query.append("                                               ,  A.LMT_WGT_TP_CD" ).append("\n"); 
		query.append("                                               ,  A.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                                               ,  E.IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("                                               ,  A.CNTR_TP_CD" ).append("\n"); 
		query.append("                                               ,  B.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                               ,  C.IMDG_COMP_GRP_CD " ).append("\n"); 
		query.append("                                               ,  D.IMDG_UN_NO" ).append("\n"); 
		query.append("                                               ,  DECODE(A.ARR_MAX_QTY	, 0, null, A.ARR_MAX_QTY	)	AS ARR_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  DECODE(A.DCHG_MAX_QTY	, 0, null, A.DCHG_MAX_QTY	)   AS DCHG_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  DECODE(A.LOD_MAX_QTY	, 0, null, A.LOD_MAX_QTY	)   AS LOD_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  DECODE(A.DEP_MAX_QTY	, 0, null, A.DEP_MAX_QTY	)   AS DEP_MAX_QTY" ).append("\n"); 
		query.append("                                               ,  A.PPT_EXPLO_FLG" ).append("\n"); 
		query.append("                                               ,  A.PPT_PROHI_FLG" ).append("\n"); 
		query.append("                                               ,  A.PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("                                               ,  A.ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("                                               ,  A.LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("                                          FROM    SCG_IMDG_PORT_LMT_MST          A" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_CLSS_CD      B" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_COMP_GRP     C" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_UN_NO        D" ).append("\n"); 
		query.append("                                               ,  SCG_IMDG_PORT_LMT_SUBS_RSK     E" ).append("\n"); 
		query.append("                                         WHERE    1 = 1" ).append("\n"); 
		query.append("										 AND	  A.PORT_CD						 = @[plmt_port_cd]" ).append("\n"); 
		query.append("										 AND	  A.PORT_CD                      = B.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_LMT_SEQ                 = B.PORT_LMT_SEQ	(+)" ).append("\n"); 
		query.append("                                         AND      B.PORT_CD                      = C.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      B.PORT_LMT_SEQ                 = C.PORT_LMT_SEQ	(+)" ).append("\n"); 
		query.append("										 AND      B.IMDG_CLSS_CD                 = C.IMDG_CLSS_CD   (+) /* 2016-04-21 */" ).append("\n"); 
		query.append("                                         AND      A.PORT_CD                      = D.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_LMT_SEQ                 = D.PORT_LMT_SEQ	(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_CD                      = E.PORT_CD		(+)" ).append("\n"); 
		query.append("                                         AND      A.PORT_LMT_SEQ                 = E.PORT_LMT_SEQ	(+) " ).append("\n"); 
		query.append("                                       	)" ).append("\n"); 
		query.append("                                                                         " ).append("\n"); 
		query.append("                        --=================== END OF UNION ALL STATEMENT ==================================================  " ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                    ) PLMT," ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("            --*************************************************************************************************************" ).append("\n"); 
		query.append("            --2016-04-13 START" ).append("\n"); 
		query.append("            --*************************************************************************************************************" ).append("\n"); 
		query.append("                   (" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                      SELECT SLAN_CD, VSL_CD, VVD,  CUR_PORT_CD, CLPT_IND_SEQ, POL_CD, POD_CD, WGT_UT_CD, IMDG_CLSS_CD, FLSH_PNT_CDO_TEMP, PORT_LMT_KND, VPS_ETA_DT,IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                             IMDG_COMP_GRP_CD, IMDG_UN_NO, IMDG_UN_NO_SEQ, CNTR_TP_CD,IMDG_SUBS_RSK_LBL_CD1, IMDG_SUBS_RSK_LBL_CD2, IMDG_SUBS_RSK_LBL_CD3, IMDG_SUBS_RSK_LBL_CD4, BKG_NO," ).append("\n"); 
		query.append("                             ------------------------" ).append("\n"); 
		query.append("                             SUM(ARR_NET_WGT) AS ARR_NET_WGT, SUM(ARR_GRS_WGT) AS ARR_GRS_WGT, SUM(ARR_NET_EXPLO_WGT) AS ARR_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                             SUM(DCHG_NET_WGT) AS DCHG_NET_WGT, SUM(DCHG_GRS_WGT) AS DCHG_GRS_WGT, SUM(DCHG_NET_EXPLO_WGT) AS DCHG_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                             SUM(LOD_NET_WGT) AS LOD_NET_WGT, SUM(LOD_GRS_WGT) AS LOD_GRS_WGT, SUM(LOD_NET_EXPLO_WGT) AS LOD_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                             SUM(DEP_NET_WGT) AS DEP_NET_WGT, SUM(DEP_GRS_WGT) AS DEP_GRS_WGT, SUM(DEP_NET_EXPLO_WGT) AS DEP_NET_EXPLO_WGT" ).append("\n"); 
		query.append("                        FROM (" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                    SELECT BKG_NO,DCGO_SEQ,SLAN_CD,VSL_CD,VVD,CUR_PORT_CD,CLPT_IND_SEQ,POL_CD,POD_CD,WGT_UT_CD,IMDG_CLSS_CD,FLSH_PNT_CDO_TEMP, IMDG_COMP_GRP_CD, IMDG_UN_NO,IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                     CNTR_TP_CD,IMDG_SUBS_RSK_LBL_CD1,IMDG_SUBS_RSK_LBL_CD2,IMDG_SUBS_RSK_LBL_CD3,IMDG_SUBS_RSK_LBL_CD4,ARR_NET_WGT,ARR_GRS_WGT,ARR_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                     DCHG_NET_WGT,DCHG_GRS_WGT,DCHG_NET_EXPLO_WGT,LOD_NET_WGT,LOD_GRS_WGT,LOD_NET_EXPLO_WGT,DEP_NET_WGT,DEP_GRS_WGT,DEP_NET_EXPLO_WGT,VPS_ETA_DT,IMDG_PCK_GRP_CD,PORT_LMT_KND" ).append("\n"); 
		query.append("                                      FROM" ).append("\n"); 
		query.append("                                          (" ).append("\n"); 
		query.append("                                          " ).append("\n"); 
		query.append("            --ARRIVAL SELECT 2016-04-13 START  " ).append("\n"); 
		query.append("                                      SELECT   A.BKG_NO" ).append("\n"); 
		query.append("											,  A.DCGO_SEQ," ).append("\n"); 
		query.append("                                               A.SLAN_CD," ).append("\n"); 
		query.append("                                               A.VSL_CD," ).append("\n"); 
		query.append("											   A.VVD," ).append("\n"); 
		query.append("                                               A.CUR_PORT_CD," ).append("\n"); 
		query.append("                                               A.CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                               A.POL_CD," ).append("\n"); 
		query.append(" 											   A.POL_CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                               A.POD_CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                               A.POD_CD," ).append("\n"); 
		query.append("                                               A.WGT_UT_CD," ).append("\n"); 
		query.append("                                               A.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                               A.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                               A.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                               A.IMDG_UN_NO," ).append("\n"); 
		query.append("                                               A.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                               A.CNTR_TP_CD," ).append("\n"); 
		query.append("                                               A.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                               A.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                               A.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                               A.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                               ---------------------------------" ).append("\n"); 
		query.append("                                                NET_WGT AS ARR_NET_WGT, GRS_WGT AS ARR_GRS_WGT, NET_EXPLO_WGT AS ARR_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                0 AS DCHG_NET_WGT, 0 AS DCHG_GRS_WGT, 0 AS DCHG_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                0 AS LOD_NET_WGT, 0 AS LOD_GRS_WGT, 0 AS LOD_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                0 AS DEP_NET_WGT, 0 AS DEP_GRS_WGT, 0 AS DEP_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                               A.VPS_ETA_DT, A.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                               '1ARRIVAL' PORT_LMT_KND" ).append("\n"); 
		query.append("                                      FROM (" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("													SELECT	A.BKG_NO               " ).append("\n"); 
		query.append("														,	A.DCGO_SEQ             " ).append("\n"); 
		query.append("														,	A.SLAN_CD              " ).append("\n"); 
		query.append("														,	A.VSL_CD    " ).append("\n"); 
		query.append("														,   A.VVD          " ).append("\n"); 
		query.append("       													,	A.CUR_PORT_CD" ).append("\n"); 
		query.append("                                                        ,   A.CLPT_IND_SEQ" ).append("\n"); 
		query.append("														,	A.CUR_PORT_MAX_SEQ     " ).append("\n"); 
		query.append("														,	A.CUR_PORT_MIN_SEQ     " ).append("\n"); 
		query.append("														,	A.POL_CD" ).append("\n"); 
		query.append(" 														,   A.POL_CLPT_IND_SEQ           " ).append("\n"); 
		query.append("														,	A.BKG_POL_SEQ          " ).append("\n"); 
		query.append("														,	A.POD_CD" ).append("\n"); 
		query.append("                                                        ,   A.POD_CLPT_IND_SEQ                   " ).append("\n"); 
		query.append("														,	A.BKG_POD_SEQ          " ).append("\n"); 
		query.append("														,	A.WGT_UT_CD            " ).append("\n"); 
		query.append("														,	A.IMDG_CLSS_CD         " ).append("\n"); 
		query.append("														,	A.FLSH_PNT_CDO_TEMP    " ).append("\n"); 
		query.append("														,	A.IMDG_COMP_GRP_CD     " ).append("\n"); 
		query.append("														,	A.IMDG_UN_NO           " ).append("\n"); 
		query.append("														,	A.IMDG_UN_NO_SEQ       " ).append("\n"); 
		query.append("														,	A.CNTR_TP_CD           " ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD1" ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD2" ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD3" ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD4" ).append("\n"); 
		query.append("														,	A.NET_WGT,A.GRS_WGT" ).append("\n"); 
		query.append("														,	A.NET_EXPLO_WGT    " ).append("\n"); 
		query.append("														,	A.VPS_ETA_DT       " ).append("\n"); 
		query.append("														,	A.IMDG_PCK_GRP_CD  " ).append("\n"); 
		query.append("													FROM	(" ).append("\n"); 
		query.append("													        " ).append("\n"); 
		query.append("                                                    SELECT 	A.BKG_NO" ).append("\n"); 
		query.append("                                                    	,	A.DCGO_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.SLAN_CD" ).append("\n"); 
		query.append("                                                    	,	A.VSL_CD" ).append("\n"); 
		query.append("														,   A.VVD" ).append("\n"); 
		query.append("                                                    	,	A.CUR_PORT_CD" ).append("\n"); 
		query.append("                                                        ,   A.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.CUR_PORT_MAX_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.CUR_PORT_MIN_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.POL_CD" ).append("\n"); 
		query.append("                                                        ,   A.POL_CLPT_IND_SEQ   " ).append("\n"); 
		query.append("                                                    	,	A.BKG_POL_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.POD_CD" ).append("\n"); 
		query.append("                                                        ,   A.POD_CLPT_IND_SEQ    " ).append("\n"); 
		query.append("                                                    	,	A.BKG_POD_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.WGT_UT_CD" ).append("\n"); 
		query.append("                                                    	,	A.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                                    	,	A.FLSH_PNT_CDO_TEMP" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_UN_NO" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_UN_NO_SEQ" ).append("\n"); 
		query.append("                                                      ,  A.CNTR_TP_CD" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD1" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD2" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD3" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD4" ).append("\n"); 
		query.append("                                                      ,  A.NET_WGT,A.GRS_WGT" ).append("\n"); 
		query.append("                                                      ,  A.NET_EXPLO_WGT" ).append("\n"); 
		query.append("                                                      ,  A.VPS_ETA_DT" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                                                      ,  ROW_NUMBER() OVER (PARTITION BY NVL(G.BKG_NO,A.BKG_NO), NVL(G.SPCL_CGO_APRO_RQST_SEQ,A.SPCL_CGO_APRO_RQST_SEQ), NVL(G.VSL_PRE_PST_CD,A.VSL_PRE_PST_CD), NVL(G.VSL_SEQ,A.VSL_SEQ), NVL(G.DCGO_SEQ,A.DCGO_SEQ) ORDER BY G.DCGO_SEQ ASC) CORR_AUTH_SEQ" ).append("\n"); 
		query.append("                                                      " ).append("\n"); 
		query.append("                                                      FROM" ).append("\n"); 
		query.append("                                                             (" ).append("\n"); 
		query.append("                                                -- Own BKG`s SPCL CGO Info" ).append("\n"); 
		query.append("                                                SELECT 		SDC.BKG_NO" ).append("\n"); 
		query.append("														,	SDC.SPCL_CGO_APRO_CD," ).append("\n"); 
		query.append("                                                           SDC.DCGO_SEQ," ).append("\n"); 
		query.append("                                                           VVPS.SLAN_CD," ).append("\n"); 
		query.append("                                                           VVPS.VSL_CD," ).append("\n"); 
		query.append("														  (SELECT " ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| " ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||" ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||" ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD" ).append("\n"); 
		query.append("                                                           FROM VSK_VSL_PORT_SKD " ).append("\n"); 
		query.append("                                                           WHERE VSL_CD = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                           AND   SKD_VOY_NO = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                           AND   SKD_DIR_CD = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                           AND   VPS_PORT_CD = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                           AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                           ) AS VVD,		" ).append("\n"); 
		query.append("                                                          " ).append("\n"); 
		query.append("                                                           @[plmt_port_cd]  AS CUR_PORT_CD," ).append("\n"); 
		query.append("                                                           VVPS.CLPT_IND_SEQ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                           (SELECT MAX(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MAX_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT MIN(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                                AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MIN_SEQ,                                                   " ).append("\n"); 
		query.append("                                                           SVAR.POL_CD," ).append("\n"); 
		query.append("	                                                       SVAR.POL_CLPT_IND_SEQ,    " ).append("\n"); 
		query.append("                                                           (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.CLPT_IND_SEQ = BVD.POL_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  = BVD.POL_CD" ).append("\n"); 
		query.append("                                                               ) AS BKG_POL_SEQ," ).append("\n"); 
		query.append("                                                            SVAR.POD_CD," ).append("\n"); 
		query.append("															SVAR.POD_CLPT_IND_SEQ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("                                                               (" ).append("\n"); 
		query.append("                                                               SELECT   T1.CLPT_SEQ" ).append("\n"); 
		query.append("                                                               FROM     VSK_VSL_PORT_SKD             T1" ).append("\n"); 
		query.append("                                                               WHERE    T1.VSL_CD                    = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_VOY_NO                = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_DIR_CD                = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               AND      T1.VPS_PORT_CD               = BVD.POD_CD" ).append("\n"); 
		query.append("                                                               AND      T1.CLPT_IND_SEQ              = BVD.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                               )    AS BKG_POD_SEQ," ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                           NVL(SDC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                                           SDC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                                           SDC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                                           SDC.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                                           SDC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                                           SDC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                                           SUBSTR(SDC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_WGT), SDC.NET_WGT) AS NET_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.GRS_WGT), SDC.GRS_WGT) AS GRS_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_EXPLO_WGT), SDC.NET_EXPLO_WGT) AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                           VVPS.VPS_ETA_DT, SDC.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                                           SVAR.VSL_PRE_PST_CD, SVAR.VSL_SEQ  , SAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                                  FROM BKG_DG_CGO        SDC," ).append("\n"); 
		query.append("                                                       SCG_APRO_RQST     SAR," ).append("\n"); 
		query.append("                                                       SCG_VVD_APRO_RQST SVAR," ).append("\n"); 
		query.append("                                                       BKG_VVD           BVD," ).append("\n"); 
		query.append("                                                       VSK_VSL_PORT_SKD  VVPS" ).append("\n"); 
		query.append("                                                  WHERE 1 = 1" ).append("\n"); 
		query.append("                                                   AND SDC.BKG_NO                 = SAR.BKG_NO" ).append("\n"); 
		query.append("                                                   AND SAR.BKG_NO                 = SVAR.BKG_NO" ).append("\n"); 
		query.append("                                                   AND SAR.SPCL_CGO_APRO_RQST_SEQ = SVAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("												   -- BDR 이후 POST VVD만 Request오는 경우 고려, LST_RQST_DAT_FLG='Y' 조건 대신 적용" ).append("\n"); 
		query.append("                                                   AND SVAR.SPCL_CGO_APRO_RQST_SEQ = (SELECT MAX(RV.SPCL_CGO_APRO_RQST_SEQ) " ).append("\n"); 
		query.append("                                                                            			FROM SCG_VVD_APRO_RQST RV," ).append("\n"); 
		query.append("                                                                                             SCG_APRO_RQST RV2" ).append("\n"); 
		query.append("                                                                                     	WHERE RV.VSL_CD = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                                                     	AND   RV.SKD_VOY_NO = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                                                     	AND   RV.SKD_DIR_CD = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                                                     	AND   RV.BKG_NO = BVD.BKG_NO                                                                                                      " ).append("\n"); 
		query.append("                                                                                        AND   RV2.BKG_No = RV.BKG_NO" ).append("\n"); 
		query.append("                                                                                        AND RV.SPCL_CGO_APRO_RQST_SEQ = RV2.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                                                                        AND   RV2.SPCL_CGO_CATE_CD = 'DG'" ).append("\n"); 
		query.append("                                                                                       )" ).append("\n"); 
		query.append("                                                   AND SVAR.BKG_NO                = BVD.BKG_NO" ).append("\n"); 
		query.append("                                                   AND SVAR.VSL_PRE_PST_CD        = BVD.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                                   AND SVAR.VSL_SEQ               = BVD.VSL_SEQ" ).append("\n"); 
		query.append("                                                   AND SVAR.VSL_CD                = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVAR.SKD_VOY_NO            = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVAR.SKD_DIR_CD            = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port" ).append("\n"); 
		query.append("                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB" ).append("\n"); 
		query.append("                                                                             WHERE SUB.VSL_CD = SVAR.VSL_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_VOY_NO = SVAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_DIR_CD = SVAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  " ).append("\n"); 
		query.append("                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                                           )        " ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port" ).append("\n"); 
		query.append("                                                   --AND SVAR.POL_CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                   AND SDC.SPCL_CGO_APRO_CD IS NOT NULL" ).append("\n"); 
		query.append("                                                   AND SDC.SPCL_CGO_APRO_CD NOT IN ('C','D','N')" ).append("\n"); 
		query.append("                                                   --AND SAR.LST_RQST_DAT_FLG = 'Y'" ).append("\n"); 
		query.append("                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                 AND EXISTS (" ).append("\n"); 
		query.append("                                                              SELECT 1" ).append("\n"); 
		query.append("                                                                FROM BKG_BOOKING C" ).append("\n"); 
		query.append("                                                               WHERE SDC.BKG_NO = C.BKG_NO" ).append("\n"); 
		query.append("                                                                 AND C.BKG_STS_CD <> 'X'" ).append("\n"); 
		query.append("                                                            )" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                   #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                                    AND SVAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                                    AND SDC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("														)" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("										   " ).append("\n"); 
		query.append("											   " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                    ) A" ).append("\n"); 
		query.append("                        						,  SCG_AUTHORIZATION G" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                             WHERE   A.BKG_NO                             = G.BKG_NO           (+)" ).append("\n"); 
		query.append("                                             AND   A.SPCL_CGO_APRO_RQST_SEQ       = G.SPCL_CGO_APRO_RQST_SEQ   (+)" ).append("\n"); 
		query.append("                                             AND   A.VSL_PRE_PST_CD                   = G.VSL_PRE_PST_CD       (+)" ).append("\n"); 
		query.append("                                             AND   A.VSL_SEQ                           = G.VSL_SEQ         (+)" ).append("\n"); 
		query.append("                                             AND   A.DCGO_SEQ                     = G.DCGO_SEQ         (+)" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                             #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                              AND  G.SPCL_CGO_AUTH_CD                 = 'P'" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                             #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                              AND  NVL(G.SPCL_CGO_AUTH_CD,'R')     = 'R'" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                             #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                              AND  G.SPCL_CGO_AUTH_CD                 = 'Y'" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                              AND   A.SPCL_CGO_APRO_CD           IN ('P','R','Y')" ).append("\n"); 
		query.append("                                              " ).append("\n"); 
		query.append("                                              ) A" ).append("\n"); 
		query.append("                                              WHERE CORR_AUTH_SEQ                = 1" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                UNION ALL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                -- Partner Lines SPCL CGO Info" ).append("\n"); 
		query.append("                                                SELECT SPAR.BKG_REF_NO," ).append("\n"); 
		query.append("                                                       SPAC.DCGO_SEQ," ).append("\n"); 
		query.append("                                                       SPAR.SLAN_CD," ).append("\n"); 
		query.append("                                                       SPAR.VSL_CD," ).append("\n"); 
		query.append("													  (SELECT " ).append("\n"); 
		query.append("                                                       DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| " ).append("\n"); 
		query.append("                                                       DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||" ).append("\n"); 
		query.append("                                                       DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||" ).append("\n"); 
		query.append("                                                       DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD" ).append("\n"); 
		query.append("                                                       FROM VSK_VSL_PORT_SKD " ).append("\n"); 
		query.append("                                                       WHERE VSL_CD = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                       AND   SKD_VOY_NO = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                       AND   SKD_DIR_CD = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                       AND   VPS_PORT_CD = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                       AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                       ) AS VVD,	" ).append("\n"); 
		query.append("														@[plmt_port_cd]	AS CUR_PORT_CD," ).append("\n"); 
		query.append("                                                        VVPS.CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT MAX(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MAX_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT MIN(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("									                           AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MIN_SEQ,                                                   " ).append("\n"); 
		query.append("                                                           SPAR.POL_CD," ).append("\n"); 
		query.append("														   SPAR.POL_CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.CLPT_IND_SEQ = NVL(SPAR.POL_CLPT_IND_SEQ,1)" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  = SPAR.POL_CD" ).append("\n"); 
		query.append("                                                               ) AS BKG_POL_SEQ," ).append("\n"); 
		query.append("                                                            SPAR.POD_CD," ).append("\n"); 
		query.append("															SPAR.POD_CLPT_IND_SEQ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("                                                               (" ).append("\n"); 
		query.append("                                                               SELECT   T1.CLPT_SEQ" ).append("\n"); 
		query.append("                                                               FROM     VSK_VSL_PORT_SKD             T1" ).append("\n"); 
		query.append("                                                               WHERE    T1.VSL_CD                    = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_VOY_NO                = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_DIR_CD                = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               AND      T1.VPS_PORT_CD               = SPAR.POD_CD" ).append("\n"); 
		query.append("                                                               AND      T1.CLPT_IND_SEQ              = NVL(SPAR.POD_CLPT_IND_SEQ,1)" ).append("\n"); 
		query.append("                                                               )		AS BKG_POD_SEQ,                                                               " ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                           NVL(SPAC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                                           SPAC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                                           SPAC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                                           (SELECT IMDG_COMP_GRP_CD FROM SCG_IMDG_UN_NO WHERE  IMDG_UN_NO = SPAC.IMDG_UN_NO AND  IMDG_UN_NO_SEQ = SPAC.IMDG_UN_NO_SEQ) AS IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                                              SPAC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                                           SPAC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                                            SUBSTR(SPAC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                                            SPAC.N1ST_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                                            SPAC.N2ND_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                                            SPAC.N3RD_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                                            SPAC.N4TH_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_WGT), SPAC.NET_WGT) AS NET_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.GRS_WGT), SPAC.GRS_WGT) AS GRS_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_EXPLO_WGT), SPAC.NET_EXPLO_WGT) AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                           VVPS.VPS_ETA_DT," ).append("\n"); 
		query.append("                                                           SPAC.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                                                 FROM  SCG_PRNR_APRO_RQST      SPAR," ).append("\n"); 
		query.append("                                                       SCG_PRNR_APRO_RQST_CGO  SPAC," ).append("\n"); 
		query.append("                                                       VSK_VSL_PORT_SKD        VVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SPAR.CRR_CD            = SPAC.CRR_CD" ).append("\n"); 
		query.append("                                                   AND SPAR.BKG_REF_NO        = SPAC.BKG_REF_NO" ).append("\n"); 
		query.append("												   AND SPAR.PRNR_CGO_RQST_SEQ = SPAC.PRNR_CGO_RQST_SEQ" ).append("\n"); 
		query.append("                                                   AND SPAR.SPCL_CGO_RQST_SEQ = SPAC.SPCL_CGO_RQST_SEQ" ).append("\n"); 
		query.append("                                                   AND SPAR.VSL_CD            = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SPAR.SKD_VOY_NO        = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SPAR.SKD_DIR_CD        = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   --AND NVL(SPAR.POL_CLPT_IND_SEQ,1)  = VVPS.CLPT_IND_SEQ                                                 " ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port" ).append("\n"); 
		query.append("                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB" ).append("\n"); 
		query.append("                                                                             WHERE SUB.VSL_CD = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_VOY_NO = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_DIR_CD = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  " ).append("\n"); 
		query.append("                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                                           )" ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port                                                   " ).append("\n"); 
		query.append("                                                   --AND VVPS.TURN_PORT_IND_CD      IN ('Y','N')" ).append("\n"); 
		query.append("                                                   AND SPAR.DG_FLG            = 'Y'" ).append("\n"); 
		query.append("                                                   AND SPAR.LST_RQST_DAT_FLG  = 'Y'" ).append("\n"); 
		query.append("                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                   #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                                   AND    SPAC.AUTH_STS_CD          = 'P'" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                                   AND SPAC.AUTH_STS_CD = 'R'" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                                   AND SPAC.AUTH_STS_CD             = 'Y'" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   AND SPAC.AUTH_STS_CD IN('P','R','Y')" ).append("\n"); 
		query.append("                                                   --AND SPAC.AUTH_STS_CD IN('Y','N','R','P')" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                   #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                                    AND SPAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                                    AND SPAC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("														)" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                ) 	A" ).append("\n"); 
		query.append("                                               --ARRIVAL 2016-04-13 WHERE CONDITION START--   " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("										WHERE	(BKG_POL_SEQ < CUR_PORT_MIN_SEQ AND BKG_POD_SEQ >= CUR_PORT_MIN_SEQ )" ).append("\n"); 
		query.append("                                    			 OR" ).append("\n"); 
		query.append("                                  				(BKG_POL_SEQ < CUR_PORT_MAX_SEQ AND BKG_POD_SEQ >= CUR_PORT_MAX_SEQ)" ).append("\n"); 
		query.append("													" ).append("\n"); 
		query.append("                                               --ARRIVAL 2016-04-13 WHERE CONDITION END--" ).append("\n"); 
		query.append("            --ARRIVAL SELECT 2016-04-13 END   " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                    UNION ALL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("            --DISCHARGE SELECT 2016-04-13 START  " ).append("\n"); 
		query.append("                                      SELECT   A.BKG_NO," ).append("\n"); 
		query.append("  											   A.DCGO_SEQ," ).append("\n"); 
		query.append("                                               A.SLAN_CD," ).append("\n"); 
		query.append("                                               A.VSL_CD," ).append("\n"); 
		query.append("											   A.VVD," ).append("\n"); 
		query.append("                                               A.CUR_PORT_CD," ).append("\n"); 
		query.append("                                               A.CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                               A.POL_CD," ).append("\n"); 
		query.append("											   A.POL_CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                               A.POD_CD," ).append("\n"); 
		query.append("											   A.POD_CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                               A.WGT_UT_CD," ).append("\n"); 
		query.append("                                               A.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                               A.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                               A.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                               A.IMDG_UN_NO," ).append("\n"); 
		query.append("                                               A.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                               A.CNTR_TP_CD," ).append("\n"); 
		query.append("                                               A.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                               A.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                               A.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                               A.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                               ---------------------------------" ).append("\n"); 
		query.append("                                                0 AS ARR_NET_WGT, 0 AS ARR_GRS_WGT, 0 AS ARR_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                NET_WGT AS DCHG_NET_WGT, GRS_WGT AS DCHG_GRS_WGT, NET_EXPLO_WGT AS DCHG_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                0 AS LOD_NET_WGT, 0 AS LOD_GRS_WGT, 0 AS LOD_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                0 AS DEP_NET_WGT, 0 AS DEP_GRS_WGT, 0 AS DEP_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                               A.VPS_ETA_DT, A.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                               '2DISCHARGE' PORT_LMT_KND" ).append("\n"); 
		query.append("                                      FROM (" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("													SELECT	A.BKG_NO               " ).append("\n"); 
		query.append("														,	A.DCGO_SEQ             " ).append("\n"); 
		query.append("														,	A.SLAN_CD              " ).append("\n"); 
		query.append("														,	A.VSL_CD " ).append("\n"); 
		query.append("                                                        ,   A.VVD             " ).append("\n"); 
		query.append("      													,	A.CUR_PORT_CD" ).append("\n"); 
		query.append("                                                        ,   A.CLPT_IND_SEQ" ).append("\n"); 
		query.append("														,	A.CUR_PORT_MAX_SEQ     " ).append("\n"); 
		query.append("														,	A.CUR_PORT_MIN_SEQ     " ).append("\n"); 
		query.append("														,	A.POL_CD" ).append("\n"); 
		query.append(" 														,   A.POL_CLPT_IND_SEQ           " ).append("\n"); 
		query.append("														,	A.BKG_POL_SEQ          " ).append("\n"); 
		query.append("														,	A.POD_CD" ).append("\n"); 
		query.append("                                                        ,   A.POD_CLPT_IND_SEQ                   " ).append("\n"); 
		query.append("														,	A.BKG_POD_SEQ          " ).append("\n"); 
		query.append("														,	A.WGT_UT_CD            " ).append("\n"); 
		query.append("														,	A.IMDG_CLSS_CD         " ).append("\n"); 
		query.append("														,	A.FLSH_PNT_CDO_TEMP    " ).append("\n"); 
		query.append("														,	A.IMDG_COMP_GRP_CD     " ).append("\n"); 
		query.append("														,	A.IMDG_UN_NO           " ).append("\n"); 
		query.append("														,	A.IMDG_UN_NO_SEQ       " ).append("\n"); 
		query.append("														,	A.CNTR_TP_CD           " ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD1" ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD2" ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD3" ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD4" ).append("\n"); 
		query.append("														,	A.NET_WGT,A.GRS_WGT" ).append("\n"); 
		query.append("														,	A.NET_EXPLO_WGT    " ).append("\n"); 
		query.append("														,	A.VPS_ETA_DT       " ).append("\n"); 
		query.append("														,	A.IMDG_PCK_GRP_CD  " ).append("\n"); 
		query.append("													FROM	(" ).append("\n"); 
		query.append("													        " ).append("\n"); 
		query.append("                                                    SELECT 	A.BKG_NO" ).append("\n"); 
		query.append("                                                    	,	A.DCGO_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.SLAN_CD" ).append("\n"); 
		query.append("                                                    	,	A.VSL_CD" ).append("\n"); 
		query.append("													    ,   A.VVD" ).append("\n"); 
		query.append("                                                    	,	A.CUR_PORT_CD" ).append("\n"); 
		query.append("                                                        ,   A.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.CUR_PORT_MAX_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.CUR_PORT_MIN_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.POL_CD" ).append("\n"); 
		query.append("                                                        ,   A.POL_CLPT_IND_SEQ   " ).append("\n"); 
		query.append("                                                    	,	A.BKG_POL_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.POD_CD" ).append("\n"); 
		query.append("                                                        ,   A.POD_CLPT_IND_SEQ    " ).append("\n"); 
		query.append("                                                    	,	A.BKG_POD_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.WGT_UT_CD" ).append("\n"); 
		query.append("                                                    	,	A.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                                    	,	A.FLSH_PNT_CDO_TEMP" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_UN_NO" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_UN_NO_SEQ" ).append("\n"); 
		query.append("                                                      ,  A.CNTR_TP_CD" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD1" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD2" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD3" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD4" ).append("\n"); 
		query.append("                                                      ,  A.NET_WGT,A.GRS_WGT" ).append("\n"); 
		query.append("                                                      ,  A.NET_EXPLO_WGT" ).append("\n"); 
		query.append("                                                      ,  A.VPS_ETA_DT" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                                                      ,  ROW_NUMBER() OVER (PARTITION BY NVL(G.BKG_NO,A.BKG_NO), NVL(G.SPCL_CGO_APRO_RQST_SEQ,A.SPCL_CGO_APRO_RQST_SEQ), NVL(G.VSL_PRE_PST_CD,A.VSL_PRE_PST_CD), NVL(G.VSL_SEQ,A.VSL_SEQ), NVL(G.DCGO_SEQ,A.DCGO_SEQ) ORDER BY G.DCGO_SEQ ASC) CORR_AUTH_SEQ" ).append("\n"); 
		query.append("                                                      " ).append("\n"); 
		query.append("                                                      FROM" ).append("\n"); 
		query.append("                                                             (" ).append("\n"); 
		query.append("                                                -- Own BKG`s SPCL CGO Info" ).append("\n"); 
		query.append("                                                SELECT 		SDC.BKG_NO" ).append("\n"); 
		query.append("														,	SDC.SPCL_CGO_APRO_CD," ).append("\n"); 
		query.append("                                                           SDC.DCGO_SEQ," ).append("\n"); 
		query.append("                                                           VVPS.SLAN_CD," ).append("\n"); 
		query.append("                                                           VVPS.VSL_CD," ).append("\n"); 
		query.append("                                                           (SELECT " ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| " ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||" ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||" ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD" ).append("\n"); 
		query.append("                                                           FROM VSK_VSL_PORT_SKD " ).append("\n"); 
		query.append("                                                           WHERE VSL_CD = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                           AND   SKD_VOY_NO = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                           AND   SKD_DIR_CD = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                           AND   VPS_PORT_CD = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                           AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                           ) AS VVD,                                                     " ).append("\n"); 
		query.append("                                                           @[plmt_port_cd]  AS CUR_PORT_CD," ).append("\n"); 
		query.append("                                                           VVPS.CLPT_IND_SEQ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                           (SELECT MAX(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("											                   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MAX_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT MIN(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("													           AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                                AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MIN_SEQ,                                                   " ).append("\n"); 
		query.append("                                                           SVAR.POL_CD," ).append("\n"); 
		query.append("	                                                       SVAR.POL_CLPT_IND_SEQ,    " ).append("\n"); 
		query.append("                                                           (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.CLPT_IND_SEQ = BVD.POL_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  = BVD.POL_CD" ).append("\n"); 
		query.append("                                                               ) AS BKG_POL_SEQ," ).append("\n"); 
		query.append("                                                            SVAR.POD_CD," ).append("\n"); 
		query.append("															SVAR.POD_CLPT_IND_SEQ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("                                                               (" ).append("\n"); 
		query.append("                                                               SELECT   T1.CLPT_SEQ" ).append("\n"); 
		query.append("                                                               FROM     VSK_VSL_PORT_SKD             T1" ).append("\n"); 
		query.append("                                                               WHERE    T1.VSL_CD                    = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_VOY_NO                = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_DIR_CD                = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               AND      T1.VPS_PORT_CD               = BVD.POD_CD" ).append("\n"); 
		query.append("                                                               AND      T1.CLPT_IND_SEQ              = BVD.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                               )    AS BKG_POD_SEQ," ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                           NVL(SDC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                                           SDC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                                           SDC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                                           SDC.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                                           SDC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                                           SDC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                                           SUBSTR(SDC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_WGT), SDC.NET_WGT) AS NET_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.GRS_WGT), SDC.GRS_WGT) AS GRS_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_EXPLO_WGT), SDC.NET_EXPLO_WGT) AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                           VVPS.VPS_ETA_DT, SDC.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                                           SVAR.VSL_PRE_PST_CD, SVAR.VSL_SEQ  , SAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                                  FROM BKG_DG_CGO        SDC," ).append("\n"); 
		query.append("                                                       SCG_APRO_RQST     SAR," ).append("\n"); 
		query.append("                                                       SCG_VVD_APRO_RQST SVAR," ).append("\n"); 
		query.append("                                                       BKG_VVD           BVD," ).append("\n"); 
		query.append("                                                       VSK_VSL_PORT_SKD  VVPS" ).append("\n"); 
		query.append("                                                  WHERE 1 = 1" ).append("\n"); 
		query.append("                                                   AND SDC.BKG_NO                 = SAR.BKG_NO" ).append("\n"); 
		query.append("                                                   AND SAR.BKG_NO                 = SVAR.BKG_NO" ).append("\n"); 
		query.append("                                                   AND SAR.SPCL_CGO_APRO_RQST_SEQ = SVAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("												   -- BDR 이후 POST VVD만 Request오는 경우 고려, LST_RQST_DAT_FLG='Y' 조건 대신 적용" ).append("\n"); 
		query.append("                                                   AND SVAR.SPCL_CGO_APRO_RQST_SEQ = (SELECT MAX(RV.SPCL_CGO_APRO_RQST_SEQ) " ).append("\n"); 
		query.append("                                                                            			FROM SCG_VVD_APRO_RQST RV," ).append("\n"); 
		query.append("                                                                                             SCG_APRO_RQST RV2" ).append("\n"); 
		query.append("                                                                                     	WHERE RV.VSL_CD = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                                                     	AND   RV.SKD_VOY_NO = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                                                     	AND   RV.SKD_DIR_CD = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                                                     	AND   RV.BKG_NO = BVD.BKG_NO                                                                                                      " ).append("\n"); 
		query.append("                                                                                        AND   RV2.BKG_No = RV.BKG_NO" ).append("\n"); 
		query.append("                                                                                        AND RV.SPCL_CGO_APRO_RQST_SEQ = RV2.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                                                                        AND   RV2.SPCL_CGO_CATE_CD = 'DG'" ).append("\n"); 
		query.append("                                                                                       )" ).append("\n"); 
		query.append("                                                   AND SVAR.BKG_NO                = BVD.BKG_NO" ).append("\n"); 
		query.append("                                                   AND SVAR.VSL_PRE_PST_CD        = BVD.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                                   AND SVAR.VSL_SEQ               = BVD.VSL_SEQ" ).append("\n"); 
		query.append("                                                   AND SVAR.VSL_CD                = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVAR.SKD_VOY_NO            = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVAR.SKD_DIR_CD            = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port" ).append("\n"); 
		query.append("                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB" ).append("\n"); 
		query.append("                                                                             WHERE SUB.VSL_CD = SVAR.VSL_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_VOY_NO = SVAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_DIR_CD = SVAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  " ).append("\n"); 
		query.append("                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                                           )        " ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port" ).append("\n"); 
		query.append("                                                   --AND SVAR.POL_CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                   AND SDC.SPCL_CGO_APRO_CD IS NOT NULL" ).append("\n"); 
		query.append("                                                   AND SDC.SPCL_CGO_APRO_CD NOT IN ('C','D','N')" ).append("\n"); 
		query.append("                                                   --AND SAR.LST_RQST_DAT_FLG = 'Y'" ).append("\n"); 
		query.append("                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                 AND EXISTS (" ).append("\n"); 
		query.append("                                                              SELECT 1" ).append("\n"); 
		query.append("                                                                FROM BKG_BOOKING C" ).append("\n"); 
		query.append("                                                               WHERE SDC.BKG_NO = C.BKG_NO" ).append("\n"); 
		query.append("                                                                 AND C.BKG_STS_CD <> 'X'" ).append("\n"); 
		query.append("                                                            )" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                   #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                                    AND SVAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                                    AND SDC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("														)" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                    ) A" ).append("\n"); 
		query.append("                        						,  SCG_AUTHORIZATION G" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                             WHERE   A.BKG_NO                             = G.BKG_NO           (+)" ).append("\n"); 
		query.append("                                             AND   A.SPCL_CGO_APRO_RQST_SEQ       = G.SPCL_CGO_APRO_RQST_SEQ   (+)" ).append("\n"); 
		query.append("                                             AND   A.VSL_PRE_PST_CD                   = G.VSL_PRE_PST_CD       (+)" ).append("\n"); 
		query.append("                                             AND   A.VSL_SEQ                           = G.VSL_SEQ         (+)" ).append("\n"); 
		query.append("                                             AND   A.DCGO_SEQ                     = G.DCGO_SEQ         (+)" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                             #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                              AND  G.SPCL_CGO_AUTH_CD                 = 'P'" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                             #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                              AND  NVL(G.SPCL_CGO_AUTH_CD,'R')     = 'R'" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                             #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                              AND  G.SPCL_CGO_AUTH_CD                 = 'Y'" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                              AND   A.SPCL_CGO_APRO_CD           IN ('P','R','Y')" ).append("\n"); 
		query.append("                                              " ).append("\n"); 
		query.append("                                              ) A" ).append("\n"); 
		query.append("                                              WHERE CORR_AUTH_SEQ                = 1" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                UNION ALL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                -- Partner Lines SPCL CGO Info" ).append("\n"); 
		query.append("                                                SELECT SPAR.BKG_REF_NO," ).append("\n"); 
		query.append("                                                       SPAC.DCGO_SEQ," ).append("\n"); 
		query.append("                                                       SPAR.SLAN_CD," ).append("\n"); 
		query.append("                                                       SPAR.VSL_CD," ).append("\n"); 
		query.append("                                                       (SELECT " ).append("\n"); 
		query.append("                                                        DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| " ).append("\n"); 
		query.append("                                                        DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||" ).append("\n"); 
		query.append("                                                        DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||" ).append("\n"); 
		query.append("                                                        DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD" ).append("\n"); 
		query.append("                                                        FROM VSK_VSL_PORT_SKD " ).append("\n"); 
		query.append("                                                        WHERE VSL_CD = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                        AND   SKD_VOY_NO = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                        AND   SKD_DIR_CD = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                        AND   VPS_PORT_CD = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                        AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                        ) AS VVD," ).append("\n"); 
		query.append("														@[plmt_port_cd]	AS CUR_PORT_CD," ).append("\n"); 
		query.append("                                                        VVPS.CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT MAX(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MAX_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT MIN(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MIN_SEQ,                                                   " ).append("\n"); 
		query.append("                                                           SPAR.POL_CD," ).append("\n"); 
		query.append("														   SPAR.POL_CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("														       AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.CLPT_IND_SEQ = NVL(SPAR.POL_CLPT_IND_SEQ,1)" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  = SPAR.POL_CD" ).append("\n"); 
		query.append("                                                               ) AS BKG_POL_SEQ," ).append("\n"); 
		query.append("                                                            SPAR.POD_CD," ).append("\n"); 
		query.append("															SPAR.POD_CLPT_IND_SEQ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("                                                               (" ).append("\n"); 
		query.append("                                                               SELECT   T1.CLPT_SEQ" ).append("\n"); 
		query.append("                                                               FROM     VSK_VSL_PORT_SKD             T1" ).append("\n"); 
		query.append("                                                               WHERE    T1.VSL_CD                    = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_VOY_NO                = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_DIR_CD                = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               AND      T1.VPS_PORT_CD               = SPAR.POD_CD" ).append("\n"); 
		query.append("                                                               AND      T1.CLPT_IND_SEQ              = NVL(SPAR.POD_CLPT_IND_SEQ,1)" ).append("\n"); 
		query.append("                                                               )		AS BKG_POD_SEQ,                                                               " ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                           NVL(SPAC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                                           SPAC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                                           SPAC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                                           (SELECT IMDG_COMP_GRP_CD FROM SCG_IMDG_UN_NO WHERE  IMDG_UN_NO = SPAC.IMDG_UN_NO AND  IMDG_UN_NO_SEQ = SPAC.IMDG_UN_NO_SEQ) AS IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                                              SPAC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                                           SPAC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                                            SUBSTR(SPAC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                                            SPAC.N1ST_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                                            SPAC.N2ND_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                                            SPAC.N3RD_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                                            SPAC.N4TH_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_WGT), SPAC.NET_WGT) AS NET_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.GRS_WGT), SPAC.GRS_WGT) AS GRS_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_EXPLO_WGT), SPAC.NET_EXPLO_WGT) AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                           VVPS.VPS_ETA_DT," ).append("\n"); 
		query.append("                                                           SPAC.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                                                 FROM  SCG_PRNR_APRO_RQST      SPAR," ).append("\n"); 
		query.append("                                                       SCG_PRNR_APRO_RQST_CGO  SPAC," ).append("\n"); 
		query.append("                                                       VSK_VSL_PORT_SKD        VVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SPAR.CRR_CD            = SPAC.CRR_CD" ).append("\n"); 
		query.append("                                                   AND SPAR.BKG_REF_NO        = SPAC.BKG_REF_NO" ).append("\n"); 
		query.append("												   AND SPAR.PRNR_CGO_RQST_SEQ = SPAC.PRNR_CGO_RQST_SEQ" ).append("\n"); 
		query.append("                                                   AND SPAR.SPCL_CGO_RQST_SEQ = SPAC.SPCL_CGO_RQST_SEQ" ).append("\n"); 
		query.append("                                                   AND SPAR.VSL_CD            = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SPAR.SKD_VOY_NO        = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SPAR.SKD_DIR_CD        = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   --AND NVL(SPAR.POL_CLPT_IND_SEQ,1)  = VVPS.CLPT_IND_SEQ                                                 " ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port" ).append("\n"); 
		query.append("                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB" ).append("\n"); 
		query.append("                                                                             WHERE SUB.VSL_CD = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_VOY_NO = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_DIR_CD = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  " ).append("\n"); 
		query.append("                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                                           )" ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port                                                   " ).append("\n"); 
		query.append("                                                   --AND VVPS.TURN_PORT_IND_CD      IN ('Y','N')" ).append("\n"); 
		query.append("                                                   AND SPAR.DG_FLG            = 'Y'" ).append("\n"); 
		query.append("                                                   AND SPAR.LST_RQST_DAT_FLG  = 'Y'" ).append("\n"); 
		query.append("                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                   #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                                   AND    SPAC.AUTH_STS_CD          = 'P'" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                                   AND SPAC.AUTH_STS_CD = 'R'" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                                   AND SPAC.AUTH_STS_CD             = 'Y'" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   AND SPAC.AUTH_STS_CD IN('P','R','Y')" ).append("\n"); 
		query.append("                                                   --AND SPAC.AUTH_STS_CD IN('Y','N','R','P')" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                   #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                                    AND SPAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                                    AND SPAC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("														)" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                ) 	A" ).append("\n"); 
		query.append("                                         --DISCHARGE 2016-04-13 WHERE CONDITION START--       " ).append("\n"); 
		query.append("                                         WHERE 	(BKG_POD_SEQ = CUR_PORT_MIN_SEQ OR BKG_POD_SEQ = CUR_PORT_MAX_SEQ)" ).append("\n"); 
		query.append("										   AND  POD_CLPT_IND_SEQ = CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                         " ).append("\n"); 
		query.append("                                         --DISCHARGE 2016-04-13 WHERE CONDITION END--" ).append("\n"); 
		query.append("                                         " ).append("\n"); 
		query.append("            --DISCHARGE SELECT 2016-04-13 END     " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                    UNION ALL" ).append("\n"); 
		query.append("                                    " ).append("\n"); 
		query.append("            --LOAD SELECT 2016-04-13 START" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                   SELECT A.BKG_NO, A.DCGO_SEQ," ).append("\n"); 
		query.append("                                              A.SLAN_CD," ).append("\n"); 
		query.append("                                              A.VSL_CD," ).append("\n"); 
		query.append("											  A.VVD," ).append("\n"); 
		query.append("                                              A.CUR_PORT_CD," ).append("\n"); 
		query.append("                                              A.CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                              A.POL_CD," ).append("\n"); 
		query.append("											  A.POL_CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                              A.POD_CD," ).append("\n"); 
		query.append("											  A.POD_CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                              A.WGT_UT_CD," ).append("\n"); 
		query.append("                                              A.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                              A.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                              A.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                              A.IMDG_UN_NO," ).append("\n"); 
		query.append("                                              A.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                              A.CNTR_TP_CD," ).append("\n"); 
		query.append("                                              A.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                              A.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                              A.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                              A.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                              0 AS ARR_NET_WGT, 0 AS ARR_GRS_WGT, 0 AS ARR_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                              0 AS DCHG_NET_WGT, 0 AS DCHG_GRS_WGT, 0 AS DCHG_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                              NET_WGT AS LOD_NET_WGT, GRS_WGT AS LOD_GRS_WGT, NET_EXPLO_WGT AS LOD_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                              0 AS DEP_NET_WGT, 0 AS DEP_GRS_WGT, 0 AS DEP_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                              A.VPS_ETA_DT, A.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                               '3LOAD' PORT_LMT_KND" ).append("\n"); 
		query.append("                                      FROM (" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("													SELECT	A.BKG_NO               " ).append("\n"); 
		query.append("														,	A.DCGO_SEQ             " ).append("\n"); 
		query.append("														,	A.SLAN_CD              " ).append("\n"); 
		query.append("														,	A.VSL_CD  " ).append("\n"); 
		query.append("														,   A.VVD             " ).append("\n"); 
		query.append("     													,	A.CUR_PORT_CD" ).append("\n"); 
		query.append("                                                        ,   A.CLPT_IND_SEQ" ).append("\n"); 
		query.append("														,	A.CUR_PORT_MAX_SEQ     " ).append("\n"); 
		query.append("														,	A.CUR_PORT_MIN_SEQ     " ).append("\n"); 
		query.append("														,	A.POL_CD" ).append("\n"); 
		query.append(" 														,   A.POL_CLPT_IND_SEQ           " ).append("\n"); 
		query.append("														,	A.BKG_POL_SEQ          " ).append("\n"); 
		query.append("														,	A.POD_CD" ).append("\n"); 
		query.append("                                                        ,   A.POD_CLPT_IND_SEQ                   " ).append("\n"); 
		query.append("														,	A.BKG_POD_SEQ          " ).append("\n"); 
		query.append("														,	A.WGT_UT_CD            " ).append("\n"); 
		query.append("														,	A.IMDG_CLSS_CD         " ).append("\n"); 
		query.append("														,	A.FLSH_PNT_CDO_TEMP    " ).append("\n"); 
		query.append("														,	A.IMDG_COMP_GRP_CD     " ).append("\n"); 
		query.append("														,	A.IMDG_UN_NO           " ).append("\n"); 
		query.append("														,	A.IMDG_UN_NO_SEQ       " ).append("\n"); 
		query.append("														,	A.CNTR_TP_CD           " ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD1" ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD2" ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD3" ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD4" ).append("\n"); 
		query.append("														,	A.NET_WGT,A.GRS_WGT" ).append("\n"); 
		query.append("														,	A.NET_EXPLO_WGT    " ).append("\n"); 
		query.append("														,	A.VPS_ETA_DT       " ).append("\n"); 
		query.append("														,	A.IMDG_PCK_GRP_CD  " ).append("\n"); 
		query.append("													FROM	(" ).append("\n"); 
		query.append("													        " ).append("\n"); 
		query.append("                                                    SELECT 	A.BKG_NO" ).append("\n"); 
		query.append("                                                    	,	A.DCGO_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.SLAN_CD" ).append("\n"); 
		query.append("                                                    	,	A.VSL_CD" ).append("\n"); 
		query.append("														,   A.VVD" ).append("\n"); 
		query.append("                                                    	,	A.CUR_PORT_CD" ).append("\n"); 
		query.append("                                                        ,   A.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.CUR_PORT_MAX_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.CUR_PORT_MIN_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.POL_CD" ).append("\n"); 
		query.append("                                                        ,   A.POL_CLPT_IND_SEQ   " ).append("\n"); 
		query.append("                                                    	,	A.BKG_POL_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.POD_CD" ).append("\n"); 
		query.append("                                                        ,   A.POD_CLPT_IND_SEQ    " ).append("\n"); 
		query.append("                                                    	,	A.BKG_POD_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.WGT_UT_CD" ).append("\n"); 
		query.append("                                                    	,	A.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                                    	,	A.FLSH_PNT_CDO_TEMP" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_UN_NO" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_UN_NO_SEQ" ).append("\n"); 
		query.append("                                                      ,  A.CNTR_TP_CD" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD1" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD2" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD3" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD4" ).append("\n"); 
		query.append("                                                      ,  A.NET_WGT,A.GRS_WGT" ).append("\n"); 
		query.append("                                                      ,  A.NET_EXPLO_WGT" ).append("\n"); 
		query.append("                                                      ,  A.VPS_ETA_DT" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                                                      ,  ROW_NUMBER() OVER (PARTITION BY NVL(G.BKG_NO,A.BKG_NO), NVL(G.SPCL_CGO_APRO_RQST_SEQ,A.SPCL_CGO_APRO_RQST_SEQ), NVL(G.VSL_PRE_PST_CD,A.VSL_PRE_PST_CD), NVL(G.VSL_SEQ,A.VSL_SEQ), NVL(G.DCGO_SEQ,A.DCGO_SEQ) ORDER BY G.DCGO_SEQ ASC) CORR_AUTH_SEQ" ).append("\n"); 
		query.append("                                                      " ).append("\n"); 
		query.append("                                                      FROM" ).append("\n"); 
		query.append("                                                             (" ).append("\n"); 
		query.append("                                                -- Own BKG`s SPCL CGO Info" ).append("\n"); 
		query.append("                                                SELECT 		SDC.BKG_NO" ).append("\n"); 
		query.append("														,	SDC.SPCL_CGO_APRO_CD," ).append("\n"); 
		query.append("                                                           SDC.DCGO_SEQ," ).append("\n"); 
		query.append("                                                           VVPS.SLAN_CD," ).append("\n"); 
		query.append("                                                           VVPS.VSL_CD," ).append("\n"); 
		query.append("                                                           (SELECT " ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| " ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||" ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||" ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD" ).append("\n"); 
		query.append("                                                           FROM VSK_VSL_PORT_SKD " ).append("\n"); 
		query.append("                                                           WHERE VSL_CD = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                           AND   SKD_VOY_NO = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                           AND   SKD_DIR_CD = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                           AND   VPS_PORT_CD = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                           AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                           ) AS VVD," ).append("\n"); 
		query.append("                                                          " ).append("\n"); 
		query.append("                                                           @[plmt_port_cd]  AS CUR_PORT_CD," ).append("\n"); 
		query.append("                                                           VVPS.CLPT_IND_SEQ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                           (SELECT MAX(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MAX_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT MIN(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                                AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MIN_SEQ,                                                   " ).append("\n"); 
		query.append("                                                           SVAR.POL_CD," ).append("\n"); 
		query.append("	                                                       SVAR.POL_CLPT_IND_SEQ,    " ).append("\n"); 
		query.append("                                                           (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.CLPT_IND_SEQ = BVD.POL_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  = BVD.POL_CD" ).append("\n"); 
		query.append("                                                               ) AS BKG_POL_SEQ," ).append("\n"); 
		query.append("                                                            SVAR.POD_CD," ).append("\n"); 
		query.append("															SVAR.POD_CLPT_IND_SEQ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("                                                               (" ).append("\n"); 
		query.append("                                                               SELECT   T1.CLPT_SEQ" ).append("\n"); 
		query.append("                                                               FROM     VSK_VSL_PORT_SKD             T1" ).append("\n"); 
		query.append("                                                               WHERE    T1.VSL_CD                    = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_VOY_NO                = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_DIR_CD                = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               AND      T1.VPS_PORT_CD               = BVD.POD_CD" ).append("\n"); 
		query.append("                                                               AND      T1.CLPT_IND_SEQ              = BVD.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                               )    AS BKG_POD_SEQ," ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                           NVL(SDC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                                           SDC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                                           SDC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                                           SDC.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                                           SDC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                                           SDC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                                           SUBSTR(SDC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_WGT), SDC.NET_WGT) AS NET_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.GRS_WGT), SDC.GRS_WGT) AS GRS_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_EXPLO_WGT), SDC.NET_EXPLO_WGT) AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                           VVPS.VPS_ETA_DT, SDC.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                                           SVAR.VSL_PRE_PST_CD, SVAR.VSL_SEQ  , SAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                                  FROM BKG_DG_CGO        SDC," ).append("\n"); 
		query.append("                                                       SCG_APRO_RQST     SAR," ).append("\n"); 
		query.append("                                                       SCG_VVD_APRO_RQST SVAR," ).append("\n"); 
		query.append("                                                       BKG_VVD           BVD," ).append("\n"); 
		query.append("                                                       VSK_VSL_PORT_SKD  VVPS" ).append("\n"); 
		query.append("                                                  WHERE 1 = 1" ).append("\n"); 
		query.append("                                                   AND SDC.BKG_NO                 = SAR.BKG_NO" ).append("\n"); 
		query.append("                                                   AND SAR.BKG_NO                 = SVAR.BKG_NO" ).append("\n"); 
		query.append("                                                   AND SAR.SPCL_CGO_APRO_RQST_SEQ = SVAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("												   -- BDR 이후 POST VVD만 Request오는 경우 고려, LST_RQST_DAT_FLG='Y' 조건 대신 적용" ).append("\n"); 
		query.append("                                                   AND SVAR.SPCL_CGO_APRO_RQST_SEQ = (SELECT MAX(RV.SPCL_CGO_APRO_RQST_SEQ) " ).append("\n"); 
		query.append("                                                                            			FROM SCG_VVD_APRO_RQST RV," ).append("\n"); 
		query.append("                                                                                             SCG_APRO_RQST RV2" ).append("\n"); 
		query.append("                                                                                     	WHERE RV.VSL_CD = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                                                     	AND   RV.SKD_VOY_NO = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                                                     	AND   RV.SKD_DIR_CD = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                                                     	AND   RV.BKG_NO = BVD.BKG_NO                                                                                                      " ).append("\n"); 
		query.append("                                                                                        AND   RV2.BKG_No = RV.BKG_NO" ).append("\n"); 
		query.append("                                                                                        AND RV.SPCL_CGO_APRO_RQST_SEQ = RV2.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                                                                        AND   RV2.SPCL_CGO_CATE_CD = 'DG'" ).append("\n"); 
		query.append("                                                                                       )" ).append("\n"); 
		query.append("                                                   AND SVAR.BKG_NO                = BVD.BKG_NO" ).append("\n"); 
		query.append("                                                   AND SVAR.VSL_PRE_PST_CD        = BVD.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                                   AND SVAR.VSL_SEQ               = BVD.VSL_SEQ" ).append("\n"); 
		query.append("                                                   AND SVAR.VSL_CD                = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVAR.SKD_VOY_NO            = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVAR.SKD_DIR_CD            = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port" ).append("\n"); 
		query.append("                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB" ).append("\n"); 
		query.append("                                                                             WHERE SUB.VSL_CD = SVAR.VSL_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_VOY_NO = SVAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_DIR_CD = SVAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  " ).append("\n"); 
		query.append("                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                                           )        " ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port" ).append("\n"); 
		query.append("                                                   --AND SVAR.POL_CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                   AND SDC.SPCL_CGO_APRO_CD IS NOT NULL" ).append("\n"); 
		query.append("                                                   AND SDC.SPCL_CGO_APRO_CD NOT IN ('C','D','N')" ).append("\n"); 
		query.append("                                                   --AND SAR.LST_RQST_DAT_FLG = 'Y'" ).append("\n"); 
		query.append("                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                 AND EXISTS (" ).append("\n"); 
		query.append("                                                              SELECT 1" ).append("\n"); 
		query.append("                                                                FROM BKG_BOOKING C" ).append("\n"); 
		query.append("                                                               WHERE SDC.BKG_NO = C.BKG_NO" ).append("\n"); 
		query.append("                                                                 AND C.BKG_STS_CD <> 'X'" ).append("\n"); 
		query.append("                                                            )" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                   #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                                    AND SVAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                                    AND SDC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("														)" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                    ) A" ).append("\n"); 
		query.append("                        						,  SCG_AUTHORIZATION G" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                             WHERE   A.BKG_NO                             = G.BKG_NO           (+)" ).append("\n"); 
		query.append("                                             AND   A.SPCL_CGO_APRO_RQST_SEQ       = G.SPCL_CGO_APRO_RQST_SEQ   (+)" ).append("\n"); 
		query.append("                                             AND   A.VSL_PRE_PST_CD                   = G.VSL_PRE_PST_CD       (+)" ).append("\n"); 
		query.append("                                             AND   A.VSL_SEQ                           = G.VSL_SEQ         (+)" ).append("\n"); 
		query.append("                                             AND   A.DCGO_SEQ                     = G.DCGO_SEQ         (+)" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                             #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                              AND  G.SPCL_CGO_AUTH_CD                 = 'P'" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                             #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                              AND  NVL(G.SPCL_CGO_AUTH_CD,'R')     = 'R'" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                             #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                              AND  G.SPCL_CGO_AUTH_CD                 = 'Y'" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                              AND   A.SPCL_CGO_APRO_CD           IN ('P','R','Y')" ).append("\n"); 
		query.append("                                              " ).append("\n"); 
		query.append("                                              ) A" ).append("\n"); 
		query.append("                                              WHERE CORR_AUTH_SEQ                = 1" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                UNION ALL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                -- Partner Lines SPCL CGO Info" ).append("\n"); 
		query.append("                                                SELECT SPAR.BKG_REF_NO," ).append("\n"); 
		query.append("                                                       SPAC.DCGO_SEQ," ).append("\n"); 
		query.append("                                                       SPAR.SLAN_CD," ).append("\n"); 
		query.append("                                                       SPAR.VSL_CD," ).append("\n"); 
		query.append("                                                       (SELECT " ).append("\n"); 
		query.append("                                                        DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| " ).append("\n"); 
		query.append("                                                        DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||" ).append("\n"); 
		query.append("                                                        DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||" ).append("\n"); 
		query.append("                                                        DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD" ).append("\n"); 
		query.append("                                                        FROM VSK_VSL_PORT_SKD " ).append("\n"); 
		query.append("                                                        WHERE VSL_CD = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                        AND   SKD_VOY_NO = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                        AND   SKD_DIR_CD = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                        AND   VPS_PORT_CD = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                        AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                        ) AS VVD," ).append("\n"); 
		query.append("														@[plmt_port_cd]	AS CUR_PORT_CD," ).append("\n"); 
		query.append("                                                        VVPS.CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT MAX(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("														       AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MAX_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT MIN(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("	                                                           AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MIN_SEQ,                                                   " ).append("\n"); 
		query.append("                                                           SPAR.POL_CD," ).append("\n"); 
		query.append("														   SPAR.POL_CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.CLPT_IND_SEQ = NVL(SPAR.POL_CLPT_IND_SEQ,1)" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  = SPAR.POL_CD" ).append("\n"); 
		query.append("                                                               ) AS BKG_POL_SEQ," ).append("\n"); 
		query.append("                                                            SPAR.POD_CD," ).append("\n"); 
		query.append("															SPAR.POD_CLPT_IND_SEQ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("                                                               (" ).append("\n"); 
		query.append("                                                               SELECT   T1.CLPT_SEQ" ).append("\n"); 
		query.append("                                                               FROM     VSK_VSL_PORT_SKD             T1" ).append("\n"); 
		query.append("                                                               WHERE    T1.VSL_CD                    = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_VOY_NO                = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_DIR_CD                = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               AND      T1.VPS_PORT_CD               = SPAR.POD_CD" ).append("\n"); 
		query.append("                                                               AND      T1.CLPT_IND_SEQ              = NVL(SPAR.POD_CLPT_IND_SEQ,1)" ).append("\n"); 
		query.append("                                                               )		AS BKG_POD_SEQ,                                                               " ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                           NVL(SPAC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                                           SPAC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                                           SPAC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                                           (SELECT IMDG_COMP_GRP_CD FROM SCG_IMDG_UN_NO WHERE  IMDG_UN_NO = SPAC.IMDG_UN_NO AND  IMDG_UN_NO_SEQ = SPAC.IMDG_UN_NO_SEQ) AS IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                                              SPAC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                                           SPAC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                                            SUBSTR(SPAC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                                            SPAC.N1ST_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                                            SPAC.N2ND_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                                            SPAC.N3RD_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                                            SPAC.N4TH_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_WGT), SPAC.NET_WGT) AS NET_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.GRS_WGT), SPAC.GRS_WGT) AS GRS_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_EXPLO_WGT), SPAC.NET_EXPLO_WGT) AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                           VVPS.VPS_ETA_DT," ).append("\n"); 
		query.append("                                                           SPAC.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                                                 FROM  SCG_PRNR_APRO_RQST      SPAR," ).append("\n"); 
		query.append("                                                       SCG_PRNR_APRO_RQST_CGO  SPAC," ).append("\n"); 
		query.append("                                                       VSK_VSL_PORT_SKD        VVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SPAR.CRR_CD            = SPAC.CRR_CD" ).append("\n"); 
		query.append("                                                   AND SPAR.BKG_REF_NO        = SPAC.BKG_REF_NO" ).append("\n"); 
		query.append("												   AND SPAR.PRNR_CGO_RQST_SEQ = SPAC.PRNR_CGO_RQST_SEQ" ).append("\n"); 
		query.append("                                                   AND SPAR.SPCL_CGO_RQST_SEQ = SPAC.SPCL_CGO_RQST_SEQ" ).append("\n"); 
		query.append("                                                   AND SPAR.VSL_CD            = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SPAR.SKD_VOY_NO        = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SPAR.SKD_DIR_CD        = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   --AND NVL(SPAR.POL_CLPT_IND_SEQ,1)  = VVPS.CLPT_IND_SEQ                                                 " ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port" ).append("\n"); 
		query.append("                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB" ).append("\n"); 
		query.append("                                                                             WHERE SUB.VSL_CD = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_VOY_NO = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_DIR_CD = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  " ).append("\n"); 
		query.append("                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                                           )" ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port                                                   " ).append("\n"); 
		query.append("                                                   --AND VVPS.TURN_PORT_IND_CD      IN ('Y','N')" ).append("\n"); 
		query.append("                                                   AND SPAR.DG_FLG            = 'Y'" ).append("\n"); 
		query.append("                                                   AND SPAR.LST_RQST_DAT_FLG  = 'Y'" ).append("\n"); 
		query.append("                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                   #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                                   AND    SPAC.AUTH_STS_CD          = 'P'" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                                   AND SPAC.AUTH_STS_CD = 'R'" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                                   AND SPAC.AUTH_STS_CD             = 'Y'" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   AND SPAC.AUTH_STS_CD IN('P','R','Y')" ).append("\n"); 
		query.append("                                                   --AND SPAC.AUTH_STS_CD IN('Y','N','R','P')" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                   #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                                    AND SPAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                                    AND SPAC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("														)" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                ) 	A" ).append("\n"); 
		query.append("                                                 --LOAD 2016-04-13 WHERE CONDITION START--" ).append("\n"); 
		query.append("                                                 WHERE (BKG_POL_SEQ = CUR_PORT_MIN_SEQ OR BKG_POL_SEQ = CUR_PORT_MAX_SEQ)" ).append("\n"); 
		query.append("												   AND POL_CLPT_IND_SEQ = CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                --LOAD 2016-04-13 WHERE CONDITION END--" ).append("\n"); 
		query.append("             " ).append("\n"); 
		query.append("            --LOAD SELECT 2016-04-13 END " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                        UNION ALL" ).append("\n"); 
		query.append("                                        " ).append("\n"); 
		query.append("            --DEPARTURE SELECT 2016-04-13 START   " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                 SELECT A.BKG_NO, A.DCGO_SEQ," ).append("\n"); 
		query.append("                                              A.SLAN_CD," ).append("\n"); 
		query.append("                                              A.VSL_CD," ).append("\n"); 
		query.append("											  A.VVD," ).append("\n"); 
		query.append("                                              A.CUR_PORT_CD," ).append("\n"); 
		query.append("                                              A.CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                              A.POL_CD," ).append("\n"); 
		query.append("											  A.POL_CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                              A.POD_CD," ).append("\n"); 
		query.append("											  A.POD_CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                              A.WGT_UT_CD," ).append("\n"); 
		query.append("                                              A.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                              A.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                              A.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                              A.IMDG_UN_NO," ).append("\n"); 
		query.append("                                              A.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                              A.CNTR_TP_CD," ).append("\n"); 
		query.append("                                              A.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                              A.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                              A.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                              A.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                              0 AS ARR_NET_WGT, 0 AS ARR_GRS_WGT, 0 AS ARR_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                              0 AS DCHG_NET_WGT, 0 AS DCHG_GRS_WGT, 0 AS DCHG_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                              0 AS LOD_NET_WGT, 0 AS LOD_GRS_WGT, 0 AS LOD_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                              NET_WGT AS DEP_NET_WGT, GRS_WGT AS DEP_GRS_WGT, NET_EXPLO_WGT AS DEP_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                              A.VPS_ETA_DT, A.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                               '4DEPARTURE' PORT_LMT_KND" ).append("\n"); 
		query.append("                                      FROM (" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("													SELECT	A.BKG_NO               " ).append("\n"); 
		query.append("														,	A.DCGO_SEQ             " ).append("\n"); 
		query.append("														,	A.SLAN_CD              " ).append("\n"); 
		query.append("														,	A.VSL_CD   " ).append("\n"); 
		query.append("														,   A.VVD           " ).append("\n"); 
		query.append("       													,	A.CUR_PORT_CD" ).append("\n"); 
		query.append("                                                        ,   A.CLPT_IND_SEQ" ).append("\n"); 
		query.append("														,	A.CUR_PORT_MAX_SEQ     " ).append("\n"); 
		query.append("														,	A.CUR_PORT_MIN_SEQ     " ).append("\n"); 
		query.append("														,	A.POL_CD" ).append("\n"); 
		query.append(" 														,   A.POL_CLPT_IND_SEQ           " ).append("\n"); 
		query.append("														,	A.BKG_POL_SEQ          " ).append("\n"); 
		query.append("														,	A.POD_CD" ).append("\n"); 
		query.append("                                                        ,   A.POD_CLPT_IND_SEQ                   " ).append("\n"); 
		query.append("														,	A.BKG_POD_SEQ          " ).append("\n"); 
		query.append("														,	A.WGT_UT_CD            " ).append("\n"); 
		query.append("														,	A.IMDG_CLSS_CD         " ).append("\n"); 
		query.append("														,	A.FLSH_PNT_CDO_TEMP    " ).append("\n"); 
		query.append("														,	A.IMDG_COMP_GRP_CD     " ).append("\n"); 
		query.append("														,	A.IMDG_UN_NO           " ).append("\n"); 
		query.append("														,	A.IMDG_UN_NO_SEQ       " ).append("\n"); 
		query.append("														,	A.CNTR_TP_CD           " ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD1" ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD2" ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD3" ).append("\n"); 
		query.append("														,	A.IMDG_SUBS_RSK_LBL_CD4" ).append("\n"); 
		query.append("														,	A.NET_WGT,A.GRS_WGT" ).append("\n"); 
		query.append("														,	A.NET_EXPLO_WGT    " ).append("\n"); 
		query.append("														,	A.VPS_ETA_DT       " ).append("\n"); 
		query.append("														,	A.IMDG_PCK_GRP_CD  " ).append("\n"); 
		query.append("													FROM	(" ).append("\n"); 
		query.append("													        " ).append("\n"); 
		query.append("                                                    SELECT 	A.BKG_NO" ).append("\n"); 
		query.append("                                                    	,	A.DCGO_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.SLAN_CD" ).append("\n"); 
		query.append("                                                    	,	A.VSL_CD" ).append("\n"); 
		query.append("														,   A.VVD" ).append("\n"); 
		query.append("                                                    	,	A.CUR_PORT_CD" ).append("\n"); 
		query.append("                                                        ,   A.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.CUR_PORT_MAX_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.CUR_PORT_MIN_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.POL_CD" ).append("\n"); 
		query.append("                                                        ,   A.POL_CLPT_IND_SEQ   " ).append("\n"); 
		query.append("                                                    	,	A.BKG_POL_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.POD_CD" ).append("\n"); 
		query.append("                                                        ,   A.POD_CLPT_IND_SEQ    " ).append("\n"); 
		query.append("                                                    	,	A.BKG_POD_SEQ" ).append("\n"); 
		query.append("                                                    	,	A.WGT_UT_CD" ).append("\n"); 
		query.append("                                                    	,	A.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                                    	,	A.FLSH_PNT_CDO_TEMP" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_UN_NO" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_UN_NO_SEQ" ).append("\n"); 
		query.append("                                                      ,  A.CNTR_TP_CD" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD1" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD2" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD3" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_SUBS_RSK_LBL_CD4" ).append("\n"); 
		query.append("                                                      ,  A.NET_WGT,A.GRS_WGT" ).append("\n"); 
		query.append("                                                      ,  A.NET_EXPLO_WGT" ).append("\n"); 
		query.append("                                                      ,  A.VPS_ETA_DT" ).append("\n"); 
		query.append("                                                      ,  A.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                                                      ,  ROW_NUMBER() OVER (PARTITION BY NVL(G.BKG_NO,A.BKG_NO), NVL(G.SPCL_CGO_APRO_RQST_SEQ,A.SPCL_CGO_APRO_RQST_SEQ), NVL(G.VSL_PRE_PST_CD,A.VSL_PRE_PST_CD), NVL(G.VSL_SEQ,A.VSL_SEQ), NVL(G.DCGO_SEQ,A.DCGO_SEQ) ORDER BY G.DCGO_SEQ ASC) CORR_AUTH_SEQ" ).append("\n"); 
		query.append("                                                      " ).append("\n"); 
		query.append("                                                      FROM" ).append("\n"); 
		query.append("                                                             (" ).append("\n"); 
		query.append("                                                -- Own BKG`s SPCL CGO Info" ).append("\n"); 
		query.append("                                                SELECT 		SDC.BKG_NO" ).append("\n"); 
		query.append("														,	SDC.SPCL_CGO_APRO_CD," ).append("\n"); 
		query.append("                                                           SDC.DCGO_SEQ," ).append("\n"); 
		query.append("                                                           VVPS.SLAN_CD," ).append("\n"); 
		query.append("                                                           VVPS.VSL_CD," ).append("\n"); 
		query.append("                                                           (SELECT " ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| " ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||" ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||" ).append("\n"); 
		query.append("                                                           DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD" ).append("\n"); 
		query.append("                                                           FROM VSK_VSL_PORT_SKD " ).append("\n"); 
		query.append("                                                           WHERE VSL_CD = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                           AND   SKD_VOY_NO = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                           AND   SKD_DIR_CD = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                           AND   VPS_PORT_CD = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                           AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                           ) AS VVD," ).append("\n"); 
		query.append("                                                           " ).append("\n"); 
		query.append("                                                           @[plmt_port_cd]  AS CUR_PORT_CD," ).append("\n"); 
		query.append("                                                           VVPS.CLPT_IND_SEQ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                           (SELECT MAX(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("															   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MAX_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT MIN(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("													           AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                                AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MIN_SEQ,                                                   " ).append("\n"); 
		query.append("                                                           SVAR.POL_CD," ).append("\n"); 
		query.append("	                                                       SVAR.POL_CLPT_IND_SEQ,    " ).append("\n"); 
		query.append("                                                           (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = BVD.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.CLPT_IND_SEQ = BVD.POL_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  = BVD.POL_CD" ).append("\n"); 
		query.append("                                                               ) AS BKG_POL_SEQ," ).append("\n"); 
		query.append("                                                            SVAR.POD_CD," ).append("\n"); 
		query.append("															SVAR.POD_CLPT_IND_SEQ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("                                                               (" ).append("\n"); 
		query.append("                                                               SELECT   T1.CLPT_SEQ" ).append("\n"); 
		query.append("                                                               FROM     VSK_VSL_PORT_SKD             T1" ).append("\n"); 
		query.append("                                                               WHERE    T1.VSL_CD                    = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_VOY_NO                = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_DIR_CD                = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               AND      T1.VPS_PORT_CD               = BVD.POD_CD" ).append("\n"); 
		query.append("                                                               AND      T1.CLPT_IND_SEQ              = BVD.POD_CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                               )    AS BKG_POD_SEQ," ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                           NVL(SDC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                                           SDC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                                           SDC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                                           SDC.IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                                           SDC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                                           SDC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                                           SUBSTR(SDC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                                           SDC.IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_WGT), SDC.NET_WGT) AS NET_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.GRS_WGT), SDC.GRS_WGT) AS GRS_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SDC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SDC.NET_EXPLO_WGT), SDC.NET_EXPLO_WGT) AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                           VVPS.VPS_ETA_DT, SDC.IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                                           SVAR.VSL_PRE_PST_CD, SVAR.VSL_SEQ  , SAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                                  FROM BKG_DG_CGO        SDC," ).append("\n"); 
		query.append("                                                       SCG_APRO_RQST     SAR," ).append("\n"); 
		query.append("                                                       SCG_VVD_APRO_RQST SVAR," ).append("\n"); 
		query.append("                                                       BKG_VVD           BVD," ).append("\n"); 
		query.append("                                                       VSK_VSL_PORT_SKD  VVPS" ).append("\n"); 
		query.append("                                                  WHERE 1 = 1" ).append("\n"); 
		query.append("                                                   AND SDC.BKG_NO                 = SAR.BKG_NO" ).append("\n"); 
		query.append("                                                   AND SAR.BKG_NO                 = SVAR.BKG_NO" ).append("\n"); 
		query.append("                                                   AND SAR.SPCL_CGO_APRO_RQST_SEQ = SVAR.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("												   -- BDR 이후 POST VVD만 Request오는 경우 고려, LST_RQST_DAT_FLG='Y' 조건 대신 적용" ).append("\n"); 
		query.append("                                                   AND SVAR.SPCL_CGO_APRO_RQST_SEQ = (SELECT MAX(RV.SPCL_CGO_APRO_RQST_SEQ) " ).append("\n"); 
		query.append("                                                                            			FROM SCG_VVD_APRO_RQST RV," ).append("\n"); 
		query.append("                                                                                             SCG_APRO_RQST RV2" ).append("\n"); 
		query.append("                                                                                     	WHERE RV.VSL_CD = BVD.VSL_CD" ).append("\n"); 
		query.append("                                                                                     	AND   RV.SKD_VOY_NO = BVD.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                                                     	AND   RV.SKD_DIR_CD = BVD.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                                                     	AND   RV.BKG_NO = BVD.BKG_NO                                                                                                      " ).append("\n"); 
		query.append("                                                                                        AND   RV2.BKG_No = RV.BKG_NO" ).append("\n"); 
		query.append("                                                                                        AND RV.SPCL_CGO_APRO_RQST_SEQ = RV2.SPCL_CGO_APRO_RQST_SEQ" ).append("\n"); 
		query.append("                                                                                        AND   RV2.SPCL_CGO_CATE_CD = 'DG'" ).append("\n"); 
		query.append("                                                                                       )" ).append("\n"); 
		query.append("                                                   AND SVAR.BKG_NO                = BVD.BKG_NO" ).append("\n"); 
		query.append("                                                   AND SVAR.VSL_PRE_PST_CD        = BVD.VSL_PRE_PST_CD" ).append("\n"); 
		query.append("                                                   AND SVAR.VSL_SEQ               = BVD.VSL_SEQ" ).append("\n"); 
		query.append("                                                   AND SVAR.VSL_CD                = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SVAR.SKD_VOY_NO            = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SVAR.SKD_DIR_CD            = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port" ).append("\n"); 
		query.append("                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB" ).append("\n"); 
		query.append("                                                                             WHERE SUB.VSL_CD = SVAR.VSL_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_VOY_NO = SVAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_DIR_CD = SVAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  " ).append("\n"); 
		query.append("                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                                           )        " ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port" ).append("\n"); 
		query.append("                                                   --AND SVAR.POL_CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                   AND SDC.SPCL_CGO_APRO_CD IS NOT NULL" ).append("\n"); 
		query.append("                                                   AND SDC.SPCL_CGO_APRO_CD NOT IN ('C','D','N')" ).append("\n"); 
		query.append("                                                   --AND SAR.LST_RQST_DAT_FLG = 'Y'" ).append("\n"); 
		query.append("                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                   AND EXISTS (" ).append("\n"); 
		query.append("                                                              SELECT 1" ).append("\n"); 
		query.append("                                                                FROM BKG_BOOKING C" ).append("\n"); 
		query.append("                                                               WHERE SDC.BKG_NO = C.BKG_NO" ).append("\n"); 
		query.append("                                                                 AND C.BKG_STS_CD <> 'X'" ).append("\n"); 
		query.append("                                                            )" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                   #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                                    AND SVAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                                    AND SDC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("														)" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                    ) A" ).append("\n"); 
		query.append("                        						,  SCG_AUTHORIZATION G" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                             WHERE   A.BKG_NO                             = G.BKG_NO           (+)" ).append("\n"); 
		query.append("                                             AND   A.SPCL_CGO_APRO_RQST_SEQ       = G.SPCL_CGO_APRO_RQST_SEQ   (+)" ).append("\n"); 
		query.append("                                             AND   A.VSL_PRE_PST_CD                   = G.VSL_PRE_PST_CD       (+)" ).append("\n"); 
		query.append("                                             AND   A.VSL_SEQ                           = G.VSL_SEQ         (+)" ).append("\n"); 
		query.append("                                             AND   A.DCGO_SEQ                     = G.DCGO_SEQ         (+)" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                             #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                              AND  G.SPCL_CGO_AUTH_CD                 = 'P'" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                             #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                              AND  NVL(G.SPCL_CGO_AUTH_CD,'R')     = 'R'" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("                                             #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                              AND  G.SPCL_CGO_AUTH_CD                 = 'Y'" ).append("\n"); 
		query.append("                                             #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                              AND   A.SPCL_CGO_APRO_CD           IN ('P','R','Y')" ).append("\n"); 
		query.append("                                              " ).append("\n"); 
		query.append("                                              ) A" ).append("\n"); 
		query.append("                                              WHERE CORR_AUTH_SEQ                = 1" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("											--=========== TOP.TOP.TOP ==============================================================--" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                UNION ALL" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                -- Partner Lines SPCL CGO Info" ).append("\n"); 
		query.append("                                                SELECT SPAR.BKG_REF_NO," ).append("\n"); 
		query.append("                                                       SPAC.DCGO_SEQ," ).append("\n"); 
		query.append("                                                       SPAR.SLAN_CD," ).append("\n"); 
		query.append("                                                       SPAR.VSL_CD," ).append("\n"); 
		query.append("                                                       (SELECT " ).append("\n"); 
		query.append("                                                       DECODE(TURN_PORT_FLG,'N', SKD_VOY_NO, TURN_SKD_VOY_NO)|| " ).append("\n"); 
		query.append("                                                       DECODE(TURN_PORT_FLG,'N', SKD_DIR_CD, TURN_SKD_DIR_CD)||" ).append("\n"); 
		query.append("                                                       DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_VOY_NO,SKD_VOY_NO), SKD_VOY_NO)||" ).append("\n"); 
		query.append("                                                       DECODE(TURN_PORT_FLG,'N', NVL(TURN_SKD_DIR_CD,SKD_DIR_CD), SKD_DIR_CD) AS VVD" ).append("\n"); 
		query.append("                                                       FROM VSK_VSL_PORT_SKD " ).append("\n"); 
		query.append("                                                       WHERE VSL_CD = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                       AND   SKD_VOY_NO = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                       AND   SKD_DIR_CD = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                       AND   VPS_PORT_CD = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                       AND   CLPT_IND_SEQ = VVPS.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                                                       ) AS VVD," ).append("\n"); 
		query.append("														@[plmt_port_cd]	AS CUR_PORT_CD," ).append("\n"); 
		query.append("                                                        VVPS.CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT MAX(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("									                           AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MAX_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT MIN(SVVPS.CLPT_SEQ)" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("											                   AND NVL(SVVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  =  @[plmt_port_cd]" ).append("\n"); 
		query.append("                                                               #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                               #end" ).append("\n"); 
		query.append("                                                               ) AS CUR_PORT_MIN_SEQ,                                                   " ).append("\n"); 
		query.append("                                                           SPAR.POL_CD," ).append("\n"); 
		query.append("														   SPAR.POL_CLPT_IND_SEQ," ).append("\n"); 
		query.append("                                                           (SELECT SVVPS.CLPT_SEQ" ).append("\n"); 
		query.append("                                                              FROM VSK_VSL_PORT_SKD  SVVPS" ).append("\n"); 
		query.append("                                                             WHERE 1=1" ).append("\n"); 
		query.append("                                                               AND SVVPS.SLAN_CD      = SPAR.SLAN_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.VSL_CD       = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_VOY_NO   = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND SVVPS.SKD_DIR_CD   = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               --AND SVVPS.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                               AND SVVPS.CLPT_IND_SEQ = NVL(SPAR.POL_CLPT_IND_SEQ,1)" ).append("\n"); 
		query.append("                                                               AND SVVPS.VPS_PORT_CD  = SPAR.POL_CD" ).append("\n"); 
		query.append("                                                               ) AS BKG_POL_SEQ," ).append("\n"); 
		query.append("                                                            SPAR.POD_CD," ).append("\n"); 
		query.append("															SPAR.POD_CLPT_IND_SEQ," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("                                                               (" ).append("\n"); 
		query.append("                                                               SELECT   T1.CLPT_SEQ" ).append("\n"); 
		query.append("                                                               FROM     VSK_VSL_PORT_SKD             T1" ).append("\n"); 
		query.append("                                                               WHERE    T1.VSL_CD                    = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_VOY_NO                = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                               AND      T1.SKD_DIR_CD                = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                               AND      T1.VPS_PORT_CD               = SPAR.POD_CD" ).append("\n"); 
		query.append("                                                               AND      T1.CLPT_IND_SEQ              = NVL(SPAR.POD_CLPT_IND_SEQ,1)" ).append("\n"); 
		query.append("                                                               )		AS BKG_POD_SEQ,                                                               " ).append("\n"); 
		query.append("                                                               --- TOP.TOP.TOP ----------------------------------------------------------------------------------------" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                           NVL(SPAC.WGT_UT_CD, 'KGS') AS WGT_UT_CD," ).append("\n"); 
		query.append("                                                           SPAC.IMDG_CLSS_CD," ).append("\n"); 
		query.append("                                                           SPAC.FLSH_PNT_CDO_TEMP," ).append("\n"); 
		query.append("                                                           (SELECT IMDG_COMP_GRP_CD FROM SCG_IMDG_UN_NO WHERE  IMDG_UN_NO = SPAC.IMDG_UN_NO AND  IMDG_UN_NO_SEQ = SPAC.IMDG_UN_NO_SEQ) AS IMDG_COMP_GRP_CD," ).append("\n"); 
		query.append("                                                              SPAC.IMDG_UN_NO," ).append("\n"); 
		query.append("                                                           SPAC.IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                                            SUBSTR(SPAC.CNTR_TPSZ_CD, 0, 1) AS CNTR_TP_CD," ).append("\n"); 
		query.append("                                                            SPAC.N1ST_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD1," ).append("\n"); 
		query.append("                                                            SPAC.N2ND_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD2," ).append("\n"); 
		query.append("                                                            SPAC.N3RD_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD3," ).append("\n"); 
		query.append("                                                            SPAC.N4TH_IMDG_SUBS_RSK_LBL_CD AS IMDG_SUBS_RSK_LBL_CD4," ).append("\n"); 
		query.append("                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_WGT), SPAC.NET_WGT) AS NET_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.GRS_WGT), SPAC.GRS_WGT) AS GRS_WGT," ).append("\n"); 
		query.append("                                                           DECODE(SPAC.WGT_UT_CD, 'LBS', TRS_COMMON_PKG.GET_CONV_WGT_TO_KG_FNC('LBS',SPAC.NET_EXPLO_WGT), SPAC.NET_EXPLO_WGT) AS NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                           VVPS.VPS_ETA_DT," ).append("\n"); 
		query.append("                                                           SPAC.IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("                                                 FROM  SCG_PRNR_APRO_RQST      SPAR," ).append("\n"); 
		query.append("                                                       SCG_PRNR_APRO_RQST_CGO  SPAC," ).append("\n"); 
		query.append("                                                       VSK_VSL_PORT_SKD        VVPS" ).append("\n"); 
		query.append("                                                 WHERE 1=1" ).append("\n"); 
		query.append("                                                   AND SPAR.CRR_CD            = SPAC.CRR_CD" ).append("\n"); 
		query.append("                                                   AND SPAR.BKG_REF_NO        = SPAC.BKG_REF_NO" ).append("\n"); 
		query.append("												   AND SPAR.PRNR_CGO_RQST_SEQ = SPAC.PRNR_CGO_RQST_SEQ" ).append("\n"); 
		query.append("                                                   AND SPAR.SPCL_CGO_RQST_SEQ = SPAC.SPCL_CGO_RQST_SEQ" ).append("\n"); 
		query.append("                                                   AND SPAR.VSL_CD            = VVPS.VSL_CD" ).append("\n"); 
		query.append("                                                   AND SPAR.SKD_VOY_NO        = VVPS.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                   AND SPAR.SKD_DIR_CD        = VVPS.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                   --AND NVL(SPAR.POL_CLPT_IND_SEQ,1)  = VVPS.CLPT_IND_SEQ                                                 " ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port" ).append("\n"); 
		query.append("                                                   --AND SVAR.POL_CD                 = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND @[plmt_port_cd]             = VVPS.VPS_PORT_CD" ).append("\n"); 
		query.append("                                                   AND VVPS.CLPT_IND_SEQ IN( SELECT SUB.CLPT_IND_SEQ FROM VSK_VSL_PORT_SKD SUB" ).append("\n"); 
		query.append("                                                                             WHERE SUB.VSL_CD = SPAR.VSL_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_VOY_NO = SPAR.SKD_VOY_NO" ).append("\n"); 
		query.append("                                                                             AND   SUB.SKD_DIR_CD = SPAR.SKD_DIR_CD" ).append("\n"); 
		query.append("                                                                             AND   SUB.VPS_PORT_CD = @[plmt_port_cd]  " ).append("\n"); 
		query.append("                                                                             --AND   SUB.TURN_PORT_IND_CD IN ('Y','N')" ).append("\n"); 
		query.append("                                                                           )" ).append("\n"); 
		query.append("                                                   --2016-08-18 ETA from Current Port                                                   " ).append("\n"); 
		query.append("                                                   --AND VVPS.TURN_PORT_IND_CD      IN ('Y','N')" ).append("\n"); 
		query.append("                                                   AND SPAR.DG_FLG            = 'Y'" ).append("\n"); 
		query.append("                                                   AND SPAR.LST_RQST_DAT_FLG  = 'Y'" ).append("\n"); 
		query.append("                                                   AND NVL(VVPS.SKD_CNG_STS_CD,'*') <> 'S'" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                   #if (${auth_flg} == 'P')" ).append("\n"); 
		query.append("                                                   AND    SPAC.AUTH_STS_CD          = 'P'" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${auth_flg} == 'R')" ).append("\n"); 
		query.append("                                                   AND SPAC.AUTH_STS_CD = 'R'" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${auth_flg} == 'Y')" ).append("\n"); 
		query.append("                                                   AND SPAC.AUTH_STS_CD             = 'Y'" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   AND SPAC.AUTH_STS_CD IN('P','R','Y')" ).append("\n"); 
		query.append("                                                   --AND SPAC.AUTH_STS_CD IN('Y','N','R','P')" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                   #if (${slan_cd1} != '')" ).append("\n"); 
		query.append("                                                    AND SPAR.SLAN_CD = @[slan_cd1]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${imdg_clss_cd} != '')" ).append("\n"); 
		query.append("                                                    AND SPAC.IMDG_CLSS_CD = @[imdg_clss_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${vsl_cd} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VSL_CD = @[vsl_cd]" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${skd_voy_no} != '' && ${skd_dir_cd} != '')" ).append("\n"); 
		query.append("                                                    AND(    (VVPS.SKD_VOY_NO = @[skd_voy_no] AND VVPS.SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("                                                         OR (VVPS.TURN_SKD_VOY_NO = @[skd_voy_no] AND VVPS.TURN_SKD_DIR_CD = @[skd_dir_cd])" ).append("\n"); 
		query.append("														)" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("                                                   #if (${from_eta_dt} != '' && ${to_eta_dt} != '')" ).append("\n"); 
		query.append("                                                    AND VVPS.VPS_ETA_DT BETWEEN TO_DATE(@[from_eta_dt],'YYYY-MM-DD') AND TO_DATE(@[to_eta_dt],'YYYY-MM-DD')+0.99999" ).append("\n"); 
		query.append("                                                   #end" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                                ) 	A" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                                                 --DEPARTURE 2016-04-13 WHERE CONDITION START--" ).append("\n"); 
		query.append("                                                  WHERE	" ).append("\n"); 
		query.append("														(BKG_POL_SEQ <= CUR_PORT_MIN_SEQ AND BKG_POD_SEQ > CUR_PORT_MIN_SEQ)" ).append("\n"); 
		query.append("                   										OR" ).append("\n"); 
		query.append("                  										(BKG_POL_SEQ <= CUR_PORT_MAX_SEQ AND BKG_POD_SEQ > CUR_PORT_MAX_SEQ)    " ).append("\n"); 
		query.append("											" ).append("\n"); 
		query.append("                                                 --DEPARTURE 2016-04-13 WHERE CONDITION END--                               " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("            --DEPARTURE SELECT 2016-04-13 END " ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                                         )" ).append("\n"); 
		query.append("                                        GROUP BY BKG_NO, DCGO_SEQ,SLAN_CD,VSL_CD,VVD,CUR_PORT_CD,CLPT_IND_SEQ,POL_CD,POD_CD,WGT_UT_CD,IMDG_CLSS_CD,FLSH_PNT_CDO_TEMP,IMDG_COMP_GRP_CD,IMDG_UN_NO,IMDG_UN_NO_SEQ," ).append("\n"); 
		query.append("                                                    CNTR_TP_CD,IMDG_SUBS_RSK_LBL_CD1,IMDG_SUBS_RSK_LBL_CD2,IMDG_SUBS_RSK_LBL_CD3,IMDG_SUBS_RSK_LBL_CD4,ARR_NET_WGT,ARR_GRS_WGT,ARR_NET_EXPLO_WGT," ).append("\n"); 
		query.append("                                                    DCHG_NET_WGT,DCHG_GRS_WGT,DCHG_NET_EXPLO_WGT,LOD_NET_WGT,LOD_GRS_WGT,LOD_NET_EXPLO_WGT,DEP_NET_WGT,DEP_GRS_WGT,DEP_NET_EXPLO_WGT,VPS_ETA_DT,IMDG_PCK_GRP_CD,PORT_LMT_KND" ).append("\n"); 
		query.append("                             )" ).append("\n"); 
		query.append("                        GROUP BY SLAN_CD, VSL_CD, VVD, CUR_PORT_CD,CLPT_IND_SEQ, POL_CD, POD_CD, WGT_UT_CD, IMDG_CLSS_CD, FLSH_PNT_CDO_TEMP, PORT_LMT_KND, VPS_ETA_DT, IMDG_PCK_GRP_CD," ).append("\n"); 
		query.append("                                  IMDG_COMP_GRP_CD,IMDG_UN_NO, IMDG_UN_NO_SEQ, CNTR_TP_CD, IMDG_SUBS_RSK_LBL_CD1, IMDG_SUBS_RSK_LBL_CD2, IMDG_SUBS_RSK_LBL_CD3, IMDG_SUBS_RSK_LBL_CD4, BKG_NO" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("                    ) DCGO" ).append("\n"); 
		query.append("            --*************************************************************************************************************" ).append("\n"); 
		query.append("            --2016-04-13 END" ).append("\n"); 
		query.append("            --*************************************************************************************************************" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("			WHERE	1 = 1" ).append("\n"); 
		query.append("			AND		PLMT.PORT_CD             				= DCGO.CUR_PORT_CD" ).append("\n"); 
		query.append("			AND		PLMT.PORT_LMT_KND 						= DCGO.PORT_LMT_KND" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--      		AND		CASE	WHEN PLMT.IMDG_COMP_GRP_CD IS NOT NULL THEN PLMT.IMDG_CLSS_CD||PLMT.IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("--                 			ELSE PLMT.IMDG_CLSS_CD" ).append("\n"); 
		query.append("--            		END                             		=	CASE	WHEN PLMT.IMDG_COMP_GRP_CD IS NOT NULL THEN DCGO.IMDG_CLSS_CD||DCGO.IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("--                                                   						ELSE DCGO.IMDG_CLSS_CD" ).append("\n"); 
		query.append("--                                              					END" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      		AND		CASE	WHEN PLMT.IMDG_COMP_GRP_CD IS NOT NULL THEN PLMT.IMDG_CLSS_CD||PLMT.IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("                 			ELSE " ).append("\n"); 
		query.append("                                CASE WHEN PLMT.IMDG_CLSS_CD IS NOT NULL THEN PLMT.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                     ELSE PLMT.IMDG_UN_NO" ).append("\n"); 
		query.append("                                END" ).append("\n"); 
		query.append("            		END			=	CASE	WHEN PLMT.IMDG_COMP_GRP_CD IS NOT NULL THEN DCGO.IMDG_CLSS_CD||DCGO.IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("                                			ELSE " ).append("\n"); 
		query.append("                                            	CASE WHEN PLMT.IMDG_CLSS_CD IS NOT NULL THEN DCGO.IMDG_CLSS_CD" ).append("\n"); 
		query.append("                                                	 ELSE DCGO.IMDG_UN_NO" ).append("\n"); 
		query.append("                                                END" ).append("\n"); 
		query.append("                                    END" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			AND		(PLMT.IMDG_UN_NO 			IS NULL OR PLMT.IMDG_UN_NO 				=  DCGO.IMDG_UN_NO			)" ).append("\n"); 
		query.append("			AND		(PLMT.CNTR_TP_CD 			IS NULL OR PLMT.CNTR_TP_CD 				=  DCGO.CNTR_TP_CD			)" ).append("\n"); 
		query.append("			AND		(PLMT.IMDG_SUBS_RSK_LBL_CD 	IS NULL OR PLMT.IMDG_SUBS_RSK_LBL_CD 	IN (DCGO.IMDG_SUBS_RSK_LBL_CD1, DCGO.IMDG_SUBS_RSK_LBL_CD2, DCGO.IMDG_SUBS_RSK_LBL_CD3, DCGO.IMDG_SUBS_RSK_LBL_CD4))" ).append("\n"); 
		query.append("			AND		(PLMT.FLSH_PNT_TEMP 		IS NULL OR PLMT.FLSH_PNT_TEMP 			>= DCGO.FLSH_PNT_CDO_TEMP	)" ).append("\n"); 
		query.append("			AND		(PLMT.IMDG_PCK_GRP_CD 		IS NULL OR PLMT.IMDG_PCK_GRP_CD 		=  DCGO.IMDG_PCK_GRP_CD		)" ).append("\n"); 
		query.append("			AND		DCGO.CUR_PORT_CD 						= @[plmt_port_cd]" ).append("\n"); 
		query.append(" 			) B" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			GROUP BY 	PORT_CD" ).append("\n"); 
		query.append("				,		PORT_LMT_SEQ" ).append("\n"); 
		query.append("				,		PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("			" ).append("\n"); 
		query.append("				,		ARRIVAL_BKG_NO" ).append("\n"); 
		query.append("				,		DISCHARGE_BKG_NO" ).append("\n"); 
		query.append("				,		LOAD_BKG_NO" ).append("\n"); 
		query.append("				,		DEPARTURE_BKG_NO    " ).append("\n"); 
		query.append("			" ).append("\n"); 
		query.append("				,		SLAN_CD" ).append("\n"); 
		query.append("				,		CUR_PORT_CD" ).append("\n"); 
		query.append("				,		PIER_TP_CD" ).append("\n"); 
		query.append("				,		VSL_CD" ).append("\n"); 
		query.append("				,       PLMT_VVD" ).append("\n"); 
		query.append("				,   	IMDG_CLSS_CD " ).append("\n"); 
		query.append("				,		FLSH_PNT_TEMP" ).append("\n"); 
		query.append("				,		IMDG_CLSS_CD_DESC" ).append("\n"); 
		query.append("				,		LMT_WGT_TP_CD" ).append("\n"); 
		query.append("				,		IMDG_COMP_GRP_CD" ).append("\n"); 
		query.append("				,		IMDG_PCK_GRP_CD" ).append("\n"); 
		query.append("				,		IMDG_SUBS_RSK_LBL_CD" ).append("\n"); 
		query.append("				,		IMDG_UN_NO" ).append("\n"); 
		query.append("				,		CNTR_TP_CD" ).append("\n"); 
		query.append("				,		ARR_DEP_PROHI_FLG" ).append("\n"); 
		query.append("				,		LDIS_APLY_TGT_FLG" ).append("\n"); 
		query.append("				,		ARR_MAX_LMT" ).append("\n"); 
		query.append("				,		DCHG_MAX_LMT" ).append("\n"); 
		query.append("				,		LOD_MAX_LMT" ).append("\n"); 
		query.append("				,		DEP_MAX_LMT" ).append("\n"); 
		query.append("				,       PLMT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("				) A" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("			) A" ).append("\n"); 
		query.append("GROUP BY	A.PORT_CD" ).append("\n"); 
		query.append("		,	A.PORT_LMT_SEQ" ).append("\n"); 
		query.append("		,	A.PORT_LMT_REP_DESC" ).append("\n"); 
		query.append("		,	A.LMT_WGT_TP_CD" ).append("\n"); 
		query.append("		,	A.VSL_CD" ).append("\n"); 
		query.append("		,   A.PLMT_VVD " ).append("\n"); 
		query.append("		,	A.SLAN_CD" ).append("\n"); 
		query.append("		,	A.CUR_PORT_CD" ).append("\n"); 
		query.append("		,	A.PIER_TP_CD" ).append("\n"); 
		query.append("		,	A.FLSH_PNT_TEMP " ).append("\n"); 
		query.append("		,   PLMT_CLPT_IND_SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("ORDER BY 	(	SELECT 	B.DP_SEQ " ).append("\n"); 
		query.append("				FROM 	SCG_IMDG_PORT_LMT_MST 	B" ).append("\n"); 
		query.append("      			WHERE 	B.PORT_CD 				= A.PORT_CD " ).append("\n"); 
		query.append("				AND 	B.LMT_WGT_TP_CD 		= DECODE(A.LMT_WGT_TP_CD, 'GROSS', 'GR', 'NET', 'NT', 'NET POWDER', 'NP', NULL) " ).append("\n"); 
		query.append("				AND 	B.PORT_LMT_SEQ 			= A.PORT_LMT_SEQ" ).append("\n"); 
		query.append("			)" ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append("              	" ).append("\n"); 
		query.append("			--==========================================================================================================" ).append("\n"); 
		query.append("			) " ).append("\n"); 

	}
}