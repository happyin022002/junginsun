<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WorkOrderPreviewEdiDBDAOsearchFlatFileEsvOriginRSQL">
			<desc><![CDATA[NYK-Hawk_FFile(ESV_N)-JOEDI_EU_OUTBOUND
{ORIGIN]]></desc>
			<sql><![CDATA[
SELECT T1.* 
FROM 
(
SELECT SO.FM_NOD_CD AS ORG_LOC
      ,'' AS ORG_REF
      ,A.YD_NM AS ORG_NM
      ,REGEXP_SUBSTR(A.YD_ADDR, '+[^,]+', 1, 1) AS ORG_ADD1
      ,REGEXP_SUBSTR(A.YD_ADDR, '+[^,]+', 1, 2) AS ORG_ADD2
      ,REGEXP_SUBSTR(A.YD_ADDR, '+[^,]+', 1, 3) AS ORG_ADD3
      ,REGEXP_SUBSTR(A.YD_ADDR, '+[^,]+', 1, 4) AS ORG_ADD4
      ,A.YD_LOC_CTY_NM ORG_CITY
      ,B.STE_NM AS ORG_STATE
      ,SUBSTR(SO.FM_NOD_CD, 1, 2) ORG_CNT
      ,A.ZIP_CD ORG_POSTAL
      ,'' ORG_TZ
      ,'' ORG_CONTACT_NM
      ,'' ORG_CONTACT_TE
      ,'' ORG_COMMENT
      ,TO_CHAR(DECODE(SO.TRSP_SO_TP_CD , 'Y', TMP.N1ST_NOD_PLN_DT, SO.N1ST_NOD_PLN_DT), 'YYYYMMDDHH24MISS') ORG_PLN_DT
      ,(SELECT TO_CHAR(MAX(COP.ACT_DT), 'YYYYMMDDHH24MISS')
          FROM SCE_COP_DTL COP
         WHERE COP.COP_NO = SO.COP_NO
           AND COP.NOD_CD = SO.FM_NOD_CD
           AND SUBSTR(COP.ACT_CD, 5, 2) = 'DO'
           AND SUBSTR(COP.ACT_CD, 3, 1) = SUBSTR(SO.TRSP_CRR_MOD_CD, 1, 1)) ORG_ACTL_DT
      ,'Pickup' ORG_TYPE
  FROM TRS_TRSP_WRK_ORD_PRV_TMP TMP
      ,TRS_TRSP_SVC_ORD     SO
      ,MDM_YARD             A
      ,MDM_STATE            B
 WHERE TMP.WO_PRV_GRP_SEQ = @[wo_prv_grp_seq]
   AND TMP.WO_ISS_NO = @[wo_iss_no]
   AND SO.TRSP_SO_OFC_CTY_CD = @[trsp_so_ofc_cty_cd]
   AND SO.TRSP_SO_SEQ = @[trsp_so_seq]
   AND TMP.TRSP_SO_OFC_CTY_CD = SO.TRSP_SO_OFC_CTY_CD
   AND TMP.TRSP_SO_SEQ = SO.TRSP_SO_SEQ
   AND SO.FM_NOD_CD = A.YD_CD(+)
   AND SUBSTR(A.LOC_CD, 1, 2) = B.CNT_CD(+)
   AND A.YD_LOC_STE_CD = B.STE_CD(+)
) T1 RIGHT OUTER JOIN DUAL
  ON 1 = 1			]]></sql>
			<params>
				<param name="wo_prv_grp_seq" type="12" value="" out="N"/>
				<param name="wo_iss_no" type="12" value="" out="N"/>
				<param name="trsp_so_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="trsp_so_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
