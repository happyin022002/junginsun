<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WorkOrderPreviewEdiDBDAOsearchFlatFileEsvHazardRSQL">
			<desc><![CDATA[NYK-Hawk_FFile(ESV_N)-JOEDI_EU_OUTBOUND
{HAZARDODUS]]></desc>
			<sql><![CDATA[
SELECT T1.*
  FROM (
		SELECT DG.BKG_NO
			  ,DG.DCGO_SEQ
			  ,DG.PRP_SHP_NM AS PRO_SH_NAME
			  ,DG.HZD_DESC AS TECH_NAME
			  ,P.IMDG_PCK_DESC AS D_PKG
			  ,DG.OUT_IMDG_PCK_CD1 AS D_PKG_CD
			  ,DG.OUT_IMDG_PCK_QTY1 AS D_PKG_QTY
			  ,DG.IMDG_UN_NO AS UN_NO
			  ,'' EMS_NO
			  ,CASE WHEN DG.IMDG_PCK_GRP_CD IN ('1', '2', '3') THEN DG.IMDG_PCK_GRP_CD END D_PKG_GRP
			  ,DG.IMDG_CLSS_CD AS CLASS
			  ,DG.FLSH_PNT_CDO_TEMP AS FLASH
			  ,'C' AS FLASH_UNIT
			  ,DG.IMDG_LMT_QTY_FLG AS IMO_LIMIT
			  ,'' AS IMO_LIMIT_QTY
			  ,'' AS REPORT_QTY
			  ,DG.MRN_POLUT_FLG AS MAR_POLL
			  ,SUBSTR(REPLACE(REPLACE(DG.DIFF_RMK, CHR(10), ''), CHR(13), ''), 1, 80) AS REMARK
			  ,'' AS RESTRICT_CD
			  ,'' AS CONTACT_TYPE
			  ,DG.EMER_CNTC_PHN_NO_CTNT AS CONTACT_NO
			  ,SUBSTR(REPLACE(REPLACE(DG.EMER_CNTC_PSON_NM, CHR(10), ''), CHR(13), ''), 1, 60) AS CONTACT_INFO
			  ,DG.CNTR_NO
			  ,DG.CNTR_TPSZ_CD
		  FROM TRS_TRSP_SVC_ORD   SO
			  ,BKG_EUR_TRO_DG_SEQ DG_SEQ
			  ,BKG_DG_CGO         DG
			  ,SCG_IMDG_PCK_CD    P
		 WHERE SO.TRSP_SO_OFC_CTY_CD = @[trsp_so_ofc_cty_cd]
		   AND SO.TRSP_SO_SEQ = @[trsp_so_seq]
		   AND SUBSTR(SO.COST_ACT_GRP_CD, 1, 2) = 'OD'
		   AND SO.BKG_NO = DG_SEQ.BKG_NO
		   AND SO.TRSP_BND_CD = DG_SEQ.IO_BND_CD
		   AND SO.TRO_SEQ = DG_SEQ.TRO_SEQ
		   AND DG_SEQ.BKG_NO = DG.BKG_NO
		   AND DG_SEQ.TRO_DCGO_SEQ = DG.DCGO_SEQ
		   AND NVL(SO.EQ_NO, 'XXX') = NVL2(SO.EQ_NO, NVL(DG.CNTR_NO, NVL(SO.EQ_NO, 'XXX')), 'XXX')
		   AND DG.OUT_IMDG_PCK_CD1 = P.IMDG_PCK_CD(+)
		   AND NVL(P.DELT_FLG(+), 'N') = 'N'
		UNION
		SELECT DG.BKG_NO
			  ,DG.DCGO_SEQ
			  ,DG.PRP_SHP_NM AS PRO_SH_NAME
			  ,DG.HZD_DESC AS TECH_NAME
			  ,P.IMDG_PCK_DESC AS D_PKG
			  ,DG.OUT_IMDG_PCK_CD1 AS D_PKG_CD
			  ,DG.OUT_IMDG_PCK_QTY1 AS D_PKG_QTY
			  ,DG.IMDG_UN_NO AS UN_NO
			  ,'' EMS_NO
			  ,CASE WHEN DG.IMDG_PCK_GRP_CD IN ('1', '2', '3') THEN DG.IMDG_PCK_GRP_CD END D_PKG_GRP
			  ,DG.IMDG_CLSS_CD AS CLASS
			  ,DG.FLSH_PNT_CDO_TEMP AS FLASH
			  ,'C' AS FLASH_UNIT
			  ,DG.IMDG_LMT_QTY_FLG AS IMO_LIMIT
			  ,'' AS IMO_LIMIT_QTY
			  ,'' AS REPORT_QTY
			  ,DG.MRN_POLUT_FLG AS MAR_POLL
			  ,SUBSTR(REPLACE(REPLACE(DG.DIFF_RMK, CHR(10), ''), CHR(13), ''), 1, 80) AS REMARK
			  ,'' AS RESTRICT_CD
			  ,'' AS CONTACT_TYPE
			  ,DG.EMER_CNTC_PHN_NO_CTNT AS CONTACT_NO
			  ,SUBSTR(REPLACE(REPLACE(DG.EMER_CNTC_PSON_NM, CHR(10), ''), CHR(13), ''), 1, 60) AS CONTACT_INFO
			  ,DG.CNTR_NO
			  ,DG.CNTR_TPSZ_CD
		  FROM TRS_TRSP_SVC_ORD SO
			  ,BKG_DG_CGO       DG
			  ,SCG_IMDG_PCK_CD  P
		 WHERE SO.TRSP_SO_OFC_CTY_CD = @[trsp_so_ofc_cty_cd]
		   AND SO.TRSP_SO_SEQ = @[trsp_so_seq]
		   AND SUBSTR(SO.COST_ACT_GRP_CD, 1, 2) <> 'OD'
		   AND SO.BKG_NO = DG.BKG_NO
		   AND NVL(SO.EQ_NO, 'XXX') = NVL2(SO.EQ_NO, NVL(DG.CNTR_NO, NVL(SO.EQ_NO, 'XXX')), 'XXX')
		   AND DG.OUT_IMDG_PCK_CD1 = P.IMDG_PCK_CD(+)
		   AND NVL(P.DELT_FLG(+), 'N') = 'N'
 ) T1
 RIGHT OUTER JOIN DUAL
    ON 1 = 1			]]></sql>
			<params>
				<param name="trsp_so_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="trsp_so_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
