<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JOInvoiceManageDBDAOSearchErpInterfaceCheckDataRSQL">
			<desc><![CDATA[SearchErpInterfaceCheckData]]></desc>
			<sql><![CDATA[
SELECT
    --- SOURCE
    COUNT(DISTINCT A.N3PTY_EXPN_TP_CD) N3PTY_EXPN_TP_CD_CNT,
    MAX(A.N3PTY_EXPN_TP_CD) N3PTY_EXPN_TP_CD_MAX,
    --- BILLING CASE
    COUNT(DISTINCT Z.N3PTY_BIL_TP_CD) N3PTY_BIL_TP_CD_CNT,
    MAX(Z.N3PTY_BIL_TP_CD) N3PTY_BIL_TP_CD_MAX,
    --- 3RD PARTY
    COUNT( DISTINCT DECODE(A.VNDR_CUST_DIV_CD, 'V',TO_CHAR(A.VNDR_SEQ), 'C', A.CUST_CNT_CD||A.CUST_SEQ, 'S',A.N3PTY_OFC_CD, NULL) ) TRD_PARTY_CODE_CNT,
    MAX( DECODE(A.VNDR_CUST_DIV_CD, 'V',TO_CHAR(A.VNDR_SEQ), 'C', A.CUST_CNT_CD||A.CUST_SEQ, 'S',A.N3PTY_OFC_CD, NULL) ) TRD_PARTY_CODE_MAX,
    --- REVENUE VVD
    COUNT( DISTINCT NVL( DECODE(A.N3PTY_SRC_SUB_SYS_CD, 'MNR',NULL, A.VSL_CD||A.SKD_VOY_NO||A.FINC_DIR_CD), '-') ) REVENUE_VVD_CNT,
    MAX( DECODE(A.N3PTY_SRC_SUB_SYS_CD, 'MNR',NULL, A.VSL_CD||A.SKD_VOY_NO||A.FINC_DIR_CD) ) REVENUE_VVD_MAX,
    --- CURRENCY
    COUNT( DISTINCT Y.CURR_CD ) CURR_CD_CNT,
    MAX( Y.CURR_CD ) CURR_CD_MAX,
    --- ACTUAL VVD
    COUNT( DISTINCT NVL(Z.VVD_CD,'-' )) VVD_CD_CNT,
    MAX( Z.VVD_CD ) VVD_CD_MAX,
    --- CSR NO.
    COUNT( DISTINCT NVL(Z.CSR_NO,'-' )) CSR_NO_CNT,
    MAX( Z.CSR_NO ) CSR_NO_MAX,
    --- MONTH OF GL DATE
    COUNT( DISTINCT NVL(SUBSTRB(Z.GL_DT,1,6),'-') ) GL_MONTH_CNT,
    MAX( SUBSTRB(Z.GL_DT,1,6) ) GL_MONTH_MAX
FROM TPB_OTS_DTL A,
  TPB_OTS_GRP B,
  TPB_INV_RVIS_DTL Z,
  TPB_INV_RVIS Y,
  TPB_INVOICE X
WHERE Y.N3PTY_INV_NO = X.N3PTY_INV_NO
  AND Y.N3PTY_INV_NO = Z.N3PTY_INV_NO
  AND Y.N3PTY_INV_NO = B.N3PTY_INV_NO
  AND B.N3PTY_NO = A.N3PTY_NO
  AND A.N3PTY_DELT_TP_CD = 'N'
  AND X.N3PTY_DELT_TP_CD = 'N'
  AND Y.N3PTY_DELT_TP_CD = 'N'
  AND Z.N3PTY_DELT_TP_CD = 'N'
  AND Y.N3PTY_INV_NO = @[s_n3pty_inv_no]
  AND Y.N3PTY_INV_RVIS_SEQ = @[s_n3pty_inv_his_seq]			]]></sql>
			<params>
				<param name="s_n3pty_inv_no" type="12" value="" out="N"/>
				<param name="s_n3pty_inv_his_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
