<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WorkOrderManagementDBDAOsearchWorkOrderBFIDownForInvoiceRSQL">
			<desc><![CDATA[searchWorkOrderBFIDownForInvoiceRSQL]]></desc>
			<sql><![CDATA[
SELECT ROWNUM as SEQ,
       S.EQ_NO,
       S.EQ_TPSZ_CD,
       S.TRSP_SO_OFC_CTY_CD||S.TRSP_SO_SEQ as TRSP_SO_NO,
       S.TRSP_WO_OFC_CTY_CD||S.TRSP_WO_SEQ as TRSP_WO_NO,
       S.REF_INV_NO as INV_NO,
       S.BZC_AMT + NVL (S.FUEL_SCG_AMT, 0) + NVL (S.NEGO_AMT, 0) + NVL (S.ETC_ADD_AMT, 0) AS TOT_INV_AMT
  FROM TRS_TRSP_SVC_ORD S, TRS_TRSP_WRK_ORD W, SCE_COP_HDR SCE
 WHERE S.TRSP_WO_OFC_CTY_CD = W.TRSP_WO_OFC_CTY_CD
   AND S.TRSP_WO_SEQ = W.TRSP_WO_SEQ
   AND S.TRSP_SO_STS_CD = 'I'
   AND S.INV_NO IS NULL
   AND S.TRS_SUB_STS_CD IN ('ST', 'CM') 
   AND NVL(S.DELT_FLG,'N') = 'N'
   AND NVL(W.DELT_FLG,'N') = 'N'
   AND S.WO_EXE_DT BETWEEN TO_DATE(@[fm_dt]||'000000','YYYY-MM-DDHH24MISS') AND TO_DATE(@[to_dt]||'235959','YYYY-MM-DDHH24MISS')
#if (${cre_ofc_cd} != '')
   AND W.CRE_OFC_CD = @[cre_ofc_cd]
#end
#if (${vndr_seq} != '')
	#if (${temp_not_sp} == 'N')
		AND	W.WO_VNDR_SEQ IN (
	#else
		AND	W.WO_VNDR_SEQ NOT IN (
	#end
		#foreach ($user_vndrSeqs IN ${vndrSeqs})
			#if($velocityCount < $vndrSeqs.size())
				'$user_vndrSeqs',
			#else
				'$user_vndrSeqs'
			#end
		#end			  
	)
#end
   AND S.COP_NO = SCE.COP_NO(+)
   AND SCE.COP_STS_CD(+) IN ('C', 'T', 'F') 
 ORDER BY S.EQ_NO,S.EQ_TPSZ_CD,S.TRSP_SO_OFC_CTY_CD||S.TRSP_SO_SEQ, S.TRSP_WO_OFC_CTY_CD||S.TRSP_WO_SEQ			]]></sql>
			<params>
				<param name="fm_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
				<param name="cre_ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
