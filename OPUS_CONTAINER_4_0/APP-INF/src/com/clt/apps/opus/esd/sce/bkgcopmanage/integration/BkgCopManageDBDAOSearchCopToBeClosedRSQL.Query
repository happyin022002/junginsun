<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BkgCopManageDBDAOSearchCopToBeClosedRSQL">
			<desc><![CDATA[attachCntr 호출을 받았을 때 해당 container 가 다른 vvd 의 booking 에서 inbound 운송 진행 중일 경우 
lcl 을 포함한 모든 cop 를 찾아서 return 한다.]]></desc>
			<sql><![CDATA[
select bkg_no,  cop_no, cntr_no 
    from sce_cop_hdr 
    where (  trnk_vsl_cd, trnk_skd_voy_no, trnk_skd_dir_cd ) in ( 
            select  trnk_vsl_cd, trnk_skd_voy_no, trnk_skd_dir_cd 
            from sce_cop_hdr 
            where cntr_no = @[cntr_no]
            and cop_sts_cd in ('C', 'T' ) 
            minus 
            SELECT vsl_cd trnk_vsl_cd, skd_voy_no trnk_skd_voy_no, skd_dir_cd trnk_skd_dir_cd
            FROM bkg_booking 
            WHERE bkg_no = @[bkg_no]
                
          ) 
    and cntr_no = @[cntr_no]
    and cop_sts_cd in ('C', 'T' )			]]></sql>
			<params>
				<param name="cntr_no" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
