<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="PortPairRouteDBDAOSearchPortPairDetailsRSQL">
			<desc><![CDATA[SearchPortPairDetails]]></desc>
			<sql><![CDATA[
SELECT rout_rcv_dt                                      
       ,rout_seq                                         
       ,cust_trd_prnr_id                                 		
       ,por_cd                                           
       ,org_loc_cd AS pol_cd                            
       ,n1st_pol_cd                                      
       ,n1st_pod_cd                                      
       ,n2nd_pol_cd                                      
       ,n2nd_pod_cd                                      
       ,n3rd_pol_cd                                      
       ,n3rd_pod_cd                                      
       ,n4th_pol_cd                                      
       ,n4th_pod_cd                                      
       ,dest_loc_cd AS pod_cd                                                                                    
       ,del_cd                                               
       ,UPD_IND_CD AS ocean_flag                             
       ,use_flg                                              
       ,mnl_use_flg
       ,'' as delt_flg                                          
       ,cre_usr_id                                           
       ,TO_CHAR(cre_dt, 'YYYYMMDDHH24MI') AS cre_dt          
       ,DECODE(mnl_use_flg,'N',upd_usr_id,'')AS upd_usr_id                                 
       ,DECODE(mnl_use_flg,'N',TO_CHAR(upd_dt, 'YYYYMMDDHH24MI'),'') AS upd_dt          
   FROM sce_port_pair_dtl dtl
WHERE cust_trd_prnr_id = @[partner_id] 
/* condition - POR */
 #if (${por_port_cd} != '') 
 	AND por_cd = @[por_port_cd]
 #end
 
  /* condition - POL */
  #if (${pol_port_cd} != '') 
 	AND n1st_pol_cd = @[pol_port_cd]
 #end
 
  /* condition - POD */
  #if (${pod_port_cd} != '') 
 	AND dest_loc_cd = @[pod_port_cd]
 #end
 
  /* condition - DEL */
  #if (${del_port_cd} != '') 
 	AND del_cd = @[del_port_cd]
 #end
 

AND CASE WHEN @[no_use_flag] = 'Y'                                    
		                 AND NVL(mnl_use_flg,'Y') = 'Y' AND use_flg = 'Y'    
		            THEN 'Y'                                        
		            WHEN @[no_use_flag] = 'N'                                    
		                 --AND (mnl_use_flg = 'N' OR use_flg = 'N')   
						 AND mnl_use_flg = 'N'
		            THEN 'Y'                                        
		            ELSE 'N'                                        
		       END = 'Y'                                            
		   AND CASE WHEN @[ts_type] = 'A'                                   
		            THEN 'Y'                                        
		            WHEN @[ts_type] = 'D'                                    
		                 AND n2nd_pod_cd IS NULL                    
		                 AND n3rd_pod_cd IS NULL                    
		                 AND n4th_pod_cd IS NULL                    
		            THEN 'Y'                                        
		            WHEN @[ts_type] = 'T'                                    
		                 AND (n2nd_pod_cd IS NOT NULL               
		                      OR n3rd_pod_cd IS NOT NULL)           
		            THEN 'Y'                                        
		            ELSE 'N'                                        
		       END = 'Y'			]]></sql>
			<params>
				<param name="partner_id" type="12" value="" out="N"/>
				<param name="por_port_cd" type="12" value="" out="N"/>
				<param name="pol_port_cd" type="12" value="" out="N"/>
				<param name="pod_port_cd" type="12" value="" out="N"/>
				<param name="del_port_cd" type="12" value="" out="N"/>
				<param name="no_use_flag" type="12" value="" out="N"/>
				<param name="ts_type" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
