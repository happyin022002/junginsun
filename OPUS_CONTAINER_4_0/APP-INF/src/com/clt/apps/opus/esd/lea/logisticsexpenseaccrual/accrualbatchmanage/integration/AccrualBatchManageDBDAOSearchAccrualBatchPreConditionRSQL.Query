<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccrualBatchManageDBDAOSearchAccrualBatchPreConditionRSQL">
			<desc><![CDATA[   ]]></desc>
			<sql><![CDATA[
SELECT	EXE_YRMON
		,AP_CLZ_FLG
		,DECODE(AP_CLZ_FLG,'Y','Yes','No') AP_CLZ_FLG_NM
		,REV_VVD_IF_FLG
		,DECODE(REV_VVD_IF_FLG,'Y','Yes','No') REV_VVD_IF_FLG_NM
		,REV_VVD_DUP_CNT
		,REV_VVD_IF_KNT
		,DECODE(REV_VVD_IF_FLG,'Y','Yes','No')||CASE WHEN NVL(REV_VVD_IF_KNT,0) < 1 THEN ''ELSE  '( '||REV_VVD_IF_KNT||' )' END REV_VVD_IF_DESC
		,MON_AVG_XCH_RT_IF_FLG
		,DECODE(MON_AVG_XCH_RT_IF_FLG,'Y','Yes','No') MON_AVG_XCH_RT_IF_FLG_NM
		,MON_AVG_XCH_RT_IF_KNT
		,DECODE(MON_AVG_XCH_RT_IF_FLG,'Y','Yes','No') ||CASE 	WHEN NVL(MON_AVG_XCH_RT_IF_KNT,0) < 1 THEN ''
																ELSE  '( '||MON_AVG_XCH_RT_IF_KNT||' )' 
														END MON_AVG_XCH_RT_IF_FLG_DESC
		,COND_CFM_FLG
		,DECODE(COND_CFM_FLG,'Y','Yes','No') COND_CFM_FLG_NM
		,MNL_INP_FLG
		,DECODE(MNL_INP_FLG,'Y','Yes','No') MNL_INP_FLG_NM
		,ERP_IF_FLG
		,DECODE(ERP_IF_FLG,'Y','Yes','No') ERP_IF_FLG_NM
		,CASE WHEN REV_VVD_DUP_CNT > 0 THEN 'Rev. VVD duplicated'
				ELSE DECODE(ERP_IF_FLG,'Y','ERP I/F for Exe. Month '||EXE_YRMON||' Batch Completed',DECODE(COND_CFM_FLG,'Y','Confirmed'))
		END ERP_IF_FLG_DESC
		,ERP_IF_DT
FROM (
		SELECT 	EXE_YRMON
				,AP_CLZ_FLG
				,REV_VVD_IF_FLG
				,(	SELECT  COUNT(*) FROM GL_ESTM_REV_VVD
					WHERE (EXE_YRMON, REV_YRMON, VSL_CD, SKD_VOY_NO, SKD_DIR_CD, REV_DIR_CD, ESTM_IOC_DIV_CD)
							IN (SELECT	EXE_YRMON, REV_YRMON, VSL_CD, SKD_VOY_NO, SKD_DIR_CD, REV_DIR_CD, ESTM_IOC_DIV_CD
								FROM	GL_ESTM_REV_VVD
								WHERE 	ESTM_BC_DIV_CD = 'C' AND EXE_YRMON = REPLACE(@[frm_exe_yrmon],'-')
					GROUP BY EXE_YRMON, REV_YRMON, VSL_CD, SKD_VOY_NO, SKD_DIR_CD, REV_DIR_CD, ESTM_IOC_DIV_CD
					HAVING COUNT (ESTM_VVD_TP_CD) > 1 ) ) REV_VVD_DUP_CNT
				,REV_VVD_IF_KNT
				,MON_AVG_XCH_RT_IF_FLG
				,MON_AVG_XCH_RT_IF_KNT
				,COND_CFM_FLG
				,MNL_INP_FLG
				,ERP_IF_FLG
				,ERP_IF_DT
		FROM LEA_ACCL_COND_ITM
		WHERE EXE_YRMON = REPLACE(@[frm_exe_yrmon],'-')
)			]]></sql>
			<params>
				<param name="frm_exe_yrmon" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
