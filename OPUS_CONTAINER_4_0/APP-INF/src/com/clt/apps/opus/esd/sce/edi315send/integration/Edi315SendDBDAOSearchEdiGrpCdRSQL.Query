<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="Edi315SendDBDAOSearchEdiGrpCdRSQL">
			<desc><![CDATA[SearchEdiGrpCd]]></desc>
			<sql><![CDATA[
select RNUM, EDI_GRP_CD From (
    select RNUM, ltrim(sys_connect_by_path(EDI_GRP_CD,',') ,',') EDI_GRP_CD
    from (
        SELECT DISTINCT  G.EDI_GRP_CD EDI_GRP_CD, ROW_NUMBER()OVER (  ORDER BY EDI_GRP_CD) RNUM
        FROM    (  
                   SELECT  E.EDI_GRP_CD edi_group_cd, E.CUST_CNT_CD, E.CUST_SEQ, E.CGO_TRC_SVC_FLG, E.IB_SVC_FLG  
                   FROM    BKG_CUSTOMER B, EDI_GRP_CUST E  
                   WHERE   B.BKG_NO        =  @[bkg_no]
                       AND E.CUST_CNT_CD    = B.CUST_CNT_CD  
                       AND E.CUST_SEQ       = B.CUST_SEQ  
                   UNION  
                   SELECT  E.EDI_GRP_CD edi_group_cd,  E.CUST_CNT_CD, E.CUST_SEQ, E.CGO_TRC_SVC_FLG, E.IB_SVC_FLG  
                   FROM    BKG_BOOKING B, EDI_GRP_CUST E  
                   WHERE   B.BKG_NO        = @[bkg_no]
                       AND E.SC_NO         = DECODE(e.bkg_ctrt_div_cd,'1',b.sc_no,'2',b.rfa_no)  
               ) E, EDI_GROUP G  
        WHERE   G.EDI_GRP_CD = E.edi_group_cd  
        AND     G.DELT_FLG <> 'Y'  
        AND     E.CGO_TRC_SVC_FLG <> 'N'  
        AND     E.IB_SVC_FLG <> 'Y'  
        
        GROUP BY G.EDI_GRP_CD  
        )           
    START WITH RNUM = 1 CONNECT BY PRIOR RNUM = RNUM - 1       
    order by RNUM desc 
)
where rownum = 1			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
