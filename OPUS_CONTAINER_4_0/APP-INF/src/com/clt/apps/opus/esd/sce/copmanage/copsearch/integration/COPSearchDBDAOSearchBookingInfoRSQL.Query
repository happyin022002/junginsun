<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="COPSearchDBDAOSearchBookingInfoRSQL">
			<desc><![CDATA[SearchBookingInfo]]></desc>
			<sql><![CDATA[
SELECT a.*
     , TO_CHAR(d.snd_dt, 'YYYYMMDDHH24MISS') AS dbl_iss_dt
     , TO_CHAR(e.snd_dt, 'YYYYMMDDHH24MISS') AS ani_iss_dt
     , TO_CHAR(b.cre_dt, 'YYYYMMDDHH24MISS') AS ca_iss_dt
     , c.iss_dt AS niv_iss_dt
  FROM bkg_booking a
     ,(SELECT bkg_no, MAX(cre_dt) AS cre_dt
         FROM bkg_correction b 
        WHERE bkg_no = @[bkg_no]
        GROUP BY bkg_no
      ) b
     , (SELECT D.BKG_NO, A.ISS_DT 
         FROM INV_AR_ISS A
            , INV_AR_ISS_DTL B
            , INV_AR_MN D
        WHERE 1 =1 
          AND A.INV_NO = B.INV_NO
          AND B.AR_IF_NO = D.AR_IF_NO
          AND D.BKG_NO = @[bkg_no]
          AND INV_SEQ=1
          AND ROWNUM = 1
       ) c
    , (SELECT bkg_no, MAX(snd_dt) AS snd_dt
         FROM bkg_ntc_his
        WHERE bkg_no = @[bkg_no]
          AND ntc_knd_cd = 'BL'
        GROUP BY bkg_no 
      ) d
    , (SELECT bkg_no, MAX(snd_dt) AS snd_dt
         FROM bkg_ntc_his
        WHERE bkg_no = @[bkg_no]
          AND ntc_knd_cd = 'AN'
        GROUP BY bkg_no 
      ) e  
 WHERE a.bkg_no = b.bkg_no(+)
   AND a.bkg_no = c.bkg_no (+)
   AND a.bkg_no = d.bkg_no (+)
   AND a.bkg_no = e.bkg_no (+)
   AND a.bkg_no = @[bkg_no]			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
