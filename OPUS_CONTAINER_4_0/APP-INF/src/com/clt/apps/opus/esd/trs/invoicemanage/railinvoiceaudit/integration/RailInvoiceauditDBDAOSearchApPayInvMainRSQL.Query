<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RailInvoiceauditDBDAOSearchApPayInvMainRSQL">
			<desc><![CDATA[AP_PAY_INV csr insert]]></desc>
			<sql><![CDATA[
    SELECT DISTINCT
	    A.RGST_NO AS INV_RGST_NO
	    ,'TRS' AS INV_SUB_SYS_CD
	    ,A.CRE_OFC_CD AS INV_OFC_CD
	    ,C.CRE_OFC_CD AS COST_OFC_CD 
	    ,A.INV_VNDR_SEQ AS VNDR_SEQ
	    ,A.INV_NO
	    ,TO_CHAR(A.INV_ISS_DT,'YYYYMMDD') AS INV_ISS_DT
	    ,TO_CHAR(A.INV_RCV_DT,'YYYYMMDD') AS INV_RCV_DT
	    ,(SELECT GEN_PAY_TERM_CD FROM MDM_VENDOR WHERE VNDR_SEQ = A.INV_VNDR_SEQ) VNDR_TERM_NM
	    ,A.INV_CURR_CD
	    ,A.INV_TTL_AMT
	    ,A.INV_VAT_AMT
	    ,(A.INV_TTL_AMT - A.INV_VAT_AMT) INV_NET_AMT
	    ,0 WHLD_TAX_AMT
	    ,'' EQ_TP_CD -- TRS는 여러가지 EQ TYPE이 하나의 Invoice로 처리 될 수 있으므로 입력 불가능
	FROM
	    TRS_TRSP_RAIL_INV_WRK A,
	    TRS_TRSP_RAIL_INV_DTL B,
	    TRS_TRSP_RAIL_BIL_ORD C,
	    TRS_TRSP_RAIL_BIL_VNDR_SET D
	WHERE A.CRE_OFC_CD = @[ofc_cd]
	AND   A.INV_NO = @[inv_no]
	AND   A.TRSP_INV_AUD_STS_CD = 'CF'
	AND   NVL(A.INV_HLD_FLG , ' ') <> 'T'
	AND   NVL(A.DELT_FLG , 'N') = 'N'
	AND   NVL(C.DELT_FLG , 'N') = 'N'
	AND   A.INV_NO = B.INV_NO
	AND   A.INV_VNDR_SEQ = B.INV_VNDR_SEQ
	AND   B.INV_NO = D.INV_NO(+)
	AND   B.INV_VNDR_SEQ = D.INV_VNDR_SEQ(+)
	AND   B.TRSP_SO_OFC_CTY_CD = D.TRSP_SO_OFC_CTY_CD(+)
	AND   B.TRSP_SO_SEQ = D.TRSP_SO_SEQ(+)
	AND   B.TRSP_SO_SEQ = D.SUB_RAIL_SEQ(+)
	AND   B.TRSP_SO_OFC_CTY_CD = C.TRSP_SO_OFC_CTY_CD(+)
	AND   B.TRSP_SO_SEQ = C.TRSP_SO_SEQ(+)
			]]></sql>
			<params>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="inv_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
