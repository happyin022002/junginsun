<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WorkOrderPreviewDBDAOManageTrsTrspWrkOrdHisByVendorCMCSQL">
			<desc><![CDATA[WorkOrderPreviewDBDAOManageTrsTrspWrkOrdHisByVendorCM]]></desc>
			<sql><![CDATA[
INSERT INTO TRS_TRSP_WRK_ORD_HIS (
   TRSP_WO_OFC_CTY_CD,
   TRSP_WO_SEQ,
   WO_ISS_KNT,
   WO_ISS_STS_CD,
   WO_PRN_USE_FLG,
   WO_FAX_USE_FLG,
   WO_EML_USE_FLG,
   WO_EDI_USE_FLG,
   WO_N1ST_FAX_NO,
   WO_N2ND_FAX_NO,
   WO_N3RD_FAX_NO,
   WO_N1ST_FAX_SND_NO,
   WO_N2ND_FAX_SND_NO,
   WO_N3RD_FAX_SND_NO,
   WO_N1ST_FAX_RSLT_FLG,
   WO_N2ND_FAX_RSLT_FLG,
   WO_N3RD_FAX_RSLT_FLG,
   WO_N1ST_EML,
   WO_N2ND_EML,
   WO_N3RD_EML,
   WO_N1ST_EML_SND_NO,
   WO_N2ND_EML_SND_NO,
   WO_N3RD_EML_SND_NO,
   WO_N1ST_EML_RSLT_FLG,
   WO_N2ND_EML_RSLT_FLG,
   WO_N3RD_EML_RSLT_FLG,
   WO_RMK,
   WO_BL_NO_ISS_FLG,
   RT_DP_USE_FLG,
   CMDT_DP_USE_FLG,
   PRE_DIS_USE_FLG,
   DTN_USE_FLG,
   WO_EDI_RCV_RSLT_MSG,
   WO_EDI_RCV_RSLT_CD,
   WO_EDI_RCV_RSLT_DT,
   WO_EDI_RCV_PURP_CD,
   INTER_USE_FLG,
   CRE_OFC_CD,
   LOCL_CRE_DT,
   LOCL_UPD_DT,
   CRE_USR_ID,
   CRE_DT,
   UPD_USR_ID,
   UPD_DT
) 
  SELECT TRSP_WO_OFC_CTY_CD,
         TRSP_WO_SEQ,
         NVL((SELECT MAX(WO_ISS_KNT) FROM TRS_TRSP_WRK_ORD_HIS H WHERE H.TRSP_WO_OFC_CTY_CD = O.TRSP_WO_OFC_CTY_CD AND H.TRSP_WO_SEQ = O.TRSP_WO_SEQ), 0) + 1 WO_ISS_KNT,
         WO_ISS_STS_CD,
         WO_PRN_USE_FLG,
         WO_FAX_USE_FLG,
         WO_EML_USE_FLG,
         WO_EDI_USE_FLG,
         WO_N1ST_FAX_NO,
         WO_N2ND_FAX_NO,
         WO_N3RD_FAX_NO,
         WO_N1ST_FAX_SND_NO,
         WO_N2ND_FAX_SND_NO,
         WO_N3RD_FAX_SND_NO,
         WO_N1ST_FAX_RSLT_FLG,
         WO_N2ND_FAX_RSLT_FLG,
         WO_N3RD_FAX_RSLT_FLG,
         WO_N1ST_EML,
         WO_N2ND_EML,
         WO_N3RD_EML,
         WO_N1ST_EML_SND_NO,
         WO_N2ND_EML_SND_NO,
         WO_N3RD_EML_SND_NO,
         WO_N1ST_EML_RSLT_FLG,
         WO_N2ND_EML_RSLT_FLG,
         WO_N3RD_EML_RSLT_FLG,
         WO_RMK,
         WO_BL_NO_ISS_FLG,
         RT_DP_USE_FLG,
         CMDT_DP_USE_FLG,
         PRE_DIS_USE_FLG,
         DTN_USE_FLG,
         '' WO_EDI_RCV_RSLT_MSG,
         '' WO_EDI_RCV_RSLT_CD,
         '' WO_EDI_RCV_RSLT_DT,
         WO_EDI_RCV_PURP_CD,
         INTER_USE_FLG,
         CRE_OFC_CD,
         GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(CRE_OFC_CD) LOCL_CRE_DT,
         GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(CRE_OFC_CD) LOCL_UPD_DT,
         CRE_USR_ID,
         SYSDATE CRE_DT,
         UPD_USR_ID,
         SYSDATE UPD_DT
    FROM TRS_TRSP_WRK_ORD O
   WHERE O.TRSP_WO_OFC_CTY_CD = @[trsp_wo_ofc_cty_cd]
     AND O.TRSP_WO_SEQ = @[trsp_wo_seq]			]]></sql>
			<params>
				<param name="trsp_wo_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="trsp_wo_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
