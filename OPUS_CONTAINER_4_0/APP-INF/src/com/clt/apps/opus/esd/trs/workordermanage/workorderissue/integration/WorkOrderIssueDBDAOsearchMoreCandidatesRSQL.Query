<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WorkOrderIssueDBDAOsearchMoreCandidatesRSQL">
			<desc><![CDATA[searchMoreCandidates]]></desc>
			<sql><![CDATA[
SELECT 
     TRSP_AGMT_OFC_CTY_CD
	,TRSP_AGMT_SEQ
    ,TRSP_AGMT_RT_TP_SER_NO
    ,TRSP_AGMT_OFC_CTY_CD||TRSP_AGMT_SEQ AS AGMT_NO
	,WAY_TYPE
	,DECODE(VNDR_TP_CD, 'COM', 'NYK', VNDR_TP_CD) VNDR_TP_CD
	,VNDR_SEQ
	,VNDR_NM
	,RJT_HIST
    ,AGMT_TRSP_TP_CD
    ,DECODE(TRSP_BND_CD, '0', NULL, TRSP_BND_CD) AS TRSP_BND_CD
    ,SPCL_CGO_CNTR_TP_CD
    ,DECODE(CMDT_GRP_CD, 'XXXX', NULL, CMDT_GRP_CD) CMDT_GRP_CD
    ,TRSP_AGMT_EQ_TP_SZ_CD
    ,USR_DEF_RMK
	,CURR_CD
	,BASIC_RATE
	,WTR_RCV_TERM_CD
	,WTR_DE_TERM_CD
    ,DECODE(TO_WGT, 999999.99, 'MAX', TO_WGT) TO_WGT
    ,DECODE(WGT_MEAS_UT_CD, 'XXX', '', WGT_MEAS_UT_CD) WGT_MEAS_UT_CD
	,TRSP_AGMT_RT_TP_CD
	,TRSP_AGMT_RT_TP_NM
	,CUST_NOMI_TRKR_FLG
	,CUST_CD
--  UI에서 선택한 것을 세팅하도록 변경 요청 2015.07.07
	,0 AS FUEL_SCG_RT
    ,0 AS VAT_SCG_RT
	,TOT_AMOUNT
	,TOT_USD_AMOUNT
	,DECODE(SEQ_, 'ZZZZZZ', TO_CHAR(SEQ), SEQ_) SEQ
FROM (
	SELECT Y.*
		  ,ROW_NUMBER() OVER(PARTITION BY SEQ_ ORDER BY VNDR_SEQ) SEQ 
	FROM (
			SELECT DISTINCT X.*
			      ,(BASIC_RATE)    TOT_AMOUNT
			      ,(TRS_COMMON_PKG.GET_CONVERSION_USD_AMT_FNC(CURR_CD, BASIC_RATE)) TOT_USD_AMOUNT
			      ,CASE WHEN VNDR_SEQ = @[vndr_seq] AND TRSP_AGMT_OFC_CTY_CD = @[trsp_agmt_ofc_cty_cd] AND TRSP_AGMT_SEQ = @[trsp_agmt_seq]
					    THEN 'Preset'
					    ELSE 'ZZZZZZ'
			       END SEQ_
			  FROM TABLE( TRS_AGMT_RATE_MORE_PKG.GET_MORE_CANDIDATES_LIST_FNC(
						      @[trsp_so_ofc_cty_cd]
						     ,@[trsp_so_seq]
						     ,@[ctrl_ofc_cd]
						     ,@[vndr_seq]
						     ,@[basis_dt]
						     ,NULL
						     ,@[eq_knd_cd]
						     ,@[eq_tp_sz_cd]
						     ,@[cmb_tp_cd]
						     ,@[cgo_tp_cd]
						     ,@[bound_cd]
						     ,@[crr_mod_cd]
						     ,@[cost_mod_cd]
						     ,NULL
						     ,@[cmdt_cd]
						     ,@[from_nod_cd]
						     ,@[via_nod_cd]
						     ,@[door_nod_cd]
						     ,@[to_nod_cd]
						     ,@[bundle_cnt]
						     ,@[wgt_uom]
						     ,@[wgt_qty]
						     ,'N'
						   )
			        ) X
              WHERE 1=1
#if(${bound_cd} == 'T')
                AND (X.TRSP_BND_CD IS NULL OR X.TRSP_BND_CD IN ('Y','0'))
#else                     -- TRSP_BND_CD : not T(I,O,NULL)
                AND (X.TRSP_BND_CD IS NULL OR X.TRSP_BND_CD IN ('N','0'))
#end
#if(${fm_vndr_prmry_seq} != '')
				AND VNDR_SEQ = @[fm_vndr_prmry_seq]
#end
#if(${spcl_cgo_cntr_tp_cd} != '')
                AND (X.SPCL_CGO_CNTR_TP_CD IS NULL OR X.SPCL_CGO_CNTR_TP_CD = @[spcl_cgo_cntr_tp_cd])
#end
			) Y
	) T
ORDER BY SEQ_, SEQ			]]></sql>
			<params>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="trsp_agmt_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="trsp_agmt_seq" type="12" value="" out="N"/>
				<param name="trsp_so_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="trsp_so_seq" type="12" value="" out="N"/>
				<param name="ctrl_ofc_cd" type="12" value="" out="N"/>
				<param name="basis_dt" type="12" value="" out="N"/>
				<param name="eq_knd_cd" type="12" value="" out="N"/>
				<param name="eq_tp_sz_cd" type="12" value="" out="N"/>
				<param name="cmb_tp_cd" type="12" value="" out="N"/>
				<param name="cgo_tp_cd" type="12" value="" out="N"/>
				<param name="bound_cd" type="12" value="" out="N"/>
				<param name="crr_mod_cd" type="12" value="" out="N"/>
				<param name="cost_mod_cd" type="12" value="" out="N"/>
				<param name="cmdt_cd" type="12" value="" out="N"/>
				<param name="from_nod_cd" type="12" value="" out="N"/>
				<param name="via_nod_cd" type="12" value="" out="N"/>
				<param name="door_nod_cd" type="12" value="" out="N"/>
				<param name="to_nod_cd" type="12" value="" out="N"/>
				<param name="bundle_cnt" type="12" value="" out="N"/>
				<param name="wgt_uom" type="12" value="" out="N"/>
				<param name="wgt_qty" type="12" value="" out="N"/>
				<param name="fm_vndr_prmry_seq" type="12" value="" out="N"/>
				<param name="spcl_cgo_cntr_tp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
