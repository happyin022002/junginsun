<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AgreementImportDBDAOMultiCorrScgAgmtScgRateUSQL">
			<desc><![CDATA[Surcharge Rate 수정]]></desc>
			<sql><![CDATA[
MERGE INTO TRS_AGMT_SCG_RT A
USING (SELECT A.EFF_FM_DT, A.EFF_TO_DT, A.CURR_CD, A.TRSP_ONE_WY_RT, A.TRSP_RND_RT, 
              A.TRSP_AGMT_EQ_TP_SZ_CD, A.AGMT_SCG_RT_DIV_CD, A.COM_SCG_APLY_FLG, A.WO_APLY_FLG, 
			  A.TO_WGT, A.WGT_MEAS_UT_CD, A.EQ_KND_CD, A.USR_DEF_RMK, A.UPD_USR_ID, A.UPD_DT,
              A.TRSP_AGMT_OFC_CTY_CD, A.TRSP_AGMT_SEQ, A.TRSP_AGMT_RT_TP_SER_NO, A.TRSP_AGMT_SCG_NOD_SEQ, A.TRSP_AGMT_SCG_RT_SEQ,
              B.EFF_FM_DT AS EFF_FM_DT_TMP, 
              B.EFF_TO_DT AS EFF_TO_DT_TMP, 
              B.CURR_CD AS CURR_CD_TMP, 
              B.TRSP_ONE_WY_RT AS TRSP_ONE_WY_RT_TMP, 
              B.TRSP_RND_RT AS TRSP_RND_RT_TMP, 
              NVL(B.TRSP_AGMT_EQ_TP_CD, 'XX') || NVL(B.TRSP_AGMT_EQ_SZ_CD, '') AS TRSP_AGMT_EQ_TP_SZ_CD_TMP, 
              B.AGMT_SCG_RT_DIV_CD AS AGMT_SCG_RT_DIV_CD_TMP, 
              B.COM_SCG_APLY_FLG AS COM_SCG_APLY_FLG_TMP, 
              B.TO_WGT AS TO_WGT_TMP, 
              B.WGT_MEAS_UT_CD AS WGT_MEAS_UT_CD_TMP, 
              B.WO_APLY_FLG AS WO_APLY_FLG_TMP, 
              B.EQ_KND_CD AS EQ_KND_CD_TMP, 
              B.AFT_USR_DEF_RMK AS USR_DEF_RMK_TMP,
              B.AGMT_COST_FLG AS AGMT_COST_FLG_TMP
          FROM TRS_AGMT_SCG_RT A, TRS_AGMT_TMP B
         WHERE A.TRSP_AGMT_OFC_CTY_CD = B.TRSP_AGMT_OFC_CTY_CD
           AND A.TRSP_AGMT_SEQ = B.TRSP_AGMT_SEQ
           AND A.TRSP_AGMT_RT_TP_SER_NO = B.TRSP_AGMT_RT_TP_SER_NO
           AND A.TRSP_AGMT_SCG_NOD_SEQ = B.TRSP_AGMT_NOD_SEQ
           AND A.TRSP_AGMT_SCG_RT_SEQ = B.TRSP_AGMT_RT_SEQ
           AND B.DELT_FLG = 'N'
           AND B.TRSP_TMP_SEQ = @[trsp_tmp_seq]
           AND B.ROW_NO IS NOT NULL
       ) C
ON (    A.TRSP_AGMT_OFC_CTY_CD = C.TRSP_AGMT_OFC_CTY_CD
    AND A.TRSP_AGMT_SEQ = C.TRSP_AGMT_SEQ
    AND A.TRSP_AGMT_RT_TP_SER_NO = C.TRSP_AGMT_RT_TP_SER_NO
    AND A.TRSP_AGMT_SCG_NOD_SEQ = C.TRSP_AGMT_SCG_NOD_SEQ
    AND A.TRSP_AGMT_SCG_RT_SEQ = C.TRSP_AGMT_SCG_RT_SEQ
    )
WHEN MATCHED THEN
UPDATE 
   SET EFF_FM_DT     = EFF_FM_DT_TMP
      ,EFF_TO_DT         = EFF_TO_DT_TMP
      ,TO_WGT            = TO_WGT_TMP
      ,WGT_MEAS_UT_CD    = WGT_MEAS_UT_CD_TMP
      ,CURR_CD           = CURR_CD_TMP
      ,TRSP_ONE_WY_RT    = TRSP_ONE_WY_RT_TMP
      ,TRSP_RND_RT       = TRSP_RND_RT_TMP
	  ,TRSP_AGMT_EQ_TP_SZ_CD = TRSP_AGMT_EQ_TP_SZ_CD_TMP
      ,EQ_KND_CD         = EQ_KND_CD_TMP
      ,USR_DEF_RMK       = USR_DEF_RMK_TMP
      ,AGMT_SCG_RT_DIV_CD   = AGMT_SCG_RT_DIV_CD_TMP
      ,COM_SCG_APLY_FLG    = COM_SCG_APLY_FLG_TMP
      ,WO_APLY_FLG = WO_APLY_FLG_TMP
      ,UPD_USR_ID        = @[fm_account_usr_id]
      ,UPD_DT            = SYSDATE
      ,AGMT_COST_FLG     = AGMT_COST_FLG_TMP			]]></sql>
			<params>
				<param name="trsp_tmp_seq" type="12" value="" out="N"/>
				<param name="fm_account_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
