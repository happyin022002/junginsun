/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : SOInquiryDBDAOSearchSOInquiryRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.11.22
*@LastModifier : 
*@LastVersion : 1.0
* 2016.11.22 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.esd.trs.soinquiry.soinquiry.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class SOInquiryDBDAOSearchSOInquiryRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * S/O Inquiry
	  * 2011.01.03 이윤정 [CHM-201007768-01] DMDT 관련 컬럼 추가
	  * </pre>
	  */
	public SOInquiryDBDAOSearchSOInquiryRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_boundmode",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_sotype",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_user_id",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("portcd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_transmode",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_to_node",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_costmode",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_provider",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_from_date",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_to_date",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_via_node",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_unplanned",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_invoicemode",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_door_node",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("r_from_node",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.esd.trs.soinquiry.soinquiry.integration").append("\n"); 
		query.append("FileName : SOInquiryDBDAOSearchSOInquiryRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if (${invar_usrail} == 'N') " ).append("\n"); 
		query.append("/* S/O inquiry */" ).append("\n"); 
		query.append("SELECT X.EQ_NO" ).append("\n"); 
		query.append("      ,X.EQ_TPSZ" ).append("\n"); 
		query.append("      ,X.ORG_EQ_TPSZ AS ORG_EQ_TPSZ" ).append("\n"); 
		query.append("      ,X.CNTR_SLT_NO" ).append("\n"); 
		query.append("      ,X.TRSP_COST_DTL_MOD_CD" ).append("\n"); 
		query.append("      ,X.TRSP_CRR_MOD_CD" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00279' AND CD.INTG_CD_VAL_CTNT = X.TRSP_SO_TP_CD) AS TRSP_SO_TP_CD" ).append("\n"); 
		query.append("      ,X.UPLN_SO_FLG" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00762' AND CD.INTG_CD_VAL_CTNT = X.BKG_CNTR_CMB_SEQ) AS BKG_CNTR_CMB_SEQ" ).append("\n"); 
		query.append("      ,X.TRSP_FRST_FLG" ).append("\n"); 
		query.append("      ,X.SO_NO" ).append("\n"); 
		query.append("      ,X.SO_CRE_DT1" ).append("\n"); 
		query.append("      ,X.SO_DEL_FLG" ).append("\n"); 
		query.append("      ,DECODE (X.SO_DEL_FLG,'Y', SO_UPD_DT) SO_DEL_DT" ).append("\n"); 
		query.append("      ,X.SO_UPD_DT" ).append("\n"); 
		query.append("      ,X.WO_NO" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00804' AND CD.INTG_CD_VAL_CTNT = X.WO_ISS_STS_CD) AS WO_ISS_STS_CD" ).append("\n"); 
		query.append("      ,X.WO_ISS_DT" ).append("\n"); 
		query.append("      ,X.WO_ISS_TP" ).append("\n"); 
		query.append("      ,X.WO_ISS_OFC_CD" ).append("\n"); 
		query.append("      ,X.WO_ISS_ID" ).append("\n"); 
		query.append("      ,X.FM_NOD_CD" ).append("\n"); 
		query.append("	  ,DECODE(LENGTH(X.FM_NOD_CD), 7, TRS_COMMON_PKG.GET_YD_CD_NM_FNC(X.FM_NOD_CD), 5, (SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.FM_NOD_CD)) FM_NOD_CD_NM" ).append("\n"); 
		query.append("      ,X.VIA_NOD_CD" ).append("\n"); 
		query.append("	  ,DECODE(LENGTH(X.VIA_NOD_CD), 7, TRS_COMMON_PKG.GET_YD_CD_NM_FNC(X.VIA_NOD_CD), 5, (SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.VIA_NOD_CD)) VIA_NOD_CD_NM" ).append("\n"); 
		query.append("      ,X.TO_NOD_CD" ).append("\n"); 
		query.append("	  ,DECODE(LENGTH(X.TO_NOD_CD), 7, TRS_COMMON_PKG.GET_YD_CD_NM_FNC(X.TO_NOD_CD), 5, (SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.TO_NOD_CD)) TO_NOD_CD_NM" ).append("\n"); 
		query.append("      ,X.DOOR" ).append("\n"); 
		query.append("	  ,DECODE(LENGTH(X.DOOR), 7, X.DOOR_NM, 5, (SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.DOOR)) DOOR_NM" ).append("\n"); 
		query.append("      ,X.DOOR_FCTRY_NM" ).append("\n"); 
		query.append("      ,X.DOOR_ZIP" ).append("\n"); 
		query.append("      ,X.DOR_DE_ADDR" ).append("\n"); 
		query.append("      ,X.DOOR_TEL" ).append("\n"); 
		query.append("      ,X.DOOR_FAX" ).append("\n"); 
		query.append("      ,X.DOOR_PIC" ).append("\n"); 
		query.append("      ,X.VNDR_TP_CD" ).append("\n"); 
		query.append("      ,SUBSTR(X.INV_VNDR_INFO, 1, INSTR(X.INV_VNDR_INFO, '$', 1, 1) - 1) AS VNDR_CD" ).append("\n"); 
		query.append("      ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 1) + 1, INSTR(X.INV_VNDR_INFO, '$', 1, 2) - INSTR(X.INV_VNDR_INFO, '$', 1, 1) - 1) AS VNDR_ABBR_NM" ).append("\n"); 
		query.append("      ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 2) + 1, INSTR(X.INV_VNDR_INFO, '$', 1, 3) - INSTR(X.INV_VNDR_INFO, '$', 1, 2) - 1) AS PVNDR_CD" ).append("\n"); 
		query.append("      ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 3) + 1) AS PVNDR_NM" ).append("\n"); 
		query.append("      ,X.WO_RCV_DT" ).append("\n"); 
		query.append("      ,X.APPT_TIME" ).append("\n"); 
		query.append("      ,X.DELIV_TIME" ).append("\n"); 
		query.append("      ,X.N3PTY_BIL_FLG" ).append("\n"); 
		query.append("      ,X.COST_OFC_CD" ).append("\n"); 
		query.append("      ,X.WO_CURR_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_BZC_AMT) WO_BZC_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_NEGO_AMT) WO_NEGO_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_FUEL_SCG_AMT) WO_FUEL_SCG_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_ETC_ADD_AMT) WO_ETC_ADD_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_TOT_AMT) WO_TOT_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WO_TOT_AMT_USD) WO_TOT_AMT_USD" ).append("\n"); 
		query.append("      ,TO_CHAR(X.INV_XCH_RT) INV_XCH_RT" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00874' AND CD.INTG_CD_VAL_CTNT = X.INV_CALC_LGC_TP_CD) AS INV_CALC_LGC_TP_CD" ).append("\n"); 
		query.append("      ,X.INV_CURR_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(X.INV_BZC_AMT) INV_BZC_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.INV_ETC_ADD_AMT) INV_ETC_ADD_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.INV_TOT_AMT) INV_TOT_AMT" ).append("\n"); 
		query.append("      ,TO_CHAR(X.INV_TOT_AMT_USD) INV_TOT_AMT_USD" ).append("\n"); 
		query.append("      ,TO_CHAR(X.INV_VNDR_SEQ) INV_VNDR_CD" ).append("\n"); 
		query.append("      ,X.INV_VNDR_NM" ).append("\n"); 
		query.append("      ,X.INV_NO" ).append("\n"); 
		query.append("      ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00824' AND CD.INTG_CD_VAL_CTNT = X.INV_STS_CD) AS INV_STS_CD" ).append("\n"); 
		query.append("      ,X.INV_CFM_DT" ).append("\n"); 
		query.append("      ,X.CSR_NO CAR_NO" ).append("\n"); 
		query.append("      ,X.INV_CFM_OFC_CD" ).append("\n"); 
		query.append("      ,X.INV_CRE_USR_ID" ).append("\n"); 
		query.append("      ,X.N1ST_NOD_PLN_DT" ).append("\n"); 
		query.append("      ,X.LST_NOD_PLN_DT" ).append("\n"); 
		query.append("      ,X.DOR_NOD_PLN_DT" ).append("\n"); 
		query.append("      ,X.DOR_ARR_DT" ).append("\n"); 
		query.append("      ,X.COP_NO" ).append("\n"); 
		query.append("      ,TO_CHAR(X.AG_SEQ) COST_ACT_GRP_SEQ" ).append("\n"); 
		query.append("      ,X.AG_CODE AS COST_ACT_GRP_CD" ).append("\n"); 
		query.append("      ,X.BKG_NO" ).append("\n"); 
		query.append("      ,X.BL_NO" ).append("\n"); 
		query.append("      ,X.TRSP_BND_CD" ).append("\n"); 
		query.append("      ,X.TERM" ).append("\n"); 
		query.append("      ,TO_CHAR(X.TRO_SEQ) TRO_SEQ" ).append("\n"); 
		query.append("      ,X.TRO_CNFM" ).append("\n"); 
		query.append("      ,X.TRO_CFM_OFC" ).append("\n"); 
		query.append("      ,X.TRO_CFM_USR" ).append("\n"); 
		query.append("      ,X.TRO_CFM_UPD" ).append("\n"); 
		query.append("      ,X.TRO_REV_CUR" ).append("\n"); 
		query.append("      ,SUBSTR(X.EUR_TRO_INFO, INSTR(X.EUR_TRO_INFO, '$', 1, 1) + 1, INSTR(X.EUR_TRO_INFO, '$', 1, 2) - INSTR(X.EUR_TRO_INFO, '$', 1, 1) - 1) EUR_TRO_REV" ).append("\n"); 
		query.append("      ,SUBSTR(X.EUR_TRO_INFO, 1, INSTR(X.EUR_TRO_INFO, '$', 1, 1) -1) AS MANIFESTED" ).append("\n"); 
		query.append("      ,X.TRO_LOD_REF" ).append("\n"); 
		query.append("      ,TO_CHAR(X.BKG_QTY) BKG_QTY" ).append("\n"); 
		query.append("      ,X.POR_CD" ).append("\n"); 
		query.append("	  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.POR_CD ) POR_CD_NM" ).append("\n"); 
		query.append("      ,X.POL_CD" ).append("\n"); 
		query.append("	  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.POL_CD ) POL_CD_NM" ).append("\n"); 
		query.append("      ,X.POD_CD" ).append("\n"); 
		query.append("	  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.POD_CD ) POD_CD_NM" ).append("\n"); 
		query.append("      ,X.DEL_CD" ).append("\n"); 
		query.append("	  ,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.DEL_CD ) DEL_CD_NM" ).append("\n"); 
		query.append("      ,X.T_VVD" ).append("\n"); 
		query.append("      ,X.SLAN_CD" ).append("\n"); 
		query.append("      ,X.IB_VVD_CD" ).append("\n"); 
		query.append("      ,X.OB_VVD_CD" ).append("\n"); 
		query.append("      ,X.CGO_TP_CD" ).append("\n"); 
		query.append("      ,X.SPCL_CGO_CNTR_TP_CD AS BKG_SPE" ).append("\n"); 
		query.append("      ,SUBSTR(X.MST_CNTR_INFO, 1, INSTR(X.MST_CNTR_INFO, '$', 1, 1) -1) AS USED" ).append("\n"); 
		query.append("      ,SUBSTR(X.MST_CNTR_INFO, INSTR(X.MST_CNTR_INFO, '$', 1, 1) + 1, INSTR(X.MST_CNTR_INFO, '$', 1, 2) - INSTR(X.MST_CNTR_INFO, '$', 1, 1) - 1) AS LT" ).append("\n"); 
		query.append("      ,SUBSTR(X.MST_CNTR_INFO, INSTR(X.MST_CNTR_INFO, '$', 1, 2) + 1) AS I_EXIT" ).append("\n"); 
		query.append("      ,X.LSE_CNTR_FLG AS LT_EXP" ).append("\n"); 
		query.append("      ,(SELECT CNTR_SEAL_NO FROM BKG_CNTR_SEAL_NO WHERE BKG_NO  = X.BKG_NO AND CNTR_NO = X.EQ_NO AND CNTR_SEAL_SEQ = 1) AS SEAL_NO" ).append("\n"); 
		query.append("      ,(SELECT CNTR_SEAL_NO FROM BKG_CNTR_SEAL_NO WHERE BKG_NO  = X.BKG_NO AND CNTR_NO = X.EQ_NO AND CNTR_SEAL_SEQ = 2) AS SEAL_NO2" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WEIGHT_KGS) WEIGHT_KGS" ).append("\n"); 
		query.append("      ,TO_CHAR(X.WEIGHT_LBS) WEIGHT_LBS" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      ,TRS_COMMON_PKG.GET_CONV_WGT_TO_KGS_FNC(TRIM(REGEXP_SUBSTR(X.BKG_CNTR_INFO, '[^$]+',1, 3)), TRIM(REGEXP_SUBSTR(X.BKG_CNTR_INFO, '[^$]+',1, 4))) AS VGM_KGS_WGT" ).append("\n"); 
		query.append("      ,TRS_COMMON_PKG.GET_CONV_WGT_TO_LBS_FNC(TRIM(REGEXP_SUBSTR(X.BKG_CNTR_INFO, '[^$]+',1, 3)), TRIM(REGEXP_SUBSTR(X.BKG_CNTR_INFO, '[^$]+',1, 4))) AS VGM_LBS_WGT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      ,SUBSTR(X.BKG_CNTR_INFO, 1, INSTR(X.BKG_CNTR_INFO, '$', 1, 1) -1) AS NO_PKG" ).append("\n"); 
		query.append("      ,SUBSTR(X.BKG_CNTR_INFO, INSTR(X.BKG_CNTR_INFO, '$', 1, 1) + 1, INSTR(X.BKG_CNTR_INFO, '$', 1, 2) - INSTR(X.BKG_CNTR_INFO, '$', 1, 1) - 1) PKG_CD" ).append("\n"); 
		query.append("      ,REPLACE(X.CMDT_NM, chr(34), '') AS CMDT_NM" ).append("\n"); 
		query.append("      ,X.C_LOC" ).append("\n"); 
		query.append("      ,X.USA_LAST_CITY" ).append("\n"); 
		query.append("      ,NVL(TRIM(REGEXP_SUBSTR(X.EDI_FOC_INFO, '[^$]+', 1, 1)), 'N') AS F" ).append("\n"); 
		query.append("      ,NVL(TRIM(REGEXP_SUBSTR(X.EDI_FOC_INFO, '[^$]+', 1, 2)), 'N') AS O" ).append("\n"); 
		query.append("      ,NVL(TRIM(REGEXP_SUBSTR(X.EDI_FOC_INFO, '[^$]+', 1, 3)), 'N') AS C" ).append("\n"); 
		query.append("      ,IT_NO" ).append("\n"); 
		query.append("      ,SUBSTR(X.PKUP_INFO, 1, INSTR(X.PKUP_INFO, '^', 1, 1) - 1) AS PICKUP_NO" ).append("\n"); 
		query.append("      ,SUBSTR(X.PKUP_INFO, INSTR(X.PKUP_INFO, '^', 1, 1) + 1, INSTR(X.PKUP_INFO, '^', 1, 2) - INSTR(X.PKUP_INFO, '^', 1, 1) - 1) AS PU_YARD_CD" ).append("\n"); 
		query.append("      ,TO_CHAR( TO_DATE(SUBSTR(X.PKUP_INFO, INSTR(X.PKUP_INFO, '^', 1, 2) + 1, INSTR(X.PKUP_INFO, '^', 1, 3) - INSTR(X.PKUP_INFO, '^', 1, 2) - 1 - 9), 'YYYY-MM-DD'), 'YYYYMMDD') AS AVAILABLE_DT" ).append("\n"); 
		query.append("      ,TO_CHAR( TO_DATE(SUBSTR(X.PKUP_INFO, INSTR(X.PKUP_INFO, '^', 1, 3) + 1, INSTR(X.PKUP_INFO, '^', 1, 4) - INSTR(X.PKUP_INFO, '^', 1, 3) - 1 - 9), 'YYYY-MM-DD'), 'YYYYMMDD') AS LAST_FREE_DT" ).append("\n"); 
		query.append("      ,SUBSTR(X.BKG_SC_NO_INFO, 1, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) -1) AS SC_NO" ).append("\n"); 
		query.append("      ,SUBSTR(X.BKG_SC_NO_INFO, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) + 1) AS RFA_NO" ).append("\n"); 
		query.append("      ,X.DOOR_SVC_TP" ).append("\n"); 
		query.append("      ,X.PKUP_CNTR" ).append("\n"); 
		query.append("      ,REPLACE(X.SHIPPER, chr(34), '') AS SHIPPER " ).append("\n"); 
		query.append("      ,REPLACE(X.CONSIGNEE, chr(34), '') AS CONSIGNEE" ).append("\n"); 
		query.append("      ,REPLACE(X.NOTIFY, chr(34), '') AS NOTIFY" ).append("\n"); 
		query.append("      ,X.REF_BKG_NO" ).append("\n"); 
		query.append("      ,X.REF_BL_NO" ).append("\n"); 
		query.append("      ,X.ORG_GATE_OUT_DT" ).append("\n"); 
		query.append("      ,X.DEST_GATE_IN_DT" ).append("\n"); 
		query.append("      ,X.MTY_REF_ID" ).append("\n"); 
		query.append("      ,REPLACE(REPLACE(X.TRSP_PURP_RSN, CHR(13)||CHR(10), ' '), CHR(34), '') TRSP_PURP_RSN" ).append("\n"); 
		query.append("      ,DECODE(X.TRSP_SO_TP_CD, 'M', 'N/A', 'H', X.INTER_RMK, DECODE(X.INTER_RMK_CHK, '', '', 'Y')) INTER_RMK" ).append("\n"); 
		query.append("      ,REPLACE(REPLACE(X.SPCL_INSTR_RMK, CHR(13)||CHR(10), ' '), CHR(34), '')  SPCL_INSTR_RMK" ).append("\n"); 
		query.append("      ,REPLACE(REPLACE(X.WO_INSTR_RMK, CHR(13)||CHR(10), ' '), CHR(34), '')  WO_INSTR_RMK" ).append("\n"); 
		query.append("      ,TO_CHAR(X.CHZ_BUNDLE_SEQ) CHZ_BUNDLE_SEQ" ).append("\n"); 
		query.append("	  ,X.REF_INV_NO" ).append("\n"); 
		query.append("#if (${invar_usdropnpull} == 'Y') " ).append("\n"); 
		query.append("	  ,SUBSTR(X.DMDT_INFO, 1, INSTR(X.DMDT_INFO, '$', 1, 1) -1) AS FM_DT" ).append("\n"); 
		query.append("	  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 1) + 1, INSTR(X.DMDT_INFO, '$', 1, 2) - INSTR(X.DMDT_INFO, '$', 1, 1) - 1) AS FM_YD" ).append("\n"); 
		query.append("	  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 2) + 1, INSTR(X.DMDT_INFO, '$', 1, 3) - INSTR(X.DMDT_INFO, '$', 1, 2) - 1) AS FM_STS " ).append("\n"); 
		query.append("	  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 3) + 1, INSTR(X.DMDT_INFO, '$', 1, 4) - INSTR(X.DMDT_INFO, '$', 1, 3) - 1) AS TO_DT " ).append("\n"); 
		query.append("	  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 4) + 1, INSTR(X.DMDT_INFO, '$', 1, 5) - INSTR(X.DMDT_INFO, '$', 1, 4) - 1) AS TO_YD " ).append("\n"); 
		query.append("	  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 5) + 1, INSTR(X.DMDT_INFO, '$', 1, 6) - INSTR(X.DMDT_INFO, '$', 1, 5) - 1) AS TO_STS" ).append("\n"); 
		query.append("	  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 6) + 1, INSTR(X.DMDT_INFO, '$', 1, 7) - INSTR(X.DMDT_INFO, '$', 1, 6) - 1) AS MT_DT " ).append("\n"); 
		query.append("	  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 7) + 1, INSTR(X.DMDT_INFO, '$', 1, 8) - INSTR(X.DMDT_INFO, '$', 1, 7) - 1) AS MT_YD " ).append("\n"); 
		query.append("	  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 8) + 1, INSTR(X.DMDT_INFO, '$', 1, 9) - INSTR(X.DMDT_INFO, '$', 1, 8) - 1) AS WEB_MT_DT " ).append("\n"); 
		query.append("	  ,SUBSTR(X.DMDT_INFO, INSTR(X.DMDT_INFO, '$', 1, 9) + 1, INSTR(X.DMDT_INFO, '$', 1,10) - INSTR(X.DMDT_INFO, '$', 1, 9) - 1) AS GRACE_END " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${grid_flg} == 'Y')" ).append("\n"); 
		query.append("      ,X.CONTI_CD" ).append("\n"); 
		query.append("      ,X.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(X.TRSP_SO_SEQ) TRSP_SO_SEQ" ).append("\n"); 
		query.append("      ,TO_CHAR(X.VNDR_SEQ) VNDR_SEQ" ).append("\n"); 
		query.append("      ,X.TRSP_WO_OFC_CTY_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(X.TRSP_WO_SEQ) TRSP_WO_SEQ" ).append("\n"); 
		query.append("      ,X.WGT_MEAS_UT_CD UOM" ).append("\n"); 
		query.append("      ,X.REGISTRATION_NO" ).append("\n"); 
		query.append("      ,X.UPD_USR_ID" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  FROM (" ).append("\n"); 
		query.append("          SELECT SO.CMDT_CD" ).append("\n"); 
		query.append("                ,SO.VNDR_SEQ" ).append("\n"); 
		query.append("                ,SO.CUST_SEQ" ).append("\n"); 
		query.append("                ,SO.CUST_CNT_CD" ).append("\n"); 
		query.append("                ,WRK.CSR_NO" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_CMB_SEQ" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_CMB_TP_CD" ).append("\n"); 
		query.append("                ,SO.LOCL_CRE_DT AS SO_CRE_DT" ).append("\n"); 
		query.append("                ,WO.LOCL_CRE_DT AS WO_CRE_DT" ).append("\n"); 
		query.append("                ,WRK.CRE_OFC_CD AS INV_CRE_OFC_CD" ).append("\n"); 
		query.append("                ,SO.VSL_CD" ).append("\n"); 
		query.append("                ,SO.SKD_VOY_NO" ).append("\n"); 
		query.append("                ,SO.SKD_DIR_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_STS_CD" ).append("\n"); 
		query.append("                ,SO.CGO_TP_CD" ).append("\n"); 
		query.append("                ,SO.CNTR_KGS_WGT AS WEIGHT_KGS" ).append("\n"); 
		query.append("                ,SO.CNTR_LBS_WGT AS WEIGHT_LBS" ).append("\n"); 
		query.append("                ,SO.WGT_MEAS_UT_CD" ).append("\n"); 
		query.append("                ,SO.EQ_NO EQ_NO" ).append("\n"); 
		query.append("                ,SO.EQ_KND_CD" ).append("\n"); 
		query.append("                ,SO.EQ_TPSZ_CD AS EQ_TPSZ" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                ,SO.TRSP_COST_DTL_MOD_CD AS TRSP_COST_DTL_MOD_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_CRR_MOD_CD AS TRSP_CRR_MOD_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_OFC_CTY_CD || SO.TRSP_SO_SEQ AS SO_NO" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LOCL_CRE_DT, 'YYYY-MM-DD HH24:MI:SS') AS SO_CRE_DT1" ).append("\n"); 
		query.append("                ,SO.DELT_FLG SO_DEL_FLG" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LOCL_UPD_DT, 'YYYY-MM-DD HH24:MI:SS') AS SO_UPD_DT" ).append("\n"); 
		query.append("                ,WO.TRSP_WO_OFC_CTY_CD || WO.TRSP_WO_SEQ AS WO_NO" ).append("\n"); 
		query.append("                ,WO.TRSP_WO_OFC_CTY_CD" ).append("\n"); 
		query.append("                ,WO.TRSP_WO_SEQ" ).append("\n"); 
		query.append("                ,WO.WO_ISS_STS_CD AS WO_ISS_STS_CD" ).append("\n"); 
		query.append("                ,TO_CHAR ( WO.LOCL_CRE_DT, 'YYYY-MM-DD HH24:MI:SS') AS WO_ISS_DT" ).append("\n"); 
		query.append("                ,DECODE (WO.WO_PRN_USE_FLG,'Y', 'PRINT','') || DECODE (WO.WO_FAX_USE_FLG,'Y', 'FAX','') || DECODE (WO.WO_EML_USE_FLG,'Y', ' EMAIL','') || DECODE (WO.WO_EDI_USE_FLG,'Y', ' EDI','') AS WO_ISS_TP" ).append("\n"); 
		query.append("                ,WO.CRE_OFC_CD AS WO_ISS_OFC_CD" ).append("\n"); 
		query.append("                ,WO.CRE_USR_ID AS WO_ISS_ID" ).append("\n"); 
		query.append("                ,SO.FM_NOD_CD AS FM_NOD_CD" ).append("\n"); 
		query.append("                ,SO.VIA_NOD_CD AS VIA_NOD_CD" ).append("\n"); 
		query.append("                ,SO.TO_NOD_CD AS TO_NOD_CD" ).append("\n"); 
		query.append("                ,SO.FCTRY_NM AS DOOR_FCTRY_NM" ).append("\n"); 
		query.append("                ,SO.DOR_NOD_CD AS DOOR" ).append("\n"); 
		query.append("				,Z.ZN_NM AS DOOR_NM" ).append("\n"); 
		query.append("                ,SO.DOR_DE_ADDR AS DOR_DE_ADDR" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_TP_CD AS TRSP_SO_TP_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_CMB_TP_CD AS BKG_CNTR_CMB_SEQ" ).append("\n"); 
		query.append("                ,DECODE (SO.CUST_NOMI_TRKR_FLG,'Y', 'CNT','NYK') AS VNDR_TP_CD" ).append("\n"); 
		query.append("                ,DECODE (WO.WO_OPN_FLG,'Y', TO_CHAR (WO.UPD_DT, 'YYYY-MM-DD HH24:MI:SS')) AS WO_RCV_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.APNT_DT, 'YYYY-MM-DD HH24:MI:SS') AS APPT_TIME" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.DE_DT, 'YYYY-MM-DD HH24:MI:SS') AS DELIV_TIME" ).append("\n"); 
		query.append("                ,NVL (SO.N3PTY_BIL_FLG, 'N') AS N3PTY_BIL_FLG" ).append("\n"); 
		query.append("                ,SO.CURR_CD AS WO_CURR_CD" ).append("\n"); 
		query.append("                ,SO.BZC_AMT AS WO_BZC_AMT" ).append("\n"); 
		query.append("                ,SO.NEGO_AMT AS WO_NEGO_AMT" ).append("\n"); 
		query.append("                ,SO.FUEL_SCG_AMT AS WO_FUEL_SCG_AMT" ).append("\n"); 
		query.append("                ,CASE WHEN SO.CURR_CD = 'JPY' OR SO.CURR_CD = 'KRW' OR SO.CURR_CD = 'TWD'" ).append("\n"); 
		query.append("                      THEN TO_CHAR(NVL(SO.ETC_ADD_AMT, 0), 'FM999999999990')" ).append("\n"); 
		query.append("                      ELSE TO_CHAR(NVL(SO.ETC_ADD_AMT, 0), 'FM999999999990.90')" ).append("\n"); 
		query.append("                 END AS WO_ETC_ADD_AMT" ).append("\n"); 
		query.append("                ,SO.BZC_AMT + NVL (SO.FUEL_SCG_AMT, 0) + NVL (SO.NEGO_AMT, 0) + NVL (SO.ETC_ADD_AMT, 0) AS WO_TOT_AMT" ).append("\n"); 
		query.append("                ,SO.INV_XCH_RT AS INV_XCH_RT" ).append("\n"); 
		query.append("                ,SO.TRSP_INV_CALC_LGC_TP_CD AS INV_CALC_LGC_TP_CD" ).append("\n"); 
		query.append("                ,SO.CRE_OFC_CD AS COST_OFC_CD" ).append("\n"); 
		query.append("                ,SO.INV_CURR_CD AS INV_CURR_CD" ).append("\n"); 
		query.append("                ,SO.INV_BZC_AMT AS INV_BZC_AMT" ).append("\n"); 
		query.append("                ,CASE WHEN SO.INV_CURR_CD = 'JPY' OR SO.INV_CURR_CD = 'KRW' OR SO.INV_CURR_CD = 'TWD'" ).append("\n"); 
		query.append("                      THEN TO_CHAR(NVL(SO.INV_ETC_ADD_AMT, 0), 'FM999999999990')" ).append("\n"); 
		query.append("                      ELSE TO_CHAR(NVL(SO.INV_ETC_ADD_AMT, 0), 'FM999999999990.90')" ).append("\n"); 
		query.append("                 END AS INV_ETC_ADD_AMT" ).append("\n"); 
		query.append("                , NVL (SO.INV_BZC_AMT, 0) + NVL (SO.INV_ETC_ADD_AMT, 0) AS INV_TOT_AMT" ).append("\n"); 
		query.append("                ,SO.INV_NO AS INV_NO" ).append("\n"); 
		query.append("                ,WRK.TRSP_INV_AUD_STS_CD AS INV_STS_CD" ).append("\n"); 
		query.append("                ,WRK.RGST_NO AS REGISTRATION_NO" ).append("\n"); 
		query.append("                ,TO_CHAR (WRK.INV_CFM_DT, 'YYYYMMDD') AS INV_CFM_DT" ).append("\n"); 
		query.append("                ,WRK.CSR_NO AS CAR_NO" ).append("\n"); 
		query.append("                ,CASE WHEN WRK.TRSP_INV_AUD_STS_CD IN ('CF', 'AR', 'IF', 'PD') THEN WRK.CRE_OFC_CD END AS INV_CFM_OFC_CD" ).append("\n"); 
		query.append("                ,WRK.CRE_USR_ID AS INV_CRE_USR_ID" ).append("\n"); 
		query.append("                ,SO.BKG_NO AS BKG_NO" ).append("\n"); 
		query.append("                ,SO.BL_NO AS BL_NO" ).append("\n"); 
		query.append("                ,SO.TRSP_BND_CD AS TRSP_BND_CD" ).append("\n"); 
		query.append("                ,SO.BKG_RCVDE_TERM_CD AS TERM" ).append("\n"); 
		query.append("                ,SO.POR_CD" ).append("\n"); 
		query.append("                ,SO.POL_CD" ).append("\n"); 
		query.append("                ,SO.POD_CD" ).append("\n"); 
		query.append("                ,SO.DEL_CD" ).append("\n"); 
		query.append("                ,SO.VSL_CD || SO.SKD_VOY_NO || SO.SKD_DIR_CD T_VVD" ).append("\n"); 
		query.append("                ,SO.SLAN_CD SLAN_CD" ).append("\n"); 
		query.append("                ,SO.IB_VVD_CD" ).append("\n"); 
		query.append("                ,SO.OB_VVD_CD" ).append("\n"); 
		query.append("                ,SO.IBD_CSTMS_CLR_LOC_CD C_LOC" ).append("\n"); 
		query.append("                ,SO.LST_LOC_CD USA_LAST_CITY" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.AVAL_DT, 'YYYYMMDD') AVAILABLE_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LST_FREE_DT, 'YYYYMMDD') LAST_FREE_DT" ).append("\n"); 
		query.append("                ,SO.REF_BKG_NO REF_BKG_NO" ).append("\n"); 
		query.append("                ,SO.REF_BL_NO REF_BL_NO" ).append("\n"); 
		query.append("                ,SO.INTER_RMK INTER_RMK" ).append("\n"); 
		query.append("                ,(SELECT MAX(RMK.BKG_NO) FROM TRS_INTER_RMK RMK WHERE RMK.BKG_NO = SO.BKG_NO AND NVL(RMK.EQ_NO, 'X') = NVL2(RMK.EQ_NO, SO.EQ_NO, 'X') AND NVL(RMK.DELT_FLG, 'X') = 'N') AS INTER_RMK_CHK" ).append("\n"); 
		query.append("                ,WO.WO_RMK WO_INSTR_RMK" ).append("\n"); 
		query.append("                ,SO.SPCL_INSTR_RMK" ).append("\n"); 
		query.append("                ,CASE" ).append("\n"); 
		query.append("                    WHEN SO.EQ_KND_CD = 'Z' AND SO.TRSP_SO_CMB_TP_CD = 'BD' THEN COUNT (SO.TRSP_SO_SEQ) OVER (PARTITION BY SO.TRSP_SO_CMB_TP_CD, SO.TRSP_SO_CMB_SEQ)" ).append("\n"); 
		query.append("                    WHEN SO.EQ_KND_CD = 'Z' THEN 1" ).append("\n"); 
		query.append("                 END AS CHZ_BUNDLE_SEQ" ).append("\n"); 
		query.append("                ,SO.COP_NO" ).append("\n"); 
		query.append("                ,SO.COST_ACT_GRP_SEQ AG_SEQ" ).append("\n"); 
		query.append("                ,SO.COST_ACT_GRP_CD AG_CODE" ).append("\n"); 
		query.append("                ,DECODE (SO.TRSP_COST_DTL_MOD_CD,'DR', DECODE (NVL (SO.TRO_SEQ, ''),'', 'N','Y'),'') TRO_CNFM" ).append("\n"); 
		query.append("                ,SO.TRO_SEQ " ).append("\n"); 
		query.append("                ,NVL (SO.UPD_USR_ID, SO.CRE_USR_ID) UPD_USR_ID" ).append("\n"); 
		query.append("                ,SO.ACT_CUST_CNT_CD || SO.ACT_CUST_SEQ DOOR_ACT_CUST" ).append("\n"); 
		query.append("                ,SO.DOR_PST_CD DOOR_ZIP" ).append("\n"); 
		query.append("                ,SO.CNTC_PSON_PHN_NO DOOR_TEL" ).append("\n"); 
		query.append("                ,SO.CNTC_PSON_FAX_NO DOOR_FAX" ).append("\n"); 
		query.append("                ,SO.CNTC_PSON_NM DOOR_PIC" ).append("\n"); 
		query.append("                ,DECODE (SO.DOR_SVC_TP_CD,'UD', 'UNDECIDED','LL', 'LIVE LOAD','LU', 'LIVE UNLOAD','ST', 'STREET TURN','DP', 'DROP AND PICK') DOOR_SVC_TP" ).append("\n"); 
		query.append("                ,SO.REF_ID MTY_REF_ID" ).append("\n"); 
		query.append("			    ,SO.REF_INV_NO" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.ORG_GATE_OUT_DT, 'YYYY-MM-DD HH24:MI:SS') ORG_GATE_OUT_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.DEST_GATE_IN_DT, 'YYYY-MM-DD HH24:MI:SS') DEST_GATE_IN_DT" ).append("\n"); 
		query.append("                ,SO.TRSP_PURP_RSN" ).append("\n"); 
		query.append("                ,NVL(SO.UPLN_SO_FLG, 'N') UPLN_SO_FLG" ).append("\n"); 
		query.append("                ,NVL(SO.TRSP_FRST_FLG, 'N') TRSP_FRST_FLG" ).append("\n"); 
		query.append("                ,DECODE (SO.EQ_TPSZ_CD, SO.ORG_EQ_TPSZ_CD, '', SO.ORG_EQ_TPSZ_CD ) ORG_EQ_TPSZ" ).append("\n"); 
		query.append("                ,SO.DOR_PKUP_CNTR_NO PKUP_CNTR" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.N1ST_NOD_PLN_DT, 'YYYY-MM-DD HH24:MI:SS') N1ST_NOD_PLN_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LST_NOD_PLN_DT, 'YYYY-MM-DD HH24:MI:SS') LST_NOD_PLN_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.DOR_NOD_PLN_DT, 'YYYY-MM-DD HH24:MI:SS') DOR_NOD_PLN_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.DOR_ARR_DT, 'YYYY-MM-DD HH24:MI:SS') DOR_ARR_DT                " ).append("\n"); 
		query.append("                ,(SELECT REPLACE(REPLACE (CUST_NM, CHR(13),' '), CHR(10), '') FROM BKG_CUSTOMER CUST WHERE CUST.BKG_NO = SO.BKG_NO AND CUST.BKG_CUST_TP_CD = 'S' ) AS SHIPPER" ).append("\n"); 
		query.append("                ,(SELECT REPLACE(REPLACE (CUST_NM, CHR(13),' '), CHR(10), '') FROM BKG_CUSTOMER CUST WHERE CUST.BKG_NO = SO.BKG_NO AND CUST.BKG_CUST_TP_CD = 'C' ) AS CONSIGNEE" ).append("\n"); 
		query.append("                ,(SELECT REPLACE(REPLACE (CUST_NM, CHR(13),' '), CHR(10), '') FROM BKG_CUSTOMER CUST WHERE CUST.BKG_NO = SO.BKG_NO AND CUST.BKG_CUST_TP_CD = 'N' ) AS NOTIFY" ).append("\n"); 
		query.append("                ,(SELECT LISTAGG(DECODE(NVL(U.EQ_SUBST_CGO_QTY, 0), 0, U.CNTR_TPSZ_CD ||' '||U.OP_CNTR_QTY, U.CNTR_TPSZ_CD||' '||U.OP_CNTR_QTY ||'-SUB '||U.EQ_SUBST_CNTR_TPSZ_CD||' '||U.EQ_SUBST_CGO_QTY ), ', ') WITHIN GROUP (ORDER BY U.BKG_NO)" ).append("\n"); 
		query.append("                    FROM BKG_QUANTITY U" ).append("\n"); 
		query.append("                   WHERE U.BKG_NO(+)       = SO.BKG_NO) AS BKG_QTY" ).append("\n"); 
		query.append("                ,(SELECT CMDT_NM FROM MDM_COMMODITY CMT WHERE CMT.CMDT_CD = SO.CMDT_CD ) AS CMDT_NM" ).append("\n"); 
		query.append("                ,DECODE (SO.TRSP_COST_DTL_MOD_CD,'DR', SO.TRO_CFM_OFC_CD, '') TRO_CFM_OFC" ).append("\n"); 
		query.append("                ,DECODE (SO.TRSP_COST_DTL_MOD_CD,'DR', SO.TRO_CFM_USR_ID, '') TRO_CFM_USR" ).append("\n"); 
		query.append("                ,DECODE (SO.TRSP_COST_DTL_MOD_CD,'DR', TO_CHAR (SO.TRO_CFM_UPD_DT, 'YYYY-MM-DD HH24:MI:SS'), '') TRO_CFM_UPD" ).append("\n"); 
		query.append("                ,DECODE (SO.TRSP_COST_DTL_MOD_CD,'DR', SO.REV_CURR_CD, '') TRO_REV_CUR" ).append("\n"); 
		query.append("                ,SO.LSE_CNTR_FLG" ).append("\n"); 
		query.append("                ,ROUND ((NVL (SO.BZC_AMT, 0) + NVL (SO.FUEL_SCG_AMT, 0) + NVL (SO.NEGO_AMT, 0) + NVL (SO.ETC_ADD_AMT, 0)) / " ).append("\n"); 
		query.append("                         (SELECT USD_LOCL_XCH_RT" ).append("\n"); 
		query.append("                            FROM GL_MON_XCH_RT XCH" ).append("\n"); 
		query.append("                           WHERE XCH.ACCT_XCH_RT_YRMON = TO_CHAR (SO.LOCL_CRE_DT, 'RRRRMM')" ).append("\n"); 
		query.append("                             AND XCH.ACCT_XCH_RT_LVL   = 1" ).append("\n"); 
		query.append("                             AND XCH.CURR_CD        = SO.CURR_CD ) , 2) WO_TOT_AMT_USD" ).append("\n"); 
		query.append("                ,ROUND ((NVL (SO.INV_BZC_AMT, 0) + NVL (SO.INV_ETC_ADD_AMT, 0)) / " ).append("\n"); 
		query.append("                        (SELECT USD_LOCL_XCH_RT" ).append("\n"); 
		query.append("                            FROM GL_MON_XCH_RT XCH" ).append("\n"); 
		query.append("                           WHERE XCH.ACCT_XCH_RT_YRMON = TO_CHAR (SO.LOCL_CRE_DT, 'RRRRMM')" ).append("\n"); 
		query.append("                             AND XCH.ACCT_XCH_RT_LVL   = 1" ).append("\n"); 
		query.append("                             AND XCH.CURR_CD        = SO.INV_CURR_CD ) , 2) INV_TOT_AMT_USD " ).append("\n"); 
		query.append("                ,SO.INV_VNDR_SEQ" ).append("\n"); 
		query.append("                ,(SELECT VDR.VNDR_LGL_ENG_NM" ).append("\n"); 
		query.append("                    FROM MDM_VENDOR VDR" ).append("\n"); 
		query.append("                   WHERE VDR.VNDR_SEQ = SO.INV_VNDR_SEQ ) AS INV_VNDR_NM" ).append("\n"); 
		query.append("                ,(SELECT IVDR.VNDR_SEQ ||'$'|| NVL(IVDR.VNDR_LGL_ENG_NM, ' ') ||'$'|| NVL((SELECT PVNDR.VNDR_SEQ ||'$'|| NVL(PVNDR.VNDR_LGL_ENG_NM, ' ') FROM MDM_VENDOR PVNDR WHERE PVNDR.VNDR_SEQ = IVDR.PRNT_VNDR_SEQ ), '$')" ).append("\n"); 
		query.append("                   FROM MDM_VENDOR IVDR" ).append("\n"); 
		query.append("                   WHERE IVDR.VNDR_SEQ = SO.VNDR_SEQ ) AS INV_VNDR_INFO" ).append("\n"); 
		query.append("                ,SO.TRO_LOD_REF_NO AS TRO_LOD_REF " ).append("\n"); 
		query.append("                ,(SELECT NVL(ETH.ALL_IN_RT_CD,' ') ||'$'|| NVL(TO_CHAR(DECODE(NVL(ETH.TRNS_REV_AMT,0)+NVL(ETH.NMF_TRNS_REV_AMT, 0)+NVL(ETH.ADD_REV_AMT, 0),0,'',NVL(ETH.TRNS_REV_AMT,0)+NVL(ETH.NMF_TRNS_REV_AMT, 0)+NVL(ETH.ADD_REV_AMT, 0) )), ' ') ||'$'||" ).append("\n"); 
		query.append("                         NVL(ETH.CXL_FLG,' ') ||'$'|| NVL(ETH.TRO_PROC_CD,' ') ||'$'|| NVL(ETH.EUR_TRNS_TP_CD,' ')" ).append("\n"); 
		query.append("                    FROM BKG_EUR_TRO ETH" ).append("\n"); 
		query.append("                   WHERE ETH.BKG_NO    = SO.BKG_NO" ).append("\n"); 
		query.append("                     AND ETH.IO_BND_CD = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("                     AND ETH.TRO_SEQ   = SO.TRO_SEQ" ).append("\n"); 
		query.append("                     AND SO.TRSP_COST_DTL_MOD_CD = 'DR' ) EUR_TRO_INFO" ).append("\n"); 
		query.append("                ,(SELECT IBD_TRSP_NO FROM BKG_CSTMS_ADV_IBD WHERE CNT_CD = 'US' AND BL_NO = SO.BL_NO) AS IT_NO " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                ,(SELECT BKG.SC_NO ||'$'|| BKG.RFA_NO " ).append("\n"); 
		query.append("                    FROM BKG_BOOKING BKG     " ).append("\n"); 
		query.append("                   WHERE BKG.BKG_NO = SO.BKG_NO " ).append("\n"); 
		query.append("                   #if($r_sc_rfa_cd.size() > 0) " ).append("\n"); 
		query.append("                      #if (${r_radio_number} == 'S' )" ).append("\n"); 
		query.append("                        AND BKG.SC_NO IN (" ).append("\n"); 
		query.append("                        #foreach( ${key} in ${r_sc_rfa_cd}) " ).append("\n"); 
		query.append("                          #if($velocityCount < $r_sc_rfa_cd.size()) " ).append("\n"); 
		query.append("                             UPPER('${key}'), " ).append("\n"); 
		query.append("                          #else " ).append("\n"); 
		query.append("                             UPPER('${key}')" ).append("\n"); 
		query.append("                          #end " ).append("\n"); 
		query.append("                        #end" ).append("\n"); 
		query.append("                      )" ).append("\n"); 
		query.append("                      #else" ).append("\n"); 
		query.append("                        AND BKG.RFA_NO IN (" ).append("\n"); 
		query.append("                        #foreach( ${key} in ${r_sc_rfa_cd}) " ).append("\n"); 
		query.append("                          #if($velocityCount < $r_sc_rfa_cd.size()) " ).append("\n"); 
		query.append("                             UPPER('${key}'), " ).append("\n"); 
		query.append("                          #else " ).append("\n"); 
		query.append("                             UPPER('${key}')" ).append("\n"); 
		query.append("                          #end " ).append("\n"); 
		query.append("                        #end" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("                      #end" ).append("\n"); 
		query.append("                   #end" ).append("\n"); 
		query.append("                 ) BKG_SC_NO_INFO" ).append("\n"); 
		query.append("                     " ).append("\n"); 
		query.append("                ,(SELECT BKG_CNTR.PCK_QTY ||'$'|| BKG_CNTR.PCK_TP_CD || '$' || NVL(BKG_CNTR.VGM_WGT_UT_CD, 'KGS') || '$' || NVL(BKG_CNTR.VGM_WGT, 0)" ).append("\n"); 
		query.append("                    FROM BKG_CONTAINER BKG_CNTR " ).append("\n"); 
		query.append("                   WHERE BKG_CNTR.BKG_NO  = SO.BKG_NO" ).append("\n"); 
		query.append("                     AND BKG_CNTR.CNTR_NO = SO.EQ_NO" ).append("\n"); 
		query.append("                 ) BKG_CNTR_INFO" ).append("\n"); 
		query.append("                ,SO.SPCL_CGO_CNTR_TP_CD" ).append("\n"); 
		query.append("                ,TRS_GET_FOC_INFO_FNC(SO.BL_NO, SO.TRSP_SO_OFC_CTY_CD, SO.TRSP_SO_SEQ, '$') EDI_FOC_INFO" ).append("\n"); 
		query.append("                    " ).append("\n"); 
		query.append("                ,(SELECT NVL(MST_CNTR.OWNR_CO_CD, ' ') ||'$'|| NVL(MST_CNTR.LSTM_CD, ' ') ||'$'|| NVL(MST_CNTR.IMDT_EXT_FLG, ' ')" ).append("\n"); 
		query.append("                    FROM MST_CONTAINER MST_CNTR" ).append("\n"); 
		query.append("                   WHERE MST_CNTR.CNTR_NO = SO.EQ_NO ) MST_CNTR_INFO" ).append("\n"); 
		query.append("                 ,SO.BKG_RCVDE_TERM_CD" ).append("\n"); 
		query.append("                ,CASE WHEN SO.TRSP_BND_CD = 'O' AND SO.CONTI_CD = 'M' AND SO.TRSP_COST_DTL_MOD_CD <> 'DR' THEN " ).append("\n"); 
		query.append("                    (SELECT PKUP_EDI_322_NO || '^^^'" ).append("\n"); 
		query.append("                     FROM (SELECT  /*+ INDEX (G XAK4EDI_322_MSG) */  G.BKG_EDI_322_NO" ).append("\n"); 
		query.append("                            ,G.EQ_NO" ).append("\n"); 
		query.append("                            ,G.DEST_LOC_NM" ).append("\n"); 
		query.append("                            ,G.PKUP_EDI_322_NO" ).append("\n"); 
		query.append("                            ,ROW_NUMBER() OVER(partition BY G.EQ_NO, G.BKG_EDI_322_NO, G.DEST_LOC_NM order by G.EVNT_DT DESC, G.EQ_NO DESC, G.EDI_322_STS_CD DESC) RK" ).append("\n"); 
		query.append("                          FROM EDI_322_MSG G) P1" ).append("\n"); 
		query.append("                    WHERE P1.BKG_EDI_322_NO = SO.BKG_NO" ).append("\n"); 
		query.append("                      AND P1.EQ_NO = SO.EQ_NO" ).append("\n"); 
		query.append("                      AND P1.DEST_LOC_NM = SO.FM_NOD_CD" ).append("\n"); 
		query.append("                      AND P1.RK = 1" ).append("\n"); 
		query.append("                      AND ROWNUM = 1" ).append("\n"); 
		query.append("                    )" ).append("\n"); 
		query.append("                  ELSE (SELECT TRS_GET_PKUP_NO_FNC(SO.BKG_NO, SO.EQ_NO, '', SO.DEL_CD, '', SO.FM_NOD_CD) FROM DUAL)  " ).append("\n"); 
		query.append("                 END PKUP_INFO" ).append("\n"); 
		query.append("                 ,SO.CONTI_CD" ).append("\n"); 
		query.append("			     ,( SELECT /*+ ORDERED INDEX_DESC(DMT_CNTR XPKDMT_CHG_BKG_CNTR) */" ).append("\n"); 
		query.append("				           TO_CHAR(DMT_CALC.FM_MVMT_DT, 'YYYY-MM-DD')" ).append("\n"); 
		query.append("							|| '$' ||DMT_CALC.FM_MVMT_YD_CD" ).append("\n"); 
		query.append("							|| '$' ||DMT_CALC.FM_MVMT_STS_CD" ).append("\n"); 
		query.append("							|| '$' ||DMT_CALC.TO_MVMT_DT" ).append("\n"); 
		query.append("							|| '$' ||DMT_CALC.TO_MVMT_YD_CD" ).append("\n"); 
		query.append("				            || '$' ||DMT_CALC.TO_MVMT_STS_CD" ).append("\n"); 
		query.append("				            || '$' ||" ).append("\n"); 
		query.append("				           NVL((SELECT TO_CHAR(CTM_MOV.CNMV_EVNT_DT, 'YYYY-MM-DD') || '$' || CTM_MOV.ORG_YD_CD" ).append("\n"); 
		query.append("						          FROM CTM_MOVEMENT CTM_MOV" ).append("\n"); 
		query.append("					             WHERE 1=1" ).append("\n"); 
		query.append("					               AND CTM_MOV.CNTR_NO        = DMT_CNTR.CNTR_NO" ).append("\n"); 
		query.append("					               AND CTM_MOV.CNMV_YR       IN (DMT_CALC.FM_MVMT_YR, DMT_CALC.TO_MVMT_YR) " ).append("\n"); 
		query.append("					               AND CTM_MOV.CNMV_SEQ      IN (DMT_CALC.FM_MVMT_SEQ, DMT_CALC.TO_MVMT_SEQ)" ).append("\n"); 
		query.append("					               AND CTM_MOV.CNMV_SPLIT_NO IN (DMT_CALC.FM_MVMT_SPLIT_NO, DMT_CALC.TO_MVMT_SPLIT_NO)" ).append("\n"); 
		query.append("					               AND CTM_MOV.MVMT_STS_CD    = 'MT'" ).append("\n"); 
		query.append("					               AND ROWNUM = 1" ).append("\n"); 
		query.append("					           ),'$')" ).append("\n"); 
		query.append("				           || '$' ||DECODE(DMT_CALC.WEB_IND_FLG, 'Y', TO_CHAR(NVL(DMT_CALC.WEB_MTY_DT, DMT_CALC.TO_MVMT_DT), 'YYYY-MM-DD'), TO_CHAR(DMT_CALC.WEB_MTY_DT, 'YYYY-MM-DD')) " ).append("\n"); 
		query.append("				           || '$' ||DECODE(DMT_CALC.WEB_IND_FLG, 'Y', TO_CHAR(NVL(DMT_CALC.WEB_MTY_DT, DMT_CALC.TO_MVMT_DT) + 7, 'YYYY-MM-DD'), TO_CHAR(DMT_CALC.WEB_MTY_DT + 7, 'YYYY-MM-DD'))" ).append("\n"); 
		query.append("				           || '$' DMT_INFO" ).append("\n"); 
		query.append("			         FROM DMT_CHG_BKG_CNTR DMT_CNTR" ).append("\n"); 
		query.append("				         ,DMT_CHG_CALC     DMT_CALC" ).append("\n"); 
		query.append("			        WHERE DMT_CNTR.SYS_AREA_GRP_ID = DMT_CALC.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("				      AND DMT_CNTR.CNTR_NO         = DMT_CALC.CNTR_NO" ).append("\n"); 
		query.append("				      AND DMT_CNTR.CNTR_CYC_NO     = DMT_CALC.CNTR_CYC_NO" ).append("\n"); 
		query.append("				      AND DMT_CNTR.BKG_NO  = SO.BKG_NO" ).append("\n"); 
		query.append("				      AND DMT_CNTR.CNTR_NO = SO.EQ_NO" ).append("\n"); 
		query.append("				      AND DMT_CALC.DMDT_TRF_CD = 'DTIC'" ).append("\n"); 
		query.append("				      AND DMT_CALC.CHG_SEQ     = 1" ).append("\n"); 
		query.append("				      AND 'I' = SO.TRSP_BND_CD" ).append("\n"); 
		query.append("				      AND ROWNUM = 1" ).append("\n"); 
		query.append("			     ) DMDT_INFO" ).append("\n"); 
		query.append("                 ,SO.CNTR_SLT_NO" ).append("\n"); 
		query.append("            FROM TRS_TRSP_SVC_ORD SO" ).append("\n"); 
		query.append("                ,TRS_TRSP_WRK_ORD WO" ).append("\n"); 
		query.append("                ,TRS_TRSP_INV_WRK WRK" ).append("\n"); 
		query.append("				,MDM_ZONE Z" ).append("\n"); 
		query.append("           WHERE SO.TRSP_WO_OFC_CTY_CD = WO.TRSP_WO_OFC_CTY_CD(+)" ).append("\n"); 
		query.append("             AND SO.TRSP_WO_SEQ = WO.TRSP_WO_SEQ(+)" ).append("\n"); 
		query.append("             AND SO.INV_NO = WRK.INV_NO(+) " ).append("\n"); 
		query.append("             AND SO.INV_VNDR_SEQ = WRK.INV_VNDR_SEQ(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_trunk_vvd.size() > 0) " ).append("\n"); 
		query.append("		     AND ((SO.VSL_CD, SO.SKD_VOY_NO, SO.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_trunk_vvd}) " ).append("\n"); 
		query.append("         #if($velocityCount == 1) " ).append("\n"); 
		query.append("		            ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("		          , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("         )" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_bkgnumber.size() > 0) " ).append("\n"); 
		query.append("		     AND SO.BKG_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_bkgnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_bkgnumber.size()) " ).append("\n"); 
		query.append("		            UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("		            UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_blnumber.size() > 0) " ).append("\n"); 
		query.append("		     AND SO.BL_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_blnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_blnumber.size()) " ).append("\n"); 
		query.append("		            UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("		            UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_copnumber.size() > 0) " ).append("\n"); 
		query.append("		     AND SO.COP_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_copnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_copnumber.size()) " ).append("\n"); 
		query.append("		           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("		           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_eqnumber.size() > 0) " ).append("\n"); 
		query.append("		     AND SO.EQ_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_eqnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_eqnumber.size()) " ).append("\n"); 
		query.append("		           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("		           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      #if (${r_radio_eq} == 'CNTR') " ).append("\n"); 
		query.append("		      AND SO.EQ_KND_CD = 'U'" ).append("\n"); 
		query.append("      #elseif (${r_radio_eq} == 'CHS') " ).append("\n"); 
		query.append("		      AND SO.EQ_KND_CD = 'Z'" ).append("\n"); 
		query.append("      #elseif (${r_radio_eq} == 'GEN') " ).append("\n"); 
		query.append("		      AND SO.EQ_KND_CD = 'G'" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_mtyrefnumber.size() > 0) " ).append("\n"); 
		query.append("			  AND SO.REF_ID IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_mtyrefnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_mtyrefnumber.size()) " ).append("\n"); 
		query.append("		           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("		           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_period} == 'S') " ).append("\n"); 
		query.append("      #if (${r_from_date} != ''|| ${r_to_date} != '') " ).append("\n"); 
		query.append("		      AND SO.LOCL_CRE_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmdd') AND TO_DATE (@[r_to_date], 'rrrrmmdd') + 0.999999" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'W')" ).append("\n"); 
		query.append("      #if (${r_from_date} != ''|| ${r_to_date} != '') " ).append("\n"); 
		query.append("        #if (${month_flg}) " ).append("\n"); 
		query.append("		      AND WO.LOCL_CRE_DT BETWEEN TO_DATE ( @[r_from_date] ,'RRRRMM') AND LAST_DAY( TO_DATE( @[r_to_date] , 'RRRRMM'))+1" ).append("\n"); 
		query.append("        #else " ).append("\n"); 
		query.append("	          AND WO.LOCL_CRE_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("     #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'I')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("		      AND WRK.INV_CFM_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'O')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("		      AND SO.N1ST_NOD_PLN_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #elseif (${r_period} == 'L')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("		      AND SO.LST_NOD_PLN_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #elseif (${r_period} == 'D')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("		      AND SO.DOR_NOD_PLN_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_input_office.size() > 0) " ).append("\n"); 
		query.append("      #if (${r_radio_office} == 'S')" ).append("\n"); 
		query.append("		      AND SO.CRE_OFC_CD IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_input_office}) " ).append("\n"); 
		query.append("          #if($velocityCount < $r_input_office.size()) " ).append("\n"); 
		query.append("		            UPPER('${key}')," ).append("\n"); 
		query.append("          #else " ).append("\n"); 
		query.append("		            UPPER('${key}')" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("      #elseif (${r_radio_office} == 'V')" ).append("\n"); 
		query.append("		      AND WRK.CRE_OFC_CD IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_input_office}) " ).append("\n"); 
		query.append("          #if($velocityCount < $r_input_office.size()) " ).append("\n"); 
		query.append("		            UPPER('${key}')," ).append("\n"); 
		query.append("          #else " ).append("\n"); 
		query.append("		            UPPER('${key}')" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("      #elseif (${r_radio_office} == 'W')" ).append("\n"); 
		query.append("		      AND WO.CRE_OFC_CD IN (" ).append("\n"); 
		query.append("        #foreach( ${key} in ${r_input_office}) " ).append("\n"); 
		query.append("          #if($velocityCount < $r_input_office.size()) " ).append("\n"); 
		query.append("		            UPPER('${key}')," ).append("\n"); 
		query.append("          #else " ).append("\n"); 
		query.append("		            UPPER('${key}')" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_somode} == 'LV') " ).append("\n"); 
		query.append("		      AND SO.DELT_FLG = 'N'" ).append("\n"); 
		query.append("    #elseif (${r_somode}=='DL')" ).append("\n"); 
		query.append("		      AND SO.DELT_FLG = 'Y'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_womode} != '' && ${r_womode} != 'ALL')" ).append("\n"); 
		query.append("      #if (${r_womode} == 'IS')" ).append("\n"); 
		query.append("		      AND WO.WO_ISS_STS_CD IN ( 'I' , 'R' , 'C')" ).append("\n"); 
		query.append("      #else " ).append("\n"); 
		query.append("		      AND (WO.WO_ISS_STS_CD = 'X' OR (SO.TRSP_SO_STS_CD IN ('R', 'C') AND SO.TRSP_WO_OFC_CTY_CD IS NULL))" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_invoicemode} != '' && ${r_invoicemode} != 'ALL')" ).append("\n"); 
		query.append("      #if (${r_invoicemode} == 'NL') " ).append("\n"); 
		query.append("		      AND WRK.TRSP_INV_AUD_STS_CD(+) IS NULL" ).append("\n"); 
		query.append("      #else" ).append("\n"); 
		query.append("		      AND WRK.TRSP_INV_AUD_STS_CD = @[r_invoicemode]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_boundmode} != '' && ${r_boundmode} != 'ALL')" ).append("\n"); 
		query.append("		      AND SO.TRSP_BND_CD = @[r_boundmode]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_radio_user} == 'S') " ).append("\n"); 
		query.append("      #if (${r_user_id} != '') " ).append("\n"); 
		query.append("		      AND SO.CRE_USR_ID = @[r_user_id]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_radio_user} == 'V') " ).append("\n"); 
		query.append("      #if (${r_user_id} != '') " ).append("\n"); 
		query.append("		      AND WRK.CRE_USR_ID = @[r_user_id]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_costmode} != '' && ${r_costmode} != 'ALL')" ).append("\n"); 
		query.append("		      AND SO.TRSP_COST_DTL_MOD_CD = @[r_costmode]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_transmode} != '' && ${r_transmode} != 'ALL')" ).append("\n"); 
		query.append("		      AND SO.TRSP_CRR_MOD_CD = @[r_transmode]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_sotype} != '' && ${r_sotype} != 'ALL')" ).append("\n"); 
		query.append("		      AND SO.TRSP_SO_TP_CD = @[r_sotype]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_provider} != '' && ${r_provider} != 'ALL') " ).append("\n"); 
		query.append("      #if (${r_provider_type} == 'WO') " ).append("\n"); 
		query.append("		      AND SO.VNDR_SEQ = @[r_provider]" ).append("\n"); 
		query.append("      #elseif (${r_provider_type} == 'IV') " ).append("\n"); 
		query.append("		      AND SO.INV_VNDR_SEQ = @[r_provider]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_from_node} != '') " ).append("\n"); 
		query.append("		      AND SO.FM_NOD_CD LIKE @[r_from_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("	-- Multi From Node로 조회" ).append("\n"); 
		query.append("	#if ($arr_fmnode.size() > 0) " ).append("\n"); 
		query.append("			  AND SO.FM_NOD_CD in (" ).append("\n"); 
		query.append("	    #foreach( ${key} in ${arr_fmnode}) " ).append("\n"); 
		query.append("		    #if($velocityCount < $arr_fmnode.size()) " ).append("\n"); 
		query.append("		        '$key', " ).append("\n"); 
		query.append("		    #else " ).append("\n"); 
		query.append("	            '$key' " ).append("\n"); 
		query.append("		    #end " ).append("\n"); 
		query.append("	    #end" ).append("\n"); 
		query.append("	    )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("    #if (${r_via_node} != '') " ).append("\n"); 
		query.append("		      AND SO.VIA_NOD_CD LIKE @[r_via_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_to_node} != '') " ).append("\n"); 
		query.append("		      AND SO.TO_NOD_CD LIKE @[r_to_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("	-- Multi To Node로 조회" ).append("\n"); 
		query.append("	#if ($arr_tonode.size() > 0) " ).append("\n"); 
		query.append("			  AND SO.TO_NOD_CD in (" ).append("\n"); 
		query.append("	    #foreach( ${key} in ${arr_tonode}) " ).append("\n"); 
		query.append("		    #if($velocityCount < $arr_tonode.size()) " ).append("\n"); 
		query.append("		        '$key', " ).append("\n"); 
		query.append("		    #else " ).append("\n"); 
		query.append("	            '$key' " ).append("\n"); 
		query.append("		    #end " ).append("\n"); 
		query.append("	    #end" ).append("\n"); 
		query.append("	    )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	-- Port로 조회 " ).append("\n"); 
		query.append("	#if (${portio} == 'I')" ).append("\n"); 
		query.append("  		AND SO.POD_CD = @[portcd]" ).append("\n"); 
		query.append("	#elseif (${portio} == 'O')" ).append("\n"); 
		query.append("		AND SO.POL_CD = @[portcd]" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("    #if (${r_door_node} != '') " ).append("\n"); 
		query.append("		      AND SO.DOR_NOD_CD LIKE @[r_door_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_sonumber.size() > 0) " ).append("\n"); 
		query.append("		      AND ((SO.TRSP_SO_OFC_CTY_CD, SO.TRSP_SO_SEQ) IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_sonumber}) " ).append("\n"); 
		query.append("          #if($velocityCount == 1) " ).append("\n"); 
		query.append("        		     ( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #else" ).append("\n"); 
		query.append("		            ,( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        ) " ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_wonumber.size() > 0) " ).append("\n"); 
		query.append("		      AND ((SO.TRSP_WO_OFC_CTY_CD, SO.TRSP_WO_SEQ) IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_wonumber}) " ).append("\n"); 
		query.append("          #if($velocityCount == 1) " ).append("\n"); 
		query.append("		             ( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #else" ).append("\n"); 
		query.append("		            ,( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        ) " ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_invoicenumber.size() > 0) " ).append("\n"); 
		query.append("		      AND SO.INV_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} IN ${r_invoicenumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_invoicenumber.size()) " ).append("\n"); 
		query.append("		            UPPER('${key}')," ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("		            UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	 AND DECODE(NVL(@[r_unplanned], 'ALL'), 'ALL', 'X', NVL(SO.UPLN_SO_FLG, 'N')) = DECODE(NVL(@[r_unplanned], 'ALL'), 'ALL', 'X', @[r_unplanned])" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_zip_code.size() > 0) " ).append("\n"); 
		query.append("		      AND SO.DOR_PST_CD IN (" ).append("\n"); 
		query.append("       #foreach( ${key} IN ${r_zip_code}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_zip_code.size()) " ).append("\n"); 
		query.append("		           UPPER('${key}')," ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("		           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_amount} == 'T')" ).append("\n"); 
		query.append("		      AND SO.INV_NO IS NOT NULL" ).append("\n"); 
		query.append("		      AND NVL(SO.INV_ETC_ADD_AMT,0) = 0" ).append("\n"); 
		query.append("    #elseif (${r_amount} == 'F')" ).append("\n"); 
		query.append("		      AND SO.INV_NO IS NOT NULL" ).append("\n"); 
		query.append("		      AND NVL(SO.INV_ETC_ADD_AMT,0) <> 0" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${grid_flg} == 'Y' && $r_sc_rfa_cd.size() == 0)" ).append("\n"); 
		query.append("--		      AND ROWNUM < 2001" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if($cntr_slt_no.size() > 0)" ).append("\n"); 
		query.append("	-- 2016.02.02 CHAN WOO PARK" ).append("\n"); 
		query.append("    -- Slot Reference No 검색조건 추가" ).append("\n"); 
		query.append("	AND SO.CNTR_SLT_NO IN (" ).append("\n"); 
		query.append("		#foreach($code IN ${cntr_slt_no})" ).append("\n"); 
		query.append("			#if($velocityCount == 1)" ).append("\n"); 
		query.append("				 '$code'" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				,'$code'" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("		AND SO.DOR_NOD_CD  = Z.ZN_CD(+)" ).append("\n"); 
		query.append("	 ) X" ).append("\n"); 
		query.append("	  WHERE 1=1" ).append("\n"); 
		query.append("    #if (${r_provider} != '' && ${r_provider} != 'ALL') " ).append("\n"); 
		query.append("      #if (${r_provider_type} == 'PA')" ).append("\n"); 
		query.append("        AND SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 2) + 1, INSTR(X.INV_VNDR_INFO, '$', 1, 3) - INSTR(X.INV_VNDR_INFO, '$', 1, 2) - 1) = @[r_provider]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if($r_sc_rfa_cd.size() > 0) " ).append("\n"); 
		query.append("       #if (${r_radio_number} == 'S' )" ).append("\n"); 
		query.append("        AND SUBSTR(X.BKG_SC_NO_INFO, 1, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) -1) IN (" ).append("\n"); 
		query.append("         #foreach( ${key} in ${r_sc_rfa_cd}) " ).append("\n"); 
		query.append("           #if($velocityCount < $r_sc_rfa_cd.size()) " ).append("\n"); 
		query.append("        	      UPPER('${key}'), " ).append("\n"); 
		query.append("           #else " ).append("\n"); 
		query.append("	              UPPER('${key}')" ).append("\n"); 
		query.append("           #end " ).append("\n"); 
		query.append("         #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        AND SUBSTR(X.BKG_SC_NO_INFO, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) + 1) IN (" ).append("\n"); 
		query.append("         #foreach( ${key} in ${r_sc_rfa_cd}) " ).append("\n"); 
		query.append("           #if($velocityCount < $r_sc_rfa_cd.size()) " ).append("\n"); 
		query.append("	              UPPER('${key}'), " ).append("\n"); 
		query.append("           #else " ).append("\n"); 
		query.append("	              UPPER('${key}')" ).append("\n"); 
		query.append("           #end " ).append("\n"); 
		query.append("         #end" ).append("\n"); 
		query.append("         )" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif (${invar_usrail} == 'Y') " ).append("\n"); 
		query.append("/* US RAIL Only inquiry  */" ).append("\n"); 
		query.append("SELECT   X.EQ_NO" ).append("\n"); 
		query.append("        ,X.EQ_TPSZ" ).append("\n"); 
		query.append("        ,NULL ORG_EQ_TPSZ" ).append("\n"); 
		query.append("        ,X.TRSP_COST_DTL_MOD_CD" ).append("\n"); 
		query.append("        ,'RD' TRSP_CRR_MOD_CD" ).append("\n"); 
		query.append("        ,'RAIL BILLING' AS TRSP_SO_TP_CD" ).append("\n"); 
		query.append("        ,X.UPLN_SO_FLG" ).append("\n"); 
		query.append("        ,NULL AS BKG_CNTR_CMB_SEQ" ).append("\n"); 
		query.append("        ,X.TRSP_FRST_FLG" ).append("\n"); 
		query.append("        ,X.SO_NO" ).append("\n"); 
		query.append("        ,X.SO_CRE_DT1" ).append("\n"); 
		query.append("        ,X.SO_DEL_FLG" ).append("\n"); 
		query.append("        ,DECODE (X.SO_DEL_FLG,'Y', SO_UPD_DT) SO_DEL_DT" ).append("\n"); 
		query.append("        ,X.SO_UPD_DT" ).append("\n"); 
		query.append("        ,NULL WO_NO" ).append("\n"); 
		query.append("        ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00804' AND CD.INTG_CD_VAL_CTNT = X.WO_ISS_STS_CD) AS WO_ISS_STS_CD" ).append("\n"); 
		query.append("        ,X.WO_ISS_DT" ).append("\n"); 
		query.append("        ,X.WO_ISS_TP" ).append("\n"); 
		query.append("        ,X.WO_ISS_OFC_CD" ).append("\n"); 
		query.append("        ,X.WO_ISS_ID" ).append("\n"); 
		query.append("        ,X.FM_NOD_CD" ).append("\n"); 
		query.append("		,DECODE(LENGTH(X.FM_NOD_CD), 7, TRS_COMMON_PKG.GET_YD_CD_NM_FNC(X.FM_NOD_CD), 5, (SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.FM_NOD_CD)) FM_NOD_CD_NM" ).append("\n"); 
		query.append("        ,NULL VIA_NOD_CD" ).append("\n"); 
		query.append("		,NULL VIA_NOD_CD_NM" ).append("\n"); 
		query.append("        ,X.TO_NOD_CD" ).append("\n"); 
		query.append("		,DECODE(LENGTH(X.TO_NOD_CD), 7, TRS_COMMON_PKG.GET_YD_CD_NM_FNC(X.TO_NOD_CD), 5, (SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.TO_NOD_CD)) TO_NOD_CD_NM" ).append("\n"); 
		query.append("        ,NULL DOOR" ).append("\n"); 
		query.append("		,NULL DOOR_NM" ).append("\n"); 
		query.append("        ,NULL DOOR_ACT_CUST" ).append("\n"); 
		query.append("        ,NULL DOOR_FCTRY_NM        " ).append("\n"); 
		query.append("        ,NULL DOOR_ZIP" ).append("\n"); 
		query.append("        ,NULL DOR_DE_ADDR" ).append("\n"); 
		query.append("        ,NULL DOOR_TEL" ).append("\n"); 
		query.append("        ,NULL DOOR_FAX" ).append("\n"); 
		query.append("        ,NULL DOOR_PIC" ).append("\n"); 
		query.append("        ,NULL USA_DO_USR_INFO" ).append("\n"); 
		query.append("        ,NULL DO_CRE_DATE" ).append("\n"); 
		query.append("        ,NULL DO_CRE_TIME" ).append("\n"); 
		query.append("        ,NULL VNDR_TP_CD" ).append("\n"); 
		query.append("        ,SUBSTR(X.INV_VNDR_INFO, 1, INSTR(X.INV_VNDR_INFO, '$', 1, 1) - 1) AS VNDR_CD" ).append("\n"); 
		query.append("        ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 1) + 1, INSTR(X.INV_VNDR_INFO, '$', 1, 2) - INSTR(X.INV_VNDR_INFO, '$', 1, 1) - 1) AS VNDR_ABBR_NM" ).append("\n"); 
		query.append("        ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 2) + 1, INSTR(X.INV_VNDR_INFO, '$', 1, 3) - INSTR(X.INV_VNDR_INFO, '$', 1, 2) - 1) AS PVNDR_CD" ).append("\n"); 
		query.append("        ,SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 3) + 1) AS PVNDR_NM" ).append("\n"); 
		query.append("        ,NULL WO_RCV_DT" ).append("\n"); 
		query.append("        ,NULL APPT_TIME" ).append("\n"); 
		query.append("        ,NULL DELIV_TIME" ).append("\n"); 
		query.append("        ,X.N3PTY_BIL_FLG" ).append("\n"); 
		query.append("        ,X.COST_OFC_CD" ).append("\n"); 
		query.append("        ,X.WO_CURR_CD" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_BZC_AMT) WO_BZC_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_NEGO_AMT) WO_NEGO_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_FUEL_SCG_AMT) WO_FUEL_SCG_AMT" ).append("\n"); 
		query.append("        ,CASE WHEN X.WO_CURR_CD = 'JPY' OR X.WO_CURR_CD = 'KRW' OR X.WO_CURR_CD = 'TWD'" ).append("\n"); 
		query.append("              THEN '0'" ).append("\n"); 
		query.append("              ELSE '0.00'" ).append("\n"); 
		query.append("         END AS WO_ETC_ADD_AMT" ).append("\n"); 
		query.append("		,TO_CHAR(X.WO_HZD_MTRL_SCG_AMT) WO_HZD_MTRL_SCG_AMT" ).append("\n"); 
		query.append("		,TO_CHAR(X.WO_OVR_WGT_SCG_AMT) WO_OVR_WGT_SCG_AMT" ).append("\n"); 
		query.append("		,TO_CHAR(X.WO_ETC_ADD_AMT) WO_USA_TTL_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_TOT_AMT) WO_TOT_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WO_TOT_AMT_USD) WO_TOT_AMT_USD" ).append("\n"); 
		query.append("        ,NULL INV_XCH_RT" ).append("\n"); 
		query.append("        ,NULL INV_CALC_LGC_TP_CD" ).append("\n"); 
		query.append("        ,X.INV_CURR_CD" ).append("\n"); 
		query.append("        ,TO_CHAR(X.INV_BZC_AMT) INV_BZC_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.INV_ETC_ADD_AMT) INV_ETC_ADD_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.INV_TOT_AMT) INV_TOT_AMT" ).append("\n"); 
		query.append("        ,TO_CHAR(X.INV_TOT_AMT_USD) INV_TOT_AMT_USD" ).append("\n"); 
		query.append("        ,TO_CHAR(X.INV_VNDR_SEQ) INV_VNDR_CD" ).append("\n"); 
		query.append("        ,X.INV_VNDR_NM" ).append("\n"); 
		query.append("        ,X.INV_NO" ).append("\n"); 
		query.append("        ,(SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL CD WHERE CD.INTG_CD_ID = 'CD00824' AND CD.INTG_CD_VAL_CTNT = X.INV_STS_CD) AS INV_STS_CD" ).append("\n"); 
		query.append("        ,X.INV_CFM_DT" ).append("\n"); 
		query.append("        ,X.CSR_NO CAR_NO" ).append("\n"); 
		query.append("        ,TO_CHAR (X.IF_DT, 'YYYY-MM-DD HH24:MI:SS') INV_IF_DT" ).append("\n"); 
		query.append("        ,X.INV_CFM_OFC_CD" ).append("\n"); 
		query.append("        ,X.INV_CRE_USR_ID" ).append("\n"); 
		query.append("        ,X.N1ST_NOD_PLN_DT" ).append("\n"); 
		query.append("        ,X.LST_NOD_PLN_DT" ).append("\n"); 
		query.append("        ,NULL DOR_NOD_PLN_DT" ).append("\n"); 
		query.append("        ,NULL DOR_ARR_DT" ).append("\n"); 
		query.append("        ,X.COP_NO" ).append("\n"); 
		query.append("        ,TO_CHAR(X.AG_SEQ) COST_ACT_GRP_SEQ" ).append("\n"); 
		query.append("        ,X.AG_CODE AS COST_ACT_GRP_CD" ).append("\n"); 
		query.append("        ,X.BKG_NO " ).append("\n"); 
		query.append("        ,X.BL_NO" ).append("\n"); 
		query.append("        ,X.TRSP_BND_CD" ).append("\n"); 
		query.append("        ,X.TERM" ).append("\n"); 
		query.append("        ,NULL TRO_SEQ" ).append("\n"); 
		query.append("        ,'' TRO_CNFM" ).append("\n"); 
		query.append("        ,NULL TRO_CFM_OFC" ).append("\n"); 
		query.append("        ,NULL TRO_CFM_USR" ).append("\n"); 
		query.append("        ,NULL TRO_CFM_UPD" ).append("\n"); 
		query.append("        ,NULL TRO_REV_CUR" ).append("\n"); 
		query.append("        ,NULL EUR_TRO_REV" ).append("\n"); 
		query.append("        ,NULL MANIFESTED" ).append("\n"); 
		query.append("        ,NULL TRO_LOD_REF" ).append("\n"); 
		query.append("        ,NULL BKG_QTY" ).append("\n"); 
		query.append("        ,X.POR_CD" ).append("\n"); 
		query.append("		,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.POR_CD ) POR_CD_NM" ).append("\n"); 
		query.append("        ,X.POL_CD" ).append("\n"); 
		query.append("		,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.POL_CD ) POL_CD_NM" ).append("\n"); 
		query.append("        ,X.POD_CD" ).append("\n"); 
		query.append("		,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.POD_CD ) POD_CD_NM" ).append("\n"); 
		query.append("        ,X.DEL_CD" ).append("\n"); 
		query.append("		,(SELECT LOC_NM FROM MDM_LOCATION WHERE LOC_CD = X.DEL_CD ) DEL_CD_NM" ).append("\n"); 
		query.append("        ,X.T_VVD" ).append("\n"); 
		query.append("        ,X.SLAN_CD" ).append("\n"); 
		query.append("        ,NULL IB_VVD_CD" ).append("\n"); 
		query.append("        ,NULL OB_VVD_CD" ).append("\n"); 
		query.append("        ,X.CGO_TP_CD" ).append("\n"); 
		query.append("        ,X.SPCL_CGO_CNTR_TP_CD AS BKG_SPE" ).append("\n"); 
		query.append("        ,SUBSTR(X.MST_CNTR_INFO, 1, INSTR(X.MST_CNTR_INFO, '$', 1, 1) -1) AS USED" ).append("\n"); 
		query.append("        ,SUBSTR(X.MST_CNTR_INFO, INSTR(X.MST_CNTR_INFO, '$', 1, 1) + 1, INSTR(X.MST_CNTR_INFO, '$', 1, 2) - INSTR(X.MST_CNTR_INFO, '$', 1, 1) - 1) AS LT" ).append("\n"); 
		query.append("        ,SUBSTR(X.MST_CNTR_INFO, INSTR(X.MST_CNTR_INFO, '$', 1, 2) + 1) AS I_EXIT" ).append("\n"); 
		query.append("        ,NULL LT_EXP" ).append("\n"); 
		query.append("        ,(SELECT CNTR_SEAL_NO FROM BKG_CNTR_SEAL_NO WHERE BKG_NO  = X.BKG_NO AND CNTR_NO = X.EQ_NO AND CNTR_SEAL_SEQ = 1) AS SEAL_NO" ).append("\n"); 
		query.append("        ,(SELECT CNTR_SEAL_NO FROM BKG_CNTR_SEAL_NO WHERE BKG_NO  = X.BKG_NO AND CNTR_NO = X.EQ_NO AND CNTR_SEAL_SEQ = 2) AS SEAL_NO2" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WEIGHT_KGS) WEIGHT_KGS" ).append("\n"); 
		query.append("        ,TO_CHAR(X.WEIGHT_LBS) WEIGHT_LBS" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        ,TRS_COMMON_PKG.GET_CONV_WGT_TO_KGS_FNC(TRIM(REGEXP_SUBSTR(X.BKG_CNTR_INFO, '[^$]+',1, 3)), TRIM(REGEXP_SUBSTR(X.BKG_CNTR_INFO, '[^$]+',1, 4))) AS VGM_KGS_WGT" ).append("\n"); 
		query.append("        ,TRS_COMMON_PKG.GET_CONV_WGT_TO_LBS_FNC(TRIM(REGEXP_SUBSTR(X.BKG_CNTR_INFO, '[^$]+',1, 3)), TRIM(REGEXP_SUBSTR(X.BKG_CNTR_INFO, '[^$]+',1, 4))) AS VGM_LBS_WGT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        ,SUBSTR(X.BKG_CNTR_INFO, 1, INSTR(X.BKG_CNTR_INFO, '$', 1, 1) -1) AS NO_PKG" ).append("\n"); 
		query.append("        ,SUBSTR(X.BKG_CNTR_INFO, INSTR(X.BKG_CNTR_INFO, '$', 1, 1) + 1, INSTR(X.BKG_CNTR_INFO, '$', 1, 2) - INSTR(X.BKG_CNTR_INFO, '$', 1, 1) - 1) PKG_CD" ).append("\n"); 
		query.append("        ,X.CMDT_NM" ).append("\n"); 
		query.append("        ,X.C_LOC" ).append("\n"); 
		query.append("        ,NULL USA_LAST_CITY" ).append("\n"); 
		query.append("        ,NVL(REGEXP_SUBSTR(X.EDI_FOC_INFO, '[^$]+', 1, 1), 'N') AS F" ).append("\n"); 
		query.append("        ,NVL(REGEXP_SUBSTR(X.EDI_FOC_INFO, '[^$]+', 1, 2), 'N') AS O" ).append("\n"); 
		query.append("        ,NVL(REGEXP_SUBSTR(X.EDI_FOC_INFO, '[^$]+', 1, 3), 'N') AS C" ).append("\n"); 
		query.append("        ,IT_NO" ).append("\n"); 
		query.append("        ,'' AS PICKUP_NO" ).append("\n"); 
		query.append("        ,'' AS PU_YARD_CD" ).append("\n"); 
		query.append("        ,'' AS AVAILABLE_DT" ).append("\n"); 
		query.append("        ,'' AS LAST_FREE_DT" ).append("\n"); 
		query.append("        ,SUBSTR(X.BKG_SC_NO_INFO, 1, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) -1) AS SC_NO" ).append("\n"); 
		query.append("        ,SUBSTR(X.BKG_SC_NO_INFO, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) + 1) AS RFA_NO" ).append("\n"); 
		query.append("        ,NULL DOOR_SVC_TP" ).append("\n"); 
		query.append("        ,NULL PKUP_CNTR" ).append("\n"); 
		query.append("	    ,(SELECT REPLACE(REPLACE (CUST_NM, CHR (13),' '), CHR (10), '') FROM BKG_CUSTOMER CUST WHERE CUST.BKG_NO = X.BKG_NO AND CUST.BKG_CUST_TP_CD = 'S' ) AS SHIPPER" ).append("\n"); 
		query.append("	    ,(SELECT REPLACE(REPLACE (CUST_NM, CHR (13),' '), CHR (10), '') FROM BKG_CUSTOMER CUST WHERE CUST.BKG_NO = X.BKG_NO AND CUST.BKG_CUST_TP_CD = 'C' ) AS CONSIGNEE" ).append("\n"); 
		query.append("	    ,(SELECT REPLACE(REPLACE (CUST_NM, CHR (13),' '), CHR (10), '') FROM BKG_CUSTOMER CUST WHERE CUST.BKG_NO = X.BKG_NO AND CUST.BKG_CUST_TP_CD = 'N' ) AS NOTIFY" ).append("\n"); 
		query.append("        ,(SELECT LISTAGG(DECODE(NVL(U.EQ_SUBST_CGO_QTY, 0), 0, U.CNTR_TPSZ_CD ||' '||U.OP_CNTR_QTY, U.CNTR_TPSZ_CD||' '||U.OP_CNTR_QTY ||'-SUB '||U.EQ_SUBST_CNTR_TPSZ_CD||' '||U.EQ_SUBST_CGO_QTY ), ', ') WITHIN GROUP (ORDER BY U.BKG_NO)" ).append("\n"); 
		query.append("        FROM BKG_QUANTITY U" ).append("\n"); 
		query.append("       WHERE U.BKG_NO       = X.BKG_NO ) AS BKG_QTY" ).append("\n"); 
		query.append("        ,NULL REF_BKG_NO" ).append("\n"); 
		query.append("        ,NULL REF_BL_NO" ).append("\n"); 
		query.append("        ,X.ORG_GATE_OUT_DT" ).append("\n"); 
		query.append("        ,X.DEST_GATE_IN_DT" ).append("\n"); 
		query.append("        ,X.MTY_REF_ID" ).append("\n"); 
		query.append("        ,NULL TRSP_PURP_RSN" ).append("\n"); 
		query.append("        ,REPLACE(REPLACE(X.INTER_RMK, CHR(13)||CHR(10), ' '), chr(34), '') AS INTER_RMK" ).append("\n"); 
		query.append("        ,NULL SPCL_INSTR_RMK" ).append("\n"); 
		query.append("        ,REPLACE(REPLACE(X.WO_INSTR_RMK, CHR(13)||CHR(10), ' '), chr(34), '') AS WO_INSTR_RMK" ).append("\n"); 
		query.append("        ,NULL CHZ_BUNDLE_SEQ" ).append("\n"); 
		query.append("        ,NULL TRSP_SPL_SO_TP_CD" ).append("\n"); 
		query.append("		,NULL REF_INV_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${invar_usdropnpull} == 'Y') " ).append("\n"); 
		query.append("		,''FM_DT" ).append("\n"); 
		query.append("		,''FM_YD" ).append("\n"); 
		query.append("		,''FM_STS" ).append("\n"); 
		query.append("		,''TO_DT" ).append("\n"); 
		query.append("		,''TO_YD" ).append("\n"); 
		query.append("		,''TO_STS" ).append("\n"); 
		query.append("		,''MT_DT" ).append("\n"); 
		query.append("		,''MT_YD" ).append("\n"); 
		query.append("		,''WEB_MT_DT" ).append("\n"); 
		query.append("		,''GRACE_END" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("#if (${grid_flg} == 'Y')" ).append("\n"); 
		query.append("        ,'M' CONTI_CD" ).append("\n"); 
		query.append("        ,X.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("        ,TO_CHAR(X.TRSP_SO_SEQ) TRSP_SO_SEQ" ).append("\n"); 
		query.append("        ,TO_CHAR(X.VNDR_SEQ) VNDR_SEQ" ).append("\n"); 
		query.append("        ,NULL TRSP_WO_OFC_CTY_CD" ).append("\n"); 
		query.append("        ,NULL TRSP_WO_SEQ" ).append("\n"); 
		query.append("        ,X.WGT_MEAS_UT_CD UOM" ).append("\n"); 
		query.append("        ,X.REGISTRATION_NO" ).append("\n"); 
		query.append("        ,X.UPD_USR_ID" ).append("\n"); 
		query.append("        ,NULL IF_SYS_KND_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  FROM (" ).append("\n"); 
		query.append("          SELECT SO.CMDT_CD" ).append("\n"); 
		query.append("                ,VNDR.VNDR_SEQ" ).append("\n"); 
		query.append("                ,SO.CUST_SEQ" ).append("\n"); 
		query.append("                ,SO.CUST_CNT_CD" ).append("\n"); 
		query.append("                ,WRK.CSR_NO" ).append("\n"); 
		query.append("                ,SO.LOCL_CRE_DT SO_CRE_DT" ).append("\n"); 
		query.append("                ,VNDR.LOCL_CRE_DT WO_CRE_DT" ).append("\n"); 
		query.append("                ,WRK.CRE_OFC_CD INV_CRE_OFC_CD" ).append("\n"); 
		query.append("                ,SO.VSL_CD" ).append("\n"); 
		query.append("                ,SO.SKD_VOY_NO" ).append("\n"); 
		query.append("                ,SO.SKD_DIR_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_STS_CD" ).append("\n"); 
		query.append("                ,SO.CGO_TP_CD" ).append("\n"); 
		query.append("                ,TRS_COMMON_PKG.GET_CONV_WGT_TO_KGS_FNC('LBS', SO.CNTR_WGT) AS WEIGHT_KGS" ).append("\n"); 
		query.append("                ,SO.CNTR_WGT WEIGHT_LBS" ).append("\n"); 
		query.append("                ,SO.WGT_MEAS_UT_CD" ).append("\n"); 
		query.append("                ,SO.EQ_NO EQ_NO" ).append("\n"); 
		query.append("                ,SO.EQ_KND_CD" ).append("\n"); 
		query.append("                ,SO.EQ_TPSZ_CD EQ_TPSZ" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                ,SO.TRSP_COST_DTL_MOD_CD TRSP_COST_DTL_MOD_CD" ).append("\n"); 
		query.append("                ,SO.TRSP_SO_OFC_CTY_CD || SO.TRSP_SO_SEQ SO_NO" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LOCL_CRE_DT, 'YYYY-MM-DD HH24:MI:SS') SO_CRE_DT1" ).append("\n"); 
		query.append("                ,SO.DELT_FLG SO_DEL_FLG" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LOCL_UPD_DT, 'YYYY-MM-DD HH24:MI:SS') SO_UPD_DT" ).append("\n"); 
		query.append("                ,DECODE (WO.BIL_ISS_STS_CD,'X', 'N',WO.BIL_ISS_STS_CD) WO_ISS_STS_CD" ).append("\n"); 
		query.append("                ,TO_CHAR (WO.BIL_EDI_SNT_DT, 'YYYY-MM-DD HH24:MI:SS') WO_ISS_DT" ).append("\n"); 
		query.append("                ,DECODE (WO.BIL_ISS_STS_CD,'I', 'EDI','') WO_ISS_TP" ).append("\n"); 
		query.append("                ,WO.CRE_OFC_CD WO_ISS_OFC_CD" ).append("\n"); 
		query.append("                ,WO.CRE_USR_ID WO_ISS_ID" ).append("\n"); 
		query.append("                ,VNDR.FM_NOD_CD FM_NOD_CD" ).append("\n"); 
		query.append("                ,VNDR.TO_NOD_CD TO_NOD_CD" ).append("\n"); 
		query.append("                ,SO.N3PTY_BIL_FLG N3PTY_BIL_FLG" ).append("\n"); 
		query.append("                ,VNDR.CURR_CD WO_CURR_CD" ).append("\n"); 
		query.append("                ,VNDR.BZC_AMT WO_BZC_AMT " ).append("\n"); 
		query.append("                ,VNDR.NEGO_AMT WO_NEGO_AMT" ).append("\n"); 
		query.append("                ,VNDR.FUEL_SCG_AMT WO_FUEL_SCG_AMT" ).append("\n"); 
		query.append("                ,NVL(VNDR.ETC_ADD_AMT, 0) WO_ETC_ADD_AMT" ).append("\n"); 
		query.append("                ,NVL(VNDR.HZD_MTRL_SCG_AMT,0) WO_HZD_MTRL_SCG_AMT" ).append("\n"); 
		query.append("                ,NVL(VNDR.OVR_WGT_SCG_AMT,0) WO_OVR_WGT_SCG_AMT" ).append("\n"); 
		query.append("                ,NVL(VNDR.BZC_AMT,0) + NVL(VNDR.FUEL_SCG_AMT,0) + NVL(VNDR.OVR_WGT_SCG_AMT,0) + NVL(VNDR.HZD_MTRL_SCG_AMT,0) + NVL(VNDR.ETC_ADD_AMT,0) WO_TOT_AMT" ).append("\n"); 
		query.append("                ,SO.CRE_OFC_CD COST_OFC_CD" ).append("\n"); 
		query.append("                ,VNDR.INV_CURR_CD INV_CURR_CD" ).append("\n"); 
		query.append("                ,NVL(VNDR.INV_BZC_AMT,0) - NVL(VNDR.INV_ETC_ADD_AMT,0) INV_BZC_AMT" ).append("\n"); 
		query.append("                ,CASE WHEN VNDR.INV_CURR_CD = 'JPY' OR VNDR.INV_CURR_CD = 'KRW' OR VNDR.INV_CURR_CD = 'TWD'" ).append("\n"); 
		query.append("                      THEN TO_CHAR(NVL(VNDR.INV_ETC_ADD_AMT, 0), 'FM999999999990')" ).append("\n"); 
		query.append("                      ELSE TO_CHAR(NVL(VNDR.INV_ETC_ADD_AMT, 0), 'FM999999999990.90')" ).append("\n"); 
		query.append("                 END AS INV_ETC_ADD_AMT" ).append("\n"); 
		query.append("                ,VNDR.INV_BZC_AMT INV_TOT_AMT" ).append("\n"); 
		query.append("                ,VNDR.INV_NO INV_NO" ).append("\n"); 
		query.append("                ,WRK.TRSP_INV_AUD_STS_CD INV_STS_CD" ).append("\n"); 
		query.append("                ,WRK.RGST_NO REGISTRATION_NO" ).append("\n"); 
		query.append("                ,TO_CHAR (WRK.INV_CFM_DT, 'YYYYMMDD') INV_CFM_DT" ).append("\n"); 
		query.append("                ,WRK.CSR_NO CAR_NO" ).append("\n"); 
		query.append("                ,CASE WHEN WRK.TRSP_INV_AUD_STS_CD IN ('CF', 'AR', 'IF', 'PD') THEN WRK.CRE_OFC_CD ELSE '' END INV_CFM_OFC_CD" ).append("\n"); 
		query.append("                ,WRK.CRE_USR_ID INV_CRE_USR_ID" ).append("\n"); 
		query.append("                ,SO.BKG_NO BKG_NO" ).append("\n"); 
		query.append("                ,SO.BL_NO BL_NO" ).append("\n"); 
		query.append("                ,SO.TRSP_BND_CD TRSP_BND_CD" ).append("\n"); 
		query.append("                ,SO.BKG_RCVDE_TERM_CD TERM" ).append("\n"); 
		query.append("                ,SO.POR_CD" ).append("\n"); 
		query.append("                ,SO.POL_CD" ).append("\n"); 
		query.append("                ,SO.POD_CD" ).append("\n"); 
		query.append("                ,SO.DEL_CD" ).append("\n"); 
		query.append("                ,SO.VSL_CD || SO.SKD_VOY_NO || SO.SKD_DIR_CD T_VVD" ).append("\n"); 
		query.append("                ,SO.SLAN_CD SLAN_CD" ).append("\n"); 
		query.append("                ,SO.IBD_CSTMS_CLR_LOC_CD C_LOC" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.AVAL_DT, 'YYYYMMDD') AVAILABLE_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LST_FREE_DT, 'YYYYMMDD') LAST_FREE_DT" ).append("\n"); 
		query.append("                ,SO.INTER_RMK INTER_RMK" ).append("\n"); 
		query.append("                ,WO.INTER_RMK WO_INSTR_RMK" ).append("\n"); 
		query.append("                ,SO.COP_NO" ).append("\n"); 
		query.append("                ,SO.COST_ACT_GRP_SEQ AG_SEQ" ).append("\n"); 
		query.append("                ,SO.COST_ACT_GRP_CD AG_CODE" ).append("\n"); 
		query.append("                ,NVL(SO.UPD_USR_ID, SO.CRE_USR_ID) UPD_USR_ID" ).append("\n"); 
		query.append("                ,SO.ORG_GATE_OUT_DT" ).append("\n"); 
		query.append("                ,SO.DEST_GATE_IN_DT" ).append("\n"); 
		query.append("                ,SO.REF_ID MTY_REF_ID" ).append("\n"); 
		query.append("                ,ROUND ((NVL(VNDR.BZC_AMT,0) + NVL(VNDR.FUEL_SCG_AMT,0) + NVL(VNDR.OVR_WGT_SCG_AMT,0) + NVL(VNDR.HZD_MTRL_SCG_AMT,0) + NVL(VNDR.ETC_ADD_AMT,0)) / " ).append("\n"); 
		query.append("                         (SELECT USD_LOCL_XCH_RT" ).append("\n"); 
		query.append("                            FROM GL_MON_XCH_RT XCH" ).append("\n"); 
		query.append("                           WHERE XCH.ACCT_XCH_RT_YRMON = TO_CHAR (VNDR.LOCL_CRE_DT, 'RRRRMM')" ).append("\n"); 
		query.append("                             AND XCH.ACCT_XCH_RT_LVL   = 1" ).append("\n"); 
		query.append("                             AND XCH.CURR_CD(+)        = VNDR.CURR_CD ) , 2) WO_TOT_AMT_USD" ).append("\n"); 
		query.append("                             " ).append("\n"); 
		query.append("                ,ROUND (NVL (VNDR.INV_BZC_AMT, 0)  / " ).append("\n"); 
		query.append("                        (SELECT USD_LOCL_XCH_RT" ).append("\n"); 
		query.append("                            FROM GL_MON_XCH_RT XCH" ).append("\n"); 
		query.append("                           WHERE XCH.ACCT_XCH_RT_YRMON = TO_CHAR (VNDR.LOCL_CRE_DT, 'RRRRMM')" ).append("\n"); 
		query.append("                             AND XCH.ACCT_XCH_RT_LVL   = 1" ).append("\n"); 
		query.append("                             AND XCH.CURR_CD(+)        = VNDR.INV_CURR_CD ) , 2) INV_TOT_AMT_USD " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                ,NVL (SO.TRSP_FRST_FLG, 'N') TRSP_FRST_FLG" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.N1ST_NOD_PLN_DT, 'YYYY-MM-DD HH24:MI:SS') N1ST_NOD_PLN_DT" ).append("\n"); 
		query.append("                ,TO_CHAR (SO.LST_NOD_PLN_DT, 'YYYY-MM-DD HH24:MI:SS') LST_NOD_PLN_DT" ).append("\n"); 
		query.append("                ,VNDR.INV_VNDR_SEQ" ).append("\n"); 
		query.append("                ,(SELECT VDR.VNDR_LGL_ENG_NM FROM MDM_VENDOR VDR WHERE VDR.VNDR_SEQ = VNDR.INV_VNDR_SEQ ) AS INV_VNDR_NM" ).append("\n"); 
		query.append("                ,(SELECT HDR.IF_DT FROM AP_INV_HDR HDR WHERE HDR.CSR_NO = WRK.CSR_NO) AS IF_DT" ).append("\n"); 
		query.append("                ,(SELECT BKG.SC_NO ||'$'|| BKG.RFA_NO FROM BKG_BOOKING BKG WHERE BKG.BKG_NO = SO.BKG_NO ) BKG_SC_NO_INFO  " ).append("\n"); 
		query.append("                ,(SELECT BKG_CNTR.PCK_QTY ||'$'|| BKG_CNTR.PCK_TP_CD || '$' || NVL(BKG_CNTR.VGM_WGT_UT_CD, 'KGS') || '$' || NVL(BKG_CNTR.VGM_WGT, 0)" ).append("\n"); 
		query.append("                    FROM BKG_CONTAINER BKG_CNTR " ).append("\n"); 
		query.append("                   WHERE BKG_CNTR.BKG_NO  = SO.BKG_NO" ).append("\n"); 
		query.append("                     AND BKG_CNTR.CNTR_NO = SO.EQ_NO" ).append("\n"); 
		query.append("                 ) BKG_CNTR_INFO" ).append("\n"); 
		query.append("                , SO.SPCL_CGO_CNTR_TP_CD" ).append("\n"); 
		query.append("                ,(SELECT NVL(MST_CNTR.OWNR_CO_CD, ' ') ||'$'|| NVL(MST_CNTR.LSTM_CD, ' ') ||'$'|| NVL(MST_CNTR.IMDT_EXT_FLG, ' ') FROM MST_CONTAINER MST_CNTR WHERE MST_CNTR.CNTR_NO = SO.EQ_NO ) MST_CNTR_INFO" ).append("\n"); 
		query.append("                ,(SELECT CMDT_NM FROM MDM_COMMODITY CMT WHERE CMT.CMDT_CD = SO.CMDT_CD ) AS CMDT_NM" ).append("\n"); 
		query.append("                ,TRS_GET_FOC_INFO_FNC(SO.BL_NO, SO.TRSP_SO_OFC_CTY_CD, SO.TRSP_SO_SEQ, '$') EDI_FOC_INFO" ).append("\n"); 
		query.append("                ,(SELECT IVDR.VNDR_SEQ ||'$'|| NVL(IVDR.VNDR_LGL_ENG_NM, ' ') ||'$'|| NVL((SELECT PVNDR.VNDR_SEQ ||'$'|| NVL(PVNDR.VNDR_LGL_ENG_NM, ' ') FROM MDM_VENDOR PVNDR WHERE PVNDR.VNDR_SEQ = IVDR.PRNT_VNDR_SEQ ), '$')" ).append("\n"); 
		query.append("                   FROM MDM_VENDOR IVDR" ).append("\n"); 
		query.append("                   WHERE IVDR.VNDR_SEQ = VNDR.VNDR_SEQ ) AS INV_VNDR_INFO" ).append("\n"); 
		query.append("                ,(SELECT CST.IBD_TRSP_NO FROM BKG_CSTMS_ADV_IBD CST WHERE CST.CNT_CD = 'US' AND CST.BL_NO = SO.BKG_NO) AS IT_NO" ).append("\n"); 
		query.append("				, SO.UPLN_SO_FLG" ).append("\n"); 
		query.append("            FROM TRS_TRSP_RAIL_BIL_ORD SO" ).append("\n"); 
		query.append("                ,TRS_TRSP_RAIL_BIL_VNDR_SET VNDR" ).append("\n"); 
		query.append("                ,TRS_TRSP_EDI_RAIL_ORD WO" ).append("\n"); 
		query.append("                ,TRS_TRSP_RAIL_INV_WRK WRK" ).append("\n"); 
		query.append("           WHERE SO.TRSP_SO_OFC_CTY_CD  = VNDR.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("             AND SO.TRSP_SO_SEQ         = VNDR.TRSP_SO_SEQ  " ).append("\n"); 
		query.append("             AND SO.TRSP_SO_OFC_CTY_CD  = WO.TRSP_SO_OFC_CTY_CD(+)" ).append("\n"); 
		query.append("             AND SO.TRSP_SO_SEQ = WO.TRSP_SO_SEQ(+)" ).append("\n"); 
		query.append("             AND SO.BIL_ISS_KNT = WO.BIL_ISS_KNT(+)" ).append("\n"); 
		query.append("             AND VNDR.INV_NO    = WRK.INV_NO(+)" ).append("\n"); 
		query.append("             AND VNDR.INV_VNDR_SEQ = WRK.INV_VNDR_SEQ(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_trunk_vvd.size() > 0) " ).append("\n"); 
		query.append("       AND ((SO.VSL_CD, SO.SKD_VOY_NO, SO.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_trunk_vvd}) " ).append("\n"); 
		query.append("         #if($velocityCount == 1) " ).append("\n"); 
		query.append("            ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("          , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("         )" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_bkgnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.BKG_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_bkgnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_bkgnumber.size()) " ).append("\n"); 
		query.append("            UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_blnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.BL_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_blnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_blnumber.size()) " ).append("\n"); 
		query.append("            UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_copnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.COP_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_copnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_copnumber.size()) " ).append("\n"); 
		query.append("           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_eqnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.EQ_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_eqnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_eqnumber.size()) " ).append("\n"); 
		query.append("           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      #if (${r_radio_eq} == 'CNTR') " ).append("\n"); 
		query.append("        AND SO.EQ_KND_CD = 'U'" ).append("\n"); 
		query.append("      #elseif (${r_radio_eq} == 'CHS') " ).append("\n"); 
		query.append("        AND SO.EQ_KND_CD = 'Z'" ).append("\n"); 
		query.append("      #elseif (${r_radio_eq} == 'GEN') " ).append("\n"); 
		query.append("        AND SO.EQ_KND_CD = 'G'" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_mtyrefnumber.size() > 0) " ).append("\n"); 
		query.append("       AND SO.REF_ID IN (" ).append("\n"); 
		query.append("       #foreach( ${key} in ${r_mtyrefnumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_mtyrefnumber.size()) " ).append("\n"); 
		query.append("           UPPER('${key}'), " ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("           UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_period} == 'S') " ).append("\n"); 
		query.append("      #if (${r_from_date} != ''|| ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND SO.LOCL_CRE_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmdd') AND TO_DATE (@[r_to_date], 'rrrrmmdd') + 0.999999" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'W')" ).append("\n"); 
		query.append("      #if (${r_from_date} != ''|| ${r_to_date} != '') " ).append("\n"); 
		query.append("        #if (${month_flg}) " ).append("\n"); 
		query.append("          AND WO.LOCL_CRE_DT BETWEEN TO_DATE ( @[r_from_date] ,'RRRRMM') AND LAST_DAY( TO_DATE( @[r_to_date] , 'RRRRMM'))+1" ).append("\n"); 
		query.append("        #else " ).append("\n"); 
		query.append("          AND WO.LOCL_CRE_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("     #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'I')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND WRK.INV_CFM_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_period} == 'O')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND SO.N1ST_NOD_PLN_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #elseif (${r_period} == 'L')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND SO.LST_NOD_PLN_DT BETWEEN TO_DATE (@[r_from_date], 'rrrrmmddhh24') AND TO_DATE (@[r_to_date], 'rrrrmmddhh24') + 0.999999" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #elseif (${r_period} == 'D')" ).append("\n"); 
		query.append("      #if (${r_from_date} != '' && ${r_to_date} != '') " ).append("\n"); 
		query.append("        AND 1=2" ).append("\n"); 
		query.append("      #end " ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_input_office.size() > 0) " ).append("\n"); 
		query.append("      #if (${r_radio_office} == 'S')" ).append("\n"); 
		query.append("        AND SO.CRE_OFC_CD IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_input_office}) " ).append("\n"); 
		query.append("          #if($velocityCount < $r_input_office.size()) " ).append("\n"); 
		query.append("            UPPER('${key}')," ).append("\n"); 
		query.append("          #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("      #elseif (${r_radio_office} == 'V')" ).append("\n"); 
		query.append("        AND WRK.CRE_OFC_CD IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_input_office}) " ).append("\n"); 
		query.append("          #if($velocityCount < $r_input_office.size()) " ).append("\n"); 
		query.append("            UPPER('${key}')," ).append("\n"); 
		query.append("          #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("      #elseif (${r_radio_office} == 'W')" ).append("\n"); 
		query.append("        AND WO.CRE_OFC_CD IN (" ).append("\n"); 
		query.append("        #foreach( ${key} in ${r_input_office}) " ).append("\n"); 
		query.append("          #if($velocityCount < $r_input_office.size()) " ).append("\n"); 
		query.append("            UPPER('${key}')," ).append("\n"); 
		query.append("          #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        )" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_somode} == 'LV') " ).append("\n"); 
		query.append("       AND SO.DELT_FLG = 'N'" ).append("\n"); 
		query.append("    #elseif (${r_somode}=='DL')" ).append("\n"); 
		query.append("       AND SO.DELT_FLG = 'Y'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_womode} != '' && ${r_womode} != 'ALL')" ).append("\n"); 
		query.append("      #if (${r_womode} == 'IS')" ).append("\n"); 
		query.append("        AND WO.BIL_ISS_STS_CD = 'I'" ).append("\n"); 
		query.append("      #else " ).append("\n"); 
		query.append("        AND NVL(WO.BIL_ISS_STS_CD, 'X') = 'X'" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_invoicemode} != '' && ${r_invoicemode} != 'ALL')" ).append("\n"); 
		query.append("      #if (${r_invoicemode} == 'NL') " ).append("\n"); 
		query.append("        AND WRK.TRSP_INV_AUD_STS_CD(+) IS NULL" ).append("\n"); 
		query.append("      #else" ).append("\n"); 
		query.append("        AND WRK.TRSP_INV_AUD_STS_CD = @[r_invoicemode]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_boundmode} != '' && ${r_boundmode} != 'ALL')" ).append("\n"); 
		query.append("      AND SO.TRSP_BND_CD = @[r_boundmode]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_radio_user} == 'S') " ).append("\n"); 
		query.append("      #if (${r_user_id} != '') " ).append("\n"); 
		query.append("        AND SO.CRE_USR_ID = @[r_user_id]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #elseif (${r_radio_user} == 'V') " ).append("\n"); 
		query.append("      #if (${r_user_id} != '') " ).append("\n"); 
		query.append("        AND WRK.CRE_USR_ID = @[r_user_id]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_costmode} != '' && ${r_costmode} != 'ALL')" ).append("\n"); 
		query.append("      #if (${r_costmode} == 'CY') " ).append("\n"); 
		query.append("        AND SO.CGO_TP_CD = 'F'" ).append("\n"); 
		query.append("      #elseif (${r_costmode} == 'ER') " ).append("\n"); 
		query.append("        AND SO.CGO_TP_CD = 'M'" ).append("\n"); 
		query.append("      #else " ).append("\n"); 
		query.append("        AND SO.TRSP_SO_SEQ = 0" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_transmode} != '' && ${r_transmode} != 'ALL')" ).append("\n"); 
		query.append("      AND 'RD' = @[r_transmode]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_sotype} != '' && ${r_sotype} != 'ALL' && ${r_sotype} != 'R')" ).append("\n"); 
		query.append("      AND SO.TRSP_SO_SEQ = 0" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_provider} != '' && ${r_provider} != 'ALL') " ).append("\n"); 
		query.append("      #if (${r_provider_type} == 'WO') " ).append("\n"); 
		query.append("        AND VNDR.VNDR_SEQ = @[r_provider]" ).append("\n"); 
		query.append("      #elseif (${r_provider_type} == 'IV') " ).append("\n"); 
		query.append("        AND VNDR.INV_VNDR_SEQ = @[r_provider]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_from_node} != '') " ).append("\n"); 
		query.append("      AND VNDR.FM_NOD_CD LIKE @[r_from_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("	-- Multi From Node로 조회" ).append("\n"); 
		query.append("	#if ($arr_fmnode.size() > 0) " ).append("\n"); 
		query.append("			  AND VNDR.FM_NOD_CD in (" ).append("\n"); 
		query.append("	    #foreach( ${key} in ${arr_fmnode}) " ).append("\n"); 
		query.append("		    #if($velocityCount < $arr_fmnode.size()) " ).append("\n"); 
		query.append("		        '$key', " ).append("\n"); 
		query.append("		    #else " ).append("\n"); 
		query.append("	            '$key' " ).append("\n"); 
		query.append("		    #end " ).append("\n"); 
		query.append("	    #end" ).append("\n"); 
		query.append("	    )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("    #if (${r_via_node} != '') " ).append("\n"); 
		query.append("      AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if (${r_to_node} != '') " ).append("\n"); 
		query.append("      AND VNDR.TO_NOD_CD LIKE @[r_to_node]||'%'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("	-- Multi To Node로 조회" ).append("\n"); 
		query.append("	#if ($arr_tonode.size() > 0) " ).append("\n"); 
		query.append("			  AND VNDR.TO_NOD_CD in (" ).append("\n"); 
		query.append("	    #foreach( ${key} in ${arr_tonode}) " ).append("\n"); 
		query.append("		    #if($velocityCount < $arr_tonode.size()) " ).append("\n"); 
		query.append("		        '$key', " ).append("\n"); 
		query.append("		    #else " ).append("\n"); 
		query.append("	            '$key' " ).append("\n"); 
		query.append("		    #end " ).append("\n"); 
		query.append("	    #end" ).append("\n"); 
		query.append("	    )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("    #if (${r_door_node} != '') " ).append("\n"); 
		query.append("      AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_sonumber.size() > 0) " ).append("\n"); 
		query.append("      AND ((SO.TRSP_SO_OFC_CTY_CD, SO.TRSP_SO_SEQ) IN (" ).append("\n"); 
		query.append("        #foreach( ${key} IN ${r_sonumber}) " ).append("\n"); 
		query.append("          #if($velocityCount == 1) " ).append("\n"); 
		query.append("             ( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #else" ).append("\n"); 
		query.append("            ,( SUBSTR('${key}',1,3),SUBSTR('${key}',4) )" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        ) " ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_wonumber.size() > 0) " ).append("\n"); 
		query.append("      AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_invoicenumber.size() > 0) " ).append("\n"); 
		query.append("       AND VNDR.INV_NO IN (" ).append("\n"); 
		query.append("       #foreach( ${key} IN ${r_invoicenumber}) " ).append("\n"); 
		query.append("         #if($velocityCount < $r_invoicenumber.size()) " ).append("\n"); 
		query.append("            UPPER('${key}')," ).append("\n"); 
		query.append("         #else " ).append("\n"); 
		query.append("            UPPER('${key}')" ).append("\n"); 
		query.append("         #end " ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_zip_code.size() > 0) " ).append("\n"); 
		query.append("       AND 0 = 1" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if (${r_amount} == 'T')" ).append("\n"); 
		query.append("       AND VNDR.INV_NO IS NOT NULL" ).append("\n"); 
		query.append("       AND NVL(VNDR.INV_ETC_ADD_AMT,0) = 0" ).append("\n"); 
		query.append("    #elseif (${r_amount} == 'F')" ).append("\n"); 
		query.append("       AND VNDR.INV_NO IS NOT NULL" ).append("\n"); 
		query.append("       AND NVL(VNDR.INV_ETC_ADD_AMT,0) <> 0" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("	 AND DECODE(NVL(@[r_unplanned], 'ALL'), 'ALL', 'X', NVL(SO.UPLN_SO_FLG, 'N')) = DECODE(NVL(@[r_unplanned], 'ALL'), 'ALL', 'X', @[r_unplanned])" ).append("\n"); 
		query.append("    #if (${grid_flg} == 'Y')" ).append("\n"); 
		query.append("--       AND ROWNUM < 2001" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append(") X" ).append("\n"); 
		query.append("WHERE 1=1" ).append("\n"); 
		query.append("    #if (${r_provider} != '' && ${r_provider} != 'ALL') " ).append("\n"); 
		query.append("      #if (${r_provider_type} == 'PA') -- Parent S/P" ).append("\n"); 
		query.append("        AND SUBSTR(X.INV_VNDR_INFO, INSTR(X.INV_VNDR_INFO, '$', 1, 2) + 1, INSTR(X.INV_VNDR_INFO, '$', 1, 3) - INSTR(X.INV_VNDR_INFO, '$', 1, 2) - 1) = @[r_provider]" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    #if($r_sc_rfa_cd.size() > 0) " ).append("\n"); 
		query.append("       #if (${r_radio_number} == 'S' )" ).append("\n"); 
		query.append("         AND SUBSTR(X.BKG_SC_NO_INFO, 1, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) -1) IN (" ).append("\n"); 
		query.append("         #foreach( ${key} in ${r_sc_rfa_cd}) " ).append("\n"); 
		query.append("           #if($velocityCount < $r_sc_rfa_cd.size()) " ).append("\n"); 
		query.append("              UPPER('${key}'), " ).append("\n"); 
		query.append("           #else " ).append("\n"); 
		query.append("              UPPER('${key}')" ).append("\n"); 
		query.append("           #end " ).append("\n"); 
		query.append("         #end" ).append("\n"); 
		query.append("       )" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("         AND SUBSTR(X.BKG_SC_NO_INFO, INSTR(X.BKG_SC_NO_INFO, '$', 1, 1) + 1) IN (" ).append("\n"); 
		query.append("         #foreach( ${key} in ${r_sc_rfa_cd}) " ).append("\n"); 
		query.append("           #if($velocityCount < $r_sc_rfa_cd.size()) " ).append("\n"); 
		query.append("              UPPER('${key}'), " ).append("\n"); 
		query.append("           #else " ).append("\n"); 
		query.append("              UPPER('${key}')" ).append("\n"); 
		query.append("           #end " ).append("\n"); 
		query.append("         #end" ).append("\n"); 
		query.append("         )" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 

	}
}