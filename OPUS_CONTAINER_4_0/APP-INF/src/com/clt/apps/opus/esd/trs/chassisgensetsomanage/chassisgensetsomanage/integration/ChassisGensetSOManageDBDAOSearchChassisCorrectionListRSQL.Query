<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChassisGensetSOManageDBDAOSearchChassisCorrectionListRSQL">
			<desc><![CDATA[f_cmd : SEARCH08
Chassis correction list retrieve]]></desc>
			<sql><![CDATA[
SELECT   a.trsp_so_cmb_seq
        ,a.trsp_so_cmb_seq trsp_so_cmb_seq2
        ,a.trsp_so_cmb_tp_cd
		,DECODE(a.trsp_so_cmb_tp_cd,'BS','Stack','BF','Flatbed','') trsp_so_cmb_tp_nm
        ,a.eq_no
        ,a.eq_tpsz_cd
        ,a.fm_nod_cd
        ,SUBSTR (a.fm_nod_cd ,1 ,5) fm_loc_value
        ,SUBSTR (a.fm_nod_cd ,6 ,2) fm_yard_value
        ,a.to_nod_cd
        ,SUBSTR (a.to_nod_cd ,1 ,5) to_loc_value
        ,SUBSTR (a.to_nod_cd ,6 ,2) to_yard_value
        ,a.trsp_crr_mod_cd
        ,b.vndr_seq
        ,d.vndr_abbr_nm
        ,b.agmt_lstm_cd lstm_cd
        ,b.chss_ownr_co_cd ownr_co_cd
        ,b.lst_use_co_cd usr_co_cd
        ,b.chss_mvmt_sts_cd  mvmt_sts_cd
        ,c.mvmt_sts_nm
        ,e.sts_evnt_yd_cd lst_sts_yd_cd
        ,TO_CHAR (b.chss_mvmt_dt, 'YYYYMMDD') mvmt_dt
        ,a.inter_rmk
        ,a.cntr_no
        ,a.cntr_tpsz_cd
        ,a.ref_bkg_no
        ,'' ref_bkg_no_split
        ,a.ref_bl_no
        ,TO_CHAR (a.org_gate_out_dt, 'YYYY-MM-DD') org_gate_out_date
        ,TO_CHAR (a.org_gate_out_dt, 'HH24:MI:SS') org_gate_out_time
        ,TO_CHAR (a.dest_gate_in_dt, 'YYYY-MM-DD') dest_gate_in_date
        ,TO_CHAR (a.dest_gate_in_dt, 'HH24:MI:SS') dest_gate_in_time
        ,a.spcl_instr_rmk
        ,a.trsp_so_ofc_cty_cd
        ,a.trsp_so_seq
        ,a.trsp_so_tp_cd
        ,a.trsp_so_sts_cd
        ,a.eq_knd_cd
        ,(select cd.intg_cd_val_dp_desc from com_intg_cd_dtl cd where cd.intg_cd_id = 'CD00595' and a.chss_mgst_trsp_tp_cd = cd.intg_cd_val_ctnt) as chss_mgst_trsp_tp_cd
        ,a.cre_ofc_cd
        ,TO_CHAR (a.locl_cre_dt, 'YYYYMMDD') cre_dt
        ,a.cre_usr_id
        ,TO_CHAR (a.locl_upd_dt, 'YYYYMMDD') upd_dt
        ,a.upd_usr_id
        , (CASE
              WHEN a.eq_no IS NULL
                 THEN 'T'
           END) AS isimport
        ,DECODE (a.trsp_wo_seq ,NULL, 'N' ,'Y' ) wo_issue
    FROM trs_trsp_svc_ord a
        ,cgm_equipment b
        ,mdm_mvmt_sts c
        ,mdm_vendor d
        ,cgm_eq_sts_his e
   WHERE a.eq_tpsz_cd = b.eq_tpsz_cd
     AND a.eq_no(+) = b.eq_no  
   	 AND b.eq_no = e.eq_no
   	 AND b.eq_sts_seq = e.eq_sts_seq
     AND b.eq_knd_cd ='Z'
	 AND e.eq_knd_cd ='Z'
     AND b.chss_mvmt_sts_cd = c.mvmt_sts_cd(+)
     AND b.vndr_seq = d.vndr_seq(+)
     AND a.trsp_so_sts_cd IN ('C', 'R')
     AND a.eq_knd_cd = @[kind_chassis]
#if (${fmdate} != '' && ${todate} != '') 
     AND a.locl_cre_dt BETWEEN TO_DATE(@[fmdate]||'000001','YYYYMMDDHH24MISS') AND TO_DATE(@[todate]||'235959','YYYYMMDDHH24MISS')
#end    
#if (${trs_tp_cd} != 'ALL') 
	 AND a.chss_mgst_trsp_tp_cd =@[trs_tp_cd]
#end
#if (${trs_md_cd} != 'ALL') 
    AND a.trsp_crr_mod_cd = @[trs_md_cd]
#end
#if (${trsp_so_fm_node} != '') 
     AND a.fm_nod_cd = @[trsp_so_fm_node]
#end
#if (${trsp_so_to_node} != '') 
	 AND a.to_nod_cd = @[trsp_so_to_node]
#end
#if($eq_no.size() > 0) 
    AND a.eq_no IN (
	#foreach( ${key} in ${eq_no}) 
		#if($velocityCount < $eq_no.size()) 
			'$key', 
		#else 
			'$key' 
		#end 
	#end
		)
#end
     AND a.delt_flg <> 'Y'                                                                                                                                                                                                         

UNION

SELECT   a.trsp_so_cmb_seq
        ,a.trsp_so_cmb_seq trsp_so_cmb_seq2
        ,a.trsp_so_cmb_tp_cd
		,DECODE(a.trsp_so_cmb_tp_cd,'BS','Stack','BF','Flatbed','') trsp_so_cmb_tp_nm
        ,a.eq_no
        ,a.eq_tpsz_cd
        ,a.fm_nod_cd
        ,SUBSTR (a.fm_nod_cd ,1 ,5) fm_loc_value
        ,SUBSTR (a.fm_nod_cd ,6 ,2) fm_yard_value
        ,a.to_nod_cd
        ,SUBSTR (a.to_nod_cd ,1 ,5) to_loc_value
        ,SUBSTR (a.to_nod_cd ,6 ,2) to_yard_value
        ,a.trsp_crr_mod_cd
        ,TO_NUMBER('', '#') vndr_seq
        ,'' vndr_abbr_nm
        ,'' lstm_cd
        ,'' ownr_co_cd
        ,'' usr_co_cd
        ,'' mvmt_sts_cd
        ,'' mvmt_sts_nm
        ,'' lst_sts_yd_cd
        ,'' mvmt_dt
        ,a.inter_rmk
        ,a.cntr_no
        ,a.cntr_tpsz_cd
        ,a.ref_bkg_no
        ,'' ref_bkg_no_split
        ,a.ref_bl_no
        ,TO_CHAR (a.org_gate_out_dt, 'YYYY-MM-DD') org_gate_out_date
        ,TO_CHAR (a.org_gate_out_dt, 'HH24:MI:SS') org_gate_out_time
        ,TO_CHAR (a.dest_gate_in_dt, 'YYYY-MM-DD') dest_gate_in_date
        ,TO_CHAR (a.dest_gate_in_dt, 'HH24:MI:SS') dest_gate_in_time
        ,a.spcl_instr_rmk
        ,a.trsp_so_ofc_cty_cd
        ,a.trsp_so_seq
        ,a.trsp_so_tp_cd
        ,a.trsp_so_sts_cd
        ,a.eq_knd_cd
        ,(select cd.intg_cd_val_dp_desc from com_intg_cd_dtl cd where cd.intg_cd_id = 'CD00595' and a.chss_mgst_trsp_tp_cd = cd.intg_cd_val_ctnt) as chss_mgst_trsp_tp_cd
        ,a.cre_ofc_cd
        ,TO_CHAR (a.locl_cre_dt, 'YYYYMMDD') cre_dt
        ,a.cre_usr_id
        ,TO_CHAR (a.locl_upd_dt, 'YYYYMMDD') upd_dt
        ,a.upd_usr_id
        , (CASE
              WHEN a.eq_no IS NULL
                 THEN 'T'
           END) AS isimport
        ,DECODE (a.trsp_wo_seq ,NULL, 'N' ,'Y' ) wo_issue
    FROM trs_trsp_svc_ord a
   WHERE 1=1
     AND a.eq_no is null
     AND a.trsp_so_sts_cd IN ('C', 'R')
     AND a.eq_knd_cd = @[kind_chassis]
#if (${fmdate} != '' && ${todate} != '') 
     AND a.locl_cre_dt BETWEEN TO_DATE(@[fmdate]||'000001','YYYYMMDDHH24MISS') AND TO_DATE(@[todate]||'235959','YYYYMMDDHH24MISS')
#end    
#if (${trs_tp_cd} != 'ALL') 
	 AND a.chss_mgst_trsp_tp_cd =@[trs_tp_cd]
#end
#if (${trs_md_cd} != 'ALL') 
    AND a.trsp_crr_mod_cd = @[trs_md_cd]
#end
#if (${trsp_so_fm_node} != '') 
     AND a.fm_nod_cd = @[trsp_so_fm_node]
#end
#if (${trsp_so_to_node} != '') 
	 AND a.to_nod_cd = @[trsp_so_to_node]
#end
#if($eq_no.size() > 0) 
    AND a.eq_no IN (
	#foreach( ${key} in ${eq_no}) 
		#if($velocityCount < $eq_no.size()) 
			'$key', 
		#else 
			'$key' 
		#end 
	#end
		)
#end
     AND a.delt_flg <> 'Y'			]]></sql>
			<params>
				<param name="kind_chassis" type="12" value=" " out="N"/>
				<param name="fmdate" type="12" value="" out="N"/>
				<param name="todate" type="12" value="" out="N"/>
				<param name="trs_tp_cd" type="12" value="" out="N"/>
				<param name="trs_md_cd" type="12" value="" out="N"/>
				<param name="trsp_so_fm_node" type="12" value="" out="N"/>
				<param name="trsp_so_to_node" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
