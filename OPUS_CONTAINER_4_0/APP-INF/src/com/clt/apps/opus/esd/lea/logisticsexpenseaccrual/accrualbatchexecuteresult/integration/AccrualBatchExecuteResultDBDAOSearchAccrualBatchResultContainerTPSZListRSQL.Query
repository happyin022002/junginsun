<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccrualBatchExecuteResultDBDAOSearchAccrualBatchResultContainerTPSZListRSQL">
			<desc><![CDATA[Accrual Result by CNTR    ]]></desc>
			<sql><![CDATA[
SELECT A.CNTR_NO
,A.CNTR_TPSZ_CD
--,B.COST_ACT_GRP_NM
,'AAAA'
,A.COST_ACT_GRP_SEQ
,A.N1ST_NOD_CD
,A.N2ND_NOD_CD
,A.ACCT_CD
,A.COA_COST_SRC_CD LGS_COST_CD
,A.ACCL_LGC_TP_CD
,A.COST_ASS_BSE_CD
,A.CTRT_RTN_FLG
,A.ESTM_COST_AMT        ESTM_COST_AMT
,A.ACT_CNTR_COST_AMT    ACT_CNTR_COST_AMT
,A.ACT_BKG_COST_AMT     ACT_BKG_COST_AMT
,A.ACT_REV_VVD_COST_AMT ACT_REV_VVD_COST_AMT
,A.ACT_COM_VVD_COST_AMT ACT_COM_VVD_COST_AMT
,A.ACT_ETC_COST_AMT     ACT_ETC_COST_AMT
,A.ACT_COST_AMT         ACT_COST_AMT
,A.ACCL_COST_AMT        ACCL_COST_AMT
,A.ACT_INV_KNT          ACT_INV_KNT
,A.TTL_INV_KNT          TTL_INV_KNT
,(NVL(A.ACT_COST_AMT,0)+NVL(A.ACCL_COST_AMT,0))  CONFIRMED_COST_AMT
,(NVL(A.ACT_COST_AMT,0)+NVL(A.ACCL_COST_AMT,0)-NVL(A.ESTM_COST_AMT,0)) COST_DIFF_AMT
FROM    LEA_ACCL_DTL A
WHERE	A.REV_YRMON  = REPLACE(@[frm_rev_yrmon],'-')
AND		A.DELT_FLG   = 'N' --Not Delete
AND		A.BKG_STS_CD = 'F' --Firm

		#if ((${frm_acct_cd} != '') && (${frm_acct_cd} != 'ALL'))
		AND    A.ACCT_CD = @[frm_acct_cd]
		#end

		#if ((${frm_vvd_no} != '') && (${frm_vvd_no} != 'ALL'))
		AND    (A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD||A.REV_DIR_CD) = @[frm_vvd_no]
		#end

		#if (${frm_bkg_no} != '') 
		AND    A.BKG_NO = @[frm_bkg_no] 
		#end


ORDER BY A.CNTR_NO
,A.CNTR_TPSZ_CD
,A.COST_ACT_GRP_SEQ
,A.ACCT_CD
,A.COA_COST_SRC_CD
,A.ACCL_LGC_TP_CD
,A.COST_ASS_BSE_CD
,A.CTRT_RTN_FLG			]]></sql>
			<params>
				<param name="frm_rev_yrmon" type="12" value="" out="N"/>
				<param name="frm_acct_cd" type="12" value="" out="N"/>
				<param name="frm_vvd_no" type="12" value="HNCH0063WW" out="N"/>
				<param name="frm_bkg_no" type="12" value="PKGZC180003" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
