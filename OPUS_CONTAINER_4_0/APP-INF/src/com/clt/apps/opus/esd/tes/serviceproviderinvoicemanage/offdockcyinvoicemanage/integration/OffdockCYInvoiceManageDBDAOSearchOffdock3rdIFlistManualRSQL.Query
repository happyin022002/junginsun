<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="OffdockCYInvoiceManageDBDAOSearchOffdock3rdIFlistManualRSQL">
			<desc><![CDATA[SearchOffdock3rdIFlistManual]]></desc>
			<sql><![CDATA[
SELECT @[tmp_dtl_seq] TMP_DTL_SEQ,	A.CALC_TP_CD,
A.TML_SO_OFC_CTY_CD, A.TML_SO_SEQ, A.TML_SO_DTL_SEQ,
A.LGS_COST_CD, A.CNTR_TPSZ_CD, A.IO_BND_CD,
CASE
WHEN T.TML_IF_OFC_CD IS NOT NULL AND T.TML_IF_SEQ IS NOT NULL THEN T.CNTR_NO
ELSE A.CNTR_NO
END CNTR_NO,
CASE
WHEN T.TML_IF_OFC_CD IS NOT NULL AND T.TML_IF_SEQ IS NOT NULL THEN 1
ELSE 0
END CHK,
T.TML_IF_OFC_CD, T.TML_IF_SEQ, T.TML_N3PTY_TP_CD, T.TML_N3PTY_IF_STS_CD,
'TM' CALC_COST_GRP_CD, T.INV_NO, T.VNDR_SEQ, T.YD_CD,
T.LGS_COST_CD, T.ACCT_CD,
T.CSR_NO, T.N3PTY_BIL_TP_CD,
T.BKG_NO, T.BL_NO,
T.FINC_VSL_CD, T.FINC_SKD_VOY_NO,
T.FINC_SKD_DIR_CD, T.IO_BND_CD, T.REF_VNDR_SEQ, T.TML_CRR_CD,
CASE
WHEN T.VNDR_CUST_DIV_CD = 'C' THEN T.CUST_CNT_CD||T.CUST_SEQ
WHEN T.VNDR_CUST_DIV_CD = 'S' THEN T.N3PTY_OFC_CD
WHEN T.VNDR_CUST_DIV_CD = 'V' THEN T.VNDR_CNT_CD||T.N3PTY_VNDR_SEQ
END TRD_PARTY_VAL,
T.VNDR_CUST_DIV_CD, T.VNDR_CNT_CD, T.N3PTY_VNDR_SEQ, T.CUST_CNT_CD,
T.CUST_SEQ, T.N3PTY_OFC_CD, NVL(T.CURR_CD,A.CURR_CD) CURR_CD, T.IF_AMT,
T.IF_RMK, T.N3PTY_INV_DT, T.N3PTY_TERM_DT, T.N3PTY_CSR_CURR_CD,
T.N3PTY_AMT, T.N3PTY_DESC, T.CXL_FLG
FROM (
SELECT D.CALC_TP_CD,
       D.TML_SO_OFC_CTY_CD, D.TML_SO_SEQ, D.TML_SO_DTL_SEQ,
       D.LGS_COST_CD, D.CNTR_TPSZ_CD, D.IO_BND_CD,
       R.CNTR_NO, H.CURR_CD
FROM TES_TML_SO_HDR H, TES_TML_SO_DTL D, TES_TML_SO_RVIS_LIST R
WHERE 1=1
AND H.TML_SO_OFC_CTY_CD = D.TML_SO_OFC_CTY_CD
AND H.TML_SO_SEQ        = D.TML_SO_SEQ
AND D.TML_SO_OFC_CTY_CD = R.TML_SO_OFC_CTY_CD
AND D.TML_SO_SEQ        = R.TML_SO_SEQ
AND D.TML_SO_DTL_SEQ 	= R.TML_SO_DTL_SEQ
AND H.TML_SO_OFC_CTY_CD = @[tml_so_ofc_cty_cd]
AND H.TML_SO_SEQ = @[tml_so_seq]
AND D.TML_SO_DTL_SEQ = @[tml_so_dtl_seq] ) A, TES_N3RD_PTY_IF T
WHERE A.TML_SO_OFC_CTY_CD = T.TML_SO_OFC_CTY_CD(+)
AND A.TML_SO_SEQ        = T.TML_SO_SEQ(+)
AND A.TML_SO_DTL_SEQ 	= T.TML_SO_DTL_SEQ(+)
AND A.CNTR_NO      = T.CNTR_NO(+)			]]></sql>
			<params>
				<param name="tmp_dtl_seq" type="12" value="" out="N"/>
				<param name="tml_so_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="tml_so_seq" type="12" value="" out="N"/>
				<param name="tml_so_dtl_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
