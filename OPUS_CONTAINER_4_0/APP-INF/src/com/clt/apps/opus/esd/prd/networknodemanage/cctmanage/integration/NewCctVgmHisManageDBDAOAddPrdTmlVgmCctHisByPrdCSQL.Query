<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="NewCctVgmHisManageDBDAOAddPrdTmlVgmCctHisByPrdCSQL">
			<desc><![CDATA[NewCctVgmHisManageDBDAOAddPrdTmlVgmCctHisByPrd]]></desc>
			<sql><![CDATA[
#if (${pctl_use_flg} == 'Y')
INSERT INTO PRD_TML_VGM_CCT_HIS (
   HIS_SEQ
  ,PCTL_USE_FLG
  ,YD_CD
  ,VSL_SLAN_CD
  ,VSL_SLAN_DIR_CD
  ,CGO_TP_CD
  ,VGM_FLG
  ,DELT_FLG
  ,CCT_TP_CD
  ,CCT_HR
  ,CCT_DY_CD
  ,CCT_HRMNT
  ,CCT_FILE_FLG
  ,YD_BSE_CALC_FLG
  ,XCLD_HOL_FRI_FLG
  ,XCLD_HOL_SAT_FLG
  ,XCLD_HOL_SUN_FLG
  ,XCLD_HOL_HOL_FLG
  ,CRE_USR_ID
  ,CRE_DT
  ,UPD_USR_ID
  ,UPD_DT
)
  SELECT nvl((select max(HIS_SEQ) from PRD_TML_VGM_CCT_HIS), 0) + 1 HIS_SEQ
        ,@[pctl_use_flg] pctl_use_flg
        ,yd_cd
        ,vsl_slan_cd
        ,vsl_slan_dir_cd
        ,cgo_tp_cd
        ,@[vgm_flg] vgm_flg
        ,@[delt_flg] delt_flg
        ,@[cct_tp_cd] cct_tp_cd
        ,@[cct_hr] cct_hr
        ,@[cct_dy_cd] cct_dy_cd
        ,@[cct_hrmnt] cct_hrmnt
        ,@[cct_file_flg] cct_file_flg
        ,@[yd_bse_calc_flg] yd_bse_calc_flg
        ,@[xcld_hol_fri_flg] xcld_hol_fri_flg
        ,@[xcld_hol_sat_flg] xcld_hol_sat_flg
        ,@[xcld_hol_sun_flg] xcld_hol_sun_flg
        ,@[xcld_hol_hol_flg] xcld_hol_hol_flg
        ,@[cre_usr_id] cre_usr_id
        ,SYSDATE cre_dt
        ,@[upd_usr_id] upd_usr_id
        ,SYSDATE upd_dt
    FROM PRD_TML_CCT_MGMT O
   WHERE O.YD_CD = @[yd_cd]
     AND VSL_SLAN_CD = @[vsl_slan_cd]
     AND VSL_SLAN_DIR_CD = NVL(@[vsl_slan_dir_cd], 'A')
     AND CGO_TP_CD = @[cgo_tp_cd]
#if (${vgm_flg} == 'Y')
	 AND (	O.VGM_CLZ_TP_CD <> @[cct_tp_cd] 
			OR to_number(NVL(O.VGM_CLZ_HR, '0')) <> TO_NUMBER(NVL(@[cct_hr], '0')) 
			OR NVL(O.VGM_CLZ_DY_CD, 'X')    <> NVL(@[cct_dy_cd], 'X') 
			OR NVL(O.VGM_CLZ_HRMNT, 'X')    <> NVL(@[cct_hrmnt], 'X') 
		    OR NVL(O.VGM_CLZ_FILE_FLG, '0')     <> NVL(@[cct_file_flg], '0') 
			OR NVL(O.VGM_YD_BSE_CALC_FLG, '0')  <> NVL(@[yd_bse_calc_flg], '0') 
			OR NVL(O.VGM_XCLD_HOL_FRI_FLG, '0') <> NVL(@[xcld_hol_fri_flg], '0') 
			OR NVL(O.VGM_XCLD_HOL_SAT_FLG, '0') <> NVL(@[xcld_hol_sat_flg], '0') 
			OR NVL(O.VGM_XCLD_HOL_SUN_FLG, '0') <> NVL(@[xcld_hol_sun_flg], '0') 
			OR NVL(O.VGM_XCLD_HOL_HOL_FLG, '0') <> NVL(@[xcld_hol_hol_flg], '0') 
			OR DELT_FLG <> @[delt_flg]
		 )
#else
     AND (	CCT_TP_CD <> @[cct_tp_cd] 
			OR to_number(NVL(CCT_HR, '0')) <>  TO_NUMBER(NVL(@[cct_hr], '0')) 
			OR NVL(CCT_DY_CD, 'X') <> NVL(@[cct_dy_cd], 'X') 
			OR NVL(CCT_HRMNT, 'X') <> NVL(@[cct_hrmnt], 'X') 
		    OR NVL(O.CCT_FILE_FLG, '0')     <> NVL(@[cct_file_flg], '0') 
			OR NVL(O.YD_BSE_CALC_FLG, '0')  <> NVL(@[yd_bse_calc_flg], '0') 
			OR NVL(O.XCLD_HOL_FRI_FLG, '0') <> NVL(@[xcld_hol_fri_flg], '0') 
			OR NVL(O.XCLD_HOL_SAT_FLG, '0') <> NVL(@[xcld_hol_sat_flg], '0') 
			OR NVL(O.XCLD_HOL_SUN_FLG, '0') <> NVL(@[xcld_hol_sun_flg], '0') 
			OR NVL(O.XCLD_HOL_HOL_FLG, '0') <> NVL(@[xcld_hol_hol_flg], '0') 
			OR DELT_FLG <> @[delt_flg]
		)
#end
#else
INSERT INTO PRD_TML_VGM_CCT_HIS
(HIS_SEQ, PCTL_USE_FLG, YD_CD, VVD_CD, VSL_SLAN_CD, VPS_PORT_CD, CLPT_IND_SEQ, VGM_FLG, DELT_FLG, CGO_CLZ_DT, DCGO_CLZ_DT, RC_CLZ_DT, AWK_CGO_CLZ_DT, BB_CGO_CLZ_DT, VGM_CLZ_DT, CRE_USR_ID, CRE_DT, UPD_USR_ID, UPD_DT)
  SELECT nvl((select max(HIS_SEQ) from PRD_TML_VGM_CCT_HIS), 0) + 1 HIS_SEQ
        ,@[pctl_use_flg] PCTL_USE_FLG
        ,@[yd_cd] YD_CD
        ,@[vvd_cd] VVD_CD
		,@[vsl_slan_cd] VSL_SLAN_CD
		,@[vps_port_cd] VPS_PORT_CD 
		,@[clpt_ind_seq] CLPT_IND_SEQ
        ,@[vgm_flg] VGM_FLG
        ,@[delt_flg] DELT_FLG
        ,TO_DATE(@[cgo_clz_dt], 'YYYYMMDDHH24MI')  CGO_CLZ_DT
        ,TO_DATE(@[dcgo_clz_dt], 'YYYYMMDDHH24MI')  DCGO_CLZ_DT
        ,TO_DATE(@[rc_clz_dt], 'YYYYMMDDHH24MI')  RC_CLZ_DT
        ,TO_DATE(@[awk_cgo_clz_dt], 'YYYYMMDDHH24MI')  AWK_CGO_CLZ_DT
        ,TO_DATE(@[bb_cgo_clz_dt], 'YYYYMMDDHH24MI')  BB_CGO_CLZ_DT
        ,TO_DATE(@[vgm_clz_dt], 'YYYYMMDDHH24MI')  VGM_CLZ_DT
        ,@[cre_usr_id] CRE_USR_ID
        ,SYSDATE CRE_DT
        ,@[upd_usr_id] UPD_USR_ID
        ,SYSDATE UPD_DT
    FROM VSK_VSL_PORT_SKD O
    WHERE VSL_CD        = SUBSTR(@[vvd_cd], 1, 4)
AND     SKD_VOY_NO      = SUBSTR(@[vvd_cd], 5, 4)
AND     SKD_DIR_CD      = SUBSTR(@[vvd_cd], 9, 1)
AND     VPS_PORT_CD     = @[vps_port_cd]
AND     CLPT_IND_SEQ    = @[clpt_ind_seq]
#if (${vgm_flg} == 'Y')
AND ( NVL(VGM_CLZ_DT, TO_DATE('299912312359', 'YYYYMMDDHH24MI')) <> TO_DATE(NVL(@[vgm_clz_dt], '299912312359'), 'YYYYMMDDHH24MI'))
#else
AND ( NVL(CGO_CLZ_DT, TO_DATE('299912312359', 'YYYYMMDDHH24MI'))    <> TO_DATE(NVL(@[cgo_clz_dt], '299912312359'), 'YYYYMMDDHH24MI') 
  OR NVL(DCGO_CLZ_DT, TO_DATE('299912312359', 'YYYYMMDDHH24MI'))    <>  TO_DATE(NVL(@[dcgo_clz_dt], '299912312359'), 'YYYYMMDDHH24MI') 
  OR NVL(RC_CLZ_DT, TO_DATE('299912312359', 'YYYYMMDDHH24MI'))    <>  TO_DATE(NVL(@[rc_clz_dt], '299912312359'), 'YYYYMMDDHH24MI') 
  OR NVL(AWK_CGO_CLZ_DT, TO_DATE('299912312359', 'YYYYMMDDHH24MI'))   <>  TO_DATE(NVL(@[awk_cgo_clz_dt], '299912312359'), 'YYYYMMDDHH24MI')  
  OR NVL(BB_CGO_CLZ_DT, TO_DATE('299912312359', 'YYYYMMDDHH24MI'))  <>  TO_DATE(NVL(@[bb_cgo_clz_dt], '299912312359'), 'YYYYMMDDHH24MI')   
  )
#end
#end			]]></sql>
			<params>
				<param name="pctl_use_flg" type="12" value="" out="N"/>
				<param name="vgm_flg" type="12" value="" out="N"/>
				<param name="delt_flg" type="12" value="" out="N"/>
				<param name="cct_tp_cd" type="12" value="" out="N"/>
				<param name="cct_hr" type="12" value="" out="N"/>
				<param name="cct_dy_cd" type="12" value="" out="N"/>
				<param name="cct_hrmnt" type="12" value="" out="N"/>
				<param name="cct_file_flg" type="12" value="" out="N"/>
				<param name="yd_bse_calc_flg" type="12" value="" out="N"/>
				<param name="xcld_hol_fri_flg" type="12" value="" out="N"/>
				<param name="xcld_hol_sat_flg" type="12" value="" out="N"/>
				<param name="xcld_hol_sun_flg" type="12" value="" out="N"/>
				<param name="xcld_hol_hol_flg" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="yd_cd" type="12" value="" out="N"/>
				<param name="vsl_slan_cd" type="12" value="" out="N"/>
				<param name="vsl_slan_dir_cd" type="12" value="" out="N"/>
				<param name="cgo_tp_cd" type="12" value="" out="N"/>
				<param name="vvd_cd" type="12" value="" out="N"/>
				<param name="vps_port_cd" type="12" value="" out="N"/>
				<param name="clpt_ind_seq" type="12" value="" out="N"/>
				<param name="cgo_clz_dt" type="12" value="" out="N"/>
				<param name="dcgo_clz_dt" type="12" value="" out="N"/>
				<param name="rc_clz_dt" type="12" value="" out="N"/>
				<param name="awk_cgo_clz_dt" type="12" value="" out="N"/>
				<param name="bb_cgo_clz_dt" type="12" value="" out="N"/>
				<param name="vgm_clz_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
