<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceAuditDBDAOSearchApPayInvRfndMainRSQL">
			<desc><![CDATA[AP_PAY_INV 테이블 Insert용 데이터 조회]]></desc>
			<sql><![CDATA[
SELECT DISTINCT
      @[inv_rgst_no] INV_RGST_NO -- 채번 sql에서 채번한 INV_RGST_NO
      ,'TRS' INV_SUB_SYS_CD
      ,W.CRE_OFC_CD  INV_OFC_CD
      ,R.CRE_OFC_CD  COST_OFC_CD 
      ,W.INV_VNDR_SEQ VNDR_SEQ
      ,W.INV_NO
      ,TO_CHAR(W.INV_ISS_DT,'YYYYMMDD') AS INV_ISS_DT
      ,TO_CHAR(W.INV_ISS_DT,'YYYYMMDD') AS INV_RCV_DT
      ,(SELECT GEN_PAY_TERM_CD FROM MDM_VENDOR WHERE VNDR_SEQ = W.INV_VNDR_SEQ) VNDR_TERM_NM
      ,W.INV_CURR_CD
      ,0 INV_TTL_AMT
      ,0 INV_VAT_AMT
      ,0 INV_NET_AMT
      ,0 WHLD_TAX_AMT
      ,'N' DELT_FLG      
      ,'USER'
      ,SYSDATE
      ,'USER'
      ,SYSDATE
FROM  TRS_TRSP_INV_WRK          W
     ,TRS_TRSP_RFND_INV         R
WHERE W.CRE_OFC_CD            = @[ofc_cd] -- 로그인 Office Code
AND   W.TRSP_INV_AUD_STS_CD   = 'CF'
AND   NVL(W.INV_HLD_FLG,' ') <> 'T'
AND   NVL(W.DELT_FLG,'N')     = 'N'
AND   NVL(R.DELT_FLG,'N')     = 'N'
AND   R.INV_NO                = W.INV_NO
AND   R.INV_VNDR_SEQ          = W.INV_VNDR_SEQ
AND   W.INV_NO = @[inv_no] -- 파라메터로 받음 (Confirm 한 invoice no)			]]></sql>
			<params>
				<param name="inv_rgst_no" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="inv_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
