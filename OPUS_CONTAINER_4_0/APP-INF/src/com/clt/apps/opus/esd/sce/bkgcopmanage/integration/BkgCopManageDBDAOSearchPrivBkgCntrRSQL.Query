<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BkgCopManageDBDAOSearchPrivBkgCntrRSQL">
			<desc><![CDATA[booking / container 별로 cycle no 로 조회시 이전 운송 booking no 와 booking status 를 조회한다.]]></desc>
			<sql><![CDATA[
select b.bkg_no, h.cop_sts_cd
    from sce_cop_hdr h,
    (
        select a.bkg_no, a.cntr_no 
        from
        (
            select bbc.bkg_no, bbc.cntr_no, bbc.cre_dt  
            from bkg_container bbc, bkg_booking bk, 
            (
                select bkg_no, CNMV_CYC_NO, cntr_no, cre_dt 
                from bkg_container 
                where bkg_no = @[bkg_no]
                and cntr_no = @[cntr_no]
            ) bc       
            where bbc.cntr_no = bc.cntr_no
            and bbc.bkg_no = bk.bkg_no
            and bk.bkg_cgo_tp_cd <>'P'
            and bbc.cre_dt < bc.cre_dt
            and bbc.CNMV_CYC_NO < bc.CNMV_CYC_NO
            order by bbc.cre_dt desc
        )a
        where rownum =1 
    ) b
    where h.bkg_no = b.bkg_no
    and h.cntr_no = b.cntr_no
    and rownum = 1			]]></sql>
			<params>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
