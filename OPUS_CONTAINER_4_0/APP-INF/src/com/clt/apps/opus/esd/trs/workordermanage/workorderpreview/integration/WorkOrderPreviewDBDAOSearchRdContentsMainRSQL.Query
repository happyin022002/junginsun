<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WorkOrderPreviewDBDAOSearchRdContentsMainRSQL">
			<desc><![CDATA[SearchRdContentsMain]]></desc>
			<sql><![CDATA[
SELECT tmp.vndr_seq as vndr_code                    
	  	,vd.vndr_lgl_eng_nm  as full_name                    
	  	,vd.eng_addr as eng_addr                     
		,vd_cntc.phn_no as phn_no
		,vd_cntc.fax_no as fax_no
		,vd.cntc_pson_nm as cntc_pson_nm
		,so.trsp_bnd_cd as trsp_bnd_cd
		,so.trsp_cost_dtl_mod_cd as trsp_cost_dtl_mod_cd
		,commcode_pkg.get_comdtl_name_fnc('CD00283',so.trsp_crr_mod_cd) as trsp_crr_mod_nm
		,commcode_pkg.get_comdtl_name_fnc('CD00744',so.trsp_cost_dtl_mod_cd) as trsp_cost_dtl_mod_nm
		,NVL(wrk.trsp_wo_ofc_cty_cd,'')||NVL(wrk.trsp_wo_seq,'') as trsp_wo_cd
		,DECODE (tmp.wo_iss_sts_cd, 'I','Issue','R', 'Reissue','C','Correction' ,'N','Cancellation') as wo_iss_sts_cd
		,NVL(from_yard.yd_cd,from_lse_yard.lse_co_yd_cd) as fm_cd
		,NVL(from_yard.yd_nm, from_lse_yard.lse_co_yd_nm) as fm_nm
		,NVL(from_yard.yd_addr, from_lse_yard.yd_addr) as fm_addr
		,NVL(from_yard.phn_no, from_lse_yard.phn_no) as fm_phn_no
		,NVL(from_yard.fax_no, from_lse_yard.fax_no) as fm_fax_no
		,NVL(from_yard.yd_pic_nm, from_lse_yard.yd_pic_nm) as fm_pic_nm
		,NVL(to_yard.yd_cd, to_lse_yard.lse_co_yd_cd) as to_cd
		,NVL(to_yard.yd_nm, to_lse_yard.lse_co_yd_nm) as to_nm
		,NVL(to_yard.yd_addr, to_lse_yard.yd_addr) as to_addr
		,NVL(to_yard.phn_no, to_lse_yard.phn_no) as to_phn_no
		,NVL(to_yard.fax_no, to_lse_yard.fax_no) as to_fax_no                    
		,NVL(to_yard.yd_pic_nm,to_lse_yard.yd_pic_nm) as to_pic_nm                    
		,via_yard.yd_cd as via_cd
		,via_yard.yd_nm as via_nm
		,via_yard.yd_addr as via_addr
		,via_yard.phn_no as via_phn_no
		,via_yard.fax_no as via_fax_no
		,via_yard.yd_pic_nm as via_pic_nm
		,so.dor_nod_cd as dr_cd
		,so.dor_de_addr as dr_addr
		,so.fctry_nm as dr_nm
		,so.cntc_pson_phn_no as dr_phn_no
		,so.cntc_pson_fax_no as dr_fax_no
		,so.cntc_pson_nm as dr_pic_nm
		,wrk.wo_rmk as instruction
		,vsl1.vsl_eng_nm||' '||SUBSTR(so.ib_vvd_cd,5,5) as ib_vvd_cd                    
		,vsl2.vsl_eng_nm||' '||SUBSTR(so.ob_vvd_cd,5,5) as ob_vvd_cd
		,org.ofc_addr  as ofc_addr
		,org.ofc_phn_no as ofc_phn_no
		,org.ofc_fax_no as ofc_fax_no
		,usr.usr_nm as pic
		,TO_CHAR(NVL(wrk.locl_upd_dt, wrk.locl_cre_dt),'YYYY-MM-DD')  as wo_cre_dt                    
		,TO_CHAR(NVL(wrk.locl_upd_dt, wrk.locl_cre_dt),'HH24:MI') as wo_cre_tm
    FROM trs_trsp_svc_ord so
		,mdm_vendor vd
		,mdm_vndr_cntc_pnt vd_cntc
		,mdm_yard from_yard
		,mdm_lse_co_yd from_lse_yard
		,mdm_yard to_yard                
		,mdm_lse_co_yd to_lse_yard
		,mdm_yard via_yard
		,trs_trsp_wrk_ord_prv_tmp tmp
		,mdm_organization org
		,com_user usr
		,mdm_vsl_cntr vsl1
		,mdm_vsl_cntr vsl2
		,trs_trsp_wrk_ord wrk
   WHERE tmp.wo_prv_grp_seq = @[wo_prv_grp_seq]
     AND tmp.wo_iss_no = @[wo_iss_no]
     AND tmp.trsp_so_ofc_cty_cd = so.trsp_so_ofc_cty_cd
     AND tmp.trsp_so_seq = so.trsp_so_seq
     AND org.ofc_cd = ?
     AND tmp.vndr_seq = vd.vndr_seq(+)                
     AND vd.vndr_seq = vd_cntc.vndr_seq(+)           
     AND vd_cntc.prmry_chk_flg(+) = 'Y'
     AND vd_cntc.phn_no(+) IS NOT NULL
     AND vd.delt_flg(+) = 'N'
     AND vd_cntc.delt_flg(+) = 'N'            
     AND tmp.fm_nod_cd = from_yard.yd_cd(+)
     AND from_yard.delt_flg(+) = 'N'
     AND tmp.fm_nod_cd = from_lse_yard.lse_co_yd_cd(+)
     AND from_lse_yard.delt_flg(+) = 'N'
     AND tmp.to_nod_cd = to_yard.yd_cd(+
     AND to_yard.delt_flg(+) = 'N'
     AND tmp.to_nod_cd = to_lse_yard.lse_co_yd_cd(+)   
     AND to_lse_yard.delt_flg(+) = 'N'
     AND tmp.via_nod_cd = via_yard.yd_cd(+)
     AND usr.usr_id = ?
     AND tmp.trsp_wo_ofc_cty_cd = wrk.trsp_wo_ofc_cty_cd(+)
     AND tmp.trsp_wo_seq = wrk.trsp_wo_seq(+)     
     AND SUBSTR(so.ib_vvd_cd,1,4) = vsl1.vsl_cd(+)
     AND SUBSTR(so.ob_vvd_cd,1,4)  = vsl2.vsl_cd(+)
     AND ROWNUM = 1			]]></sql>
			<params>
				<param name="wo_prv_grp_seq" type="12" value="" out="N"/>
				<param name="wo_iss_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
