<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="NewCCTManageDBDAOMultiCCTManageRSQL">
			<desc><![CDATA[MultiCCTManage]]></desc>
			<sql><![CDATA[
MERGE INTO PRD_TML_CCT_MGMT C USING  

    (SELECT @[yard_code] YD_CD 
         , @[lane_code] VSL_SLAN_CD 
         , NVL(@[lane_dir_code], 'A') VSL_SLAN_DIR_CD 
         , @[cargo_type] CGO_TP_CD 
         , @[cct_type] CCT_TP_CD 
         , DECODE(TO_NUMBER(@[cct_hour], '99'), 0, NULL, TO_NUMBER(@[cct_hour], '99')) CCT_HR 
         
         #if(${cct_type} == 'CMN') 
         , '' CCT_DY_CD 
         #else 
         , @[cct_day] CCT_DY_CD 
         #end 
         
         , @[cct_time] CCT_HRMNT 
      FROM DUAL 
    ) T 

ON( C.YD_CD = T.YD_CD 
	AND C.VSL_SLAN_CD = T.VSL_SLAN_CD 
	AND C.VSL_SLAN_DIR_CD = T.VSL_SLAN_DIR_CD 
	AND C.CGO_TP_CD =T.CGO_TP_CD ) 

WHEN MATCHED THEN 
       UPDATE 
          SET C.CCT_TP_CD= @[cct_type] 
            , C.CCT_HR = T.CCT_HR 
            , C.CCT_FILE_FLG = @[cct_file_flg] 
            , C.YD_BSE_CALC_FLG = @[yd_bse_calc_flg] 
            
            #if(${cct_type} == 'CMN') 
            , C.CCT_DY_CD = '' 
            #else 
            , C.CCT_DY_CD = T.CCT_DY_CD 
            #end
             
            , C.CCT_HRMNT = T.CCT_HRMNT 
            , C.XCLD_HOL_FRI_FLG = @[fri_flag] 
            , C.XCLD_HOL_SAT_FLG = @[sat_flag] 
            , C.XCLD_HOL_SUN_FLG = @[sun_flag] 
            , C.XCLD_HOL_HOL_FLG = @[holi_flag] 
            
            #if(${ibflag} == 'I' || ${ibflag} == 'U') 
            , C.DELT_FLG = 'N' 
            #else 
            , C.DELT_FLG = 'Y' 
            #end
             
            , C.UPD_USR_ID = @[user_id] 
            , C.UPD_DT = SYSDATE 		

			, C.VGM_CLZ_TP_CD = @[vgm_clz_tp_cd] 
            , C.VGM_CLZ_HR = DECODE(TO_NUMBER(@[vgm_clz_hr], '99'), 0, NULL, TO_NUMBER(@[vgm_clz_hr], '99')) 
            , C.VGM_CLZ_FILE_FLG = @[vgm_clz_file_flg] 
            , C.VGM_YD_BSE_CALC_FLG = @[vgm_yd_bse_calc_flg] 

			#if(${vgm_clz_tp_cd} == 'CMN') 
            , C.VGM_CLZ_DY_CD = '' 
			#else 
            , C.VGM_CLZ_DY_CD = @[vgm_clz_dy_cd] 
            #end	

            , C.VGM_CLZ_HRMNT = @[vgm_clz_hrmnt] 
            , C.VGM_XCLD_HOL_FRI_FLG = @[vgm_xcld_hol_fri_flg] 
            , C.VGM_XCLD_HOL_SAT_FLG = @[vgm_xcld_hol_sat_flg] 
            , C.VGM_XCLD_HOL_SUN_FLG = @[vgm_xcld_hol_sun_flg] 
            , C.VGM_XCLD_HOL_HOL_FLG = @[vgm_xcld_hol_hol_flg] 

WHEN NOT MATCHED THEN 

       INSERT 
              ( 
                  YD_CD 
                , VSL_SLAN_CD 
                , VSL_SLAN_DIR_CD 
                , CGO_TP_CD 
                , CCT_TP_CD 
                , CCT_HR 
                , CCT_FILE_FLG 
                , YD_BSE_CALC_FLG 
                , CCT_DY_CD 
                , CCT_HRMNT 
                , XCLD_HOL_FRI_FLG 
                , XCLD_HOL_SAT_FLG 
                , XCLD_HOL_SUN_FLG 
                , XCLD_HOL_HOL_FLG 
                , DELT_FLG 
                , CRE_USR_ID 
                , CRE_DT 
                , UPD_USR_ID 
                , UPD_DT 
                , VGM_CLZ_TP_CD 
                , VGM_CLZ_HR 
                , VGM_CLZ_FILE_FLG 
                , VGM_YD_BSE_CALC_FLG 
                , VGM_CLZ_DY_CD 
                , VGM_CLZ_HRMNT 
                , VGM_XCLD_HOL_FRI_FLG 
                , VGM_XCLD_HOL_SAT_FLG 
                , VGM_XCLD_HOL_SUN_FLG 
                , VGM_XCLD_HOL_HOL_FLG 
              ) 
              VALUES 
              ( 
                  @[yard_code] 
                , @[lane_code] 
                , NVL(@[lane_dir_code], 'A') 
                , @[cargo_type] 
                , @[cct_type] 
                , DECODE(TO_NUMBER(@[cct_hour], '99'), 0, NULL, TO_NUMBER(@[cct_hour], '99')) 
                , @[cct_file_flg] 
                , @[yd_bse_calc_flg] 
                
                #if(${cct_type} == 'CMN') 
                , '' 
                #else 
                , @[cct_day] 
                #end
                 
                , @[cct_time] 
                , @[fri_flag] 
                , @[sat_flag] 
                , @[sun_flag] 
                , @[holi_flag] 
                
                #if(${ibflag} == 'I' || ${ibflag} == 'U') 
                , 'N' 
                #else 
                , 'Y' 
                #end
                 
                , @[user_id] 
                , SYSDATE 
                , @[user_id] 
                , SYSDATE 

                , @[vgm_clz_tp_cd] 
                , DECODE(TO_NUMBER(@[vgm_clz_hr], '99'), 0, NULL, TO_NUMBER(@[vgm_clz_hr], '99')) 
                , @[vgm_clz_file_flg] 
                , @[vgm_yd_bse_calc_flg] 

                #if(${vgm_clz_tp_cd} == 'CMN') 
                , '' 
                #else 
                , @[vgm_clz_dy_cd] 
                #end

                , @[vgm_clz_hrmnt] 
                , @[vgm_xcld_hol_fri_flg] 
                , @[vgm_xcld_hol_sat_flg] 
                , @[vgm_xcld_hol_sun_flg] 
                , @[vgm_xcld_hol_hol_flg] 
              )			]]></sql>
			<params>
				<param name="yard_code" type="12" value="" out="N"/>
				<param name="lane_code" type="12" value="" out="N"/>
				<param name="lane_dir_code" type="12" value="" out="N"/>
				<param name="cargo_type" type="12" value="" out="N"/>
				<param name="cct_type" type="12" value="" out="N"/>
				<param name="cct_hour" type="12" value="" out="N"/>
				<param name="cct_day" type="12" value="" out="N"/>
				<param name="cct_time" type="12" value="" out="N"/>
				<param name="cct_file_flg" type="12" value="" out="N"/>
				<param name="yd_bse_calc_flg" type="12" value="" out="N"/>
				<param name="fri_flag" type="12" value="" out="N"/>
				<param name="sat_flag" type="12" value="" out="N"/>
				<param name="sun_flag" type="12" value="" out="N"/>
				<param name="holi_flag" type="12" value="" out="N"/>
				<param name="user_id" type="12" value="" out="N"/>
				<param name="vgm_clz_tp_cd" type="12" value="" out="N"/>
				<param name="vgm_clz_hr" type="12" value="" out="N"/>
				<param name="vgm_clz_file_flg" type="12" value="" out="N"/>
				<param name="vgm_yd_bse_calc_flg" type="12" value="" out="N"/>
				<param name="vgm_clz_dy_cd" type="12" value="" out="N"/>
				<param name="vgm_clz_hrmnt" type="12" value="" out="N"/>
				<param name="vgm_xcld_hol_fri_flg" type="12" value="" out="N"/>
				<param name="vgm_xcld_hol_sat_flg" type="12" value="" out="N"/>
				<param name="vgm_xcld_hol_sun_flg" type="12" value="" out="N"/>
				<param name="vgm_xcld_hol_hol_flg" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
