<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TESInvoiceCommonDBDAOSearchApPayInvDtlRSQL">
			<desc><![CDATA[SearchApPayInvDtl]]></desc>
			<sql><![CDATA[
SELECT
	'I' IBFLAG,
	NVL((SELECT INV_RGST_SEQ 
		 FROM AP_PAY_INV_DTL D
		 WHERE  D.INV_RGST_NO = @[inv_rgst_no] ), 0)+1 INV_RGST_SEQ,
	LGS_COST_CD,
	(select decode(length(T1.lgs_cost_cd), 4, 110911, x.acct_cd) from tes_lgs_cost x where x.lgs_cost_cd = T1.lgs_cost_cd) ACCT_CD,
	'CNTC' VSL_CD,
	'1102' SKD_VOY_NO,
	'M' SKD_DIR_CD,
	'M' REV_DIR_CD,
	( SELECT X.vsl_slan_cd 
	  FROM VSK_VSL_SKD X 
	  WHERE X.VSL_CD = t1.vsl_cd AND X.SKD_VOY_NO = t1.skd_voy_no AND X.skd_dir_cd = T1.skd_dir_cd
	) SLAN_CD,
	VSL_CD||SKD_VOY_NO||SKD_DIR_CD ACT_VVD_CD,
	SUBSTR((select x.yd_cd from tes_tml_so_hdr x where x.tml_so_ofc_cty_cd = t1.tml_so_ofc_cty_cd and x.tml_so_seq = t1.tml_so_seq), 1, 5) PORT_CD,
	(select x.yd_cd from tes_tml_so_hdr x where x.tml_so_ofc_cty_cd = t1.tml_so_ofc_cty_cd and x.tml_so_seq = t1.tml_so_seq) YD_CD,
	INV_AMT,
	TML_SO_OFC_CTY_CD SO_OFC_CTY_CD,
	TML_SO_SEQ SO_SEQ,
	'N' DELT_FLG,
	@[cre_usr_id] CRE_USR_ID,
	SYSDATE CRE_DT,
	@[cre_usr_id] UPD_USR_ID,
	SYSDATE UPD_DT,
	'' as INV_DESC
FROM
	TES_TML_SO_DTL T1
WHERE 1=1
	AND TML_SO_OFC_CTY_CD = @[tml_so_ofc_cty_cd]
	AND TML_SO_SEQ = @[tml_so_seq]			]]></sql>
			<params>
				<param name="inv_rgst_no" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="tml_so_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="tml_so_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
