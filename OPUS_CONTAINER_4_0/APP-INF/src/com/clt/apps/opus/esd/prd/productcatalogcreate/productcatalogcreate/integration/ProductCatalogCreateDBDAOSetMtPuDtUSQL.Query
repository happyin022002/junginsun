<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ProductCatalogCreateDBDAOSetMtPuDtUSQL">
			<desc><![CDATA[mt pu dt를 입력받은 값으로 바꿔준다.]]></desc>
			<sql><![CDATA[
MERGE INTO PRD_PROD_CTL_ROUT_DTL D
      USING (
            SELECT PCTL_NO, PCTL_SEQ,ORG_NOD_CD,DEST_NOD_CD,--ARR_ST_DT,DEP_FSH_DT,TZ_DWLL_TM_HRS,
                   CASE WHEN PCTL_SEQ IN (1,2) THEN TO_DATE(@[mt_pu_dt], 'YYYYMMDD')
                        ELSE ARR_ST_DT
                   END ARR_ST_DT,
                   CASE WHEN PCTL_SEQ =1 THEN TO_DATE(@[mt_pu_dt], 'YYYYMMDD')
                        ELSE DEP_FSH_DT
                   END DEP_FSH_DT,
                   CASE WHEN PCTL_SEQ =2 THEN TZ_DWLL_TM_HRS+ ROUND((ARR_ST_DT - TO_DATE(@[mt_pu_dt], 'YYYYMMDD'))*24)
                        ELSE TZ_DWLL_TM_HRS
                   END TZ_DWLL_TM_HRS
            FROM PRD_PROD_CTL_ROUT_DTL  
            WHERE PCTL_NO = @[pctl_no]
            AND PCTL_IO_BND_CD ='O'
            AND PCTL_SEQ IN (1,2)
      ) T ON (
            D.PCTL_NO = T.PCTL_NO
            AND D.PCTL_SEQ = T.PCTL_SEQ
            AND D.ORG_NOD_CD = T.ORG_NOD_CD
            AND D.DEST_NOD_CD = T.DEST_NOD_CD
      )
WHEN MATCHED THEN 
     UPDATE SET ARR_ST_DT= T.ARR_ST_DT
                , DEP_FSH_DT= T.DEP_FSH_DT 
                , TZ_DWLL_TM_HRS= T.TZ_DWLL_TM_HRS			]]></sql>
			<params>
				<param name="mt_pu_dt" type="12" value="" out="N"/>
				<param name="pctl_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
