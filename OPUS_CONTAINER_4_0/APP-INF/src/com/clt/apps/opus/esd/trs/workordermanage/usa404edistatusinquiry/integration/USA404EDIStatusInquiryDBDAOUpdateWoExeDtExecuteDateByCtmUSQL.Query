<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="USA404EDIStatusInquiryDBDAOUpdateWoExeDtExecuteDateByCtmUSQL">
			<desc><![CDATA[USA404EDIStatusInquiryDBDAOUpdateWoExeDtExecuteDateByCtm]]></desc>
			<sql><![CDATA[
UPDATE TRS_TRSP_RAIL_BIL_ORD SO
   SET
#if(${mvmt_cre_tp_cd} == 'A')  
       	SO.ORG_GATE_OUT_DT 	= (CASE WHEN @[mvmt_sts_cd] IN ('EN','TN','OP','ID') AND @[node_cd] = SO.FM_NOD_CD THEN TO_DATE(@[wo_exe_dt], 'YYYYMMDDHH24MI')
                                  ELSE SO.ORG_GATE_OUT_DT
                               END) ,
#else 
		SO.WO_EXE_DT       	= (CASE WHEN SO.TRSP_COST_DTL_MOD_CD <> 'DR' AND @[node_cd] = SO.FM_NOD_CD AND @[mvmt_sts_cd] IN ('EN','TN','OP','ID') THEN TO_DATE(@[wo_exe_dt], 'YYYYMMDDHH24MI')
                               	  ELSE SO.WO_EXE_DT
							   END) ,       
       	SO.ORG_GATE_OUT_DT 	= (CASE WHEN @[mvmt_sts_cd] IN ('EN','TN','OP','ID') AND @[node_cd] = SO.FM_NOD_CD THEN TO_DATE(@[wo_exe_dt], 'YYYYMMDDHH24MI')
                                  ELSE SO.ORG_GATE_OUT_DT
                               END) ,
       	SO.DEST_GATE_IN_DT 	= (CASE WHEN @[mvmt_sts_cd] IN ('OC','IC','MT') AND @[node_cd] = SO.TO_NOD_CD THEN TO_DATE(@[wo_exe_dt], 'YYYYMMDDHH24MI')
                                  ELSE SO.DEST_GATE_IN_DT
                               END),   
#end							   
       	SO.UPD_USR_ID      	= @[upd_usr_id],
	   	SO.LOCL_UPD_DT	  	= GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(SO.CRE_OFC_CD),
	   	SO.UPD_DT          	= SYSDATE		
WHERE ( SO.EQ_NO = @[cntr_no] OR SO.COP_NO = (SELECT COP_NO FROM SCE_COP_HDR WHERE BKG_NO=@[bkg_no] AND CNTR_NO =@[cntr_no]) )
AND SO.BKG_NO = @[bkg_no]
AND INSTR(SO.FM_NOD_CD||SO.TO_NOD_CD, @[node_cd] ) > 0
AND SO.DELT_FLG = 'N'			]]></sql>
			<params>
				<param name="mvmt_sts_cd" type="12" value="" out="N"/>
				<param name="node_cd" type="12" value="" out="N"/>
				<param name="wo_exe_dt" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
