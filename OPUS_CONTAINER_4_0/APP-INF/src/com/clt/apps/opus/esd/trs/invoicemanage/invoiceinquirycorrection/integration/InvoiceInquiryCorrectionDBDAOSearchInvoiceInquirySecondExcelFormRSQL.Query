<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceInquiryCorrectionDBDAOSearchInvoiceInquirySecondExcelFormRSQL">
			<desc><![CDATA[InvoiceInquiryCorrection의 모든 목록을 가져온다]]></desc>
			<sql><![CDATA[
SELECT A.IF_SYS_KND_CD
	,COMMCODE_PKG.GET_COMDTL_NAME_FNC('CD00914', A.IF_SYS_KND_CD) AS IF_SYS_KND_NM
	,A.TRSP_INV_AUD_STS_CD
	,COMMCODE_PKG.GET_COMDTL_NAME_FNC('CD00824', A.TRSP_INV_AUD_STS_CD) AS TRSP_INV_AUD_STS_NM
	,DECODE(A.INV_HLD_FLG, 'N', '0', 'Y', '1') AS INV_HLD_FLG
	,A.INV_NO
	,LPAD(TO_CHAR(A.INV_VNDR_SEQ), 6, '0') AS INV_VNDR_SEQ
	,B.VNDR_LGL_ENG_NM AS INV_VNDR_NM
	,C.TRSP_WO_OFC_CTY_CD || C.TRSP_WO_SEQ AS TRSP_WO_OFC_CTY_CD_SEQ
	,LPAD(TO_CHAR(C.VNDR_SEQ), 6, '0') AS VNDR_SEQ
	,D.VNDR_LGL_ENG_NM AS VNDR_NM
	,C.TRSP_SO_OFC_CTY_CD || C.TRSP_SO_SEQ AS TRSP_SO_OFC_CTY_CD_SEQ
	,C.EQ_NO
	,C.EQ_TPSZ_CD
	,C.CURR_CD
	,NVL(C.BZC_AMT, 0) AS BZC_AMT
	,NVL(C.NEGO_AMT, 0) AS NEGO_AMT
	,NVL(C.FUEL_SCG_AMT, 0) AS FUEL_SCG_AMT
	,NVL(C.ETC_ADD_AMT, 0) AS ETC_ADD_AMT
	,NVL(C.BZC_AMT, 0) + NVL(C.ETC_ADD_AMT, 0) + NVL(C.FUEL_SCG_AMT, 0) + NVL(C.NEGO_AMT, 0) AS WO_TOT_AMT
	,C.INV_XCH_RT
	,C.TRSP_INV_CALC_LGC_TP_CD
	,COMMCODE_PKG.GET_COMDTL_NAME_FNC('CD00874', C.TRSP_INV_CALC_LGC_TP_CD) AS TRSP_INV_CALC_LGC_TP_NM
	,A.INV_CURR_CD
	,NVL(C.INV_BZC_AMT, 0) AS INV_BZC_AMT
	,NVL(C.INV_ETC_ADD_AMT, 0) AS INV_ETC_ADD_AMT
	,NVL(C.INV_BZC_AMT, 0) + NVL(C.INV_ETC_ADD_AMT, 0) AS INV_TOT_AMT
	,NVL(A.INV_VAT_AMT, 0) AS INV_VAT_AMT
	,NVL(A.INV_WHLD_TAX_AMT, 0) AS INV_WHLD_TAX_AMT
	,DECODE(NVL(A.INV_TTL_AMT, 0), 0, (SUM(NVL(C.INV_BZC_AMT, 0) + NVL(C.INV_ETC_ADD_AMT, 0)) OVER(PARTITION BY C.INV_NO, C.INV_VNDR_SEQ)) + NVL(A.INV_VAT_AMT, 0) + NVL(A.INV_WHLD_TAX_AMT, 0), NVL(A.INV_TTL_AMT, 0)) AS INV_GTTL_AMT
	,TO_CHAR(A.INV_ISS_DT, 'YYYY-MM-DD') AS INV_ISS_DT
	,TO_CHAR(A.INV_RCV_DT, 'YYYY-MM-DD') AS INV_RCV_DT
	,TO_CHAR(A.PAY_DT, 'YYYY-MM-DD') AS PAY_DT
	,A.GL_DT
	,TO_CHAR(A.UPD_DT, 'YYYY-MM-DD') AS UPD_DT
	,A.CSR_NO
	,A.INV_PAY_MZD_CD
	,A.INV_CHK_TRNS_NO
	,C.INV_RMK
	,A.CRE_OFC_CD
	,A.CRE_USR_ID
	,C.REF_INV_NO
	,NVL(C.INV_ADJ_BZC_AMT, 0) INV_ADJ_BZC_AMT
FROM TRS_TRSP_INV_WRK A
	,MDM_VENDOR       B
	,TRS_TRSP_SVC_ORD C
	,MDM_VENDOR       D
WHERE A.INV_VNDR_SEQ = B.VNDR_SEQ
AND A.INV_VNDR_SEQ = C.INV_VNDR_SEQ
AND A.INV_NO = C.INV_NO
AND C.VNDR_SEQ = D.VNDR_SEQ        
AND A.INV_NO                                   = @[inv_no]                        
AND A.INV_VNDR_SEQ                             = @[inv_vndr_seq]			]]></sql>
			<params>
				<param name="inv_no" type="12" value="" out="N"/>
				<param name="inv_vndr_seq" type="2" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
