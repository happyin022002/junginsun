<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CommonCodeDBDAOSearchOfficeLevelRSQL">
			<desc><![CDATA[SearchOfficeLevel]]></desc>
			<sql><![CDATA[
SELECT DISTINCT OFFICE_LEVEL,
       OFC_CD,
       RHQ_CD,
       HO_CD
  FROM (
       ----- HO -----
       SELECT 'H' OFFICE_LEVEL, OFC_CD, NULL AS RHQ_CD, OFC_CD HO_CD
         FROM MDM_ORGANIZATION
        WHERE 1 = 1
          AND OFC_KND_CD = '1'
          AND OFC_CD = @[s_ofc_cd]
       -----
       UNION ALL
       ----- RHQ -----
	   SELECT DISTINCT 'R' AS OFFICE_LEVEL,
    	      DECODE(PRNT_OFC_CD, ( SELECT OFC_CD FROM MDM_OFC_GRP_MAPG WHERE OFC_GRP_ID='000001' AND  SUB_SYS_CD='TPB' ), OFC_CD, PRNT_OFC_CD) AS OFC_CD,
    	      DECODE(PRNT_OFC_CD, ( SELECT OFC_CD FROM MDM_OFC_GRP_MAPG WHERE OFC_GRP_ID='000001' AND  SUB_SYS_CD='TPB' ), OFC_CD, PRNT_OFC_CD) AS RHQ_CD,
    	      NULL AS HO_CD
	    FROM MDM_ORGANIZATION
	   WHERE 1 = 1
    	 AND OFC_KND_CD = '2'
    	 AND DELT_FLG = 'N'
    	 AND OFC_CD = @[s_ofc_cd]
         AND OFC_CD != ( SELECT OFC_CD FROM MDM_OFC_GRP_MAPG WHERE OFC_GRP_ID='000002' AND  SUB_SYS_CD='TPB' )
       -----
       UNION ALL
       ----- RHQ - SINWA -----
	   SELECT DISTINCT 'R' AS OFFICE_LEVEL,
    	      OFC_CD,
    	      OFC_CD RHQ_CD,
    	      NULL AS HO_CD
	     FROM MDM_ORGANIZATION
	    WHERE 1 = 1
          AND OFC_KND_CD = '2'
          AND DELT_FLG = 'N'
    	  AND OFC_CD = @[s_ofc_cd]
          AND OFC_CD = ( SELECT OFC_CD FROM MDM_OFC_GRP_MAPG WHERE OFC_GRP_ID='000002' AND  SUB_SYS_CD='TPB' )
       -----
       UNION ALL
       ----- GO 1 -----
       SELECT 'G' OFFICE_LEVEL, N3PTY_OFC_CD, RHQ_CD, NULL AS HO_CD
         FROM TPB_HNDL_OFC
        WHERE N3PTY_OFC_CD = @[s_ofc_cd]
          AND DELT_FLG = 'N'
       ) A
 WHERE 1 = 1			]]></sql>
			<params>
				<param name="s_ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
