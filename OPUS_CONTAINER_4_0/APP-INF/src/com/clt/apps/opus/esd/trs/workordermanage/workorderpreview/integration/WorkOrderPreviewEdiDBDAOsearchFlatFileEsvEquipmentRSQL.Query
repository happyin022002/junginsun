<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="WorkOrderPreviewEdiDBDAOsearchFlatFileEsvEquipmentRSQL">
			<desc><![CDATA[NYK-Hawk_FFile(ESV_N)-JOEDI_EU_OUTBOUND
{EQUIPMENT]]></desc>
			<sql><![CDATA[
SELECT T1.*
  FROM (
	#if(${cgo_tp_cd} == 'F')
		SELECT SO.BKG_NO
			  ,SO.EQ_NO AS CNTR_NO
			  ,SO.EQ_TPSZ_CD AS CNTR_TPSZ
			  ,'' AS EQ_COMMENT
			  ,'' AS FUMIGATE
			  ,'' AS TRIAXLE
--			  ,SUBSTR(DECODE(NVL(SO.EQ_NO, 'XX'), 'XX', F.CMDT_NM, C.DIFF_RMK), 1, 50) CMDD
              ,CASE WHEN SO.TRSP_BND_CD = 'I'
                    THEN NVL((SELECT REPLACE(REPLACE(CM.CNTR_MF_GDS_DESC, CHR(13), ''), CHR(10), ' ')
                                FROM BKG_CNTR_MF_DESC CM
                               WHERE SO.BKG_NO = CM.BKG_NO(+)
                                 AND SO.EQ_NO = CM.CNTR_NO(+)
                                 AND CM.CNTR_MF_SEQ = 1), F.CMDT_NM)
                    WHEN TRSP_COST_DTL_MOD_CD = 'DR'
                    THEN NVL((SELECT CMDD.CMDT_NM
                                FROM BKG_EUR_TRO TRO,
                                     MDM_COMMODITY CMDD
                               WHERE SO.BKG_NO = TRO.BKG_NO
                                 AND SO.TRSP_BND_CD = TRO.IO_BND_CD
                                 AND SO.TRO_SEQ = TRO.TRO_SEQ
                                 AND SO.TRO_SUB_SEQ = TRO.RQST_SUB_SEQ
                                 AND SO.EQ_TPSZ_CD = TRO.CNTR_TPSZ_CD
                                 AND TRO.CMDT_CD = CMDD.CMDT_CD(+)
                                 AND TRO.CXL_FLG = 'N'), F.CMDT_NM)
                    ELSE F.CMDT_NM
               END CMDD
			  ,CASE WHEN NVL(X.CNTR_TYPE, 'X') != 'X' THEN X.CNTR_TYPE
					WHEN B.DCGO_FLG = 'Y' AND B.AWK_CGO_FLG = 'Y' THEN 'Awkward Dangerous'
					WHEN B.DCGO_FLG = 'Y' AND B.RC_FLG = 'Y' THEN 'Reefer Dangerous'
					WHEN B.DCGO_FLG = 'Y' 		THEN 'Dangerous'
					WHEN B.RC_FLG = 'Y' 		THEN 'Reefer'
					WHEN B.BB_CGO_FLG = 'Y' 	THEN 'Break Bulk'
					WHEN B.AWK_CGO_FLG = 'Y' 	THEN 'Awkward'
					WHEN NVL(B.DCGO_FLG, 'N') = 'N' AND NVL(B.RC_FLG, 'N') = 'N' AND NVL(B.BB_CGO_FLG, 'N') = 'N' AND NVL(B.AWK_CGO_FLG, 'N') = 'N' THEN 'General'
					ELSE ''
			   END CNTR_TYPE
			  ,B.CMDT_CD AS HS_CD
			  ,C.PCK_QTY AS PKG_QTY
			  ,C.PCK_TP_CD AS PKG_CD
			  ,D.PCK_NM AS PKG_TYPE
			  ,SO.TRSP_SO_OFC_CTY_CD
			  ,SO.TRSP_SO_SEQ
		  FROM TRS_TRSP_SVC_ORD SO
			  ,BKG_BOOKING      B
			  ,BKG_CONTAINER    C
			  ,MDM_PCK_TP       D
			  ,MDM_COMMODITY    F
			  ,(SELECT NVL(TRIM(DECODE(SIGN(TRO.RC_SEQ), 1, 'Reefer ') || DECODE(SIGN(TRO.AWK_CGO_SEQ), 1, 'Awkward ') || DECODE(SIGN(DGSEQ.DCGO_SEQ), 1, 'Dangerous')), 'General') CNTR_TYPE
					  ,SVC.TRSP_SO_OFC_CTY_CD
					  ,SVC.TRSP_SO_SEQ
				  FROM TRS_TRSP_SVC_ORD   SVC
					  ,BKG_EUR_TRO        TRO
					  ,BKG_EUR_TRO_DG_SEQ DGSEQ
				 WHERE SVC.BKG_NO = TRO.BKG_NO
				   AND SVC.TRSP_BND_CD = TRO.IO_BND_CD
				   AND SVC.TRO_SEQ = TRO.TRO_SEQ
				   AND SVC.TRO_SUB_SEQ = TRO.RQST_SUB_SEQ
				   AND SVC.EQ_TPSZ_CD = TRO.CNTR_TPSZ_CD
				   AND TRO.BKG_NO = DGSEQ.BKG_NO
				   AND TRO.IO_BND_CD = DGSEQ.IO_BND_CD
				   AND TRO.TRO_SEQ = DGSEQ.TRO_SEQ
				   AND SVC.TRSP_SO_OFC_CTY_CD = @[trsp_so_ofc_cty_cd]
				   AND SVC.TRSP_SO_SEQ = @[trsp_so_seq]
				   AND ROWNUM = 1) X
		 WHERE SO.BKG_NO = B.BKG_NO
		   AND SO.BKG_NO = C.BKG_NO(+)
		   AND SO.EQ_NO = C.CNTR_NO(+)
		   AND C.PCK_TP_CD = D.PCK_CD(+)
		   AND D.DELT_FLG(+) = 'N'
		   AND B.CMDT_CD = F.CMDT_CD(+)
		   AND SO.TRSP_SO_OFC_CTY_CD = X.TRSP_SO_OFC_CTY_CD(+)
		   AND SO.TRSP_SO_SEQ = X.TRSP_SO_SEQ(+)
		   AND SO.TRSP_SO_OFC_CTY_CD = @[trsp_so_ofc_cty_cd]
		   AND SO.TRSP_SO_SEQ = @[trsp_so_seq]
	#else
		SELECT SO.BKG_NO
			  ,SO.EQ_NO AS CNTR_NO
			  ,SO.EQ_TPSZ_CD AS CNTR_TPSZ
			  ,'' AS EQ_COMMENT
			  ,'' AS FUMIGATE
			  ,'' AS TRIAXLE
			  ,'' CMDD
			  ,CASE WHEN NVL(X.CNTR_TYPE, 'X') != 'X' THEN X.CNTR_TYPE END CNTR_TYPE
			  ,'' AS HS_CD
			  ,'' AS PKG_QTY
			  ,'' AS PKG_CD
			  ,'' AS PKG_TYPE
			  ,SO.TRSP_SO_OFC_CTY_CD
			  ,SO.TRSP_SO_SEQ
		  FROM TRS_TRSP_SVC_ORD SO     
			  ,(SELECT NVL(TRIM(DECODE(SIGN(TRO.RC_SEQ), 1, 'Reefer ') || DECODE(SIGN(TRO.AWK_CGO_SEQ), 1, 'Awkward ') || DECODE(SIGN(DGSEQ.DCGO_SEQ), 1, 'Dangerous')), 'General') CNTR_TYPE
					  ,SVC.TRSP_SO_OFC_CTY_CD
					  ,SVC.TRSP_SO_SEQ
				  FROM TRS_TRSP_SVC_ORD   SVC
					  ,BKG_EUR_TRO        TRO
					  ,BKG_EUR_TRO_DG_SEQ DGSEQ
				 WHERE SVC.BKG_NO = TRO.BKG_NO
				   AND SVC.TRSP_BND_CD = TRO.IO_BND_CD
				   AND SVC.TRO_SEQ = TRO.TRO_SEQ
				   AND SVC.TRO_SUB_SEQ = TRO.RQST_SUB_SEQ
				   AND SVC.EQ_TPSZ_CD = TRO.CNTR_TPSZ_CD
				   AND TRO.BKG_NO = DGSEQ.BKG_NO
				   AND TRO.IO_BND_CD = DGSEQ.IO_BND_CD
				   AND TRO.TRO_SEQ = DGSEQ.TRO_SEQ
				   AND SVC.TRSP_SO_OFC_CTY_CD = @[trsp_so_ofc_cty_cd]
				   AND SVC.TRSP_SO_SEQ = @[trsp_so_seq]
				   AND ROWNUM = 1) X
		 WHERE SO.TRSP_SO_OFC_CTY_CD = X.TRSP_SO_OFC_CTY_CD(+)
		   AND SO.TRSP_SO_SEQ = X.TRSP_SO_SEQ(+)
		   AND SO.TRSP_SO_OFC_CTY_CD = @[trsp_so_ofc_cty_cd]
		   AND SO.TRSP_SO_SEQ = @[trsp_so_seq]	
	#end
 ) T1
 RIGHT OUTER JOIN DUAL
    ON 1 = 1
			]]></sql>
			<params>
				<param name="trsp_so_ofc_cty_cd" type="12" value="" out="N"/>
				<param name="trsp_so_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
