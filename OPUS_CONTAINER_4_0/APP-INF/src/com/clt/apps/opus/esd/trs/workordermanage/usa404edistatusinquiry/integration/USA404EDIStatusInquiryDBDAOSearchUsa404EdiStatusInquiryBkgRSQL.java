/*=========================================================
*Copyright(c) 2017 CyberLogitec
*@FileName : USA404EDIStatusInquiryDBDAOSearchUsa404EdiStatusInquiryBkgRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2017.01.12
*@LastModifier : 박찬우
*@LastVersion : 1.0
* 2017.01.12 박찬우
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.esd.trs.workordermanage.usa404edistatusinquiry.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author Chanwoo Park
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class USA404EDIStatusInquiryDBDAOSearchUsa404EdiStatusInquiryBkgRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * BKG으로 404 Edi 대상 조회 SQL
	  * </pre>
	  */
	public USA404EDIStatusInquiryDBDAOSearchUsa404EdiStatusInquiryBkgRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("unplanned",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("status",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pod_n",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("svcProvid",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ctrlOfcCd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("toDate",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("edKind",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("toNode",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("frmNode",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("frmDate",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fuEmpy",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("railRoad",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("bound",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.esd.trs.workordermanage.usa404edistatusinquiry.integration").append("\n"); 
		query.append("FileName : USA404EDIStatusInquiryDBDAOSearchUsa404EdiStatusInquiryBkgRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT  /*+ ORDERED USE_HASH(M) USE_NL(S T) */  M.INV_NO," ).append("\n"); 
		query.append("    M.LASTCHK," ).append("\n"); 
		query.append("    M.COP_NO, " ).append("\n"); 
		query.append("    M.COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("    M.SUB_RAIL_SEQ," ).append("\n"); 
		query.append("    M.VNDR_SEQ," ).append("\n"); 
		query.append("   (SELECT USA_EDI_CD FROM MDM_VENDOR WHERE VNDR_SEQ = M.VNDR_SEQ AND DELT_FLG = 'N') USA_EDI_CD," ).append("\n"); 
		query.append("    CASE WHEN M.BIL_ISS_STS_CD = 'I'  THEN DECODE(SIGN((SELECT COUNT(*) FROM TRS_EXPT_ACK_RAIL_VNDR WHERE VNDR_SEQ = M.VNDR_SEQ AND DELT_FLG = 'N')), 1, 'Y', 'N') " ).append("\n"); 
		query.append("         ELSE 'N'" ).append("\n"); 
		query.append("    END EXPT_ACK_VNDR_FLG," ).append("\n"); 
		query.append("   (SELECT USA_EDI_CD FROM MDM_VENDOR WHERE VNDR_SEQ = M.VNDR_SEQ AND DELT_FLG = 'N') USA_EDI_CD," ).append("\n"); 
		query.append("    M.TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("    M.TRSP_SO_SEQ," ).append("\n"); 
		query.append("    '' CHK1," ).append("\n"); 
		query.append("    '' CHK2," ).append("\n"); 
		query.append("    '' CHK3," ).append("\n"); 
		query.append("	'' CHK4," ).append("\n"); 
		query.append("    '' CHK5," ).append("\n"); 
		query.append("    M.WO_RJCT_RSN," ).append("\n"); 
		query.append("    M.CXL_RQST_FLG," ).append("\n"); 
		query.append("    M.REPO_PLN_ID," ).append("\n"); 
		query.append("    M.PLN_YRWK," ).append("\n"); 
		query.append("    M.REF_ID," ).append("\n"); 
		query.append("    M.REF_SEQ," ).append("\n"); 
		query.append("    M.RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("    (SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD00126' AND INTG_CD_VAL_CTNT = M.RAIL_CMB_THRU_TP_CD) RAIL_CMB_THRU_TP_NM," ).append("\n"); 
		query.append("    M.CRE_OFC_CD," ).append("\n"); 
		query.append("    M.BKG_CGO_TP_CD," ).append("\n"); 
		query.append("    M.TRSP_SO_STS_CD," ).append("\n"); 
		query.append("    M.STATUS AS TRSP_SO_STS_CD_NM," ).append("\n"); 
		query.append("    M.TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("    M.EQ_NO," ).append("\n"); 
		query.append("    M.EQ_TPSZ_CD," ).append("\n"); 
		query.append("    M.CGO_TP_CD," ).append("\n"); 
		query.append("    M.CRE_DT," ).append("\n"); 
		query.append("    M.CRE_DT_HMS," ).append("\n"); 
		query.append("    M.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("    M.FM_NOD_CD," ).append("\n"); 
		query.append("    M.FM_NOD_YARD," ).append("\n"); 
		query.append("    M.TO_NOD_CD," ).append("\n"); 
		query.append("    M.TO_NOD_YARD," ).append("\n"); 
		query.append("    M.VNDR_ABBR_NM," ).append("\n"); 
		query.append("    M.BL_NO," ).append("\n"); 
		query.append("    M.BKG_NO," ).append("\n"); 
		query.append("    M.BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("    M.BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("    M.BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("    M.BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("    M.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("    M.BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("    M.BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("    (CASE WHEN M.WAYBILL_NO IS NOT NULL THEN M.WAYBILL_NO" ).append("\n"); 
		query.append("          ELSE (" ).append("\n"); 
		query.append("		SELECT P1.WBL_NO" ).append("\n"); 
		query.append("		  FROM (SELECT CT.BKG_NO" ).append("\n"); 
		query.append("					  ,CT.CNTR_NO" ).append("\n"); 
		query.append("					  ,CT.EVNT_YD_CD" ).append("\n"); 
		query.append("					  ,CT.WBL_NO" ).append("\n"); 
		query.append("					  ,ROW_NUMBER() OVER(partition BY CT.BKG_NO, CT.CNTR_NO, CT.EVNT_YD_CD order by MVMT_EDI_TP_CD desc, MVMT_EDI_MSG_TP_ID desc, MVMT_EDI_MSG_AREA_CD desc, MVMT_EDI_MSG_YRMONDY desc, MVMT_EDI_MSG_SEQ desc) RK" ).append("\n"); 
		query.append("				  FROM CTM_MVMT_EDI_MSG CT" ).append("\n"); 
		query.append("				 WHERE 1 = 1" ).append("\n"); 
		query.append("				   AND CT.WBL_NO > ' '" ).append("\n"); 
		query.append("				   AND CT.MVMT_EDI_RSLT_CD > ' ') P1" ).append("\n"); 
		query.append("		 WHERE P1.BKG_NO = M.BKG_NO" ).append("\n"); 
		query.append("		   AND P1.CNTR_NO = M.EQ_NO" ).append("\n"); 
		query.append("		   AND P1.EVNT_YD_CD = M.FM_NOD_CD || M.FM_NOD_YARD" ).append("\n"); 
		query.append("		   AND P1.RK = 1" ).append("\n"); 
		query.append("		   AND ROWNUM = 1" ).append("\n"); 
		query.append("		)" ).append("\n"); 
		query.append("     END) WAYBILL_NO,      " ).append("\n"); 
		query.append("    M.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("    M.MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("    SUBSTR(M.BKG_SPE, 0, LENGTH(M.BKG_SPE)-1) AS BKG_SPE," ).append("\n"); 
		query.append("    M.SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("    M.MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("    M.CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("    M.CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("    M.PROV_VNDR_SEQ," ).append("\n"); 
		query.append("    M.CXL_RQST_DT," ).append("\n"); 
		query.append("    M.CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("    M.STATUS_NM," ).append("\n"); 
		query.append("    M.CXL_RQST_RSN," ).append("\n"); 
		query.append("    M.CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("    M.CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("    M.CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("    MAX(DECODE(M.CGO_TP_CD, 'M', M.INTER_RMK, 'F', DECODE(M.INTER_RMK_CHK, '', '', 'Y'))) AS INTER_RMK," ).append("\n"); 
		query.append("    CASE WHEN MAX(M.CGO_TP_CD) = 'F' THEN '1' ELSE '0' END POP_IMG," ).append("\n"); 
		query.append("    M.SPCL_INSTR_RMK," ).append("\n"); 
		query.append("    M.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("    TO_CHAR(M.CCREDT, 'YYYYMMDDHH24MISS') AS CCREDT," ).append("\n"); 
		query.append("    M.BIL_ISS_KNT," ).append("\n"); 
		query.append("    CASE WHEN LENGTH(S.EDI_RCV_VNDR_ABBR_NM) > 0 OR LENGTH(T.EDI_RCV_VNDR_ABBR_NM) > 0 THEN 'Y' END AS MTC_EDI_IND_CD," ).append("\n"); 
		query.append("    M.SLAN_CD," ).append("\n"); 
		query.append("    M.TRUNKVVD," ).append("\n"); 
		query.append("    REGEXP_SUBSTR( CNTR_WGT_STR, '[^|]+', 1, 1) CNTR_WGT," ).append("\n"); 
		query.append("    REGEXP_SUBSTR( CNTR_WGT_STR, '[^|]+', 1, 2) TARE_WGT," ).append("\n"); 
		query.append("    REGEXP_SUBSTR( CNTR_WGT_STR, '[^|]+', 1, 3) GROSS_WGT," ).append("\n"); 
		query.append("    REGEXP_SUBSTR( CNTR_WGT_STR, '[^|]+', 1, 4) VGM_WGT," ).append("\n"); 
		query.append("    M.IBD_NO," ).append("\n"); 
		query.append("    M.RAIL_CRR_REF_NO," ).append("\n"); 
		query.append("    M.SHPR_CUST_NM," ).append("\n"); 
		query.append("    M.CNEE_CUST_NM," ).append("\n"); 
		query.append("    M.EDI_USR_ID," ).append("\n"); 
		query.append("    M.TRSP_FRST_FLG," ).append("\n"); 
		query.append("    M.CMDT_NAME," ).append("\n"); 
		query.append("    M.REF_NO," ).append("\n"); 
		query.append("    M.AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("    M.AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("    M.BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("    M.IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("    M.TRSP_BND_CD," ).append("\n"); 
		query.append("    MAX(M.CURR_CD) CURR_CD," ).append("\n"); 
		query.append("    (SUM(NVL(M.BZC_AMT,0)) + SUM(NVL(M.FUEL_SCG_AMT,0)) + SUM(NVL(M.OVR_WGT_SCG_AMT,0)) + SUM(NVL(M.HZD_MTRL_SCG_AMT,0)) + SUM(NVL(M.ETC_ADD_AMT,0))) TOT_AMT," ).append("\n"); 
		query.append("    SUM(NVL(M.BZC_AMT,0)) BZC_AMT," ).append("\n"); 
		query.append("    (SUM(NVL(M.FUEL_SCG_AMT,0)) + SUM(NVL(M.OVR_WGT_SCG_AMT,0)) + SUM(NVL(M.HZD_MTRL_SCG_AMT,0)) + SUM(NVL(M.ETC_ADD_AMT,0))) SCG_AMT," ).append("\n"); 
		query.append("    SUM(NVL(M.FUEL_SCG_AMT,0)) FUEL_SCG_AMT," ).append("\n"); 
		query.append("    SUM(NVL(M.OVR_WGT_SCG_AMT,0)) OVR_WGT_SCG_AMT," ).append("\n"); 
		query.append("    SUM(NVL(M.HZD_MTRL_SCG_AMT,0)) HZD_MTRL_SCG_AMT," ).append("\n"); 
		query.append("    SUM(NVL(M.ETC_ADD_AMT,0)) ETC_ADD_AMT," ).append("\n"); 
		query.append("    MAX(M.TRSP_AGMT_OFC_CTY_CD) TRSP_AGMT_OFC_CTY_CD," ).append("\n"); 
		query.append("    MAX(M.TRSP_AGMT_SEQ) TRSP_AGMT_SEQ," ).append("\n"); 
		query.append("    NVL((SELECT 'Y' FROM TRS_TRSP_RAIL_BIL_VNDR_SET TT WHERE TT.TRSP_SO_OFC_CTY_CD = M.TRSP_SO_OFC_CTY_CD AND TT.TRSP_SO_SEQ = M.TRSP_SO_SEQ AND TT.INV_NO IS NOT NULL AND ROWNUM = 1), 'N') INV_FLG," ).append("\n"); 
		query.append("    M.DELT_FLG," ).append("\n"); 
		query.append("    DECODE(MAX(M.CND_CSTMS_CLR_FLG), 'Y', '1', '0') CND_CSTMS_CLR_FLG," ).append("\n"); 
		query.append("    MAX(M.UPLN_SO_FLG) UPLN_SO_FLG," ).append("\n"); 
		query.append("    (SELECT BB.RAIL_BLK_CD FROM BKG_BOOKING BB WHERE BB.BKG_NO = M.BKG_NO) RAIL_BLK_CD," ).append("\n"); 
		query.append("    M.POR_NOD_CD," ).append("\n"); 
		query.append("    M.POL_NOD_CD," ).append("\n"); 
		query.append("    M.POD_NOD_CD," ).append("\n"); 
		query.append("    M.DEL_NOD_CD," ).append("\n"); 
		query.append("    M.DEL_SCC_CD," ).append("\n"); 
		query.append("    M.STCC_CD," ).append("\n"); 
		query.append("    M.STCC_DESC," ).append("\n"); 
		query.append("    M.CNTR_SEAL_NO," ).append("\n"); 
		query.append("    CASE  WHEN SUBSTR(RAIL_CMB_THRU_TP_CD, 2, 1) IN ('2', '3') AND  SUBSTR(RAIL_CMB_THRU_TP_CD, 1, 1) <> 'S' THEN SUBSTR(M.INTERCHANGE_1, 1, 5) END INTERCHANGE1_LOC," ).append("\n"); 
		query.append("    CASE  WHEN SUBSTR(RAIL_CMB_THRU_TP_CD, 2, 1) IN ('2', '3') AND  SUBSTR(RAIL_CMB_THRU_TP_CD, 1, 1) <> 'S' THEN SUBSTR(M.INTERCHANGE_1, 6) END INTERCHANGE1_NOD," ).append("\n"); 
		query.append("    CASE  WHEN SUBSTR(RAIL_CMB_THRU_TP_CD, 2, 1) = '3' AND  SUBSTR(RAIL_CMB_THRU_TP_CD, 1, 1) <> 'S' THEN SUBSTR(M.INTERCHANGE_2, 1, 5) END INTERCHANGE2_LOC," ).append("\n"); 
		query.append("    CASE  WHEN SUBSTR(RAIL_CMB_THRU_TP_CD, 2, 1) = '3' AND  SUBSTR(RAIL_CMB_THRU_TP_CD, 1, 1) <> 'S' THEN SUBSTR(M.INTERCHANGE_2, 6) END INTERCHANGE2_NOD," ).append("\n"); 
		query.append("    (SELECT DECODE(YD_CHR_CD, 'N', 'ON DOCK', 'F', 'OFF DOCK', '') FROM MDM_YARD WHERE YD_CD = DECODE(M.TRSP_BND_CD, 'I', M.FM_NOD_CD||M.FM_NOD_YARD, M.TO_NOD_CD||M.TO_NOD_YARD)) YD_CHR_CD" ).append("\n"); 
		query.append("FROM " ).append("\n"); 
		query.append("    (" ).append("\n"); 
		query.append("        SELECT " ).append("\n"); 
		query.append("            X.LASTCHK," ).append("\n"); 
		query.append("            X.INV_NO," ).append("\n"); 
		query.append("            X.CXL_RQST_FLG," ).append("\n"); 
		query.append("            X.COP_NO," ).append("\n"); 
		query.append("            X.COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("            X.SUB_RAIL_SEQ," ).append("\n"); 
		query.append("            X.VNDR_SEQ," ).append("\n"); 
		query.append("            X.BIL_ISS_KNT," ).append("\n"); 
		query.append("            X.TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("            X.TRSP_SO_SEQ," ).append("\n"); 
		query.append("            X.REPO_PLN_ID," ).append("\n"); 
		query.append("            X.PLN_YRWK," ).append("\n"); 
		query.append("            X.REF_ID," ).append("\n"); 
		query.append("            X.REF_SEQ," ).append("\n"); 
		query.append("            X.RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("            X.CRE_OFC_CD," ).append("\n"); 
		query.append("            X.BKG_CGO_TP_CD," ).append("\n"); 
		query.append("            X.TRSP_SO_STS_CD," ).append("\n"); 
		query.append("			X.STATUS," ).append("\n"); 
		query.append("            X.TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("            X.EQ_NO," ).append("\n"); 
		query.append("            X.EQ_TPSZ_CD," ).append("\n"); 
		query.append("            X.CGO_TP_CD," ).append("\n"); 
		query.append("            X.CRE_DT," ).append("\n"); 
		query.append("            X.CRE_DT_HMS," ).append("\n"); 
		query.append("            X.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("            X.FM_NOD_CD," ).append("\n"); 
		query.append("            X.FM_NOD_YARD," ).append("\n"); 
		query.append("            X.TO_NOD_CD," ).append("\n"); 
		query.append("            X.TO_NOD_YARD," ).append("\n"); 
		query.append("            X.VNDR_ABBR_NM," ).append("\n"); 
		query.append("            X.BL_NO," ).append("\n"); 
		query.append("            X.BKG_NO," ).append("\n"); 
		query.append("            X.BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("            X.BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("            CASE WHEN X.BIL_EDI_RSNT_DT = '20000101' THEN '' ELSE X.BIL_EDI_RSNT_DT END BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("            CASE WHEN X.BIL_EDI_RSNT_DT = '20000101' THEN '' ELSE X.BIL_EDI_RSNT_DT_HMS END BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("            X.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("            X.BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("            X.BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("            X.WAYBILL_NO," ).append("\n"); 
		query.append("            X.MTC_EDI_IND_CD," ).append("\n"); 
		query.append("            X.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("            X.MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("            X.MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("            X.CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("            X.CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("            X.PROV_VNDR_SEQ," ).append("\n"); 
		query.append("            X.CXL_RQST_DT," ).append("\n"); 
		query.append("            X.CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("            X.STATUS_NM," ).append("\n"); 
		query.append("            X.CXL_RQST_RSN," ).append("\n"); 
		query.append("            X.CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("            X.CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("            X.CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("            X.INTER_RMK," ).append("\n"); 
		query.append("            (SELECT MAX(RMK.BKG_NO)" ).append("\n"); 
		query.append("               FROM TRS_INTER_RMK RMK" ).append("\n"); 
		query.append("              WHERE RMK.BKG_NO IN(X.BKG_NO, 'DUM000000000')" ).append("\n"); 
		query.append("                AND NVL(RMK.EQ_NO, 'X') = NVL2(RMK.EQ_NO, X.EQ_NO, 'X')" ).append("\n"); 
		query.append("                AND NVL(RMK.TRSP_SO_OFC_CTY_CD, 'XX') = NVL2(RMK.TRSP_SO_OFC_CTY_CD, X.TRSP_SO_OFC_CTY_CD, 'XX')" ).append("\n"); 
		query.append("                AND NVL(RMK.TRSP_SO_SEQ, '99999') = NVL2(RMK.TRSP_SO_SEQ, X.TRSP_SO_SEQ, '99999')" ).append("\n"); 
		query.append("                AND NVL(RMK.DELT_FLG, 'X') = 'N') AS INTER_RMK_CHK," ).append("\n"); 
		query.append("            X.SPCL_INSTR_RMK," ).append("\n"); 
		query.append("            X.SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("            X.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("            X.CCREDT," ).append("\n"); 
		query.append("            X.SLAN_CD," ).append("\n"); 
		query.append("            X.TRUNKVVD," ).append("\n"); 
		query.append("			(SELECT TRS_GET_COM_SO_RAIL_WGT_FNC('R', X.TRSP_SO_OFC_CTY_CD, X.TRSP_SO_SEQ, NULL, X.BKG_NO, X.EQ_NO, X.EQ_TPSZ_CD, 'LBS', X.COP_NO, 'N') FROM DUAL) CNTR_WGT_STR,  " ).append("\n"); 
		query.append("            NVL(X.IBD_NO, X.CSTMS_IBD_NO) AS IBD_NO," ).append("\n"); 
		query.append("            X.RAIL_CRR_REF_NO," ).append("\n"); 
		query.append("            X.SHPR_CUST_NM," ).append("\n"); 
		query.append("            X.CNEE_CUST_NM," ).append("\n"); 
		query.append("            X.EDI_USR_ID," ).append("\n"); 
		query.append("            X.TRSP_FRST_FLG," ).append("\n"); 
		query.append("            X.WO_RJCT_RSN," ).append("\n"); 
		query.append("            X.REF_NO," ).append("\n"); 
		query.append("            X.BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("            X.IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("			X.POR_NOD_CD," ).append("\n"); 
		query.append("            X.POL_NOD_CD," ).append("\n"); 
		query.append("			X.POD_NOD_CD," ).append("\n"); 
		query.append("			X.DEL_NOD_CD," ).append("\n"); 
		query.append("			X.DEL_SCC_CD," ).append("\n"); 
		query.append("			X.STCC_CD," ).append("\n"); 
		query.append("			X.STCC_DESC," ).append("\n"); 
		query.append("			X.CNTR_SEAL_NO," ).append("\n"); 
		query.append("            X.TRSP_BND_CD," ).append("\n"); 
		query.append("            X.AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("            X.AUTO_XPT_SYS_NO" ).append("\n"); 
		query.append("            ,(" ).append("\n"); 
		query.append("                SELECT REPLACE(MDM_CO.CMDT_NM, CHR(13)||CHR(10), ' ') AS CMDT_NAME" ).append("\n"); 
		query.append("                  FROM MDM_COMMODITY MDM_CO," ).append("\n"); 
		query.append("                       BKG_BOOKING B" ).append("\n"); 
		query.append("                 WHERE X.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                   AND B.CMDT_CD = MDM_CO.CMDT_CD" ).append("\n"); 
		query.append("            ) CMDT_NAME" ).append("\n"); 
		query.append("            ,(" ).append("\n"); 
		query.append("                SELECT DECODE( BK.DCGO_FLG , 'Y', 'DG /') || " ).append("\n"); 
		query.append("                       DECODE( BK.RC_FLG , 'Y', 'RF /') || " ).append("\n"); 
		query.append("                       DECODE( BK.AWK_CGO_FLG , 'Y', 'AK /') || " ).append("\n"); 
		query.append("                       DECODE( BK.BB_CGO_FLG , 'Y', 'BB /') || " ).append("\n"); 
		query.append("                       DECODE( BK.SPCL_HIDE_FLG , 'Y', 'HD /') || " ).append("\n"); 
		query.append("                       DECODE( BK.FD_GRD_FLG , 'Y', 'FG /') || " ).append("\n"); 
		query.append("                       DECODE( BK.RAIL_BLK_CD, '', '', 'RB /') AS BKG_SPE" ).append("\n"); 
		query.append("                  FROM BKG_BOOKING BK" ).append("\n"); 
		query.append("                 WHERE X.BKG_NO = BK.BKG_NO" ).append("\n"); 
		query.append("            ) BKG_SPE," ).append("\n"); 
		query.append("            X.CURR_CD," ).append("\n"); 
		query.append("            X.BZC_AMT," ).append("\n"); 
		query.append("            X.FUEL_SCG_AMT," ).append("\n"); 
		query.append("            X.OVR_WGT_SCG_AMT," ).append("\n"); 
		query.append("            X.HZD_MTRL_SCG_AMT," ).append("\n"); 
		query.append("            X.ETC_ADD_AMT," ).append("\n"); 
		query.append("            X.TRSP_AGMT_OFC_CTY_CD," ).append("\n"); 
		query.append("            X.TRSP_AGMT_SEQ," ).append("\n"); 
		query.append("            X.DELT_FLG," ).append("\n"); 
		query.append("			X.CND_CSTMS_CLR_FLG," ).append("\n"); 
		query.append("			X.UPLN_SO_FLG," ).append("\n"); 
		query.append("            X.INTERCHANGE_1," ).append("\n"); 
		query.append("            X.INTERCHANGE_2" ).append("\n"); 
		query.append("        FROM    " ).append("\n"); 
		query.append("            (" ).append("\n"); 
		query.append("                SELECT /*+ ORDERED USE_NL(A, B, C, CR, CFM, AGMT, BC, D) */" ).append("\n"); 
		query.append("                    DECODE(C.BIL_ISS_KNT, A.BIL_ISS_KNT, 'Y', NULL , 'Y' ) AS LASTCHK," ).append("\n"); 
		query.append("                    MAX(B.INV_NO) AS INV_NO," ).append("\n"); 
		query.append("                    A.CXL_RQST_FLG AS CXL_RQST_FLG," ).append("\n"); 
		query.append("                    A.COP_NO AS COP_NO," ).append("\n"); 
		query.append("                    A.COST_ACT_GRP_SEQ AS COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("                    MIN(B.SUB_RAIL_SEQ) AS SUB_RAIL_SEQ," ).append("\n"); 
		query.append("                    MAX(DECODE(B.SUB_RAIL_SEQ, 1, B.VNDR_SEQ)) AS VNDR_SEQ," ).append("\n"); 
		query.append("                    C.BIL_ISS_KNT AS BIL_ISS_KNT," ).append("\n"); 
		query.append("                    A.TRSP_SO_OFC_CTY_CD AS TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("                    A.TRSP_SO_SEQ AS TRSP_SO_SEQ," ).append("\n"); 
		query.append("                    A.REPO_PLN_ID AS REPO_PLN_ID," ).append("\n"); 
		query.append("                    A.PLN_YRWK AS PLN_YRWK," ).append("\n"); 
		query.append("                    A.REF_ID AS REF_ID," ).append("\n"); 
		query.append("                    A.REF_SEQ AS REF_SEQ," ).append("\n"); 
		query.append("                    A.RAIL_CMB_THRU_TP_CD AS RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("                    A.CRE_OFC_CD AS CRE_OFC_CD," ).append("\n"); 
		query.append("                    MAX(A.BKG_CGO_TP_CD) AS BKG_CGO_TP_CD," ).append("\n"); 
		query.append("					MAX(A.TRSP_SO_STS_CD) TRSP_SO_STS_CD," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_SO_STS_CD , 'C', 'S/O Created' , 'R', 'S/O Corrected' , 'I', 'EDI Sent' , '') ) AS STATUS," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_RAIL_BIL_TP_CD , 'W', 'WRS' , 'OPUS')) AS TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("                    MAX(A.EQ_NO) AS EQ_NO," ).append("\n"); 
		query.append("                    MAX(A.EQ_TPSZ_CD) AS EQ_TPSZ_CD," ).append("\n"); 
		query.append("                    MAX(A.CGO_TP_CD) AS CGO_TP_CD," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'YYYYMMDD')) AS CRE_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'HH24MISS')) AS CRE_DT_HMS," ).append("\n"); 
		query.append("                    C.BIL_ISS_STS_CD AS BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 1, 5)) AS FM_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 6)) AS FM_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 1, 5)) AS TO_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 6)) AS TO_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(DECODE(B.SUB_RAIL_SEQ, 1, D.VNDR_ABBR_NM)) AS VNDR_ABBR_NM," ).append("\n"); 
		query.append("                    MAX(A.BL_NO) AS BL_NO," ).append("\n"); 
		query.append("                    DECODE(A.BIL_ISS_STS_CD , 'I', C.BKG_NO , A.BKG_NO) AS BKG_NO," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_SNT_DT, 'YYYYMMDD') AS BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_SNT_DT, 'HH24MISS') AS BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                            ) , 'YYYYMMDD'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                            ) , 'HH24MISS'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("                    C.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'YYYYMMDD') AS BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'HH24MISS') AS BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    C.WBL_NO AS WAYBILL_NO," ).append("\n"); 
		query.append("                    C.MTC_EDI_IND_CD," ).append("\n"); 
		query.append("                    C.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("                    TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'YYYYMMDD') AS MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'HH24MISS') AS MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'YYYYMMDD')) AS CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'HH24MISS')) AS CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(A.PROV_VNDR_SEQ) AS PROV_VNDR_SEQ," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'YYYYMMDD')) AS CXL_RQST_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'HH24MISS')) AS CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("                    MAX(CASE WHEN A.CXL_RQST_FLG = 'N' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'Y' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested Rejected'" ).append("\n"); 
		query.append("                             WHEN A.CXL_RQST_FLG = 'Y' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'N' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'E' THEN 'EDI Error'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'V' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' AND C.BIL_ISS_STS_CD = 'X' THEN 'Rail Billing Cancelled'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Rail Billed'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'C' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'R' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                    END) STATUS_NM," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_RSN) AS CXL_RQST_RSN," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'YYYYMMDD')) AS CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'HH24MISS')) AS CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.CXL_RQST_RJCT_RSN) AS CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("                    NVL(C.INTER_RMK, A.INTER_RMK) AS INTER_RMK," ).append("\n"); 
		query.append("                    NVL(C.SPCL_INSTR_RMK, A.SPCL_INSTR_RMK) SPCL_INSTR_RMK," ).append("\n"); 
		query.append("                    MAX(A.SPCL_CGO_CNTR_TP_CD) AS SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("                    C.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("                    C.LOCL_CRE_DT AS CCREDT," ).append("\n"); 
		query.append("                    MAX(A.SLAN_CD) AS SLAN_CD," ).append("\n"); 
		query.append("                    MAX((A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD)) AS TRUNKVVD," ).append("\n"); 
		query.append("                    MAX(A.IBD_NO) AS IBD_NO," ).append("\n"); 
		query.append("                    MAX((SELECT NVL(CSTMS_IBD.IBD_TRSP_NO, ' ')" ).append("\n"); 
		query.append("                           FROM BKG_CSTMS_ADV_IBD CSTMS_IBD" ).append("\n"); 
		query.append("                          WHERE CSTMS_IBD.BL_NO = A.BL_NO" ).append("\n"); 
		query.append("                            AND CSTMS_IBD.CNT_CD = 'US')) CSTMS_IBD_NO," ).append("\n"); 
		query.append("                    MAX(A.RAIL_CRR_REF_NO) AS RAIL_CRR_REF_NO," ).append("\n"); 
		query.append("                    MAX(A.SHPR_CUST_NM) AS SHPR_CUST_NM," ).append("\n"); 
		query.append("                    MAX(A.CNEE_CUST_NM) AS CNEE_CUST_NM," ).append("\n"); 
		query.append("                    C.CRE_USR_ID AS EDI_USR_ID," ).append("\n"); 
		query.append("                    MAX(A.TRSP_FRST_FLG) AS TRSP_FRST_FLG," ).append("\n"); 
		query.append("                    C.WO_RJCT_RSN," ).append("\n"); 
		query.append("                    MAX(DECODE(B.SUB_RAIL_SEQ, 1, AGMT.AGMT_REF_NO) || DECODE(B.TO_NOD_CD, NULL, '' , A.TO_NOD_CD, '', ' / ') ) || " ).append("\n"); 
		query.append("                    MAX( DECODE(B.SUB_RAIL_SEQ, 2 , AGMT.AGMT_REF_NO) || DECODE(B.TO_NOD_CD, NULL, '' , A.TO_NOD_CD, '', ' / ') ) || " ).append("\n"); 
		query.append("                    MAX( DECODE(B.SUB_RAIL_SEQ, 3 , AGMT.AGMT_REF_NO)) AS REF_NO," ).append("\n"); 
		query.append("                    MAX(DECODE(A.CGO_TP_CD, 'M', NULL, DECODE(BC.CNTR_NO, NULL , 'N', 'Y'))) AS BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("                    MAX(A.IBD_CSTMS_CLR_LOC_CD) AS IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("					MAX(A.POR_NOD_CD) AS POR_NOD_CD," ).append("\n"); 
		query.append("                    MAX(A.POL_NOD_CD) AS POL_NOD_CD," ).append("\n"); 
		query.append("                    MAX(A.POD_NOD_CD) AS POD_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.DEL_NOD_CD) AS DEL_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.DEL_SCC_CD) AS DEL_SCC_CD," ).append("\n"); 
		query.append("					MAX(A.STCC_CD) AS STCC_CD," ).append("\n"); 
		query.append("					MAX(A.STCC_DESC) AS STCC_DESC," ).append("\n"); 
		query.append("					MAX(A.CNTR_SEAL_NO) AS CNTR_SEAL_NO," ).append("\n"); 
		query.append("                    MAX(A.TRSP_BND_CD) AS TRSP_BND_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_CD AS AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_NO AS AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                    MAX(B.CURR_CD) CURR_CD," ).append("\n"); 
		query.append("                    SUM(B.BZC_AMT) BZC_AMT," ).append("\n"); 
		query.append("                    SUM(B.FUEL_SCG_AMT) FUEL_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.OVR_WGT_SCG_AMT) OVR_WGT_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.HZD_MTRL_SCG_AMT) HZD_MTRL_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.ETC_ADD_AMT) ETC_ADD_AMT," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_OFC_CTY_CD) TRSP_AGMT_OFC_CTY_CD," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_SEQ) TRSP_AGMT_SEQ," ).append("\n"); 
		query.append("                    MAX(A.DELT_FLG) DELT_FLG," ).append("\n"); 
		query.append("					MAX(A.CND_CSTMS_CLR_FLG) CND_CSTMS_CLR_FLG," ).append("\n"); 
		query.append("					MAX(A.UPLN_SO_FLG) UPLN_SO_FLG," ).append("\n"); 
		query.append("                    MAX(CASE WHEN B.SUB_RAIL_SEQ = 2 THEN B.FM_NOD_CD ELSE '' END) AS INTERCHANGE_1," ).append("\n"); 
		query.append("                    MAX(CASE WHEN B.SUB_RAIL_SEQ = 3 THEN B.FM_NOD_CD ELSE '' END) AS INTERCHANGE_2" ).append("\n"); 
		query.append("                FROM " ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_ORD A," ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_VNDR_SET B," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD C," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD_RSND CR," ).append("\n"); 
		query.append("                    TRS_TRSP_CFM_MSG_HIS CFM," ).append("\n"); 
		query.append("                    TRS_AGMT_HDR AGMT," ).append("\n"); 
		query.append("                    BKG_CONTAINER BC," ).append("\n"); 
		query.append("                    MDM_VENDOR D" ).append("\n"); 
		query.append("                WHERE A.TRSP_SO_OFC_CTY_CD = B.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = B.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = C.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = C.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CR.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CR.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CFM.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CFM.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   B.TRSP_AGMT_OFC_CTY_CD = AGMT.TRSP_AGMT_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   B.TRSP_AGMT_SEQ = AGMT.TRSP_AGMT_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.BKG_NO = BC.BKG_NO (+)" ).append("\n"); 
		query.append("                AND   A.EQ_NO = BC.CNTR_NO (+)" ).append("\n"); 
		query.append("                AND   B.VNDR_SEQ = D.VNDR_SEQ" ).append("\n"); 
		query.append("                AND   A.RAIL_CMB_THRU_TP_CD IN ('C1T', 'C2T', 'C3T', 'C2R', 'C3R', 'C2C', 'C3S')" ).append("\n"); 
		query.append("                AND   A.CRE_OFC_CD IN (@[ctrlOfcCd], 'SYSTEM')" ).append("\n"); 
		query.append("#if(${incHistory} != \'H\')" ).append("\n"); 
		query.append("                AND   A.DELT_FLG = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                AND   NVL(A.SPND_FLG, 'N') = 'N'" ).append("\n"); 
		query.append("                AND   NVL(C.BKG_NO, '0000000000') = NVL(A.BKG_NO, '0000000000')" ).append("\n"); 
		query.append("                AND   A.BIL_ISS_STS_CD = 'I'" ).append("\n"); 
		query.append("#if($bkg.size() > 0)" ).append("\n"); 
		query.append("                AND   ( C.BKG_NO ) IN (" ).append("\n"); 
		query.append("          #foreach($key IN ${bkg})" ).append("\n"); 
		query.append("           #if($velocityCount == 1)" ).append("\n"); 
		query.append("            '$key'" ).append("\n"); 
		query.append("           #else" ).append("\n"); 
		query.append("            ,'$key' " ).append("\n"); 
		query.append("           #end" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($vvd.size() > 0)" ).append("\n"); 
		query.append(" AND ((A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append(" #foreach($key IN ${vvd})" ).append("\n"); 
		query.append("  #if($velocityCount == 1)      " ).append("\n"); 
		query.append("   ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("  #else" ).append("\n"); 
		query.append("   , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append(" )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($bl.size() > 0)" ).append("\n"); 
		query.append(" AND (A.BL_NO IN ( " ).append("\n"); 
		query.append("      #foreach($key IN ${bl})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($cntr.size() > 0)" ).append("\n"); 
		query.append(" AND A.EQ_NO IN (" ).append("\n"); 
		query.append("      #foreach($key IN ${cntr})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($ref_no.size() > 0)" ).append("\n"); 
		query.append(" AND A.REF_ID IN (" ).append("\n"); 
		query.append("      #foreach($key IN ${ref_no})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${frmDate} != \'\' && ${toDate} != \'\')" ).append("\n"); 
		query.append(" #if(${radDate} == \'DS\')" ).append("\n"); 
		query.append("  AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #elseif(${radDate} == \'DB\')" ).append("\n"); 
		query.append("  AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD')-21 AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("  AND C.BIL_EDI_SNT_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #elseif(${radDate} == \'DC\')" ).append("\n"); 
		query.append("  AND A.CXL_RQST_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${frmNode} != \'\')" ).append("\n"); 
		query.append(" AND A.FM_NOD_CD LIKE @[frmNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toNode} != \'\')" ).append("\n"); 
		query.append(" AND A.TO_NOD_CD LIKE @[toNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${radVendor} == \'V2\' && ${svcProvid} != \'\')" ).append("\n"); 
		query.append(" AND A.PROV_VNDR_SEQ = @[svcProvid]" ).append("\n"); 
		query.append("#elseif(${radVendor} == \'V1\' && ${railRoad} != \'ALL\')" ).append("\n"); 
		query.append("AND   EXISTS (SELECT 1 FROM TRS_TRSP_RAIL_BIL_VNDR_SET  V" ).append("\n"); 
		query.append("      WHERE V.TRSP_SO_OFC_CTY_CD = A.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("      AND V.TRSP_SO_SEQ = A.TRSP_SO_SEQ" ).append("\n"); 
		query.append("	  AND V.SUB_RAIL_SEQ = 1" ).append("\n"); 
		query.append("      AND V.VNDR_SEQ = @[railRoad]" ).append("\n"); 
		query.append("	  )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${status} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.TRSP_SO_STS_CD = @[status]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${edKind} != \'ALL\')" ).append("\n"); 
		query.append(" AND C.BIL_ISS_STS_CD = @[edKind]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${fuEmpy} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.CGO_TP_CD = @[fuEmpy]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${bound} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.TRSP_BND_CD = @[bound]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${bkgAtch} != \'ALL\')" ).append("\n"); 
		query.append(" #if(${bkgAtch} == \'N\')" ).append("\n"); 
		query.append("  AND BC.CNTR_NO IS NULL" ).append("\n"); 
		query.append("  AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append(" #elseif(${bkgAtch} == \'Y\')" ).append("\n"); 
		query.append("  AND BC.CNTR_NO IS NOT NULL" ).append("\n"); 
		query.append("  AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  AND DECODE(@[unplanned], 'ALL', 'X', NVL(A.UPLN_SO_FLG, 'N')) = DECODE(@[unplanned], 'ALL', 'X', @[unplanned])" ).append("\n"); 
		query.append("#if(${pod_n} != '')" ).append("\n"); 
		query.append("  AND A.POD_NOD_CD LIKE @[pod_n] || '%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${through} != \'ALL\')" ).append("\n"); 
		query.append("    #if(${through} == \'E\')" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD <> 'W'" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD = 'W'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                GROUP BY" ).append("\n"); 
		query.append("                    DECODE(C.BIL_ISS_KNT , A.BIL_ISS_KNT, 'Y' , NULL , 'Y' )," ).append("\n"); 
		query.append("                    A.CXL_RQST_FLG," ).append("\n"); 
		query.append("                    A.COP_NO," ).append("\n"); 
		query.append("                    A.COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("                    C.BIL_ISS_KNT," ).append("\n"); 
		query.append("                    A.TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("                    A.TRSP_SO_SEQ," ).append("\n"); 
		query.append("                    A.REPO_PLN_ID," ).append("\n"); 
		query.append("                    A.PLN_YRWK," ).append("\n"); 
		query.append("                    A.REF_ID," ).append("\n"); 
		query.append("                    A.REF_SEQ," ).append("\n"); 
		query.append("                    A.RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("                    A.CRE_OFC_CD," ).append("\n"); 
		query.append("                    A.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    C.BKG_NO," ).append("\n"); 
		query.append("                    A.BKG_NO," ).append("\n"); 
		query.append("                    C.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    C.BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("                    C.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("                    C.BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    C.MTC_EDI_IND_CD," ).append("\n"); 
		query.append("                    C.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("                    C.MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    NVL( C.INTER_RMK, A.INTER_RMK)," ).append("\n"); 
		query.append("                    NVL( C.SPCL_INSTR_RMK, A.SPCL_INSTR_RMK)," ).append("\n"); 
		query.append("                    C.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("                    C.LOCL_CRE_DT," ).append("\n"); 
		query.append("                    C.CRE_USR_ID," ).append("\n"); 
		query.append("                    C.WO_RJCT_RSN," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                    C.WBL_NO" ).append("\n"); 
		query.append("    UNION" ).append("\n"); 
		query.append("    SELECT /*+ ORDERED USE_NL(A, B, C, CR, CFM, AGMT, BC, D) */" ).append("\n"); 
		query.append("                    DECODE(C.BIL_ISS_KNT, A.BIL_ISS_KNT, 'Y', NULL , 'Y' ) AS LASTCHK," ).append("\n"); 
		query.append("                    MAX(B.INV_NO) AS INV_NO," ).append("\n"); 
		query.append("                    A.CXL_RQST_FLG AS CXL_RQST_FLG," ).append("\n"); 
		query.append("                    A.COP_NO AS COP_NO," ).append("\n"); 
		query.append("                    A.COST_ACT_GRP_SEQ AS COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("                    MIN(B.SUB_RAIL_SEQ) AS SUB_RAIL_SEQ," ).append("\n"); 
		query.append("                    MAX(DECODE(B.SUB_RAIL_SEQ, 1, B.VNDR_SEQ)) AS VNDR_SEQ," ).append("\n"); 
		query.append("                    C.BIL_ISS_KNT AS BIL_ISS_KNT," ).append("\n"); 
		query.append("                    A.TRSP_SO_OFC_CTY_CD AS TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("                    A.TRSP_SO_SEQ AS TRSP_SO_SEQ," ).append("\n"); 
		query.append("                    A.REPO_PLN_ID AS REPO_PLN_ID," ).append("\n"); 
		query.append("                    A.PLN_YRWK AS PLN_YRWK," ).append("\n"); 
		query.append("                    A.REF_ID AS REF_ID," ).append("\n"); 
		query.append("                    A.REF_SEQ AS REF_SEQ," ).append("\n"); 
		query.append("                    A.RAIL_CMB_THRU_TP_CD AS RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("                    A.CRE_OFC_CD AS CRE_OFC_CD," ).append("\n"); 
		query.append("                    MAX(A.BKG_CGO_TP_CD) AS BKG_CGO_TP_CD," ).append("\n"); 
		query.append("					MAX(A.TRSP_SO_STS_CD) AS TRSP_SO_STS_CD," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_SO_STS_CD , 'C', 'S/O Created' , 'R', 'S/O Corrected' , 'I', 'EDI Sent' , '') ) AS STATUS," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_RAIL_BIL_TP_CD , 'W', 'WRS' , 'OPUS')) AS TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("                    MAX(A.EQ_NO) AS EQ_NO," ).append("\n"); 
		query.append("                    MAX(A.EQ_TPSZ_CD) AS EQ_TPSZ_CD," ).append("\n"); 
		query.append("                    MAX(A.CGO_TP_CD) AS CGO_TP_CD," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'YYYYMMDD')) AS CRE_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'HH24MISS')) AS CRE_DT_HMS," ).append("\n"); 
		query.append("                    C.BIL_ISS_STS_CD AS BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 1, 5)) AS FM_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 6)) AS FM_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 1, 5)) AS TO_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 6)) AS TO_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(DECODE(B.SUB_RAIL_SEQ, 1, D.VNDR_ABBR_NM)) AS VNDR_ABBR_NM," ).append("\n"); 
		query.append("                    MAX(A.BL_NO) AS BL_NO," ).append("\n"); 
		query.append("                    DECODE(A.BIL_ISS_STS_CD , 'I', C.BKG_NO , A.BKG_NO) AS BKG_NO," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_SNT_DT, 'YYYYMMDD') AS BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_SNT_DT, 'HH24MISS') AS BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                            ) , 'YYYYMMDD'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                            ) , 'HH24MISS'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("                    C.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'YYYYMMDD') AS BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'HH24MISS') AS BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    C.WBL_NO AS WAYBILL_NO," ).append("\n"); 
		query.append("                    C.MTC_EDI_IND_CD," ).append("\n"); 
		query.append("                    C.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("                    TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'YYYYMMDD') AS MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'HH24MISS') AS MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'YYYYMMDD')) AS CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'HH24MISS')) AS CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(A.PROV_VNDR_SEQ) AS PROV_VNDR_SEQ," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'YYYYMMDD')) AS CXL_RQST_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'HH24MISS')) AS CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("                    MAX(CASE WHEN A.CXL_RQST_FLG = 'N' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'Y' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested Rejected'" ).append("\n"); 
		query.append("                             WHEN A.CXL_RQST_FLG = 'Y' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'N' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'E' THEN 'EDI Error'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'V' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' AND C.BIL_ISS_STS_CD = 'X' THEN 'Rail Billing Cancelled'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Rail Billed'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'C' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'R' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                    END) STATUS_NM," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_RSN) AS CXL_RQST_RSN," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'YYYYMMDD')) AS CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'HH24MISS')) AS CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.CXL_RQST_RJCT_RSN) AS CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("                    NVL(C.INTER_RMK, A.INTER_RMK) AS INTER_RMK," ).append("\n"); 
		query.append("                    NVL(C.SPCL_INSTR_RMK, A.SPCL_INSTR_RMK) SPCL_INSTR_RMK," ).append("\n"); 
		query.append("                    MAX(A.SPCL_CGO_CNTR_TP_CD) AS SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("                    C.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("                    C.LOCL_CRE_DT AS CCREDT," ).append("\n"); 
		query.append("                    MAX(A.SLAN_CD) AS SLAN_CD," ).append("\n"); 
		query.append("                    MAX((A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD)) AS TRUNKVVD," ).append("\n"); 
		query.append("                    MAX(A.IBD_NO) AS IBD_NO," ).append("\n"); 
		query.append("                    MAX((SELECT NVL(CSTMS_IBD.IBD_TRSP_NO, ' ')" ).append("\n"); 
		query.append("                           FROM BKG_CSTMS_ADV_IBD CSTMS_IBD" ).append("\n"); 
		query.append("                          WHERE CSTMS_IBD.BL_NO = A.BL_NO" ).append("\n"); 
		query.append("                            AND CSTMS_IBD.CNT_CD = 'US')) CSTMS_IBD_NO," ).append("\n"); 
		query.append("                    MAX(A.RAIL_CRR_REF_NO) AS RAIL_CRR_REF_NO," ).append("\n"); 
		query.append("                    MAX(A.SHPR_CUST_NM) AS SHPR_CUST_NM," ).append("\n"); 
		query.append("                    MAX(A.CNEE_CUST_NM) AS CNEE_CUST_NM," ).append("\n"); 
		query.append("                    C.CRE_USR_ID AS EDI_USR_ID," ).append("\n"); 
		query.append("                    MAX(A.TRSP_FRST_FLG) AS TRSP_FRST_FLG," ).append("\n"); 
		query.append("                    C.WO_RJCT_RSN," ).append("\n"); 
		query.append("                    MAX(DECODE(B.SUB_RAIL_SEQ, 1, AGMT.AGMT_REF_NO) || DECODE(B.TO_NOD_CD, NULL, '' , A.TO_NOD_CD, '', ' / ') ) || " ).append("\n"); 
		query.append("                    MAX( DECODE(B.SUB_RAIL_SEQ, 2 , AGMT.AGMT_REF_NO) || DECODE(B.TO_NOD_CD, NULL, '' , A.TO_NOD_CD, '', ' / ') ) || " ).append("\n"); 
		query.append("                    MAX( DECODE(B.SUB_RAIL_SEQ, 3 , AGMT.AGMT_REF_NO)) AS REF_NO," ).append("\n"); 
		query.append("                    MAX(DECODE(A.CGO_TP_CD, 'M', NULL, DECODE(BC.CNTR_NO, NULL , 'N', 'Y'))) AS BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("                    MAX(A.IBD_CSTMS_CLR_LOC_CD) AS IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("					MAX(A.POR_NOD_CD) AS POR_NOD_CD," ).append("\n"); 
		query.append("                    MAX(A.POL_NOD_CD) AS POL_NOD_CD," ).append("\n"); 
		query.append("                    MAX(A.POD_NOD_CD) AS POD_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.DEL_NOD_CD) AS DEL_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.DEL_SCC_CD) AS DEL_SCC_CD," ).append("\n"); 
		query.append("					MAX(A.STCC_CD) AS STCC_CD," ).append("\n"); 
		query.append("					MAX(A.STCC_DESC) AS STCC_DESC," ).append("\n"); 
		query.append("					MAX(A.CNTR_SEAL_NO) AS CNTR_SEAL_NO," ).append("\n"); 
		query.append("                    MAX(A.TRSP_BND_CD) AS TRSP_BND_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_CD AS AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_NO AS AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                    MAX(B.CURR_CD) CURR_CD," ).append("\n"); 
		query.append("                    SUM(B.BZC_AMT) BZC_AMT," ).append("\n"); 
		query.append("                    SUM(B.FUEL_SCG_AMT) FUEL_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.OVR_WGT_SCG_AMT) OVR_WGT_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.HZD_MTRL_SCG_AMT) HZD_MTRL_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.ETC_ADD_AMT) ETC_ADD_AMT," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_OFC_CTY_CD) TRSP_AGMT_OFC_CTY_CD," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_SEQ) TRSP_AGMT_SEQ," ).append("\n"); 
		query.append("                    MAX(A.DELT_FLG) DELT_FLG," ).append("\n"); 
		query.append("					MAX(A.CND_CSTMS_CLR_FLG) CND_CSTMS_CLR_FLG," ).append("\n"); 
		query.append("					MAX(A.UPLN_SO_FLG) UPLN_SO_FLG," ).append("\n"); 
		query.append("                    MAX(CASE WHEN B.SUB_RAIL_SEQ = 2 THEN B.FM_NOD_CD ELSE '' END) AS INTERCHANGE_1," ).append("\n"); 
		query.append("                    MAX(CASE WHEN B.SUB_RAIL_SEQ = 3 THEN B.FM_NOD_CD ELSE '' END) AS INTERCHANGE_2" ).append("\n"); 
		query.append("                FROM " ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_ORD A," ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_VNDR_SET B," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD C," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD_RSND CR," ).append("\n"); 
		query.append("                    TRS_TRSP_CFM_MSG_HIS CFM," ).append("\n"); 
		query.append("                    TRS_AGMT_HDR AGMT," ).append("\n"); 
		query.append("                    BKG_CONTAINER BC," ).append("\n"); 
		query.append("                    MDM_VENDOR D" ).append("\n"); 
		query.append("                WHERE A.TRSP_SO_OFC_CTY_CD = B.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = B.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = C.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = C.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CR.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CR.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CFM.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CFM.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   B.TRSP_AGMT_OFC_CTY_CD = AGMT.TRSP_AGMT_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   B.TRSP_AGMT_SEQ = AGMT.TRSP_AGMT_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.BKG_NO = BC.BKG_NO (+)" ).append("\n"); 
		query.append("                AND   A.EQ_NO = BC.CNTR_NO (+)" ).append("\n"); 
		query.append("                AND   B.VNDR_SEQ = D.VNDR_SEQ" ).append("\n"); 
		query.append("                AND   A.RAIL_CMB_THRU_TP_CD IN ('C1T', 'C2T', 'C3T', 'C2R', 'C3R', 'C2C', 'C3S')" ).append("\n"); 
		query.append("                AND   A.CRE_OFC_CD IN (@[ctrlOfcCd], 'SYSTEM')" ).append("\n"); 
		query.append("#if(${incHistory} != \'H\')" ).append("\n"); 
		query.append("                AND   A.DELT_FLG = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                AND   NVL(A.SPND_FLG, 'N') = 'N'" ).append("\n"); 
		query.append("				AND   NVL(C.BKG_NO, '0000000000') = NVL(A.ORG_BKG_NO, '0000000000')" ).append("\n"); 
		query.append("                AND   A.BIL_ISS_STS_CD = 'I'" ).append("\n"); 
		query.append("#if($bkg.size() > 0)" ).append("\n"); 
		query.append("                AND   ( C.BKG_NO ) IN (" ).append("\n"); 
		query.append("          		#foreach($key IN ${bkg})" ).append("\n"); 
		query.append("           			#if($velocityCount == 1)" ).append("\n"); 
		query.append("            			'$key'" ).append("\n"); 
		query.append("           			#else" ).append("\n"); 
		query.append("            			,'$key'" ).append("\n"); 
		query.append("           			#end" ).append("\n"); 
		query.append("          		#end" ).append("\n"); 
		query.append("           		)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($vvd.size() > 0)" ).append("\n"); 
		query.append(" AND ((A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append(" #foreach($key IN ${vvd})" ).append("\n"); 
		query.append("  #if($velocityCount == 1)      " ).append("\n"); 
		query.append("   ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("  #else" ).append("\n"); 
		query.append("   , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append(" )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($bl.size() > 0)" ).append("\n"); 
		query.append(" AND (A.BL_NO IN ( " ).append("\n"); 
		query.append("      #foreach($key IN ${bl})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($cntr.size() > 0)" ).append("\n"); 
		query.append(" AND A.EQ_NO IN (" ).append("\n"); 
		query.append("      #foreach($key IN ${cntr})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($ref_no.size() > 0)" ).append("\n"); 
		query.append(" AND A.REF_ID IN (" ).append("\n"); 
		query.append("      #foreach($key IN ${ref_no})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${frmDate} != \'\' && ${toDate} != \'\')" ).append("\n"); 
		query.append(" #if(${radDate} == \'DS\')" ).append("\n"); 
		query.append("  AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #elseif(${radDate} == \'DB\')" ).append("\n"); 
		query.append("  AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD')-21 AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("  AND C.BIL_EDI_SNT_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #elseif(${radDate} == \'DC\')" ).append("\n"); 
		query.append("  AND A.CXL_RQST_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${frmNode} != \'\')" ).append("\n"); 
		query.append(" AND A.FM_NOD_CD LIKE @[frmNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toNode} != \'\')" ).append("\n"); 
		query.append(" AND A.TO_NOD_CD LIKE @[toNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${radVendor} == \'V2\' && ${svcProvid} != \'\')" ).append("\n"); 
		query.append(" AND A.PROV_VNDR_SEQ = @[svcProvid]" ).append("\n"); 
		query.append("#elseif(${radVendor} == \'V1\' && ${railRoad} != \'ALL\')" ).append("\n"); 
		query.append("AND   EXISTS (SELECT 1 FROM TRS_TRSP_RAIL_BIL_VNDR_SET  V" ).append("\n"); 
		query.append("      WHERE V.TRSP_SO_OFC_CTY_CD = A.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("      AND V.TRSP_SO_SEQ = A.TRSP_SO_SEQ" ).append("\n"); 
		query.append("	  AND V.SUB_RAIL_SEQ = 1" ).append("\n"); 
		query.append("      AND V.VNDR_SEQ = @[railRoad]" ).append("\n"); 
		query.append("	  )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${status} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.TRSP_SO_STS_CD = @[status]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${edKind} != \'ALL\')" ).append("\n"); 
		query.append(" AND C.BIL_ISS_STS_CD = @[edKind]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${fuEmpy} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.CGO_TP_CD = @[fuEmpy]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${bound} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.TRSP_BND_CD = @[bound]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${bkgAtch} != \'ALL\')" ).append("\n"); 
		query.append(" #if(${bkgAtch} == \'N\')" ).append("\n"); 
		query.append("  AND BC.CNTR_NO IS NULL" ).append("\n"); 
		query.append("  AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append(" #elseif(${bkgAtch} == \'Y\')" ).append("\n"); 
		query.append("  AND BC.CNTR_NO IS NOT NULL" ).append("\n"); 
		query.append("  AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  AND DECODE(@[unplanned], 'ALL', 'X', NVL(A.UPLN_SO_FLG, 'N')) = DECODE(@[unplanned], 'ALL', 'X', @[unplanned])" ).append("\n"); 
		query.append("#if(${pod_n} != '')" ).append("\n"); 
		query.append("  AND A.POD_NOD_CD LIKE @[pod_n] || '%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${through} != \'ALL\')" ).append("\n"); 
		query.append("    #if(${through} == \'E\')" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD <> 'W'" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD = 'W'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                GROUP BY" ).append("\n"); 
		query.append("                    DECODE(C.BIL_ISS_KNT , A.BIL_ISS_KNT, 'Y' , NULL , 'Y' )," ).append("\n"); 
		query.append("                    A.CXL_RQST_FLG," ).append("\n"); 
		query.append("                    A.COP_NO," ).append("\n"); 
		query.append("                    A.COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("                    C.BIL_ISS_KNT," ).append("\n"); 
		query.append("                    A.TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("                    A.TRSP_SO_SEQ," ).append("\n"); 
		query.append("                    A.REPO_PLN_ID," ).append("\n"); 
		query.append("                    A.PLN_YRWK," ).append("\n"); 
		query.append("                    A.REF_ID," ).append("\n"); 
		query.append("                    A.REF_SEQ," ).append("\n"); 
		query.append("                    A.RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("                    A.CRE_OFC_CD," ).append("\n"); 
		query.append("                    A.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    C.BKG_NO," ).append("\n"); 
		query.append("                    A.BKG_NO," ).append("\n"); 
		query.append("                    C.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    C.BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("                    C.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("                    C.BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    C.MTC_EDI_IND_CD," ).append("\n"); 
		query.append("                    C.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("                    C.MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    NVL( C.INTER_RMK, A.INTER_RMK)," ).append("\n"); 
		query.append("                    NVL( C.SPCL_INSTR_RMK, A.SPCL_INSTR_RMK)," ).append("\n"); 
		query.append("                    C.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("                    C.LOCL_CRE_DT," ).append("\n"); 
		query.append("                    C.CRE_USR_ID," ).append("\n"); 
		query.append("                    C.WO_RJCT_RSN," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                    C.WBL_NO" ).append("\n"); 
		query.append("    UNION" ).append("\n"); 
		query.append("    SELECT /*+ ORDERED USE_NL(A, B, C, CR, CFM, AGMT, BC, D) */" ).append("\n"); 
		query.append("                    DECODE(C.BIL_ISS_KNT, A.BIL_ISS_KNT, 'Y', NULL , 'Y' ) AS LASTCHK," ).append("\n"); 
		query.append("                    MAX(B.INV_NO) AS INV_NO," ).append("\n"); 
		query.append("                    A.CXL_RQST_FLG AS CXL_RQST_FLG," ).append("\n"); 
		query.append("                    A.COP_NO AS COP_NO," ).append("\n"); 
		query.append("                    A.COST_ACT_GRP_SEQ AS COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("                    MIN(B.SUB_RAIL_SEQ) AS SUB_RAIL_SEQ," ).append("\n"); 
		query.append("                    MAX(DECODE(B.SUB_RAIL_SEQ, 1, B.VNDR_SEQ)) AS VNDR_SEQ," ).append("\n"); 
		query.append("                    C.BIL_ISS_KNT AS BIL_ISS_KNT," ).append("\n"); 
		query.append("                    A.TRSP_SO_OFC_CTY_CD AS TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("                    A.TRSP_SO_SEQ AS TRSP_SO_SEQ," ).append("\n"); 
		query.append("                    A.REPO_PLN_ID AS REPO_PLN_ID," ).append("\n"); 
		query.append("                    A.PLN_YRWK AS PLN_YRWK," ).append("\n"); 
		query.append("                    A.REF_ID AS REF_ID," ).append("\n"); 
		query.append("                    A.REF_SEQ AS REF_SEQ," ).append("\n"); 
		query.append("                    A.RAIL_CMB_THRU_TP_CD AS RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("                    A.CRE_OFC_CD AS CRE_OFC_CD," ).append("\n"); 
		query.append("                    MAX(A.BKG_CGO_TP_CD) AS BKG_CGO_TP_CD," ).append("\n"); 
		query.append("					MAX(A.TRSP_SO_STS_CD) AS TRSP_SO_STS_CD," ).append("\n"); 
		query.append("                    MAX(DECODE(NVL(C.BIL_ISS_STS_CD, A.TRSP_SO_STS_CD) , 'I', 'EDI Sent' , 'C', 'S/O Created' , 'R', 'S/O Corrected', 'S/O Created')) AS STATUS," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_RAIL_BIL_TP_CD , 'W', 'WRS' , 'OPUS')) AS TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("                    MAX(A.EQ_NO) AS EQ_NO," ).append("\n"); 
		query.append("                    MAX(A.EQ_TPSZ_CD) AS EQ_TPSZ_CD," ).append("\n"); 
		query.append("                    MAX(A.CGO_TP_CD) AS CGO_TP_CD," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'YYYYMMDD')) AS CRE_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'HH24MISS')) AS CRE_DT_HMS," ).append("\n"); 
		query.append("                    C.BIL_ISS_STS_CD AS BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 1, 5)) AS FM_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 6)) AS FM_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 1, 5)) AS TO_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 6)) AS TO_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(DECODE(B.SUB_RAIL_SEQ, 1, D.VNDR_ABBR_NM)) AS VNDR_ABBR_NM," ).append("\n"); 
		query.append("                    MAX(A.BL_NO) AS BL_NO," ).append("\n"); 
		query.append("                    DECODE(A.BIL_ISS_STS_CD , 'I', C.BKG_NO , A.BKG_NO) AS BKG_NO," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_SNT_DT, 'YYYYMMDD') AS BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_SNT_DT, 'HH24MISS') AS BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                            ) , 'YYYYMMDD'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                            ) , 'HH24MISS'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("                    C.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'YYYYMMDD') AS BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'HH24MISS') AS BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    C.WBL_NO AS WAYBILL_NO," ).append("\n"); 
		query.append("                    C.MTC_EDI_IND_CD," ).append("\n"); 
		query.append("                    C.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("                    TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'YYYYMMDD') AS MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'HH24MISS') AS MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'YYYYMMDD')) AS CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'HH24MISS')) AS CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(A.PROV_VNDR_SEQ) AS PROV_VNDR_SEQ," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'YYYYMMDD')) AS CXL_RQST_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'HH24MISS')) AS CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("                    MAX(CASE WHEN A.CXL_RQST_FLG = 'N' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'Y' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested Rejected'" ).append("\n"); 
		query.append("                             WHEN A.CXL_RQST_FLG = 'Y' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'N' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'E' THEN 'EDI Error'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'V' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' AND C.BIL_ISS_STS_CD = 'X' THEN 'Rail Billing Cancelled'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Rail Billed'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'C' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'R' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                    END) STATUS_NM," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_RSN) AS CXL_RQST_RSN," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'YYYYMMDD')) AS CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'HH24MISS')) AS CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.CXL_RQST_RJCT_RSN) AS CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("                    NVL(C.INTER_RMK, A.INTER_RMK) AS INTER_RMK," ).append("\n"); 
		query.append("                    NVL(C.SPCL_INSTR_RMK, A.SPCL_INSTR_RMK) SPCL_INSTR_RMK," ).append("\n"); 
		query.append("                    MAX(A.SPCL_CGO_CNTR_TP_CD) AS SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("                    C.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("                    C.LOCL_CRE_DT AS CCREDT," ).append("\n"); 
		query.append("                    MAX(A.SLAN_CD) AS SLAN_CD," ).append("\n"); 
		query.append("                    MAX((A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD)) AS TRUNKVVD," ).append("\n"); 
		query.append("                    MAX(A.IBD_NO) AS IBD_NO," ).append("\n"); 
		query.append("                    MAX((SELECT NVL(CSTMS_IBD.IBD_TRSP_NO, ' ')" ).append("\n"); 
		query.append("                           FROM BKG_CSTMS_ADV_IBD CSTMS_IBD" ).append("\n"); 
		query.append("                          WHERE CSTMS_IBD.BL_NO = A.BL_NO" ).append("\n"); 
		query.append("                            AND CSTMS_IBD.CNT_CD = 'US')) CSTMS_IBD_NO," ).append("\n"); 
		query.append("                    MAX(A.RAIL_CRR_REF_NO) AS RAIL_CRR_REF_NO," ).append("\n"); 
		query.append("                    MAX(A.SHPR_CUST_NM) AS SHPR_CUST_NM," ).append("\n"); 
		query.append("                    MAX(A.CNEE_CUST_NM) AS CNEE_CUST_NM," ).append("\n"); 
		query.append("                    C.CRE_USR_ID AS EDI_USR_ID," ).append("\n"); 
		query.append("                    MAX(A.TRSP_FRST_FLG) AS TRSP_FRST_FLG," ).append("\n"); 
		query.append("                    C.WO_RJCT_RSN," ).append("\n"); 
		query.append("                    MAX(DECODE(B.SUB_RAIL_SEQ, 1, AGMT.AGMT_REF_NO) || DECODE(B.TO_NOD_CD, NULL, '' , A.TO_NOD_CD, '', ' / ') ) || " ).append("\n"); 
		query.append("                    MAX( DECODE(B.SUB_RAIL_SEQ, 2 , AGMT.AGMT_REF_NO) || DECODE(B.TO_NOD_CD, NULL, '' , A.TO_NOD_CD, '', ' / ') ) || " ).append("\n"); 
		query.append("                    MAX( DECODE(B.SUB_RAIL_SEQ, 3 , AGMT.AGMT_REF_NO)) AS REF_NO," ).append("\n"); 
		query.append("                    MAX(DECODE(A.CGO_TP_CD, 'M', NULL, DECODE(BC.CNTR_NO, NULL , 'N', 'Y'))) AS BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("                    MAX(A.IBD_CSTMS_CLR_LOC_CD) AS IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("					MAX(A.POR_NOD_CD) AS POR_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.POL_NOD_CD) AS POL_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.POD_NOD_CD) AS POD_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.DEL_NOD_CD) AS DEL_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.DEL_SCC_CD) AS DEL_SCC_CD," ).append("\n"); 
		query.append("					MAX(A.STCC_CD) AS STCC_CD," ).append("\n"); 
		query.append("					MAX(A.STCC_DESC) AS STCC_DESC," ).append("\n"); 
		query.append("					MAX(A.CNTR_SEAL_NO) AS CNTR_SEAL_NO," ).append("\n"); 
		query.append("                    MAX(A.TRSP_BND_CD) AS TRSP_BND_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_CD AS AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_NO AS AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                    MAX(B.CURR_CD) CURR_CD," ).append("\n"); 
		query.append("                    SUM(B.BZC_AMT) BZC_AMT," ).append("\n"); 
		query.append("                    SUM(B.FUEL_SCG_AMT) FUEL_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.OVR_WGT_SCG_AMT) OVR_WGT_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.HZD_MTRL_SCG_AMT) HZD_MTRL_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.ETC_ADD_AMT) ETC_ADD_AMT," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_OFC_CTY_CD) TRSP_AGMT_OFC_CTY_CD," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_SEQ) TRSP_AGMT_SEQ," ).append("\n"); 
		query.append("                    MAX(A.DELT_FLG) DELT_FLG," ).append("\n"); 
		query.append("					MAX(A.CND_CSTMS_CLR_FLG) CND_CSTMS_CLR_FLG," ).append("\n"); 
		query.append("					MAX(A.UPLN_SO_FLG) UPLN_SO_FLG," ).append("\n"); 
		query.append("                    MAX(CASE WHEN B.SUB_RAIL_SEQ = 2 THEN B.FM_NOD_CD ELSE '' END) AS INTERCHANGE_1," ).append("\n"); 
		query.append("                    MAX(CASE WHEN B.SUB_RAIL_SEQ = 3 THEN B.FM_NOD_CD ELSE '' END) AS INTERCHANGE_2" ).append("\n"); 
		query.append("                FROM " ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_ORD A," ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_VNDR_SET B," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD C," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD_RSND CR," ).append("\n"); 
		query.append("                    TRS_TRSP_CFM_MSG_HIS CFM," ).append("\n"); 
		query.append("                    TRS_AGMT_HDR AGMT," ).append("\n"); 
		query.append("                    BKG_CONTAINER BC," ).append("\n"); 
		query.append("                    MDM_VENDOR D" ).append("\n"); 
		query.append("                WHERE A.TRSP_SO_OFC_CTY_CD = B.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = B.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = C.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = C.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CR.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CR.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CFM.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CFM.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   B.TRSP_AGMT_OFC_CTY_CD = AGMT.TRSP_AGMT_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   B.TRSP_AGMT_SEQ = AGMT.TRSP_AGMT_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.BKG_NO = BC.BKG_NO (+)" ).append("\n"); 
		query.append("                AND   A.EQ_NO = BC.CNTR_NO (+)" ).append("\n"); 
		query.append("                AND   B.VNDR_SEQ = D.VNDR_SEQ" ).append("\n"); 
		query.append("                AND   A.RAIL_CMB_THRU_TP_CD IN ('C1T', 'C2T', 'C3T', 'C2R', 'C3R', 'C2C', 'C3S')" ).append("\n"); 
		query.append("                AND   A.CRE_OFC_CD IN (@[ctrlOfcCd], 'SYSTEM')" ).append("\n"); 
		query.append("#if(${incHistory} != \'H\')" ).append("\n"); 
		query.append("                AND   A.DELT_FLG = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                AND   NVL(A.SPND_FLG, 'N') = 'N'" ).append("\n"); 
		query.append("                AND   NVL(A.BIL_ISS_STS_CD,'XX') <> 'I'" ).append("\n"); 
		query.append("#if($bkg.size() > 0)" ).append("\n"); 
		query.append("                AND   ( A.BKG_NO ) IN (" ).append("\n"); 
		query.append("         		#foreach($key IN ${bkg})" ).append("\n"); 
		query.append("           			#if($velocityCount == 1)" ).append("\n"); 
		query.append("            			'$key'" ).append("\n"); 
		query.append("           			#else" ).append("\n"); 
		query.append("            			,'$key'" ).append("\n"); 
		query.append("           			#end" ).append("\n"); 
		query.append("          		#end" ).append("\n"); 
		query.append("           		)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($vvd.size() > 0)" ).append("\n"); 
		query.append(" AND ((A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append(" #foreach($key IN ${vvd})" ).append("\n"); 
		query.append("  #if($velocityCount == 1)      " ).append("\n"); 
		query.append("   ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("  #else" ).append("\n"); 
		query.append("   , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append(" )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($bl.size() > 0)" ).append("\n"); 
		query.append(" AND (A.BL_NO IN ( " ).append("\n"); 
		query.append("      #foreach($key IN ${bl})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($cntr.size() > 0)" ).append("\n"); 
		query.append(" AND A.EQ_NO IN (" ).append("\n"); 
		query.append("      #foreach($key IN ${cntr})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($ref_no.size() > 0)" ).append("\n"); 
		query.append(" AND A.REF_ID IN (" ).append("\n"); 
		query.append("      #foreach($key IN ${ref_no})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${frmDate} != \'\' && ${toDate} != \'\')" ).append("\n"); 
		query.append(" #if(${radDate} == \'DS\')" ).append("\n"); 
		query.append("  AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #elseif(${radDate} == \'DB\')" ).append("\n"); 
		query.append("  AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD')-21 AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("  AND C.BIL_EDI_SNT_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #elseif(${radDate} == \'DC\')" ).append("\n"); 
		query.append("  AND A.CXL_RQST_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${frmNode} != \'\')" ).append("\n"); 
		query.append(" AND A.FM_NOD_CD LIKE @[frmNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toNode} != \'\')" ).append("\n"); 
		query.append(" AND A.TO_NOD_CD LIKE @[toNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${radVendor} == \'V2\' && ${svcProvid} != \'\')" ).append("\n"); 
		query.append(" AND A.PROV_VNDR_SEQ = @[svcProvid]" ).append("\n"); 
		query.append("#elseif(${radVendor} == \'V1\' && ${railRoad} != \'ALL\')" ).append("\n"); 
		query.append("AND   EXISTS (SELECT 1 FROM TRS_TRSP_RAIL_BIL_VNDR_SET  V" ).append("\n"); 
		query.append("      WHERE V.TRSP_SO_OFC_CTY_CD = A.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("      AND V.TRSP_SO_SEQ = A.TRSP_SO_SEQ" ).append("\n"); 
		query.append("	  AND V.SUB_RAIL_SEQ = 1" ).append("\n"); 
		query.append("      AND V.VNDR_SEQ = @[railRoad]" ).append("\n"); 
		query.append("	  )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${status} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.TRSP_SO_STS_CD = @[status]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${edKind} != \'ALL\')" ).append("\n"); 
		query.append(" AND C.BIL_ISS_STS_CD = @[edKind]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${fuEmpy} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.CGO_TP_CD = @[fuEmpy]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${bound} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.TRSP_BND_CD = @[bound]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${bkgAtch} != \'ALL\')" ).append("\n"); 
		query.append(" #if(${bkgAtch} == \'N\')" ).append("\n"); 
		query.append("  AND BC.CNTR_NO IS NULL" ).append("\n"); 
		query.append("  AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append(" #elseif(${bkgAtch} == \'Y\')" ).append("\n"); 
		query.append("  AND BC.CNTR_NO IS NOT NULL" ).append("\n"); 
		query.append("  AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  AND DECODE(@[unplanned], 'ALL', 'X', NVL(A.UPLN_SO_FLG, 'N')) = DECODE(@[unplanned], 'ALL', 'X', @[unplanned])" ).append("\n"); 
		query.append("#if(${pod_n} != '')" ).append("\n"); 
		query.append("  AND A.POD_NOD_CD LIKE @[pod_n] || '%' " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${through} != \'ALL\')" ).append("\n"); 
		query.append("    #if(${through} == \'E\')" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD <> 'W'" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD = 'W'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                GROUP BY" ).append("\n"); 
		query.append("                    DECODE(C.BIL_ISS_KNT , A.BIL_ISS_KNT, 'Y' , NULL , 'Y' )," ).append("\n"); 
		query.append("                    A.CXL_RQST_FLG," ).append("\n"); 
		query.append("                    A.COP_NO," ).append("\n"); 
		query.append("                    A.COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("                    C.BIL_ISS_KNT," ).append("\n"); 
		query.append("                    A.TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("                    A.TRSP_SO_SEQ," ).append("\n"); 
		query.append("                    A.REPO_PLN_ID," ).append("\n"); 
		query.append("                    A.PLN_YRWK," ).append("\n"); 
		query.append("                    A.REF_ID," ).append("\n"); 
		query.append("                    A.REF_SEQ," ).append("\n"); 
		query.append("                    A.RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("                    A.CRE_OFC_CD," ).append("\n"); 
		query.append("                    A.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    C.BKG_NO," ).append("\n"); 
		query.append("                    A.BKG_NO," ).append("\n"); 
		query.append("                    C.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    C.BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("                    C.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("                    C.BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    C.MTC_EDI_IND_CD," ).append("\n"); 
		query.append("                    C.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("                    C.MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    NVL( C.INTER_RMK, A.INTER_RMK)," ).append("\n"); 
		query.append("                    NVL( C.SPCL_INSTR_RMK, A.SPCL_INSTR_RMK)," ).append("\n"); 
		query.append("                    C.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("                    C.LOCL_CRE_DT," ).append("\n"); 
		query.append("                    C.CRE_USR_ID," ).append("\n"); 
		query.append("                    C.WO_RJCT_RSN," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                    C.WBL_NO" ).append("\n"); 
		query.append("            ) X" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT" ).append("\n"); 
		query.append("            X.LASTCHK," ).append("\n"); 
		query.append("            X.INV_NO," ).append("\n"); 
		query.append("            X.CXL_RQST_FLG," ).append("\n"); 
		query.append("            X.COP_NO," ).append("\n"); 
		query.append("            X.COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("            X.SUB_RAIL_SEQ," ).append("\n"); 
		query.append("            X.VNDR_SEQ," ).append("\n"); 
		query.append("            X.BIL_ISS_KNT," ).append("\n"); 
		query.append("            X.TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("            X.TRSP_SO_SEQ," ).append("\n"); 
		query.append("            X.REPO_PLN_ID," ).append("\n"); 
		query.append("            X.PLN_YRWK," ).append("\n"); 
		query.append("            X.REF_ID," ).append("\n"); 
		query.append("            X.REF_SEQ," ).append("\n"); 
		query.append("            X.RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("            X.CRE_OFC_CD," ).append("\n"); 
		query.append("            X.BKG_CGO_TP_CD," ).append("\n"); 
		query.append("            X.TRSP_SO_STS_CD," ).append("\n"); 
		query.append("			X.STATUS," ).append("\n"); 
		query.append("            X.TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("            X.EQ_NO," ).append("\n"); 
		query.append("            X.EQ_TPSZ_CD," ).append("\n"); 
		query.append("            X.CGO_TP_CD," ).append("\n"); 
		query.append("            X.CRE_DT," ).append("\n"); 
		query.append("            X.CRE_DT_HMS," ).append("\n"); 
		query.append("            X.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("            X.FM_NOD_CD," ).append("\n"); 
		query.append("            X.FM_NOD_YARD," ).append("\n"); 
		query.append("            X.TO_NOD_CD," ).append("\n"); 
		query.append("            X.TO_NOD_YARD," ).append("\n"); 
		query.append("            X.VNDR_ABBR_NM," ).append("\n"); 
		query.append("            X.BL_NO," ).append("\n"); 
		query.append("            X.BKG_NO," ).append("\n"); 
		query.append("            X.BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("            X.BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("            CASE WHEN X.BIL_EDI_RSNT_DT = '20000101' THEN '' ELSE X.BIL_EDI_RSNT_DT END BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("            CASE WHEN X.BIL_EDI_RSNT_DT = '20000101' THEN '' ELSE X.BIL_EDI_RSNT_DT_HMS END BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("            X.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("            X.BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("            X.BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("            X.WAYBILL_NO," ).append("\n"); 
		query.append("            X.MTC_EDI_IND_CD," ).append("\n"); 
		query.append("            X.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("            X.MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("            X.MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("            X.CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("            X.CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("            X.PROV_VNDR_SEQ," ).append("\n"); 
		query.append("            X.CXL_RQST_DT," ).append("\n"); 
		query.append("            X.CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("            X.STATUS_NM," ).append("\n"); 
		query.append("            X.CXL_RQST_RSN," ).append("\n"); 
		query.append("            X.CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("            X.CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("            X.CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("            X.INTER_RMK," ).append("\n"); 
		query.append("            (SELECT MAX(RMK.BKG_NO)" ).append("\n"); 
		query.append("               FROM TRS_INTER_RMK RMK" ).append("\n"); 
		query.append("              WHERE RMK.BKG_NO IN(X.BKG_NO, 'DUM000000000')" ).append("\n"); 
		query.append("                AND NVL(RMK.EQ_NO, 'X') = NVL2(RMK.EQ_NO, X.EQ_NO, 'X')" ).append("\n"); 
		query.append("                AND NVL(RMK.TRSP_SO_OFC_CTY_CD, 'XX') = NVL2(RMK.TRSP_SO_OFC_CTY_CD, X.TRSP_SO_OFC_CTY_CD, 'XX')" ).append("\n"); 
		query.append("                AND NVL(RMK.TRSP_SO_SEQ, '99999') = NVL2(RMK.TRSP_SO_SEQ, X.TRSP_SO_SEQ, '99999')" ).append("\n"); 
		query.append("                AND NVL(RMK.DELT_FLG, 'X') = 'N') AS INTER_RMK_CHK," ).append("\n"); 
		query.append("            X.SPCL_INSTR_RMK," ).append("\n"); 
		query.append("            X.SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("            X.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("            X.CCREDT," ).append("\n"); 
		query.append("            X.SLAN_CD," ).append("\n"); 
		query.append("            X.TRUNKVVD," ).append("\n"); 
		query.append("			(SELECT TRS_GET_COM_SO_RAIL_WGT_FNC('R', X.TRSP_SO_OFC_CTY_CD, X.TRSP_SO_SEQ, NULL, X.BKG_NO, X.EQ_NO, X.EQ_TPSZ_CD, 'LBS', X.COP_NO, 'N') FROM DUAL) CNTR_WGT_STR,  " ).append("\n"); 
		query.append("            NVL(X.IBD_NO, X.CSTMS_IBD_NO) AS IBD_NO," ).append("\n"); 
		query.append("            X.RAIL_CRR_REF_NO," ).append("\n"); 
		query.append("            X.SHPR_CUST_NM," ).append("\n"); 
		query.append("            X.CNEE_CUST_NM," ).append("\n"); 
		query.append("            X.EDI_USR_ID," ).append("\n"); 
		query.append("            X.TRSP_FRST_FLG," ).append("\n"); 
		query.append("            X.WO_RJCT_RSN," ).append("\n"); 
		query.append("            (" ).append("\n"); 
		query.append("                SELECT AGMT.AGMT_REF_NO AS REF_NO" ).append("\n"); 
		query.append("                  FROM TRS_AGMT_HDR AGMT" ).append("\n"); 
		query.append("                 WHERE X.TRSP_AGMT_OFC_CTY_CD = AGMT.TRSP_AGMT_OFC_CTY_CD" ).append("\n"); 
		query.append("                   AND X.TRSP_AGMT_SEQ = AGMT.TRSP_AGMT_SEQ" ).append("\n"); 
		query.append("            ) REF_NO," ).append("\n"); 
		query.append("            X.BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("            X.IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("			X.POR_NOD_CD," ).append("\n"); 
		query.append("			X.POL_NOD_CD," ).append("\n"); 
		query.append("			X.POD_NOD_CD," ).append("\n"); 
		query.append("			X.DEL_NOD_CD," ).append("\n"); 
		query.append("			X.DEL_SCC_CD," ).append("\n"); 
		query.append("			X.STCC_CD," ).append("\n"); 
		query.append("			X.STCC_DESC," ).append("\n"); 
		query.append("			X.CNTR_SEAL_NO," ).append("\n"); 
		query.append("            X.TRSP_BND_CD," ).append("\n"); 
		query.append("            X.AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("            X.AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("            (" ).append("\n"); 
		query.append("                SELECT REPLACE(MDM_CO.CMDT_NM, CHR(13)||CHR(10), ' ') AS CMDT_NAME" ).append("\n"); 
		query.append("                  FROM MDM_COMMODITY MDM_CO," ).append("\n"); 
		query.append("                       BKG_BOOKING B" ).append("\n"); 
		query.append("                 WHERE X.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("                   AND B.CMDT_CD = MDM_CO.CMDT_CD" ).append("\n"); 
		query.append("            ) CMDT_NAME," ).append("\n"); 
		query.append("            (" ).append("\n"); 
		query.append("                SELECT DECODE( BK.DCGO_FLG , 'Y', 'DG /') || " ).append("\n"); 
		query.append("                       DECODE( BK.RC_FLG , 'Y', 'RF /') || " ).append("\n"); 
		query.append("                       DECODE( BK.AWK_CGO_FLG , 'Y', 'AK /') || " ).append("\n"); 
		query.append("                       DECODE( BK.BB_CGO_FLG , 'Y', 'BB /') || " ).append("\n"); 
		query.append("                       DECODE( BK.SPCL_HIDE_FLG , 'Y', 'HD /') || " ).append("\n"); 
		query.append("                       DECODE( BK.FD_GRD_FLG , 'Y', 'FG /') || " ).append("\n"); 
		query.append("                       DECODE( BK.RAIL_BLK_CD, '', '', 'RB /') AS BKG_SPE" ).append("\n"); 
		query.append("                  FROM BKG_BOOKING BK" ).append("\n"); 
		query.append("                 WHERE X.BKG_NO = BK.BKG_NO" ).append("\n"); 
		query.append("            ) BKG_SPE," ).append("\n"); 
		query.append("            X.CURR_CD," ).append("\n"); 
		query.append("            X.BZC_AMT," ).append("\n"); 
		query.append("            X.FUEL_SCG_AMT," ).append("\n"); 
		query.append("            X.OVR_WGT_SCG_AMT," ).append("\n"); 
		query.append("            X.HZD_MTRL_SCG_AMT," ).append("\n"); 
		query.append("            X.ETC_ADD_AMT," ).append("\n"); 
		query.append("            X.TRSP_AGMT_OFC_CTY_CD," ).append("\n"); 
		query.append("            X.TRSP_AGMT_SEQ," ).append("\n"); 
		query.append("            X.DELT_FLG," ).append("\n"); 
		query.append("			X.CND_CSTMS_CLR_FLG," ).append("\n"); 
		query.append("			X.UPLN_SO_FLG," ).append("\n"); 
		query.append("            X.INTERCHANGE_1," ).append("\n"); 
		query.append("            X.INTERCHANGE_2" ).append("\n"); 
		query.append("        FROM" ).append("\n"); 
		query.append("            (" ).append("\n"); 
		query.append("                SELECT /*+ ORDERED USE_NL(A, B, C, CR, CFM, BC, D) */" ).append("\n"); 
		query.append("                    MAX(DECODE(C.BIL_ISS_KNT, A.BIL_ISS_KNT, 'Y', A.BIL_ISS_KNT-1, 'Y', DECODE(SUBSTR(A.RAIL_CMB_THRU_TP_CD, 2, 1), '3', A.BIL_ISS_KNT-2 ), 'Y', NULL, 'Y')) AS LASTCHK," ).append("\n"); 
		query.append("                    MAX(B.INV_NO) AS INV_NO," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_FLG) AS CXL_RQST_FLG," ).append("\n"); 
		query.append("                    MAX(A.COP_NO) AS COP_NO," ).append("\n"); 
		query.append("                    MAX(A.COST_ACT_GRP_SEQ) AS COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("                    B.SUB_RAIL_SEQ," ).append("\n"); 
		query.append("                    MAX(B.VNDR_SEQ) AS VNDR_SEQ," ).append("\n"); 
		query.append("                    C.BIL_ISS_KNT AS BIL_ISS_KNT," ).append("\n"); 
		query.append("                    A.TRSP_SO_OFC_CTY_CD AS TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("                    A.TRSP_SO_SEQ AS TRSP_SO_SEQ," ).append("\n"); 
		query.append("                    MAX(A.REPO_PLN_ID) AS REPO_PLN_ID," ).append("\n"); 
		query.append("                    MAX(A.PLN_YRWK) AS PLN_YRWK," ).append("\n"); 
		query.append("                    MAX(A.REF_ID) AS REF_ID," ).append("\n"); 
		query.append("                    MAX(A.REF_SEQ) AS REF_SEQ," ).append("\n"); 
		query.append("                    MAX(A.RAIL_CMB_THRU_TP_CD) AS RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("                    MAX(A.CRE_OFC_CD) AS CRE_OFC_CD," ).append("\n"); 
		query.append("                    MAX(A.BKG_CGO_TP_CD) AS BKG_CGO_TP_CD," ).append("\n"); 
		query.append("					MAX(A.TRSP_SO_STS_CD) AS TRSP_SO_STS_CD," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_SO_STS_CD, 'C', 'S/O Created', 'R', 'S/O Corrected', 'I', 'EDI Sent', '')) AS STATUS," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_RAIL_BIL_TP_CD , 'W', 'WRS' , 'OPUS')) AS TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("                    MAX(A.EQ_NO) AS EQ_NO," ).append("\n"); 
		query.append("                    MAX(A.EQ_TPSZ_CD) AS EQ_TPSZ_CD," ).append("\n"); 
		query.append("                    MAX(A.CGO_TP_CD) AS CGO_TP_CD," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'YYYYMMDD')) AS CRE_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'HH24MISS')) AS CRE_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.BIL_ISS_STS_CD) AS BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 1, 5)) AS FM_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 6)) AS FM_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 1, 5)) AS TO_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 6)) AS TO_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(D.VNDR_ABBR_NM) AS VNDR_ABBR_NM," ).append("\n"); 
		query.append("                    MAX(A.BL_NO) AS BL_NO," ).append("\n"); 
		query.append("                    MAX(DECODE(A.BIL_ISS_STS_CD, 'I', C.BKG_NO, A.BKG_NO)) AS BKG_NO," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_SNT_DT, 'YYYYMMDD')) AS BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_SNT_DT, 'HH24MISS')) AS BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                            ) , 'YYYYMMDD'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                            ) , 'HH24MISS'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.BIL_EDI_RCV_RSLT_CD) AS BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'YYYYMMDD')) AS BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'HH24MISS')) AS BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    C.WBL_NO AS WAYBILL_NO," ).append("\n"); 
		query.append("                    MAX(C.MTC_EDI_IND_CD) AS MTC_EDI_IND_CD," ).append("\n"); 
		query.append("                    MAX(C.MTC_EDI_RCV_RSLT_FLG) AS MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'YYYYMMDD')) AS MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'HH24MISS')) AS MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'YYYYMMDD')) AS CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'HH24MISS')) AS CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(A.PROV_VNDR_SEQ) AS PROV_VNDR_SEQ," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'YYYYMMDD')) AS CXL_RQST_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'HH24MISS')) AS CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("                    MAX(CASE WHEN A.CXL_RQST_FLG = 'N' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'Y' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested Rejected'" ).append("\n"); 
		query.append("                             WHEN A.CXL_RQST_FLG = 'Y' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'N' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'E' THEN 'EDI Error'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'V' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' AND C.BIL_ISS_STS_CD = 'X' THEN 'Rail Billing Cancelled'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Rail Billed'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'C' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'R' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                    END) STATUS_NM," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_RSN) AS CXL_RQST_RSN," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'YYYYMMDD')) AS CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'HH24MISS')) AS CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.CXL_RQST_RJCT_RSN) AS CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("                    MAX(NVL(C.INTER_RMK, A.INTER_RMK)) AS INTER_RMK," ).append("\n"); 
		query.append("                    MAX(C.SPCL_INSTR_RMK) AS SPCL_INSTR_RMK," ).append("\n"); 
		query.append("                    MAX(A.SPCL_CGO_CNTR_TP_CD) AS SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("                    MAX(C.RAIL_ORD_RJCT_FLG) AS RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("                    MAX(C.LOCL_CRE_DT) AS CCREDT," ).append("\n"); 
		query.append("                    MAX(A.SLAN_CD) AS SLAN_CD," ).append("\n"); 
		query.append("                    MAX(A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD) AS TRUNKVVD," ).append("\n"); 
		query.append("--                    MAX(A.CNTR_WGT) AS CNTR_WGT," ).append("\n"); 
		query.append("                    MAX(A.IBD_NO) AS IBD_NO," ).append("\n"); 
		query.append("                    MAX((SELECT NVL(CSTMS_IBD.IBD_TRSP_NO, ' ')" ).append("\n"); 
		query.append("                           FROM BKG_CSTMS_ADV_IBD CSTMS_IBD" ).append("\n"); 
		query.append("                          WHERE CSTMS_IBD.BL_NO = A.BL_NO" ).append("\n"); 
		query.append("                            AND CSTMS_IBD.CNT_CD = 'US')) CSTMS_IBD_NO," ).append("\n"); 
		query.append("                    MAX(A.RAIL_CRR_REF_NO) AS RAIL_CRR_REF_NO," ).append("\n"); 
		query.append("                    MAX(A.SHPR_CUST_NM) AS SHPR_CUST_NM," ).append("\n"); 
		query.append("                    MAX(A.CNEE_CUST_NM) AS CNEE_CUST_NM," ).append("\n"); 
		query.append("                    MAX(C.CRE_USR_ID) AS EDI_USR_ID," ).append("\n"); 
		query.append("                    MAX(A.TRSP_FRST_FLG) AS TRSP_FRST_FLG," ).append("\n"); 
		query.append("                    MAX(C.WO_RJCT_RSN) AS WO_RJCT_RSN," ).append("\n"); 
		query.append("                    MAX(DECODE(A.CGO_TP_CD, 'M', NULL, DECODE(BC.CNTR_NO, NULL, 'N', 'Y'))) AS BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("                    MAX(A.IBD_CSTMS_CLR_LOC_CD) AS IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("					MAX(A.POR_NOD_CD) AS POR_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.POL_NOD_CD) AS POL_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.POD_NOD_CD) AS POD_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.DEL_NOD_CD) AS DEL_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.DEL_SCC_CD) AS DEL_SCC_CD," ).append("\n"); 
		query.append("					MAX(A.STCC_CD) AS STCC_CD," ).append("\n"); 
		query.append("					MAX(A.STCC_DESC) AS STCC_DESC," ).append("\n"); 
		query.append("					MAX(A.CNTR_SEAL_NO) AS CNTR_SEAL_NO," ).append("\n"); 
		query.append("                    MAX(A.TRSP_BND_CD) AS TRSP_BND_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_CD AS AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_NO AS AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_OFC_CTY_CD) AS TRSP_AGMT_OFC_CTY_CD," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_SEQ) AS TRSP_AGMT_SEQ," ).append("\n"); 
		query.append("                    MAX(B.CURR_CD) CURR_CD," ).append("\n"); 
		query.append("                    SUM(B.BZC_AMT) BZC_AMT," ).append("\n"); 
		query.append("                    SUM(B.FUEL_SCG_AMT) FUEL_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.OVR_WGT_SCG_AMT) OVR_WGT_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.HZD_MTRL_SCG_AMT) HZD_MTRL_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.ETC_ADD_AMT) ETC_ADD_AMT," ).append("\n"); 
		query.append("                    MAX(A.DELT_FLG) DELT_FLG," ).append("\n"); 
		query.append("					MAX(A.CND_CSTMS_CLR_FLG) CND_CSTMS_CLR_FLG," ).append("\n"); 
		query.append("					MAX(A.UPLN_SO_FLG) UPLN_SO_FLG," ).append("\n"); 
		query.append("                    MAX(CASE WHEN B.SUB_RAIL_SEQ = 2 THEN B.FM_NOD_CD ELSE '' END) AS INTERCHANGE_1," ).append("\n"); 
		query.append("                    MAX(CASE WHEN B.SUB_RAIL_SEQ = 3 THEN B.FM_NOD_CD ELSE '' END) AS INTERCHANGE_2" ).append("\n"); 
		query.append("                FROM" ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_ORD A," ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_VNDR_SET B," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD C," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD_RSND CR," ).append("\n"); 
		query.append("                    BKG_CONTAINER BC," ).append("\n"); 
		query.append("                    MDM_VENDOR D," ).append("\n"); 
		query.append("                    TRS_TRSP_CFM_MSG_HIS CFM" ).append("\n"); 
		query.append("                WHERE A.TRSP_SO_OFC_CTY_CD = B.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = B.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = C.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = C.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CR.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CR.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   B.VNDR_SEQ = NVL(C.VNDR_SEQ, B.VNDR_SEQ)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CFM.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CFM.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.BKG_NO = BC.BKG_NO (+)" ).append("\n"); 
		query.append("                AND   A.EQ_NO = BC.CNTR_NO (+)" ).append("\n"); 
		query.append("                AND   B.VNDR_SEQ = D.VNDR_SEQ" ).append("\n"); 
		query.append("                AND   A.RAIL_CMB_THRU_TP_CD IN ('S2R', 'S3R')" ).append("\n"); 
		query.append("                AND   A.CRE_OFC_CD IN (@[ctrlOfcCd], 'SYSTEM')" ).append("\n"); 
		query.append("#if(${incHistory} != \'H\')" ).append("\n"); 
		query.append("                AND   A.DELT_FLG = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                AND   NVL(A.SPND_FLG, 'N') = 'N'" ).append("\n"); 
		query.append("                --AND   C.BKG_NO = A.BKG_NO" ).append("\n"); 
		query.append("				AND   NVL(C.BKG_NO, '0000000000') = NVL(A.BKG_NO, '0000000000')" ).append("\n"); 
		query.append("                AND   A.BIL_ISS_STS_CD = 'I' " ).append("\n"); 
		query.append("               -- AND   C.CRE_OFC_CD = ^[ctrlOfcCd]" ).append("\n"); 
		query.append("#if($bkg.size() > 0)" ).append("\n"); 
		query.append("                AND   ( C.BKG_NO ) IN (" ).append("\n"); 
		query.append("          #foreach($key IN ${bkg})" ).append("\n"); 
		query.append("           #if($velocityCount == 1)" ).append("\n"); 
		query.append("            '$key'" ).append("\n"); 
		query.append("           #else" ).append("\n"); 
		query.append("            ,'$key'" ).append("\n"); 
		query.append("           #end" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($vvd.size() > 0)" ).append("\n"); 
		query.append(" AND ((A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append(" #foreach($key IN ${vvd})" ).append("\n"); 
		query.append("  #if($velocityCount == 1)      " ).append("\n"); 
		query.append("   ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("  #else" ).append("\n"); 
		query.append("   , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append(" )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($bl.size() > 0)" ).append("\n"); 
		query.append(" AND (A.BL_NO IN ( " ).append("\n"); 
		query.append("      #foreach($key IN ${bl})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($cntr.size() > 0)" ).append("\n"); 
		query.append(" AND A.EQ_NO IN (" ).append("\n"); 
		query.append("      #foreach($key IN ${cntr})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($ref_no.size() > 0)" ).append("\n"); 
		query.append(" AND A.REF_ID IN (" ).append("\n"); 
		query.append("      #foreach($key IN ${ref_no})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${frmDate} != \'\' && ${toDate} != \'\')" ).append("\n"); 
		query.append(" #if(${radDate} == \'DS\')" ).append("\n"); 
		query.append("  AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #elseif(${radDate} == \'DB\')" ).append("\n"); 
		query.append("  AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD')-21 AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("  AND C.BIL_EDI_SNT_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #elseif(${radDate} == \'DC\')" ).append("\n"); 
		query.append("  AND A.CXL_RQST_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${frmNode} != \'\')" ).append("\n"); 
		query.append(" AND A.FM_NOD_CD LIKE @[frmNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toNode} != \'\')" ).append("\n"); 
		query.append(" AND A.TO_NOD_CD LIKE @[toNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${radVendor} == \'V2\' && ${svcProvid} != \'\')" ).append("\n"); 
		query.append(" AND A.PROV_VNDR_SEQ = @[svcProvid]" ).append("\n"); 
		query.append("#elseif(${radVendor} == \'V1\' && ${railRoad} != \'ALL\')" ).append("\n"); 
		query.append(" AND B.VNDR_SEQ = @[railRoad]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${status} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.TRSP_SO_STS_CD = @[status]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${edKind} != \'ALL\')" ).append("\n"); 
		query.append(" AND C.BIL_ISS_STS_CD = @[edKind]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${fuEmpy} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.CGO_TP_CD = @[fuEmpy]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${bound} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.TRSP_BND_CD = @[bound]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${bkgAtch} != \'ALL\')" ).append("\n"); 
		query.append(" #if(${bkgAtch} == \'N\')" ).append("\n"); 
		query.append("  AND BC.CNTR_NO IS NULL" ).append("\n"); 
		query.append("  AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append(" #elseif(${bkgAtch} == \'Y\')" ).append("\n"); 
		query.append("  AND BC.CNTR_NO IS NOT NULL" ).append("\n"); 
		query.append("  AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  AND DECODE(@[unplanned], 'ALL', 'X', NVL(A.UPLN_SO_FLG, 'N')) = DECODE(@[unplanned], 'ALL', 'X', @[unplanned])" ).append("\n"); 
		query.append("#if(${pod_n} != '')" ).append("\n"); 
		query.append("  AND A.POD_NOD_CD LIKE @[pod_n] || '%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${through} != \'ALL\')" ).append("\n"); 
		query.append("    #if(${through} == \'E\')" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD <> 'W'" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD = 'W'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                GROUP BY " ).append("\n"); 
		query.append("                        A.TRSP_SO_OFC_CTY_CD, " ).append("\n"); 
		query.append("                        A.TRSP_SO_SEQ, " ).append("\n"); 
		query.append("                        B.SUB_RAIL_SEQ, " ).append("\n"); 
		query.append("                        C.BIL_ISS_KNT, " ).append("\n"); 
		query.append("                        A.AUTO_XPT_SYS_CD, " ).append("\n"); 
		query.append("                        A.AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                        C.WBL_NO" ).append("\n"); 
		query.append("    UNION" ).append("\n"); 
		query.append("    SELECT /*+ ORDERED USE_NL(A, B, C, CR, CFM, BC, D) */" ).append("\n"); 
		query.append("                    MAX(DECODE(C.BIL_ISS_KNT, A.BIL_ISS_KNT, 'Y', A.BIL_ISS_KNT-1, 'Y', DECODE(SUBSTR(A.RAIL_CMB_THRU_TP_CD, 2, 1), '3', A.BIL_ISS_KNT-2 ), 'Y', NULL, 'Y')) AS LASTCHK," ).append("\n"); 
		query.append("                    MAX(B.INV_NO) AS INV_NO," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_FLG) AS CXL_RQST_FLG," ).append("\n"); 
		query.append("                    MAX(A.COP_NO) AS COP_NO," ).append("\n"); 
		query.append("                    MAX(A.COST_ACT_GRP_SEQ) AS COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("                    B.SUB_RAIL_SEQ," ).append("\n"); 
		query.append("                    MAX(B.VNDR_SEQ) AS VNDR_SEQ," ).append("\n"); 
		query.append("                    C.BIL_ISS_KNT AS BIL_ISS_KNT," ).append("\n"); 
		query.append("                    A.TRSP_SO_OFC_CTY_CD AS TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("                    A.TRSP_SO_SEQ AS TRSP_SO_SEQ," ).append("\n"); 
		query.append("                    MAX(A.REPO_PLN_ID) AS REPO_PLN_ID," ).append("\n"); 
		query.append("                    MAX(A.PLN_YRWK) AS PLN_YRWK," ).append("\n"); 
		query.append("                    MAX(A.REF_ID) AS REF_ID," ).append("\n"); 
		query.append("                    MAX(A.REF_SEQ) AS REF_SEQ," ).append("\n"); 
		query.append("                    MAX(A.RAIL_CMB_THRU_TP_CD) AS RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("                    MAX(A.CRE_OFC_CD) AS CRE_OFC_CD," ).append("\n"); 
		query.append("                    MAX(A.BKG_CGO_TP_CD) AS BKG_CGO_TP_CD," ).append("\n"); 
		query.append("					MAX(A.TRSP_SO_STS_CD) AS TRSP_SO_STS_CD," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_SO_STS_CD, 'C', 'S/O Created', 'R', 'S/O Corrected', 'I', 'EDI Sent', '')) AS STATUS," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_RAIL_BIL_TP_CD , 'W', 'WRS' , 'OPUS')) AS TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("                    MAX(A.EQ_NO) AS EQ_NO," ).append("\n"); 
		query.append("                    MAX(A.EQ_TPSZ_CD) AS EQ_TPSZ_CD," ).append("\n"); 
		query.append("                    MAX(A.CGO_TP_CD) AS CGO_TP_CD," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'YYYYMMDD')) AS CRE_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'HH24MISS')) AS CRE_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.BIL_ISS_STS_CD) AS BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 1, 5)) AS FM_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 6)) AS FM_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 1, 5)) AS TO_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 6)) AS TO_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(D.VNDR_ABBR_NM) AS VNDR_ABBR_NM," ).append("\n"); 
		query.append("                    MAX(A.BL_NO) AS BL_NO," ).append("\n"); 
		query.append("                    MAX(DECODE(A.BIL_ISS_STS_CD, 'I', C.BKG_NO, A.BKG_NO)) AS BKG_NO," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_SNT_DT, 'YYYYMMDD')) AS BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_SNT_DT, 'HH24MISS')) AS BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                            ) , 'YYYYMMDD'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                            ) , 'HH24MISS'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.BIL_EDI_RCV_RSLT_CD) AS BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'YYYYMMDD')) AS BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'HH24MISS')) AS BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    C.WBL_NO AS WAYBILL_NO," ).append("\n"); 
		query.append("                    MAX(C.MTC_EDI_IND_CD) AS MTC_EDI_IND_CD," ).append("\n"); 
		query.append("                    MAX(C.MTC_EDI_RCV_RSLT_FLG) AS MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'YYYYMMDD')) AS MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'HH24MISS')) AS MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'YYYYMMDD')) AS CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'HH24MISS')) AS CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(A.PROV_VNDR_SEQ) AS PROV_VNDR_SEQ," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'YYYYMMDD')) AS CXL_RQST_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'HH24MISS')) AS CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("                    MAX(CASE WHEN A.CXL_RQST_FLG = 'N' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'Y' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested Rejected'" ).append("\n"); 
		query.append("                             WHEN A.CXL_RQST_FLG = 'Y' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'N' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'E' THEN 'EDI Error'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'V' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' AND C.BIL_ISS_STS_CD = 'X' THEN 'Rail Billing Cancelled'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Rail Billed'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'C' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'R' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                    END) STATUS_NM," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_RSN) AS CXL_RQST_RSN," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'YYYYMMDD')) AS CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'HH24MISS')) AS CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.CXL_RQST_RJCT_RSN) AS CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("                    MAX(NVL(C.INTER_RMK, A.INTER_RMK)) AS INTER_RMK," ).append("\n"); 
		query.append("                    MAX(C.SPCL_INSTR_RMK) AS SPCL_INSTR_RMK," ).append("\n"); 
		query.append("                    MAX(A.SPCL_CGO_CNTR_TP_CD) AS SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("                    MAX(C.RAIL_ORD_RJCT_FLG) AS RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("                    MAX(C.LOCL_CRE_DT) AS CCREDT," ).append("\n"); 
		query.append("                    MAX(A.SLAN_CD) AS SLAN_CD," ).append("\n"); 
		query.append("                    MAX(A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD) AS TRUNKVVD," ).append("\n"); 
		query.append("--                    MAX(A.CNTR_WGT) AS CNTR_WGT," ).append("\n"); 
		query.append("                    MAX(A.IBD_NO) AS IBD_NO," ).append("\n"); 
		query.append("                    MAX((SELECT NVL(CSTMS_IBD.IBD_TRSP_NO, ' ')" ).append("\n"); 
		query.append("                           FROM BKG_CSTMS_ADV_IBD CSTMS_IBD" ).append("\n"); 
		query.append("                          WHERE CSTMS_IBD.BL_NO = A.BL_NO" ).append("\n"); 
		query.append("                            AND CSTMS_IBD.CNT_CD = 'US')) CSTMS_IBD_NO," ).append("\n"); 
		query.append("                    MAX(A.RAIL_CRR_REF_NO) AS RAIL_CRR_REF_NO," ).append("\n"); 
		query.append("                    MAX(A.SHPR_CUST_NM) AS SHPR_CUST_NM," ).append("\n"); 
		query.append("                    MAX(A.CNEE_CUST_NM) AS CNEE_CUST_NM," ).append("\n"); 
		query.append("                    MAX(C.CRE_USR_ID) AS EDI_USR_ID," ).append("\n"); 
		query.append("                    MAX(A.TRSP_FRST_FLG) AS TRSP_FRST_FLG," ).append("\n"); 
		query.append("                    MAX(C.WO_RJCT_RSN) AS WO_RJCT_RSN," ).append("\n"); 
		query.append("                    MAX(DECODE(A.CGO_TP_CD, 'M', NULL, DECODE(BC.CNTR_NO, NULL, 'N', 'Y'))) AS BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("                    MAX(A.IBD_CSTMS_CLR_LOC_CD) AS IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("					MAX(A.POR_NOD_CD) AS POR_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.POL_NOD_CD) AS POL_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.POD_NOD_CD) AS POD_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.DEL_NOD_CD) AS DEL_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.DEL_SCC_CD) AS DEL_SCC_CD," ).append("\n"); 
		query.append("					MAX(A.STCC_CD) AS STCC_CD," ).append("\n"); 
		query.append("					MAX(A.STCC_DESC) AS STCC_DESC," ).append("\n"); 
		query.append("					MAX(A.CNTR_SEAL_NO) AS CNTR_SEAL_NO," ).append("\n"); 
		query.append("                    MAX(A.TRSP_BND_CD) AS TRSP_BND_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_CD AS AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_NO AS AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_OFC_CTY_CD) AS TRSP_AGMT_OFC_CTY_CD," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_SEQ) AS TRSP_AGMT_SEQ," ).append("\n"); 
		query.append("                    MAX(B.CURR_CD) CURR_CD," ).append("\n"); 
		query.append("                    SUM(B.BZC_AMT) BZC_AMT," ).append("\n"); 
		query.append("                    SUM(B.FUEL_SCG_AMT) FUEL_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.OVR_WGT_SCG_AMT) OVR_WGT_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.HZD_MTRL_SCG_AMT) HZD_MTRL_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.ETC_ADD_AMT) ETC_ADD_AMT," ).append("\n"); 
		query.append("                    MAX(A.DELT_FLG) DELT_FLG," ).append("\n"); 
		query.append("					MAX(A.CND_CSTMS_CLR_FLG) CND_CSTMS_CLR_FLG," ).append("\n"); 
		query.append("					MAX(A.UPLN_SO_FLG) UPLN_SO_FLG," ).append("\n"); 
		query.append("                    MAX(CASE WHEN B.SUB_RAIL_SEQ = 2 THEN B.FM_NOD_CD ELSE '' END) AS INTERCHANGE_1," ).append("\n"); 
		query.append("                    MAX(CASE WHEN B.SUB_RAIL_SEQ = 3 THEN B.FM_NOD_CD ELSE '' END) AS INTERCHANGE_2" ).append("\n"); 
		query.append("                FROM" ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_ORD A," ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_VNDR_SET B," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD C," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD_RSND CR," ).append("\n"); 
		query.append("                    BKG_CONTAINER BC," ).append("\n"); 
		query.append("                    MDM_VENDOR D," ).append("\n"); 
		query.append("                    TRS_TRSP_CFM_MSG_HIS CFM" ).append("\n"); 
		query.append("                WHERE A.TRSP_SO_OFC_CTY_CD = B.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = B.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = C.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = C.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CR.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CR.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   B.VNDR_SEQ = NVL(C.VNDR_SEQ, B.VNDR_SEQ)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CFM.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CFM.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.BKG_NO = BC.BKG_NO (+)" ).append("\n"); 
		query.append("                AND   A.EQ_NO = BC.CNTR_NO (+)" ).append("\n"); 
		query.append("                AND   B.VNDR_SEQ = D.VNDR_SEQ" ).append("\n"); 
		query.append("                AND   A.RAIL_CMB_THRU_TP_CD IN ('S2R', 'S3R')" ).append("\n"); 
		query.append("                AND   A.CRE_OFC_CD IN (@[ctrlOfcCd], 'SYSTEM')" ).append("\n"); 
		query.append("#if(${incHistory} != \'H\')" ).append("\n"); 
		query.append("                AND   A.DELT_FLG = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                AND   NVL(A.SPND_FLG, 'N') = 'N'" ).append("\n"); 
		query.append("                --AND   C.BKG_NO = A.ORG_BKG_NO" ).append("\n"); 
		query.append("				AND   NVL(C.BKG_NO, '0000000000') = NVL(A.ORG_BKG_NO, '0000000000')" ).append("\n"); 
		query.append("                AND   A.BIL_ISS_STS_CD = 'I'" ).append("\n"); 
		query.append("              --  AND   C.CRE_OFC_CD = ^[ctrlOfcCd]" ).append("\n"); 
		query.append("#if($bkg.size() > 0)" ).append("\n"); 
		query.append("                AND   ( C.BKG_NO ) IN (" ).append("\n"); 
		query.append("          #foreach($key IN ${bkg})" ).append("\n"); 
		query.append("           #if($velocityCount == 1)" ).append("\n"); 
		query.append("            '$key'" ).append("\n"); 
		query.append("           #else" ).append("\n"); 
		query.append("            ,'$key'" ).append("\n"); 
		query.append("           #end" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($vvd.size() > 0)" ).append("\n"); 
		query.append(" AND ((A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append(" #foreach($key IN ${vvd})" ).append("\n"); 
		query.append("  #if($velocityCount == 1)      " ).append("\n"); 
		query.append("   ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("  #else" ).append("\n"); 
		query.append("   , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append(" )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($bl.size() > 0)" ).append("\n"); 
		query.append(" AND (A.BL_NO IN ( " ).append("\n"); 
		query.append("      #foreach($key IN ${bl})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($cntr.size() > 0)" ).append("\n"); 
		query.append(" AND A.EQ_NO IN (" ).append("\n"); 
		query.append("      #foreach($key IN ${cntr})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($ref_no.size() > 0)" ).append("\n"); 
		query.append(" AND A.REF_ID IN (" ).append("\n"); 
		query.append("      #foreach($key IN ${ref_no})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${frmDate} != \'\' && ${toDate} != \'\')" ).append("\n"); 
		query.append(" #if(${radDate} == \'DS\')" ).append("\n"); 
		query.append("  AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #elseif(${radDate} == \'DB\')" ).append("\n"); 
		query.append("  AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD')-21 AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("  AND C.BIL_EDI_SNT_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #elseif(${radDate} == \'DC\')" ).append("\n"); 
		query.append("  AND A.CXL_RQST_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${frmNode} != \'\')" ).append("\n"); 
		query.append(" AND A.FM_NOD_CD LIKE @[frmNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toNode} != \'\')" ).append("\n"); 
		query.append(" AND A.TO_NOD_CD LIKE @[toNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${radVendor} == \'V2\' && ${svcProvid} != \'\')" ).append("\n"); 
		query.append(" AND A.PROV_VNDR_SEQ = @[svcProvid]" ).append("\n"); 
		query.append("#elseif(${radVendor} == \'V1\' && ${railRoad} != \'ALL\')" ).append("\n"); 
		query.append(" AND B.VNDR_SEQ = @[railRoad]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${status} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.TRSP_SO_STS_CD = @[status]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${edKind} != \'ALL\')" ).append("\n"); 
		query.append(" AND C.BIL_ISS_STS_CD = @[edKind]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${fuEmpy} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.CGO_TP_CD = @[fuEmpy]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${bound} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.TRSP_BND_CD = @[bound]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${bkgAtch} != \'ALL\')" ).append("\n"); 
		query.append(" #if(${bkgAtch} == \'N\')" ).append("\n"); 
		query.append("  AND BC.CNTR_NO IS NULL" ).append("\n"); 
		query.append("  AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append(" #elseif(${bkgAtch} == \'Y\')" ).append("\n"); 
		query.append("  AND BC.CNTR_NO IS NOT NULL" ).append("\n"); 
		query.append("  AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  AND DECODE(@[unplanned], 'ALL', 'X', NVL(A.UPLN_SO_FLG, 'N')) = DECODE(@[unplanned], 'ALL', 'X', @[unplanned])	" ).append("\n"); 
		query.append("#if(${pod_n} != '')" ).append("\n"); 
		query.append("  AND A.POD_NOD_CD LIKE @[pod_n] || '%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${through} != \'ALL\')" ).append("\n"); 
		query.append("    #if(${through} == \'E\')" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD <> 'W'" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD = 'W'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                GROUP BY " ).append("\n"); 
		query.append("                        A.TRSP_SO_OFC_CTY_CD, " ).append("\n"); 
		query.append("                        A.TRSP_SO_SEQ, " ).append("\n"); 
		query.append("                        B.SUB_RAIL_SEQ, " ).append("\n"); 
		query.append("                        C.BIL_ISS_KNT, " ).append("\n"); 
		query.append("                        A.AUTO_XPT_SYS_CD, " ).append("\n"); 
		query.append("                        A.AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                        C.WBL_NO" ).append("\n"); 
		query.append("    UNION" ).append("\n"); 
		query.append("    SELECT /*+ ORDERED USE_NL(A, B, C, CR, CFM, BC, D) */" ).append("\n"); 
		query.append("                    MAX(DECODE(C.BIL_ISS_KNT, A.BIL_ISS_KNT, 'Y', A.BIL_ISS_KNT-1, 'Y', DECODE(SUBSTR(A.RAIL_CMB_THRU_TP_CD, 2, 1), '3', A.BIL_ISS_KNT-2 ), 'Y', NULL, 'Y')) AS LASTCHK," ).append("\n"); 
		query.append("                    MAX(B.INV_NO) AS INV_NO," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_FLG) AS CXL_RQST_FLG," ).append("\n"); 
		query.append("                    MAX(A.COP_NO) AS COP_NO," ).append("\n"); 
		query.append("                    MAX(A.COST_ACT_GRP_SEQ) AS COST_ACT_GRP_SEQ," ).append("\n"); 
		query.append("                    B.SUB_RAIL_SEQ," ).append("\n"); 
		query.append("                    MAX(B.VNDR_SEQ) AS VNDR_SEQ," ).append("\n"); 
		query.append("                    C.BIL_ISS_KNT AS BIL_ISS_KNT," ).append("\n"); 
		query.append("                    A.TRSP_SO_OFC_CTY_CD AS TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("                    A.TRSP_SO_SEQ AS TRSP_SO_SEQ," ).append("\n"); 
		query.append("                    MAX(A.REPO_PLN_ID) AS REPO_PLN_ID," ).append("\n"); 
		query.append("                    MAX(A.PLN_YRWK) AS PLN_YRWK," ).append("\n"); 
		query.append("                    MAX(A.REF_ID) AS REF_ID," ).append("\n"); 
		query.append("                    MAX(A.REF_SEQ) AS REF_SEQ," ).append("\n"); 
		query.append("                    MAX(A.RAIL_CMB_THRU_TP_CD) AS RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("                    MAX(A.CRE_OFC_CD) AS CRE_OFC_CD," ).append("\n"); 
		query.append("                    MAX(A.BKG_CGO_TP_CD) AS BKG_CGO_TP_CD," ).append("\n"); 
		query.append("					MAX(A.TRSP_SO_STS_CD) TRSP_SO_STS_CD," ).append("\n"); 
		query.append("                    MAX(DECODE(NVL(C.BIL_ISS_STS_CD, A.TRSP_SO_STS_CD) , 'I', 'EDI Sent' , 'C', 'S/O Created' , 'R', 'S/O Corrected', 'S/O Created')) AS STATUS," ).append("\n"); 
		query.append("                    MAX(DECODE(A.TRSP_RAIL_BIL_TP_CD , 'W', 'WRS' , 'OPUS')) AS TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("                    MAX(A.EQ_NO) AS EQ_NO," ).append("\n"); 
		query.append("                    MAX(A.EQ_TPSZ_CD) AS EQ_TPSZ_CD," ).append("\n"); 
		query.append("                    MAX(A.CGO_TP_CD) AS CGO_TP_CD," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'YYYYMMDD')) AS CRE_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.LOCL_CRE_DT, 'HH24MISS')) AS CRE_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.BIL_ISS_STS_CD) AS BIL_ISS_STS_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 1, 5)) AS FM_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.FM_NOD_CD, 6)) AS FM_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 1, 5)) AS TO_NOD_CD," ).append("\n"); 
		query.append("                    MAX(SUBSTR(A.TO_NOD_CD, 6)) AS TO_NOD_YARD," ).append("\n"); 
		query.append("                    MAX(D.VNDR_ABBR_NM) AS VNDR_ABBR_NM," ).append("\n"); 
		query.append("                    MAX(A.BL_NO) AS BL_NO," ).append("\n"); 
		query.append("                    MAX(DECODE(A.BIL_ISS_STS_CD, 'I', C.BKG_NO, A.BKG_NO)) AS BKG_NO," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_SNT_DT, 'YYYYMMDD')) AS BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_SNT_DT, 'HH24MISS')) AS BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                            ) , 'YYYYMMDD'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("                    MAX( TO_CHAR( GREATEST( " ).append("\n"); 
		query.append("                                            NVL( CR.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') ),  " ).append("\n"); 
		query.append("                                            NVL( C.BIL_EDI_RSND_DT, TO_DATE('20000101', 'YYYYMMDD') )" ).append("\n"); 
		query.append("                                            ) , 'HH24MISS'" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("                        ) AS BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.BIL_EDI_RCV_RSLT_CD) AS BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'YYYYMMDD')) AS BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.BIL_EDI_RCV_RSLT_DT, 'HH24MISS')) AS BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    C.WBL_NO AS WAYBILL_NO," ).append("\n"); 
		query.append("                    MAX(C.MTC_EDI_IND_CD) AS MTC_EDI_IND_CD," ).append("\n"); 
		query.append("                    MAX(C.MTC_EDI_RCV_RSLT_FLG) AS MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'YYYYMMDD')) AS MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(C.MTC_EDI_RCV_RSLT_DT, 'HH24MISS')) AS MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'YYYYMMDD')) AS CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(CFM.SND_DT, 'HH24MISS')) AS CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(A.PROV_VNDR_SEQ) AS PROV_VNDR_SEQ," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'YYYYMMDD')) AS CXL_RQST_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_DT, 'HH24MISS')) AS CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("                    MAX(CASE WHEN A.CXL_RQST_FLG = 'N' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'Y' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested Rejected'" ).append("\n"); 
		query.append("                             WHEN A.CXL_RQST_FLG = 'Y' AND NVL(A.CXL_RQST_RJCT_FLG, 'N') = 'N' AND A.DELT_FLG = 'N' THEN 'Cancellation Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'E' THEN 'EDI Error'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'V' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.DELT_FLG = 'N' AND C.BIL_EDI_RCV_RSLT_CD = 'A' THEN 'Acknowledged'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' AND C.BIL_ISS_STS_CD = 'X' THEN 'Rail Billing Cancelled'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'I' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Rail Billed'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'C' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                             WHEN A.TRSP_SO_STS_CD = 'R' AND A.SPND_FLG = 'N' AND A.DELT_FLG = 'N' THEN 'Requested'" ).append("\n"); 
		query.append("                    END) STATUS_NM," ).append("\n"); 
		query.append("                    MAX(A.CXL_RQST_RSN) AS CXL_RQST_RSN," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'YYYYMMDD')) AS CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("                    MAX(TO_CHAR(A.CXL_RQST_RJCT_DT, 'HH24MISS')) AS CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("                    MAX(C.CXL_RQST_RJCT_RSN) AS CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("                    MAX(NVL(C.INTER_RMK, A.INTER_RMK)) AS INTER_RMK," ).append("\n"); 
		query.append("                    MAX(C.SPCL_INSTR_RMK) AS SPCL_INSTR_RMK," ).append("\n"); 
		query.append("                    MAX(A.SPCL_CGO_CNTR_TP_CD) AS SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("                    MAX(C.RAIL_ORD_RJCT_FLG) AS RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("                    MAX(C.LOCL_CRE_DT) AS CCREDT," ).append("\n"); 
		query.append("                    MAX(A.SLAN_CD) AS SLAN_CD," ).append("\n"); 
		query.append("                    MAX(A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD) AS TRUNKVVD," ).append("\n"); 
		query.append("--                    MAX(A.CNTR_WGT) AS CNTR_WGT," ).append("\n"); 
		query.append("                    MAX(A.IBD_NO) AS IBD_NO," ).append("\n"); 
		query.append("                    MAX((SELECT NVL(CSTMS_IBD.IBD_TRSP_NO, ' ')" ).append("\n"); 
		query.append("                           FROM BKG_CSTMS_ADV_IBD CSTMS_IBD" ).append("\n"); 
		query.append("                          WHERE CSTMS_IBD.BL_NO = A.BL_NO" ).append("\n"); 
		query.append("                            AND CSTMS_IBD.CNT_CD = 'US')) CSTMS_IBD_NO," ).append("\n"); 
		query.append("                    MAX(A.RAIL_CRR_REF_NO) AS RAIL_CRR_REF_NO," ).append("\n"); 
		query.append("                    MAX(A.SHPR_CUST_NM) AS SHPR_CUST_NM," ).append("\n"); 
		query.append("                    MAX(A.CNEE_CUST_NM) AS CNEE_CUST_NM," ).append("\n"); 
		query.append("                    MAX(C.CRE_USR_ID) AS EDI_USR_ID," ).append("\n"); 
		query.append("                    MAX(A.TRSP_FRST_FLG) AS TRSP_FRST_FLG," ).append("\n"); 
		query.append("                    MAX(C.WO_RJCT_RSN) AS WO_RJCT_RSN," ).append("\n"); 
		query.append("                    MAX(DECODE(A.CGO_TP_CD, 'M', NULL, DECODE(BC.CNTR_NO, NULL, 'N', 'Y'))) AS BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("                    MAX(A.IBD_CSTMS_CLR_LOC_CD) AS IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("					MAX(A.POR_NOD_CD) AS POR_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.POL_NOD_CD) AS POL_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.POD_NOD_CD) AS POD_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.DEL_NOD_CD) AS DEL_NOD_CD," ).append("\n"); 
		query.append("					MAX(A.DEL_SCC_CD) AS DEL_SCC_CD," ).append("\n"); 
		query.append("					MAX(A.STCC_CD) AS STCC_CD," ).append("\n"); 
		query.append("					MAX(A.STCC_DESC) AS STCC_DESC," ).append("\n"); 
		query.append("					MAX(A.CNTR_SEAL_NO) AS CNTR_SEAL_NO," ).append("\n"); 
		query.append("                    MAX(A.TRSP_BND_CD) AS TRSP_BND_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_CD AS AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("                    A.AUTO_XPT_SYS_NO AS AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_OFC_CTY_CD) AS TRSP_AGMT_OFC_CTY_CD," ).append("\n"); 
		query.append("                    MAX(B.TRSP_AGMT_SEQ) AS TRSP_AGMT_SEQ," ).append("\n"); 
		query.append("                    MAX(B.CURR_CD) CURR_CD," ).append("\n"); 
		query.append("                    SUM(B.BZC_AMT) BZC_AMT," ).append("\n"); 
		query.append("                    SUM(B.FUEL_SCG_AMT) FUEL_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.OVR_WGT_SCG_AMT) OVR_WGT_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.HZD_MTRL_SCG_AMT) HZD_MTRL_SCG_AMT," ).append("\n"); 
		query.append("                    SUM(B.ETC_ADD_AMT) ETC_ADD_AMT," ).append("\n"); 
		query.append("                    MAX(A.DELT_FLG) DELT_FLG," ).append("\n"); 
		query.append("					MAX(A.CND_CSTMS_CLR_FLG) CND_CSTMS_CLR_FLG," ).append("\n"); 
		query.append("					MAX(A.UPLN_SO_FLG) UPLN_SO_FLG," ).append("\n"); 
		query.append("                    MAX(CASE WHEN B.SUB_RAIL_SEQ = 2 THEN B.FM_NOD_CD ELSE '' END) AS INTERCHANGE_1," ).append("\n"); 
		query.append("                    MAX(CASE WHEN B.SUB_RAIL_SEQ = 3 THEN B.FM_NOD_CD ELSE '' END) AS INTERCHANGE_2" ).append("\n"); 
		query.append("                FROM" ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_ORD A," ).append("\n"); 
		query.append("                    TRS_TRSP_RAIL_BIL_VNDR_SET B," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD C," ).append("\n"); 
		query.append("                    TRS_TRSP_EDI_RAIL_ORD_RSND CR," ).append("\n"); 
		query.append("                    BKG_CONTAINER BC," ).append("\n"); 
		query.append("                    MDM_VENDOR D," ).append("\n"); 
		query.append("                    TRS_TRSP_CFM_MSG_HIS CFM" ).append("\n"); 
		query.append("                WHERE A.TRSP_SO_OFC_CTY_CD = B.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = B.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = C.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = C.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CR.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CR.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   B.VNDR_SEQ = NVL(C.VNDR_SEQ, B.VNDR_SEQ)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_OFC_CTY_CD = CFM.TRSP_SO_OFC_CTY_CD (+)" ).append("\n"); 
		query.append("                AND   A.TRSP_SO_SEQ = CFM.TRSP_SO_SEQ (+)" ).append("\n"); 
		query.append("                AND   A.BKG_NO = BC.BKG_NO (+)" ).append("\n"); 
		query.append("                AND   A.EQ_NO = BC.CNTR_NO (+)" ).append("\n"); 
		query.append("                AND   B.VNDR_SEQ = D.VNDR_SEQ" ).append("\n"); 
		query.append("                AND   A.RAIL_CMB_THRU_TP_CD IN ('S2R', 'S3R')" ).append("\n"); 
		query.append("                AND   A.CRE_OFC_CD IN (@[ctrlOfcCd], 'SYSTEM')" ).append("\n"); 
		query.append("#if(${incHistory} != \'H\')" ).append("\n"); 
		query.append("                AND   A.DELT_FLG = 'N'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                AND   NVL(A.SPND_FLG, 'N') = 'N'" ).append("\n"); 
		query.append("                AND   NVL(A.BIL_ISS_STS_CD,'XX') <> 'I'  " ).append("\n"); 
		query.append("               -- AND   C.CRE_OFC_CD = ^[ctrlOfcCd]" ).append("\n"); 
		query.append("#if($bkg.size() > 0)" ).append("\n"); 
		query.append("                AND   ( A.BKG_NO ) IN (" ).append("\n"); 
		query.append("          #foreach($key IN ${bkg})" ).append("\n"); 
		query.append("           #if($velocityCount == 1)" ).append("\n"); 
		query.append("            '$key'" ).append("\n"); 
		query.append("           #else" ).append("\n"); 
		query.append("            ,'$key'" ).append("\n"); 
		query.append("           #end" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("           )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($vvd.size() > 0)" ).append("\n"); 
		query.append(" AND ((A.VSL_CD, A.SKD_VOY_NO, A.SKD_DIR_CD) IN (" ).append("\n"); 
		query.append(" #foreach($key IN ${vvd})" ).append("\n"); 
		query.append("  #if($velocityCount == 1)      " ).append("\n"); 
		query.append("   ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("  #else" ).append("\n"); 
		query.append("   , ( SUBSTR('$key', 1, 4), SUBSTR('$key', 5, 4), SUBSTR('$key', 9))" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append(" )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($bl.size() > 0)" ).append("\n"); 
		query.append(" AND (A.BL_NO IN ( " ).append("\n"); 
		query.append("      #foreach($key IN ${bl})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($cntr.size() > 0)" ).append("\n"); 
		query.append(" AND A.EQ_NO IN (" ).append("\n"); 
		query.append("      #foreach($key IN ${cntr})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($ref_no.size() > 0)" ).append("\n"); 
		query.append(" AND A.REF_ID IN (" ).append("\n"); 
		query.append("      #foreach($key IN ${ref_no})" ).append("\n"); 
		query.append("       #if($velocityCount == 1)" ).append("\n"); 
		query.append("        '$key'" ).append("\n"); 
		query.append("       #else" ).append("\n"); 
		query.append("        ,'$key'" ).append("\n"); 
		query.append("       #end" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("     )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${frmDate} != \'\' && ${toDate} != \'\')" ).append("\n"); 
		query.append(" #if(${radDate} == \'DS\')" ).append("\n"); 
		query.append("  AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #elseif(${radDate} == \'DB\')" ).append("\n"); 
		query.append("  AND A.LOCL_CRE_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD')-21 AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append("  AND C.BIL_EDI_SNT_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #elseif(${radDate} == \'DC\')" ).append("\n"); 
		query.append("  AND A.CXL_RQST_DT BETWEEN TO_DATE(@[frmDate], 'YYYYMMDD') AND TO_DATE(@[toDate], 'YYYYMMDD')+0.99999999" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${frmNode} != \'\')" ).append("\n"); 
		query.append(" AND A.FM_NOD_CD LIKE @[frmNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${toNode} != \'\')" ).append("\n"); 
		query.append(" AND A.TO_NOD_CD LIKE @[toNode]||'%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${radVendor} == \'V2\' && ${svcProvid} != \'\')" ).append("\n"); 
		query.append(" AND A.PROV_VNDR_SEQ = @[svcProvid]" ).append("\n"); 
		query.append("#elseif(${radVendor} == \'V1\' && ${railRoad} != \'ALL\')" ).append("\n"); 
		query.append(" AND B.VNDR_SEQ = @[railRoad]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${status} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.TRSP_SO_STS_CD = @[status]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${edKind} != \'ALL\')" ).append("\n"); 
		query.append(" AND C.BIL_ISS_STS_CD = @[edKind]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${fuEmpy} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.CGO_TP_CD = @[fuEmpy]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${bound} != \'ALL\')" ).append("\n"); 
		query.append(" AND A.TRSP_BND_CD = @[bound]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${bkgAtch} != \'ALL\')" ).append("\n"); 
		query.append(" #if(${bkgAtch} == \'N\')" ).append("\n"); 
		query.append("  AND BC.CNTR_NO IS NULL" ).append("\n"); 
		query.append("  AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append(" #elseif(${bkgAtch} == \'Y\')" ).append("\n"); 
		query.append("  AND BC.CNTR_NO IS NOT NULL" ).append("\n"); 
		query.append("  AND A.BKG_NO IS NOT NULL" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  AND DECODE(@[unplanned], 'ALL', 'X', NVL(A.UPLN_SO_FLG, 'N')) = DECODE(@[unplanned], 'ALL', 'X', @[unplanned])" ).append("\n"); 
		query.append("#if(${pod_n} != '')" ).append("\n"); 
		query.append("  AND A.POD_NOD_CD LIKE @[pod_n] || '%'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if(${through} != \'ALL\')" ).append("\n"); 
		query.append("    #if(${through} == \'E\')" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD <> 'W'" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("        AND A.TRSP_RAIL_BIL_TP_CD = 'W'" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                GROUP BY " ).append("\n"); 
		query.append("                        A.TRSP_SO_OFC_CTY_CD, " ).append("\n"); 
		query.append("                        A.TRSP_SO_SEQ, " ).append("\n"); 
		query.append("                        B.SUB_RAIL_SEQ, " ).append("\n"); 
		query.append("                        C.BIL_ISS_KNT, " ).append("\n"); 
		query.append("                        A.AUTO_XPT_SYS_CD, " ).append("\n"); 
		query.append("                        A.AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("                        C.WBL_NO" ).append("\n"); 
		query.append("            ) X" ).append("\n"); 
		query.append("    ) M," ).append("\n"); 
		query.append("    TRS_TRSP_RAIL_EDI_NOD S," ).append("\n"); 
		query.append("    TRS_TRSP_RAIL_EDI_NOD T" ).append("\n"); 
		query.append("WHERE NVL(M.POL_NOD_CD, M.FM_NOD_CD||M.FM_NOD_YARD) = S.EDI_RCV_NOD_CD (+)" ).append("\n"); 
		query.append("AND   NVL(M.POD_NOD_CD, M.TO_NOD_CD||M.TO_NOD_YARD) = T.EDI_RCV_NOD_CD (+)" ).append("\n"); 
		query.append("#if(${incHistory} != \'H\')" ).append("\n"); 
		query.append(" AND M.LASTCHK = 'Y' " ).append("\n"); 
		query.append(" AND NOT EXISTS (SELECT 1" ).append("\n"); 
		query.append("                   FROM TRS_TRSP_RAIL_BIL_VNDR_SET S1" ).append("\n"); 
		query.append("                         WHERE S1.TRSP_SO_OFC_CTY_CD = M.TRSP_SO_OFC_CTY_CD" ).append("\n"); 
		query.append("                           AND S1.TRSP_SO_SEQ = M.TRSP_SO_SEQ" ).append("\n"); 
		query.append("                           AND S1.INV_NO IS NOT NULL)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("    M.INV_NO, M.LASTCHK, M.COP_NO, M.COST_ACT_GRP_SEQ, M.SUB_RAIL_SEQ, M.VNDR_SEQ, " ).append("\n"); 
		query.append("    M.TRSP_SO_OFC_CTY_CD," ).append("\n"); 
		query.append("    M.TRSP_SO_SEQ," ).append("\n"); 
		query.append("    M.WO_RJCT_RSN," ).append("\n"); 
		query.append("    M.CXL_RQST_FLG," ).append("\n"); 
		query.append("    M.REPO_PLN_ID," ).append("\n"); 
		query.append("    M.PLN_YRWK," ).append("\n"); 
		query.append("    M.REF_ID," ).append("\n"); 
		query.append("    M.REF_SEQ," ).append("\n"); 
		query.append("    M.RAIL_CMB_THRU_TP_CD," ).append("\n"); 
		query.append("    M.CRE_OFC_CD," ).append("\n"); 
		query.append("    M.BKG_CGO_TP_CD," ).append("\n"); 
		query.append("    M.TRSP_SO_STS_CD," ).append("\n"); 
		query.append("	M.STATUS," ).append("\n"); 
		query.append("    M.TRSP_RAIL_BIL_TP_CD," ).append("\n"); 
		query.append("    M.EQ_NO," ).append("\n"); 
		query.append("    M.EQ_TPSZ_CD," ).append("\n"); 
		query.append("    M.CGO_TP_CD," ).append("\n"); 
		query.append("    M.CRE_DT," ).append("\n"); 
		query.append("    M.CRE_DT_HMS," ).append("\n"); 
		query.append("    M.BIL_ISS_STS_CD," ).append("\n"); 
		query.append("    M.FM_NOD_CD," ).append("\n"); 
		query.append("    M.FM_NOD_YARD," ).append("\n"); 
		query.append("    M.TO_NOD_CD," ).append("\n"); 
		query.append("    M.TO_NOD_YARD," ).append("\n"); 
		query.append("    M.VNDR_ABBR_NM," ).append("\n"); 
		query.append("    M.BL_NO," ).append("\n"); 
		query.append("    M.BKG_NO," ).append("\n"); 
		query.append("    M.BIL_EDI_SNT_DT," ).append("\n"); 
		query.append("    M.BIL_EDI_SNT_DT_HMS," ).append("\n"); 
		query.append("    M.BIL_EDI_RSNT_DT," ).append("\n"); 
		query.append("    M.BIL_EDI_RSNT_DT_HMS," ).append("\n"); 
		query.append("    M.BIL_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("    M.BIL_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("    M.WAYBILL_NO, " ).append("\n"); 
		query.append("    M.MTC_EDI_RCV_RSLT_FLG," ).append("\n"); 
		query.append("    M.MTC_EDI_RCV_RSLT_DT," ).append("\n"); 
		query.append("    SUBSTR(M.BKG_SPE, 0, LENGTH(M.BKG_SPE)-1)," ).append("\n"); 
		query.append("    M.SPCL_CGO_CNTR_TP_CD," ).append("\n"); 
		query.append("    M.MTC_EDI_RCV_RSLT_DT_HMS," ).append("\n"); 
		query.append("    M.CFM_MSG_SNT_DT," ).append("\n"); 
		query.append("    M.CFM_MSG_SNT_DT_HMS," ).append("\n"); 
		query.append("    M.PROV_VNDR_SEQ," ).append("\n"); 
		query.append("    M.CXL_RQST_DT," ).append("\n"); 
		query.append("    M.CXL_RQST_DT_HMS," ).append("\n"); 
		query.append("    M.CXL_RQST_RSN," ).append("\n"); 
		query.append("    M.CXL_RQST_RJCT_DT," ).append("\n"); 
		query.append("    M.CXL_RQST_RJCT_DT_HMS," ).append("\n"); 
		query.append("    M.CXL_RQST_RJCT_RSN," ).append("\n"); 
		query.append("    M.INTER_RMK," ).append("\n"); 
		query.append("    M.SPCL_INSTR_RMK," ).append("\n"); 
		query.append("    M.RAIL_ORD_RJCT_FLG," ).append("\n"); 
		query.append("    TO_CHAR(M.CCREDT, 'YYYYMMDDHH24MISS')," ).append("\n"); 
		query.append("    M.BIL_ISS_KNT, S.EDI_RCV_VNDR_ABBR_NM, T.EDI_RCV_VNDR_ABBR_NM," ).append("\n"); 
		query.append("    M.SLAN_CD," ).append("\n"); 
		query.append("    M.TRUNKVVD," ).append("\n"); 
		query.append("    M. CNTR_WGT_STR," ).append("\n"); 
		query.append("    M.IBD_NO," ).append("\n"); 
		query.append("    M.RAIL_CRR_REF_NO," ).append("\n"); 
		query.append("    M.SHPR_CUST_NM," ).append("\n"); 
		query.append("    M.CNEE_CUST_NM," ).append("\n"); 
		query.append("    M.EDI_USR_ID," ).append("\n"); 
		query.append("    M.TRSP_FRST_FLG," ).append("\n"); 
		query.append("    M.CMDT_NAME," ).append("\n"); 
		query.append("    M.REF_NO," ).append("\n"); 
		query.append("    M.AUTO_XPT_SYS_CD," ).append("\n"); 
		query.append("    M.AUTO_XPT_SYS_NO," ).append("\n"); 
		query.append("    M.BKG_CNTR_ATTACHED," ).append("\n"); 
		query.append("    M.IBD_CSTMS_CLR_LOC_CD," ).append("\n"); 
		query.append("    M.TRSP_BND_CD," ).append("\n"); 
		query.append("    M.BIL_EDI_RCV_RSLT_CD," ).append("\n"); 
		query.append("    M.DELT_FLG," ).append("\n"); 
		query.append("    M.POR_NOD_CD," ).append("\n"); 
		query.append("    M.POL_NOD_CD," ).append("\n"); 
		query.append("    M.POD_NOD_CD," ).append("\n"); 
		query.append("    M.DEL_NOD_CD," ).append("\n"); 
		query.append("    M.DEL_SCC_CD," ).append("\n"); 
		query.append("    M.STCC_CD," ).append("\n"); 
		query.append("    M.STCC_DESC," ).append("\n"); 
		query.append("    M.CNTR_SEAL_NO," ).append("\n"); 
		query.append("	M.INTERCHANGE_1," ).append("\n"); 
		query.append("    M.INTERCHANGE_2," ).append("\n"); 
		query.append("    M.STATUS_NM" ).append("\n"); 
		query.append("ORDER BY " ).append("\n"); 
		query.append("    M.TRSP_SO_OFC_CTY_CD, M.TRSP_SO_SEQ, M.BIL_ISS_KNT DESC" ).append("\n"); 

	}
}