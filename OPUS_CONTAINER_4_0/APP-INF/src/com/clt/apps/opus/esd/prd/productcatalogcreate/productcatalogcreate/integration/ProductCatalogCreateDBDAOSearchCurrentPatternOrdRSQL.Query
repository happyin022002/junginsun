<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ProductCatalogCreateDBDAOSearchCurrentPatternOrdRSQL">
			<desc><![CDATA[ProductCatalogCreateDBDAOSearchCurrentPatternOrdRSQL.Query]]></desc>
			<sql><![CDATA[
SELECT 
PCTL_NO, BKG_NO, COP_NO, CRNT_FLG, CNTR_NO, CNTR_TPSZ_CD, COP_OP_TP_CD,
OB_ITCHG_CTNT, MTY_PKUP_YD_CD, BKG_OP_RMK, MTY_RTN_YD_CD, IB_ITCHG_CTNT,
POR_NOD_CD, OCN_ITCHG_CTNT, POL_NOD_CD, BKG_RCV_TERM_CD, BKG_DE_TERM_CD,
OB_TRO_FLG, IB_TRO_FLG, COP_PATT_ORD_NO, COP_SO_KNT,COP_MAPG_SEQ
from
(
	SELECT 
	PCTL_NO, BKG_NO, COP_NO, CRNT_FLG, CNTR_NO, CNTR_TPSZ_CD, COP_OP_TP_CD,
	OB_ITCHG_CTNT, MTY_PKUP_YD_CD, BKG_OP_RMK, MTY_RTN_YD_CD, IB_ITCHG_CTNT,
	POR_NOD_CD, OCN_ITCHG_CTNT, POL_NOD_CD, BKG_RCV_TERM_CD, BKG_DE_TERM_CD,
	OB_TRO_FLG, IB_TRO_FLG, COP_PATT_ORD_NO, COP_SO_KNT,COP_MAPG_SEQ,
	row_number() over (partition by COP_PATT_ORD_NO order by COP_PATT_ORD_NO) rn,
	COUNT(*) OVER (PARTITION BY COP_PATT_ORD_NO) CNT
	FROM PRD_BKG_COP_MAP M
	WHERE 1 = 1
#if	(${pctl_no} != '')
	AND   PCTL_NO 		= @[pctl_no]
	AND	  BKG_NO 		= @[bkg_no]
	AND	  COP_NO 		= @[cop_no]
#end
#if	(${cop_mapg_seq} != '')
	AND   COP_MAPG_SEQ 	= @[cop_mapg_seq]
#end
#if	(${pctl_no} == ''  &&  ${cop_mapg_seq} == '') 
	AND 1 = 2
#end
)
WHERE RN = 1
ORDER BY COP_PATT_ORD_NO,NVL(POL_NOD_CD,'AAAAA00'), CNT DESC			]]></sql>
			<params>
				<param name="pctl_no" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="cop_no" type="12" value="" out="N"/>
				<param name="cop_mapg_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
