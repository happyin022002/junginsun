<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CSRIssueTransferSlipManageDBDAOSearchInvoiceInquiryRSQL">
			<desc><![CDATA[Invoice 조회]]></desc>
			<sql><![CDATA[
SELECT HDR.CSR_NO
      ,HDR.VNDR_NO
      ,TRS_COMMON_PKG.GET_VNDR_FULL_NM_FNC(HDR.VNDR_NO) VNDR_NM
      ,INV_WRK.INV_CNT
      ,HDR.CSR_CURR_CD
      ,TO_CHAR(HDR.CSR_AMT, 'FM999,999,999,999,990.90') CSR_AMT
      ,TO_CHAR(INV_WRK.INV_ISS_DT, 'YYYY-MM-DD') MAX_ISS_DT
      ,TO_CHAR(INV_WRK.INV_RCV_DT, 'YYYY-MM-DD') MAX_RCV_DT
      ,DECODE(HDR.PAY_MZD_LU_CD, 'CHK', HDR.ATTR_CTNT2, '') ASA_NO
      ,HDR.VNDR_TERM_NM
      ,DECODE(HDR.VNDR_TERM_NM, 'KR H/O PAYMENT_60', NULL, 'O60', NULL, TO_CHAR(TO_DATE(HDR.INV_TERM_DT, 'YYYYMMDD'), 'YYYY-MM-DD')) PRE_DUE_DATE
      ,INV_WRK.CRE_OFC_CD AS COST_OFC
  FROM AP_INV_HDR HDR
      ,(SELECT CSR_NO
              ,MAX(CRE_OFC_CD) CRE_OFC_CD
              ,MAX(INV_ISS_DT) INV_ISS_DT
              ,MAX(INV_RCV_DT) INV_RCV_DT
              ,COUNT(*) INV_CNT       
          FROM (SELECT CSR_NO
                      ,RAIL_INV_WRK.CRE_OFC_CD
                      ,RAIL_INV_WRK.INV_ISS_DT
                      ,INV_RCV_DT
                  FROM TRS_TRSP_RAIL_INV_WRK RAIL_INV_WRK
                UNION ALL
                SELECT CSR_NO
                      ,INV_WRK.CRE_OFC_CD
                      ,INV_ISS_DT
                      ,INV_RCV_DT
                  FROM TRS_TRSP_INV_WRK INV_WRK
                  )
         GROUP BY CSR_NO) INV_WRK
 WHERE INV_WRK.CSR_NO = HDR.CSR_NO
   AND HDR.CSR_NO = @[CSR_NO]			]]></sql>
			<params>
				<param name="CSR_NO" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
