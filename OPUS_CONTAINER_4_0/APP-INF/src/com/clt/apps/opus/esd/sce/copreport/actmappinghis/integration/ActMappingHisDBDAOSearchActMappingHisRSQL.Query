<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ActMappingHisDBDAOSearchActMappingHisRSQL">
			<desc><![CDATA[SearchActMappingHis]]></desc>
			<sql><![CDATA[
SELECT ACT_RCV_TP_CD,ACT_UMCH_TP_CD,ACT_STS_MAPG_CD,ACT_DT,ACT_STS_MAPG_CD, VVD, BKG_NO ,ACT_GAP_DESC,
       CNTR_NO,COP_NO,ACT_CD,NOD_CD,PLN_DT,ESTM_DT,MST_COP_NO,ACT_DAT_RCV_DT,UMCH_CHK_DT,DUP_FLG,
       UPD_DT,UPD_USR_ID,PAGE 
FROM(
       --SELECT CASE WHEN B.ACT_RCV_TP_CD ='1' THEN 'MVMT'
       --     WHEN B.ACT_RCV_TP_CD ='2' THEN 'VSL'
         --   WHEN B.ACT_RCV_TP_CD ='3' THEN '322'
         --   WHEN B.ACT_RCV_TP_CD ='4' THEN '214'
         --   WHEN B.ACT_RCV_TP_CD ='5' THEN 'SPP'
         --   WHEN B.ACT_RCV_TP_CD ='6' THEN 'Manual'
         --   ELSE B.ACT_RCV_TP_CD  END  ACT_RCV_TP_CD,
		(SELECT d.ACT_RCV_TP_DESC FROM SCE_ACT_RCV_DESC d WHERE d.ACT_RCV_TP_CD = b.ACT_RCV_TP_CD) ACT_RCV_TP_CD,
        DECODE(B.ACT_UMCH_TP_CD,'99','Y','N') ACT_UMCH_TP_CD,
        TO_CHAR(B.ACT_DT,'YYYY/MM/DD HH24:MI:SS') ACT_DT,
        B.ACT_STS_MAPG_CD ,
		B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD VVD,
--        C.VSL_CD||C.SKD_VOY_NO||C.SKD_DIR_CD  VVD,
        B.BKG_NO, 
		B.ACT_GAP_DESC,
        B.CNTR_NO,
        B.COP_NO,
        B.ACT_CD, 
        B.NOD_CD ,
        TO_CHAR(C.PLN_DT,'YYYY/MM/DD HH24:MI:SS') PLN_DT,
        TO_CHAR(C.ESTM_DT,'YYYY/MM/DD HH24:MI:SS') ESTM_DT,
        B.MST_COP_NO,
        TO_CHAR(C.ACT_DAT_RCV_DT,'YYYY/MM/DD HH24:MI:SS') ACT_DAT_RCV_DT,
        TO_CHAR(B.UMCH_CHK_DT,'YYYY/MM/DD HH24:MI:SS') UMCH_CHK_DT,
        B.DUP_FLG,
        TO_CHAR(B.UPD_DT,'YYYY/MM/DD HH24:MI:SS') UPD_DT,
        B.UPD_USR_ID,
        CEIL(rownum/3000) PAGE
        
        FROM SCE_ACT_RCV_HIS B, SCE_COP_DTL C

        WHERE C.cop_no(+) = B.cop_no
        AND C.act_cd(+) = B.act_cd

/* condition - ACT_RCV_TP_CD */
#if (${act_rcv_tp_cd} != '') 
	AND B.ACT_RCV_TP_CD =  @[act_rcv_tp_cd]
#end

/* condition - act_sts_mapg_cd */
#if (${act_sts_mapg_cd} != '') 
	AND B.ACT_STS_MAPG_CD =  @[act_sts_mapg_cd]
#end

/* condition - act_umch_tp_cd */
#if (${act_umch_tp_cd} != '') 
	AND DECODE(B.ACT_UMCH_TP_CD,'99','Y','N') =  @[act_umch_tp_cd]
#end

/* condition - act_fm_dt */
#if (${act_fm_dt} != '')
	AND B.act_rcv_dt BETWEEN REPLACE(@[act_fm_dt],'-') AND  REPLACE(@[act_to_dt],'-')
#end

/* condition - bkg_no */
#if (${bkg_no} != '') 
	AND B.BKG_NO =  @[bkg_no]
#end

/* condition - cntr_no */
#if (${cntr_no} != '') 
	AND B.CNTR_NO =  @[cntr_no]
#end

/* condition - cop_no */
#if (${cop_no} != '') 
	AND B.COP_NO =  @[cop_no]
#end


/* condition - vvd */
#if (${vvd} != '') 
AND B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD IN (
#foreach($ele IN ${vvd})
#if($velocityCount == 1 ) 
'$ele'
#else 
,'$ele' 
#end 
#end
) 
#end

/* condition - por_cd */
#if (${por_cd} != '') 
AND SUBSTR(B.NOD_CD,1,5) IN (SELECT POR_NOD_CD FROM SCE_COP_HDR WHERE COP_NO = B.COP_NO  AND POR_NOD_CD  IN(

#foreach($ele IN ${por_cd})
#if($velocityCount == 1 ) 
'$ele'
#else 
,'$ele' 
#end 
#end
)
)
#end

/* condition - pol_cd */
#if (${pol_cd} != '') 
AND SUBSTR(B.NOD_CD,1,5) IN (SELECT POL_NOD_CD FROM SCE_COP_HDR WHERE COP_NO = B.COP_NO  AND POL_NOD_CD  IN(
#foreach($ele IN ${pol_cd})
#if($velocityCount == 1 ) 
'$ele'
#else 
,'$ele' 
#end 
#end
)
#end

/* condition - pod_cd */
#if (${pod_cd} != '') 
AND SUBSTR(B.NOD_CD,1,5) IN (SELECT POD_NOD_CD FROM SCE_COP_HDR WHERE COP_NO = B.COP_NO  AND POD_NOD_CD  IN(
#foreach($ele IN ${pod_cd})
#if($velocityCount == 1 ) 
'$ele'
#else 
,'$ele' 
#end 
#end
)
#end

/* condition - del_cd */
#if (${del_cd} != '') 
AND SUBSTR(B.NOD_CD,1,5) IN (SELECT DEL_NOD_CD FROM SCE_COP_HDR WHERE COP_NO = B.COP_NO  AND DEL_NOD_CD  IN(
#foreach($ele IN ${del_cd})
#if($velocityCount == 1 ) 
'$ele'
#else 
,'$ele' 
#end 
#end
)
#end

)
WHERE
1=1
#if(${i_page} !='')
AND PAGE = TO_NUMBER(@[i_page])
#else
AND PAGE =1
#end			]]></sql>
			<params>
				<param name="act_rcv_tp_cd" type="12" value="" out="N"/>
				<param name="act_sts_mapg_cd" type="12" value="" out="N"/>
				<param name="act_umch_tp_cd" type="12" value="" out="N"/>
				<param name="act_fm_dt" type="12" value="" out="N"/>
				<param name="act_to_dt" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
				<param name="cop_no" type="12" value="" out="N"/>
				<param name="i_page" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
