<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JointOperationAccrualCreationDBDAOEstmActRsltVORSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
SELECT *
FROM   (
SELECT /*+INDEX(A XPKJOO_ESTM_ACT_RSLT)*/
       ROWNUM AS RN 
      ,'R' AS IBFLAG
      ,A.EXE_YRMON
      ,A.REV_YRMON
      ,A.JO_CRR_CD
      ,B.TRD_CD
      ,CASE WHEN A.ACCT_CD LIKE '4%' THEN
              B.CUST_CNT_CD||B.CUST_SEQ
            WHEN A.ACCT_CD LIKE '5%' THEN
              B.VNDR_SEQ||''
       END AS VNDR_CUST_SEQ
      ,CASE WHEN A.ACCT_CD LIKE '4%' THEN
              B.CUST_CNT_CD
            WHEN A.ACCT_CD LIKE '5%' THEN
              ''
       END AS CUST_CNT_CD
      ,CASE WHEN A.ACCT_CD LIKE '4%' THEN
              B.CUST_SEQ
            WHEN A.ACCT_CD LIKE '5%' THEN
              B.VNDR_SEQ
       END AS CUST_SEQ
      ,CASE WHEN A.ACCT_CD LIKE '4%' THEN
              'R'
            WHEN A.ACCT_CD LIKE '5%' THEN
              'E'
       END AS RE_DIVR_CD
      ,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD||A.REV_DIR_CD AS VVD
      ,A.VSL_CD
      ,A.SKD_VOY_NO
      ,A.SKD_DIR_CD
      ,A.REV_DIR_CD
      ,A.RLANE_CD
      ,A.JO_STL_JB_CD
      ,C.NAME AS JO_STL_JB_NM
      ,A.BSA_QTY
      ,A.BSA_SLT_PRC
      ,A.ACCT_CD
      ,ROUND(A.ESTM_AMT,2) AS ESTM_AMT
      ,ROUND(A.ACT_AMT,2) AS ACT_AMT
      ,ROUND(A.ACCL_AMT,2) AS ACCL_AMT
      ,ROUND(A.ESTM_AMT,2) - ROUND(A.ACT_AMT,2) AS DIFF_AMT
      ,A.ESTM_VVD_TP_CD
      ,A.JO_IOC_DIV_CD
      ,A.ESTM_VVD_HDR_ID
      ,A.CNTR_BLK_DIV_CD
      ,A.SYS_SRC_ID
      ,A.LOC_CD
      ,A.JO_CNTR_DIV_CTNT
      ,A.ACCL_AMT_CORR_FLG
      ,A.CRE_USR_ID
      ,A.UPD_USR_ID
      ,A.ESTM_ACT_SEQ
FROM   JOO_ESTM_ACT_RSLT A
      ,JOO_CARRIER       B
      ,(SELECT A.INTG_CD_VAL_CTNT AS CODE, A.INTG_CD_VAL_DP_DESC AS NAME FROM COM_INTG_CD_DTL A WHERE A.INTG_CD_ID = 'CD01866') C
WHERE  A.JO_CRR_CD = B.JO_CRR_CD
AND    A.RLANE_CD  = B.RLANE_CD
AND    B.DELT_FLG  = 'N'
AND    A.JO_STL_JB_CD = C.CODE(+)
AND    A.EXE_YRMON = REPLACE(@[exe_yrmon],'-','')
#if (${re_divr_cd} != '')
AND    A.ACCT_CD LIKE DECODE(@[re_divr_cd],'R','4','E','5')||'%'
#end
#if (${jo_crr_cd} != '')
AND    A.JO_CRR_CD = @[jo_crr_cd]
#end
#if (${trd_cd} != '')
AND    B.TRD_CD    = @[trd_cd]
#end
#if (${rlane_cd} != '')
AND    A.RLANE_CD  = @[rlane_cd]
#end
#if (${vvd} != '')
AND	   A.VSL_CD || A.SKD_VOY_NO || A.SKD_DIR_CD || A.REV_DIR_CD LIKE @[vvd]||'%'
#end
)
#if (${page_no} != '')
WHERE  RN >= (TO_NUMBER(@[page_no]) - 1) * TO_NUMBER(@[pagerows]) + 1 AND    RN <= TO_NUMBER(@[page_no]) * TO_NUMBER(@[pagerows])
#end			]]></sql>
			<params>
				<param name="exe_yrmon" type="12" value="" out="N"/>
				<param name="re_divr_cd" type="12" value="" out="N"/>
				<param name="jo_crr_cd" type="12" value="" out="N"/>
				<param name="trd_cd" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="page_no" type="12" value="" out="N"/>
				<param name="pagerows" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
