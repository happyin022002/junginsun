<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableInvoiceMigrationDBDAOAddVVDExchangeRateCSQL">
			<desc><![CDATA[Add VVD Exchange Rate]]></desc>
			<sql><![CDATA[
INSERT INTO OPUSADM_TMP.INV_VVD_XCH_RT
(
    VSL_CD
    , SKD_VOY_NO
    , SKD_DIR_CD
    , PORT_CD
    , SVC_SCP_CD
    , IO_BND_CD
    , LOCL_CURR_CD
    , CHG_CURR_CD 
    , AR_OFC_CD
    , INV_XCH_RT
    , IVS_XCH_RT
    , CRE_USR_ID
    , CRE_DT
    , UPD_USR_ID
    , UPD_DT
    , XCH_RT_DT
)
( 
SELECT
	A.VSL_CD
    , A.SKD_VOY_NO
    , A.SKD_DIR_CD
    , A.PORT_CD
    , A.SVC_SCP_CD
    , A.IO_BND_CD
    , B.LOCL_CURR_CD
    , B.CHG_CURR_CD
    , A.AR_OFC_CD
    , B.INV_XCH_RT
    , B.IVS_XCH_RT
    , A.CRE_USR_ID
    , SYSDATE
    , A.UPD_USR_ID
    , SYSDATE
    , A.XCH_RT_DT
FROM OPUSADM_TMP.INV_VVD_XCH_RT_DT A,
     OPUSADM_TMP.INV_CUST_AND_DLY_XCH_RT B
WHERE A.AR_OFC_CD = B.AR_OFC_CD
AND A.XCH_RT_DT = B.FM_DT
AND A.IO_BND_CD = B.IO_BND_CD
AND B.CUST_CNT_CD = 'XX'
AND B.CUST_SEQ = 0
AND B.XCH_RT_TP_CD = 'V'
#if (${ar_ofc_cd} != '')
    AND A.AR_OFC_CD = @[ar_ofc_cd]
#end
#if (${vvd_cd} != '')
    AND A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD = @[vvd_cd]
#end
)			]]></sql>
			<params>
				<param name="ar_ofc_cd" type="12" value="" out="N"/>
				<param name="vvd_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
