<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BookingARCreationDBDAOSearchExchangeRateTempListRSQL">
			<desc><![CDATA[SELECT INV_XCH_RT_TMP]]></desc>
			<sql><![CDATA[
SELECT
	 XCH_RT_TMP_SEQ
	,VSL_CD
	,SKD_VOY_NO
	,SKD_DIR_CD
	,PORT_CD
	,SVC_SCP_CD
	,IO_BND_CD
	,LOCL_CURR_CD
	,CHG_CURR_CD
	,AR_OFC_CD
	,INV_XCH_RT
	,IVS_XCH_RT
	,XCH_RT_DT
	,CUST_CNT_CD    
	,CUST_SEQ        
	,FM_DT           
	,TO_DT           
	,XCH_RT_TP_CD 
    ,'I' AS IBFLAG
	,CRE_USR_ID USR_ID
	,DECODE(XCH_RT_TP_CD, 'V', VSL_CD||SKD_VOY_NO||SKD_DIR_CD||PORT_CD||SVC_SCP_CD||IO_BND_CD||AR_OFC_CD,
                          'D', IO_BND_CD||AR_OFC_CD||FM_DT||TO_DT,
                          'I', IO_BND_CD||AR_OFC_CD||CUST_CNT_CD||CUST_SEQ||FM_DT||TO_DT) XCH_KEY_CD
FROM INV_XCH_RT_TMP
WHERE 1 = 1 
#if (${xch_rt_tmp_seq} != 'BAT')
	AND XCH_RT_TMP_SEQ = @[xch_rt_tmp_seq]
#else
	AND XCH_RT_TMP_SEQ = (SELECT MIN(XCH_RT_TMP_SEQ)
                          FROM INV_XCH_RT_TMP
						  WHERE CRE_DT < SYSDATE - 0.00347)
#end
ORDER BY DECODE(XCH_RT_TP_CD, 'V', VSL_CD||SKD_VOY_NO||SKD_DIR_CD||PORT_CD||SVC_SCP_CD||IO_BND_CD||AR_OFC_CD,
                              'D', IO_BND_CD||AR_OFC_CD||FM_DT||TO_DT,
                              'I', IO_BND_CD||AR_OFC_CD||CUST_CNT_CD||CUST_SEQ||FM_DT||TO_DT)			]]></sql>
			<params>
				<param name="xch_rt_tmp_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
