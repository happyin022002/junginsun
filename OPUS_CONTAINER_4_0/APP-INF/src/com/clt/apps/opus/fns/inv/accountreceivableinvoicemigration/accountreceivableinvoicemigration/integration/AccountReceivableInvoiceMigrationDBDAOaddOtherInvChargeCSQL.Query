<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableInvoiceMigrationDBDAOaddOtherInvChargeCSQL">
			<desc><![CDATA[AccountReceivableInvoiceMigrationDBDAOaddOtherInvChargeCSQL]]></desc>
			<sql><![CDATA[
INSERT INTO OPUSADM_TMP.INV_AR_CHG (
AR_IF_NO
,AR_IF_SER_NO
,CHG_SEQ
,CHG_CD
,CURR_CD
,PER_TP_CD
,TRF_RT_AMT
,RAT_AS_CNTR_QTY
,CHG_AMT
,INV_XCH_RT -- 10
,REP_CHG_CD
,CHG_FULL_NM
,INV_ISS_FLG
,INV_CLR_FLG
,SOB_ID
,INV_REV_TP_SRC_CD
,REV_COA_CO_CD
,REV_COA_RGN_CD
,REV_COA_CTR_CD
,REV_COA_ACCT_CD -- 20
,REV_COA_INTER_CO_CD
,REV_COA_VSL_CD
,REV_COA_VOY_NO
,REV_COA_SKD_DIR_CD
,REV_COA_DIR_CD
,ACCT_CD
,TVA_FLG
,CHG_RMK
,MNL_FLG
,MF_DIV_CD -- 30
,CRE_USR_ID
,CRE_DT
,UPD_USR_ID
,UPD_DT
,INV_XCH_RT_DT
,TJ_SRC_NM
,AR_IF_CHG_SEQ
,USD_XCH_RT
,ISS_XCH_RT
)VALUES(
@[ar_if_no]
,@[ar_if_ser_no]
,@[chg_seq]
,(SELECT DECODE(@[chg_cd], 'VAT', (SELECT NVL(MAX(CHG_CD), 'TVA') FROM MDM_CHARGE WHERE TAX_FLG = 'Y' AND TAX_CNT_CD = B.CNT_CD), @[chg_cd])
  FROM MDM_ORGANIZATION A,
       MDM_LOCATION B
  WHERE A.LOC_CD = B.LOC_CD
  AND A.OFC_CD = @[ofc_cd])
,@[curr_cd]
,@[per_tp_cd]
,NVL(@[trf_rt_amt], 0)
,NVL(@[rat_as_cntr_qty], 0)
,NVL((SELECT ROUND(NVL(@[chg_amt],0),DP_PRCS_KNT) FROM MDM_CURRENCY WHERE CURR_CD = SUBSTR(@[curr_cd], 1, 3)), 0)
,NVL(@[inv_xch_rt], 0) -- 10
,(SELECT REP_CHG_CD FROM MDM_CHARGE WHERE CHG_CD = @[chg_cd])
,(SELECT CHG_NM FROM MDM_CHARGE WHERE CHG_CD = @[chg_cd])
,NVL(@[inv_iss_flg],'N')
,NVL(@[inv_clr_flg],'N')
,1
,@[inv_rev_tp_src_cd]
,'01'
,(SELECT FINC_RGN_CD FROM MDM_ORGANIZATION WHERE OFC_CD = @[ofc_cd])
,(SELECT AR_CTR_CD FROM MDM_ORGANIZATION WHERE OFC_CD = @[ofc_cd])
,@[rev_coa_acct_cd] -- 20
,@[rev_coa_inter_co_cd]
,(DECODE(@[rev_coa_acct_cd], null, '', DECODE(SUBSTR(@[rev_coa_acct_cd],1,1), '4', @[rev_coa_vsl_cd], '7', @[rev_coa_vsl_cd], DECODE(SUBSTR(@[rev_coa_acct_cd],1,2), '51', @[rev_coa_vsl_cd], '0000'))))
,(DECODE(@[rev_coa_acct_cd], null, '', DECODE(SUBSTR(@[rev_coa_acct_cd],1,1), '4', @[rev_coa_voy_no], '7', @[rev_coa_voy_no], DECODE(SUBSTR(@[rev_coa_acct_cd],1,2), '51', @[rev_coa_voy_no], '0000'))))
,(DECODE(@[rev_coa_acct_cd], null, '', DECODE(SUBSTR(@[rev_coa_acct_cd],1,1), '4', @[rev_coa_skd_dir_cd], '7', @[rev_coa_skd_dir_cd], DECODE(SUBSTR(@[rev_coa_acct_cd],1,2), '51', @[rev_coa_skd_dir_cd], '0'))))
,(DECODE(@[rev_coa_acct_cd], null, '', DECODE(SUBSTR(@[rev_coa_acct_cd],1,1), '4', @[rev_coa_dir_cd], '7', @[rev_coa_dir_cd], DECODE(SUBSTR(@[rev_coa_acct_cd],1,2), '51', @[rev_coa_dir_cd], '0'))))
,@[acct_cd]
,@[tva_flg]
,@[chg_rmk]
,'Y'
,'N' -- 30
,@[cre_usr_id]
,SYSDATE
,@[upd_usr_id]
,SYSDATE
,@[inv_xch_rt_dt]
,@[tj_src_nm]
,@[ar_if_chg_seq]
,NVL(@[usd_xch_rt], 0)
,1
)			]]></sql>
			<params>
				<param name="ar_if_no" type="12" value="" out="N"/>
				<param name="ar_if_ser_no" type="12" value="" out="N"/>
				<param name="chg_seq" type="12" value="" out="N"/>
				<param name="chg_cd" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="curr_cd" type="12" value="" out="N"/>
				<param name="per_tp_cd" type="12" value="" out="N"/>
				<param name="trf_rt_amt" type="12" value="" out="N"/>
				<param name="rat_as_cntr_qty" type="12" value="" out="N"/>
				<param name="chg_amt" type="12" value="" out="N"/>
				<param name="inv_xch_rt" type="12" value="" out="N"/>
				<param name="inv_iss_flg" type="12" value="" out="N"/>
				<param name="inv_clr_flg" type="12" value="" out="N"/>
				<param name="inv_rev_tp_src_cd" type="12" value="" out="N"/>
				<param name="rev_coa_acct_cd" type="12" value="" out="N"/>
				<param name="rev_coa_inter_co_cd" type="12" value="" out="N"/>
				<param name="rev_coa_vsl_cd" type="12" value="" out="N"/>
				<param name="rev_coa_voy_no" type="12" value="" out="N"/>
				<param name="rev_coa_skd_dir_cd" type="12" value="" out="N"/>
				<param name="rev_coa_dir_cd" type="12" value="" out="N"/>
				<param name="acct_cd" type="12" value="" out="N"/>
				<param name="tva_flg" type="12" value="" out="N"/>
				<param name="chg_rmk" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="inv_xch_rt_dt" type="12" value="" out="N"/>
				<param name="tj_src_nm" type="12" value="" out="N"/>
				<param name="ar_if_chg_seq" type="12" value="" out="N"/>
				<param name="usd_xch_rt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
