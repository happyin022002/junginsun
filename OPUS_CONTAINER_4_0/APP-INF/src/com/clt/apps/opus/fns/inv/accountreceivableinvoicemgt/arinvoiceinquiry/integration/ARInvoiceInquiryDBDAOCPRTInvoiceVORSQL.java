/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : ARInvoiceInquiryDBDAOCPRTInvoiceVORSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.11.10
*@LastModifier : 
*@LastVersion : 1.0
* 2016.11.10 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.fns.inv.accountreceivableinvoicemgt.arinvoiceinquiry.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class ARInvoiceInquiryDBDAOCPRTInvoiceVORSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  *    
	  * </pre>
	  */
	public ARInvoiceInquiryDBDAOCPRTInvoiceVORSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_gb",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ar_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("frt_term_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ob_sls_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pol_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("from_date",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rpt_tmplt_nm",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("del_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("por_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sc_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("pod_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_date",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("bkg_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rfa_no",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.fns.inv.accountreceivableinvoicemgt.arinvoiceinquiry.integration").append("\n"); 
		query.append("FileName : ARInvoiceInquiryDBDAOCPRTInvoiceVORSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT	RPT_TMPLT_NM " ).append("\n"); 
		query.append("#foreach( ${key} in ${allcols})" ).append("\n"); 
		query.append(" #if( $key == 'CHG001'||$key == 'CHG002'||$key == 'CHG003'||$key == 'CHG004'||$key == 'CHG005'||$key == 'CHG999') " ).append("\n"); 
		query.append(" ,(DECODE (0" ).append("\n"); 
		query.append("   #foreach( ${key} in ${allcols})" ).append("\n"); 
		query.append("      #if($key == 'INV069')" ).append("\n"); 
		query.append("         +1" ).append("\n"); 
		query.append("      #else" ).append("\n"); 
		query.append("	     +0" ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("   #end" ).append("\n"); 
		query.append(",0,  " ).append("\n"); 
		query.append("    #if( $key == 'CHG001')" ).append("\n"); 
		query.append("         SUM(CHG001_S)," ).append("\n"); 
		query.append("    #elseif( $key == 'CHG002')" ).append("\n"); 
		query.append("         SUM(CHG002_S)," ).append("\n"); 
		query.append("    #elseif( $key == 'CHG003')" ).append("\n"); 
		query.append("         SUM(CHG003_S)," ).append("\n"); 
		query.append("    #elseif( $key == 'CHG004')" ).append("\n"); 
		query.append("         SUM(CHG004_S)," ).append("\n"); 
		query.append("    #elseif( $key == 'CHG005')" ).append("\n"); 
		query.append("         SUM(CHG005_S)," ).append("\n"); 
		query.append("    #elseif( $key == 'CHG999')" ).append("\n"); 
		query.append("         SUM(CHG_AMT)-(SUM(CHG001_S)+ SUM(CHG002_S)+ SUM(CHG003_S)+ SUM(CHG004_S)+ SUM(CHG005_S))," ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    #if( $key == 'CHG999')" ).append("\n"); 
		query.append("         SUM(CNTR_AMT)-(SUM(CHG001)+SUM(CHG002)+SUM(CHG003)+SUM(CHG004)+SUM(CHG005))  )) $key" ).append("\n"); 
		query.append("    #else" ).append("\n"); 
		query.append("         SUM($key)  )) $key" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append(" #else" ).append("\n"); 
		query.append("	,$key " ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM ( " ).append("\n"); 
		query.append("SELECT  @[rpt_tmplt_nm] RPT_TMPLT_NM" ).append("\n"); 
		query.append("        ,MN.BKG_NO                  AS INV001" ).append("\n"); 
		query.append("       /*  BKG MAIN  */" ).append("\n"); 
		query.append("        ,MN.BL_NO                   AS INV002 " ).append("\n"); 
		query.append("        ,MN.SCAC_CD                 AS INV003" ).append("\n"); 
		query.append("        ,MN.TOT_PCK_QTY             AS INV004" ).append("\n"); 
		query.append("        ,MN.TOT_PCK_TP              AS INV005" ).append("\n"); 
		query.append("        ,MN.ACT_WGT                 AS INV006" ).append("\n"); 
		query.append("        ,MN.TOT_WGT_UT_CD           AS INV007" ).append("\n"); 
		query.append("        ,MN.TOT_MEAS_QTY            AS INV008" ).append("\n"); 
		query.append("        ,MN.MEAS_UT_CD              AS INV009 " ).append("\n"); 
		query.append("        ,MN.BKG_OFC_CD              AS INV010" ).append("\n"); 
		query.append("        ,MN.OBL_ISS_OFC_CD          AS INV011  " ).append("\n"); 
		query.append("        ,MN.RFA_NO                  AS INV012" ).append("\n"); 
		query.append("        ,MN.SC_NO                   AS INV013 " ).append("\n"); 
		query.append("      /* CUSTOMER */   " ).append("\n"); 
		query.append("        ,MN.CONSIGNEE               AS INV014" ).append("\n"); 
		query.append("		,MN.CONSIGNEE_NM            AS INV015" ).append("\n"); 
		query.append("       	,MN.CN_GROUP_CUST           AS INV016" ).append("\n"); 
		query.append("	    ,MN.CN_GROUP_CUST_NM        AS INV017" ).append("\n"); 
		query.append("        ,MN.NOTIFY_PARTY            AS INV018" ).append("\n"); 
		query.append("	    ,MN.NOTIFY_PARTY_NM         AS INV019" ).append("\n"); 
		query.append("        ,MN.SHIPPER                 AS INV020" ).append("\n"); 
		query.append("	    ,MN.SHIPPER_NM              AS INV021" ).append("\n"); 
		query.append("        ,MN.SH_GROUP_CUST           AS INV022" ).append("\n"); 
		query.append("        ,MN.SH_GROUP_CUST_NM        AS INV023" ).append("\n"); 
		query.append("        ,MN.ALSO_NOTIFY             AS INV063" ).append("\n"); 
		query.append("        ,MN.SHIPPER_ADDR            AS INV147" ).append("\n"); 
		query.append("        ,MN.FORWARDER_ADDR          AS INV148" ).append("\n"); 
		query.append("        ,MN.ACTUAL_CUST_NM          AS INV149" ).append("\n"); 
		query.append("        ,MN.BKG_CNTC_EMAIL          AS INV150" ).append("\n"); 
		query.append("        ,MN.BKG_CNTC_NM             AS INV151" ).append("\n"); 
		query.append("         /* ROUTE CONDITION */" ).append("\n"); 
		query.append("        ,MN.POR_CD                  AS INV024" ).append("\n"); 
		query.append("        ,MN.POR_CNT                 AS INV025" ).append("\n"); 
		query.append("        ,MN.POR_NM                  AS INV026" ).append("\n"); 
		query.append("        ,MN.POL_CD                  AS INV027" ).append("\n"); 
		query.append("        ,MN.POL_NM                  AS INV028" ).append("\n"); 
		query.append("        ,MN.PRE_RELAY_PORT          AS INV029" ).append("\n"); 
		query.append("        ,MN.POD_CD                  AS INV030  " ).append("\n"); 
		query.append("        ,MN.POD_NM                  AS INV031" ).append("\n"); 
		query.append("        ,MN.POST_RELAY_PORT         AS INV032" ).append("\n"); 
		query.append("        ,MN.DEL_CD                  AS INV033 " ).append("\n"); 
		query.append("        ,MN.DEL_CNT                 AS INV034" ).append("\n"); 
		query.append("        ,MN.DEL_STE                 AS INV035 " ).append("\n"); 
		query.append("        ,MN.DEL_NM                  AS INV036 " ).append("\n"); 
		query.append("        ,MN.FNL_DEST_CD             AS INV037" ).append("\n"); 
		query.append("        ,MN.RCV_TERM_CD             AS INV038" ).append("\n"); 
		query.append("        ,MN.DE_TERM_CD              AS INV039" ).append("\n"); 
		query.append("        ,MN.FNL_DEST_NM             AS INV040   " ).append("\n"); 
		query.append("        ,MN.EQ_CTRL_OFC             AS INV041 " ).append("\n"); 
		query.append("        ,MN.DEST_TRNS_SVC_MOD_CD    AS INV042" ).append("\n"); 
		query.append("       /*  VESSEL  */" ).append("\n"); 
		query.append("        ,MN.T_VVD                   AS INV043" ).append("\n"); 
		query.append("        ,MN.VESSEL_NM               AS INV044" ).append("\n"); 
		query.append("        ,MN.T_LANE                  AS INV045" ).append("\n"); 
		query.append("        ,MN.FST_VVD                 AS INV046" ).append("\n"); 
		query.append("         /* DATE,TIME */" ).append("\n"); 
		query.append("        ,MN.OC_DT                   AS INV047" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(SUBSTR(MN.F_POL_ETAETD,1,8),'YYYYMMDD'),'YYYY-MM-DD')  AS INV048  " ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(SUBSTR(MN.F_POL_ETAETD,9,8),'YYYYMMDD'),'YYYY-MM-DD')  AS INV050" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(SUBSTR(MN.T_POL_ETAETD,1,8),'YYYYMMDD'),'YYYY-MM-DD')  AS INV051" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(SUBSTR(MN.T_POL_ETAETD,9,8),'YYYYMMDD'),'YYYY-MM-DD')  AS INV052" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(SUBSTR(MN.T_POD_ETAETD,1,8),'YYYYMMDD'),'YYYY-MM-DD')  AS INV055" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(SUBSTR(MN.T_POD_ETAETD,9,8),'YYYYMMDD'),'YYYY-MM-DD')  AS INV057" ).append("\n"); 
		query.append("      	,TO_CHAR(TO_DATE(SUBSTR(MN.L_POD_ETAETD,1,8),'YYYYMMDD'),'YYYY-MM-DD')  AS INV058" ).append("\n"); 
		query.append("      	,TO_CHAR(TO_DATE(SUBSTR(MN.L_POD_ETAETD,9,8),'YYYYMMDD'),'YYYY-MM-DD')  AS INV059" ).append("\n"); 
		query.append("        ,DECODE( MN.FRT_TERM_CD, 'P', TO_CHAR(TO_DATE(SUBSTR(MN.F_POL_ETAETD,9,8),'YYYYMMDD')  " ).append("\n"); 
		query.append("                                             + DECODE(NVL(MN.OB_CUST_CRTERM, 0),0, NVL(MN.OB_OFC_CRTERM, 0), NVL(MN.OB_CUST_CRTERM, 0)),'YYYY-MM-DD')" ).append("\n"); 
		query.append("                                    , TO_CHAR((TO_DATE(SUBSTR(MN.L_POD_ETAETD,1,8),'YYYYMMDD')  " ).append("\n"); 
		query.append("                                             + DECODE(NVL(MN.IB_CUST_CRTERM, 0),0, NVL(MN.IB_OFC_CRTERM, 0) ,NVL(MN.IB_CUST_CRTERM, 0))),'YYYY-MM-DD')        " ).append("\n"); 
		query.append("                                             ) AS INV049 " ).append("\n"); 
		query.append("        ,MN.OBRD_DT                 AS INV053" ).append("\n"); 
		query.append("        ,MN.OBL_ISS_DT              AS INV054     " ).append("\n"); 
		query.append("        ,MN.AN_SENT_DT              AS INV056      " ).append("\n"); 
		query.append("        ,MN.CUST_CLR_DT             AS INV060 " ).append("\n"); 
		query.append("        ,DECODE(TO_CHAR(MN.DEL_ARR_DT,'YYYY-MM-DD'), NULL, DECODE(MN.COP_DEL_ETA,'00000000', MN.VSK_DEL_ETA, TO_CHAR(TO_DATE(MN.COP_DEL_ETA,'YYYYMMDD'),'YYYY-MM-DD')),TO_CHAR(MN.DEL_ARR_DT,'YYYY-MM-DD'))  AS INV061" ).append("\n"); 
		query.append("        ,MN.MVMT_STS                AS INV062" ).append("\n"); 
		query.append("        ,MN.PCK_AVAIL_DT            AS INV064" ).append("\n"); 
		query.append("        ,MN.FREE_DT                 AS INV065  " ).append("\n"); 
		query.append("        ,MN.DELIVER_DT              AS INV066 " ).append("\n"); 
		query.append("        ,MN.MT_RTN_DT               AS INV067" ).append("\n"); 
		query.append("        ,MN.IC_DT                   AS INV080" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(IAM.BL_INV_IF_DT,'YYYYMMDD'), 'YYYY-MM-DD') AS INV081" ).append("\n"); 
		query.append("       /* CONTAINER  INV068 - INV078 */" ).append("\n"); 
		query.append("        ,MN.MEAS_QTY                AS INV068" ).append("\n"); 
		query.append("        ,MN.CNTR_NO                 AS INV069" ).append("\n"); 
		query.append("        ,MN.CNTR_PRT_FLG            AS INV070" ).append("\n"); 
		query.append("        ,MN.CNTR_SEAL_NO            AS INV071" ).append("\n"); 
		query.append("        ,MN.CNTR_SZ_CD              AS INV072" ).append("\n"); 
		query.append("        ,MN.CNTR_TPSZ_CD            AS INV073  " ).append("\n"); 
		query.append("        ,MN.CNTR_VOL_QTY            AS INV074" ).append("\n"); 
		query.append("        ,MN.PCK_QTY                 AS INV075" ).append("\n"); 
		query.append("        ,MN.PCK_TP_CD               AS INV076" ).append("\n"); 
		query.append("        ,MN.CNTR_WGT                AS INV077" ).append("\n"); 
		query.append("        ,MN.WGT_UT_CD               AS INV078   " ).append("\n"); 
		query.append("      /*   CUSTOMER REF.  */" ).append("\n"); 
		query.append("        ,MN.BKPO                    AS INV082  " ).append("\n"); 
		query.append("        ,MN.CTPO                    AS INV083  " ).append("\n"); 
		query.append("        ,MN.PRT_NO                  AS INV084    " ).append("\n"); 
		query.append("        ,MN.INV_REF_NO              AS INV085   " ).append("\n"); 
		query.append("        ,MN.BKG_REF_NO              AS INV086   " ).append("\n"); 
		query.append("        ,MN.SI_REF_NO               AS INV087  " ).append("\n"); 
		query.append("        ,MN.EXP_REF_NO              AS INV088    " ).append("\n"); 
		query.append("     /*  RATE   */" ).append("\n"); 
		query.append("        ,MN.THR_CUST                AS INV092" ).append("\n"); 
		query.append("        ,MN.CNTR_CHG_CURR           AS INV126" ).append("\n"); 
		query.append("        ,MN.AUD_STS_CD              AS INV101" ).append("\n"); 
		query.append("        ,MN.GRP_CUR                 AS INV103" ).append("\n"); 
		query.append("        ,MN.TOT_CURR_AMT            AS INV102" ).append("\n"); 
		query.append("        ,DECODE(MN.FRT_TERM_CD, 'P', NVL(MN.THR_CUST, MN.PPD_CUST), NVL(MN.THR_CUST, MN.CCT_CUST)) AS INV104" ).append("\n"); 
		query.append("        ,DECODE(MN.FRT_TERM_CD, 'P', NVL(MN.N3PTY_OFC, MN.PPD_OFC), NVL(MN.N3PTY_OFC, MN.CCT_OFC)) AS INV105" ).append("\n"); 
		query.append("        ,MN.CNTR_SUM1               AS INV106" ).append("\n"); 
		query.append("        ,MN.CNTR_SUM2               AS INV107  " ).append("\n"); 
		query.append("        ,DECODE( MN.FRT_TERM_CD, 'P'  ,DECODE(NVL(MN.OB_CUST_CRTERM, 0),0, NVL(MN.OB_OFC_CRTERM, 0), NVL(MN.OB_CUST_CRTERM, 0))" ).append("\n"); 
		query.append("                                      ,DECODE(NVL(MN.IB_CUST_CRTERM, 0),0, NVL(MN.IB_OFC_CRTERM, 0), NVL(MN.IB_CUST_CRTERM, 0))) AS INV108 " ).append("\n"); 
		query.append("        ,DECODE( MN.FRT_TERM_CD, 'P'  ,(TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'YYYYMMDD')" ).append("\n"); 
		query.append("                                         - (TO_DATE(SUBSTR(MN.F_POL_ETAETD,9,8),'YYYYMMDD')  " ).append("\n"); 
		query.append("                                             + DECODE(NVL(MN.OB_CUST_CRTERM, 0),0, NVL(MN.OB_OFC_CRTERM, 0), NVL(MN.OB_CUST_CRTERM, 0)))) " ).append("\n"); 
		query.append("                                      ,(TO_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'YYYYMMDD')" ).append("\n"); 
		query.append("                                         - (TO_DATE(SUBSTR(MN.L_POD_ETAETD,1,8),'YYYYMMDD')  " ).append("\n"); 
		query.append("                                             + DECODE(NVL(MN.IB_CUST_CRTERM, 0),0, NVL(MN.IB_OFC_CRTERM, 0), NVL(MN.IB_CUST_CRTERM, 0))))) AS INV109" ).append("\n"); 
		query.append("        ,MN.CLT_FLG                 AS INV110 " ).append("\n"); 
		query.append("        ,DECODE(MN.N3PTY_OFC, '', DECODE(MN.FRT_TERM_CD, 'P', MN.GL_EX_PPD, MN.GL_EX_CCT), MN.GL_EX_THR) AS INV111" ).append("\n"); 
		query.append("        --,DECODE(MN.N3PTY_OFC, '', DECODE(MN.FRT_TERM_CD, 'P', MN.LCL_TOT_PPD, MN.LCL_TOT_CCT), MN.LCL_TOT_THR) AS INV112" ).append("\n"); 
		query.append("        --,DECODE(MN.N3PTY_OFC, '', DECODE(MN.FRT_TERM_CD, 'P', MN.USD_TOT_PPD, MN.USD_TOT_CCT), MN.USD_TOT_THR) AS INV141 " ).append("\n"); 
		query.append("		,IAM.INV_TTL_LOCL_AMT AS INV112" ).append("\n"); 
		query.append("        ,(SELECT SUM(ROUND(CHG_AMT * USD_XCH_RT, 2))" ).append("\n"); 
		query.append("          FROM INV_AR_CHG" ).append("\n"); 
		query.append("          WHERE AR_IF_NO = IAM.AR_IF_NO) AS INV141 " ).append("\n"); 
		query.append("        ,MN.CHG_CD                  AS INV096" ).append("\n"); 
		query.append("        ,MN.CHG_CURR                AS INV127" ).append("\n"); 
		query.append("        ,MN.CHG_RATED_AS            AS INV128" ).append("\n"); 
		query.append("        ,MN.CHG_RATE                AS INV129" ).append("\n"); 
		query.append("        ,MN.TOT_CHG_AMT             AS INV131  " ).append("\n"); 
		query.append("     /* COMMODITY */" ).append("\n"); 
		query.append("        ,MN.CMDT_CD                 AS INV113 " ).append("\n"); 
		query.append("        ,MN.CMDT_NM                 AS INV114 " ).append("\n"); 
		query.append("        ,MN.CSTMS_DESC              AS INV115" ).append("\n"); 
		query.append("        ,MN.CNTR_SP_CGO_FG          AS INV116" ).append("\n"); 
		query.append("        ,MN.MK_DESC                 AS INV079" ).append("\n"); 
		query.append("     /*  I/B INFORM   */" ).append("\n"); 
		query.append("        ,MN.RTN_YD_CD               AS INV117" ).append("\n"); 
		query.append("        ,MN.HUB_LOC_CD              AS INV118  " ).append("\n"); 
		query.append("        ,MN.IBD_TRSP_NO             AS INV119  " ).append("\n"); 
		query.append("        ,MN.IBD_TRSP_ISS_DT         AS INV120 " ).append("\n"); 
		query.append("        ,MN.PKUP_NO                 AS INV121 " ).append("\n"); 
		query.append("        ,MN.PKUP_YD_CD              AS INV122  " ).append("\n"); 
		query.append("        ,MN.OBL_RDEM_FLG            AS INV124" ).append("\n"); 
		query.append("        ,MN.CSTMS_CLR_CD            AS INV125       " ).append("\n"); 
		query.append("        ,MN.RT_APLY_DT              AS INV142      " ).append("\n"); 
		query.append("        ,MN.CGO_RCV_DT              AS INV144" ).append("\n"); 
		query.append("        ,MN.DEPT_NO                 AS INV145  " ).append("\n"); 
		query.append("        ,''                         AS INV146" ).append("\n"); 
		query.append("        ,MN.FRT_TERM_CD" ).append("\n"); 
		query.append("        /* ADD NEW ITEMS *****************************************************/" ).append("\n"); 
		query.append("        ,MN.BL_TP_CD                AS INV201" ).append("\n"); 
		query.append("        ,MN.BOUND                   AS INV202" ).append("\n"); 
		query.append("        ,SUBSTR(MN.T_VVD, 9, 1)     AS INV203" ).append("\n"); 
		query.append("        ,MN.FORWARDER               AS INV204" ).append("\n"); 
		query.append("        ,MN.FORWARDER_NM            AS INV205" ).append("\n"); 
		query.append("        ,MN.SLS_OFC_CD              AS INV206" ).append("\n"); 
		query.append("        ,MN.SREP_CD                 AS INV207" ).append("\n"); 
		query.append("        ,MN.TRADE_CD                AS INV208" ).append("\n"); 
		query.append("        ,MN.TRAFFIC_MOD             AS INV209" ).append("\n"); 
		query.append("        ,MN.CNTR_MEAS_UT            AS INV210" ).append("\n"); 
		query.append("        ,MN.CNTR_DESC               AS INV211" ).append("\n"); 
		query.append("        ,MN.CREDIT_AMT              AS INV212" ).append("\n"); 
		query.append("        ,MN.CREDIT_FLG              AS INV213		" ).append("\n"); 
		query.append("        --,MN.BILL_CUST_NM            AS INV214" ).append("\n"); 
		query.append("        --,MN.BILL_CUST_ADDR          AS INV215" ).append("\n"); 
		query.append("		,(SELECT CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("          FROM MDM_CUSTOMER" ).append("\n"); 
		query.append("          WHERE CUST_CNT_CD = IAM.ACT_CUST_CNT_CD" ).append("\n"); 
		query.append("          AND CUST_SEQ = IAM.ACT_CUST_SEQ) AS INV214" ).append("\n"); 
		query.append("        ,(SELECT BZET_ADDR" ).append("\n"); 
		query.append("          FROM MDM_CUST_ADDR" ).append("\n"); 
		query.append("          WHERE CUST_CNT_CD = IAM.ACT_CUST_CNT_CD" ).append("\n"); 
		query.append("          AND CUST_SEQ = IAM.ACT_CUST_SEQ" ).append("\n"); 
		query.append("          AND PRMRY_CHK_FLG = 'Y') AS INV215" ).append("\n"); 
		query.append("        --,MN.CUST_OFC_NM             AS INV216" ).append("\n"); 
		query.append("        --,MN.CUST_OFC_SAP_ID         AS INV217" ).append("\n"); 
		query.append("		,(SELECT B.OFC_ENG_NM" ).append("\n"); 
		query.append("          FROM MDM_CUSTOMER A, MDM_ORGANIZATION B" ).append("\n"); 
		query.append("          WHERE A.OFC_CD = B.OFC_CD" ).append("\n"); 
		query.append("          AND A.CUST_CNT_CD = IAM.ACT_CUST_CNT_CD" ).append("\n"); 
		query.append("          AND A.CUST_SEQ = IAM.ACT_CUST_SEQ) AS INV216" ).append("\n"); 
		query.append("        ,(SELECT B.MODI_AGN_CD" ).append("\n"); 
		query.append("          FROM MDM_CUSTOMER A, MDM_ORGANIZATION B" ).append("\n"); 
		query.append("          WHERE A.OFC_CD = B.OFC_CD" ).append("\n"); 
		query.append("          AND A.CUST_CNT_CD = IAM.ACT_CUST_CNT_CD" ).append("\n"); 
		query.append("          AND A.CUST_SEQ = IAM.ACT_CUST_SEQ) AS INV217" ).append("\n"); 
		query.append("        ,MN.DISCHARGE_DT            AS INV218" ).append("\n"); 
		query.append("        ,DECODE(SHR.OTS_TP_CD, '', '', TO_CHAR(SHR.UPD_DT, 'YYYY-MM-DD')) AS INV219 " ).append("\n"); 
		query.append("        ,MN.MT_OUT_DT               AS INV220" ).append("\n"); 
		query.append("        ,MN.LOADING_DT              AS INV221" ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(IAM.BL_INV_IF_DT,'YYYYMMDD'), 'YYYY-MM-DD') AS INV222           " ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(IAM.BL_INV_IF_DT,'YYYYMMDD'), 'YYYY-MM-DD') AS INV223        " ).append("\n"); 
		query.append("        ,TO_CHAR(TO_DATE(IAM.ISS_DT,'YYYYMMDD'), 'YYYY-MM-DD')       AS INV224        " ).append("\n"); 
		query.append("        ,(SELECT MAX(TO_CHAR(RCT_UPD_DT, 'YYYY-MM-DD'))" ).append("\n"); 
		query.append("          FROM SAR_OTS_DTL" ).append("\n"); 
		query.append("          WHERE RHQ_CD = SHS.RHQ_CD" ).append("\n"); 
		query.append("          AND OTS_OFC_CD = SHS.OTS_OFC_CD" ).append("\n"); 
		query.append("          AND BL_NO = SHS.BL_NO" ).append("\n"); 
		query.append("          AND INV_NO = SHS.INV_NO)  AS INV225        " ).append("\n"); 
		query.append("        ,(SELECT LU_DESC" ).append("\n"); 
		query.append("          FROM SCO_LU_DTL" ).append("\n"); 
		query.append("          WHERE LU_TP_CD = 'OTS TYPE'" ).append("\n"); 
		query.append("          AND LU_CD = SHR.OTS_TP_CD) AS INV226        " ).append("\n"); 
		query.append("        ,DECODE(SHR.OTS_TP_CD, '', '', SHR.UPD_USR_ID) AS INV227 " ).append("\n"); 
		query.append("        ,DECODE(SHR.OTS_TP_CD, '', '', SHR.OTS_RMK)    AS INV228" ).append("\n"); 
		query.append("        ,IAM.CRE_USR_ID             AS INV229   " ).append("\n"); 
		query.append("        ,MN.CARRIER                 AS INV230" ).append("\n"); 
		query.append("        ,(SELECT DECODE(COUNT(DISTINCT BL_SRC_NO), 0, '', 1, 'N', 'Y')" ).append("\n"); 
		query.append("          FROM INV_AR_MN" ).append("\n"); 
		query.append("          WHERE INV_NO = IAM.INV_NO) AS INV231" ).append("\n"); 
		query.append("        ,IAM.INV_NO                 AS INV232" ).append("\n"); 
		query.append("        ,DECODE(IAM.INV_NO, '', '', 'SF') AS INV233" ).append("\n"); 
		query.append("        ,SHR.CLT_OFC_CD             AS INV234" ).append("\n"); 
		query.append("        ,SHR.OTS_OFC_CD             AS INV235" ).append("\n"); 
		query.append("        ,(SELECT B.LOC_NM" ).append("\n"); 
		query.append("          FROM MDM_ORGANIZATION A," ).append("\n"); 
		query.append("               MDM_LOCATION B" ).append("\n"); 
		query.append("          WHERE A.OFC_CD = SHR.OTS_OFC_CD" ).append("\n"); 
		query.append("          AND B.LOC_CD = A.LOC_CD)  AS INV236" ).append("\n"); 
		query.append("        ,DECODE(IAM.INV_NO, '', '', IAM.AR_OFC_CD) AS INV237" ).append("\n"); 
		query.append("        ,MN.CHG_AMT                 AS INV238" ).append("\n"); 
		query.append("        ,(SELECT ROUND(MN.CHG_AMT * B.ISS_XCH_RT, C.DP_PRCS_KNT)" ).append("\n"); 
		query.append("          FROM INV_AR_MN A," ).append("\n"); 
		query.append("               INV_AR_CHG B," ).append("\n"); 
		query.append("               MDM_CURRENCY C" ).append("\n"); 
		query.append("          WHERE A.AR_IF_NO = IAM.AR_IF_NO" ).append("\n"); 
		query.append("          AND A.AR_IF_NO = B.AR_IF_NO" ).append("\n"); 
		query.append("          AND A.INV_CURR_CD = C.CURR_CD" ).append("\n"); 
		query.append("          AND B.CURR_CD = MN.CHG_CURR" ).append("\n"); 
		query.append("          AND ROWNUM = 1)           AS INV239" ).append("\n"); 
		query.append("        --,MN.USD_CHG_AMT             AS INV240" ).append("\n"); 
		query.append("		,(SELECT ROUND(MN.CHG_AMT * USD_XCH_RT, 2)" ).append("\n"); 
		query.append("          FROM INV_AR_CHG" ).append("\n"); 
		query.append("          WHERE AR_IF_NO = IAM.AR_IF_NO" ).append("\n"); 
		query.append("          AND CURR_CD = MN.CHG_CURR" ).append("\n"); 
		query.append("          AND ROWNUM = 1) AS INV240" ).append("\n"); 
		query.append("        ,(SELECT MN.CHG_AMT" ).append("\n"); 
		query.append("          FROM INV_AR_CHG" ).append("\n"); 
		query.append("          WHERE AR_IF_NO = IAM.AR_IF_NO" ).append("\n"); 
		query.append("          AND CHG_CD = MN.CHG_CD" ).append("\n"); 
		query.append("          AND TJ_SRC_NM <> 'VAT'" ).append("\n"); 
		query.append("          AND ROWNUM = 1)           AS INV241" ).append("\n"); 
		query.append("        ,DECODE(IAM.INV_DELT_DIV_CD, 'X', 'Cancelled', DECODE(IAM.INV_NO, '', 'Unbilled', 'Billed')) AS INV242" ).append("\n"); 
		query.append("        ,MN.CHG_NM                  AS INV243" ).append("\n"); 
		query.append("        ,MN.THR_PAY_FLG             AS INV244" ).append("\n"); 
		query.append("        ,(SELECT INV_XCH_RT" ).append("\n"); 
		query.append("          FROM INV_AR_CHG" ).append("\n"); 
		query.append("          WHERE AR_IF_NO = IAM.AR_IF_NO" ).append("\n"); 
		query.append("          AND CURR_CD = MN.CHG_CURR" ).append("\n"); 
		query.append("          AND ROWNUM = 1)           AS INV245" ).append("\n"); 
		query.append("        ,(SELECT ISS_XCH_RT" ).append("\n"); 
		query.append("          FROM INV_AR_CHG" ).append("\n"); 
		query.append("          WHERE AR_IF_NO = IAM.AR_IF_NO" ).append("\n"); 
		query.append("          AND CURR_CD = MN.CHG_CURR" ).append("\n"); 
		query.append("          AND ROWNUM = 1)           AS INV246" ).append("\n"); 
		query.append("        ,DECODE(IAM.INV_CURR_CD, IAM.LOCL_CURR_CD, 1, 'USD', IAM.INV_LOCL_XCH_RT, NULL) AS INV247" ).append("\n"); 
		query.append("        ,IAM.INV_CURR_CD            AS INV248" ).append("\n"); 
		query.append("        ,MN.FRT_TERM_CD             AS INV249" ).append("\n"); 
		query.append("        ,(SELECT SUM(ROUND(B.CHG_AMT * B.ISS_XCH_RT, C.DP_PRCS_KNT))" ).append("\n"); 
		query.append("          FROM INV_AR_MN A," ).append("\n"); 
		query.append("               INV_AR_CHG B," ).append("\n"); 
		query.append("               MDM_CURRENCY C" ).append("\n"); 
		query.append("          WHERE A.AR_IF_NO = IAM.AR_IF_NO" ).append("\n"); 
		query.append("          AND A.AR_IF_NO = B.AR_IF_NO" ).append("\n"); 
		query.append("          AND A.INV_CURR_CD = C.CURR_CD) AS INV250" ).append("\n"); 
		query.append("        ,(SELECT ROUND(MN.CHG_AMT * B.ISS_XCH_RT, C.DP_PRCS_KNT)" ).append("\n"); 
		query.append("          FROM INV_AR_MN A," ).append("\n"); 
		query.append("               INV_AR_CHG B," ).append("\n"); 
		query.append("               MDM_CURRENCY C" ).append("\n"); 
		query.append("          WHERE A.AR_IF_NO = IAM.AR_IF_NO" ).append("\n"); 
		query.append("          AND A.AR_IF_NO = B.AR_IF_NO" ).append("\n"); 
		query.append("          AND A.INV_CURR_CD = C.CURR_CD" ).append("\n"); 
		query.append("          AND B.CURR_CD = MN.CHG_CURR" ).append("\n"); 
		query.append("          AND B.CHG_CD = MN.CHG_CD" ).append("\n"); 
		query.append("          AND B.TJ_SRC_NM = 'VAT'" ).append("\n"); 
		query.append("          AND ROWNUM = 1)           AS INV251" ).append("\n"); 
		query.append("        ,(SELECT MN.CHG_AMT" ).append("\n"); 
		query.append("          FROM INV_AR_CHG" ).append("\n"); 
		query.append("          WHERE AR_IF_NO = IAM.AR_IF_NO" ).append("\n"); 
		query.append("          AND CHG_CD = MN.CHG_CD" ).append("\n"); 
		query.append("          AND TJ_SRC_NM = 'VAT'" ).append("\n"); 
		query.append("          AND ROWNUM = 1)           AS INV252" ).append("\n"); 
		query.append("        ,(SELECT MN.CHG_RATED_AS" ).append("\n"); 
		query.append("          FROM INV_AR_CHG" ).append("\n"); 
		query.append("          WHERE AR_IF_NO = IAM.AR_IF_NO" ).append("\n"); 
		query.append("          AND CHG_CD = MN.CHG_CD" ).append("\n"); 
		query.append("          AND TJ_SRC_NM = 'VAT'" ).append("\n"); 
		query.append("          AND ROWNUM = 1)           AS INV253" ).append("\n"); 
		query.append("        ,MN.FST_POL                 AS INV254" ).append("\n"); 
		query.append("        ,MN.LST_POD                 AS INV255" ).append("\n"); 
		query.append("        ,MN.LST_VVD                 AS INV256" ).append("\n"); 
		query.append("        ,IAM.SVC_SCP_CD             AS INV257" ).append("\n"); 
		query.append("        ,IAM.VSL_CD||IAM.SKD_VOY_NO||IAM.SKD_DIR_CD AS INV258" ).append("\n"); 
		query.append("        /***********************************************************/" ).append("\n"); 
		query.append("        ,MN.CHG001_S" ).append("\n"); 
		query.append("        ,MN.CHG002_S" ).append("\n"); 
		query.append("        ,MN.CHG003_S" ).append("\n"); 
		query.append("        ,MN.CHG004_S" ).append("\n"); 
		query.append("        ,MN.CHG005_S" ).append("\n"); 
		query.append("        ,MN.CHG001" ).append("\n"); 
		query.append("        ,MN.CHG002" ).append("\n"); 
		query.append("        ,MN.CHG003" ).append("\n"); 
		query.append("        ,MN.CHG004" ).append("\n"); 
		query.append("        ,MN.CHG005  " ).append("\n"); 
		query.append("        ,MN.CHG_AMT" ).append("\n"); 
		query.append("        ,MN.CNTR_AMT" ).append("\n"); 
		query.append("FROM " ).append("\n"); 
		query.append("    (SELECT O.BKG_NO" ).append("\n"); 
		query.append("        ,O.BL_NO " ).append("\n"); 
		query.append("        ,O.SC_NO" ).append("\n"); 
		query.append("        ,O.RFA_NO " ).append("\n"); 
		query.append("        ,'NYKSC' AS SCAC_CD   " ).append("\n"); 
		query.append("        ,O.BKG_OFC_CD " ).append("\n"); 
		query.append("        ,O.POR_CD " ).append("\n"); 
		query.append("        ,SUBSTR(O.POR_CD,1,2) AS POR_CNT" ).append("\n"); 
		query.append("        ,(SELECT LOC1.LOC_NM FROM MDM_LOCATION LOC1  " ).append("\n"); 
		query.append("          WHERE  O.POR_CD = LOC1.LOC_CD(+)) AS POR_NM" ).append("\n"); 
		query.append("        ,O.POD_CD " ).append("\n"); 
		query.append("        ,(SELECT LOC3.LOC_NM FROM MDM_LOCATION LOC3  " ).append("\n"); 
		query.append("          WHERE  O.POD_CD = LOC3.LOC_CD(+)) AS POD_NM" ).append("\n"); 
		query.append("        ,O.POL_CD " ).append("\n"); 
		query.append("        ,(SELECT LOC2.LOC_NM FROM MDM_LOCATION LOC2  " ).append("\n"); 
		query.append("          WHERE  O.POL_CD = LOC2.LOC_CD(+)) AS POL_NM" ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CO1.CUST_CONV_CD_CTNT), O.DEL_CD) " ).append("\n"); 
		query.append("          FROM  INV_CPRT_CD_CONV CO1  " ).append("\n"); 
		query.append("          WHERE CO1.CPRT_CONV_TP_CD ='LOCATION'" ).append("\n"); 
		query.append("          AND   CO1.CO_CD_CTNT = O.DEL_CD" ).append("\n"); 
		query.append("          AND   CO1.SC_NO  = NVL(O.SC_NO,'X') " ).append("\n"); 
		query.append("          AND   CO1.RFA_NO = NVL(O.RFA_NO,'X'))  AS DEL_CD " ).append("\n"); 
		query.append("        ,SUBSTR(O.DEL_CD,1,2)                AS DEL_CNT" ).append("\n"); 
		query.append("        ,(SELECT LOC4.STE_CD FROM MDM_LOCATION LOC4  " ).append("\n"); 
		query.append("          WHERE  O.DEL_CD = LOC4.LOC_CD(+)) AS DEL_STE " ).append("\n"); 
		query.append("        ,(SELECT LOC5.LOC_NM FROM MDM_LOCATION LOC5  " ).append("\n"); 
		query.append("          WHERE  O.DEL_CD = LOC5.LOC_CD(+)) AS DEL_NM" ).append("\n"); 
		query.append("        ,(SELECT LOC6.EQ_CTRL_OFC_CD  FROM MDM_LOCATION LOC6  " ).append("\n"); 
		query.append("          WHERE  O.DEL_CD = LOC6.LOC_CD(+)) AS EQ_CTRL_OFC " ).append("\n"); 
		query.append("        ,O.FNL_DEST_CD" ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CO2.CUST_CONV_CD_CTNT), O.RCV_TERM_CD)" ).append("\n"); 
		query.append("          FROM INV_CPRT_CD_CONV CO2" ).append("\n"); 
		query.append("          WHERE CO2.CPRT_CONV_TP_CD ='RECEIVINGTERM'" ).append("\n"); 
		query.append("          AND CO2.CO_CD_CTNT = O.RCV_TERM_CD" ).append("\n"); 
		query.append("          AND CO2.SC_NO = NVL(O.SC_NO, 'X')" ).append("\n"); 
		query.append("          AND CO2.RFA_NO = NVL(O.RFA_NO, 'X')) AS RCV_TERM_CD" ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CO2.CUST_CONV_CD_CTNT), O.DE_TERM_CD)" ).append("\n"); 
		query.append("          FROM INV_CPRT_CD_CONV CO2" ).append("\n"); 
		query.append("          WHERE CO2.CPRT_CONV_TP_CD ='DELIVERYTERM'" ).append("\n"); 
		query.append("          AND CO2.CO_CD_CTNT = O.DE_TERM_CD" ).append("\n"); 
		query.append("          AND CO2.SC_NO = NVL(O.SC_NO, 'X')" ).append("\n"); 
		query.append("          AND CO2.RFA_NO = NVL(O.RFA_NO, 'X')) AS DE_TERM_CD" ).append("\n"); 
		query.append("        ,O.DEST_TRNS_SVC_MOD_CD" ).append("\n"); 
		query.append("        ,P.FNL_DEST_NM" ).append("\n"); 
		query.append("        ,P.PCK_QTY AS TOT_PCK_QTY" ).append("\n"); 
		query.append("        ,P.PCK_TP_CD AS TOT_PCK_TP" ).append("\n"); 
		query.append("        ,P.ACT_WGT" ).append("\n"); 
		query.append("        ,P.WGT_UT_CD AS TOT_WGT_UT_CD" ).append("\n"); 
		query.append("        ,P.MEAS_QTY  AS TOT_MEAS_QTY" ).append("\n"); 
		query.append("        ,P.MEAS_UT_CD" ).append("\n"); 
		query.append("        ,P.VSL_NM" ).append("\n"); 
		query.append("        ,P.CSTMS_DESC" ).append("\n"); 
		query.append("       /* CUSTOMER  */   " ).append("\n"); 
		query.append("        ,( SELECT DECODE(C1.CUST_CNT_CD||C1.CUST_SEQ, '', '', C1.CUST_CNT_CD||'-'||LPAD(TO_CHAR(C1.CUST_SEQ),6,'0'))" ).append("\n"); 
		query.append("           FROM  BKG_CUSTOMER C1" ).append("\n"); 
		query.append("           WHERE C1.BKG_NO = O.BKG_NO AND C1.BKG_CUST_TP_CD ='C' ) AS CONSIGNEE " ).append("\n"); 
		query.append("        ,( SELECT C1.CUST_NM" ).append("\n"); 
		query.append("           FROM  BKG_CUSTOMER C1" ).append("\n"); 
		query.append("           WHERE C1.BKG_NO = O.BKG_NO AND C1.BKG_CUST_TP_CD ='C' ) AS CONSIGNEE_NM " ).append("\n"); 
		query.append("        ,(SELECT DECODE(L1.CUST_GRP_ID, '', '', SUBSTR(L1.CUST_GRP_ID,3,2)||'-'||SUBSTR(L1.CUST_GRP_ID,5,6))" ).append("\n"); 
		query.append("          FROM  MDM_CUSTOMER L1, BKG_CUSTOMER C3" ).append("\n"); 
		query.append("          WHERE C3.BKG_NO = O.BKG_NO " ).append("\n"); 
		query.append("          AND   C3.CUST_CNT_CD = L1.CUST_CNT_CD " ).append("\n"); 
		query.append("          AND   C3.CUST_SEQ    = L1.CUST_SEQ" ).append("\n"); 
		query.append("          AND   C3.BKG_CUST_TP_CD = 'C'  " ).append("\n"); 
		query.append("          )  AS CN_GROUP_CUST " ).append("\n"); 
		query.append("        ,(SELECT L2.CUST_LGL_ENG_NM  " ).append("\n"); 
		query.append("          FROM  MDM_CUSTOMER L1, MDM_CUSTOMER L2, BKG_CUSTOMER C3" ).append("\n"); 
		query.append("          WHERE C3.BKG_NO = O.BKG_NO " ).append("\n"); 
		query.append("          AND   C3.CUST_CNT_CD = L1.CUST_CNT_CD " ).append("\n"); 
		query.append("          AND   C3.CUST_SEQ    = L1.CUST_SEQ" ).append("\n"); 
		query.append("          AND   C3.BKG_CUST_TP_CD = 'C'  " ).append("\n"); 
		query.append("          AND   SUBSTR(L1.CUST_GRP_ID,3,2) = L2.CUST_CNT_CD" ).append("\n"); 
		query.append("          AND   SUBSTR(L1.CUST_GRP_ID,5,6) = L2.CUST_SEQ" ).append("\n"); 
		query.append("          )  AS CN_GROUP_CUST_NM  " ).append("\n"); 
		query.append("        ,(SELECT DECODE(C5.CUST_CNT_CD||C5.CUST_SEQ, '', '', C5.CUST_CNT_CD||'-'||LPAD(TO_CHAR(C5.CUST_SEQ),6,'0'))" ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C5" ).append("\n"); 
		query.append("          WHERE C5.BKG_NO=O.BKG_NO AND C5.BKG_CUST_TP_CD ='N'  ) AS NOTIFY_PARTY  " ).append("\n"); 
		query.append("        ,(SELECT C5.CUST_NM" ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C5" ).append("\n"); 
		query.append("          WHERE C5.BKG_NO=O.BKG_NO AND C5.BKG_CUST_TP_CD ='N'  ) AS NOTIFY_PARTY_NM   " ).append("\n"); 
		query.append("        ,(SELECT DECODE(C7.CUST_CNT_CD||C7.CUST_SEQ, '', '', C7.CUST_CNT_CD||'-'||LPAD(TO_CHAR(C7.CUST_SEQ),6,'0'))" ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C7" ).append("\n"); 
		query.append("          WHERE C7.BKG_NO=O.BKG_NO AND C7.BKG_CUST_TP_CD ='S' ) AS SHIPPER  " ).append("\n"); 
		query.append("        ,(SELECT C7.CUST_NM" ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C7" ).append("\n"); 
		query.append("          WHERE C7.BKG_NO=O.BKG_NO AND C7.BKG_CUST_TP_CD ='S' ) AS SHIPPER_NM  " ).append("\n"); 
		query.append("        ,(SELECT DECODE(L3.CUST_GRP_ID, '', '', SUBSTR(L3.CUST_GRP_ID,3,2)||'-'||SUBSTR(L3.CUST_GRP_ID,5,6))" ).append("\n"); 
		query.append("          FROM  MDM_CUSTOMER L3, BKG_CUSTOMER C9" ).append("\n"); 
		query.append("          WHERE C9.BKG_NO = O.BKG_NO  " ).append("\n"); 
		query.append("          AND C9.CUST_CNT_CD = L3.CUST_CNT_CD " ).append("\n"); 
		query.append("          AND C9.CUST_SEQ = L3.CUST_SEQ          " ).append("\n"); 
		query.append("          AND C9.BKG_CUST_TP_CD = 'S' ) AS SH_GROUP_CUST " ).append("\n"); 
		query.append("        ,(SELECT L2.CUST_LGL_ENG_NM  " ).append("\n"); 
		query.append("          FROM  MDM_CUSTOMER L1, MDM_CUSTOMER L2, BKG_CUSTOMER C3" ).append("\n"); 
		query.append("          WHERE C3.BKG_NO = O.BKG_NO " ).append("\n"); 
		query.append("          AND   C3.CUST_CNT_CD = L1.CUST_CNT_CD " ).append("\n"); 
		query.append("          AND   C3.CUST_SEQ    = L1.CUST_SEQ" ).append("\n"); 
		query.append("          AND   C3.BKG_CUST_TP_CD = 'S'  " ).append("\n"); 
		query.append("          AND   SUBSTR(L1.CUST_GRP_ID,3,2) = L2.CUST_CNT_CD" ).append("\n"); 
		query.append("          AND   SUBSTR(L1.CUST_GRP_ID,5,6) = L2.CUST_SEQ" ).append("\n"); 
		query.append("          )  AS SH_GROUP_CUST_NM   " ).append("\n"); 
		query.append("        ,(SELECT S.CUST_NM" ).append("\n"); 
		query.append("          FROM   BKG_CUSTOMER S" ).append("\n"); 
		query.append("          WHERE  S.BKG_NO = O.BKG_NO AND S.BKG_CUST_TP_CD = 'A' ) AS ALSO_NOTIFY" ).append("\n"); 
		query.append("        ,(SELECT C9.CUST_ADDR" ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C9" ).append("\n"); 
		query.append("          WHERE C9.BKG_NO=O.BKG_NO AND C9.BKG_CUST_TP_CD ='S' )AS SHIPPER_ADDR     " ).append("\n"); 
		query.append("        ,(SELECT C9.CUST_ADDR  " ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C9" ).append("\n"); 
		query.append("          WHERE C9.BKG_NO=O.BKG_NO AND C9.BKG_CUST_TP_CD ='F' )AS FORWARDER_ADDR" ).append("\n"); 
		query.append("        ,(SELECT C9.CUST_NM" ).append("\n"); 
		query.append("          FROM BKG_CUSTOMER C9" ).append("\n"); 
		query.append("          WHERE C9.BKG_NO=O.BKG_NO AND C9.BKG_CUST_TP_CD ='E' )AS ACTUAL_CUST_NM" ).append("\n"); 
		query.append("        ,(SELECT C10.CNTC_PSON_EML" ).append("\n"); 
		query.append("          FROM BKG_CNTC_PSON C10" ).append("\n"); 
		query.append("          WHERE C10.BKG_NO=O.BKG_NO AND C10.BKG_CNTC_PSON_TP_CD ='BK' )AS BKG_CNTC_EMAIL" ).append("\n"); 
		query.append("        ,(SELECT C11.CNTC_PSON_NM" ).append("\n"); 
		query.append("          FROM BKG_CNTC_PSON C11" ).append("\n"); 
		query.append("          WHERE C11.BKG_NO=O.BKG_NO AND C11.BKG_CNTC_PSON_TP_CD ='BK' )AS BKG_CNTC_NM" ).append("\n"); 
		query.append("       /* ROUTE CONDITION */" ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_DESC( K1 XPKBKG_VVD ) */ " ).append("\n"); 
		query.append("                 K1.POL_CD  " ).append("\n"); 
		query.append("          FROM BKG_VVD K1" ).append("\n"); 
		query.append("          WHERE K1.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND   K1.VSL_PRE_PST_CD='S'  AND ROWNUM = 1 )  AS PRE_RELAY_PORT " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX( K2 XPKBKG_VVD ) */" ).append("\n"); 
		query.append("                  K2.POL_CD" ).append("\n"); 
		query.append("          FROM BKG_VVD K2" ).append("\n"); 
		query.append("          WHERE K2.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND   K2.VSL_PRE_PST_CD='U' AND ROWNUM = 1 )   AS POST_RELAY_PORT" ).append("\n"); 
		query.append("       /*  VESSEL  */" ).append("\n"); 
		query.append("        ,(SELECT K3.VSL_CD||K3.SKD_VOY_NO||K3.SKD_DIR_CD" ).append("\n"); 
		query.append("          FROM BKG_VVD K3" ).append("\n"); 
		query.append("          WHERE K3.BKG_NO = O.BKG_NO AND K3.VSL_PRE_PST_CD ='T' ) AS T_VVD    " ).append("\n"); 
		query.append("        ,(SELECT VSL_ENG_NM||' '||(SELECT K3.SKD_VOY_NO||K3.SKD_DIR_CD FROM BKG_VVD K3 WHERE K3.BKG_NO = O.BKG_NO AND K3.VSL_PRE_PST_CD ='T')  " ).append("\n"); 
		query.append("          FROM MDM_VSL_CNTR " ).append("\n"); 
		query.append("          WHERE VSL_CD = (SELECT K3.VSL_CD " ).append("\n"); 
		query.append("                          FROM BKG_VVD K3 " ).append("\n"); 
		query.append("                          WHERE K3.BKG_NO = O.BKG_NO " ).append("\n"); 
		query.append("                          AND K3.VSL_PRE_PST_CD ='T')) AS VESSEL_NM" ).append("\n"); 
		query.append("        ,(SELECT K4.SLAN_CD FROM BKG_VVD K4" ).append("\n"); 
		query.append("          WHERE K4.BKG_NO = O.BKG_NO AND K4.VSL_PRE_PST_CD ='T'  ) AS T_LANE " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX( K5 XPKBKG_VVD ) */" ).append("\n"); 
		query.append("                K5.VSL_CD||K5.SKD_VOY_NO||K5.SKD_DIR_CD " ).append("\n"); 
		query.append("          FROM  BKG_VVD K5" ).append("\n"); 
		query.append("          WHERE K5.BKG_NO = O.BKG_NO  " ).append("\n"); 
		query.append("          AND K5.POL_CD = O.POL_CD      " ).append("\n"); 
		query.append("          AND K5.VSL_PRE_PST_CD||K5.VSL_SEQ = (SELECT MIN(S.VSL_PRE_PST_CD||S.VSL_SEQ) " ).append("\n"); 
		query.append("                                               FROM BKG_VVD S                " ).append("\n"); 
		query.append("                                               WHERE S.BKG_NO = O.BKG_NO    " ).append("\n"); 
		query.append("                                               AND S.POL_CD = O.POL_CD)      " ).append("\n"); 
		query.append("          ) AS FST_VVD           " ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(V1.VPS_ETA_DT,'YYYYMMDD')||TO_CHAR(V1.VPS_ETD_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("          FROM  BKG_VVD K5, VSK_VSL_PORT_SKD V1" ).append("\n"); 
		query.append("          WHERE K5.BKG_NO = O.BKG_NO  " ).append("\n"); 
		query.append("          AND K5.POL_CD = O.POL_CD     " ).append("\n"); 
		query.append("          AND K5.VSL_PRE_PST_CD||K5.VSL_SEQ = (SELECT MIN(S.VSL_PRE_PST_CD||S.VSL_SEQ) " ).append("\n"); 
		query.append("                                               FROM BKG_VVD S               " ).append("\n"); 
		query.append("                                               WHERE S.BKG_NO = O.BKG_NO    " ).append("\n"); 
		query.append("                                               AND S.POL_CD = O.POL_CD)      " ).append("\n"); 
		query.append("          AND V1.VSL_CD = K5.VSL_CD" ).append("\n"); 
		query.append("          AND V1.SKD_VOY_NO = K5.SKD_VOY_NO" ).append("\n"); 
		query.append("          AND V1.SKD_DIR_CD = K5.SKD_DIR_CD" ).append("\n"); 
		query.append("          AND V1.VPS_PORT_CD = K5.POL_CD" ).append("\n"); 
		query.append("          AND V1.CLPT_IND_SEQ = (SELECT MAX(V2.CLPT_IND_SEQ) FROM VSK_VSL_PORT_SKD V2" ).append("\n"); 
		query.append("                                 WHERE  V2.VSL_CD = K5.VSL_CD" ).append("\n"); 
		query.append("                                 AND    V2.SKD_VOY_NO = K5.SKD_VOY_NO" ).append("\n"); 
		query.append("                                 AND    V2.SKD_DIR_CD = K5.SKD_DIR_CD" ).append("\n"); 
		query.append("                                 AND    V2.VPS_PORT_CD =  K5.POL_CD)" ).append("\n"); 
		query.append("          ) AS F_POL_ETAETD" ).append("\n"); 
		query.append("       /* DATE,TIME */" ).append("\n"); 
		query.append("        ,TO_CHAR(P.BL_OBRD_DT,'YYYY-MM-DD') AS OBRD_DT  " ).append("\n"); 
		query.append("        ,TO_CHAR(R.OBL_ISS_DT,'YYYY-MM-DD') AS OBL_ISS_DT " ).append("\n"); 
		query.append("        ,S.DEL_ARR_DT" ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(KK.VPS_ETA_DT,'YYYYMMDD')||TO_CHAR(KK.VPS_ETD_DT,'YYYYMMDD') AS ETAETD " ).append("\n"); 
		query.append("          FROM VSK_VSL_PORT_SKD KK, BKG_VVD BB" ).append("\n"); 
		query.append("          WHERE   KK.VSL_CD = BB.VSL_CD" ).append("\n"); 
		query.append("          AND     KK.SKD_VOY_NO = BB.SKD_VOY_NO" ).append("\n"); 
		query.append("          AND     KK.SKD_DIR_CD = BB.SKD_DIR_CD" ).append("\n"); 
		query.append("          AND     KK.VPS_PORT_CD = BB.POL_CD" ).append("\n"); 
		query.append("          AND     BB.VSL_PRE_PST_CD='T'" ).append("\n"); 
		query.append("          AND     BB.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND     KK.CLPT_IND_SEQ = (SELECT MAX(CLPT_IND_SEQ) FROM VSK_VSL_PORT_SKD" ).append("\n"); 
		query.append("                                     WHERE  VSL_CD = KK.VSL_CD" ).append("\n"); 
		query.append("                                     AND    SKD_VOY_NO = KK.SKD_VOY_NO" ).append("\n"); 
		query.append("                                     AND    SKD_DIR_CD = KK.SKD_DIR_CD" ).append("\n"); 
		query.append("                                     AND    VPS_PORT_CD = KK.VPS_PORT_CD)" ).append("\n"); 
		query.append("          ) AS T_POL_ETAETD     " ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(KK1.VPS_ETA_DT,'YYYYMMDD')||TO_CHAR(KK1.VPS_ETD_DT,'YYYYMMDD') AS ETAETD " ).append("\n"); 
		query.append("          FROM VSK_VSL_PORT_SKD KK1, BKG_VVD BB1" ).append("\n"); 
		query.append("          WHERE   KK1.VSL_CD     = BB1.VSL_CD" ).append("\n"); 
		query.append("          AND     KK1.SKD_VOY_NO = BB1.SKD_VOY_NO" ).append("\n"); 
		query.append("          AND     KK1.SKD_DIR_CD = BB1.SKD_DIR_CD" ).append("\n"); 
		query.append("          AND     KK1.VPS_PORT_CD = BB1.POD_CD" ).append("\n"); 
		query.append("          AND     BB1.VSL_PRE_PST_CD='T'" ).append("\n"); 
		query.append("          AND     BB1.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND     KK1.CLPT_IND_SEQ = (SELECT MAX(CLPT_IND_SEQ) FROM VSK_VSL_PORT_SKD" ).append("\n"); 
		query.append("                                     WHERE VSL_CD = KK1.VSL_CD" ).append("\n"); 
		query.append("                                     AND   SKD_VOY_NO = KK1.SKD_VOY_NO" ).append("\n"); 
		query.append("                                     AND   SKD_DIR_CD = KK1.SKD_DIR_CD" ).append("\n"); 
		query.append("                                     AND   VPS_PORT_CD = KK1.VPS_PORT_CD)" ).append("\n"); 
		query.append("          ) AS T_POD_ETAETD           " ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(V3.VPS_ETA_DT,'YYYYMMDD')||TO_CHAR(V3.VPS_ETD_DT,'YYYYMMDD')" ).append("\n"); 
		query.append("          FROM  BKG_VVD K6, VSK_VSL_PORT_SKD V3" ).append("\n"); 
		query.append("          WHERE K6.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND K6.POD_CD = O.POD_CD     " ).append("\n"); 
		query.append("          AND K6.VSL_PRE_PST_CD||K6.VSL_SEQ = (SELECT MAX(S.VSL_PRE_PST_CD||S.VSL_SEQ) " ).append("\n"); 
		query.append("                                               FROM BKG_VVD S                " ).append("\n"); 
		query.append("                                               WHERE S.BKG_NO = O.BKG_NO    " ).append("\n"); 
		query.append("                                               AND S.POD_CD = O.POD_CD)       " ).append("\n"); 
		query.append("          AND V3.VSL_CD = K6.VSL_CD" ).append("\n"); 
		query.append("          AND V3.SKD_VOY_NO = K6.SKD_VOY_NO" ).append("\n"); 
		query.append("          AND V3.SKD_DIR_CD = K6.SKD_DIR_CD" ).append("\n"); 
		query.append("          AND V3.VPS_PORT_CD = K6.POD_CD" ).append("\n"); 
		query.append("          AND V3.CLPT_IND_SEQ = (SELECT MAX(V4.CLPT_IND_SEQ) FROM VSK_VSL_PORT_SKD V4" ).append("\n"); 
		query.append("                                 WHERE  V4.VSL_CD = K6.VSL_CD" ).append("\n"); 
		query.append("                                 AND    V4.SKD_VOY_NO = K6.SKD_VOY_NO" ).append("\n"); 
		query.append("                                 AND    V4.SKD_DIR_CD = K6.SKD_DIR_CD" ).append("\n"); 
		query.append("                                 AND    V4.VPS_PORT_CD =  K6.POD_CD)" ).append("\n"); 
		query.append("          ) AS L_POD_ETAETD" ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(MAX(DECODE(COPD.ACT_CD, 'FITRDO', '1', '0') || NVL(TO_CHAR(COPD.PLN_DT, 'YYYYMMDDHH24MISS'), '00000000000000')" ).append("\n"); 
		query.append("                            || NVL(TO_CHAR(NVL(COPD.ACT_DT, COPD.ESTM_DT), 'YYYYMMDDHH24MISS'), '00000000000000')" ).append("\n"); 
		query.append("                            || COPD.NOD_CD ), 2,8)" ).append("\n"); 
		query.append("          FROM SCE_COP_HDR COPM  , SCE_COP_DTL COPD" ).append("\n"); 
		query.append("          WHERE COPM.BKG_NO(+) = O.BKG_NO " ).append("\n"); 
		query.append("          AND COPD.COP_NO = COPM.COP_NO" ).append("\n"); 
		query.append("          AND COPM.COP_STS_CD <> 'X'" ).append("\n"); 
		query.append("          AND COPD.ACT_CD IN ('FITRDO', 'FUVMAD')  " ).append("\n"); 
		query.append("         ) AS COP_DEL_ETA " ).append("\n"); 
		query.append("        ,(SELECT  TO_CHAR(VSKD.VPS_ETA_DT + DECODE(SUBSTR(O.POD_CD,1,2) , 'US', 2 , DECODE(O.POD_CD, O.DEL_CD, 1, 2)),'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM BKG_VVD BVVD, VSK_VSL_PORT_SKD VSKD" ).append("\n"); 
		query.append("          WHERE  BVVD.VSL_CD = VSKD.VSL_CD(+)  " ).append("\n"); 
		query.append("          AND  BVVD.SKD_VOY_NO = VSKD.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("          AND  BVVD.SKD_DIR_CD = VSKD.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("          AND  BVVD.POD_CD = VSKD.VPS_PORT_CD(+)" ).append("\n"); 
		query.append("          AND  BVVD.POD_CLPT_IND_SEQ = VSKD.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("          AND  O.BKG_NO = BVVD.BKG_NO" ).append("\n"); 
		query.append("          AND  O.POD_CD = BVVD.POD_CD" ).append("\n"); 
		query.append("        ) AS VSK_DEL_ETA     " ).append("\n"); 
		query.append("        , TO_CHAR(NVL(" ).append("\n"); 
		query.append("          (SELECT /*+ INDEX_DESC (S XAK11CTM_MOVEMENT)*/" ).append("\n"); 
		query.append("                  S.CNMV_EVNT_DT" ).append("\n"); 
		query.append("           FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("           WHERE  1=1" ).append("\n"); 
		query.append("           AND    S.CNTR_NO     (+) = V.CNTR_NO" ).append("\n"); 
		query.append("           AND    S.CNMV_YR     (+) = V.CNMV_YR" ).append("\n"); 
		query.append("           AND    S.CNMV_CYC_NO (+) = V.CNMV_CYC_NO" ).append("\n"); 
		query.append("           AND    S.MVMT_STS_CD (+) = 'OC'" ).append("\n"); 
		query.append("           AND    ROWNUM            = 1" ).append("\n"); 
		query.append("           ), V.CGO_RCV_DT), 'YYYY-MM-DD') AS OC_DT  " ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(NVL(P.FAX_SND_DT, NVL(P.EML_SND_DT, '')),'YYYY-MM-DD') AN_SENT_DT" ).append("\n"); 
		query.append("          FROM BKG_ARR_NTC_DTL P" ).append("\n"); 
		query.append("          WHERE O.BKG_NO = P.BKG_NO(+)" ).append("\n"); 
		query.append("          AND  P.BKG_CUST_TP_CD(+) ='C' " ).append("\n"); 
		query.append("          AND  P.CUST_CNTC_TP_CD(+) = 'C1'  ) AS AN_SENT_DT " ).append("\n"); 
		query.append("        ,TO_CHAR(T.CSTMS_CLR_LST_DT,'YYYY-MM-DD')  AS CUST_CLR_DT " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_DESC(S XAK2CTM_MOVEMENT)*/" ).append("\n"); 
		query.append("                 S.MVMT_STS_CD||' '|| NVL(TO_CHAR(S.CNMV_EVNT_DT,'YYYY-MM-DD'),'') " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  S.BKG_NO     (+) = O.BKG_NO" ).append("\n"); 
		query.append("          AND    S.CNTR_NO    (+) = V.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO(+) = V.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    ROWNUM           = 1" ).append("\n"); 
		query.append("         ) AS MVMT_STS" ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_DESC(S XAK11CTM_MOVEMENT) */" ).append("\n"); 
		query.append("                 TO_CHAR(S.CNMV_EVNT_DT, 'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  1=1" ).append("\n"); 
		query.append("          AND    S.CNTR_NO     (+)  = V.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_YR     (+)  = V.CNMV_YR      " ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO (+)  = V.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    S.MVMT_STS_CD (+)  = 'ID'" ).append("\n"); 
		query.append("          AND    ROWNUM             = 1" ).append("\n"); 
		query.append("         ) AS PCK_AVAIL_DT" ).append("\n"); 
		query.append("        ,TO_CHAR(S.PKUP_FREE_DT,'YYYY-MM-DD' ) AS FREE_DT  " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_DESC(S XAK11CTM_MOVEMENT) */" ).append("\n"); 
		query.append("                 TO_CHAR(S.CNMV_EVNT_DT, 'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  1=1" ).append("\n"); 
		query.append("          AND    S.CNTR_NO     (+)  = V.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_YR     (+)  = V.CNMV_YR      " ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO (+)  = V.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    S.MVMT_STS_CD (+)  = 'ID'" ).append("\n"); 
		query.append("          AND    ROWNUM             = 1" ).append("\n"); 
		query.append("         ) AS DELIVER_DT " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_ASC(S XAK11CTM_MOVEMENT)*/" ).append("\n"); 
		query.append("                 TO_CHAR(S.CNMV_EVNT_DT,'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  1=1" ).append("\n"); 
		query.append("          AND    S.CNTR_NO     (+) = V.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_YR     (+) = V.CNMV_YR" ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO (+) = V.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    S.MVMT_STS_CD (+) = 'MT'" ).append("\n"); 
		query.append("          AND    ROWNUM            = 1" ).append("\n"); 
		query.append("         ) AS MT_RTN_DT" ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_ASC(S XAK11CTM_MOVEMENT)*/" ).append("\n"); 
		query.append("                 TO_CHAR(S.CNMV_EVNT_DT,'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  1=1" ).append("\n"); 
		query.append("          AND    S.CNTR_NO     (+) = V.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_YR     (+) = V.CNMV_YR" ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO (+) = V.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    S.MVMT_STS_CD (+) = 'IC'" ).append("\n"); 
		query.append("          AND    ROWNUM            = 1   " ).append("\n"); 
		query.append("         ) AS IC_DT" ).append("\n"); 
		query.append("      /*  RATE  INV089 - INV112 */  " ).append("\n"); 
		query.append("        ,DECODE(Q.CLT_PAYR_CNT_CD||Q.CLT_PAYR_CUST_SEQ, '', '', Q.CLT_PAYR_CNT_CD||'-'||LPAD(TO_CHAR(Q.CLT_PAYR_CUST_SEQ),6,'0')) AS CCT_CUST   " ).append("\n"); 
		query.append("        ,DECODE(U.N3PTY_CUST_CNT_CD||U.N3PTY_CUST_SEQ, '', '', U.N3PTY_CUST_CNT_CD||'-'||LPAD(TO_CHAR(U.N3PTY_CUST_SEQ),6,'0')) AS THR_CUST" ).append("\n"); 
		query.append("        ,Q.CLT_OFC_CD   AS CCT_OFC" ).append("\n"); 
		query.append("        ,(SELECT DECODE(U.FRT_TERM_CD, 'C',T.FRT_CLT_FLG,  MIN(NVL(OT.OTS_STL_FLG,'N'))) FROM BKG_OUTSTANDING OT" ).append("\n"); 
		query.append("          WHERE OT.CLT_BL_NO = O.BL_NO AND OT.OFC_CD = DECODE(U.N3PTY_RCV_OFC_CD, '', DECODE(U.FRT_TERM_CD, 'P', Q.PPD_RCV_OFC_CD, Q.CLT_OFC_CD), U.N3PTY_RCV_OFC_CD) AND OT.OTS_BND_TP_CD='O')  AS CLT_FLG " ).append("\n"); 
		query.append("        ,(SELECT GLM.USD_LOCL_XCH_RT " ).append("\n"); 
		query.append("          FROM BKG_CHG_RT R1, GL_MON_XCH_RT GLM" ).append("\n"); 
		query.append("          WHERE R1.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND R1.FRT_TERM_CD='C'" ).append("\n"); 
		query.append("          AND R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND R1.N3PTY_RCV_OFC_CD IS NULL" ).append("\n"); 
		query.append("          AND GLM.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND GLM.ACCT_XCH_RT_LVL = '1'" ).append("\n"); 
		query.append("          AND GLM.CURR_CD =  (SELECT O2.AR_CURR_CD" ).append("\n"); 
		query.append("                              FROM MDM_ORGANIZATION O1, MDM_ORGANIZATION O2" ).append("\n"); 
		query.append("                              WHERE O1.OFC_CD =Q.CLT_OFC_CD" ).append("\n"); 
		query.append("                              AND  O2.OFC_CD = O1.AR_OFC_CD) " ).append("\n"); 
		query.append("          AND ROWNUM=1 )      AS GL_EX_CCT " ).append("\n"); 
		query.append("       ,(SELECT SUM(ROUND(R1.CHG_AMT*(GL2.USD_LOCL_XCH_RT/GL1.USD_LOCL_XCH_RT),2))" ).append("\n"); 
		query.append("         FROM BKG_CHG_RT R1, GL_MON_XCH_RT GL1, GL_MON_XCH_RT GL2 " ).append("\n"); 
		query.append("         WHERE R1.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("         AND R1.FRT_TERM_CD='C'" ).append("\n"); 
		query.append("         AND R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("         AND R1.N3PTY_RCV_OFC_CD IS NULL" ).append("\n"); 
		query.append("         AND GL1.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("         AND GL1.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("         AND GL1.CURR_CD = R1.CURR_CD" ).append("\n"); 
		query.append("         AND GL2.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("         AND GL2.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("         AND GL2.CURR_CD =  (SELECT O2.AR_CURR_CD" ).append("\n"); 
		query.append("                             FROM MDM_ORGANIZATION O1, MDM_ORGANIZATION O2" ).append("\n"); 
		query.append("                             WHERE O1.OFC_CD =Q.CLT_OFC_CD" ).append("\n"); 
		query.append("                             AND  O2.OFC_CD = O1.AR_OFC_CD)   ) AS LCL_TOT_CCT " ).append("\n"); 
		query.append("        ,(SELECT SUM(ROUND(R1.CHG_AMT/GL1.USD_LOCL_XCH_RT,2))    " ).append("\n"); 
		query.append("          FROM BKG_CHG_RT R1, GL_MON_XCH_RT GL1 " ).append("\n"); 
		query.append("          WHERE R1.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND R1.FRT_TERM_CD ='C'" ).append("\n"); 
		query.append("          AND R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND R1.N3PTY_RCV_OFC_CD IS NULL" ).append("\n"); 
		query.append("          AND GL1.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND GL1.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND GL1.CURR_CD = R1.CURR_CD            ) AS USD_TOT_CCT " ).append("\n"); 
		query.append("        ,Q.AUD_STS_CD  AS AUD_STS_CD  " ).append("\n"); 
		query.append("        ,DECODE(Q.PPD_PAYR_CNT_CD||Q.PPD_PAYR_CUST_SEQ, '', '', Q.PPD_PAYR_CNT_CD||'-'||LPAD(TO_CHAR(Q.PPD_PAYR_CUST_SEQ),6,'0')) AS PPD_CUST" ).append("\n"); 
		query.append("        ,Q.PPD_RCV_OFC_CD   AS PPD_OFC    " ).append("\n"); 
		query.append("        ,(SELECT GLM.USD_LOCL_XCH_RT " ).append("\n"); 
		query.append("          FROM BKG_CHG_RT R1, GL_MON_XCH_RT GLM" ).append("\n"); 
		query.append("          WHERE R1.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND R1.FRT_TERM_CD='P'" ).append("\n"); 
		query.append("          AND R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND R1.N3PTY_RCV_OFC_CD IS NULL" ).append("\n"); 
		query.append("          AND GLM.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND GLM.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND GLM.CURR_CD =  (SELECT O2.AR_CURR_CD" ).append("\n"); 
		query.append("                              FROM MDM_ORGANIZATION O1, MDM_ORGANIZATION O2" ).append("\n"); 
		query.append("                              WHERE O1.OFC_CD =Q.PPD_RCV_OFC_CD" ).append("\n"); 
		query.append("                              AND  O2.OFC_CD = O1.AR_OFC_CD )" ).append("\n"); 
		query.append("          AND ROWNUM=1     )      AS GL_EX_PPD  " ).append("\n"); 
		query.append("        ,(SELECT SUM(ROUND(R2.CHG_AMT*(GL4.USD_LOCL_XCH_RT/GL3.USD_LOCL_XCH_RT),2))" ).append("\n"); 
		query.append("          FROM BKG_CHG_RT R2, GL_MON_XCH_RT GL3, GL_MON_XCH_RT GL4" ).append("\n"); 
		query.append("          WHERE R2.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND   R2.FRT_TERM_CD ='P'" ).append("\n"); 
		query.append("          AND   R2.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND   R2.N3PTY_RCV_OFC_CD IS NULL" ).append("\n"); 
		query.append("          AND   GL3.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R2.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND   GL3.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND   GL3.CURR_CD = R2.CURR_CD" ).append("\n"); 
		query.append("          AND   GL4.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R2.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND   GL4.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND   GL4.CURR_CD =  (SELECT O2.AR_CURR_CD" ).append("\n"); 
		query.append("                                FROM MDM_ORGANIZATION O1, MDM_ORGANIZATION O2" ).append("\n"); 
		query.append("                                WHERE O1.OFC_CD =Q.PPD_RCV_OFC_CD" ).append("\n"); 
		query.append("                                AND  O2.OFC_CD = O1.AR_OFC_CD)   ) AS LCL_TOT_PPD " ).append("\n"); 
		query.append("        ,(SELECT SUM(ROUND(R1.CHG_AMT/GL1.USD_LOCL_XCH_RT,2))    " ).append("\n"); 
		query.append("          FROM BKG_CHG_RT R1, GL_MON_XCH_RT GL1 " ).append("\n"); 
		query.append("          WHERE R1.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND R1.FRT_TERM_CD='P'" ).append("\n"); 
		query.append("          AND R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND R1.N3PTY_RCV_OFC_CD IS NULL" ).append("\n"); 
		query.append("          AND GL1.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND GL1.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND GL1.CURR_CD = R1.CURR_CD            ) AS USD_TOT_PPD " ).append("\n"); 
		query.append("        ,(SELECT GLM.USD_LOCL_XCH_RT " ).append("\n"); 
		query.append("          FROM BKG_CHG_RT R1, GL_MON_XCH_RT GLM" ).append("\n"); 
		query.append("          WHERE R1.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND R1.FRT_TERM_CD=U.FRT_TERM_CD" ).append("\n"); 
		query.append("          AND R1.N3PTY_RCV_OFC_CD = U.N3PTY_RCV_OFC_CD" ).append("\n"); 
		query.append("          AND R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND GLM.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND GLM.ACCT_XCH_RT_LVL = '1'" ).append("\n"); 
		query.append("          AND GLM.CURR_CD =  (SELECT O2.AR_CURR_CD" ).append("\n"); 
		query.append("                              FROM MDM_ORGANIZATION O1, MDM_ORGANIZATION O2" ).append("\n"); 
		query.append("                              WHERE O1.OFC_CD = U.N3PTY_RCV_OFC_CD" ).append("\n"); 
		query.append("                              AND  O2.OFC_CD = O1.AR_OFC_CD) " ).append("\n"); 
		query.append("          AND ROWNUM=1 )      AS GL_EX_THR" ).append("\n"); 
		query.append("       ,(SELECT SUM(ROUND(R1.CHG_AMT*(GL2.USD_LOCL_XCH_RT/GL1.USD_LOCL_XCH_RT),2))" ).append("\n"); 
		query.append("         FROM BKG_CHG_RT R1, GL_MON_XCH_RT GL1, GL_MON_XCH_RT GL2 " ).append("\n"); 
		query.append("         WHERE R1.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("         AND R1.FRT_TERM_CD=U.FRT_TERM_CD" ).append("\n"); 
		query.append("         AND R1.N3PTY_RCV_OFC_CD = U.N3PTY_RCV_OFC_CD" ).append("\n"); 
		query.append("         AND R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("         AND GL1.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("         AND GL1.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("         AND GL1.CURR_CD = R1.CURR_CD" ).append("\n"); 
		query.append("         AND GL2.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("         AND GL2.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("         AND GL2.CURR_CD =  (SELECT O2.AR_CURR_CD" ).append("\n"); 
		query.append("                             FROM MDM_ORGANIZATION O1, MDM_ORGANIZATION O2" ).append("\n"); 
		query.append("                             WHERE O1.OFC_CD = U.N3PTY_RCV_OFC_CD" ).append("\n"); 
		query.append("                             AND  O2.OFC_CD = O1.AR_OFC_CD)   ) AS LCL_TOT_THR " ).append("\n"); 
		query.append("        ,(SELECT SUM(ROUND(R1.CHG_AMT/GL1.USD_LOCL_XCH_RT,2))    " ).append("\n"); 
		query.append("          FROM BKG_CHG_RT R1, GL_MON_XCH_RT GL1 " ).append("\n"); 
		query.append("          WHERE R1.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND R1.FRT_TERM_CD = U.FRT_TERM_CD" ).append("\n"); 
		query.append("          AND R1.N3PTY_RCV_OFC_CD = U.N3PTY_RCV_OFC_CD" ).append("\n"); 
		query.append("          AND R1.FRT_INCL_XCLD_DIV_CD ='N'" ).append("\n"); 
		query.append("          AND GL1.ACCT_XCH_RT_YRMON =  SUBSTR(TO_CHAR(R1.CRE_DT,'YYYYMMDD'),1,6)" ).append("\n"); 
		query.append("          AND GL1.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND GL1.CURR_CD = R1.CURR_CD            ) AS USD_TOT_THR   " ).append("\n"); 
		query.append("        ,TO_CHAR(Q.RT_APLY_DT,'YYYY-MM-DD') RT_APLY_DT  " ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CR.IB_CR_TERM_DYS),0) FROM MDM_CR_CUST CR" ).append("\n"); 
		query.append("          WHERE (CR.CUST_CNT_CD, CR.CUST_SEQ) = (SELECT C1.CUST_CNT_CD, C1.CUST_SEQ" ).append("\n"); 
		query.append("                                                 FROM  BKG_CUSTOMER C1" ).append("\n"); 
		query.append("                                                 WHERE C1.BKG_NO = O.BKG_NO AND C1.BKG_CUST_TP_CD ='C')) AS IB_CUST_CRTERM  " ).append("\n"); 
		query.append("        ,(SELECT M2.IB_CR_TERM_DYS " ).append("\n"); 
		query.append("          FROM  MDM_ORGANIZATION M1, MDM_ORGANIZATION M2" ).append("\n"); 
		query.append("          WHERE  M1.OFC_CD = Q.CLT_OFC_CD" ).append("\n"); 
		query.append("          AND    M2.OFC_CD = M1.AR_OFC_CD) AS IB_OFC_CRTERM     " ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CR2.OB_CR_TERM_DYS),0) FROM MDM_CR_CUST CR2  " ).append("\n"); 
		query.append("          WHERE (CR2.CUST_CNT_CD, CR2.CUST_SEQ) = (SELECT C1.CUST_CNT_CD, C1.CUST_SEQ" ).append("\n"); 
		query.append("                                                   FROM  BKG_CUSTOMER C1" ).append("\n"); 
		query.append("                                                   WHERE C1.BKG_NO = O.BKG_NO AND C1.BKG_CUST_TP_CD ='S')) AS OB_CUST_CRTERM   " ).append("\n"); 
		query.append("        ,(SELECT M2.OB_CR_TERM_DYS         " ).append("\n"); 
		query.append("          FROM  MDM_ORGANIZATION M1, MDM_ORGANIZATION M2" ).append("\n"); 
		query.append("          WHERE  M1.OFC_CD = Q.PPD_RCV_OFC_CD" ).append("\n"); 
		query.append("          AND    M2.OFC_CD = M1.AR_OFC_CD) AS OB_OFC_CRTERM  " ).append("\n"); 
		query.append("        ,(SELECT CNTR_SEAL_NO  FROM BKG_CNTR_SEAL_NO" ).append("\n"); 
		query.append("          WHERE BKG_NO =  O.BKG_NO" ).append("\n"); 
		query.append("          AND   CNTR_NO = V.CNTR_NO " ).append("\n"); 
		query.append("          AND CNTR_SEAL_SEQ = 1 ) AS CNTR_SEAL_NO" ).append("\n"); 
		query.append("        ,(SELECT  DECODE(V.CNTR_TPSZ_CD, 'D7','45',SUBSTR(SZ.CNTR_SZ_DESC, 1, 2)) FROM MDM_CNTR_SZ SZ,MDM_CNTR_TP_SZ TP" ).append("\n"); 
		query.append("          WHERE  TP.CNTR_TPSZ_CD = V.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("          AND TP.CNTR_SZ_CD = SZ.CNTR_SZ_CD     )  AS CNTR_SZ_CD" ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CO2.CUST_CONV_CD_CTNT), V.CNTR_TPSZ_CD) " ).append("\n"); 
		query.append("          FROM  INV_CPRT_CD_CONV CO2  " ).append("\n"); 
		query.append("          WHERE CO2.CPRT_CONV_TP_CD ='CNTRTPSZ'" ).append("\n"); 
		query.append("          AND   CO2.CO_CD_CTNT = V.CNTR_TPSZ_CD " ).append("\n"); 
		query.append("          AND   CO2.SC_NO  = NVL(O.SC_NO,'X') " ).append("\n"); 
		query.append("          AND   CO2.RFA_NO = NVL(O.RFA_NO,'X')) AS CNTR_TPSZ_CD    " ).append("\n"); 
		query.append("        ,NVL(V.DCGO_FLG, NVL(V.RC_FLG,NVL(V.BB_CGO_FLG,NVL(V.AWK_CGO_FLG,'')))) AS CNTR_SP_CGO_FG  " ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(U1.CUST_REF_NO_CTNT,1,50) FROM BKG_REFERENCE U1 " ).append("\n"); 
		query.append("          WHERE O.BKG_NO = U1.BKG_NO(+)" ).append("\n"); 
		query.append("          AND U1.BKG_REF_TP_CD='BKPO' AND ROWNUM=1) AS BKPO  " ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(U2.CUST_REF_NO_CTNT,1,50) FROM BKG_REFERENCE U2 " ).append("\n"); 
		query.append("          WHERE O.BKG_NO = U2.BKG_NO(+) " ).append("\n"); 
		query.append("          AND  V.CNTR_NO = U2.CNTR_NO(+) " ).append("\n"); 
		query.append("          AND U2.BKG_REF_TP_CD='CTPO' AND ROWNUM=1) AS CTPO  " ).append("\n"); 
		query.append("        ,(SELECT V.PRT_NO FROM BKG_REF_DTL V " ).append("\n"); 
		query.append("          WHERE O.BKG_NO = V.BKG_NO(+)" ).append("\n"); 
		query.append("          AND V.CUST_REF_TP_CD='HP' AND ROWNUM=1)  AS PRT_NO    " ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(U3.CUST_REF_NO_CTNT,1,50) FROM BKG_REFERENCE U3 " ).append("\n"); 
		query.append("          WHERE O.BKG_NO = U3.BKG_NO(+)" ).append("\n"); 
		query.append("          AND U3.BKG_REF_TP_CD='FINV' AND ROWNUM=1) AS INV_REF_NO   " ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(U4.CUST_REF_NO_CTNT,1,50) FROM BKG_REFERENCE U4 " ).append("\n"); 
		query.append("          WHERE O.BKG_NO = U4.BKG_NO(+)" ).append("\n"); 
		query.append("          AND U4.BKG_REF_TP_CD='EBRF' AND ROWNUM=1) AS BKG_REF_NO   " ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(U5.CUST_REF_NO_CTNT,1,50) FROM BKG_REFERENCE U5     " ).append("\n"); 
		query.append("          WHERE O.BKG_NO = U5.BKG_NO(+)" ).append("\n"); 
		query.append("          AND U5.BKG_REF_TP_CD='ESRF' AND ROWNUM=1) AS SI_REF_NO  " ).append("\n"); 
		query.append("        ,(SELECT U6.CUST_NM FROM BKG_CUSTOMER U6  " ).append("\n"); 
		query.append("          WHERE O.BKG_NO = U6.BKG_NO(+)" ).append("\n"); 
		query.append("          AND U6.BKG_CUST_TP_CD = 'E' AND ROWNUM=1) AS EXP_REF_NO    " ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CO3.CUST_CONV_CD_CTNT), U.CHG_CD) " ).append("\n"); 
		query.append("          FROM  INV_CPRT_CD_CONV CO3  " ).append("\n"); 
		query.append("          WHERE CO3.CPRT_CONV_TP_CD ='CHARGE' " ).append("\n"); 
		query.append("          AND  CO3.CO_CD_CTNT = U.CHG_CD" ).append("\n"); 
		query.append("          AND  CO3.SC_NO  = NVL(O.SC_NO,'X') " ).append("\n"); 
		query.append("          AND  CO3.RFA_NO = NVL(O.RFA_NO,'X'))  AS CHG_CD" ).append("\n"); 
		query.append("        ,(SELECT NVL(MAX(CO4.CUST_CONV_CD_CTNT), O.CMDT_CD) " ).append("\n"); 
		query.append("          FROM  INV_CPRT_CD_CONV CO4  " ).append("\n"); 
		query.append("          WHERE CO4.CPRT_CONV_TP_CD ='COMMODITY' " ).append("\n"); 
		query.append("          AND  CO4.CO_CD_CTNT = O.CMDT_CD" ).append("\n"); 
		query.append("          AND  CO4.SC_NO  = NVL(O.SC_NO,'X') " ).append("\n"); 
		query.append("          AND  CO4.RFA_NO = NVL(O.RFA_NO,'X')) AS CMDT_CD   " ).append("\n"); 
		query.append("        ,(SELECT D.CMDT_NM FROM MDM_COMMODITY D WHERE O.CMDT_CD = D.CMDT_CD(+)) AS CMDT_NM " ).append("\n"); 
		query.append("        ,(SELECT TO_CHAR(SUBSTR(S.MK_DESC, 1, 4000)) FROM BKG_BL_MK_DESC S WHERE S.BKG_NO = O.BKG_NO AND S.MK_SEQ=1) AS MK_DESC" ).append("\n"); 
		query.append("        ,(SELECT M.RTN_YD_CD FROM BKG_PKUP_NTC M " ).append("\n"); 
		query.append("          WHERE M.BKG_NO = O.BKG_NO " ).append("\n"); 
		query.append("          AND  M.NTC_SEQ = (SELECT MAX(MM.NTC_SEQ) " ).append("\n"); 
		query.append("                            FROM BKG_PKUP_NTC MM " ).append("\n"); 
		query.append("                            WHERE MM.BKG_NO = O.BKG_NO)) AS RTN_YD_CD" ).append("\n"); 
		query.append("        ,(SELECT HUB_LOC_CD FROM BKG_CSTMS_ADV_BL" ).append("\n"); 
		query.append("          WHERE BL_NO = O.BL_NO    " ).append("\n"); 
		query.append("          AND CNT_CD =SUBSTR(O.DEL_CD,1,2)) AS HUB_LOC_CD  " ).append("\n"); 
		query.append("        ,(SELECT MAX(DECODE(CNT_CD, 'US', IBD_TRSP_NO, ''))  " ).append("\n"); 
		query.append("          FROM BKG_CSTMS_ADV_IBD                        " ).append("\n"); 
		query.append("          WHERE  BL_NO = O.BL_NO AND CNT_CD ='US' ) AS IBD_TRSP_NO  " ).append("\n"); 
		query.append("        ,(SELECT MAX(DECODE(CNT_CD ,'US', TO_CHAR(IBD_TRSP_ISS_DT,'YYYY-MM-DD'), ''))" ).append("\n"); 
		query.append("          FROM  BKG_CSTMS_ADV_IBD" ).append("\n"); 
		query.append("          WHERE BL_NO = O.BL_NO AND CNT_CD ='US' ) AS IBD_TRSP_ISS_DT " ).append("\n"); 
		query.append("        ,(SELECT M1.PKUP_NO FROM BKG_PKUP_NTC M1 " ).append("\n"); 
		query.append("          WHERE M1.BKG_NO = O.BKG_NO " ).append("\n"); 
		query.append("          AND M1.NTC_SEQ = (SELECT MAX(M2.NTC_SEQ) " ).append("\n"); 
		query.append("                           FROM BKG_PKUP_NTC M2 WHERE M2.BKG_NO = O.BKG_NO)) AS PKUP_NO " ).append("\n"); 
		query.append("        ,(SELECT M3.PKUP_YD_CD FROM BKG_PKUP_NTC M3 " ).append("\n"); 
		query.append("          WHERE M3.BKG_NO = O.BKG_NO " ).append("\n"); 
		query.append("          AND M3.NTC_SEQ = (SELECT MAX(M4.NTC_SEQ) " ).append("\n"); 
		query.append("                           FROM BKG_PKUP_NTC M4 WHERE M4.BKG_NO = O.BKG_NO)) AS PKUP_YD_CD  " ).append("\n"); 
		query.append("        ,(SELECT MAX(TO_CHAR(BC.CGO_RCV_DT,'YYYY-MM-DD')) " ).append("\n"); 
		query.append("          FROM BKG_CONTAINER BC " ).append("\n"); 
		query.append("          WHERE BC.BKG_NO = O.BKG_NO  ) AS CGO_RCV_DT" ).append("\n"); 
		query.append("        ,(SELECT SUBSTR(U7.CUST_REF_NO_CTNT,1,50) FROM BKG_REFERENCE U7" ).append("\n"); 
		query.append("          WHERE O.BKG_NO = U7.BKG_NO(+)" ).append("\n"); 
		query.append("          AND U7.BKG_REF_TP_CD='HPDP' AND ROWNUM=1) AS DEPT_NO           " ).append("\n"); 
		query.append("        ,U.FRT_TERM_CD" ).append("\n"); 
		query.append("        ,R.OBL_ISS_OFC_CD" ).append("\n"); 
		query.append("        ,V.MEAS_QTY     " ).append("\n"); 
		query.append("        ,V.CNTR_NO      " ).append("\n"); 
		query.append("        ,V.CNTR_PRT_FLG " ).append("\n"); 
		query.append("        ,V.CNTR_VOL_QTY " ).append("\n"); 
		query.append("        ,V.PCK_QTY       " ).append("\n"); 
		query.append("        ,V.PCK_TP_CD    " ).append("\n"); 
		query.append("        ,V.CNTR_WGT     " ).append("\n"); 
		query.append("        ,V.WGT_UT_CD   " ).append("\n"); 
		query.append("        ,V.CURR_CD AS CNTR_CHG_CURR" ).append("\n"); 
		query.append("        ,U.CURR_CD AS GRP_CUR" ).append("\n"); 
		query.append("        ,U.CHG_SUM1 AS TOT_CURR_AMT" ).append("\n"); 
		query.append("        ,V.CNTR_SUM1              " ).append("\n"); 
		query.append("        ,V.CNTR_SUM2   " ).append("\n"); 
		query.append("        ,U.CURR_CD AS CHG_CURR" ).append("\n"); 
		query.append("        ,U.RAT_AS_QTY AS CHG_RATED_AS" ).append("\n"); 
		query.append("        ,U.CHG_UT_AMT AS CHG_RATE" ).append("\n"); 
		query.append("        ,U.CHG_SUM2 AS TOT_CHG_AMT" ).append("\n"); 
		query.append("        ,T.OBL_RDEM_FLG" ).append("\n"); 
		query.append("        ,T.CSTMS_CLR_CD" ).append("\n"); 
		query.append("        ,U.N3PTY_RCV_OFC_CD AS N3PTY_OFC" ).append("\n"); 
		query.append("        /* ADD NEW ITEMS *****************************************************/" ).append("\n"); 
		query.append("        ,O.BL_TP_CD" ).append("\n"); 
		query.append("        ,DECODE(U.FRT_TERM_CD, 'P', 'O', 'I') AS BOUND" ).append("\n"); 
		query.append("        ,( SELECT DECODE(C1.CUST_CNT_CD||C1.CUST_SEQ, '', '', C1.CUST_CNT_CD||'-'||LPAD(TO_CHAR(C1.CUST_SEQ),6,'0'))" ).append("\n"); 
		query.append("           FROM  BKG_CUSTOMER C1" ).append("\n"); 
		query.append("           WHERE C1.BKG_NO = O.BKG_NO AND C1.BKG_CUST_TP_CD ='F' ) AS FORWARDER " ).append("\n"); 
		query.append("        ,( SELECT C1.CUST_NM" ).append("\n"); 
		query.append("           FROM  BKG_CUSTOMER C1" ).append("\n"); 
		query.append("           WHERE C1.BKG_NO = O.BKG_NO AND C1.BKG_CUST_TP_CD ='F' ) AS FORWARDER_NM " ).append("\n"); 
		query.append("        ,DECODE(U.FRT_TERM_CD, 'P', O.OB_SLS_OFC_CD, O.IB_SLS_OFC_CD) AS SLS_OFC_CD" ).append("\n"); 
		query.append("        ,O.OB_SREP_CD AS SREP_CD" ).append("\n"); 
		query.append("        ,(SELECT TRD_CD FROM COA_RGST_BKG WHERE BKG_NO = O.BKG_NO) AS TRADE_CD" ).append("\n"); 
		query.append("        ,DECODE(DECODE(U.FRT_TERM_CD, 'P', O.RCV_TERM_CD, O.DE_TERM_CD), 'S', 'LCL', 'FCL') AS TRAFFIC_MOD" ).append("\n"); 
		query.append("        ,V.MEAS_UT_CD AS CNTR_MEAS_UT" ).append("\n"); 
		query.append("        ,V.DIFF_RMK AS CNTR_DESC" ).append("\n"); 
		query.append("        ,(SELECT NVL(CR.CR_AMT, 0) FROM MDM_CR_CUST CR" ).append("\n"); 
		query.append("          WHERE (CR.CUST_CNT_CD, CR.CUST_SEQ) = (SELECT C1.CUST_CNT_CD, C1.CUST_SEQ" ).append("\n"); 
		query.append("                                                 FROM  BKG_CUSTOMER C1" ).append("\n"); 
		query.append("                                                 WHERE C1.BKG_NO = O.BKG_NO AND C1.BKG_CUST_TP_CD = DECODE(U.FRT_TERM_CD, 'P', 'S', 'C'))) AS CREDIT_AMT       " ).append("\n"); 
		query.append("        ,(SELECT NVL(CR2.CR_FLG, 'N') FROM MDM_CR_CUST CR2  " ).append("\n"); 
		query.append("          WHERE (CR2.CUST_CNT_CD, CR2.CUST_SEQ) = (SELECT C1.CUST_CNT_CD, C1.CUST_SEQ" ).append("\n"); 
		query.append("                                                   FROM  BKG_CUSTOMER C1" ).append("\n"); 
		query.append("                                                   WHERE C1.BKG_NO = O.BKG_NO AND C1.BKG_CUST_TP_CD = DECODE(U.FRT_TERM_CD, 'P', 'S', 'C'))) AS CREDIT_FLG              " ).append("\n"); 
		query.append("        ,(SELECT CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("          FROM MDM_CUSTOMER" ).append("\n"); 
		query.append("          WHERE CUST_CNT_CD = DECODE(U.N3PTY_RCV_OFC_CD, '', DECODE(U.FRT_TERM_CD, 'P', Q.PPD_PAYR_CNT_CD, Q.CLT_PAYR_CNT_CD), U.N3PTY_CUST_CNT_CD)" ).append("\n"); 
		query.append("          AND CUST_SEQ = DECODE(U.N3PTY_RCV_OFC_CD, '', DECODE(U.FRT_TERM_CD, 'P', Q.PPD_PAYR_CUST_SEQ, Q.CLT_PAYR_CUST_SEQ), U.N3PTY_CUST_SEQ)) AS BILL_CUST_NM" ).append("\n"); 
		query.append("        ,(SELECT BZET_ADDR" ).append("\n"); 
		query.append("          FROM MDM_CUST_ADDR" ).append("\n"); 
		query.append("          WHERE CUST_CNT_CD = DECODE(U.N3PTY_RCV_OFC_CD, '', DECODE(U.FRT_TERM_CD, 'P', Q.PPD_PAYR_CNT_CD, Q.CLT_PAYR_CNT_CD), U.N3PTY_CUST_CNT_CD)" ).append("\n"); 
		query.append("          AND CUST_SEQ = DECODE(U.N3PTY_RCV_OFC_CD, '', DECODE(U.FRT_TERM_CD, 'P', Q.PPD_PAYR_CUST_SEQ, Q.CLT_PAYR_CUST_SEQ), U.N3PTY_CUST_SEQ)" ).append("\n"); 
		query.append("          AND PRMRY_CHK_FLG = 'Y') AS BILL_CUST_ADDR" ).append("\n"); 
		query.append("        ,(SELECT B.OFC_ENG_NM" ).append("\n"); 
		query.append("          FROM MDM_CUSTOMER A, MDM_ORGANIZATION B" ).append("\n"); 
		query.append("          WHERE A.OFC_CD = B.OFC_CD" ).append("\n"); 
		query.append("          AND A.CUST_CNT_CD = DECODE(U.N3PTY_RCV_OFC_CD, '', DECODE(U.FRT_TERM_CD, 'P', Q.PPD_PAYR_CNT_CD, Q.CLT_PAYR_CNT_CD), U.N3PTY_CUST_CNT_CD)" ).append("\n"); 
		query.append("          AND A.CUST_SEQ = DECODE(U.N3PTY_RCV_OFC_CD, '', DECODE(U.FRT_TERM_CD, 'P', Q.PPD_PAYR_CUST_SEQ, Q.CLT_PAYR_CUST_SEQ), U.N3PTY_CUST_SEQ)) AS CUST_OFC_NM" ).append("\n"); 
		query.append("        ,(SELECT B.MODI_AGN_CD" ).append("\n"); 
		query.append("          FROM MDM_CUSTOMER A, MDM_ORGANIZATION B" ).append("\n"); 
		query.append("          WHERE A.OFC_CD = B.OFC_CD" ).append("\n"); 
		query.append("          AND A.CUST_CNT_CD = DECODE(U.N3PTY_RCV_OFC_CD, '', DECODE(U.FRT_TERM_CD, 'P', Q.PPD_PAYR_CNT_CD, Q.CLT_PAYR_CNT_CD), U.N3PTY_CUST_CNT_CD)" ).append("\n"); 
		query.append("          AND A.CUST_SEQ = DECODE(U.N3PTY_RCV_OFC_CD, '', DECODE(U.FRT_TERM_CD, 'P', Q.PPD_PAYR_CUST_SEQ, Q.CLT_PAYR_CUST_SEQ), U.N3PTY_CUST_SEQ)) AS CUST_OFC_SAP_ID   " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_ASC(S XAK11CTM_MOVEMENT)*/" ).append("\n"); 
		query.append("                 TO_CHAR(S.CNMV_EVNT_DT,'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  1=1" ).append("\n"); 
		query.append("          AND    S.CNTR_NO     (+) = V.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_YR     (+) = V.CNMV_YR" ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO (+) = V.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    S.MVMT_STS_CD (+) = 'VD'" ).append("\n"); 
		query.append("          AND    ROWNUM            = 1   " ).append("\n"); 
		query.append("         ) AS DISCHARGE_DT   " ).append("\n"); 
		query.append("        ,(SELECT MAX(OTS_HIS_SEQ)" ).append("\n"); 
		query.append("          FROM SAR_OTS_HIS A," ).append("\n"); 
		query.append("               MDM_ORGANIZATION B" ).append("\n"); 
		query.append("          WHERE B.OFC_CD = DECODE(U.N3PTY_RCV_OFC_CD, '', DECODE(U.FRT_TERM_CD, 'P', Q.PPD_RCV_OFC_CD, Q.CLT_OFC_CD), U.N3PTY_RCV_OFC_CD)" ).append("\n"); 
		query.append("          AND A.BL_NO = O.BL_NO" ).append("\n"); 
		query.append("          AND A.INV_OFC_CD = B.AR_OFC_CD" ).append("\n"); 
		query.append("          AND A.OTS_HIS_TP_CD = 'OTS') AS OTS_HIS_SEQ" ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_ASC(S XAK11CTM_MOVEMENT)*/" ).append("\n"); 
		query.append("                 TO_CHAR(S.CNMV_EVNT_DT,'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  1=1" ).append("\n"); 
		query.append("          AND    S.CNTR_NO     (+) = V.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_YR     (+) = V.CNMV_YR" ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO (+) = V.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    S.MVMT_STS_CD (+) = 'OP'" ).append("\n"); 
		query.append("          AND    ROWNUM            = 1   " ).append("\n"); 
		query.append("         ) AS MT_OUT_DT  " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_ASC(S XAK11CTM_MOVEMENT)*/" ).append("\n"); 
		query.append("                 TO_CHAR(S.CNMV_EVNT_DT,'YYYY-MM-DD')  " ).append("\n"); 
		query.append("          FROM   CTM_MOVEMENT S" ).append("\n"); 
		query.append("          WHERE  1=1" ).append("\n"); 
		query.append("          AND    S.CNTR_NO     (+) = V.CNTR_NO" ).append("\n"); 
		query.append("          AND    S.CNMV_YR     (+) = V.CNMV_YR" ).append("\n"); 
		query.append("          AND    S.CNMV_CYC_NO (+) = V.CNMV_CYC_NO" ).append("\n"); 
		query.append("          AND    S.MVMT_STS_CD (+) = 'VL'" ).append("\n"); 
		query.append("          AND    ROWNUM            = 1   " ).append("\n"); 
		query.append("         ) AS LOADING_DT   " ).append("\n"); 
		query.append("        ,(SELECT MAX(AR_IF_NO)" ).append("\n"); 
		query.append("          FROM INV_AR_MN A," ).append("\n"); 
		query.append("               MDM_ORGANIZATION B" ).append("\n"); 
		query.append("          WHERE B.OFC_CD = DECODE(U.N3PTY_RCV_OFC_CD, '', DECODE(U.FRT_TERM_CD, 'P', Q.PPD_RCV_OFC_CD, Q.CLT_OFC_CD), U.N3PTY_RCV_OFC_CD)" ).append("\n"); 
		query.append("          AND A.BL_SRC_NO = O.BL_NO" ).append("\n"); 
		query.append("          AND A.AR_OFC_CD = B.AR_OFC_CD" ).append("\n"); 
		query.append("          AND A.REV_TP_CD <> 'M'" ).append("\n"); 
		query.append("          AND A.BL_INV_CFM_DT IS NOT NULL" ).append("\n"); 
		query.append("          AND A.INV_DELT_DIV_CD <> 'Y') AS AR_IF_NO " ).append("\n"); 
		query.append("        ,(SELECT CRR_CD" ).append("\n"); 
		query.append("          FROM MDM_VSL_CNTR " ).append("\n"); 
		query.append("          WHERE VSL_CD = (SELECT K3.VSL_CD " ).append("\n"); 
		query.append("                          FROM BKG_VVD K3 " ).append("\n"); 
		query.append("                          WHERE K3.BKG_NO = O.BKG_NO " ).append("\n"); 
		query.append("                          AND K3.VSL_PRE_PST_CD ='T')) AS CARRIER" ).append("\n"); 
		query.append("        ,U.CHG_AMT  " ).append("\n"); 
		query.append("        ,(SELECT ROUND(U.CHG_AMT/GL1.USD_LOCL_XCH_RT, 2)" ).append("\n"); 
		query.append("          FROM GL_MON_XCH_RT GL1 " ).append("\n"); 
		query.append("          WHERE GL1.ACCT_XCH_RT_YRMON = SUBSTR(TO_CHAR(U.CRE_DT,'YYYYMMDD'), 1, 6)" ).append("\n"); 
		query.append("          AND GL1.ACCT_XCH_RT_LVL = '1'  " ).append("\n"); 
		query.append("          AND GL1.CURR_CD = U.CURR_CD) AS USD_CHG_AMT " ).append("\n"); 
		query.append("        ,(SELECT CHG_NM" ).append("\n"); 
		query.append("          FROM MDM_CHARGE" ).append("\n"); 
		query.append("          WHERE CHG_CD = U.CHG_CD) AS CHG_NM" ).append("\n"); 
		query.append("        ,DECODE(U.N3PTY_RCV_OFC_CD, '', 'N', 'Y') AS THR_PAY_FLG" ).append("\n"); 
		query.append("        ,O.POL_CD AS FST_POL  " ).append("\n"); 
		query.append("        ,O.POD_CD AS LST_POD " ).append("\n"); 
		query.append("        ,(SELECT /*+ INDEX_DESC( K6 XPKBKG_VVD ) */ " ).append("\n"); 
		query.append("                 K6.VSL_CD||K6.SKD_VOY_NO||K6.SKD_DIR_CD " ).append("\n"); 
		query.append("          FROM  BKG_VVD K6" ).append("\n"); 
		query.append("          WHERE K6.BKG_NO = O.BKG_NO" ).append("\n"); 
		query.append("          AND K6.POD_CD = O.POD_CD      " ).append("\n"); 
		query.append("          AND K6.VSL_PRE_PST_CD||K6.VSL_SEQ = (SELECT MAX(S.VSL_PRE_PST_CD||S.VSL_SEQ) " ).append("\n"); 
		query.append("                                               FROM BKG_VVD S               " ).append("\n"); 
		query.append("                                               WHERE S.BKG_NO = O.BKG_NO     " ).append("\n"); 
		query.append("                                               AND S.POD_CD = O.POD_CD)      " ).append("\n"); 
		query.append("          ) AS LST_VVD" ).append("\n"); 
		query.append("        ,V.CHG_AMT AS CNTR_AMT" ).append("\n"); 
		query.append("        /***********************************************************/" ).append("\n"); 
		query.append("        ,U.CHG001_S" ).append("\n"); 
		query.append("        ,U.CHG002_S" ).append("\n"); 
		query.append("        ,U.CHG003_S" ).append("\n"); 
		query.append("        ,U.CHG004_S" ).append("\n"); 
		query.append("        ,U.CHG005_S" ).append("\n"); 
		query.append("        ,V.CHG001" ).append("\n"); 
		query.append("        ,V.CHG002" ).append("\n"); 
		query.append("        ,V.CHG003" ).append("\n"); 
		query.append("        ,V.CHG004" ).append("\n"); 
		query.append("        ,V.CHG005  " ).append("\n"); 
		query.append("    FROM BKG_BOOKING O," ).append("\n"); 
		query.append("         BKG_BL_DOC P," ).append("\n"); 
		query.append("         BKG_RATE Q," ).append("\n"); 
		query.append("         BKG_BL_ISS R," ).append("\n"); 
		query.append("         BKG_ARR_NTC S," ).append("\n"); 
		query.append("         BKG_CGO_RLSE T, " ).append("\n"); 
		query.append("         (SELECT A.BKG_NO, B.FRT_TERM_CD, B.RT_SEQ, B.N3PTY_RCV_OFC_CD, B.N3PTY_CUST_CNT_CD, " ).append("\n"); 
		query.append("                 B.N3PTY_CUST_SEQ, B.CHG_CD, B.CURR_CD, B.RAT_UT_CD, B.RAT_AS_QTY, B.CHG_UT_AMT, B.CHG_AMT, B.CRE_DT," ).append("\n"); 
		query.append("                 SUM(B.CHG_AMT) OVER (PARTITION BY B.BKG_NO, B.FRT_TERM_CD, B.CURR_CD) CHG_SUM1," ).append("\n"); 
		query.append("                 SUM(B.CHG_AMT) OVER (PARTITION BY B.BKG_NO, B.FRT_TERM_CD, B.CURR_CD, B.CHG_CD) CHG_SUM2," ).append("\n"); 
		query.append("                 DECODE(C.DP_SEQ, 1, B.CHG_AMT, 0) CHG001_S," ).append("\n"); 
		query.append("                 DECODE(C.DP_SEQ, 2, B.CHG_AMT, 0) CHG002_S," ).append("\n"); 
		query.append("                 DECODE(C.DP_SEQ, 3, B.CHG_AMT, 0) CHG003_S," ).append("\n"); 
		query.append("                 DECODE(C.DP_SEQ, 4, B.CHG_AMT, 0) CHG004_S," ).append("\n"); 
		query.append("                 DECODE(C.DP_SEQ, 5, B.CHG_AMT, 0) CHG005_S" ).append("\n"); 
		query.append("          FROM BKG_BOOKING A," ).append("\n"); 
		query.append("               BKG_CHG_RT B," ).append("\n"); 
		query.append("               INV_CPRT_TMPLT_CHG C," ).append("\n"); 
		query.append("               MDM_CHARGE D" ).append("\n"); 
		query.append("		       #if (${cust_cd} != '' && ${cust_gb} != 'P')" ).append("\n"); 
		query.append("                   ,BKG_CUSTOMER E" ).append("\n"); 
		query.append("                   ,MDM_CUSTOMER H" ).append("\n"); 
		query.append("               #end" ).append("\n"); 
		query.append("               ,BKG_BL_DOC F" ).append("\n"); 
		query.append("               ,BKG_VVD G" ).append("\n"); 
		query.append("			   #if (${from_date} != '' && ${to_date} != '')" ).append("\n"); 
		query.append("               		#if (${date_gb} == '1STVVD' || ${date_gb} == 'ETA' || ${date_gb} == 'ETD')" ).append("\n"); 
		query.append("                   		,BKG_VVD I" ).append("\n"); 
		query.append("                   		,VSK_VSL_PORT_SKD J" ).append("\n"); 
		query.append("  	           		#end" ).append("\n"); 
		query.append("			   #end" ).append("\n"); 
		query.append("          WHERE A.BKG_NO = B.BKG_NO(+)" ).append("\n"); 
		query.append("          AND A.BKG_NO = F.BKG_NO(+)" ).append("\n"); 
		query.append("          AND A.BKG_NO = G.BKG_NO(+)" ).append("\n"); 
		query.append("          AND B.FRT_INCL_XCLD_DIV_CD(+) ='N'" ).append("\n"); 
		query.append("          AND G.VSL_PRE_PST_CD(+) = 'T'" ).append("\n"); 
		query.append("          AND C.AR_OFC_CD(+) = @[ar_ofc_cd]" ).append("\n"); 
		query.append("          AND C.RPT_TMPLT_NM(+) = @[rpt_tmplt_nm]          " ).append("\n"); 
		query.append("          #if (${sc_no} != '')" ).append("\n"); 
		query.append("              AND C.CPRT_TP_CTNT(+) = 'S'" ).append("\n"); 
		query.append("              AND C.CPRT_VAL_CTNT(+) = @[sc_no]" ).append("\n"); 
		query.append("          #elseif (${rfa_no} != '')" ).append("\n"); 
		query.append("              AND C.CPRT_TP_CTNT(+) = 'R'" ).append("\n"); 
		query.append("              AND C.CPRT_VAL_CTNT(+) = @[rfa_no]" ).append("\n"); 
		query.append("          #else" ).append("\n"); 
		query.append("              AND C.CPRT_TP_CTNT(+) = 'X'" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("          AND C.CHG_CD(+) = DECODE(C.CPRT_CHG_GRP_FLG(+), 'N', D.CHG_CD, D.REP_CHG_CD)" ).append("\n"); 
		query.append("          AND B.CHG_CD = D.CHG_CD(+)       " ).append("\n"); 
		query.append("          #if (${bl_nos} != '')" ).append("\n"); 
		query.append("              AND A.BL_NO in (${bl_nos})" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${frt_term_cd} != 'A')" ).append("\n"); 
		query.append("              AND B.FRT_TERM_CD = @[frt_term_cd]" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${sc_no} != '')" ).append("\n"); 
		query.append("              AND A.SC_NO = @[sc_no]" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${rfa_no} != '')" ).append("\n"); 
		query.append("              AND A.RFA_NO = @[rfa_no]" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${bkg_ofc_cd} != '')" ).append("\n"); 
		query.append("              AND A.BKG_OFC_CD = @[bkg_ofc_cd]" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${ob_sls_ofc_cd} != '')" ).append("\n"); 
		query.append("              AND A.OB_SLS_OFC_CD = @[ob_sls_ofc_cd]" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${cust_cd} != '' && ${cust_gb} != 'P')" ).append("\n"); 
		query.append("              AND A.BKG_NO = E.BKG_NO" ).append("\n"); 
		query.append("              AND E.CUST_CNT_CD = H.CUST_CNT_CD " ).append("\n"); 
		query.append("              AND E.CUST_SEQ = H.CUST_SEQ     " ).append("\n"); 
		query.append("              #if (${cust_gb} == 'S' || ${cust_gb} == 'C' || ${cust_gb} == 'N' || ${cust_gb} == 'F')" ).append("\n"); 
		query.append("                  AND E.BKG_CUST_TP_CD = @[cust_gb]" ).append("\n"); 
		query.append("                  AND E.CUST_CNT_CD||E.CUST_SEQ IN (@[cust_cd])" ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("              #if (${cust_gb} == 'GS')" ).append("\n"); 
		query.append("                  AND E.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("                  AND SUBSTR(H.CUST_GRP_ID, 3) IN (@[cust_cd])" ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("              #if (${cust_gb} == 'GC')" ).append("\n"); 
		query.append("                  AND E.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("                  AND SUBSTR(H.CUST_GRP_ID, 3) IN (@[cust_cd])" ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${from_date} != '' && ${to_date} != '')" ).append("\n"); 
		query.append("              #if (${date_gb} == 'OBD')" ).append("\n"); 
		query.append("                  AND F.BL_OBRD_DT between to_date(REPLACE(@[from_date],'-',''),'YYYYMMDD') and to_date(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999             " ).append("\n"); 
		query.append("              #end " ).append("\n"); 
		query.append("              #if (${date_gb} == 'PCD')              " ).append("\n"); 
		query.append("                  AND A.PORT_CLZ_DT  between to_date(REPLACE(@[from_date],'-',''),'YYYYMMDD') and to_date(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999              " ).append("\n"); 
		query.append("              #end " ).append("\n"); 
		query.append("              #if (${date_gb} == 'BDR')             " ).append("\n"); 
		query.append("                  AND F.BDR_DT  between to_date(REPLACE(@[from_date],'-',''),'YYYYMMDD') and to_date(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999             " ).append("\n"); 
		query.append("              #end " ).append("\n"); 
		query.append("              #if (${date_gb} == '1STVVD')" ).append("\n"); 
		query.append("                  AND I.BKG_NO(+) = A.BKG_NO" ).append("\n"); 
		query.append("                  AND I.VSL_CD = J.VSL_CD" ).append("\n"); 
		query.append("                  AND I.SKD_VOY_NO = J.SKD_VOY_NO" ).append("\n"); 
		query.append("                  AND I.SKD_DIR_CD = J.SKD_DIR_CD" ).append("\n"); 
		query.append("                  AND I.POL_CD = J.VPS_PORT_CD" ).append("\n"); 
		query.append("                  AND I.POL_YD_CD = J.YD_CD" ).append("\n"); 
		query.append("                  AND I.POL_CLPT_IND_SEQ = J.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                  AND I.ROWID = (SELECT SUBSTR(MIN(S.VSL_PRE_PST_CD||LTRIM(TO_CHAR(S.VSL_SEQ, '000'))||ROWID), 5) -- 1st VVD" ).append("\n"); 
		query.append("                                 FROM BKG_VVD S" ).append("\n"); 
		query.append("                                 WHERE S.BKG_NO = I.BKG_NO)" ).append("\n"); 
		query.append("                  AND J.VPS_ETD_DT BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999" ).append("\n"); 
		query.append("                  AND NVL(J.SKD_CNG_STS_CD, ' ') <> 'S'" ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("              #if (${date_gb} == 'ETD')                    " ).append("\n"); 
		query.append("                  AND I.BKG_NO(+) = A.BKG_NO" ).append("\n"); 
		query.append("                  AND I.VSL_CD = J.VSL_CD" ).append("\n"); 
		query.append("                  AND I.SKD_VOY_NO = J.SKD_VOY_NO" ).append("\n"); 
		query.append("                  AND I.SKD_DIR_CD = J.SKD_DIR_CD" ).append("\n"); 
		query.append("                  AND I.POL_CD = J.VPS_PORT_CD" ).append("\n"); 
		query.append("                  AND I.POL_YD_CD = J.YD_CD" ).append("\n"); 
		query.append("                  AND I.POL_CLPT_IND_SEQ = J.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                  AND I.VSL_PRE_PST_CD = 'T'" ).append("\n"); 
		query.append("                  AND J.VPS_ETD_DT BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999" ).append("\n"); 
		query.append("                  AND NVL(J.SKD_CNG_STS_CD, ' ') <> 'S'                    " ).append("\n"); 
		query.append("              #end " ).append("\n"); 
		query.append("              #if (${date_gb} == 'ETA')                   " ).append("\n"); 
		query.append("                  AND I.BKG_NO(+) = A.BKG_NO" ).append("\n"); 
		query.append("                  AND I.VSL_CD = J.VSL_CD" ).append("\n"); 
		query.append("                  AND I.SKD_VOY_NO = J.SKD_VOY_NO" ).append("\n"); 
		query.append("                  AND I.SKD_DIR_CD = J.SKD_DIR_CD" ).append("\n"); 
		query.append("                  AND I.POD_CD = J.VPS_PORT_CD" ).append("\n"); 
		query.append("                  AND I.POD_YD_CD = J.YD_CD" ).append("\n"); 
		query.append("                  AND I.POD_CLPT_IND_SEQ = J.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                  AND I.VSL_PRE_PST_CD = 'T'" ).append("\n"); 
		query.append("                  AND J.VPS_ETA_DT BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999" ).append("\n"); 
		query.append("                  AND NVL(J.SKD_CNG_STS_CD, ' ') <> 'S'                   " ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${del_cd} != '')" ).append("\n"); 
		query.append("              AND A.DEL_CD like @[del_cd]||'%'" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${por_cd} != '')" ).append("\n"); 
		query.append("              AND A.POR_CD like @[por_cd]||'%'" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${pol_cd} != '')" ).append("\n"); 
		query.append("              AND A.POL_CD like @[pol_cd]||'%'" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${pod_cd} != '')" ).append("\n"); 
		query.append("              AND A.POD_CD like @[pod_cd]||'%'" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${vvd} != '')         " ).append("\n"); 
		query.append("              AND G.VSL_CD||G.SKD_VOY_NO||G.SKD_DIR_CD = @[vvd]" ).append("\n"); 
		query.append("          #end       " ).append("\n"); 
		query.append("		  #if ((${from_date} != '' && ${to_date} != '' && (${date_gb} == 'IVD' || ${date_gb} == 'IFD')) ||" ).append("\n"); 
		query.append("               (${cust_cd} != '' && ${cust_gb} == 'P'))" ).append("\n"); 
		query.append("              AND EXISTS (SELECT 'X'" ).append("\n"); 
		query.append("                          FROM INV_AR_MN" ).append("\n"); 
		query.append("                          WHERE BKG_NO = A.BKG_NO" ).append("\n"); 
		query.append("                          AND IO_BND_CD = DECODE(B.FRT_TERM_CD, 'P', 'O', 'I')" ).append("\n"); 
		query.append("                          AND REV_TP_CD <> 'M'" ).append("\n"); 
		query.append("                          AND INV_DELT_DIV_CD <> 'Y'" ).append("\n"); 
		query.append("                          #if (${from_date} != '' && ${to_date} != '')	" ).append("\n"); 
		query.append("                              #if (${date_gb} == 'IVD')" ).append("\n"); 
		query.append("                                  AND TO_DATE(ISS_DT,'YYYYMMDD') BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999             " ).append("\n"); 
		query.append("                              #end " ).append("\n"); 
		query.append("                              #if (${date_gb} == 'IFD')              " ).append("\n"); 
		query.append("                                  AND TO_DATE(BL_INV_IF_DT,'YYYYMMDD') BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999              " ).append("\n"); 
		query.append("                              #end " ).append("\n"); 
		query.append("                          #end  " ).append("\n"); 
		query.append("                          #if (${cust_cd} != '') " ).append("\n"); 
		query.append("                              #if (${cust_gb} == 'P')" ).append("\n"); 
		query.append("                                  AND ACT_CUST_CNT_CD||ACT_CUST_SEQ IN (@[cust_cd])" ).append("\n"); 
		query.append("                              #end " ).append("\n"); 
		query.append("                          #end       " ).append("\n"); 
		query.append("                          )     " ).append("\n"); 
		query.append("          #end   " ).append("\n"); 
		query.append("         ) U," ).append("\n"); 
		query.append("         (SELECT A.BKG_NO, C.FRT_TERM_CD, B.CNTR_NO, B.CNMV_CYC_NO, B.CNMV_YR, B.CGO_RCV_DT, B.CNTR_TPSZ_CD, B.MEAS_QTY, " ).append("\n"); 
		query.append("                 B.MEAS_UT_CD, B.CNTR_PRT_FLG, B.CNTR_VOL_QTY, B.PCK_QTY, B.PCK_TP_CD, B.CNTR_WGT, B.WGT_UT_CD, B.DCGO_FLG, " ).append("\n"); 
		query.append("                 B.RC_FLG, B.BB_CGO_FLG, B.AWK_CGO_FLG, B.DIFF_RMK, C.CHG_CD, C.CURR_CD, C.RAT_UT_CD, C.RAT_AS_QTY, C.CHG_UT_AMT, C.CHG_AMT," ).append("\n"); 
		query.append("                 SUM(C.CHG_AMT) OVER (PARTITION BY C.BKG_NO, C.FRT_TERM_CD, C.CNTR_NO, C.CURR_CD) CNTR_SUM1," ).append("\n"); 
		query.append("                 SUM(C.CHG_AMT) OVER (PARTITION BY C.BKG_NO, C.FRT_TERM_CD, C.CNTR_NO, C.CURR_CD, C.CHG_CD) CNTR_SUM2," ).append("\n"); 
		query.append("                 DECODE(D.DP_SEQ, 1, C.CHG_AMT, 0) CHG001," ).append("\n"); 
		query.append("                 DECODE(D.DP_SEQ, 2, C.CHG_AMT, 0) CHG002," ).append("\n"); 
		query.append("                 DECODE(D.DP_SEQ, 3, C.CHG_AMT, 0) CHG003," ).append("\n"); 
		query.append("                 DECODE(D.DP_SEQ, 4, C.CHG_AMT, 0) CHG004," ).append("\n"); 
		query.append("                 DECODE(D.DP_SEQ, 5, C.CHG_AMT, 0) CHG005" ).append("\n"); 
		query.append("          FROM BKG_BOOKING A," ).append("\n"); 
		query.append("               BKG_CONTAINER B," ).append("\n"); 
		query.append("               BKG_CNTR_RT C," ).append("\n"); 
		query.append("               INV_CPRT_TMPLT_CHG D," ).append("\n"); 
		query.append("               MDM_CHARGE K" ).append("\n"); 
		query.append("               #if (${cust_cd} != '' && ${cust_gb} != 'P') " ).append("\n"); 
		query.append("                   ,BKG_CUSTOMER E" ).append("\n"); 
		query.append("                   ,MDM_CUSTOMER H" ).append("\n"); 
		query.append("               #end" ).append("\n"); 
		query.append("               ,BKG_BL_DOC F" ).append("\n"); 
		query.append("               ,BKG_VVD G" ).append("\n"); 
		query.append("			   #if (${from_date} != '' && ${to_date} != '')" ).append("\n"); 
		query.append("               		#if (${date_gb} == '1STVVD' || ${date_gb} == 'ETA' || ${date_gb} == 'ETD')" ).append("\n"); 
		query.append("                   		,BKG_VVD I" ).append("\n"); 
		query.append("                   		,VSK_VSL_PORT_SKD J" ).append("\n"); 
		query.append("  	           		#end" ).append("\n"); 
		query.append("			   #end" ).append("\n"); 
		query.append("          WHERE A.BKG_NO = B.BKG_NO(+)" ).append("\n"); 
		query.append("          AND A.BKG_NO = C.BKG_NO(+)" ).append("\n"); 
		query.append("          AND A.BKG_NO = F.BKG_NO(+)" ).append("\n"); 
		query.append("          AND A.BKG_NO = G.BKG_NO(+)" ).append("\n"); 
		query.append("          AND B.CNTR_NO = NVL(C.CNTR_NO, B.CNTR_NO)" ).append("\n"); 
		query.append("          AND C.FRT_INCL_XCLD_DIV_CD(+) ='N' " ).append("\n"); 
		query.append("          AND G.VSL_PRE_PST_CD(+) = 'T'" ).append("\n"); 
		query.append("          AND D.AR_OFC_CD(+) = @[ar_ofc_cd]" ).append("\n"); 
		query.append("          AND D.RPT_TMPLT_NM(+) = @[rpt_tmplt_nm]" ).append("\n"); 
		query.append("          #if (${sc_no} != '')" ).append("\n"); 
		query.append("              AND D.CPRT_TP_CTNT(+) = 'S'" ).append("\n"); 
		query.append("              AND D.CPRT_VAL_CTNT(+) = @[sc_no]" ).append("\n"); 
		query.append("          #elseif (${rfa_no} != '')" ).append("\n"); 
		query.append("              AND D.CPRT_TP_CTNT(+) = 'R'" ).append("\n"); 
		query.append("              AND D.CPRT_VAL_CTNT(+) = @[rfa_no]" ).append("\n"); 
		query.append("          #else" ).append("\n"); 
		query.append("              AND D.CPRT_TP_CTNT(+) = 'X'" ).append("\n"); 
		query.append("          #end " ).append("\n"); 
		query.append("          AND D.CHG_CD(+) = DECODE(D.CPRT_CHG_GRP_FLG(+), 'N', K.CHG_CD, K.REP_CHG_CD)" ).append("\n"); 
		query.append("          AND C.CHG_CD = K.CHG_CD(+)" ).append("\n"); 
		query.append("          #if (${bl_nos} != '')" ).append("\n"); 
		query.append("              AND A.BL_NO in (${bl_nos})" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${frt_term_cd} != 'A')" ).append("\n"); 
		query.append("              AND C.FRT_TERM_CD = @[frt_term_cd]" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${sc_no} != '')" ).append("\n"); 
		query.append("              AND A.SC_NO = @[sc_no]" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${rfa_no} != '')" ).append("\n"); 
		query.append("              AND A.RFA_NO = @[rfa_no]" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${bkg_ofc_cd} != '')" ).append("\n"); 
		query.append("              AND A.BKG_OFC_CD = @[bkg_ofc_cd]" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${ob_sls_ofc_cd} != '')" ).append("\n"); 
		query.append("              AND A.OB_SLS_OFC_CD = @[ob_sls_ofc_cd]" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${cust_cd} != '' && ${cust_gb} != 'P')" ).append("\n"); 
		query.append("              AND A.BKG_NO = E.BKG_NO" ).append("\n"); 
		query.append("              AND E.CUST_CNT_CD = H.CUST_CNT_CD " ).append("\n"); 
		query.append("              AND E.CUST_SEQ = H.CUST_SEQ     " ).append("\n"); 
		query.append("              #if (${cust_gb} == 'S' || ${cust_gb} == 'C' || ${cust_gb} == 'N' || ${cust_gb} == 'F')" ).append("\n"); 
		query.append("                  AND E.BKG_CUST_TP_CD = @[cust_gb]" ).append("\n"); 
		query.append("                  AND E.CUST_CNT_CD||E.CUST_SEQ IN (@[cust_cd])" ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("              #if (${cust_gb} == 'GS')" ).append("\n"); 
		query.append("                  AND E.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("                  AND SUBSTR(H.CUST_GRP_ID, 3) IN (@[cust_cd])" ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("              #if (${cust_gb} == 'GC')" ).append("\n"); 
		query.append("                  AND E.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("                  AND SUBSTR(H.CUST_GRP_ID, 3) IN (@[cust_cd])" ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${from_date} != '' && ${to_date} != '')" ).append("\n"); 
		query.append("              #if (${date_gb} == 'OBD')" ).append("\n"); 
		query.append("                  AND F.BL_OBRD_DT BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999             " ).append("\n"); 
		query.append("              #end " ).append("\n"); 
		query.append("              #if (${date_gb} == 'PCD')              " ).append("\n"); 
		query.append("                  AND A.PORT_CLZ_DT BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999              " ).append("\n"); 
		query.append("              #end " ).append("\n"); 
		query.append("              #if (${date_gb} == 'BDR')             " ).append("\n"); 
		query.append("                  AND F.BDR_DT BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999             " ).append("\n"); 
		query.append("              #end " ).append("\n"); 
		query.append("              #if (${date_gb} == '1STVVD')" ).append("\n"); 
		query.append("                  AND I.BKG_NO(+) = A.BKG_NO" ).append("\n"); 
		query.append("                  AND I.VSL_CD = J.VSL_CD" ).append("\n"); 
		query.append("                  AND I.SKD_VOY_NO = J.SKD_VOY_NO" ).append("\n"); 
		query.append("                  AND I.SKD_DIR_CD = J.SKD_DIR_CD" ).append("\n"); 
		query.append("                  AND I.POL_CD = J.VPS_PORT_CD" ).append("\n"); 
		query.append("                  AND I.POL_YD_CD = J.YD_CD" ).append("\n"); 
		query.append("                  AND I.POL_CLPT_IND_SEQ = J.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                  AND I.ROWID = (SELECT SUBSTR(MIN(S.VSL_PRE_PST_CD||LTRIM(TO_CHAR(S.VSL_SEQ, '000'))||ROWID), 5) -- 1st VVD" ).append("\n"); 
		query.append("                                 FROM BKG_VVD S" ).append("\n"); 
		query.append("                                 WHERE S.BKG_NO = I.BKG_NO)" ).append("\n"); 
		query.append("                  AND J.VPS_ETD_DT BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999" ).append("\n"); 
		query.append("                  AND NVL(J.SKD_CNG_STS_CD, ' ') <> 'S'" ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("              #if (${date_gb} == 'ETD')                    " ).append("\n"); 
		query.append("                  AND I.BKG_NO(+) = A.BKG_NO" ).append("\n"); 
		query.append("                  AND I.VSL_CD = J.VSL_CD" ).append("\n"); 
		query.append("                  AND I.SKD_VOY_NO = J.SKD_VOY_NO" ).append("\n"); 
		query.append("                  AND I.SKD_DIR_CD = J.SKD_DIR_CD" ).append("\n"); 
		query.append("                  AND I.POL_CD = J.VPS_PORT_CD" ).append("\n"); 
		query.append("                  AND I.POL_YD_CD = J.YD_CD" ).append("\n"); 
		query.append("                  AND I.POL_CLPT_IND_SEQ = J.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                  AND I.VSL_PRE_PST_CD = 'T'" ).append("\n"); 
		query.append("                  AND J.VPS_ETD_DT BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999" ).append("\n"); 
		query.append("                  AND NVL(J.SKD_CNG_STS_CD, ' ') <> 'S'                    " ).append("\n"); 
		query.append("              #end " ).append("\n"); 
		query.append("              #if (${date_gb} == 'ETA')                   " ).append("\n"); 
		query.append("                  AND I.BKG_NO(+) = A.BKG_NO" ).append("\n"); 
		query.append("                  AND I.VSL_CD = J.VSL_CD" ).append("\n"); 
		query.append("                  AND I.SKD_VOY_NO = J.SKD_VOY_NO" ).append("\n"); 
		query.append("                  AND I.SKD_DIR_CD = J.SKD_DIR_CD" ).append("\n"); 
		query.append("                  AND I.POD_CD = J.VPS_PORT_CD" ).append("\n"); 
		query.append("                  AND I.POD_YD_CD = J.YD_CD" ).append("\n"); 
		query.append("                  AND I.POD_CLPT_IND_SEQ = J.CLPT_IND_SEQ" ).append("\n"); 
		query.append("                  AND I.VSL_PRE_PST_CD = 'T'" ).append("\n"); 
		query.append("                  AND J.VPS_ETA_DT BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999" ).append("\n"); 
		query.append("                  AND NVL(J.SKD_CNG_STS_CD, ' ') <> 'S'                   " ).append("\n"); 
		query.append("              #end" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${del_cd} != '')" ).append("\n"); 
		query.append("              AND A.DEL_CD like @[del_cd]||'%'" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${por_cd} != '')" ).append("\n"); 
		query.append("              AND A.POR_CD like @[por_cd]||'%'" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${pol_cd} != '')" ).append("\n"); 
		query.append("              AND A.POL_CD like @[pol_cd]||'%'" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${pod_cd} != '')" ).append("\n"); 
		query.append("              AND A.POD_CD like @[pod_cd]||'%'" ).append("\n"); 
		query.append("          #end" ).append("\n"); 
		query.append("          #if (${vvd} != '')         " ).append("\n"); 
		query.append("              AND G.VSL_CD||G.SKD_VOY_NO||G.SKD_DIR_CD = @[vvd]" ).append("\n"); 
		query.append("          #end    " ).append("\n"); 
		query.append("		  #if ((${from_date} != '' && ${to_date} != '' && (${date_gb} == 'IVD' || ${date_gb} == 'IFD')) ||" ).append("\n"); 
		query.append("               (${cust_cd} != '' && ${cust_gb} == 'P'))" ).append("\n"); 
		query.append("              AND EXISTS (SELECT 'X'" ).append("\n"); 
		query.append("                          FROM INV_AR_MN" ).append("\n"); 
		query.append("                          WHERE BKG_NO = A.BKG_NO" ).append("\n"); 
		query.append("                          AND IO_BND_CD = DECODE(C.FRT_TERM_CD, 'P', 'O', 'I')" ).append("\n"); 
		query.append("                          AND REV_TP_CD <> 'M'" ).append("\n"); 
		query.append("                          AND INV_DELT_DIV_CD <> 'Y'" ).append("\n"); 
		query.append("                          #if (${from_date} != '' && ${to_date} != '')	" ).append("\n"); 
		query.append("                              #if (${date_gb} == 'IVD')" ).append("\n"); 
		query.append("                                  AND TO_DATE(ISS_DT,'YYYYMMDD') BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999             " ).append("\n"); 
		query.append("                              #end " ).append("\n"); 
		query.append("                              #if (${date_gb} == 'IFD')              " ).append("\n"); 
		query.append("                                  AND TO_DATE(BL_INV_IF_DT,'YYYYMMDD') BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999              " ).append("\n"); 
		query.append("                              #end " ).append("\n"); 
		query.append("                          #end  " ).append("\n"); 
		query.append("                          #if (${cust_cd} != '') " ).append("\n"); 
		query.append("                              #if (${cust_gb} == 'P')" ).append("\n"); 
		query.append("                                  AND ACT_CUST_CNT_CD||ACT_CUST_SEQ IN (@[cust_cd])" ).append("\n"); 
		query.append("                              #end " ).append("\n"); 
		query.append("                          #end       " ).append("\n"); 
		query.append("                          )     " ).append("\n"); 
		query.append("          #end      " ).append("\n"); 
		query.append("         ) V" ).append("\n"); 
		query.append("    WHERE O.BKG_NO = P.BKG_NO(+)" ).append("\n"); 
		query.append("    AND O.BKG_NO = Q.BKG_NO(+)" ).append("\n"); 
		query.append("    AND O.BKG_STS_CD IN ('F','S')" ).append("\n"); 
		query.append("    AND O.BKG_CGO_TP_CD <> 'P'" ).append("\n"); 
		query.append("    AND O.BKG_NO = R.BKG_NO(+)" ).append("\n"); 
		query.append("    AND O.BKG_NO = S.BKG_NO(+)" ).append("\n"); 
		query.append("    AND O.BL_NO = T.BL_NO(+)" ).append("\n"); 
		query.append("    AND O.BKG_NO = U.BKG_NO" ).append("\n"); 
		query.append("    AND U.BKG_NO = V.BKG_NO(+)" ).append("\n"); 
		query.append("    AND U.FRT_TERM_CD = V.FRT_TERM_CD(+)" ).append("\n"); 
		query.append("    AND U.CURR_CD = V.CURR_CD(+)" ).append("\n"); 
		query.append("    AND U.CHG_CD = V.CHG_CD(+)" ).append("\n"); 
		query.append("    AND U.RAT_UT_CD = V.RAT_UT_CD(+)) MN,    " ).append("\n"); 
		query.append("    INV_AR_MN IAM," ).append("\n"); 
		query.append("    SAR_OTS_HIS SHS," ).append("\n"); 
		query.append("    SAR_OTS_HDR SHR" ).append("\n"); 
		query.append("WHERE MN.AR_IF_NO = IAM.AR_IF_NO(+)" ).append("\n"); 
		query.append("AND MN.OTS_HIS_SEQ = SHS.OTS_HIS_SEQ(+)" ).append("\n"); 
		query.append("AND SHS.RHQ_CD = SHR.RHQ_CD" ).append("\n"); 
		query.append("AND SHS.OTS_OFC_CD = SHR.OTS_OFC_CD" ).append("\n"); 
		query.append("AND SHS.BL_NO = SHR.BL_NO" ).append("\n"); 
		query.append("AND SHS.INV_NO = SHR.INV_NO" ).append("\n"); 
		query.append("#if (${from_date} != '' && ${to_date} != '')	" ).append("\n"); 
		query.append("	#if (${date_gb} == 'IVD')" ).append("\n"); 
		query.append("    	AND TO_DATE(IAM.ISS_DT,'YYYYMMDD') BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999             " ).append("\n"); 
		query.append("    #end " ).append("\n"); 
		query.append("    #if (${date_gb} == 'IFD')              " ).append("\n"); 
		query.append("    	AND TO_DATE(IAM.BL_INV_IF_DT,'YYYYMMDD') BETWEEN TO_DATE(REPLACE(@[from_date],'-',''),'YYYYMMDD') AND TO_DATE(REPLACE(@[to_date],'-',''),'YYYYMMDD')+0.99999              " ).append("\n"); 
		query.append("    #end " ).append("\n"); 
		query.append("#end  " ).append("\n"); 
		query.append("#if (${cust_cd} != '') " ).append("\n"); 
		query.append("	#if (${cust_gb} == 'P')" ).append("\n"); 
		query.append("        AND IAM.ACT_CUST_CNT_CD||IAM.ACT_CUST_SEQ IN (@[cust_cd])" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("#end " ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY RPT_TMPLT_NM" ).append("\n"); 
		query.append("#foreach( ${key} in ${allcols}) " ).append("\n"); 
		query.append("	#if($key != 'CHG001' && $key != 'CHG002' && $key != 'CHG003' && $key != 'CHG004' && $key != 'CHG005' && $key != 'CHG999')" ).append("\n"); 
		query.append("		,$key" ).append("\n"); 
		query.append("	#end	" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("ORDER BY RPT_TMPLT_NM" ).append("\n"); 
		query.append("#foreach( ${key} in ${allcols}) " ).append("\n"); 
		query.append("    ,$key" ).append("\n"); 
		query.append("#end" ).append("\n"); 

	}
}