<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableEDISendDBDAOSearchInvoiceBlMainRSQL">
			<desc><![CDATA[SearchInvoiceBlMain]]></desc>
			<sql><![CDATA[
SELECT  DISTINCT  
       'INV_TP:'|| DECODE(INV.REV_TP_CD, 'M', '02', DECODE(INV.INV_DELT_DIV_CD, 'N', '01', '03')) || CHR(10) || 
       'INV_STATUS:'|| DECODE(INV.INV_DELT_DIV_CD,'X','Cancelled','Confirmed') || CHR(10) || 
       'BL_NO:' || INV.BL_SRC_NO ||CHR(10) || 
       'POR_TRAFFIC_MD:' || DECODE(BK.RCV_TERM_CD,'S','LCL','FCL') ||CHR(10) || 
       'POD_TRAFFIC_MD:' || DECODE(BK.DE_TERM_CD,'S','LCL','FCL')  ||CHR(10) || 
       'PAY_DUE_DT:' || INV.DUE_DT || CHR(10) || 
       'SAILING_ARR_DT:' || INV.SAIL_ARR_DT||CHR(10) ||
       'INV_CURR:' || NVL(INV.INV_CURR_CD, INV.LOCL_CURR_CD) ||CHR(10) || 
       'INV_CURR_TTL:' || (SELECT SUM(ROUND(CHG_AMT * NVL(ISS_XCH_RT, INV_XCH_RT), (SELECT DP_PRCS_KNT FROM MDM_CURRENCY WHERE CURR_CD = NVL(INV.INV_CURR_CD, INV.LOCL_CURR_CD))))
                           FROM INV_AR_CHG
                           WHERE AR_IF_NO = INV.AR_IF_NO) ||CHR(10) || 
       'LOCAL_CURR:'  || INV.LOCL_CURR_CD ||CHR(10) || 
       'LOCAL_CURR_TTL:' || INV.INV_TTL_LOCL_AMT ||CHR(10) || 
       'INV_EX_RATE:' || INV.USD_XCH_RT || CHR(10) || 
       'INV_PAYTERM_CLUS:' || INV.CR_TERM_DYS ||CHR(10) || 
       'REMARK:' || INV.INV_RMK ||CHR(10) || 
       'APP_DT:' || (SELECT TO_CHAR(RT_APLY_DT ,'RRRRMMDDHH24MI', 'NLS_DATE_LANGUAGE=ENGLISH') 
				    FROM BKG_RATE
					WHERE BKG_NO = BK.BKG_NO ) ||CHR(10)
FROM BKG_BOOKING BK, INV_AR_MN INV
WHERE BK.BKG_NO(+) = INV.BKG_NO
AND INV.AR_IF_NO = @[ar_if_no]			]]></sql>
			<params>
				<param name="ar_if_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
