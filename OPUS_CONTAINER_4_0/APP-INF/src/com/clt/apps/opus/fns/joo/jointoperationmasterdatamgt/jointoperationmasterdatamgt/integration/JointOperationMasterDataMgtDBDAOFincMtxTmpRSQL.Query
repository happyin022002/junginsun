<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JointOperationMasterDataMgtDBDAOFincMtxTmpRSQL">
			<desc><![CDATA[matrix를 생성하기위한 query]]></desc>
			<sql><![CDATA[
SELECT
       'R' AS IBFLAG,
       B.JO_CRR_CD,
       B.RLANE_CD,
       B.RE_DIVR_CD,      
       B.JO_STL_ITM_CD,
#if (${re_divr_cd} == 'R') 
       A.CUST_CNT_CD||LPAD(A.CUST_SEQ,6,'0') AS CUST_SEQ,
#elseif (${re_divr_cd} == 'E') 
       ''||A.VNDR_SEQ AS CUST_SEQ,
#end
       C.DR_ACCT_CD,
       B.DR_CTR_CD,
       B.DR_LOC_CD,
       C.CR_ACCT_CD,
       B.CR_CTR_CD,
       B.CR_LOC_CD,
       B.LOCL_CURR_CD,
       D.JO_STL_ITM_NM,
       D.ORD_SEQ
FROM   JOO_CARRIER      A,
       JOO_FINC_MTX     B,
       JOO_STL_ITM_ACCT C,
       JOO_STL_ITM      D
WHERE  A.JO_CRR_CD     = B.JO_CRR_CD
AND    A.RLANE_CD      = B.RLANE_CD
AND    B.RE_DIVR_CD    = C.RE_DIVR_CD
AND    B.JO_STL_ITM_CD = C.JO_STL_ITM_CD
AND    C.JO_STL_ITM_CD = D.JO_STL_ITM_CD
AND    B.RE_DIVR_CD    = @[re_divr_cd]
AND    B.JO_CRR_CD     = @[jo_crr_cd]
AND    B.RLANE_CD      = @[rlane_cd]
UNION ALL 
SELECT
       'I' AS IBFLAG,
       @[jo_crr_cd]  AS JO_CRR_CD,
       @[rlane_cd]   AS RLANE_CD,
       @[re_divr_cd] AS RE_DIVR_CD,
       A.JO_STL_ITM_CD,
#if (${re_divr_cd} == 'R') 
       @[cust_cnt_cd]||LPAD(@[cust_seq],6,'0') AS CUST_SEQ,
#elseif (${re_divr_cd} == 'E') 
       @[vndr_seq] AS CUST_SEQ,
#end
       B.DR_ACCT_CD,
       C.AP_CTR_CD AS DR_CTR_CD,
       C.LOC_CD    AS DR_LOC_CD,
       B.CR_ACCT_CD,
       C.AP_CTR_CD AS CR_CTR_CD,
       C.LOC_CD    AS CR_LOC_CD,
       '' AS LOCL_CURR_CD,
       A.JO_STL_ITM_NM,
       A.ORD_SEQ
FROM   JOO_STL_ITM      A,
       JOO_STL_ITM_ACCT B,
       MDM_ORGANIZATION C,
       MDM_ORGANIZATION D
WHERE  A.JO_STL_ITM_CD = B.JO_STL_ITM_CD
AND    C.OFC_CD        = D.AP_OFC_CD
AND    D.OFC_CD     = @[ofc_cd]
AND    B.RE_DIVR_CD = @[re_divr_cd]
AND    A.JO_STL_ITM_CD NOT IN (
          SELECT JO_STL_ITM_CD
          FROM   JOO_FINC_MTX X
          WHERE  X.JO_CRR_CD = @[jo_crr_cd]
          AND    X.RLANE_CD  = @[rlane_cd]
          AND    X.RE_DIVR_CD = B.RE_DIVR_CD
       )
ORDER  BY IBFLAG DESC, ORD_SEQ			]]></sql>
			<params>
				<param name="re_divr_cd" type="12" value="R" out="N"/>
				<param name="jo_crr_cd" type="12" value="COS" out="N"/>
				<param name="rlane_cd" type="12" value="AEXAE" out="N"/>
				<param name="cust_cnt_cd" type="12" value="CN" out="N"/>
				<param name="cust_seq" type="2" value="69541" out="N"/>
				<param name="vndr_seq" type="12" value="151122" out="N"/>
				<param name="ofc_cd" type="12" value="HQFAR" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
