<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableInvoiceMigrationDBDAOAddDailyUSDExchangeRateCSQL">
			<desc><![CDATA[Add Daily USD Exchange Rate]]></desc>
			<sql><![CDATA[
INSERT INTO OPUSADM_TMP.INV_CUST_AND_DLY_XCH_RT
(
   CUST_CNT_CD
   , CUST_SEQ
   , IO_BND_CD
   , FM_DT
   , TO_DT
   , CHG_CURR_CD
   , LOCL_CURR_CD
   , XCH_RT_TP_CD
   , AR_OFC_CD
   , INV_XCH_RT
   , IVS_XCH_RT
   , CRE_USR_ID
   , CRE_DT
   , UPD_USR_ID
   , UPD_DT
)
(
SELECT A.CUST_CNT_CD
       , A.CUST_SEQ
       , A.IO_BND_CD
       , A.FM_DT
       , A.TO_DT
       , DECODE(A.CHG_CURR_CD, 'USD', A.LOCL_CURR_CD, A.CHG_CURR_CD) CHG_CURR_CD
       , 'USD' LOCL_CURR_CD
       , A.XCH_RT_TP_CD
       , A.AR_OFC_CD
       , NVL(ROUND(DECODE(A.CHG_CURR_CD, 'USD', 1, A.INV_XCH_RT)/B.INV_XCH_RT, 6), 0) INV_XCH_RT
       , NVL(ROUND(1/ROUND(DECODE(A.CHG_CURR_CD, 'USD', 1, A.INV_XCH_RT)/B.INV_XCH_RT, 6), 6), 0) IVS_XCH_RT
       , A.CRE_USR_ID
       , A.CRE_DT
       , A.UPD_USR_ID
       , A.UPD_DT
FROM  OPUSADM_TMP.INV_CUST_AND_DLY_XCH_RT A,
      OPUSADM_TMP.INV_CUST_AND_DLY_XCH_RT B,
      MDM_ORGANIZATION C
WHERE A.CUST_CNT_CD = B.CUST_CNT_CD
AND   A.CUST_SEQ = B.CUST_SEQ
AND   A.IO_BND_CD = B.IO_BND_CD
AND   A.FM_DT = B.FM_DT
AND   A.TO_DT = B.TO_DT
AND   A.LOCL_CURR_CD = B.LOCL_CURR_CD
AND   A.XCH_RT_TP_CD = B.XCH_RT_TP_CD
AND   A.AR_OFC_CD = B.AR_OFC_CD
AND   B.CHG_CURR_CD = 'USD'
AND   A.CUST_CNT_CD = 'XX'
AND   A.CUST_SEQ = 0
AND   A.XCH_RT_TP_CD = 'V'
AND   A.AR_OFC_CD = C.OFC_CD
AND   NVL(C.ALTN_CURR_DIV_CD, 'LCL') = 'USD'
#if (${ar_ofc_cd} != '')
    AND A.AR_OFC_CD = @[ar_ofc_cd]
#end
)			]]></sql>
			<params>
				<param name="ar_ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
