<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableInvoiceMigrationDBDAOsearchSvcScpRSQL">
			<desc><![CDATA[AccountReceivableInvoiceMigrationDBDAOsearchSvcScpRSQL]]></desc>
			<sql><![CDATA[
SELECT distinct CASE WHEN CNT.CNT = 1 
                     THEN SINGLE.svcScpCd
                     ELSE MULTI.svcScpCd end SVC_SCP_CD 
  FROM (SELECT count(*)  CNT
          FROM MDM_svc_scp_lmt org
               , MDM_svc_scp_lmt dest
         WHERE org.rgn_cd           = @[rgn_cd_por]
           AND org.ORG_DEST_CD      = 'O'
           AND org.SVC_SCP_IND_FLG  = 'Y'
           AND dest.rgn_cd          = @[rgn_cd_del]
           AND dest.ORG_DEST_CD     = 'D'
           AND dest.SVC_SCP_IND_FLG = 'Y'
           AND org.svc_scp_cd       = dest.svc_scp_cd
           and org.delt_flg         = 'N'
           and dest.delt_flg        = 'N') CNT
     , (SELECT Max(org.svc_scp_cd) svcScpCd
          FROM MDM_svc_scp_lmt org
               , MDM_svc_scp_lmt dest
               , MDM_svc_scp_lane L
         WHERE org.rgn_cd           = @[rgn_cd_por]
           AND org.ORG_DEST_CD      = 'O'
           AND org.SVC_SCP_IND_FLG  = 'Y'
           and org.delt_flg         = 'N'
           AND dest.rgn_cd          = @[rgn_cd_del]
           AND dest.ORG_DEST_CD     = 'D'
           AND dest.SVC_SCP_IND_FLG = 'Y'
           and dest.delt_flg        = 'N'
           and org.svc_scp_cd       = l.SVC_SCP_CD
           AND org.svc_scp_cd       = dest.svc_scp_cd
           and org.svc_scp_cd       = l.SVC_SCP_CD
           and dest.svc_scp_cd      = l.SVC_SCP_CD
           and l.vsl_slan_cd        = @[lane_cd]) MULTI
     , (SELECT org.svc_scp_cd svcScpCd
          FROM MDM_svc_scp_lmt org
               , MDM_svc_scp_lmt dest
         WHERE org.rgn_cd           = @[rgn_cd_por]
           AND org.ORG_DEST_CD      = 'O'
           AND org.SVC_SCP_IND_FLG  = 'Y'
           AND dest.rgn_cd          = @[rgn_cd_del]
           AND dest.ORG_DEST_CD     = 'D'
           AND dest.SVC_SCP_IND_FLG = 'Y'
           AND org.svc_scp_cd       = dest.svc_scp_cd
           and NVL(org.delt_flg,'N') = 'N'
           and NVL(dest.delt_flg,'N') = 'N') SINGLE			]]></sql>
			<params>
				<param name="rgn_cd_por" type="12" value="" out="N"/>
				<param name="rgn_cd_del" type="12" value="" out="N"/>
				<param name="lane_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
