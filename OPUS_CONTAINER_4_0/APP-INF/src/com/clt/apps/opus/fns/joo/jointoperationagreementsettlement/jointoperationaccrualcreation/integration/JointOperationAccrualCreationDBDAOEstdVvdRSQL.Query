<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="JointOperationAccrualCreationDBDAOEstdVvdRSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
SELECT RLANE_CD
     , VVDCODE
  FROM (SELECT RLANE_CD
             , VVDCODE
          FROM (SELECT DISTINCT G.RLANE_CD
                     , G.VSL_CD||G.SKD_VOY_NO||G.SKD_DIR_CD||G.REV_DIR_CD AS VVDCODE
                  FROM GL_ESTM_REV_VVD G
                     , (SELECT DISTINCT A.RLANE_CD
                             , A.VSL_CD||A.SKD_VOY_NO||A.DIR_CD AS VVDCODE
                          FROM COA_MON_VVD A
                             , BSA_VVD_MST B
                             , (SELECT MIN(REV_YRMON) AS MIN_REV_YRMON
                                     , MAX(REV_YRMON) AS MAX_REV_YRMON
                                  FROM JOO_ESTM_ACT_RSLT J
                                 WHERE J.EXE_YRMON = REPLACE( @[exe_yrmon],'-','') ) M
                         WHERE 1=1
                           AND A.VSL_CD = B.VSL_CD
                           AND A.SKD_VOY_NO = B.SKD_VOY_NO
                           AND A.DIR_CD = B.SKD_DIR_CD
                           AND A.TRD_CD = B.TRD_CD
                           AND A.RLANE_CD = B.RLANE_CD
                           AND A.COST_YRMON BETWEEN M.MIN_REV_YRMON AND M.MAX_REV_YRMON 
                       ) J
                 WHERE 1=1
                   --AND G.EXE_YRMON = REPLACE([exe_yrmon],'-','')
                   AND G.ESTM_BC_DIV_CD = 'C'
                   AND G.RLANE_CD = J.RLANE_CD
                   AND G.VSL_CD||G.SKD_VOY_NO||G.SKD_DIR_CD = J.VVDCODE 
               )
         MINUS
        SELECT DISTINCT J.RLANE_CD
             , J.VSL_CD||J.SKD_VOY_NO||J.SKD_DIR_CD||J.REV_DIR_CD
          FROM JOO_ESTM_ACT_RSLT J
         WHERE EXE_YRMON = REPLACE( @[exe_yrmon], '-' , '')
       )
 ORDER BY 1, 2			]]></sql>
			<params>
				<param name="exe_yrmon" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
