/*=========================================================
*Copyright(c) 2015 CyberLogitec
*@FileName : MTYRepositionPerformanceAnalysisDBDAOMTYCNTRPERFSummaryVORSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2015.12.07
*@LastModifier : 
*@LastVersion : 1.0
* 2015.12.07 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.ees.cim.cntroperationperformancemgt.mtyrepositionperformanceanalysis.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class MTYRepositionPerformanceAnalysisDBDAOMTYCNTRPERFSummaryVORSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * MTY Container PFMC Summary    
	  * 2011.03.07 남궁진호[CHM-201109244-01] DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19, 오타수정
	  * 2011.04.21 남궁진호[CHM-201110306-01] Week조건으로 조회할수 있도록 조건 추가함
	  * </pre>
	  */
	public MTYRepositionPerformanceAnalysisDBDAOMTYCNTRPERFSummaryVORSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("tpsz",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("location",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("from",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("mtymvmt",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.ees.cim.cntroperationperformancemgt.mtyrepositionperformanceanalysis.integration").append("\n"); 
		query.append("FileName : MTYRepositionPerformanceAnalysisDBDAOMTYCNTRPERFSummaryVORSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if (${mtymvmt} == 'MTIDMG' || ${mtymvmt} == 'MTVDVD-MT' || ${mtymvmt} == 'MTOPOP-MT' || ${mtymvmt} == 'VLMTMT-VL' || ${mtymvmt} == 'MTOCOC-MT' || ${mtymvmt} == 'OCIDID-OC')" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("	L.MOV_STS AS division," ).append("\n"); 
		query.append("	SUM(CNT) AS total," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("			SELECT	/*+ ORDERED USE_NL ( A S ) */" ).append("\n"); 
		query.append("			        SUBSTR(@[mtymvmt],5)	MOV_STS," ).append("\n"); 
		query.append("					S.DP_SEQ				DSP_SEQ," ).append("\n"); 
		query.append("					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD," ).append("\n"); 
		query.append("					NVL(A.CNT,0)	        CNT" ).append("\n"); 
		query.append("			FROM	(" ).append("\n"); 
		query.append("						SELECT 	" ).append("\n"); 
		query.append("								SUBSTR(@[mtymvmt],5)	MOV_STS			," ).append("\n"); 
		query.append("								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ," ).append("\n"); 
		query.append("								COUNT(M.CNTR_NO)        CNT             " ).append("\n"); 
		query.append("						FROM 	CTM_MOVEMENT	     M,							" ).append("\n"); 
		query.append("						       	MST_CONTAINER        C     " ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      	AND 	M.MVMT_STS_CD = SUBSTR(@[mtymvmt],0,2)" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${mtymvmt} == 'MTIDMG')" ).append("\n"); 
		query.append("      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ����� */" ).append("\n"); 
		query.append("		AND		SUBSTR(@[mtymvmt],3,2)	=	(   		  " ).append("\n"); 
		query.append("												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("												FROM    CTM_MOVEMENT MM" ).append("\n"); 
		query.append("												WHERE   MM.CNTR_NO = M.CNTR_NO  " ).append("\n"); 
		query.append("												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         " ).append("\n"); 
		query.append("																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("												AND     ROWNUM = 1" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ����� */		" ).append("\n"); 
		query.append("      AND 	M.CNTR_NO  			= C.CNTR_NO" ).append("\n"); 
		query.append("	  #if (${soc} == 'E')" ).append("\n"); 
		query.append("      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ " ).append("\n"); 
		query.append("	  #elseif(${soc} == 'O')" ).append("\n"); 
		query.append("	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #end	" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    GROUP BY SUBSTR(@[mtymvmt],5),M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ_V S    " ).append("\n"); 
		query.append("     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("	) L" ).append("\n"); 
		query.append("	GROUP BY L.MOV_STS " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif(${mtymvmt} == 'MP')" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("	L.MOV_STS AS division," ).append("\n"); 
		query.append("	SUM(CNT) AS total," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("			SELECT	'MP'			MOV_STS		," ).append("\n"); 
		query.append("					S.DP_SEQ		DSP_SEQ		," ).append("\n"); 
		query.append("					S.CNTR_TPSZ_CD	CNTR_TPSZ_CD," ).append("\n"); 
		query.append("					NVL(CNT,0)		CNT" ).append("\n"); 
		query.append("			FROM	(" ).append("\n"); 
		query.append("						SELECT	M.CNTR_TPSZ_CD		CNTR_TPSZ_CD," ).append("\n"); 
		query.append("								COUNT(M.CNTR_NO)	CNT" ).append("\n"); 
		query.append("						FROM	(" ).append("\n"); 
		query.append("									SELECT	" ).append("\n"); 
		query.append("											M.CNTR_NO			CNTR_NO," ).append("\n"); 
		query.append("											M.CNTR_TPSZ_CD		CNTR_TPSZ_CD" ).append("\n"); 
		query.append("									FROM	CTM_MOVEMENT M" ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      	AND 	M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ����� */" ).append("\n"); 
		query.append("		AND		'XX'	=	(   		  " ).append("\n"); 
		query.append("												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("												FROM    CTM_MOVEMENT MM" ).append("\n"); 
		query.append("												WHERE   MM.CNTR_NO = M.CNTR_NO  " ).append("\n"); 
		query.append("												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         " ).append("\n"); 
		query.append("																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("												AND     ROWNUM = 1" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ����� */	" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("									SELECT " ).append("\n"); 
		query.append("											M.CNTR_NO			CNTR_NO," ).append("\n"); 
		query.append("											M.CNTR_TPSZ_CD		CNTR_TPSZ_CD" ).append("\n"); 
		query.append("									FROM	CTM_MOVEMENT M" ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      	AND 	M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("      AND M.CNMV_CYC_NO = 1 " ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("		) M," ).append("\n"); 
		query.append("		MST_CONTAINER		C" ).append("\n"); 
		query.append("		WHERE	M.CNTR_NO			= C.CNTR_NO" ).append("\n"); 
		query.append("	  #if (${soc} == 'E')" ).append("\n"); 
		query.append("      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #elseif(${soc} == 'O')" ).append("\n"); 
		query.append("	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("    GROUP BY M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ_V S" ).append("\n"); 
		query.append("	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") L" ).append("\n"); 
		query.append("GROUP BY L.MOV_STS" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif(${mtymvmt} == 'MR')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("	L.MOV_STS AS division," ).append("\n"); 
		query.append("	SUM(CNT) AS total," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("			SELECT	'MR'				MOV_STS," ).append("\n"); 
		query.append("					S.DP_SEQ			DSP_SEQ," ).append("\n"); 
		query.append("					S.CNTR_TPSZ_CD      CNTR_TPSZ_CD,	" ).append("\n"); 
		query.append("					NVL(CNT,0)			CNT" ).append("\n"); 
		query.append("			FROM	(" ).append("\n"); 
		query.append("						SELECT " ).append("\n"); 
		query.append("								'MR'					MOV_STS," ).append("\n"); 
		query.append("								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD," ).append("\n"); 
		query.append("								COUNT(M.CNTR_NO)		CNT" ).append("\n"); 
		query.append("						FROM	CTM_MOVEMENT	M," ).append("\n"); 
		query.append("								MST_CONTAINER	C" ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      	AND 	M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("		SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("					Y.YD_CD" ).append("\n"); 
		query.append("		FROM " ).append("\n"); 
		query.append("				MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("				MDM_LOCATION L," ).append("\n"); 
		query.append("					MDM_YARD Y" ).append("\n"); 
		query.append("		WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("		  AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("			#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("		  AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("			#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("			  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("			#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("			  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("			#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("			  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		  ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("			/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ����� */" ).append("\n"); 
		query.append("			AND		'OK'	=	(   		  " ).append("\n"); 
		query.append("									SELECT /*+ ORDERED USE_NL(MM LL GG) INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("											#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("											  DECODE(GG.SCC_CD,@[location],'NO'," ).append("\n"); 
		query.append("											#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("											  DECODE(GG.LCC_CD,@[location],'NO'," ).append("\n"); 
		query.append("											#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("											  DECODE(GG.ECC_CD,@[location],'NO'," ).append("\n"); 
		query.append("											#elseif(${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("											  DECODE(MM.ORG_YD_CD,@[location],'NO'," ).append("\n"); 
		query.append("											#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("											  DECODE(GG.RCC_CD,@[location],'NO',	" ).append("\n"); 
		query.append("											#end" ).append("\n"); 
		query.append("											DECODE(MM.MVMT_STS_CD,'EN','OK'," ).append("\n"); 
		query.append("											DECODE(MM.MVMT_STS_CD,'TN','OK','NO')))" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("									--		MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("									FROM    CTM_MOVEMENT	MM," ).append("\n"); 
		query.append("											MDM_LOCATION	LL," ).append("\n"); 
		query.append("											MDM_EQ_ORZ_CHT	GG" ).append("\n"); 
		query.append("									WHERE   MM.CNTR_NO = M.CNTR_NO  " ).append("\n"); 
		query.append("									AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         " ).append("\n"); 
		query.append("													M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("									AND		SUBSTR(MM.ORG_YD_CD, 1, 5)	= LL.LOC_CD" ).append("\n"); 
		query.append("									AND		LL.SCC_CD	= GG.SCC_CD" ).append("\n"); 
		query.append("									AND     ROWNUM		= 1" ).append("\n"); 
		query.append("								)" ).append("\n"); 
		query.append("		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ����� */		" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		AND		M.CNTR_NO	=	C.CNTR_NO" ).append("\n"); 
		query.append("	  #if (${soc} == 'E')" ).append("\n"); 
		query.append("      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #elseif(${soc} == 'O')" ).append("\n"); 
		query.append("	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("    GROUP BY 'MR', M.CNTR_TPSZ_CD )A,CIM_TP_SZ_DP_SEQ_V S" ).append("\n"); 
		query.append("	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") L" ).append("\n"); 
		query.append("GROUP BY L.MOV_STS" ).append("\n"); 
		query.append("#elseif(${mtymvmt} == 'MT')" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("	L.MOV_STS AS division," ).append("\n"); 
		query.append("	NVL(SUM(CNT),0) AS total," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("			SELECT	/*+ ORDERED USE_NL ( A S ) */" ).append("\n"); 
		query.append("			        'MG'			MOV_STS," ).append("\n"); 
		query.append("					S.DP_SEQ		DSP_SEQ," ).append("\n"); 
		query.append("					S.CNTR_TPSZ_CD  CNTR_TPSZ_CD," ).append("\n"); 
		query.append("					NVL(A.CNT,0)	CNT" ).append("\n"); 
		query.append("			FROM	(" ).append("\n"); 
		query.append("						SELECT 	" ).append("\n"); 
		query.append("								'MG'				MOV_STS			," ).append("\n"); 
		query.append("								M.CNTR_TPSZ_CD		CNTR_TPSZ_CD    ," ).append("\n"); 
		query.append("								COUNT(M.CNTR_NO)    CNT             " ).append("\n"); 
		query.append("						FROM 	CTM_MOVEMENT	     M," ).append("\n"); 
		query.append("						       	MST_CONTAINER        C     " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							)  " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      	AND 	M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  	M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ����� */" ).append("\n"); 
		query.append("		AND		'ID'	=	(   		  " ).append("\n"); 
		query.append("												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("												FROM    CTM_MOVEMENT MM" ).append("\n"); 
		query.append("												WHERE   MM.CNTR_NO = M.CNTR_NO  " ).append("\n"); 
		query.append("												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         " ).append("\n"); 
		query.append("																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("												AND     ROWNUM = 1" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ����� */	" ).append("\n"); 
		query.append("		AND	     M.CNTR_NO  			= C.CNTR_NO" ).append("\n"); 
		query.append("	  #if (${soc} == 'E')" ).append("\n"); 
		query.append("      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #elseif(${soc} == 'O')" ).append("\n"); 
		query.append("	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("    GROUP BY 'MG', M.CNTR_TPSZ_CD )A,CIM_TP_SZ_DP_SEQ_V S" ).append("\n"); 
		query.append("	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("	UNION ALL" ).append("\n"); 
		query.append("			SELECT	'MP'			MOV_STS		," ).append("\n"); 
		query.append("					S.DP_SEQ		DSP_SEQ		," ).append("\n"); 
		query.append("					S.CNTR_TPSZ_CD	CNTR_TPSZ_CD," ).append("\n"); 
		query.append("					NVL(CNT,0)		CNT" ).append("\n"); 
		query.append("			FROM	(" ).append("\n"); 
		query.append("						SELECT	M.CNTR_TPSZ_CD		CNTR_TPSZ_CD," ).append("\n"); 
		query.append("								COUNT(M.CNTR_NO)	CNT" ).append("\n"); 
		query.append("						FROM	(" ).append("\n"); 
		query.append("									SELECT	" ).append("\n"); 
		query.append("											M.CNTR_NO			CNTR_NO," ).append("\n"); 
		query.append("											M.CNTR_TPSZ_CD		CNTR_TPSZ_CD" ).append("\n"); 
		query.append("									FROM	CTM_MOVEMENT M" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							)  " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      AND 	M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ����� */" ).append("\n"); 
		query.append("		AND		'XX'	=	(   		  " ).append("\n"); 
		query.append("												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("												FROM    CTM_MOVEMENT MM" ).append("\n"); 
		query.append("												WHERE   MM.CNTR_NO = M.CNTR_NO  " ).append("\n"); 
		query.append("												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         " ).append("\n"); 
		query.append("																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("												AND     ROWNUM = 1" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ����� */	" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT " ).append("\n"); 
		query.append("          M.CNTR_NO CNTR_NO," ).append("\n"); 
		query.append("          M.CNTR_TPSZ_CD CNTR_TPSZ_CD" ).append("\n"); 
		query.append("        FROM CTM_MOVEMENT M" ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							)  " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      	AND 	M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  	M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("      AND 	M.CNMV_CYC_NO = 1 " ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND 	M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND 	M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("		) M ," ).append("\n"); 
		query.append("      MST_CONTAINER		C" ).append("\n"); 
		query.append("   	  WHERE	M.CNTR_NO			= C.CNTR_NO" ).append("\n"); 
		query.append("	  #if (${soc} == 'E')" ).append("\n"); 
		query.append("      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #elseif(${soc} == 'O')" ).append("\n"); 
		query.append("	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #end    " ).append("\n"); 
		query.append("	GROUP BY 'MP', M.CNTR_TPSZ_CD )A,CIM_TP_SZ_DP_SEQ_V S" ).append("\n"); 
		query.append("WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			SELECT	'MR'				MOV_STS," ).append("\n"); 
		query.append("					S.DP_SEQ			DSP_SEQ," ).append("\n"); 
		query.append("					S.CNTR_TPSZ_CD      CNTR_TPSZ_CD,	" ).append("\n"); 
		query.append("					NVL(CNT,0)			CNT" ).append("\n"); 
		query.append("			FROM	(" ).append("\n"); 
		query.append("						SELECT " ).append("\n"); 
		query.append("								'MR'					MOV_STS," ).append("\n"); 
		query.append("								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD," ).append("\n"); 
		query.append("								COUNT(M.CNTR_NO)		CNT" ).append("\n"); 
		query.append("						FROM	CTM_MOVEMENT	M," ).append("\n"); 
		query.append("								MST_CONTAINER	C" ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      AND 	M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("      AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("			/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ����� */" ).append("\n"); 
		query.append("			AND		'OK'	=	(   		  " ).append("\n"); 
		query.append("									SELECT /*+ ORDERED USE_NL(MM LL GG) INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("											#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("											  DECODE(GG.SCC_CD,@[location],'NO'," ).append("\n"); 
		query.append("											#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("											  DECODE(GG.LCC_CD,@[location],'NO'," ).append("\n"); 
		query.append("											#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("											  DECODE(GG.ECC_CD,@[location],'NO'," ).append("\n"); 
		query.append("											#elseif(${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("											  DECODE(MM.ORG_YD_CD,@[location],'NO'," ).append("\n"); 
		query.append("											#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("											  DECODE(GG.RCC_CD,@[location],'NO'," ).append("\n"); 
		query.append("											#end" ).append("\n"); 
		query.append("											DECODE(MM.MVMT_STS_CD,'EN','OK'," ).append("\n"); 
		query.append("											DECODE(MM.MVMT_STS_CD,'TN','OK','NO')))" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("									--		MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("									FROM    CTM_MOVEMENT	MM," ).append("\n"); 
		query.append("											MDM_LOCATION	LL," ).append("\n"); 
		query.append("											MDM_EQ_ORZ_CHT	GG" ).append("\n"); 
		query.append("									WHERE   MM.CNTR_NO = M.CNTR_NO  " ).append("\n"); 
		query.append("									AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         " ).append("\n"); 
		query.append("													M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("									AND		SUBSTR(MM.ORG_YD_CD, 1, 5)	= LL.LOC_CD" ).append("\n"); 
		query.append("									AND		LL.SCC_CD	= GG.SCC_CD" ).append("\n"); 
		query.append("									AND     ROWNUM		= 1" ).append("\n"); 
		query.append("								)" ).append("\n"); 
		query.append("		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ����� */	" ).append("\n"); 
		query.append("		AND	M.CNTR_NO	=	C.CNTR_NO" ).append("\n"); 
		query.append("	  #if (${soc} == 'E')" ).append("\n"); 
		query.append("      	AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #elseif(${soc} == 'O')" ).append("\n"); 
		query.append("	  	AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("    GROUP BY 'MR', M.CNTR_TPSZ_CD )A,CIM_TP_SZ_DP_SEQ_V S" ).append("\n"); 
		query.append("	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("	UNION ALL" ).append("\n"); 
		query.append("			SELECT	/*+ ORDERED USE_NL ( A S ) */" ).append("\n"); 
		query.append("			        'VD-MT'			MOV_STS," ).append("\n"); 
		query.append("					S.DP_SEQ		DSP_SEQ," ).append("\n"); 
		query.append("					S.CNTR_TPSZ_CD  CNTR_TPSZ_CD," ).append("\n"); 
		query.append("					NVL(A.CNT,0)	CNT" ).append("\n"); 
		query.append("			FROM	(" ).append("\n"); 
		query.append("						SELECT 	" ).append("\n"); 
		query.append("								'VD-MT'				MOV_STS			," ).append("\n"); 
		query.append("								M.CNTR_TPSZ_CD		CNTR_TPSZ_CD    ," ).append("\n"); 
		query.append("								COUNT(M.CNTR_NO)    CNT             " ).append("\n"); 
		query.append("						FROM 	CTM_MOVEMENT	     M," ).append("\n"); 
		query.append("						       	MST_CONTAINER        C     " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      	AND 	M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  	M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("     -- AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ����� */" ).append("\n"); 
		query.append("		AND		'VD'	=	(   		  " ).append("\n"); 
		query.append("												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("												FROM    CTM_MOVEMENT MM" ).append("\n"); 
		query.append("												WHERE   MM.CNTR_NO = M.CNTR_NO  " ).append("\n"); 
		query.append("												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         " ).append("\n"); 
		query.append("																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("												AND     ROWNUM = 1" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ����� */	" ).append("\n"); 
		query.append("		AND	     M.CNTR_NO  			= C.CNTR_NO" ).append("\n"); 
		query.append("	  #if (${soc} == 'E')" ).append("\n"); 
		query.append("      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #elseif(${soc} == 'O')" ).append("\n"); 
		query.append("	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("    GROUP BY 'VD-MT', M.CNTR_TPSZ_CD )A,CIM_TP_SZ_DP_SEQ_V S" ).append("\n"); 
		query.append("	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") L" ).append("\n"); 
		query.append("GROUP BY  L.MOV_STS " ).append("\n"); 
		query.append("ORDER BY division" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif(${mtymvmt} == 'VL')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("	L.MOV_STS AS division," ).append("\n"); 
		query.append("	SUM(CNT) AS total," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("			SELECT	/*+ ORDERED USE_NL ( A S ) */" ).append("\n"); 
		query.append("			        'OC-VL'					MOV_STS," ).append("\n"); 
		query.append("					S.DP_SEQ				DSP_SEQ," ).append("\n"); 
		query.append("					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD," ).append("\n"); 
		query.append("					NVL(A.CNT,0)	        CNT" ).append("\n"); 
		query.append("			FROM	(" ).append("\n"); 
		query.append("						SELECT 	" ).append("\n"); 
		query.append("								'OC-VL'					MOV_STS			," ).append("\n"); 
		query.append("								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ," ).append("\n"); 
		query.append("								COUNT(M.CNTR_NO)        CNT             " ).append("\n"); 
		query.append("						FROM 	CTM_MOVEMENT	     M," ).append("\n"); 
		query.append("						       	MST_CONTAINER        C     " ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							)  " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      	AND 	M.MVMT_STS_CD = 'VL'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${mtymvmt} == 'MTIDMG')" ).append("\n"); 
		query.append("      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ����� */" ).append("\n"); 
		query.append("		AND		'OC'	=	(   		  " ).append("\n"); 
		query.append("												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("												FROM    CTM_MOVEMENT MM" ).append("\n"); 
		query.append("												WHERE   MM.CNTR_NO = M.CNTR_NO  " ).append("\n"); 
		query.append("												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         " ).append("\n"); 
		query.append("																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("												AND     ROWNUM = 1" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ����� */		" ).append("\n"); 
		query.append("      AND 	M.CNTR_NO  			= C.CNTR_NO" ).append("\n"); 
		query.append("	  #if (${soc} == 'E')" ).append("\n"); 
		query.append("      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ " ).append("\n"); 
		query.append("	  #elseif(${soc} == 'O')" ).append("\n"); 
		query.append("	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #end	" ).append("\n"); 
		query.append("	#if (${bound} == 'N')" ).append("\n"); 
		query.append("		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("	#elseif(${bound} == 'Y')" ).append("\n"); 
		query.append("		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("    GROUP BY 'OC-VL',M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ_V S    " ).append("\n"); 
		query.append("     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			SELECT	/*+ ORDERED USE_NL ( A S ) */" ).append("\n"); 
		query.append("			        'TS-VL'					MOV_STS," ).append("\n"); 
		query.append("					S.DP_SEQ				DSP_SEQ," ).append("\n"); 
		query.append("					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD," ).append("\n"); 
		query.append("					NVL(A.CNT,0)	        CNT" ).append("\n"); 
		query.append("			FROM	(" ).append("\n"); 
		query.append("						SELECT 	" ).append("\n"); 
		query.append("								'TS-VL'					MOV_STS			," ).append("\n"); 
		query.append("								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ," ).append("\n"); 
		query.append("								COUNT(M.CNTR_NO)        CNT             " ).append("\n"); 
		query.append("						FROM 	CTM_MOVEMENT	     M," ).append("\n"); 
		query.append("						       	MST_CONTAINER        C     " ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      	AND 	M.MVMT_STS_CD = 'VL'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${mtymvmt} == 'MTIDMG')" ).append("\n"); 
		query.append("      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ����� */" ).append("\n"); 
		query.append("		AND		'TS'	=	(   		  " ).append("\n"); 
		query.append("												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("												FROM    CTM_MOVEMENT MM" ).append("\n"); 
		query.append("												WHERE   MM.CNTR_NO = M.CNTR_NO  " ).append("\n"); 
		query.append("												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         " ).append("\n"); 
		query.append("																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("												AND     ROWNUM = 1" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ����� */		" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      AND 	M.CNTR_NO  			= C.CNTR_NO" ).append("\n"); 
		query.append("	  #if (${soc} == 'E')" ).append("\n"); 
		query.append("      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ " ).append("\n"); 
		query.append("	  #elseif(${soc} == 'O')" ).append("\n"); 
		query.append("	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #end	" ).append("\n"); 
		query.append("	#if (${bound} == 'N')" ).append("\n"); 
		query.append("		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("	#elseif(${bound} == 'Y')" ).append("\n"); 
		query.append("		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    GROUP BY 'TS-VL',M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ_V S    " ).append("\n"); 
		query.append("     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("	) L" ).append("\n"); 
		query.append("	GROUP BY L.MOV_STS " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif(${mtymvmt} == 'VD')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("	L.MOV_STS AS division," ).append("\n"); 
		query.append("	SUM(CNT) AS total," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("			SELECT	/*+ ORDERED USE_NL ( A S ) */" ).append("\n"); 
		query.append("			        'VD-IC'					MOV_STS," ).append("\n"); 
		query.append("					S.DP_SEQ				DSP_SEQ," ).append("\n"); 
		query.append("					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD," ).append("\n"); 
		query.append("					NVL(A.CNT,0)	        CNT" ).append("\n"); 
		query.append("			FROM	(" ).append("\n"); 
		query.append("						SELECT 	" ).append("\n"); 
		query.append("								'VD-IC'					MOV_STS			," ).append("\n"); 
		query.append("								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ," ).append("\n"); 
		query.append("								COUNT(M.CNTR_NO)        CNT             " ).append("\n"); 
		query.append("						FROM 	CTM_MOVEMENT	     M," ).append("\n"); 
		query.append("						       	MST_CONTAINER        C     " ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      	AND 	M.MVMT_STS_CD = 'IC'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${mtymvmt} == 'MTIDMG')" ).append("\n"); 
		query.append("      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ����� */" ).append("\n"); 
		query.append("		AND		'VD'	=	(   		  " ).append("\n"); 
		query.append("												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("												FROM    CTM_MOVEMENT MM" ).append("\n"); 
		query.append("												WHERE   MM.CNTR_NO = M.CNTR_NO  " ).append("\n"); 
		query.append("												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         " ).append("\n"); 
		query.append("																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("												AND     ROWNUM = 1" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ����� */		" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      AND 	M.CNTR_NO  			= C.CNTR_NO" ).append("\n"); 
		query.append("	  #if (${soc} == 'E')" ).append("\n"); 
		query.append("      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ " ).append("\n"); 
		query.append("	  #elseif(${soc} == 'O')" ).append("\n"); 
		query.append("	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #end	" ).append("\n"); 
		query.append("	#if (${bound} == 'N')" ).append("\n"); 
		query.append("		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("	#elseif(${bound} == 'Y')" ).append("\n"); 
		query.append("		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    GROUP BY 'VD-IC',M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ_V S    " ).append("\n"); 
		query.append("     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("			SELECT	/*+ ORDERED USE_NL ( A S ) */" ).append("\n"); 
		query.append("			        'VD-TS'					MOV_STS," ).append("\n"); 
		query.append("					S.DP_SEQ				DSP_SEQ," ).append("\n"); 
		query.append("					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD," ).append("\n"); 
		query.append("					NVL(A.CNT,0)	        CNT" ).append("\n"); 
		query.append("			FROM	(" ).append("\n"); 
		query.append("						SELECT 	" ).append("\n"); 
		query.append("								'VD-TS'					MOV_STS			," ).append("\n"); 
		query.append("								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ," ).append("\n"); 
		query.append("								COUNT(M.CNTR_NO)        CNT             " ).append("\n"); 
		query.append("						FROM 	CTM_MOVEMENT	     M," ).append("\n"); 
		query.append("						       	MST_CONTAINER        C     " ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      	AND 	M.MVMT_STS_CD = 'TS'" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${mtymvmt} == 'MTIDMG')" ).append("\n"); 
		query.append("      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) " ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic ����� */" ).append("\n"); 
		query.append("		AND		'VD'	=	(   		  " ).append("\n"); 
		query.append("												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("												FROM    CTM_MOVEMENT MM" ).append("\n"); 
		query.append("												WHERE   MM.CNTR_NO = M.CNTR_NO  " ).append("\n"); 
		query.append("												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         " ).append("\n"); 
		query.append("																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("												AND     ROWNUM = 1" ).append("\n"); 
		query.append("											)" ).append("\n"); 
		query.append("		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic ����� */		" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      AND 	M.CNTR_NO  			= C.CNTR_NO" ).append("\n"); 
		query.append("	  #if (${soc} == 'E')" ).append("\n"); 
		query.append("      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ " ).append("\n"); 
		query.append("	  #elseif(${soc} == 'O')" ).append("\n"); 
		query.append("	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #end	" ).append("\n"); 
		query.append("	#if (${bound} == 'N')" ).append("\n"); 
		query.append("		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("	#elseif(${bound} == 'Y')" ).append("\n"); 
		query.append("		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    GROUP BY 'VD-TS',M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ_V S    " ).append("\n"); 
		query.append("     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("	) L" ).append("\n"); 
		query.append("	GROUP BY L.MOV_STS " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("	L.MOV_STS AS division," ).append("\n"); 
		query.append("	SUM(CNT) AS total," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 1, CNTR_TPSZ_CD , '0'  )),0,NULL,DECODE( L.DSP_SEQ, 1, CNT , 0  ) )) AS count01," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 2, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 2, CNT , 0) )) AS count02," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 3, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 3, CNT , 0) )) AS count03," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 4, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 4, CNT , 0) )) AS count04," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 5, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 5, CNT , 0) )) AS count05," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 6, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 6, CNT , 0) )) AS count06," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 7, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 7, CNT , 0) )) AS count07," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 8, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 8, CNT , 0) )) AS count08," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 9, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 9, CNT , 0) )) AS count09," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 10, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 10, CNT , 0) )) AS count10," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 11, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 11, CNT , 0) )) AS count11," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 12, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 12, CNT , 0) )) AS count12," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 13, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 13, CNT , 0) )) AS count13," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 14, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 14, CNT , 0) )) AS count14," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 15, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 15, CNT , 0) )) AS count15," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 16, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 16, CNT , 0) )) AS count16," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 17, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 17, CNT , 0) )) AS count17," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 18, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 18, CNT , 0) )) AS count18," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 19, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 19, CNT , 0) )) AS count19," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 20, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 20, CNT , 0) )) AS count20," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 21, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 21, CNT , 0) )) AS count21," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 22, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 22, CNT , 0) )) AS count22," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 23, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 23, CNT , 0) )) AS count23," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 24, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 24, CNT , 0) )) AS count24," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 25, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 25, CNT , 0) )) AS count25," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 26, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 26, CNT , 0) )) AS count26," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 27, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 27, CNT , 0) )) AS count27," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 28, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 28, CNT , 0) )) AS count28," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 29, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 29, CNT , 0) )) AS count29," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 30, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 30, CNT , 0) )) AS count30," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 31, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 31, CNT , 0) )) AS count31," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 32, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 32, CNT , 0) )) AS count32," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 33, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 33, CNT , 0) )) AS count33," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 34, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 34, CNT , 0) )) AS count34," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 35, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 35, CNT , 0) )) AS count35," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 36, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 36, CNT , 0) )) AS count36," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 37, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 37, CNT , 0) )) AS count37," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 38, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 38, CNT , 0) )) AS count38," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 39, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 39, CNT , 0) )) AS count39," ).append("\n"); 
		query.append("	SUM(DECODE(INSTR(@[tpsz],DECODE( L.DSP_SEQ, 40, CNTR_TPSZ_CD , '0'  )),0,NULL, DECODE( L.DSP_SEQ, 40, CNT , 0) )) AS count40" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("			SELECT	/*+ ORDERED USE_NL ( A S ) */" ).append("\n"); 
		query.append("			        SUBSTR(@[mtymvmt],0,2)	MOV_STS," ).append("\n"); 
		query.append("					S.DP_SEQ				DSP_SEQ," ).append("\n"); 
		query.append("					S.CNTR_TPSZ_CD          CNTR_TPSZ_CD," ).append("\n"); 
		query.append("					NVL(A.CNT,0)	        CNT" ).append("\n"); 
		query.append("			FROM	(" ).append("\n"); 
		query.append("						SELECT 	" ).append("\n"); 
		query.append("								SUBSTR(@[mtymvmt],0,2)	MOV_STS			," ).append("\n"); 
		query.append("								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ," ).append("\n"); 
		query.append("								COUNT(M.CNTR_NO)        CNT             " ).append("\n"); 
		query.append("						FROM 	CTM_MOVEMENT	     M," ).append("\n"); 
		query.append("						       	MST_CONTAINER        C     " ).append("\n"); 
		query.append("	#if (${period} == 'W') " ).append("\n"); 
		query.append("		WHERE 	M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD K" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							)  " ).append("\n"); 
		query.append("	#elseif (${period} == 'D' || ${period} == 'M') " ).append("\n"); 
		query.append("    	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 " ).append("\n"); 
		query.append("	  	AND 							TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("	#if (${mtymvmt} != '') " ).append("\n"); 
		query.append("      	AND 	M.MVMT_STS_CD = SUBSTR(@[mtymvmt],0,2)" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${mtymvmt} == 'ENF' || ${mtymvmt} == 'TNF' || ${mtymvmt} == 'ENM' || ${mtymvmt} == 'TNM') " ).append("\n"); 
		query.append("		#if (${mtymvmt} == 'ENF' || ${mtymvmt} == 'TNF') " ).append("\n"); 
		query.append("			AND	M.FCNTR_FLG = 'Y'" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			AND	M.FCNTR_FLG = 'N'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${tpsz} != '') " ).append("\n"); 
		query.append("		AND  	M.CNTR_TPSZ_CD  IN ( " ).append("\n"); 
		query.append("		#foreach($cntrtpszcd in ${vel_tpsz_cd})  " ).append("\n"); 
		query.append("			'$cntrtpszcd',  " ).append("\n"); 
		query.append("			#end  " ).append("\n"); 
		query.append("			'') " ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	  #if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("	  #else" ).append("\n"); 
		query.append("      AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("        SELECT 	/*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("				Y.YD_CD" ).append("\n"); 
		query.append("        FROM " ).append("\n"); 
		query.append("          		MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("          		MDM_LOCATION L," ).append("\n"); 
		query.append("				MDM_YARD Y" ).append("\n"); 
		query.append("        WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("          AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("		#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("          AND G.SCC_CD = @[location] 		/* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("		#elseif(${inquiryLevel} == 'R')" ).append("\n"); 
		query.append("		  AND G.RCC_CD = @[location]		/* inquiryLevel = 'RCC'*/" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("          ) " ).append("\n"); 
		query.append("	  #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      AND 	M.CNTR_NO  			= C.CNTR_NO" ).append("\n"); 
		query.append("	  #if (${soc} == 'E')" ).append("\n"); 
		query.append("      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ " ).append("\n"); 
		query.append("	  #elseif(${soc} == 'O')" ).append("\n"); 
		query.append("	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/" ).append("\n"); 
		query.append("	  #end	" ).append("\n"); 
		query.append("	#if (${bound} == 'N')" ).append("\n"); 
		query.append("		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("	#elseif(${bound} == 'Y')" ).append("\n"); 
		query.append("		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    GROUP BY SUBSTR(@[mtymvmt],0,2),M.CNTR_TPSZ_CD) A,CIM_TP_SZ_DP_SEQ_V S    " ).append("\n"); 
		query.append("     WHERE 	A.CNTR_TPSZ_CD(+) 	= S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("	) L" ).append("\n"); 
		query.append("	GROUP BY L.MOV_STS " ).append("\n"); 
		query.append("#end" ).append("\n"); 

	}
}