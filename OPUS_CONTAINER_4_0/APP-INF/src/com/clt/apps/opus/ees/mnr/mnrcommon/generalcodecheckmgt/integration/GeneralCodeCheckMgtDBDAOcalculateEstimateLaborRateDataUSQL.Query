<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GeneralCodeCheckMgtDBDAOcalculateEstimateLaborRateDataUSQL">
			<desc><![CDATA[calculateEstimateLaborRateData]]></desc>
			<sql><![CDATA[
UPDATE MNR_DAT_VRFY A
SET (A.INP_MSG18, A.INP_MSG37)
    = ( SELECT NVL(MAR.AGMT_RT_AMT, 0), 'Y'||(CASE WHEN (SELECT MNR_CD_DESC FROM MNR_GEN_CD
                    WHERE PRNT_CD_ID ='CD00096'
                    AND   MNR_CD_ID='TC' ) = 'N' 
              THEN 'YY'
              ELSE 'NN'
        END
        )
        FROM MNR_AGMT_HDR MAH, MNR_AGMT_RT MAR
        WHERE A.INP_MSG35              = MAH.AGMT_OFC_CTY_CD
        AND   A.INP_MSG36              = MAH.AGMT_SEQ
        AND   MAH.AGMT_LST_VER_FLG     = 'Y'
        AND   MAH.AGMT_OFC_CTY_CD      = MAR.AGMT_OFC_CTY_CD
        AND   MAH.AGMT_SEQ             = MAR.AGMT_SEQ
        AND   MAH.AGMT_VER_NO          = MAR.AGMT_VER_NO
        AND   A.INP_MSG19              = MAR.COST_CD(+)
        AND   A.INP_MSG20              = MAR.COST_DTL_CD(+)
        AND   ROWNUM =1
      )
WHERE A.TMP_SEQ = @[tmp_seq]
AND   A.INP_MSG4 = 'SS'
AND   EXISTS ( SELECT 'X'
  FROM MNR_AGMT_HDR MAH, MNR_AGMT_RT MAR
  WHERE A.INP_MSG35              = MAH.AGMT_OFC_CTY_CD
  AND   A.INP_MSG36              = MAH.AGMT_SEQ
  AND   MAH.AGMT_LST_VER_FLG     = 'Y'
  AND   MAH.AGMT_OFC_CTY_CD      = MAR.AGMT_OFC_CTY_CD
  AND   MAH.AGMT_SEQ             = MAR.AGMT_SEQ
  AND   MAH.AGMT_VER_NO          = MAR.AGMT_VER_NO
  AND   A.INP_MSG19              = MAR.COST_CD(+)
  AND   A.INP_MSG20              = MAR.COST_DTL_CD(+)
  AND   ROWNUM =1
 )			]]></sql>
			<params>
				<param name="tmp_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
