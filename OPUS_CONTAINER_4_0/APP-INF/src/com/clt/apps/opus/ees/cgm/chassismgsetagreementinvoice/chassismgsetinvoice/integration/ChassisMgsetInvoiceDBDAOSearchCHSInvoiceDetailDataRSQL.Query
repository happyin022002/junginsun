<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChassisMgsetInvoiceDBDAOSearchCHSInvoiceDetailDataRSQL">
			<desc><![CDATA[------------------------------------------------------------------------------------------------------------------
ChassisMgsetInvoiceDB.SearchCHSInvoiceDetailData
2014-05-16 Justin HAN Added NP, CP Invoice Detail Inquiry SQL
------------------------------------------------------------------------------------------------------------------]]></desc>
			<sql><![CDATA[
SELECT A.AGMT_OFC_CTY_CD || LPAD(A.AGMT_SEQ, 6,'0') AS AGMT_NO,
	   A.EQ_NO,
	   (SELECT C.EQ_TPSZ_CD
          FROM CGM_EQUIPMENT C
         WHERE C.EQ_NO = A.EQ_NO
       ) AS EQ_TPSZ_CD,
	   A.CHG_CD,
       A.COST_CD,
       A.ACCT_CD,
       'USD' AS CURR_CD,
       A.PAY_TAX_AMT,
       A.PAY_CR_AMT,
       A.PAY_LSE_CHG_AMT
  FROM CGM_LSE_CHG_DTL A
 WHERE A.EQ_KND_CD = @[eq_knd_cd]
   AND A.PAY_INV_SEQ = @[pay_inv_seq]
   AND A.PAY_LSE_CHG_STS_CD = 'C'
UNION ALL
SELECT A.AGMT_OFC_CTY_CD || LPAD(A.AGMT_SEQ, 6,'0') AS AGMT_NO,
	   '' AS EQ_NO,
	   '' AS EQ_TPSZ_CD,
	   '' AS CHG_CD,
       B.COST_CD,
       B.ACCT_CD,
       A.CURR_CD AS CURR_CD,
       0 AS PAY_TAX_AMT,
       CASE WHEN A.CHSS_MGST_INV_KND_CD = 'CP' AND B.DTL_POOL_COST_ITM_CD = 'CG' THEN ABS(B.COST_AMT)
            WHEN A.CHSS_MGST_INV_KND_CD = 'NP' AND B.DTL_POOL_COST_ITM_CD = 'NE' THEN ABS(B.COST_AMT)
            ELSE 0
       END AS PAY_CR_AMT,
       CASE WHEN A.CHSS_MGST_INV_KND_CD = 'CP' AND B.DTL_POOL_COST_ITM_CD = 'CG' THEN B.COST_AMT       
            WHEN A.CHSS_MGST_INV_KND_CD = 'NP' AND B.DTL_POOL_COST_ITM_CD = 'NE' THEN B.COST_AMT
            ELSE B.COST_AMT
       END AS PAY_LSE_CHG_AMT
  FROM CGM_PAY_INV A, CGM_PAY_INV_POOL_DTL B
 WHERE A.PAY_INV_SEQ = B.PAY_INV_SEQ
   AND B.PAY_INV_SEQ = @[pay_inv_seq]
   AND A.CHSS_MGST_INV_STS_CD != 'H'			]]></sql>
			<params>
				<param name="eq_knd_cd" type="12" value="" out="N"/>
				<param name="pay_inv_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
