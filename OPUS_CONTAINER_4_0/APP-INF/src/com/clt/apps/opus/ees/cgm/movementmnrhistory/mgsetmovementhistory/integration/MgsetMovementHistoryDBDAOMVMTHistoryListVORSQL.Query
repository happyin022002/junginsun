<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="MgsetMovementHistoryDBDAOMVMTHistoryListVORSQL">
			<desc><![CDATA[DESC Enter..]]></desc>
			<sql><![CDATA[
SELECT
     DISTINCT
     CTM.CNMV_CYC_NO
    ,BKG.VSL_CD||BKG.SKD_VOY_NO||BKG.SKD_DIR_CD VL
    ,BKG.POR_CD
    ,BKG.POL_CD
    ,BKG.POD_CD
    ,BKG.DEL_CD
    ,BKG.BKG_NO
    ,BKG.BL_NO BL_NO
    ,MDT.REP_CMDT_NM
    ,DECODE (BKG.POL_CD, BV.POL_CD, '', BV.POL_CD) RELAY
FROM BKG_BOOKING BKG, BKG_CONTAINER BCNT, (
     SELECT DISTINCT
            CTR.BKG_NO, CTR.CNMV_CYC_NO, CTR.CNTR_NO
       FROM CTM_MOVEMENT CTR
      WHERE 1 = 1
#if (${p_cntrno} != '') 
        AND CTR.CNTR_NO =  @[p_cntrno]
#end
#if (${p_date1} != '')
        AND CTR.CNMV_EVNT_DT BETWEEN TO_DATE (REPLACE (@[p_date1], '-', ''), 'YYYY-MM-DD') AND TO_DATE (REPLACE (@[p_date2], '-', ''), 'YYYY-MM-DD') + 0.9999
#end
     ) CTM, MDM_REP_CMDT MDT, BKG_VVD BV
WHERE CTM.CNTR_NO = BCNT.CNTR_NO 
  AND CTM.CNMV_CYC_NO = BCNT.CNMV_CYC_NO
  AND BCNT.BKG_NO = BKG.BKG_NO
  AND BKG.REP_CMDT_CD = MDT.REP_CMDT_CD(+)
  AND BKG.BKG_STS_CD NOT IN ('X', 'S')
  AND BKG.BKG_NO = BV.BKG_NO
  AND BKG.VSL_CD = BV.VSL_CD
  AND BKG.SKD_VOY_NO = BV.SKD_VOY_NO
  AND BKG.SKD_DIR_CD = BV.SKD_DIR_CD
  AND BV.VSL_PRE_PST_CD = 'T'
ORDER BY CTM.CNMV_CYC_NO ASC			]]></sql>
			<params>
				<param name="p_cntrno" type="12" value="" out="N"/>
				<param name="p_date1" type="12" value="" out="N"/>
				<param name="p_date2" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
