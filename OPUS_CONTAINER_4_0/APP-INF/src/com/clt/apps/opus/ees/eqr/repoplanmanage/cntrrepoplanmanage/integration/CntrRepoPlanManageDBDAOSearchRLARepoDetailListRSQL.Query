<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CntrRepoPlanManageDBDAOSearchRLARepoDetailListRSQL">
			<desc><![CDATA[<EES_EQR_0048 컨테이너 수급 예측실적 및 정확도 조회(RLA List)>
EQR 각 PORT의 재고정보 / RED LIGHT ALERT 정보 조회
                            			EQR_VSL_LODG_DCHG_PLN
							EQR_INLND_TRSP_PLN
							EQR_ONF_HIR_PLN

<Change History>
1	2009.09.16	Lee ByoungHun	최초작성]]></desc>
			<sql><![CDATA[
SELECT
    PLN_YRWK
    , RLATYPE_TMP RLA_TMP
    , RLAType RLA_TYPE
    , DIV
    , ITEM
    , VSL_LANE_CD
    , VVD
    , FM_ECC_CD
    , ETD FM_ETD_DT
    , TO_ECC_CD
    , ETA TO_ETA_DT
    , '' TVOL
    #foreach ($key in ${arrCntrTpszCd})
        , ${key}CNTR_QTY
        , ${key}COST_AMT
    #end
    , REPO_PLN_ID
    , TABLENM
    , TRSP_MOD_CD
    ,'1' SUBSEQ
    --,CNTR_TOT_QTY, CNTR_MAX_CAPA_QTY --값 확인시 주석푼다.
FROM
(
    -----------------------------------------------------------------------Max Capa
    SELECT
        PLN_YRWK
        , '2Max Capa' RLATYPE_TMP
        , SUBSTR('2Max Capa',2) RLATYPE
        , 'Plan' DIV
        , P.ITEM
        , P.TRSP_MOD_CD
        , '' VSL_LANE_CD
        , '' VVD
        , P.FM_ECC_CD
        , ETD
        , P.TO_ECC_CD
        , ETA
        , '' TVOL
        , '' TCOST
        #foreach ($key in ${arrCntrTpszCd})
            , SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY
            , SUM(DECODE ( CNTR_TPSZ_CD , '$key' , COST_AMT))     ${key}COST_AMT
        #end
        , REPO_PLN_ID
        , SUM(CNTR_QTY) CNTR_TOT_QTY
        , CNTR_MAX_CAPA_QTY
        , 'EQR_INLND_TRSP_PLN' TABLENM
    FROM
    (
        SELECT
            A.REPO_PLN_ID
            , A.PLN_YRWK
            , A.TRSP_MOD_CD ITEM
            , A.TRSP_MOD_CD
            , '' VSL_LANE_CD
            , '' VVD
            , (
                SELECT
                #if (${fmtoat5} == '1')
                    #if (${fmtypeby_5} == 'R')
                        RCC_CD
                    #elseif (${fmtypeby_5} == 'C')
                        CNT_CD
                    #elseif (${fmtypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM
                    EQR_ECC_MST
                WHERE
                    A.FM_ECC_CD = ECC_CD
            ) FM_ECC_CD
            , (
                SELECT
                #if (${fmtoat5} == '1')
                    #if (${totypeby_5} == 'R')
                        RCC_CD
                    #elseif (${totypeby_5} == 'C')
                        CNT_CD
                    #elseif (${totypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM
                    EQR_ECC_MST
                WHERE
                    A.TO_ECC_CD = ECC_CD
            ) TO_ECC_CD
            , A.FM_YRWK ETD
            , A.TO_YRWK ETA
            , B.CNTR_TPSZ_CD
            , B.CNTR_QTY
            , B.TRSP_COST_AMT COST_AMT
        FROM
            EQR_INLND_TRSP_PLN A
            , EQR_INLND_TRSP_PLN_QTY B
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrFmEccCd.size() > 0)
                    #if (${fmtype_5} == 'R')
                        AND RCC_CD
                    #elseif (${fmtype_5} == 'L')
                        AND LCC_CD
                    #elseif (${fmtype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrFmEccCd})
                            #if($velocityCount < $arrFmEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) C
                #else
                    ) C
                #end
            #else
                #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if (${attype_5}== 'R')
                        AND RCC_CD
                    #elseif (${attype_5}== 'L')
                        AND LCC_CD
                    #elseif (${attype_5}== 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrAtEccCd})
                            #if($velocityCount < $arrAtEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    ))C
                #end
            #end
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrToEccCd.size() > 0)
                    #if (${totype_5} == 'R')
                        AND RCC_CD
                    #elseif (${totype_5} == 'L')
                        AND LCC_CD
                    #elseif (${totype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrToEccCd})
                            #if($velocityCount < $arrToEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) D
                #else
                    ) D
                #end
            #end
        WHERE
            A.REPO_PLN_ID = B.REPO_PLN_ID
            AND A.PLN_YRWK = B.PLN_YRWK
            AND A.PLN_SEQ = B.PLN_SEQ
            AND A.REPO_PLN_ID = @[repo_pln_Id]
            AND A.PAST_REPO_PLN_FLG = 'N'
            #if ($arrItem.size() > 0)
                AND TRSP_MOD_CD IN 
                (
                    #foreach ($key in ${arrItem})
                        #if($velocityCount < $arrItem.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            #if (${lane_5} != '')
                AND 1 = 2
            #end
            #if (${vvd_5} != '')
                AND 1 = 2
            #end
            #if (${fmtoat5} == '1')
                AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
            #else
                #if (${attype_5} != '')
                    AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                #end
            #end
            #if ($arrCntrTpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arrCntrTpszCd})
                        #if($velocityCount < $arrCntrTpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            AND (
                #if (${fmtoat5} == '1')
                    #if (${fmFmPlnYrWk} != '')
                        A.FM_YRWK BETWEEN @[fmFmPlnYrWk] AND @[fmToPlnYrWk]
                    #end
                    #if (${toFmPlnYrWk} != '')
                        AND A.TO_YRWK BETWEEN @[toFmPlnYrWk] AND @[toToPlnYrWk]
                    #end
                #else
                    A.FM_YRWK BETWEEN @[fmFmPlnYrWk] AND @[fmToPlnYrWk]
                    OR A.TO_YRWK BETWEEN @[toFmPlnYrWk] AND @[toToPlnYrWk]
                #end
            )
    ) P,
    (
        SELECT
            PERF.TRSP_MOD_CD
            , PERF.FM_ECC_CD
            , PERF.TO_ECC_CD
            , PERF.CNTR_TPSZ_CD TPSZ_CD
            , B.SCNR_ID
            , B.CNTR_MAX_CAPA_QTY
        FROM
        (
            SELECT
                A.YRWK PLN_YRWK
                , A.TRSP_MOD_CD ITEM
                , A.TRSP_MOD_CD
                , (
                    SELECT
                    #if (${fmtoat5} == '1')
                        #if (${fmtypeby_5} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby_5} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM
                        EQR_ECC_MST
                    WHERE
                        A.FM_ECC_CD = ECC_CD
                ) FM_ECC_CD
                , (
                    SELECT
                    #if (${fmtoat5} == '1')
                        #if (${totypeby_5} == 'R')
                            RCC_CD
                        #elseif (${totypeby_5} == 'C')
                            CNT_CD
                        #elseif (${totypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM
                        EQR_ECC_MST
                    WHERE
                        A.TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
                , A.CNTR_TPSZ_CD
                , A.CNTR_QTY
                , '' COST_AMT
                , MON_FREQ_KNT
            FROM
                EQR_EXE_PLN_INLND_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE
                A.YRWK = @[yyyyww]
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND MON_FREQ_KNT >= 4
        ) PERF
            , EQR_SCNR_ECC_LNK B
        WHERE
            B.SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_Id])
            AND PERF.TRSP_MOD_CD = B.TRSP_MOD_CD
            AND PERF.FM_ECC_CD = B.FM_ECC_CD
            AND PERF.TO_ECC_CD = B.TO_ECC_CD
            AND PERF.CNTR_QTY/MON_FREQ_KNT  >= B.CNTR_MAX_CAPA_QTY
    ) F
    WHERE
        F.SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = P.REPO_PLN_ID)
        AND P.TRSP_MOD_CD = F.TRSP_MOD_CD
        AND P.FM_ECC_CD = F.FM_ECC_CD
        AND P.TO_ECC_CD = F.TO_ECC_CD
        AND P.CNTR_TPSZ_CD = F.TPSZ_CD
        AND P.PLN_YRWK IN (${max_capa_4wk})
        #if (${rlatype_5} == '')
            AND 1=1
        #elseif (${rlatype_5} == 'B')
            AND 1=2
        #elseif (${rlatype_5} == 'M')
            AND 1=1
        #elseif (${rlatype_5} == 'A')
            AND 1=2
        #elseif (${rlatype_5} == 'S')
            AND 1=2
        #elseif (${rlatype_5} == 'N')
            AND 1=2
        #elseif (${rlatype_5} == 'P')
            AND 1=2
        #end
    GROUP BY
        REPO_PLN_ID, PLN_YRWK, P.TRSP_MOD_CD, P.FM_ECC_CD, ETD, P.TO_ECC_CD, ETA, CNTR_MAX_CAPA_QTY
)

UNION ALL

-----------------------------------------------------------------------Low ADHR
SELECT
    PLN_YRWK,
    '3Low Adherence' RLA_TMP
    , SUBSTR('3Low Adherence',2) RLA_TYPE
    , DIV
    , ITEM
    , VSL_LANE_CD
    , VVD
    , FM_ECC_CD
    , ETD FM_ETD_DT
    , T2.TO_ECC_CD
    , ETA TO_ETA_DT
    , '' TVOL
    #foreach ($key in ${arrCntrTpszCd})
        , SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY
        , SUM(DECODE ( CNTR_TPSZ_CD , '$key' , COST_AMT))     ${key}COST_AMT
    #end
    , REPO_PLN_ID
    , TABLENM
    , TRSP_MOD_CD
    , SUBSEQ
FROM
(
    -------------------------------------------------------------------------------Low ADHR(ON-HIRE)
    SELECT
        PLN_ON.PLN_YRWK PLN_YRWK
        , DIV, PLN_ON.ITEM
        , PLN_ON.TRSP_MOD_CD
        , VSL_LANE_CD
        , VVD
        , (
            SELECT
            #if (${fmtoat5} == '1')
                #if (${fmtypeby_5} == 'R')
                    RCC_CD
                #elseif (${fmtypeby_5} == 'C')
                    CNT_CD
                #elseif (${fmtypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM
                EQR_ECC_MST
            WHERE
                PLN_ON.FM_ECC_CD = ECC_CD
        ) FM_ECC_CD
        , (
            SELECT
            #if (${fmtoat5} == '1')
                #if (${totypeby_5} == 'R')
                    RCC_CD
                #elseif (${totypeby_5} == 'C')
                    CNT_CD
                #elseif (${totypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM
                EQR_ECC_MST
            WHERE
                PLN_ON.TO_ECC_CD = ECC_CD
        ) TO_ECC_CD
        , ETD
        , ETA
        , '' TVOL
        , '' TCOST
        , PLN_ON.CNTR_TPSZ_CD
        , PLN_ON.CNTR_QTY
        , PLN_ON.COST_AMT
        , PLN_ON.REPO_PLN_ID
        , '1' SEQ
        , '1' SUBSEQ
        , TABLENM
    FROM
    (
        SELECT
            TRSP_MOD_CD
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
        FROM
        (
            SELECT
                A.YRWK PLN_YRWK
                , A.ONF_HIR_DIV_CD ITEM
                , 'O' TRSP_MOD_CD
                , (
                    SELECT
                    #if (${fmtoat5} == '1')
                        #if (${fmtypeby_5} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby_5} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM
                        EQR_ECC_MST
                    WHERE
                        A.FM_ECC_CD = ECC_CD
                ) FM_ECC_CD
                , (
                    SELECT
                    #if (${fmtoat5} == '1')
                        #if (${totypeby_5} == 'R')
                            RCC_CD
                        #elseif (${totypeby_5} == 'C')
                            CNT_CD
                        #elseif (${totypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM
                        EQR_ECC_MST
                    WHERE
                        A.TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
                , A.CNTR_TPSZ_CD
                , A.CNTR_QTY
                , '' COST_AMT
                , MON_FREQ_KNT
            FROM
                EQR_EXE_PLN_ONF_HIR_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE
                A.YRWK = @[yyyyww]
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND ONF_HIR_DIV_CD = 'O'
                AND MON_RSN_KNT = 4
        )
    )PERF,
    (
        SELECT
            A.REPO_PLN_ID
            , A.PLN_YRWK
            , '' FM_ECC_CD
            , A.ECC_CD TO_ECC_CD
            , CNTR_TPSZ_CD
            , CNTR_QTY
            , ONF_HIR_COST_AMT COST_AMT
            , '' ETD
            , '' ETA
            , 'O' TRSP_MOD_CD
            , '' VSL_LANE_CD
            , '' VVD
            , 'Plan' DIV
            , ONF_HIR_DIV_CD ITEM
            , 'EQR_ONF_HIR_PLN' TABLENM
        FROM
            EQR_ONF_HIR_PLN	A
            , EQR_ONF_HIR_PLN_QTY B
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrFmEccCd.size() > 0)
                    #if (${fmtype_5} == 'R')
                        AND RCC_CD
                    #elseif (${fmtype_5} == 'L')
                        AND LCC_CD
                    #elseif (${fmtype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrFmEccCd})
                            #if($velocityCount < $arrFmEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) C
                #else
                    ) C
                #end
            #else
                #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if (${attype_5}== 'R')
                        AND RCC_CD
                    #elseif (${attype_5}== 'L')
                        AND LCC_CD
                    #elseif (${attype_5}== 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrAtEccCd})
                            #if($velocityCount < $arrAtEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    ))C
                #end
            #end
        WHERE
            A.REPO_PLN_ID = B.REPO_PLN_ID
            AND A.PLN_YRWK = B.PLN_YRWK
            AND A.PLN_SEQ = B.PLN_SEQ
            AND A.REPO_PLN_ID = @[repo_pln_Id]
            #if (${item_5} != '')
                #if (${onHire} == 'Y')
                    AND 1=1
                #else
                    AND 1=2
                #end
            #end
            #if (${lane_5} != '')
                AND 1 = 2
            #end
            #if (${vvd_5} != '')
                AND 1 = 2
            #end
            #if (${item_5} != '')
                #if (${onHire} == 'Y')
                    AND 1=1
                #else
                    AND 1=2
                #end
            #end
            #if ($arrCntrTpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arrCntrTpszCd})
                        #if($velocityCount < $arrCntrTpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            AND A.PLN_YRWK = @[yyyyww]
            AND ONF_HIR_DIV_CD = 'O'
    )PLN_ON
    WHERE
        PERF.CNTR_TPSZ_CD = PLN_ON.CNTR_TPSZ_CD
        AND PERF.TO_ECC_CD 		= PLN_ON.TO_ECC_CD
        AND PERF.TRSP_MOD_CD 	= PLN_ON.TRSP_MOD_CD
        AND PLN_ON.PLN_YRWK IN (${max_capa_4wk})
        #if (${rlatype_5} == '')
            AND 1=1
        #elseif (${rlatype_5} == 'B')
            AND 1=2
        #elseif (${rlatype_5} == 'M')
            AND 1=2
        #elseif (${rlatype_5} == 'A')
            AND 1=1
        #elseif (${rlatype_5} == 'S')
            AND 1=2
        #elseif (${rlatype_5} == 'N')
            AND 1=2
        #elseif (${rlatype_5} == 'P')
            AND 1=2
        #end

    UNION ALL

    -------------------------------------------------------------------------------Low ADHR(OFF-HIRE)
    SELECT
        PLN_ON.PLN_YRWK PLN_YRWK
        , DIV
        , PLN_ON.ITEM
        , PLN_ON.TRSP_MOD_CD
        , VSL_LANE_CD
        , VVD
        , (
            SELECT
            #if (${fmtoat5} == '1')
                #if (${fmtypeby_5} == 'R')
                    RCC_CD
                #elseif (${fmtypeby_5} == 'C')
                    CNT_CD
                #elseif (${fmtypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM
                EQR_ECC_MST
            WHERE
                PLN_ON.FM_ECC_CD = ECC_CD
        ) FM_ECC_CD
        , (
            SELECT
            #if (${fmtoat5} == '1')
                #if (${totypeby_5} == 'R')
                    RCC_CD
                #elseif (${totypeby_5} == 'C')
                    CNT_CD
                #elseif (${totypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM
                EQR_ECC_MST
            WHERE
                PLN_ON.TO_ECC_CD = ECC_CD
        ) TO_ECC_CD
        , ETD
        , ETA
        , '' TVOL
        , '' TCOST
        , PLN_ON.CNTR_TPSZ_CD
        , PLN_ON.CNTR_QTY
        , PLN_ON.COST_AMT
        , PLN_ON.REPO_PLN_ID
        , '1' SEQ
        , '1' SUBSEQ
        , TABLENM
    FROM
    (
        SELECT
            TRSP_MOD_CD
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
        FROM
        (
            SELECT
            A.YRWK PLN_YRWK
            , A.ONF_HIR_DIV_CD ITEM
            , 'F' TRSP_MOD_CD
            , (
                SELECT
                #if (${fmtoat5} == '1')
                    #if (${fmtypeby_5} == 'R')
                        RCC_CD
                    #elseif (${fmtypeby_5} == 'C')
                        CNT_CD
                    #elseif (${fmtypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM
                    EQR_ECC_MST
                WHERE
                    A.FM_ECC_CD = ECC_CD
            ) FM_ECC_CD
            , (
                SELECT
                #if (${fmtoat5} == '1')
                    #if (${totypeby_5} == 'R')
                        RCC_CD
                    #elseif (${totypeby_5} == 'C')
                        CNT_CD
                    #elseif (${totypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM
                    EQR_ECC_MST
                WHERE
                    A.TO_ECC_CD = ECC_CD
            ) TO_ECC_CD
            , A.CNTR_TPSZ_CD
            , A.CNTR_QTY
            , '' COST_AMT
            , MON_FREQ_KNT
            FROM
                EQR_EXE_PLN_ONF_HIR_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE
                A.YRWK = @[yyyyww]
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND ONF_HIR_DIV_CD = 'F'
                AND MON_RSN_KNT = 4
        )
    )PERF,
    (
        SELECT
            A.REPO_PLN_ID
            , A.PLN_YRWK
            , A.ECC_CD FM_ECC_CD
            , '' TO_ECC_CD
            , CNTR_TPSZ_CD
            , CNTR_QTY
            , ONF_HIR_COST_AMT COST_AMT
            , '' ETD
            , '' ETA
            , 'F' TRSP_MOD_CD
            , '' VSL_LANE_CD
            , '' VVD
            , 'Plan' DIV
            , ONF_HIR_DIV_CD ITEM
            , 'EQR_ONF_HIR_PLN' TABLENM
        FROM
            EQR_ONF_HIR_PLN	A
            , EQR_ONF_HIR_PLN_QTY B
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrFmEccCd.size() > 0)
                    #if (${fmtype_5} == 'R')
                        AND RCC_CD
                    #elseif (${fmtype_5} == 'L')
                        AND LCC_CD
                    #elseif (${fmtype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrFmEccCd})
                            #if($velocityCount < $arrFmEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) C
                #else
                    ) C
                #end
            #else
                #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if (${attype_5}== 'R')
                        AND RCC_CD
                    #elseif (${attype_5}== 'L')
                        AND LCC_CD
                    #elseif (${attype_5}== 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrAtEccCd})
                            #if($velocityCount < $arrAtEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    ))C
                #end
            #end
        WHERE
            A.REPO_PLN_ID = B.REPO_PLN_ID
            AND A.PLN_YRWK = B.PLN_YRWK
            AND A.PLN_SEQ = B.PLN_SEQ
            AND A.REPO_PLN_ID = @[repo_pln_Id]
            #if (${item_5} != '')
                #if (${offHire} == 'Y')
                    AND 1=1
                #else
                    AND 1=2
                #end
            #end
            #if (${lane_5} != '')
                AND 1 = 2
            #end
            #if (${vvd_5} != '')
                AND 1 = 2
            #end
            #if (${fmtoat5} == '1')
                AND A.ECC_CD = C.ECC_CD
            #else
                #if (${attype_5} != '')
                    AND A.ECC_CD = C.ECC_CD
                #end
            #end
            #if ($arrCntrTpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arrCntrTpszCd})
                        #if($velocityCount < $arrCntrTpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            AND A.PLN_YRWK = @[yyyyww]
            AND ONF_HIR_DIV_CD = 'F'
    )PLN_ON
    WHERE
        PERF.CNTR_TPSZ_CD = PLN_ON.CNTR_TPSZ_CD
        AND PERF.FM_ECC_CD 		= PLN_ON.FM_ECC_CD
        AND PERF.TRSP_MOD_CD 	= PLN_ON.TRSP_MOD_CD
        AND PLN_ON.PLN_YRWK IN (${max_capa_4wk})
        #if (${rlatype_5} == '')
            AND 1=1
        #elseif (${rlatype_5} == 'B')
            AND 1=2
        #elseif (${rlatype_5} == 'M')
            AND 1=2
        #elseif (${rlatype_5} == 'A')
            AND 1=1
        #elseif (${rlatype_5} == 'S')
            AND 1=2
        #elseif (${rlatype_5} == 'N')
            AND 1=2
        #elseif (${rlatype_5} == 'P')
            AND 1=2
        #end

    UNION ALL

    -------------------------------------------------------------------------------Low ADHR(INLND)
    SELECT
        PLN_ON.PLN_YRWK PLN_YRWK
        , DIV
        , PLN_ON.ITEM
        , PLN_ON.TRSP_MOD_CD
        , VSL_LANE_CD
        , VVD
        , (
            SELECT
            #if (${fmtoat5} == '1')
                #if (${fmtypeby_5} == 'R')
                    RCC_CD
                #elseif (${fmtypeby_5} == 'C')
                    CNT_CD
                #elseif (${fmtypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM
                EQR_ECC_MST
            WHERE
                PLN_ON.FM_ECC_CD = ECC_CD
        ) FM_ECC_CD
        , (
            SELECT
            #if (${fmtoat5} == '1')
                #if (${totypeby_5} == 'R')
                    RCC_CD
                #elseif (${totypeby_5} == 'C')
                    CNT_CD
                #elseif (${totypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM
                EQR_ECC_MST
            WHERE
                PLN_ON.TO_ECC_CD = ECC_CD
        ) TO_ECC_CD
        , ETD
        , ETA
        , '' TVOL
        , '' TCOST
        , PLN_ON.CNTR_TPSZ_CD
        , PLN_ON.CNTR_QTY
        , PLN_ON.COST_AMT
        , PLN_ON.REPO_PLN_ID
        , '1' SEQ
        , '3' SUBSEQ
        , TABLENM
    FROM
    (
        SELECT
            TRSP_MOD_CD
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
        FROM
        (
            SELECT
            A.YRWK PLN_YRWK
                , A.TRSP_MOD_CD ITEM
                , A.TRSP_MOD_CD
                , (
                    SELECT
                    #if (${fmtoat5} == '1')
                        #if (${fmtypeby_5} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby_5} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM
                        EQR_ECC_MST
                    WHERE
                        A.FM_ECC_CD = ECC_CD
                ) FM_ECC_CD
                , (
                    SELECT
                    #if (${fmtoat5} == '1')
                        #if (${totypeby_5} == 'R')
                            RCC_CD
                        #elseif (${totypeby_5} == 'C')
                            CNT_CD
                        #elseif (${totypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM
                        EQR_ECC_MST
                    WHERE
                        A.TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
                , A.CNTR_TPSZ_CD
                , A.CNTR_QTY
                , '' COST_AMT
                , MON_FREQ_KNT
            FROM
                EQR_EXE_PLN_INLND_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE
                A.YRWK = @[yyyyww]
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND MON_RSN_KNT = 4
        )
    )PERF,
    (
        SELECT
            A.REPO_PLN_ID
            , A.PLN_YRWK
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
            , CNTR_QTY
            , TRSP_COST_AMT COST_AMT
            , FM_YRWK ETD
            , TO_YRWK ETA
            , TRSP_MOD_CD
            , '' VSL_LANE_CD
            , '' VVD
            , 'Plan' DIV
            , TRSP_MOD_CD ITEM
            , 'EQR_INLND_TRSP_PLN' TABLENM
        FROM
            EQR_INLND_TRSP_PLN	A
            , EQR_INLND_TRSP_PLN_QTY B
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrFmEccCd.size() > 0)
                    #if (${fmtype_5} == 'R')
                        AND RCC_CD
                    #elseif (${fmtype_5} == 'L')
                        AND LCC_CD
                    #elseif (${fmtype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrFmEccCd})
                            #if($velocityCount < $arrFmEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) C
                #else
                    ) C
                #end
            #else
                #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if (${attype_5}== 'R')
                        AND RCC_CD
                    #elseif (${attype_5}== 'L')
                        AND LCC_CD
                    #elseif (${attype_5}== 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrAtEccCd})
                            #if($velocityCount < $arrAtEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    ))C
                #end
            #end
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrToEccCd.size() > 0)
                    #if (${totype_5} == 'R')
                        AND RCC_CD
                    #elseif (${totype_5} == 'L')
                        AND LCC_CD
                    #elseif (${totype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrToEccCd})
                            #if($velocityCount < $arrToEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) D
                #else
                    ) D
                #end
            #end
        WHERE
            A.REPO_PLN_ID = B.REPO_PLN_ID
            AND A.PLN_YRWK = B.PLN_YRWK
            AND A.PLN_SEQ = B.PLN_SEQ
            AND A.REPO_PLN_ID = @[repo_pln_Id]
            #if ($arrItem.size() > 0)
                AND TRSP_MOD_CD IN 
                (
                    #foreach ($key in ${arrItem})
                        #if($velocityCount < $arrItem.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            #if (${lane_5} != '')
                AND 1 = 2
            #end
            #if (${vvd_5} != '')
                AND 1 = 2
            #end
            #if (${fmtoat5} == '1')
                AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
            #else
                #if (${attype_5} != '')
                    AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                #end
            #end
            #if ($arrCntrTpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arrCntrTpszCd})
                        #if($velocityCount < $arrCntrTpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            AND A.PLN_YRWK = @[yyyyww]
    )PLN_ON
    WHERE
        PERF.CNTR_TPSZ_CD = PLN_ON.CNTR_TPSZ_CD
        AND PERF.TO_ECC_CD 		= PLN_ON.TO_ECC_CD
        AND PERF.FM_ECC_CD 		= PLN_ON.FM_ECC_CD
        AND PERF.TRSP_MOD_CD 	= PLN_ON.TRSP_MOD_CD
        AND PLN_ON.PLN_YRWK IN (${max_capa_4wk})
        #if (${rlatype_5} == '')
            AND 1=1
        #elseif (${rlatype_5} == 'B')
            AND 1=2
        #elseif (${rlatype_5} == 'M')
            AND 1=2
        #elseif (${rlatype_5} == 'A')
            AND 1=1
        #elseif (${rlatype_5} == 'S')
            AND 1=2
        #elseif (${rlatype_5} == 'N')
            AND 1=2
        #elseif (${rlatype_5} == 'P')
            AND 1=2
        #end

    UNION ALL

    -------------------------------------------------------------------------------Low ADHR(VSL)
    SELECT
        PLN_ON.PLN_YRWK PLN_YRWK
        , DIV
        , PLN_ON.ITEM
        , PLN_ON.TRSP_MOD_CD
        , PLN_ON.VSL_LANE_CD
        , VVD
        , (
            SELECT
            #if (${fmtoat5} == '1')
                #if (${fmtypeby_5} == 'R')
                    RCC_CD
                #elseif (${fmtypeby_5} == 'C')
                    CNT_CD
                #elseif (${fmtypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM
                EQR_ECC_MST
            WHERE
                PLN_ON.FM_ECC_CD = ECC_CD
        ) FM_ECC_CD
        , (
            SELECT
            #if (${fmtoat5} == '1')
                #if (${totypeby_5} == 'R')
                    RCC_CD
                #elseif (${totypeby_5} == 'C')
                    CNT_CD
                #elseif (${totypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM
                EQR_ECC_MST
            WHERE
                PLN_ON.TO_ECC_CD = ECC_CD
        ) TO_ECC_CD
        , ETD
        , ETA
        , '' TVOL
        , '' TCOST
        , PLN_ON.CNTR_TPSZ_CD
        , PLN_ON.CNTR_QTY
        , PLN_ON.COST_AMT
        , PLN_ON.REPO_PLN_ID
        , '1' SEQ
        , '3' SUBSEQ
        , TABLENM
    FROM
    (
        SELECT
            VSL_LANE_CD
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
        FROM
        (
            SELECT
                A.YRWK PLN_YRWK
                , A.VSL_LANE_CD
                , (
                    SELECT
                    #if (${fmtoat5} == '1')
                        #if (${fmtypeby_5} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby_5} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM
                        EQR_ECC_MST
                    WHERE
                        A.FM_ECC_CD = ECC_CD
                ) FM_ECC_CD
                , (
                    SELECT
                    #if (${fmtoat5} == '1')
                        #if (${totypeby_5} == 'R')
                            RCC_CD
                        #elseif (${totypeby_5} == 'C')
                            CNT_CD
                        #elseif (${totypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM
                        EQR_ECC_MST
                    WHERE
                        A.TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
                , A.CNTR_TPSZ_CD
                , A.CNTR_QTY
                , '' COST_AMT
                , MON_FREQ_KNT
            FROM
                EQR_EXE_PLN_VSL_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE
                A.YRWK = @[yyyyww]
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND MON_RSN_KNT = 4
        )
    )PERF,
    (
        SELECT
            A.REPO_PLN_ID
            , A.PLN_YRWK
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
            , CNTR_QTY
            , LODG_DCHG_COST_AMT COST_AMT
            , TO_CHAR(FM_ETD_DT,'YYYY-MM-DD HH24:MI:SS', 'NLS_DATE_LANGUAGE=AMERICAN') ETD
            , TO_CHAR(TO_ETB_DT,'YYYY-MM-DD HH24:MI:SS', 'NLS_DATE_LANGUAGE=AMERICAN') ETA
            , TRSP_MOD_CD
            , VSL_LANE_CD
            , VSL_CD||SKD_VOY_NO||SKD_DIR_CD VVD
            ,'Plan' DIV
            ,TRSP_MOD_CD ITEM
            , 'EQR_VSL_LODG_DCHG_PLN' TABLENM
        FROM
            EQR_VSL_LODG_DCHG_PLN A
            , EQR_VSL_LODG_DCHG_PLN_QTY B
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrFmEccCd.size() > 0)
                    #if (${fmtype_5} == 'R')
                        AND RCC_CD
                    #elseif (${fmtype_5} == 'L')
                        AND LCC_CD
                    #elseif (${fmtype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrFmEccCd})
                            #if($velocityCount < $arrFmEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) C
                #else
                    ) C
                #end
            #else
                #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if (${attype_5}== 'R')
                        AND RCC_CD
                    #elseif (${attype_5}== 'L')
                        AND LCC_CD
                    #elseif (${attype_5}== 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrAtEccCd})
                            #if($velocityCount < $arrAtEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    ))C
                #end
            #end
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrToEccCd.size() > 0)
                    #if (${totype_5} == 'R')
                        AND RCC_CD
                    #elseif (${totype_5} == 'L')
                        AND LCC_CD
                    #elseif (${totype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrToEccCd})
                            #if($velocityCount < $arrToEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) D
                #else
                    ) D
                #end
            #end
        WHERE
            A.REPO_PLN_ID = B.REPO_PLN_ID
            AND A.PLN_YRWK = B.PLN_YRWK
            AND A.PLN_SEQ = B.PLN_SEQ
            AND A.REPO_PLN_ID = @[repo_pln_Id]
            #if ($arrItem.size() > 0)
                AND TRSP_MOD_CD IN 
                (
                    #foreach ($key in ${arrItem})
                        #if($velocityCount < $arrItem.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            #if ($arrIane.size() > 0)
                AND VSL_LANE_CD IN 
                (
                    #foreach ($key in ${arrIane})
                        #if($velocityCount < $arrIane.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            #if ($arrVvd.size() > 0)
                AND VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN 
                (
                    #foreach ($key in ${arrVvd})
                        #if($velocityCount < $arrVvd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            #if (${fmtoat5} == '1')
                AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
            #else
                #if (${attype_5} != '')
                    AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                #end
            #end
            #if ($arrCntrTpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arrCntrTpszCd})
                        #if($velocityCount < $arrCntrTpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            AND A.PLN_YRWK = @[yyyyww]
    )PLN_ON
    WHERE
        PERF.CNTR_TPSZ_CD = PLN_ON.CNTR_TPSZ_CD
        AND PERF.TO_ECC_CD 		= PLN_ON.TO_ECC_CD
        AND PERF.FM_ECC_CD 		= PLN_ON.FM_ECC_CD
        AND PERF.VSL_LANE_CD 	= PLN_ON.VSL_LANE_CD
        AND PLN_ON.PLN_YRWK IN (${max_capa_4wk})
        #if (${rlatype_5} == '')
            AND 1=1
        #elseif (${rlatype_5} == 'B')
            AND 1=2
        #elseif (${rlatype_5} == 'M')
            AND 1=2
        #elseif (${rlatype_5} == 'A')
            AND 1=1
        #elseif (${rlatype_5} == 'S')
            AND 1=2
        #elseif (${rlatype_5} == 'N')
            AND 1=2
        #elseif (${rlatype_5} == 'P')
            AND 1=2
        #end
)T2
GROUP BY
    REPO_PLN_ID, PLN_YRWK, DIV, ITEM, TRSP_MOD_CD, VSL_LANE_CD, VVD
    , FM_ECC_CD, ETD, T2.TO_ECC_CD, ETA, SEQ, TABLENM, SUBSEQ

UNION ALL

---------------------------------------------------------------------------------NO PERF
SELECT
    PLN_YRWK
    , '4No Perf' RLA_TMP
    , SUBSTR('4No Perf',2) RLA_TYPE
    , DIV
    , ITEM
    , VSL_LANE_CD
    , VVD
    , FM_ECC_CD
    , ETD FM_ETD_DT
    , T2.TO_ECC_CD
    , ETA TO_ETA_DT
    , '' TVOL
    #foreach ($key in ${arrCntrTpszCd})
        , SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY
        , SUM(DECODE ( CNTR_TPSZ_CD , '$key' , COST_AMT))     ${key}COST_AMT
    #end
    , REPO_PLN_ID
    , TABLENM
    , TRSP_MOD_CD
    , SUBSEQ
FROM
(
    -------------------------------------------------------------------------------NO PERF(ON-HIRE)
    SELECT
        DISTINCT PERF.PLN_YRWK PLN_YRWK
        , 'Perf' DIV
        , 'O' ITEM
        , PERF.TRSP_MOD_CD
        , '' VSL_LANE_CD
        , '' VVD
        , (
            SELECT
            #if (${fmtoat5} == '1')
                #if (${fmtypeby_5} == 'R')
                    RCC_CD
                #elseif (${fmtypeby_5} == 'C')
                    CNT_CD
                #elseif (${fmtypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM
                EQR_ECC_MST
            WHERE
                PERF.FM_ECC_CD = ECC_CD
        ) FM_ECC_CD
        , (
            SELECT
            #if (${fmtoat5} == '1')
                #if (${totypeby_5} == 'R')
                    RCC_CD
                #elseif (${totypeby_5} == 'C')
                    CNT_CD
                #elseif (${totypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM
                EQR_ECC_MST
            WHERE
                PERF.TO_ECC_CD = ECC_CD
        ) TO_ECC_CD
        , '' ETD
        , '' ETA
        , '' TVOL
        , '' TCOST
        , PERF.CNTR_TPSZ_CD
        , '' CNTR_QTY
        , '' COST_AMT
        , '' REPO_PLN_ID
        , '1' SEQ
        , '1' SUBSEQ
        , 'EQR_ONF_HIR_PLN' TABLENM
    FROM
    (
        SELECT
            TRSP_MOD_CD
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
            , PLN_YRWK
        FROM
        (
            SELECT
                A.YRWK PLN_YRWK
                , 'O' TRSP_MOD_CD
                , A.CNTR_TPSZ_CD
                , (
                    SELECT
                    #if (${fmtoat5} == '1')
                        #if (${fmtypeby_5} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby_5} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM
                        EQR_ECC_MST
                    WHERE
                        A.FM_ECC_CD = ECC_CD
                ) FM_ECC_CD
                , (
                    SELECT
                    #if (${fmtoat5} == '1')
                        #if (${totypeby_5} == 'R')
                            RCC_CD
                        #elseif (${totypeby_5} == 'C')
                            CNT_CD
                        #elseif (${totypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM
                        EQR_ECC_MST
                    WHERE
                        A.TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
            FROM
                EQR_EXE_PLN_ONF_HIR_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE
                A.YRWK = @[yyyyww]
                #if (${item_5} != '')
                    #if (${onHire} == 'Y')
                        AND 1=1
                    #else
                        AND 1=2
                    #end
                #end
                #if (${lane_5} != '')
                    AND 1 = 2
                #end
                #if (${vvd_5} != '')
                    AND 1 = 2
                #end
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND ONF_HIR_DIV_CD = 'O'
                AND MON_FREQ_KNT = 4
        )
    )PERF

    MINUS

    SELECT
        DISTINCT PERF.PLN_YRWK PLN_YRWK
        , 'Perf' DIV
        , PERF.TRSP_MOD_CD ITEM
        , PERF.TRSP_MOD_CD
        , '' VSL_LANE_CD
        , '' VVD
        , (
            SELECT
            #if (${fmtoat5} == '1')
                #if (${fmtypeby_5} == 'R')
                    RCC_CD
                #elseif (${fmtypeby_5} == 'C')
                    CNT_CD
                #elseif (${fmtypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM
                EQR_ECC_MST
            WHERE
                PERF.FM_ECC_CD = ECC_CD
        ) FM_ECC_CD
        , (
            SELECT
            #if (${fmtoat5} == '1')
                #if (${totypeby_5} == 'R')
                    RCC_CD
                #elseif (${totypeby_5} == 'C')
                    CNT_CD
                #elseif (${totypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM
                EQR_ECC_MST
            WHERE
                PERF.TO_ECC_CD = ECC_CD
        ) TO_ECC_CD
        , '' ETD
        , '' ETA
        , '' TVOL
        , '' TCOST
        , PERF.CNTR_TPSZ_CD
        , '' CNTR_QTY
        , '' COST_AMT
        , '' REPO_PLN_ID
        , '1' SEQ
        , '1' SUBSEQ
        , 'EQR_ONF_HIR_PLN' TABLENM
    FROM
    (
        SELECT
            TRSP_MOD_CD
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
            , PLN_YRWK
        FROM
        (
            SELECT
                A.YRWK PLN_YRWK
                , 'O' TRSP_MOD_CD
                , A.CNTR_TPSZ_CD
                , (
                    SELECT
                    #if (${fmtoat5} == '1')
                        #if (${fmtypeby_5} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby_5} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM
                        EQR_ECC_MST
                    WHERE
                        A.FM_ECC_CD = ECC_CD
                ) FM_ECC_CD
                , (
                    SELECT
                    #if (${fmtoat5} == '1')
                        #if (${totypeby_5} == 'R')
                            RCC_CD
                        #elseif (${totypeby_5} == 'C')
                            CNT_CD
                        #elseif (${totypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM
                        EQR_ECC_MST
                    WHERE
                        A.TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
            FROM
                EQR_EXE_PLN_ONF_HIR_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE
                A.YRWK = @[yyyyww]
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND ONF_HIR_DIV_CD = 'O'
                AND MON_FREQ_KNT = 4
        )
    )PERF,
    (
        SELECT
            A.REPO_PLN_ID
            , A.PLN_YRWK
            , '' FM_ECC_CD
            , A.ECC_CD TO_ECC_CD
            , CNTR_TPSZ_CD
            , 'O' TRSP_MOD_CD
        FROM
            EQR_ONF_HIR_PLN	A
            , EQR_ONF_HIR_PLN_QTY B
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrFmEccCd.size() > 0)
                    #if (${fmtype_5} == 'R')
                        AND RCC_CD
                    #elseif (${fmtype_5} == 'L')
                        AND LCC_CD
                    #elseif (${fmtype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrFmEccCd})
                            #if($velocityCount < $arrFmEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) C
                #else
                    ) C
                #end
            #else
                #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if (${attype_5}== 'R')
                        AND RCC_CD
                    #elseif (${attype_5}== 'L')
                        AND LCC_CD
                    #elseif (${attype_5}== 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrAtEccCd})
                            #if($velocityCount < $arrAtEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    ))C
                #end
            #end
        WHERE
            A.REPO_PLN_ID = B.REPO_PLN_ID
            AND A.PLN_YRWK = B.PLN_YRWK
            AND A.PLN_SEQ = B.PLN_SEQ
            AND A.REPO_PLN_ID = @[repo_pln_Id]
            #if (${item_5} != '')
                #if (${onHire} == 'Y')
                    AND 1=1
                #else
                    AND 1=2
                #end
            #end
            #if (${lane_5} != '')
                AND 1 = 2
            #end
            #if (${vvd_5} != '')
                AND 1 = 2
            #end
            #if (${fmtoat5} == '1')
                AND A.ECC_CD = C.ECC_CD
            #else
                #if (${attype_5} != '')
                    AND A.ECC_CD = C.ECC_CD
                #end
            #end
            #if ($arrCntrTpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arrCntrTpszCd})
                        #if($velocityCount < $arrCntrTpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            AND ONF_HIR_DIV_CD = 'O'
    )PLN_ON
    WHERE
        PERF.CNTR_TPSZ_CD = PLN_ON.CNTR_TPSZ_CD
        AND PERF.TO_ECC_CD 		= PLN_ON.TO_ECC_CD
        AND PERF.TRSP_MOD_CD 	= PLN_ON.TRSP_MOD_CD
        AND PLN_ON.PLN_YRWK IN (${max_capa_4wk})

    UNION ALL

    -------------------------------------------------------------------------------NO PERF(OFF-HIRE)
    SELECT	
        DISTINCT PERF.PLN_YRWK PLN_YRWK
        , 'Perf' DIV
        , 'F' ITEM
        , PERF.TRSP_MOD_CD
        , '' VSL_LANE_CD
        , '' VVD
        , (
            SELECT 
            #if (${fmtoat5} == '1')
                #if (${fmtypeby_5} == 'R')
                    RCC_CD
                #elseif (${fmtypeby_5} == 'C')
                    CNT_CD
                #elseif (${fmtypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM 
                EQR_ECC_MST 
            WHERE 
                PERF.FM_ECC_CD = ECC_CD
        ) FM_ECC_CD
        , (
            SELECT 
            #if (${fmtoat5} == '1')
                #if (${totypeby_5} == 'R')
                    RCC_CD
                #elseif (${totypeby_5} == 'C')
                    CNT_CD
                #elseif (${totypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM 
                EQR_ECC_MST 
            WHERE 
                PERF.TO_ECC_CD = ECC_CD
        ) TO_ECC_CD
        , '' ETD
        , '' ETA
        , '' TVOL
        , '' TCOST
        , PERF.CNTR_TPSZ_CD
        , '' CNTR_QTY
        , '' COST_AMT
        , '' REPO_PLN_ID
        , '1' SEQ
        , '2' SUBSEQ
        , 'EQR_ONF_HIR_PLN' TABLENM
    FROM
    (
        SELECT 
            TRSP_MOD_CD
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
            , PLN_YRWK
        FROM
        (
            SELECT 
                A.YRWK PLN_YRWK
                , 'F' TRSP_MOD_CD
                , A.CNTR_TPSZ_CD
                , (
                    SELECT 
                    #if (${fmtoat5} == '1')
                        #if (${fmtypeby_5} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby_5} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM 
                        EQR_ECC_MST 
                    WHERE 
                        A.FM_ECC_CD = ECC_CD
                ) FM_ECC_CD
                , (
                    SELECT 
                    #if (${fmtoat5} == '1')
                        #if (${totypeby_5} == 'R')
                            RCC_CD
                        #elseif (${totypeby_5} == 'C')
                            CNT_CD
                        #elseif (${totypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM 
                        EQR_ECC_MST 
                    WHERE 
                        A.TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
            FROM 
                EQR_EXE_PLN_ONF_HIR_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE 
                A.YRWK = @[yyyyww]
                #if (${item_5} != '')
                    #if (${offHire} == 'Y')
                        AND 1=1
                    #else
                        AND 1=2
                    #end
                #end
                #if (${lane_5} != '')
                    AND 1 = 2
                #end
                #if (${vvd_5} != '')
                    AND 1 = 2
                #end
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND ONF_HIR_DIV_CD = 'F'
                AND MON_FREQ_KNT = 4
        )
    )PERF
    
    MINUS
    
    SELECT	
        DISTINCT PERF.PLN_YRWK PLN_YRWK
        , 'Perf' DIV
        , PERF.TRSP_MOD_CD ITEM
        , PERF.TRSP_MOD_CD
        , '' VSL_LANE_CD
        , '' VVD
        , (
            SELECT 
            #if (${fmtoat5} == '1')
                #if (${fmtypeby_5} == 'R')
                    RCC_CD
                #elseif (${fmtypeby_5} == 'C')
                    CNT_CD
                #elseif (${fmtypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM 
                EQR_ECC_MST 
            WHERE 
                PERF.FM_ECC_CD = ECC_CD
        ) FM_ECC_CD
        , (
            SELECT 
            #if (${fmtoat5} == '1')
                #if (${totypeby_5} == 'R')
                    RCC_CD
                #elseif (${totypeby_5} == 'C')
                    CNT_CD
                #elseif (${totypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM 
                EQR_ECC_MST 
            WHERE 
                PERF.TO_ECC_CD = ECC_CD
        ) TO_ECC_CD
        , '' ETD
        , '' ETA
        , '' TVOL
        , '' TCOST
        , PERF.CNTR_TPSZ_CD
        , '' CNTR_QTY
        , '' COST_AMT
        , '' REPO_PLN_ID
        , '1' SEQ
        , '2' SUBSEQ
        , 'EQR_ONF_HIR_PLN' TABLENM
    FROM
    (
        SELECT 
            TRSP_MOD_CD
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
            , PLN_YRWK
        FROM
        (
            SELECT 
                A.YRWK PLN_YRWK
                , 'F' TRSP_MOD_CD
                , A.CNTR_TPSZ_CD
                , (
                    SELECT 
                    #if (${fmtoat5} == '1')
                        #if (${fmtypeby_5} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby_5} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM 
                        EQR_ECC_MST 
                    WHERE 
                        A.FM_ECC_CD = ECC_CD
                ) FM_ECC_CD
                , (
                    SELECT 
                    #if (${fmtoat5} == '1')
                        #if (${totypeby_5} == 'R')
                            RCC_CD
                        #elseif (${totypeby_5} == 'C')
                            CNT_CD
                        #elseif (${totypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM 
                        EQR_ECC_MST 
                    WHERE 
                        A.TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
            FROM 
                EQR_EXE_PLN_ONF_HIR_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE 
                A.YRWK = @[yyyyww]
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND ONF_HIR_DIV_CD = 'F'
                AND MON_FREQ_KNT = 4
        )
    )PERF,
    (
        SELECT 
            A.REPO_PLN_ID
            , A.PLN_YRWK
            , A.ECC_CD FM_ECC_CD
            , '' TO_ECC_CD
            , CNTR_TPSZ_CD
            , 'F' TRSP_MOD_CD
        FROM 
            EQR_ONF_HIR_PLN	A
            , EQR_ONF_HIR_PLN_QTY B
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrFmEccCd.size() > 0)
                    #if (${fmtype_5} == 'R')
                        AND RCC_CD
                    #elseif (${fmtype_5} == 'L')
                        AND LCC_CD
                    #elseif (${fmtype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrFmEccCd})
                            #if($velocityCount < $arrFmEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) C
                #else
                    ) C
                #end
            #else
                #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if (${attype_5}== 'R')
                        AND RCC_CD
                    #elseif (${attype_5}== 'L')
                        AND LCC_CD
                    #elseif (${attype_5}== 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrAtEccCd})
                            #if($velocityCount < $arrAtEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    ))C
                #end
            #end
        WHERE 
            A.REPO_PLN_ID = B.REPO_PLN_ID
            AND A.PLN_YRWK = B.PLN_YRWK
            AND A.PLN_SEQ = B.PLN_SEQ
            AND A.REPO_PLN_ID = @[repo_pln_Id]
            #if (${item_5} != '')
                #if (${offHire} == 'Y')
                    AND 1=1
                #else
                    AND 1=2
                #end
            #end
            #if (${lane_5} != '')
                AND 1 = 2
            #end
            #if (${vvd_5} != '')
                AND 1 = 2
            #end
            #if (${fmtoat5} == '1')
                AND A.ECC_CD = C.ECC_CD
            #else
                #if (${attype_5} != '')
                    AND A.ECC_CD = C.ECC_CD
                #end
            #end
            #if ($arrCntrTpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arrCntrTpszCd})
                        #if($velocityCount < $arrCntrTpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            AND ONF_HIR_DIV_CD = 'F'
    )PLN_ON
    WHERE 
        PERF.CNTR_TPSZ_CD = PLN_ON.CNTR_TPSZ_CD
        AND PERF.FM_ECC_CD 		= PLN_ON.FM_ECC_CD
        AND PERF.TRSP_MOD_CD 	= PLN_ON.TRSP_MOD_CD
        AND PLN_ON.PLN_YRWK IN (${max_capa_4wk})
        
    UNION ALL
    
    -------------------------------------------------------------------------------NO PERF(INLND)
    SELECT	
        DISTINCT PERF.PLN_YRWK PLN_YRWK
        , 'Perf' DIV
        , PERF.TRSP_MOD_CD ITEM
        , PERF.TRSP_MOD_CD
        , '' VSL_LANE_CD
        , '' VVD
        , (
            SELECT 
            #if (${fmtoat5} == '1')
                #if (${fmtypeby_5} == 'R')
                    RCC_CD
                #elseif (${fmtypeby_5} == 'C')
                    CNT_CD
                #elseif (${fmtypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM 
                EQR_ECC_MST 
            WHERE 
                PERF.FM_ECC_CD = ECC_CD
        ) FM_ECC_CD
        , (
            SELECT 
            #if (${fmtoat5} == '1')
                #if (${totypeby_5} == 'R')
                    RCC_CD
                #elseif (${totypeby_5} == 'C')
                    CNT_CD
                #elseif (${totypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM 
                EQR_ECC_MST 
            WHERE 
                PERF.TO_ECC_CD = ECC_CD
        ) TO_ECC_CD
        , '' ETD
        , '' ETA
        , '' TVOL
        , '' TCOST
        , PERF.CNTR_TPSZ_CD
        , '' CNTR_QTY
        , '' COST_AMT
        , '' REPO_PLN_ID
        , '1' SEQ
        , '3' SUBSEQ
        , 'EQR_INLND_TRSP_PLN' TABLENM
    FROM
    (
        SELECT 
            TRSP_MOD_CD
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
            , PLN_YRWK
        FROM
        (
            SELECT 
                A.YRWK PLN_YRWK
                , A.TRSP_MOD_CD
                , A.CNTR_TPSZ_CD
                , (
                    SELECT 
                    #if (${fmtoat5} == '1')
                        #if (${fmtypeby_5} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby_5} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM 
                        EQR_ECC_MST 
                    WHERE 
                        A.FM_ECC_CD = ECC_CD
                ) FM_ECC_CD
                , (
                    SELECT 
                    #if (${fmtoat5} == '1')
                        #if (${totypeby_5} == 'R')
                            RCC_CD
                        #elseif (${totypeby_5} == 'C')
                            CNT_CD
                        #elseif (${totypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM 
                        EQR_ECC_MST 
                    WHERE 
                        A.TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
            FROM 
                EQR_EXE_PLN_INLND_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE 
                A.YRWK = @[yyyyww]
                #if ($arrItem.size() > 0)
                    AND TRSP_MOD_CD IN 
                    (
                        #foreach ($key in ${arrItem})
                            #if($velocityCount < $arrItem.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND MON_FREQ_KNT = 4
        )
    )PERF
    
    MINUS
    
    SELECT	
        DISTINCT PERF.PLN_YRWK PLN_YRWK
        , 'Perf' DIV
        , PERF.TRSP_MOD_CD ITEM
        , PERF.TRSP_MOD_CD
        , '' VSL_LANE_CD
        , '' VVD
        , (
            SELECT 
            #if (${fmtoat5} == '1')
                #if (${fmtypeby_5} == 'R')
                    RCC_CD
                #elseif (${fmtypeby_5} == 'C')
                    CNT_CD
                #elseif (${fmtypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM 
                EQR_ECC_MST 
            WHERE 
                PERF.FM_ECC_CD = ECC_CD
        ) FM_ECC_CD
        , (
            SELECT 
            #if (${fmtoat5} == '1')
                #if (${totypeby_5} == 'R')
                    RCC_CD
                #elseif (${totypeby_5} == 'C')
                    CNT_CD
                #elseif (${totypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM 
                EQR_ECC_MST 
            WHERE 
                PERF.TO_ECC_CD = ECC_CD
        ) TO_ECC_CD
        , '' ETD
        , '' ETA
        , '' TVOL
        , '' TCOST
        , PERF.CNTR_TPSZ_CD
        , '' CNTR_QTY
        , '' COST_AMT
        , '' REPO_PLN_ID
        , '1' SEQ
        , '3' SUBSEQ
        , 'EQR_INLND_TRSP_PLN' TABLENM
    FROM
    (
        SELECT 
            TRSP_MOD_CD
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
            , PLN_YRWK
        FROM
        (
            SELECT 
                A.YRWK PLN_YRWK
                , A.TRSP_MOD_CD
                , A.CNTR_TPSZ_CD
                , (
                    SELECT 
                    #if (${fmtoat5} == '1')
                        #if (${fmtypeby_5} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby_5} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM 
                        EQR_ECC_MST 
                    WHERE 
                        A.FM_ECC_CD = ECC_CD
                ) FM_ECC_CD
                , (
                    SELECT 
                    #if (${fmtoat5} == '1')
                        #if (${totypeby_5} == 'R')
                            RCC_CD
                        #elseif (${totypeby_5} == 'C')
                            CNT_CD
                        #elseif (${totypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM 
                        EQR_ECC_MST 
                    WHERE 
                        A.TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
            FROM 
                EQR_EXE_PLN_INLND_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE 
                A.YRWK = @[yyyyww]
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND MON_FREQ_KNT = 4
        )
    )PERF,
    (
        SELECT 
            A.REPO_PLN_ID
            , A.PLN_YRWK
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
            , TRSP_MOD_CD
        FROM 
            EQR_INLND_TRSP_PLN	A
            , EQR_INLND_TRSP_PLN_QTY B
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrFmEccCd.size() > 0)
                    #if (${fmtype_5} == 'R')
                        AND RCC_CD
                    #elseif (${fmtype_5} == 'L')
                        AND LCC_CD
                    #elseif (${fmtype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrFmEccCd})
                            #if($velocityCount < $arrFmEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) C
                #else
                    ) C
                #end
            #else
                #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if (${attype_5}== 'R')
                        AND RCC_CD
                    #elseif (${attype_5}== 'L')
                        AND LCC_CD
                    #elseif (${attype_5}== 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrAtEccCd})
                            #if($velocityCount < $arrAtEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    ))C
                #end
            #end
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrToEccCd.size() > 0)
                    #if (${totype_5} == 'R')
                        AND RCC_CD
                    #elseif (${totype_5} == 'L')
                        AND LCC_CD
                    #elseif (${totype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrToEccCd})
                            #if($velocityCount < $arrToEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) D
                #else
                    ) D
                #end
            #end
        WHERE 
            A.REPO_PLN_ID = B.REPO_PLN_ID
            AND A.PLN_YRWK = B.PLN_YRWK
            AND A.PLN_SEQ = B.PLN_SEQ
            AND A.REPO_PLN_ID = @[repo_pln_Id]
            #if ($arrItem.size() > 0)
                AND TRSP_MOD_CD IN 
                (
                    #foreach ($key in ${arrItem})
                        #if($velocityCount < $arrItem.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            #if (${lane_5} != '')
                AND 1 = 2
            #end
            #if (${vvd_5} != '')
                AND 1 = 2
            #end
            #if (${fmtoat5} == '1')
                AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
            #else
                #if (${attype_5} != '')
                    AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                #end
            #end
            #if ($arrCntrTpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arrCntrTpszCd})
                        #if($velocityCount < $arrCntrTpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
    )PLN_ON
    WHERE 
        PERF.CNTR_TPSZ_CD = PLN_ON.CNTR_TPSZ_CD
        AND PERF.TO_ECC_CD 		= PLN_ON.TO_ECC_CD
        AND PERF.FM_ECC_CD 		= PLN_ON.FM_ECC_CD
        AND PERF.TRSP_MOD_CD 	= PLN_ON.TRSP_MOD_CD
        AND PLN_ON.PLN_YRWK IN (${max_capa_4wk})
        
    UNION ALL
    
    -------------------------------------------------------------------------------NO PERF(VSL)
    SELECT	
        DISTINCT PERF.PLN_YRWK PLN_YRWK
        , 'Perf' DIV
        , 'V' ITEM
        , '' TRSP_MOD_CD
        , PERF.VSL_LANE_CD
        , '' VVD
        , (
            SELECT 
            #if (${fmtoat5} == '1')
                #if (${fmtypeby_5} == 'R')
                    RCC_CD
                #elseif (${fmtypeby_5} == 'C')
                    CNT_CD
                #elseif (${fmtypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM 
                EQR_ECC_MST 
            WHERE 
                PERF.FM_ECC_CD = ECC_CD
        ) FM_ECC_CD
        , (
            SELECT 
            #if (${fmtoat5} == '1')
                #if (${totypeby_5} == 'R')
                    RCC_CD
                #elseif (${totypeby_5} == 'C')
                    CNT_CD
                #elseif (${totypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM 
                EQR_ECC_MST 
            WHERE 
                PERF.TO_ECC_CD = ECC_CD
        ) TO_ECC_CD
        , '' ETD
        , '' ETA
        , '' TVOL
        , '' TCOST
        , PERF.CNTR_TPSZ_CD
        , '' CNTR_QTY
        , '' COST_AMT
        , '' REPO_PLN_ID
        , '1' SEQ
        , '3' SUBSEQ
        , 'EQR_VSL_LODG_DCHG_PLN' TABLENM
    FROM
    (
        SELECT 
            VSL_LANE_CD
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
            , PLN_YRWK
        FROM
        (
            SELECT 
                A.YRWK PLN_YRWK
                , A.VSL_LANE_CD
                , A.CNTR_TPSZ_CD
                , (
                    SELECT 
                    #if (${fmtoat5} == '1')
                        #if (${fmtypeby_5} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby_5} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM 
                        EQR_ECC_MST 
                    WHERE 
                        A.FM_ECC_CD = ECC_CD
                ) FM_ECC_CD
                , (
                    SELECT 
                    #if (${fmtoat5} == '1')
                        #if (${totypeby_5} == 'R')
                            RCC_CD
                        #elseif (${totypeby_5} == 'C')
                            CNT_CD
                        #elseif (${totypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM 
                        EQR_ECC_MST 
                    WHERE 
                        A.TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
            FROM 
                EQR_EXE_PLN_VSL_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE 
                A.YRWK = @[yyyyww]
                #if (${item_5} != '')
                    #if (${vsl} == 'Y')
                        AND 1=1
                    #else
                        AND 1=2
                    #end
                #end
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND MON_FREQ_KNT = 2
        )
    )PERF
    
    MINUS
    
    SELECT	
        DISTINCT PERF.PLN_YRWK PLN_YRWK
        , 'Perf' DIV
        , 'V' ITEM
        , '' TRSP_MOD_CD
        , PERF.VSL_LANE_CD
        , '' VVD
        , (
            SELECT 
            #if (${fmtoat5} == '1')
                #if (${fmtypeby_5} == 'R')
                    RCC_CD
                #elseif (${fmtypeby_5} == 'C')
                    CNT_CD
                #elseif (${fmtypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM 
                EQR_ECC_MST 
            WHERE 
                PERF.FM_ECC_CD = ECC_CD
        ) FM_ECC_CD
        , (
            SELECT 
            #if (${fmtoat5} == '1')
                #if (${totypeby_5} == 'R')
                    RCC_CD
                #elseif (${totypeby_5} == 'C')
                    CNT_CD
                #elseif (${totypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #else
                #if (${attypeby_5} == 'R')
                    RCC_CD
                #elseif (${attypeby_5} == 'C')
                    CNT_CD
                #elseif (${attypeby_5} == 'L')
                    LCC_CD
                #else
                    ECC_CD
                #end
            #end
            FROM 
                EQR_ECC_MST 
            WHERE 
                PERF.TO_ECC_CD = ECC_CD
        ) TO_ECC_CD
        , '' ETD
        , '' ETA
        , '' TVOL
        , '' TCOST
        , PERF.CNTR_TPSZ_CD
        , '' CNTR_QTY
        , '' COST_AMT
        , '' REPO_PLN_ID
        , '1' SEQ
        , '3' SUBSEQ
        , 'EQR_VSL_LODG_DCHG_PLN' TABLENM
    FROM
    (
        SELECT 
            VSL_LANE_CD
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
            , PLN_YRWK
        FROM
        (
            SELECT 
                A.YRWK PLN_YRWK
                , A.VSL_LANE_CD
                , A.CNTR_TPSZ_CD
                , (
                    SELECT 
                    #if (${fmtoat5} == '1')
                        #if (${fmtypeby_5} == 'R')
                            RCC_CD
                        #elseif (${fmtypeby_5} == 'C')
                            CNT_CD
                        #elseif (${fmtypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM 
                        EQR_ECC_MST 
                    WHERE 
                        A.FM_ECC_CD = ECC_CD
                ) FM_ECC_CD
                , (
                    SELECT 
                    #if (${fmtoat5} == '1')
                        #if (${totypeby_5} == 'R')
                            RCC_CD
                        #elseif (${totypeby_5} == 'C')
                            CNT_CD
                        #elseif (${totypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #else
                        #if (${attypeby_5} == 'R')
                            RCC_CD
                        #elseif (${attypeby_5} == 'C')
                            CNT_CD
                        #elseif (${attypeby_5} == 'L')
                            LCC_CD
                        #else
                            ECC_CD
                        #end
                    #end
                    FROM 
                        EQR_ECC_MST 
                    WHERE 
                        A.TO_ECC_CD = ECC_CD
                ) TO_ECC_CD
            FROM 
                EQR_EXE_PLN_VSL_PERF A
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE 
                A.YRWK = @[yyyyww]
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND MON_FREQ_KNT = 2
        )
    )PERF,
    (
        SELECT 
            A.REPO_PLN_ID
            , A.PLN_YRWK
            , FM_ECC_CD
            , TO_ECC_CD
            , CNTR_TPSZ_CD
            , VSL_LANE_CD
        FROM 
            EQR_VSL_LODG_DCHG_PLN	A
            , EQR_VSL_LODG_DCHG_PLN_QTY B
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrFmEccCd.size() > 0)
                    #if (${fmtype_5} == 'R')
                        AND RCC_CD
                    #elseif (${fmtype_5} == 'L')
                        AND LCC_CD
                    #elseif (${fmtype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrFmEccCd})
                            #if($velocityCount < $arrFmEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) C
                #else
                    ) C
                #end
            #else
                #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if (${attype_5}== 'R')
                        AND RCC_CD
                    #elseif (${attype_5}== 'L')
                        AND LCC_CD
                    #elseif (${attype_5}== 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrAtEccCd})
                            #if($velocityCount < $arrAtEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    ))C
                #end
            #end
            #if (${fmtoat5} == '1')
                , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                #if ($arrToEccCd.size() > 0)
                    #if (${totype_5} == 'R')
                        AND RCC_CD
                    #elseif (${totype_5} == 'L')
                        AND LCC_CD
                    #elseif (${totype_5} == 'E')
                        AND ECC_CD
                    #end
                    IN(
                        #foreach ($key in ${arrToEccCd})
                            #if($velocityCount < $arrToEccCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )) D
                #else
                    ) D
                #end
            #end
        WHERE 
            A.REPO_PLN_ID = B.REPO_PLN_ID
            AND A.PLN_YRWK = B.PLN_YRWK
            AND A.PLN_SEQ = B.PLN_SEQ
            AND A.REPO_PLN_ID = @[repo_pln_Id]
            #if ($arrItem.size() > 0)
                AND TRSP_MOD_CD IN 
                (
                    #foreach ($key in ${arrItem})
                        #if($velocityCount < $arrItem.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            #if ($arrIane.size() > 0)
                AND VSL_LANE_CD IN 
                (
                    #foreach ($key in ${arrIane})
                        #if($velocityCount < $arrIane.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            #if ($arrVvd.size() > 0)
                AND VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN 
                (
                    #foreach ($key in ${arrVvd})
                        #if($velocityCount < $arrVvd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
            #if (${fmtoat5} == '1')
                AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
            #else
                #if (${attype_5} != '')
                    AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                #end
            #end
            #if ($arrCntrTpszCd.size() > 0)
                AND CNTR_TPSZ_CD IN(
                    #foreach ($key in ${arrCntrTpszCd})
                        #if($velocityCount < $arrCntrTpszCd.size())
                        '$key',
                        #else
                        '$key'
                        #end
                    #end
                )
            #end
    )PLN_ON
    WHERE 
        PERF.CNTR_TPSZ_CD = PLN_ON.CNTR_TPSZ_CD
        AND PERF.TO_ECC_CD 		= PLN_ON.TO_ECC_CD
        AND PERF.FM_ECC_CD 		= PLN_ON.FM_ECC_CD
        AND PERF.VSL_LANE_CD 	= PLN_ON.VSL_LANE_CD
        AND PLN_ON.PLN_YRWK IN (${max_capa_4wk})
)T2
#if (${rlatype_5} == '')
    WHERE 1=1
#elseif (${rlatype_5} == 'B')
    WHERE 1=2
#elseif (${rlatype_5} == 'M')
    WHERE 1=2
#elseif (${rlatype_5} == 'A')
    WHERE 1=2
#elseif (${rlatype_5} == 'S')
    WHERE 1=2
#elseif (${rlatype_5} == 'N')
    WHERE 1=1
#elseif (${rlatype_5} == 'P')
    WHERE 1=2
#end
GROUP BY 
    REPO_PLN_ID, PLN_YRWK, DIV, ITEM, TRSP_MOD_CD, VSL_LANE_CD, VVD
    , FM_ECC_CD, ETD, T2.TO_ECC_CD, ETA, SEQ, TABLENM, SUBSEQ
    
UNION ALL

---------------------------------------------------------------------------------NEW PERF
SELECT 
    PLN_YRWK
    , '5New Perf' RLA_TMP
    , SUBSTR('5New Perf',2) RLA_TYPE
    , DIV
    , ITEM
    , VSL_LANE_CD
    , VVD
    , FM_ECC_CD
    , ETD FM_ETD_DT
    , T2.TO_ECC_CD
    , ETA TO_ETA_DT
    , '' TVOL
    #foreach ($key in ${arrCntrTpszCd})
        , SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY
        , SUM(DECODE ( CNTR_TPSZ_CD , '$key' , COST_AMT))     ${key}COST_AMT
    #end
    , REPO_PLN_ID
    , TABLENM
    , TRSP_MOD_CD
    , SUBSEQ
FROM
(
    -------------------------------------------------------------------------------NEW PERF(ON-HIRE)
    SELECT 
        BB.PLN_YRWK
        , AA.DIV
        , AA.ITEM ITEM
        , AA.TRSP_MOD_CD
        , '' VSL_LANE_CD
        , '' VVD 
        , '' FM_ECC_CD 
        , BB.ECC_CD TO_ECC_CD
        , '' ETD
        , '' ETA
        , '' TVOL
        , '' TCOST
        , CC.CNTR_TPSZ_CD
        , CC.CNTR_QTY
        , CC.ONF_HIR_COST_AMT COST_AMT
        , BB.REPO_PLN_ID
        , '1' SEQ
        , '1' SUBSEQ
        , 'EQR_ONF_HIR_PLN' TABLENM
    FROM
    (
        --내부값 START----------.
            SELECT	
            DISTINCT PLN_ON.PLN_YRWK PLN_YRWK
            , 'Plan' DIV
            , PLN_ON.TRSP_MOD_CD ITEM
            , PLN_ON.TRSP_MOD_CD
            , '' VSL_LANE_CD
            , '' VVD
            , PLN_ON.FM_ECC_CD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${totypeby_5} == 'R')
                        RCC_CD
                    #elseif (${totypeby_5} == 'C')
                        CNT_CD
                    #elseif (${totypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.TO_ECC_CD = ECC_CD
            ) TO_ECC_CD
            , '' ETD
            , '' ETA
            , '' TVOL
            , '' TCOST
            , PLN_ON.CNTR_TPSZ_CD
            , '' CNTR_QTY
            , '' COST_AMT
            , '' REPO_PLN_ID
            , '1' SEQ
            , '1' SUBSEQ
            , 'EQR_ONF_HIR_PLN' TABLENM
        FROM
        (
            SELECT 
                PLN_YRWK
                , FM_ECC_CD
                , TO_ECC_CD
                , CNTR_TPSZ_CD
                , TRSP_MOD_CD
            FROM
            (
                SELECT 
                    A.PLN_YRWK
                    , 'O' TRSP_MOD_CD,
                     B.CNTR_TPSZ_CD
                    , '' FM_ECC_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${totypeby_5} == 'R')
                                RCC_CD
                            #elseif (${totypeby_5} == 'C')
                                CNT_CD
                            #elseif (${totypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.ECC_CD = ECC_CD
                    ) TO_ECC_CD
                FROM 
                    EQR_ONF_HIR_PLN A
                    , EQR_ONF_HIR_PLN_QTY B
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrFmEccCd.size() > 0)
                            #if (${fmtype_5} == 'R')
                                AND RCC_CD
                            #elseif (${fmtype_5} == 'L')
                                AND LCC_CD
                            #elseif (${fmtype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrFmEccCd})
                                    #if($velocityCount < $arrFmEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) C
                        #else
                            ) C
                        #end
                    #else
                        #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                            , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                            #if (${attype_5}== 'R')
                                AND RCC_CD
                            #elseif (${attype_5}== 'L')
                                AND LCC_CD
                            #elseif (${attype_5}== 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrAtEccCd})
                                    #if($velocityCount < $arrAtEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            ))C
                        #end
                    #end
                WHERE 
                    A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.PLN_YRWK = B.PLN_YRWK
                    AND A.PLN_SEQ = B.PLN_SEQ
                    AND A.REPO_PLN_ID = @[repo_pln_Id]
                    #if (${item_5} != '')
                        #if (${onHire} == 'Y')
                            AND 1=1
                        #else
                            AND 1=2
                        #end
                    #end
                    #if (${lane_5} != '')
                        AND 1 = 2
                    #end
                    #if (${vvd_5} != '')
                        AND 1 = 2
                    #end
                    #if (${fmtoat5} == '1')
                        AND A.ECC_CD = C.ECC_CD
                    #else
                        #if (${attype_5} != '')
                            AND A.ECC_CD = C.ECC_CD
                        #end
                    #end
                    #if ($arrCntrTpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arrCntrTpszCd})
                                #if($velocityCount < $arrCntrTpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )
                    #end
                    AND ONF_HIR_DIV_CD = 'O'
                    AND A.PLN_YRWK IN (${max_capa_4wk})
            )
        )PLN_ON
        
        MINUS
        
        SELECT	
            DISTINCT PLN_ON.PLN_YRWK PLN_YRWK
            , 'Plan' DIV
            , PERF.TRSP_MOD_CD ITEM
            , PERF.TRSP_MOD_CD
            , '' VSL_LANE_CD
            , '' VVD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${fmtypeby_5} == 'R')
                        RCC_CD
                    #elseif (${fmtypeby_5} == 'C')
                        CNT_CD
                    #elseif (${fmtypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.FM_ECC_CD = ECC_CD
            ) FM_ECC_CD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${totypeby_5} == 'R')
                        RCC_CD
                    #elseif (${totypeby_5} == 'C')
                        CNT_CD
                    #elseif (${totypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.TO_ECC_CD = ECC_CD
            ) TO_ECC_CD
            , '' ETD
            , '' ETA
            , '' TVOL
            , '' TCOST
            , PLN_ON.CNTR_TPSZ_CD
            , '' CNTR_QTY
            , '' COST_AMT
            , '' REPO_PLN_ID
            , '1' SEQ
            , '1' SUBSEQ
            , 'EQR_ONF_HIR_PLN' TABLENM
        FROM
        (
            SELECT 
                F.TRSP_MOD_CD
                , F.FM_ECC_CD
                , F.TO_ECC_CD
                , F.CNTR_TPSZ_CD
                , F.PLN_YRWK
            FROM
            (
                SELECT 
                    A.YRWK PLN_YRWK
                    , 'O' TRSP_MOD_CD
                    , A.CNTR_TPSZ_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${fmtypeby_5} == 'R')
                                RCC_CD
                            #elseif (${fmtypeby_5} == 'C')
                                CNT_CD
                            #elseif (${fmtypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${totypeby_5} == 'R')
                                RCC_CD
                            #elseif (${totypeby_5} == 'C')
                                CNT_CD
                            #elseif (${totypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                FROM 
                    EQR_EXE_PLN_ONF_HIR_PERF A
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrFmEccCd.size() > 0)
                            #if (${fmtype_5} == 'R')
                                AND RCC_CD
                            #elseif (${fmtype_5} == 'L')
                                AND LCC_CD
                            #elseif (${fmtype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrFmEccCd})
                                    #if($velocityCount < $arrFmEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) C
                        #else
                            ) C
                        #end
                    #else
                        #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                            , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                            #if (${attype_5}== 'R')
                                AND RCC_CD
                            #elseif (${attype_5}== 'L')
                                AND LCC_CD
                            #elseif (${attype_5}== 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrAtEccCd})
                                    #if($velocityCount < $arrAtEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            ))C
                        #end
                    #end
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrToEccCd.size() > 0)
                            #if (${totype_5} == 'R')
                                AND RCC_CD
                            #elseif (${totype_5} == 'L')
                                AND LCC_CD
                            #elseif (${totype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrToEccCd})
                                    #if($velocityCount < $arrToEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) D
                        #else
                            ) D
                        #end
                    #end
                WHERE 
                    A.YRWK = @[yyyyww]
                    #if (${fmtoat5} == '1')
                        AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                    #else
                        #if (${attype_5} != '')
                            AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                        #end
                    #end
                    #if ($arrCntrTpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arrCntrTpszCd})
                                #if($velocityCount < $arrCntrTpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )
                    #end
                    AND ONF_HIR_DIV_CD = 'O'
                    AND MON_FREQ_KNT = 4
            )F
        )PERF,
        (
            SELECT 
                A.PLN_YRWK
                , '' FM_ECC_CD
                , A.ECC_CD TO_ECC_CD
                , CNTR_TPSZ_CD 
                , 'O' TRSP_MOD_CD
            FROM 
                EQR_ONF_HIR_PLN	A
                , EQR_ONF_HIR_PLN_QTY B
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
            WHERE 
                A.REPO_PLN_ID = B.REPO_PLN_ID
                AND A.PLN_YRWK = B.PLN_YRWK
                AND A.PLN_SEQ = B.PLN_SEQ
                AND A.REPO_PLN_ID = @[repo_pln_Id]
                #if (${item_5} != '')
                    #if (${onHire} == 'Y')
                        AND 1=1
                    #else
                        AND 1=2
                    #end
                #end
                #if (${lane_5} != '')
                    AND 1 = 2
                #end
                #if (${vvd_5} != '')
                    AND 1 = 2
                #end
                #if (${fmtoat5} == '1')
                    AND A.ECC_CD = C.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND A.ECC_CD = C.ECC_CD
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND ONF_HIR_DIV_CD = 'O'
                AND A.PLN_YRWK IN (${max_capa_4wk})
        )PLN_ON
        WHERE 
            PERF.CNTR_TPSZ_CD = PLN_ON.CNTR_TPSZ_CD
            AND PERF.TO_ECC_CD 		= PLN_ON.TO_ECC_CD
            AND PERF.TRSP_MOD_CD 	= PLN_ON.TRSP_MOD_CD
        --내부값 END----------.
    )AA 
        , EQR_ONF_HIR_PLN BB
        , EQR_ONF_HIR_PLN_QTY CC
    WHERE 
        BB.REPO_PLN_ID = CC.REPO_PLN_ID
        AND BB.PLN_YRWK = CC.PLN_YRWK
        AND BB.PLN_SEQ = CC.PLN_SEQ
        AND BB.REPO_PLN_ID 	= @[repo_pln_Id]
        AND BB.PLN_YRWK 		= AA.PLN_YRWK
        AND BB.ECC_CD 		= AA.TO_ECC_CD
        AND CC.CNTR_TPSZ_CD 	= AA.CNTR_TPSZ_CD
        AND BB.ONF_HIR_DIV_CD = AA.TRSP_MOD_CD
        
    UNION ALL
    
    -------------------------------------------------------------------------------NEW PERF(OFF-HIRE)
    SELECT 
        BB.PLN_YRWK
        , AA.DIV
        , AA.ITEM ITEM
        , AA.TRSP_MOD_CD
        , '' VSL_LANE_CD
        , '' VVD 
        , BB.ECC_CD FM_ECC_CD 
        , '' TO_ECC_CD
        , '' ETD
        , '' ETA
        , '' TVOL
        , '' TCOST
        , CC.CNTR_TPSZ_CD
        , CC.CNTR_QTY
        , CC.ONF_HIR_COST_AMT COST_AMT
        , BB.REPO_PLN_ID
        , '1' SEQ
        , '2' SUBSEQ
        , 'EQR_ONF_HIR_PLN' TABLENM
    FROM
    (
        --내부값 START----------.
        SELECT	
            DISTINCT PLN_ON.PLN_YRWK PLN_YRWK
            , 'Plan' DIV
            , PLN_ON.TRSP_MOD_CD ITEM
            , PLN_ON.TRSP_MOD_CD
            , '' VSL_LANE_CD
            , '' VVD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${fmtypeby_5} == 'R')
                        RCC_CD
                    #elseif (${fmtypeby_5} == 'C')
                        CNT_CD
                    #elseif (${fmtypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.FM_ECC_CD = ECC_CD
            ) FM_ECC_CD
            , PLN_ON.TO_ECC_CD
            , '' ETD
            , '' ETA
            , '' TVOL
            , '' TCOST
            , PLN_ON.CNTR_TPSZ_CD
            , '' CNTR_QTY
            , '' COST_AMT
            ,  '' REPO_PLN_ID
            , '1' SEQ
            , '2' SUBSEQ
            , 'EQR_ONF_HIR_PLN' TABLENM
        FROM
        (
            SELECT 
                PLN_YRWK
                , FM_ECC_CD
                , TO_ECC_CD
                , CNTR_TPSZ_CD
                , TRSP_MOD_CD
            FROM
            (
                SELECT 
                    A.PLN_YRWK
                    , 'F' TRSP_MOD_CD
                    , B.CNTR_TPSZ_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${fmtypeby_5} == 'R')
                                RCC_CD
                            #elseif (${fmtypeby_5} == 'C')
                                CNT_CD
                            #elseif (${fmtypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    , '' TO_ECC_CD
                FROM 
                    EQR_ONF_HIR_PLN A
                    , EQR_ONF_HIR_PLN_QTY B
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrFmEccCd.size() > 0)
                            #if (${fmtype_5} == 'R')
                                AND RCC_CD
                            #elseif (${fmtype_5} == 'L')
                                AND LCC_CD
                            #elseif (${fmtype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrFmEccCd})
                                    #if($velocityCount < $arrFmEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) C
                        #else
                            ) C
                        #end
                    #else
                        #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                            , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                            #if (${attype_5}== 'R')
                                AND RCC_CD
                            #elseif (${attype_5}== 'L')
                                AND LCC_CD
                            #elseif (${attype_5}== 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrAtEccCd})
                                    #if($velocityCount < $arrAtEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            ))C
                        #end
                    #end
                WHERE 
                    A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.PLN_YRWK = B.PLN_YRWK
                    AND A.PLN_SEQ = B.PLN_SEQ
                    AND A.REPO_PLN_ID = @[repo_pln_Id]
                    #if (${item_5} != '')
                        #if (${offHire} == 'Y')
                            AND 1=1
                        #else
                            AND 1=2
                        #end
                    #end
                    #if (${lane_5} != '')
                        AND 1 = 2
                    #end
                    #if (${vvd_5} != '')
                        AND 1 = 2
                    #end
                    #if (${fmtoat5} == '1')
                        AND A.ECC_CD = C.ECC_CD
                    #else
                        #if (${attype_5} != '')
                            AND A.ECC_CD = C.ECC_CD
                        #end
                    #end
                    #if ($arrCntrTpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arrCntrTpszCd})
                                #if($velocityCount < $arrCntrTpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )
                    #end
                    AND ONF_HIR_DIV_CD = 'F'
                    AND A.PLN_YRWK IN (${max_capa_4wk})
            )
        )PLN_ON
        
        MINUS
        
        SELECT	
            DISTINCT PLN_ON.PLN_YRWK PLN_YRWK
            , 'Plan' DIV
            , PERF.TRSP_MOD_CD ITEM
            , PERF.TRSP_MOD_CD
            , '' VSL_LANE_CD
            , '' VVD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${fmtypeby_5} == 'R')
                        RCC_CD
                    #elseif (${fmtypeby_5} == 'C')
                        CNT_CD
                    #elseif (${fmtypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.FM_ECC_CD = ECC_CD
            ) FM_ECC_CD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${totypeby_5} == 'R')
                        RCC_CD
                    #elseif (${totypeby_5} == 'C')
                        CNT_CD
                    #elseif (${totypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.TO_ECC_CD = ECC_CD
            ) TO_ECC_CD
            , '' ETD
            , '' ETA
            , '' TVOL
            , '' TCOST
            , PLN_ON.CNTR_TPSZ_CD
            , '' CNTR_QTY
            , '' COST_AMT
            , '' REPO_PLN_ID
            , '1' SEQ
            , '2' SUBSEQ
            , 'EQR_ONF_HIR_PLN' TABLENM
        FROM
        (
            SELECT 
                F.TRSP_MOD_CD
                , F.FM_ECC_CD
                , F.TO_ECC_CD
                , F.CNTR_TPSZ_CD
                , F.PLN_YRWK
            FROM
            (
                SELECT 
                    A.YRWK PLN_YRWK
                    , 'F' TRSP_MOD_CD
                    , A.CNTR_TPSZ_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${fmtypeby_5} == 'R')
                                RCC_CD
                            #elseif (${fmtypeby_5} == 'C')
                                CNT_CD
                            #elseif (${fmtypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${totypeby_5} == 'R')
                                RCC_CD
                            #elseif (${totypeby_5} == 'C')
                                CNT_CD
                            #elseif (${totypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                FROM 
                    EQR_EXE_PLN_ONF_HIR_PERF A
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrFmEccCd.size() > 0)
                            #if (${fmtype_5} == 'R')
                                AND RCC_CD
                            #elseif (${fmtype_5} == 'L')
                                AND LCC_CD
                            #elseif (${fmtype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrFmEccCd})
                                    #if($velocityCount < $arrFmEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) C
                        #else
                            ) C
                        #end
                    #else
                        #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                            , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                            #if (${attype_5}== 'R')
                                AND RCC_CD
                            #elseif (${attype_5}== 'L')
                                AND LCC_CD
                            #elseif (${attype_5}== 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrAtEccCd})
                                    #if($velocityCount < $arrAtEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            ))C
                        #end
                    #end
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrToEccCd.size() > 0)
                            #if (${totype_5} == 'R')
                                AND RCC_CD
                            #elseif (${totype_5} == 'L')
                                AND LCC_CD
                            #elseif (${totype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrToEccCd})
                                    #if($velocityCount < $arrToEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) D
                        #else
                            ) D
                        #end
                    #end
                WHERE 
                    A.YRWK = @[yyyyww]
                    #if (${fmtoat5} == '1')
                        AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                    #else
                        #if (${attype_5} != '')
                            AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                        #end
                    #end
                    #if ($arrCntrTpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arrCntrTpszCd})
                                #if($velocityCount < $arrCntrTpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )
                    #end
                    AND ONF_HIR_DIV_CD = 'F'
                    AND MON_FREQ_KNT = 4
            )F
        )PERF,
        (
            SELECT 
                A.PLN_YRWK
                , A.ECC_CD FM_ECC_CD
                , '' TO_ECC_CD
                , CNTR_TPSZ_CD 
                , 'F' TRSP_MOD_CD
            FROM 
                EQR_ONF_HIR_PLN	A
                , EQR_ONF_HIR_PLN_QTY B
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
            WHERE 
                A.REPO_PLN_ID = B.REPO_PLN_ID
                AND A.PLN_YRWK = B.PLN_YRWK
                AND A.PLN_SEQ = B.PLN_SEQ
                AND A.REPO_PLN_ID = @[repo_pln_Id]
                #if (${item_5} != '')
                    #if (${offHire} == 'Y')
                        AND 1=1
                    #else
                        AND 1=2
                    #end
                #end
                #if (${lane_5} != '')
                    AND 1 = 2
                #end
                #if (${vvd_5} != '')
                    AND 1 = 2
                #end
                #if (${fmtoat5} == '1')
                    AND A.ECC_CD = C.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND A.ECC_CD = C.ECC_CD
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND ONF_HIR_DIV_CD = 'F'
                AND A.PLN_YRWK IN (${max_capa_4wk})
        )PLN_ON
        WHERE 
            PERF.CNTR_TPSZ_CD = PLN_ON.CNTR_TPSZ_CD
            AND PERF.FM_ECC_CD 		= PLN_ON.FM_ECC_CD
            AND PERF.TRSP_MOD_CD 	= PLN_ON.TRSP_MOD_CD
        --내부값 END----------.
    )AA 
        , EQR_ONF_HIR_PLN BB
        , EQR_ONF_HIR_PLN_QTY CC
    WHERE 
        BB.REPO_PLN_ID = CC.REPO_PLN_ID
        AND BB.PLN_YRWK = CC.PLN_YRWK
        AND BB.PLN_SEQ = CC.PLN_SEQ
        AND BB.REPO_PLN_ID 	= @[repo_pln_Id]
        AND BB.PLN_YRWK 		= AA.PLN_YRWK
        AND BB.ECC_CD 		= AA.FM_ECC_CD
        AND CC.CNTR_TPSZ_CD 	= AA.CNTR_TPSZ_CD
        AND BB.ONF_HIR_DIV_CD = AA.TRSP_MOD_CD
        
    UNION ALL
    
    -------------------------------------------------------------------------------NEW PERF(INLND)
    SELECT 
        BB.PLN_YRWK
        , AA.DIV
        , BB.TRSP_MOD_CD ITEM
        , BB.TRSP_MOD_CD
        , '' VSL_LANE_CD
        , '' VVD 
        , BB.FM_ECC_CD 
        , BB.TO_ECC_CD
        , BB.FM_YRWK ETD
        , BB.TO_YRWK ETA
        , '' TVOL
        , '' TCOST
        , CC.CNTR_TPSZ_CD
        , CC.CNTR_QTY
        , CC.TRSP_COST_AMT COST_AMT
        , '' REPO_PLN_ID
        , '1' SEQ
        , '3' SUBSEQ
        , 'EQR_INLND_TRSP_PLN' TABLENM
    FROM
    (
        --내부값 START----------.
        SELECT	
            DISTINCT PLN_ON.PLN_YRWK PLN_YRWK
            , 'Plan' DIV
            , PLN_ON.TRSP_MOD_CD ITEM
            , PLN_ON.TRSP_MOD_CD
            , '' VSL_LANE_CD
            , '' VVD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${fmtypeby_5} == 'R')
                        RCC_CD
                    #elseif (${fmtypeby_5} == 'C')
                        CNT_CD
                    #elseif (${fmtypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.FM_ECC_CD = ECC_CD
            ) FM_ECC_CD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${totypeby_5} == 'R')
                        RCC_CD
                    #elseif (${totypeby_5} == 'C')
                        CNT_CD
                    #elseif (${totypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.TO_ECC_CD = ECC_CD
            ) TO_ECC_CD
            , '' ETD
            , '' ETA
            , '' TVOL
            , '' TCOST
            , PLN_ON.CNTR_TPSZ_CD
            , '' CNTR_QTY
            , '' COST_AMT
            , '' REPO_PLN_ID
            , '1' SEQ
            , '3' SUBSEQ
            , 'EQR_INLND_TRSP_PLN' TABLENM
        FROM
        (
            SELECT 
                PLN_YRWK
                , FM_ECC_CD
                , TO_ECC_CD
                , CNTR_TPSZ_CD
                , TRSP_MOD_CD
            FROM
            (
                SELECT 
                    A.PLN_YRWK
                    , A.TRSP_MOD_CD
                    , B.CNTR_TPSZ_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${fmtypeby_5} == 'R')
                                RCC_CD
                            #elseif (${fmtypeby_5} == 'C')
                                CNT_CD
                            #elseif (${fmtypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${totypeby_5} == 'R')
                                RCC_CD
                            #elseif (${totypeby_5} == 'C')
                                CNT_CD
                            #elseif (${totypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                FROM 
                    EQR_INLND_TRSP_PLN A
                    , EQR_INLND_TRSP_PLN_QTY B
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrFmEccCd.size() > 0)
                            #if (${fmtype_5} == 'R')
                                AND RCC_CD
                            #elseif (${fmtype_5} == 'L')
                                AND LCC_CD
                            #elseif (${fmtype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrFmEccCd})
                                    #if($velocityCount < $arrFmEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) C
                        #else
                            ) C
                        #end
                    #else
                        #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                            , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                            #if (${attype_5}== 'R')
                                AND RCC_CD
                            #elseif (${attype_5}== 'L')
                                AND LCC_CD
                            #elseif (${attype_5}== 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrAtEccCd})
                                    #if($velocityCount < $arrAtEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            ))C
                        #end
                    #end
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrToEccCd.size() > 0)
                            #if (${totype_5} == 'R')
                                AND RCC_CD
                            #elseif (${totype_5} == 'L')
                                AND LCC_CD
                            #elseif (${totype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrToEccCd})
                                    #if($velocityCount < $arrToEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) D
                        #else
                            ) D
                        #end
                    #end
                WHERE 
                    A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.PLN_YRWK = B.PLN_YRWK
                    AND A.PLN_SEQ = B.PLN_SEQ
                    AND A.REPO_PLN_ID = @[repo_pln_Id]
                    #if ($arrItem.size() > 0)
                        AND TRSP_MOD_CD IN 
                        (
                            #foreach ($key in ${arrItem})
                                #if($velocityCount < $arrItem.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )
                    #end
                    #if (${lane_5} != '')
                        AND 1 = 2
                    #end
                    #if (${vvd_5} != '')
                        AND 1 = 2
                    #end
                    #if (${fmtoat5} == '1')
                        AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                    #else
                        #if (${attype_5} != '')
                            AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                        #end
                    #end
                    #if ($arrCntrTpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arrCntrTpszCd})
                                #if($velocityCount < $arrCntrTpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )
                    #end
                    AND A.PLN_YRWK IN (${max_capa_4wk})
            )
        )PLN_ON
        
        MINUS
        
        SELECT	
            DISTINCT PLN_ON.PLN_YRWK PLN_YRWK
            , 'Perf' DIV
            , PERF.TRSP_MOD_CD ITEM
            , PERF.TRSP_MOD_CD
            , '' VSL_LANE_CD
            , '' VVD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${fmtypeby_5} == 'R')
                        RCC_CD
                    #elseif (${fmtypeby_5} == 'C')
                        CNT_CD
                    #elseif (${fmtypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.FM_ECC_CD = ECC_CD
            ) FM_ECC_CD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${totypeby_5} == 'R')
                        RCC_CD
                    #elseif (${totypeby_5} == 'C')
                        CNT_CD
                    #elseif (${totypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.TO_ECC_CD = ECC_CD
            ) TO_ECC_CD
            , '' ETD
            , '' ETA
            , '' TVOL
            , '' TCOST
            , PLN_ON.CNTR_TPSZ_CD
            , '' CNTR_QTY
            , '' COST_AMT
            , '' REPO_PLN_ID
            , '1' SEQ
            , '3' SUBSEQ
            , 'EQR_INLND_TRSP_PLN' TABLENM
        FROM
        (
            SELECT 
                F.TRSP_MOD_CD
                , F.FM_ECC_CD
                , F.TO_ECC_CD
                , F.CNTR_TPSZ_CD
                , F.PLN_YRWK
            FROM
            (
                SELECT 
                    A.YRWK PLN_YRWK
                    , A.TRSP_MOD_CD
                    , A.CNTR_TPSZ_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${fmtypeby_5} == 'R')
                                RCC_CD
                            #elseif (${fmtypeby_5} == 'C')
                                CNT_CD
                            #elseif (${fmtypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${totypeby_5} == 'R')
                                RCC_CD
                            #elseif (${totypeby_5} == 'C')
                                CNT_CD
                            #elseif (${totypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                FROM 
                    EQR_EXE_PLN_INLND_PERF A
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrFmEccCd.size() > 0)
                            #if (${fmtype_5} == 'R')
                                AND RCC_CD
                            #elseif (${fmtype_5} == 'L')
                                AND LCC_CD
                            #elseif (${fmtype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrFmEccCd})
                                    #if($velocityCount < $arrFmEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) C
                        #else
                            ) C
                        #end
                    #else
                        #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                            , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                            #if (${attype_5}== 'R')
                                AND RCC_CD
                            #elseif (${attype_5}== 'L')
                                AND LCC_CD
                            #elseif (${attype_5}== 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrAtEccCd})
                                    #if($velocityCount < $arrAtEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            ))C
                        #end
                    #end
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrToEccCd.size() > 0)
                            #if (${totype_5} == 'R')
                                AND RCC_CD
                            #elseif (${totype_5} == 'L')
                                AND LCC_CD
                            #elseif (${totype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrToEccCd})
                                    #if($velocityCount < $arrToEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) D
                        #else
                            ) D
                        #end
                    #end
                WHERE 
                    A.YRWK = @[yyyyww]
                    #if (${fmtoat5} == '1')
                        AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                    #else
                        #if (${attype_5} != '')
                            AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                        #end
                    #end
                    #if ($arrCntrTpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arrCntrTpszCd})
                                #if($velocityCount < $arrCntrTpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )
                    #end
                    AND MON_FREQ_KNT = 4
            )F
        )PERF,
        (
            SELECT 
                A.PLN_YRWK
                , FM_ECC_CD
                , TO_ECC_CD
                , CNTR_TPSZ_CD 
                , TRSP_MOD_CD
            FROM 
                EQR_INLND_TRSP_PLN	A
                , EQR_INLND_TRSP_PLN_QTY B
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE 
                A.REPO_PLN_ID = B.REPO_PLN_ID
                AND A.PLN_YRWK = B.PLN_YRWK
                AND A.PLN_SEQ = B.PLN_SEQ
                AND A.REPO_PLN_ID = @[repo_pln_Id]
                #if ($arrItem.size() > 0)
                    AND TRSP_MOD_CD IN 
                    (
                        #foreach ($key in ${arrItem})
                            #if($velocityCount < $arrItem.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                #if (${lane_5} != '')
                    AND 1 = 2
                #end
                #if (${vvd_5} != '')
                    AND 1 = 2
                #end
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                AND A.PLN_YRWK IN (${max_capa_4wk})
        )PLN_ON
        WHERE 
            PERF.CNTR_TPSZ_CD = PLN_ON.CNTR_TPSZ_CD
            AND PERF.TO_ECC_CD 		= PLN_ON.TO_ECC_CD
            AND PERF.FM_ECC_CD 		= PLN_ON.FM_ECC_CD
            AND PERF.TRSP_MOD_CD 	= PLN_ON.TRSP_MOD_CD
        --내부값 END----------.
    )AA 
        , EQR_INLND_TRSP_PLN BB
        , EQR_INLND_TRSP_PLN_QTY CC
    WHERE 
        BB.REPO_PLN_ID = CC.REPO_PLN_ID
        AND BB.PLN_YRWK = CC.PLN_YRWK
        AND BB.PLN_SEQ = CC.PLN_SEQ
        AND BB.REPO_PLN_ID = @[repo_pln_Id]
        AND BB.PLN_YRWK = AA.PLN_YRWK
        AND BB.FM_ECC_CD = AA.FM_ECC_CD
        AND BB.TO_ECC_CD = AA.TO_ECC_CD
        AND CC.CNTR_TPSZ_CD = AA.CNTR_TPSZ_CD
        AND BB.TRSP_MOD_CD = AA.TRSP_MOD_CD
        
    UNION ALL
    
    -------------------------------------------------------------------------------NEW PERF(VSL)
    SELECT 
        BB.PLN_YRWK
        , AA.DIV
        , BB.TRSP_MOD_CD ITEM
        , BB.TRSP_MOD_CD
        , BB.VSL_LANE_CD
        , BB.VSL_CD||BB.SKD_VOY_NO||BB.SKD_DIR_CD VVD 
        , BB.FM_ECC_CD 
        , BB.TO_ECC_CD
        , TO_CHAR(BB.FM_ETD_DT,'YYYY-MM-DD HH24:MI:SS') ETD
        , TO_CHAR(BB.TO_ETB_DT,'YYYY-MM-DD HH24:MI:SS') ETA
        , '' TVOL
        , '' TCOST
        , CC.CNTR_TPSZ_CD
        , CC.CNTR_QTY
        , CC.LODG_DCHG_COST_AMT COST_AMT
        ,  '' REPO_PLN_ID
        , '1' SEQ
        , '4' SUBSEQ
        , 'EQR_VSL_LODG_DCHG_PLN' TABLENM
    FROM
    (
        --내부값 START----------.
        SELECT	
            DISTINCT PLN_ON.PLN_YRWK PLN_YRWK
            , 'Plan' DIV
            , 'V' ITEM
            , 'V' TRSP_MOD_CD
            ,  PLN_ON.VSL_LANE_CD
            , '' VVD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${fmtypeby_5} == 'R')
                        RCC_CD
                    #elseif (${fmtypeby_5} == 'C')
                        CNT_CD
                    #elseif (${fmtypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.FM_ECC_CD = ECC_CD
            ) FM_ECC_CD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${totypeby_5} == 'R')
                        RCC_CD
                    #elseif (${totypeby_5} == 'C')
                        CNT_CD
                    #elseif (${totypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.TO_ECC_CD = ECC_CD
            ) TO_ECC_CD
            , '' ETD
            , '' ETA
            , '' TVOL
            , '' TCOST
            , PLN_ON.CNTR_TPSZ_CD
            , '' CNTR_QTY
            , '' COST_AMT
            , '' REPO_PLN_ID
            , '1' SEQ
            , '4' SUBSEQ
            , 'EQR_VSL_LODG_DCHG_PLN' TABLENM
        FROM
        (
            SELECT 
                PLN_YRWK
                , FM_ECC_CD
                , TO_ECC_CD
                , CNTR_TPSZ_CD
                , VSL_LANE_CD
            FROM
            (
                SELECT 
                    A.PLN_YRWK
                    , A.VSL_LANE_CD
                    , B.CNTR_TPSZ_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${fmtypeby_5} == 'R')
                                RCC_CD
                            #elseif (${fmtypeby_5} == 'C')
                                CNT_CD
                            #elseif (${fmtypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${totypeby_5} == 'R')
                                RCC_CD
                            #elseif (${totypeby_5} == 'C')
                                CNT_CD
                            #elseif (${totypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                FROM 
                    EQR_VSL_LODG_DCHG_PLN A
                    , EQR_VSL_LODG_DCHG_PLN_QTY B
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrFmEccCd.size() > 0)
                            #if (${fmtype_5} == 'R')
                                AND RCC_CD
                            #elseif (${fmtype_5} == 'L')
                                AND LCC_CD
                            #elseif (${fmtype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrFmEccCd})
                                    #if($velocityCount < $arrFmEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) C
                        #else
                            ) C
                        #end
                    #else
                        #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                            , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                            #if (${attype_5}== 'R')
                                AND RCC_CD
                            #elseif (${attype_5}== 'L')
                                AND LCC_CD
                            #elseif (${attype_5}== 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrAtEccCd})
                                    #if($velocityCount < $arrAtEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            ))C
                        #end
                    #end
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrToEccCd.size() > 0)
                            #if (${totype_5} == 'R')
                                AND RCC_CD
                            #elseif (${totype_5} == 'L')
                                AND LCC_CD
                            #elseif (${totype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrToEccCd})
                                    #if($velocityCount < $arrToEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) D
                        #else
                            ) D
                        #end
                    #end
                WHERE 
                    A.REPO_PLN_ID = B.REPO_PLN_ID
                    AND A.PLN_YRWK = B.PLN_YRWK
                    AND A.PLN_SEQ = B.PLN_SEQ
                    AND A.REPO_PLN_ID = @[repo_pln_Id]
                    #if ($arrItem.size() > 0)
                        AND TRSP_MOD_CD IN 
                        (
                            #foreach ($key in ${arrItem})
                                #if($velocityCount < $arrItem.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )
                    #end
                    #if ($arrIane.size() > 0)
                        AND VSL_LANE_CD IN 
                        (
                            #foreach ($key in ${arrIane})
                                #if($velocityCount < $arrIane.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )
                    #end
                    #if ($arrVvd.size() > 0)
                        AND VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN 
                        (
                            #foreach ($key in ${arrVvd})
                                #if($velocityCount < $arrVvd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )
                    #end
                    #if (${fmtoat5} == '1')
                        AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                    #else
                        #if (${attype_5} != '')
                            AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                        #end
                    #end
                    #if ($arrCntrTpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arrCntrTpszCd})
                                #if($velocityCount < $arrCntrTpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )
                    #end
                    AND A.PLN_YRWK IN (${max_capa_4wk})
            )
        )PLN_ON
        
        MINUS
        
        SELECT	
            DISTINCT PERF.PLN_YRWK PLN_YRWK
            , 'Perf' DIV
            , 'V' ITEM
            , 'V' TRSP_MOD_CD
            , PERF.VSL_LANE_CD
            , '' VVD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${fmtypeby_5} == 'R')
                        RCC_CD
                    #elseif (${fmtypeby_5} == 'C')
                        CNT_CD
                    #elseif (${fmtypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.FM_ECC_CD = ECC_CD
            ) FM_ECC_CD
            , (
                SELECT 
                #if (${fmtoat5} == '1')
                    #if (${totypeby_5} == 'R')
                        RCC_CD
                    #elseif (${totypeby_5} == 'C')
                        CNT_CD
                    #elseif (${totypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #else
                    #if (${attypeby_5} == 'R')
                        RCC_CD
                    #elseif (${attypeby_5} == 'C')
                        CNT_CD
                    #elseif (${attypeby_5} == 'L')
                        LCC_CD
                    #else
                        ECC_CD
                    #end
                #end
                FROM 
                    EQR_ECC_MST 
                WHERE 
                    PLN_ON.TO_ECC_CD = ECC_CD
            ) TO_ECC_CD
            , '' ETD
            , '' ETA
            , '' TVOL
            , '' TCOST
            , PLN_ON.CNTR_TPSZ_CD
            , '' CNTR_QTY
            , '' COST_AMT
            , '' REPO_PLN_ID
            , '1' SEQ
            , '4' SUBSEQ
            , 'EQR_VSL_LODG_DCHG_PLN' TABLENM
        FROM
        (
            SELECT 
                F.VSL_LANE_CD
                , F.FM_ECC_CD
                , F.TO_ECC_CD
                , F.CNTR_TPSZ_CD
                , F.PLN_YRWK
            FROM
            (
                SELECT 
                    A.YRWK PLN_YRWK
                    , A.VSL_LANE_CD
                    , A.CNTR_TPSZ_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${fmtypeby_5} == 'R')
                                RCC_CD
                            #elseif (${fmtypeby_5} == 'C')
                                CNT_CD
                            #elseif (${fmtypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.FM_ECC_CD = ECC_CD
                    ) FM_ECC_CD
                    , (
                        SELECT 
                        #if (${fmtoat5} == '1')
                            #if (${totypeby_5} == 'R')
                                RCC_CD
                            #elseif (${totypeby_5} == 'C')
                                CNT_CD
                            #elseif (${totypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #else
                            #if (${attypeby_5} == 'R')
                                RCC_CD
                            #elseif (${attypeby_5} == 'C')
                                CNT_CD
                            #elseif (${attypeby_5} == 'L')
                                LCC_CD
                            #else
                                ECC_CD
                            #end
                        #end
                        FROM 
                            EQR_ECC_MST 
                        WHERE 
                            A.TO_ECC_CD = ECC_CD
                    ) TO_ECC_CD
                FROM 
                    EQR_EXE_PLN_VSL_PERF A
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrFmEccCd.size() > 0)
                            #if (${fmtype_5} == 'R')
                                AND RCC_CD
                            #elseif (${fmtype_5} == 'L')
                                AND LCC_CD
                            #elseif (${fmtype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrFmEccCd})
                                    #if($velocityCount < $arrFmEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) C
                        #else
                            ) C
                        #end
                    #else
                        #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                            , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                            #if (${attype_5}== 'R')
                                AND RCC_CD
                            #elseif (${attype_5}== 'L')
                                AND LCC_CD
                            #elseif (${attype_5}== 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrAtEccCd})
                                    #if($velocityCount < $arrAtEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            ))C
                        #end
                    #end
                    #if (${fmtoat5} == '1')
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if ($arrToEccCd.size() > 0)
                            #if (${totype_5} == 'R')
                                AND RCC_CD
                            #elseif (${totype_5} == 'L')
                                AND LCC_CD
                            #elseif (${totype_5} == 'E')
                                AND ECC_CD
                            #end
                            IN(
                                #foreach ($key in ${arrToEccCd})
                                    #if($velocityCount < $arrToEccCd.size())
                                    '$key',
                                    #else
                                    '$key'
                                    #end
                                #end
                            )) D
                        #else
                            ) D
                        #end
                    #end
                WHERE 
                    A.YRWK = @[yyyyww]
                    #if (${fmtoat5} == '1')
                        AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                    #else
                        #if (${attype_5} != '')
                            AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                        #end
                    #end
                    #if ($arrCntrTpszCd.size() > 0)
                        AND CNTR_TPSZ_CD IN(
                            #foreach ($key in ${arrCntrTpszCd})
                                #if($velocityCount < $arrCntrTpszCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )
                    #end
                    AND MON_FREQ_KNT = 4
            )F
        )PERF,
        (
            SELECT 
                A.PLN_YRWK
                , FM_ECC_CD
                , TO_ECC_CD
                , CNTR_TPSZ_CD 
                , VSL_LANE_CD
            FROM 
                EQR_VSL_LODG_DCHG_PLN	A
                , EQR_VSL_LODG_DCHG_PLN_QTY B
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrFmEccCd.size() > 0)
                        #if (${fmtype_5} == 'R')
                            AND RCC_CD
                        #elseif (${fmtype_5} == 'L')
                            AND LCC_CD
                        #elseif (${fmtype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrFmEccCd})
                                #if($velocityCount < $arrFmEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) C
                    #else
                        ) C
                    #end
                #else
                    #if (${attype_5} != '' && $arrAtEccCd.size() > 0)
                        , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                        #if (${attype_5}== 'R')
                            AND RCC_CD
                        #elseif (${attype_5}== 'L')
                            AND LCC_CD
                        #elseif (${attype_5}== 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrAtEccCd})
                                #if($velocityCount < $arrAtEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        ))C
                    #end
                #end
                #if (${fmtoat5} == '1')
                    , (SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1
                    #if ($arrToEccCd.size() > 0)
                        #if (${totype_5} == 'R')
                            AND RCC_CD
                        #elseif (${totype_5} == 'L')
                            AND LCC_CD
                        #elseif (${totype_5} == 'E')
                            AND ECC_CD
                        #end
                        IN(
                            #foreach ($key in ${arrToEccCd})
                                #if($velocityCount < $arrToEccCd.size())
                                '$key',
                                #else
                                '$key'
                                #end
                            #end
                        )) D
                    #else
                        ) D
                    #end
                #end
            WHERE 
                A.REPO_PLN_ID = B.REPO_PLN_ID
                AND A.PLN_YRWK = B.PLN_YRWK
                AND A.PLN_SEQ = B.PLN_SEQ
                AND A.REPO_PLN_ID = @[repo_pln_Id]
                #if ($arrItem.size() > 0)
                    AND TRSP_MOD_CD IN 
                    (
                        #foreach ($key in ${arrItem})
                            #if($velocityCount < $arrItem.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                #if ($arrIane.size() > 0)
                    AND VSL_LANE_CD IN 
                    (
                        #foreach ($key in ${arrIane})
                            #if($velocityCount < $arrIane.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                #if ($arrVvd.size() > 0)
                    AND VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN 
                    (
                        #foreach ($key in ${arrVvd})
                            #if($velocityCount < $arrVvd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
                #if (${fmtoat5} == '1')
                    AND A.FM_ECC_CD = C.ECC_CD AND A.TO_ECC_CD = D.ECC_CD
                #else
                    #if (${attype_5} != '')
                        AND (A.FM_ECC_CD = C.ECC_CD OR A.TO_ECC_CD = C.ECC_CD)
                    #end
                #end
                #if ($arrCntrTpszCd.size() > 0)
                    AND CNTR_TPSZ_CD IN(
                        #foreach ($key in ${arrCntrTpszCd})
                            #if($velocityCount < $arrCntrTpszCd.size())
                            '$key',
                            #else
                            '$key'
                            #end
                        #end
                    )
                #end
        )PLN_ON
        WHERE 
            PERF.CNTR_TPSZ_CD = PLN_ON.CNTR_TPSZ_CD
            AND PERF.TO_ECC_CD 		= PLN_ON.TO_ECC_CD
            AND PERF.FM_ECC_CD 		= PLN_ON.FM_ECC_CD
            AND PERF.VSL_LANE_CD 	= PLN_ON.VSL_LANE_CD
            AND PLN_ON.PLN_YRWK IN (${max_capa_4wk})
        --내부값 END----------.
    )AA 
        , EQR_VSL_LODG_DCHG_PLN BB
        , EQR_VSL_LODG_DCHG_PLN_QTY CC
    WHERE 
        BB.REPO_PLN_ID = CC.REPO_PLN_ID
        AND BB.PLN_YRWK = CC.PLN_YRWK
        AND BB.PLN_SEQ = CC.PLN_SEQ
        AND BB.REPO_PLN_ID = @[repo_pln_Id]
        AND BB.PLN_YRWK = AA.PLN_YRWK
        AND BB.FM_ECC_CD = AA.FM_ECC_CD
        AND BB.TO_ECC_CD = AA.TO_ECC_CD
        AND CC.CNTR_TPSZ_CD = AA.CNTR_TPSZ_CD
        AND BB.TRSP_MOD_CD = AA.TRSP_MOD_CD
        #if ($arrVvd.size() > 0)
            AND BB.VSL_CD||BB.SKD_VOY_NO||BB.SKD_DIR_CD IN
            (
                #foreach ($key in ${arrVvd})
                    #if($velocityCount < $arrVvd.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
            )
        #end
        #if ($arrIane.size() > 0)
            AND BB.VSL_LANE_CD IN
            (
                #foreach ($key in ${arrIane})
                    #if($velocityCount < $arrIane.size())
                    '$key',
                    #else
                    '$key'
                    #end
                #end
            )
        #end
)T2
#if (${rlatype_5} == '')
    WHERE 1=1
#elseif (${rlatype_5} == 'B')
    WHERE 1=2
#elseif (${rlatype_5} == 'M')
    WHERE 1=2
#elseif (${rlatype_5} == 'A')
    WHERE 1=2
#elseif (${rlatype_5} == 'S')
    WHERE 1=2
#elseif (${rlatype_5} == 'N')
    WHERE 1=2
#elseif (${rlatype_5} == 'P')
    WHERE 1=1
#end
GROUP BY 
    REPO_PLN_ID, PLN_YRWK, DIV, ITEM, TRSP_MOD_CD, VSL_LANE_CD, VVD
    , FM_ECC_CD, ETD, T2.TO_ECC_CD, ETA, SEQ, TABLENM, SUBSEQ
ORDER BY 
    PLN_YRWK, RLA_TMP, SUBSEQ, DIV, ITEM, VSL_LANE_CD, VVD, FM_ECC_CD, TO_ECC_CD			]]></sql>
			<params>
				<param name="repo_pln_Id" type="12" value="" out="N"/>
				<param name="fmFmPlnYrWk" type="12" value="" out="N"/>
				<param name="fmToPlnYrWk" type="12" value="" out="N"/>
				<param name="toFmPlnYrWk" type="12" value="" out="N"/>
				<param name="toToPlnYrWk" type="12" value="" out="N"/>
				<param name="yyyyww" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
