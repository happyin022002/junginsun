<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ChassisMgsetInventoryDBDAOsearchMGSInventoryGeneralDataRSQL">
			<desc><![CDATA[chungpa 20090909 2076 start]]></desc>
			<sql><![CDATA[
SELECT
#if (${group1} == '1') 
	C.LCC_CD AS GROUP1 ,
#elseif (${group1} == '2') 
    C.SCC_CD AS GROUP1 ,
#elseif (${group1} == '3') 
	A.CRNT_YD_CD AS GROUP1 ,
#elseif (${group1} == '4') 
	D.VNDR_ABBR_NM||' ('||A.VNDR_SEQ||')'  AS GROUP1 ,
#elseif (${group1} == '5') 
    A.AGMT_OFC_CTY_CD || LPAD(A.AGMT_SEQ, 6, '0')||' ('||E.VNDR_ABBR_NM||')' AS GROUP1 ,
#end
    A.AGMT_LSTM_CD AS AGMT_LSTM_CD
    ,D.INTG_CD_VAL_DP_SEQ
	, count(*)												AS EQ_TPSZ_CD_TOTAL,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '1' THEN 1 END),0) AS EQ_TPSZ_CD1,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '2' THEN 1 END),0) AS EQ_TPSZ_CD2,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '3' THEN 1 END),0) AS EQ_TPSZ_CD3,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '4' THEN 1 END),0) AS EQ_TPSZ_CD4,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '5' THEN 1 END),0) AS EQ_TPSZ_CD5,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '6' THEN 1 END),0) AS EQ_TPSZ_CD6,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '7' THEN 1 END),0) AS EQ_TPSZ_CD7,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '8' THEN 1 END),0) AS EQ_TPSZ_CD8,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '9' THEN 1 END),0) AS EQ_TPSZ_CD9,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '10' THEN 1 END),0) AS EQ_TPSZ_CD10,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '11' THEN 1 END),0) AS EQ_TPSZ_CD11,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '12' THEN 1 END),0) AS EQ_TPSZ_CD12,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '13' THEN 1 END),0) AS EQ_TPSZ_CD13,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '14' THEN 1 END),0) AS EQ_TPSZ_CD14,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '15' THEN 1 END),0) AS EQ_TPSZ_CD15,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '16' THEN 1 END),0) AS EQ_TPSZ_CD16,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '17' THEN 1 END),0) AS EQ_TPSZ_CD17,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '18' THEN 1 END),0) AS EQ_TPSZ_CD18,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '19' THEN 1 END),0) AS EQ_TPSZ_CD19,
    NVL(SUM(CASE WHEN t1.DP_SEQ = '20' THEN 1 END),0) AS EQ_TPSZ_CD20
FROM 
    CGM_EQUIPMENT A,
#if (${atch_bare} != '')
	( SELECT A.EQ_NO FROM  CGM_EQ_ATCH_DTCH_HIS A
    	WHERE A.DTCH_DT = TO_DATE('88881231','YYYYMMDD')
	    GROUP BY A.EQ_NO
	   ) T8,
#end
    MDM_LOCATION B,
    MDM_EQ_ORZ_CHT C,
    COM_INTG_CD_DTL D
    
#if (${group1} == '4') 
    , MDM_VENDOR D
#end    
#if (${group1} == '5') 
    , MDM_VENDOR E
#end
	, CGM_EQ_TP_SZ t1       
WHERE 
    A.CRNT_LOC_CD = B.LOC_CD
	AND A.EQ_TPSZ_CD = t1.EQ_TPSZ_CD
#if (${atch_bare} != '')
    AND A.EQ_NO= T8.EQ_NO(+)
#end
    AND B.SCC_CD = C.SCC_CD
    AND B.DELT_FLG = 'N'
    AND (C.DELT_FLG = 'N' OR C.DELT_FLG IS NULL)
	AND A.EQ_KND_CD = @[eq_knd_cd]

    AND A.AGMT_LSTM_CD = D.INTG_CD_VAL_CTNT (+)
    AND 'CD01948' = D.INTG_CD_ID (+)
    	
#if (${location} == 'RCC')
	AND C.RCC_CD = @[crnt_loc_cd]
#elseif (${location} == 'LCC')
	AND C.LCC_CD = @[crnt_loc_cd]
#elseif (${location} == 'SCC')
	AND C.SCC_CD = @[crnt_loc_cd]
#end
#if (${group1} == '4') 
    AND A.VNDR_SEQ = D.VNDR_SEQ
#end    
#if (${group1} == '5') 
    AND A.VNDR_SEQ = E.VNDR_SEQ
#end   
#if (${crnt_yd_cd} != '')
	AND A.CRNT_YD_CD IN ($crnt_yd_cd)
#end
#if (${aciac_div_cd} != '')
	AND A.ACIAC_DIV_CD = @[aciac_div_cd]
#end
#if (${eq_tpsz_cd} != '')
	AND A.EQ_TPSZ_CD IN ($eq_tpsz_cd)
#end

#if (${atch_bare} == 'ATTACHED')
	AND	T8.EQ_NO IS NOT NULL
#elseif (${atch_bare} == 'BARE')
	AND T8.EQ_NO IS NULL  
#end

#if (${dmg_snd} == 'DAMAGE')
AND A.DMG_FLG = 'Y'
#elseif (${dmg_snd} == 'SOUND')
AND ((A.DMG_FLG <> 'Y') or (A.DMG_FLG IS NULL))
#end

GROUP BY
#if (${group1} == '1') 
	C.LCC_CD ,
#elseif (${group1} == '2') 
    C.SCC_CD ,
#elseif (${group1} == '3') 
	A.CRNT_YD_CD ,
#elseif (${group1} == '4') 
	D.VNDR_ABBR_NM||' ('||A.VNDR_SEQ||')' ,
#elseif (${group1} == '5') 
    A.AGMT_OFC_CTY_CD || LPAD(A.AGMT_SEQ, 6, '0')||' ('||E.VNDR_ABBR_NM||')'  ,
#end
    A.AGMT_LSTM_CD ,
    D.INTG_CD_VAL_DP_SEQ
    
ORDER BY
#if (${group1} == '1') 
	C.LCC_CD ASC ,
#elseif (${group1} == '2') 
    C.SCC_CD ASC ,
#elseif (${group1} == '3') 
	A.CRNT_YD_CD ASC ,
#elseif (${group1} == '4') 
	D.VNDR_ABBR_NM||' ('||A.VNDR_SEQ||')' ASC ,
#elseif (${group1} == '5') 
    A.AGMT_OFC_CTY_CD || LPAD(A.AGMT_SEQ, 6, '0')||' ('||E.VNDR_ABBR_NM||')' ASC ,
#end 
    --A.AGMT_LSTM_CD ASC
    D.INTG_CD_VAL_DP_SEQ			]]></sql>
			<params>
				<param name="eq_knd_cd" type="12" value="" out="N"/>
				<param name="crnt_loc_cd" type="12" value="" out="N"/>
				<param name="aciac_div_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
