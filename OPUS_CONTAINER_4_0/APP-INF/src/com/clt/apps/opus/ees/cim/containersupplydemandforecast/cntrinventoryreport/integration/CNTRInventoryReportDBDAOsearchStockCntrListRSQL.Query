<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CNTRInventoryReportDBDAOsearchStockCntrListRSQL">
			<desc><![CDATA[구주지역내 SCC 또는 Yard별 MT 재고를 컨테이너별로 조회한다.(팝업)]]></desc>
			<sql><![CDATA[
SELECT
         A.LOC_CD
        ,A.CNTR_NO
        ,A.CNTR_TPSZ_CD
        ,A.DMG_FLG
		,A.DMG_FLG_DT
		,A.DMG_UNFLG_DT
        ,A.LSTM_CD
        ,A.BKG_NO
        ,A.VVD
        ,A.CNMV_DT
FROM 
(
    SELECT 
        A.CRNT_YD_CD  LOC_CD
        ,A.CNTR_NO
        ,A.CNTR_TPSZ_CD
        ,A.DMG_FLG
		,MST_COMMON_PKG.MST_DMG_DT_GET_FNC(A.CNTR_NO, 'FLG' ) AS DMG_FLG_DT
		,MST_COMMON_PKG.MST_DMG_DT_GET_FNC(A.CNTR_NO, 'UNFLG' ) AS DMG_UNFLG_DT
        ,A.LSTM_CD
        ,A.BKG_NO
        ,B.TRNK_VSL_CD||B.TRNK_SKD_VOY_NO||B.TRNK_SKD_DIR_CD VVD
        ,TO_CHAR(A.CNMV_DT,'YYYY-MM-DD') CNMV_DT
    FROM MST_CONTAINER A
        ,CTM_MOVEMENT B
	WHERE A.CNTR_NO =B.CNTR_NO
	AND  A.CNMV_YR=B.CNMV_YR
	AND A.CNMV_ID_NO=B.CNMV_ID_NO
	AND DECODE(@[lvl],'10',  DECODE(@[loc_type_code],1,A.RCC_CD,2,A.LCC_CD,3,A.ECC_CD,4,A.SCC_CD),  DECODE(@[yard_cd],NULL,A.LOC_CD,A.CRNT_YD_CD)) = DECODE(@[yard_cd],NULL,@[loc_cd],@[yard_cd])
    #if (${yard_cd} != '')
        AND DECODE(@[loc_type_code],'4',A.CRNT_YD_CD,A.SCC_CD) = @[yard_cd]
    #end
    AND A.ACIAC_DIV_CD = 'A'
    AND A.CNMV_STS_CD = 'MT'
    #if (${cntr_tpsz_cd} != '')
    	AND A.CNTR_TPSZ_CD  =@[cntr_tpsz_cd]
    #end
    
    UNION ALL
    
    SELECT 
		''
     	,      SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd1] ,1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd2] ,1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd3] ,1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd4] ,1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd5] ,1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd6] ,1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd7] ,1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd8] ,1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd9] ,1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd10],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd11],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd12],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd13],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd14],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd15],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd16],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd17],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd18],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd19],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd20],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd21],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd22],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd23],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd24],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd25],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd26],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd27],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd28],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd29],1)) 
        ||'|'||SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd30],1)) 
        ,''
		,''
		,''
        ,''
        ,''
        ,''
        ,''
        ,''
    FROM MST_CONTAINER A
	WHERE DECODE(@[lvl],'10',  DECODE(@[loc_type_code],1,A.RCC_CD,2,A.LCC_CD,3,A.ECC_CD,4,A.SCC_CD),  DECODE(@[yard_cd],NULL,A.LOC_CD,A.CRNT_YD_CD)) = DECODE(@[yard_cd],NULL,@[loc_cd],@[yard_cd])

    #if (${yard_cd} != '')
        AND DECODE(@[loc_type_code],'4',A.CRNT_YD_CD,A.SCC_CD) = @[yard_cd]
    #end
    AND A.ACIAC_DIV_CD = 'A'
    AND A.CNMV_STS_CD = 'MT'
    #if (${cntr_tpsz_cd} != '')
    	AND A.CNTR_TPSZ_CD  =@[cntr_tpsz_cd]
    #end
    GROUP BY DECODE(@[loc_type_code],1,A.RCC_CD,2,A.LCC_CD,3,A.ECC_CD,4,A.SCC_CD)
) A    
ORDER BY A.LOC_CD ,A.CNTR_NO,A.CNTR_TPSZ_CD,A.DMG_FLG			]]></sql>
			<params>
				<param name="lvl" type="12" value="" out="N"/>
				<param name="loc_type_code" type="12" value="" out="N"/>
				<param name="yard_cd" type="12" value="" out="N"/>
				<param name="loc_cd" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd1" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd2" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd3" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd4" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd5" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd6" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd7" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd8" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd9" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd10" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd11" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd12" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd13" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd14" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd15" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd16" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd17" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd18" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd19" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd20" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd21" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd22" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd23" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd24" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd25" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd26" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd27" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd28" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd29" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd30" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
