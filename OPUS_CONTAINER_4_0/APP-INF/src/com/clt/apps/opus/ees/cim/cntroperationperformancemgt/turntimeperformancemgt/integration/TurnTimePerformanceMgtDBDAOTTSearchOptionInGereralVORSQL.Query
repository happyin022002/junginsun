<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="TurnTimePerformanceMgtDBDAOTTSearchOptionInGereralVORSQL">
			<desc><![CDATA[   ]]></desc>
			<sql><![CDATA[
#if (${mvmtPairDivision} == '1' )
SELECT 
	'11111' pol ,
	'11111' etc,
	0 total,
	SUM(DECODE(DSP_SEQ,'01',XXX,0)) AS count01, 
	SUM(DECODE(DSP_SEQ,'02',XXX,0)) AS count02, 
	SUM(DECODE(DSP_SEQ,'03',XXX,0)) AS count03, 
	SUM(DECODE(DSP_SEQ,'04',XXX,0)) AS count04, 
	SUM(DECODE(DSP_SEQ,'05',XXX,0)) AS count05, 
	SUM(DECODE(DSP_SEQ,'06',XXX,0)) AS count06, 
	SUM(DECODE(DSP_SEQ,'07',XXX,0)) AS count07, 
	SUM(DECODE(DSP_SEQ,'08',XXX,0)) AS count08, 
	SUM(DECODE(DSP_SEQ,'09',XXX,0)) AS count09, 
	SUM(DECODE(DSP_SEQ,'10',XXX,0)) AS count10, 
	SUM(DECODE(DSP_SEQ,'11',XXX,0)) AS count11, 
	SUM(DECODE(DSP_SEQ,'12',XXX,0)) AS count12, 
	SUM(DECODE(DSP_SEQ,'13',XXX,0)) AS count13, 
	SUM(DECODE(DSP_SEQ,'14',XXX,0)) AS count14, 
	SUM(DECODE(DSP_SEQ,'15',XXX,0)) AS count15, 
	SUM(DECODE(DSP_SEQ,'16',XXX,0)) AS count16, 
	SUM(DECODE(DSP_SEQ,'17',XXX,0)) AS count17, 
	SUM(DECODE(DSP_SEQ,'18',XXX,0)) AS count18, 
	SUM(DECODE(DSP_SEQ,'19',XXX,0)) AS count19, 
	SUM(DECODE(DSP_SEQ,'20',XXX,0)) AS count20, 
	SUM(DECODE(DSP_SEQ,'21',XXX,0)) AS count21, 
	SUM(DECODE(DSP_SEQ,'22',XXX,0)) AS count22, 
	SUM(DECODE(DSP_SEQ,'23',XXX,0)) AS count23, 
	SUM(DECODE(DSP_SEQ,'24',XXX,0)) AS count24, 
	SUM(DECODE(DSP_SEQ,'25',XXX,0)) AS count25, 
	SUM(DECODE(DSP_SEQ,'26',XXX,0)) AS count26, 
	SUM(DECODE(DSP_SEQ,'27',XXX,0)) AS count27, 
	SUM(DECODE(DSP_SEQ,'28',XXX,0)) AS count28, 
	SUM(DECODE(DSP_SEQ,'29',XXX,0)) AS count29, 
	SUM(DECODE(DSP_SEQ,'30',XXX,0)) AS count30, 
	SUM(DECODE(DSP_SEQ,'31',XXX,0)) AS count31, 
	SUM(DECODE(DSP_SEQ,'32',XXX,0)) AS count32, 
	SUM(DECODE(DSP_SEQ,'33',XXX,0)) AS count33, 
	SUM(DECODE(DSP_SEQ,'34',XXX,0)) AS count34, 
	SUM(DECODE(DSP_SEQ,'35',XXX,0)) AS count35, 
	SUM(DECODE(DSP_SEQ,'36',XXX,0)) AS count36, 
	SUM(DECODE(DSP_SEQ,'37',XXX,0)) AS count37, 
	SUM(DECODE(DSP_SEQ,'38',XXX,0)) AS count38, 
	SUM(DECODE(DSP_SEQ,'39',XXX,0)) AS count39, 
	SUM(DECODE(DSP_SEQ,'40',XXX,0)) AS count40  
FROM 
( 
SELECT  DP_SEQ DSP_SEQ, 
		DECODE( @[tpsz] , 'A' , 1 , DECODE( CNTR_TPSZ_DIV_CD , @[tpsz] , 1 , 0 ) ) XXX 
FROM    CIM_TP_SZ_DP_SEQ_V 
ORDER BY  DP_SEQ 
) Z 
UNION ALL
SELECT 
        NVL(LOC_CD,'') pol ,
        DECODE( 
				TYPE_CD,
				'FD' , 'IC-ID', 
				'MG' , 'ID-MT', 
				'MP' , 'MT-OP',
				'MR' , 'MT-VL',  
				'FH' , 'MT-XX', 
				'OF' , 'OP-VL',  
				'IF' , 'VD-MT', 
				'TL' , 'VD-TS-VL','X') etc,
 		ROUND(SUM(T_TIME) / SUM(T_CNT) ,1 ) AS total,
        DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '01',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '01',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '01',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '01',T_CNT,0))),1)) AS count01,		
        DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '02',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '02',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '02',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '02',T_CNT,0))),1)) AS count02,		
        DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '03',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '03',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '03',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '03',T_CNT,0))),1)) AS count03,		
        DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '04',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '04',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '04',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '04',T_CNT,0))),1)) AS count04,		
        DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '05',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '05',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '05',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '05',T_CNT,0))),1)) AS count05,		
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '06',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '06',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '06',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '06',T_CNT,0))),1)) AS count06,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '07',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '07',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '07',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '07',T_CNT,0))),1)) AS count07,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '08',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '08',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '08',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '08',T_CNT,0))),1)) AS count08,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '09',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '09',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '09',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '09',T_CNT,0))),1)) AS count09,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '10',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '10',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '10',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '10',T_CNT,0))),1)) AS count10,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '11',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '11',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '11',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '11',T_CNT,0))),1)) AS count11,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '12',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '12',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '12',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '12',T_CNT,0))),1)) AS count12,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '13',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '13',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '13',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '13',T_CNT,0))),1)) AS count13,
        DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '14',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '14',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '14',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '14',T_CNT,0))),1)) AS count14,		
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '15',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '15',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '15',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '15',T_CNT,0))),1)) AS count15,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '16',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '16',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '16',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '16',T_CNT,0))),1)) AS count16,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '17',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '17',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '17',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '17',T_CNT,0))),1)) AS count17,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '18',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '18',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '18',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '18',T_CNT,0))),1)) AS count18,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '19',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '19',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '19',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '19',T_CNT,0))),1)) AS count19,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '20',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '20',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '20',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '20',T_CNT,0))),1)) AS count20,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '21',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '21',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '21',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '21',T_CNT,0))),1)) AS count21,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '22',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '22',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '22',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '22',T_CNT,0))),1)) AS count22,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '23',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '23',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '23',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '23',T_CNT,0))),1)) AS count23,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '24',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '24',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '24',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '24',T_CNT,0))),1)) AS count24,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '25',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '25',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '25',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '25',T_CNT,0))),1)) AS count25,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '26',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '26',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '26',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '26',T_CNT,0))),1)) AS count26,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '27',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '27',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '27',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '27',T_CNT,0))),1)) AS count27,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '28',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '28',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '28',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '28',T_CNT,0))),1)) AS count28,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '29',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '29',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '29',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '29',T_CNT,0))),1)) AS count29,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '30',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '30',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '30',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '30',T_CNT,0))),1)) AS count30,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '31',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '31',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '31',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '31',T_CNT,0))),1)) AS count31,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '32',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '32',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '32',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '32',T_CNT,0))),1)) AS count32,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '33',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '33',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '33',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '33',T_CNT,0))),1)) AS count33,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '34',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '34',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '34',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '34',T_CNT,0))),1)) AS count34,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '35',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '35',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '35',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '35',T_CNT,0))),1)) AS count35,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '36',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '36',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '36',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '36',T_CNT,0))),1)) AS count36,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '37',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '37',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '37',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '37',T_CNT,0))),1)) AS count37,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '38',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '38',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '38',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '38',T_CNT,0))),1)) AS count38,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '39',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '39',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '39',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '39',T_CNT,0))),1)) AS count39,
        DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '40',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '40',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '40',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '40',T_CNT,0))),1)) AS count40		


FROM      
        (
            SELECT	
			#if (${inquiryLevel} == 'AR' ) 
			--TG.RCC_CD LOC_CD,
			D.TO_RCC_CD LOC_CD, 
			#elseif (${inquiryLevel} == 'RL') 
			--TG.LCC_CD LOC_CD, 
			D.TO_LCC_CD LOC_CD, 
			#elseif (${inquiryLevel} == 'LE' || ${inquiryLevel} == 'RE') 
			--TG.ECC_CD LOC_CD, 
			D.TO_ECC_CD LOC_CD, 
			#elseif (${inquiryLevel} == 'LS' || ${inquiryLevel} == 'ES' || ${inquiryLevel} == 'SS') 
			--TG.SCC_CD LOC_CD, 
			D.TO_SCC_CD LOC_CD, 
			#elseif (${inquiryLevel} == 'AC' || ${inquiryLevel} == 'RC' || ${inquiryLevel} == 'CC') 
			--SUBSTR(TG.SCC_CD,1,2) LOC_CD, 
			SUBSTR(D.TO_SCC_CD,1,2) LOC_CD, 
			#end 
            		D.TT_SHP_TP_CD			TYPE_CD,
            		S.DP_SEQ				DSP_SEQ,
            		SUM  (D.TT_DYS)			T_TIME,
            		COUNT(DISTINCT M.CNTR_NO)	T_CNT
            FROM	CIM_SHP_TURN_TM			M,
            		CIM_SHP_TURN_TM_DTL		D,
            		--MDM_LOCATION			FL,		/* From Loc Location */
            		--MDM_EQ_ORZ_CHT		FG,		/* From Loc Orgnization */
            		--MDM_LOCATION			TL,		/* To Loc Location */
            		--MDM_EQ_ORZ_CHT		TG,		/* To Loc Organization */
            		CIM_TP_SZ_DP_SEQ_V		S
	    	#if (${period} == 'M') 
        		WHERE	D.TGT_MVMT_DT	BETWEEN    @[from]	AND @[to]
 	    	#elseif (${period} == 'W') 
        		WHERE	M.TGT_YRWK	BETWEEN    @[from]	AND @[to]
  			#end
										
			AND		M.TGT_MVMT_DT		=	D.TGT_MVMT_DT
            AND		M.CNTR_NO			=	D.CNTR_NO
            AND		M.IB_PORT_CD		=	D.IB_PORT_CD
            AND		M.ID_LOC_CD			=	D.ID_LOC_CD	

            AND     M.CNTR_TPSZ_CD		=   S.CNTR_TPSZ_CD

          --  AND     D.FM_LOC_CD		=   FL.LOC_CD
          --  AND     FL.SCC_CD			=   FG.SCC_CD
          --  AND     D.TO_LOC_CD		=   TL.LOC_CD
          --  AND     TL.SCC_CD			=   TG.SCC_CD

			#if (${inquiryLevel} != 'AR' && ${inquiryLevel} != 'AC')
				#if (${inquiryLevel} == 'RL' || ${inquiryLevel} == 'RE') 
					AND	D.TO_RCC_CD = @[location]
				#elseif (${inquiryLevel} == 'LE') 
					AND	D.TO_LCC_CD = @[location] 
				#elseif (${inquiryLevel} == 'LS') 
					AND	D.TO_LCC_CD = @[location] 
				#elseif (${inquiryLevel} == 'SS') 
					AND	D.TO_SCC_CD = @[location]
				#elseif (${inquiryLevel} == 'ES') 
					AND	D.TO_ECC_CD = @[location]
				#end

			#end

            AND		(
				#if (${inquiryLevel} == 'AR') 
					D.FM_RCC_CD
				#elseif (${inquiryLevel} == 'AC') 
					SUBSTR(D.FM_SCC_CD,1,2) 
				#elseif (${inquiryLevel} == 'RL') 
					D.FM_LCC_CD 
				#elseif (${inquiryLevel} == 'LE' || ${inquiryLevel} == 'RE') 
					D.FM_ECC_CD 
				#elseif (${inquiryLevel} == 'LS') 
					D.FM_SCC_CD 
				#elseif (${inquiryLevel} == 'SS') 
					D.FM_SCC_CD
				#elseif (${inquiryLevel} == 'ES') 
					D.FM_SCC_CD
				#end
				=
				#if (${inquiryLevel} == 'AR') 
					D.TO_RCC_CD
				#elseif (${inquiryLevel} == 'AC') 
					SUBSTR(D.TO_SCC_CD,1,2) 
				#elseif (${inquiryLevel} == 'RL') 
					D.TO_LCC_CD 
				#elseif (${inquiryLevel} == 'LE' || ${inquiryLevel} == 'RE') 
					D.TO_ECC_CD 
				#elseif (${inquiryLevel} == 'LS') 
					D.TO_SCC_CD  
				#elseif (${inquiryLevel} == 'SS') 
					D.TO_SCC_CD 
				#elseif (${inquiryLevel} == 'ES') 
					D.TO_SCC_CD 
				#end
            		)	

            AND		D.TT_SHP_TP_CD		IN	( 'MG','MP','MR','FH','FD','OF','IF','TL' )		
                 
			#if (${mvmtPair1} != 'AL') 
				AND		D.TT_SHP_TP_CD		=	@[mvmtPair1]
            #end

			#if (${tpsz} != 'A') 
				AND		S.CNTR_TPSZ_DIV_CD  =  @[tpsz]		/* CNTR TPSZ */
            #end
			
			#if (${soc} == 'E')
				AND		M.SOC_FLG			=	'N'					/* soc */
			#elseif (${soc} == 'O') 
				AND		M.SOC_FLG			=	'Y'					/* soc */
			#end

			AND		D.TT_SHP_TP_SEQ =	(
											SELECT	/*+ INDEX( DD XPKCIM_SHP_TURN_TM_DTL ) */
													DD.TT_SHP_TP_SEQ
											FROM	CIM_SHP_TURN_TM_DTL		DD
											WHERE	DD.TGT_MVMT_DT		=	D.TGT_MVMT_DT
											AND		DD.CNTR_NO			=	D.CNTR_NO
											AND		DD.IB_PORT_CD		=	D.IB_PORT_CD
											AND		DD.ID_LOC_CD		=	D.ID_LOC_CD
											AND		DD.TT_SHP_TP_CD		=	D.TT_SHP_TP_CD
											AND		(
														#if (${inquiryLevel} == 'AR') 
															DD.FM_RCC_CD
														#elseif (${inquiryLevel} == 'AC') 
															SUBSTR(DD.FM_SCC_CD,1,2) 
														#elseif (${inquiryLevel} == 'RL') 
															DD.FM_LCC_CD 
														#elseif (${inquiryLevel} == 'LE' || ${inquiryLevel} == 'RE') 
															DD.FM_ECC_CD 
														#elseif (${inquiryLevel} == 'LS') 
															DD.FM_SCC_CD 
														#elseif (${inquiryLevel} == 'SS') 
															DD.FM_SCC_CD
														#elseif (${inquiryLevel} == 'ES') 
															DD.FM_SCC_CD
														#end
														=
														#if (${inquiryLevel} == 'AR') 
															DD.TO_RCC_CD
														#elseif (${inquiryLevel} == 'AC') 
															SUBSTR(DD.TO_SCC_CD,1,2) 
														#elseif (${inquiryLevel} == 'RL') 
															DD.TO_LCC_CD 
														#elseif (${inquiryLevel} == 'LE' || ${inquiryLevel} == 'RE') 
															DD.TO_ECC_CD 
														#elseif (${inquiryLevel} == 'LS') 
															DD.TO_SCC_CD  
														#elseif (${inquiryLevel} == 'SS') 
															DD.TO_SCC_CD 
														#elseif (${inquiryLevel} == 'ES') 
															DD.TO_SCC_CD 
														#end
													)	
											AND		ROWNUM				=	1
										)
            GROUP BY
			#if (${inquiryLevel} == 'AR' ) 
			D.TO_RCC_CD, 
			#elseif (${inquiryLevel} == 'RL') 
			D.TO_LCC_CD, 
			#elseif (${inquiryLevel} == 'LE' || ${inquiryLevel} == 'RE') 
			D.TO_ECC_CD, 
			#elseif (${inquiryLevel} == 'LS' || ${inquiryLevel} == 'ES' || ${inquiryLevel} == 'SS') 
			D.TO_SCC_CD, 
			#elseif (${inquiryLevel} == 'AC' || ${inquiryLevel} == 'RC' || ${inquiryLevel} == 'CC') 
			SUBSTR(D.TO_SCC_CD,1,2), 
			#end 
            		D.TT_SHP_TP_CD			,
            		S.DP_SEQ			
        )
GROUP BY
         ROLLUP(LOC_CD)  ,
         DECODE( 
				TYPE_CD,
				'FD' , 'IC-ID', 
				'MG' , 'ID-MT', 
				'MP' , 'MT-OP',
				'MR' , 'MT-VL', 
				'FH' , 'MT-XX', 
				'OF' , 'OP-VL', 
				'IF' , 'VD-MT', 
				'TL' , 'VD-TS-VL','X')    
ORDER BY
        pol,
		etc  

#else

SELECT 
		'11111' pol ,
		'11111' etc,
		0 total,
		SUM(DECODE(DSP_SEQ,'01',XXX,0)) AS count01, 
		SUM(DECODE(DSP_SEQ,'02',XXX,0)) AS count02, 
		SUM(DECODE(DSP_SEQ,'03',XXX,0)) AS count03, 
		SUM(DECODE(DSP_SEQ,'04',XXX,0)) AS count04, 
		SUM(DECODE(DSP_SEQ,'05',XXX,0)) AS count05, 
		SUM(DECODE(DSP_SEQ,'06',XXX,0)) AS count06, 
		SUM(DECODE(DSP_SEQ,'07',XXX,0)) AS count07, 
		SUM(DECODE(DSP_SEQ,'08',XXX,0)) AS count08, 
		SUM(DECODE(DSP_SEQ,'09',XXX,0)) AS count09, 
		SUM(DECODE(DSP_SEQ,'10',XXX,0)) AS count10, 
		SUM(DECODE(DSP_SEQ,'11',XXX,0)) AS count11, 
		SUM(DECODE(DSP_SEQ,'12',XXX,0)) AS count12, 
		SUM(DECODE(DSP_SEQ,'13',XXX,0)) AS count13, 
		SUM(DECODE(DSP_SEQ,'14',XXX,0)) AS count14, 
		SUM(DECODE(DSP_SEQ,'15',XXX,0)) AS count15, 
		SUM(DECODE(DSP_SEQ,'16',XXX,0)) AS count16, 
		SUM(DECODE(DSP_SEQ,'17',XXX,0)) AS count17, 
		SUM(DECODE(DSP_SEQ,'18',XXX,0)) AS count18, 
		SUM(DECODE(DSP_SEQ,'19',XXX,0)) AS count19, 
		SUM(DECODE(DSP_SEQ,'20',XXX,0)) AS count20, 
		SUM(DECODE(DSP_SEQ,'21',XXX,0)) AS count21, 
		SUM(DECODE(DSP_SEQ,'22',XXX,0)) AS count22, 
		SUM(DECODE(DSP_SEQ,'23',XXX,0)) AS count23, 
		SUM(DECODE(DSP_SEQ,'24',XXX,0)) AS count24, 
		SUM(DECODE(DSP_SEQ,'25',XXX,0)) AS count25, 
		SUM(DECODE(DSP_SEQ,'26',XXX,0)) AS count26, 
		SUM(DECODE(DSP_SEQ,'27',XXX,0)) AS count27, 
		SUM(DECODE(DSP_SEQ,'28',XXX,0)) AS count28, 
		SUM(DECODE(DSP_SEQ,'29',XXX,0)) AS count29, 
		SUM(DECODE(DSP_SEQ,'30',XXX,0)) AS count30, 
		SUM(DECODE(DSP_SEQ,'31',XXX,0)) AS count31, 
		SUM(DECODE(DSP_SEQ,'32',XXX,0)) AS count32, 
		SUM(DECODE(DSP_SEQ,'33',XXX,0)) AS count33, 
		SUM(DECODE(DSP_SEQ,'34',XXX,0)) AS count34, 
		SUM(DECODE(DSP_SEQ,'35',XXX,0)) AS count35, 
		SUM(DECODE(DSP_SEQ,'36',XXX,0)) AS count36, 
		SUM(DECODE(DSP_SEQ,'37',XXX,0)) AS count37, 
		SUM(DECODE(DSP_SEQ,'38',XXX,0)) AS count38, 
		SUM(DECODE(DSP_SEQ,'39',XXX,0)) AS count39, 
		SUM(DECODE(DSP_SEQ,'40',XXX,0)) AS count40  
FROM 
		( 
			SELECT	DP_SEQ DSP_SEQ, 
					DECODE( @[tpsz] , 'A' , 1 , DECODE( CNTR_TPSZ_DIV_CD , @[tpsz] , 1 , 0 ) ) XXX 
			FROM    CIM_TP_SZ_DP_SEQ_V 
			ORDER BY  
					DP_SEQ 
		) Z 
UNION ALL
SELECT 
		NVL(LOC_CD,'') pol ,
		DECODE	( 
					TYPE_CD,
					'A' , 'IC-EN', 
					'B' , 'EN-IC', 
					'C' , 'IC-ID',
					'D' , 'ID-MT', 
					'E' , 'MT-EN', 
					'F' , 'MT-XX', 
					'G' , 'XX-MT', 
					'H' , 'MT-OP', 
					'I' , 'OP-OC', 
					'J' , 'OC-EN', 
					'K' , 'EN-OC', 
					'L' , 'OC-VL', 
					'M' , 'EN-MT', 
					'N' , 'MT-VL', 
					'O' , 'MT-TN','X' ) etc, 
		ROUND(SUM(T_TIME) / SUM(T_CNT) ,1 ) AS total,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '01',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '01',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '01',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '01',T_CNT,0))),1)) AS count01,  
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '02',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '02',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '02',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '02',T_CNT,0))),1)) AS count02,  
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '03',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '03',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '03',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '03',T_CNT,0))),1)) AS count03,  
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '04',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '04',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '04',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '04',T_CNT,0))),1)) AS count04,  
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '05',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '05',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '05',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '05',T_CNT,0))),1)) AS count05,  
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '06',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '06',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '06',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '06',T_CNT,0))),1)) AS count06,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '07',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '07',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '07',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '07',T_CNT,0))),1)) AS count07,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '08',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '08',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '08',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '08',T_CNT,0))),1)) AS count08,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '09',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '09',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '09',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '09',T_CNT,0))),1)) AS count09,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '10',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '10',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '10',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '10',T_CNT,0))),1)) AS count10,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '11',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '11',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '11',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '11',T_CNT,0))),1)) AS count11,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '12',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '12',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '12',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '12',T_CNT,0))),1)) AS count12,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '13',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '13',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '13',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '13',T_CNT,0))),1)) AS count13,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '14',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '14',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '14',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '14',T_CNT,0))),1)) AS count14,  
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '15',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '15',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '15',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '15',T_CNT,0))),1)) AS count15,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '16',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '16',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '16',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '16',T_CNT,0))),1)) AS count16,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '17',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '17',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '17',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '17',T_CNT,0))),1)) AS count17,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '18',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '18',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '18',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '18',T_CNT,0))),1)) AS count18,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '19',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '19',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '19',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '19',T_CNT,0))),1)) AS count19,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '20',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '20',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '20',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '20',T_CNT,0))),1)) AS count20,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '21',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '21',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '21',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '21',T_CNT,0))),1)) AS count21,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '22',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '22',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '22',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '22',T_CNT,0))),1)) AS count22,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '23',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '23',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '23',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '23',T_CNT,0))),1)) AS count23,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '24',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '24',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '24',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '24',T_CNT,0))),1)) AS count24,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '25',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '25',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '25',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '25',T_CNT,0))),1)) AS count25,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '26',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '26',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '26',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '26',T_CNT,0))),1)) AS count26,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '27',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '27',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '27',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '27',T_CNT,0))),1)) AS count27,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '28',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '28',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '28',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '28',T_CNT,0))),1)) AS count28,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '29',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '29',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '29',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '29',T_CNT,0))),1)) AS count29,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '30',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '30',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '30',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '30',T_CNT,0))),1)) AS count30,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '31',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '31',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '31',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '31',T_CNT,0))),1)) AS count31,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '32',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '32',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '32',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '32',T_CNT,0))),1)) AS count32,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '33',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '33',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '33',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '33',T_CNT,0))),1)) AS count33,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '34',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '34',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '34',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '34',T_CNT,0))),1)) AS count34,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '35',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '35',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '35',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '35',T_CNT,0))),1)) AS count35,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '36',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '36',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '36',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '36',T_CNT,0))),1)) AS count36,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '37',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '37',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '37',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '37',T_CNT,0))),1)) AS count37,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '38',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '38',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '38',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '38',T_CNT,0))),1)) AS count38,
		DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '39',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '39',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '39',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '39',T_CNT,0))),1)) AS count39,
        DECODE(GROUPING_ID(LOC_CD),0,SUM( DECODE( DSP_SEQ,  '40',ROUND(T_TIME / T_CNT ,1 ),0)),ROUND(SUM(DECODE( DSP_SEQ,  '40',T_TIME,0))/DECODE(SUM(DECODE( DSP_SEQ,  '40',T_CNT,0)),0,1,SUM(DECODE( DSP_SEQ,  '40',T_CNT,0))),1)) AS count40  
FROM      
        (
			SELECT /*+  LEADING ( FG FL M S ) USE_NL ( FG FL M S ) INDEX (M XAK1CIM_MVMT_STS_TURN_TM) */
					
					#if (${inquiryLevel} == 'AR' ) 
					FG.RCC_CD LOC_CD, 
					#elseif (${inquiryLevel} == 'RL') 
					FG.LCC_CD LOC_CD, 
					#elseif (${inquiryLevel} == 'LE' || ${inquiryLevel} == 'RE') 
					FG.ECC_CD LOC_CD, 
					#elseif (${inquiryLevel} == 'LS' || ${inquiryLevel} == 'ES') 
					FG.SCC_CD LOC_CD, 
					#elseif (${inquiryLevel} == 'SS') 
					NVL(M.FM_YD_CD,FG.SCC_CD)	LOC_CD,
					#elseif (${inquiryLevel} == 'AC' || ${inquiryLevel} == 'RC' || ${inquiryLevel} == 'CC') 
					SUBSTR(FG.SCC_CD,1,2) LOC_CD, 
					#end 
					
					M.TT_MVMT_TP_CD				TYPE_CD,
					S.DP_SEQ					DSP_SEQ,
					SUM  (M.TT_DYS)				T_TIME,
					SUM  (M.CNTR_KNT)			T_CNT
			FROM	
					CIM_MVMT_STS_TURN_TM_SMRY	M,
					MDM_LOCATION				FL,  /* From Loc Location */
					MDM_EQ_ORZ_CHT				FG,  /* From Loc Orgnization */
					CIM_TP_SZ_DP_SEQ_V			S
			
			#if (${period} == 'M') 
			WHERE M.TGT_MVMT_DT BETWEEN    @[from] AND @[to]
			#elseif (${period} == 'W') 
			WHERE M.TGT_YRWK BETWEEN    @[from] AND @[to]
			#end

			AND     M.CNTR_TPSZ_CD  =   S.CNTR_TPSZ_CD
			AND     M.FM_LOC_CD		=   FL.LOC_CD
			AND     FL.SCC_CD		=   FG.SCC_CD
			
			#if (${inquiryLevel} != 'AR' && ${inquiryLevel} != 'AC')         

				#if (${inquiryLevel} == 'RL' || ${inquiryLevel} == 'RE') 
					AND  FG.RCC_CD = @[location] 
				#elseif (${inquiryLevel} == 'LE') 
					AND  FG.LCC_CD = @[location] 
				#elseif (${inquiryLevel} == 'LS') 
					AND  FG.LCC_CD = @[location] 
				#elseif (${inquiryLevel} == 'SS') 
					AND  FG.SCC_CD = @[location]
				#elseif (${inquiryLevel} == 'ES') 
					AND  FG.ECC_CD = @[location]
				#end

			#end

			#if (${mvmtPair2} != 'Z') 
			AND  M.TT_MVMT_TP_CD  = @[mvmtPair2]
			#end
			
			#if (${tpsz} != 'A') 
			AND  S.CNTR_TPSZ_DIV_CD  =  @[tpsz]  /* CNTR TPSZ */
			#end

			#if (${soc} == 'E')
			AND  M.SOC_FLG   = 'N'     /* soc */
			#elseif (${soc} == 'O') 
			AND  M.SOC_FLG   = 'Y'     /* soc */
			#end

			GROUP BY
						#if (${inquiryLevel} == 'AR' ) 
						FG.RCC_CD, 
						#elseif (${inquiryLevel} == 'RL') 
						FG.LCC_CD, 
						#elseif (${inquiryLevel} == 'LE' || ${inquiryLevel} == 'RE') 
						FG.ECC_CD, 
						#elseif (${inquiryLevel} == 'LS' || ${inquiryLevel} == 'ES') 
						FG.SCC_CD, 
						#elseif (${inquiryLevel} == 'SS') 
						NVL(M.FM_YD_CD,FG.SCC_CD),
						#elseif (${inquiryLevel} == 'AC' || ${inquiryLevel} == 'RC' || ${inquiryLevel} == 'CC') 
						SUBSTR(FG.SCC_CD,1,2), 
						#end 
						M.TT_MVMT_TP_CD ,
						S.DP_SEQ    
        )
GROUP BY
		ROLLUP(LOC_CD)  ,
		DECODE	( 
					TYPE_CD,
					'A' , 'IC-EN', 
					'B' , 'EN-IC', 
					'C' , 'IC-ID',
					'D' , 'ID-MT', 
					'E' , 'MT-EN', 
					'F' , 'MT-XX', 
					'G' , 'XX-MT', 
					'H' , 'MT-OP', 
					'I' , 'OP-OC', 
					'J' , 'OC-EN', 
					'K' , 'EN-OC', 
					'L' , 'OC-VL', 
					'M' , 'EN-MT', 
					'N' , 'MT-VL',
					'O' , 'MT-TN',  'X')  
ORDER BY
		pol,
		etc 

#end			]]></sql>
			<params>
				<param name="tpsz" type="12" value="" out="N"/>
				<param name="from" type="12" value="" out="N"/>
				<param name="to" type="12" value="" out="N"/>
				<param name="location" type="12" value="" out="N"/>
				<param name="mvmtPair1" type="12" value="" out="N"/>
				<param name="mvmtPair2" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
