<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DMTCalculationDBDAOGetStopDaysRSQL">
			<desc><![CDATA[getStopDays]]></desc>
			<sql><![CDATA[
SELECT	CLK_STOP_NO TMP_CSTOP_NO
       ,DECODE (SIGN (TO_DATE (@[to_date], 'YYYYMMDD')
                     - TO_DATE (TO_CHAR (CLK_STOP_TO_DT, 'YYYYMMDD')
                               ,'YYYYMMDD')),1
              , TO_DATE (TO_CHAR (CLK_STOP_TO_DT, 'YYYYMMDD'), 'YYYYMMDD')
                - TO_DATE (TO_CHAR (CLK_STOP_FM_DT, 'YYYYMMDD'), 'YYYYMMDD')
                + 1
              , TO_DATE (@[to_date], 'YYYYMMDD')
                - TO_DATE (TO_CHAR (CLK_STOP_FM_DT, 'YYYYMMDD'), 'YYYYMMDD')
                + 1
              ) TMP_CSTOP_DAY
  FROM	DMT_TM_CLK_STOP
 WHERE	DMDT_TRF_CD		    =	@[dtt_code]
   AND	CLK_STOP_OFC_CD		=	@[ofc_cd]
   AND TO_DATE (TO_CHAR (CLK_STOP_FM_DT, 'YYYYMMDD'), 'YYYYMMDD')
          BETWEEN TO_DATE (@[ftime_end], 'YYYYMMDD')
              AND TO_DATE (@[to_date], 'YYYYMMDD')
   AND	CXL_FLG	      	    =	'N'
   AND  ALL_YD_FLG          =   'Y'
UNION ALL
SELECT	A.CLK_STOP_NO TMP_CSTOP_NO
       ,DECODE (SIGN (TO_DATE (@[to_date], 'YYYYMMDD')
                     - TO_DATE (TO_CHAR (A.CLK_STOP_TO_DT, 'YYYYMMDD')
                               ,'YYYYMMDD')),1
              , TO_DATE (TO_CHAR (A.CLK_STOP_TO_DT, 'YYYYMMDD'), 'YYYYMMDD')
                - TO_DATE (TO_CHAR (A.CLK_STOP_FM_DT, 'YYYYMMDD'), 'YYYYMMDD')
                + 1
              , TO_DATE (@[to_date], 'YYYYMMDD')
                - TO_DATE (TO_CHAR (A.CLK_STOP_FM_DT, 'YYYYMMDD'), 'YYYYMMDD')
                + 1
              ) TMP_CSTOP_DAY
  FROM	DMT_TM_CLK_STOP A, DMT_TM_CLK_STOP_YD B
 WHERE	A.DMDT_TRF_CD		    =	@[dtt_code]
   AND	A.CLK_STOP_OFC_CD		=	@[ofc_cd]
   AND TO_DATE (TO_CHAR (A.CLK_STOP_FM_DT, 'YYYYMMDD'), 'YYYYMMDD')
          BETWEEN TO_DATE (@[ftime_end], 'YYYYMMDD')
              AND TO_DATE (@[to_date], 'YYYYMMDD')
   AND	A.CXL_FLG	      	    =	'N'
   AND  A.ALL_YD_FLG            <>  'Y'
   AND  A.CLK_STOP_NO           =   B.CLK_STOP_NO
   AND  B.YD_CD                 =   @[yd_cd]			]]></sql>
			<params>
				<param name="to_date" type="12" value="" out="N"/>
				<param name="dtt_code" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="ftime_end" type="12" value="" out="N"/>
				<param name="yd_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
