<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EQAvailabilityFinderDBDAOsearchAvailTpSzListRSQL">
			<desc><![CDATA[EQ Availability 조회]]></desc>
			<sql><![CDATA[
SELECT A.SCC_CD AS SCC_CD
       ,  TO_CHAR(A.FCAST_DT,'YYYYMMDD') AS FCAST_DT
       ,  A.CNTR_TPSZ_CD AS TP_CD
       ,  SUM(A.EA) EA1
       ,  SUM(A.BR) BR1
       ,  SUM(A.PUP) PUP1
       ,  SUM(A.RO) RO1
       ,  SUM(A.OFH) OFH1
       ,  SUM(A.DG) DG1
       ,  SUM(A.SN) SN1
       ,  SUM(A.IG) IG1
       ,  SUM(A.RTN) RTN1
       ,  SUM(A.RI) RI1
       ,  SUM(A.ONH) ONH1
    FROM CIM_AVAL_SMRY_V A,
                     (          
                         SELECT
                             MAX(DECODE(RANK,1,CNTR_TPSZ_CD)) CNTR_TPSZ_CD_VAL1 
                            ,MAX(DECODE(RANK,2,CNTR_TPSZ_CD)) CNTR_TPSZ_CD_VAL2 
                            ,MAX(DECODE(RANK,3,CNTR_TPSZ_CD)) CNTR_TPSZ_CD_VAL3 
                            ,MAX(DECODE(RANK,4,CNTR_TPSZ_CD)) CNTR_TPSZ_CD_VAL4
               , @[loc_type_code] AS LOC_TP 
                         FROM
                         (
                             SELECT
                                    A.CNTR_TPSZ_CD
                                    ,RANK() OVER (ORDER BY A.CNTR_TPSZ_CD) RANK
                               FROM MDM_CNTR_TP_SZ A
                               WHERE A.CNTR_TPSZ_CD IN (@[cntr_tpsz_cd_val1],@[cntr_tpsz_cd_val2],@[cntr_tpsz_cd_val3],@[cntr_tpsz_cd_val4])
                               ORDER BY A.RPT_DP_SEQ
                         )
                     ) C
        , MDM_EQ_ORZ_CHT D
    WHERE D.SCC_CD = A.SCC_CD
           #if (${loc_type_code} == 'S')
                     AND D.SCC_CD = @[loc_cd]
           #elseif (${loc_type_code} == 'E')
                     AND D.ECC_CD = @[loc_cd]
           #elseif (${loc_type_code} == 'L')
                     AND D.LCC_CD = @[loc_cd]
           #elseif (${loc_type_code} == 'R')
                     AND D.RCC_CD = @[loc_cd]
           #elseif (${loc_type_code} == 'Y')
               AND A.YD_CD = @[loc_cd]
           #else
                     AND D.SCC_CD = @[loc_cd]
           #end
           #if (${rstr_usg_lbl} != '')
                     AND A.RSTR_USG_TP_LBL_DESC LIKE '%'|| @[rstr_usg_lbl] ||'%'
           #end 
    AND A.CNTR_TPSZ_CD IN (@[cntr_tpsz_cd_val1],@[cntr_tpsz_cd_val2],@[cntr_tpsz_cd_val3],@[cntr_tpsz_cd_val4])
    GROUP BY A.SCC_CD, A.CNTR_TPSZ_CD,  A.FCAST_DT
    ORDER BY A.SCC_CD, A.CNTR_TPSZ_CD,  A.FCAST_DT			]]></sql>
			<params>
				<param name="loc_type_code" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd_val1" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd_val2" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd_val3" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd_val4" type="12" value="" out="N"/>
				<param name="loc_cd" type="12" value="" out="N"/>
				<param name="rstr_usg_lbl" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
