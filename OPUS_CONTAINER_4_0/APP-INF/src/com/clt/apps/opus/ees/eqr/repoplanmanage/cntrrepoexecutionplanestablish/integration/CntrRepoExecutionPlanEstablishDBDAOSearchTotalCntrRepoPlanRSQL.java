/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : CntrRepoExecutionPlanEstablishDBDAOSearchTotalCntrRepoPlanRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.05.27
*@LastModifier : 이주현
*@LastVersion : 1.0
* 2016.05.27 이주현
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.ees.eqr.repoplanmanage.cntrrepoexecutionplanestablish.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author LEE JU HYUN
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class CntrRepoExecutionPlanEstablishDBDAOSearchTotalCntrRepoPlanRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * EES_EQR_0092
	  * </pre>
	  */
	public CntrRepoExecutionPlanEstablishDBDAOSearchTotalCntrRepoPlanRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fm_plnyrwk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("FM_PLNYRWK",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_plnyrwk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sosend",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("repo_pln_id",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("mty",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.ees.eqr.repoplanmanage.cntrrepoexecutionplanestablish.integration").append("\n"); 
		query.append("FileName : CntrRepoExecutionPlanEstablishDBDAOSearchTotalCntrRepoPlanRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT	PLN_YRWK			AS T5_PLN_YRWK" ).append("\n"); 
		query.append("		,COMPANY			AS T5_COMPANY" ).append("\n"); 
		query.append("		,DIVISION			AS T5_DIVISION" ).append("\n"); 
		query.append("		,ITEM       	 	AS T5_ITEM " ).append("\n"); 
		query.append("		,LANE				AS T5_LANE" ).append("\n"); 
		query.append("		,VVD				AS T5_VVD" ).append("\n"); 
		query.append("		,FRLOC				AS T5_FRLOC" ).append("\n"); 
		query.append("		,ETD				AS T5_ETD" ).append("\n"); 
		query.append("		,TOLOC				AS T5_TOLOC" ).append("\n"); 
		query.append("		,ETA				AS T5_ETA" ).append("\n"); 
		query.append("		,LSR        		AS T5_LSR	-- VENDOR ABBR NM" ).append("\n"); 
		query.append("		,SOSEND				AS T5_SOSENED" ).append("\n"); 
		query.append("		,MTY				AS T5_MTY" ).append("\n"); 
		query.append("		,REF_ID				AS T5_REF_ID" ).append("\n"); 
		query.append("		,BKG_NO				AS T5_BKG_NO" ).append("\n"); 
		query.append("		,PURPOSE			AS T5_PURPOSE" ).append("\n"); 
		query.append("		,REASON				AS T5_REASON" ).append("\n"); 
		query.append("		,REASONREMARK		AS T5_REASONREMARK" ).append("\n"); 
		query.append("		,SUM(TOTALVOL)  	AS TOTALVOL" ).append("\n"); 
		query.append("	#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("		,SUM(${key}VOL) 	AS T5_${key}VOL" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		,SORTNUM			AS T5_SORTNUM   	-- HIDDEN	PLAN(1), Execution(2), SO(3)를 구분" ).append("\n"); 
		query.append("		,NUM				AS T5_NUM        	-- HIDDEN 	NORMAL ROW(1), SUB TOTAL(2), GRAND TOTAL(3) 구분" ).append("\n"); 
		query.append("		,FM_ECC||TO_ECC		AS T5_SORT1" ).append("\n"); 
		query.append("FROM	(" ).append("\n"); 
		query.append("		SELECT	 DECODE(B.NUM, 1, A.PLN_YRWK, 2, A.PLN_YRWK||' TTL', 3, 'TOTAL') PLN_YRWK" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.COMPANY,  2, '', 3, '') COMPANY" ).append("\n"); 
		query.append("				,A.DIVISION" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.ITEM ,  2, '', 3, '') ITEM" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.LANE ,  2, '', 3, '') LANE" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.VVD  ,  2, '', 3, '') VVD" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.FRLOC,  2, '', 3, '') FRLOC" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.ETD  ,  2, NULL, 3, NULL) ETD" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.TOLOC,  2, '', 3, '') TOLOC" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.ETA  ,  2, NULL, 3, NULL) ETA" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.SOSEND  ,  2, NULL, 3, NULL) SOSEND" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.MTY,  2, '', 3, '') MTY" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.LSR,  2, '', 3, '') LSR" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.PURPOSE,  2, '', 3, '') PURPOSE" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.REASON,  2, '', 3, '') REASON" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.REASONREMARK,  2, '', 3, '') REASONREMARK" ).append("\n"); 
		query.append("				,SUM(A.TOTALVOL)  TOTALVOL" ).append("\n"); 
		query.append("				,SUM(A.TOTALCOST) TOTALCOST" ).append("\n"); 
		query.append("			#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("				,SUM(A.${key}VOL)     ${key}VOL" ).append("\n"); 
		query.append("				,SUM(A.${key}COST)    ${key}COST" ).append("\n"); 
		query.append("    		#end" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.REF_ID,  2, '', 3, '') REF_ID" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.BKG_NO,  2, '', 3, '') BKG_NO" ).append("\n"); 
		query.append("				,A.SORTNUM    	    -- HIDDEN" ).append("\n"); 
		query.append("				,B.NUM         		-- HIDDEN" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.FM_ECC,  2, '', 3, '') FM_ECC -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.TO_ECC,  2, '', 3, '') TO_ECC -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("		FROM	(" ).append("\n"); 
		query.append("				-- PLAN -------------------------------------------" ).append("\n"); 
		query.append("				-- 1. T.VVD & D.VVD(PLAN) ------------------------" ).append("\n"); 
		query.append("				SELECT	 A.PLN_YRWK" ).append("\n"); 
		query.append("						,' ' 			COMPANY" ).append("\n"); 
		query.append("						,'Plan' 			DIVISION" ).append("\n"); 
		query.append("						,A.TRSP_MOD_CD	ITEM" ).append("\n"); 
		query.append("						,A.VSL_LANE_CD 	LANE" ).append("\n"); 
		query.append("						,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD VVD" ).append("\n"); 
		query.append("						,A.FM_ECC_CD 		FRLOC" ).append("\n"); 
		query.append("						,TO_CHAR(A.FM_ETD_DT,'YYYY-MM-DD HH24:MI:SS') ETD" ).append("\n"); 
		query.append("						,A.TO_ECC_CD 		TOLOC" ).append("\n"); 
		query.append("						,TO_CHAR(A.TO_ETB_DT,'YYYY-MM-DD HH24:MI:SS') ETA" ).append("\n"); 
		query.append("						,'' 			SOSEND" ).append("\n"); 
		query.append("						,'' 			MTY" ).append("\n"); 
		query.append("						,'' 			LSR" ).append("\n"); 
		query.append("						,'' 			PURPOSE" ).append("\n"); 
		query.append("						,'' 			REASON" ).append("\n"); 
		query.append("						,'' 			REASONREMARK" ).append("\n"); 
		query.append("				#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("					#if($velocityCount == 1)" ).append("\n"); 
		query.append("						,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)" ).append("\n"); 
		query.append("					#else" ).append("\n"); 
		query.append("						+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)" ).append("\n"); 
		query.append("				    #end" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("						TOTALVOL" ).append("\n"); 
		query.append("				#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("					#if($velocityCount == 1)" ).append("\n"); 
		query.append("						,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.LODG_DCHG_COST_AMT)),0)" ).append("\n"); 
		query.append("					#else" ).append("\n"); 
		query.append("						+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.LODG_DCHG_COST_AMT)),0)" ).append("\n"); 
		query.append("					#end" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("						TOTALCOST" ).append("\n"); 
		query.append("				#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("						,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)        			${key}VOL" ).append("\n"); 
		query.append("						,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.LODG_DCHG_COST_AMT)),0)		${key}COST" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("						,'' REF_ID" ).append("\n"); 
		query.append("						,'' BKG_NO" ).append("\n"); 
		query.append("						,1 SORTNUM    	-- HIDDEN" ).append("\n"); 
		query.append("						,A.FM_ECC_CD FM_ECC -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("						,A.TO_ECC_CD TO_ECC -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("				FROM	(" ).append("\n"); 
		query.append("						SELECT	A.REPO_PLN_ID" ).append("\n"); 
		query.append("								,A.PLN_YRWK" ).append("\n"); 
		query.append("								,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("								,A.VSL_LANE_CD" ).append("\n"); 
		query.append("								,A.VSL_CD" ).append("\n"); 
		query.append("								,A.SKD_VOY_NO" ).append("\n"); 
		query.append("								,A.SKD_DIR_CD" ).append("\n"); 
		query.append("								,A.FM_ECC_CD" ).append("\n"); 
		query.append("								,A.FM_ETD_DT" ).append("\n"); 
		query.append("								,A.TO_ETB_DT" ).append("\n"); 
		query.append("								,A.TO_ECC_CD" ).append("\n"); 
		query.append("								,QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("								,QTY.CNTR_QTY" ).append("\n"); 
		query.append("								,QTY.LODG_DCHG_COST_AMT" ).append("\n"); 
		query.append("						FROM	 EQR_VSL_LODG_DCHG_PLN A" ).append("\n"); 
		query.append("								,EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("						WHERE	A.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("							AND	A.PLN_YRWK		= QTY.PLN_YRWK" ).append("\n"); 
		query.append("							AND	A.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("							AND	A.REPO_PLN_ID	= @[repo_pln_id]" ).append("\n"); 
		query.append("		 				#if ( ${userEcc} != ${userEcc} )" ).append("\n"); 
		query.append("		 					AND	(A.FM_ECC_CD IN ( ${userEccText} ) OR A.TO_ECC_CD IN ( ${userEccText} ) )" ).append("\n"); 
		query.append("		 				#end" ).append("\n"); 
		query.append("		 			#if ( ${fmtoat} == 1 )" ).append("\n"); 
		query.append("		 					AND	A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("		 				#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("		 					AND	A.FM_ECC_CD IN ( ${fromEccText} )" ).append("\n"); 
		query.append("		 				#end" ).append("\n"); 
		query.append("		 				#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("		 					AND	A.TO_ECC_CD IN ( ${toEccText} )" ).append("\n"); 
		query.append("		 				#end" ).append("\n"); 
		query.append("					#elseif ( ${fmtoat} == 3 )" ).append("\n"); 
		query.append("							AND	TO_CHAR(A.FM_ETD_DT ,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("																	AND	(SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("						#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("		 					AND	A.FM_ECC_CD IN ( ${fromEccText} )" ).append("\n"); 
		query.append("		 				#end" ).append("\n"); 
		query.append("		 				#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("		 					AND	A.TO_ECC_CD IN ( ${toEccText} )" ).append("\n"); 
		query.append("		 				#end" ).append("\n"); 
		query.append("					#elseif ( ${fmtoat} == 4 )" ).append("\n"); 
		query.append("							AND  TO_CHAR(A.TO_ETB_DT ,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("																	AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("						#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("		 					AND	A.FM_ECC_CD IN ( ${fromEccText} )" ).append("\n"); 
		query.append("		 				#end" ).append("\n"); 
		query.append("		 				#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("		 					AND	A.TO_ECC_CD IN ( ${toEccText} )" ).append("\n"); 
		query.append("		 				#end" ).append("\n"); 
		query.append("					#else" ).append("\n"); 
		query.append("						#if ( ${atstatus} != '' )" ).append("\n"); 
		query.append("							AND	(	(A.FM_ECC_CD IN ( ${fromEccText} ) AND A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]  )" ).append("\n"); 
		query.append("								OR	(A.TO_ECC_CD IN ( ${fromEccText} ) AND (SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETB_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT)" ).append("\n"); 
		query.append("																		BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("								)" ).append("\n"); 
		query.append("						#else" ).append("\n"); 
		query.append("							AND (	(A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]  )" ).append("\n"); 
		query.append("								OR	((SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT)" ).append("\n"); 
		query.append("									BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("								)" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("		 			#end" ).append("\n"); 
		query.append("						#if ( ${tpsz} != '' && ${tpsztype} != '')" ).append("\n"); 
		query.append("							AND	QTY.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("						#if ( ${itemText} != '' )" ).append("\n"); 
		query.append("							AND	A.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("						#if ( ${lane} != '' )" ).append("\n"); 
		query.append("							AND	A.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("						#if ( ${vvd} != '' )" ).append("\n"); 
		query.append("							AND	A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("						) A" ).append("\n"); 
		query.append("    					-- reason, company, mty 검색정보 사용시만 조인쿼리를 사용합니다." ).append("\n"); 
		query.append("    		#if ( ${reason} != '' || ${mty} != '' || ${sosend} != '' )" ).append("\n"); 
		query.append("    					,(" ).append("\n"); 
		query.append("						SELECT	 DISTINCT A.REPO_PLN_ID" ).append("\n"); 
		query.append("								,A.PLN_YRWK" ).append("\n"); 
		query.append("								,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("								,A.FM_YD_CD" ).append("\n"); 
		query.append("								,A.TO_YD_CD" ).append("\n"); 
		query.append("								,A.CO_CD" ).append("\n"); 
		query.append("								,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("								,A.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append("								,B.LOC_CD FM_ECC" ).append("\n"); 
		query.append("								,C.LOC_CD TO_ECC" ).append("\n"); 
		query.append("						FROM	 EQR_VSL_LODG_DCHG_EXE_PLN A" ).append("\n"); 
		query.append("								,MDM_EQ_ORZ_CHT B" ).append("\n"); 
		query.append("								,MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("								,MDM_LOCATION E" ).append("\n"); 
		query.append("								,MDM_LOCATION F" ).append("\n"); 
		query.append("						WHERE	SUBSTR(A.FM_YD_CD, 0, 5) = E.LOC_CD" ).append("\n"); 
		query.append("						AND     E.SCC_CD                 = B.SCC_CD" ).append("\n"); 
		query.append("						AND	SUBSTR(A.TO_YD_CD, 0, 5) = F.LOC_CD" ).append("\n"); 
		query.append("						AND     F.SCC_CD                 = C.SCC_CD" ).append("\n"); 
		query.append("						#if ( ${reason} != '' )" ).append("\n"); 
		query.append("							AND	A.REPO_PLN_FB_RSN_CD IN ( ${reasonText} )" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("						#if ( ${mty} != '' )" ).append("\n"); 
		query.append("							AND	A.REPO_MTY_BKG_FLG = @[mty]" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("						#if ( ${sosend} != '' )" ).append("\n"); 
		query.append("							AND	1=0" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("						) B" ).append("\n"); 
		query.append("				WHERE	A.REPO_PLN_ID = B.REPO_PLN_ID" ).append("\n"); 
		query.append("					AND	A.PLN_YRWK    = B.PLN_YRWK" ).append("\n"); 
		query.append("					AND	A.FM_ECC_CD   = B.FM_ECC" ).append("\n"); 
		query.append("					AND	A.TO_ECC_CD   = B.TO_ECC" ).append("\n"); 
		query.append("					AND	A.TRSP_MOD_CD = B.TRSP_MOD_CD" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				WHERE	1=1" ).append("\n"); 
		query.append("    		#end" ).append("\n"); 
		query.append("				GROUP BY A.PLN_YRWK" ).append("\n"); 
		query.append("					,A.FM_ECC_CD" ).append("\n"); 
		query.append("					,TO_CHAR(A.FM_ETD_DT,'YYYY-MM-DD HH24:MI:SS')" ).append("\n"); 
		query.append("					,A.TO_ECC_CD" ).append("\n"); 
		query.append("					,TO_CHAR(A.TO_ETB_DT,'YYYY-MM-DD HH24:MI:SS')" ).append("\n"); 
		query.append("					,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("					,A.VSL_LANE_CD" ).append("\n"); 
		query.append("					,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD" ).append("\n"); 
		query.append("				-- 2. TRUCK & RAIL & WATER(PLAN)-------------------" ).append("\n"); 
		query.append("				UNION" ).append("\n"); 
		query.append("				SELECT	 A.PLN_YRWK" ).append("\n"); 
		query.append("						,' ' 		COMPANY" ).append("\n"); 
		query.append("						,'Plan' 		DIVISION" ).append("\n"); 
		query.append("						,A.TRSP_MOD_CD 	ITEM" ).append("\n"); 
		query.append("						,'' 			LANE" ).append("\n"); 
		query.append("						,'' 			VVD" ).append("\n"); 
		query.append("						,A.FM_ECC_CD 	FRLOC" ).append("\n"); 
		query.append("						,A.FM_YRWK		ETD" ).append("\n"); 
		query.append("						,A.TO_ECC_CD 	TOLOC" ).append("\n"); 
		query.append("						,A.TO_YRWK 	ETA" ).append("\n"); 
		query.append("						,'' 			SOSEND" ).append("\n"); 
		query.append("						,'' 			MTY" ).append("\n"); 
		query.append("						,'' 			LSR" ).append("\n"); 
		query.append("						,'' 			PURPOSE" ).append("\n"); 
		query.append("						,'' 			REASON" ).append("\n"); 
		query.append("						,'' 			REASONREMARK" ).append("\n"); 
		query.append("				#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("       				#if($velocityCount == 1)" ).append("\n"); 
		query.append("    	   				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)" ).append("\n"); 
		query.append("        			#else" ).append("\n"); 
		query.append("        				+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)" ).append("\n"); 
		query.append("        			#end" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("						TOTALVOL" ).append("\n"); 
		query.append("				#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("        			#if($velocityCount == 1)" ).append("\n"); 
		query.append("        				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.TRSP_COST_AMT)),0)" ).append("\n"); 
		query.append("        			#else" ).append("\n"); 
		query.append("        				+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.TRSP_COST_AMT)),0)" ).append("\n"); 
		query.append("        			#end" ).append("\n"); 
		query.append("        		#end" ).append("\n"); 
		query.append("        				TOTALCOST" ).append("\n"); 
		query.append("					#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("						,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0) 	  ${key}VOL" ).append("\n"); 
		query.append("						,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.TRSP_COST_AMT)),0) ${key}COST" ).append("\n"); 
		query.append("					#end" ).append("\n"); 
		query.append("						,'' REF_ID" ).append("\n"); 
		query.append("						,'' BKG_NO" ).append("\n"); 
		query.append("						,1 SORTNUM    	  -- HIDDEN" ).append("\n"); 
		query.append("						,A.FM_ECC_CD FM_ECC -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("						,A.TO_ECC_CD TO_ECC -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("				FROM	(SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("								,A.PLN_YRWK" ).append("\n"); 
		query.append("								,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("								,A.FM_ECC_CD" ).append("\n"); 
		query.append("								,A.TO_ECC_CD" ).append("\n"); 
		query.append("								,A.FM_YRWK" ).append("\n"); 
		query.append("								,A.TO_YRWK" ).append("\n"); 
		query.append("								,QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("								,QTY.CNTR_QTY" ).append("\n"); 
		query.append("								,QTY.TRSP_COST_AMT" ).append("\n"); 
		query.append("						FROM	EQR_INLND_TRSP_PLN A" ).append("\n"); 
		query.append("								,EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("						WHERE	A.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("							AND	A.PLN_YRWK		= QTY.PLN_YRWK" ).append("\n"); 
		query.append("							AND	A.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("						) A" ).append("\n"); 
		query.append("				-- reason, company, sosend 검색정보 사용시만 조인쿼리를 사용합니다." ).append("\n"); 
		query.append("	    		#if ( ${reason} != '' || ${mty} != '' || ${sosend} != ''  || ${lane} != '' || ${vvd} != '' )" ).append("\n"); 
		query.append("						,(" ).append("\n"); 
		query.append("						SELECT	 DISTINCT A.REPO_PLN_ID" ).append("\n"); 
		query.append("								,A.PLN_YRWK" ).append("\n"); 
		query.append("								,A.REF_ID" ).append("\n"); 
		query.append("								,A.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("								,A.CO_CD" ).append("\n"); 
		query.append("								,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("								,A.VSL_LANE_CD" ).append("\n"); 
		query.append("								,A.VSL_CD" ).append("\n"); 
		query.append("								,A.SKD_VOY_NO" ).append("\n"); 
		query.append("								,A.SKD_DIR_CD" ).append("\n"); 
		query.append("								,A.FM_YD_CD" ).append("\n"); 
		query.append("								,A.FM_ETD_DT" ).append("\n"); 
		query.append("								,A.TO_YD_CD" ).append("\n"); 
		query.append("								,A.TO_ETA_DT" ).append("\n"); 
		query.append("								,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("								,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("								,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("								,A.CNTR_QTY" ).append("\n"); 
		query.append("								,A.TRSP_COST_AMT" ).append("\n"); 
		query.append("								,A.EXE_RQST_DT" ).append("\n"); 
		query.append("								,A.EXE_ISS_FLG" ).append("\n"); 
		query.append("								,A.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append("								,E.LOC_CD FM_ECC" ).append("\n"); 
		query.append("								,F.LOC_CD TO_ECC" ).append("\n"); 
		query.append("						FROM	(" ).append("\n"); 
		query.append("								SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("										,A.PLN_YRWK" ).append("\n"); 
		query.append("										,A.REF_ID" ).append("\n"); 
		query.append("										,A.CO_CD" ).append("\n"); 
		query.append("										,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("										,A.VSL_LANE_CD" ).append("\n"); 
		query.append("										,A.VSL_CD" ).append("\n"); 
		query.append("										,A.SKD_VOY_NO" ).append("\n"); 
		query.append("										,A.SKD_DIR_CD" ).append("\n"); 
		query.append("										,A.FM_YD_CD" ).append("\n"); 
		query.append("										,A.FM_ETD_DT" ).append("\n"); 
		query.append("										,A.TO_YD_CD" ).append("\n"); 
		query.append("										,A.TO_ETA_DT" ).append("\n"); 
		query.append("										,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("										,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("										,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("										,A.EXE_ISS_FLG" ).append("\n"); 
		query.append("										,A.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append("										,QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("										,QTY.CNTR_QTY" ).append("\n"); 
		query.append("										,QTY.TRSP_COST_AMT" ).append("\n"); 
		query.append("										,QTY.EXE_RQST_DT" ).append("\n"); 
		query.append("								FROM	EQR_INLND_TRSP_EXE_PLN A" ).append("\n"); 
		query.append("										,EQR_INLND_TRSP_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("								WHERE	A.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("									AND	A.PLN_YRWK		= QTY.PLN_YRWK" ).append("\n"); 
		query.append("									AND	A.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("									AND	A.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("								)A" ).append("\n"); 
		query.append("								,MDM_EQ_ORZ_CHT B" ).append("\n"); 
		query.append("								,MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("								,MDM_LOCATION E" ).append("\n"); 
		query.append("								,MDM_LOCATION F" ).append("\n"); 
		query.append("						WHERE	SUBSTR(A.FM_YD_CD, 0, 5) = E.LOC_CD" ).append("\n"); 
		query.append("						AND     E.SCC_CD                 = B.SCC_CD" ).append("\n"); 
		query.append("						AND	SUBSTR(A.TO_YD_CD, 0, 5) = F.LOC_CD" ).append("\n"); 
		query.append("						AND     F.SCC_CD                 = C.SCC_CD" ).append("\n"); 
		query.append("						#if ( ${sosend} != '' )" ).append("\n"); 
		query.append("							AND A.EXE_ISS_FLG = @[sosend]" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("						#if ( ${mty} != '' )" ).append("\n"); 
		query.append("							AND A.REPO_MTY_BKG_FLG = @[mty]" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("						#if ( ${reason} != '' )" ).append("\n"); 
		query.append("							AND A.REPO_PLN_FB_RSN_CD IN ( ${reasonText} )" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("						#if ( ${lane} != '' )" ).append("\n"); 
		query.append("							AND A.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("						#if ( ${vvd} != '' )" ).append("\n"); 
		query.append("							AND A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("						#end" ).append("\n"); 
		query.append("	            		) B" ).append("\n"); 
		query.append("				WHERE	A.REPO_PLN_ID = B.REPO_PLN_ID" ).append("\n"); 
		query.append("					AND	A.PLN_YRWK    = B.PLN_YRWK" ).append("\n"); 
		query.append("					AND	A.FM_ECC_CD   = B.FM_ECC" ).append("\n"); 
		query.append("					AND	A.TO_ECC_CD   = B.TO_ECC" ).append("\n"); 
		query.append("					AND	A.TRSP_MOD_CD = B.TRSP_MOD_CD" ).append("\n"); 
		query.append("    		#else" ).append("\n"); 
		query.append("				WHERE	1=1" ).append("\n"); 
		query.append("    		#end" ).append("\n"); 
		query.append("					AND	A.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("				#if ( ${userEcc} != ${userEcc} )" ).append("\n"); 
		query.append("					AND (A.FM_ECC_CD IN ( ${userEccText} ) OR A.TO_ECC_CD IN ( ${userEccText} ))" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("			#if( ${fmtoat} == 1 )" ).append("\n"); 
		query.append("					AND	A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("            	#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("            		AND A.FM_ECC_CD IN ( ${fromEccText} )" ).append("\n"); 
		query.append("            	#end" ).append("\n"); 
		query.append("            	#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("            		AND A.TO_ECC_CD IN ( ${toEccText} )" ).append("\n"); 
		query.append("            	#end" ).append("\n"); 
		query.append("			#elseif( ${fmtoat} == 3 )" ).append("\n"); 
		query.append("				AND	A.FM_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("            	#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("            		AND A.FM_ECC_CD IN ( ${fromEccText} )" ).append("\n"); 
		query.append("            	#end" ).append("\n"); 
		query.append("            	#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("            		AND A.TO_ECC_CD IN ( ${toEccText} )" ).append("\n"); 
		query.append("            	#end" ).append("\n"); 
		query.append("			#elseif( ${fmtoat} == 4 )" ).append("\n"); 
		query.append("					AND	A.TO_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("            	#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("            		AND A.FM_ECC_CD IN ( ${fromEccText} )" ).append("\n"); 
		query.append("            	#end" ).append("\n"); 
		query.append("            	#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("            		AND A.TO_ECC_CD IN ( ${toEccText} )" ).append("\n"); 
		query.append("            	#end" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				#if ( ${atstatus} != '' )" ).append("\n"); 
		query.append("					AND (	(A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk] AND A.FM_ECC_CD IN ( ${fromEccText} ) )" ).append("\n"); 
		query.append("						OR	(A.TO_YRWK  BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk] AND A.TO_ECC_CD IN ( ${fromEccText} ) )" ).append("\n"); 
		query.append("						)" ).append("\n"); 
		query.append("				#else" ).append("\n"); 
		query.append("					AND	(	(A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("						OR	(A.TO_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("						)" ).append("\n"); 
		query.append("        		#end" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("				#if ( ${tpsz} != '' && ${tpsztype} != '' )" ).append("\n"); 
		query.append("					AND A.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if ( ${itemText} != '' )" ).append("\n"); 
		query.append("					AND A.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("		GROUP BY A.PLN_YRWK" ).append("\n"); 
		query.append("			,A.FM_ECC_CD" ).append("\n"); 
		query.append("			,A.FM_YRWK" ).append("\n"); 
		query.append("			,A.TO_ECC_CD" ).append("\n"); 
		query.append("			,A.TO_YRWK" ).append("\n"); 
		query.append("			,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("		-- lane & vvd 검색조건이 들어오면 on-off hire 조외하지 않음" ).append("\n"); 
		query.append("		#if ( ${lane} == '' && ${vvd} == '' )" ).append("\n"); 
		query.append("		-- 3. ON-HIRE & OFF-HIRE(PLAN)---------------------" ).append("\n"); 
		query.append("		UNION" ).append("\n"); 
		query.append("		SELECT	 A.PLN_YRWK" ).append("\n"); 
		query.append("				,' ' COMPANY" ).append("\n"); 
		query.append("				,'Plan' DIVISION" ).append("\n"); 
		query.append("				,A.ONF_HIR_DIV_CD ITEM" ).append("\n"); 
		query.append("				,'' LANE" ).append("\n"); 
		query.append("				,'' VVD" ).append("\n"); 
		query.append("				, A.ECC_CD FRLOC" ).append("\n"); 
		query.append("				,'' ETD" ).append("\n"); 
		query.append("				, A.ECC_CD TOLOC" ).append("\n"); 
		query.append("				,'' ETA" ).append("\n"); 
		query.append("				,'' SOSEND" ).append("\n"); 
		query.append("				,'' MTY" ).append("\n"); 
		query.append("				,'' LSR" ).append("\n"); 
		query.append("				,'' PURPOSE" ).append("\n"); 
		query.append("				,'' REASON" ).append("\n"); 
		query.append("				,'' REASONREMARK" ).append("\n"); 
		query.append("		#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("			#if($velocityCount == 1)" ).append("\n"); 
		query.append("	       		,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)" ).append("\n"); 
		query.append("	       	#else" ).append("\n"); 
		query.append("	       		+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)" ).append("\n"); 
		query.append("	        #end" ).append("\n"); 
		query.append("	    #end" ).append("\n"); 
		query.append("	        	TOTALVOL" ).append("\n"); 
		query.append("		#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("			#if($velocityCount == 1)" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.ONF_HIR_COST_AMT)),0)" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.ONF_HIR_COST_AMT)),0)" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("			TOTALCOST" ).append("\n"); 
		query.append("			#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0) 		 ${key}VOL" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.ONF_HIR_COST_AMT)),0) ${key}COST" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("				,'' REF_ID" ).append("\n"); 
		query.append("				,'' BKG_NO" ).append("\n"); 
		query.append("				,1 SORTNUM    	-- HIDDEN" ).append("\n"); 
		query.append("				,DECODE(A.ONF_HIR_DIV_CD, 'F', A.ECC_CD) FM_ECC -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("				,DECODE(A.ONF_HIR_DIV_CD, 'O', A.ECC_CD) TO_ECC -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("		FROM	(" ).append("\n"); 
		query.append("				SELECT	 A.PLN_YRWK" ).append("\n"); 
		query.append("						,A.ONF_HIR_DIV_CD" ).append("\n"); 
		query.append("						,A.ECC_CD" ).append("\n"); 
		query.append("						,A.REPO_PLN_ID" ).append("\n"); 
		query.append("						,QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("						,QTY.CNTR_QTY" ).append("\n"); 
		query.append("						,QTY.ONF_HIR_COST_AMT" ).append("\n"); 
		query.append("				FROM	 EQR_ONF_HIR_PLN A" ).append("\n"); 
		query.append("						,EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("				WHERE	A.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("					AND	A.PLN_YRWK		= QTY.PLN_YRWK" ).append("\n"); 
		query.append("					AND	A.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("				) A" ).append("\n"); 
		query.append("		-- reason, company, sosend 검색정보 사용시만 조인쿼리를 사용합니다." ).append("\n"); 
		query.append("		#if ( ${reason} != '' || ${mty} != '' || ${sosend} != '' )" ).append("\n"); 
		query.append("				,(" ).append("\n"); 
		query.append("				SELECT	 DISTINCT A.REPO_PLN_ID" ).append("\n"); 
		query.append("						,A.PLN_YRWK" ).append("\n"); 
		query.append("						,A.REF_ID" ).append("\n"); 
		query.append("						,A.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("						,A.CO_CD" ).append("\n"); 
		query.append("						,A.ONF_HIR_DIV_CD" ).append("\n"); 
		query.append("						,A.FM_YD_CD" ).append("\n"); 
		query.append("						,A.TO_YD_CD" ).append("\n"); 
		query.append("						,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("						,A.SO_ISS_FLG" ).append("\n"); 
		query.append("						,A.NON_SO_ISS_FLG" ).append("\n"); 
		query.append("						,B.LCC_CD FM_ECC" ).append("\n"); 
		query.append("						,C.LCC_CD TO_ECC" ).append("\n"); 
		query.append("				FROM	(" ).append("\n"); 
		query.append("						SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("								,A.PLN_YRWK" ).append("\n"); 
		query.append("								,A.REF_ID" ).append("\n"); 
		query.append("								,A.CO_CD" ).append("\n"); 
		query.append("								,A.ONF_HIR_DIV_CD" ).append("\n"); 
		query.append("								,A.FM_YD_CD" ).append("\n"); 
		query.append("								,A.TO_YD_CD" ).append("\n"); 
		query.append("								,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("								,A.SO_ISS_FLG" ).append("\n"); 
		query.append("								,A.NON_SO_ISS_FLG" ).append("\n"); 
		query.append("								,QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("						FROM	 EQR_ONF_HIR_EXE_PLN A" ).append("\n"); 
		query.append("								,EQR_ONF_HIR_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("						WHERE	A.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("							AND	A.PLN_YRWK		= QTY.PLN_YRWK" ).append("\n"); 
		query.append("							AND	A.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("							AND	A.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("						) A" ).append("\n"); 
		query.append("						,MDM_EQ_ORZ_CHT B" ).append("\n"); 
		query.append("						,MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("						,MDM_LOCATION E" ).append("\n"); 
		query.append("						,MDM_LOCATION F" ).append("\n"); 
		query.append("				WHERE	SUBSTR(A.FM_YD_CD, 0, 5) = E.LOC_CD" ).append("\n"); 
		query.append("				AND     E.SCC_CD                 = B.SCC_CD" ).append("\n"); 
		query.append("				AND	SUBSTR(A.TO_YD_CD, 0, 5)     = F.LOC_CD" ).append("\n"); 
		query.append("				AND     F.SCC_CD                 = C.SCC_CD" ).append("\n"); 
		query.append("				#if ( ${reason} != '' )" ).append("\n"); 
		query.append("					AND A.REPO_PLN_FB_RSN_CD IN ( ${reasonText} )" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if ( ${sosend} != '' )" ).append("\n"); 
		query.append("					AND (A.SO_ISS_FLG = @[sosend] OR NON_SO_ISS_FLG= @[sosend])" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				#if ( ${mty} != '' )" ).append("\n"); 
		query.append("					AND 1=0" ).append("\n"); 
		query.append("				#end" ).append("\n"); 
		query.append("				) B" ).append("\n"); 
		query.append("		WHERE	A.REPO_PLN_ID	= B.REPO_PLN_ID" ).append("\n"); 
		query.append("			AND	A.PLN_YRWK		= B.PLN_YRWK" ).append("\n"); 
		query.append("			AND	A.ONF_HIR_DIV_CD= B.ONF_HIR_DIV_CD" ).append("\n"); 
		query.append("			AND	(A.ECC_CD=B.FM_ECC OR A.ECC_CD=B.TO_ECC)" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("		WHERE	1=1" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("			AND	A.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("			AND	A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("		#if ( ${userEcc} != ${userEcc} )" ).append("\n"); 
		query.append("			AND	A.ECC_CD IN ( ${userEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( (${fmtoat} == 1 || ${fmtoat} == 3 || ${fmtoat} == 4 ) && ${fromstatus} != '')" ).append("\n"); 
		query.append("			AND A.ECC_CD IN ( ${fromEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${tpsz} != '' && ${tpsztype} != '' )" ).append("\n"); 
		query.append("			AND A.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${itemText} != '' )" ).append("\n"); 
		query.append("			AND A.ONF_HIR_DIV_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		GROUP BY A.PLN_YRWK" ).append("\n"); 
		query.append("				,A.ONF_HIR_DIV_CD" ).append("\n"); 
		query.append("				,A.ECC_CD" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("		-- 4. ECC INTERNAL (PLAN)  ------------------------" ).append("\n"); 
		query.append("		-- (PLAN 없음)             ------------------------" ).append("\n"); 
		query.append("		" ).append("\n"); 
		query.append("		-- Execution  ---------------------------------------" ).append("\n"); 
		query.append("		-- 1. T.VVD & D.VVD	(Execution)----------------------" ).append("\n"); 
		query.append("		UNION" ).append("\n"); 
		query.append("		SELECT	 A.PLN_YRWK 		PLN_YRWK" ).append("\n"); 
		query.append("				,A.CO_CD 			COMPANY" ).append("\n"); 
		query.append("				,'REPO BKG' 		DIVISION" ).append("\n"); 
		query.append("				,A.TRSP_MOD_CD 	ITEM" ).append("\n"); 
		query.append("				,A.VSL_LANE_CD 	LANE" ).append("\n"); 
		query.append("				,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD VVD" ).append("\n"); 
		query.append("				,A.FM_YD_CD  		FRLOC" ).append("\n"); 
		query.append("				,TO_CHAR(A.FM_ETD_DT, 'YYYY-MM-DD HH24:MI:SS') ETD" ).append("\n"); 
		query.append("				,A.TO_YD_CD  		TOLOC" ).append("\n"); 
		query.append("				,TO_CHAR(A.TO_ETB_DT, 'YYYY-MM-DD HH24:MI:SS') ETA" ).append("\n"); 
		query.append("				,''                    SOSEND" ).append("\n"); 
		query.append("				,A.REPO_MTY_BKG_FLG    MTY" ).append("\n"); 
		query.append("				,''                    LSR" ).append("\n"); 
		query.append("				,A.EQ_REPO_PURP_CD     PURPOSE" ).append("\n"); 
		query.append("				,A.REPO_PLN_FB_RSN_CD  REASON" ).append("\n"); 
		query.append("				,A.REPO_PLN_FB_RMK REASONREMARK" ).append("\n"); 
		query.append("		#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("			#if(${velocityCount} == 1 )" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', DECODE(A.REPO_MTY_BKG_FLG, 'Y', DECODE(A.SPLIT_REPO_PLN_FLG,'N',B.CNTR_QTY,A.CNTR_QTY), A.CNTR_QTY))),0)" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', DECODE(A.REPO_MTY_BKG_FLG, 'Y', DECODE(A.SPLIT_REPO_PLN_FLG,'N',B.CNTR_QTY,A.CNTR_QTY), A.CNTR_QTY))),0)" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("				TOTALVOL" ).append("\n"); 
		query.append("        #foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("        	#if(${velocityCount} == 1 )" ).append("\n"); 
		query.append("        		,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.LODG_DCHG_COST_AMT)),0)" ).append("\n"); 
		query.append("        	#else" ).append("\n"); 
		query.append("        		+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.LODG_DCHG_COST_AMT)),0)" ).append("\n"); 
		query.append("        	#end" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        		TOTALCOST" ).append("\n"); 
		query.append("	        #foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("	        	,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', DECODE(A.REPO_MTY_BKG_FLG, 'Y', DECODE(A.SPLIT_REPO_PLN_FLG,'N',B.CNTR_QTY,A.CNTR_QTY), A.CNTR_QTY))),0) ${key}VOL" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.LODG_DCHG_COST_AMT)),0) ${key}COST" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("				,A.REF_ID" ).append("\n"); 
		query.append("				,A.MTY_BKG_NO BKG_NO" ).append("\n"); 
		query.append("				,4 SORTNUM" ).append("\n"); 
		query.append("				,A.FM_ECC -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("				,A.TO_ECC -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("		FROM	(" ).append("\n"); 
		query.append("				SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("						,A.PLN_YRWK" ).append("\n"); 
		query.append("						,A.REF_ID" ).append("\n"); 
		query.append("						,A.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("						,A.CO_CD" ).append("\n"); 
		query.append("						,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("						,A.VSL_LANE_CD" ).append("\n"); 
		query.append("						,A.VSL_CD" ).append("\n"); 
		query.append("						,A.SKD_VOY_NO" ).append("\n"); 
		query.append("						,A.SKD_DIR_CD" ).append("\n"); 
		query.append("						,A.FM_YD_CD" ).append("\n"); 
		query.append("						,A.FM_ETD_DT" ).append("\n"); 
		query.append("						,A.TO_YD_CD" ).append("\n"); 
		query.append("						,A.TO_ETB_DT" ).append("\n"); 
		query.append("						,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("						,A.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append("						,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("						,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("						,A.CNTR_QTY" ).append("\n"); 
		query.append("						,A.LODG_DCHG_COST_AMT" ).append("\n"); 
		query.append("						,A.MTY_BKG_NO" ).append("\n"); 
		query.append("						,A.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("						,A.SPLIT_REPO_PLN_FLG" ).append("\n"); 
		query.append("						,B.ECC_CD FM_ECC" ).append("\n"); 
		query.append("						,C.ECC_CD TO_ECC" ).append("\n"); 
		query.append("				FROM	(" ).append("\n"); 
		query.append("						SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("								,A.PLN_YRWK" ).append("\n"); 
		query.append("								,A.REF_ID" ).append("\n"); 
		query.append("								,A.CO_CD" ).append("\n"); 
		query.append("								,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("								,A.VSL_LANE_CD" ).append("\n"); 
		query.append("								,A.VSL_CD" ).append("\n"); 
		query.append("								,A.SKD_VOY_NO" ).append("\n"); 
		query.append("								,A.SKD_DIR_CD" ).append("\n"); 
		query.append("								,A.FM_YD_CD" ).append("\n"); 
		query.append("								,A.FM_ETD_DT" ).append("\n"); 
		query.append("								,A.TO_YD_CD" ).append("\n"); 
		query.append("								,A.TO_ETB_DT" ).append("\n"); 
		query.append("								,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("								,A.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append("								,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("								,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("								,A.MTY_BKG_NO" ).append("\n"); 
		query.append("								,A.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("								,A.SPLIT_REPO_PLN_FLG" ).append("\n"); 
		query.append("								,QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("								,QTY.CNTR_QTY" ).append("\n"); 
		query.append("								,QTY.LODG_DCHG_COST_AMT" ).append("\n"); 
		query.append("						FROM	EQR_VSL_LODG_DCHG_EXE_PLN A" ).append("\n"); 
		query.append("								,EQR_VSL_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("						WHERE	A.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("							AND	A.PLN_YRWK		= QTY.PLN_YRWK" ).append("\n"); 
		query.append("							AND	A.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("							AND	A.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("						) A" ).append("\n"); 
		query.append("						,MDM_EQ_ORZ_CHT B" ).append("\n"); 
		query.append("						,MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("						,MDM_LOCATION E" ).append("\n"); 
		query.append("						,MDM_LOCATION F" ).append("\n"); 
		query.append("				WHERE	SUBSTR(A.FM_YD_CD, 0, 5) = E.LOC_CD" ).append("\n"); 
		query.append("				AND     E.SCC_CD                 = B.SCC_CD" ).append("\n"); 
		query.append("				AND	SUBSTR(A.TO_YD_CD, 0, 5)     = F.LOC_CD" ).append("\n"); 
		query.append("				AND     F.SCC_CD                 = C.SCC_CD" ).append("\n"); 
		query.append("				) A," ).append("\n"); 
		query.append("				(" ).append("\n"); 
		query.append("				SELECT	 A.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("						,A.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("						,NVL(A.CNTR_QTY, 0) - NVL(B.CNTR_QTY, 0) CNTR_QTY  -- (original - split)" ).append("\n"); 
		query.append("				FROM	(" ).append("\n"); 
		query.append("						-- original booking vol 집계" ).append("\n"); 
		query.append("						SELECT	 DISTINCT A.OLD_BKG_GRP_NO AS OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("								,B.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("								,SUM(B.CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("						FROM	 EQR_VSL_LODG_DCHG_EXE_PLN A" ).append("\n"); 
		query.append("								,EQR_VSL_EXE_PLN_QTY B" ).append("\n"); 
		query.append("								,(" ).append("\n"); 
		query.append("								SELECT	DISTINCT OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("								FROM	EQR_VSL_LODG_DCHG_EXE_PLN" ).append("\n"); 
		query.append("								WHERE	REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("									AND	REPO_MTY_BKG_FLG = 'Y'" ).append("\n"); 
		query.append("								) C                         " ).append("\n"); 
		query.append("						WHERE	A.REPO_PLN_ID   = B.REPO_PLN_ID" ).append("\n"); 
		query.append("							AND	A.PLN_YRWK      = B.PLN_YRWK" ).append("\n"); 
		query.append("							AND	A.PLN_SEQ       = B.PLN_SEQ" ).append("\n"); 
		query.append("							AND	A.REF_ID        = B.REF_ID" ).append("\n"); 
		query.append("							AND	A.OLD_BKG_GRP_NO= C.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("						GROUP BY A.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("								,B.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("						) A," ).append("\n"); 
		query.append("						(" ).append("\n"); 
		query.append("						-- split booking vol 집계" ).append("\n"); 
		query.append("						SELECT	 DISTINCT A.OLD_BKG_GRP_NO AS OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("								,B.CNTR_TPSZ_CD                        " ).append("\n"); 
		query.append("								,SUM(B.CNTR_QTY) CNTR_QTY              " ).append("\n"); 
		query.append("						FROM	 EQR_VSL_LODG_DCHG_EXE_PLN A" ).append("\n"); 
		query.append("								,EQR_VSL_EXE_PLN_QTY B" ).append("\n"); 
		query.append("								,(                                       " ).append("\n"); 
		query.append("								SELECT	DISTINCT OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("								FROM	EQR_VSL_LODG_DCHG_EXE_PLN      " ).append("\n"); 
		query.append("								WHERE	REPO_PLN_ID			= @[repo_pln_id]" ).append("\n"); 
		query.append("									AND	REPO_MTY_BKG_FLG	= 'Y'       " ).append("\n"); 
		query.append("									AND	SPLIT_REPO_PLN_FLG	= 'Y'" ).append("\n"); 
		query.append("									--AND	TRIM(MTY_BKG_NO_SPLIT) IS NOT NULL " ).append("\n"); 
		query.append("								) C                                     " ).append("\n"); 
		query.append("						WHERE	A.REPO_PLN_ID   = B.REPO_PLN_ID" ).append("\n"); 
		query.append("							AND A.PLN_YRWK      = B.PLN_YRWK" ).append("\n"); 
		query.append("							AND A.PLN_SEQ       = B.PLN_SEQ" ).append("\n"); 
		query.append("							AND A.REF_ID        = B.REF_ID" ).append("\n"); 
		query.append("							AND A.OLD_BKG_GRP_NO	= C.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("						    AND	A.REPO_MTY_BKG_FLG	= 'Y'       " ).append("\n"); 
		query.append("							AND	A.SPLIT_REPO_PLN_FLG	= 'Y'" ).append("\n"); 
		query.append("						GROUP BY A.OLD_BKG_GRP_NO" ).append("\n"); 
		query.append("								,B.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("						) B" ).append("\n"); 
		query.append("				WHERE	A.OLD_BKG_GRP_NO = B.OLD_BKG_GRP_NO(+)" ).append("\n"); 
		query.append("					AND	A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)" ).append("\n"); 
		query.append("				) B" ).append("\n"); 
		query.append("				,EQR_VSL_LODG_DCHG_PLN C" ).append("\n"); 
		query.append("		WHERE	A.REPO_PLN_ID = C.REPO_PLN_ID" ).append("\n"); 
		query.append("			AND	A.PLN_YRWK    = C.PLN_YRWK" ).append("\n"); 
		query.append("			AND	A.TRSP_MOD_CD = C.TRSP_MOD_CD" ).append("\n"); 
		query.append("			AND	C.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("			AND	A.OLD_BKG_GRP_NO= B.OLD_BKG_GRP_NO(+)" ).append("\n"); 
		query.append("			AND	A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)" ).append("\n"); 
		query.append("		#if ( ${userEcc} != ${userEcc} )" ).append("\n"); 
		query.append("			AND	(A.FM_ECC IN ( ${userEccText} ) OR A.TO_ECC IN ( ${userEccText} ))" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#if ( ${fmtoat} == 1 )" ).append("\n"); 
		query.append("			AND	C.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("		#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("			AND	A.FM_ECC IN ( ${fromEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("			AND	A.TO_ECC IN ( ${toEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#elseif ( ${fmtoat} == 3 )" ).append("\n"); 
		query.append("			AND	TO_CHAR(A.FM_ETD_DT ,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("													AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("		#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("			AND	A.FM_ECC IN ( ${fromEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("			AND	A.TO_ECC IN ( ${toEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#elseif ( ${fmtoat} == 4 )" ).append("\n"); 
		query.append("			AND	TO_CHAR(A.TO_ETB_DT ,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("													AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("		#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("			AND	A.FM_ECC IN ( ${fromEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("			AND	A.TO_ECC IN ( ${toEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#else		" ).append("\n"); 
		query.append("		#if ( ${atstatus} != '' )" ).append("\n"); 
		query.append("			AND	(	(C.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] AND A.FM_ECC IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("				OR	((SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETB_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT) " ).append("\n"); 
		query.append("					BETWEEN @[fm_plnyrwk] AND @[to_plnyrwk] AND A.TO_ECC IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("				)" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			AND	(	(C.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("				OR	((SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETB_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT) BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("				)" ).append("\n"); 
		query.append("   		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("		#if (${reason} != '' )" ).append("\n"); 
		query.append("			AND	A.REPO_PLN_FB_RSN_CD IN ( ${reasonText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if (${tpsz} != '' && ${tpsztype} != '' )" ).append("\n"); 
		query.append("			AND	A.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if (${itemText} != '' )" ).append("\n"); 
		query.append("			AND	A.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if (${mty} != '' )" ).append("\n"); 
		query.append("			AND	A.REPO_MTY_BKG_FLG = @[mty]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if (${sosend} != '' )" ).append("\n"); 
		query.append("			AND	1=0" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if (${lane} != '' )" ).append("\n"); 
		query.append("			AND	A.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if (${vvd} != '' )" ).append("\n"); 
		query.append("			AND	A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		GROUP BY A.PLN_YRWK" ).append("\n"); 
		query.append("				,A.CO_CD" ).append("\n"); 
		query.append("				,A.FM_YD_CD" ).append("\n"); 
		query.append("				,A.FM_ETD_DT" ).append("\n"); 
		query.append("				,A.TO_YD_CD" ).append("\n"); 
		query.append("				,A.TO_ETB_DT" ).append("\n"); 
		query.append("				,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("				,A.VSL_LANE_CD" ).append("\n"); 
		query.append("				,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD" ).append("\n"); 
		query.append("				,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("				,A.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append("				,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("				,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("				,A.MTY_BKG_NO" ).append("\n"); 
		query.append("				,A.REF_ID" ).append("\n"); 
		query.append("				,A.FM_ECC -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("				,A.TO_ECC -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("		-- 2. TRUCK & RAIL & WATER (Execution)-----------------" ).append("\n"); 
		query.append("		UNION" ).append("\n"); 
		query.append("		SELECT	 A.PLN_YRWK 		PLN_YRWK" ).append("\n"); 
		query.append("				,A.CO_CD 			COMPANY" ).append("\n"); 
		query.append("				,'Execution' 		DIVISION" ).append("\n"); 
		query.append("				,A.TRSP_MOD_CD 	ITEM" ).append("\n"); 
		query.append("				,A.VSL_LANE_CD 	LANE" ).append("\n"); 
		query.append("				,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD     VVD" ).append("\n"); 
		query.append("				,A.FM_YD_CD  		FRLOC" ).append("\n"); 
		query.append("				,TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') 		ETD" ).append("\n"); 
		query.append("				,A.TO_YD_CD  		TOLOC" ).append("\n"); 
		query.append("				,TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD') 		ETA" ).append("\n"); 
		query.append("				,A.EXE_ISS_FLG    	 SOSEND" ).append("\n"); 
		query.append("				,A.REPO_MTY_BKG_FLG	 MTY" ).append("\n"); 
		query.append("				,''    				 LSR" ).append("\n"); 
		query.append("				,A.EQ_REPO_PURP_CD PURPOSE" ).append("\n"); 
		query.append("				,A.REPO_PLN_FB_RSN_CD  REASON" ).append("\n"); 
		query.append("				,A.REPO_PLN_FB_RMK     REASONREMARK" ).append("\n"); 
		query.append("		#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("			#if ( ${velocityCount} == 1 )" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("				TOTALVOL" ).append("\n"); 
		query.append("		#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("			#if ( ${velocityCount} == 1 )" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.TRSP_COST_AMT)),0)" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.TRSP_COST_AMT)),0)" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("				TOTALCOST" ).append("\n"); 
		query.append("			#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0) 	 ${key}VOL" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.TRSP_COST_AMT)),0) ${key}COST" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("				,A.REF_ID" ).append("\n"); 
		query.append("				,A.MTY_BKG_NO BKG_NO" ).append("\n"); 
		query.append("				,2 SORTNUM" ).append("\n"); 
		query.append("				,A.FM_ECC -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("				,A.TO_ECC -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("		FROM	(" ).append("\n"); 
		query.append("				SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("						,A.PLN_YRWK" ).append("\n"); 
		query.append("						,A.REF_ID" ).append("\n"); 
		query.append("						,A.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("						,A.CO_CD" ).append("\n"); 
		query.append("						,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("						,A.VSL_LANE_CD" ).append("\n"); 
		query.append("						,A.VSL_CD" ).append("\n"); 
		query.append("						,A.SKD_VOY_NO" ).append("\n"); 
		query.append("						,A.SKD_DIR_CD" ).append("\n"); 
		query.append("						,A.FM_YD_CD" ).append("\n"); 
		query.append("						,A.FM_ETD_DT" ).append("\n"); 
		query.append("						,A.TO_YD_CD" ).append("\n"); 
		query.append("						,A.TO_ETA_DT" ).append("\n"); 
		query.append("						,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("						,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("						,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("						,A.CNTR_QTY" ).append("\n"); 
		query.append("						,A.TRSP_COST_AMT" ).append("\n"); 
		query.append("						,A.EXE_RQST_DT" ).append("\n"); 
		query.append("						,A.EXE_ISS_FLG" ).append("\n"); 
		query.append("						,A.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append("						,A.MTY_BKG_NO" ).append("\n"); 
		query.append("						,E.LOC_CD FM_ECC" ).append("\n"); 
		query.append("						,F.LOC_CD TO_ECC" ).append("\n"); 
		query.append("				FROM	(" ).append("\n"); 
		query.append("						SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("								,A.PLN_YRWK" ).append("\n"); 
		query.append("								,A.REF_ID" ).append("\n"); 
		query.append("								,A.CO_CD" ).append("\n"); 
		query.append("								,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("								,A.VSL_LANE_CD" ).append("\n"); 
		query.append("								,A.VSL_CD" ).append("\n"); 
		query.append("								,A.SKD_VOY_NO" ).append("\n"); 
		query.append("								,A.SKD_DIR_CD" ).append("\n"); 
		query.append("								,A.FM_YD_CD" ).append("\n"); 
		query.append("								,A.FM_ETD_DT" ).append("\n"); 
		query.append("								,A.TO_YD_CD" ).append("\n"); 
		query.append("								,A.TO_ETA_DT" ).append("\n"); 
		query.append("								,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("								,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("								,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("								,A.EXE_ISS_FLG" ).append("\n"); 
		query.append("								,A.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append("								,A.MTY_BKG_NO" ).append("\n"); 
		query.append("								,QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("								,QTY.CNTR_QTY" ).append("\n"); 
		query.append("								,QTY.TRSP_COST_AMT" ).append("\n"); 
		query.append("								,QTY.EXE_RQST_DT" ).append("\n"); 
		query.append("						FROM	 EQR_INLND_TRSP_EXE_PLN A" ).append("\n"); 
		query.append("								,EQR_INLND_TRSP_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("						WHERE	A.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("							AND	A.PLN_YRWK		= QTY.PLN_YRWK" ).append("\n"); 
		query.append("							AND	A.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("							AND	A.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("						) A" ).append("\n"); 
		query.append("						,MDM_EQ_ORZ_CHT B" ).append("\n"); 
		query.append("						,MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("						,MDM_LOCATION E" ).append("\n"); 
		query.append("						,MDM_LOCATION F" ).append("\n"); 
		query.append("				WHERE	SUBSTR(A.FM_YD_CD, 0, 5) = E.LOC_CD" ).append("\n"); 
		query.append("				AND     E.SCC_CD                 = B.SCC_CD" ).append("\n"); 
		query.append("				AND	SUBSTR(A.TO_YD_CD, 0, 5) = F.LOC_CD" ).append("\n"); 
		query.append("				AND     F.SCC_CD                 = C.SCC_CD" ).append("\n"); 
		query.append("				) A" ).append("\n"); 
		query.append("				,EQR_INLND_TRSP_PLN B" ).append("\n"); 
		query.append("		WHERE	A.REPO_PLN_ID = B.REPO_PLN_ID" ).append("\n"); 
		query.append("			AND	A.PLN_YRWK    = B.PLN_YRWK" ).append("\n"); 
		query.append("			AND	A.FM_ECC   = B.FM_ECC_CD" ).append("\n"); 
		query.append("			AND	A.TO_ECC 	 = B.TO_ECC_CD" ).append("\n"); 
		query.append("			AND	A.TRSP_MOD_CD= B.TRSP_MOD_CD" ).append("\n"); 
		query.append("			AND	A.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("		#if ( ${userEcc} != ${userEcc} )" ).append("\n"); 
		query.append("			AND	(A.FM_ECC IN ( ${userEccText} ) OR A.TO_ECC IN ( ${userEccText} ))" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#if ( ${fmtoat} == 1 )" ).append("\n"); 
		query.append("			AND	A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("		#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("			AND	A.FM_ECC IN ( ${fromEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("			AND	A.TO_ECC IN ( ${toEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#elseif ( ${fmtoat} == 3 )" ).append("\n"); 
		query.append("			AND	TO_CHAR(A.FM_ETD_DT ,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[FM_PLNYRWK])" ).append("\n"); 
		query.append("													AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("		#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("			AND	A.FM_ECC IN ( ${fromEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("			AND	A.TO_ECC IN ( ${toEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#elseif ( ${fmtoat} == 4 )" ).append("\n"); 
		query.append("			AND	TO_CHAR(A.TO_ETA_DT ,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("													AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("		#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("			AND	A.FM_ECC IN ( ${fromEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("			AND	A.TO_ECC IN ( ${toEccText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#else" ).append("\n"); 
		query.append("		#if ( ${atstatus} != '' )" ).append("\n"); 
		query.append("			AND	(	(B.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] AND A.FM_ECC IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("				OR	((SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT) BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("						AND A.TO_ECC IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("				)" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			AND	(	(B.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("				OR	((SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT) BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("				)" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("		#if ( ${tpsz} != '' && ${tpsztype} != '')" ).append("\n"); 
		query.append("			AND	A.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${reason} != '')" ).append("\n"); 
		query.append("			AND	A.REPO_PLN_FB_RSN_CD IN ( ${reasonText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${itemText} != '')" ).append("\n"); 
		query.append("			AND	A.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${sosend} != '')" ).append("\n"); 
		query.append("			AND	A.EXE_ISS_FLG = @[sosend]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${lane} != '')" ).append("\n"); 
		query.append("			AND	A.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${vvd} != '')" ).append("\n"); 
		query.append("			AND	A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${mty} != '')" ).append("\n"); 
		query.append("			AND	A.REPO_MTY_BKG_FLG = @[mty]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		GROUP BY A.PLN_YRWK" ).append("\n"); 
		query.append("			,A.CO_CD" ).append("\n"); 
		query.append("			,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("			,A.FM_YD_CD" ).append("\n"); 
		query.append("			,TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD')" ).append("\n"); 
		query.append("			,A.TO_YD_CD" ).append("\n"); 
		query.append("			,TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD')" ).append("\n"); 
		query.append("			,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD" ).append("\n"); 
		query.append("			,A.VSL_LANE_CD" ).append("\n"); 
		query.append("			,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("			,A.EXE_ISS_FLG" ).append("\n"); 
		query.append("			,A.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append("			,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("			,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("			,A.REF_ID" ).append("\n"); 
		query.append("			,A.MTY_BKG_NO" ).append("\n"); 
		query.append("			,A.FM_ECC -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("			,A.TO_ECC -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("		-- lane & vvd 검색조건이 들어오면 on-off hire 조외하지 않음" ).append("\n"); 
		query.append("	#if ( ${lane} == '' && ${vvd} == '' )" ).append("\n"); 
		query.append("		-- 3. ON-HIRE & OFF-HIRE (Execution)-----------------" ).append("\n"); 
		query.append("		UNION" ).append("\n"); 
		query.append("		SELECT	 A.PLN_YRWK 		PLN_YRWK" ).append("\n"); 
		query.append("				,A.CO_CD 			COMPANY" ).append("\n"); 
		query.append("				,'Execution' 		DIVISION" ).append("\n"); 
		query.append("				,A.ONF_HIR_DIV_CD ITEM" ).append("\n"); 
		query.append("				,'' 				LANE" ).append("\n"); 
		query.append("				,'' 				VVD" ).append("\n"); 
		query.append("				,A.FM_YD_CD 		FRLOC" ).append("\n"); 
		query.append("				,A.FM_LOC_DT 		ETD" ).append("\n"); 
		query.append("				,A.TO_YD_CD 		TOLOC" ).append("\n"); 
		query.append("				,A.TO_LOC_DT 		ETA" ).append("\n"); 
		query.append("				,DECODE(A.SO_ISS_FLG, 'Y', A.SO_ISS_FLG, A.NON_SO_ISS_FLG) SOSEND" ).append("\n"); 
		query.append("				,'' 				MTY" ).append("\n"); 
		query.append("				,A.VNDR_ABBR_NM 	LSR" ).append("\n"); 
		query.append("				,'' 				PURPOSE" ).append("\n"); 
		query.append("				,A.REPO_PLN_FB_RSN_CD REASON" ).append("\n"); 
		query.append("				,A.REPO_PLN_FB_RMK REASONREMARK" ).append("\n"); 
		query.append("		#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("			#if ( ${velocityCount} == 1 )" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("				TOTALVOL" ).append("\n"); 
		query.append("		#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("			#if ( ${velocityCount} == 1 )" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.ONF_HIR_COST_AMT)),0)" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.ONF_HIR_COST_AMT)),0)" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("				TOTALCOST" ).append("\n"); 
		query.append("			#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0) 		 ${key}VOL" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.ONF_HIR_COST_AMT)),0) ${key}COST" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("				,A.REF_ID REFNO" ).append("\n"); 
		query.append("				,'' BKG_NO" ).append("\n"); 
		query.append("				,2 SORTNUM   					-- HIDDEN" ).append("\n"); 
		query.append("				,A.FM_ECC  -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("				,A.TO_ECC  -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("		FROM	(" ).append("\n"); 
		query.append("				SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("						,A.PLN_YRWK" ).append("\n"); 
		query.append("						,A.REF_ID" ).append("\n"); 
		query.append("						,A.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("						,A.CO_CD" ).append("\n"); 
		query.append("						,A.ONF_HIR_DIV_CD" ).append("\n"); 
		query.append("						,A.VNDR_CNT_CD" ).append("\n"); 
		query.append("						,A.VNDR_SEQ" ).append("\n"); 
		query.append("						,A.VNDR_ABBR_NM" ).append("\n"); 
		query.append("						,A.FM_YD_CD" ).append("\n"); 
		query.append("						,A.FM_LOC_DT" ).append("\n"); 
		query.append("						,A.TO_YD_CD" ).append("\n"); 
		query.append("						,A.TO_LOC_DT" ).append("\n"); 
		query.append("						,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("						,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("						,A.CNTR_QTY" ).append("\n"); 
		query.append("						,A.ONF_HIR_COST_AMT" ).append("\n"); 
		query.append("						,A.SO_RQST_DT" ).append("\n"); 
		query.append("						,A.SO_ISS_FLG" ).append("\n"); 
		query.append("						,A.NON_SO_ISS_FLG" ).append("\n"); 
		query.append("						,B.LCC_CD FM_ECC" ).append("\n"); 
		query.append("						,C.LCC_CD TO_ECC" ).append("\n"); 
		query.append("				FROM	(" ).append("\n"); 
		query.append("						SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("								,A.PLN_YRWK" ).append("\n"); 
		query.append("								,A.REF_ID" ).append("\n"); 
		query.append("								,A.CO_CD" ).append("\n"); 
		query.append("								,A.ONF_HIR_DIV_CD" ).append("\n"); 
		query.append("								,A.VNDR_CNT_CD" ).append("\n"); 
		query.append("								,A.VNDR_SEQ" ).append("\n"); 
		query.append("								,A.VNDR_ABBR_NM" ).append("\n"); 
		query.append("								,A.FM_YD_CD" ).append("\n"); 
		query.append("								,A.FM_LOC_DT" ).append("\n"); 
		query.append("								,A.TO_YD_CD" ).append("\n"); 
		query.append("								,A.TO_LOC_DT" ).append("\n"); 
		query.append("								,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("								,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("								,A.SO_RQST_DT" ).append("\n"); 
		query.append("								,A.SO_ISS_FLG" ).append("\n"); 
		query.append("								,A.NON_SO_ISS_FLG" ).append("\n"); 
		query.append("								,QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("								,QTY.CNTR_QTY" ).append("\n"); 
		query.append("								,QTY.ONF_HIR_COST_AMT" ).append("\n"); 
		query.append("						FROM	 EQR_ONF_HIR_EXE_PLN A" ).append("\n"); 
		query.append("								,EQR_ONF_HIR_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("						WHERE	A.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("							AND	A.PLN_YRWK		= QTY.PLN_YRWK" ).append("\n"); 
		query.append("							AND	A.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("							AND	A.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("						) A" ).append("\n"); 
		query.append("						,MDM_EQ_ORZ_CHT B" ).append("\n"); 
		query.append("						,MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("						,MDM_LOCATION E" ).append("\n"); 
		query.append("						,MDM_LOCATION F" ).append("\n"); 
		query.append("				WHERE	SUBSTR(A.FM_YD_CD, 0, 5) = E.LOC_CD" ).append("\n"); 
		query.append("				AND     E.SCC_CD                 = B.SCC_CD" ).append("\n"); 
		query.append("				AND	SUBSTR(A.TO_YD_CD, 0, 5) = F.LOC_CD" ).append("\n"); 
		query.append("				AND     F.SCC_CD                 = C.SCC_CD" ).append("\n"); 
		query.append("				) A" ).append("\n"); 
		query.append("				,EQR_ONF_HIR_PLN B" ).append("\n"); 
		query.append("		WHERE	A.REPO_PLN_ID = B.REPO_PLN_ID" ).append("\n"); 
		query.append("			AND	A.PLN_YRWK    = B.PLN_YRWK" ).append("\n"); 
		query.append("			AND	A.ONF_HIR_DIV_CD = B.ONF_HIR_DIV_CD" ).append("\n"); 
		query.append("			AND	(A.FM_ECC = B.ECC_CD OR A.TO_ECC = B.ECC_CD)" ).append("\n"); 
		query.append("			AND	A.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("		#if ( ${fmtoat} == 3 )" ).append("\n"); 
		query.append("			AND	A.FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("								AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("		#elseif ( ${fmtoat} == 4 )" ).append("\n"); 
		query.append("			AND	A.TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("								AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("	        AND	A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${userEcc} != ${userEcc} )" ).append("\n"); 
		query.append("			AND (A.FM_ECC IN ( ${userEccText} ) OR A.TO_ECC IN ( ${userEccText} ))" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ( ${fmtoat} == 1 || ${fmtoat} == 3 || ${fmtoat} == 4 ) && ${fromstatus} != '' )" ).append("\n"); 
		query.append("			AND (A.FM_ECC IN ( ${fromEccText} ) OR A.TO_ECC IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("		#end		" ).append("\n"); 
		query.append("		#if ( ${tpsz} != '' && ${tpsztype} != '' )" ).append("\n"); 
		query.append("			AND	A.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${reason} != '' )" ).append("\n"); 
		query.append("			AND	A.REPO_PLN_FB_RSN_CD IN ( ${reasonText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${itemText} != '' )" ).append("\n"); 
		query.append("			AND	A.ONF_HIR_DIV_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${sosend} != '' )" ).append("\n"); 
		query.append("			AND	(A.SO_ISS_FLG = @[sosend] OR A.NON_SO_ISS_FLG = @[sosend])" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if ( ${mty} != '' )" ).append("\n"); 
		query.append("			AND	1=0" ).append("\n"); 
		query.append("		#end	                  " ).append("\n"); 
		query.append("		GROUP BY A.PLN_YRWK" ).append("\n"); 
		query.append("			,A.CO_CD           " ).append("\n"); 
		query.append("			,A.ONF_HIR_DIV_CD  " ).append("\n"); 
		query.append("			,A.VNDR_ABBR_NM    " ).append("\n"); 
		query.append("			,A.FM_YD_CD        " ).append("\n"); 
		query.append("			,A.FM_LOC_DT       " ).append("\n"); 
		query.append("			,A.TO_YD_CD        " ).append("\n"); 
		query.append("			,A.TO_LOC_DT       " ).append("\n"); 
		query.append("			,DECODE(A.SO_ISS_FLG, 'Y', A.SO_ISS_FLG, A.NON_SO_ISS_FLG)" ).append("\n"); 
		query.append("			,A.REPO_PLN_FB_RSN_CD " ).append("\n"); 
		query.append("			,A.REPO_PLN_FB_RMK    " ).append("\n"); 
		query.append("			,A.REF_ID             " ).append("\n"); 
		query.append("			,A.FM_ECC  -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("			,A.TO_ECC  -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("	-- 4. ECC INTERNAL (Execution)-----------------------" ).append("\n"); 
		query.append("	UNION" ).append("\n"); 
		query.append("	SELECT	 A.PLN_YRWK 		PLN_YRWK" ).append("\n"); 
		query.append("			,A.CO_CD 			COMPANY" ).append("\n"); 
		query.append("			,'Execution' 		DIVISION" ).append("\n"); 
		query.append("			,DECODE(A.TRSP_MOD_CD, 'T', 'S', 'W', 'S', 'R', 'S') AS	ITEM" ).append("\n"); 
		query.append("			,'' 	LANE" ).append("\n"); 
		query.append("			,'' 	VVD" ).append("\n"); 
		query.append("			,A.FM_YD_CD  		FRLOC" ).append("\n"); 
		query.append("			,TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD') ETD" ).append("\n"); 
		query.append("			,A.TO_YD_CD  		TOLOC" ).append("\n"); 
		query.append("			,TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD') ETA" ).append("\n"); 
		query.append("			,A.EXE_ISS_FLG    SOSEND" ).append("\n"); 
		query.append("			,''    MTY" ).append("\n"); 
		query.append("			,''    LSR" ).append("\n"); 
		query.append("			,A.EQ_REPO_PURP_CD PURPOSE" ).append("\n"); 
		query.append("			,''    REASON" ).append("\n"); 
		query.append("			,''    REASONREMARK" ).append("\n"); 
		query.append("	#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("		#if ( ${velocityCount} == 1 )" ).append("\n"); 
		query.append("			,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0)" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("			TOTALVOL" ).append("\n"); 
		query.append("	#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("		#if ( ${velocityCount} == 1 )" ).append("\n"); 
		query.append("			,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.TRSP_COST_AMT)),0)" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			+NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.TRSP_COST_AMT)),0)" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("			TOTALCOST" ).append("\n"); 
		query.append("		#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("            ,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.CNTR_QTY)),0) 	 ${key}VOL" ).append("\n"); 
		query.append("            ,NVL(MAX(DECODE(A.CNTR_TPSZ_CD, '$key', A.TRSP_COST_AMT)),0) ${key}COS" ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("			,A.REF_ID" ).append("\n"); 
		query.append("			,'' BKG_NO" ).append("\n"); 
		query.append("			,2 SORTNUM   					-- HIDDEN" ).append("\n"); 
		query.append("			,B.ECC_CD FM_ECC" ).append("\n"); 
		query.append("			,C.ECC_CD TO_ECC" ).append("\n"); 
		query.append("	FROM	(" ).append("\n"); 
		query.append("			SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("					,A.PLN_YRWK" ).append("\n"); 
		query.append("					,A.REF_ID" ).append("\n"); 
		query.append("					,A.CO_CD" ).append("\n"); 
		query.append("					,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("					,A.FM_YD_CD" ).append("\n"); 
		query.append("					,A.FM_ETD_DT" ).append("\n"); 
		query.append("					,A.TO_YD_CD" ).append("\n"); 
		query.append("					,A.TO_ETA_DT" ).append("\n"); 
		query.append("					,A.EXE_ISS_FLG" ).append("\n"); 
		query.append("					,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("					,QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("					,QTY.CNTR_QTY" ).append("\n"); 
		query.append("					,QTY.TRSP_COST_AMT" ).append("\n"); 
		query.append("			FROM	 EQR_ECC_INTER_EXE_PLN A" ).append("\n"); 
		query.append("					,EQR_ECC_INTER_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("			WHERE	A.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("				AND	A.PLN_YRWK		= QTY.PLN_YRWK" ).append("\n"); 
		query.append("				AND	A.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("			) A" ).append("\n"); 
		query.append("			,MDM_EQ_ORZ_CHT B" ).append("\n"); 
		query.append("			,MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("			,MDM_LOCATION E" ).append("\n"); 
		query.append("			,MDM_LOCATION F" ).append("\n"); 
		query.append("	WHERE	SUBSTR(A.FM_YD_CD, 0, 5) = E.LOC_CD" ).append("\n"); 
		query.append("	AND     E.SCC_CD                 = B.SCC_CD" ).append("\n"); 
		query.append("	AND	SUBSTR(A.TO_YD_CD, 0, 5) = F.LOC_CD" ).append("\n"); 
		query.append("	AND     F.SCC_CD                 = C.SCC_CD" ).append("\n"); 
		query.append("	AND	A.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("	#if ( ${userEcc} != ${userEcc} )" ).append("\n"); 
		query.append("		AND (E.SCC_CD IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${userEccText} ))" ).append("\n"); 
		query.append("			OR F.SCC_CD IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${userEccText} )))" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#if ( ${fmtoat} == 1 )" ).append("\n"); 
		query.append("		AND	A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("	#if( ${fromstatus} != '' )" ).append("\n"); 
		query.append("		AND E.SCC_CD IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	#if( ${tostatus} != '' )" ).append("\n"); 
		query.append("		AND F.SCC_CD IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${toEccText} ))" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#elseif ( ${fmtoat} == 3 )" ).append("\n"); 
		query.append("		AND	TO_CHAR(A.FM_ETD_DT ,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("												AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("	#if( ${fromstatus} != '' )" ).append("\n"); 
		query.append("		AND E.SCC_CD IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	#if( ${tostatus} != '' )" ).append("\n"); 
		query.append("		AND F.SCC_CD IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${toEccText} ))" ).append("\n"); 
		query.append("	#end	            " ).append("\n"); 
		query.append("#elseif ( ${fmtoat} == 4 )" ).append("\n"); 
		query.append("		AND	TO_CHAR(A.TO_ETA_DT ,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("												AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("	#if( ${fromstatus} != '' )" ).append("\n"); 
		query.append("		AND E.SCC_CD IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	#if( ${tostatus} != '' )" ).append("\n"); 
		query.append("		AND F.SCC_CD IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${toEccText} ))" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("   	#if( ${atstatus} != '' )" ).append("\n"); 
		query.append("   		AND	(	(A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("   				AND E.SCC_CD IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${fromEccText} )))" ).append("\n"); 
		query.append("   			OR	((SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT)" ).append("\n"); 
		query.append("   					BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] AND SUBSTR(A.TO_YD_CD, 0, 5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${fromEccText} )))" ).append("\n"); 
		query.append("   			)" ).append("\n"); 
		query.append("   	#else" ).append("\n"); 
		query.append("   		AND	(	(A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("   			OR	((SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT) BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("        	)" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("	#if ( ${tpsz} != '' && ${tpsztype} != '')" ).append("\n"); 
		query.append("		AND	A.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	#if ( ${itemText} != '')" ).append("\n"); 
		query.append("		AND	DECODE(A.TRSP_MOD_CD, 'T', 'S', 'W', 'S', 'R', 'S') IN ( ${itemText} )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	#if ( ${sosend} != '')" ).append("\n"); 
		query.append("		AND	A.EXE_ISS_FLG = @[sosend]" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	#if ( ${mty} != '')" ).append("\n"); 
		query.append("		AND	1=0" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("	GROUP BY A.PLN_YRWK" ).append("\n"); 
		query.append("			,A.CO_CD" ).append("\n"); 
		query.append("			,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("			,A.FM_YD_CD" ).append("\n"); 
		query.append("			,TO_CHAR(A.FM_ETD_DT, 'YYYYMMDD')" ).append("\n"); 
		query.append("			,A.TO_YD_CD" ).append("\n"); 
		query.append("			,TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD')" ).append("\n"); 
		query.append("			,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("			,A.EXE_ISS_FLG" ).append("\n"); 
		query.append("			,A.REF_ID" ).append("\n"); 
		query.append("			,B.ECC_CD" ).append("\n"); 
		query.append("			,C.ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("		-- W/O Issue --------------------------------------" ).append("\n"); 
		query.append("		-- 1. T.VVD & D.VVD	(W/O Issue)--------------------" ).append("\n"); 
		query.append("		--(없음)" ).append("\n"); 
		query.append("		-- 2. TRUCK & RAIL & WATER (W/O Issue)-------------" ).append("\n"); 
		query.append("		UNION" ).append("\n"); 
		query.append("		SELECT	 PLN_YRWK 		PLN_YRWK" ).append("\n"); 
		query.append("				,CO_CD 			COMPANY" ).append("\n"); 
		query.append("				,'W/O Issue' 		DIVISION" ).append("\n"); 
		query.append("				,TRSP_MOD_CD      ITEM" ).append("\n"); 
		query.append("				,'' 				LANE" ).append("\n"); 
		query.append("				,'' 				VVD" ).append("\n"); 
		query.append("				,FM_YD_CD 		FRLOC" ).append("\n"); 
		query.append("				,FM_DT 			ETD" ).append("\n"); 
		query.append("				,TO_YD_CD 		TOLOC" ).append("\n"); 
		query.append("				,TO_DT 			ETA" ).append("\n"); 
		query.append("				,'' 				SOSEND" ).append("\n"); 
		query.append("				,'' 				MTY" ).append("\n"); 
		query.append("				,'' 				LSR" ).append("\n"); 
		query.append("				,'' 				PURPOSE" ).append("\n"); 
		query.append("				,'' 				REASON" ).append("\n"); 
		query.append("				,'' 				REASONREMARK" ).append("\n"); 
		query.append("				,COUNT(CNTR_TPSZ_CD) TOTALVOL" ).append("\n"); 
		query.append("		#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("			#if ( ${velocityCount} == 1 )" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(CNTR_TPSZ_CD, '$key', REPO_COST_AMT)),0)" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				+NVL(MAX(DECODE(CNTR_TPSZ_CD, '$key', REPO_COST_AMT)),0)" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("			TOTALCOST" ).append("\n"); 
		query.append("			#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("				,COUNT(DECODE(CNTR_TPSZ_CD, '$key', CNTR_TPSZ_CD))  ${key}VOL" ).append("\n"); 
		query.append("				,MAX(DECODE(CNTR_TPSZ_CD,   '$key', REPO_COST_AMT)) ${key}COST" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("				,REF_ID REFNO" ).append("\n"); 
		query.append("				,'' BKG_NO" ).append("\n"); 
		query.append("				,3 SORTNUM	 	-- HIDDEN" ).append("\n"); 
		query.append("				,E.LOC_CD FM_ECC  -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("				,F.LOC_CD TO_ECC  -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("		FROM	 EQR_REPO_EXE_SO_IF OUTER" ).append("\n"); 
		query.append("				,MDM_EQ_ORZ_CHT B" ).append("\n"); 
		query.append("				,MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("				,MDM_LOCATION E" ).append("\n"); 
		query.append("				,MDM_LOCATION F" ).append("\n"); 
		query.append("		WHERE	SUBSTR(OUTER.FM_YD_CD, 0, 5) = E.LOC_CD" ).append("\n"); 
		query.append("		AND     E.SCC_CD                     = B.SCC_CD" ).append("\n"); 
		query.append("		AND	SUBSTR(OUTER.TO_YD_CD, 0, 5) = F.LOC_CD" ).append("\n"); 
		query.append("		AND     F.SCC_CD                     = C.SCC_CD" ).append("\n"); 
		query.append("			AND	OUTER.WO_EXE_FLG = 'Y'" ).append("\n"); 
		query.append("			AND	EXISTS	(" ).append("\n"); 
		query.append("						SELECT	 INNER.REPO_PLN_ID" ).append("\n"); 
		query.append("								,INNER.PLN_YRWK" ).append("\n"); 
		query.append("								,INNER.REF_ID" ).append("\n"); 
		query.append("						FROM	(" ).append("\n"); 
		query.append("								SELECT	A.REPO_PLN_ID" ).append("\n"); 
		query.append("										,A.PLN_YRWK" ).append("\n"); 
		query.append("										,A.REF_ID" ).append("\n"); 
		query.append("										,A.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("										,A.CO_CD" ).append("\n"); 
		query.append("										,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("										,A.VSL_LANE_CD" ).append("\n"); 
		query.append("										,A.VSL_CD" ).append("\n"); 
		query.append("										,A.SKD_VOY_NO" ).append("\n"); 
		query.append("										,A.SKD_DIR_CD" ).append("\n"); 
		query.append("										,A.FM_YD_CD" ).append("\n"); 
		query.append("										,A.FM_ETD_DT" ).append("\n"); 
		query.append("										,A.TO_YD_CD" ).append("\n"); 
		query.append("										,A.TO_ETA_DT" ).append("\n"); 
		query.append("										,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("										,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("										,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("										,A.CNTR_QTY" ).append("\n"); 
		query.append("										,A.TRSP_COST_AMT" ).append("\n"); 
		query.append("										,A.EXE_RQST_DT" ).append("\n"); 
		query.append("										,A.EXE_ISS_FLG" ).append("\n"); 
		query.append("										,A.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append("										,A.FM_ECC" ).append("\n"); 
		query.append("										,A.TO_ECC" ).append("\n"); 
		query.append("								FROM    (" ).append("\n"); 
		query.append("										SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("												,A.PLN_YRWK" ).append("\n"); 
		query.append("												,A.REF_ID" ).append("\n"); 
		query.append("												,A.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("												,A.CO_CD" ).append("\n"); 
		query.append("												,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("												,A.VSL_LANE_CD" ).append("\n"); 
		query.append("												,A.VSL_CD" ).append("\n"); 
		query.append("												,A.SKD_VOY_NO" ).append("\n"); 
		query.append("												,A.SKD_DIR_CD" ).append("\n"); 
		query.append("												,A.FM_YD_CD" ).append("\n"); 
		query.append("												,A.FM_ETD_DT" ).append("\n"); 
		query.append("												,A.TO_YD_CD" ).append("\n"); 
		query.append("												,A.TO_ETA_DT" ).append("\n"); 
		query.append("												,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("												,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("												,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("												,A.CNTR_QTY" ).append("\n"); 
		query.append("												,A.TRSP_COST_AMT" ).append("\n"); 
		query.append("												,A.EXE_RQST_DT" ).append("\n"); 
		query.append("												,A.EXE_ISS_FLG" ).append("\n"); 
		query.append("												,A.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append("												,E.LOC_CD FM_ECC" ).append("\n"); 
		query.append("												,F.LOC_CD TO_ECC" ).append("\n"); 
		query.append("										FROM	(" ).append("\n"); 
		query.append("												SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("														,A.PLN_YRWK" ).append("\n"); 
		query.append("														,A.REF_ID" ).append("\n"); 
		query.append("														,A.CO_CD" ).append("\n"); 
		query.append("														,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("														,A.VSL_LANE_CD" ).append("\n"); 
		query.append("														,A.VSL_CD" ).append("\n"); 
		query.append("														,A.SKD_VOY_NO" ).append("\n"); 
		query.append("														,A.SKD_DIR_CD" ).append("\n"); 
		query.append("														,A.FM_YD_CD" ).append("\n"); 
		query.append("														,A.FM_ETD_DT" ).append("\n"); 
		query.append("														,A.TO_YD_CD" ).append("\n"); 
		query.append("														,A.TO_ETA_DT" ).append("\n"); 
		query.append("														,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("														,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("														,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("														,A.EXE_ISS_FLG" ).append("\n"); 
		query.append("														,A.REPO_MTY_BKG_FLG" ).append("\n"); 
		query.append("														,QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("														,QTY.CNTR_QTY" ).append("\n"); 
		query.append("														,QTY.TRSP_COST_AMT" ).append("\n"); 
		query.append("														,QTY.EXE_RQST_DT" ).append("\n"); 
		query.append("												FROM	 EQR_INLND_TRSP_EXE_PLN A" ).append("\n"); 
		query.append("														,EQR_INLND_TRSP_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("												WHERE	A.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("													AND	A.PLN_YRWK		= QTY.PLN_YRWK" ).append("\n"); 
		query.append("													AND	A.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("													AND	A.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("												) A" ).append("\n"); 
		query.append("												,MDM_EQ_ORZ_CHT B" ).append("\n"); 
		query.append("												,MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("												,MDM_LOCATION E" ).append("\n"); 
		query.append("												,MDM_LOCATION F" ).append("\n"); 
		query.append("										WHERE	SUBSTR(A.FM_YD_CD, 0, 5) = E.LOC_CD" ).append("\n"); 
		query.append("										AND     E.SCC_CD                 = B.SCC_CD" ).append("\n"); 
		query.append("											AND	SUBSTR(A.TO_YD_CD, 0, 5) = F.LOC_CD" ).append("\n"); 
		query.append("											AND     F.SCC_CD                 = C.SCC_CD" ).append("\n"); 
		query.append("										) A" ).append("\n"); 
		query.append("										,EQR_INLND_TRSP_PLN     B" ).append("\n"); 
		query.append("								WHERE	A.REPO_PLN_ID = B.REPO_PLN_ID" ).append("\n"); 
		query.append("									AND	A.PLN_YRWK    = B.PLN_YRWK" ).append("\n"); 
		query.append("									AND	A.TRSP_MOD_CD = B.TRSP_MOD_CD" ).append("\n"); 
		query.append("									AND	A.FM_ECC      = B.FM_ECC_CD" ).append("\n"); 
		query.append("									AND	A.TO_ECC      = B.TO_ECC_CD" ).append("\n"); 
		query.append("									AND	A.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("								#if ( ${userEcc} != ${userEcc} )" ).append("\n"); 
		query.append("									AND (A.FM_ECC IN ( ${userEccText} ) OR A.TO_ECC IN ( ${userEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("							#if ( ${fmtoat} == 1 )" ).append("\n"); 
		query.append("									AND	A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("								#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("									AND A.FM_ECC IN ( ${fromEccText} )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("									AND A.TO_ECC IN ( ${toEccText} )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("							#elseif ( ${fmtoat} == 3 )" ).append("\n"); 
		query.append("									AND	TO_CHAR(A.FM_ETD_DT ,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("																			AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("								#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("									AND SUBSTR(A.FM_YD_CD, 0, 5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("									AND SUBSTR(A.TO_YD_CD, 0, 5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${toEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("							#elseif ( ${fmtoat} == 4 )" ).append("\n"); 
		query.append("									AND	TO_CHAR(A.TO_ETA_DT ,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("																			AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("								#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("									AND SUBSTR(A.FM_YD_CD, 0, 5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("									AND SUBSTR(A.TO_YD_CD, 0, 5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${toEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("							#else" ).append("\n"); 
		query.append("								#if ( ${atstatus} != '' )" ).append("\n"); 
		query.append("									AND	(	(A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] AND A.FM_ECC IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("										OR	((SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT)" ).append("\n"); 
		query.append("												BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] AND A.TO_ECC IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("										)" ).append("\n"); 
		query.append("								#else" ).append("\n"); 
		query.append("									AND	(	(A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("										OR	((SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT)" ).append("\n"); 
		query.append("												BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("										)" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("							#end" ).append("\n"); 
		query.append("								#if ( ${tpsz} != '' && ${tpsztype} != '' )" ).append("\n"); 
		query.append("									AND	A.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${itemText} != '' )" ).append("\n"); 
		query.append("									AND	B.TRSP_MOD_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${reason} != '' )" ).append("\n"); 
		query.append("									AND	A.REPO_PLN_FB_RSN_CD IN ( ${reasonText} )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${sosend} != '' )" ).append("\n"); 
		query.append("									AND	A.EXE_ISS_FLG = @[sosend]" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${lane} != '' )" ).append("\n"); 
		query.append("									AND	A.VSL_LANE_CD IN ( ${laneText} )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${vvd} != '' )" ).append("\n"); 
		query.append("									AND	A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD IN ( ${vvdText} )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${mty} != '' )" ).append("\n"); 
		query.append("									AND	A.REPO_MTY_BKG_FLG = @[mty]" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								) INNER" ).append("\n"); 
		query.append("						WHERE	INNER.REPO_PLN_ID = OUTER.REPO_PLN_ID" ).append("\n"); 
		query.append("							AND	INNER.REF_ID      = OUTER.REF_ID" ).append("\n"); 
		query.append("							AND	INNER.PLN_YRWK    = OUTER.PLN_YRWK" ).append("\n"); 
		query.append("						)" ).append("\n"); 
		query.append("		GROUP BY PLN_YRWK" ).append("\n"); 
		query.append("				,CO_CD" ).append("\n"); 
		query.append("				,TRSP_MOD_CD" ).append("\n"); 
		query.append("				,FM_YD_CD" ).append("\n"); 
		query.append("				,FM_DT" ).append("\n"); 
		query.append("				,TO_YD_CD" ).append("\n"); 
		query.append("				,TO_DT" ).append("\n"); 
		query.append("				,REF_ID" ).append("\n"); 
		query.append("				,E.LOC_CD -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("				,F.LOC_CD -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		--lane & vvd 검색조건이 들어오면 on-off hire 조외하지 않음" ).append("\n"); 
		query.append("	#if ( ${lane} == '' && ${vvd} == '' )" ).append("\n"); 
		query.append("		-- 3. ON-HIRE & OFF-HIRE (W/O Issue)-----------" ).append("\n"); 
		query.append("		UNION" ).append("\n"); 
		query.append("		SELECT	 PLN_YRWK 		PLN_YRWK" ).append("\n"); 
		query.append("				,CO_CD 			COMPANY" ).append("\n"); 
		query.append("				,'W/O Issue' 		DIVISION" ).append("\n"); 
		query.append("				,SO_IF_DIV_CD     ITEM" ).append("\n"); 
		query.append("				,''     			LANE" ).append("\n"); 
		query.append("				,''    			VVD" ).append("\n"); 
		query.append("				,FM_YD_CD 		FRLOC" ).append("\n"); 
		query.append("				,FM_DT 			ETD" ).append("\n"); 
		query.append("				,TO_YD_CD 		TOLOC" ).append("\n"); 
		query.append("				,TO_DT 			ETA" ).append("\n"); 
		query.append("				,'' SOSEND" ).append("\n"); 
		query.append("				,'' MTY" ).append("\n"); 
		query.append("				,'' LSR" ).append("\n"); 
		query.append("				,'' PURPOSE" ).append("\n"); 
		query.append("				,'' REASON" ).append("\n"); 
		query.append("				,'' REASONREMARK" ).append("\n"); 
		query.append("				,COUNT(CNTR_TPSZ_CD) TOTALVOL" ).append("\n"); 
		query.append("		#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("			#if ( ${velocityCount} == 1 )" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(CNTR_TPSZ_CD, '$key', REPO_COST_AMT)),0)" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				+NVL(MAX(DECODE(CNTR_TPSZ_CD, '$key', REPO_COST_AMT)),0)" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("				TOTALCOST" ).append("\n"); 
		query.append("			#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("				,COUNT(DECODE(CNTR_TPSZ_CD, '$key', CNTR_TPSZ_CD))  ${key}VOL" ).append("\n"); 
		query.append("				,MAX(DECODE(CNTR_TPSZ_CD,   '$key', REPO_COST_AMT)) ${key}COST" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("				,REF_ID REFNO" ).append("\n"); 
		query.append("				,'' BKG_NO" ).append("\n"); 
		query.append("				,3 SORTNUM	 	-- HIDDEN" ).append("\n"); 
		query.append("				,B.LCC_CD FM_ECC  -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("				,C.LCC_CD TO_ECC  -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("		FROM	 EQR_REPO_EXE_SO_IF OUTER" ).append("\n"); 
		query.append("				,MDM_EQ_ORZ_CHT B" ).append("\n"); 
		query.append("				,MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("				,MDM_LOCATION E" ).append("\n"); 
		query.append("				,MDM_LOCATION F" ).append("\n"); 
		query.append("		WHERE	OUTER.WO_EXE_FLG = 'Y'" ).append("\n"); 
		query.append("			AND	EXISTS	(" ).append("\n"); 
		query.append("						SELECT	 INNER.REPO_PLN_ID" ).append("\n"); 
		query.append("								,INNER.REF_ID" ).append("\n"); 
		query.append("								,INNER.PLN_YRWK" ).append("\n"); 
		query.append("						FROM	(" ).append("\n"); 
		query.append("								SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("										,A.PLN_YRWK" ).append("\n"); 
		query.append("										,A.REF_ID" ).append("\n"); 
		query.append("										,A.ONF_HIR_DIV_CD" ).append("\n"); 
		query.append("										,A.FM_ECC" ).append("\n"); 
		query.append("										,A.TO_ECC" ).append("\n"); 
		query.append("										,A.CO_CD" ).append("\n"); 
		query.append("										,A.SO_ISS_FLG" ).append("\n"); 
		query.append("										,A.NON_SO_ISS_FLG" ).append("\n"); 
		query.append("										,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("								FROM	(" ).append("\n"); 
		query.append("										SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("												,A.PLN_YRWK" ).append("\n"); 
		query.append("												,A.REF_ID" ).append("\n"); 
		query.append("												,A.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("												,A.CO_CD" ).append("\n"); 
		query.append("												,A.ONF_HIR_DIV_CD" ).append("\n"); 
		query.append("												,A.VNDR_CNT_CD" ).append("\n"); 
		query.append("												,A.VNDR_SEQ" ).append("\n"); 
		query.append("												,A.VNDR_ABBR_NM" ).append("\n"); 
		query.append("												,A.FM_YD_CD" ).append("\n"); 
		query.append("												,A.FM_LOC_DT" ).append("\n"); 
		query.append("												,A.TO_YD_CD" ).append("\n"); 
		query.append("												,A.TO_LOC_DT" ).append("\n"); 
		query.append("												,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("												,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("												,A.CNTR_QTY" ).append("\n"); 
		query.append("												,A.ONF_HIR_COST_AMT" ).append("\n"); 
		query.append("												,A.SO_RQST_DT" ).append("\n"); 
		query.append("												,A.SO_ISS_FLG" ).append("\n"); 
		query.append("												,A.NON_SO_ISS_FLG" ).append("\n"); 
		query.append("												,B.LCC_CD FM_ECC" ).append("\n"); 
		query.append("												,C.LCC_CD TO_ECC" ).append("\n"); 
		query.append("										FROM	(" ).append("\n"); 
		query.append("												SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("														,A.PLN_YRWK" ).append("\n"); 
		query.append("														,A.REF_ID" ).append("\n"); 
		query.append("														,A.CO_CD" ).append("\n"); 
		query.append("														,A.ONF_HIR_DIV_CD" ).append("\n"); 
		query.append("														,A.VNDR_CNT_CD" ).append("\n"); 
		query.append("														,A.VNDR_SEQ" ).append("\n"); 
		query.append("														,A.VNDR_ABBR_NM" ).append("\n"); 
		query.append("														,A.FM_YD_CD" ).append("\n"); 
		query.append("														,A.FM_LOC_DT" ).append("\n"); 
		query.append("														,A.TO_YD_CD" ).append("\n"); 
		query.append("														,A.TO_LOC_DT" ).append("\n"); 
		query.append("														,A.REPO_PLN_FB_RSN_CD" ).append("\n"); 
		query.append("														,A.REPO_PLN_FB_RMK" ).append("\n"); 
		query.append("														,A.SO_RQST_DT" ).append("\n"); 
		query.append("														,A.SO_ISS_FLG" ).append("\n"); 
		query.append("														,A.NON_SO_ISS_FLG" ).append("\n"); 
		query.append("														,QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("														,QTY.CNTR_QTY" ).append("\n"); 
		query.append("														,QTY.ONF_HIR_COST_AMT" ).append("\n"); 
		query.append("												FROM	 EQR_ONF_HIR_EXE_PLN A" ).append("\n"); 
		query.append("														,EQR_ONF_HIR_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("												WHERE	A.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("													AND	A.PLN_YRWK		= QTY.PLN_YRWK" ).append("\n"); 
		query.append("													AND	A.PLN_SEQ		= QTY.PLN_SEQ" ).append("\n"); 
		query.append("													AND	A.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("												) A" ).append("\n"); 
		query.append("												,MDM_EQ_ORZ_CHT B" ).append("\n"); 
		query.append("												,MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("												,MDM_LOCATION E" ).append("\n"); 
		query.append("												,MDM_LOCATION F" ).append("\n"); 
		query.append("										WHERE	SUBSTR(A.FM_YD_CD, 0, 5) = E.LOC_CD" ).append("\n"); 
		query.append("										AND     E.SCC_CD                 = B.SCC_CD" ).append("\n"); 
		query.append("										AND	SUBSTR(A.TO_YD_CD, 0, 5) = F.LOC_CD" ).append("\n"); 
		query.append("										AND     F.SCC_CD                 = C.SCC_CD" ).append("\n"); 
		query.append("										) A" ).append("\n"); 
		query.append("										,EQR_ONF_HIR_PLN B" ).append("\n"); 
		query.append("								WHERE	A.REPO_PLN_ID = B.REPO_PLN_ID" ).append("\n"); 
		query.append("									AND	A.PLN_YRWK    = B.PLN_YRWK" ).append("\n"); 
		query.append("									AND	A.ONF_HIR_DIV_CD = B.ONF_HIR_DIV_CD" ).append("\n"); 
		query.append("									AND	(A.FM_ECC = B.ECC_CD OR A.TO_ECC = B.ECC_CD)" ).append("\n"); 
		query.append("									AND	A.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("								#if ( ${fmtoat} == 3 )" ).append("\n"); 
		query.append("									AND	A.FM_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("														AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("								#elseif ( ${fmtoat} == 4 )" ).append("\n"); 
		query.append("									AND	A.TO_LOC_DT BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("														AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("								#else" ).append("\n"); 
		query.append("									AND	A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${userEcc} != ${userEcc} )" ).append("\n"); 
		query.append("									AND (A.FM_ECC IN ( ${userEccText} ) OR A.TO_ECC IN ( ${userEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ( ${fmtoat} == 1 || ${fmtoat} == 3 || ${fmtoat} == 4 ) && ${fromstatus} != '' )" ).append("\n"); 
		query.append("									AND (A.FM_ECC IN ( ${fromEccText} ) OR A.TO_ECC IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${tpsz} != '' && ${tpsztype} != '')" ).append("\n"); 
		query.append("									AND A.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${itemText} != '' )" ).append("\n"); 
		query.append("									AND B.ONF_HIR_DIV_CD IN ( ${itemText} )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${sosend} != '' )" ).append("\n"); 
		query.append("									AND (A.SO_ISS_FLG = @[sosend] OR A.NON_SO_ISS_FLG= @[sosend] )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${reason} != '' )" ).append("\n"); 
		query.append("									AND A.REPO_PLN_FB_RSN_CD IN ( ${reasonText} )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${mty} != '' )" ).append("\n"); 
		query.append("									AND 1=0" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								) INNER" ).append("\n"); 
		query.append("						WHERE	INNER.REPO_PLN_ID = OUTER.REPO_PLN_ID " ).append("\n"); 
		query.append("							AND	INNER.REF_ID		= OUTER.REF_ID" ).append("\n"); 
		query.append("							AND	INNER.PLN_YRWK 	= OUTER.PLN_YRWK" ).append("\n"); 
		query.append("						)" ).append("\n"); 
		query.append("					AND	SUBSTR(OUTER.FM_YD_CD, 0, 5) = E.LOC_CD" ).append("\n"); 
		query.append("					AND     E.SCC_CD                 = B.SCC_CD" ).append("\n"); 
		query.append("					AND SUBSTR(OUTER.TO_YD_CD, 0, 5) = F.LOC_CD" ).append("\n"); 
		query.append("					AND     F.SCC_CD                 = C.SCC_CD" ).append("\n"); 
		query.append("		GROUP BY OUTER.PLN_YRWK" ).append("\n"); 
		query.append("				,OUTER.CO_CD" ).append("\n"); 
		query.append("				,OUTER.SO_IF_DIV_CD" ).append("\n"); 
		query.append("				,OUTER.FM_YD_CD" ).append("\n"); 
		query.append("				,OUTER.FM_DT" ).append("\n"); 
		query.append("				,OUTER.TO_YD_CD" ).append("\n"); 
		query.append("				,OUTER.TO_DT" ).append("\n"); 
		query.append("				,OUTER.REF_ID" ).append("\n"); 
		query.append("				,B.LCC_CD    -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("				,C.LCC_CD    -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("		-- 4. ECC INTERNAL       (W/O Issue)-----------" ).append("\n"); 
		query.append("		UNION" ).append("\n"); 
		query.append("		SELECT	 PLN_YRWK 		PLN_YRWK" ).append("\n"); 
		query.append("				,CO_CD 			COMPANY" ).append("\n"); 
		query.append("				,'W/O Issue' 	DIVISION" ).append("\n"); 
		query.append("				,'S'      ITEM" ).append("\n"); 
		query.append("				,''               LANE" ).append("\n"); 
		query.append("				,''               VVD" ).append("\n"); 
		query.append("				,FM_YD_CD 		FRLOC" ).append("\n"); 
		query.append("				,FM_DT 			ETD" ).append("\n"); 
		query.append("				,TO_YD_CD 		TOLOC" ).append("\n"); 
		query.append("				,TO_DT 			ETA" ).append("\n"); 
		query.append("				,'' SOSEND" ).append("\n"); 
		query.append("				,'' MTY" ).append("\n"); 
		query.append("				,'' LSR" ).append("\n"); 
		query.append("				,'' PURPOSE" ).append("\n"); 
		query.append("				,'' REASON" ).append("\n"); 
		query.append("				,'' REASONREMARK" ).append("\n"); 
		query.append("				,COUNT(CNTR_TPSZ_CD) TOTALVOL" ).append("\n"); 
		query.append("		#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("			#if ( ${velocityCount} == 1 )" ).append("\n"); 
		query.append("				,NVL(MAX(DECODE(CNTR_TPSZ_CD, '$key', REPO_COST_AMT)),0)" ).append("\n"); 
		query.append("			#else" ).append("\n"); 
		query.append("				+NVL(MAX(DECODE(CNTR_TPSZ_CD, '$key', REPO_COST_AMT)),0)" ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("				TOTALCOST" ).append("\n"); 
		query.append("			#foreach ( $key in ${arrtpsz} )" ).append("\n"); 
		query.append("				,COUNT(DECODE(CNTR_TPSZ_CD, '$key', CNTR_TPSZ_CD))  ${key}VOL" ).append("\n"); 
		query.append("				,MAX(DECODE(CNTR_TPSZ_CD,   '$key', REPO_COST_AMT)) ${key}COST" ).append("\n"); 
		query.append("			#end " ).append("\n"); 
		query.append("				,REF_ID REFNO" ).append("\n"); 
		query.append("				,'' BKG_NO" ).append("\n"); 
		query.append("				,3 SORTNUM	 	-- HIDDEN" ).append("\n"); 
		query.append("				,B.LCC_CD FM_ECC  -- SORT에 사용될 SCC의 해당 FM ECC 정보" ).append("\n"); 
		query.append("				,C.LCC_CD TO_ECC  -- SORT에 사용될 SCC의 해당 TO ECC 정보" ).append("\n"); 
		query.append("		FROM	 EQR_REPO_EXE_SO_IF OUTER" ).append("\n"); 
		query.append("				,MDM_EQ_ORZ_CHT B" ).append("\n"); 
		query.append("				,MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("				,MDM_LOCATION E" ).append("\n"); 
		query.append("				,MDM_LOCATION F" ).append("\n"); 
		query.append("		WHERE	SUBSTR(OUTER.FM_YD_CD, 0, 5) = E.LOC_CD" ).append("\n"); 
		query.append("		AND     E.SCC_CD                 = B.SCC_CD" ).append("\n"); 
		query.append("			AND	SUBSTR(OUTER.TO_YD_CD, 0, 5) = F.LOC_CD" ).append("\n"); 
		query.append("			AND     F.SCC_CD                 = C.SCC_CD" ).append("\n"); 
		query.append("			AND	OUTER.WO_EXE_FLG = 'Y'" ).append("\n"); 
		query.append("			AND	EXISTS	(" ).append("\n"); 
		query.append("						SELECT	 REPO_PLN_ID" ).append("\n"); 
		query.append("								,REF_ID" ).append("\n"); 
		query.append("								,PLN_YRWK" ).append("\n"); 
		query.append("						FROM	(" ).append("\n"); 
		query.append("								SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("										,A.PLN_YRWK" ).append("\n"); 
		query.append("										,A.REF_ID" ).append("\n"); 
		query.append("										,A.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("										,A.CO_CD" ).append("\n"); 
		query.append("										,DECODE(A.TRSP_MOD_CD, 'T', 'S', 'W', 'S', 'R', 'S') TRSP_MOD_CD" ).append("\n"); 
		query.append("										,A.FM_YD_CD" ).append("\n"); 
		query.append("										,A.FM_ETD_DT" ).append("\n"); 
		query.append("										,A.TO_YD_CD" ).append("\n"); 
		query.append("										,A.TO_ETA_DT" ).append("\n"); 
		query.append("										,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("										,A.CNTR_QTY" ).append("\n"); 
		query.append("										,A.TRSP_COST_AMT" ).append("\n"); 
		query.append("										,A.EXE_RQST_DT" ).append("\n"); 
		query.append("										,A.EXE_ISS_FLG" ).append("\n"); 
		query.append("								FROM	(" ).append("\n"); 
		query.append("										SELECT	 A.REPO_PLN_ID" ).append("\n"); 
		query.append("												,A.PLN_YRWK" ).append("\n"); 
		query.append("												,A.REF_ID" ).append("\n"); 
		query.append("												,A.CO_CD" ).append("\n"); 
		query.append("												,A.TRSP_MOD_CD" ).append("\n"); 
		query.append("												,A.FM_YD_CD" ).append("\n"); 
		query.append("												,A.FM_ETD_DT" ).append("\n"); 
		query.append("												,A.TO_YD_CD" ).append("\n"); 
		query.append("												,A.TO_ETA_DT" ).append("\n"); 
		query.append("												,A.EQ_REPO_PURP_CD" ).append("\n"); 
		query.append("												,A.EXE_ISS_FLG" ).append("\n"); 
		query.append("												,QTY.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("												,QTY.CNTR_QTY" ).append("\n"); 
		query.append("												,QTY.TRSP_COST_AMT" ).append("\n"); 
		query.append("												,QTY.EXE_RQST_DT" ).append("\n"); 
		query.append("										FROM	 EQR_ECC_INTER_EXE_PLN A" ).append("\n"); 
		query.append("												,EQR_ECC_INTER_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("										WHERE	A.REPO_PLN_ID	= QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("											AND	A.PLN_YRWK		= QTY.PLN_YRWK" ).append("\n"); 
		query.append("											AND	A.REF_ID		= QTY.REF_ID" ).append("\n"); 
		query.append("										) A" ).append("\n"); 
		query.append("								WHERE	A.REPO_PLN_ID = @[repo_pln_id]" ).append("\n"); 
		query.append("								#if ( ${userEcc} != ${userEcc} )" ).append("\n"); 
		query.append("									AND (SUBSTR(A.FM_YD_CD, 0, 5) IN (SELECT LOC_CD FROM MDM_EQ_ORZ_CHT CT, MDM_LOCATION ML WHERE  CT.SCC_CD = ML.SCC_CD AND ECC_CD IN ( ${userEccText} ))" ).append("\n"); 
		query.append("										OR SUBSTR(A.TO_YD_CD, 0, 5) IN (SELECT LOC_CD FROM MDM_EQ_ORZ_CHT CT, MDM_LOCATION ML WHERE  CT.SCC_CD = ML.SCC_CD AND ECC_CD IN ( ${userEccText} )))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("							#if ( ${fmtoat} == 1 )" ).append("\n"); 
		query.append("									AND	A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk]" ).append("\n"); 
		query.append("								#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("									AND SUBSTR(A.FM_YD_CD, 0, 5) IN (SELECT LOC_CD FROM MDM_EQ_ORZ_CHT CT, MDM_LOCATION ML WHERE  CT.SCC_CD = ML.SCC_CD AND ECC_CD IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("									AND SUBSTR(A.TO_YD_CD, 0, 5) IN (SELECT LOC_CD FROM MDM_EQ_ORZ_CHT CT, MDM_LOCATION ML WHERE  CT.SCC_CD = ML.SCC_CD AND ECC_CD IN ( ${toEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("							#elseif ( ${fmtoat} == 3 )" ).append("\n"); 
		query.append("									AND	TO_CHAR(A.FM_ETD_DT ,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("																			AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[to_plnyrwk])" ).append("\n"); 
		query.append("								#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("									AND SUBSTR(A.FM_YD_CD, 0, 5) IN (SELECT LOC_CD FROM MDM_EQ_ORZ_CHT CT, MDM_LOCATION ML WHERE  CT.SCC_CD = ML.SCC_CD AND ECC_CD IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("									 AND SUBSTR(A.TO_YD_CD, 0, 5) IN (SELECT LOC_CD FROM MDM_EQ_ORZ_CHT CT, MDM_LOCATION ML WHERE  CT.SCC_CD = ML.SCC_CD AND ECC_CD IN ( ${toEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("							#elseif ( ${fmtoat} == 4 )" ).append("\n"); 
		query.append("								AND	TO_CHAR(A.TO_ETA_DT ,'YYYYMMDD') BETWEEN (SELECT WK_ST_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK = @[fm_plnyrwk])" ).append("\n"); 
		query.append("																		AND (SELECT WK_END_DT  FROM EQR_WK_PRD WHERE PLN_YR||PLN_WK =@[to_plnyrwk] )" ).append("\n"); 
		query.append("								#if ( ${fromstatus} != '' )" ).append("\n"); 
		query.append("									AND SUBSTR(A.FM_YD_CD, 0, 5) IN (SELECT LOC_CD FROM MDM_EQ_ORZ_CHT CT, MDM_LOCATION ML WHERE  CT.SCC_CD = ML.SCC_CD AND ECC_CD IN ( ${fromEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${tostatus} != '' )" ).append("\n"); 
		query.append("									 AND SUBSTR(A.TO_YD_CD, 0, 5) IN (SELECT LOC_CD FROM MDM_EQ_ORZ_CHT CT, MDM_LOCATION ML WHERE  CT.SCC_CD = ML.SCC_CD AND ECC_CD IN ( ${toEccText} ))" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("							#else" ).append("\n"); 
		query.append("								#if ( ${atstatus} != '' )" ).append("\n"); 
		query.append("									AND	(	(A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] AND SUBSTR(A.FM_YD_CD, 0, 5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${fromEccText} )))" ).append("\n"); 
		query.append("										OR	((SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT) BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] " ).append("\n"); 
		query.append("											AND SUBSTR(A.TO_YD_CD, 0, 5) IN (SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE ECC_CD IN ( ${fromEccText} )))" ).append("\n"); 
		query.append("										)" ).append("\n"); 
		query.append("								#else" ).append("\n"); 
		query.append("									AND	(	(A.PLN_YRWK BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("										OR	((SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(A.TO_ETA_DT, 'YYYYMMDD') BETWEEN WK_ST_DT AND WK_END_DT) BETWEEN @[fm_plnyrwk] AND  @[to_plnyrwk] )" ).append("\n"); 
		query.append("										)" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("							#end" ).append("\n"); 
		query.append("								#if ( ${tpsz} != '' && ${tpsz} != '' )" ).append("\n"); 
		query.append("									AND	A.CNTR_TPSZ_CD IN ( ${tpszText} )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${itemText} != '' )" ).append("\n"); 
		query.append("									AND	DECODE(A.TRSP_MOD_CD, 'T', 'S', 'W', 'S', 'R', 'S') IN ( ${itemText} )" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${sosend} != '' )" ).append("\n"); 
		query.append("									AND	A.EXE_ISS_FLG = @[sosend]" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								#if ( ${mty} != '' )" ).append("\n"); 
		query.append("									AND	1 = 0" ).append("\n"); 
		query.append("								#end" ).append("\n"); 
		query.append("								) INNER" ).append("\n"); 
		query.append("						WHERE	INNER.REPO_PLN_ID = OUTER.REPO_PLN_ID" ).append("\n"); 
		query.append("							AND	INNER.REF_ID      = OUTER.REF_ID" ).append("\n"); 
		query.append("							AND	INNER.PLN_YRWK    = OUTER.PLN_YRWK" ).append("\n"); 
		query.append("						)" ).append("\n"); 
		query.append("				GROUP BY PLN_YRWK" ).append("\n"); 
		query.append("						,CO_CD" ).append("\n"); 
		query.append("						,FM_YD_CD" ).append("\n"); 
		query.append("						,FM_DT" ).append("\n"); 
		query.append("						,TO_YD_CD" ).append("\n"); 
		query.append("						,TO_DT" ).append("\n"); 
		query.append("						,REF_ID" ).append("\n"); 
		query.append("						,B.LCC_CD" ).append("\n"); 
		query.append("						,C.LCC_CD" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("				) A," ).append("\n"); 
		query.append("				(" ).append("\n"); 
		query.append("				SELECT 1 NUM, '' NAME		FROM DUAL	UNION" ).append("\n"); 
		query.append("				SELECT 2 NUM, 'TOTAL' NAME	FROM DUAL	UNION" ).append("\n"); 
		query.append("				SELECT 3 NUM, 'GRAND TOTAL' NAME FROM DUAL" ).append("\n"); 
		query.append("				) B" ).append("\n"); 
		query.append("		GROUP BY DECODE(B.NUM, 1, A.PLN_YRWK, 2, A.PLN_YRWK||' TTL', 3, 'TOTAL')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.COMPANY,  2, '', 3, '')" ).append("\n"); 
		query.append("				,A.DIVISION" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.ITEM ,  2, '', 3, '')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.LANE ,  2, '', 3, '')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.VVD  ,  2, '', 3, '')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.FRLOC,  2, '', 3, '')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.ETD  ,  2, NULL, 3, NULL)" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.TOLOC,  2, '', 3, '')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.ETA  ,  2, NULL, 3, NULL)" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.SOSEND  ,  2, NULL, 3, NULL)" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.MTY,  2, '', 3, '')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.LSR,  2, '', 3, '')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.PURPOSE,  2, '', 3, '')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.REASON,  2, '', 3, '')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.REASONREMARK,  2, '', 3, '')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.REF_ID,  2, '', 3, '')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.BKG_NO,  2, '', 3, '')" ).append("\n"); 
		query.append("				,A.SORTNUM    	    -- HIDDEN" ).append("\n"); 
		query.append("				,B.NUM         		-- HIDDEN" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.FM_ECC,  2, '', 3, '')" ).append("\n"); 
		query.append("				,DECODE(B.NUM, 1, A.TO_ECC,  2, '', 3, '')" ).append("\n"); 
		query.append("		)" ).append("\n"); 
		query.append("GROUP BY PLN_YRWK" ).append("\n"); 
		query.append("		,COMPANY" ).append("\n"); 
		query.append("		,DIVISION" ).append("\n"); 
		query.append("		,ITEM" ).append("\n"); 
		query.append("		,LANE" ).append("\n"); 
		query.append("		,VVD" ).append("\n"); 
		query.append("		,FRLOC" ).append("\n"); 
		query.append("		,ETD" ).append("\n"); 
		query.append("		,TOLOC" ).append("\n"); 
		query.append("		,ETA" ).append("\n"); 
		query.append("		,SOSEND" ).append("\n"); 
		query.append("		,MTY" ).append("\n"); 
		query.append("		,LSR" ).append("\n"); 
		query.append("		,PURPOSE" ).append("\n"); 
		query.append("		,REASON" ).append("\n"); 
		query.append("		,REASONREMARK" ).append("\n"); 
		query.append("		,REF_ID" ).append("\n"); 
		query.append("		,BKG_NO" ).append("\n"); 
		query.append("		,SORTNUM    	-- HIDDEN" ).append("\n"); 
		query.append("		,NUM        	-- HIDDEN" ).append("\n"); 
		query.append("		,FM_ECC||TO_ECC" ).append("\n"); 
		query.append("		ORDER BY 1, ITEM DESC, FM_ECC||TO_ECC, REF_ID||SORTNUM" ).append("\n"); 

	}
}