<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ContainerOnOffhireDBDAOValidationSpecNoTpszRSQL">
			<desc><![CDATA[AGMT No와 spec No간의 tpsz 비교]]></desc>
			<sql><![CDATA[
SELECT AA.AGMT_CTY_CD
, AA.AGMT_SEQ
, AA.CNTR_TPSZ_CD
FROM   (
SELECT A.AGMT_CTY_CD
, A.AGMT_SEQ
, A.LOC_CD
, A.CNTR_TPSZ_CD
, A.CNTR_SPEC_NO
, A.CNTR_RNTL_CHG_TP_CD
, A.AGMT_CHG_VAL AS QTY
, A.N1ST_CHG_AMT AS REPL_VALUE
, A.N2ND_CHG_AMT AS PUR_PRICE
, A.AGMT_CHG_DYS AS PUR_PERIOD
, NULL           AS GATE_IN
, NULL           AS GATE_OUT
, A.GEN_RMK
FROM   LSE_AGMT_RT A
, LSE_AGREEMENT B
WHERE  A.CNTR_RNTL_CHG_TP_CD = 'GENV'
AND    A.AGMT_SEQ    = B.AGMT_SEQ
AND    A.AGMT_CTY_CD = B.AGMT_CTY_CD
AND    B.AGMT_LST_VER_SEQ = NVL(null, B.AGMT_LST_VER_SEQ)
AND    B.AGMT_CTY_CD || LPAD(B.AGMT_SEQ, 6, '0')   = @[agmt_no]
UNION ALL
SELECT A.AGMT_CTY_CD
, A.AGMT_SEQ
, A.LOC_CD
, A.CNTR_TPSZ_CD
, A.CNTR_SPEC_NO
, A.CNTR_RNTL_CHG_TP_CD
, NULL           AS QTY
, NULL           AS REPL_VALUE
, NULL           AS PUR_PRICE
, NULL           AS PUR_PERIOD
, N1ST_CHG_AMT   AS GATE_IN
, N2ND_CHG_AMT   AS GATE_OUT
, NULL           AS GEN_RMK
FROM   LSE_AGMT_RT A
, LSE_AGREEMENT B
WHERE  A.CNTR_RNTL_CHG_TP_CD = 'GATV'
AND    A.AGMT_SEQ    = B.AGMT_SEQ
AND    A.AGMT_CTY_CD = B.AGMT_CTY_CD
AND    B.AGMT_LST_VER_SEQ = NVL(null, B.AGMT_LST_VER_SEQ)
AND    B.AGMT_CTY_CD || LPAD(B.AGMT_CTY_CD, 6, '0')   = @[agmt_no]
UNION ALL
SELECT A.AGMT_CTY_CD
, A.AGMT_SEQ
, A.LOC_CD
, A.CNTR_TPSZ_CD
, A.CNTR_SPEC_NO
, A.CNTR_RNTL_CHG_TP_CD
, A.AGMT_CHG_VAL AS QTY
, A.N1ST_CHG_AMT AS REPL_VALUE
, A.N2ND_CHG_AMT AS PUR_PRICE
, A.AGMT_CHG_DYS AS PUR_PERIOD
, NULL           AS GATE_IN
, NULL           AS GATE_OUT
, A.GEN_RMK
FROM   LSE_AGMT_RT_HIS A
, LSE_AGREEMENT B
WHERE  A.CNTR_RNTL_CHG_TP_CD = 'GENV'
AND    A.AGMT_VER_SEQ = DECODE(B.AGMT_LST_VER_SEQ, null, 9999, null)
AND    A.AGMT_SEQ    = B.AGMT_SEQ
AND    A.AGMT_CTY_CD = B.AGMT_CTY_CD
AND    B.AGMT_CTY_CD || LPAD(B.AGMT_CTY_CD, 6, '0')   = @[agmt_no]
UNION ALL
SELECT A.AGMT_CTY_CD
, A.AGMT_SEQ
, A.LOC_CD
, A.CNTR_TPSZ_CD
, A.CNTR_SPEC_NO
, A.CNTR_RNTL_CHG_TP_CD
, NULL           AS QTY
, NULL           AS REPL_VALUE
, NULL           AS PUR_PRICE
, NULL           AS PUR_PERIOD
, N1ST_CHG_AMT   AS GATE_IN
, N2ND_CHG_AMT   AS GATE_OUT
, NULL           AS GEN_RMK
FROM   LSE_AGMT_RT_HIS A
, LSE_AGREEMENT B
WHERE  A.CNTR_RNTL_CHG_TP_CD = 'GATV'
AND    A.AGMT_VER_SEQ = DECODE(B.AGMT_LST_VER_SEQ, null, 9999, null)
AND    A.AGMT_SEQ    = B.AGMT_SEQ
AND    A.AGMT_CTY_CD = B.AGMT_CTY_CD
AND    B.AGMT_CTY_CD || LPAD(B.AGMT_CTY_CD, 6, '0')   = @[agmt_no]
) AA
, MDM_CNTR_TP_SZ BB
WHERE  AA.CNTR_TPSZ_CD = BB.CNTR_TPSZ_CD
GROUP  BY AA.AGMT_CTY_CD
, AA.AGMT_SEQ
, AA.LOC_CD
, AA.CNTR_TPSZ_CD
, BB.RPT_DP_SEQ
ORDER  BY BB.RPT_DP_SEQ
			]]></sql>
			<params>
				<param name="agmt_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
