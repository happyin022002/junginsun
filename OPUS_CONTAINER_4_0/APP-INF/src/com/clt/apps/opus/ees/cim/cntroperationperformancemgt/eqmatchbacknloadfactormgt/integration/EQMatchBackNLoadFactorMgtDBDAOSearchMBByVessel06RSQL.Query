<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EQMatchBackNLoadFactorMgtDBDAOSearchMBByVessel06RSQL">
			<desc><![CDATA[SearchMBByVessel06]]></desc>
			<sql><![CDATA[
SELECT      
			'RDR' val01,														/* dataSource */
	
			--  DECODE(CNTR_SIZE,'2','20','3','2H','4','40','H','4H','L','45') CNTR_SIZE, SUM(M.QTY) QTY,  WGT

			SUM( DECODE(  M.CNTR_TYPE, 'F', DECODE( M.CNTR_SIZE, '2', M.QTY, 0  ), 0 )) val02,    /* 20 */
			SUM( DECODE(  M.CNTR_TYPE, 'F', DECODE( M.CNTR_SIZE, '4', M.QTY, 0  ), 0 )) val03,    /* 40 */      
			SUM( DECODE(  M.CNTR_TYPE, 'F', DECODE( M.CNTR_SIZE, 'H', M.QTY, 0  ), 0 )) val04,    /* HC */
			SUM( DECODE(  M.CNTR_TYPE, 'F', DECODE( M.CNTR_SIZE, 'L', M.QTY, 0  ), 0 )) val05,     /* 45 */

			SUM( DECODE(  M.CNTR_TYPE, 'M', DECODE( M.CNTR_SIZE, '2', M.QTY, 0  ), 0 )) val06,    /* 20 */
			SUM( DECODE(  M.CNTR_TYPE, 'M', DECODE( M.CNTR_SIZE, '4', M.QTY, 0  ), 0 )) val07,    /* 40 */      
			SUM( DECODE(  M.CNTR_TYPE, 'M', DECODE( M.CNTR_SIZE, 'H', M.QTY, 0  ), 0 )) val08,    /* HC */
			SUM( DECODE(  M.CNTR_TYPE, 'M', DECODE( M.CNTR_SIZE, 'L', M.QTY, 0  ), 0 )) val09,     /* 45 */
			NVL(SUM( DECODE( M.CNTR_SIZE, '2', M.WEIGHT, 0  ) ),0) + 
			NVL(SUM( DECODE( M.CNTR_SIZE, '4', M.WEIGHT, 0  ) ),0) + 
			NVL(SUM( DECODE( M.CNTR_SIZE, 'H', M.WEIGHT, 0  ) ),0) + 
			NVL(SUM( DECODE( M.CNTR_SIZE, 'L', M.WEIGHT, 0  ) ),0) weightTotal

	FROM	RDR_HEADER		H, 
			RDR_SUMMARY		M 
	WHERE	H.VSL_CD	= SUBSTR(@[vvd],1,4) --:vsl_cd
	AND		H.VOY_NO	= SUBSTR(@[vvd],5,4) --:voy_no
	AND		H.DIR_CD	= SUBSTR(@[vvd],9,1)    --:dir_cd
	AND		H.PORT_CD	= @[port] --:port      
	AND		H.VSL_CD	= M.VSL_CD
	AND		H.VOY_NO	= M.VOY_NO
	AND		H.DIR_CD	= M.DIR_CD
	AND		H.REGION	= M.REGION
	AND		M.OPR_CD	= @[company] -- :opr_cd
	GROUP BY 1			]]></sql>
			<params>
				<param name="vvd" type="12" value="" out="N"/>
				<param name="port" type="12" value="" out="N"/>
				<param name="company" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
