<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ContainerOnOffhireDBDAOSearchFACntrListRSQL">
			<desc><![CDATA[ERP FA Interface 화면상에서 Type에 따른 Container 정보를 보여준다.]]></desc>
			<sql><![CDATA[
SELECT    ROWNUM AS ROW_SEQ, CNTR_NO, CNTR_TPSZ_CD, LSTM_CD, MFT_DT, ONH_DT, ONH_YD_CD, ONH_FREE_DYS
          , MIN_ONH_DYS, USED_DYS, CNTR_STS_CD, CRNT_YD_CD, CNMV_STS_CD, CNMV_DT
          , AGMT_CTY_CD, AGMT_SEQ, REF_NO           
    FROM  ( 
            SELECT   A.CNTR_NO, A.CNTR_TPSZ_CD, C.LSTM_CD
                   , TO_CHAR(A.MFT_DT,'YYYYMMDD') AS MFT_DT
                   , TO_CHAR(A.ONH_DT,'YYYYMMDD') AS ONH_DT
                   , A.ONH_YD_CD, A.ONH_FREE_DYS, A.MIN_ONH_DYS
                   , CASE WHEN C.LSTM_CD IN('OW','LP','OL')
                          THEN ROUND(TRUNC(SYSDATE) - A.ONH_DT) + 1
                          ELSE ROUND(TRUNC(SYSDATE) - A.ONH_DT) + 1 END USED_DYS
                   , A.CNMV_STS_CD, A.CRNT_YD_CD, A.CNTR_STS_CD, TO_CHAR(A.CNMV_DT,'YYYYMMDD') AS CNMV_DT  
                   , A.AGMT_CTY_CD, A.AGMT_SEQ, C.REF_NO
              FROM  MST_CONTAINER A,
                    LSE_AGREEMENT C            
             WHERE  1=1
               AND  A.AGMT_CTY_CD = C.AGMT_CTY_CD        
               AND  A.AGMT_SEQ    = C.AGMT_SEQ        
               AND  A.AGMT_SEQ <> 999990
            
            -- CASE : OW Master
            #if (${hid_type} == '0')
               AND A.LOT_PLN_YR||'-'||A.LOT_LOC_CD||'-'||A.CNTR_TPSZ_CD||'-'||TRIM(TO_CHAR(A.LOT_SEQ, '000')) IN (
                   #foreach($key IN ${lot_no})
                       #if($velocityCount < $lot_no.size())
                           '$key',
                       #else
                           '$key'
                       #end
                   #end
                   )
            
			-- CASE : Term Change Master
            #elseif (${hid_type} == '1')
               AND A.TERM_CNG_SEQ IN (
                   #foreach($key IN ${term_cng_seq})
                       #if($velocityCount < $term_cng_seq.size())
                           '$key',
                       #else
                           '$key'
                       #end
				   #end
                   ) 

            -- CASE : Own in Specification Inquiry (Active)
            #elseif (${hid_type} == '2')
               AND A.ACIAC_DIV_CD = 'A'
               AND A.LOT_PLN_YR||'-'||A.LOT_LOC_CD||'-'||A.CNTR_TPSZ_CD||'-'||TRIM(TO_CHAR(A.LOT_SEQ, '000')) IN (
                   #foreach($key IN ${lot_no})
                       #if($velocityCount < $lot_no.size())
                           '$key',
                       #else
                           '$key'
                       #end
                   #end
                   )
            -- CASE : Lease in Specification Inquiry (Active)
            #elseif (${hid_type} == '3')
              AND A.ACIAC_DIV_CD = 'A'
              AND A.CNTR_SPEC_NO
                  ||NVL(TRIM(A.AGMT_CTY_CD||TRIM(TO_CHAR(A.AGMT_SEQ, '000000'))), 'X')
                  ||DECODE(A.LSTM_CD, 'SI', 'X', 'MI', 'X', 'SH', 'X', 'OF', 'X', NVL(TRIM(A.LOT_PLN_YR||'-'||A.LOT_LOC_CD||'-'||A.CNTR_TPSZ_CD||'-'||LTRIM(TO_CHAR(A.LOT_SEQ,'000'))), 'X'))
                  ||NVL(TRIM(TO_CHAR(A.MFTR_VNDR_SEQ, '000000')), 'X')
                   IN (
                   #foreach($key IN ${lot_no})
                       #if($velocityCount < $lot_no.size())
                           '$key',
                       #else
                           '$key'
                       #end
                   #end
                   )
            #end

		    ORDER BY CNTR_NO ASC
          )			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
