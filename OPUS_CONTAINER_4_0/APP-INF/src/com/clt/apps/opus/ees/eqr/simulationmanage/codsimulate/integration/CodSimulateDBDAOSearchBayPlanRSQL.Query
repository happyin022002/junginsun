<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CodSimulateDBDAOSearchBayPlanRSQL">
			<desc><![CDATA[OPF_BAY_PLN_LDIS에서 Bay Plan 정보 검색]]></desc>
			<sql><![CDATA[
SELECT	BAY.VSL_CD||BAY.SKD_VOY_NO||BAY.SKD_DIR_CD AS VVD						
        ,BAY.POL_CD AS POL														
        ,BAY.POD_CD AS POD														
        ,COUNT(BAY.CNTR_TPSZ_CD) AS TOTAL										
#foreach( ${key} in ${arrtpszcd}) 
        #if (${key} == 'O2') 
        ,COUNT(DECODE(BAY.CNTR_TPSZ_CD,'O2', CLPT_IND_SEQ))						
			+ COUNT(DECODE(BAY.CNTR_TPSZ_CD,'S2', CLPT_IND_SEQ)) AS TPSZO2				 
        #elseif (${key} == 'O4') 
		,COUNT(DECODE(BAY.CNTR_TPSZ_CD,'O4', CLPT_IND_SEQ))					
			+ COUNT(DECODE(BAY.CNTR_TPSZ_CD,'S4', CLPT_IND_SEQ)) AS TPSZO4			
		#elseif (${key} == 'F2') 
		,COUNT(DECODE(BAY.CNTR_TPSZ_CD,'F2', CLPT_IND_SEQ))						
			+ COUNT(DECODE(BAY.CNTR_TPSZ_CD,'A2', CLPT_IND_SEQ)) AS TPSZF2	
        #elseif (${key} == 'F4')
        ,COUNT(DECODE(BAY.CNTR_TPSZ_CD,'F4', CLPT_IND_SEQ))						
			+ COUNT(DECODE(BAY.CNTR_TPSZ_CD,'A4', CLPT_IND_SEQ))					
			+ COUNT(DECODE(BAY.CNTR_TPSZ_CD,'F5', CLPT_IND_SEQ)) AS TPSZF4 
        #else
        ,COUNT(DECODE(BAY.CNTR_TPSZ_CD,'$key', CLPT_IND_SEQ)) AS TPSZ${key}	
        #end
#end
FROM	OPF_BAY_PLN_LDIS BAY, MST_CONTAINER CNTR								
 	WHERE	BAY.CNTR_REF_NO = CNTR.CNTR_NO												
	AND	BAY.VSL_CD				= @[vsl_cd]								
    AND	BAY.SKD_VOY_NO			= @[skd_voy_no]								
    AND	BAY.SKD_DIR_CD			= @[skd_dir_cd]								
    AND	BAY.VPS_PORT_CD			= @[search_port]			
    AND	BAY.FULL_MTY_CD         = 'E'						
   -- AND	BAY.LODG_DCHG_IND_CD    in ('C','L')
    AND   BAY.LODG_DCHG_IND_CD = 'C'
    AND	CNTR.LSTM_CD	        <> 'SH'					
    GROUP BY BAY.VSL_CD||BAY.SKD_VOY_NO||BAY.SKD_DIR_CD, BAY.POL_CD, BAY.POD_CD		
    ORDER BY 1,2,3			]]></sql>
			<params>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="search_port" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
