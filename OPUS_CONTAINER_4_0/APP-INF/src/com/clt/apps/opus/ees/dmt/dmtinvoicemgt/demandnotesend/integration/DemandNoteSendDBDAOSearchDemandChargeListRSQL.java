/*=========================================================
*Copyright(c) 2010 CyberLogitec
*@FileName : DemandNoteSendDBDAOSearchDemandChargeListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2010.04.21
*@LastModifier : 최성환
*@LastVersion : 1.0
* 2010.04.21 최성환
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.ees.dmt.dmtinvoicemgt.demandnotesend.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;

import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author Choi Sung Hwan
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class DemandNoteSendDBDAOSearchDemandChargeListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * SearchDemandChargeList
	  * </pre>
	  */
	public DemandNoteSendDBDAOSearchDemandChargeListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("port_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cre_ofc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fx_ft_ovr_dys",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("loc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("cust_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sc_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fm_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("dmdt_trf_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("svc_provdr",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rfa_no",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.ees.dmt.dmtinvoicemgt.demandnotesend.integration").append("\n"); 
		query.append("FileName : DemandNoteSendDBDAOSearchDemandChargeListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if (${grp_type} == '2')" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("BKG_NO" ).append("\n"); 
		query.append(",BL_NO" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",CNTR_NO" ).append("\n"); 
		query.append(",DMDT_CHG_STS_CD" ).append("\n"); 
		query.append(",OFC_CD" ).append("\n"); 
		query.append(",FM_MVMT_YD_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",DMDT_TRF_CD" ).append("\n"); 
		query.append(",DECODE(" ).append("\n"); 
		query.append("(CASE WHEN LENGTH(PAYER_CD) = 8 THEN" ).append("\n"); 
		query.append("CASE WHEN SUBSTR(PAYER_CD, 1, 2) = '00'" ).append("\n"); 
		query.append("THEN SUBSTR(PAYER_CD, 3) ELSE PAYER_CD END" ).append("\n"); 
		query.append("ELSE PAYER_CD END) , '000000',''," ).append("\n"); 
		query.append("(CASE WHEN LENGTH(PAYER_CD) = 8 THEN" ).append("\n"); 
		query.append("CASE WHEN SUBSTR(PAYER_CD, 1, 2) = '00'" ).append("\n"); 
		query.append("THEN SUBSTR(PAYER_CD, 3) ELSE PAYER_CD END" ).append("\n"); 
		query.append("ELSE PAYER_CD END)" ).append("\n"); 
		query.append(") AS PAYER_CD" ).append("\n"); 
		query.append(",PAYER_NM" ).append("\n"); 
		query.append(",SHIPPER_CD" ).append("\n"); 
		query.append(",SHIPPER_NM" ).append("\n"); 
		query.append(",CNEE_CD" ).append("\n"); 
		query.append(",CNEE_NM" ).append("\n"); 
		query.append(",NTFY_CD" ).append("\n"); 
		query.append(",NTFY_NM" ).append("\n"); 
		query.append(",AR_ACT_CD" ).append("\n"); 
		query.append(",AR_ACT_NM" ).append("\n"); 
		query.append(",SVC_PROVDR_CD" ).append("\n"); 
		query.append(",SVC_PROVDR_NM" ).append("\n"); 
		query.append(",SC_NO" ).append("\n"); 
		query.append(",RFA_NO" ).append("\n"); 
		query.append(",INV_CURR_CD" ).append("\n"); 
		query.append(",BIL_AMT AS INV_CHG_AMT" ).append("\n"); 
		query.append(",ORG_CHG_AMT AS INV_ORG_AMT  ##RD용" ).append("\n"); 
		query.append(",DC_AMT AS INV_DC_AMT ##RD용" ).append("\n"); 
		query.append(",ORG_CURR_CD" ).append("\n"); 
		query.append(",ORG_CHG_AMT" ).append("\n"); 
		query.append(",EXPT_AMT" ).append("\n"); 
		query.append(",DC_AMT" ).append("\n"); 
		query.append(",BIL_AMT" ).append("\n"); 
		query.append(",AR_XCH_RT AS INV_XCH_RT" ).append("\n"); 
		query.append(",SVR_ID" ).append("\n"); 
		query.append(",CNTR_CYC_NO" ).append("\n"); 
		query.append(",DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append(",CHG_SEQ" ).append("\n"); 
		query.append(",DMDT_INV_NO" ).append("\n"); 
		query.append(",VSL_CD" ).append("\n"); 
		query.append(",SKD_VOY_NO" ).append("\n"); 
		query.append(",SKD_DIR_CD" ).append("\n"); 
		query.append(",POL_CD" ).append("\n"); 
		query.append(",POD_CD" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT B.BKG_NO" ).append("\n"); 
		query.append(",B.BL_NO" ).append("\n"); 
		query.append(",'' AS CNTR_QTY" ).append("\n"); 
		query.append(",C.CNTR_NO" ).append("\n"); 
		query.append(",C.DMDT_CHG_STS_CD" ).append("\n"); 
		query.append(",C.OFC_CD" ).append("\n"); 
		query.append(",C.FM_MVMT_YD_CD" ).append("\n"); 
		query.append(",DECODE (SUBSTR (C.DMDT_TRF_CD" ).append("\n"); 
		query.append(",3" ).append("\n"); 
		query.append(",1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(",'O', B.POR_CD" ).append("\n"); 
		query.append(",B.DEL_CD" ).append("\n"); 
		query.append(") AS PORT" ).append("\n"); 
		query.append(",C.DMDT_TRF_CD" ).append("\n"); 
		query.append(",DECODE (C.ACT_CNT_CD,'00', '',C.ACT_CNT_CD)" ).append("\n"); 
		query.append("|| TO_CHAR (C.ACT_CUST_SEQ, 'FM000000') AS PAYER_CD" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN C.DMDT_TRF_CD = 'DTIC'" ).append("\n"); 
		query.append("##AND B.BKG_DE_TERM_CD = 'Y'" ).append("\n"); 
		query.append("AND INSTR (NVL (B.POD_CD, '  '), 'US') = 1" ).append("\n"); 
		query.append("THEN (SELECT MV.VNDR_LGL_ENG_NM" ).append("\n"); 
		query.append("FROM MDM_VENDOR MV" ).append("\n"); 
		query.append("WHERE MV.VNDR_SEQ = C.VNDR_SEQ)" ).append("\n"); 
		query.append("WHEN C.DMDT_TRF_CD = 'DTOC'" ).append("\n"); 
		query.append("##AND B.BKG_RCV_TERM_CD = 'Y'" ).append("\n"); 
		query.append("AND INSTR (NVL (B.POL_CD, '  '), 'US') = 1" ).append("\n"); 
		query.append("THEN (SELECT MV.VNDR_LGL_ENG_NM" ).append("\n"); 
		query.append("FROM MDM_VENDOR MV" ).append("\n"); 
		query.append("WHERE MV.VNDR_SEQ = C.VNDR_SEQ)" ).append("\n"); 
		query.append("WHEN C.DMDT_TRF_CD IN ('DMIF', 'CTIC')" ).append("\n"); 
		query.append("OR (    C.DMDT_TRF_CD = 'DTIC'" ).append("\n"); 
		query.append("AND INSTR (NVL (B.POD_CD, '  '), 'US') <> 1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("THEN (SELECT MC.CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("FROM MDM_CUSTOMER MC" ).append("\n"); 
		query.append("WHERE MC.CUST_CNT_CD = C.ACT_CNT_CD" ).append("\n"); 
		query.append("AND MC.CUST_SEQ = C.ACT_CUST_SEQ)" ).append("\n"); 
		query.append("WHEN C.DMDT_TRF_CD IN ('DMOF', 'CTOC')" ).append("\n"); 
		query.append("OR (    C.DMDT_TRF_CD = 'DTOC'" ).append("\n"); 
		query.append("AND INSTR (NVL (B.POL_CD, '  '), 'US') <> 1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("THEN REPLACE (BS.CUST_NM" ).append("\n"); 
		query.append(", CHR (13)" ).append("\n"); 
		query.append("|| CHR (10)" ).append("\n"); 
		query.append(",' '" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("END AS PAYER_NM" ).append("\n"); 
		query.append(", BS.CUST_CNT_CD" ).append("\n"); 
		query.append("|| TRIM (TO_CHAR (BS.CUST_SEQ, '000000')) SHIPPER_CD" ).append("\n"); 
		query.append(",REPLACE (BS.CUST_NM" ).append("\n"); 
		query.append(", CHR (13)" ).append("\n"); 
		query.append("|| CHR (10)" ).append("\n"); 
		query.append(",' '" ).append("\n"); 
		query.append(") SHIPPER_NM" ).append("\n"); 
		query.append(",DECODE (BC.CUST_CNT_CD" ).append("\n"); 
		query.append("|| TRIM (TO_CHAR (BC.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append(",'000000', NULL" ).append("\n"); 
		query.append(", BC.CUST_CNT_CD" ).append("\n"); 
		query.append("|| TRIM (TO_CHAR (BC.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append(") CNEE_CD" ).append("\n"); 
		query.append(",REPLACE (BC.CUST_NM" ).append("\n"); 
		query.append(", CHR (13)" ).append("\n"); 
		query.append("|| CHR (10)" ).append("\n"); 
		query.append(",' '" ).append("\n"); 
		query.append(") CNEE_NM" ).append("\n"); 
		query.append(",DECODE (BN.CUST_CNT_CD" ).append("\n"); 
		query.append("|| TRIM (TO_CHAR (BN.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append(",'000000', NULL" ).append("\n"); 
		query.append(", BN.CUST_CNT_CD" ).append("\n"); 
		query.append("|| TRIM (TO_CHAR (BN.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append(") NTFY_CD" ).append("\n"); 
		query.append(",NVL (RTRIM (REPLACE (REPLACE (BN.CUST_NM" ).append("\n"); 
		query.append(",'\"'" ).append("\n"); 
		query.append(",''" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", CHR (13)" ).append("\n"); 
		query.append("|| CHR (10)" ).append("\n"); 
		query.append(",' '" ).append("\n"); 
		query.append("))" ).append("\n"); 
		query.append(",'-') NTFY_NM" ).append("\n"); 
		query.append(", (SELECT I.ACT_CUST_CNT_CD" ).append("\n"); 
		query.append("|| TRIM (TO_CHAR (ACT_CUST_SEQ, '000000'))" ).append("\n"); 
		query.append("FROM INV_AR_MN I" ).append("\n"); 
		query.append("WHERE I.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("AND I.IO_BND_CD = SUBSTR (C.DMDT_TRF_CD" ).append("\n"); 
		query.append(",3" ).append("\n"); 
		query.append(",1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND AR_IF_NO =" ).append("\n"); 
		query.append("(SELECT MAX (AR_IF_NO)" ).append("\n"); 
		query.append("FROM INV_AR_MN" ).append("\n"); 
		query.append("WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("AND IO_BND_CD = SUBSTR (C.DMDT_TRF_CD" ).append("\n"); 
		query.append(",3" ).append("\n"); 
		query.append(",1" ).append("\n"); 
		query.append("))" ).append("\n"); 
		query.append("AND ROWNUM = 1) AS AR_ACT_CD" ).append("\n"); 
		query.append(", (SELECT MC.CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("FROM MDM_CUSTOMER MC" ).append("\n"); 
		query.append(",INV_AR_MN I" ).append("\n"); 
		query.append("WHERE MC.CUST_CNT_CD = I.ACT_CUST_CNT_CD" ).append("\n"); 
		query.append("AND MC.CUST_SEQ = I.ACT_CUST_SEQ" ).append("\n"); 
		query.append("AND I.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("AND I.IO_BND_CD = SUBSTR (C.DMDT_TRF_CD" ).append("\n"); 
		query.append(",3" ).append("\n"); 
		query.append(",1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND AR_IF_NO =" ).append("\n"); 
		query.append("(SELECT MAX (AR_IF_NO)" ).append("\n"); 
		query.append("FROM INV_AR_MN" ).append("\n"); 
		query.append("WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("AND IO_BND_CD = SUBSTR (C.DMDT_TRF_CD" ).append("\n"); 
		query.append(",3" ).append("\n"); 
		query.append(",1" ).append("\n"); 
		query.append("))" ).append("\n"); 
		query.append("AND ROWNUM = 1) AS AR_ACT_NM" ).append("\n"); 
		query.append(",DECODE (TRIM (TO_CHAR (C.VNDR_SEQ, '000000'))" ).append("\n"); 
		query.append(",'000000', NULL" ).append("\n"); 
		query.append(",TRIM (TO_CHAR (C.VNDR_SEQ, '000000'))" ).append("\n"); 
		query.append(") AS SVC_PROVDR_CD" ).append("\n"); 
		query.append(", (SELECT MV.VNDR_LGL_ENG_NM" ).append("\n"); 
		query.append("FROM MDM_VENDOR MV" ).append("\n"); 
		query.append("WHERE MV.VNDR_SEQ = C.VNDR_SEQ) AS SVC_PROVDR_NM" ).append("\n"); 
		query.append(",B.SC_NO" ).append("\n"); 
		query.append(",B.RFA_NO" ).append("\n"); 
		query.append(",CASE WHEN (SELECT AR_OFC_CD FROM MDM_ORGANIZATION WHERE OFC_CD = @[ofc_cd]) IN ('SGNBB', 'SAOBB', 'MTRBS', 'TORBB', 'VANBS', 'MEXBA') THEN 'USD'" ).append("\n"); 
		query.append("ELSE (SELECT AR_CURR_CD FROM MDM_ORGANIZATION WHERE OFC_CD = @[ofc_cd])" ).append("\n"); 
		query.append("END AS INV_CURR_CD" ).append("\n"); 
		query.append(",C.BZC_TRF_CURR_CD AS ORG_CURR_CD" ).append("\n"); 
		query.append(",C.ORG_CHG_AMT AS ORG_CHG_AMT" ).append("\n"); 
		query.append(",C.SC_RFA_EXPT_AMT AS EXPT_AMT" ).append("\n"); 
		query.append(",C.AFT_EXPT_DC_AMT AS DC_AMT" ).append("\n"); 
		query.append(",C.BIL_AMT" ).append("\n"); 
		query.append(",C.SYS_AREA_GRP_ID AS SVR_ID" ).append("\n"); 
		query.append(",C.CNTR_CYC_NO" ).append("\n"); 
		query.append(",C.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append(",C.CHG_SEQ" ).append("\n"); 
		query.append(",CASE WHEN (SELECT AR_OFC_CD FROM MDM_ORGANIZATION WHERE OFC_CD = @[ofc_cd]) IN ('SGNBB', 'SAOBB', 'MTRBS', 'TORBB', 'VANBS', 'MEXBA') THEN 'USD'" ).append("\n"); 
		query.append("ELSE (SELECT AR_CURR_CD FROM MDM_ORGANIZATION WHERE OFC_CD = @[ofc_cd])" ).append("\n"); 
		query.append("END  AS AR_CURR_CD" ).append("\n"); 
		query.append(",1 AS AR_XCH_RT" ).append("\n"); 
		query.append(",C.BZC_TRF_CURR_CD" ).append("\n"); 
		query.append(",C.DMDT_INV_NO" ).append("\n"); 
		query.append(",B.VSL_CD" ).append("\n"); 
		query.append(",B.SKD_VOY_NO" ).append("\n"); 
		query.append(",B.SKD_DIR_CD" ).append("\n"); 
		query.append(",B.POL_CD" ).append("\n"); 
		query.append(",B.POD_CD" ).append("\n"); 
		query.append("FROM DMT_CHG_BKG_CNTR B" ).append("\n"); 
		query.append(",DMT_CHG_CALC C" ).append("\n"); 
		query.append(",BKG_CUSTOMER BS" ).append("\n"); 
		query.append(",BKG_CUSTOMER BC" ).append("\n"); 
		query.append(",BKG_CUSTOMER BN" ).append("\n"); 
		query.append("WHERE B.SYS_AREA_GRP_ID = C.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("AND B.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("AND B.CNTR_CYC_NO = C.CNTR_CYC_NO" ).append("\n"); 
		query.append("AND B.BKG_NO   = BS.BKG_NO(+)" ).append("\n"); 
		query.append("AND BS.BKG_CUST_TP_CD(+) = 'S'" ).append("\n"); 
		query.append("AND B.BKG_NO   = BC.BKG_NO (+)" ).append("\n"); 
		query.append("AND BC.BKG_CUST_TP_CD(+) = 'C'" ).append("\n"); 
		query.append("AND B.BKG_NO   = BN.BKG_NO(+)" ).append("\n"); 
		query.append("AND BN.BKG_CUST_TP_CD(+) = 'N'" ).append("\n"); 
		query.append("AND C.DMDT_CHG_LOC_DIV_CD IN ('POD','POL','POR','DEL', 'TSP')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##    -- 메인 조회 : Office" ).append("\n"); 
		query.append("#if (${ofc_cd} != '')" ).append("\n"); 
		query.append("AND C.OFC_CD            =   @[ofc_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  -- 메인 조회 : Tariff type" ).append("\n"); 
		query.append("AND    C.DMDT_TRF_CD        =	@[dmdt_trf_cd]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  -- 메인 조회 : Status + OVERDAY : F/T OVER DAY OR STAYING DAY(단, DMDT_CHG_STS_CD가 U일 경우는 over day 적용 제외)" ).append("\n"); 
		query.append("#if (${dmdt_chg_sts_cd} != '')" ).append("\n"); 
		query.append("AND ( 1=0" ).append("\n"); 
		query.append("#foreach( $chg_sts_cd in ${chg_sts_cd_list} )" ).append("\n"); 
		query.append("#if (${cond_type} != 'date')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ($chg_sts_cd != 'U')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = '$chg_sts_cd'" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = '$chg_sts_cd'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND (" ).append("\n"); 
		query.append("( C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'RRRRMMDD'),'YYYYMMDDHH24MISS') - TO_DATE (TO_CHAR (C.FT_END_DT, 'RRRRMMDD'), 'YYYYMMDDHH24MISS') >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("( C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'RRRRMMDD'),'YYYYMMDDHH24MISS') - TO_DATE (TO_CHAR (C.FT_END_DT, 'RRRRMMDD'), 'YYYYMMDDHH24MISS') >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if ($chg_sts_cd == 'F')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = 'F'" ).append("\n"); 
		query.append("AND C.TO_MVMT_DT BETWEEN TO_DATE(@[fm_dt], 'yyyymmdd')" ).append("\n"); 
		query.append("AND TO_DATE(@[to_dt], 'yyyymmdd') + 0.99999" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif ($chg_sts_cd == 'L')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = 'L'" ).append("\n"); 
		query.append("AND C.FM_MVMT_DT BETWEEN TO_DATE(@[fm_dt], 'yyyymmdd')" ).append("\n"); 
		query.append("AND TO_DATE(@[to_dt], 'yyyymmdd') + 0.99999" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif ($chg_sts_cd == 'U')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = 'U'" ).append("\n"); 
		query.append("AND C.FM_MVMT_DT BETWEEN TO_DATE(@[fm_dt], 'yyyymmdd')" ).append("\n"); 
		query.append("AND TO_DATE(@[to_dt], 'yyyymmdd') + 0.99999" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND (" ).append("\n"); 
		query.append("( C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'RRRRMMDD'),'YYYYMMDDHH24MISS') - TO_DATE (TO_CHAR (C.FT_END_DT, 'RRRRMMDD'), 'YYYYMMDDHH24MISS') >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("( C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'RRRRMMDD'),'YYYYMMDDHH24MISS') - TO_DATE (TO_CHAR (C.FT_END_DT, 'RRRRMMDD'), 'YYYYMMDDHH24MISS') >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif ($chg_sts_cd == 'C')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = 'C'" ).append("\n"); 
		query.append("AND C.TO_MVMT_DT BETWEEN TO_DATE(@[fm_dt], 'yyyymmdd')" ).append("\n"); 
		query.append("AND TO_DATE(@[to_dt], 'yyyymmdd') + 0.99999" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif ($chg_sts_cd == 'I')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = 'I'" ).append("\n"); 
		query.append("AND C.TO_MVMT_DT BETWEEN TO_DATE(@[fm_dt], 'yyyymmdd')" ).append("\n"); 
		query.append("AND TO_DATE(@[to_dt], 'yyyymmdd') + 0.99999" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif ($chg_sts_cd == 'R')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = 'L'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  -- 메인 조회 : G/B CHARGE_TYPE" ).append("\n"); 
		query.append("#if (${chg_type} == 'G')" ).append("\n"); 
		query.append("AND C.CHG_SEQ = 1" ).append("\n"); 
		query.append("#elseif (${chg_type} == 'B')" ).append("\n"); 
		query.append("AND C.CHG_SEQ > 1" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 1: DATE 일 경우" ).append("\n"); 
		query.append("#if (${cond_type} == 'date')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${loc_cd} != '')" ).append("\n"); 
		query.append("#if (${loc_type} == '1')" ).append("\n"); 
		query.append("AND (( LENGTH(@[loc_cd]) = 5 AND C.FM_MVMT_YD_CD LIKE  @[loc_cd] || '%' )" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("( LENGTH(@[loc_cd]) = 7 AND C.FM_MVMT_YD_CD =  @[loc_cd] ))" ).append("\n"); 
		query.append("#elseif (${loc_type} == '2')" ).append("\n"); 
		query.append("AND DECODE(SUBSTR(@[dmdt_trf_cd], 3, 1),'O', B.POR_CD, B.DEL_CD) = SUBSTR(@[loc_cd], 1, 5)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("##else" ).append("\n"); 
		query.append("##	AND C.DMDT_CHG_STS_CD NOT IN ('D','N','U','I','C')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 2: VVD CD 일 경우" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${cond_type} == 'vvd_cd')" ).append("\n"); 
		query.append("#if (${vvd_cd} != '')" ).append("\n"); 
		query.append("AND (	B.VSL_CD = SUBSTR(@[vvd_cd],1,4)" ).append("\n"); 
		query.append("AND B.SKD_VOY_NO = SUBSTR(@[vvd_cd],5,4)" ).append("\n"); 
		query.append("AND B.SKD_DIR_CD = SUBSTR(@[vvd_cd],9)" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${port_cd} != '')" ).append("\n"); 
		query.append("AND	DECODE(SUBSTR(@[dmdt_trf_cd], 3, 1),'O', B.POL_CD, B.POD_CD) = @[port_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 3: CNTR 종류를 선택 했을 경우" ).append("\n"); 
		query.append("#if (${cond_type} == 'cntr')" ).append("\n"); 
		query.append("#if (${bkg_no} != '')" ).append("\n"); 
		query.append("AND B.BKG_NO IN (" ).append("\n"); 
		query.append("#foreach( $bkg_cd in ${bkg_no_list} )" ).append("\n"); 
		query.append("#if($velocityCount < $bkg_no_list.size()) '$bkg_cd', #else '$bkg_cd' #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${bl_no} != '')" ).append("\n"); 
		query.append("AND B.BL_NO IN (" ).append("\n"); 
		query.append("#foreach( $bl_cd in ${bl_no_list} )" ).append("\n"); 
		query.append("#if($velocityCount < $bl_no_list.size()) '$bl_cd', #else '$bl_cd' #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${cntr_no} != '')" ).append("\n"); 
		query.append("AND C.CNTR_NO IN (" ).append("\n"); 
		query.append("#foreach( $cntr_cd in ${cntr_no_list} )" ).append("\n"); 
		query.append("#if($velocityCount < $cntr_no_list.size()) '$cntr_cd', #else '$cntr_cd' #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 : CUSTOMER 종류" ).append("\n"); 
		query.append("#if (${cust_cd} != '')" ).append("\n"); 
		query.append("#if (${cust_type} == '')" ).append("\n"); 
		query.append("AND (" ).append("\n"); 
		query.append("#if (${cust_len} == '8')" ).append("\n"); 
		query.append("C.ACT_CNT_CD	= SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND C.ACT_CUST_SEQ	= LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("C.ACT_CUST_SEQ = LTRIM(SUBSTR(@[cust_cd],1,6),'0')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("OR		BS.CUST_CNT_CD	= SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND BS.CUST_SEQ		= LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("OR		BC.CUST_CNT_CD	= SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND BC.CUST_SEQ		= LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("OR 		BN.CUST_CNT_CD	= SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND BN.CUST_SEQ		= LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("OR(" ).append("\n"); 
		query.append("EXISTS (" ).append("\n"); 
		query.append("SELECT  'X'" ).append("\n"); 
		query.append("FROM    INV_AR_MN I" ).append("\n"); 
		query.append("WHERE   I.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("AND     I.IO_BND_CD = 'I'" ).append("\n"); 
		query.append("AND     ROWNUM  = 1" ).append("\n"); 
		query.append("AND     I.ACT_CUST_CNT_CD   = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND     I.ACT_CUST_SEQ      = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif (${cust_type} == 'P')" ).append("\n"); 
		query.append("#if (${cust_len} == '8')" ).append("\n"); 
		query.append("AND	C.ACT_CNT_CD	= SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND C.ACT_CUST_SEQ	= LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND	C.ACT_CUST_SEQ = LTRIM(SUBSTR(@[cust_cd],1,6),'0')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${cust_type} == 'S')" ).append("\n"); 
		query.append("AND BS.CUST_CNT_CD = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND BS.CUST_SEQ = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("#elseif (${cust_type} == 'C')" ).append("\n"); 
		query.append("AND BC.CUST_CNT_CD = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND BC.CUST_SEQ = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("#elseif (${cust_type} == 'N')" ).append("\n"); 
		query.append("AND BN.CUST_CNT_CD = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND BN.CUST_SEQ  = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("#elseif (${cust_type} == 'A')" ).append("\n"); 
		query.append("AND EXISTS (" ).append("\n"); 
		query.append("SELECT  'X'" ).append("\n"); 
		query.append("FROM    INV_AR_MN I" ).append("\n"); 
		query.append("WHERE   I.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("AND     I.IO_BND_CD = 'I'" ).append("\n"); 
		query.append("AND     ROWNUM  = 1" ).append("\n"); 
		query.append("AND     I.ACT_CUST_CNT_CD   = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND     I.ACT_CUST_SEQ      = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 : Service Provider 종류" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${svc_provdr} != '')" ).append("\n"); 
		query.append("AND C.VNDR_SEQ = LTRIM(@[svc_provdr],'0')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 : S/C No" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${sc_no} != '')" ).append("\n"); 
		query.append("AND B.SC_NO = @[sc_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 : RFA No" ).append("\n"); 
		query.append("#if (${rfa_no} != '')" ).append("\n"); 
		query.append("AND B.RFA_NO = @[rfa_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(") X" ).append("\n"); 
		query.append("ORDER BY X.BKG_NO, X.CNTR_NO" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif (${grp_type} == '1')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT BKG_NO" ).append("\n"); 
		query.append(",BL_NO" ).append("\n"); 
		query.append(",CNTR_QTY" ).append("\n"); 
		query.append(",DMDT_CHG_STS_CD" ).append("\n"); 
		query.append(",OFC_CD" ).append("\n"); 
		query.append(",FM_MVMT_YD_CD" ).append("\n"); 
		query.append(",PORT" ).append("\n"); 
		query.append(",DMDT_TRF_CD" ).append("\n"); 
		query.append(",DECODE(" ).append("\n"); 
		query.append("(CASE WHEN LENGTH(PAYER_CD) = 8 THEN" ).append("\n"); 
		query.append("CASE WHEN SUBSTR(PAYER_CD, 1, 2) = '00'" ).append("\n"); 
		query.append("THEN SUBSTR(PAYER_CD, 3) ELSE PAYER_CD END" ).append("\n"); 
		query.append("ELSE PAYER_CD END) , '000000',''," ).append("\n"); 
		query.append("(CASE WHEN LENGTH(PAYER_CD) = 8 THEN" ).append("\n"); 
		query.append("CASE WHEN SUBSTR(PAYER_CD, 1, 2) = '00'" ).append("\n"); 
		query.append("THEN SUBSTR(PAYER_CD, 3) ELSE PAYER_CD END" ).append("\n"); 
		query.append("ELSE PAYER_CD END)" ).append("\n"); 
		query.append(") AS PAYER_CD" ).append("\n"); 
		query.append(",PAYER_NM" ).append("\n"); 
		query.append(",SHIPPER_CD" ).append("\n"); 
		query.append(",SHIPPER_NM" ).append("\n"); 
		query.append(",CNEE_CD" ).append("\n"); 
		query.append(",CNEE_NM" ).append("\n"); 
		query.append(",NTFY_CD" ).append("\n"); 
		query.append(",NTFY_NM" ).append("\n"); 
		query.append(",AR_ACT_CD" ).append("\n"); 
		query.append(",AR_ACT_NM" ).append("\n"); 
		query.append(",SVC_PROVDR_CD" ).append("\n"); 
		query.append(",SVC_PROVDR_NM" ).append("\n"); 
		query.append(",SC_NO" ).append("\n"); 
		query.append(",RFA_NO" ).append("\n"); 
		query.append(",INV_CURR_CD" ).append("\n"); 
		query.append(",INV_CHG_AMT" ).append("\n"); 
		query.append(",ORG_CHG_AMT AS INV_ORG_AMT  ##RD용" ).append("\n"); 
		query.append(",DC_AMT AS INV_DC_AMT ##RD용" ).append("\n"); 
		query.append(",ORG_CURR_CD" ).append("\n"); 
		query.append(",ORG_CHG_AMT" ).append("\n"); 
		query.append(",EXPT_AMT" ).append("\n"); 
		query.append(",DC_AMT" ).append("\n"); 
		query.append(",BIL_AMT" ).append("\n"); 
		query.append(",AR_XCH_RT AS INV_XCH_RT" ).append("\n"); 
		query.append(",SVR_ID" ).append("\n"); 
		query.append(",CNTR_CYC_NO" ).append("\n"); 
		query.append(",DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append(",CHG_SEQ" ).append("\n"); 
		query.append(",DMDT_INV_NO" ).append("\n"); 
		query.append(", VSL_CD" ).append("\n"); 
		query.append(", SKD_VOY_NO" ).append("\n"); 
		query.append(", SKD_DIR_CD" ).append("\n"); 
		query.append(", POL_CD" ).append("\n"); 
		query.append(", POD_CD" ).append("\n"); 
		query.append("FROM (SELECT" ).append("\n"); 
		query.append("X.BKG_NO" ).append("\n"); 
		query.append(", X.BL_NO" ).append("\n"); 
		query.append(", COUNT(X.CNTR_NO) OVER (PARTITION by X.BKG_NO, X.OFC_CD, X.FM_MVMT_YD_CD) AS CNTR_QTY" ).append("\n"); 
		query.append(", X.DMDT_CHG_STS_CD" ).append("\n"); 
		query.append(", X.OFC_CD" ).append("\n"); 
		query.append(", X.FM_MVMT_YD_CD" ).append("\n"); 
		query.append(", X.PORT" ).append("\n"); 
		query.append(", X.DMDT_TRF_CD" ).append("\n"); 
		query.append(", X.PAYER_CD" ).append("\n"); 
		query.append(", X.PAYER_NM" ).append("\n"); 
		query.append(", X.SHIPPER_CD" ).append("\n"); 
		query.append(", X.SHIPPER_NM" ).append("\n"); 
		query.append(", X.CNEE_CD" ).append("\n"); 
		query.append(", X.CNEE_NM" ).append("\n"); 
		query.append(", X.NTFY_CD" ).append("\n"); 
		query.append(", X.NTFY_NM" ).append("\n"); 
		query.append(", X.AR_ACT_CD" ).append("\n"); 
		query.append(", X.AR_ACT_NM" ).append("\n"); 
		query.append(", X.SVC_PROVDR_CD" ).append("\n"); 
		query.append(", X.SVC_PROVDR_NM" ).append("\n"); 
		query.append(", X.SC_NO" ).append("\n"); 
		query.append(", X.RFA_NO" ).append("\n"); 
		query.append(", X.INV_CURR_CD" ).append("\n"); 
		query.append(", SUM(X.BIL_AMT) OVER (PARTITION by X.BKG_NO, X.OFC_CD, X.FM_MVMT_YD_CD ORDER BY X.BKG_NO ASC) AS INV_CHG_AMT" ).append("\n"); 
		query.append(", X.ORG_CURR_CD" ).append("\n"); 
		query.append(", SUM(X.ORG_CHG_AMT) OVER (PARTITION by X.BKG_NO, X.OFC_CD, X.FM_MVMT_YD_CD ORDER BY X.BKG_NO ASC) AS ORG_CHG_AMT" ).append("\n"); 
		query.append(", SUM(X.EXPT_AMT) OVER (PARTITION by X.BKG_NO, X.OFC_CD, X.FM_MVMT_YD_CD ORDER BY X.BKG_NO ASC) AS EXPT_AMT" ).append("\n"); 
		query.append(", SUM(X.DC_AMT) OVER (PARTITION by X.BKG_NO, X.OFC_CD, X.FM_MVMT_YD_CD ORDER BY X.BKG_NO ASC) AS DC_AMT" ).append("\n"); 
		query.append(", SUM(X.BIL_AMT) OVER (PARTITION by X.BKG_NO, X.OFC_CD, X.FM_MVMT_YD_CD ORDER BY X.BKG_NO ASC) AS BIL_AMT" ).append("\n"); 
		query.append(", X.SVR_ID" ).append("\n"); 
		query.append(", X.CNTR_CYC_NO" ).append("\n"); 
		query.append(", X.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append(", X.CHG_SEQ" ).append("\n"); 
		query.append(", AR_CURR_CD" ).append("\n"); 
		query.append(", AR_XCH_RT" ).append("\n"); 
		query.append(", ROW_NUMBER () OVER (PARTITION BY X.BKG_NO, X.OFC_CD, X.FM_MVMT_YD_CD ORDER BY X.BKG_NO ASC) AS RNUM" ).append("\n"); 
		query.append(", DMDT_INV_NO" ).append("\n"); 
		query.append(", VSL_CD" ).append("\n"); 
		query.append(", SKD_VOY_NO" ).append("\n"); 
		query.append(", SKD_DIR_CD" ).append("\n"); 
		query.append(", POL_CD" ).append("\n"); 
		query.append(", POD_CD" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT B.BKG_NO" ).append("\n"); 
		query.append(",B.BL_NO" ).append("\n"); 
		query.append(",'' AS CNTR_QTY" ).append("\n"); 
		query.append(",C.CNTR_NO" ).append("\n"); 
		query.append(",C.DMDT_CHG_STS_CD" ).append("\n"); 
		query.append(",C.OFC_CD" ).append("\n"); 
		query.append(",C.FM_MVMT_YD_CD" ).append("\n"); 
		query.append(",DECODE (SUBSTR (C.DMDT_TRF_CD" ).append("\n"); 
		query.append(",3" ).append("\n"); 
		query.append(",1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(",'O', B.POR_CD" ).append("\n"); 
		query.append(",B.DEL_CD" ).append("\n"); 
		query.append(") AS PORT" ).append("\n"); 
		query.append(",C.DMDT_TRF_CD" ).append("\n"); 
		query.append(",DECODE (C.ACT_CNT_CD,'00', '',C.ACT_CNT_CD)" ).append("\n"); 
		query.append("|| TO_CHAR (C.ACT_CUST_SEQ, 'FM000000') AS PAYER_CD" ).append("\n"); 
		query.append(",CASE" ).append("\n"); 
		query.append("WHEN C.DMDT_TRF_CD = 'DTIC'" ).append("\n"); 
		query.append("AND INSTR (NVL (B.POD_CD, '  '), 'US') = 1" ).append("\n"); 
		query.append("THEN (SELECT MV.VNDR_LGL_ENG_NM" ).append("\n"); 
		query.append("FROM MDM_VENDOR MV" ).append("\n"); 
		query.append("WHERE MV.VNDR_SEQ = C.VNDR_SEQ)" ).append("\n"); 
		query.append("WHEN C.DMDT_TRF_CD = 'DTOC'" ).append("\n"); 
		query.append("AND INSTR (NVL (B.POL_CD, '  '), 'US') = 1" ).append("\n"); 
		query.append("THEN (SELECT MV.VNDR_LGL_ENG_NM" ).append("\n"); 
		query.append("FROM MDM_VENDOR MV" ).append("\n"); 
		query.append("WHERE MV.VNDR_SEQ = C.VNDR_SEQ)" ).append("\n"); 
		query.append("WHEN C.DMDT_TRF_CD IN ('DMIF', 'CTIC')" ).append("\n"); 
		query.append("OR (    C.DMDT_TRF_CD = 'DTIC'" ).append("\n"); 
		query.append("AND INSTR (NVL (B.POD_CD, '  '), 'US') <> 1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("THEN (SELECT MC.CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("FROM MDM_CUSTOMER MC" ).append("\n"); 
		query.append("WHERE MC.CUST_CNT_CD = C.ACT_CNT_CD" ).append("\n"); 
		query.append("AND MC.CUST_SEQ = C.ACT_CUST_SEQ)" ).append("\n"); 
		query.append("WHEN C.DMDT_TRF_CD IN ('DMOF', 'CTOC')" ).append("\n"); 
		query.append("OR (    C.DMDT_TRF_CD = 'DTOC'" ).append("\n"); 
		query.append("AND INSTR (NVL (B.POL_CD, '  '), 'US') <> 1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("THEN REPLACE (BS.CUST_NM" ).append("\n"); 
		query.append(", CHR (13)" ).append("\n"); 
		query.append("|| CHR (10)" ).append("\n"); 
		query.append(",' '" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("END AS PAYER_NM" ).append("\n"); 
		query.append(", BS.CUST_CNT_CD" ).append("\n"); 
		query.append("|| TRIM (TO_CHAR (BS.CUST_SEQ, '000000')) SHIPPER_CD" ).append("\n"); 
		query.append(",REPLACE (BS.CUST_NM" ).append("\n"); 
		query.append(", CHR (13)" ).append("\n"); 
		query.append("|| CHR (10)" ).append("\n"); 
		query.append(",' '" ).append("\n"); 
		query.append(") SHIPPER_NM" ).append("\n"); 
		query.append(",DECODE (BC.CUST_CNT_CD" ).append("\n"); 
		query.append("|| TRIM (TO_CHAR (BC.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append(",'000000', NULL" ).append("\n"); 
		query.append(", BC.CUST_CNT_CD" ).append("\n"); 
		query.append("|| TRIM (TO_CHAR (BC.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append(") CNEE_CD" ).append("\n"); 
		query.append(",REPLACE (BC.CUST_NM" ).append("\n"); 
		query.append(", CHR (13)" ).append("\n"); 
		query.append("|| CHR (10)" ).append("\n"); 
		query.append(",' '" ).append("\n"); 
		query.append(") CNEE_NM" ).append("\n"); 
		query.append(",DECODE (BN.CUST_CNT_CD" ).append("\n"); 
		query.append("|| TRIM (TO_CHAR (BN.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append(",'000000', NULL" ).append("\n"); 
		query.append(", BN.CUST_CNT_CD" ).append("\n"); 
		query.append("|| TRIM (TO_CHAR (BN.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append(") NTFY_CD" ).append("\n"); 
		query.append(",NVL (RTRIM (REPLACE (REPLACE (BN.CUST_NM" ).append("\n"); 
		query.append(",'\"'" ).append("\n"); 
		query.append(",''" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(", CHR (13)" ).append("\n"); 
		query.append("|| CHR (10)" ).append("\n"); 
		query.append(",' '" ).append("\n"); 
		query.append("))" ).append("\n"); 
		query.append(",'-') NTFY_NM" ).append("\n"); 
		query.append(", (SELECT I.ACT_CUST_CNT_CD" ).append("\n"); 
		query.append("|| TRIM (TO_CHAR (ACT_CUST_SEQ, '000000'))" ).append("\n"); 
		query.append("FROM INV_AR_MN I" ).append("\n"); 
		query.append("WHERE I.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("AND I.IO_BND_CD = SUBSTR (C.DMDT_TRF_CD" ).append("\n"); 
		query.append(",3" ).append("\n"); 
		query.append(",1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND AR_IF_NO =" ).append("\n"); 
		query.append("(SELECT MAX (AR_IF_NO)" ).append("\n"); 
		query.append("FROM INV_AR_MN" ).append("\n"); 
		query.append("WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("AND IO_BND_CD = SUBSTR (C.DMDT_TRF_CD" ).append("\n"); 
		query.append(",3" ).append("\n"); 
		query.append(",1" ).append("\n"); 
		query.append("))" ).append("\n"); 
		query.append("AND ROWNUM = 1) AS AR_ACT_CD" ).append("\n"); 
		query.append(", (SELECT MC.CUST_LGL_ENG_NM" ).append("\n"); 
		query.append("FROM MDM_CUSTOMER MC" ).append("\n"); 
		query.append(",INV_AR_MN I" ).append("\n"); 
		query.append("WHERE MC.CUST_CNT_CD = I.ACT_CUST_CNT_CD" ).append("\n"); 
		query.append("AND MC.CUST_SEQ = I.ACT_CUST_SEQ" ).append("\n"); 
		query.append("AND I.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("AND I.IO_BND_CD = SUBSTR (C.DMDT_TRF_CD" ).append("\n"); 
		query.append(",3" ).append("\n"); 
		query.append(",1" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("AND AR_IF_NO =" ).append("\n"); 
		query.append("(SELECT MAX (AR_IF_NO)" ).append("\n"); 
		query.append("FROM INV_AR_MN" ).append("\n"); 
		query.append("WHERE BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("AND IO_BND_CD = SUBSTR (C.DMDT_TRF_CD" ).append("\n"); 
		query.append(",3" ).append("\n"); 
		query.append(",1" ).append("\n"); 
		query.append("))" ).append("\n"); 
		query.append("AND ROWNUM = 1) AS AR_ACT_NM" ).append("\n"); 
		query.append(",DECODE (TRIM (TO_CHAR (C.VNDR_SEQ, '000000'))" ).append("\n"); 
		query.append(",'000000', NULL" ).append("\n"); 
		query.append(",TRIM (TO_CHAR (C.VNDR_SEQ, '000000'))" ).append("\n"); 
		query.append(") AS SVC_PROVDR_CD" ).append("\n"); 
		query.append(", (SELECT MV.VNDR_LGL_ENG_NM" ).append("\n"); 
		query.append("FROM MDM_VENDOR MV" ).append("\n"); 
		query.append("WHERE MV.VNDR_SEQ = C.VNDR_SEQ) AS SVC_PROVDR_NM" ).append("\n"); 
		query.append(",B.SC_NO" ).append("\n"); 
		query.append(",B.RFA_NO" ).append("\n"); 
		query.append(",CASE WHEN (SELECT AR_OFC_CD FROM MDM_ORGANIZATION WHERE OFC_CD = @[ofc_cd]) IN ('SGNBB', 'SAOBB', 'MTRBS', 'TORBB', 'VANBS', 'MEXBA') THEN 'USD'" ).append("\n"); 
		query.append("ELSE (SELECT AR_CURR_CD FROM MDM_ORGANIZATION WHERE OFC_CD = @[ofc_cd])" ).append("\n"); 
		query.append("END  AS INV_CURR_CD" ).append("\n"); 
		query.append(",C.BZC_TRF_CURR_CD AS ORG_CURR_CD" ).append("\n"); 
		query.append(",C.ORG_CHG_AMT AS ORG_CHG_AMT" ).append("\n"); 
		query.append(",C.SC_RFA_EXPT_AMT AS EXPT_AMT" ).append("\n"); 
		query.append(",C.AFT_EXPT_DC_AMT AS DC_AMT" ).append("\n"); 
		query.append(",C.BIL_AMT" ).append("\n"); 
		query.append(",C.SYS_AREA_GRP_ID AS SVR_ID" ).append("\n"); 
		query.append(",C.CNTR_CYC_NO" ).append("\n"); 
		query.append(",C.DMDT_CHG_LOC_DIV_CD" ).append("\n"); 
		query.append(",C.CHG_SEQ" ).append("\n"); 
		query.append(",CASE WHEN (SELECT AR_OFC_CD FROM MDM_ORGANIZATION WHERE OFC_CD = @[ofc_cd]) IN ('SGNBB', 'SAOBB', 'MTRBS', 'TORBB', 'VANBS', 'MEXBA') THEN 'USD'" ).append("\n"); 
		query.append("ELSE (SELECT AR_CURR_CD FROM MDM_ORGANIZATION WHERE OFC_CD = @[ofc_cd])" ).append("\n"); 
		query.append("END  AS AR_CURR_CD" ).append("\n"); 
		query.append(",1 AS AR_XCH_RT" ).append("\n"); 
		query.append(",C.BZC_TRF_CURR_CD" ).append("\n"); 
		query.append(",C.DMDT_INV_NO" ).append("\n"); 
		query.append(",B.VSL_CD" ).append("\n"); 
		query.append(",B.SKD_VOY_NO" ).append("\n"); 
		query.append(",B.SKD_DIR_CD" ).append("\n"); 
		query.append(",B.POL_CD" ).append("\n"); 
		query.append(",B.POD_CD" ).append("\n"); 
		query.append("FROM DMT_CHG_BKG_CNTR B" ).append("\n"); 
		query.append(",DMT_CHG_CALC C" ).append("\n"); 
		query.append(",BKG_CUSTOMER BS" ).append("\n"); 
		query.append(",BKG_CUSTOMER BC" ).append("\n"); 
		query.append(",BKG_CUSTOMER BN" ).append("\n"); 
		query.append("WHERE B.SYS_AREA_GRP_ID = C.SYS_AREA_GRP_ID" ).append("\n"); 
		query.append("AND B.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("AND B.CNTR_CYC_NO = C.CNTR_CYC_NO" ).append("\n"); 
		query.append("AND B.BKG_NO   = BS.BKG_NO(+)" ).append("\n"); 
		query.append("AND BS.BKG_CUST_TP_CD(+) = 'S'" ).append("\n"); 
		query.append("AND B.BKG_NO   = BC.BKG_NO (+)" ).append("\n"); 
		query.append("AND BC.BKG_CUST_TP_CD(+) = 'C'" ).append("\n"); 
		query.append("AND B.BKG_NO   = BN.BKG_NO(+)" ).append("\n"); 
		query.append("AND BN.BKG_CUST_TP_CD(+) = 'N'" ).append("\n"); 
		query.append("AND C.DMDT_CHG_LOC_DIV_CD IN ('POD','POL','POR','DEL', 'TSP')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##    -- 메인 조회 : Office" ).append("\n"); 
		query.append("#if (${ofc_cd} != '')" ).append("\n"); 
		query.append("AND C.OFC_CD            =   @[ofc_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  -- 메인 조회 : Tariff type" ).append("\n"); 
		query.append("AND    C.DMDT_TRF_CD        =	@[dmdt_trf_cd]" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  -- 메인 조회 : Status + OVERDAY : F/T OVER DAY OR STAYING DAY(단, DMDT_CHG_STS_CD가 U일 경우는 over day 적용 제외)" ).append("\n"); 
		query.append("#if (${dmdt_chg_sts_cd} != '')" ).append("\n"); 
		query.append("AND ( 1=0" ).append("\n"); 
		query.append("#foreach( $chg_sts_cd in ${chg_sts_cd_list} )" ).append("\n"); 
		query.append("#if (${cond_type} != 'date')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ($chg_sts_cd != 'U')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = '$chg_sts_cd'" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = '$chg_sts_cd'" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND (" ).append("\n"); 
		query.append("( C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'RRRRMMDD'),'YYYYMMDDHH24MISS') - TO_DATE (TO_CHAR (C.FT_END_DT, 'RRRRMMDD'), 'YYYYMMDDHH24MISS') >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("( C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'RRRRMMDD'),'YYYYMMDDHH24MISS') - TO_DATE (TO_CHAR (C.FT_END_DT, 'RRRRMMDD'), 'YYYYMMDDHH24MISS') >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("#if ($chg_sts_cd == 'F')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = 'F'" ).append("\n"); 
		query.append("AND C.TO_MVMT_DT BETWEEN TO_DATE(@[fm_dt], 'yyyymmdd')" ).append("\n"); 
		query.append("AND TO_DATE(@[to_dt], 'yyyymmdd') + 0.99999" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif ($chg_sts_cd == 'L')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = 'L'" ).append("\n"); 
		query.append("AND C.FM_MVMT_DT BETWEEN TO_DATE(@[fm_dt], 'yyyymmdd')" ).append("\n"); 
		query.append("AND TO_DATE(@[to_dt], 'yyyymmdd') + 0.99999" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif ($chg_sts_cd == 'U')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = 'U'" ).append("\n"); 
		query.append("AND C.FM_MVMT_DT BETWEEN TO_DATE(@[fm_dt], 'yyyymmdd')" ).append("\n"); 
		query.append("AND TO_DATE(@[to_dt], 'yyyymmdd') + 0.99999" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND (" ).append("\n"); 
		query.append("( C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'RRRRMMDD'),'YYYYMMDDHH24MISS') - TO_DATE (TO_CHAR (C.FT_END_DT, 'RRRRMMDD'), 'YYYYMMDDHH24MISS') >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("( C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'RRRRMMDD'),'YYYYMMDDHH24MISS') - TO_DATE (TO_CHAR (C.FT_END_DT, 'RRRRMMDD'), 'YYYYMMDDHH24MISS') >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif ($chg_sts_cd == 'C')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = 'C'" ).append("\n"); 
		query.append("AND C.TO_MVMT_DT BETWEEN TO_DATE(@[fm_dt], 'yyyymmdd')" ).append("\n"); 
		query.append("AND TO_DATE(@[to_dt], 'yyyymmdd') + 0.99999" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif ($chg_sts_cd == 'I')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = 'I'" ).append("\n"); 
		query.append("AND C.TO_MVMT_DT BETWEEN TO_DATE(@[fm_dt], 'yyyymmdd')" ).append("\n"); 
		query.append("AND TO_DATE(@[to_dt], 'yyyymmdd') + 0.99999" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif ($chg_sts_cd == 'R')" ).append("\n"); 
		query.append("OR (C.DMDT_CHG_STS_CD = 'L'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${fx_ft_ovr_dys} != '')" ).append("\n"); 
		query.append("#if (${day_type} == '1')" ).append("\n"); 
		query.append("AND C.FX_FT_OVR_DYS >= TO_NUMBER(@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append("#elseif (${day_type} == '2')" ).append("\n"); 
		query.append("AND	(   (    C.TO_MVMT_DT IS NOT NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (C.TO_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("OR (    C.TO_MVMT_DT IS NULL" ).append("\n"); 
		query.append("AND (TO_DATE (TO_CHAR (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[cre_ofc_cd]),SYSDATE), 'rrrrmmdd'), 'rrrrmmdd')" ).append("\n"); 
		query.append("- TO_DATE (TO_CHAR (C.FM_MVMT_DT, 'rrrrmmdd'), 'rrrrmmdd'))" ).append("\n"); 
		query.append("+ 1 >= TO_NUMBER (@[fx_ft_ovr_dys])" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end ## end of the day_type" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  -- 메인 조회 : G/B CHARGE_TYPE" ).append("\n"); 
		query.append("#if (${chg_type} == 'G')" ).append("\n"); 
		query.append("AND C.CHG_SEQ = 1" ).append("\n"); 
		query.append("#elseif (${chg_type} == 'B')" ).append("\n"); 
		query.append("AND C.CHG_SEQ > 1" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 1: DATE 일 경우" ).append("\n"); 
		query.append("#if (${cond_type} == 'date')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${loc_cd} != '')" ).append("\n"); 
		query.append("#if (${loc_type} == '1')" ).append("\n"); 
		query.append("AND (( LENGTH(@[loc_cd]) = 5 AND C.FM_MVMT_YD_CD LIKE  @[loc_cd] || '%' )" ).append("\n"); 
		query.append("OR" ).append("\n"); 
		query.append("( LENGTH(@[loc_cd]) = 7 AND C.FM_MVMT_YD_CD =  @[loc_cd] ))" ).append("\n"); 
		query.append("#elseif (${loc_type} == '2')" ).append("\n"); 
		query.append("AND DECODE(SUBSTR(@[dmdt_trf_cd], 3, 1),'O', B.POR_CD, B.DEL_CD) = SUBSTR(@[loc_cd], 1, 5)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("##else" ).append("\n"); 
		query.append("##	AND C.DMDT_CHG_STS_CD NOT IN ('D','N','U','I','C')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 2: VVD CD 일 경우" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${cond_type} == 'vvd_cd')" ).append("\n"); 
		query.append("#if (${vvd_cd} != '')" ).append("\n"); 
		query.append("AND (	B.VSL_CD = SUBSTR(@[vvd_cd],1,4)" ).append("\n"); 
		query.append("AND B.SKD_VOY_NO = SUBSTR(@[vvd_cd],5,4)" ).append("\n"); 
		query.append("AND B.SKD_DIR_CD = SUBSTR(@[vvd_cd],9)" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${port_cd} != '')" ).append("\n"); 
		query.append("AND	DECODE(SUBSTR(@[dmdt_trf_cd], 3, 1),'O', B.POL_CD, B.POD_CD) = @[port_cd]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 3: CNTR 종류를 선택 했을 경우" ).append("\n"); 
		query.append("#if (${cond_type} == 'cntr')" ).append("\n"); 
		query.append("#if (${bkg_no} != '')" ).append("\n"); 
		query.append("AND B.BKG_NO IN (" ).append("\n"); 
		query.append("#foreach( $bkg_cd in ${bkg_no_list} )" ).append("\n"); 
		query.append("#if($velocityCount < $bkg_no_list.size()) '$bkg_cd', #else '$bkg_cd' #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${bl_no} != '')" ).append("\n"); 
		query.append("AND B.BL_NO IN (" ).append("\n"); 
		query.append("#foreach( $bl_cd in ${bl_no_list} )" ).append("\n"); 
		query.append("#if($velocityCount < $bl_no_list.size()) '$bl_cd', #else '$bl_cd' #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${cntr_no} != '')" ).append("\n"); 
		query.append("AND C.CNTR_NO IN (" ).append("\n"); 
		query.append("#foreach( $cntr_cd in ${cntr_no_list} )" ).append("\n"); 
		query.append("#if($velocityCount < $cntr_no_list.size()) '$cntr_cd', #else '$cntr_cd' #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 : CUSTOMER 종류" ).append("\n"); 
		query.append("#if (${cust_cd} != '')" ).append("\n"); 
		query.append("#if (${cust_type} == '')" ).append("\n"); 
		query.append("AND (" ).append("\n"); 
		query.append("#if (${cust_len} == '8')" ).append("\n"); 
		query.append("C.ACT_CNT_CD	= SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND C.ACT_CUST_SEQ	= LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("C.ACT_CUST_SEQ = LTRIM(SUBSTR(@[cust_cd],1,6),'0')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("OR		BS.CUST_CNT_CD	= SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND BS.CUST_SEQ		= LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("OR		BC.CUST_CNT_CD	= SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND BC.CUST_SEQ		= LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("OR 		BN.CUST_CNT_CD	= SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND BN.CUST_SEQ		= LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("OR(" ).append("\n"); 
		query.append("EXISTS (" ).append("\n"); 
		query.append("SELECT  'X'" ).append("\n"); 
		query.append("FROM    INV_AR_MN I" ).append("\n"); 
		query.append("WHERE   I.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("AND     I.IO_BND_CD = 'I'" ).append("\n"); 
		query.append("AND     ROWNUM  = 1" ).append("\n"); 
		query.append("AND     I.ACT_CUST_CNT_CD   = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND     I.ACT_CUST_SEQ      = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#elseif (${cust_type} == 'P')" ).append("\n"); 
		query.append("#if (${cust_len} == '8')" ).append("\n"); 
		query.append("AND	C.ACT_CNT_CD	= SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND C.ACT_CUST_SEQ	= LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("AND	C.ACT_CUST_SEQ = LTRIM(SUBSTR(@[cust_cd],1,6),'0')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#elseif (${cust_type} == 'S')" ).append("\n"); 
		query.append("AND BS.CUST_CNT_CD = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND BS.CUST_SEQ = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("#elseif (${cust_type} == 'C')" ).append("\n"); 
		query.append("AND BC.CUST_CNT_CD = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND BC.CUST_SEQ = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("#elseif (${cust_type} == 'N')" ).append("\n"); 
		query.append("AND BN.CUST_CNT_CD = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND BN.CUST_SEQ  = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append("#elseif (${cust_type} == 'A')" ).append("\n"); 
		query.append("AND EXISTS (" ).append("\n"); 
		query.append("SELECT  'X'" ).append("\n"); 
		query.append("FROM    INV_AR_MN I" ).append("\n"); 
		query.append("WHERE   I.BKG_NO = B.BKG_NO" ).append("\n"); 
		query.append("AND     I.IO_BND_CD = 'I'" ).append("\n"); 
		query.append("AND     ROWNUM  = 1" ).append("\n"); 
		query.append("AND     I.ACT_CUST_CNT_CD   = SUBSTR(@[cust_cd],1,2)" ).append("\n"); 
		query.append("AND     I.ACT_CUST_SEQ      = LTRIM(SUBSTR(@[cust_cd],3),'0')" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 : Service Provider 종류" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${svc_provdr} != '')" ).append("\n"); 
		query.append("AND C.VNDR_SEQ = LTRIM(@[svc_provdr],'0')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##  --선택 조회 : S/C No" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${sc_no} != '')" ).append("\n"); 
		query.append("AND B.SC_NO = @[sc_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("##  --선택 조회 : RFA No" ).append("\n"); 
		query.append("#if (${rfa_no} != '')" ).append("\n"); 
		query.append("AND B.RFA_NO = @[rfa_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(") X" ).append("\n"); 
		query.append(") Y" ).append("\n"); 
		query.append("WHERE Y.RNUM < 2" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("##" ).append("\n"); 

	}
}