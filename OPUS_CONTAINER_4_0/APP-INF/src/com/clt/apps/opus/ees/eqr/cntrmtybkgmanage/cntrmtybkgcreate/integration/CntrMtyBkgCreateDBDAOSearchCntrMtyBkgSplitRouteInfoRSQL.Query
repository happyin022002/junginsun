<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CntrMtyBkgCreateDBDAOSearchCntrMtyBkgSplitRouteInfoRSQL">
			<desc><![CDATA[BKG/DOC 에 제공할 BKG VD ROUTE 정보 조회]]></desc>
			<sql><![CDATA[
SELECT A.TRSP_MOD_CD
      ,A.VSL_LANE_CD
      ,A.VSL_CD
      ,A.SKD_VOY_NO
      ,A.SKD_DIR_CD
      ,'' AS BKG_EXE_SEQ --BKG_EXE_SEQ
      ,A.FM_YD_CD AS FM_YD_CD 
      ,TO_CHAR(A.FM_ETD_DT, 'YYYY-MM-DD HH24MISS') AS FM_ETD_DT 
      ,'' AS POL_CLPT_IND_SEQ --A.POL_CLPT_IND_SEQ     
      ,B.TO_YD_CD   TO_YD_CD
      ,B.TO_ETB_DT  TO_ETB_DT
      ,B.POD_CLPT_IND_SEQ
      ,A.MTY_BKG_NO  
      ,A.EQ_REPO_PURP_CD
      ,B.CNTR_TP_SZ AS CNTR_TPSZ_CD
      ,B.CNTR_QTY
FROM EQR_VSL_LODG_DCHG_EXE_PLN A
    ,(
        SELECT INP_MSG1  BKG_NO
              ,INP_MSG7  TO_YD_CD
              ,INP_MSG8  TO_ETB_DT 
              ,INP_MSG13 POD_CLPT_IND_SEQ
              ,INP_MSG3  CNTR_TP_SZ
  			  ,COUNT(INP_MSG6) CNTR_QTY
        FROM EQR_CTRL_DAT_VRFY
        WHERE TMP_SEQ = @[tmp_seq]
        AND   INP_MSG1= @[vl_bkg_no]
        GROUP BY INP_MSG1, INP_MSG7, INP_MSG8, INP_MSG13, INP_MSG3
     ) B
WHERE A.MTY_BKG_NO = B.BKG_NO -- VL BKG NO
AND   A.VSL_CD     = @[vsl_cd]
AND   A.SKD_VOY_NO = @[skd_voy_no]
AND   A.SKD_DIR_CD = @[skd_dir_cd]
AND   A.MTY_BKG_NO = @[vl_bkg_no]			]]></sql>
			<params>
				<param name="tmp_seq" type="12" value="" out="N"/>
				<param name="vl_bkg_no" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
