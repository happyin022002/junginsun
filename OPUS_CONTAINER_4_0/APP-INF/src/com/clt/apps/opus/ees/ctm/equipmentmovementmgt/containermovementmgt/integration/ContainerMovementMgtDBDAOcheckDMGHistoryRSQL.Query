<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ContainerMovementMgtDBDAOcheckDMGHistoryRSQL">
			<desc><![CDATA[checkDMGHistory]]></desc>
			<sql><![CDATA[
SELECT EQ_NO, 
	MNR_STS_FLG, 
	MNR_FLG_YD_CD, 
	TO_CHAR(MNR_FLG_INP_DT, 'YYYYMMDDHH24MI') AS MNR_FLG_INP_DT,
	MNR_FLG_RMK,
	UPD_OFC_CD,
	UPD_USR_ID
FROM MNR_FLG_HIS
WHERE 1=1
AND EQ_NO = @[cntr_no]
AND EQ_KND_CD='U'
AND MNR_FLG_TP_CD = 'DMG'
#if (${evnt_dt} != '') 
AND MNR_FLG_SEQ = (SELECT MAX(MNR_FLG_SEQ) - @[seq] - 1
        FROM MNR_FLG_HIS
        WHERE 1=1
        AND EQ_NO = @[cntr_no]
        AND EQ_KND_CD='U'
        AND MNR_FLG_TP_CD = 'DMG')
AND MNR_FLG_INP_DT > TO_DATE(@[evnt_dt], 'YYYYMMDDHH24MI')
AND MNR_STS_FLG = DECODE(@[dmg_flg], '1', 'N', 'Y')
#else
AND MNR_FLG_SEQ = (SELECT MAX(MNR_FLG_SEQ) - @[seq]
        FROM MNR_FLG_HIS
        WHERE 1=1
        AND EQ_NO = @[cntr_no]
        AND EQ_KND_CD='U'
        AND MNR_FLG_TP_CD = 'DMG')
#end			]]></sql>
			<params>
				<param name="cntr_no" type="12" value="" out="N"/>
				<param name="seq" type="12" value="" out="N"/>
				<param name="evnt_dt" type="12" value="" out="N"/>
				<param name="dmg_flg" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
