/*=========================================================
*Copyright(c) 2017 CyberLogitec
*@FileName : MTYRepositionPerformanceAnalysisDBDAOMTYCNTRPERFInDetailVORSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2017.01.18
*@LastModifier : 
*@LastVersion : 1.0
* 2017.01.18 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.ees.cim.cntroperationperformancemgt.mtyrepositionperformanceanalysis.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class MTYRepositionPerformanceAnalysisDBDAOMTYCNTRPERFInDetailVORSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * Movement Premance by CY 조회 쿼리
	  * - 2010.09.02 남궁진호 [CHM-201005671-01]- 두개의 MVMT STS를 조회하는 경우 이전 이후 MVMT EVENT DATE 를  모두 보여주도록 수정함, EVENTDATE -> PRE-EVENT_DATE,POST_EVENT_DATE추가
	  * - 2010.09.15 이병훈 [CHM-201005995-01] - ''Movement Performance by CY''의 BKG 데이터 I/F 로직 변경
	  * - 2011.04.07 나상보 [CHM-201109997-01] - [CIM] Movement Performance by CY 기능 보완. SC_RFA_NO_TAA, SHPR, CNEE 추가
	  * </pre>
	  */
	public MTYRepositionPerformanceAnalysisDBDAOMTYCNTRPERFInDetailVORSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("location",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("from",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("mtymvmt",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.ees.cim.cntroperationperformancemgt.mtyrepositionperformanceanalysis.integration").append("\n"); 
		query.append("FileName : MTYRepositionPerformanceAnalysisDBDAOMTYCNTRPERFInDetailVORSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if (${mtymvmt} == 'MTIDMG' || ${mtymvmt} == 'MTVDVD-MT' || ${mtymvmt} == 'MTOPOP-MT' || ${mtymvmt} == 'VLMTMT-VL' || ${mtymvmt} == 'MTOCOC-MT' || ${mtymvmt} == 'OCIDID-OC')" ).append("\n"); 
		query.append("  SELECT  /*+ index( m xie6ctm_movement ) */" ).append("\n"); 
		query.append("        M.CNMV_CO_CD AS company," ).append("\n"); 
		query.append("        M.CNTR_NO AS cntrNo," ).append("\n"); 
		query.append("        M.CNTR_TPSZ_CD AS tpsz," ).append("\n"); 
		query.append("        SUBSTR(@[mtymvmt],5) AS mvmt, " ).append("\n"); 
		query.append("        M.ORG_YD_CD AS yard ," ).append("\n"); 
		query.append("#if (${mtymvmt} != 'MTIDMG')" ).append("\n"); 
		query.append("      (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("              TO_CHAR(MM.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI')  /*  PRE_MVMT_EVNT_DT */" ).append("\n"); 
		query.append("         FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("        WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("          AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("              M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("          AND MM.MVMT_STS_CD = SUBSTR(@[mtymvmt],3,2)" ).append("\n"); 
		query.append("          AND ROWNUM = 1) AS PRE_EVENTDATE," ).append("\n"); 
		query.append("        TO_CHAR(M.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI') AS POST_EVENTDATE," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("        TO_CHAR(M.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI') AS PRE_EVENTDATE," ).append("\n"); 
		query.append("        '' AS POST_EVENTDATE," ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("        M.MVMT_CRE_TP_CD AS autoFlag," ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("#if (${mtymvmt} != 'MTOPOP-MT')        " ).append("\n"); 
		query.append("        B.SLAN_CD AS lane," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("     (SELECT   /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ BB.SLAN_CD" ).append("\n"); 
		query.append("         FROM CTM_MOVEMENT MM, BKG_BOOKING   BB" ).append("\n"); 
		query.append("        WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("          AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("              M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("          AND MM.MVMT_STS_CD = SUBSTR('MTOPOP-MT',3,2)" ).append("\n"); 
		query.append("          AND MM.BKG_NO    = BB.BKG_NO" ).append("\n"); 
		query.append("          AND ROWNUM = 1) AS lane," ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("     " ).append("\n"); 
		query.append("        M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS tVvd," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${mtymvmt} != 'MTOPOP-MT')" ).append("\n"); 
		query.append("        M.BKG_NO AS bkgNo," ).append("\n"); 
		query.append("        B.POR_CD as por,  /* POR CODE */" ).append("\n"); 
		query.append("        B.POL_CD AS pol," ).append("\n"); 
		query.append("        B.POD_CD AS pod," ).append("\n"); 
		query.append("        B.DEL_CD AS del,  /* DEL CODE */" ).append("\n"); 
		query.append("		B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		(SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("     (SELECT   /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ BB.BKG_NO" ).append("\n"); 
		query.append("         FROM CTM_MOVEMENT MM, BKG_BOOKING   BB" ).append("\n"); 
		query.append("        WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("          AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("              M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("          AND MM.MVMT_STS_CD = SUBSTR('MTOPOP-MT',3,2)" ).append("\n"); 
		query.append("          AND MM.BKG_NO    = BB.BKG_NO" ).append("\n"); 
		query.append("          AND ROWNUM = 1) AS bkgNo," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      (SELECT  /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ BB.POR_CD " ).append("\n"); 
		query.append("         FROM CTM_MOVEMENT MM, BKG_BOOKING   BB" ).append("\n"); 
		query.append("        WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("          AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("              M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("          AND MM.MVMT_STS_CD = SUBSTR('MTOPOP-MT',3,2)" ).append("\n"); 
		query.append("          AND MM.BKG_NO    = BB.BKG_NO" ).append("\n"); 
		query.append("          AND ROWNUM = 1) AS por," ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append("       (SELECT  /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ BB.POL_CD " ).append("\n"); 
		query.append("         FROM CTM_MOVEMENT MM, BKG_BOOKING   BB" ).append("\n"); 
		query.append("        WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("          AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("              M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("          AND MM.MVMT_STS_CD = SUBSTR('MTOPOP-MT',3,2)" ).append("\n"); 
		query.append("          AND MM.BKG_NO    = BB.BKG_NO" ).append("\n"); 
		query.append("          AND ROWNUM = 1) AS pol," ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append("         (SELECT  /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ BB.POD_CD " ).append("\n"); 
		query.append("         FROM CTM_MOVEMENT MM, BKG_BOOKING   BB" ).append("\n"); 
		query.append("        WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("          AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("              M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("          AND MM.MVMT_STS_CD = SUBSTR('MTOPOP-MT',3,2)" ).append("\n"); 
		query.append("          AND MM.BKG_NO    = BB.BKG_NO" ).append("\n"); 
		query.append("          AND ROWNUM = 1) AS pod, " ).append("\n"); 
		query.append("          " ).append("\n"); 
		query.append("        (SELECT  /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ BB.DEL_CD " ).append("\n"); 
		query.append("         FROM CTM_MOVEMENT MM, BKG_BOOKING   BB" ).append("\n"); 
		query.append("        WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("          AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("              M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("          AND MM.MVMT_STS_CD = SUBSTR('MTOPOP-MT',3,2)" ).append("\n"); 
		query.append("          AND MM.BKG_NO    = BB.BKG_NO" ).append("\n"); 
		query.append("          AND ROWNUM = 1) AS del," ).append("\n"); 
		query.append("(SELECT   /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ " ).append("\n"); 
		query.append("          REPLACE(REPLACE(SUBSTR(CC.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')" ).append("\n"); 
		query.append("         FROM CTM_MOVEMENT MM, BKG_BOOKING   BB, BKG_CUSTOMER CC" ).append("\n"); 
		query.append("        WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("          AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("              M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("          AND MM.MVMT_STS_CD = SUBSTR('MTOPOP-MT',3,2)" ).append("\n"); 
		query.append("          AND MM.BKG_NO    = BB.BKG_NO" ).append("\n"); 
		query.append("          AND BB.BKG_NO    = CC.BKG_NO" ).append("\n"); 
		query.append("          AND CC.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("          AND ROWNUM = 1) AS SHPR," ).append("\n"); 
		query.append("(SELECT   /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */ " ).append("\n"); 
		query.append("          REPLACE(REPLACE(SUBSTR(CC.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')" ).append("\n"); 
		query.append("         FROM CTM_MOVEMENT MM, BKG_BOOKING   BB, BKG_CUSTOMER CC" ).append("\n"); 
		query.append("        WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("          AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("              M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("          AND MM.MVMT_STS_CD = SUBSTR('MTOPOP-MT',3,2)" ).append("\n"); 
		query.append("          AND MM.BKG_NO    = BB.BKG_NO" ).append("\n"); 
		query.append("          AND BB.BKG_NO    = CC.BKG_NO" ).append("\n"); 
		query.append("          AND CC.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("          AND ROWNUM = 1) AS CNEE," ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("        M.CNTR_DMG_FLG AS damage," ).append("\n"); 
		query.append("        M.CNTR_DISP_FLG AS disposal," ).append("\n"); 
		query.append("        M.IMDT_EXT_FLG AS imdtExit ," ).append("\n"); 
		query.append("        M.CNTR_HNGR_RCK_FLG AS hngrRack" ).append("\n"); 
		query.append("   FROM CTM_MOVEMENT    M," ).append("\n"); 
		query.append("        MST_CONTAINER   C" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${mtymvmt} != 'MTOPOP-MT')" ).append("\n"); 
		query.append("        ,BKG_BOOKING     B" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("        " ).append("\n"); 
		query.append("#if(${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("  WHERE M.CNMV_EVNT_DT BETWEEN  TO_DATE( @[from], 'YYYYMMDD') + .0 AND TO_DATE( @[to], 'YYYYMMDD') + .99999 " ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("    AND M.MVMT_STS_CD = SUBSTR(@[mtymvmt],0,2)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    AND M.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("    AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("    #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("      '$cntrtpszcd'," ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc */" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc  */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${mtymvmt} == 'MTIDMG')" ).append("\n"); 
		query.append("    AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${mtymvmt} != 'MTOPOP-MT')" ).append("\n"); 
		query.append("    AND M.BKG_NO    = B.BKG_NO(+)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                        SELECT  /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                               Y.YD_CD" ).append("\n"); 
		query.append("                          FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                               MDM_LOCATION L," ).append("\n"); 
		query.append("                               MDM_YARD Y" ).append("\n"); 
		query.append("                         WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                           AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                           AND G.SCC_CD = @[location]     /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                           AND G.LCC_CD = @[location]   /* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                           AND G.ECC_CD = @[location]   /* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    /* ----------------> 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("    AND SUBSTR(@[mtymvmt],3,2)  = (" ).append("\n"); 
		query.append("                                    SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                                           MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("                                      FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("                                     WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("                                       AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                                           M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("                                       AND ROWNUM = 1" ).append("\n"); 
		query.append("                                  )" ).append("\n"); 
		query.append("   /* <---------------- 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif(${mtymvmt} == 'MP')" ).append("\n"); 
		query.append("  SELECT  /*+ INDEX( M XIE6CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("         COMPANY," ).append("\n"); 
		query.append("         CNTRNO," ).append("\n"); 
		query.append("         TPSZ," ).append("\n"); 
		query.append("         MVMT," ).append("\n"); 
		query.append("         YARD," ).append("\n"); 
		query.append("         TO_CHAR(EVENTDATE,'YYYY-MM-DD HH24:MI') AS PRE_EVENTDATE," ).append("\n"); 
		query.append("         ''  AS POST_EVENTDATE," ).append("\n"); 
		query.append("         AUTOFLAG," ).append("\n"); 
		query.append("         LANE," ).append("\n"); 
		query.append("         TVVD," ).append("\n"); 
		query.append("         BKGNO," ).append("\n"); 
		query.append("         POR," ).append("\n"); 
		query.append("         POL," ).append("\n"); 
		query.append("         POD," ).append("\n"); 
		query.append("         DEL," ).append("\n"); 
		query.append("         DAMAGE," ).append("\n"); 
		query.append("         DISPOSAL," ).append("\n"); 
		query.append("         IMDTEXIT," ).append("\n"); 
		query.append("         HNGRRACK," ).append("\n"); 
		query.append("		 SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		 SHPR," ).append("\n"); 
		query.append(" 		 CNEE," ).append("\n"); 
		query.append("         DMG_FLG_DT, " ).append("\n"); 
		query.append("         DMG_UNFLG_DT" ).append("\n"); 
		query.append("  FROM" ).append("\n"); 
		query.append("      (" ).append("\n"); 
		query.append("        SELECT  /*+ INDEX( M XIE6CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("               M.CNMV_CO_CD AS COMPANY," ).append("\n"); 
		query.append("               M.CNTR_NO AS CNTRNO," ).append("\n"); 
		query.append("               M.CNTR_TPSZ_CD AS TPSZ," ).append("\n"); 
		query.append("               'MP' AS MVMT," ).append("\n"); 
		query.append("               M.ORG_YD_CD AS YARD ," ).append("\n"); 
		query.append("               M.CNMV_EVNT_DT AS EVENTDATE," ).append("\n"); 
		query.append("               M.MVMT_CRE_TP_CD AS AUTOFLAG," ).append("\n"); 
		query.append("               B.SLAN_CD AS LANE," ).append("\n"); 
		query.append("               M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS TVVD," ).append("\n"); 
		query.append("               M.BKG_NO AS BKGNO," ).append("\n"); 
		query.append("               B.POR_CD as POR, /* POR CODE */" ).append("\n"); 
		query.append("               B.POL_CD AS POL," ).append("\n"); 
		query.append("               B.POD_CD AS POD," ).append("\n"); 
		query.append("               B.DEL_CD AS DEL, /* DEL CODE */" ).append("\n"); 
		query.append("               M.CNTR_DMG_FLG AS DAMAGE," ).append("\n"); 
		query.append("               M.CNTR_DISP_FLG AS DISPOSAL," ).append("\n"); 
		query.append("               M.IMDT_EXT_FLG AS IMDTEXIT ," ).append("\n"); 
		query.append("               M.CNTR_HNGR_RCK_FLG AS HNGRRACK," ).append("\n"); 
		query.append("	  		   B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("			   (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE," ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("          FROM CTM_MOVEMENT    M," ).append("\n"); 
		query.append("               MST_CONTAINER   C," ).append("\n"); 
		query.append("               BKG_BOOKING     B" ).append("\n"); 
		query.append("#if(${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("         WHERE M.CNMV_EVNT_DT BETWEEN   TO_DATE( @[from], 'YYYYMMDD') + .0 AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("           AND M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("           AND M.CNTR_NO    = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("           AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("      #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("        '$cntrtpszcd'," ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("           AND NVL(C.LSTM_CD, '  ') <> 'SH'" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("           AND NVL(C.LSTM_CD, '  ') = 'SH'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("           AND NVL(M.MVMT_CRE_TP_CD,' ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("#if (${mtymvmt} != 'MTOPOP-MT')" ).append("\n"); 
		query.append("           AND M.BKG_NO = B.BKG_NO(+)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("           AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("           AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                               SELECT /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                                      Y.YD_CD" ).append("\n"); 
		query.append("                                 FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                                      MDM_LOCATION L," ).append("\n"); 
		query.append("                                      MDM_YARD Y" ).append("\n"); 
		query.append("                                WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                                  AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                                  AND G.SCC_CD = @[location]    /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                                  AND G.LCC_CD = @[location]    /* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                                  AND G.ECC_CD = @[location]    /* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                               )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("      /* ----------------> 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("          AND 'XX'  = (" ).append("\n"); 
		query.append("                        SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                              MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("                          FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("                         WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("                           AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                               M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("                           AND ROWNUM = 1" ).append("\n"); 
		query.append("                      )" ).append("\n"); 
		query.append("      /* <---------------- 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("  SELECT /*+ INDEX( M XIE6CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("         M.CNMV_CO_CD AS COMPANY," ).append("\n"); 
		query.append("         M.CNTR_NO AS CNTRNO," ).append("\n"); 
		query.append("         M.CNTR_TPSZ_CD AS TPSZ," ).append("\n"); 
		query.append("         'MP' AS MVMT," ).append("\n"); 
		query.append("         M.ORG_YD_CD AS YARD ," ).append("\n"); 
		query.append("         M.CNMV_EVNT_DT AS EVENTDATE," ).append("\n"); 
		query.append("         M.MVMT_CRE_TP_CD AS AUTOFLAG," ).append("\n"); 
		query.append("         B.SLAN_CD AS LANE," ).append("\n"); 
		query.append("         M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS TVVD," ).append("\n"); 
		query.append("         M.BKG_NO AS BKGNO," ).append("\n"); 
		query.append("         B.POR_CD as POR, /* POR CODE */" ).append("\n"); 
		query.append("         B.POL_CD AS POL," ).append("\n"); 
		query.append("         B.POD_CD AS POD," ).append("\n"); 
		query.append("         B.DEL_CD AS DEL, /* DEL CODE */" ).append("\n"); 
		query.append("         M.CNTR_DMG_FLG AS DAMAGE," ).append("\n"); 
		query.append("         M.CNTR_DISP_FLG AS DISPOSAL," ).append("\n"); 
		query.append("         M.IMDT_EXT_FLG AS IMDTEXIT ," ).append("\n"); 
		query.append("         M.CNTR_HNGR_RCK_FLG AS HNGRRACK," ).append("\n"); 
		query.append("		 B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		 (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("    FROM CTM_MOVEMENT    M," ).append("\n"); 
		query.append("         MST_CONTAINER   C," ).append("\n"); 
		query.append("         BKG_BOOKING     B" ).append("\n"); 
		query.append("#if(${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("   WHERE M.CNMV_EVNT_DT BETWEEN   TO_DATE( @[from], 'YYYYMMDD') + .0 AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("     AND M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("     AND M.CNTR_NO    = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("     AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("      #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("        '$cntrtpszcd'," ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("     AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc  */" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("     AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("     AND NVL(M.MVMT_CRE_TP_CD,' ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("     AND M.CNMV_CYC_NO    = 1" ).append("\n"); 
		query.append("     AND M.BKG_NO = B.BKG_NO(+)" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("     AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("     AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                         SELECT /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                               Y.YD_CD" ).append("\n"); 
		query.append("                          FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                               MDM_LOCATION L," ).append("\n"); 
		query.append("                               MDM_YARD Y" ).append("\n"); 
		query.append("                         WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                           AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                           AND G.SCC_CD = @[location]" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                           AND G.LCC_CD = @[location]" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                           AND G.ECC_CD = @[location]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif(${mtymvmt} == 'MR')" ).append("\n"); 
		query.append("  SELECT  /*+ INDEX( M XIE6CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("         COMPANY," ).append("\n"); 
		query.append("         CNTRNO," ).append("\n"); 
		query.append("         TPSZ," ).append("\n"); 
		query.append("         MVMT," ).append("\n"); 
		query.append("         YARD," ).append("\n"); 
		query.append("         TO_CHAR(EVENTDATE,'YYYY-MM-DD HH24:MI') AS PRE_EVENTDATE," ).append("\n"); 
		query.append("         ''  AS POST_EVENTDATE," ).append("\n"); 
		query.append("         AUTOFLAG," ).append("\n"); 
		query.append("         LANE," ).append("\n"); 
		query.append("         TVVD," ).append("\n"); 
		query.append("         BKGNO," ).append("\n"); 
		query.append("         POR," ).append("\n"); 
		query.append("         POL," ).append("\n"); 
		query.append("         POD," ).append("\n"); 
		query.append("         DEL," ).append("\n"); 
		query.append("         DAMAGE," ).append("\n"); 
		query.append("         DISPOSAL," ).append("\n"); 
		query.append("         IMDTEXIT," ).append("\n"); 
		query.append("         HNGRRACK," ).append("\n"); 
		query.append("		 SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		 SHPR," ).append("\n"); 
		query.append(" 		 CNEE," ).append("\n"); 
		query.append("		 DMG_FLG_DT," ).append("\n"); 
		query.append("		 DMG_UNFLG_DT" ).append("\n"); 
		query.append("   FROM (" ).append("\n"); 
		query.append("         SELECT /*+ INDEX( M XIE6CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                M.CNMV_CO_CD AS COMPANY," ).append("\n"); 
		query.append("                M.CNTR_NO AS CNTRNO," ).append("\n"); 
		query.append("                M.CNTR_TPSZ_CD AS TPSZ," ).append("\n"); 
		query.append("                'MR' AS MVMT," ).append("\n"); 
		query.append("                M.ORG_YD_CD AS YARD ," ).append("\n"); 
		query.append("                M.CNMV_EVNT_DT AS EVENTDATE," ).append("\n"); 
		query.append("                M.MVMT_CRE_TP_CD AS AUTOFLAG," ).append("\n"); 
		query.append("                B.SLAN_CD AS LANE," ).append("\n"); 
		query.append("                M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS TVVD," ).append("\n"); 
		query.append("                M.BKG_NO AS BKGNO," ).append("\n"); 
		query.append("                B.POR_CD as POR,  /* POR CODE */" ).append("\n"); 
		query.append("                B.POL_CD AS POL," ).append("\n"); 
		query.append("                B.POD_CD AS POD," ).append("\n"); 
		query.append("                B.DEL_CD AS DEL,  /* DEL CODE */" ).append("\n"); 
		query.append("                M.CNTR_DMG_FLG AS DAMAGE," ).append("\n"); 
		query.append("                M.CNTR_DISP_FLG AS DISPOSAL," ).append("\n"); 
		query.append("                M.IMDT_EXT_FLG AS IMDTEXIT ," ).append("\n"); 
		query.append("                M.CNTR_HNGR_RCK_FLG AS HNGRRACK," ).append("\n"); 
		query.append("		 		B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		  	 	(SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("		MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("           FROM CTM_MOVEMENT      M," ).append("\n"); 
		query.append("                CIM_TP_SZ_DP_SEQ_V  S," ).append("\n"); 
		query.append("                MST_CONTAINER     C," ).append("\n"); 
		query.append("                BKG_BOOKING       B" ).append("\n"); 
		query.append("#if (${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("          WHERE M.CNMV_EVNT_DT BETWEEN  TO_DATE( @[from], 'YYYYMMDD') + .0 AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("            AND M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("            AND M.CNTR_TPSZ_CD = S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("            AND M.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("            AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("      #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("        '$cntrtpszcd'," ).append("\n"); 
		query.append("        #end" ).append("\n"); 
		query.append("        '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("            AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc */" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("            AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc  */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("            AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("            AND M.BKG_NO = B.BKG_NO(+)" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("            AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("            AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                                SELECT  /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                                       Y.YD_CD" ).append("\n"); 
		query.append("                                  FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                                       MDM_LOCATION L," ).append("\n"); 
		query.append("                                       MDM_YARD Y" ).append("\n"); 
		query.append("                                 WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                                   AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                                   AND G.SCC_CD = @[location]     /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                                   AND G.LCC_CD = @[location]   /* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                                   AND G.ECC_CD = @[location]   /* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                                )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    /* ----------------> 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("            AND 'OK'  = (" ).append("\n"); 
		query.append("                         SELECT /*+ ORDERED USE_NL(MM LL GG) INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                                DECODE(GG.SCC_CD,@[location],'NO'," ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                                DECODE(GG.LCC_CD,@[location],'NO'," ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                                DECODE(GG.ECC_CD,@[location],'NO'," ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("                                DECODE(MM.ORG_YD_CD,@[location],'NO'," ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                                DECODE(MM.MVMT_STS_CD,'EN','OK'," ).append("\n"); 
		query.append("                                DECODE(MM.MVMT_STS_CD,'TN','OK','NO')))" ).append("\n"); 
		query.append("                          --    MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("                           FROM CTM_MOVEMENT  MM," ).append("\n"); 
		query.append("                                MDM_LOCATION  LL," ).append("\n"); 
		query.append("                                MDM_EQ_ORZ_CHT  GG" ).append("\n"); 
		query.append("                          WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("                            AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                                M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("                            AND SUBSTR(MM.ORG_YD_CD, 1, 5)  = LL.LOC_CD" ).append("\n"); 
		query.append("                            AND LL.SCC_CD = GG.SCC_CD" ).append("\n"); 
		query.append("                            AND ROWNUM    = 1" ).append("\n"); 
		query.append("                         )" ).append("\n"); 
		query.append("      /* <---------------- 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("  )" ).append("\n"); 
		query.append("#elseif(${mtymvmt} == 'MT')" ).append("\n"); 
		query.append("  SELECT  /*+ index( m xie6ctm_movement ) */" ).append("\n"); 
		query.append("         M.CNMV_CO_CD AS company," ).append("\n"); 
		query.append("         M.CNTR_NO AS cntrNo," ).append("\n"); 
		query.append("         M.CNTR_TPSZ_CD AS tpsz," ).append("\n"); 
		query.append("         'MG' AS mvmt," ).append("\n"); 
		query.append("         M.ORG_YD_CD AS yard ," ).append("\n"); 
		query.append("         TO_CHAR(M.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI') AS PRE_EVENTDATE," ).append("\n"); 
		query.append("         '' AS POST_EVENTDATE," ).append("\n"); 
		query.append("         M.MVMT_CRE_TP_CD AS autoFlag," ).append("\n"); 
		query.append("         B.SLAN_CD AS lane," ).append("\n"); 
		query.append("         M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS tVvd," ).append("\n"); 
		query.append("         M.BKG_NO AS bkgNo," ).append("\n"); 
		query.append("         B.POR_CD as por, /* POR CODE */" ).append("\n"); 
		query.append("         B.POL_CD AS pol," ).append("\n"); 
		query.append("         B.POD_CD AS pod," ).append("\n"); 
		query.append("         B.DEL_CD AS del, /* DEL CODE */" ).append("\n"); 
		query.append("         M.CNTR_DMG_FLG AS damage," ).append("\n"); 
		query.append("         M.CNTR_DISP_FLG AS disposal," ).append("\n"); 
		query.append("         M.IMDT_EXT_FLG AS imdtExit ," ).append("\n"); 
		query.append("         M.CNTR_HNGR_RCK_FLG AS hngrRack," ).append("\n"); 
		query.append(" 		 B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		 (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("		MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("    FROM CTM_MOVEMENT     M," ).append("\n"); 
		query.append("         MST_CONTAINER    C," ).append("\n"); 
		query.append("         BKG_BOOKING      B" ).append("\n"); 
		query.append("#if(${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("   WHERE M.CNMV_EVNT_DT BETWEEN   TO_DATE( @[from], 'YYYYMMDD') + .0" ).append("\n"); 
		query.append("     AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("     AND M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("     AND M.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("     AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("    #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("      '$cntrtpszcd'," ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("     AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc  */" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("     AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("     AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("     AND M.BKG_NO   = B.BKG_NO(+)" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("     AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("     AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                         SELECT /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                                Y.YD_CD" ).append("\n"); 
		query.append("                           FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                                MDM_LOCATION L," ).append("\n"); 
		query.append("                                MDM_YARD Y" ).append("\n"); 
		query.append("                          WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                            AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                            AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                            AND G.LCC_CD = @[location]    /* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                            AND G.ECC_CD = @[location]    /* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                      )" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("    /* ----------------> 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("    AND   'ID'  = (" ).append("\n"); 
		query.append("                   SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                           MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("                     FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("                    WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("                      AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                          M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("                      AND ROWNUM = 1" ).append("\n"); 
		query.append("                  )" ).append("\n"); 
		query.append("    /* <---------------- 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("  SELECT  /*+ INDEX( M XIE6CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("         M.CNMV_CO_CD AS COMPANY," ).append("\n"); 
		query.append("         M.CNTR_NO AS CNTRNO," ).append("\n"); 
		query.append("         M.CNTR_TPSZ_CD AS TPSZ," ).append("\n"); 
		query.append("         'MP' AS MVMT," ).append("\n"); 
		query.append("         M.ORG_YD_CD AS YARD ," ).append("\n"); 
		query.append("         TO_CHAR(M.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI') AS PRE_EVENTDATE," ).append("\n"); 
		query.append("         '' AS POST_EVENTDATE," ).append("\n"); 
		query.append("         M.MVMT_CRE_TP_CD AS AUTOFLAG," ).append("\n"); 
		query.append("         B.SLAN_CD AS LANE," ).append("\n"); 
		query.append("         M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS TVVD," ).append("\n"); 
		query.append("         M.BKG_NO AS BKGNO," ).append("\n"); 
		query.append("         B.POR_CD as POR, /* POR CODE */" ).append("\n"); 
		query.append("         B.POL_CD AS POL," ).append("\n"); 
		query.append("         B.POD_CD AS POD," ).append("\n"); 
		query.append("         B.DEL_CD AS DEL, /* DEL CODE */" ).append("\n"); 
		query.append("         M.CNTR_DMG_FLG AS DAMAGE," ).append("\n"); 
		query.append("         M.CNTR_DISP_FLG AS DISPOSAL," ).append("\n"); 
		query.append("         M.IMDT_EXT_FLG AS IMDTEXIT ," ).append("\n"); 
		query.append("         M.CNTR_HNGR_RCK_FLG AS HNGRRACK," ).append("\n"); 
		query.append(" 		 B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		 (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("		MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("    FROM CTM_MOVEMENT    M," ).append("\n"); 
		query.append("         MST_CONTAINER   C," ).append("\n"); 
		query.append("         BKG_BOOKING     B" ).append("\n"); 
		query.append("#if(${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("   WHERE M.CNMV_EVNT_DT BETWEEN   TO_DATE( @[from], 'YYYYMMDD') + .0 AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("     AND M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("     AND M.CNTR_NO    = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("     AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("    #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("      '$cntrtpszcd'," ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("     AND NVL(C.LSTM_CD, '  ') <> 'SH'" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("     AND NVL(C.LSTM_CD, '  ') = 'SH'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("     AND NVL(M.MVMT_CRE_TP_CD,' ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("     AND M.BKG_NO = B.BKG_NO(+)" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("     AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("     AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                         SELECT   /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                                Y.YD_CD" ).append("\n"); 
		query.append("                           FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                                MDM_LOCATION L," ).append("\n"); 
		query.append("                                MDM_YARD Y" ).append("\n"); 
		query.append("                          WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                            AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                            AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                            AND G.LCC_CD = @[location] /* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                            AND G.ECC_CD = @[location] /* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    /* ----------------> 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("     AND 'XX' = (" ).append("\n"); 
		query.append("                  SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                        MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("                    FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("                   WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("                     AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                         M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("                     AND ROWNUM = 1" ).append("\n"); 
		query.append("                )" ).append("\n"); 
		query.append("    /* <---------------- 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("  SELECT  /*+ INDEX( M XIE6CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("        M.CNMV_CO_CD AS COMPANY," ).append("\n"); 
		query.append("        M.CNTR_NO AS CNTRNO," ).append("\n"); 
		query.append("        M.CNTR_TPSZ_CD AS TPSZ," ).append("\n"); 
		query.append("        'MP' AS MVMT," ).append("\n"); 
		query.append("        M.ORG_YD_CD AS YARD ," ).append("\n"); 
		query.append("        TO_CHAR(M.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI') AS PRE_EVENTDATE," ).append("\n"); 
		query.append("        '' AS POST_EVENTDATE," ).append("\n"); 
		query.append("        M.MVMT_CRE_TP_CD AS AUTOFLAG," ).append("\n"); 
		query.append("        B.SLAN_CD AS LANE," ).append("\n"); 
		query.append("        M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS TVVD," ).append("\n"); 
		query.append("        M.BKG_NO AS BKGNO," ).append("\n"); 
		query.append("        B.POR_CD as POR,  /* POR CODE */" ).append("\n"); 
		query.append("        B.POL_CD AS POL," ).append("\n"); 
		query.append("        B.POD_CD AS POD," ).append("\n"); 
		query.append("        B.DEL_CD AS DEL,  /* DEL CODE */" ).append("\n"); 
		query.append("        M.CNTR_DMG_FLG AS DAMAGE," ).append("\n"); 
		query.append("        M.CNTR_DISP_FLG AS DISPOSAL," ).append("\n"); 
		query.append("        M.IMDT_EXT_FLG AS IMDTEXIT ," ).append("\n"); 
		query.append("        M.CNTR_HNGR_RCK_FLG AS HNGRRACK," ).append("\n"); 
		query.append(" 		B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		(SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("		MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("   FROM CTM_MOVEMENT    M," ).append("\n"); 
		query.append("        MST_CONTAINER   C," ).append("\n"); 
		query.append("        BKG_BOOKING     B" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if(${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("  WHERE M.CNMV_EVNT_DT BETWEEN  TO_DATE( @[from], 'YYYYMMDD') + .0 AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("    AND M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    AND M.CNTR_NO   = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("    AND  M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("    #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("      '$cntrtpszcd'," ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc */" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc  */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    AND NVL(M.MVMT_CRE_TP_CD,' ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("    AND M.CNMV_CYC_NO   = 1" ).append("\n"); 
		query.append("    AND M.BKG_NO = B.BKG_NO(+)" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                        SELECT  /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                               Y.YD_CD" ).append("\n"); 
		query.append("                          FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                               MDM_LOCATION L," ).append("\n"); 
		query.append("                               MDM_YARD Y" ).append("\n"); 
		query.append("                         WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                           AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                           AND G.SCC_CD = @[location]" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                           AND G.LCC_CD = @[location]" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                           AND G.ECC_CD = @[location]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                       )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("  SELECT  /*+ INDEX( M XIE6CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("        M.CNMV_CO_CD AS COMPANY," ).append("\n"); 
		query.append("        M.CNTR_NO AS CNTRNO," ).append("\n"); 
		query.append("        M.CNTR_TPSZ_CD AS TPSZ," ).append("\n"); 
		query.append("        'MR' AS MVMT," ).append("\n"); 
		query.append("        M.ORG_YD_CD AS YARD ," ).append("\n"); 
		query.append("        TO_CHAR(M.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI') AS PRE_EVENTDATE," ).append("\n"); 
		query.append("        '' AS POST_EVENTDATE," ).append("\n"); 
		query.append("        M.MVMT_CRE_TP_CD AS AUTOFLAG," ).append("\n"); 
		query.append("        B.SLAN_CD AS LANE," ).append("\n"); 
		query.append("        M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS TVVD," ).append("\n"); 
		query.append("        M.BKG_NO AS BKGNO," ).append("\n"); 
		query.append("        B.POR_CD as POR,  /* POR CODE */" ).append("\n"); 
		query.append("        B.POL_CD AS POL," ).append("\n"); 
		query.append("        B.POD_CD AS POD," ).append("\n"); 
		query.append("        B.DEL_CD AS DEL,  /* DEL CODE */" ).append("\n"); 
		query.append("        M.CNTR_DMG_FLG AS DAMAGE," ).append("\n"); 
		query.append("        M.CNTR_DISP_FLG AS DISPOSAL," ).append("\n"); 
		query.append("        M.IMDT_EXT_FLG AS IMDTEXIT ," ).append("\n"); 
		query.append("        M.CNTR_HNGR_RCK_FLG AS HNGRRACK," ).append("\n"); 
		query.append(" 		B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		(SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("		MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("   FROM CTM_MOVEMENT      M," ).append("\n"); 
		query.append("        CIM_TP_SZ_DP_SEQ_V  S," ).append("\n"); 
		query.append("        MST_CONTAINER     C," ).append("\n"); 
		query.append("        BKG_BOOKING       B" ).append("\n"); 
		query.append("#if (${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("  WHERE M.CNMV_EVNT_DT BETWEEN  TO_DATE( @[from], 'YYYYMMDD') + .0 AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("    AND M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    AND M.CNTR_TPSZ_CD = S.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("    AND M.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("    AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("    #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("      '$cntrtpszcd'," ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc */" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc  */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("    AND M.BKG_NO = B.BKG_NO(+)" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                        SELECT  /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                               Y.YD_CD" ).append("\n"); 
		query.append("                          FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                               MDM_LOCATION L," ).append("\n"); 
		query.append("                               MDM_YARD Y" ).append("\n"); 
		query.append("                         WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                           AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("     AND G.SCC_CD = @[location]     /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("     AND G.LCC_CD = @[location]   /* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("     AND G.ECC_CD = @[location]   /* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                       )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("      /* ----------------> 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("     AND 'OK' = (" ).append("\n"); 
		query.append("                 SELECT /*+ ORDERED USE_NL(MM LL GG) INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                        DECODE(GG.SCC_CD,@[location],'NO'," ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                        DECODE(GG.LCC_CD,@[location],'NO'," ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                        DECODE(GG.ECC_CD,@[location],'NO'," ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("                        DECODE(MM.ORG_YD_CD,@[location],'NO'," ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                        DECODE(MM.MVMT_STS_CD,'EN','OK'," ).append("\n"); 
		query.append("                        DECODE(MM.MVMT_STS_CD,'TN','OK','NO')))" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                  --    MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("                  FROM CTM_MOVEMENT MM," ).append("\n"); 
		query.append("                       MDM_LOCATION LL," ).append("\n"); 
		query.append("                       MDM_EQ_ORZ_CHT GG" ).append("\n"); 
		query.append("                 WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("                   AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                       M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("                   AND SUBSTR(MM.ORG_YD_CD, 1, 5) = LL.LOC_CD" ).append("\n"); 
		query.append("                   AND LL.SCC_CD  = GG.SCC_CD" ).append("\n"); 
		query.append("                   AND ROWNUM   = 1" ).append("\n"); 
		query.append("                  )" ).append("\n"); 
		query.append("    /* <---------------- 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("  SELECT  /*+ index( m xie6ctm_movement ) */" ).append("\n"); 
		query.append("         M.CNMV_CO_CD AS company," ).append("\n"); 
		query.append("         M.CNTR_NO AS cntrNo," ).append("\n"); 
		query.append("         M.CNTR_TPSZ_CD AS tpsz," ).append("\n"); 
		query.append("         'VD-MT' AS mvmt," ).append("\n"); 
		query.append("         M.ORG_YD_CD AS yard ," ).append("\n"); 
		query.append("         (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                 TO_CHAR(MM.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI')  /*  PRE_MVMT_EVNT_DT */" ).append("\n"); 
		query.append("            FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("           WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("             AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                 M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("             AND MM.MVMT_STS_CD = 'VD'" ).append("\n"); 
		query.append("             AND ROWNUM = 1) AS PRE_EVENTDATE," ).append("\n"); 
		query.append("         TO_CHAR(M.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI') AS POST_EVENTDATE," ).append("\n"); 
		query.append("         M.MVMT_CRE_TP_CD AS autoFlag," ).append("\n"); 
		query.append("         B.SLAN_CD AS lane," ).append("\n"); 
		query.append("         M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS tVvd," ).append("\n"); 
		query.append("         M.BKG_NO AS bkgNo," ).append("\n"); 
		query.append("         B.POR_CD as por, /* POR CODE */" ).append("\n"); 
		query.append("         B.POL_CD AS pol," ).append("\n"); 
		query.append("         B.POD_CD AS pod," ).append("\n"); 
		query.append("         B.DEL_CD AS del, /* DEL CODE */" ).append("\n"); 
		query.append("         M.CNTR_DMG_FLG AS damage," ).append("\n"); 
		query.append("         M.CNTR_DISP_FLG AS disposal," ).append("\n"); 
		query.append("         M.IMDT_EXT_FLG AS imdtExit ," ).append("\n"); 
		query.append("         M.CNTR_HNGR_RCK_FLG AS hngrRack," ).append("\n"); 
		query.append(" 		 B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		 (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("		MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("   FROM CTM_MOVEMENT    M," ).append("\n"); 
		query.append("        MST_CONTAINER   C," ).append("\n"); 
		query.append("        BKG_BOOKING     B" ).append("\n"); 
		query.append("#if(${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("   WHERE M.CNMV_EVNT_DT BETWEEN   TO_DATE( @[from], 'YYYYMMDD') + .0 AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("     AND M.MVMT_STS_CD = 'MT'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("     AND M.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("     AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("    #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("      '$cntrtpszcd'," ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("     AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc  */" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("     AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  --AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("     AND M.BKG_NO   = B.BKG_NO(+)" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("     AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("     AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                         SELECT /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                                Y.YD_CD" ).append("\n"); 
		query.append("                           FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                                MDM_LOCATION L," ).append("\n"); 
		query.append("                                MDM_YARD Y" ).append("\n"); 
		query.append("                          WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                            AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                            AND G.SCC_CD = @[location]    /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                            AND G.LCC_CD = @[location]    /* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                            AND G.ECC_CD = @[location]    /* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                         )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    /* ----------------> 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("     AND 'VD' = (" ).append("\n"); 
		query.append("                  SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                        MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("                    FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("                   WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("                     AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                         M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("                     AND ROWNUM = 1" ).append("\n"); 
		query.append("                )" ).append("\n"); 
		query.append("    /* <---------------- 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif(${mtymvmt} == 'VL')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("  SELECT  /*+ index( m xie6ctm_movement ) */" ).append("\n"); 
		query.append("         M.CNMV_CO_CD AS company," ).append("\n"); 
		query.append("         M.CNTR_NO AS cntrNo," ).append("\n"); 
		query.append("         M.CNTR_TPSZ_CD AS tpsz," ).append("\n"); 
		query.append("         'OC-VL' AS mvmt," ).append("\n"); 
		query.append("         M.ORG_YD_CD AS yard ," ).append("\n"); 
		query.append("        (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                TO_CHAR(MM.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI')  /*  pre_mvmt_evnt_dt */" ).append("\n"); 
		query.append("           FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("          WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("            AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("            AND MM.MVMT_STS_CD = 'OC'" ).append("\n"); 
		query.append("            AND ROWNUM = 1) AS PRE_EVENTDATE," ).append("\n"); 
		query.append("         TO_CHAR(M.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI') AS POST_EVENTDATE," ).append("\n"); 
		query.append("         M.MVMT_CRE_TP_CD AS autoFlag," ).append("\n"); 
		query.append("         B.SLAN_CD AS lane," ).append("\n"); 
		query.append("         M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS tVvd," ).append("\n"); 
		query.append("         M.BKG_NO AS bkgNo," ).append("\n"); 
		query.append("         B.POR_CD as por, /* POR CODE */" ).append("\n"); 
		query.append("         B.POL_CD AS pol," ).append("\n"); 
		query.append("         B.POD_CD AS pod," ).append("\n"); 
		query.append("         B.DEL_CD AS del, /* DEL CODE */" ).append("\n"); 
		query.append("         M.CNTR_DMG_FLG AS damage," ).append("\n"); 
		query.append("         M.CNTR_DISP_FLG AS disposal," ).append("\n"); 
		query.append("         M.IMDT_EXT_FLG AS imdtExit ," ).append("\n"); 
		query.append("         M.CNTR_HNGR_RCK_FLG AS hngrRack," ).append("\n"); 
		query.append(" 		 B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		(SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("		MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("   FROM CTM_MOVEMENT    M," ).append("\n"); 
		query.append("        MST_CONTAINER   C," ).append("\n"); 
		query.append("        BKG_BOOKING     B" ).append("\n"); 
		query.append("#if(${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("  WHERE M.CNMV_EVNT_DT BETWEEN  TO_DATE( @[from], 'YYYYMMDD') + .0" ).append("\n"); 
		query.append("    AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("    AND M.MVMT_STS_CD = 'VL'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    AND M.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("    AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("    #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("      '$cntrtpszcd'," ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc */" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc  */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${mtymvmt} == 'MTIDMG')" ).append("\n"); 
		query.append("    AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    AND M.BKG_NO    = B.BKG_NO(+)" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                        SELECT  /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                              Y.YD_CD" ).append("\n"); 
		query.append("                          FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                               MDM_LOCATION L," ).append("\n"); 
		query.append("                               MDM_YARD Y" ).append("\n"); 
		query.append("                         WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                           AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                           AND G.SCC_CD = @[location]   /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                           AND G.LCC_CD = @[location]   /* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                           AND G.ECC_CD = @[location]   /* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    /* ----------------> 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("    AND 'OC'  = (" ).append("\n"); 
		query.append("                 SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                        MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("                   FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("                  WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("                    AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                        M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("                    AND ROWNUM = 1" ).append("\n"); 
		query.append("                )" ).append("\n"); 
		query.append("    /* <---------------- 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${bound} == 'N')" ).append("\n"); 
		query.append("    AND M.OB_CNTR_FLG = 'N'   /* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("#elseif(${bound} == 'Y')" ).append("\n"); 
		query.append("    AND M.OB_CNTR_FLG = 'Y'   /* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("  SELECT  /*+ index( m xie6ctm_movement ) */" ).append("\n"); 
		query.append("         M.CNMV_CO_CD AS company," ).append("\n"); 
		query.append("         M.CNTR_NO AS cntrNo," ).append("\n"); 
		query.append("         M.CNTR_TPSZ_CD AS tpsz," ).append("\n"); 
		query.append("         'TS-VL' AS mvmt," ).append("\n"); 
		query.append("         M.ORG_YD_CD AS yard ," ).append("\n"); 
		query.append("         (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                 TO_CHAR(MM.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI')  /*  pre_mvmt_evnt_dt */" ).append("\n"); 
		query.append("            FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("           WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("             AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                 M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("             AND MM.MVMT_STS_CD = 'TS'" ).append("\n"); 
		query.append("             AND ROWNUM = 1) AS PRE_EVENTDATE," ).append("\n"); 
		query.append("         TO_CHAR(M.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI') AS POST_EVENTDATE," ).append("\n"); 
		query.append("         M.MVMT_CRE_TP_CD AS autoFlag," ).append("\n"); 
		query.append("         B.SLAN_CD AS lane," ).append("\n"); 
		query.append("         M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS tVvd," ).append("\n"); 
		query.append("         M.BKG_NO AS bkgNo," ).append("\n"); 
		query.append("         B.POR_CD as por, /* POR CODE */" ).append("\n"); 
		query.append("         B.POL_CD AS pol," ).append("\n"); 
		query.append("         B.POD_CD AS pod," ).append("\n"); 
		query.append("         B.DEL_CD AS del, /* DEL CODE */" ).append("\n"); 
		query.append("         M.CNTR_DMG_FLG AS damage," ).append("\n"); 
		query.append("         M.CNTR_DISP_FLG AS disposal," ).append("\n"); 
		query.append("         M.IMDT_EXT_FLG AS imdtExit ," ).append("\n"); 
		query.append("         M.CNTR_HNGR_RCK_FLG AS hngrRack," ).append("\n"); 
		query.append(" 		 B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		 (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("		MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("   FROM CTM_MOVEMENT    M," ).append("\n"); 
		query.append("        MST_CONTAINER   C," ).append("\n"); 
		query.append("        BKG_BOOKING     B" ).append("\n"); 
		query.append("#if(${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("  WHERE M.CNMV_EVNT_DT BETWEEN  TO_DATE( @[from], 'YYYYMMDD') + .0" ).append("\n"); 
		query.append("    AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("    AND M.MVMT_STS_CD = 'VL'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    AND M.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("    AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("    #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("      '$cntrtpszcd'," ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc */" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc  */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${mtymvmt} == 'MTIDMG')" ).append("\n"); 
		query.append("    AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    AND M.BKG_NO    = B.BKG_NO(+)" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                        SELECT /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                               Y.YD_CD" ).append("\n"); 
		query.append("                          FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                               MDM_LOCATION L," ).append("\n"); 
		query.append("                               MDM_YARD Y" ).append("\n"); 
		query.append("                         WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                           AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                           AND G.SCC_CD = @[location]     /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                           AND G.LCC_CD = @[location]   /* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                           AND G.ECC_CD = @[location]   /* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                       )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    /* ----------------> 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("    AND 'TS'  = (" ).append("\n"); 
		query.append("                 SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                        MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("                  FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("                 WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("                   AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                       M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("                   AND ROWNUM = 1" ).append("\n"); 
		query.append("                )" ).append("\n"); 
		query.append("    /* <---------------- 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${bound} == 'N')" ).append("\n"); 
		query.append("    AND M.OB_CNTR_FLG = 'N'   /* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("#elseif(${bound} == 'Y')" ).append("\n"); 
		query.append("    AND M.OB_CNTR_FLG = 'Y'   /* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#elseif(${mtymvmt} == 'VD')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("  SELECT /*+ index( m xie6ctm_movement ) */" ).append("\n"); 
		query.append("        M.CNMV_CO_CD AS company," ).append("\n"); 
		query.append("        M.CNTR_NO AS cntrNo," ).append("\n"); 
		query.append("        M.CNTR_TPSZ_CD AS tpsz," ).append("\n"); 
		query.append("        'VD-IC' AS mvmt," ).append("\n"); 
		query.append("        M.ORG_YD_CD AS yard ," ).append("\n"); 
		query.append("        (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                    TO_CHAR(MM.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI')  /*  pre_mvmt_evnt_dt */" ).append("\n"); 
		query.append("             FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("             WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("               AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                     M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("               AND MM.MVMT_STS_CD = 'VD'" ).append("\n"); 
		query.append("               AND ROWNUM = 1) AS PRE_EVENTDATE," ).append("\n"); 
		query.append("        TO_CHAR(M.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI') AS POST_EVENTDATE," ).append("\n"); 
		query.append("        M.MVMT_CRE_TP_CD AS autoFlag," ).append("\n"); 
		query.append("        B.SLAN_CD AS lane," ).append("\n"); 
		query.append("        M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS tVvd," ).append("\n"); 
		query.append("        M.BKG_NO AS bkgNo," ).append("\n"); 
		query.append("        B.POR_CD as por,  /* POR CODE */" ).append("\n"); 
		query.append("        B.POL_CD AS pol," ).append("\n"); 
		query.append("        B.POD_CD AS pod," ).append("\n"); 
		query.append("        B.DEL_CD AS del,  /* DEL CODE */" ).append("\n"); 
		query.append("        M.CNTR_DMG_FLG AS damage," ).append("\n"); 
		query.append("        M.CNTR_DISP_FLG AS disposal," ).append("\n"); 
		query.append("        M.IMDT_EXT_FLG AS imdtExit ," ).append("\n"); 
		query.append("        M.CNTR_HNGR_RCK_FLG AS hngrRack," ).append("\n"); 
		query.append(" 		B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		(SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("		MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("   FROM CTM_MOVEMENT    M," ).append("\n"); 
		query.append("        MST_CONTAINER   C," ).append("\n"); 
		query.append("        BKG_BOOKING     B" ).append("\n"); 
		query.append("#if(${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("  WHERE M.CNMV_EVNT_DT BETWEEN  TO_DATE( @[from], 'YYYYMMDD') + .0 AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("    AND M.MVMT_STS_CD = 'IC'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    AND M.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("    AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("    #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("      '$cntrtpszcd'," ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc */" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc  */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${mtymvmt} == 'MTIDMG')" ).append("\n"); 
		query.append("    AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    AND M.BKG_NO    = B.BKG_NO(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                        SELECT /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                               Y.YD_CD" ).append("\n"); 
		query.append("                          FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                               MDM_LOCATION L," ).append("\n"); 
		query.append("                               MDM_YARD Y" ).append("\n"); 
		query.append("                         WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                           AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                           AND G.SCC_CD = @[location]     /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                           AND G.LCC_CD = @[location]   /* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                           AND G.ECC_CD = @[location]   /* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                      )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    /* ----------------> 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("    AND 'VD'  = (" ).append("\n"); 
		query.append("                  SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                        MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("                    FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("                   WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("                     AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                         M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("                     AND ROWNUM = 1" ).append("\n"); 
		query.append("                )" ).append("\n"); 
		query.append("    /* <---------------- 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${bound} == 'N')" ).append("\n"); 
		query.append("    AND M.OB_CNTR_FLG = 'N'   /* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("#elseif(${bound} == 'Y')" ).append("\n"); 
		query.append("    AND M.OB_CNTR_FLG = 'Y'   /* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("  SELECT  /*+ index( m xie6ctm_movement ) */" ).append("\n"); 
		query.append("        M.CNMV_CO_CD AS company," ).append("\n"); 
		query.append("        M.CNTR_NO AS cntrNo," ).append("\n"); 
		query.append("        M.CNTR_TPSZ_CD AS tpsz," ).append("\n"); 
		query.append("        'VD-TS' AS mvmt," ).append("\n"); 
		query.append("        M.ORG_YD_CD AS yard ," ).append("\n"); 
		query.append("        (SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                TO_CHAR(MM.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI')  /*  pre_mvmt_evnt_dt */" ).append("\n"); 
		query.append("           FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("          WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("            AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("            AND MM.MVMT_STS_CD = 'VD'" ).append("\n"); 
		query.append("            AND ROWNUM = 1) AS PRE_EVENTDATE," ).append("\n"); 
		query.append("        TO_CHAR(M.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI') AS POST_EVENTDATE," ).append("\n"); 
		query.append("        M.MVMT_CRE_TP_CD AS autoFlag," ).append("\n"); 
		query.append("        B.SLAN_CD AS lane," ).append("\n"); 
		query.append("        M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS tVvd," ).append("\n"); 
		query.append("        M.BKG_NO AS bkgNo," ).append("\n"); 
		query.append("        B.POR_CD as por,  /* POR CODE */" ).append("\n"); 
		query.append("        B.POL_CD AS pol," ).append("\n"); 
		query.append("        B.POD_CD AS pod," ).append("\n"); 
		query.append("        B.DEL_CD AS del,  /* DEL CODE */" ).append("\n"); 
		query.append("        M.CNTR_DMG_FLG AS damage," ).append("\n"); 
		query.append("        M.CNTR_DISP_FLG AS disposal," ).append("\n"); 
		query.append("        M.IMDT_EXT_FLG AS imdtExit ," ).append("\n"); 
		query.append("        M.CNTR_HNGR_RCK_FLG AS hngrRack," ).append("\n"); 
		query.append(" 		B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		(SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("		MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("   FROM CTM_MOVEMENT    M," ).append("\n"); 
		query.append("        MST_CONTAINER   C," ).append("\n"); 
		query.append("        BKG_BOOKING     B" ).append("\n"); 
		query.append("#if(${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("  WHERE M.CNMV_EVNT_DT BETWEEN  TO_DATE( @[from], 'YYYYMMDD') + .0 AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("    AND M.MVMT_STS_CD = 'TS'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    AND M.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("    AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("    #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("      '$cntrtpszcd'," ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc */" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc  */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${mtymvmt} == 'MTIDMG')" ).append("\n"); 
		query.append("    AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    AND M.BKG_NO    = B.BKG_NO(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                        SELECT /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                               Y.YD_CD" ).append("\n"); 
		query.append("                          FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                               MDM_LOCATION L," ).append("\n"); 
		query.append("                               MDM_YARD Y" ).append("\n"); 
		query.append("                         WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                           AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                           AND G.SCC_CD = @[location]     /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                           AND G.LCC_CD = @[location]   /* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                           AND G.ECC_CD = @[location]   /* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                        )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    /* ----------------> 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("    AND 'VD'  = (" ).append("\n"); 
		query.append("                 SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */" ).append("\n"); 
		query.append("                        MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */" ).append("\n"); 
		query.append("                   FROM CTM_MOVEMENT MM" ).append("\n"); 
		query.append("                  WHERE MM.CNTR_NO = M.CNTR_NO" ).append("\n"); 
		query.append("                    AND MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <" ).append("\n"); 
		query.append("                        M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO" ).append("\n"); 
		query.append("                    AND ROWNUM = 1" ).append("\n"); 
		query.append("                )" ).append("\n"); 
		query.append("    /* <---------------- 2010.05.13 Pre MVMT STS Check Logic ??????????????????????????????????????????????????????????????????????????? */" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("  #if (${bound} == 'N')" ).append("\n"); 
		query.append("    AND M.OB_CNTR_FLG = 'N'   /* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("  #elseif(${bound} == 'Y')" ).append("\n"); 
		query.append("    AND M.OB_CNTR_FLG = 'Y'   /* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("  SELECT  /*+ index( m xie6ctm_movement ) */" ).append("\n"); 
		query.append("        M.CNMV_CO_CD AS company," ).append("\n"); 
		query.append("        M.CNTR_NO AS cntrNo," ).append("\n"); 
		query.append("        M.CNTR_TPSZ_CD AS tpsz," ).append("\n"); 
		query.append("        SUBSTR(@[mtymvmt],0,2) AS mvmt," ).append("\n"); 
		query.append("        M.ORG_YD_CD AS yard ," ).append("\n"); 
		query.append("        TO_CHAR(M.CNMV_EVNT_DT,'YYYY-MM-DD HH24:MI') AS PRE_EVENTDATE," ).append("\n"); 
		query.append("        '' AS POST_EVENTDATE," ).append("\n"); 
		query.append("        M.MVMT_CRE_TP_CD AS autoFlag," ).append("\n"); 
		query.append("        B.SLAN_CD AS lane," ).append("\n"); 
		query.append("        M.TRNK_VSL_CD||M.TRNK_SKD_VOY_NO||M.TRNK_SKD_DIR_CD AS tVvd," ).append("\n"); 
		query.append("        M.BKG_NO AS bkgNo," ).append("\n"); 
		query.append("        B.POR_CD AS por,  /* POR CODE */" ).append("\n"); 
		query.append("        B.POL_CD AS pol," ).append("\n"); 
		query.append("        B.POD_CD AS pod," ).append("\n"); 
		query.append("        B.DEL_CD AS del,  /* DEL CODE */" ).append("\n"); 
		query.append("        M.CNTR_DMG_FLG AS damage," ).append("\n"); 
		query.append("        M.CNTR_DISP_FLG AS disposal," ).append("\n"); 
		query.append("        M.IMDT_EXT_FLG AS imdtExit ," ).append("\n"); 
		query.append("        M.CNTR_HNGR_RCK_FLG AS hngrRack," ).append("\n"); 
		query.append(" 		B.SC_NO||' '||B.RFA_NO||' '||B.TAA_NO  SC_RFA_NO_TAA," ).append("\n"); 
		query.append("		(SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  SHPR" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("          WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("            AND    C.BKG_CUST_TP_CD = 'S'" ).append("\n"); 
		query.append("        ) SHPR," ).append("\n"); 
		query.append("        (SELECT REPLACE(REPLACE(SUBSTR(C.CUST_NM,1,50),CHR(13)||CHR(10),' '), CHR(10), ' ')  CNEE" ).append("\n"); 
		query.append("           FROM   BKG_CUSTOMER C" ).append("\n"); 
		query.append("           WHERE  B.BKG_NO         = C.BKG_NO" ).append("\n"); 
		query.append("           AND    C.BKG_CUST_TP_CD = 'C'" ).append("\n"); 
		query.append("        ) CNEE," ).append("\n"); 
		query.append("		MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'FLG') AS DMG_FLG_DT, " ).append("\n"); 
		query.append("        MST_COMMON_PKG.MST_DMG_DT_GET_FNC(C.CNTR_NO, 'UNFLG') AS DMG_UNFLG_DT" ).append("\n"); 
		query.append("   FROM CTM_MOVEMENT    M," ).append("\n"); 
		query.append("        MST_CONTAINER   C," ).append("\n"); 
		query.append("        BKG_BOOKING     B" ).append("\n"); 
		query.append("#if(${period} == 'D' || ${period} == 'M')" ).append("\n"); 
		query.append("  WHERE M.CNMV_EVNT_DT BETWEEN  TO_DATE( @[from], 'YYYYMMDD') + .0 AND TO_DATE( @[to], 'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	  WHERE M.CNMV_EVNT_DT	BETWEEN	( " ).append("\n"); 
		query.append("							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0" ).append("\n"); 
		query.append("							FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							WHERE  K.PLN_YR||K.PLN_WK = @[from]" ).append("\n"); 
		query.append("							)	" ).append("\n"); 
		query.append("			AND				( " ).append("\n"); 
		query.append("							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999" ).append("\n"); 
		query.append("							 FROM   EQR_WK_PRD k" ).append("\n"); 
		query.append("							 WHERE  K.PLN_YR||K.PLN_WK = @[to]" ).append("\n"); 
		query.append("							) " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${mtymvmt} != '')" ).append("\n"); 
		query.append("    AND M.MVMT_STS_CD = SUBSTR(@[mtymvmt],0,2)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${mtymvmt} == 'ENF' || ${mtymvmt} == 'TNF' || ${mtymvmt} == 'ENM' || ${mtymvmt} == 'TNM')" ).append("\n"); 
		query.append(" #if (${mtymvmt} == 'ENF' || ${mtymvmt} == 'TNF')" ).append("\n"); 
		query.append("    AND M.FCNTR_FLG = 'Y'" ).append("\n"); 
		query.append(" #else" ).append("\n"); 
		query.append("    AND M.FCNTR_FLG = 'N'" ).append("\n"); 
		query.append(" #end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    AND M.CNTR_NO = C.CNTR_NO" ).append("\n"); 
		query.append("#if (${tpsz} != '')" ).append("\n"); 
		query.append("    AND M.CNTR_TPSZ_CD  IN (" ).append("\n"); 
		query.append("    #foreach($cntrtpszcd in ${vel_tpsz_cd})" ).append("\n"); 
		query.append("      '$cntrtpszcd'," ).append("\n"); 
		query.append("      #end" ).append("\n"); 
		query.append("      '')" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${soc} == 'E')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') <> 'SH' /* soc */" ).append("\n"); 
		query.append("#elseif(${soc} == 'O')" ).append("\n"); 
		query.append("    AND NVL(C.LSTM_CD, '  ') = 'SH' /* soc  */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("  --AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' )" ).append("\n"); 
		query.append("    AND M.BKG_NO    = B.BKG_NO(+)" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'Y')" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD = @[location]" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("    AND M.ORG_YD_CD IN (" ).append("\n"); 
		query.append("                        SELECT /*+ ORDERED USE_NL( G L Y )  */" ).append("\n"); 
		query.append("                               Y.YD_CD" ).append("\n"); 
		query.append("                          FROM MDM_EQ_ORZ_CHT G," ).append("\n"); 
		query.append("                               MDM_LOCATION L," ).append("\n"); 
		query.append("                               MDM_YARD Y" ).append("\n"); 
		query.append("                         WHERE Y.LOC_CD = L.LOC_CD" ).append("\n"); 
		query.append("                           AND L.SCC_CD = G.SCC_CD" ).append("\n"); 
		query.append("#if (${inquiryLevel} == 'S')" ).append("\n"); 
		query.append("                           AND G.SCC_CD = @[location]    /* inquiryLevel = 'SCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'L')" ).append("\n"); 
		query.append("                           AND G.LCC_CD = @[location]    /* inquiryLevel = 'LCC'*/" ).append("\n"); 
		query.append("#elseif(${inquiryLevel} == 'E')" ).append("\n"); 
		query.append("                           AND G.ECC_CD = @[location]    /* inquiryLevel = 'ECC'*/" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                       )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${bound} == 'N')" ).append("\n"); 
		query.append("    AND M.OB_CNTR_FLG = 'N'   /* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("#elseif(${bound} == 'Y')" ).append("\n"); 
		query.append("    AND M.OB_CNTR_FLG = 'Y'   /* 'N':Inbound, 'Y':Outbound */" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 

	}
}