<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="InvoiceIssueCollectionMgtDBDAOSearchInvoiceInterfaceARByDetailRSQL">
			<desc><![CDATA[searchInvoiceInterfaceARByDetail]]></desc>
			<sql><![CDATA[
SELECT   M.DMDT_INV_NO
		,M.DMDT_AR_IF_CD
		,ROUND (NVL(GLOBALDATE_PKG.TIME_LOCAL_OFC_FNC(@[session_ofc_cd]),SYSDATE) 
				- M.CRE_DT) AS OVER_DAYS
		,M.INV_CURR_CD
        ,M.INV_CHG_AMT
        ,M.TAX_AMT
        ,M.INV_AMT
        ,M.DMDT_TRF_CD
        ,M.BL_NO
        ,M.BKG_NO
 		,M.CR_INV_NO
		,SUBSTR(M.DMDT_INV_NO,3,1) AS DMDT_SUB_INV_NO
		,DMDT_INV_STS_CD
    FROM DMT_INV_MN M
   WHERE M.CRE_OFC_CD = @[ofc_cd]
     
#if (${dmdt_trf_cd} != '') 
     AND M.DMDT_TRF_CD IN (
        #foreach( $trf_cd in ${trf_cd_list} )
            #if($velocityCount < $trf_cd_list.size()) '$trf_cd', #else '$trf_cd' #end
        #end
        ) 
#end   
     
     AND (   M.DMDT_AR_IF_CD = 'N'
          OR M.DMDT_AR_IF_CD = DECODE (@[chk_hold]
                                      ,'Y', 'H'
                                      ,'N'
                                      )
         )
--선택 조회 1: DATE 일 경우
#if (${cond_type} == 'date')         
     AND M.CRE_DT BETWEEN TO_DATE (@[fm_dt], 'yyyymmdd')
                      AND TO_DATE (@[to_dt], 'yyyymmdd')
                          + 0.99999
#end
 
--선택 조회 2: INV 종류를 선택 했을 경우
#if (${cond_type} == 'inv')
	#if (${inv_no} != '')
	AND M.DMDT_INV_NO IN (
		#foreach( $inv_cd in ${inv_no_list} )
			#if($velocityCount < $inv_no_list.size()) '$inv_cd', #else '$inv_cd' #end
		#end
		)
	#end
	
	#if (${bkg_no} != '')	
	AND M.BKG_NO IN (
		#foreach( $bkg_cd in ${bkg_no_list} )
			#if($velocityCount < $bkg_no_list.size()) '$bkg_cd', #else '$bkg_cd' #end
		#end
		)
	#end

	#if (${bl_no} != '')
	AND M.BL_NO IN (
		#foreach( $bl_cd in ${bl_no_list} )
			#if($velocityCount < $bl_no_list.size()) '$bl_cd', #else '$bl_cd' #end
		#end
		)
	#end
#end          
     AND ( (M.DMDT_INV_STS_CD = 'I') OR (M.DMDT_INV_STS_CD = 'C' AND CR_INV_NO IS NOT NULL))
#if (${sh_cust_cd} != '')     
	 AND DECODE (M.ACT_PAYR_CNT_CD
                ,'00', ''
                ,M.ACT_PAYR_CNT_CD
                )
         || TO_CHAR (M.ACT_PAYR_SEQ, 'FM000000') = @[sh_cust_cd]
#end                                      

	 AND M.INV_CURR_CD = @[sh_inv_curr_cd] 
ORDER BY 1 ASC			]]></sql>
			<params>
				<param name="session_ofc_cd" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="chk_hold" type="12" value="" out="N"/>
				<param name="fm_dt" type="12" value="" out="N"/>
				<param name="to_dt" type="12" value="" out="N"/>
				<param name="sh_cust_cd" type="12" value="" out="N"/>
				<param name="sh_inv_curr_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
