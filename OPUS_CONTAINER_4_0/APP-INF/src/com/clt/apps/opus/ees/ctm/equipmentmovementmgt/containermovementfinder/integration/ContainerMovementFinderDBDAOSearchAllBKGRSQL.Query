<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ContainerMovementFinderDBDAOSearchAllBKGRSQL">
			<desc><![CDATA[SearchAllBKG]]></desc>
			<sql><![CDATA[
SELECT B.BKG_CGO_TP_CD,
    B.BKG_NO,
    B.BL_NO,
    E.REPO_PLN_ID,
    B.VSL_CD||B.SKD_VOY_NO||B.SKD_DIR_CD AS VVD,
    B.POL_CD,
    NVL(B.POL_ETD_DT, E.FM_ETD_DT) AS ETD_DT,
    B.POD_CD,
    NVL(B.POD_ETA_DT, E.TO_DT) AS ETA_DT
FROM BKG_BOOKING B, (SELECT REPO_PLN_ID,
                            MTY_BKG_NO,
                            FM_ETD_DT,
                            TO_ETB_DT AS TO_DT
                     FROM EQR_VSL_LODG_DCHG_EXE_PLN
                     UNION
                     SELECT REPO_PLN_ID,
                            MTY_BKG_NO,
                            FM_ETD_DT,
                            TO_ETA_DT AS TO_DT
                     FROM EQR_INLND_TRSP_EXE_PLN) E
WHERE B.BKG_NO = E.MTY_BKG_NO(+)
#if (${etd_eta} == 'D')
AND TO_CHAR(NVL(B.POL_ETD_DT, E.FM_ETD_DT), 'YYYYMMDD') BETWEEN REPLACE (@[p_date1], '-', '') AND REPLACE (@[p_date2], '-', '')
#else
AND TO_CHAR(NVL(B.POD_ETA_DT, E.TO_DT), 'YYYYMMDD') BETWEEN REPLACE (@[p_date1], '-', '') AND REPLACE (@[p_date2], '-', '')
#end
#if (${fm_ecc_cd} != '')
AND POL_CD IN (SELECT L.LOC_CD
                FROM MDM_LOCATION L, MDM_EQ_ORZ_CHT E
                WHERE L.SCC_CD = E.SCC_CD
                AND E.ECC_CD = @[fm_ecc_cd])
#end
#if (${to_ecc_cd} != '')
AND POD_CD IN (SELECT L.LOC_CD
                FROM MDM_LOCATION L, MDM_EQ_ORZ_CHT E
                WHERE L.SCC_CD = E.SCC_CD
                AND E.ECC_CD = @[to_ecc_cd])
#end
#if (${fm_loc_cd} != '')
AND POL_CD = @[fm_loc_cd]
#end
#if (${to_loc_cd} != '')
AND POD_CD = @[to_loc_cd]
#end
#if (${cgo_tp_cd} != 'A')
AND BKG_CGO_TP_CD = @[cgo_tp_cd]
#end
#if (${etd_eta} == 'D')
ORDER BY NVL(B.POL_ETD_DT, E.FM_ETD_DT)
#else
ORDER BY NVL(B.POD_ETA_DT, E.TO_DT)
#end			]]></sql>
			<params>
				<param name="p_date1" type="12" value="" out="N"/>
				<param name="p_date2" type="12" value="" out="N"/>
				<param name="fm_ecc_cd" type="12" value="" out="N"/>
				<param name="to_ecc_cd" type="12" value="" out="N"/>
				<param name="fm_loc_cd" type="12" value="" out="N"/>
				<param name="to_loc_cd" type="12" value="" out="N"/>
				<param name="cgo_tp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
