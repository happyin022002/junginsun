<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RepairMgtDBDAOsearchRepairRqstRefNoDataRSQL">
			<desc><![CDATA[searchRepairRqstRefNoData]]></desc>
			<sql><![CDATA[
SELECT @[rqst_ref_no] || '-' || TO_CHAR(SYSDATE, 'YYYYMM') || '-' || 
              DECODE(LENGTH(P.RQST_REF_NO),1,'000'||P.RQST_REF_NO,
              DECODE(LENGTH(P.RQST_REF_NO),2,'00'||P.RQST_REF_NO,
              DECODE(LENGTH(P.RQST_REF_NO),3,'0'||P.RQST_REF_NO, 
              P.RQST_REF_NO))) AS RQST_REF_NO
FROM (  
  SELECT NVL(MAX(TO_NUMBER(SUBSTRB(RQST_REF_NO,LENGTH(RQST_REF_NO)-3,LENGTH(RQST_REF_NO)))) + 1,1) AS RQST_REF_NO
  FROM MNR_RPR_RQST_HDR
  WHERE RQST_REF_NO LIKE @[rqst_ref_no] || '-' || TO_CHAR(SYSDATE, 'YYYYMM') || '-' || '%'
) P			]]></sql>
			<params>
				<param name="rqst_ref_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
