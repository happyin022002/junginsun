<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="MTYRepositionPerformanceAnalysisDBDAOMTYMonthlyWeeklyTrendSetVORSQL">
			<desc><![CDATA[   ]]></desc>
			<sql><![CDATA[
#if (${mtymvmt} == 'MTIDMG' || ${mtymvmt} == 'MTVDVD-MT' || ${mtymvmt} == 'MTOPOP-MT' || ${mtymvmt} == 'VLMTMT-VL' || ${mtymvmt} == 'MTOCOC-MT' || ${mtymvmt} == 'OCIDID-OC')
SELECT	
		L.CNTR_TPSZ_CD AS inout,
		L.MOV_STS as division,
		SUM(CNT) AS total,
 		SUM( DECODE( L.WK_SEQ,  1, CNT ,0) )   AS count01,
		SUM( DECODE( L.WK_SEQ,  2, CNT ,0) )   AS count02,
		SUM( DECODE( L.WK_SEQ,  3, CNT ,0) )   AS count03,
		SUM( DECODE( L.WK_SEQ,  4, CNT ,0) )   AS count04,
		SUM( DECODE( L.WK_SEQ,  5, CNT ,0) )   AS count05,
		SUM( DECODE( L.WK_SEQ,  6, CNT ,0) )   AS count06,
		SUM( DECODE( L.WK_SEQ,  7, CNT ,0) )   AS count07,
		SUM( DECODE( L.WK_SEQ,  8, CNT ,0) )   AS count08,
		SUM( DECODE( L.WK_SEQ,  9, CNT ,0) )   AS count09, 
		SUM( DECODE( L.WK_SEQ, 10, CNT ,0) )   AS count10,
		SUM( DECODE( L.WK_SEQ, 11, CNT ,0) )   AS count11,
		SUM( DECODE( L.WK_SEQ, 12, CNT ,0) )   AS count12

FROM	(
	SELECT	/*+ ORDERED USE_NL ( A S ) */
			SUBSTR(@[mtymvmt],5)		MOV_STS,
			S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
			S.DP_SEQ				DSP_SEQ,
			A.WK_SEQ				WK_SEQ,
			A.CNT	                CNT
	FROM	(

			SELECT 	/*+ INDEX( M XIE6CTM_MOVEMENT ) */
				SUBSTR(@[mtymvmt],5)	MOV_STS,
				M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
				W.WK_SEQ		WK_SEQ,
				COUNT(M.MVMT_STS_CD)	CNT
			FROM    CTM_MOVEMENT        M,
					#if (${period} == 'W')
					EQR_WK_PRD			K,
					#end
					MST_CONTAINER		C,
					(
					#if (${period} == 'W')
					SELECT  /*+ INDEX ( XPKEQR_WK_PRD ) */ 
							PLN_YR||PLN_WK     DAY_UNIT,
							ROWNUM             WK_SEQ
					FROM    EQR_WK_PRD
					WHERE   PLN_YR||PLN_WK >= @[from]
					AND     PLN_YR||PLN_WK <= @[to]
					#elseif (${period} == 'M') 
						SELECT DAY_UNIT    DAY_UNIT,
							   ROWNUM      WK_SEQ
						FROM   (          	
									SELECT  DISTINCT PLN_YR||PLN_MON  DAY_UNIT     
									FROM    EQR_WK_PRD
									WHERE   PLN_YR||PLN_MON >= SUBSTR(@[from],0,6)
									AND     PLN_YR||PLN_MON <= SUBSTR(@[to],0,6)
									ORDER BY PLN_YR||PLN_MON
							   )
					#end
					)	W                
			#if (${period} == 'W')
			WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD k
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD k
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
			#elseif (${period} == 'M') 
    			WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  		AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
			#end

			#if (${period} == 'W')
			AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
			                                             AND 	K.WK_END_DT 	
			AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
			#elseif (${period} == 'M') 
			AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
			#end
			#if (${mtymvmt} != '') 
			AND 	M.MVMT_STS_CD = SUBSTR(@[mtymvmt],0,2)
			#end 
	
			#if (${tpsz} != '') 
				AND  M.CNTR_TPSZ_CD  IN ( 
				#foreach($cntrtpszcd in ${vel_tpsz_cd})  
					'$cntrtpszcd',  
					#end  
					'') 
			#end 
			#if (${mtymvmt} == 'MTIDMG')
      		AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
			#end
			
			#if (${inquiryLevel} == 'Y')
			AND M.ORG_YD_CD = @[location]
			#else
			AND M.ORG_YD_CD IN (
        				SELECT 	/*+ ORDERED USE_NL( G L Y )  */
								Y.YD_CD
        				FROM 
          						MDM_EQ_ORZ_CHT G,
          						MDM_LOCATION L,
								MDM_YARD Y
						WHERE Y.LOC_CD = L.LOC_CD
						AND L.SCC_CD = G.SCC_CD
						#if (${inquiryLevel} == 'S')
						AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
						#elseif(${inquiryLevel} == 'L')
						AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
						#elseif(${inquiryLevel} == 'E')
						AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
						#end
					   ) 
			#end			
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic 수정 */
		AND		SUBSTR(@[mtymvmt],3,2)	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic 수정 */		
			
      AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	

			GROUP BY
				M.CNTR_TPSZ_CD,SUBSTR(@[mtymvmt],5),					
				W.WK_SEQ)A,CIM_TP_SZ_DP_SEQ_V S
	WHERE A.CNTR_TPSZ_CD = S.CNTR_TPSZ_CD

		)	L
GROUP BY 
			L.CNTR_TPSZ_CD,
			L.MOV_STS,
			L.DSP_SEQ
ORDER BY 	L.DSP_SEQ
#elseif(${mtymvmt} == 'MP')
SELECT	
		L.CNTR_TPSZ_CD inout,
		L.MOV_STS division,
		SUM(CNT) AS total,
 		SUM( DECODE( L.WK_SEQ,  1, CNT ,0) )   AS count01,
		SUM( DECODE( L.WK_SEQ,  2, CNT ,0) )   AS count02,
		SUM( DECODE( L.WK_SEQ,  3, CNT ,0) )   AS count03,
		SUM( DECODE( L.WK_SEQ,  4, CNT ,0) )   AS count04,
		SUM( DECODE( L.WK_SEQ,  5, CNT ,0) )   AS count05,
		SUM( DECODE( L.WK_SEQ,  6, CNT ,0) )   AS count06,
		SUM( DECODE( L.WK_SEQ,  7, CNT ,0) )   AS count07,
		SUM( DECODE( L.WK_SEQ,  8, CNT ,0) )   AS count08,
		SUM( DECODE( L.WK_SEQ,  9, CNT ,0) )   AS count09,
		SUM( DECODE( L.WK_SEQ, 10, CNT ,0) )   AS count10,
		SUM( DECODE( L.WK_SEQ, 11, CNT ,0) )   AS count11,
		SUM( DECODE( L.WK_SEQ, 12, CNT ,0) )   AS count12

FROM	(
	SELECT	/*+ ORDERED USE_NL ( A S ) */
			'MP'					MOV_STS,
			S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
			S.DP_SEQ				DSP_SEQ,
			A.WK_SEQ				WK_SEQ,
			A.CNT	                CNT
	FROM	(

			SELECT 	/*+ INDEX( M XIE6CTM_MOVEMENT ) */
					'MP'					MOV_STS,
					M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
					W.WK_SEQ				WK_SEQ,
					COUNT(M.MVMT_STS_CD)	CNT
			FROM    CTM_MOVEMENT        M,
					#if (${period} == 'W')
					EQR_WK_PRD			K,
					#end
					MST_CONTAINER		C,
		(
	#if (${period} == 'W')
	SELECT  /*+ INDEX ( XPKEQR_WK_PRD ) */ 
			PLN_YR||PLN_WK     DAY_UNIT,
			ROWNUM             WK_SEQ
	FROM    EQR_WK_PRD
	WHERE   PLN_YR||PLN_WK >= @[from]
	AND     PLN_YR||PLN_WK <= @[to]
	#elseif (${period} == 'M') 
		SELECT DAY_UNIT    DAY_UNIT,
			   ROWNUM      WK_SEQ
		FROM   (          	
					SELECT  DISTINCT PLN_YR||PLN_MON  DAY_UNIT     
					FROM    EQR_WK_PRD
					WHERE   PLN_YR||PLN_MON >= SUBSTR(@[from],0,6)
					AND     PLN_YR||PLN_MON <= SUBSTR(@[to],0,6)
					ORDER BY PLN_YR||PLN_MON
			   )
	#end
	)	W                
	#if (${period} == 'W')
	WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
					SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
					FROM   EQR_WK_PRD k
					WHERE  K.PLN_YR||K.PLN_WK = @[from]
					)	
	AND				( 
					 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
					 FROM   EQR_WK_PRD k
					 WHERE  K.PLN_YR||K.PLN_WK = @[to]
					) 
	#elseif (${period} == 'M') 
	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end

	#if (${period} == 'W')
	AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
						     AND 	K.WK_END_DT 	
	
	AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
	#elseif (${period} == 'M') 
	AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
	#end
	#if (${mtymvmt} != '') 
	AND 	M.MVMT_STS_CD = 'MT'
	#end 
	AND 	M.CNTR_NO = C.CNTR_NO
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end
      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] 		/* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#end
          ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic 수정 */
		AND		'XX'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic 수정 */		

		 GROUP BY M.CNTR_TPSZ_CD, 'MP', W.WK_SEQ 
        UNION ALL
	SELECT 	/*+ INDEX( M XIE6CTM_MOVEMENT ) */
			'MP'					MOV_STS,
			M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
			W.WK_SEQ				WK_SEQ,
			COUNT(M.MVMT_STS_CD)	CNT      
	FROM	CTM_MOVEMENT M,
			#if (${period} == 'W')
			EQR_WK_PRD   K,
			#end
			MST_CONTAINER C,
		(
	#if (${period} == 'W')
	SELECT  /*+ INDEX ( XPKEQR_WK_PRD ) */ 
			PLN_YR||PLN_WK     DAY_UNIT,
			ROWNUM             WK_SEQ
	FROM    EQR_WK_PRD
	WHERE   PLN_YR||PLN_WK >= @[from]
	AND     PLN_YR||PLN_WK <= @[to]
	#elseif (${period} == 'M') 
		SELECT DAY_UNIT    DAY_UNIT,
			   ROWNUM      WK_SEQ
		FROM   (          	
					SELECT  DISTINCT PLN_YR||PLN_MON  DAY_UNIT     
					FROM    EQR_WK_PRD
					WHERE   PLN_YR||PLN_MON >= SUBSTR(@[from],0,6)
					AND     PLN_YR||PLN_MON <= SUBSTR(@[to],0,6)
					ORDER BY PLN_YR||PLN_MON
			   )
	#end
	)	W                
	#if (${period} == 'W')
	WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
					SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
					FROM   EQR_WK_PRD k
					WHERE  K.PLN_YR||K.PLN_WK = @[from]
					)	
	AND				( 
					 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
					 FROM   EQR_WK_PRD k
					 WHERE  K.PLN_YR||K.PLN_WK = @[to]
					) 
	#elseif (${period} == 'M') 
	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end

	#if (${period} == 'W')
	AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
						     AND 	K.WK_END_DT 	
	AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
	#elseif (${period} == 'M') 
	AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
	#end
	
	#if (${mtymvmt} != '') 
		AND 	M.MVMT_STS_CD = 'MT'
	#end 
		AND 	M.CNTR_NO = C.CNTR_NO
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
	  #if (${soc} == 'E')
		AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
	  	AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end
		AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
		AND M.CNMV_CYC_NO = 1 
	  #if (${inquiryLevel} == 'Y')
		AND M.ORG_YD_CD = @[location]
	  #else
		AND M.ORG_YD_CD IN (
        			SELECT 	/*+ ORDERED USE_NL( G L Y )  */
							Y.YD_CD
        			FROM 
          					MDM_EQ_ORZ_CHT G,
          					MDM_LOCATION L,
							MDM_YARD Y
					WHERE	Y.LOC_CD = L.LOC_CD
					AND		L.SCC_CD = G.SCC_CD
					#if (${inquiryLevel} == 'S')
						AND G.SCC_CD = @[location] 		/* inquiryLevel = 'SCC'*/
					#elseif(${inquiryLevel} == 'L')
						AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
					#elseif(${inquiryLevel} == 'E')
						AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
					#end
				  ) 
	  #end
    GROUP BY M.CNTR_TPSZ_CD,'MP', W.WK_SEQ )A,CIM_TP_SZ_DP_SEQ_V S
	WHERE A.CNTR_TPSZ_CD = S.CNTR_TPSZ_CD

		)	L
GROUP BY 	
			L.CNTR_TPSZ_CD,
			L.MOV_STS,
			L.DSP_SEQ
ORDER BY 	L.DSP_SEQ

#elseif(${mtymvmt} == 'MR')

SELECT	
		L.CNTR_TPSZ_CD inout,
		L.MOV_STS division,
		SUM(CNT) AS total,
 		SUM( DECODE( L.WK_SEQ,  1, CNT ,0) )   AS count01,
		SUM( DECODE( L.WK_SEQ,  2, CNT ,0) )   AS count02,
		SUM( DECODE( L.WK_SEQ,  3, CNT ,0) )   AS count03,
		SUM( DECODE( L.WK_SEQ,  4, CNT ,0) )   AS count04,
		SUM( DECODE( L.WK_SEQ,  5, CNT ,0) )   AS count05,
		SUM( DECODE( L.WK_SEQ,  6, CNT ,0) )   AS count06,
		SUM( DECODE( L.WK_SEQ,  7, CNT ,0) )   AS count07,
		SUM( DECODE( L.WK_SEQ,  8, CNT ,0) )   AS count08,
		SUM( DECODE( L.WK_SEQ,  9, CNT ,0) )   AS count09,
		SUM( DECODE( L.WK_SEQ, 10, CNT ,0) )   AS count10,
		SUM( DECODE( L.WK_SEQ, 11, CNT ,0) )   AS count11,
		SUM( DECODE( L.WK_SEQ, 12, CNT ,0) )   AS count12

FROM (
			SELECT	/*+ ORDERED USE_NL ( A S ) */
					'MR'				MOV_STS,
					S.DP_SEQ			DSP_SEQ,
					S.CNTR_TPSZ_CD      CNTR_TPSZ_CD,
					A.WK_SEQ WK_SEQ,	
					NVL(CNT,0)			CNT
			FROM	(
						SELECT 
								'MR'					MOV_STS,
								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD,
								W.WK_SEQ WK_SEQ,
								COUNT(M.CNTR_NO)		CNT
						FROM	CTM_MOVEMENT	M,
								MST_CONTAINER	C,
								#if (${period} == 'W')
								EQR_WK_PRD	K,
								#end
		(
	#if (${period} == 'W')
	SELECT  /*+ INDEX ( XPKEQR_WK_PRD ) */ 
			PLN_YR||PLN_WK     DAY_UNIT,
			ROWNUM             WK_SEQ
	FROM    EQR_WK_PRD
	WHERE   PLN_YR||PLN_WK >= @[from]
	AND     PLN_YR||PLN_WK <= @[to]
	#elseif (${period} == 'M') 
		SELECT DAY_UNIT    DAY_UNIT,
			   ROWNUM      WK_SEQ
		FROM   (          	
					SELECT  DISTINCT PLN_YR||PLN_MON  DAY_UNIT     
					FROM    EQR_WK_PRD
					WHERE   PLN_YR||PLN_MON >= SUBSTR(@[from],0,6)
					AND     PLN_YR||PLN_MON <= SUBSTR(@[to],0,6)
					ORDER BY PLN_YR||PLN_MON
			   )
	#end
	)	W                
	#if (${period} == 'W')
	WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
					SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
					FROM   EQR_WK_PRD k
					WHERE  K.PLN_YR||K.PLN_WK = @[from]
					)	
	AND				( 
					 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
					 FROM   EQR_WK_PRD k
					 WHERE  K.PLN_YR||K.PLN_WK = @[to]
					) 
	#elseif (${period} == 'M') 
	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end

	#if (${period} == 'W')
	AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
						     AND 	K.WK_END_DT 	
	AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
	#elseif (${period} == 'M') 
	AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
	#end
	#if (${mtymvmt} != '') 
		AND 	M.MVMT_STS_CD = 'MT'
	#end 
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
      AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] 		/* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#end
          ) 
	  #end
			/* ----------------> 2010.05.13 Pre MVMT STS Check Logic 수정 */
			AND		'OK'	=	(   		  
									SELECT /*+ ORDERED USE_NL(MM LL GG) INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
											#if (${inquiryLevel} == 'S')
											  DECODE(GG.SCC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'L')
											  DECODE(GG.LCC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'E')
											  DECODE(GG.ECC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'Y')
											  DECODE(MM.ORG_YD_CD,@[location],'NO',
											#end
											DECODE(MM.MVMT_STS_CD,'EN','OK',
											DECODE(MM.MVMT_STS_CD,'TN','OK','NO')))

									--		MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
									FROM    CTM_MOVEMENT	MM,
											MDM_LOCATION	LL,
											MDM_EQ_ORZ_CHT	GG
									WHERE   MM.CNTR_NO = M.CNTR_NO  
									AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
													M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
									AND		SUBSTR(MM.ORG_YD_CD, 1, 5)	= LL.LOC_CD
									AND		LL.SCC_CD	= GG.SCC_CD
									AND     ROWNUM		= 1
								)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic 수정 */	
		AND		M.CNTR_NO	=	C.CNTR_NO
	  #if (${soc} == 'E')
        AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
	    AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end

    GROUP BY M.CNTR_TPSZ_CD,'MR', W.WK_SEQ ) A,CIM_TP_SZ_DP_SEQ_V	S
	WHERE	A.CNTR_TPSZ_CD = S.CNTR_TPSZ_CD
	) L
GROUP BY L.CNTR_TPSZ_CD,L.MOV_STS,L.DSP_SEQ
ORDER BY L.DSP_SEQ

#elseif(${mtymvmt} == 'MT')
WITH W AS(
					#if (${period} == 'W')
					SELECT  /*+ INDEX ( XPKEQR_WK_PRD ) */ 
							PLN_YR||PLN_WK     DAY_UNIT,
							ROWNUM             WK_SEQ
					FROM    EQR_WK_PRD
					WHERE   PLN_YR||PLN_WK >= @[from]
					AND     PLN_YR||PLN_WK <= @[to]
					#elseif (${period} == 'M') 
						SELECT DAY_UNIT    DAY_UNIT,
							   ROWNUM      WK_SEQ
						FROM   (          	
									SELECT  DISTINCT PLN_YR||PLN_MON  DAY_UNIT     
									FROM    EQR_WK_PRD
									WHERE   PLN_YR||PLN_MON >= SUBSTR(@[from],0,6)
									AND     PLN_YR||PLN_MON <= SUBSTR(@[to],0,6)
									ORDER BY PLN_YR||PLN_MON
							   )
					#end
     )
SELECT	
		DECODE(L.MOV_STS,'',1,'MG',2,'MP',3,'MR',4,'VD-MT',5) AS seq,
		NVL(L.CNTR_TPSZ_CD,'') AS inout,
		NVL(L.MOV_STS,'MT') as division,
		NVL(SUM(CNT),0) AS total,
 		SUM( DECODE( L.WK_SEQ,  1, CNT ,0) )   AS count01,
		SUM( DECODE( L.WK_SEQ,  2, CNT ,0) )   AS count02,
		SUM( DECODE( L.WK_SEQ,  3, CNT ,0) )   AS count03,
		SUM( DECODE( L.WK_SEQ,  4, CNT ,0) )   AS count04,
		SUM( DECODE( L.WK_SEQ,  5, CNT ,0) )   AS count05,
		SUM( DECODE( L.WK_SEQ,  6, CNT ,0) )   AS count06,
		SUM( DECODE( L.WK_SEQ,  7, CNT ,0) )   AS count07,
		SUM( DECODE( L.WK_SEQ,  8, CNT ,0) )   AS count08,
		SUM( DECODE( L.WK_SEQ,  9, CNT ,0) )   AS count09,
		SUM( DECODE( L.WK_SEQ, 10, CNT ,0) )   AS count10,
		SUM( DECODE( L.WK_SEQ, 11, CNT ,0) )   AS count11,
		SUM( DECODE( L.WK_SEQ, 12, CNT ,0) )   AS count12

FROM	(

	SELECT	/*+ ORDERED USE_NL ( A S ) */
			'MG'					MOV_STS,
			S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
			S.DP_SEQ				DSP_SEQ,
			A.WK_SEQ				WK_SEQ,
			A.CNT	                CNT
	FROM	(
			SELECT 	/*+ INDEX( M XIE6CTM_MOVEMENT ) */
				'MG'					MOV_STS,
				M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
				W.WK_SEQ				WK_SEQ,
				COUNT(M.MVMT_STS_CD)	CNT
			FROM    CTM_MOVEMENT        M,
					#if (${period} == 'W')
					EQR_WK_PRD			K,
					#end
					MST_CONTAINER		C,
					W                
			#if (${period} == 'W')
			WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD k
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD k
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
			#elseif (${period} == 'M') 
    			WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  		AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
			#end

			#if (${period} == 'W')
			AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
			                                             AND 	K.WK_END_DT 	
			AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
			#elseif (${period} == 'M') 
			AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
			#end
			#if (${mtymvmt} != '') 
			AND 	M.MVMT_STS_CD = 'MT'
			#end 
			#if (${tpsz} != '') 
				AND  M.CNTR_TPSZ_CD  IN ( 
				#foreach($cntrtpszcd in ${vel_tpsz_cd})  
					'$cntrtpszcd',  
					#end  
					'') 
			#end 
			
			AND	NVL(M.MVMT_CRE_TP_CD,'  ')	NOT IN ( 'C','L' )
			#if (${inquiryLevel} == 'Y')
			AND M.ORG_YD_CD = @[location]
			#else
			AND M.ORG_YD_CD IN (
        				SELECT 	/*+ ORDERED USE_NL( G L Y )  */
								Y.YD_CD
        				FROM 
          						MDM_EQ_ORZ_CHT G,
          						MDM_LOCATION L,
								MDM_YARD Y
						WHERE Y.LOC_CD = L.LOC_CD
						AND L.SCC_CD = G.SCC_CD
						#if (${inquiryLevel} == 'S')
						AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
						#elseif(${inquiryLevel} == 'L')
						  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
						#elseif(${inquiryLevel} == 'E')
						  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
						#end
					   ) 
			#end			
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic 수정 */
		AND		'ID'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic 수정 */		
		
      		AND 	M.CNTR_NO  			= C.CNTR_NO
			#if (${soc} == 'E')
			AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
			#elseif(${soc} == 'O')
			AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
			#end			
			GROUP BY
				M.CNTR_TPSZ_CD,'MG',W.WK_SEQ)A,CIM_TP_SZ_DP_SEQ_V S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
	#if (${tpsz} != '') 
		AND  S.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 

	UNION ALL

	SELECT	/*+ ORDERED USE_NL ( A S ) */
			'MP'					MOV_STS,
			S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
			S.DP_SEQ				DSP_SEQ,
			A.WK_SEQ				WK_SEQ,
			A.CNT	                CNT
	FROM	(

			SELECT 	/*+ INDEX( M XIE6CTM_MOVEMENT ) */
				'MP'					MOV_STS,
				M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
				W.WK_SEQ				WK_SEQ,
				COUNT(M.MVMT_STS_CD)	CNT
			FROM    CTM_MOVEMENT        M,
					#if (${period} == 'W')
					EQR_WK_PRD			K,
					#end
					MST_CONTAINER		C,
					W                
	#if (${period} == 'W')
	WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
					SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
					FROM   EQR_WK_PRD k
					WHERE  K.PLN_YR||K.PLN_WK = @[from]
					)	
	AND				( 
					 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
					 FROM   EQR_WK_PRD k
					 WHERE  K.PLN_YR||K.PLN_WK = @[to]
					) 
	#elseif (${period} == 'M') 
	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end

	#if (${period} == 'W')
	AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
						     AND 	K.WK_END_DT 	
	AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
	#elseif (${period} == 'M') 
	AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
	#end
	#if (${mtymvmt} != '') 
	AND 	M.MVMT_STS_CD = 'MT'
	#end 
	AND 	M.CNTR_NO = C.CNTR_NO
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end
      AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] 		/* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#end
          ) 
	  #end
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic 수정 */
		AND		'XX'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic 수정 */		

		 GROUP BY M.CNTR_TPSZ_CD, 'MP', W.WK_SEQ 

    UNION ALL

	SELECT 	/*+ INDEX( M XIE6CTM_MOVEMENT ) */
		'MP'					MOV_STS,
		M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
		W.WK_SEQ				WK_SEQ,
		COUNT(M.MVMT_STS_CD)	CNT      
	FROM	CTM_MOVEMENT M,
			#if (${period} == 'W')
			EQR_WK_PRD   K,
			#end
			MST_CONTAINER C,
			W                
	#if (${period} == 'W')
	WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
					SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
					FROM   EQR_WK_PRD k
					WHERE  K.PLN_YR||K.PLN_WK = @[from]
					)	
	AND				( 
					 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
					 FROM   EQR_WK_PRD k
					 WHERE  K.PLN_YR||K.PLN_WK = @[to]
					) 
	#elseif (${period} == 'M') 
	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end

	#if (${period} == 'W')
	AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
						     AND 	K.WK_END_DT 	
	AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
	#elseif (${period} == 'M') 
	AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
	#end
	
	#if (${mtymvmt} != '') 
		AND 	M.MVMT_STS_CD = 'MT'
	#end 
		AND 	M.CNTR_NO = C.CNTR_NO
	#if (${tpsz} != '') 
		AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
	  #if (${soc} == 'E')
		AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
	  	AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end
		AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
		AND M.CNMV_CYC_NO = 1 
	  #if (${inquiryLevel} == 'Y')
		AND M.ORG_YD_CD = @[location]
	  #else
		AND M.ORG_YD_CD IN (
        			SELECT 	/*+ ORDERED USE_NL( G L Y )  */
							Y.YD_CD
        			FROM 
          					MDM_EQ_ORZ_CHT G,
          					MDM_LOCATION L,
							MDM_YARD Y
					WHERE	Y.LOC_CD = L.LOC_CD
					AND		L.SCC_CD = G.SCC_CD
					#if (${inquiryLevel} == 'S')
						AND G.SCC_CD = @[location] 		/* inquiryLevel = 'SCC'*/
					#elseif(${inquiryLevel} == 'L')
						AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
					#elseif(${inquiryLevel} == 'E')
						AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
					#end
				  ) 
	  #end
    GROUP BY M.CNTR_TPSZ_CD,'MP', W.WK_SEQ )A,CIM_TP_SZ_DP_SEQ_V S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
	#if (${tpsz} != '') 
		AND  S.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 

	UNION ALL
			SELECT	/*+ ORDERED USE_NL ( A S ) */
					'MR'				MOV_STS,
					S.CNTR_TPSZ_CD      CNTR_TPSZ_CD,
					S.DP_SEQ			DSP_SEQ,
					A.WK_SEQ 			WK_SEQ,	
					NVL(CNT,0)			CNT
			FROM	(
						SELECT 
								'MR'					MOV_STS,
								M.CNTR_TPSZ_CD			CNTR_TPSZ_CD,
								W.WK_SEQ 				WK_SEQ,
								COUNT(M.CNTR_NO)		CNT
						FROM	CTM_MOVEMENT	M,
								MST_CONTAINER	C,
								#if (${period} == 'W')
								EQR_WK_PRD	K,
								#end
								W                
	#if (${period} == 'W')
	WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
					SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
					FROM   EQR_WK_PRD k
					WHERE  K.PLN_YR||K.PLN_WK = @[from]
					)	
	AND				( 
					 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
					 FROM   EQR_WK_PRD k
					 WHERE  K.PLN_YR||K.PLN_WK = @[to]
					) 
	#elseif (${period} == 'M') 
	WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
	#end

	#if (${period} == 'W')
	AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
						     AND 	K.WK_END_DT 	
	AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
	#elseif (${period} == 'M') 
	AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
	#end
	#if (${mtymvmt} != '') 
	AND 	M.MVMT_STS_CD = 'MT'
	#end 
	#if (${tpsz} != '') 
	AND  M.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 
      AND NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
	  #if (${inquiryLevel} == 'Y')
      AND M.ORG_YD_CD = @[location]
	  #else
      AND M.ORG_YD_CD IN (
        SELECT 	/*+ ORDERED USE_NL( G L Y )  */
				Y.YD_CD
        FROM 
          		MDM_EQ_ORZ_CHT G,
          		MDM_LOCATION L,
				MDM_YARD Y
        WHERE Y.LOC_CD = L.LOC_CD
          AND L.SCC_CD = G.SCC_CD
		#if (${inquiryLevel} == 'S')
          AND G.SCC_CD = @[location] 		/* inquiryLevel = 'SCC'*/
		#elseif(${inquiryLevel} == 'L')
		  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
		#elseif(${inquiryLevel} == 'E')
		  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
		#end
          ) 
	  #end
			/* ----------------> 2010.05.13 Pre MVMT STS Check Logic 수정 */
			AND		'OK'	=	(   		  
									SELECT /*+ ORDERED USE_NL(MM LL GG) INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
											#if (${inquiryLevel} == 'S')
											  DECODE(GG.SCC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'L')
											  DECODE(GG.LCC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'E')
											  DECODE(GG.ECC_CD,@[location],'NO',
											#elseif(${inquiryLevel} == 'Y')
											  DECODE(MM.ORG_YD_CD,@[location],'NO',
											#end
											DECODE(MM.MVMT_STS_CD,'EN','OK',
											DECODE(MM.MVMT_STS_CD,'TN','OK','NO')))

									--		MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
									FROM    CTM_MOVEMENT	MM,
											MDM_LOCATION	LL,
											MDM_EQ_ORZ_CHT	GG
									WHERE   MM.CNTR_NO = M.CNTR_NO  
									AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
													M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
									AND		SUBSTR(MM.ORG_YD_CD, 1, 5)	= LL.LOC_CD
									AND		LL.SCC_CD	= GG.SCC_CD
									AND     ROWNUM		= 1
								)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic 수정 */	
		AND		M.CNTR_NO	=	C.CNTR_NO
	  #if (${soc} == 'E')
        AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
	  #elseif(${soc} == 'O')
	    AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end

    GROUP BY M.CNTR_TPSZ_CD,'MR', W.WK_SEQ ) A,CIM_TP_SZ_DP_SEQ_V	S
	WHERE	A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
	#if (${tpsz} != '') 
	AND  S.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 

	UNION ALL
	SELECT	/*+ ORDERED USE_NL ( A S ) */
			'VD-MT'					MOV_STS,
			S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
			S.DP_SEQ				DSP_SEQ,
			A.WK_SEQ				WK_SEQ,
			A.CNT	                CNT
	FROM	(
			SELECT 	/*+ INDEX( M XIE6CTM_MOVEMENT ) */
				'VD-MT'					MOV_STS,
				M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
				W.WK_SEQ				WK_SEQ,
				COUNT(M.MVMT_STS_CD)	CNT
			FROM    CTM_MOVEMENT        M,
					#if (${period} == 'W')
					EQR_WK_PRD			K,
					#end
					MST_CONTAINER		C,
					W                
			#if (${period} == 'W')
			WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD k
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD k
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
			#elseif (${period} == 'M') 
    			WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  		AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
			#end

			#if (${period} == 'W')
			AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
			                                             AND 	K.WK_END_DT 	
			AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
			#elseif (${period} == 'M') 
			AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
			#end
			#if (${mtymvmt} != '') 
			AND 	M.MVMT_STS_CD = 'MT'
			#end 
			#if (${tpsz} != '') 
			AND  M.CNTR_TPSZ_CD  IN ( 
				#foreach($cntrtpszcd in ${vel_tpsz_cd})  
					'$cntrtpszcd',  
					#end  
					'') 
			#end 
			
			--AND	NVL(M.MVMT_CRE_TP_CD,'  ')	NOT IN ( 'C','L' )
			#if (${inquiryLevel} == 'Y')
			AND M.ORG_YD_CD = @[location]
			#else
			AND M.ORG_YD_CD IN (
        				SELECT 	/*+ ORDERED USE_NL( G L Y )  */
								Y.YD_CD
        				FROM 
          						MDM_EQ_ORZ_CHT G,
          						MDM_LOCATION L,
								MDM_YARD Y
						WHERE Y.LOC_CD = L.LOC_CD
						AND L.SCC_CD = G.SCC_CD
						#if (${inquiryLevel} == 'S')
						AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
						#elseif(${inquiryLevel} == 'L')
						AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
						#elseif(${inquiryLevel} == 'E')
						AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
						#end
					   ) 
			#end			
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic 수정 */
		AND		'VD'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic 수정 */		

      		AND 	M.CNTR_NO  			= C.CNTR_NO
			#if (${soc} == 'E')
			AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/
			#elseif(${soc} == 'O')
			AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
			#end			
			GROUP BY
				M.CNTR_TPSZ_CD,'VD-MT',W.WK_SEQ)A,CIM_TP_SZ_DP_SEQ_V S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
	#if (${tpsz} != '') 
		AND  S.CNTR_TPSZ_CD  IN ( 
		#foreach($cntrtpszcd in ${vel_tpsz_cd})  
			'$cntrtpszcd',  
			#end  
			'') 
	#end 

		)	L
GROUP BY 
			ROLLUP(L.CNTR_TPSZ_CD,L.MOV_STS),
			L.DSP_SEQ
ORDER BY 	L.DSP_SEQ||seq

#elseif(${mtymvmt} == 'VL')

SELECT	
		DECODE(L.MOV_STS,'',1,'OC-VL',2,'TS-VL',3) AS seq,
		NVL(L.CNTR_TPSZ_CD,'') AS inout,
		NVL(L.MOV_STS,'VL(Full)') as division,
		NVL(SUM(CNT),0) AS total,
 		SUM( DECODE( L.WK_SEQ,  1, CNT ,0) )   AS count01,
		SUM( DECODE( L.WK_SEQ,  2, CNT ,0) )   AS count02,
		SUM( DECODE( L.WK_SEQ,  3, CNT ,0) )   AS count03,
		SUM( DECODE( L.WK_SEQ,  4, CNT ,0) )   AS count04,
		SUM( DECODE( L.WK_SEQ,  5, CNT ,0) )   AS count05,
		SUM( DECODE( L.WK_SEQ,  6, CNT ,0) )   AS count06,
		SUM( DECODE( L.WK_SEQ,  7, CNT ,0) )   AS count07,
		SUM( DECODE( L.WK_SEQ,  8, CNT ,0) )   AS count08,
		SUM( DECODE( L.WK_SEQ,  9, CNT ,0) )   AS count09,
		SUM( DECODE( L.WK_SEQ, 10, CNT ,0) )   AS count10,
		SUM( DECODE( L.WK_SEQ, 11, CNT ,0) )   AS count11,
		SUM( DECODE( L.WK_SEQ, 12, CNT ,0) )   AS count12

FROM	(
	SELECT	/*+ ORDERED USE_NL ( A S ) */
			'OC-VL'					MOV_STS,
			S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
			S.DP_SEQ				DSP_SEQ,
			A.WK_SEQ				WK_SEQ,
			A.CNT	                CNT
	FROM	(

			SELECT 	/*+ INDEX( M XIE6CTM_MOVEMENT ) */
				'OC-VL'					MOV_STS,
				M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
				W.WK_SEQ		WK_SEQ,
				COUNT(M.MVMT_STS_CD)	CNT
			FROM    CTM_MOVEMENT        M,
					#if (${period} == 'W')
					EQR_WK_PRD			K,
					#end
					MST_CONTAINER		C,
					(
					#if (${period} == 'W')
					SELECT  /*+ INDEX ( XPKEQR_WK_PRD ) */ 
							PLN_YR||PLN_WK     DAY_UNIT,
							ROWNUM             WK_SEQ
					FROM    EQR_WK_PRD
					WHERE   PLN_YR||PLN_WK >= @[from]
					AND     PLN_YR||PLN_WK <= @[to]
					#elseif (${period} == 'M') 
						SELECT DAY_UNIT    DAY_UNIT,
							   ROWNUM      WK_SEQ
						FROM   (          	
									SELECT  DISTINCT PLN_YR||PLN_MON  DAY_UNIT     
									FROM    EQR_WK_PRD
									WHERE   PLN_YR||PLN_MON >= SUBSTR(@[from],0,6)
									AND     PLN_YR||PLN_MON <= SUBSTR(@[to],0,6)
									ORDER BY PLN_YR||PLN_MON
							   )
					#end
					)	W                
			#if (${period} == 'W')
			WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD k
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD k
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
			#elseif (${period} == 'M') 
    			WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  		AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
			#end

			#if (${period} == 'W')
			AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
			                                             AND 	K.WK_END_DT 	
			AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
			#elseif (${period} == 'M') 
			AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
			#end
			#if (${mtymvmt} != '') 
			AND 	M.MVMT_STS_CD = 'VL'
			#end 
	
			#if (${tpsz} != '') 
				AND  M.CNTR_TPSZ_CD  IN ( 
				#foreach($cntrtpszcd in ${vel_tpsz_cd})  
					'$cntrtpszcd',  
					#end  
					'') 
			#end 
			#if (${mtymvmt} == 'MTIDMG')
      		AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
			#end
			
			#if (${inquiryLevel} == 'Y')
			AND M.ORG_YD_CD = @[location]
			#else
			AND M.ORG_YD_CD IN (
        				SELECT 	/*+ ORDERED USE_NL( G L Y )  */
								Y.YD_CD
        				FROM 
          						MDM_EQ_ORZ_CHT G,
          						MDM_LOCATION L,
								MDM_YARD Y
						WHERE Y.LOC_CD = L.LOC_CD
						AND L.SCC_CD = G.SCC_CD
						#if (${inquiryLevel} == 'S')
						AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
						#elseif(${inquiryLevel} == 'L')
						AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
						#elseif(${inquiryLevel} == 'E')
						AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
						#end
					   ) 
			#end			
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic 수정 */
		AND		'OC'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic 수정 */		
			
      AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	
	#if (${bound} == 'N')
		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */
	#elseif(${bound} == 'Y')
		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */
	#end

			GROUP BY
				M.CNTR_TPSZ_CD,'OC-VL',					
				W.WK_SEQ)A,CIM_TP_SZ_DP_SEQ_V S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
UNION ALL
	SELECT	/*+ ORDERED USE_NL ( A S ) */
			'TS-VL'					MOV_STS,
			S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
			S.DP_SEQ				DSP_SEQ,
			A.WK_SEQ				WK_SEQ,
			A.CNT	                CNT
	FROM	(

			SELECT 	/*+ INDEX( M XIE6CTM_MOVEMENT ) */
				'TS-VL'					MOV_STS,
				M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
				W.WK_SEQ		WK_SEQ,
				COUNT(M.MVMT_STS_CD)	CNT
			FROM    CTM_MOVEMENT        M,
					#if (${period} == 'W')
					EQR_WK_PRD			K,
					#end
					MST_CONTAINER		C,
					(
					#if (${period} == 'W')
					SELECT  /*+ INDEX ( XPKEQR_WK_PRD ) */ 
							PLN_YR||PLN_WK     DAY_UNIT,
							ROWNUM             WK_SEQ
					FROM    EQR_WK_PRD
					WHERE   PLN_YR||PLN_WK >= @[from]
					AND     PLN_YR||PLN_WK <= @[to]
					#elseif (${period} == 'M') 
						SELECT DAY_UNIT    DAY_UNIT,
							   ROWNUM      WK_SEQ
						FROM   (          	
									SELECT  DISTINCT PLN_YR||PLN_MON  DAY_UNIT     
									FROM    EQR_WK_PRD
									WHERE   PLN_YR||PLN_MON >= SUBSTR(@[from],0,6)
									AND     PLN_YR||PLN_MON <= SUBSTR(@[to],0,6)
									ORDER BY PLN_YR||PLN_MON
							   )
					#end
					)	W                
			#if (${period} == 'W')
			WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD k
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD k
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
			#elseif (${period} == 'M') 
    			WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  		AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
			#end

			#if (${period} == 'W')
			AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
			                                             AND 	K.WK_END_DT 	
			AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
			#elseif (${period} == 'M') 
			AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
			#end
			#if (${mtymvmt} != '') 
			AND 	M.MVMT_STS_CD = 'VL'
			#end 
	
			#if (${tpsz} != '') 
				AND  M.CNTR_TPSZ_CD  IN ( 
				#foreach($cntrtpszcd in ${vel_tpsz_cd})  
					'$cntrtpszcd',  
					#end  
					'') 
			#end 
			#if (${mtymvmt} == 'MTIDMG')
      		AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
			#end
			
			#if (${inquiryLevel} == 'Y')
			AND M.ORG_YD_CD = @[location]
			#else
			AND M.ORG_YD_CD IN (
        				SELECT 	/*+ ORDERED USE_NL( G L Y )  */
								Y.YD_CD
        				FROM 
          						MDM_EQ_ORZ_CHT G,
          						MDM_LOCATION L,
								MDM_YARD Y
						WHERE Y.LOC_CD = L.LOC_CD
						AND L.SCC_CD = G.SCC_CD
						#if (${inquiryLevel} == 'S')
						AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
						#elseif(${inquiryLevel} == 'L')
						AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
						#elseif(${inquiryLevel} == 'E')
						AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
						#end
					   ) 
			#end			
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic 수정 */
		AND		'TS'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic 수정 */		

      AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	
	#if (${bound} == 'N')
		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */
	#elseif(${bound} == 'Y')
		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */
	#end

			GROUP BY
				M.CNTR_TPSZ_CD,'TS-VL',					
				W.WK_SEQ)A,CIM_TP_SZ_DP_SEQ_V S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
		)	L
GROUP BY 
			ROLLUP(L.CNTR_TPSZ_CD,L.MOV_STS),
			L.DSP_SEQ
ORDER BY 	L.DSP_SEQ||seq

#elseif(${mtymvmt} == 'VD')

SELECT	
		DECODE(L.MOV_STS,'',1,'VD-IC',2,'VD-TS',3) AS seq,
		NVL(L.CNTR_TPSZ_CD,'') AS inout,
		NVL(L.MOV_STS,'VD(Full)') as division,
		NVL(SUM(CNT),0) AS total,
 		SUM( DECODE( L.WK_SEQ,  1, CNT ,0) )   AS count01,
		SUM( DECODE( L.WK_SEQ,  2, CNT ,0) )   AS count02,
		SUM( DECODE( L.WK_SEQ,  3, CNT ,0) )   AS count03,
		SUM( DECODE( L.WK_SEQ,  4, CNT ,0) )   AS count04,
		SUM( DECODE( L.WK_SEQ,  5, CNT ,0) )   AS count05,
		SUM( DECODE( L.WK_SEQ,  6, CNT ,0) )   AS count06,
		SUM( DECODE( L.WK_SEQ,  7, CNT ,0) )   AS count07,
		SUM( DECODE( L.WK_SEQ,  8, CNT ,0) )   AS count08,
		SUM( DECODE( L.WK_SEQ,  9, CNT ,0) )   AS count09,
		SUM( DECODE( L.WK_SEQ, 10, CNT ,0) )   AS count10,
		SUM( DECODE( L.WK_SEQ, 11, CNT ,0) )   AS count11,
		SUM( DECODE( L.WK_SEQ, 12, CNT ,0) )   AS count12

FROM	(
	SELECT	/*+ ORDERED USE_NL ( A S ) */
			'VD-IC'					MOV_STS,
			S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
			S.DP_SEQ				DSP_SEQ,
			A.WK_SEQ				WK_SEQ,
			A.CNT	                CNT
	FROM	(

			SELECT 	/*+ INDEX( M XIE6CTM_MOVEMENT ) */
				'VD-IC'					MOV_STS,
				M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
				W.WK_SEQ		WK_SEQ,
				COUNT(M.MVMT_STS_CD)	CNT
			FROM    CTM_MOVEMENT        M,
					#if (${period} == 'W')
					EQR_WK_PRD			K,
					#end
					MST_CONTAINER		C,
					(
					#if (${period} == 'W')
					SELECT  /*+ INDEX ( XPKEQR_WK_PRD ) */ 
							PLN_YR||PLN_WK     DAY_UNIT,
							ROWNUM             WK_SEQ
					FROM    EQR_WK_PRD
					WHERE   PLN_YR||PLN_WK >= @[from]
					AND     PLN_YR||PLN_WK <= @[to]
					#elseif (${period} == 'M') 
						SELECT DAY_UNIT    DAY_UNIT,
							   ROWNUM      WK_SEQ
						FROM   (          	
									SELECT  DISTINCT PLN_YR||PLN_MON  DAY_UNIT     
									FROM    EQR_WK_PRD
									WHERE   PLN_YR||PLN_MON >= SUBSTR(@[from],0,6)
									AND     PLN_YR||PLN_MON <= SUBSTR(@[to],0,6)
									ORDER BY PLN_YR||PLN_MON
							   )
					#end
					)	W                
			#if (${period} == 'W')
			WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD k
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD k
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
			#elseif (${period} == 'M') 
    			WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  		AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
			#end

			#if (${period} == 'W')
			AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
			                                             AND 	K.WK_END_DT 	
			AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
			#elseif (${period} == 'M') 
			AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
			#end
			#if (${mtymvmt} != '') 
			AND 	M.MVMT_STS_CD = 'IC'
			#end 
	
			#if (${tpsz} != '') 
				AND  M.CNTR_TPSZ_CD  IN ( 
				#foreach($cntrtpszcd in ${vel_tpsz_cd})  
					'$cntrtpszcd',  
					#end  
					'') 
			#end 
			#if (${mtymvmt} == 'MTIDMG')
      		AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
			#end
			
			#if (${inquiryLevel} == 'Y')
			AND M.ORG_YD_CD = @[location]
			#else
			AND M.ORG_YD_CD IN (
        				SELECT 	/*+ ORDERED USE_NL( G L Y )  */
								Y.YD_CD
        				FROM 
          						MDM_EQ_ORZ_CHT G,
          						MDM_LOCATION L,
								MDM_YARD Y
						WHERE Y.LOC_CD = L.LOC_CD
						AND L.SCC_CD = G.SCC_CD
						#if (${inquiryLevel} == 'S')
						AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
						#elseif(${inquiryLevel} == 'L')
						AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
						#elseif(${inquiryLevel} == 'E')
						AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
						#end
					   ) 
			#end			
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic 수정 */
		AND		'VD'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic 수정 */		
	
      AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	
	#if (${bound} == 'N')
		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */
	#elseif(${bound} == 'Y')
		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */
	#end

			GROUP BY
				M.CNTR_TPSZ_CD,'VD-IC',					
				W.WK_SEQ)A,CIM_TP_SZ_DP_SEQ_V S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
UNION ALL
	SELECT	/*+ ORDERED USE_NL ( A S ) */
			'VD-TS'					MOV_STS,
			S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
			S.DP_SEQ				DSP_SEQ,
			A.WK_SEQ				WK_SEQ,
			A.CNT	                CNT
	FROM	(

			SELECT 	/*+ INDEX( M XIE6CTM_MOVEMENT ) */
				'VD-TS'					MOV_STS,
				M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
				W.WK_SEQ		WK_SEQ,
				COUNT(M.MVMT_STS_CD)	CNT
			FROM    CTM_MOVEMENT        M,
					#if (${period} == 'W')
					EQR_WK_PRD			K,
					#end
					MST_CONTAINER		C,
					(
					#if (${period} == 'W')
					SELECT  /*+ INDEX ( XPKEQR_WK_PRD ) */ 
							PLN_YR||PLN_WK     DAY_UNIT,
							ROWNUM             WK_SEQ
					FROM    EQR_WK_PRD
					WHERE   PLN_YR||PLN_WK >= @[from]
					AND     PLN_YR||PLN_WK <= @[to]
					#elseif (${period} == 'M') 
						SELECT DAY_UNIT    DAY_UNIT,
							   ROWNUM      WK_SEQ
						FROM   (          	
									SELECT  DISTINCT PLN_YR||PLN_MON  DAY_UNIT     
									FROM    EQR_WK_PRD
									WHERE   PLN_YR||PLN_MON >= SUBSTR(@[from],0,6)
									AND     PLN_YR||PLN_MON <= SUBSTR(@[to],0,6)
									ORDER BY PLN_YR||PLN_MON
							   )
					#end
					)	W                
			#if (${period} == 'W')
			WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD k
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD k
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
			#elseif (${period} == 'M') 
    			WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  		AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
			#end

			#if (${period} == 'W')
			AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
			                                             AND 	K.WK_END_DT 	
			AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
			#elseif (${period} == 'M') 
			AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
			#end
			#if (${mtymvmt} != '') 
			AND 	M.MVMT_STS_CD = 'TS'
			#end 
	
			#if (${tpsz} != '') 
				AND  M.CNTR_TPSZ_CD  IN ( 
				#foreach($cntrtpszcd in ${vel_tpsz_cd})  
					'$cntrtpszcd',  
					#end  
					'') 
			#end 
			#if (${mtymvmt} == 'MTIDMG')
      		AND 	NVL(M.MVMT_CRE_TP_CD, '  ') NOT IN ( 'C','L' ) 
			#end
			
			#if (${inquiryLevel} == 'Y')
			AND M.ORG_YD_CD = @[location]
			#else
			AND M.ORG_YD_CD IN (
        				SELECT 	/*+ ORDERED USE_NL( G L Y )  */
								Y.YD_CD
        				FROM 
          						MDM_EQ_ORZ_CHT G,
          						MDM_LOCATION L,
								MDM_YARD Y
						WHERE Y.LOC_CD = L.LOC_CD
						AND L.SCC_CD = G.SCC_CD
						#if (${inquiryLevel} == 'S')
						AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
						#elseif(${inquiryLevel} == 'L')
						AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
						#elseif(${inquiryLevel} == 'E')
						AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
						#end
					   ) 
			#end			
		/* ----------------> 2010.05.13 Pre MVMT STS Check Logic 수정 */
		AND		'VD'	=	(   		  
												SELECT /*+ INDEX_DESC ( MM XFN1CTM_MOVEMENT ) */
														MM.MVMT_STS_CD  /*  pre_mvmt_sts_cd   */
												FROM    CTM_MOVEMENT MM
												WHERE   MM.CNTR_NO = M.CNTR_NO  
												AND     MM.CNMV_YR || TO_CHAR(MM.CNMV_SEQ, '0000') ||MM.CNMV_SPLIT_NO <         
																M.CNMV_YR||TO_CHAR(M.CNMV_SEQ,'0000')||M.CNMV_SPLIT_NO
												AND     ROWNUM = 1
											)
		/* <---------------- 2010.05.13 Pre MVMT STS Check Logic 수정 */		
		
      AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	
	#if (${bound} == 'N')
		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */
	#elseif(${bound} == 'Y')
		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */
	#end

			GROUP BY
				M.CNTR_TPSZ_CD,'VD-TS',					
				W.WK_SEQ)A,CIM_TP_SZ_DP_SEQ_V S
	WHERE A.CNTR_TPSZ_CD(+) = S.CNTR_TPSZ_CD
		)	L
GROUP BY 
			ROLLUP(L.CNTR_TPSZ_CD,L.MOV_STS),
			L.DSP_SEQ
ORDER BY 	L.DSP_SEQ||seq

#else

SELECT	
		L.CNTR_TPSZ_CD AS inout,
		L.MOV_STS as division,
		SUM(CNT) AS total,
 		SUM( DECODE( L.WK_SEQ,  1, CNT ,0) )   AS count01,
		SUM( DECODE( L.WK_SEQ,  2, CNT ,0) )   AS count02,
		SUM( DECODE( L.WK_SEQ,  3, CNT ,0) )   AS count03,
		SUM( DECODE( L.WK_SEQ,  4, CNT ,0) )   AS count04,
		SUM( DECODE( L.WK_SEQ,  5, CNT ,0) )   AS count05,
		SUM( DECODE( L.WK_SEQ,  6, CNT ,0) )   AS count06,
		SUM( DECODE( L.WK_SEQ,  7, CNT ,0) )   AS count07,
		SUM( DECODE( L.WK_SEQ,  8, CNT ,0) )   AS count08,
		SUM( DECODE( L.WK_SEQ,  9, CNT ,0) )   AS count09,
		SUM( DECODE( L.WK_SEQ, 10, CNT ,0) )   AS count10,
		SUM( DECODE( L.WK_SEQ, 11, CNT ,0) )   AS count11,
		SUM( DECODE( L.WK_SEQ, 12, CNT ,0) )   AS count12

FROM	(
	SELECT	/*+ ORDERED USE_NL ( A S ) */
			SUBSTR(@[mtymvmt],0,2)	MOV_STS,
			S.CNTR_TPSZ_CD          CNTR_TPSZ_CD,
			S.DP_SEQ				DSP_SEQ,
			A.WK_SEQ				WK_SEQ,
			A.CNT	                CNT
	FROM	(

			SELECT 	/*+ INDEX( M XIE6CTM_MOVEMENT ) */
				SUBSTR(@[mtymvmt],0,2)	MOV_STS,
				M.CNTR_TPSZ_CD			CNTR_TPSZ_CD    ,
				W.WK_SEQ				WK_SEQ,
				COUNT(M.MVMT_STS_CD)	CNT
			FROM    CTM_MOVEMENT        M,
					#if (${period} == 'W')
					EQR_WK_PRD			K,
					#end
					MST_CONTAINER		C,
					(
					#if (${period} == 'W')
					SELECT  /*+ INDEX ( XPKEQR_WK_PRD ) */ 
							PLN_YR||PLN_WK     DAY_UNIT,
							ROWNUM             WK_SEQ
					FROM    EQR_WK_PRD
					WHERE   PLN_YR||PLN_WK >= @[from]
					AND     PLN_YR||PLN_WK <= @[to]
					#elseif (${period} == 'M') 
						SELECT DAY_UNIT    DAY_UNIT,
							   ROWNUM      WK_SEQ
						FROM   (          	
									SELECT  DISTINCT PLN_YR||PLN_MON  DAY_UNIT     
									FROM    EQR_WK_PRD
									WHERE   PLN_YR||PLN_MON >= SUBSTR(@[from],0,6)
									AND     PLN_YR||PLN_MON <= SUBSTR(@[to],0,6)
									ORDER BY PLN_YR||PLN_MON
							   )
					#end
					)	W                
			#if (${period} == 'W')
			WHERE 	M.CNMV_EVNT_DT	BETWEEN	( 
							SELECT TO_DATE(K.WK_ST_DT,'YYYYMMDD') + .0
							FROM   EQR_WK_PRD k
							WHERE  K.PLN_YR||K.PLN_WK = @[from]
							)	
			AND				( 
							 SELECT TO_DATE(K.WK_END_DT,'YYYYMMDD') + .99999
							 FROM   EQR_WK_PRD k
							 WHERE  K.PLN_YR||K.PLN_WK = @[to]
							) 
			#elseif (${period} == 'M') 
    			WHERE 	M.CNMV_EVNT_DT BETWEEN 	TO_DATE( @[from], 'YYYYMMDD') + .0 
	  		AND 				TO_DATE( @[to], 'YYYYMMDD') + .99999
			#end

			#if (${period} == 'W')
			AND	TO_CHAR(M.CNMV_EVNT_DT,'YYYYMMDD')   BETWEEN    K.WK_ST_DT
			                                             AND 	K.WK_END_DT 	
			AND	K.PLN_YR||K.PLN_WK	=	W.DAY_UNIT		/* if ( :period = 'W' ) */
			#elseif (${period} == 'M') 
			AND TO_CHAR(M.CNMV_EVNT_DT,'YYYYMM') = W.DAY_UNIT		/* ( period = 'M' ) */
			#end

	#if (${mtymvmt} != '') 
      	AND 	M.MVMT_STS_CD = SUBSTR(@[mtymvmt],0,2)
	#end 

	#if (${mtymvmt} == 'ENF' || ${mtymvmt} == 'TNF' || ${mtymvmt} == 'ENM' || ${mtymvmt} == 'TNM') 
		#if (${mtymvmt} == 'ENF' || ${mtymvmt} == 'TNF') 
			AND	M.FCNTR_FLG = 'Y'
		#else
			AND	M.FCNTR_FLG = 'N'
		#end
	#end 
	
			#if (${tpsz} != '') 
			AND  M.CNTR_TPSZ_CD  IN ( 
				#foreach($cntrtpszcd in ${vel_tpsz_cd})  
					'$cntrtpszcd',  
					#end  
					'') 
			#end 
		--	AND	NVL(M.MVMT_CRE_TP_CD,'  ')	NOT IN ( 'C','L' )
			
			#if (${inquiryLevel} == 'Y')
			AND M.ORG_YD_CD = @[location]
			#else
			AND M.ORG_YD_CD IN (
        				SELECT 	/*+ ORDERED USE_NL( G L Y )  */
								Y.YD_CD
        				FROM 
          						MDM_EQ_ORZ_CHT G,
          						MDM_LOCATION L,
								MDM_YARD Y
						WHERE Y.LOC_CD = L.LOC_CD
						AND L.SCC_CD = G.SCC_CD
						#if (${inquiryLevel} == 'S')
						AND G.SCC_CD = @[location] /* inquiryLevel = 'SCC'*/
						#elseif(${inquiryLevel} == 'L')
						  AND G.LCC_CD = @[location]		/* inquiryLevel = 'LCC'*/
						#elseif(${inquiryLevel} == 'E')
						  AND G.ECC_CD = @[location]		/* inquiryLevel = 'ECC'*/
						#end
					   ) 
			#end			
      AND 	M.CNTR_NO  			= C.CNTR_NO
	  #if (${soc} == 'E')
      AND 	NVL(C.LSTM_CD, '  ') <> 'SH' /* soc	*/ 
	  #elseif(${soc} == 'O')
	  AND 	NVL(C.LSTM_CD, '  ') = 'SH' /* soc	*/
	  #end	
	#if (${bound} == 'N')
		AND		M.OB_CNTR_FLG	=	'N'		/* 'N':Inbound, 'Y':Outbound */
	#elseif(${bound} == 'Y')
		AND		M.OB_CNTR_FLG	=	'Y'		/* 'N':Inbound, 'Y':Outbound */
	#end

	GROUP BY
			M.CNTR_TPSZ_CD,SUBSTR(@[mtymvmt],0,2),					
			W.WK_SEQ)A,CIM_TP_SZ_DP_SEQ_V S
	WHERE 	A.CNTR_TPSZ_CD = S.CNTR_TPSZ_CD

		)	L
GROUP BY 
			L.CNTR_TPSZ_CD,
			L.MOV_STS,
			L.DSP_SEQ
ORDER BY 	L.DSP_SEQ

#end			]]></sql>
			<params>
				<param name="mtymvmt" type="12" value="" out="N"/>
				<param name="from" type="12" value="" out="N"/>
				<param name="to" type="12" value="" out="N"/>
				<param name="location" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
