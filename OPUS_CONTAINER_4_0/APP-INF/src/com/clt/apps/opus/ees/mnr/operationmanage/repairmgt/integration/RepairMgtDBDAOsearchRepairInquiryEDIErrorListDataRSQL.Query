<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RepairMgtDBDAOsearchRepairInquiryEDIErrorListDataRSQL">
			<desc><![CDATA[searchRepairInquiryEDIErrorListData]]></desc>
			<sql><![CDATA[
SELECT MRT.VNDR_SEQ,
       NVL((SELECT MVR.VNDR_LGL_ENG_NM
             FROM MDM_VENDOR MVR
            WHERE MRT.VNDR_SEQ = MVR.VNDR_SEQ),
           MRT.VNDR_SEQ) AS VNDR_NM,
       '' MNR_WO_TP_CD,
       '' AS WO_NO,
       '' AS ISS_DT,
       '' AS MNR_ORD_SND_DT,
       MRT.INV_NO,
       MRT.INV_AMT,
       MRT.MNR_RPR_RMK AS ORD_HDR_RMK,
       MRT.EQ_KND_CD,
       'E' AS TRSM_MOD_CD,
       MRT.MNR_ORD_OFC_CTY_CD,
       MRT.MNR_ORD_SEQ,
       '' AS COST_CD,
       (MRT.MNR_LBR_AMT + MRT.MNR_MTRL_AMT) AS MNR_WRK_AMT,
       '' AS VVD,
       '' AS SPR_PRT_SPL_YD_CD,
       '' AS COST_CD_NM,
       TO_CHAR(MRT.CRE_DT, 'YYYY-MM-DD') AS EST_DT,
       MRT.CURR_CD,
       MRT.N3PTY_FLG,
       (SELECT SUM(MRD.MNR_WRK_AMT)
          FROM MNR_RPR_RQST_TMP_DTL MRD
         WHERE MRD.RQST_EQ_NO = MRT.RQST_EQ_NO
           AND MRD.RPR_RQST_TMP_SEQ = MRT.RPR_RQST_TMP_SEQ
           AND MRD.RPR_RQST_TMP_VER_NO = MRT.RPR_RQST_TMP_VER_NO) TOTAL_AMT,
       NVL((SELECT MNR_CD_DESC
             FROM MNR_GEN_CD
            WHERE MNR_CD_ID = MRT.EDI_ERR_CD
              AND PRNT_CD_ID = 'CD00076'
              AND ROWNUM = 1),
           'Error') AS MNR_VRFY_TP_CD,
       MRT.RQST_EQ_NO,
       MRT.RPR_RQST_TMP_SEQ AS RPR_RQST_SEQ,
       MRT.RPR_RQST_TMP_VER_NO AS RPR_RQST_VER_NO,
       MRT.RPR_RQST_LST_VER_FLG,
       MRT.EQ_TPSZ_CD,
       NVL((SELECT MNR_CD_DESC
             FROM MNR_GEN_CD
            WHERE MNR_CD_ID = MRT.EDI_ERR_CD
              AND PRNT_CD_ID = 'CD00076'
              AND ROWNUM = 1),
           'Error') AS RPR_STS_CD,
       MRT.RQST_REF_NO,
       MRT.COST_OFC_CD,
       '' AS AGMT_OFC_CD,
       'N' AS DMG_FLAG,
       MRT.CRE_USR_ID
  FROM MNR_RPR_RQST_TMP_HDR MRT
 WHERE MRT.EDI_ERR_CD <> 'SS'
#if (${rqst_ref_no} != '')
   AND MRT.RQST_REF_NO IN (
			#foreach ($user_ref_no IN ${rqstRefNos})
            	#if($velocityCount < $rqstRefNos.size())
                	'$user_ref_no',
               	#else
                	'$user_ref_no'
               	#end
           	#end
       )
#end
#if (${rqst_eq_no} != '')
   AND MRT.RQST_EQ_NO IN (
        #foreach ($user_eq_no IN ${eqNos})
            #if($velocityCount < $eqNos.size())
                '$user_eq_no',
            #else
                '$user_eq_no'
            #end
        #end
)
#end	
#if (${vndr_seq} != '')
   AND MRT.VNDR_SEQ = @[vndr_seq]
#end
#if (${fm_est_dt} != '' && ${to_est_dt} != '')
   AND MRT.RQST_DT BETWEEN
       TO_DATE(REPLACE(@[fm_est_dt], '-', ''), 'yyyymmdd') AND (TO_DATE(REPLACE(@[to_est_dt], '-', ''), 'yyyymmdd') + 0.99999)
   #if (${rqst_eq_no} == '' && ${rqst_ref_no} == '' && ${vndr_seq} == '')
   AND MRT.COST_OFC_CD = @[cost_ofc_cd] 
   #end
#end			]]></sql>
			<params>
				<param name="vndr_seq" type="12" value="" out="N"/>
				<param name="fm_est_dt" type="12" value="" out="N"/>
				<param name="to_est_dt" type="12" value="" out="N"/>
				<param name="cost_ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
