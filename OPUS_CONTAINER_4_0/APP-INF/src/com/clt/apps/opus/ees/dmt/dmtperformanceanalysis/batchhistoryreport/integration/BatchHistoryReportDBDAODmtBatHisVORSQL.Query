<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="BatchHistoryReportDBDAODmtBatHisVORSQL">
			<desc><![CDATA[   ]]></desc>
			<sql><![CDATA[
SELECT   bat_his_dt,
         MAX (kor_bat_tm)
         || ' min' kor_bat_tm,
         MAX (kor_bat_typ) kor_bat_typ,
         MAX (chn_bat_tm)
         || ' min' chn_bat_tm,
         MAX (chn_bat_typ) chn_bat_typ,
         MAX (sw1_bat_tm)
         || ' min' sw1_bat_tm,
         MAX (sw1_bat_typ) sw1_bat_typ,
         MAX (sw2_bat_tm)
         || ' min' sw2_bat_tm,
         MAX (sw2_bat_typ) sw2_bat_typ,
         MAX (sw3_bat_tm)
         || ' min' sw3_bat_tm,
         MAX (sw3_bat_typ) sw3_bat_typ,
         MAX (usa_bat_tm)
         || ' min' usa_bat_tm,
         MAX (usa_bat_typ) usa_bat_typ,
         MAX (eur_bat_tm)
         || ' min' eur_bat_tm,
         MAX (eur_bat_typ) eur_bat_typ
    FROM (SELECT TO_CHAR (bat_his_dt, 'YYYY-MM-DD') AS bat_his_dt,
                 CASE
                    WHEN SYS_AREA_GRP_ID = 'KOR'
                       THEN ROUND ((cre_dt
                                    - TO_DATE (TO_CHAR (cre_dt, 'YYYYMMDD')
                                               || '003000',
                                               'YYYYMMDD HH24:MI:SS'
                                              )
                                   )
                                   * 24
                                   * 60
                                  )
                 END AS kor_bat_tm,
                 CASE
                    WHEN SYS_AREA_GRP_ID = 'KOR'
                       THEN bat_his_rmk
                 END AS kor_bat_typ,
                 CASE
                    WHEN SYS_AREA_GRP_ID = 'CHN'
                       THEN ROUND ((cre_dt
                                    - TO_DATE (TO_CHAR (cre_dt, 'YYYYMMDD')
                                               || '033000',
                                               'YYYYMMDD HH24:MI:SS'
                                              )
                                   )
                                   * 24
                                   * 60
                                  )
                 END AS chn_bat_tm,
                 CASE
                    WHEN SYS_AREA_GRP_ID = 'CHN'
                       THEN bat_his_rmk
                 END AS chn_bat_typ,
                 CASE
                    WHEN SYS_AREA_GRP_ID = 'SWA' 
                       THEN ROUND ((cre_dt
                                    - TO_DATE (TO_CHAR (cre_dt, 'YYYYMMDD')
                                               || '063000',
                                               'YYYYMMDD HH24:MI:SS'
                                              )
                                   )
                                   * 24
                                   * 60
                                  )
                    WHEN SYS_AREA_GRP_ID = 'SW1' 
                       THEN ROUND ((cre_dt
                                    - TO_DATE (TO_CHAR (cre_dt, 'YYYYMMDD')
                                               || '070000',
                                               'YYYYMMDD HH24:MI:SS'
                                              )
                                   )
                                   * 24
                                   * 60
                                  )
                 END AS sw1_bat_tm,
                 CASE
                    WHEN SYS_AREA_GRP_ID = 'SWA'
                       THEN bat_his_rmk
                    WHEN SYS_AREA_GRP_ID = 'SW1'
                       THEN bat_his_rmk
                 END AS sw1_bat_typ,
				 CASE
                    WHEN SYS_AREA_GRP_ID = 'SW2' 
                       THEN ROUND ((cre_dt
                                    - TO_DATE (TO_CHAR (cre_dt, 'YYYYMMDD')
                                               || '020000',
                                               'YYYYMMDD HH24:MI:SS'
                                              )
                                   )
                                   * 24
                                   * 60
                                  )
                 END AS sw2_bat_tm,
				 CASE
                    WHEN SYS_AREA_GRP_ID = 'SW3'
                       THEN bat_his_rmk
                 END AS sw2_bat_typ,
				 CASE
                    WHEN SYS_AREA_GRP_ID = 'SW3' 
                       THEN ROUND ((cre_dt
                                    - TO_DATE (TO_CHAR (cre_dt, 'YYYYMMDD')
                                               || '210000',
                                               'YYYYMMDD HH24:MI:SS'
                                              )
                                   )
                                   * 24
                                   * 60
                                  )
                 END AS sw3_bat_tm,
				 CASE
                    WHEN SYS_AREA_GRP_ID = 'SW3'
                       THEN bat_his_rmk
                 END AS sw3_bat_typ,
                 CASE
                    WHEN SYS_AREA_GRP_ID = 'USA'
                       THEN ROUND ((cre_dt
                                    - TO_DATE (TO_CHAR (cre_dt, 'YYYYMMDD')
                                               || '173000',
                                               'YYYYMMDD HH24:MI:SS'
                                              )
                                   )
                                   * 24
                                   * 60
                                  )
                 END AS usa_bat_tm,
                 CASE
                    WHEN SYS_AREA_GRP_ID = 'USA'
                       THEN bat_his_rmk
                 END AS usa_bat_typ,
                 CASE
                    WHEN SYS_AREA_GRP_ID = 'EUR'
                       THEN ROUND ((cre_dt
                                    - TO_DATE (TO_CHAR (cre_dt, 'YYYYMMDD')
                                               || '093000',
                                               'YYYYMMDD HH24:MI:SS'
                                              )
                                   )
                                   * 24
                                   * 60
                                  )
                 END AS eur_bat_tm,
                 CASE
                    WHEN SYS_AREA_GRP_ID = 'EUR'
                       THEN bat_his_rmk
                 END AS eur_bat_typ
            FROM dmt_bat_his
           WHERE bat_his_dt BETWEEN TO_DATE (@[fm_dt], 'rrrrmmdd')
                                    + .00001
                                AND TO_DATE (@[to_dt], 'rrrrmmdd')
                                    + .99999)
GROUP BY bat_his_dt
ORDER BY bat_his_dt DESC			]]></sql>
			<params>
				<param name="fm_dt" type="12" value="20090501" out="N"/>
				<param name="to_dt" type="12" value="20090530" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
