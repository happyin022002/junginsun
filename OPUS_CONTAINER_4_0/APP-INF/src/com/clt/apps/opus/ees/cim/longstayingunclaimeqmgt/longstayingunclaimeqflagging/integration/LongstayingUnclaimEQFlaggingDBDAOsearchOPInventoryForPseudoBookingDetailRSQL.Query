<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="LongstayingUnclaimEQFlaggingDBDAOsearchOPInventoryForPseudoBookingDetailRSQL">
			<desc><![CDATA[OP Inventory for Pseudo Booking  - Detail]]></desc>
			<sql><![CDATA[
SELECT   O.AR_HD_QTR_OFC_CD RHQ_CD
        ,B.BKG_OFC_CD BKG_OFC_CD
        ,B.OB_SREP_CD
        ,C.CUST_CNT_CD||LPAD(C.CUST_SEQ,6,0) CUST_CD
        ,T.CUST_LGL_ENG_NM CUST_NM
        ,A.BKG_NO
        ,A.CNTR_NO
        ,A.CNTR_TPSZ_CD
        ,A.CRNT_YD_CD YD_CD
        ,(SELECT Y.YD_NM
          FROM MDM_YARD Y
          WHERE Y.YD_CD = A.CRNT_YD_CD
          ) YD_NM
        ,ROUND(CEIL(GLOBALDATE_PKG.TIME_LOCAL_FNC(A.RCC_CD) - A.CNMV_DT), 1) STAY_DAYS
   FROM MST_CONTAINER A, BKG_BOOKING B, MDM_ORGANIZATION O, BKG_CUSTOMER C, MDM_CUSTOMER T 
	WHERE A.ACIAC_DIV_CD         = 'A'
      AND A.BKG_NO             =  B.BKG_NO
      AND B.VSL_CD          LIKE '%XX'
      AND A.CNMV_STS_CD        = 'OP'
      AND B.BKG_OFC_CD         = O.OFC_CD      
      AND C.BKG_NO             = B.BKG_NO
      AND C.BKG_CUST_TP_CD     = 'S'
      AND T.CUST_CNT_CD        = C.CUST_CNT_CD
      AND T.CUST_SEQ           = C.CUST_SEQ
  
      #if (${rhq_cd} != '')
      		AND O.AR_HD_QTR_OFC_CD   = @[rhq_cd]
      #end

      #if (${bkg_ofc_cd} != '')
      		AND B.BKG_OFC_CD         = @[bkg_ofc_cd]
      #end

      #if (${bkg_no} != '')
      		AND A.BKG_NO             = @[bkg_no]
      #end

      #if (${cust_cd} != '')
      		AND C.CUST_CNT_CD        = SUBSTR(@[cust_cd],1,2)
      		AND LPAD(C.CUST_SEQ,6,0) = SUBSTR(@[cust_cd],3)
      #end

      #if (${cust_nm} != '')
      		AND T.CUST_LGL_ENG_NM    LIKE @[cust_nm]||'%'
      #end

      #if (${op_loc_cd} != '')
      		AND A.LOC_CD             = @[op_loc_cd]
      #end			]]></sql>
			<params>
				<param name="rhq_cd" type="12" value="" out="N"/>
				<param name="bkg_ofc_cd" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="cust_cd" type="12" value="" out="N"/>
				<param name="cust_nm" type="12" value="" out="N"/>
				<param name="op_loc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
