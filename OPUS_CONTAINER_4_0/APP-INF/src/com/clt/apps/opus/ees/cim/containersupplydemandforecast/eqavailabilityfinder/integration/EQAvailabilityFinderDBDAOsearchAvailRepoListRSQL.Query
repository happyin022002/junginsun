<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="EQAvailabilityFinderDBDAOsearchAvailRepoListRSQL">
			<desc><![CDATA[MTY Reposition for EQ Availability]]></desc>
			<sql><![CDATA[
SELECT
	A.LVL   
    ,A.IO_BND_CD
    ,A.EQ_TRSP_MOD_CD
    ,A.VVD
    ,A.FM_YD_CD
    ,A.ETD_DT
    ,A.TO_YD_CD
    ,A.ETB_DT
    ,A.TOTAL
    ,A.FCAST_QTY1
    ,A.FCAST_QTY2
    ,A.FCAST_QTY3
    ,A.FCAST_QTY4
    ,A.FCAST_QTY5
    ,A.FCAST_QTY6
    ,A.FCAST_QTY7
    ,A.FCAST_QTY8
    ,A.FCAST_QTY9
    ,A.FCAST_QTY10
    ,A.FCAST_QTY11
    ,A.FCAST_QTY12
    ,A.FCAST_QTY13
    ,A.FCAST_QTY14
    ,A.FCAST_QTY15
FROM
(
	SELECT   A.LVL   
	        ,A.IO_BND_CD
	        ,DECODE(A.EQ_TRSP_MOD_CD,'V','T/D VVD','R','Rail','W','Water','T','Truck') EQ_TRSP_MOD_CD
	        ,A.VVD
	        ,A.FM_YD_CD
	        ,A.ETD_DT
	        ,A.TO_YD_CD
	        ,A.ETB_DT
	        ,A.FCAST_QTY1+A.FCAST_QTY2+A.FCAST_QTY3+A.FCAST_QTY4+A.FCAST_QTY5+A.FCAST_QTY6+A.FCAST_QTY7+A.FCAST_QTY8+A.FCAST_QTY9+A.FCAST_QTY10+A.FCAST_QTY11+A.FCAST_QTY12+A.FCAST_QTY13+A.FCAST_QTY14+A.FCAST_QTY15 TOTAL
	        ,A.FCAST_QTY1
	        ,A.FCAST_QTY2
	        ,A.FCAST_QTY3
	        ,A.FCAST_QTY4
	        ,A.FCAST_QTY5
	        ,A.FCAST_QTY6
	        ,A.FCAST_QTY7
	        ,A.FCAST_QTY8
	        ,A.FCAST_QTY9
	        ,A.FCAST_QTY10
	        ,A.FCAST_QTY11
	        ,A.FCAST_QTY12
	        ,A.FCAST_QTY13
	        ,A.FCAST_QTY14
	        ,A.FCAST_QTY15
	FROM(
	    SELECT
	             GROUPING(A.IO_BND_CD)||GROUPING(A.EQ_TRSP_MOD_CD)||GROUPING(A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD)||GROUPING(A.FM_YD_CD)||GROUPING(TO_CHAR(A.ETD_DT,'YYYYMMDD'))||GROUPING(A.TO_YD_CD)||GROUPING(TO_CHAR(A.ETB_DT,'YYYYMMDD')) LVL
	            ,A.IO_BND_CD
	            ,A.EQ_TRSP_MOD_CD
	            ,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD VVD
	            ,A.FM_YD_CD
	            ,TO_CHAR(A.ETD_DT,'YYYYMMDD') ETD_DT
	            ,A.TO_YD_CD
	            ,TO_CHAR(A.ETB_DT,'YYYYMMDD') ETB_DT
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd1]  ,A.FCAST_QTY,0))  FCAST_QTY1
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd2]  ,A.FCAST_QTY,0))  FCAST_QTY2
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd3]  ,A.FCAST_QTY,0))  FCAST_QTY3
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd4]  ,A.FCAST_QTY,0))  FCAST_QTY4
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd5]  ,A.FCAST_QTY,0))  FCAST_QTY5
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd6]  ,A.FCAST_QTY,0))  FCAST_QTY6
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd7]  ,A.FCAST_QTY,0))  FCAST_QTY7
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd8]  ,A.FCAST_QTY,0))  FCAST_QTY8
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd9]  ,A.FCAST_QTY,0))  FCAST_QTY9
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd10], A.FCAST_QTY,0))  FCAST_QTY10
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd11], A.FCAST_QTY,0))  FCAST_QTY11
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd12], A.FCAST_QTY,0))  FCAST_QTY12
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd13], A.FCAST_QTY,0))  FCAST_QTY13
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd14], A.FCAST_QTY,0))  FCAST_QTY14
	            ,SUM(DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd15], A.FCAST_QTY,0))  FCAST_QTY15
	    FROM  CIM_AVAL_REPO A,MDM_LOCATION B, MDM_EQ_ORZ_CHT D
	    WHERE DECODE(A.IO_BND_CD,'I',SUBSTR(A.TO_YD_CD,1,5),SUBSTR(A.FM_YD_CD,1,5))=B.LOC_CD
        AND B.SCC_CD = D.SCC_CD
#if (${loc_type_code} == 'S')
    	AND D.SCC_CD = @[loc_cd]
#elseif (${loc_type_code} == 'E')
	    AND D.ECC_CD = @[loc_cd]
#elseif (${loc_type_code} == 'L')
	    AND D.LCC_CD = @[loc_cd]
#elseif (${loc_type_code} == 'R')
	    AND D.RCC_CD = @[loc_cd]
#elseif (${loc_type_code} == 'Y')
        AND  DECODE(@[io_bnd_cd],'I',A.TO_YD_CD,A.FM_YD_CD)=@[loc_cd]
#else
	    AND D.SCC_CD = @[loc_cd]
        AND NVL(@[loc_type_code], 'X') = NVL(@[loc_type_code], 'X')
#end
		#if (${io_bnd_cd} !='' )
			AND A.IO_BND_CD = @[io_bnd_cd]
		#end
		#if (${fcast_dt} !='' )
			AND DECODE(@[io_bnd_cd],'I',TO_CHAR(A.ETB_DT,'YYYYMMDD'),TO_CHAR(A.ETD_DT,'YYYYMMDD')) = @[fcast_dt]
		#end
	    GROUP BY GROUPING SETS((A.IO_BND_CD,A.EQ_TRSP_MOD_CD,A.VSL_CD||A.SKD_VOY_NO||A.SKD_DIR_CD,A.FM_YD_CD,TO_CHAR(A.ETD_DT,'YYYYMMDD'),A.TO_YD_CD,TO_CHAR(A.ETB_DT,'YYYYMMDD')),
	                           (A.IO_BND_CD))

	    UNION ALL
	    SELECT
	             '1111111' LVL
	            ,''IO_BND_CD
	            ,'' EQ_TRSP_MOD_CD
	            ,'' VVD
	            ,'' FM_YD_CD
	            ,'' ETD_DT
	            ,'' TO_YD_CD
	            ,'' ETB_DT
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd1]  ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd1]  ,A.FCAST_QTY,0),0)) FCAST_QTY1 
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd2]  ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd2]  ,A.FCAST_QTY,0),0)) FCAST_QTY2 
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd3]  ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd3]  ,A.FCAST_QTY,0),0)) FCAST_QTY3 
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd4]  ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd4]  ,A.FCAST_QTY,0),0)) FCAST_QTY4 
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd5]  ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd5]  ,A.FCAST_QTY,0),0)) FCAST_QTY5 
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd6]  ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd6]  ,A.FCAST_QTY,0),0)) FCAST_QTY6 
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd7]  ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd7]  ,A.FCAST_QTY,0),0)) FCAST_QTY7 
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd8]  ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd8]  ,A.FCAST_QTY,0),0)) FCAST_QTY8 
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd9]  ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd9]  ,A.FCAST_QTY,0),0)) FCAST_QTY9 
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd10] ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd10] ,A.FCAST_QTY,0),0)) FCAST_QTY10
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd11] ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd11] ,A.FCAST_QTY,0),0)) FCAST_QTY11
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd12] ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd12] ,A.FCAST_QTY,0),0)) FCAST_QTY12
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd13] ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd13] ,A.FCAST_QTY,0),0)) FCAST_QTY13
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd14] ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd14] ,A.FCAST_QTY,0),0)) FCAST_QTY14
	            ,SUM(DECODE(A.IO_BND_CD,'I',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd15] ,A.FCAST_QTY,0),0)) - SUM(DECODE(A.IO_BND_CD,'O',DECODE(A.CNTR_TPSZ_CD,@[cntr_tpsz_cd15] ,A.FCAST_QTY,0),0)) FCAST_QTY15
	    FROM  CIM_AVAL_REPO A,MDM_LOCATION B, MDM_EQ_ORZ_CHT D
	    WHERE DECODE(A.IO_BND_CD,'I',SUBSTR(A.TO_YD_CD,1,5),SUBSTR(A.FM_YD_CD,1,5))=B.LOC_CD
        AND  B.SCC_CD = D.SCC_CD
#if (${loc_type_code} == 'S')
    	AND D.SCC_CD = @[loc_cd]
#elseif (${loc_type_code} == 'E')
	    AND D.ECC_CD = @[loc_cd]
#elseif (${loc_type_code} == 'L')
	    AND D.LCC_CD = @[loc_cd]
#elseif (${loc_type_code} == 'R')
	    AND D.RCC_CD = @[loc_cd]
#elseif (${loc_type_code} == 'Y')
        AND  DECODE(A.IO_BND_CD,'I',A.TO_YD_CD,A.FM_YD_CD)=@[loc_cd] --YARD 
#else
	    AND D.SCC_CD = @[loc_cd]
        AND NVL(@[loc_type_code], 'X') = NVL(@[loc_type_code], 'X')
#end
		AND A.IO_BND_CD = 'X'
	    ) A
	ORDER BY A.IO_BND_CD,DECODE(A.EQ_TRSP_MOD_CD,'V',1,'T',2,'R',3,'W',4),  DECODE(A.IO_BND_CD,'I',A.ETB_DT,'O',A.ETD_DT)
) A
WHERE A.TOTAL <> 0			]]></sql>
			<params>
				<param name="cntr_tpsz_cd1" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd2" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd3" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd4" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd5" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd6" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd7" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd8" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd9" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd10" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd11" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd12" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd13" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd14" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd15" type="12" value="" out="N"/>
				<param name="loc_cd" type="12" value="" out="N"/>
				<param name="io_bnd_cd" type="12" value="" out="N"/>
				<param name="loc_type_code" type="12" value="" out="N"/>
				<param name="fcast_dt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
