/*=========================================================
*Copyright(c) 2011 CyberLogitec
*@FileName : LeaseReportDBDAOsearchOnHireTotalSummaryByLeaseTermYearRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2011.03.25
*@LastModifier : 
*@LastVersion : 1.0
* 2011.03.25 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.ees.lse.containerleasemgt.leasereport.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class LeaseReportDBDAOsearchOnHireTotalSummaryByLeaseTermYearRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * 년도별/계약별 자가 및 장기 장비 인수 계획 대비 실적 조회
	  * </pre>
	  */
	public LeaseReportDBDAOsearchOnHireTotalSummaryByLeaseTermYearRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("period_eddt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("period_stdt",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.ees.lse.containerleasemgt.leasereport.integration").append("\n"); 
		query.append("FileName : LeaseReportDBDAOsearchOnHireTotalSummaryByLeaseTermYearRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if (${lstm_cd_str} == '' ) " ).append("\n"); 
		query.append("--===================================================ALL end    " ).append("\n"); 
		query.append("WITH PARAM AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT A.PLN_YRMON," ).append("\n"); 
		query.append("      A.AGMT_CTY_CD," ).append("\n"); 
		query.append("      A.AGMT_SEQ," ).append("\n"); 
		query.append("      A.DEL_CD," ).append("\n"); 
		query.append("      A.MFT_VNDR_SEQ," ).append("\n"); 
		query.append("      A.CNTR_TPSZ_CD," ).append("\n"); 
		query.append("      A.NEW_VAN_YRMON AS BASE_DE_YRMON   " ).append("\n"); 
		query.append("    FROM LSE_NEW_VAN_DE_PLN A" ).append("\n"); 
		query.append("    WHERE 1 = 1" ).append("\n"); 
		query.append("       AND A.PLN_YRMON BETWEEN @[period_stdt] AND @[period_eddt]" ).append("\n"); 
		query.append("      AND A.AGMT_CTY_CD = 'HHO' )," ).append("\n"); 
		query.append("  INLINE_1 AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT P.PLN_YRMON," ).append("\n"); 
		query.append("      P.AGMT_CTY_CD," ).append("\n"); 
		query.append("      P.AGMT_SEQ," ).append("\n"); 
		query.append("      P.AGMT_CTY_CD||LPAD(P.AGMT_SEQ, 6, '0') AS AGMT_NO," ).append("\n"); 
		query.append("      P.MFT_VNDR_SEQ," ).append("\n"); 
		query.append("      P.DEL_CD," ).append("\n"); 
		query.append("      P.CNTR_TPSZ_CD," ).append("\n"); 
		query.append("      P.BASE_DE_YRMON," ).append("\n"); 
		query.append("      1 AS RSLT_TP_SEQ," ).append("\n"); 
		query.append("      NVL(PLAN.DE_QTY, 0) AS PLAN_DE_QTY," ).append("\n"); 
		query.append("      0 AS PFMC_DE_QTY," ).append("\n"); 
		query.append("	  C.RCC_CD, C.LCC_CD, C.SCC_CD" ).append("\n"); 
		query.append("    FROM PARAM P," ).append("\n"); 
		query.append("      LSE_NEW_VAN_DE_PLN PLAN," ).append("\n"); 
		query.append("	  MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("    WHERE 1 = 1" ).append("\n"); 
		query.append("      AND P.BASE_DE_YRMON = PLAN.NEW_VAN_YRMON(+)" ).append("\n"); 
		query.append("      AND P.CNTR_TPSZ_CD = PLAN.CNTR_TPSZ_CD(+)" ).append("\n"); 
		query.append("      AND P.DEL_CD = PLAN.DEL_CD(+)" ).append("\n"); 
		query.append("      AND P.MFT_VNDR_SEQ = PLAN.MFT_VNDR_SEQ(+)" ).append("\n"); 
		query.append("      AND P.AGMT_SEQ = PLAN.AGMT_SEQ(+)" ).append("\n"); 
		query.append("      AND P.AGMT_CTY_CD = PLAN.AGMT_CTY_CD(+)" ).append("\n"); 
		query.append("      AND P.PLN_YRMON = PLAN.PLN_YRMON(+) " ).append("\n"); 
		query.append("	  AND P.DEL_CD = C.SCC_CD)," ).append("\n"); 
		query.append("  INLINE_2 AS (" ).append("\n"); 
		query.append("    SELECT AGMT_CTY_CD||LPAD(AGMT_SEQ, 6, '0') AS AGMT_NO," ).append("\n"); 
		query.append("      AGMT_CTY_CD," ).append("\n"); 
		query.append("      AGMT_SEQ," ).append("\n"); 
		query.append("      MFT_VNDR_SEQ," ).append("\n"); 
		query.append("      RCC_CD, LCC_CD, SCC_CD, " ).append("\n"); 
		query.append("      CNTR_TPSZ_CD," ).append("\n"); 
		query.append("      DE_YRMON AS BASE_DE_YRMON," ).append("\n"); 
		query.append("      2 AS RSLT_TP_SEQ," ).append("\n"); 
		query.append("      0 AS PLAN_DE_QTY," ).append("\n"); 
		query.append("      NVL(COUNT(CNTR_NO), 0) AS PFMC_DE_QTY," ).append("\n"); 
		query.append("      PLN_YRMON" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT /*+ ORDERED USE_HASH(P HS CN) */" ).append("\n"); 
		query.append("          DISTINCT TO_CHAR(CN.ONH_DT, 'YYYYMM') AS DE_YRMON," ).append("\n"); 
		query.append("          HS.AGMT_CTY_CD," ).append("\n"); 
		query.append("          HS.AGMT_SEQ," ).append("\n"); 
		query.append("          CN.MFTR_VNDR_SEQ AS MFT_VNDR_SEQ," ).append("\n"); 
		query.append("          E.SCC_CD AS DEL_CD," ).append("\n"); 
		query.append("          CN.CNTR_TPSZ_CD," ).append("\n"); 
		query.append("          CN.CNTR_NO," ).append("\n"); 
		query.append("          P.PLN_YRMON," ).append("\n"); 
		query.append("		  E.RCC_CD, E.LCC_CD, E.SCC_CD" ).append("\n"); 
		query.append("        FROM PARAM P," ).append("\n"); 
		query.append("          MST_CNTR_STS_HIS HS," ).append("\n"); 
		query.append("          MST_CONTAINER CN," ).append("\n"); 
		query.append("          (" ).append("\n"); 
		query.append("            SELECT A.YD_CD, A.LOC_CD, C.RCC_CD, C.LCC_CD, C.SCC_CD" ).append("\n"); 
		query.append("            FROM MDM_YARD A," ).append("\n"); 
		query.append("              MDM_LOCATION B," ).append("\n"); 
		query.append("              MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("            WHERE A.LOC_CD = B.LOC_CD" ).append("\n"); 
		query.append("              AND B.SCC_CD = C.SCC_CD) E" ).append("\n"); 
		query.append("        WHERE 1 = 1" ).append("\n"); 
		query.append("          AND CN.ONH_DT >= TO_DATE(P.BASE_DE_YRMON, 'YYYYMM')" ).append("\n"); 
		query.append("-- T-project 특정 오피스 예외사항 제거" ).append("\n"); 
		query.append("--          AND SUBSTR(NVL(HS.CNTR_STS_RMK, ' '), 1, 6) <> 'SELLOE'" ).append("\n"); 
		query.append("          AND HS.CNTR_LSTM_CNG_FLG <> 'Y'" ).append("\n"); 
		query.append("          AND HS.CNTR_STS_CD IN ('LSI','OWN')" ).append("\n"); 
		query.append("          AND HS.CNTR_NO = CN.CNTR_NO" ).append("\n"); 
		query.append("--          AND CN.ONH_YD_CD <> 'KRSEL1H'" ).append("\n"); 
		query.append("          AND CN.LSTM_CD IN('OW','LP', 'OL')" ).append("\n"); 
		query.append("          AND CN.CO_CRE_FLG = 'N'" ).append("\n"); 
		query.append("          AND CN.ONH_YD_CD = E.YD_CD" ).append("\n"); 
		query.append("          AND HS.AGMT_SEQ = P.AGMT_SEQ" ).append("\n"); 
		query.append("          AND HS.AGMT_CTY_CD = P.AGMT_CTY_CD )" ).append("\n"); 
		query.append("    GROUP BY DE_YRMON, AGMT_CTY_CD, AGMT_SEQ, MFT_VNDR_SEQ, RCC_CD, LCC_CD, SCC_CD, CNTR_TPSZ_CD, PLN_YRMON  )," ).append("\n"); 
		query.append("  TEMP_DROP AS (" ).append("\n"); 
		query.append("    SELECT " ).append("\n"); 
		query.append("      X.DE_YR AS YEAR_MONTH," ).append("\n"); 
		query.append("      X.AGMT_NO," ).append("\n"); 
		query.append("      Z.LSTM_CD," ).append("\n"); 
		query.append("      X.DEL_CD AS LOC_CD," ).append("\n"); 
		query.append("      X.CNTR_TPSZ_CD AS TYSZ," ).append("\n"); 
		query.append("      SUBSTR(Y.VNDR_ABBR_NM, 0, 8) AS SUPPLIER," ).append("\n"); 
		query.append("      DECODE(X.RSLT_TP_SEQ, 1, 'Plan', 2, 'PFMC', 3, 'Ratio') AS RESULT,   " ).append("\n"); 
		query.append("      X.RSLT_TP_SEQ, " ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '01', DE_QTY, 0)) AS JAN," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '02', DE_QTY, 0)) AS FEB," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '03', DE_QTY, 0)) AS MAR," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '04', DE_QTY, 0)) AS APR," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '05', DE_QTY, 0)) AS MAY," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '06', DE_QTY, 0)) AS JUN," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '07', DE_QTY, 0)) AS JUL," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '08', DE_QTY, 0)) AS AUG," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '09', DE_QTY, 0)) AS SEP," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '10', DE_QTY, 0)) AS OCT," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '11', DE_QTY, 0)) AS NOV," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '12', DE_QTY, 0)) AS DEC," ).append("\n"); 
		query.append("      CASE WHEN X.RSLT_TP_SEQ = 1" ).append("\n"); 
		query.append("      OR X.RSLT_TP_SEQ = 2 THEN SUM(DECODE(X.DE_MON, '01', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '02', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '03', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '04', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '05', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '06', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '07', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '08', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '09', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '10', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '11', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '12', DE_QTY, 0)) WHEN X.RSLT_TP_SEQ = 3 THEN 0 END AS DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT A.PLN_YRMON," ).append("\n"); 
		query.append("          A.AGMT_NO," ).append("\n"); 
		query.append("          A.AGMT_CTY_CD," ).append("\n"); 
		query.append("          A.AGMT_SEQ," ).append("\n"); 
		query.append("          A.MFT_VNDR_SEQ," ).append("\n"); 
		query.append("          A.RCC_CD, A.LCC_CD, A.SCC_CD, A.LCC_CD AS DEL_CD," ).append("\n"); 
		query.append("          A.CNTR_TPSZ_CD," ).append("\n"); 
		query.append("          SUBSTR(A.BASE_DE_YRMON, 0, 4) AS DE_YR," ).append("\n"); 
		query.append("          SUBSTR(A.BASE_DE_YRMON, 5, 2) AS DE_MON," ).append("\n"); 
		query.append("          C.RSLT_TP_SEQ," ).append("\n"); 
		query.append("          CASE C.RSLT_TP_SEQ WHEN 1 THEN A.PLAN_DE_QTY WHEN 2 THEN B.PFMC_DE_QTY WHEN 3 THEN DECODE(NVL(A.PLAN_DE_QTY, 0), 0, 0, ROUND(B.PFMC_DE_QTY/A.PLAN_DE_QTY*100)) END DE_QTY" ).append("\n"); 
		query.append("        FROM INLINE_1 A," ).append("\n"); 
		query.append("          INLINE_2 B," ).append("\n"); 
		query.append("          (" ).append("\n"); 
		query.append("            SELECT LEVEL AS RSLT_TP_SEQ" ).append("\n"); 
		query.append("            FROM DUAL CONNECT BY LEVEL <= 3) C" ).append("\n"); 
		query.append("        WHERE A.AGMT_NO = B.AGMT_NO(+)" ).append("\n"); 
		query.append("          AND A.MFT_VNDR_SEQ = B.MFT_VNDR_SEQ(+)" ).append("\n"); 
		query.append("		  AND A.SCC_CD = B.SCC_CD(+)" ).append("\n"); 
		query.append("          AND A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)" ).append("\n"); 
		query.append("          AND A.BASE_DE_YRMON = B.BASE_DE_YRMON(+)" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT NVL(A.PLN_YRMON, B.PLN_YRMON) AS PLN_YRMON," ).append("\n"); 
		query.append("          B.AGMT_NO," ).append("\n"); 
		query.append("          B.AGMT_CTY_CD," ).append("\n"); 
		query.append("          B.AGMT_SEQ," ).append("\n"); 
		query.append("          B.MFT_VNDR_SEQ," ).append("\n"); 
		query.append("          B.RCC_CD, B.LCC_CD, B.SCC_CD, B.LCC_CD AS DEL_CD," ).append("\n"); 
		query.append("          B.CNTR_TPSZ_CD," ).append("\n"); 
		query.append("          SUBSTR(B.BASE_DE_YRMON, 0, 4) AS DE_YR," ).append("\n"); 
		query.append("          SUBSTR(B.BASE_DE_YRMON, 5, 2) AS DE_MON," ).append("\n"); 
		query.append("          C.RSLT_TP_SEQ," ).append("\n"); 
		query.append("          CASE C.RSLT_TP_SEQ WHEN 1 THEN A.PLAN_DE_QTY WHEN 2 THEN B.PFMC_DE_QTY WHEN 3 THEN DECODE(NVL(A.PLAN_DE_QTY, 0), 0, 0, ROUND(B.PFMC_DE_QTY/A.PLAN_DE_QTY*100)) END DE_QTY" ).append("\n"); 
		query.append("        FROM INLINE_1 A," ).append("\n"); 
		query.append("          INLINE_2 B," ).append("\n"); 
		query.append("          (" ).append("\n"); 
		query.append("            SELECT LEVEL AS RSLT_TP_SEQ" ).append("\n"); 
		query.append("            FROM DUAL CONNECT BY LEVEL <= 3) C" ).append("\n"); 
		query.append("        WHERE A.AGMT_NO(+) = B.AGMT_NO" ).append("\n"); 
		query.append("          AND A.MFT_VNDR_SEQ(+) = B.MFT_VNDR_SEQ" ).append("\n"); 
		query.append("		  AND A.SCC_CD(+) = B.SCC_CD" ).append("\n"); 
		query.append("          AND A.CNTR_TPSZ_CD(+) = B.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("          AND A.BASE_DE_YRMON(+) = B.BASE_DE_YRMON" ).append("\n"); 
		query.append("          AND A.PLAN_DE_QTY IS NULL ) X ," ).append("\n"); 
		query.append("          MDM_VENDOR Y ," ).append("\n"); 
		query.append("          LSE_AGREEMENT Z" ).append("\n"); 
		query.append("    WHERE Y.VNDR_SEQ = X.MFT_VNDR_SEQ" ).append("\n"); 
		query.append("      AND X.AGMT_CTY_CD = Z.AGMT_CTY_CD" ).append("\n"); 
		query.append("      AND X.AGMT_SEQ    = Z.AGMT_SEQ" ).append("\n"); 
		query.append("#if (${vndr_seq_str} != '' )" ).append("\n"); 
		query.append("    AND X.MFT_VNDR_SEQ IN( #foreach($key IN ${vndr_seq})" ).append("\n"); 
		query.append("                                      #if($velocityCount < $vndr_seq.size())" ).append("\n"); 
		query.append("                                          '$key'," ).append("\n"); 
		query.append("                                      #else" ).append("\n"); 
		query.append("                                          '$key'" ).append("\n"); 
		query.append("                                      #end" ).append("\n"); 
		query.append("                                  #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd_str} != '' )" ).append("\n"); 
		query.append("    AND X.CNTR_TPSZ_CD  IN( #foreach($key IN ${cntr_tpsz_cd})" ).append("\n"); 
		query.append("                                      #if($velocityCount < $cntr_tpsz_cd.size())" ).append("\n"); 
		query.append("                                          '$key'," ).append("\n"); 
		query.append("                                      #else" ).append("\n"); 
		query.append("                                          '$key'" ).append("\n"); 
		query.append("                                      #end" ).append("\n"); 
		query.append("                                  #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${loc_cd} != '')" ).append("\n"); 
		query.append("	#if (${loc_tp} == 'R')" ).append("\n"); 
		query.append("        AND	X.RCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                          		#if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                	'$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                          #end )" ).append("\n"); 
		query.append("	#elseif (${loc_tp} == 'L')" ).append("\n"); 
		query.append("        AND	X.LCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                                #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                    '$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                          #end )" ).append("\n"); 
		query.append("	#elseif (${loc_tp} == 'S')" ).append("\n"); 
		query.append("        AND	X.SCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                                #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                    '$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                          #end )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    GROUP BY X.DE_YR, X.AGMT_NO, Z.LSTM_CD, X.DEL_CD, X.CNTR_TPSZ_CD, Y.VNDR_ABBR_NM , X.RSLT_TP_SEQ " ).append("\n"); 
		query.append("    ORDER BY X.DE_YR, X.AGMT_NO, Z.LSTM_CD, X.DEL_CD, X.CNTR_TPSZ_CD, Y.VNDR_ABBR_NM , X.RSLT_TP_SEQ ) ," ).append("\n"); 
		query.append("--===================================================================" ).append("\n"); 
		query.append("  LT_VIEW AS (" ).append("\n"); 
		query.append("    SELECT " ).append("\n"); 
		query.append("      DD.PLN_YR ," ).append("\n"); 
		query.append("      DD.DE_YR AS YEAR_MONTH," ).append("\n"); 
		query.append("      NVL(DD.AGMT_NO, 'G.TTL') AS AGMT_NO ," ).append("\n"); 
		query.append("      NVL2(DD.MFT_VNDR_SEQ, SUBSTR(VNDR.VNDR_ABBR_NM, 0, 3), 'TTL') AS SUPPLIER ," ).append("\n"); 
		query.append("      DD.DEL_CD AS LOC_CD," ).append("\n"); 
		query.append("      DD.CNTR_TPSZ_CD AS TYSZ," ).append("\n"); 
		query.append("      DD.TYPE_CD AS RSLT_TP_SEQ ," ).append("\n"); 
		query.append("      DECODE(DD.TYPE_CD, 1, 'Plan', 2, 'PFMC', 3, 'Ratio') AS RESULT ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '01', DD.VAL, 0)) AS JAN ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '02', DD.VAL, 0)) AS FEB ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '03', DD.VAL, 0)) AS MAR ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '04', DD.VAL, 0)) AS APR ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '05', DD.VAL, 0)) AS MAY ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '06', DD.VAL, 0)) AS JUN ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '07', DD.VAL, 0)) AS JUL ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '08', DD.VAL, 0)) AS AUG ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '09', DD.VAL, 0)) AS SEP ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '10', DD.VAL, 0)) AS OCT ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '11', DD.VAL, 0)) AS NOV ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '12', DD.VAL, 0)) AS DEC ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, 'S.TTL', DD.VAL, 0)) AS DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT BB.PLN_YR ," ).append("\n"); 
		query.append("          BB.DE_YR ," ).append("\n"); 
		query.append("          BB.AGMT_NO ," ).append("\n"); 
		query.append("          BB.MFT_VNDR_SEQ ," ).append("\n"); 
		query.append("          BB.DEL_CD ," ).append("\n"); 
		query.append("          BB.CNTR_TPSZ_CD ," ).append("\n"); 
		query.append("          NVL(BB.DE_MON, 'S.TTL') AS DE_MON ," ).append("\n"); 
		query.append("          TP.TYPE_CD ," ).append("\n"); 
		query.append("          DECODE(TP.TYPE_CD, 1, BB.PLAN_DE_QTY, 2, BB.PFMC_DE_QTY, DECODE(BB.PLAN_DE_QTY, 0, 0, ROUND(BB.PFMC_DE_QTY/BB.PLAN_DE_QTY*100, 2)) ) AS VAL," ).append("\n"); 
		query.append("          DECODE(BB.GRP_ID, 1, 0, GRP_ID) AS GRP_ID" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT AA.PLN_YR ," ).append("\n"); 
		query.append("              AA.DE_YR ," ).append("\n"); 
		query.append("              AA.MFT_VNDR_SEQ ," ).append("\n"); 
		query.append("              AA.AGMT_NO ," ).append("\n"); 
		query.append("              AA.DEL_CD ," ).append("\n"); 
		query.append("              AA.CNTR_TPSZ_CD ," ).append("\n"); 
		query.append("              AA.DE_MON ," ).append("\n"); 
		query.append("              SUM(AA.PLAN_DE_QTY) AS PLAN_DE_QTY ," ).append("\n"); 
		query.append("              SUM(AA.PFMC_DE_QTY) AS PFMC_DE_QTY ," ).append("\n"); 
		query.append("              GROUPING_ID ( AA.PLN_YR , AA.DE_YR , AA.MFT_VNDR_SEQ , AA.AGMT_NO , AA.DEL_CD , AA.CNTR_TPSZ_CD , AA.DE_MON ) GRP_ID" ).append("\n"); 
		query.append("            FROM (" ).append("\n"); 
		query.append("                SELECT A.PLN_YR ," ).append("\n"); 
		query.append("                  SUBSTR(A.DE_YRMON, 0, 4) AS DE_YR ," ).append("\n"); 
		query.append("                  A.MFT_VNDR_SEQ ," ).append("\n"); 
		query.append("                  A.AGMT_NO ," ).append("\n"); 
		query.append("                  A.DEL_CD ," ).append("\n"); 
		query.append("                  A.CNTR_TPSZ_CD ," ).append("\n"); 
		query.append("                  SUBSTR(A.DE_YRMON, 5, 2) AS DE_MON ," ).append("\n"); 
		query.append("                  SUM(A.PLAN_DE_QTY) AS PLAN_DE_QTY ," ).append("\n"); 
		query.append("                  SUM(A.PFMC_DE_QTY) AS PFMC_DE_QTY" ).append("\n"); 
		query.append("                FROM (" ).append("\n"); 
		query.append("                    SELECT PLN.PLN_YR ," ).append("\n"); 
		query.append("                      PLN.DE_YRMON ," ).append("\n"); 
		query.append("                      PLN.MFT_VNDR_SEQ ," ).append("\n"); 
		query.append("                      PLN.AGMT_CTY_CD || LPAD(PLN.AGMT_SEQ, 6, '0') AS AGMT_NO ," ).append("\n"); 
		query.append("                      C.LCC_CD AS DEL_CD ," ).append("\n"); 
		query.append("                      PLN.CNTR_TPSZ_CD ," ).append("\n"); 
		query.append("                      PLN.DE_QTY AS PLAN_DE_QTY ," ).append("\n"); 
		query.append("                      0 AS PFMC_DE_QTY," ).append("\n"); 
		query.append("					  C.RCC_CD, C.LCC_CD, C.SCC_CD" ).append("\n"); 
		query.append("                    FROM LSE_LONG_TERM_DE_PLN PLN," ).append("\n"); 
		query.append("					     MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("                    WHERE 1 = 1" ).append("\n"); 
		query.append("					  AND PLN.DEL_CD = C.SCC_CD" ).append("\n"); 
		query.append("                      AND PLN.AGMT_CTY_CD = 'HHO'" ).append("\n"); 
		query.append("                      AND DE_YRMON BETWEEN @[period_stdt] AND @[period_eddt]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd_str} != '' )" ).append("\n"); 
		query.append("                      AND PLN.CNTR_TPSZ_CD IN( #foreach($key IN ${cntr_tpsz_cd})" ).append("\n"); 
		query.append("                                      #if($velocityCount < $cntr_tpsz_cd.size())" ).append("\n"); 
		query.append("                                          '$key'," ).append("\n"); 
		query.append("                                      #else" ).append("\n"); 
		query.append("                                          '$key'" ).append("\n"); 
		query.append("                                      #end" ).append("\n"); 
		query.append("                                  #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${vndr_seq_str} != '' )" ).append("\n"); 
		query.append("          AND PLN.MFT_VNDR_SEQ IN( #foreach($key IN ${vndr_seq})" ).append("\n"); 
		query.append("                                      #if($velocityCount < $vndr_seq.size())" ).append("\n"); 
		query.append("                                          '$key'," ).append("\n"); 
		query.append("                                      #else" ).append("\n"); 
		query.append("                                          '$key'" ).append("\n"); 
		query.append("                                      #end" ).append("\n"); 
		query.append("                                  #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${loc_cd} != '')" ).append("\n"); 
		query.append("	#if (${loc_tp} == 'R')" ).append("\n"); 
		query.append("        AND C.RCC_CD  IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                           		#if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                	'$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                           #end )" ).append("\n"); 
		query.append("	#elseif (${loc_tp} == 'L')" ).append("\n"); 
		query.append("        AND	C.LCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                                #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                    '$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                          #end )" ).append("\n"); 
		query.append("	#elseif (${loc_tp} == 'S')" ).append("\n"); 
		query.append("        AND	C.SCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                                #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                    '$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                          #end )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    UNION ALL " ).append("\n"); 
		query.append("                    SELECT PLN.PLN_YR ," ).append("\n"); 
		query.append("                      TO_CHAR(HS.CNTR_STS_EVNT_DT, 'YYYYMM') AS DE_YRMON ," ).append("\n"); 
		query.append("                      CN.VNDR_SEQ AS MFT_VNDR_SEQ ," ).append("\n"); 
		query.append("                      HS.AGMT_CTY_CD || LPAD(HS.AGMT_SEQ, 6, '0') AS AGMT_NO ," ).append("\n"); 
		query.append("                      HS.LCC_CD AS DEL_CD ," ).append("\n"); 
		query.append("                      CN.CNTR_TPSZ_CD ," ).append("\n"); 
		query.append("                      0 AS PLAN_DE_QTY ," ).append("\n"); 
		query.append("                      COUNT(CN.CNTR_NO) AS PFMC_DE_QTY," ).append("\n"); 
		query.append("					  HS.RCC_CD, HS.LCC_CD, HS.SCC_CD" ).append("\n"); 
		query.append("                    FROM MST_CONTAINER CN ," ).append("\n"); 
		query.append("                      MST_CNTR_STS_HIS HS ," ).append("\n"); 
		query.append("                      (" ).append("\n"); 
		query.append("                        SELECT DISTINCT PLN_YR," ).append("\n"); 
		query.append("                          AGMT_CTY_CD," ).append("\n"); 
		query.append("                          AGMT_SEQ" ).append("\n"); 
		query.append("                        FROM LSE_LONG_TERM_DE_PLN" ).append("\n"); 
		query.append("                        WHERE 1 = 1" ).append("\n"); 
		query.append("                          AND AGMT_CTY_CD = 'HHO'" ).append("\n"); 
		query.append("                          AND DE_YRMON BETWEEN @[period_stdt] AND @[period_eddt]" ).append("\n"); 
		query.append("                          ) PLN" ).append("\n"); 
		query.append("                    WHERE 1 = 1" ).append("\n"); 
		query.append("                      AND CN.CNTR_NO = HS.CNTR_NO" ).append("\n"); 
		query.append("-- T-project 특정 오피스 예외사항 제거" ).append("\n"); 
		query.append("--                    AND SUBSTR(nvl(HS.CNTR_STS_RMK, ' '), 1, 6) <> 'SELLOE'" ).append("\n"); 
		query.append("                      AND HS.CNTR_LSTM_CNG_FLG <> 'Y'" ).append("\n"); 
		query.append("                      AND HS.CNTR_STS_EVNT_DT BETWEEN TO_DATE(@[period_stdt] , 'YYYYMM' ) AND last_day(to_date(@[period_eddt],'YYYYMM'))+0.99999 " ).append("\n"); 
		query.append("                      AND HS.CNTR_STS_CD in ('LSI', 'DII')" ).append("\n"); 
		query.append("                      AND HS.AGMT_SEQ = PLN.AGMT_SEQ(+)" ).append("\n"); 
		query.append("                      AND HS.AGMT_CTY_CD = PLN.AGMT_CTY_CD(+)" ).append("\n"); 
		query.append("					  AND CN.LSTM_CD = 'LT'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd_str} != '' )" ).append("\n"); 
		query.append("                      AND CN.CNTR_TPSZ_CD IN( #foreach($key IN ${cntr_tpsz_cd})" ).append("\n"); 
		query.append("                                      #if($velocityCount < $cntr_tpsz_cd.size())" ).append("\n"); 
		query.append("                                          '$key'," ).append("\n"); 
		query.append("                                      #else" ).append("\n"); 
		query.append("                                          '$key'" ).append("\n"); 
		query.append("                                      #end" ).append("\n"); 
		query.append("                                  #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${vndr_seq_str} != '' )" ).append("\n"); 
		query.append("          AND CN.VNDR_SEQ IN( #foreach($key IN ${vndr_seq})" ).append("\n"); 
		query.append("                                      #if($velocityCount < $vndr_seq.size())" ).append("\n"); 
		query.append("                                          '$key'," ).append("\n"); 
		query.append("                                      #else" ).append("\n"); 
		query.append("                                          '$key'" ).append("\n"); 
		query.append("                                      #end" ).append("\n"); 
		query.append("                                  #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${loc_cd} != '')" ).append("\n"); 
		query.append("	#if (${loc_tp} == 'R')" ).append("\n"); 
		query.append("        AND HS.RCC_CD  IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                            	#if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                	'$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                            #end )" ).append("\n"); 
		query.append("	#elseif (${loc_tp} == 'L')" ).append("\n"); 
		query.append("        AND	HS.LCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                                #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                    '$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                           #end )" ).append("\n"); 
		query.append("	#elseif (${loc_tp} == 'S')" ).append("\n"); 
		query.append("        AND	HS.SCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                                #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                    '$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                           #end )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("                    GROUP BY PLN.PLN_YR , TO_CHAR(HS.CNTR_STS_EVNT_DT, 'YYYYMM') , HS.AGMT_CTY_CD , HS.AGMT_SEQ , CN.VNDR_SEQ , HS.RCC_CD, HS.LCC_CD, HS.SCC_CD, CN.CNTR_TPSZ_CD ) A" ).append("\n"); 
		query.append("                GROUP BY A.PLN_YR , SUBSTR(A.DE_YRMON, 0, 4) , A.MFT_VNDR_SEQ , A.AGMT_NO , A.DEL_CD , A.CNTR_TPSZ_CD , SUBSTR(A.DE_YRMON, 5, 2) ) AA" ).append("\n"); 
		query.append("            GROUP BY CUBE ( AA.PLN_YR , AA.DE_YR , AA.MFT_VNDR_SEQ , AA.AGMT_NO , AA.DEL_CD , AA.CNTR_TPSZ_CD , AA.DE_MON )" ).append("\n"); 
		query.append("            ORDER BY GRP_ID ) BB ," ).append("\n"); 
		query.append("          (" ).append("\n"); 
		query.append("            SELECT LEVEL TYPE_CD" ).append("\n"); 
		query.append("            FROM DUAL CONNECT BY LEVEL <= 3 ) TP" ).append("\n"); 
		query.append("        WHERE GRP_ID IN (0," ).append("\n"); 
		query.append("              1) ) DD ," ).append("\n"); 
		query.append("      MDM_VENDOR VNDR" ).append("\n"); 
		query.append("    WHERE DD.MFT_VNDR_SEQ = VNDR.VNDR_SEQ(+)" ).append("\n"); 
		query.append("    GROUP BY DD.PLN_YR , DD.DE_YR , DD.MFT_VNDR_SEQ , VNDR.VNDR_ABBR_NM , DD.AGMT_NO , DD.DEL_CD , DD.CNTR_TPSZ_CD , DD.TYPE_CD" ).append("\n"); 
		query.append("    ORDER BY DD.PLN_YR , DD.DE_YR , DD.AGMT_NO , DD.MFT_VNDR_SEQ , DD.DEL_CD , DD.CNTR_TPSZ_CD , DD.TYPE_CD )" ).append("\n"); 
		query.append("   SELECT YEAR_MONTH," ).append("\n"); 
		query.append("      AGMT_NO ," ).append("\n"); 
		query.append("      LSTM_CD," ).append("\n"); 
		query.append("      LOC_CD," ).append("\n"); 
		query.append("      TYSZ," ).append("\n"); 
		query.append("      SUPPLIER," ).append("\n"); 
		query.append("      RESULT," ).append("\n"); 
		query.append("      RSLT_TP_SEQ," ).append("\n"); 
		query.append("      JAN," ).append("\n"); 
		query.append("      FEB ," ).append("\n"); 
		query.append("      MAR," ).append("\n"); 
		query.append("      APR," ).append("\n"); 
		query.append("      MAY," ).append("\n"); 
		query.append("      JUN," ).append("\n"); 
		query.append("      JUL," ).append("\n"); 
		query.append("      AUG," ).append("\n"); 
		query.append("      SEP," ).append("\n"); 
		query.append("      OCT," ).append("\n"); 
		query.append("      NOV," ).append("\n"); 
		query.append("      DEC," ).append("\n"); 
		query.append("      DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("    SELECT YEAR_MONTH," ).append("\n"); 
		query.append("      AGMT_NO ," ).append("\n"); 
		query.append("      LSTM_CD," ).append("\n"); 
		query.append("      LOC_CD," ).append("\n"); 
		query.append("      TYSZ," ).append("\n"); 
		query.append("      SUPPLIER," ).append("\n"); 
		query.append("      RESULT," ).append("\n"); 
		query.append("      RSLT_TP_SEQ," ).append("\n"); 
		query.append("      JAN," ).append("\n"); 
		query.append("      FEB ," ).append("\n"); 
		query.append("      MAR," ).append("\n"); 
		query.append("      APR," ).append("\n"); 
		query.append("      MAY," ).append("\n"); 
		query.append("      JUN," ).append("\n"); 
		query.append("      JUL," ).append("\n"); 
		query.append("      AUG," ).append("\n"); 
		query.append("      SEP," ).append("\n"); 
		query.append("      OCT," ).append("\n"); 
		query.append("      NOV," ).append("\n"); 
		query.append("      DEC," ).append("\n"); 
		query.append("      DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          AGMT_NO ," ).append("\n"); 
		query.append("          LSTM_CD," ).append("\n"); 
		query.append("          LOC_CD," ).append("\n"); 
		query.append("          TYSZ," ).append("\n"); 
		query.append("          SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          JAN," ).append("\n"); 
		query.append("          FEB ," ).append("\n"); 
		query.append("          MAR," ).append("\n"); 
		query.append("          APR," ).append("\n"); 
		query.append("          MAY," ).append("\n"); 
		query.append("          JUN," ).append("\n"); 
		query.append("          JUL," ).append("\n"); 
		query.append("          AUG," ).append("\n"); 
		query.append("          SEP," ).append("\n"); 
		query.append("          OCT," ).append("\n"); 
		query.append("          NOV," ).append("\n"); 
		query.append("          DEC," ).append("\n"); 
		query.append("          DIV_TOTAL" ).append("\n"); 
		query.append("        FROM TEMP_DROP" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          AGMT_NO ," ).append("\n"); 
		query.append("          'LT' LSTM_CD," ).append("\n"); 
		query.append("          LOC_CD," ).append("\n"); 
		query.append("          TYSZ," ).append("\n"); 
		query.append("          SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          JAN," ).append("\n"); 
		query.append("          FEB ," ).append("\n"); 
		query.append("          MAR," ).append("\n"); 
		query.append("          APR," ).append("\n"); 
		query.append("          MAY," ).append("\n"); 
		query.append("          JUN," ).append("\n"); 
		query.append("          JUL," ).append("\n"); 
		query.append("          AUG," ).append("\n"); 
		query.append("          SEP," ).append("\n"); 
		query.append("          OCT," ).append("\n"); 
		query.append("          NOV," ).append("\n"); 
		query.append("          DEC," ).append("\n"); 
		query.append("          DIV_TOTAL" ).append("\n"); 
		query.append("        FROM LT_VIEW )" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT YEAR_MONTH," ).append("\n"); 
		query.append("      'S.TTL' AGMT_NO ," ).append("\n"); 
		query.append("      NULL LSTM_CD," ).append("\n"); 
		query.append("      NULL LOC_CD," ).append("\n"); 
		query.append("      NULL TYSZ," ).append("\n"); 
		query.append("      NULL SUPPLIER," ).append("\n"); 
		query.append("      RESULT," ).append("\n"); 
		query.append("      RSLT_TP_SEQ," ).append("\n"); 
		query.append("      SUM(JAN) JAN," ).append("\n"); 
		query.append("      SUM(FEB) FEB," ).append("\n"); 
		query.append("      SUM(MAR) MAR," ).append("\n"); 
		query.append("      SUM(APR) APR," ).append("\n"); 
		query.append("      SUM(MAY) MAY," ).append("\n"); 
		query.append("      SUM(JUN) JUN," ).append("\n"); 
		query.append("      SUM(JUL) JUL," ).append("\n"); 
		query.append("      SUM(AUG) AUG," ).append("\n"); 
		query.append("      SUM(SEP) SEP," ).append("\n"); 
		query.append("      SUM(OCT) OCT," ).append("\n"); 
		query.append("      SUM(NOV) NOV," ).append("\n"); 
		query.append("      SUM(DEC) DEC," ).append("\n"); 
		query.append("      SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          AGMT_NO ," ).append("\n"); 
		query.append("          LSTM_CD," ).append("\n"); 
		query.append("          LOC_CD," ).append("\n"); 
		query.append("          TYSZ," ).append("\n"); 
		query.append("          SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          JAN," ).append("\n"); 
		query.append("          FEB ," ).append("\n"); 
		query.append("          MAR," ).append("\n"); 
		query.append("          APR," ).append("\n"); 
		query.append("          MAY," ).append("\n"); 
		query.append("          JUN," ).append("\n"); 
		query.append("          JUL," ).append("\n"); 
		query.append("          AUG," ).append("\n"); 
		query.append("          SEP," ).append("\n"); 
		query.append("          OCT," ).append("\n"); 
		query.append("          NOV," ).append("\n"); 
		query.append("          DEC," ).append("\n"); 
		query.append("          DIV_TOTAL" ).append("\n"); 
		query.append("        FROM TEMP_DROP" ).append("\n"); 
		query.append("        WHERE RSLT_TP_SEQ < 3" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          AGMT_NO ," ).append("\n"); 
		query.append("          'LT' LSTM_CD," ).append("\n"); 
		query.append("          LOC_CD," ).append("\n"); 
		query.append("          TYSZ," ).append("\n"); 
		query.append("          SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          JAN," ).append("\n"); 
		query.append("          FEB ," ).append("\n"); 
		query.append("          MAR," ).append("\n"); 
		query.append("          APR," ).append("\n"); 
		query.append("          MAY," ).append("\n"); 
		query.append("          JUN," ).append("\n"); 
		query.append("          JUL," ).append("\n"); 
		query.append("          AUG," ).append("\n"); 
		query.append("          SEP," ).append("\n"); 
		query.append("          OCT," ).append("\n"); 
		query.append("          NOV," ).append("\n"); 
		query.append("          DEC," ).append("\n"); 
		query.append("          DIV_TOTAL" ).append("\n"); 
		query.append("        FROM LT_VIEW" ).append("\n"); 
		query.append("        WHERE RSLT_TP_SEQ < 3 )" ).append("\n"); 
		query.append("    GROUP BY YEAR_MONTH, RESULT, RSLT_TP_SEQ" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT P.YEAR_MONTH," ).append("\n"); 
		query.append("      'S.TTL' AGMT_NO ," ).append("\n"); 
		query.append("      NULL LSTM_CD," ).append("\n"); 
		query.append("      NULL LOC_CD," ).append("\n"); 
		query.append("      NULL TYSZ," ).append("\n"); 
		query.append("      NULL SUPPLIER," ).append("\n"); 
		query.append("      'Ratio' RESULT," ).append("\n"); 
		query.append("      3 RSLT_TP_SEQ," ).append("\n"); 
		query.append("      CASE WHEN P.JAN > 0" ).append("\n"); 
		query.append("      AND F.JAN > 0 THEN ROUND((F.JAN / P.JAN) * 100 ) ELSE 0 END JAN ," ).append("\n"); 
		query.append("      CASE WHEN P.FEB > 0" ).append("\n"); 
		query.append("      AND F.FEB > 0 THEN ROUND((F.FEB / P.FEB) * 100 ) ELSE 0 END FEB ," ).append("\n"); 
		query.append("      CASE WHEN P.MAR > 0" ).append("\n"); 
		query.append("      AND F.MAR > 0 THEN ROUND((F.MAR / P.MAR) * 100 ) ELSE 0 END MAR ," ).append("\n"); 
		query.append("      CASE WHEN P.APR > 0" ).append("\n"); 
		query.append("      AND F.APR > 0 THEN ROUND((F.APR / P.APR) * 100 ) ELSE 0 END APR ," ).append("\n"); 
		query.append("      CASE WHEN P.MAY > 0" ).append("\n"); 
		query.append("      AND F.MAY > 0 THEN ROUND((F.MAY / P.MAY) * 100 ) ELSE 0 END MAY ," ).append("\n"); 
		query.append("      CASE WHEN P.JUN > 0" ).append("\n"); 
		query.append("      AND F.JUN > 0 THEN ROUND((F.JUN / P.JUN) * 100 ) ELSE 0 END JUN ," ).append("\n"); 
		query.append("      CASE WHEN P.JUL > 0" ).append("\n"); 
		query.append("      AND F.JUL > 0 THEN ROUND((F.JUL / P.JUL) * 100 ) ELSE 0 END JUL ," ).append("\n"); 
		query.append("      CASE WHEN P.AUG > 0" ).append("\n"); 
		query.append("      AND F.AUG > 0 THEN ROUND((F.AUG / P.AUG) * 100 ) ELSE 0 END AUG ," ).append("\n"); 
		query.append("      CASE WHEN P.SEP > 0" ).append("\n"); 
		query.append("      AND F.SEP > 0 THEN ROUND((F.SEP / P.SEP) * 100 ) ELSE 0 END SEP ," ).append("\n"); 
		query.append("      CASE WHEN P.OCT > 0" ).append("\n"); 
		query.append("      AND F.OCT > 0 THEN ROUND((F.OCT / P.OCT) * 100 ) ELSE 0 END OCT ," ).append("\n"); 
		query.append("      CASE WHEN P.NOV > 0" ).append("\n"); 
		query.append("      AND F.NOV > 0 THEN ROUND((F.NOV / P.NOV) * 100 ) ELSE 0 END NOV ," ).append("\n"); 
		query.append("      CASE WHEN P.DEC > 0" ).append("\n"); 
		query.append("      AND F.DEC > 0 THEN ROUND((F.DEC / P.DEC) * 100 ) ELSE 0 END DEC ," ).append("\n"); 
		query.append("      CASE WHEN P.DIV_TOTAL > 0" ).append("\n"); 
		query.append("      AND F.DIV_TOTAL > 0 THEN ROUND((F.DIV_TOTAL / P.DIV_TOTAL) * 100 ) ELSE 0 END DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          NULL AGMT_NO ," ).append("\n"); 
		query.append("          NULL LSTM_CD," ).append("\n"); 
		query.append("          NULL LOC_CD," ).append("\n"); 
		query.append("          NULL TYSZ," ).append("\n"); 
		query.append("          NULL SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          SUM(JAN) JAN," ).append("\n"); 
		query.append("          SUM(FEB) FEB," ).append("\n"); 
		query.append("          SUM(MAR) MAR," ).append("\n"); 
		query.append("          SUM(APR) APR," ).append("\n"); 
		query.append("          SUM(MAY) MAY," ).append("\n"); 
		query.append("          SUM(JUN) JUN," ).append("\n"); 
		query.append("          SUM(JUL) JUL," ).append("\n"); 
		query.append("          SUM(AUG) AUG," ).append("\n"); 
		query.append("          SUM(SEP) SEP," ).append("\n"); 
		query.append("          SUM(OCT) OCT," ).append("\n"); 
		query.append("          SUM(NOV) NOV," ).append("\n"); 
		query.append("          SUM(DEC) DEC," ).append("\n"); 
		query.append("          SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM TEMP_DROP" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 1" ).append("\n"); 
		query.append("            UNION ALL" ).append("\n"); 
		query.append("            SELECT YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              'LT' LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM LT_VIEW" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 1 )" ).append("\n"); 
		query.append("        GROUP BY YEAR_MONTH, RESULT, RSLT_TP_SEQ ) P ," ).append("\n"); 
		query.append("      (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          NULL AGMT_NO ," ).append("\n"); 
		query.append("          NULL LSTM_CD," ).append("\n"); 
		query.append("          NULL LOC_CD," ).append("\n"); 
		query.append("          NULL TYSZ," ).append("\n"); 
		query.append("          NULL SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          SUM(JAN) JAN," ).append("\n"); 
		query.append("          SUM(FEB) FEB," ).append("\n"); 
		query.append("          SUM(MAR) MAR," ).append("\n"); 
		query.append("          SUM(APR) APR," ).append("\n"); 
		query.append("          SUM(MAY) MAY," ).append("\n"); 
		query.append("          SUM(JUN) JUN," ).append("\n"); 
		query.append("          SUM(JUL) JUL," ).append("\n"); 
		query.append("          SUM(AUG) AUG," ).append("\n"); 
		query.append("          SUM(SEP) SEP," ).append("\n"); 
		query.append("          SUM(OCT) OCT," ).append("\n"); 
		query.append("          SUM(NOV) NOV," ).append("\n"); 
		query.append("          SUM(DEC) DEC," ).append("\n"); 
		query.append("          SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM TEMP_DROP" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 2" ).append("\n"); 
		query.append("            UNION ALL" ).append("\n"); 
		query.append("            SELECT YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              'LT' LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM LT_VIEW" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 2 )" ).append("\n"); 
		query.append("        GROUP BY YEAR_MONTH, RESULT, RSLT_TP_SEQ ) F" ).append("\n"); 
		query.append("    WHERE P.YEAR_MONTH = F.YEAR_MONTH " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT " ).append("\n"); 
		query.append("      'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("      NULL AGMT_NO ," ).append("\n"); 
		query.append("      NULL LSTM_CD," ).append("\n"); 
		query.append("      NULL LOC_CD," ).append("\n"); 
		query.append("      NULL TYSZ," ).append("\n"); 
		query.append("      NULL SUPPLIER," ).append("\n"); 
		query.append("      RESULT," ).append("\n"); 
		query.append("      RSLT_TP_SEQ," ).append("\n"); 
		query.append("      SUM(JAN) JAN," ).append("\n"); 
		query.append("      SUM(FEB) FEB," ).append("\n"); 
		query.append("      SUM(MAR) MAR," ).append("\n"); 
		query.append("      SUM(APR) APR," ).append("\n"); 
		query.append("      SUM(MAY) MAY," ).append("\n"); 
		query.append("      SUM(JUN) JUN," ).append("\n"); 
		query.append("      SUM(JUL) JUL," ).append("\n"); 
		query.append("      SUM(AUG) AUG," ).append("\n"); 
		query.append("      SUM(SEP) SEP," ).append("\n"); 
		query.append("      SUM(OCT) OCT," ).append("\n"); 
		query.append("      SUM(NOV) NOV," ).append("\n"); 
		query.append("      SUM(DEC) DEC," ).append("\n"); 
		query.append("      SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          AGMT_NO ," ).append("\n"); 
		query.append("          LSTM_CD," ).append("\n"); 
		query.append("          LOC_CD," ).append("\n"); 
		query.append("          TYSZ," ).append("\n"); 
		query.append("          SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          JAN," ).append("\n"); 
		query.append("          FEB ," ).append("\n"); 
		query.append("          MAR," ).append("\n"); 
		query.append("          APR," ).append("\n"); 
		query.append("          MAY," ).append("\n"); 
		query.append("          JUN," ).append("\n"); 
		query.append("          JUL," ).append("\n"); 
		query.append("          AUG," ).append("\n"); 
		query.append("          SEP," ).append("\n"); 
		query.append("          OCT," ).append("\n"); 
		query.append("          NOV," ).append("\n"); 
		query.append("          DEC," ).append("\n"); 
		query.append("          DIV_TOTAL" ).append("\n"); 
		query.append("        FROM TEMP_DROP" ).append("\n"); 
		query.append("        WHERE RSLT_TP_SEQ < 3" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          AGMT_NO ," ).append("\n"); 
		query.append("          'LT' LSTM_CD," ).append("\n"); 
		query.append("          LOC_CD," ).append("\n"); 
		query.append("          TYSZ," ).append("\n"); 
		query.append("          SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          JAN," ).append("\n"); 
		query.append("          FEB ," ).append("\n"); 
		query.append("          MAR," ).append("\n"); 
		query.append("          APR," ).append("\n"); 
		query.append("          MAY," ).append("\n"); 
		query.append("          JUN," ).append("\n"); 
		query.append("          JUL," ).append("\n"); 
		query.append("          AUG," ).append("\n"); 
		query.append("          SEP," ).append("\n"); 
		query.append("          OCT," ).append("\n"); 
		query.append("          NOV," ).append("\n"); 
		query.append("          DEC," ).append("\n"); 
		query.append("          DIV_TOTAL" ).append("\n"); 
		query.append("        FROM LT_VIEW" ).append("\n"); 
		query.append("        WHERE RSLT_TP_SEQ < 3 )" ).append("\n"); 
		query.append("    GROUP BY RESULT, RSLT_TP_SEQ" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT" ).append("\n"); 
		query.append("      'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("      NULL AGMT_NO ," ).append("\n"); 
		query.append("      NULL LSTM_CD," ).append("\n"); 
		query.append("      NULL LOC_CD," ).append("\n"); 
		query.append("      NULL TYSZ," ).append("\n"); 
		query.append("      NULL SUPPLIER," ).append("\n"); 
		query.append("      'Ratio' RESULT," ).append("\n"); 
		query.append("      3 RSLT_TP_SEQ," ).append("\n"); 
		query.append("      CASE WHEN P.JAN > 0" ).append("\n"); 
		query.append("      AND F.JAN > 0 THEN ROUND((F.JAN / P.JAN) * 100 ) ELSE 0 END JAN ," ).append("\n"); 
		query.append("      CASE WHEN P.FEB > 0" ).append("\n"); 
		query.append("      AND F.FEB > 0 THEN ROUND((F.FEB / P.FEB) * 100 ) ELSE 0 END FEB ," ).append("\n"); 
		query.append("      CASE WHEN P.MAR > 0" ).append("\n"); 
		query.append("      AND F.MAR > 0 THEN ROUND((F.MAR / P.MAR) * 100 ) ELSE 0 END MAR ," ).append("\n"); 
		query.append("      CASE WHEN P.APR > 0" ).append("\n"); 
		query.append("      AND F.APR > 0 THEN ROUND((F.APR / P.APR) * 100 ) ELSE 0 END APR ," ).append("\n"); 
		query.append("      CASE WHEN P.MAY > 0" ).append("\n"); 
		query.append("      AND F.MAY > 0 THEN ROUND((F.MAY / P.MAY) * 100 ) ELSE 0 END MAY ," ).append("\n"); 
		query.append("      CASE WHEN P.JUN > 0" ).append("\n"); 
		query.append("      AND F.JUN > 0 THEN ROUND((F.JUN / P.JUN) * 100 ) ELSE 0 END JUN ," ).append("\n"); 
		query.append("      CASE WHEN P.JUL > 0" ).append("\n"); 
		query.append("      AND F.JUL > 0 THEN ROUND((F.JUL / P.JUL) * 100 ) ELSE 0 END JUL ," ).append("\n"); 
		query.append("      CASE WHEN P.AUG > 0" ).append("\n"); 
		query.append("      AND F.AUG > 0 THEN ROUND((F.AUG / P.AUG) * 100 ) ELSE 0 END AUG ," ).append("\n"); 
		query.append("      CASE WHEN P.SEP > 0" ).append("\n"); 
		query.append("      AND F.SEP > 0 THEN ROUND((F.SEP / P.SEP) * 100 ) ELSE 0 END SEP ," ).append("\n"); 
		query.append("      CASE WHEN P.OCT > 0" ).append("\n"); 
		query.append("      AND F.OCT > 0 THEN ROUND((F.OCT / P.OCT) * 100 ) ELSE 0 END OCT ," ).append("\n"); 
		query.append("      CASE WHEN P.NOV > 0" ).append("\n"); 
		query.append("      AND F.NOV > 0 THEN ROUND((F.NOV / P.NOV) * 100 ) ELSE 0 END NOV ," ).append("\n"); 
		query.append("      CASE WHEN P.DEC > 0" ).append("\n"); 
		query.append("      AND F.DEC > 0 THEN ROUND((F.DEC / P.DEC) * 100 ) ELSE 0 END DEC ," ).append("\n"); 
		query.append("      CASE WHEN P.DIV_TOTAL > 0" ).append("\n"); 
		query.append("      AND F.DIV_TOTAL > 0 THEN ROUND((F.DIV_TOTAL / P.DIV_TOTAL) * 100 ) ELSE 0 END DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT " ).append("\n"); 
		query.append("          'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("          NULL AGMT_NO ," ).append("\n"); 
		query.append("          NULL LSTM_CD," ).append("\n"); 
		query.append("          NULL LOC_CD," ).append("\n"); 
		query.append("          NULL TYSZ," ).append("\n"); 
		query.append("          NULL SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          SUM(JAN) JAN," ).append("\n"); 
		query.append("          SUM(FEB) FEB," ).append("\n"); 
		query.append("          SUM(MAR) MAR," ).append("\n"); 
		query.append("          SUM(APR) APR," ).append("\n"); 
		query.append("          SUM(MAY) MAY," ).append("\n"); 
		query.append("          SUM(JUN) JUN," ).append("\n"); 
		query.append("          SUM(JUL) JUL," ).append("\n"); 
		query.append("          SUM(AUG) AUG," ).append("\n"); 
		query.append("          SUM(SEP) SEP," ).append("\n"); 
		query.append("          SUM(OCT) OCT," ).append("\n"); 
		query.append("          SUM(NOV) NOV," ).append("\n"); 
		query.append("          SUM(DEC) DEC," ).append("\n"); 
		query.append("          SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT " ).append("\n"); 
		query.append("              YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM TEMP_DROP" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 1" ).append("\n"); 
		query.append("            UNION ALL" ).append("\n"); 
		query.append("            SELECT " ).append("\n"); 
		query.append("              YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              'LT' LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM LT_VIEW" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 1 )" ).append("\n"); 
		query.append("        GROUP BY RESULT, RSLT_TP_SEQ ) P ," ).append("\n"); 
		query.append("      (" ).append("\n"); 
		query.append("        SELECT " ).append("\n"); 
		query.append("          'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("          NULL AGMT_NO ," ).append("\n"); 
		query.append("          NULL LSTM_CD," ).append("\n"); 
		query.append("          NULL LOC_CD," ).append("\n"); 
		query.append("          NULL TYSZ," ).append("\n"); 
		query.append("          NULL SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          SUM(JAN) JAN," ).append("\n"); 
		query.append("          SUM(FEB) FEB," ).append("\n"); 
		query.append("          SUM(MAR) MAR," ).append("\n"); 
		query.append("          SUM(APR) APR," ).append("\n"); 
		query.append("          SUM(MAY) MAY," ).append("\n"); 
		query.append("          SUM(JUN) JUN," ).append("\n"); 
		query.append("          SUM(JUL) JUL," ).append("\n"); 
		query.append("          SUM(AUG) AUG," ).append("\n"); 
		query.append("          SUM(SEP) SEP," ).append("\n"); 
		query.append("          SUM(OCT) OCT," ).append("\n"); 
		query.append("          SUM(NOV) NOV," ).append("\n"); 
		query.append("          SUM(DEC) DEC," ).append("\n"); 
		query.append("          SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT " ).append("\n"); 
		query.append("              'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM TEMP_DROP" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 2" ).append("\n"); 
		query.append("            UNION ALL" ).append("\n"); 
		query.append("            SELECT " ).append("\n"); 
		query.append("              'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              'LT' LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM LT_VIEW" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 2 )" ).append("\n"); 
		query.append("        GROUP BY RESULT, RSLT_TP_SEQ ) F" ).append("\n"); 
		query.append("    WHERE P.YEAR_MONTH = F.YEAR_MONTH )" ).append("\n"); 
		query.append("ORDER BY YEAR_MONTH ,AGMT_NO,LSTM_CD,LOC_CD,TYSZ,SUPPLIER,RSLT_TP_SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("--===================================================ALL end    " ).append("\n"); 
		query.append("#elseif (${lstm_cd_str} == 'LT' ) " ).append("\n"); 
		query.append("---========================================================LT start" ).append("\n"); 
		query.append("WITH LT_VIEW AS (" ).append("\n"); 
		query.append("    SELECT " ).append("\n"); 
		query.append("      DD.PLN_YR ," ).append("\n"); 
		query.append("      DD.DE_YR AS YEAR_MONTH," ).append("\n"); 
		query.append("      NVL(DD.AGMT_NO, 'G.TTL') AS AGMT_NO ," ).append("\n"); 
		query.append("     'LT' LSTM_CD," ).append("\n"); 
		query.append("      NVL2(DD.MFT_VNDR_SEQ, SUBSTR(VNDR.VNDR_ABBR_NM, 0, 3), 'TTL') AS SUPPLIER ," ).append("\n"); 
		query.append("      DD.DEL_CD AS LOC_CD," ).append("\n"); 
		query.append("      DD.CNTR_TPSZ_CD AS TYSZ," ).append("\n"); 
		query.append("      DD.TYPE_CD AS RSLT_TP_SEQ ," ).append("\n"); 
		query.append("      DECODE(DD.TYPE_CD, 1, 'Plan', 2, 'PFMC', 3, 'Ratio') AS RESULT ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '01', DD.VAL, 0)) AS JAN ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '02', DD.VAL, 0)) AS FEB ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '03', DD.VAL, 0)) AS MAR ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '04', DD.VAL, 0)) AS APR ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '05', DD.VAL, 0)) AS MAY ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '06', DD.VAL, 0)) AS JUN ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '07', DD.VAL, 0)) AS JUL ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '08', DD.VAL, 0)) AS AUG ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '09', DD.VAL, 0)) AS SEP ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '10', DD.VAL, 0)) AS OCT ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '11', DD.VAL, 0)) AS NOV ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, '12', DD.VAL, 0)) AS DEC ," ).append("\n"); 
		query.append("      SUM(DECODE(DD.DE_MON, 'S.TTL', DD.VAL, 0)) AS DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT BB.PLN_YR ," ).append("\n"); 
		query.append("          BB.DE_YR ," ).append("\n"); 
		query.append("          BB.AGMT_NO ," ).append("\n"); 
		query.append("          BB.MFT_VNDR_SEQ ," ).append("\n"); 
		query.append("          BB.DEL_CD ," ).append("\n"); 
		query.append("          BB.CNTR_TPSZ_CD ," ).append("\n"); 
		query.append("          NVL(BB.DE_MON, 'S.TTL') AS DE_MON ," ).append("\n"); 
		query.append("          TP.TYPE_CD ," ).append("\n"); 
		query.append("          DECODE(TP.TYPE_CD, 1, BB.PLAN_DE_QTY, 2, BB.PFMC_DE_QTY, DECODE(BB.PLAN_DE_QTY, 0, 0, ROUND(BB.PFMC_DE_QTY/BB.PLAN_DE_QTY*100, 2)) ) AS VAL," ).append("\n"); 
		query.append("          DECODE(BB.GRP_ID, 1, 0, GRP_ID) AS GRP_ID" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT AA.PLN_YR ," ).append("\n"); 
		query.append("              AA.DE_YR ," ).append("\n"); 
		query.append("              AA.MFT_VNDR_SEQ ," ).append("\n"); 
		query.append("              AA.AGMT_NO ," ).append("\n"); 
		query.append("              AA.DEL_CD ," ).append("\n"); 
		query.append("              AA.CNTR_TPSZ_CD ," ).append("\n"); 
		query.append("              AA.DE_MON ," ).append("\n"); 
		query.append("              SUM(AA.PLAN_DE_QTY) AS PLAN_DE_QTY ," ).append("\n"); 
		query.append("              SUM(AA.PFMC_DE_QTY) AS PFMC_DE_QTY ," ).append("\n"); 
		query.append("              GROUPING_ID ( AA.PLN_YR , AA.DE_YR , AA.MFT_VNDR_SEQ , AA.AGMT_NO , AA.DEL_CD , AA.CNTR_TPSZ_CD , AA.DE_MON ) GRP_ID" ).append("\n"); 
		query.append("            FROM (" ).append("\n"); 
		query.append("                SELECT A.PLN_YR ," ).append("\n"); 
		query.append("                  SUBSTR(A.DE_YRMON, 0, 4) AS DE_YR ," ).append("\n"); 
		query.append("                  A.MFT_VNDR_SEQ ," ).append("\n"); 
		query.append("                  A.AGMT_NO ," ).append("\n"); 
		query.append("                  A.DEL_CD ," ).append("\n"); 
		query.append("                  A.CNTR_TPSZ_CD ," ).append("\n"); 
		query.append("                  SUBSTR(A.DE_YRMON, 5, 2) AS DE_MON ," ).append("\n"); 
		query.append("                  SUM(A.PLAN_DE_QTY) AS PLAN_DE_QTY ," ).append("\n"); 
		query.append("                  SUM(A.PFMC_DE_QTY) AS PFMC_DE_QTY" ).append("\n"); 
		query.append("                FROM (" ).append("\n"); 
		query.append("                    SELECT PLN.PLN_YR ," ).append("\n"); 
		query.append("                      PLN.DE_YRMON ," ).append("\n"); 
		query.append("                      PLN.MFT_VNDR_SEQ ," ).append("\n"); 
		query.append("                      PLN.AGMT_CTY_CD || LPAD(PLN.AGMT_SEQ, 6, '0') AS AGMT_NO ," ).append("\n"); 
		query.append("                      C.LCC_CD AS DEL_CD ," ).append("\n"); 
		query.append("                      PLN.CNTR_TPSZ_CD ," ).append("\n"); 
		query.append("                      PLN.DE_QTY AS PLAN_DE_QTY ," ).append("\n"); 
		query.append("                      0 AS PFMC_DE_QTY," ).append("\n"); 
		query.append("					  C.RCC_CD, C.LCC_CD, C.SCC_CD" ).append("\n"); 
		query.append("                    FROM LSE_LONG_TERM_DE_PLN PLN," ).append("\n"); 
		query.append("						 MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("                    WHERE 1 = 1" ).append("\n"); 
		query.append("					  AND PLN.DEL_CD = C.SCC_CD" ).append("\n"); 
		query.append("                      AND PLN.AGMT_CTY_CD = 'HHO'" ).append("\n"); 
		query.append("                      AND DE_YRMON BETWEEN @[period_stdt] AND @[period_eddt]" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd_str} != '' )" ).append("\n"); 
		query.append("                      AND PLN.CNTR_TPSZ_CD IN( #foreach($key IN ${cntr_tpsz_cd})" ).append("\n"); 
		query.append("                                      #if($velocityCount < $cntr_tpsz_cd.size())" ).append("\n"); 
		query.append("                                          '$key'," ).append("\n"); 
		query.append("                                      #else" ).append("\n"); 
		query.append("                                          '$key'" ).append("\n"); 
		query.append("                                      #end" ).append("\n"); 
		query.append("                                  #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${vndr_seq_str} != '' )" ).append("\n"); 
		query.append("          AND PLN.MFT_VNDR_SEQ IN( #foreach($key IN ${vndr_seq})" ).append("\n"); 
		query.append("                                      #if($velocityCount < $vndr_seq.size())" ).append("\n"); 
		query.append("                                          '$key'," ).append("\n"); 
		query.append("                                      #else" ).append("\n"); 
		query.append("                                          '$key'" ).append("\n"); 
		query.append("                                      #end" ).append("\n"); 
		query.append("                                  #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${loc_cd} != '')" ).append("\n"); 
		query.append("	#if (${loc_tp} == 'R')" ).append("\n"); 
		query.append("        AND C.RCC_CD  IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                           		#if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                	'$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                           #end )" ).append("\n"); 
		query.append("	#elseif (${loc_tp} == 'L')" ).append("\n"); 
		query.append("        AND	C.LCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                                #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                    '$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                          #end )" ).append("\n"); 
		query.append("	#elseif (${loc_tp} == 'S')" ).append("\n"); 
		query.append("        AND	C.SCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                                #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                    '$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                          #end )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    UNION ALL " ).append("\n"); 
		query.append("                    SELECT PLN.PLN_YR ," ).append("\n"); 
		query.append("                      TO_CHAR(HS.CNTR_STS_EVNT_DT, 'YYYYMM') AS DE_YRMON ," ).append("\n"); 
		query.append("                      CN.VNDR_SEQ AS MFT_VNDR_SEQ ," ).append("\n"); 
		query.append("                      HS.AGMT_CTY_CD || LPAD(HS.AGMT_SEQ, 6, '0') AS AGMT_NO ," ).append("\n"); 
		query.append("                      HS.LCC_CD AS DEL_CD ," ).append("\n"); 
		query.append("                      CN.CNTR_TPSZ_CD ," ).append("\n"); 
		query.append("                      0 AS PLAN_DE_QTY ," ).append("\n"); 
		query.append("                      COUNT(CN.CNTR_NO) AS PFMC_DE_QTY," ).append("\n"); 
		query.append("					  HS.RCC_CD, HS.LCC_CD, HS.SCC_CD" ).append("\n"); 
		query.append("                    FROM MST_CONTAINER CN ," ).append("\n"); 
		query.append("                      MST_CNTR_STS_HIS HS ," ).append("\n"); 
		query.append("                      (" ).append("\n"); 
		query.append("                        SELECT DISTINCT PLN_YR," ).append("\n"); 
		query.append("                          AGMT_CTY_CD," ).append("\n"); 
		query.append("                          AGMT_SEQ" ).append("\n"); 
		query.append("                        FROM LSE_LONG_TERM_DE_PLN" ).append("\n"); 
		query.append("                        WHERE 1 = 1" ).append("\n"); 
		query.append("                          AND AGMT_CTY_CD = 'HHO'" ).append("\n"); 
		query.append("                          AND DE_YRMON BETWEEN @[period_stdt] AND @[period_eddt]" ).append("\n"); 
		query.append("                          ) PLN" ).append("\n"); 
		query.append("                    WHERE 1 = 1" ).append("\n"); 
		query.append("                      AND CN.CNTR_NO = HS.CNTR_NO" ).append("\n"); 
		query.append("-- T-project 특정 오피스 예외사항 제거" ).append("\n"); 
		query.append("--                      AND SUBSTR(nvl(HS.CNTR_STS_RMK, ' '), 1, 6) <> 'SELLOE'" ).append("\n"); 
		query.append("                      AND HS.CNTR_LSTM_CNG_FLG <> 'Y'" ).append("\n"); 
		query.append("                      AND HS.CNTR_STS_EVNT_DT BETWEEN TO_DATE(@[period_stdt] , 'YYYYMM' ) AND last_day(to_date(@[period_eddt],'YYYYMM'))+0.99999 " ).append("\n"); 
		query.append("                      AND HS.CNTR_STS_CD in ('LSI', 'DII')" ).append("\n"); 
		query.append("                      AND HS.AGMT_SEQ = PLN.AGMT_SEQ(+)" ).append("\n"); 
		query.append("                      AND HS.AGMT_CTY_CD = PLN.AGMT_CTY_CD(+)" ).append("\n"); 
		query.append("					  AND CN.LSTM_CD = 'LT'" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd_str} != '' )" ).append("\n"); 
		query.append("                      AND CN.CNTR_TPSZ_CD IN( #foreach($key IN ${cntr_tpsz_cd})" ).append("\n"); 
		query.append("                                      #if($velocityCount < $cntr_tpsz_cd.size())" ).append("\n"); 
		query.append("                                          '$key'," ).append("\n"); 
		query.append("                                      #else" ).append("\n"); 
		query.append("                                          '$key'" ).append("\n"); 
		query.append("                                      #end" ).append("\n"); 
		query.append("                                  #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${vndr_seq_str} != '' )" ).append("\n"); 
		query.append("          AND CN.VNDR_SEQ IN( #foreach($key IN ${vndr_seq})" ).append("\n"); 
		query.append("                                      #if($velocityCount < $vndr_seq.size())" ).append("\n"); 
		query.append("                                          '$key'," ).append("\n"); 
		query.append("                                      #else" ).append("\n"); 
		query.append("                                          '$key'" ).append("\n"); 
		query.append("                                      #end" ).append("\n"); 
		query.append("                                  #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${loc_cd} != '')" ).append("\n"); 
		query.append("	#if (${loc_tp} == 'R')" ).append("\n"); 
		query.append("        AND HS.SCC_CD  IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                            	#if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                	'$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                            #end )" ).append("\n"); 
		query.append("	#elseif (${loc_tp} == 'L')" ).append("\n"); 
		query.append("        AND	HS.SCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                                #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                    '$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                           #end )" ).append("\n"); 
		query.append("	#elseif (${loc_tp} == 'S')" ).append("\n"); 
		query.append("        AND	HS.SCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                                #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                    '$key'," ).append("\n"); 
		query.append("                                #else" ).append("\n"); 
		query.append("                                    '$key'" ).append("\n"); 
		query.append("                                #end" ).append("\n"); 
		query.append("                           #end )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("                    GROUP BY PLN.PLN_YR , TO_CHAR(HS.CNTR_STS_EVNT_DT, 'YYYYMM') , HS.AGMT_CTY_CD , HS.AGMT_SEQ , CN.VNDR_SEQ , HS.RCC_CD, HS.LCC_CD, HS.SCC_CD , CN.CNTR_TPSZ_CD ) A" ).append("\n"); 
		query.append("                GROUP BY A.PLN_YR , SUBSTR(A.DE_YRMON, 0, 4) , A.MFT_VNDR_SEQ , A.AGMT_NO , A.DEL_CD , A.CNTR_TPSZ_CD , SUBSTR(A.DE_YRMON, 5, 2) ) AA" ).append("\n"); 
		query.append("            GROUP BY CUBE ( AA.PLN_YR , AA.DE_YR , AA.MFT_VNDR_SEQ , AA.AGMT_NO , AA.DEL_CD , AA.CNTR_TPSZ_CD , AA.DE_MON )" ).append("\n"); 
		query.append("            ORDER BY GRP_ID ) BB ," ).append("\n"); 
		query.append("          (" ).append("\n"); 
		query.append("            SELECT LEVEL TYPE_CD" ).append("\n"); 
		query.append("            FROM DUAL CONNECT BY LEVEL <= 3 ) TP" ).append("\n"); 
		query.append("        WHERE GRP_ID IN (0," ).append("\n"); 
		query.append("              1) ) DD ," ).append("\n"); 
		query.append("      MDM_VENDOR VNDR" ).append("\n"); 
		query.append("    WHERE DD.MFT_VNDR_SEQ = VNDR.VNDR_SEQ(+)" ).append("\n"); 
		query.append("    GROUP BY DD.PLN_YR , DD.DE_YR , DD.MFT_VNDR_SEQ , VNDR.VNDR_ABBR_NM , DD.AGMT_NO , DD.DEL_CD , DD.CNTR_TPSZ_CD , DD.TYPE_CD" ).append("\n"); 
		query.append("    ORDER BY DD.PLN_YR , DD.DE_YR , DD.AGMT_NO , DD.MFT_VNDR_SEQ , DD.DEL_CD , DD.CNTR_TPSZ_CD , DD.TYPE_CD )" ).append("\n"); 
		query.append("SELECT YEAR_MONTH," ).append("\n"); 
		query.append("  AGMT_NO ," ).append("\n"); 
		query.append("  LSTM_CD," ).append("\n"); 
		query.append("  LOC_CD," ).append("\n"); 
		query.append("  TYSZ," ).append("\n"); 
		query.append("  SUPPLIER," ).append("\n"); 
		query.append("  RESULT," ).append("\n"); 
		query.append("  RSLT_TP_SEQ," ).append("\n"); 
		query.append("  JAN," ).append("\n"); 
		query.append("  FEB ," ).append("\n"); 
		query.append("  MAR," ).append("\n"); 
		query.append("  APR," ).append("\n"); 
		query.append("  MAY," ).append("\n"); 
		query.append("  JUN," ).append("\n"); 
		query.append("  JUL," ).append("\n"); 
		query.append("  AUG," ).append("\n"); 
		query.append("  SEP," ).append("\n"); 
		query.append("  OCT," ).append("\n"); 
		query.append("  NOV," ).append("\n"); 
		query.append("  DEC," ).append("\n"); 
		query.append("  DIV_TOTAL" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("    SELECT YEAR_MONTH," ).append("\n"); 
		query.append("      AGMT_NO ," ).append("\n"); 
		query.append("      LSTM_CD," ).append("\n"); 
		query.append("      LOC_CD," ).append("\n"); 
		query.append("      TYSZ," ).append("\n"); 
		query.append("      SUPPLIER," ).append("\n"); 
		query.append("      RESULT," ).append("\n"); 
		query.append("      RSLT_TP_SEQ," ).append("\n"); 
		query.append("      JAN," ).append("\n"); 
		query.append("      FEB ," ).append("\n"); 
		query.append("      MAR," ).append("\n"); 
		query.append("      APR," ).append("\n"); 
		query.append("      MAY," ).append("\n"); 
		query.append("      JUN," ).append("\n"); 
		query.append("      JUL," ).append("\n"); 
		query.append("      AUG," ).append("\n"); 
		query.append("      SEP," ).append("\n"); 
		query.append("      OCT," ).append("\n"); 
		query.append("      NOV," ).append("\n"); 
		query.append("      DEC," ).append("\n"); 
		query.append("      DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          AGMT_NO ," ).append("\n"); 
		query.append("          'LT' LSTM_CD," ).append("\n"); 
		query.append("          LOC_CD," ).append("\n"); 
		query.append("          TYSZ," ).append("\n"); 
		query.append("          SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          JAN," ).append("\n"); 
		query.append("          FEB ," ).append("\n"); 
		query.append("          MAR," ).append("\n"); 
		query.append("          APR," ).append("\n"); 
		query.append("          MAY," ).append("\n"); 
		query.append("          JUN," ).append("\n"); 
		query.append("          JUL," ).append("\n"); 
		query.append("          AUG," ).append("\n"); 
		query.append("          SEP," ).append("\n"); 
		query.append("          OCT," ).append("\n"); 
		query.append("          NOV," ).append("\n"); 
		query.append("          DEC," ).append("\n"); 
		query.append("          DIV_TOTAL" ).append("\n"); 
		query.append("        FROM LT_VIEW )" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT YEAR_MONTH," ).append("\n"); 
		query.append("      'S.TTL' AGMT_NO ," ).append("\n"); 
		query.append("      NULL LSTM_CD," ).append("\n"); 
		query.append("      NULL LOC_CD," ).append("\n"); 
		query.append("      NULL TYSZ," ).append("\n"); 
		query.append("      NULL SUPPLIER," ).append("\n"); 
		query.append("      RESULT," ).append("\n"); 
		query.append("      RSLT_TP_SEQ," ).append("\n"); 
		query.append("      SUM(JAN) JAN," ).append("\n"); 
		query.append("      SUM(FEB) FEB," ).append("\n"); 
		query.append("      SUM(MAR) MAR," ).append("\n"); 
		query.append("      SUM(APR) APR," ).append("\n"); 
		query.append("      SUM(MAY) MAY," ).append("\n"); 
		query.append("      SUM(JUN) JUN," ).append("\n"); 
		query.append("      SUM(JUL) JUL," ).append("\n"); 
		query.append("      SUM(AUG) AUG," ).append("\n"); 
		query.append("      SUM(SEP) SEP," ).append("\n"); 
		query.append("      SUM(OCT) OCT," ).append("\n"); 
		query.append("      SUM(NOV) NOV," ).append("\n"); 
		query.append("      SUM(DEC) DEC," ).append("\n"); 
		query.append("      SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          AGMT_NO ," ).append("\n"); 
		query.append("          'LT' LSTM_CD," ).append("\n"); 
		query.append("          LOC_CD," ).append("\n"); 
		query.append("          TYSZ," ).append("\n"); 
		query.append("          SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          JAN," ).append("\n"); 
		query.append("          FEB ," ).append("\n"); 
		query.append("          MAR," ).append("\n"); 
		query.append("          APR," ).append("\n"); 
		query.append("          MAY," ).append("\n"); 
		query.append("          JUN," ).append("\n"); 
		query.append("          JUL," ).append("\n"); 
		query.append("          AUG," ).append("\n"); 
		query.append("          SEP," ).append("\n"); 
		query.append("          OCT," ).append("\n"); 
		query.append("          NOV," ).append("\n"); 
		query.append("          DEC," ).append("\n"); 
		query.append("          DIV_TOTAL" ).append("\n"); 
		query.append("        FROM LT_VIEW" ).append("\n"); 
		query.append("        WHERE RSLT_TP_SEQ < 3 )" ).append("\n"); 
		query.append("    GROUP BY YEAR_MONTH, RESULT, RSLT_TP_SEQ" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT P.YEAR_MONTH," ).append("\n"); 
		query.append("      'S.TTL' AGMT_NO ," ).append("\n"); 
		query.append("      NULL LSTM_CD," ).append("\n"); 
		query.append("      NULL LOC_CD," ).append("\n"); 
		query.append("      NULL TYSZ," ).append("\n"); 
		query.append("      NULL SUPPLIER," ).append("\n"); 
		query.append("      'Ratio' RESULT," ).append("\n"); 
		query.append("      3 RSLT_TP_SEQ," ).append("\n"); 
		query.append("      CASE WHEN P.JAN > 0" ).append("\n"); 
		query.append("      AND F.JAN > 0 THEN ROUND((F.JAN / P.JAN) * 100 ) ELSE 0 END JAN ," ).append("\n"); 
		query.append("      CASE WHEN P.FEB > 0" ).append("\n"); 
		query.append("      AND F.FEB > 0 THEN ROUND((F.FEB / P.FEB) * 100 ) ELSE 0 END FEB ," ).append("\n"); 
		query.append("      CASE WHEN P.MAR > 0" ).append("\n"); 
		query.append("      AND F.MAR > 0 THEN ROUND((F.MAR / P.MAR) * 100 ) ELSE 0 END MAR ," ).append("\n"); 
		query.append("      CASE WHEN P.APR > 0" ).append("\n"); 
		query.append("      AND F.APR > 0 THEN ROUND((F.APR / P.APR) * 100 ) ELSE 0 END APR ," ).append("\n"); 
		query.append("      CASE WHEN P.MAY > 0" ).append("\n"); 
		query.append("      AND F.MAY > 0 THEN ROUND((F.MAY / P.MAY) * 100 ) ELSE 0 END MAY ," ).append("\n"); 
		query.append("      CASE WHEN P.JUN > 0" ).append("\n"); 
		query.append("      AND F.JUN > 0 THEN ROUND((F.JUN / P.JUN) * 100 ) ELSE 0 END JUN ," ).append("\n"); 
		query.append("      CASE WHEN P.JUL > 0" ).append("\n"); 
		query.append("      AND F.JUL > 0 THEN ROUND((F.JUL / P.JUL) * 100 ) ELSE 0 END JUL ," ).append("\n"); 
		query.append("      CASE WHEN P.AUG > 0" ).append("\n"); 
		query.append("      AND F.AUG > 0 THEN ROUND((F.AUG / P.AUG) * 100 ) ELSE 0 END AUG ," ).append("\n"); 
		query.append("      CASE WHEN P.SEP > 0" ).append("\n"); 
		query.append("      AND F.SEP > 0 THEN ROUND((F.SEP / P.SEP) * 100 ) ELSE 0 END SEP ," ).append("\n"); 
		query.append("      CASE WHEN P.OCT > 0" ).append("\n"); 
		query.append("      AND F.OCT > 0 THEN ROUND((F.OCT / P.OCT) * 100 ) ELSE 0 END OCT ," ).append("\n"); 
		query.append("      CASE WHEN P.NOV > 0" ).append("\n"); 
		query.append("      AND F.NOV > 0 THEN ROUND((F.NOV / P.NOV) * 100 ) ELSE 0 END NOV ," ).append("\n"); 
		query.append("      CASE WHEN P.DEC > 0" ).append("\n"); 
		query.append("      AND F.DEC > 0 THEN ROUND((F.DEC / P.DEC) * 100 ) ELSE 0 END DEC ," ).append("\n"); 
		query.append("      CASE WHEN P.DIV_TOTAL > 0" ).append("\n"); 
		query.append("      AND F.DIV_TOTAL > 0 THEN ROUND((F.DIV_TOTAL / P.DIV_TOTAL) * 100 ) ELSE 0 END DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          NULL AGMT_NO ," ).append("\n"); 
		query.append("          NULL LSTM_CD," ).append("\n"); 
		query.append("          NULL LOC_CD," ).append("\n"); 
		query.append("          NULL TYSZ," ).append("\n"); 
		query.append("          NULL SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          SUM(JAN) JAN," ).append("\n"); 
		query.append("          SUM(FEB) FEB," ).append("\n"); 
		query.append("          SUM(MAR) MAR," ).append("\n"); 
		query.append("          SUM(APR) APR," ).append("\n"); 
		query.append("          SUM(MAY) MAY," ).append("\n"); 
		query.append("          SUM(JUN) JUN," ).append("\n"); 
		query.append("          SUM(JUL) JUL," ).append("\n"); 
		query.append("          SUM(AUG) AUG," ).append("\n"); 
		query.append("          SUM(SEP) SEP," ).append("\n"); 
		query.append("          SUM(OCT) OCT," ).append("\n"); 
		query.append("          SUM(NOV) NOV," ).append("\n"); 
		query.append("          SUM(DEC) DEC," ).append("\n"); 
		query.append("          SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              'LT' LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM LT_VIEW" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 1 )" ).append("\n"); 
		query.append("        GROUP BY YEAR_MONTH, RESULT, RSLT_TP_SEQ ) P ," ).append("\n"); 
		query.append("      (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          NULL AGMT_NO ," ).append("\n"); 
		query.append("          NULL LSTM_CD," ).append("\n"); 
		query.append("          NULL LOC_CD," ).append("\n"); 
		query.append("          NULL TYSZ," ).append("\n"); 
		query.append("          NULL SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          SUM(JAN) JAN," ).append("\n"); 
		query.append("          SUM(FEB) FEB," ).append("\n"); 
		query.append("          SUM(MAR) MAR," ).append("\n"); 
		query.append("          SUM(APR) APR," ).append("\n"); 
		query.append("          SUM(MAY) MAY," ).append("\n"); 
		query.append("          SUM(JUN) JUN," ).append("\n"); 
		query.append("          SUM(JUL) JUL," ).append("\n"); 
		query.append("          SUM(AUG) AUG," ).append("\n"); 
		query.append("          SUM(SEP) SEP," ).append("\n"); 
		query.append("          SUM(OCT) OCT," ).append("\n"); 
		query.append("          SUM(NOV) NOV," ).append("\n"); 
		query.append("          SUM(DEC) DEC," ).append("\n"); 
		query.append("          SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              'LT' LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM LT_VIEW" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 2 )" ).append("\n"); 
		query.append("        GROUP BY YEAR_MONTH, RESULT, RSLT_TP_SEQ ) F" ).append("\n"); 
		query.append("    WHERE P.YEAR_MONTH = F.YEAR_MONTH" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT 'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("      NULL AGMT_NO ," ).append("\n"); 
		query.append("      NULL LSTM_CD," ).append("\n"); 
		query.append("      NULL LOC_CD," ).append("\n"); 
		query.append("      NULL TYSZ," ).append("\n"); 
		query.append("      NULL SUPPLIER," ).append("\n"); 
		query.append("      RESULT," ).append("\n"); 
		query.append("      RSLT_TP_SEQ," ).append("\n"); 
		query.append("      SUM(JAN) JAN," ).append("\n"); 
		query.append("      SUM(FEB) FEB," ).append("\n"); 
		query.append("      SUM(MAR) MAR," ).append("\n"); 
		query.append("      SUM(APR) APR," ).append("\n"); 
		query.append("      SUM(MAY) MAY," ).append("\n"); 
		query.append("      SUM(JUN) JUN," ).append("\n"); 
		query.append("      SUM(JUL) JUL," ).append("\n"); 
		query.append("      SUM(AUG) AUG," ).append("\n"); 
		query.append("      SUM(SEP) SEP," ).append("\n"); 
		query.append("      SUM(OCT) OCT," ).append("\n"); 
		query.append("      SUM(NOV) NOV," ).append("\n"); 
		query.append("      SUM(DEC) DEC," ).append("\n"); 
		query.append("      SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          AGMT_NO ," ).append("\n"); 
		query.append("          'LT' LSTM_CD," ).append("\n"); 
		query.append("          LOC_CD," ).append("\n"); 
		query.append("          TYSZ," ).append("\n"); 
		query.append("          SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          JAN," ).append("\n"); 
		query.append("          FEB ," ).append("\n"); 
		query.append("          MAR," ).append("\n"); 
		query.append("          APR," ).append("\n"); 
		query.append("          MAY," ).append("\n"); 
		query.append("          JUN," ).append("\n"); 
		query.append("          JUL," ).append("\n"); 
		query.append("          AUG," ).append("\n"); 
		query.append("          SEP," ).append("\n"); 
		query.append("          OCT," ).append("\n"); 
		query.append("          NOV," ).append("\n"); 
		query.append("          DEC," ).append("\n"); 
		query.append("          DIV_TOTAL" ).append("\n"); 
		query.append("        FROM LT_VIEW" ).append("\n"); 
		query.append("        WHERE RSLT_TP_SEQ < 3 )" ).append("\n"); 
		query.append("    GROUP BY RESULT, RSLT_TP_SEQ" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT 'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("      NULL AGMT_NO ," ).append("\n"); 
		query.append("      NULL LSTM_CD," ).append("\n"); 
		query.append("      NULL LOC_CD," ).append("\n"); 
		query.append("      NULL TYSZ," ).append("\n"); 
		query.append("      NULL SUPPLIER," ).append("\n"); 
		query.append("      'Ratio' RESULT," ).append("\n"); 
		query.append("      3 RSLT_TP_SEQ," ).append("\n"); 
		query.append("      CASE WHEN P.JAN > 0" ).append("\n"); 
		query.append("      AND F.JAN > 0 THEN ROUND((F.JAN / P.JAN) * 100 ) ELSE 0 END JAN ," ).append("\n"); 
		query.append("      CASE WHEN P.FEB > 0" ).append("\n"); 
		query.append("      AND F.FEB > 0 THEN ROUND((F.FEB / P.FEB) * 100 ) ELSE 0 END FEB ," ).append("\n"); 
		query.append("      CASE WHEN P.MAR > 0" ).append("\n"); 
		query.append("      AND F.MAR > 0 THEN ROUND((F.MAR / P.MAR) * 100 ) ELSE 0 END MAR ," ).append("\n"); 
		query.append("      CASE WHEN P.APR > 0" ).append("\n"); 
		query.append("      AND F.APR > 0 THEN ROUND((F.APR / P.APR) * 100 ) ELSE 0 END APR ," ).append("\n"); 
		query.append("      CASE WHEN P.MAY > 0" ).append("\n"); 
		query.append("      AND F.MAY > 0 THEN ROUND((F.MAY / P.MAY) * 100 ) ELSE 0 END MAY ," ).append("\n"); 
		query.append("      CASE WHEN P.JUN > 0" ).append("\n"); 
		query.append("      AND F.JUN > 0 THEN ROUND((F.JUN / P.JUN) * 100 ) ELSE 0 END JUN ," ).append("\n"); 
		query.append("      CASE WHEN P.JUL > 0" ).append("\n"); 
		query.append("      AND F.JUL > 0 THEN ROUND((F.JUL / P.JUL) * 100 ) ELSE 0 END JUL ," ).append("\n"); 
		query.append("      CASE WHEN P.AUG > 0" ).append("\n"); 
		query.append("      AND F.AUG > 0 THEN ROUND((F.AUG / P.AUG) * 100 ) ELSE 0 END AUG ," ).append("\n"); 
		query.append("      CASE WHEN P.SEP > 0" ).append("\n"); 
		query.append("      AND F.SEP > 0 THEN ROUND((F.SEP / P.SEP) * 100 ) ELSE 0 END SEP ," ).append("\n"); 
		query.append("      CASE WHEN P.OCT > 0" ).append("\n"); 
		query.append("      AND F.OCT > 0 THEN ROUND((F.OCT / P.OCT) * 100 ) ELSE 0 END OCT ," ).append("\n"); 
		query.append("      CASE WHEN P.NOV > 0" ).append("\n"); 
		query.append("      AND F.NOV > 0 THEN ROUND((F.NOV / P.NOV) * 100 ) ELSE 0 END NOV ," ).append("\n"); 
		query.append("      CASE WHEN P.DEC > 0" ).append("\n"); 
		query.append("      AND F.DEC > 0 THEN ROUND((F.DEC / P.DEC) * 100 ) ELSE 0 END DEC ," ).append("\n"); 
		query.append("      CASE WHEN P.DIV_TOTAL > 0" ).append("\n"); 
		query.append("      AND F.DIV_TOTAL > 0 THEN ROUND((F.DIV_TOTAL / P.DIV_TOTAL) * 100 ) ELSE 0 END DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT 'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("          NULL AGMT_NO ," ).append("\n"); 
		query.append("          NULL LSTM_CD," ).append("\n"); 
		query.append("          NULL LOC_CD," ).append("\n"); 
		query.append("          NULL TYSZ," ).append("\n"); 
		query.append("          NULL SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          SUM(JAN) JAN," ).append("\n"); 
		query.append("          SUM(FEB) FEB," ).append("\n"); 
		query.append("          SUM(MAR) MAR," ).append("\n"); 
		query.append("          SUM(APR) APR," ).append("\n"); 
		query.append("          SUM(MAY) MAY," ).append("\n"); 
		query.append("          SUM(JUN) JUN," ).append("\n"); 
		query.append("          SUM(JUL) JUL," ).append("\n"); 
		query.append("          SUM(AUG) AUG," ).append("\n"); 
		query.append("          SUM(SEP) SEP," ).append("\n"); 
		query.append("          SUM(OCT) OCT," ).append("\n"); 
		query.append("          SUM(NOV) NOV," ).append("\n"); 
		query.append("          SUM(DEC) DEC," ).append("\n"); 
		query.append("          SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              'LT' LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM LT_VIEW" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 1 )" ).append("\n"); 
		query.append("        GROUP BY RESULT, RSLT_TP_SEQ ) P ," ).append("\n"); 
		query.append("      (" ).append("\n"); 
		query.append("        SELECT 'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("          NULL AGMT_NO ," ).append("\n"); 
		query.append("          NULL LSTM_CD," ).append("\n"); 
		query.append("          NULL LOC_CD," ).append("\n"); 
		query.append("          NULL TYSZ," ).append("\n"); 
		query.append("          NULL SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          SUM(JAN) JAN," ).append("\n"); 
		query.append("          SUM(FEB) FEB," ).append("\n"); 
		query.append("          SUM(MAR) MAR," ).append("\n"); 
		query.append("          SUM(APR) APR," ).append("\n"); 
		query.append("          SUM(MAY) MAY," ).append("\n"); 
		query.append("          SUM(JUN) JUN," ).append("\n"); 
		query.append("          SUM(JUL) JUL," ).append("\n"); 
		query.append("          SUM(AUG) AUG," ).append("\n"); 
		query.append("          SUM(SEP) SEP," ).append("\n"); 
		query.append("          SUM(OCT) OCT," ).append("\n"); 
		query.append("          SUM(NOV) NOV," ).append("\n"); 
		query.append("          SUM(DEC) DEC," ).append("\n"); 
		query.append("          SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT 'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              'LT' LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM LT_VIEW" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 2 )" ).append("\n"); 
		query.append("        GROUP BY RESULT, RSLT_TP_SEQ ) F" ).append("\n"); 
		query.append("    WHERE P.YEAR_MONTH = F.YEAR_MONTH )" ).append("\n"); 
		query.append("ORDER BY YEAR_MONTH , AGMT_NO, LSTM_CD, LOC_CD, TYSZ, SUPPLIER, RSLT_TP_SEQ " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("---========================================================LT end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("---========================================================New Van start" ).append("\n"); 
		query.append("WITH PARAM AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT A.PLN_YRMON," ).append("\n"); 
		query.append("      A.AGMT_CTY_CD," ).append("\n"); 
		query.append("      A.AGMT_SEQ," ).append("\n"); 
		query.append("      A.DEL_CD," ).append("\n"); 
		query.append("      A.MFT_VNDR_SEQ," ).append("\n"); 
		query.append("      A.CNTR_TPSZ_CD," ).append("\n"); 
		query.append("      A.NEW_VAN_YRMON AS BASE_DE_YRMON     " ).append("\n"); 
		query.append("    FROM LSE_NEW_VAN_DE_PLN A" ).append("\n"); 
		query.append("    WHERE 1 = 1" ).append("\n"); 
		query.append("       AND A.PLN_YRMON BETWEEN @[period_stdt] AND @[period_eddt]" ).append("\n"); 
		query.append("      AND A.AGMT_CTY_CD = 'HHO' )," ).append("\n"); 
		query.append("  INLINE_1 AS (" ).append("\n"); 
		query.append("    SELECT DISTINCT P.PLN_YRMON," ).append("\n"); 
		query.append("      P.AGMT_CTY_CD," ).append("\n"); 
		query.append("      P.AGMT_SEQ," ).append("\n"); 
		query.append("      P.AGMT_CTY_CD||LPAD(P.AGMT_SEQ, 6, '0') AS AGMT_NO," ).append("\n"); 
		query.append("      P.MFT_VNDR_SEQ," ).append("\n"); 
		query.append("      P.DEL_CD," ).append("\n"); 
		query.append("      P.CNTR_TPSZ_CD," ).append("\n"); 
		query.append("      P.BASE_DE_YRMON," ).append("\n"); 
		query.append("      1 AS RSLT_TP_SEQ," ).append("\n"); 
		query.append("      NVL(PLAN.DE_QTY, 0) AS PLAN_DE_QTY," ).append("\n"); 
		query.append("      0 AS PFMC_DE_QTY," ).append("\n"); 
		query.append("	  C.RCC_CD, C.LCC_CD, C.SCC_CD" ).append("\n"); 
		query.append("    FROM PARAM P," ).append("\n"); 
		query.append("      	 LSE_NEW_VAN_DE_PLN PLAN," ).append("\n"); 
		query.append("		 MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("    WHERE 1 = 1" ).append("\n"); 
		query.append("      AND P.BASE_DE_YRMON = PLAN.NEW_VAN_YRMON(+)" ).append("\n"); 
		query.append("      AND P.CNTR_TPSZ_CD = PLAN.CNTR_TPSZ_CD(+)" ).append("\n"); 
		query.append("      AND P.DEL_CD = PLAN.DEL_CD(+)" ).append("\n"); 
		query.append("      AND P.MFT_VNDR_SEQ = PLAN.MFT_VNDR_SEQ(+)" ).append("\n"); 
		query.append("      AND P.AGMT_SEQ = PLAN.AGMT_SEQ(+)" ).append("\n"); 
		query.append("      AND P.AGMT_CTY_CD = PLAN.AGMT_CTY_CD(+)" ).append("\n"); 
		query.append("      AND P.PLN_YRMON = PLAN.PLN_YRMON(+) " ).append("\n"); 
		query.append("	  AND P.DEL_CD = C.SCC_CD)," ).append("\n"); 
		query.append("  INLINE_2 AS (" ).append("\n"); 
		query.append("    SELECT AGMT_CTY_CD||LPAD(AGMT_SEQ, 6, '0') AS AGMT_NO," ).append("\n"); 
		query.append("      AGMT_CTY_CD," ).append("\n"); 
		query.append("      AGMT_SEQ," ).append("\n"); 
		query.append("      MFT_VNDR_SEQ," ).append("\n"); 
		query.append("      RCC_CD, LCC_CD, SCC_CD," ).append("\n"); 
		query.append("      CNTR_TPSZ_CD," ).append("\n"); 
		query.append("      DE_YRMON AS BASE_DE_YRMON," ).append("\n"); 
		query.append("      2 AS RSLT_TP_SEQ," ).append("\n"); 
		query.append("      0 AS PLAN_DE_QTY," ).append("\n"); 
		query.append("      NVL(COUNT(CNTR_NO), 0) AS PFMC_DE_QTY," ).append("\n"); 
		query.append("      PLN_YRMON" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT /*+ ORDERED USE_HASH(P HS CN) */" ).append("\n"); 
		query.append("          DISTINCT TO_CHAR(CN.ONH_DT, 'YYYYMM') AS DE_YRMON," ).append("\n"); 
		query.append("          HS.AGMT_CTY_CD," ).append("\n"); 
		query.append("          HS.AGMT_SEQ," ).append("\n"); 
		query.append("          CN.MFTR_VNDR_SEQ AS MFT_VNDR_SEQ," ).append("\n"); 
		query.append("          CN.CNTR_TPSZ_CD," ).append("\n"); 
		query.append("          CN.CNTR_NO," ).append("\n"); 
		query.append("          P.PLN_YRMON," ).append("\n"); 
		query.append("		  E.RCC_CD, E.LCC_CD, E.SCC_CD" ).append("\n"); 
		query.append("        FROM PARAM P," ).append("\n"); 
		query.append("          MST_CNTR_STS_HIS HS," ).append("\n"); 
		query.append("          MST_CONTAINER CN," ).append("\n"); 
		query.append("          (" ).append("\n"); 
		query.append("            SELECT A.YD_CD, A.LOC_CD, C.RCC_CD, C.LCC_CD, C.SCC_CD" ).append("\n"); 
		query.append("            FROM MDM_YARD A," ).append("\n"); 
		query.append("              MDM_LOCATION B," ).append("\n"); 
		query.append("              MDM_EQ_ORZ_CHT C" ).append("\n"); 
		query.append("            WHERE A.LOC_CD = B.LOC_CD" ).append("\n"); 
		query.append("              AND B.SCC_CD = C.SCC_CD) E" ).append("\n"); 
		query.append("        WHERE 1 = 1" ).append("\n"); 
		query.append("          AND CN.ONH_DT >= TO_DATE(P.BASE_DE_YRMON, 'YYYYMM')" ).append("\n"); 
		query.append("--        AND SUBSTR(NVL(HS.CNTR_STS_RMK, ' '), 1, 6) <> 'SELLOE'" ).append("\n"); 
		query.append("          AND HS.CNTR_LSTM_CNG_FLG <> 'Y'" ).append("\n"); 
		query.append("          AND HS.CNTR_STS_CD IN ('LSI','OWN')" ).append("\n"); 
		query.append("          AND HS.CNTR_NO = CN.CNTR_NO" ).append("\n"); 
		query.append("--          AND CN.ONH_YD_CD <> 'KRSEL1H'" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${lstm_cd_str} != '' )" ).append("\n"); 
		query.append("          AND CN.LSTM_CD IN( #foreach($key IN ${lstm_cd})" ).append("\n"); 
		query.append("                                 #if($velocityCount < $lstm_cd.size())" ).append("\n"); 
		query.append("                                     '$key'," ).append("\n"); 
		query.append("                                 #else" ).append("\n"); 
		query.append("                                     '$key'" ).append("\n"); 
		query.append("                                 #end" ).append("\n"); 
		query.append("                             #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("          AND CN.CO_CRE_FLG = 'N'" ).append("\n"); 
		query.append("          AND CN.ONH_YD_CD = E.YD_CD" ).append("\n"); 
		query.append("          AND HS.AGMT_SEQ = P.AGMT_SEQ" ).append("\n"); 
		query.append("          AND HS.AGMT_CTY_CD = P.AGMT_CTY_CD )" ).append("\n"); 
		query.append("    GROUP BY DE_YRMON, AGMT_CTY_CD, AGMT_SEQ, MFT_VNDR_SEQ, RCC_CD, LCC_CD, SCC_CD, CNTR_TPSZ_CD, PLN_YRMON  )," ).append("\n"); 
		query.append("  TEMP_DROP AS (" ).append("\n"); 
		query.append("    SELECT " ).append("\n"); 
		query.append("      X.DE_YR AS YEAR_MONTH," ).append("\n"); 
		query.append("      X.AGMT_NO," ).append("\n"); 
		query.append("      Z.LSTM_CD," ).append("\n"); 
		query.append("      X.DEL_CD AS LOC_CD," ).append("\n"); 
		query.append("      X.CNTR_TPSZ_CD AS TYSZ," ).append("\n"); 
		query.append("      SUBSTR(Y.VNDR_ABBR_NM, 0, 8) AS SUPPLIER," ).append("\n"); 
		query.append("      DECODE(X.RSLT_TP_SEQ, 1, 'Plan', 2, 'PFMC', 3, 'Ratio') AS RESULT, " ).append("\n"); 
		query.append("      X.RSLT_TP_SEQ,   " ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '01', DE_QTY, 0)) AS JAN," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '02', DE_QTY, 0)) AS FEB," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '03', DE_QTY, 0)) AS MAR," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '04', DE_QTY, 0)) AS APR," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '05', DE_QTY, 0)) AS MAY," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '06', DE_QTY, 0)) AS JUN," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '07', DE_QTY, 0)) AS JUL," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '08', DE_QTY, 0)) AS AUG," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '09', DE_QTY, 0)) AS SEP," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '10', DE_QTY, 0)) AS OCT," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '11', DE_QTY, 0)) AS NOV," ).append("\n"); 
		query.append("      SUM(DECODE(X.DE_MON, '12', DE_QTY, 0)) AS DEC," ).append("\n"); 
		query.append("      CASE WHEN X.RSLT_TP_SEQ = 1" ).append("\n"); 
		query.append("      OR X.RSLT_TP_SEQ = 2 THEN SUM(DECODE(X.DE_MON, '01', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '02', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '03', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '04', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '05', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '06', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '07', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '08', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '09', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '10', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '11', DE_QTY, 0)) + SUM(DECODE(X.DE_MON, '12', DE_QTY, 0)) WHEN X.RSLT_TP_SEQ = 3 THEN 0 END AS DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT A.PLN_YRMON," ).append("\n"); 
		query.append("          A.AGMT_NO," ).append("\n"); 
		query.append("          A.AGMT_CTY_CD," ).append("\n"); 
		query.append("          A.AGMT_SEQ," ).append("\n"); 
		query.append("          A.MFT_VNDR_SEQ," ).append("\n"); 
		query.append("          A.RCC_CD, A.LCC_CD, A.SCC_CD, A.LCC_CD AS DEL_CD," ).append("\n"); 
		query.append("          A.CNTR_TPSZ_CD," ).append("\n"); 
		query.append("          SUBSTR(A.BASE_DE_YRMON, 0, 4) AS DE_YR," ).append("\n"); 
		query.append("          SUBSTR(A.BASE_DE_YRMON, 5, 2) AS DE_MON," ).append("\n"); 
		query.append("          C.RSLT_TP_SEQ," ).append("\n"); 
		query.append("          CASE C.RSLT_TP_SEQ WHEN 1 THEN A.PLAN_DE_QTY WHEN 2 THEN B.PFMC_DE_QTY WHEN 3 THEN DECODE(NVL(A.PLAN_DE_QTY, 0), 0, 0, ROUND(B.PFMC_DE_QTY/A.PLAN_DE_QTY*100)) END DE_QTY" ).append("\n"); 
		query.append("        FROM INLINE_1 A," ).append("\n"); 
		query.append("          INLINE_2 B," ).append("\n"); 
		query.append("          (" ).append("\n"); 
		query.append("            SELECT LEVEL AS RSLT_TP_SEQ" ).append("\n"); 
		query.append("            FROM DUAL CONNECT BY LEVEL <= 3) C" ).append("\n"); 
		query.append("        WHERE A.AGMT_NO = B.AGMT_NO(+)" ).append("\n"); 
		query.append("          AND A.MFT_VNDR_SEQ = B.MFT_VNDR_SEQ(+)" ).append("\n"); 
		query.append("          AND A.SCC_CD = B.SCC_CD(+)" ).append("\n"); 
		query.append("          AND A.CNTR_TPSZ_CD = B.CNTR_TPSZ_CD(+)" ).append("\n"); 
		query.append("          AND A.BASE_DE_YRMON = B.BASE_DE_YRMON(+)" ).append("\n"); 
		query.append("        UNION ALL" ).append("\n"); 
		query.append("        SELECT NVL(A.PLN_YRMON, B.PLN_YRMON) AS PLN_YRMON," ).append("\n"); 
		query.append("          B.AGMT_NO," ).append("\n"); 
		query.append("          B.AGMT_CTY_CD," ).append("\n"); 
		query.append("          B.AGMT_SEQ," ).append("\n"); 
		query.append("          B.MFT_VNDR_SEQ," ).append("\n"); 
		query.append("          B.RCC_CD, B.LCC_CD, B.SCC_CD, B.LCC_CD AS DEL_CD," ).append("\n"); 
		query.append("          B.CNTR_TPSZ_CD," ).append("\n"); 
		query.append("          SUBSTR(B.BASE_DE_YRMON, 0, 4) AS DE_YR," ).append("\n"); 
		query.append("          SUBSTR(B.BASE_DE_YRMON, 5, 2) AS DE_MON," ).append("\n"); 
		query.append("          C.RSLT_TP_SEQ," ).append("\n"); 
		query.append("          CASE C.RSLT_TP_SEQ WHEN 1 THEN A.PLAN_DE_QTY WHEN 2 THEN B.PFMC_DE_QTY WHEN 3 THEN DECODE(NVL(A.PLAN_DE_QTY, 0), 0, 0, ROUND(B.PFMC_DE_QTY/A.PLAN_DE_QTY*100)) END DE_QTY" ).append("\n"); 
		query.append("        FROM INLINE_1 A," ).append("\n"); 
		query.append("          INLINE_2 B," ).append("\n"); 
		query.append("          (" ).append("\n"); 
		query.append("            SELECT LEVEL AS RSLT_TP_SEQ" ).append("\n"); 
		query.append("            FROM DUAL CONNECT BY LEVEL <= 3) C" ).append("\n"); 
		query.append("        WHERE A.AGMT_NO(+) = B.AGMT_NO" ).append("\n"); 
		query.append("          AND A.MFT_VNDR_SEQ(+) = B.MFT_VNDR_SEQ" ).append("\n"); 
		query.append("          AND A.SCC_CD(+) = B.SCC_CD" ).append("\n"); 
		query.append("          AND A.CNTR_TPSZ_CD(+) = B.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("          AND A.BASE_DE_YRMON(+) = B.BASE_DE_YRMON" ).append("\n"); 
		query.append("          AND A.PLAN_DE_QTY IS NULL ) X ," ).append("\n"); 
		query.append("      MDM_VENDOR Y , " ).append("\n"); 
		query.append("      LSE_AGREEMENT Z" ).append("\n"); 
		query.append("    WHERE Y.VNDR_SEQ = X.MFT_VNDR_SEQ" ).append("\n"); 
		query.append("      AND X.AGMT_CTY_CD = Z.AGMT_CTY_CD" ).append("\n"); 
		query.append("      AND X.AGMT_SEQ    = Z.AGMT_SEQ" ).append("\n"); 
		query.append("#if (${vndr_seq_str} != '' )" ).append("\n"); 
		query.append("    AND X.MFT_VNDR_SEQ IN( #foreach($key IN ${vndr_seq})" ).append("\n"); 
		query.append("                                      #if($velocityCount < $vndr_seq.size())" ).append("\n"); 
		query.append("                                          '$key'," ).append("\n"); 
		query.append("                                      #else" ).append("\n"); 
		query.append("                                          '$key'" ).append("\n"); 
		query.append("                                      #end" ).append("\n"); 
		query.append("                                  #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${cntr_tpsz_cd_str} != '' )" ).append("\n"); 
		query.append("    AND X.CNTR_TPSZ_CD  IN( #foreach($key IN ${cntr_tpsz_cd})" ).append("\n"); 
		query.append("                                      #if($velocityCount < $cntr_tpsz_cd.size())" ).append("\n"); 
		query.append("                                          '$key'," ).append("\n"); 
		query.append("                                      #else" ).append("\n"); 
		query.append("                                          '$key'" ).append("\n"); 
		query.append("                                      #end" ).append("\n"); 
		query.append("                                  #end )" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${loc_cd} != '')" ).append("\n"); 
		query.append("	#if (${loc_tp} == 'R')" ).append("\n"); 
		query.append("        AND	X.RCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                          	  #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                            	  '$key'," ).append("\n"); 
		query.append("                              #else" ).append("\n"); 
		query.append("                                  '$key'" ).append("\n"); 
		query.append("                          	  #end" ).append("\n"); 
		query.append("                          #end )" ).append("\n"); 
		query.append("	#elseif (${loc_tp} == 'L')" ).append("\n"); 
		query.append("        AND	X.LCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                              #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                  '$key'," ).append("\n"); 
		query.append("                              #else" ).append("\n"); 
		query.append("                                  '$key'" ).append("\n"); 
		query.append("                              #end" ).append("\n"); 
		query.append("                          #end )" ).append("\n"); 
		query.append("	#elseif (${loc_tp} == 'S')" ).append("\n"); 
		query.append("        AND	X.SCC_CD IN ( #foreach($key IN ${loc_cd})" ).append("\n"); 
		query.append("                              #if($velocityCount < $loc_cd.size())" ).append("\n"); 
		query.append("                                  '$key'," ).append("\n"); 
		query.append("                              #else" ).append("\n"); 
		query.append("                                  '$key'" ).append("\n"); 
		query.append("                              #end" ).append("\n"); 
		query.append("                          #end )" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("    GROUP BY X.DE_YR, X.AGMT_NO, Z.LSTM_CD, X.DEL_CD, X.CNTR_TPSZ_CD, Y.VNDR_ABBR_NM , X.RSLT_TP_SEQ " ).append("\n"); 
		query.append("    ORDER BY X.DE_YR, X.AGMT_NO, Z.LSTM_CD, X.DEL_CD, X.CNTR_TPSZ_CD, Y.VNDR_ABBR_NM , X.RSLT_TP_SEQ ) " ).append("\n"); 
		query.append(" SELECT YEAR_MONTH," ).append("\n"); 
		query.append("  AGMT_NO ," ).append("\n"); 
		query.append("  LSTM_CD," ).append("\n"); 
		query.append("  LOC_CD," ).append("\n"); 
		query.append("  TYSZ," ).append("\n"); 
		query.append("  SUPPLIER," ).append("\n"); 
		query.append("  RESULT," ).append("\n"); 
		query.append("  RSLT_TP_SEQ," ).append("\n"); 
		query.append("  JAN," ).append("\n"); 
		query.append("  FEB ," ).append("\n"); 
		query.append("  MAR," ).append("\n"); 
		query.append("  APR," ).append("\n"); 
		query.append("  MAY," ).append("\n"); 
		query.append("  JUN," ).append("\n"); 
		query.append("  JUL," ).append("\n"); 
		query.append("  AUG," ).append("\n"); 
		query.append("  SEP," ).append("\n"); 
		query.append("  OCT," ).append("\n"); 
		query.append("  NOV," ).append("\n"); 
		query.append("  DEC," ).append("\n"); 
		query.append("  DIV_TOTAL" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("    SELECT YEAR_MONTH," ).append("\n"); 
		query.append("      AGMT_NO ," ).append("\n"); 
		query.append("      LSTM_CD," ).append("\n"); 
		query.append("      LOC_CD," ).append("\n"); 
		query.append("      TYSZ," ).append("\n"); 
		query.append("      SUPPLIER," ).append("\n"); 
		query.append("      RESULT," ).append("\n"); 
		query.append("      RSLT_TP_SEQ," ).append("\n"); 
		query.append("      JAN," ).append("\n"); 
		query.append("      FEB ," ).append("\n"); 
		query.append("      MAR," ).append("\n"); 
		query.append("      APR," ).append("\n"); 
		query.append("      MAY," ).append("\n"); 
		query.append("      JUN," ).append("\n"); 
		query.append("      JUL," ).append("\n"); 
		query.append("      AUG," ).append("\n"); 
		query.append("      SEP," ).append("\n"); 
		query.append("      OCT," ).append("\n"); 
		query.append("      NOV," ).append("\n"); 
		query.append("      DEC," ).append("\n"); 
		query.append("      DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          AGMT_NO ," ).append("\n"); 
		query.append("          LSTM_CD," ).append("\n"); 
		query.append("          LOC_CD," ).append("\n"); 
		query.append("          TYSZ," ).append("\n"); 
		query.append("          SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          JAN," ).append("\n"); 
		query.append("          FEB ," ).append("\n"); 
		query.append("          MAR," ).append("\n"); 
		query.append("          APR," ).append("\n"); 
		query.append("          MAY," ).append("\n"); 
		query.append("          JUN," ).append("\n"); 
		query.append("          JUL," ).append("\n"); 
		query.append("          AUG," ).append("\n"); 
		query.append("          SEP," ).append("\n"); 
		query.append("          OCT," ).append("\n"); 
		query.append("          NOV," ).append("\n"); 
		query.append("          DEC," ).append("\n"); 
		query.append("          DIV_TOTAL" ).append("\n"); 
		query.append("        FROM TEMP_DROP )" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT YEAR_MONTH," ).append("\n"); 
		query.append("      'S.TTL' AGMT_NO ," ).append("\n"); 
		query.append("      NULL LSTM_CD," ).append("\n"); 
		query.append("      NULL LOC_CD," ).append("\n"); 
		query.append("      NULL TYSZ," ).append("\n"); 
		query.append("      NULL SUPPLIER," ).append("\n"); 
		query.append("      RESULT," ).append("\n"); 
		query.append("      RSLT_TP_SEQ," ).append("\n"); 
		query.append("      SUM(JAN) JAN," ).append("\n"); 
		query.append("      SUM(FEB) FEB," ).append("\n"); 
		query.append("      SUM(MAR) MAR," ).append("\n"); 
		query.append("      SUM(APR) APR," ).append("\n"); 
		query.append("      SUM(MAY) MAY," ).append("\n"); 
		query.append("      SUM(JUN) JUN," ).append("\n"); 
		query.append("      SUM(JUL) JUL," ).append("\n"); 
		query.append("      SUM(AUG) AUG," ).append("\n"); 
		query.append("      SUM(SEP) SEP," ).append("\n"); 
		query.append("      SUM(OCT) OCT," ).append("\n"); 
		query.append("      SUM(NOV) NOV," ).append("\n"); 
		query.append("      SUM(DEC) DEC," ).append("\n"); 
		query.append("      SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          AGMT_NO ," ).append("\n"); 
		query.append("          LSTM_CD," ).append("\n"); 
		query.append("          LOC_CD," ).append("\n"); 
		query.append("          TYSZ," ).append("\n"); 
		query.append("          SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          JAN," ).append("\n"); 
		query.append("          FEB ," ).append("\n"); 
		query.append("          MAR," ).append("\n"); 
		query.append("          APR," ).append("\n"); 
		query.append("          MAY," ).append("\n"); 
		query.append("          JUN," ).append("\n"); 
		query.append("          JUL," ).append("\n"); 
		query.append("          AUG," ).append("\n"); 
		query.append("          SEP," ).append("\n"); 
		query.append("          OCT," ).append("\n"); 
		query.append("          NOV," ).append("\n"); 
		query.append("          DEC," ).append("\n"); 
		query.append("          DIV_TOTAL" ).append("\n"); 
		query.append("        FROM TEMP_DROP" ).append("\n"); 
		query.append("        WHERE RSLT_TP_SEQ < 3 )" ).append("\n"); 
		query.append("    GROUP BY YEAR_MONTH, RESULT, RSLT_TP_SEQ" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT P.YEAR_MONTH," ).append("\n"); 
		query.append("      'S.TTL' AGMT_NO ," ).append("\n"); 
		query.append("      NULL LSTM_CD," ).append("\n"); 
		query.append("      NULL LOC_CD," ).append("\n"); 
		query.append("      NULL TYSZ," ).append("\n"); 
		query.append("      NULL SUPPLIER," ).append("\n"); 
		query.append("      'Ratio' RESULT," ).append("\n"); 
		query.append("      3 RSLT_TP_SEQ," ).append("\n"); 
		query.append("      CASE WHEN P.JAN > 0" ).append("\n"); 
		query.append("      AND F.JAN > 0 THEN ROUND((F.JAN / P.JAN) * 100 ) ELSE 0 END JAN ," ).append("\n"); 
		query.append("      CASE WHEN P.FEB > 0" ).append("\n"); 
		query.append("      AND F.FEB > 0 THEN ROUND((F.FEB / P.FEB) * 100 ) ELSE 0 END FEB ," ).append("\n"); 
		query.append("      CASE WHEN P.MAR > 0" ).append("\n"); 
		query.append("      AND F.MAR > 0 THEN ROUND((F.MAR / P.MAR) * 100 ) ELSE 0 END MAR ," ).append("\n"); 
		query.append("      CASE WHEN P.APR > 0" ).append("\n"); 
		query.append("      AND F.APR > 0 THEN ROUND((F.APR / P.APR) * 100 ) ELSE 0 END APR ," ).append("\n"); 
		query.append("      CASE WHEN P.MAY > 0" ).append("\n"); 
		query.append("      AND F.MAY > 0 THEN ROUND((F.MAY / P.MAY) * 100 ) ELSE 0 END MAY ," ).append("\n"); 
		query.append("      CASE WHEN P.JUN > 0" ).append("\n"); 
		query.append("      AND F.JUN > 0 THEN ROUND((F.JUN / P.JUN) * 100 ) ELSE 0 END JUN ," ).append("\n"); 
		query.append("      CASE WHEN P.JUL > 0" ).append("\n"); 
		query.append("      AND F.JUL > 0 THEN ROUND((F.JUL / P.JUL) * 100 ) ELSE 0 END JUL ," ).append("\n"); 
		query.append("      CASE WHEN P.AUG > 0" ).append("\n"); 
		query.append("      AND F.AUG > 0 THEN ROUND((F.AUG / P.AUG) * 100 ) ELSE 0 END AUG ," ).append("\n"); 
		query.append("      CASE WHEN P.SEP > 0" ).append("\n"); 
		query.append("      AND F.SEP > 0 THEN ROUND((F.SEP / P.SEP) * 100 ) ELSE 0 END SEP ," ).append("\n"); 
		query.append("      CASE WHEN P.OCT > 0" ).append("\n"); 
		query.append("      AND F.OCT > 0 THEN ROUND((F.OCT / P.OCT) * 100 ) ELSE 0 END OCT ," ).append("\n"); 
		query.append("      CASE WHEN P.NOV > 0" ).append("\n"); 
		query.append("      AND F.NOV > 0 THEN ROUND((F.NOV / P.NOV) * 100 ) ELSE 0 END NOV ," ).append("\n"); 
		query.append("      CASE WHEN P.DEC > 0" ).append("\n"); 
		query.append("      AND F.DEC > 0 THEN ROUND((F.DEC / P.DEC) * 100 ) ELSE 0 END DEC ," ).append("\n"); 
		query.append("      CASE WHEN P.DIV_TOTAL > 0" ).append("\n"); 
		query.append("      AND F.DIV_TOTAL > 0 THEN ROUND((F.DIV_TOTAL / P.DIV_TOTAL) * 100 ) ELSE 0 END DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          NULL AGMT_NO ," ).append("\n"); 
		query.append("          NULL LSTM_CD," ).append("\n"); 
		query.append("          NULL LOC_CD," ).append("\n"); 
		query.append("          NULL TYSZ," ).append("\n"); 
		query.append("          NULL SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          SUM(JAN) JAN," ).append("\n"); 
		query.append("          SUM(FEB) FEB," ).append("\n"); 
		query.append("          SUM(MAR) MAR," ).append("\n"); 
		query.append("          SUM(APR) APR," ).append("\n"); 
		query.append("          SUM(MAY) MAY," ).append("\n"); 
		query.append("          SUM(JUN) JUN," ).append("\n"); 
		query.append("          SUM(JUL) JUL," ).append("\n"); 
		query.append("          SUM(AUG) AUG," ).append("\n"); 
		query.append("          SUM(SEP) SEP," ).append("\n"); 
		query.append("          SUM(OCT) OCT," ).append("\n"); 
		query.append("          SUM(NOV) NOV," ).append("\n"); 
		query.append("          SUM(DEC) DEC," ).append("\n"); 
		query.append("          SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM TEMP_DROP" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 1 )" ).append("\n"); 
		query.append("        GROUP BY YEAR_MONTH, RESULT, RSLT_TP_SEQ ) P ," ).append("\n"); 
		query.append("      (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          NULL AGMT_NO ," ).append("\n"); 
		query.append("          NULL LSTM_CD," ).append("\n"); 
		query.append("          NULL LOC_CD," ).append("\n"); 
		query.append("          NULL TYSZ," ).append("\n"); 
		query.append("          NULL SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          SUM(JAN) JAN," ).append("\n"); 
		query.append("          SUM(FEB) FEB," ).append("\n"); 
		query.append("          SUM(MAR) MAR," ).append("\n"); 
		query.append("          SUM(APR) APR," ).append("\n"); 
		query.append("          SUM(MAY) MAY," ).append("\n"); 
		query.append("          SUM(JUN) JUN," ).append("\n"); 
		query.append("          SUM(JUL) JUL," ).append("\n"); 
		query.append("          SUM(AUG) AUG," ).append("\n"); 
		query.append("          SUM(SEP) SEP," ).append("\n"); 
		query.append("          SUM(OCT) OCT," ).append("\n"); 
		query.append("          SUM(NOV) NOV," ).append("\n"); 
		query.append("          SUM(DEC) DEC," ).append("\n"); 
		query.append("          SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM TEMP_DROP" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 2 )" ).append("\n"); 
		query.append("        GROUP BY YEAR_MONTH, RESULT, RSLT_TP_SEQ ) F" ).append("\n"); 
		query.append("    WHERE P.YEAR_MONTH = F.YEAR_MONTH" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT 'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("      NULL AGMT_NO ," ).append("\n"); 
		query.append("      NULL LSTM_CD," ).append("\n"); 
		query.append("      NULL LOC_CD," ).append("\n"); 
		query.append("      NULL TYSZ," ).append("\n"); 
		query.append("      NULL SUPPLIER," ).append("\n"); 
		query.append("      RESULT," ).append("\n"); 
		query.append("      RSLT_TP_SEQ," ).append("\n"); 
		query.append("      SUM(JAN) JAN," ).append("\n"); 
		query.append("      SUM(FEB) FEB," ).append("\n"); 
		query.append("      SUM(MAR) MAR," ).append("\n"); 
		query.append("      SUM(APR) APR," ).append("\n"); 
		query.append("      SUM(MAY) MAY," ).append("\n"); 
		query.append("      SUM(JUN) JUN," ).append("\n"); 
		query.append("      SUM(JUL) JUL," ).append("\n"); 
		query.append("      SUM(AUG) AUG," ).append("\n"); 
		query.append("      SUM(SEP) SEP," ).append("\n"); 
		query.append("      SUM(OCT) OCT," ).append("\n"); 
		query.append("      SUM(NOV) NOV," ).append("\n"); 
		query.append("      SUM(DEC) DEC," ).append("\n"); 
		query.append("      SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT YEAR_MONTH," ).append("\n"); 
		query.append("          AGMT_NO ," ).append("\n"); 
		query.append("          LSTM_CD," ).append("\n"); 
		query.append("          LOC_CD," ).append("\n"); 
		query.append("          TYSZ," ).append("\n"); 
		query.append("          SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          JAN," ).append("\n"); 
		query.append("          FEB ," ).append("\n"); 
		query.append("          MAR," ).append("\n"); 
		query.append("          APR," ).append("\n"); 
		query.append("          MAY," ).append("\n"); 
		query.append("          JUN," ).append("\n"); 
		query.append("          JUL," ).append("\n"); 
		query.append("          AUG," ).append("\n"); 
		query.append("          SEP," ).append("\n"); 
		query.append("          OCT," ).append("\n"); 
		query.append("          NOV," ).append("\n"); 
		query.append("          DEC," ).append("\n"); 
		query.append("          DIV_TOTAL" ).append("\n"); 
		query.append("        FROM TEMP_DROP" ).append("\n"); 
		query.append("        WHERE RSLT_TP_SEQ < 3 )" ).append("\n"); 
		query.append("    GROUP BY RESULT, RSLT_TP_SEQ" ).append("\n"); 
		query.append("    UNION ALL" ).append("\n"); 
		query.append("    SELECT 'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("      NULL AGMT_NO ," ).append("\n"); 
		query.append("      NULL LSTM_CD," ).append("\n"); 
		query.append("      NULL LOC_CD," ).append("\n"); 
		query.append("      NULL TYSZ," ).append("\n"); 
		query.append("      NULL SUPPLIER," ).append("\n"); 
		query.append("      'Ratio' RESULT," ).append("\n"); 
		query.append("      3 RSLT_TP_SEQ," ).append("\n"); 
		query.append("      CASE WHEN P.JAN > 0" ).append("\n"); 
		query.append("      AND F.JAN > 0 THEN ROUND((F.JAN / P.JAN) * 100 ) ELSE 0 END JAN ," ).append("\n"); 
		query.append("      CASE WHEN P.FEB > 0" ).append("\n"); 
		query.append("      AND F.FEB > 0 THEN ROUND((F.FEB / P.FEB) * 100 ) ELSE 0 END FEB ," ).append("\n"); 
		query.append("      CASE WHEN P.MAR > 0" ).append("\n"); 
		query.append("      AND F.MAR > 0 THEN ROUND((F.MAR / P.MAR) * 100 ) ELSE 0 END MAR ," ).append("\n"); 
		query.append("      CASE WHEN P.APR > 0" ).append("\n"); 
		query.append("      AND F.APR > 0 THEN ROUND((F.APR / P.APR) * 100 ) ELSE 0 END APR ," ).append("\n"); 
		query.append("      CASE WHEN P.MAY > 0" ).append("\n"); 
		query.append("      AND F.MAY > 0 THEN ROUND((F.MAY / P.MAY) * 100 ) ELSE 0 END MAY ," ).append("\n"); 
		query.append("      CASE WHEN P.JUN > 0" ).append("\n"); 
		query.append("      AND F.JUN > 0 THEN ROUND((F.JUN / P.JUN) * 100 ) ELSE 0 END JUN ," ).append("\n"); 
		query.append("      CASE WHEN P.JUL > 0" ).append("\n"); 
		query.append("      AND F.JUL > 0 THEN ROUND((F.JUL / P.JUL) * 100 ) ELSE 0 END JUL ," ).append("\n"); 
		query.append("      CASE WHEN P.AUG > 0" ).append("\n"); 
		query.append("      AND F.AUG > 0 THEN ROUND((F.AUG / P.AUG) * 100 ) ELSE 0 END AUG ," ).append("\n"); 
		query.append("      CASE WHEN P.SEP > 0" ).append("\n"); 
		query.append("      AND F.SEP > 0 THEN ROUND((F.SEP / P.SEP) * 100 ) ELSE 0 END SEP ," ).append("\n"); 
		query.append("      CASE WHEN P.OCT > 0" ).append("\n"); 
		query.append("      AND F.OCT > 0 THEN ROUND((F.OCT / P.OCT) * 100 ) ELSE 0 END OCT ," ).append("\n"); 
		query.append("      CASE WHEN P.NOV > 0" ).append("\n"); 
		query.append("      AND F.NOV > 0 THEN ROUND((F.NOV / P.NOV) * 100 ) ELSE 0 END NOV ," ).append("\n"); 
		query.append("      CASE WHEN P.DEC > 0" ).append("\n"); 
		query.append("      AND F.DEC > 0 THEN ROUND((F.DEC / P.DEC) * 100 ) ELSE 0 END DEC ," ).append("\n"); 
		query.append("      CASE WHEN P.DIV_TOTAL > 0" ).append("\n"); 
		query.append("      AND F.DIV_TOTAL > 0 THEN ROUND((F.DIV_TOTAL / P.DIV_TOTAL) * 100 ) ELSE 0 END DIV_TOTAL" ).append("\n"); 
		query.append("    FROM (" ).append("\n"); 
		query.append("        SELECT 'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("          NULL AGMT_NO ," ).append("\n"); 
		query.append("          NULL LSTM_CD," ).append("\n"); 
		query.append("          NULL LOC_CD," ).append("\n"); 
		query.append("          NULL TYSZ," ).append("\n"); 
		query.append("          NULL SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          SUM(JAN) JAN," ).append("\n"); 
		query.append("          SUM(FEB) FEB," ).append("\n"); 
		query.append("          SUM(MAR) MAR," ).append("\n"); 
		query.append("          SUM(APR) APR," ).append("\n"); 
		query.append("          SUM(MAY) MAY," ).append("\n"); 
		query.append("          SUM(JUN) JUN," ).append("\n"); 
		query.append("          SUM(JUL) JUL," ).append("\n"); 
		query.append("          SUM(AUG) AUG," ).append("\n"); 
		query.append("          SUM(SEP) SEP," ).append("\n"); 
		query.append("          SUM(OCT) OCT," ).append("\n"); 
		query.append("          SUM(NOV) NOV," ).append("\n"); 
		query.append("          SUM(DEC) DEC," ).append("\n"); 
		query.append("          SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM TEMP_DROP" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 1 )" ).append("\n"); 
		query.append("        GROUP BY RESULT, RSLT_TP_SEQ ) P ," ).append("\n"); 
		query.append("      (" ).append("\n"); 
		query.append("        SELECT 'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("          NULL AGMT_NO ," ).append("\n"); 
		query.append("          NULL LSTM_CD," ).append("\n"); 
		query.append("          NULL LOC_CD," ).append("\n"); 
		query.append("          NULL TYSZ," ).append("\n"); 
		query.append("          NULL SUPPLIER," ).append("\n"); 
		query.append("          RESULT," ).append("\n"); 
		query.append("          RSLT_TP_SEQ," ).append("\n"); 
		query.append("          SUM(JAN) JAN," ).append("\n"); 
		query.append("          SUM(FEB) FEB," ).append("\n"); 
		query.append("          SUM(MAR) MAR," ).append("\n"); 
		query.append("          SUM(APR) APR," ).append("\n"); 
		query.append("          SUM(MAY) MAY," ).append("\n"); 
		query.append("          SUM(JUN) JUN," ).append("\n"); 
		query.append("          SUM(JUL) JUL," ).append("\n"); 
		query.append("          SUM(AUG) AUG," ).append("\n"); 
		query.append("          SUM(SEP) SEP," ).append("\n"); 
		query.append("          SUM(OCT) OCT," ).append("\n"); 
		query.append("          SUM(NOV) NOV," ).append("\n"); 
		query.append("          SUM(DEC) DEC," ).append("\n"); 
		query.append("          SUM(DIV_TOTAL) DIV_TOTAL" ).append("\n"); 
		query.append("        FROM (" ).append("\n"); 
		query.append("            SELECT 'G.TTL' YEAR_MONTH," ).append("\n"); 
		query.append("              AGMT_NO ," ).append("\n"); 
		query.append("              LSTM_CD," ).append("\n"); 
		query.append("              LOC_CD," ).append("\n"); 
		query.append("              TYSZ," ).append("\n"); 
		query.append("              SUPPLIER," ).append("\n"); 
		query.append("              RESULT," ).append("\n"); 
		query.append("              RSLT_TP_SEQ," ).append("\n"); 
		query.append("              JAN," ).append("\n"); 
		query.append("              FEB ," ).append("\n"); 
		query.append("              MAR," ).append("\n"); 
		query.append("              APR," ).append("\n"); 
		query.append("              MAY," ).append("\n"); 
		query.append("              JUN," ).append("\n"); 
		query.append("              JUL," ).append("\n"); 
		query.append("              AUG," ).append("\n"); 
		query.append("              SEP," ).append("\n"); 
		query.append("              OCT," ).append("\n"); 
		query.append("              NOV," ).append("\n"); 
		query.append("              DEC," ).append("\n"); 
		query.append("              DIV_TOTAL" ).append("\n"); 
		query.append("            FROM TEMP_DROP" ).append("\n"); 
		query.append("            WHERE RSLT_TP_SEQ = 2 )" ).append("\n"); 
		query.append("        GROUP BY RESULT, RSLT_TP_SEQ ) F" ).append("\n"); 
		query.append("    WHERE P.YEAR_MONTH = F.YEAR_MONTH )" ).append("\n"); 
		query.append("ORDER BY YEAR_MONTH , AGMT_NO, LSTM_CD, LOC_CD, TYSZ, SUPPLIER, RSLT_TP_SEQ" ).append("\n"); 
		query.append("--===================================================New Van end    " ).append("\n"); 
		query.append("#end" ).append("\n"); 

	}
}