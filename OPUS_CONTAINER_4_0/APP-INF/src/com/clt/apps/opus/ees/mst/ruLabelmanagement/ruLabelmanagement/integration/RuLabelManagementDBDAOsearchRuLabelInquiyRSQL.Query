<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="RuLabelManagementDBDAOsearchRuLabelInquiyRSQL">
			<desc><![CDATA[Container별 RU Label의 정보를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT RUC.RSTR_USG_DP_SEQ
     , RUC.RU_LABEL_TYPE_DESC
     , MCR.RSTR_USG_LBL_NM
     , (SELECT MRU.RSTR_USG_LBL_DESC 
          FROM MST_RSTR_USG_CD MRU
         WHERE 1=1 
           AND MRU.DELT_FLG = 'N'
           AND MRU.RSTR_USG_TP_CD  = MCR.RSTR_USG_TP_CD
           AND MRU.RSTR_USG_LBL_NM = MCR.RSTR_USG_LBL_NM
           AND ROWNUM              = 1) AS RSTR_USG_LBL_DESC
     , (SELECT MRU.USR_DEF_RMK 
          FROM MST_RSTR_USG_CD MRU
         WHERE 1=1 
           AND MRU.DELT_FLG = 'N'
           AND MRU.RSTR_USG_TP_CD  = MCR.RSTR_USG_TP_CD
           AND MRU.RSTR_USG_LBL_NM = MCR.RSTR_USG_LBL_NM
           AND ROWNUM              = 1) AS USR_DEF_RMK
     , MCR.UPD_USR_ID, TO_CHAR(MCR.UPD_DT, 'YYYY-MM-DD HH24:MI:SS') AS UPD_DT 
  FROM 
       ( 
         SELECT INTG_CD_VAL_DP_SEQ AS RSTR_USG_DP_SEQ, INTG_CD_VAL_CTNT AS RSTR_USG_TP_CD, INTG_CD_VAL_DP_DESC AS RU_LABEL_TYPE_DESC
           FROM COM_INTG_CD_DTL
          WHERE 1=1
            AND INTG_CD_ID = 'CD20097'
          ORDER BY INTG_CD_VAL_DP_SEQ 
        ) RUC,
       ( 
         SELECT SMCR.CNTR_NO, SMCR.RSTR_USG_TP_CD, SSMCR.RSTR_USG_LBL_NM, SMCR.UPD_USR_ID, SMCR.UPD_DT
           FROM (
                 SELECT SMCR.CNTR_NO, SMCR.RSTR_USG_TP_CD, SMCR.RSTR_USG_LBL_NM, 
                        SSMCR.MAX_HIS_SEQ, SMCR.RSTR_USG_UPD_TP_CD, SMCR.UPD_USR_ID, SMCR.UPD_DT
                   FROM (
                          SELECT CNTR_NO, RSTR_USG_TP_CD, MAX(RSTR_USG_HIS_SEQ) AS MAX_HIS_SEQ
                            FROM MST_CNTR_RSTR_USG_HIS
                           WHERE 1=1
                             AND CNTR_NO = @[s_cntr_no]
                           GROUP BY CNTR_NO, RSTR_USG_TP_CD
                         ) SSMCR, MST_CNTR_RSTR_USG_HIS SMCR 
                    WHERE 1=1
                      AND SSMCR.CNTR_NO = SMCR.CNTR_NO
                      AND SSMCR.MAX_HIS_SEQ = SMCR.RSTR_USG_HIS_SEQ
                  ) SMCR, MST_CNTR_RSTR_USG_HIS SSMCR 
             WHERE 1=1
               AND SMCR.CNTR_NO     = SSMCR.CNTR_NO
               AND SMCR.MAX_HIS_SEQ = SSMCR.RSTR_USG_HIS_SEQ
               AND SMCR.RSTR_USG_UPD_TP_CD != 'D'
         ) MCR
      WHERE 1=1
        AND RUC.RSTR_USG_TP_CD = MCR.RSTR_USG_TP_CD (+)			]]></sql>
			<params>
				<param name="s_cntr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
