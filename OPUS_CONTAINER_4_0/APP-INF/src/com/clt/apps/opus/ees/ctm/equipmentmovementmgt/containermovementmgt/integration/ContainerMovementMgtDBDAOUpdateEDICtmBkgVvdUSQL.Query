<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ContainerMovementMgtDBDAOUpdateEDICtmBkgVvdUSQL">
			<desc><![CDATA[UpdateEDICtmBkgVvd]]></desc>
			<sql><![CDATA[
UPDATE ctm_bkg_vvd
SET 
		SLAN_CD 			= (SELECT VSL_SLAN_CD FROM MDM_VSL_SVC_LANE WHERE MODI_VSL_SLAN_CD2 = @[slan_cd] and rownum = 1)
		,VSL_CD 			= NVL((SELECT MAP.VSL_CD FROM  MDM_VSL_CNTR MAP WHERE
				                MAP.VSL_CD LIKE SUBSTR(TRIM(@[vsl_cd]),1,3)||'%' AND SUBSTR(MAP.VSL_CD,1,3) = SUBSTR(TRIM(@[vsl_cd]),1,3) 
				                AND DELT_FLG != 'Y' AND ROWNUM <= 1),'')
		,SKD_VOY_NO			= Decode(length(@[skd_voy_no]), 3, '0'||@[skd_voy_no], 4, @[skd_voy_no], NVL(@[skd_voy_no],''))
		,SKD_DIR_CD         = NVL(@[skd_dir_cd],'')
		,POL_CD             = NVL((select SUBSTR(YD_CD,0,5) AS POL_CD from MDM_YARD WHERE MODI_YD_CD=@[pol_yd_cd] AND DELT_FLG != 'Y' AND ROWNUM=1),'')
		,POL_YD_CD          = NVL((select YD_CD AS POL_YD_CD from MDM_YARD WHERE MODI_YD_CD=@[pol_yd_cd] AND DELT_FLG != 'Y' AND ROWNUM=1),'')
		,POD_CD             = NVL((select SUBSTR(YD_CD,0,5) AS POD_CD from MDM_YARD WHERE MODI_YD_CD=@[pod_yd_cd] AND DELT_FLG != 'Y' AND ROWNUM=1),'')
		,POD_YD_CD          = NVL((select YD_CD AS POD_YD_CD from MDM_YARD WHERE MODI_YD_CD=@[pod_yd_cd] AND DELT_FLG != 'Y' AND ROWNUM=1),'')
		,UPD_USR_ID         = @[upd_usr_id]
		,UPD_DT             = sysdate
		,OP_CD              = @[op_cd]
		,POL_CLPT_IND_SEQ   = @[pol_clpt_ind_seq]
		,POD_CLPT_IND_SEQ   = @[pod_clpt_ind_seq]
		,BKG_TRSP_MZD_CD    = @[bkg_trsp_mzd_cd]
		,CNTR_LODG_FLG      = NVL(@[cntr_lodg_flg],'N')
		,REV_VVD_FLG        = @[rev_vvd_flg]
		,OSCA_CRE_DT        = TO_DATE(SUBSTR(@[cre_dt],0,19),'YYYY-MM-DD HH24:MI:SS')
		,OSCA_UPD_DT        = TO_DATE(SUBSTR(@[upd_dt],0,19),'YYYY-MM-DD HH24:MI:SS')
WHERE 1=1
AND BKG_NO = @[bkg_no]
AND VSL_PRE_PST_CD = @[vsl_pre_pst_cd]
AND VSL_SEQ = @[vsl_seq]			]]></sql>
			<params>
				<param name="slan_cd" type="12" value="" out="N"/>
				<param name="vsl_cd" type="12" value="" out="N"/>
				<param name="skd_voy_no" type="12" value="" out="N"/>
				<param name="skd_dir_cd" type="12" value="" out="N"/>
				<param name="pol_yd_cd" type="12" value="" out="N"/>
				<param name="pod_yd_cd" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="op_cd" type="12" value="" out="N"/>
				<param name="pol_clpt_ind_seq" type="12" value="" out="N"/>
				<param name="pod_clpt_ind_seq" type="12" value="" out="N"/>
				<param name="bkg_trsp_mzd_cd" type="12" value="" out="N"/>
				<param name="cntr_lodg_flg" type="12" value="" out="N"/>
				<param name="rev_vvd_flg" type="12" value="" out="N"/>
				<param name="cre_dt" type="12" value="" out="N"/>
				<param name="upd_dt" type="12" value="" out="N"/>
				<param name="bkg_no" type="12" value="" out="N"/>
				<param name="vsl_pre_pst_cd" type="12" value="" out="N"/>
				<param name="vsl_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
