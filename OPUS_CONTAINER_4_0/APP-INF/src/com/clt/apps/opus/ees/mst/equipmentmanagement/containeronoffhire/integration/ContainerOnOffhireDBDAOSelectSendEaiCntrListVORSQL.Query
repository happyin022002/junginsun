<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ContainerOnOffhireDBDAOSelectSendEaiCntrListVORSQL">
			<desc><![CDATA[SelectSendEaiCntrListVO]]></desc>
			<sql><![CDATA[
SELECT 
    'FNS026-0001' LIFID
   ,A.EAI_IF_NO SEQ
   ,A.IF_TTL_ROW_KNT TOTAL_COUNT
   ,A.IF_SEQ RNUM
   ,'OPUS_GAAP_BOOK' BOOK_TYPE_CODE
   , A.CNTR_TPSZ_CD ASSET_DESCRIPTION
   ,'A' ASSET_TYPE
   #if (${hid_type} == '0')
   , (SELECT FA_CATE_CD 
      FROM MST_FA_CATE 
      WHERE EQ_TPSZ_CD = A.CNTR_TPSZ_CD 
      AND   FA_CATE_MTRL_CD = A.CNTR_MTRL_CD) CATEGORY_SEGMENT  
   #end
   #if (${hid_type} == '1') 
   , (SELECT SUBSTR(CA.FA_CATE_CD,1,11)||
           LTRIM(TO_CHAR(TO_NUMBER(SUBSTR(CA.FA_CATE_CD,12)) - 
           ROUND(MONTHS_BETWEEN
           (
           TO_DATE(TO_CHAR(MH.CNTR_STS_EVNT_DT,'YYYYMM'),'YYYYMM'),
           TO_DATE(TO_CHAR(DECODE(LA.DPC_VAL_FLG, 'Y', MH.CNTR_STS_EVNT_DT, NVL(A.MFT_DT,MH.CNTR_STS_EVNT_DT)),'YYYYMM'),'YYYYMM')
           )  / 12 ),'00'))                                    
    FROM LSE_AGREEMENT LA, MST_FA_CATE CA, MST_CNTR_STS_HIS MH
    WHERE 1 = 1
    AND   A.AGMT_CTY_CD = LA.AGMT_CTY_CD
    AND   A.AGMT_SEQ = LA.AGMT_SEQ
    AND   A.CNTR_TPSZ_CD = CA.EQ_TPSZ_CD
    AND   A.CNTR_MTRL_CD = CA.FA_CATE_MTRL_CD
    AND   A.CNTR_NO = MH.CNTR_NO
    AND   A.ONH_STS_SEQ = MH.CNTR_STS_SEQ) CATEGORY_SEGMENT
   #end
   ,@[cntr_aqz_amt] COST
   ,'CNTR' LOCATION_SEGMENT
   ,TO_CHAR(SYSDATE,'YYYYMMDD') DATE_PLACED_IN_SERVICE
   ,A.CNTR_NO TAG_NUMBER
   ,@[cntr_curr_cd] ATTRIBUTE1
   ,@[cntr_aqz_amt] ATTRIBUTE2
   ,@[cntr_invst_no] ATTRIBUTE3
   ,A.FA_IF_GRP_SEQ_NO ATTRIBUTE4
   ,'LSE' CREATED_BY
   ,TO_CHAR(SYSDATE,'YYYYMMDD') CREATION_DATE
   ,'LSE' LAST_UPDATED_BY
   ,TO_CHAR(SYSDATE,'YYYYMMDD') LAST_UPDATE_DATE
   #if (${hid_type} == '0')
   ,B.VNDR_LGL_ENG_NM MANUFACTURER
   #end
   #if (${hid_type} == '1') 
   ,'Free Purchase' MANUFACTURER
   #end
   ,TO_CHAR(A.MFT_DT, 'YYYYMMDD') ATTRIBUTE21
   #if (${hid_type} == '0')
   ,REPLACE(@[de_yrmon], '-','') ACQ_MTH
   #end
   #if (${hid_type} == '1') 
   ,TO_CHAR(SYSDATE, 'YYYYMM') ACQ_MTH
   #end
FROM 
   MST_CONTAINER A,
   MDM_VENDOR B
WHERE 1 = 1   
#if (${hid_type} == '0') 
AND A.LOT_PLN_YR    = @[lot_pln_yr]
AND A.LOT_LOC_CD    = @[lot_loc_cd]
AND A.CNTR_TPSZ_CD  = @[cntr_tpsz_cd]
AND A.LOT_SEQ       = @[lot_seq]
AND A.LSTM_CD = 'OW'
#end
#if (${hid_type} == '1') 
AND A.TERM_CNG_SEQ = @[term_cng_seq]
#end   
AND A.VNDR_SEQ = B.VNDR_SEQ
ORDER BY A.IF_SEQ			]]></sql>
			<params>
				<param name="cntr_aqz_amt" type="12" value="" out="N"/>
				<param name="cntr_curr_cd" type="12" value="" out="N"/>
				<param name="cntr_invst_no" type="12" value="" out="N"/>
				<param name="de_yrmon" type="12" value="" out="N"/>
				<param name="lot_pln_yr" type="12" value="" out="N"/>
				<param name="lot_loc_cd" type="12" value="" out="N"/>
				<param name="cntr_tpsz_cd" type="12" value="" out="N"/>
				<param name="lot_seq" type="12" value="" out="N"/>
				<param name="term_cng_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
