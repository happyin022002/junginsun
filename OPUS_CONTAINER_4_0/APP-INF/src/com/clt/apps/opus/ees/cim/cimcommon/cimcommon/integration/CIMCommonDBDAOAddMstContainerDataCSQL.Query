<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CIMCommonDBDAOAddMstContainerDataCSQL">
			<desc><![CDATA[MST_CONTAINER 테이블에 저장
CTM_MOVEMENT CM, 
MDM_EQ_ORZ_CHT ME Join]]></desc>
			<sql><![CDATA[
INSERT INTO MST_CONTAINER MC ( 
      LOC_CD
	, SCC_CD
	, LCC_CD
	, ECC_CD
	, RCC_CD
	, SYS_AREA_GRP_ID
	, CNMV_YR
	, CNMV_ID_NO
	, CNMV_SEQ
	, CNMV_CYC_NO
	, CNMV_DT
	, CNMV_GDT
	, PRE_STS_FLG
	, BKG_NO
	, BKG_KNT
	, FULL_FLG
	, CRNT_YD_CD
	, DEST_YD_CD
	, VSL_CD
	, SKD_VOY_NO
	, SKD_DIR_CD
	, CNMV_STS_CD
	, IMDT_EXT_FLG
	, CO_CRE_FLG
	, UCLM_LS_DIV_CD
	, UCLM_DT
	, UCLM_FREE_DYS
	, UCLM_END_DT
	, UCLM_RSN
	, UCLM_PLN_RMK
	, UCLM_CNTC_PNT_NM
	, UPD_USR_ID
	,UPD_DT
  )
    SELECT 
			ML.LOC_CD, 
			ME.SCC_CD, 
			ME.LCC_CD, 
			ME.ECC_CD,
			ME.RCC_CD, 
			(SELECT SYS_AREA_GRP_ID
				FROM   COM_SYS_AREA_GRP_ID B   
				WHERE SUBSTR(CM.INP_YD_CD, 1, 2) = B.CNT_CD
				AND   B.CO_IND_CD                = 'H'
				AND   ROWNUM                     = 1)
		   , CM.CNMV_YR       
		  , CM.CNMV_ID_NO
		  , CM.CNMV_SEQ
		  , CM.CNMV_CYC_NO
		  , CM.CNMV_EVNT_DT
		  , GLOBALDATE_PKG.TIME_CONV_FNC ( SUBSTR(CM.INP_YD_CD, 1, 5), CM.CNMV_EVNT_DT, 'GMT' )
		  , NVL(CM.PRE_STS_FLG, 'N')
		  , CM.BKG_NO
		  , CM.BKG_KNT
		  , NVL(CM.FCNTR_FLG, 'F')
		  , CM.INP_YD_CD
		  , CM.DEST_YD_CD
		  , CM.TRNK_VSL_CD VSL_CD
		  , CM.TRNK_SKD_VOY_NO
		  , CM.TRNK_SKD_DIR_CD
		  , CM.MVMT_STS_CD
		  , @[imdt_ext_flg]
		  , 'N'
		  , '' AS UCLM_LS_DIV_CD 
          , '' AS UCLM_DT 
          , '' AS UCLM_FREE_DYS 
          , '' AS UCLM_END_DT 
          , '' AS UCLM_RSN 
          , '' AS UCLM_PLN_RMK 
          , '' AS UCLM_CNTC_PNT_NM           
		  , CM.UPD_USR_ID
		  , CM.UPD_DT             
		FROM  CTM_MOVEMENT CM, 
			  MDM_EQ_ORZ_CHT ME, 
			  MDM_LOCATION ML
			,  ( SELECT SB.CNTR_NO AS CNTR_NO
					 , MAX(SB.CNMV_YR) AS CNMV_YR
					 , SUBSTR(MAX(SB.CNMV_YR||TO_CHAR(SB.CNMV_ID_NO, '00000')) , - 5) AS CNMV_ID_NO
					 , SUBSTR(MAX(SB.CNMV_YR||TO_CHAR(SB.CNMV_ID_NO, '00000')||TO_CHAR(SB.CNMV_SEQ, '0000')) , - 4) AS CNMV_SEQ
				 FROM CTM_MOVEMENT SB
				 WHERE SB.CNTR_NO = @[cntr_no]
				 GROUP BY SB.CNTR_NO) SB                            
		WHERE  SB.CNTR_NO         = 'CAIU5543281'
			AND  SB.CNMV_YR       = CM.CNMV_YR
			AND  SB.CNMV_ID_NO    = CM.CNMV_ID_NO
			AND  SB.CNMV_SEQ      = CM.CNMV_SEQ
			AND  ME.SCC_CD(+)     = ML.SCC_CD
		    AND   ML.LOC_CD(+)    = SUBSTR(CM.INP_YD_CD,0,5)   
		    AND  ROWNUM           = 1			]]></sql>
			<params>
				<param name="imdt_ext_flg" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
