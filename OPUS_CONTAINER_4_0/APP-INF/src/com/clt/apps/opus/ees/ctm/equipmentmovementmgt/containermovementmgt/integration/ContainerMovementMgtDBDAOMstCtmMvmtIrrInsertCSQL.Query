<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="ContainerMovementMgtDBDAOMstCtmMvmtIrrInsertCSQL">
			<desc><![CDATA[CTM_MVMT_IRR에 데이타 입력]]></desc>
			<sql><![CDATA[
INSERT INTO CTM_MVMT_IRR
            (CNTR_NO,
             CNMV_YR,
             CNMV_ID_NO,
             CNTR_BKG_ATCH_CD,
             CNMV_CYC_NO,
             MVMT_IRR_SEQ,
             CNTR_TPSZ_CD,
             CNMV_STS_CD,
             CNMV_EVNT_DT,
             ORG_YD_CD,
             BKG_NO,
             PRE_CNMV_YR,
             PRE_CNMV_ID_NO,
             PRE_CNMV_STS_CD,
             PRE_CNMV_EVNT_DT,
             PRE_ORG_YD_CD,
             PRE_DEST_YD_CD,
             PRE_BKG_NO,
             CNMV_IRR_STL_FLG,
             OFC_CD,
             CRE_USR_ID,
             CRE_DT,
             UPD_USR_ID
            )
   (SELECT /*+ LEADING(A) USE_NL(B) INDEX_DESC(A XUK1CTM_MOVEMENT ) */
           A.CNTR_NO,
           A.CNMV_YR,
           A.CNMV_ID_NO,
           @[cntr_bkg_atch_cd],
           A.CNMV_CYC_NO,
           (SELECT NVL (MAX (MVMT_IRR_SEQ), 0) + 1
              FROM CTM_MVMT_IRR
             WHERE CNTR_NO = @[cntr_no]),
           A.CNTR_TPSZ_CD,
           A.MVMT_STS_CD,
           A.CNMV_EVNT_DT,
           A.ORG_YD_CD,
           A.BKG_NO,
           B.CNMV_YR,
           B.CNMV_ID_NO,
           B.MVMT_STS_CD,
           B.CNMV_EVNT_DT,
           B.ORG_YD_CD,
           B.DEST_YD_CD,
           B.BKG_NO,
           'N',
           A.OFC_CD,
           A.CRE_USR_ID,
           SYSDATE,
           CRE_USR_ID
      FROM CTM_MOVEMENT A,
           (SELECT ROWNUM RON,
                   CNTR_NO,
                   CNMV_YR,
                   CNMV_ID_NO,
                   CNMV_CYC_NO,
                   IDS,
                   CNTR_TPSZ_CD,
                   MVMT_STS_CD,
                   CNMV_EVNT_DT,
                   ORG_YD_CD,
                   BKG_NO,
                   DEST_YD_CD
              FROM (SELECT /*+ INDEX_DESC (CTM_MOVEMENT XUK1CTM_MOVEMENT ) */
                           ROWNUM RON,
                           CNTR_NO,
                           CNMV_YR,
                           CNMV_ID_NO,
                           CNMV_CYC_NO,
                           (SELECT NVL (MAX (MVMT_IRR_SEQ), 0)
                              FROM CTM_MVMT_IRR
                             WHERE CNTR_NO = @[cntr_no]) IDS,
                           CNTR_TPSZ_CD,
                           MVMT_STS_CD,
                           CNMV_EVNT_DT,
                           ORG_YD_CD,
                           BKG_NO,
                           DEST_YD_CD
                      FROM CTM_MOVEMENT
                     WHERE CNTR_NO = @[cntr_no]
                       AND NVL (MVMT_CRE_TP_CD, 'C') != 'A'
                       AND ROWNUM < 3)
             WHERE RON = 2) B
     WHERE A.CNTR_NO = @[cntr_no]
       AND A.CNTR_NO = B.CNTR_NO(+)
       AND ROWNUM = 1) 			]]></sql>
			<params>
				<param name="cntr_bkg_atch_cd" type="12" value="" out="N"/>
				<param name="cntr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
