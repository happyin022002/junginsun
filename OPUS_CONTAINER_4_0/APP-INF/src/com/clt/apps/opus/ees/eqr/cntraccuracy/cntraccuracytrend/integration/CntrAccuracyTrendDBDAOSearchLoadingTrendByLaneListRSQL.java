/*=========================================================
*Copyright(c) 2014 CyberLogitec
*@FileName : CntrAccuracyTrendDBDAOSearchLoadingTrendByLaneListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2014.02.03
*@LastModifier : 
*@LastVersion : 1.0
* 2014.02.03 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.ees.eqr.cntraccuracy.cntraccuracytrend.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class CntrAccuracyTrendDBDAOSearchLoadingTrendByLaneListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * Search Loading Trend By Lane
	  * 2014-01-15, AFRICA PORT 를 EUROPE 으로 병합, 
	  * 2014-02-03, SKIP PORT 제거, MT LOADING PORT IND SEQ 조건 추가, 
	  * </pre>
	  */
	public CntrAccuracyTrendDBDAOSearchLoadingTrendByLaneListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("vvd_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("eta_fm_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("loc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("to_wk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("fm_wk",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rcc_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("eta_to_dt",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.ees.eqr.cntraccuracy.cntraccuracytrend.integration").append("\n"); 
		query.append("FileName : CntrAccuracyTrendDBDAOSearchLoadingTrendByLaneListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("WITH DUMMY_HEAD AS" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("    SELECT DISTINCT " ).append("\n"); 
		query.append("           A.TRD_CD" ).append("\n"); 
		query.append("          ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("          ,A.RLANE_CD" ).append("\n"); 
		query.append("          ,A.SLAN_CD" ).append("\n"); 
		query.append("          ,SUBSTR(A.SLS_YRMON, 0, 4)||A.COST_WK WEEK" ).append("\n"); 
		query.append("          ,A.VSL_CD||A.SKD_VOY_NO||A.DIR_CD VVD " ).append("\n"); 
		query.append("          ,A.VSL_CD" ).append("\n"); 
		query.append("          ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("          ,A.DIR_CD" ).append("\n"); 
		query.append("          ,D.YD_CD " ).append("\n"); 
		query.append("          ,D.VPS_PORT_CD" ).append("\n"); 
		query.append("          ,D.CLPT_SEQ" ).append("\n"); 
		query.append("          ,D.CLPT_IND_SEQ" ).append("\n"); 
		query.append("          ,E.CONTI_CD" ).append("\n"); 
		query.append("          ,D.VPS_ETA_DT" ).append("\n"); 
		query.append("          ,D.VPS_ETB_DT " ).append("\n"); 
		query.append("          ,D.VPS_ETD_DT" ).append("\n"); 
		query.append("    FROM COA_MON_VVD A" ).append("\n"); 
		query.append("        ,VSK_VSL_PORT_SKD D" ).append("\n"); 
		query.append("        ,MDM_LOCATION E" ).append("\n"); 
		query.append("    WHERE A.VSL_CD     = D.VSL_CD" ).append("\n"); 
		query.append("    AND   A.SKD_VOY_NO = D.SKD_VOY_NO" ).append("\n"); 
		query.append("    AND   A.DIR_CD     = D.SKD_DIR_CD " ).append("\n"); 
		query.append("    AND   D.VPS_PORT_CD= E.LOC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    -- 수정전 원본" ).append("\n"); 
		query.append("    --AND   (SELECT X.CONTI_CD FROM MDM_LOCATION X WHERE X.LOC_CD = A.LST_LODG_PORT_CD) = E.CONTI_CD  -- COA MON VVD의 LAST CALLING LOADING PORT 의 대륙의 PORT만 조회(LOADING만 조회)" ).append("\n"); 
		query.append("    -- 수정후 (2014-01-15, AFRICA PORT 를 EUROPE 으로 병합, )" ).append("\n"); 
		query.append("    AND   (SELECT DECODE(X.CONTI_CD, 'F', 'E', X.CONTI_CD) FROM MDM_LOCATION X WHERE X.LOC_CD = A.LST_LODG_PORT_CD) = DECODE(E.CONTI_CD, 'F', 'E', E.CONTI_CD)  -- COA MON VVD의 LAST CALLING LOADING PORT 의 대륙의 PORT만 조회(LOADING만 조회)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    AND   A.DELT_FLG = 'N'" ).append("\n"); 
		query.append("    AND   NVL(D.VPS_PORT_CD, ' ') NOT IN ('PAPAC', 'EGSUZ')" ).append("\n"); 
		query.append("    AND   NVL(D.SKD_CNG_STS_CD, 'X') <> 'S'  -- SKIP PORT 제외(20140203)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("  #if (${vvd_cd} != '') " ).append("\n"); 
		query.append("    -- VVD" ).append("\n"); 
		query.append("    AND   A.VSL_CD     = SUBSTR(@[vvd_cd], 0, 4)" ).append("\n"); 
		query.append("    AND   A.SKD_VOY_NO = SUBSTR(@[vvd_cd], 5, 4)" ).append("\n"); 
		query.append("    AND   A.DIR_CD     = SUBSTR(@[vvd_cd], 9, 1)" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("  -- WEEK" ).append("\n"); 
		query.append("  #if (${dt_tp_cd} == 'W')" ).append("\n"); 
		query.append("    #if (${fm_wk} != '' && ${to_wk} != '') " ).append("\n"); 
		query.append("      AND   SUBSTR(A.SLS_YRMON, 0, 4)||A.COST_WK BETWEEN @[fm_wk] AND @[to_wk]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("      -- ETA DATE" ).append("\n"); 
		query.append("  #else" ).append("\n"); 
		query.append("    #if (${eta_fm_dt} != '' && ${eta_to_dt} != '') " ).append("\n"); 
		query.append("      AND   TO_CHAR(D.VPS_ETA_DT, 'YYYYMMDD') BETWEEN @[eta_fm_dt] AND @[eta_to_dt]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("  #if (${trade} != '')" ).append("\n"); 
		query.append("      -- TRADE CD" ).append("\n"); 
		query.append("  	AND   A.TRD_CD IN (" ).append("\n"); 
		query.append("  		 #foreach($key IN ${arr_trd_cd})" ).append("\n"); 
		query.append("  		  	#if($velocityCount < $arr_trd_cd.size())" ).append("\n"); 
		query.append("  				'$key', " ).append("\n"); 
		query.append("  			#else " ).append("\n"); 
		query.append("  				'$key' " ).append("\n"); 
		query.append("  			#end " ).append("\n"); 
		query.append("  		#end " ).append("\n"); 
		query.append("  			           )" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("  #if (${subtrade} != '')" ).append("\n"); 
		query.append("      -- SUB TRADE CD" ).append("\n"); 
		query.append("  	AND (" ).append("\n"); 
		query.append("  		#foreach($key IN ${arr_sub_trd_cd})" ).append("\n"); 
		query.append("  			#if($velocityCount == 1 )" ).append("\n"); 
		query.append("  			     (A.TRD_CD = SUBSTR('$key',1,3) AND A.SUB_TRD_CD = SUBSTR('$key',4,2))" ).append("\n"); 
		query.append("  			#else " ).append("\n"); 
		query.append("  			  OR (A.TRD_CD = SUBSTR('$key',1,3) AND A.SUB_TRD_CD = SUBSTR('$key',4,2))" ).append("\n"); 
		query.append("  			#end " ).append("\n"); 
		query.append("  		#end " ).append("\n"); 
		query.append("  		 )" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("  #if (${lane} != '') " ).append("\n"); 
		query.append("  	-- LANE CD" ).append("\n"); 
		query.append("  	AND (" ).append("\n"); 
		query.append("  		#foreach($key IN ${arr_lane})" ).append("\n"); 
		query.append("  		  #if($velocityCount == 1 ) " ).append("\n"); 
		query.append("  			   (A.TRD_CD = SUBSTR('$key',1,3) AND A.SUB_TRD_CD = SUBSTR('$key',4,2) AND A.SLAN_CD = SUBSTR('$key',6))" ).append("\n"); 
		query.append("  		  #else " ).append("\n"); 
		query.append("  			OR (A.TRD_CD = SUBSTR('$key',1,3) AND A.SUB_TRD_CD = SUBSTR('$key',4,2) AND A.SLAN_CD = SUBSTR('$key',6))" ).append("\n"); 
		query.append("  		  #end " ).append("\n"); 
		query.append("  		#end " ).append("\n"); 
		query.append("  		)" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("  #if (${rcc_cd} != '' || ${loc_tp_cd} != ''|| ${loc_cd} != '')" ).append("\n"); 
		query.append("      -- LOCATION" ).append("\n"); 
		query.append("      AND   D.VPS_PORT_CD IN " ).append("\n"); 
		query.append("      (" ).append("\n"); 
		query.append("          SELECT DISTINCT B.LOC_CD " ).append("\n"); 
		query.append("          FROM MDM_EQ_ORZ_CHT A" ).append("\n"); 
		query.append("              ,MDM_LOCATION B" ).append("\n"); 
		query.append("          WHERE A.SCC_CD   = B.SCC_CD            " ).append("\n"); 
		query.append("          AND   A.DELT_FLG = 'N'" ).append("\n"); 
		query.append("  	#if (${rcc_cd} != '') " ).append("\n"); 
		query.append("          AND   A.RCC_CD = @[rcc_cd]" ).append("\n"); 
		query.append("    #end" ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("  	#if (${loc_tp_cd} == 'L')" ).append("\n"); 
		query.append("  	  #if (${loc_cd} != '') " ).append("\n"); 
		query.append("          AND A.LCC_CD  = @[loc_cd]" ).append("\n"); 
		query.append("  	  #end" ).append("\n"); 
		query.append("  	#elseif (${loc_tp_cd} == 'S')" ).append("\n"); 
		query.append("  	  #if (${loc_cd} != '') " ).append("\n"); 
		query.append("  		AND A.SCC_CD  = @[loc_cd]" ).append("\n"); 
		query.append("  	  #end" ).append("\n"); 
		query.append("  	#elseif (${loc_tp_cd} == 'E') " ).append("\n"); 
		query.append("  	  #if (${loc_cd} != '') " ).append("\n"); 
		query.append("  	    AND A.ECC_CD  = @[loc_cd]" ).append("\n"); 
		query.append("  	  #end" ).append("\n"); 
		query.append("  	#end" ).append("\n"); 
		query.append("      )" ).append("\n"); 
		query.append("  #end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    ORDER BY 1,2,3,4,CLPT_SEQ" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- MT PLAN (A) ----------------------------------------" ).append("\n"); 
		query.append(",DUMMY_PLAN AS" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("    SELECT SUB_TRD_CD" ).append("\n"); 
		query.append("          ,VSL_LANE_CD" ).append("\n"); 
		query.append("          ,VSL_CD" ).append("\n"); 
		query.append("          ,SKD_VOY_NO" ).append("\n"); 
		query.append("          ,SKD_DIR_CD" ).append("\n"); 
		query.append("          ,POL_YD_CD" ).append("\n"); 
		query.append("          ,FCBF_DT" ).append("\n"); 
		query.append("          ,TEU_QTY" ).append("\n"); 
		query.append("          ,TON_WGT" ).append("\n"); 
		query.append("          ,TYPE1" ).append("\n"); 
		query.append("          ,TYPE2" ).append("\n"); 
		query.append("          ,PLN_RSN_RMK" ).append("\n"); 
		query.append("          ,NVL(SUM(CNTR_QTY), 0) QTY_BOX" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D2', CNTR_QTY)), '') QTY_D2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D4', CNTR_QTY)), '') QTY_D4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D5', CNTR_QTY)), '') QTY_D5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D7', CNTR_QTY)), '') QTY_D7" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R2', CNTR_QTY)), '') QTY_R2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R5', CNTR_QTY)), '') QTY_R5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R9', CNTR_QTY)), '') QTY_R9" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'O2', CNTR_QTY)), '') QTY_O2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'O4', CNTR_QTY)), '') QTY_O4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'O5', CNTR_QTY)), '') QTY_O5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'S2', CNTR_QTY)), '') QTY_S2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'S4', CNTR_QTY)), '') QTY_S4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F2', CNTR_QTY)), '') QTY_F2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F4', CNTR_QTY)), '') QTY_F4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F5', CNTR_QTY)), '') QTY_F5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A2', CNTR_QTY)), '') QTY_A2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A4', CNTR_QTY)), '') QTY_A4" ).append("\n"); 
		query.append("          ,1 CLPT_IND_SEQ                                                                " ).append("\n"); 
		query.append("    FROM" ).append("\n"); 
		query.append("    (" ).append("\n"); 
		query.append("        SELECT A.TRD_CD" ).append("\n"); 
		query.append("              ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("              ,A.VSL_LANE_CD" ).append("\n"); 
		query.append("              ,A.VSL_CD" ).append("\n"); 
		query.append("              ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("              ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("              ,A.POL_YD_CD " ).append("\n"); 
		query.append("              ,TO_CHAR(A.FNL_CBF_DT, 'YYYY-MM-DD') FCBF_DT" ).append("\n"); 
		query.append("              ,A.MTY_LODG_PLN_TEU_QTY TEU_QTY" ).append("\n"); 
		query.append("              ,A.MTY_LODG_PLN_TON_WGT TON_WGT" ).append("\n"); 
		query.append("              ,D.PLN_RSN_HDR_NM TYPE1" ).append("\n"); 
		query.append("              ,E.PLN_RSN_SUB_NM TYPE2" ).append("\n"); 
		query.append("              ,PLN_RSN_RMK      " ).append("\n"); 
		query.append("              ,C.CNTR_TPSZ_CD TPSZ_CD" ).append("\n"); 
		query.append("              ,C.CNTR_QTY" ).append("\n"); 
		query.append("        FROM EQR_CTRL_MTY_LODG_PLN A" ).append("\n"); 
		query.append("            ,EQR_CTRL_MTY_DCHG_PLN B" ).append("\n"); 
		query.append("            ,EQR_CTRL_MTY_DCHG_PLN_QTY C" ).append("\n"); 
		query.append("            ,EQR_CTRL_PLN_RSN_HDR D" ).append("\n"); 
		query.append("            ,EQR_CTRL_PLN_RSN_SUB E" ).append("\n"); 
		query.append("            ,DUMMY_HEAD Z" ).append("\n"); 
		query.append("        WHERE A.VSL_CD     = B.VSL_CD" ).append("\n"); 
		query.append("        AND   A.SKD_VOY_NO = B.SKD_VOY_NO    " ).append("\n"); 
		query.append("        AND   A.SKD_DIR_CD = B.SKD_DIR_CD" ).append("\n"); 
		query.append("        AND   A.POL_YD_CD  = B.POL_YD_CD" ).append("\n"); 
		query.append("        AND   B.VSL_CD     = C.VSL_CD" ).append("\n"); 
		query.append("        AND   B.SKD_VOY_NO = C.SKD_VOY_NO" ).append("\n"); 
		query.append("        AND   B.SKD_DIR_CD = C.SKD_DIR_CD" ).append("\n"); 
		query.append("        AND   B.POL_YD_CD  = C.POL_YD_CD" ).append("\n"); 
		query.append("        AND   B.POD_YD_CD  = C.POD_YD_CD" ).append("\n"); 
		query.append("        AND   A.PLN_RSN_HDR_CD = D.PLN_RSN_HDR_CD(+)" ).append("\n"); 
		query.append("        AND   A.PLN_RSN_HDR_CD = E.PLN_RSN_HDR_CD(+)" ).append("\n"); 
		query.append("        AND   A.PLN_RSN_SUB_CD = E.PLN_RSN_SUB_CD(+)" ).append("\n"); 
		query.append("        AND   A.SUB_TRD_CD = Z.SUB_TRD_CD" ).append("\n"); 
		query.append("        AND   A.VSL_LANE_CD= Z.SLAN_CD" ).append("\n"); 
		query.append("        AND   A.VSL_CD     = Z.VSL_CD" ).append("\n"); 
		query.append("        AND   A.SKD_VOY_NO = Z.SKD_VOY_NO" ).append("\n"); 
		query.append("        AND   A.SKD_DIR_CD = Z.DIR_CD  " ).append("\n"); 
		query.append("        AND   A.POL_YD_CD  = Z.YD_CD" ).append("\n"); 
		query.append("        AND   Z.CLPT_IND_SEQ = 1  -- PLAN은 1만 취급" ).append("\n"); 
		query.append("        -- AND   B.MTY_PLN_SHW_FLG = 'Y' (조건제거, 2013-10-16,  )" ).append("\n"); 
		query.append("    )" ).append("\n"); 
		query.append("    GROUP BY SUB_TRD_CD" ).append("\n"); 
		query.append("            ,VSL_LANE_CD" ).append("\n"); 
		query.append("            ,VSL_CD" ).append("\n"); 
		query.append("            ,SKD_VOY_NO" ).append("\n"); 
		query.append("            ,SKD_DIR_CD" ).append("\n"); 
		query.append("            ,POL_YD_CD" ).append("\n"); 
		query.append("            ,FCBF_DT" ).append("\n"); 
		query.append("            ,TEU_QTY" ).append("\n"); 
		query.append("            ,TON_WGT" ).append("\n"); 
		query.append("            ,TYPE1" ).append("\n"); 
		query.append("            ,TYPE2" ).append("\n"); 
		query.append("            ,PLN_RSN_RMK" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- MT BOOKING (B) ---------------------------------------------" ).append("\n"); 
		query.append(",DUMMY_MTBOOKING AS" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("    SELECT VSL_CD" ).append("\n"); 
		query.append("          ,SKD_VOY_NO" ).append("\n"); 
		query.append("          ,SKD_DIR_CD" ).append("\n"); 
		query.append("          ,VSL_LANE_CD" ).append("\n"); 
		query.append("          ,POL_YD_CD          " ).append("\n"); 
		query.append("          " ).append("\n"); 
		query.append("          ,SUM(QTY_TEU) TEU_QTY" ).append("\n"); 
		query.append("          ,SUM(TON_WGT) TON_WGT" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("          ,NVL(SUM(CNTR_QTY), 0) QTY_BOX                " ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D2', CNTR_QTY)), 0) QTY_D2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D4', CNTR_QTY)), 0) QTY_D4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D5', CNTR_QTY)), 0) QTY_D5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'D7', CNTR_QTY)), 0) QTY_D7" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R2', CNTR_QTY)), 0) QTY_R2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R5', CNTR_QTY)), 0) QTY_R5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'R9', CNTR_QTY)), 0) QTY_R9" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'O2', CNTR_QTY)), 0) QTY_O2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'O4', CNTR_QTY)), 0) QTY_O4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'O5', CNTR_QTY)), 0) QTY_O5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'S2', CNTR_QTY)), 0) QTY_S2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'S4', CNTR_QTY)), 0) QTY_S4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F2', CNTR_QTY)), 0) QTY_F2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F4', CNTR_QTY)), 0) QTY_F4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'F5', CNTR_QTY)), 0) QTY_F5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A2', CNTR_QTY)), 0) QTY_A2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(TPSZ_CD, 'A4', CNTR_QTY)), 0) QTY_A4" ).append("\n"); 
		query.append("          --,1 CLPT_IND_SEQ " ).append("\n"); 
		query.append("          ,POL_CLPT_IND_SEQ CLPT_IND_SEQ  -- 2014-02-03 로직변경,          " ).append("\n"); 
		query.append("                                           " ).append("\n"); 
		query.append("    FROM" ).append("\n"); 
		query.append("    (" ).append("\n"); 
		query.append("        SELECT A.VSL_CD" ).append("\n"); 
		query.append("              ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("              ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("              ,A.SLAN_CD VSL_LANE_CD" ).append("\n"); 
		query.append("              ,A.POL_YD_CD" ).append("\n"); 
		query.append("              ,A.POL_CLPT_IND_SEQ" ).append("\n"); 
		query.append("              ,B.BKG_NO" ).append("\n"); 
		query.append("              ,B.CNTR_TPSZ_CD TPSZ_CD" ).append("\n"); 
		query.append("              ,B.OP_CNTR_QTY CNTR_QTY" ).append("\n"); 
		query.append("              ,DECODE(SUBSTR(B.CNTR_TPSZ_CD,-1), '2' ,OP_CNTR_QTY, OP_CNTR_QTY*2) QTY_TEU" ).append("\n"); 
		query.append("              ,ROUND((C.CNTR_TPSZ_TARE_WGT * B.OP_CNTR_QTY) / 1000, 1) AS TON_WGT" ).append("\n"); 
		query.append("        FROM --EQR_CTRL_MTY_BKG_EXE A" ).append("\n"); 
		query.append("             BKG_VVD A" ).append("\n"); 
		query.append("            ,BKG_QUANTITY B" ).append("\n"); 
		query.append("            ,MDM_CNTR_TP_SZ C" ).append("\n"); 
		query.append("            ,BKG_BOOKING D" ).append("\n"); 
		query.append("            ,DUMMY_HEAD Z" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("        WHERE D.VSL_CD        = Z.VSL_CD" ).append("\n"); 
		query.append("        AND   D.SKD_VOY_NO    = Z.SKD_VOY_NO" ).append("\n"); 
		query.append("        AND   D.SKD_DIR_CD    = Z.DIR_CD   " ).append("\n"); 
		query.append("        AND   D.POL_NOD_CD    = Z.YD_CD " ).append("\n"); 
		query.append("        AND   D.BKG_CGO_TP_CD = 'P' " ).append("\n"); 
		query.append("        AND   D.BKG_NO        = A.BKG_NO" ).append("\n"); 
		query.append("        AND   A.POL_CLPT_IND_SEQ = Z.CLPT_IND_SEQ" ).append("\n"); 
		query.append("        AND   A.BKG_NO        = B.BKG_NO" ).append("\n"); 
		query.append("        AND   B.CNTR_TPSZ_CD= C.CNTR_TPSZ_CD" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    )" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    GROUP BY VSL_CD" ).append("\n"); 
		query.append("          ,SKD_VOY_NO" ).append("\n"); 
		query.append("          ,SKD_DIR_CD" ).append("\n"); 
		query.append("          ,VSL_LANE_CD" ).append("\n"); 
		query.append("          ,POL_YD_CD" ).append("\n"); 
		query.append("          ,POL_CLPT_IND_SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- FULL BOOKING (D) ---------------------------------------------" ).append("\n"); 
		query.append(",DUMMY_FULLBKG AS" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("    SELECT A.VSL_CD" ).append("\n"); 
		query.append("          ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("          ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("          ,A.POL_YD_CD" ).append("\n"); 
		query.append("          ,A.CLPT_SEQ" ).append("\n"); 
		query.append("          ,NVL(MAX(A.FULL_BKG_LOD_TTL_TEU_QTY ),0) F_L_TEU " ).append("\n"); 
		query.append("          ,NVL(MAX(A.FULL_BKG_LOD_TTL_WGT     ),0) F_L_WGT" ).append("\n"); 
		query.append("          ,NVL(MAX(A.FULL_BKG_DCHG_TTL_TEU_QTY),0) F_D_TEU" ).append("\n"); 
		query.append("          ,NVL(MAX(A.FULL_BKG_DCHG_TTL_WGT    ),0) F_D_WGT" ).append("\n"); 
		query.append("          ,NVL(MAX(A.FULL_BKG_OBRD_TTL_TEU_QTY),0) F_O_TEU" ).append("\n"); 
		query.append("          ,NVL(MAX(A.FULL_BKG_OBRD_TTL_WGT    ),0) F_O_WGT" ).append("\n"); 
		query.append("          ,NVL(MAX(A.FULL_BKG_AVG_TTL_WGT     ),0) F_VOID" ).append("\n"); 
		query.append("          ,NVL(MAX(A.BKG_OBRD_TTL_TEU_QTY     ),0) T_O_TEU  -- TOTAL ONBOARD TEU (MTY+FULL)" ).append("\n"); 
		query.append("          ,NVL(MAX(A.BKG_OBRD_TTL_WGT         ),0) T_O_WGT  -- TOTAL ONBOARD WGT (MTY+FULL)   " ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', B.CNTR_QTY)),0) F_L_BOX" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'D2', B.CNTR_QTY))),0) F_L_D2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'D4', B.CNTR_QTY))),0) F_L_D4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'D5', B.CNTR_QTY))),0) F_L_D5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'D7', B.CNTR_QTY))),0) F_L_D7" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'R2', B.CNTR_QTY))),0) F_L_R2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'R5', B.CNTR_QTY))),0) F_L_R5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'R9', B.CNTR_QTY))),0) F_L_R9" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'O2', B.CNTR_QTY))),0) F_L_O2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'O4', B.CNTR_QTY))),0) F_L_O4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'O5', B.CNTR_QTY))),0) F_L_O5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'S2', B.CNTR_QTY))),0) F_L_S2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'S4', B.CNTR_QTY))),0) F_L_S4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'F2', B.CNTR_QTY))),0) F_L_F2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'F4', B.CNTR_QTY))),0) F_L_F4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'F5', B.CNTR_QTY))),0) F_L_F5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'A2', B.CNTR_QTY))),0) F_L_A2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'L', DECODE(B.CNTR_TPSZ_CD, 'A4', B.CNTR_QTY))),0) F_L_A4" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', B.CNTR_QTY)),0) F_D_BOX      " ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'D2', B.CNTR_QTY))),0) F_D_D2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'D4', B.CNTR_QTY))),0) F_D_D4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'D5', B.CNTR_QTY))),0) F_D_D5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'D7', B.CNTR_QTY))),0) F_D_D7" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'R2', B.CNTR_QTY))),0) F_D_R2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'R5', B.CNTR_QTY))),0) F_D_R5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'R9', B.CNTR_QTY))),0) F_D_R9" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'O2', B.CNTR_QTY))),0) F_D_O2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'O4', B.CNTR_QTY))),0) F_D_O4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'O5', B.CNTR_QTY))),0) F_D_O5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'S2', B.CNTR_QTY))),0) F_D_S2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'S4', B.CNTR_QTY))),0) F_D_S4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'F2', B.CNTR_QTY))),0) F_D_F2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'F4', B.CNTR_QTY))),0) F_D_F4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'F5', B.CNTR_QTY))),0) F_D_F5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'A2', B.CNTR_QTY))),0) F_D_A2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'D', DECODE(B.CNTR_TPSZ_CD, 'A4', B.CNTR_QTY))),0) F_D_A4" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', B.CNTR_QTY)),0) F_O_BOX      " ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'D2', B.CNTR_QTY))),0) F_O_D2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'D4', B.CNTR_QTY))),0) F_O_D4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'D5', B.CNTR_QTY))),0) F_O_D5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'D7', B.CNTR_QTY))),0) F_O_D7" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'R2', B.CNTR_QTY))),0) F_O_R2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'R5', B.CNTR_QTY))),0) F_O_R5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'R9', B.CNTR_QTY))),0) F_O_R9" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'O2', B.CNTR_QTY))),0) F_O_O2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'O4', B.CNTR_QTY))),0) F_O_O4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'O5', B.CNTR_QTY))),0) F_O_O5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'S2', B.CNTR_QTY))),0) F_O_S2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'S4', B.CNTR_QTY))),0) F_O_S4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'F2', B.CNTR_QTY))),0) F_O_F2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'F4', B.CNTR_QTY))),0) F_O_F4" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'F5', B.CNTR_QTY))),0) F_O_F5" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'A2', B.CNTR_QTY))),0) F_O_A2" ).append("\n"); 
		query.append("          ,NVL(SUM(DECODE(B.MTY_FULL_BKG_BX_DIV_CD, 'O', DECODE(B.CNTR_TPSZ_CD, 'A4', B.CNTR_QTY))),0) F_O_A4" ).append("\n"); 
		query.append("    " ).append("\n"); 
		query.append("    FROM EQR_CTRL_FULL_LOD_SNAP A" ).append("\n"); 
		query.append("        ,EQR_CTRL_FULL_LOD_SNAP_DTL B" ).append("\n"); 
		query.append("        ,DUMMY_HEAD X" ).append("\n"); 
		query.append("    WHERE A.VSL_CD     = B.VSL_CD" ).append("\n"); 
		query.append("    AND   A.SKD_VOY_NO = B.SKD_VOY_NO" ).append("\n"); 
		query.append("    AND   A.SKD_DIR_CD = B.SKD_DIR_CD" ).append("\n"); 
		query.append("    AND   A.POL_YD_CD  = B.POL_YD_CD   " ).append("\n"); 
		query.append("    AND   A.CLPT_SEQ   = B.CLPT_SEQ" ).append("\n"); 
		query.append("    AND   B.VSL_CD     = X.VSL_CD    " ).append("\n"); 
		query.append("    AND   B.SKD_VOY_NO = X.SKD_VOY_NO" ).append("\n"); 
		query.append("    AND   B.SKD_DIR_CD = X.DIR_CD" ).append("\n"); 
		query.append("    AND   B.POL_YD_CD  = X.YD_CD  " ).append("\n"); 
		query.append("    GROUP BY A.VSL_CD" ).append("\n"); 
		query.append("          ,A.SKD_VOY_NO" ).append("\n"); 
		query.append("          ,A.SKD_DIR_CD" ).append("\n"); 
		query.append("          ,A.POL_YD_CD  " ).append("\n"); 
		query.append("          ,A.CLPT_SEQ" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- BSA TEU -------------------------------------------------" ).append("\n"); 
		query.append(",DUMMY_BSA_TEU AS" ).append("\n"); 
		query.append("(                                  " ).append("\n"); 
		query.append("    SELECT X.VPS_PORT_CD PORT_CD" ).append("\n"); 
		query.append("          ,X.RLANE_CD" ).append("\n"); 
		query.append("          ,X.VSL_CD" ).append("\n"); 
		query.append("          ,X.SKD_VOY_NO" ).append("\n"); 
		query.append("          ,X.DIR_CD" ).append("\n"); 
		query.append("          ,NVL(MAX(C.CRR_BSA_CAPA),0) BSA_TEU" ).append("\n"); 
		query.append("    FROM COA_LANE_RGST    B" ).append("\n"); 
		query.append("        ,BSA_VVD_OTR_CRR  C" ).append("\n"); 
		query.append("        ,DUMMY_HEAD       X" ).append("\n"); 
		query.append("    WHERE B.RLANE_CD        = C.RLANE_CD" ).append("\n"); 
		query.append("    AND   B.TRD_CD          = C.TRD_CD" ).append("\n"); 
		query.append("    AND   B.DIR_CD          = C.SKD_DIR_CD" ).append("\n"); 
		query.append("    AND   C.RLANE_CD     = X.RLANE_CD" ).append("\n"); 
		query.append("    AND   C.VSL_CD       = X.VSL_CD" ).append("\n"); 
		query.append("    AND   C.SKD_VOY_NO   = X.SKD_VOY_NO" ).append("\n"); 
		query.append("    AND   C.SKD_DIR_CD   = X.DIR_CD" ).append("\n"); 
		query.append("    AND   C.BSA_OP_JB_CD = '007' -- TOTAL TEU " ).append("\n"); 
		query.append("    AND   C.CRR_CD       = 'HJS'" ).append("\n"); 
		query.append("    GROUP BY X.VPS_PORT_CD " ).append("\n"); 
		query.append("            ,X.RLANE_CD" ).append("\n"); 
		query.append("            ,X.VSL_CD" ).append("\n"); 
		query.append("            ,X.SKD_VOY_NO" ).append("\n"); 
		query.append("            ,X.DIR_CD" ).append("\n"); 
		query.append(")                       " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- BSA WEIGHT" ).append("\n"); 
		query.append(",DUMMY_BSA_WGT AS" ).append("\n"); 
		query.append("(               " ).append("\n"); 
		query.append("    SELECT X.VPS_PORT_CD PORT_CD" ).append("\n"); 
		query.append("          ,X.RLANE_CD" ).append("\n"); 
		query.append("          ,X.VSL_CD" ).append("\n"); 
		query.append("          ,X.SKD_VOY_NO" ).append("\n"); 
		query.append("          ,X.DIR_CD" ).append("\n"); 
		query.append("          ,NVL(MAX(C.CRR_BSA_CAPA),0) BSA_WGT" ).append("\n"); 
		query.append("    FROM COA_LANE_RGST    B" ).append("\n"); 
		query.append("        ,BSA_VVD_OTR_CRR  C" ).append("\n"); 
		query.append("        ,DUMMY_HEAD       X" ).append("\n"); 
		query.append("    WHERE B.RLANE_CD     = C.RLANE_CD" ).append("\n"); 
		query.append("    AND   B.TRD_CD       = C.TRD_CD" ).append("\n"); 
		query.append("    AND   B.DIR_CD       = C.SKD_DIR_CD" ).append("\n"); 
		query.append("    AND   C.RLANE_CD     = X.RLANE_CD" ).append("\n"); 
		query.append("    AND   C.VSL_CD       = X.VSL_CD" ).append("\n"); 
		query.append("    AND   C.SKD_VOY_NO   = X.SKD_VOY_NO" ).append("\n"); 
		query.append("    AND   C.SKD_DIR_CD   = X.DIR_CD" ).append("\n"); 
		query.append("    AND   C.BSA_OP_JB_CD = '009' -- TEU기준 (009, TOTAL WEIGHT)" ).append("\n"); 
		query.append("    AND   C.CRR_CD       = 'HJS'" ).append("\n"); 
		query.append("    GROUP BY X.VPS_PORT_CD" ).append("\n"); 
		query.append("                 ,X.RLANE_CD" ).append("\n"); 
		query.append("                 ,X.VSL_CD" ).append("\n"); 
		query.append("                 ,X.SKD_VOY_NO" ).append("\n"); 
		query.append("                 ,X.DIR_CD                 " ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- NORMAL 쿼리 ---------------------------------------" ).append("\n"); 
		query.append(",DUMMY_NORMAL AS" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT A.TRD_CD" ).append("\n"); 
		query.append("      ,A.SUB_TRD_CD" ).append("\n"); 
		query.append("      ,A.SLAN_CD" ).append("\n"); 
		query.append("      ,A.WEEK" ).append("\n"); 
		query.append("      ,A.VVD" ).append("\n"); 
		query.append("      ,A.YD_CD" ).append("\n"); 
		query.append("      ,TO_CHAR(A.VPS_ETA_DT, 'YYYY-MM-DD HH24:MM') VPS_ETA_DT" ).append("\n"); 
		query.append("      ,TO_CHAR(A.VPS_ETD_DT, 'YYYY-MM-DD HH24:MM') VPS_ETD_DT " ).append("\n"); 
		query.append("      ,B.FCBF_DT" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("       -- MT PLAN(A)  " ).append("\n"); 
		query.append("      ,NVL(B.TEU_QTY,0) P_TEU" ).append("\n"); 
		query.append("      ,NVL(B.QTY_BOX,0) P_BOX" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,NVL(B.QTY_D2,0)  P_D2" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D4,0)  P_D4" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D5,0)  P_D5" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D7,0)  P_D7" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R2,0)  P_R2" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R5,0)  P_R5" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R9,0)  P_R9" ).append("\n"); 
		query.append("      ,NVL(B.QTY_O2,0)  P_O2" ).append("\n"); 
		query.append("      ,NVL(B.QTY_O4,0)  P_O4" ).append("\n"); 
		query.append("      ,NVL(B.QTY_O5,0)  P_O5" ).append("\n"); 
		query.append("      ,NVL(B.QTY_S2,0)  P_S2" ).append("\n"); 
		query.append("      ,NVL(B.QTY_S4,0)  P_S4" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F2,0)  P_F2" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F4,0)  P_F4" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F5,0)  P_F5" ).append("\n"); 
		query.append("      ,NVL(B.QTY_A2,0)  P_A2" ).append("\n"); 
		query.append("      ,NVL(B.QTY_A4,0)  P_A4" ).append("\n"); 
		query.append("      ,NVL(B.TON_WGT,0) P_WGT" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       -- MT BOOKING(B)      " ).append("\n"); 
		query.append("      ,NVL(C.TEU_QTY,0) M_TEU" ).append("\n"); 
		query.append("      ,NVL(C.QTY_BOX,0) M_BOX" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("      ,NVL(C.QTY_D2,0)  M_D2" ).append("\n"); 
		query.append("      ,NVL(C.QTY_D4,0)  M_D4" ).append("\n"); 
		query.append("      ,NVL(C.QTY_D5,0)  M_D5" ).append("\n"); 
		query.append("      ,NVL(C.QTY_D7,0)  M_D7" ).append("\n"); 
		query.append("      ,NVL(C.QTY_R2,0)  M_R2" ).append("\n"); 
		query.append("      ,NVL(C.QTY_R5,0)  M_R5" ).append("\n"); 
		query.append("      ,NVL(C.QTY_R9,0)  M_R9" ).append("\n"); 
		query.append("      ,NVL(C.QTY_O2,0)  M_O2" ).append("\n"); 
		query.append("      ,NVL(C.QTY_O4,0)  M_O4" ).append("\n"); 
		query.append("      ,NVL(C.QTY_O5,0)  M_O5" ).append("\n"); 
		query.append("      ,NVL(C.QTY_S2,0)  M_S2" ).append("\n"); 
		query.append("      ,NVL(C.QTY_S4,0)  M_S4" ).append("\n"); 
		query.append("      ,NVL(C.QTY_F2,0)  M_F2" ).append("\n"); 
		query.append("      ,NVL(C.QTY_F4,0)  M_F4" ).append("\n"); 
		query.append("      ,NVL(C.QTY_F5,0)  M_F5" ).append("\n"); 
		query.append("      ,NVL(C.QTY_A2,0)  M_A2" ).append("\n"); 
		query.append("      ,NVL(C.QTY_A4,0)  M_A4" ).append("\n"); 
		query.append("      ,NVL(C.TON_WGT,0) M_WGT " ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("      -- DIFF(A-B)" ).append("\n"); 
		query.append("      ,NVL(B.TEU_QTY, 0) - NVL(C.TEU_QTY, 0) DF_TEU_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_BOX, 0) - NVL(C.QTY_BOX, 0) DF_BOX_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D2,  0) - NVL(C.QTY_D2,  0) DF_D2_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D4,  0) - NVL(C.QTY_D4,  0) DF_D4_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D5,  0) - NVL(C.QTY_D5,  0) DF_D5_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_D7,  0) - NVL(C.QTY_D7,  0) DF_D7_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R2,  0) - NVL(C.QTY_R2,  0) DF_R2_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R5,  0) - NVL(C.QTY_R5,  0) DF_R5_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_R9,  0) - NVL(C.QTY_R9,  0) DF_R9_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_O2,  0) - NVL(C.QTY_O2,  0) DF_O2_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_O4,  0) - NVL(C.QTY_O4,  0) DF_O4_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_O5,  0) - NVL(C.QTY_O5,  0) DF_O5_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_S2,  0) - NVL(C.QTY_S2,  0) DF_S2_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_S4,  0) - NVL(C.QTY_S4,  0) DF_S4_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F2,  0) - NVL(C.QTY_F2,  0) DF_F2_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F4,  0) - NVL(C.QTY_F4,  0) DF_F4_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_F5,  0) - NVL(C.QTY_F5,  0) DF_F5_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_A2,  0) - NVL(C.QTY_A2,  0) DF_A2_A" ).append("\n"); 
		query.append("      ,NVL(B.QTY_A4,  0) - NVL(C.QTY_A4,  0) DF_A4_A" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       -- FULL BKG (LOAD)   " ).append("\n"); 
		query.append("      ,NVL(D.F_L_TEU,0) F_L_TEU" ).append("\n"); 
		query.append("      ,NVL(D.F_L_BOX,0) F_L_BOX" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      ,NVL(D.F_L_D2,0) F_L_D2" ).append("\n"); 
		query.append("      ,NVL(D.F_L_D4,0) F_L_D4" ).append("\n"); 
		query.append("      ,NVL(D.F_L_D5,0) F_L_D5" ).append("\n"); 
		query.append("      ,NVL(D.F_L_D7,0) F_L_D7" ).append("\n"); 
		query.append("      ,NVL(D.F_L_R2,0) F_L_R2" ).append("\n"); 
		query.append("      ,NVL(D.F_L_R5,0) F_L_R5" ).append("\n"); 
		query.append("      ,NVL(D.F_L_R9,0) F_L_R9" ).append("\n"); 
		query.append("      ,NVL(D.F_L_O2,0) F_L_O2" ).append("\n"); 
		query.append("      ,NVL(D.F_L_O4,0) F_L_O4" ).append("\n"); 
		query.append("      ,NVL(D.F_L_O5,0) F_L_O5" ).append("\n"); 
		query.append("      ,NVL(D.F_L_S2,0) F_L_S2" ).append("\n"); 
		query.append("      ,NVL(D.F_L_S4,0) F_L_S4" ).append("\n"); 
		query.append("      ,NVL(D.F_L_F2,0) F_L_F2" ).append("\n"); 
		query.append("      ,NVL(D.F_L_F4,0) F_L_F4" ).append("\n"); 
		query.append("      ,NVL(D.F_L_F5,0) F_L_F5" ).append("\n"); 
		query.append("      ,NVL(D.F_L_A2,0) F_L_A2" ).append("\n"); 
		query.append("      ,NVL(D.F_L_A4,0) F_L_A4" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      ,NVL(D.F_L_WGT,0) F_L_WGT             " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("       -- FULL BKG (DISCH)" ).append("\n"); 
		query.append("      ,NVL(D.F_D_TEU,0) F_D_TEU" ).append("\n"); 
		query.append("      ,NVL(D.F_D_BOX,0) F_D_BOX" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      ,NVL(D.F_D_D2,0) F_D_D2" ).append("\n"); 
		query.append("      ,NVL(D.F_D_D4,0) F_D_D4" ).append("\n"); 
		query.append("      ,NVL(D.F_D_D5,0) F_D_D5" ).append("\n"); 
		query.append("      ,NVL(D.F_D_D7,0) F_D_D7" ).append("\n"); 
		query.append("      ,NVL(D.F_D_R2,0) F_D_R2" ).append("\n"); 
		query.append("      ,NVL(D.F_D_R5,0) F_D_R5" ).append("\n"); 
		query.append("      ,NVL(D.F_D_R9,0) F_D_R9" ).append("\n"); 
		query.append("      ,NVL(D.F_D_O2,0) F_D_O2" ).append("\n"); 
		query.append("      ,NVL(D.F_D_O4,0) F_D_O4" ).append("\n"); 
		query.append("      ,NVL(D.F_D_O5,0) F_D_O5" ).append("\n"); 
		query.append("      ,NVL(D.F_D_S2,0) F_D_S2" ).append("\n"); 
		query.append("      ,NVL(D.F_D_S4,0) F_D_S4" ).append("\n"); 
		query.append("      ,NVL(D.F_D_F2,0) F_D_F2" ).append("\n"); 
		query.append("      ,NVL(D.F_D_F4,0) F_D_F4" ).append("\n"); 
		query.append("      ,NVL(D.F_D_F5,0) F_D_F5" ).append("\n"); 
		query.append("      ,NVL(D.F_D_A2,0) F_D_A2" ).append("\n"); 
		query.append("      ,NVL(D.F_D_A4,0) F_D_A4" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      ,NVL(D.F_D_WGT,0)  F_D_WGT" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,NVL(D.F_O_WGT,0)  F_O_WGT" ).append("\n"); 
		query.append("      ,NVL(D.F_O_TEU,0)  F_O_TEU" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("      ,NVL(D.T_O_WGT,0)  T_O_WGT" ).append("\n"); 
		query.append("      ,NVL(D.T_O_TEU,0)  T_O_TEU          " ).append("\n"); 
		query.append("       -- VOID (45FT-D7:R9 , HC-D5:R5)" ).append("\n"); 
		query.append("      --,NVL(" ).append("\n"); 
		query.append("      --   SPC_LANE_RGST_QTY_FNC('45', A.RLANE_CD, TO_CHAR(A.VPS_ETA_DT, 'YYYYMMDD'), SUBSTR(A.YD_CD,0,5), A.VVD, F.BSA_TEU, (NVL(C.QTY_D7,0) + NVL(C.QTY_R9,0) + NVL(D.F_L_D7,0) + NVL(D.F_L_R9, 0))) " ).append("\n"); 
		query.append("      --  +SPC_LANE_RGST_QTY_FNC('HC', A.RLANE_CD, TO_CHAR(A.VPS_ETA_DT, 'YYYYMMDD'), SUBSTR(A.YD_CD,0,5), A.VVD, F.BSA_TEU, (NVL(C.QTY_D5,0) + NVL(C.QTY_R5,0) + NVL(D.F_L_D5,0) + NVL(D.F_L_R5, 0)))" ).append("\n"); 
		query.append("      -- , 0) VOID" ).append("\n"); 
		query.append("      ,NVL(D.F_VOID, 0) VOID" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       -- BSA" ).append("\n"); 
		query.append("      ,NVL(F.BSA_TEU,0) BSA_TEU" ).append("\n"); 
		query.append("      ,NVL(G.BSA_WGT,0) BSA_WGT" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       -- PLAN REASON / REMARK" ).append("\n"); 
		query.append("      ,B.TYPE1" ).append("\n"); 
		query.append("      ,B.TYPE2" ).append("\n"); 
		query.append("      ,B.PLN_RSN_RMK " ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("       -- HIDDEN AREA   " ).append("\n"); 
		query.append("      ,1 SORT_FLAG      " ).append("\n"); 
		query.append("      ,A.CLPT_SEQ     " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM DUMMY_HEAD      A" ).append("\n"); 
		query.append("    ,DUMMY_PLAN      B" ).append("\n"); 
		query.append("    ,DUMMY_MTBOOKING C" ).append("\n"); 
		query.append("    ,DUMMY_FULLBKG   D" ).append("\n"); 
		query.append("    ,DUMMY_BSA_TEU   F" ).append("\n"); 
		query.append("    ,DUMMY_BSA_WGT   G" ).append("\n"); 
		query.append("WHERE A.VSL_CD     = B.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = B.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = B.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = B.POL_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = B.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = C.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = C.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = C.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = C.POL_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_IND_SEQ = C.CLPT_IND_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = D.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = D.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = D.SKD_DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.YD_CD      = D.POL_YD_CD(+)" ).append("\n"); 
		query.append("AND   A.CLPT_SEQ   = D.CLPT_SEQ(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = F.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = F.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = F.DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.VPS_PORT_CD= F.PORT_CD(+)" ).append("\n"); 
		query.append("AND   A.VSL_CD     = G.VSL_CD(+)" ).append("\n"); 
		query.append("AND   A.SKD_VOY_NO = G.SKD_VOY_NO(+)" ).append("\n"); 
		query.append("AND   A.DIR_CD     = G.DIR_CD(+)" ).append("\n"); 
		query.append("AND   A.VPS_PORT_CD= G.PORT_CD(+)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${vvd_cd} == '') " ).append("\n"); 
		query.append("-- AVG 쿼리 ---------------------------------------" ).append("\n"); 
		query.append(",DUMMY_AVG AS" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("    SELECT SUB_TRD_CD" ).append("\n"); 
		query.append("          ,SLAN_CD" ).append("\n"); 
		query.append("          ,WEEK" ).append("\n"); 
		query.append("          ,YD_CD" ).append("\n"); 
		query.append("          ,ROUND(AVG(P_TEU    ))  P_TEU      " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_BOX    ))  P_BOX    " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_D2     ))  P_D2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_D4     ))  P_D4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_D5     ))  P_D5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_D7     ))  P_D7     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_R2     ))  P_R2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_R5     ))  P_R5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_R9     ))  P_R9     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_O2     ))  P_O2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_O4     ))  P_O4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_O5     ))  P_O5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_S2     ))  P_S2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_S4     ))  P_S4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_F2     ))  P_F2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_F4     ))  P_F4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_F5     ))  P_F5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_A2     ))  P_A2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_A4     ))  P_A4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_WGT    ))  P_WGT    " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_TEU    ))  M_TEU    " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_BOX    ))  M_BOX    " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_D2     ))  M_D2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_D4     ))  M_D4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_D5     ))  M_D5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_D7     ))  M_D7     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_R2     ))  M_R2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_R5     ))  M_R5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_R9     ))  M_R9     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_O2     ))  M_O2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_O4     ))  M_O4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_O5     ))  M_O5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_S2     ))  M_S2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_S4     ))  M_S4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_F2     ))  M_F2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_F4     ))  M_F4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_F5     ))  M_F5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_A2     ))  M_A2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_A4     ))  M_A4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_WGT    ))  M_WGT  " ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_TEU_A ))  DF_TEU_A " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_BOX_A ))  DF_BOX_A " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_D2_A  ))  DF_D2_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_D4_A  ))  DF_D4_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_D5_A  ))  DF_D5_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_D7_A  ))  DF_D7_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_R2_A  ))  DF_R2_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_R5_A  ))  DF_R5_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_R9_A  ))  DF_R9_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_O2_A  ))  DF_O2_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_O4_A  ))  DF_O4_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_O5_A  ))  DF_O5_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_S2_A  ))  DF_S2_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_S4_A  ))  DF_S4_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_F2_A  ))  DF_F2_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_F4_A  ))  DF_F4_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_F5_A  ))  DF_F5_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_A2_A  ))  DF_A2_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_A4_A  ))  DF_A4_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_TEU  ))  F_L_TEU  " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_BOX  ))  F_L_BOX  " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_D2   ))  F_L_D2   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_D4   ))  F_L_D4   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_D5   ))  F_L_D5   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_D7   ))  F_L_D7   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_R2   ))  F_L_R2   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_R5   ))  F_L_R5   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_R9   ))  F_L_R9   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_O2   ))  F_L_O2   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_O4   ))  F_L_O4   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_O5   ))  F_L_O5   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_S2   ))  F_L_S2   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_S4   ))  F_L_S4   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_F2   ))  F_L_F2   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_F4   ))  F_L_F4   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_F5   ))  F_L_F5   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_A2   ))  F_L_A2   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_A4   ))  F_L_A4   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_WGT  ))  F_L_WGT  " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_TEU  ))  F_D_TEU" ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_BOX  ))  F_D_BOX" ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_D2   ))  F_D_D2 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_D4   ))  F_D_D4 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_D5   ))  F_D_D5 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_D7   ))  F_D_D7 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_R2   ))  F_D_R2 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_R5   ))  F_D_R5 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_R9   ))  F_D_R9 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_O2   ))  F_D_O2 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_O4   ))  F_D_O4 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_O5   ))  F_D_O5 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_S2   ))  F_D_S2 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_S4   ))  F_D_S4 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_F2   ))  F_D_F2 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_F4   ))  F_D_F4 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_F5   ))  F_D_F5 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_A2   ))  F_D_A2 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_A4   ))  F_D_A4 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_WGT  ))  F_D_WGT" ).append("\n"); 
		query.append("          ,ROUND(AVG(F_O_TEU  ))  F_O_TEU" ).append("\n"); 
		query.append("          ,ROUND(AVG(F_O_WGT  ))  F_O_WGT" ).append("\n"); 
		query.append("          ,ROUND(AVG(T_O_TEU  ))  T_O_TEU" ).append("\n"); 
		query.append("          ,ROUND(AVG(T_O_WGT  ))  T_O_WGT      " ).append("\n"); 
		query.append("          ,ROUND(AVG(VOID     ))  VOID   " ).append("\n"); 
		query.append("          ,ROUND(AVG(BSA_TEU  ))  BSA_TEU" ).append("\n"); 
		query.append("          ,ROUND(AVG(BSA_WGT  ))  BSA_WGT" ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("    FROM DUMMY_NORMAL" ).append("\n"); 
		query.append("    GROUP BY SUB_TRD_CD" ).append("\n"); 
		query.append("          ,SLAN_CD" ).append("\n"); 
		query.append("          ,WEEK" ).append("\n"); 
		query.append("          ,YD_CD" ).append("\n"); 
		query.append(")   " ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- NORMAL LINE" ).append("\n"); 
		query.append("SELECT SUB_TRD_CD" ).append("\n"); 
		query.append("      ,SLAN_CD" ).append("\n"); 
		query.append("      ,WEEK" ).append("\n"); 
		query.append("      ,VVD" ).append("\n"); 
		query.append("      ,YD_CD" ).append("\n"); 
		query.append("      ,VPS_ETA_DT" ).append("\n"); 
		query.append("      ,VPS_ETD_DT" ).append("\n"); 
		query.append("      ,FCBF_DT" ).append("\n"); 
		query.append("      ,P_TEU " ).append("\n"); 
		query.append("      ,P_BOX" ).append("\n"); 
		query.append("      ,P_D2" ).append("\n"); 
		query.append("      ,P_D4" ).append("\n"); 
		query.append("      ,P_D5" ).append("\n"); 
		query.append("      ,P_D7" ).append("\n"); 
		query.append("      ,P_R2" ).append("\n"); 
		query.append("      ,P_R5" ).append("\n"); 
		query.append("      ,P_R9" ).append("\n"); 
		query.append("      ,P_O2" ).append("\n"); 
		query.append("      ,P_O4" ).append("\n"); 
		query.append("      ,P_O5" ).append("\n"); 
		query.append("      ,P_S2" ).append("\n"); 
		query.append("      ,P_S4" ).append("\n"); 
		query.append("      ,P_F2" ).append("\n"); 
		query.append("      ,P_F4" ).append("\n"); 
		query.append("      ,P_F5" ).append("\n"); 
		query.append("      ,P_A2" ).append("\n"); 
		query.append("      ,P_A4" ).append("\n"); 
		query.append("      ,P_WGT" ).append("\n"); 
		query.append("      ,M_TEU" ).append("\n"); 
		query.append("      ,M_BOX" ).append("\n"); 
		query.append("      ,M_D2" ).append("\n"); 
		query.append("      ,M_D4" ).append("\n"); 
		query.append("      ,M_D5" ).append("\n"); 
		query.append("      ,M_D7" ).append("\n"); 
		query.append("      ,M_R2" ).append("\n"); 
		query.append("      ,M_R5" ).append("\n"); 
		query.append("      ,M_R9" ).append("\n"); 
		query.append("      ,M_O2" ).append("\n"); 
		query.append("      ,M_O4" ).append("\n"); 
		query.append("      ,M_O5" ).append("\n"); 
		query.append("      ,M_S2" ).append("\n"); 
		query.append("      ,M_S4" ).append("\n"); 
		query.append("      ,M_F2" ).append("\n"); 
		query.append("      ,M_F4" ).append("\n"); 
		query.append("      ,M_F5" ).append("\n"); 
		query.append("      ,M_A2" ).append("\n"); 
		query.append("      ,M_A4" ).append("\n"); 
		query.append("      ,M_WGT" ).append("\n"); 
		query.append("      ,DF_TEU_A" ).append("\n"); 
		query.append("      ,DF_BOX_A" ).append("\n"); 
		query.append("      ,DF_D2_A" ).append("\n"); 
		query.append("      ,DF_D4_A" ).append("\n"); 
		query.append("      ,DF_D5_A" ).append("\n"); 
		query.append("      ,DF_D7_A" ).append("\n"); 
		query.append("      ,DF_R2_A" ).append("\n"); 
		query.append("      ,DF_R5_A" ).append("\n"); 
		query.append("      ,DF_R9_A" ).append("\n"); 
		query.append("      ,DF_O2_A" ).append("\n"); 
		query.append("      ,DF_O4_A" ).append("\n"); 
		query.append("      ,DF_O5_A" ).append("\n"); 
		query.append("      ,DF_S2_A" ).append("\n"); 
		query.append("      ,DF_S4_A" ).append("\n"); 
		query.append("      ,DF_F2_A" ).append("\n"); 
		query.append("      ,DF_F4_A" ).append("\n"); 
		query.append("      ,DF_F5_A" ).append("\n"); 
		query.append("      ,DF_A2_A" ).append("\n"); 
		query.append("      ,DF_A4_A" ).append("\n"); 
		query.append("      ,F_L_TEU" ).append("\n"); 
		query.append("      ,F_L_BOX" ).append("\n"); 
		query.append("      ,F_L_D2" ).append("\n"); 
		query.append("      ,F_L_D4" ).append("\n"); 
		query.append("      ,F_L_D5" ).append("\n"); 
		query.append("      ,F_L_D7" ).append("\n"); 
		query.append("      ,F_L_R2" ).append("\n"); 
		query.append("      ,F_L_R5" ).append("\n"); 
		query.append("      ,F_L_R9" ).append("\n"); 
		query.append("      ,F_L_O2" ).append("\n"); 
		query.append("      ,F_L_O4" ).append("\n"); 
		query.append("      ,F_L_O5" ).append("\n"); 
		query.append("      ,F_L_S2" ).append("\n"); 
		query.append("      ,F_L_S4" ).append("\n"); 
		query.append("      ,F_L_F2" ).append("\n"); 
		query.append("      ,F_L_F4" ).append("\n"); 
		query.append("      ,F_L_F5" ).append("\n"); 
		query.append("      ,F_L_A2" ).append("\n"); 
		query.append("      ,F_L_A4" ).append("\n"); 
		query.append("      ,F_L_WGT" ).append("\n"); 
		query.append("      ,CASE WHEN F_L_TEU=0 THEN 0 " ).append("\n"); 
		query.append("            ELSE ROUND(F_L_WGT / F_L_TEU, 1) " ).append("\n"); 
		query.append("       END F_A_WGT" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,F_D_TEU" ).append("\n"); 
		query.append("      ,F_D_BOX" ).append("\n"); 
		query.append("      ,F_D_D2" ).append("\n"); 
		query.append("      ,F_D_D4" ).append("\n"); 
		query.append("      ,F_D_D5" ).append("\n"); 
		query.append("      ,F_D_D7" ).append("\n"); 
		query.append("      ,F_D_R2" ).append("\n"); 
		query.append("      ,F_D_R5" ).append("\n"); 
		query.append("      ,F_D_R9" ).append("\n"); 
		query.append("      ,F_D_O2" ).append("\n"); 
		query.append("      ,F_D_O4" ).append("\n"); 
		query.append("      ,F_D_O5" ).append("\n"); 
		query.append("      ,F_D_S2" ).append("\n"); 
		query.append("      ,F_D_S4" ).append("\n"); 
		query.append("      ,F_D_F2" ).append("\n"); 
		query.append("      ,F_D_F4" ).append("\n"); 
		query.append("      ,F_D_F5" ).append("\n"); 
		query.append("      ,F_D_A2" ).append("\n"); 
		query.append("      ,F_D_A4" ).append("\n"); 
		query.append("      ,F_D_WGT" ).append("\n"); 
		query.append("      ,VOID" ).append("\n"); 
		query.append("      ,BSA_TEU" ).append("\n"); 
		query.append("      ,BSA_WGT" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("       -- L/F " ).append("\n"); 
		query.append("       -- L/F " ).append("\n"); 
		query.append("       -- (((SUM(BSA_TEU)-(SUM(BSA_WGT)/2.2))/(1-( ( SUM(F_L_WGT) / SUM(F_L_TEU) )/2.2))) / SUM(BSA_TEU) ) * 100  " ).append("\n"); 
		query.append("      ,CASE WHEN BSA_TEU=0 OR F_L_TEU=0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(" ).append("\n"); 
		query.append(" " ).append("\n"); 
		query.append("                       (((BSA_TEU-(BSA_WGT/2.2))/(1-( ( F_L_WGT / F_L_TEU )/2.2))) / BSA_TEU ) * 100    " ).append("\n"); 
		query.append("                      ) " ).append("\n"); 
		query.append("       END LF_FD" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       -- ((FULL ONBOARD TEU + VOID TEU) / BSA TEU) *100" ).append("\n"); 
		query.append("      ,CASE WHEN BSA_TEU = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((F_O_TEU + VOID) / BSA_TEU) * 100)" ).append("\n"); 
		query.append("       END LF_F_TEU" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,CASE WHEN BSA_WGT = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND((F_O_WGT/BSA_WGT) * 100)" ).append("\n"); 
		query.append("       END LF_F_WGT" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      -- ((TOTAL ONBOARD TEU + VOID TEU) / BSA TEU) *100" ).append("\n"); 
		query.append("      ,CASE WHEN BSA_TEU = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((T_O_TEU + VOID) / BSA_TEU) * 100)" ).append("\n"); 
		query.append("       END LF_T_TEU" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,CASE WHEN BSA_WGT = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((T_O_WGT )/BSA_WGT) * 100)" ).append("\n"); 
		query.append("       END LF_T_WGT" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,TYPE1" ).append("\n"); 
		query.append("      ,TYPE2" ).append("\n"); 
		query.append("      ,PLN_RSN_RMK" ).append("\n"); 
		query.append("      ,1 SORT_FLG" ).append("\n"); 
		query.append("      ,CLPT_SEQ" ).append("\n"); 
		query.append("FROM DUMMY_NORMAL" ).append("\n"); 
		query.append("--ORDER BY CLPT_SET" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- VVD SUM" ).append("\n"); 
		query.append("UNION ALL      " ).append("\n"); 
		query.append("SELECT SUB_TRD_CD" ).append("\n"); 
		query.append("      ,SLAN_CD" ).append("\n"); 
		query.append("      ,WEEK" ).append("\n"); 
		query.append("      ,VVD" ).append("\n"); 
		query.append("      ,'TTL' YD_CD" ).append("\n"); 
		query.append("      ,'' VPS_ETA_DT" ).append("\n"); 
		query.append("      ,'' VPS_ETD_DT" ).append("\n"); 
		query.append("      ,'' FCBF_DT" ).append("\n"); 
		query.append("      ,SUM(P_TEU    )" ).append("\n"); 
		query.append("      ,SUM(P_BOX    )" ).append("\n"); 
		query.append("      ,SUM(P_D2     )" ).append("\n"); 
		query.append("      ,SUM(P_D4     )" ).append("\n"); 
		query.append("      ,SUM(P_D5     )" ).append("\n"); 
		query.append("      ,SUM(P_D7     )" ).append("\n"); 
		query.append("      ,SUM(P_R2     )" ).append("\n"); 
		query.append("      ,SUM(P_R5     )" ).append("\n"); 
		query.append("      ,SUM(P_R9     )" ).append("\n"); 
		query.append("      ,SUM(P_O2     )" ).append("\n"); 
		query.append("      ,SUM(P_O4     )" ).append("\n"); 
		query.append("      ,SUM(P_O5     )" ).append("\n"); 
		query.append("      ,SUM(P_S2     )" ).append("\n"); 
		query.append("      ,SUM(P_S4     )" ).append("\n"); 
		query.append("      ,SUM(P_F2     )" ).append("\n"); 
		query.append("      ,SUM(P_F4     )" ).append("\n"); 
		query.append("      ,SUM(P_F5     )" ).append("\n"); 
		query.append("      ,SUM(P_A2     )" ).append("\n"); 
		query.append("      ,SUM(P_A4     )" ).append("\n"); 
		query.append("      ,SUM(P_WGT    )" ).append("\n"); 
		query.append("      ,SUM(M_TEU    )" ).append("\n"); 
		query.append("      ,SUM(M_BOX    )" ).append("\n"); 
		query.append("      ,SUM(M_D2     )" ).append("\n"); 
		query.append("      ,SUM(M_D4     )" ).append("\n"); 
		query.append("      ,SUM(M_D5     )" ).append("\n"); 
		query.append("      ,SUM(M_D7     )" ).append("\n"); 
		query.append("      ,SUM(M_R2     )" ).append("\n"); 
		query.append("      ,SUM(M_R5     )" ).append("\n"); 
		query.append("      ,SUM(M_R9     )" ).append("\n"); 
		query.append("      ,SUM(M_O2     )" ).append("\n"); 
		query.append("      ,SUM(M_O4     )" ).append("\n"); 
		query.append("      ,SUM(M_O5     )" ).append("\n"); 
		query.append("      ,SUM(M_S2     )" ).append("\n"); 
		query.append("      ,SUM(M_S4     )" ).append("\n"); 
		query.append("      ,SUM(M_F2     )" ).append("\n"); 
		query.append("      ,SUM(M_F4     )" ).append("\n"); 
		query.append("      ,SUM(M_F5     )" ).append("\n"); 
		query.append("      ,SUM(M_A2     )" ).append("\n"); 
		query.append("      ,SUM(M_A4     )" ).append("\n"); 
		query.append("      ,SUM(M_WGT    )" ).append("\n"); 
		query.append("      ,SUM(DF_TEU_A )" ).append("\n"); 
		query.append("      ,SUM(DF_BOX_A )" ).append("\n"); 
		query.append("      ,SUM(DF_D2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_D4_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_D5_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_D7_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_R2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_R5_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_R9_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_O2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_O4_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_O5_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_S2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_S4_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_F2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_F4_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_F5_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_A2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_A4_A  )" ).append("\n"); 
		query.append("      ,SUM(F_L_TEU  )" ).append("\n"); 
		query.append("      ,SUM(F_L_BOX  )" ).append("\n"); 
		query.append("      ,SUM(F_L_D2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_D4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_D5   )" ).append("\n"); 
		query.append("      ,SUM(F_L_D7   )" ).append("\n"); 
		query.append("      ,SUM(F_L_R2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_R5   )" ).append("\n"); 
		query.append("      ,SUM(F_L_R9   )" ).append("\n"); 
		query.append("      ,SUM(F_L_O2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_O4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_O5   )" ).append("\n"); 
		query.append("      ,SUM(F_L_S2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_S4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_F2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_F4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_F5   )" ).append("\n"); 
		query.append("      ,SUM(F_L_A2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_A4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_WGT  )" ).append("\n"); 
		query.append("      ,CASE WHEN SUM(F_L_TEU)=0 THEN 0 " ).append("\n"); 
		query.append("            ELSE ROUND(SUM(F_L_WGT) / SUM(F_L_TEU),1) " ).append("\n"); 
		query.append("       END F_A_WGT" ).append("\n"); 
		query.append("      ,SUM(F_D_TEU  )" ).append("\n"); 
		query.append("      ,SUM(F_D_BOX  )" ).append("\n"); 
		query.append("      ,SUM(F_D_D2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_D4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_D5   )" ).append("\n"); 
		query.append("      ,SUM(F_D_D7   )" ).append("\n"); 
		query.append("      ,SUM(F_D_R2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_R5   )" ).append("\n"); 
		query.append("      ,SUM(F_D_R9   )" ).append("\n"); 
		query.append("      ,SUM(F_D_O2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_O4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_O5   )" ).append("\n"); 
		query.append("      ,SUM(F_D_S2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_S4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_F2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_F4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_F5   )" ).append("\n"); 
		query.append("      ,SUM(F_D_A2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_A4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_WGT  )" ).append("\n"); 
		query.append("      ,SUM(VOID     )" ).append("\n"); 
		query.append("      ,SUM(BSA_TEU  )" ).append("\n"); 
		query.append("      ,SUM(BSA_WGT  )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("       -- L/F " ).append("\n"); 
		query.append("       -- (((SUM(BSA_TEU)-(SUM(BSA_WGT)/2.2))/(1-( ( SUM(F_L_WGT) / SUM(F_L_TEU) )/2.2))) / SUM(BSA_TEU) ) * 100  " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_TEU)=0 OR SUM(F_L_TEU)=0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(" ).append("\n"); 
		query.append("                       (((SUM(BSA_TEU)-(SUM(BSA_WGT)/2.2))/(1-( ( SUM(F_L_WGT) / SUM(F_L_TEU) )/2.2))) / SUM(BSA_TEU) ) * 100    " ).append("\n"); 
		query.append("                      ) " ).append("\n"); 
		query.append("       END LF_FD" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       -- ((FULL ONBOARD TEU + VOID TEU) / BSA TEU) *100" ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_TEU) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((SUM(F_O_TEU) + SUM(VOID)) / SUM(BSA_TEU)) * 100)" ).append("\n"); 
		query.append("       END LF_F_TEU" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_WGT) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND((SUM(F_O_WGT)/SUM(BSA_WGT)) * 100)" ).append("\n"); 
		query.append("       END LF_F_WGT" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      -- ((TOTAL ONBOARD TEU + VOID TEU) / BSA TEU) *100" ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_TEU) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((SUM(T_O_TEU) + SUM(VOID)) / SUM(BSA_TEU)) * 100)" ).append("\n"); 
		query.append("       END LF_T_TEU" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_WGT) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((SUM(T_O_WGT) ) / SUM(BSA_WGT)) * 100)" ).append("\n"); 
		query.append("       END LF_T_WGT" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,'' TYPE1" ).append("\n"); 
		query.append("      ,'' TYPE2" ).append("\n"); 
		query.append("      ,'' PLN_RSN_RMK" ).append("\n"); 
		query.append("      ,2 SORT_FLG" ).append("\n"); 
		query.append("      ,100 CLPT_SEQ" ).append("\n"); 
		query.append("FROM DUMMY_NORMAL" ).append("\n"); 
		query.append("GROUP BY SUB_TRD_CD" ).append("\n"); 
		query.append("      ,SLAN_CD" ).append("\n"); 
		query.append("      ,WEEK" ).append("\n"); 
		query.append("      ,VVD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- ===============================================" ).append("\n"); 
		query.append("-- VVD 검색조건인 경우 아래 SQL 은 제외(G.TTL, LANE TTL)" ).append("\n"); 
		query.append("-- ===============================================" ).append("\n"); 
		query.append("#if (${vvd_cd} == '') " ).append("\n"); 
		query.append("-- SUB TRADE, SLAN, WEEK, YD_CD 의 AVG 의 WEEK 제외 한 AVG" ).append("\n"); 
		query.append("UNION ALL      " ).append("\n"); 
		query.append("SELECT SUB_TRD_CD" ).append("\n"); 
		query.append("      ,SLAN_CD" ).append("\n"); 
		query.append("      ,'999999' WEEK" ).append("\n"); 
		query.append("      ,'AVG PFMC' VVD" ).append("\n"); 
		query.append("      ,YD_CD" ).append("\n"); 
		query.append("      ,'' VPS_ETA_DT" ).append("\n"); 
		query.append("      ,'' VPS_ETD_DT" ).append("\n"); 
		query.append("      ,'' FCBF_DT" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_TEU    ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_BOX    ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_D2     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_D4     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_D5     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_D7     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_R2     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_R5     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_R9     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_O2     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_O4     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_O5     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_S2     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_S4     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_F2     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_F4     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_F5     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_A2     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_A4     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(P_WGT    ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_TEU    ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_BOX    ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_D2     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_D4     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_D5     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_D7     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_R2     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_R5     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_R9     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_O2     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_O4     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_O5     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_S2     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_S4     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_F2     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_F4     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_F5     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_A2     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_A4     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(M_WGT    ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_TEU_A ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_BOX_A ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_D2_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_D4_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_D5_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_D7_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_R2_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_R5_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_R9_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_O2_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_O4_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_O5_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_S2_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_S4_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_F2_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_F4_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_F5_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_A2_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(DF_A4_A  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_TEU  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_BOX  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_D2   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_D4   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_D5   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_D7   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_R2   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_R5   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_R9   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_O2   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_O4   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_O5   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_S2   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_S4   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_F2   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_F4   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_F5   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_A2   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_A4   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_L_WGT  ))" ).append("\n"); 
		query.append("      ,CASE WHEN AVG(F_L_TEU)=0 THEN 0 " ).append("\n"); 
		query.append("            ELSE ROUND(AVG(F_L_WGT) / AVG(F_L_TEU),1) " ).append("\n"); 
		query.append("       END F_A_WGT" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_TEU  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_BOX  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_D2   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_D4   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_D5   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_D7   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_R2   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_R5   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_R9   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_O2   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_O4   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_O5   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_S2   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_S4   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_F2   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_F4   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_F5   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_A2   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_A4   ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(F_D_WGT  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(VOID     ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(BSA_TEU  ))" ).append("\n"); 
		query.append("      ,ROUND(AVG(BSA_WGT  ))" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("       -- L/F " ).append("\n"); 
		query.append("       -- (((SUM(BSA_TEU)-(SUM(BSA_WGT)/2.2))/(1-( ( SUM(F_L_WGT) / SUM(F_L_TEU) )/2.2))) / SUM(BSA_TEU) ) * 100  " ).append("\n"); 
		query.append("      ,CASE WHEN AVG(BSA_TEU)=0 OR AVG(F_L_TEU)=0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(" ).append("\n"); 
		query.append("                       " ).append("\n"); 
		query.append("                       (((AVG(BSA_TEU)-(AVG(BSA_WGT)/2.2))/(1-( ( AVG(F_L_WGT) / AVG(F_L_TEU) )/2.2))) / AVG(BSA_TEU) ) * 100   " ).append("\n"); 
		query.append("                      ) " ).append("\n"); 
		query.append("       END LF_FD" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       -- ((FULL ONBOARD TEU + VOID TEU) / BSA TEU) *100" ).append("\n"); 
		query.append("      ,CASE WHEN AVG(BSA_TEU) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((AVG(F_O_TEU) + AVG(VOID)) / AVG(BSA_TEU)) * 100)" ).append("\n"); 
		query.append("       END LF_F_TEU" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,CASE WHEN AVG(BSA_WGT) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND((AVG(F_O_WGT)/AVG(BSA_WGT)) * 100)" ).append("\n"); 
		query.append("       END LF_F_WGT" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      -- ((TOTAL ONBOARD TEU + VOID TEU) / BSA TEU) *100" ).append("\n"); 
		query.append("      ,CASE WHEN AVG(BSA_TEU) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((AVG(T_O_TEU) + AVG(VOID)) / AVG(BSA_TEU)) * 100)" ).append("\n"); 
		query.append("       END LF_T_TEU" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,CASE WHEN AVG(BSA_WGT) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((AVG(T_O_WGT) ) / AVG(BSA_WGT)) * 100)" ).append("\n"); 
		query.append("       END LF_T_WGT" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,'' TYPE1" ).append("\n"); 
		query.append("      ,'' TYPE2" ).append("\n"); 
		query.append("      ,'' PLN_RSN_RMK" ).append("\n"); 
		query.append("      ,3 SORT_FLG" ).append("\n"); 
		query.append("      ,0 CLPT_SEQ" ).append("\n"); 
		query.append("FROM DUMMY_AVG" ).append("\n"); 
		query.append("GROUP BY SUB_TRD_CD" ).append("\n"); 
		query.append("      ,SLAN_CD" ).append("\n"); 
		query.append("      ,YD_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- SUB TRADE, LANE 의 SUM - AVG      " ).append("\n"); 
		query.append("UNION ALL     " ).append("\n"); 
		query.append("SELECT SUB_TRD_CD" ).append("\n"); 
		query.append("      ,SLAN_CD" ).append("\n"); 
		query.append("      ,'999999' WEEK" ).append("\n"); 
		query.append("      ,'AVG PFMC' VVD" ).append("\n"); 
		query.append("      ,'TTL' YD_CD" ).append("\n"); 
		query.append("      ,'' VPS_ETA_DT" ).append("\n"); 
		query.append("      ,'' VPS_ETD_DT" ).append("\n"); 
		query.append("      ,'' FCBF_DT" ).append("\n"); 
		query.append("      ,SUM(P_TEU    )  P_TEU      " ).append("\n"); 
		query.append("      ,SUM(P_BOX    )  P_BOX    " ).append("\n"); 
		query.append("      ,SUM(P_D2     )  P_D2     " ).append("\n"); 
		query.append("      ,SUM(P_D4     )  P_D4     " ).append("\n"); 
		query.append("      ,SUM(P_D5     )  P_D5     " ).append("\n"); 
		query.append("      ,SUM(P_D7     )  P_D7     " ).append("\n"); 
		query.append("      ,SUM(P_R2     )  P_R2     " ).append("\n"); 
		query.append("      ,SUM(P_R5     )  P_R5     " ).append("\n"); 
		query.append("      ,SUM(P_R9     )  P_R9     " ).append("\n"); 
		query.append("      ,SUM(P_O2     )  P_O2     " ).append("\n"); 
		query.append("      ,SUM(P_O4     )  P_O4     " ).append("\n"); 
		query.append("      ,SUM(P_O5     )  P_O5     " ).append("\n"); 
		query.append("      ,SUM(P_S2     )  P_S2     " ).append("\n"); 
		query.append("      ,SUM(P_S4     )  P_S4     " ).append("\n"); 
		query.append("      ,SUM(P_F2     )  P_F2     " ).append("\n"); 
		query.append("      ,SUM(P_F4     )  P_F4     " ).append("\n"); 
		query.append("      ,SUM(P_F5     )  P_F5     " ).append("\n"); 
		query.append("      ,SUM(P_A2     )  P_A2     " ).append("\n"); 
		query.append("      ,SUM(P_A4     )  P_A4     " ).append("\n"); 
		query.append("      ,SUM(P_WGT    )  P_WGT    " ).append("\n"); 
		query.append("      ,SUM(M_TEU    )  M_TEU    " ).append("\n"); 
		query.append("      ,SUM(M_BOX    )  M_BOX    " ).append("\n"); 
		query.append("      ,SUM(M_D2     )  M_D2     " ).append("\n"); 
		query.append("      ,SUM(M_D4     )  M_D4     " ).append("\n"); 
		query.append("      ,SUM(M_D5     )  M_D5     " ).append("\n"); 
		query.append("      ,SUM(M_D7     )  M_D7     " ).append("\n"); 
		query.append("      ,SUM(M_R2     )  M_R2     " ).append("\n"); 
		query.append("      ,SUM(M_R5     )  M_R5     " ).append("\n"); 
		query.append("      ,SUM(M_R9     )  M_R9     " ).append("\n"); 
		query.append("      ,SUM(M_O2     )  M_O2     " ).append("\n"); 
		query.append("      ,SUM(M_O4     )  M_O4     " ).append("\n"); 
		query.append("      ,SUM(M_O5     )  M_O5     " ).append("\n"); 
		query.append("      ,SUM(M_S2     )  M_S2     " ).append("\n"); 
		query.append("      ,SUM(M_S4     )  M_S4     " ).append("\n"); 
		query.append("      ,SUM(M_F2     )  M_F2     " ).append("\n"); 
		query.append("      ,SUM(M_F4     )  M_F4     " ).append("\n"); 
		query.append("      ,SUM(M_F5     )  M_F5     " ).append("\n"); 
		query.append("      ,SUM(M_A2     )  M_A2     " ).append("\n"); 
		query.append("      ,SUM(M_A4     )  M_A4     " ).append("\n"); 
		query.append("      ,SUM(M_WGT    )  M_WGT    " ).append("\n"); 
		query.append("      ,SUM(DF_TEU_A )  DF_TEU_A " ).append("\n"); 
		query.append("      ,SUM(DF_BOX_A )  DF_BOX_A " ).append("\n"); 
		query.append("      ,SUM(DF_D2_A  )  DF_D2_A  " ).append("\n"); 
		query.append("      ,SUM(DF_D4_A  )  DF_D4_A  " ).append("\n"); 
		query.append("      ,SUM(DF_D5_A  )  DF_D5_A  " ).append("\n"); 
		query.append("      ,SUM(DF_D7_A  )  DF_D7_A  " ).append("\n"); 
		query.append("      ,SUM(DF_R2_A  )  DF_R2_A  " ).append("\n"); 
		query.append("      ,SUM(DF_R5_A  )  DF_R5_A  " ).append("\n"); 
		query.append("      ,SUM(DF_R9_A  )  DF_R9_A  " ).append("\n"); 
		query.append("      ,SUM(DF_O2_A  )  DF_O2_A  " ).append("\n"); 
		query.append("      ,SUM(DF_O4_A  )  DF_O4_A  " ).append("\n"); 
		query.append("      ,SUM(DF_O5_A  )  DF_O5_A  " ).append("\n"); 
		query.append("      ,SUM(DF_S2_A  )  DF_S2_A  " ).append("\n"); 
		query.append("      ,SUM(DF_S4_A  )  DF_S4_A  " ).append("\n"); 
		query.append("      ,SUM(DF_F2_A  )  DF_F2_A  " ).append("\n"); 
		query.append("      ,SUM(DF_F4_A  )  DF_F4_A  " ).append("\n"); 
		query.append("      ,SUM(DF_F5_A  )  DF_F5_A  " ).append("\n"); 
		query.append("      ,SUM(DF_A2_A  )  DF_A2_A  " ).append("\n"); 
		query.append("      ,SUM(DF_A4_A  )  DF_A4_A  " ).append("\n"); 
		query.append("      ,SUM(F_L_TEU  )  F_L_TEU  " ).append("\n"); 
		query.append("      ,SUM(F_L_BOX  )  F_L_BOX  " ).append("\n"); 
		query.append("      ,SUM(F_L_D2   )  F_L_D2   " ).append("\n"); 
		query.append("      ,SUM(F_L_D4   )  F_L_D4   " ).append("\n"); 
		query.append("      ,SUM(F_L_D5   )  F_L_D5   " ).append("\n"); 
		query.append("      ,SUM(F_L_D7   )  F_L_D7   " ).append("\n"); 
		query.append("      ,SUM(F_L_R2   )  F_L_R2   " ).append("\n"); 
		query.append("      ,SUM(F_L_R5   )  F_L_R5   " ).append("\n"); 
		query.append("      ,SUM(F_L_R9   )  F_L_R9   " ).append("\n"); 
		query.append("      ,SUM(F_L_O2   )  F_L_O2   " ).append("\n"); 
		query.append("      ,SUM(F_L_O4   )  F_L_O4   " ).append("\n"); 
		query.append("      ,SUM(F_L_O5   )  F_L_O5   " ).append("\n"); 
		query.append("      ,SUM(F_L_S2   )  F_L_S2   " ).append("\n"); 
		query.append("      ,SUM(F_L_S4   )  F_L_S4   " ).append("\n"); 
		query.append("      ,SUM(F_L_F2   )  F_L_F2   " ).append("\n"); 
		query.append("      ,SUM(F_L_F4   )  F_L_F4   " ).append("\n"); 
		query.append("      ,SUM(F_L_F5   )  F_L_F5   " ).append("\n"); 
		query.append("      ,SUM(F_L_A2   )  F_L_A2   " ).append("\n"); 
		query.append("      ,SUM(F_L_A4   )  F_L_A4   " ).append("\n"); 
		query.append("      ,SUM(F_L_WGT  )  F_L_WGT  " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(F_L_TEU)=0 THEN 0 " ).append("\n"); 
		query.append("            ELSE ROUND(SUM(F_L_WGT) / SUM(F_L_TEU),0) " ).append("\n"); 
		query.append("       END F_A_WGT" ).append("\n"); 
		query.append("      ,SUM(F_D_TEU  )  F_D_TEU" ).append("\n"); 
		query.append("      ,SUM(F_D_BOX  )  F_D_BOX" ).append("\n"); 
		query.append("      ,SUM(F_D_D2   )  F_D_D2 " ).append("\n"); 
		query.append("      ,SUM(F_D_D4   )  F_D_D4 " ).append("\n"); 
		query.append("      ,SUM(F_D_D5   )  F_D_D5 " ).append("\n"); 
		query.append("      ,SUM(F_D_D7   )  F_D_D7 " ).append("\n"); 
		query.append("      ,SUM(F_D_R2   )  F_D_R2 " ).append("\n"); 
		query.append("      ,SUM(F_D_R5   )  F_D_R5 " ).append("\n"); 
		query.append("      ,SUM(F_D_R9   )  F_D_R9 " ).append("\n"); 
		query.append("      ,SUM(F_D_O2   )  F_D_O2 " ).append("\n"); 
		query.append("      ,SUM(F_D_O4   )  F_D_O4 " ).append("\n"); 
		query.append("      ,SUM(F_D_O5   )  F_D_O5 " ).append("\n"); 
		query.append("      ,SUM(F_D_S2   )  F_D_S2 " ).append("\n"); 
		query.append("      ,SUM(F_D_S4   )  F_D_S4 " ).append("\n"); 
		query.append("      ,SUM(F_D_F2   )  F_D_F2 " ).append("\n"); 
		query.append("      ,SUM(F_D_F4   )  F_D_F4 " ).append("\n"); 
		query.append("      ,SUM(F_D_F5   )  F_D_F5 " ).append("\n"); 
		query.append("      ,SUM(F_D_A2   )  F_D_A2 " ).append("\n"); 
		query.append("      ,SUM(F_D_A4   )  F_D_A4 " ).append("\n"); 
		query.append("      ,SUM(F_D_WGT  )  F_D_WGT" ).append("\n"); 
		query.append("      ,SUM(VOID     )  VOID   " ).append("\n"); 
		query.append("      ,SUM(BSA_TEU  )  BSA_TEU" ).append("\n"); 
		query.append("      ,SUM(BSA_WGT  )  BSA_WGT" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("       -- L/F " ).append("\n"); 
		query.append("       -- (((SUM(BSA_TEU)-(SUM(BSA_WGT)/2.2))/(1-( ( SUM(F_L_WGT) / SUM(F_L_TEU) )/2.2))) / SUM(BSA_TEU) ) * 100  " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_TEU)=0 OR SUM(F_L_TEU)=0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND( " ).append("\n"); 
		query.append("                       (((SUM(BSA_TEU)-(SUM(BSA_WGT)/2.2))/(1-( ( SUM(F_L_WGT) / SUM(F_L_TEU) )/2.2))) / SUM(BSA_TEU) ) * 100   " ).append("\n"); 
		query.append("                      ) " ).append("\n"); 
		query.append("       END LF_FD" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       -- ((FULL ONBOARD TEU + VOID TEU) / BSA TEU) *100" ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_TEU) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((SUM(F_O_TEU) + SUM(VOID)) / SUM(BSA_TEU)) * 100)" ).append("\n"); 
		query.append("       END LF_F_TEU" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_WGT) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND((SUM(F_O_WGT)/SUM(BSA_WGT)) * 100)" ).append("\n"); 
		query.append("       END LF_F_WGT" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      -- ((TOTAL ONBOARD TEU + VOID TEU) / BSA TEU) *100" ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_TEU) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((SUM(T_O_TEU) + SUM(VOID)) / SUM(BSA_TEU)) * 100)" ).append("\n"); 
		query.append("       END LF_T_TEU" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_WGT) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((SUM(T_O_WGT) ) / SUM(BSA_WGT)) * 100)" ).append("\n"); 
		query.append("       END LF_T_WGT" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,'' TYPE1" ).append("\n"); 
		query.append("      ,'' TYPE2" ).append("\n"); 
		query.append("      ,'' PLN_RSN_RMK" ).append("\n"); 
		query.append("      ,4 SORT_FLG" ).append("\n"); 
		query.append("      ,100 CLPT_SEQ" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("( " ).append("\n"); 
		query.append("    SELECT SUB_TRD_CD" ).append("\n"); 
		query.append("          ,SLAN_CD" ).append("\n"); 
		query.append("          ,YD_CD" ).append("\n"); 
		query.append("          ,ROUND(AVG(P_TEU    ))  P_TEU      " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_BOX    ))  P_BOX    " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_D2     ))  P_D2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_D4     ))  P_D4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_D5     ))  P_D5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_D7     ))  P_D7     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_R2     ))  P_R2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_R5     ))  P_R5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_R9     ))  P_R9     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_O2     ))  P_O2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_O4     ))  P_O4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_O5     ))  P_O5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_S2     ))  P_S2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_S4     ))  P_S4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_F2     ))  P_F2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_F4     ))  P_F4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_F5     ))  P_F5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_A2     ))  P_A2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_A4     ))  P_A4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(P_WGT    ))  P_WGT    " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_TEU    ))  M_TEU    " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_BOX    ))  M_BOX    " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_D2     ))  M_D2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_D4     ))  M_D4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_D5     ))  M_D5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_D7     ))  M_D7     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_R2     ))  M_R2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_R5     ))  M_R5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_R9     ))  M_R9     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_O2     ))  M_O2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_O4     ))  M_O4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_O5     ))  M_O5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_S2     ))  M_S2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_S4     ))  M_S4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_F2     ))  M_F2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_F4     ))  M_F4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_F5     ))  M_F5     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_A2     ))  M_A2     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_A4     ))  M_A4     " ).append("\n"); 
		query.append("          ,ROUND(AVG(M_WGT    ))  M_WGT  " ).append("\n"); 
		query.append("  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_TEU_A ))  DF_TEU_A " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_BOX_A ))  DF_BOX_A " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_D2_A  ))  DF_D2_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_D4_A  ))  DF_D4_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_D5_A  ))  DF_D5_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_D7_A  ))  DF_D7_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_R2_A  ))  DF_R2_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_R5_A  ))  DF_R5_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_R9_A  ))  DF_R9_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_O2_A  ))  DF_O2_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_O4_A  ))  DF_O4_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_O5_A  ))  DF_O5_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_S2_A  ))  DF_S2_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_S4_A  ))  DF_S4_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_F2_A  ))  DF_F2_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_F4_A  ))  DF_F4_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_F5_A  ))  DF_F5_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_A2_A  ))  DF_A2_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(DF_A4_A  ))  DF_A4_A  " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_TEU  ))  F_L_TEU  " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_BOX  ))  F_L_BOX  " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_D2   ))  F_L_D2   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_D4   ))  F_L_D4   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_D5   ))  F_L_D5   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_D7   ))  F_L_D7   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_R2   ))  F_L_R2   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_R5   ))  F_L_R5   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_R9   ))  F_L_R9   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_O2   ))  F_L_O2   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_O4   ))  F_L_O4   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_O5   ))  F_L_O5   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_S2   ))  F_L_S2   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_S4   ))  F_L_S4   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_F2   ))  F_L_F2   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_F4   ))  F_L_F4   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_F5   ))  F_L_F5   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_A2   ))  F_L_A2   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_A4   ))  F_L_A4   " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_L_WGT  ))  F_L_WGT  " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_TEU  ))  F_D_TEU" ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_BOX  ))  F_D_BOX" ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_D2   ))  F_D_D2 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_D4   ))  F_D_D4 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_D5   ))  F_D_D5 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_D7   ))  F_D_D7 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_R2   ))  F_D_R2 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_R5   ))  F_D_R5 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_R9   ))  F_D_R9 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_O2   ))  F_D_O2 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_O4   ))  F_D_O4 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_O5   ))  F_D_O5 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_S2   ))  F_D_S2 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_S4   ))  F_D_S4 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_F2   ))  F_D_F2 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_F4   ))  F_D_F4 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_F5   ))  F_D_F5 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_A2   ))  F_D_A2 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_A4   ))  F_D_A4 " ).append("\n"); 
		query.append("          ,ROUND(AVG(F_D_WGT  ))  F_D_WGT" ).append("\n"); 
		query.append("          ,ROUND(AVG(F_O_TEU  ))  F_O_TEU" ).append("\n"); 
		query.append("          ,ROUND(AVG(F_O_WGT  ))  F_O_WGT" ).append("\n"); 
		query.append("          ,ROUND(AVG(T_O_TEU  ))  T_O_TEU" ).append("\n"); 
		query.append("          ,ROUND(AVG(T_O_WGT  ))  T_O_WGT" ).append("\n"); 
		query.append("          ,ROUND(AVG(VOID     ))  VOID   " ).append("\n"); 
		query.append("          ,ROUND(AVG(BSA_TEU  ))  BSA_TEU" ).append("\n"); 
		query.append("          ,ROUND(AVG(BSA_WGT  ))  BSA_WGT" ).append("\n"); 
		query.append("           " ).append("\n"); 
		query.append("    FROM DUMMY_AVG" ).append("\n"); 
		query.append("    GROUP BY SUB_TRD_CD" ).append("\n"); 
		query.append("          ,SLAN_CD" ).append("\n"); 
		query.append("          ,YD_CD" ).append("\n"); 
		query.append(")   " ).append("\n"); 
		query.append("GROUP BY SUB_TRD_CD" ).append("\n"); 
		query.append("      ,SLAN_CD" ).append("\n"); 
		query.append("     " ).append("\n"); 
		query.append("-- GRAND SUM (YARD)  " ).append("\n"); 
		query.append("UNION ALL      " ).append("\n"); 
		query.append("SELECT 'ZTTL' SUB_TRD_CD" ).append("\n"); 
		query.append("      ,'' SLAN_CD" ).append("\n"); 
		query.append("      ,'' WEEK" ).append("\n"); 
		query.append("      ,'' VVD" ).append("\n"); 
		query.append("      ,YD_CD" ).append("\n"); 
		query.append("      ,'' VPS_ETA_DT" ).append("\n"); 
		query.append("      ,'' VPS_ETD_DT" ).append("\n"); 
		query.append("      ,'' FCBF_DT" ).append("\n"); 
		query.append("      ,SUM(P_TEU    )" ).append("\n"); 
		query.append("      ,SUM(P_BOX    )" ).append("\n"); 
		query.append("      ,SUM(P_D2     )" ).append("\n"); 
		query.append("      ,SUM(P_D4     )" ).append("\n"); 
		query.append("      ,SUM(P_D5     )" ).append("\n"); 
		query.append("      ,SUM(P_D7     )" ).append("\n"); 
		query.append("      ,SUM(P_R2     )" ).append("\n"); 
		query.append("      ,SUM(P_R5     )" ).append("\n"); 
		query.append("      ,SUM(P_R9     )" ).append("\n"); 
		query.append("      ,SUM(P_O2     )" ).append("\n"); 
		query.append("      ,SUM(P_O4     )" ).append("\n"); 
		query.append("      ,SUM(P_O5     )" ).append("\n"); 
		query.append("      ,SUM(P_S2     )" ).append("\n"); 
		query.append("      ,SUM(P_S4     )" ).append("\n"); 
		query.append("      ,SUM(P_F2     )" ).append("\n"); 
		query.append("      ,SUM(P_F4     )" ).append("\n"); 
		query.append("      ,SUM(P_F5     )" ).append("\n"); 
		query.append("      ,SUM(P_A2     )" ).append("\n"); 
		query.append("      ,SUM(P_A4     )" ).append("\n"); 
		query.append("      ,SUM(P_WGT    )" ).append("\n"); 
		query.append("      ,SUM(M_TEU    )" ).append("\n"); 
		query.append("      ,SUM(M_BOX    )" ).append("\n"); 
		query.append("      ,SUM(M_D2     )" ).append("\n"); 
		query.append("      ,SUM(M_D4     )" ).append("\n"); 
		query.append("      ,SUM(M_D5     )" ).append("\n"); 
		query.append("      ,SUM(M_D7     )" ).append("\n"); 
		query.append("      ,SUM(M_R2     )" ).append("\n"); 
		query.append("      ,SUM(M_R5     )" ).append("\n"); 
		query.append("      ,SUM(M_R9     )" ).append("\n"); 
		query.append("      ,SUM(M_O2     )" ).append("\n"); 
		query.append("      ,SUM(M_O4     )" ).append("\n"); 
		query.append("      ,SUM(M_O5     )" ).append("\n"); 
		query.append("      ,SUM(M_S2     )" ).append("\n"); 
		query.append("      ,SUM(M_S4     )" ).append("\n"); 
		query.append("      ,SUM(M_F2     )" ).append("\n"); 
		query.append("      ,SUM(M_F4     )" ).append("\n"); 
		query.append("      ,SUM(M_F5     )" ).append("\n"); 
		query.append("      ,SUM(M_A2     )" ).append("\n"); 
		query.append("      ,SUM(M_A4     )" ).append("\n"); 
		query.append("      ,SUM(M_WGT    )" ).append("\n"); 
		query.append("      ,SUM(DF_TEU_A )" ).append("\n"); 
		query.append("      ,SUM(DF_BOX_A )" ).append("\n"); 
		query.append("      ,SUM(DF_D2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_D4_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_D5_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_D7_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_R2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_R5_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_R9_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_O2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_O4_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_O5_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_S2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_S4_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_F2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_F4_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_F5_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_A2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_A4_A  )" ).append("\n"); 
		query.append("      ,SUM(F_L_TEU  )" ).append("\n"); 
		query.append("      ,SUM(F_L_BOX  )" ).append("\n"); 
		query.append("      ,SUM(F_L_D2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_D4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_D5   )" ).append("\n"); 
		query.append("      ,SUM(F_L_D7   )" ).append("\n"); 
		query.append("      ,SUM(F_L_R2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_R5   )" ).append("\n"); 
		query.append("      ,SUM(F_L_R9   )" ).append("\n"); 
		query.append("      ,SUM(F_L_O2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_O4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_O5   )" ).append("\n"); 
		query.append("      ,SUM(F_L_S2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_S4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_F2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_F4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_F5   )" ).append("\n"); 
		query.append("      ,SUM(F_L_A2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_A4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_WGT  )" ).append("\n"); 
		query.append("      ,CASE WHEN SUM(F_L_TEU)=0 THEN 0 " ).append("\n"); 
		query.append("            ELSE ROUND(SUM(F_L_WGT) / SUM(F_L_TEU),1) " ).append("\n"); 
		query.append("       END F_A_WGT" ).append("\n"); 
		query.append("      ,SUM(F_D_TEU  )" ).append("\n"); 
		query.append("      ,SUM(F_D_BOX  )" ).append("\n"); 
		query.append("      ,SUM(F_D_D2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_D4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_D5   )" ).append("\n"); 
		query.append("      ,SUM(F_D_D7   )" ).append("\n"); 
		query.append("      ,SUM(F_D_R2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_R5   )" ).append("\n"); 
		query.append("      ,SUM(F_D_R9   )" ).append("\n"); 
		query.append("      ,SUM(F_D_O2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_O4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_O5   )" ).append("\n"); 
		query.append("      ,SUM(F_D_S2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_S4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_F2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_F4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_F5   )" ).append("\n"); 
		query.append("      ,SUM(F_D_A2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_A4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_WGT  )" ).append("\n"); 
		query.append("      ,SUM(VOID     )" ).append("\n"); 
		query.append("      ,SUM(BSA_TEU  )" ).append("\n"); 
		query.append("      ,SUM(BSA_WGT  )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("       -- L/F " ).append("\n"); 
		query.append("       -- (((SUM(BSA_TEU)-(SUM(BSA_WGT)/2.2))/(1-( ( SUM(F_L_WGT) / SUM(F_L_TEU) )/2.2))) / SUM(BSA_TEU) ) * 100  " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_TEU)=0 OR SUM(F_L_TEU)=0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(" ).append("\n"); 
		query.append("                       (((SUM(BSA_TEU)-(SUM(BSA_WGT)/2.2))/(1-( ( SUM(F_L_WGT) / SUM(F_L_TEU) )/2.2))) / SUM(BSA_TEU) ) * 100   " ).append("\n"); 
		query.append("                      ) " ).append("\n"); 
		query.append("       END LF_FD" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       -- ((FULL ONBOARD TEU + VOID TEU) / BSA TEU) *100" ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_TEU) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((SUM(F_O_TEU) + SUM(VOID)) / SUM(BSA_TEU)) * 100)" ).append("\n"); 
		query.append("       END LF_F_TEU" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_WGT) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND((SUM(F_O_WGT)/SUM(BSA_WGT)) * 100)" ).append("\n"); 
		query.append("       END LF_F_WGT" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      -- ((TOTAL ONBOARD TEU + VOID TEU) / BSA TEU) *100" ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_TEU) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((SUM(T_O_TEU) + SUM(VOID)) / SUM(BSA_TEU)) * 100)" ).append("\n"); 
		query.append("       END LF_T_TEU" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_WGT) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((SUM(T_O_WGT) ) / SUM(BSA_WGT)) * 100)" ).append("\n"); 
		query.append("       END LF_T_WGT" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,'' TYPE1" ).append("\n"); 
		query.append("      ,'' TYPE2" ).append("\n"); 
		query.append("      ,'' PLN_RSN_RMK" ).append("\n"); 
		query.append("      ,7 SORT_FLG" ).append("\n"); 
		query.append("      ,0 CLPT_SEQ" ).append("\n"); 
		query.append("FROM DUMMY_NORMAL" ).append("\n"); 
		query.append("GROUP BY YD_CD  " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- GRAND SUM (YARD)  " ).append("\n"); 
		query.append("UNION ALL      " ).append("\n"); 
		query.append("SELECT 'ZTTL' SUB_TRD_CD" ).append("\n"); 
		query.append("      ,'' SLAN_CD" ).append("\n"); 
		query.append("      ,'' WEEK" ).append("\n"); 
		query.append("      ,'' VVD" ).append("\n"); 
		query.append("      ,'TTL' YD_CD" ).append("\n"); 
		query.append("      ,'' VPS_ETA_DT" ).append("\n"); 
		query.append("      ,'' VPS_ETD_DT" ).append("\n"); 
		query.append("      ,'' FCBF_DT" ).append("\n"); 
		query.append("      ,SUM(P_TEU    )" ).append("\n"); 
		query.append("      ,SUM(P_BOX    )" ).append("\n"); 
		query.append("      ,SUM(P_D2     )" ).append("\n"); 
		query.append("      ,SUM(P_D4     )" ).append("\n"); 
		query.append("      ,SUM(P_D5     )" ).append("\n"); 
		query.append("      ,SUM(P_D7     )" ).append("\n"); 
		query.append("      ,SUM(P_R2     )" ).append("\n"); 
		query.append("      ,SUM(P_R5     )" ).append("\n"); 
		query.append("      ,SUM(P_R9     )" ).append("\n"); 
		query.append("      ,SUM(P_O2     )" ).append("\n"); 
		query.append("      ,SUM(P_O4     )" ).append("\n"); 
		query.append("      ,SUM(P_O5     )" ).append("\n"); 
		query.append("      ,SUM(P_S2     )" ).append("\n"); 
		query.append("      ,SUM(P_S4     )" ).append("\n"); 
		query.append("      ,SUM(P_F2     )" ).append("\n"); 
		query.append("      ,SUM(P_F4     )" ).append("\n"); 
		query.append("      ,SUM(P_F5     )" ).append("\n"); 
		query.append("      ,SUM(P_A2     )" ).append("\n"); 
		query.append("      ,SUM(P_A4     )" ).append("\n"); 
		query.append("      ,SUM(P_WGT    )" ).append("\n"); 
		query.append("      ,SUM(M_TEU    )" ).append("\n"); 
		query.append("      ,SUM(M_BOX    )" ).append("\n"); 
		query.append("      ,SUM(M_D2     )" ).append("\n"); 
		query.append("      ,SUM(M_D4     )" ).append("\n"); 
		query.append("      ,SUM(M_D5     )" ).append("\n"); 
		query.append("      ,SUM(M_D7     )" ).append("\n"); 
		query.append("      ,SUM(M_R2     )" ).append("\n"); 
		query.append("      ,SUM(M_R5     )" ).append("\n"); 
		query.append("      ,SUM(M_R9     )" ).append("\n"); 
		query.append("      ,SUM(M_O2     )" ).append("\n"); 
		query.append("      ,SUM(M_O4     )" ).append("\n"); 
		query.append("      ,SUM(M_O5     )" ).append("\n"); 
		query.append("      ,SUM(M_S2     )" ).append("\n"); 
		query.append("      ,SUM(M_S4     )" ).append("\n"); 
		query.append("      ,SUM(M_F2     )" ).append("\n"); 
		query.append("      ,SUM(M_F4     )" ).append("\n"); 
		query.append("      ,SUM(M_F5     )" ).append("\n"); 
		query.append("      ,SUM(M_A2     )" ).append("\n"); 
		query.append("      ,SUM(M_A4     )" ).append("\n"); 
		query.append("      ,SUM(M_WGT    )" ).append("\n"); 
		query.append("      ,SUM(DF_TEU_A )" ).append("\n"); 
		query.append("      ,SUM(DF_BOX_A )" ).append("\n"); 
		query.append("      ,SUM(DF_D2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_D4_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_D5_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_D7_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_R2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_R5_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_R9_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_O2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_O4_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_O5_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_S2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_S4_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_F2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_F4_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_F5_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_A2_A  )" ).append("\n"); 
		query.append("      ,SUM(DF_A4_A  )" ).append("\n"); 
		query.append("      ,SUM(F_L_TEU  )" ).append("\n"); 
		query.append("      ,SUM(F_L_BOX  )" ).append("\n"); 
		query.append("      ,SUM(F_L_D2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_D4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_D5   )" ).append("\n"); 
		query.append("      ,SUM(F_L_D7   )" ).append("\n"); 
		query.append("      ,SUM(F_L_R2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_R5   )" ).append("\n"); 
		query.append("      ,SUM(F_L_R9   )" ).append("\n"); 
		query.append("      ,SUM(F_L_O2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_O4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_O5   )" ).append("\n"); 
		query.append("      ,SUM(F_L_S2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_S4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_F2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_F4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_F5   )" ).append("\n"); 
		query.append("      ,SUM(F_L_A2   )" ).append("\n"); 
		query.append("      ,SUM(F_L_A4   )" ).append("\n"); 
		query.append("      ,SUM(F_L_WGT  )" ).append("\n"); 
		query.append("      ,CASE WHEN SUM(F_L_TEU)=0 THEN 0 " ).append("\n"); 
		query.append("            ELSE ROUND(SUM(F_L_WGT) / SUM(F_L_TEU),1) " ).append("\n"); 
		query.append("       END F_A_WGT" ).append("\n"); 
		query.append("      ,SUM(F_D_TEU  )" ).append("\n"); 
		query.append("      ,SUM(F_D_BOX  )" ).append("\n"); 
		query.append("      ,SUM(F_D_D2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_D4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_D5   )" ).append("\n"); 
		query.append("      ,SUM(F_D_D7   )" ).append("\n"); 
		query.append("      ,SUM(F_D_R2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_R5   )" ).append("\n"); 
		query.append("      ,SUM(F_D_R9   )" ).append("\n"); 
		query.append("      ,SUM(F_D_O2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_O4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_O5   )" ).append("\n"); 
		query.append("      ,SUM(F_D_S2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_S4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_F2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_F4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_F5   )" ).append("\n"); 
		query.append("      ,SUM(F_D_A2   )" ).append("\n"); 
		query.append("      ,SUM(F_D_A4   )" ).append("\n"); 
		query.append("      ,SUM(F_D_WGT  )" ).append("\n"); 
		query.append("      ,SUM(VOID     )" ).append("\n"); 
		query.append("      ,SUM(BSA_TEU  )" ).append("\n"); 
		query.append("      ,SUM(BSA_WGT  )" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("       -- L/F " ).append("\n"); 
		query.append("       -- (((SUM(BSA_TEU)-(SUM(BSA_WGT)/2.2))/(1-( ( SUM(F_L_WGT) / SUM(F_L_TEU) )/2.2))) / SUM(BSA_TEU) ) * 100  " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_TEU)=0 OR SUM(F_L_TEU)=0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(" ).append("\n"); 
		query.append("                       (((SUM(BSA_TEU)-(SUM(BSA_WGT)/2.2))/(1-( ( SUM(F_L_WGT) / SUM(F_L_TEU) )/2.2))) / SUM(BSA_TEU) ) * 100   " ).append("\n"); 
		query.append("                      ) " ).append("\n"); 
		query.append("       END LF_FD" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       -- ((FULL ONBOARD TEU + VOID TEU) / BSA TEU) *100" ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_TEU) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((SUM(F_O_TEU) + SUM(VOID)) / SUM(BSA_TEU)) * 100)" ).append("\n"); 
		query.append("       END LF_F_TEU" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_WGT) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND((SUM(F_O_WGT)/SUM(BSA_WGT)) * 100) " ).append("\n"); 
		query.append("       END LF_F_WGT" ).append("\n"); 
		query.append("      " ).append("\n"); 
		query.append("      -- ((TOTAL ONBOARD TEU + VOID TEU) / BSA TEU) *100" ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_TEU) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND(((SUM(T_O_TEU) + SUM(VOID)) / SUM(BSA_TEU)) * 100) " ).append("\n"); 
		query.append("       END LF_T_TEU" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,CASE WHEN SUM(BSA_WGT) = 0 THEN 0" ).append("\n"); 
		query.append("            ELSE ROUND((SUM(T_O_WGT) / SUM(BSA_WGT)) * 100) " ).append("\n"); 
		query.append("       END LF_T_WGT" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("      ,'' TYPE1" ).append("\n"); 
		query.append("      ,'' TYPE2" ).append("\n"); 
		query.append("      ,'' PLN_RSN_RMK " ).append("\n"); 
		query.append("      ,8 SORT_FLG" ).append("\n"); 
		query.append("      ,100 CLPT_SEQ" ).append("\n"); 
		query.append("FROM DUMMY_NORMAL   " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("-- [종료]VVD 검색조건인 경우 아래 SQL 은 제외(G.TTL, LANE TTL)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("ORDER BY SUB_TRD_CD" ).append("\n"); 
		query.append("        ,SLAN_CD" ).append("\n"); 
		query.append("        ,WEEK" ).append("\n"); 
		query.append("        ,VVD" ).append("\n"); 
		query.append("        ,CLPT_SEQ" ).append("\n"); 
		query.append("        ,YD_CD" ).append("\n"); 

	}
}