/*=========================================================
*Copyright(c) 2009 CyberLogitec
*@FileName : CntrRepoPlanManageDBDAOGetForecastedLandInventoryListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2009.11.10
*@LastModifier : 
*@LastVersion : 1.0
* 2009.11.10 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.ees.eqr.repoplanmanage.cntrrepoplanmanage.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;

import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class CntrRepoPlanManageDBDAOGetForecastedLandInventoryListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * <EES_EQR_0051 컨테이너 이송계획 관리>
	  * EQR 각 PORT의 재고정보 / OUTBOUND, INBOUND / 운송모드별 운송수량 비교하는 쿼리
	  * 
	  * <Change History>
	  * 1	2009.08.17	Lee ByoungHun	최초작성
	  * </pre>
	  */
	public CntrRepoPlanManageDBDAOGetForecastedLandInventoryListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("repo_pln_Id",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.ees.eqr.repoplanmanage.cntrrepoplanmanage.integration").append("\n"); 
		query.append("FileName : CntrRepoPlanManageDBDAOGetForecastedLandInventoryListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("WITH XX AS(" ).append("\n"); 
		query.append("----------------------------------------------------------------------------------Initial" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(", '00Initial' ITEM" ).append("\n"); 
		query.append(", '0' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = E.ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_Id] REPO_PLN_ID" ).append("\n"); 
		query.append(",(SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE SNAP_DT BETWEEN WK_ST_DT  AND WK_END_DT) PLN_YRWK" ).append("\n"); 
		query.append(",PLN.ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INVT_SNAP PLN" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SNAP_DT = (SELECT WK_ST_DT FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${fmplnyr_1}${fmplnwk_1}')" ).append("\n"); 
		query.append("#if (${item_1} != '' || ${lane_1} != '' || ${vvd_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("SNAP_DT, PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM, REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("----------------------------------------------------------------------------------Demand Vol" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(", '10Demand Vol' ITEM" ).append("\n"); 
		query.append(", '0' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = FM_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_Id] REPO_PLN_ID" ).append("\n"); 
		query.append(", FCAST_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(", FM_ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_Id])" ).append("\n"); 
		query.append("#if (${item_1} != '' || ${lane_1} != '' || ${vvd_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (PLN.FM_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN '${fmplnyr_1}${fmplnwk_1}'	 AND  '${toplnyr_1}${toplnwk_1}'" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("FCAST_YRWK, FM_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("FCAST_YRWK" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("----------------------------------------------------------------------------------Repo Out" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(", '20Repo Out' ITEM" ).append("\n"); 
		query.append(", '0' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = FM_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("-------EQR_VSL_LODG_DCHG_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN.PLN_YRWK" ).append("\n"); 
		query.append(", FM_ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("#if ($arrItem.size() > 0)" ).append("\n"); 
		query.append("AND TRSP_MOD_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrItem})" ).append("\n"); 
		query.append("#if($velocityCount < $arrItem.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrIane.size() > 0)" ).append("\n"); 
		query.append("AND VSL_LANE_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrIane})" ).append("\n"); 
		query.append("#if($velocityCount < $arrIane.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrVvd.size() > 0)" ).append("\n"); 
		query.append("AND VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrVvd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrVvd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (PLN.FM_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${fmplnyr_1}${fmplnwk_1}')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${toplnyr_1}${toplnwk_1}')" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID, PLN.PLN_YRWK, FM_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-------EQR_INLND_TRSP_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN.PLN_YRWK" ).append("\n"); 
		query.append(", FM_ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("#if ($arrItem.size() > 0)" ).append("\n"); 
		query.append("AND TRSP_MOD_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrItem})" ).append("\n"); 
		query.append("#if($velocityCount < $arrItem.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${item_1} != '' && ${lane_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#elseif (${item_1} != '' && ${vvd_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (PLN.FM_ECC_CD = c.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND FM_YRWK BETWEEN '${fmplnyr_1}${fmplnwk_1}'	 AND  '${toplnyr_1}${toplnwk_1}'" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID, PLN.PLN_YRWK, FM_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("----------------------------------------------------------------------------------Execution(Repo Out)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(", '30Execution' ITEM" ).append("\n"); 
		query.append(", '1' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = FM_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("-------EQR_VSL_LODG_DCHG_EXE_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN.PLN_YRWK" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(FM_YD_CD,0,5)) AS FM_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("#if ($arrItem.size() > 0)" ).append("\n"); 
		query.append("AND TRSP_MOD_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrItem})" ).append("\n"); 
		query.append("#if($velocityCount < $arrItem.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrIane.size() > 0)" ).append("\n"); 
		query.append("AND VSL_LANE_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrIane})" ).append("\n"); 
		query.append("#if($velocityCount < $arrIane.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrVvd.size() > 0)" ).append("\n"); 
		query.append("AND VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrVvd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrVvd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.FM_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${fmplnyr_1}${fmplnwk_1}')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${toplnyr_1}${toplnwk_1}')" ).append("\n"); 
		query.append("#if (${inclexecplan_1} == '0')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID, PLN.PLN_YRWK, FM_YD_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("-------EQR_INLND_TRSP_EXE_PLN" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN.PLN_YRWK" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(FM_YD_CD,0,5)) AS FM_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_EXE_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("#if ($arrItem.size() > 0)" ).append("\n"); 
		query.append("AND TRSP_MOD_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrItem})" ).append("\n"); 
		query.append("#if($velocityCount < $arrItem.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${item_1} != '' && ${lane_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#elseif (${item_1} != '' && ${vvd_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.FM_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(FM_ETD_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${fmplnyr_1}${fmplnwk_1}')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${toplnyr_1}${toplnwk_1}')" ).append("\n"); 
		query.append("#if (${inclexecplan_1} == '0')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID, PLN.PLN_YRWK, FM_YD_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("---------------------------------------------------------------------------------- Off-Hire" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(", '40Off-Hire' ITEM" ).append("\n"); 
		query.append(", '0' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = FM_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN.PLN_YRWK" ).append("\n"); 
		query.append(", PLN.ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("#if (${isItemOffStr} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif (${isItemOffStr} == 'N')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN '${fmplnyr_1}${fmplnwk_1}'	 AND  '${toplnyr_1}${toplnwk_1}'" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("----------------------------------------------------------------------------------Execution(Off-Hire)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'outflow' AS FLOW" ).append("\n"); 
		query.append(", '50Execution' ITEM" ).append("\n"); 
		query.append(", '1' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = FM_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(", FM_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN.PLN_YRWK" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(FM_YD_CD,0,5)) FM_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_EXE_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("#if (${isItemOffStr} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif (${isItemOffStr} == 'N')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.FM_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'F'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN '${fmplnyr_1}${fmplnwk_1}' AND  '${toplnyr_1}${toplnwk_1}'" ).append("\n"); 
		query.append("#if (${inclexecplan_1} == '0')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID, PLN.PLN_YRWK, FM_YD_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("PLN_YRWK DESC" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN_YRWK, FM_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("----------------------------------------------------------------------------------I/B Generation" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(", '11I/B Generation' ITEM" ).append("\n"); 
		query.append(", '0' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = TO_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_Id] REPO_PLN_ID" ).append("\n"); 
		query.append(", FCAST_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(", TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_IB_BKG_FCAST PLN" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_Id] 	)" ).append("\n"); 
		query.append("#if (${item_1} != '' || ${lane_1} != '' || ${vvd_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND FCAST_YRWK BETWEEN '${fmplnyr_1}${fmplnwk_1}'	 AND  '${toplnyr_1}${toplnwk_1}'" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("FCAST_YRWK, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("FCAST_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append("--- 20070602  (황영신 수석님 추가 요청 반영) ---" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = TO_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_Id] REPO_PLN_ID" ).append("\n"); 
		query.append(", FCAST_DEL_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(", TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_VOL_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_OB_FCAST PLN" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_Id] 	)" ).append("\n"); 
		query.append("#if (${item_1} != '' || ${lane_1} != '' || ${vvd_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND FCAST_DEL_YRWK BETWEEN '${fmplnyr_1}${fmplnwk_1}' AND  '${toplnyr_1}${toplnwk_1}'" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("FCAST_DEL_YRWK, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("FCAST_DEL_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append("--- 추가 끝 ----" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("---------------------------------------------------------------------------------- Repo In" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(", '22Repo In' ITEM" ).append("\n"); 
		query.append(", '0' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(",  PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = TO_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("--EQR_VSL_LODG_DCHG_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT) AS PLN_YRWK" ).append("\n"); 
		query.append(", TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_LODG_DCHG_PLN_QTY QTY" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("#if ($arrItem.size() > 0)" ).append("\n"); 
		query.append("AND TRSP_MOD_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrItem})" ).append("\n"); 
		query.append("#if($velocityCount < $arrItem.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrIane.size() > 0)" ).append("\n"); 
		query.append("AND VSL_LANE_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrIane})" ).append("\n"); 
		query.append("#if($velocityCount < $arrIane.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrVvd.size() > 0)" ).append("\n"); 
		query.append("AND VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrVvd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrVvd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${fmplnyr_1}${fmplnwk_1}')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${toplnyr_1}${toplnwk_1}')" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID, TO_ETB_DT, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("--EQR_INLND_TRSP_PLN--------------" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", TO_YRWK AS PLN_YRWK" ).append("\n"); 
		query.append(", TO_ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_PLN_QTY QTY" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("#if ($arrItem.size() > 0)" ).append("\n"); 
		query.append("AND TRSP_MOD_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrItem})" ).append("\n"); 
		query.append("#if($velocityCount < $arrItem.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${item_1} != '' && ${lane_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#elseif (${item_1} != '' && ${vvd_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (PLN.TO_ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_YRWK BETWEEN '${fmplnyr_1}${fmplnwk_1}'	 AND  '${toplnyr_1}${toplnwk_1}'" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID, TO_YRWK, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("----------------------------------------------------------------------------------Execution(Repo In)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(", '33Execution' ITEM" ).append("\n"); 
		query.append(", '1' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY)	CNTR_QTY" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = TO_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(TO_ETB_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT) AS PLN_YRWK" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(TO_YD_CD,0,5)) AS TO_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_VSL_LODG_DCHG_EXE_PLN PLN" ).append("\n"); 
		query.append(", EQR_VSL_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("#if ($arrItem.size() > 0)" ).append("\n"); 
		query.append("AND TRSP_MOD_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrItem})" ).append("\n"); 
		query.append("#if($velocityCount < $arrItem.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrIane.size() > 0)" ).append("\n"); 
		query.append("AND VSL_LANE_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrIane})" ).append("\n"); 
		query.append("#if($velocityCount < $arrIane.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if ($arrVvd.size() > 0)" ).append("\n"); 
		query.append("AND VSL_CD||SKD_VOY_NO||SKD_DIR_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrVvd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrVvd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.TO_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(TO_ETB_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${fmplnyr_1}${fmplnwk_1}')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${toplnyr_1}${toplnwk_1}')" ).append("\n"); 
		query.append("#if (${inclexecplan_1} == '0')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID, TO_ETB_DT, TO_YD_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", (SELECT PLN_YR||PLN_WK FROM EQR_WK_PRD WHERE TO_CHAR(TO_ETA_DT,'YYYYMMDD') BETWEEN WK_ST_DT  AND WK_END_DT) AS PLN_YRWK" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(TO_YD_CD,0,5)) AS TO_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_INLND_TRSP_EXE_PLN PLN" ).append("\n"); 
		query.append(", EQR_INLND_TRSP_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("#if ($arrItem.size() > 0)" ).append("\n"); 
		query.append("AND TRSP_MOD_CD IN (" ).append("\n"); 
		query.append("#foreach ($key in ${arrItem})" ).append("\n"); 
		query.append("#if($velocityCount < $arrItem.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${item_1} != '' && ${lane_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#elseif (${item_1} != '' && ${vvd_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.TO_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND TO_CHAR(TO_ETA_DT,'YYYYMMDD')  BETWEEN" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${fmplnyr_1}${fmplnwk_1}')" ).append("\n"); 
		query.append("AND" ).append("\n"); 
		query.append("(SELECT TO_CHAR(TO_DATE(WK_END_DT,'YYYYMMDD'),'YYYYMMDD') FROM EQR_WK_PRD WHERE PLN_YR || PLN_WK = '${toplnyr_1}${toplnwk_1}')" ).append("\n"); 
		query.append("#if (${inclexecplan_1} == '0')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID, TO_ETA_DT, TO_YD_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  REPO_PLN_ID, PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("----------------------------------------------------------------------------------On-Hire" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(", '44On-Hire' ITEM" ).append("\n"); 
		query.append(", '0' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = FM_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN.PLN_YRWK" ).append("\n"); 
		query.append(", PLN.ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_PLN_QTY QTY" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("#if (${isItemOnStr} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif (${isItemOnStr} == 'N')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN '${fmplnyr_1}${fmplnwk_1}'	 AND  '${toplnyr_1}${toplnwk_1}'" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID, PLN.PLN_YRWK, PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("----------------------------------------------------------------------------------Execution(On-Hire)" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(", '55Execution' ITEM" ).append("\n"); 
		query.append(", '1' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = TO_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(", TO_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN.PLN_YRWK" ).append("\n"); 
		query.append(", (SELECT ECC_CD FROM MDM_EQ_ORZ_CHT WHERE SCC_CD = SUBSTR(TO_YD_CD,0,5)) TO_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY)  CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ONF_HIR_EXE_PLN PLN" ).append("\n"); 
		query.append(", EQR_ONF_HIR_EXE_PLN_QTY QTY" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT SCC_CD FROM MDM_EQ_ORZ_CHT WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("AND PLN.REPO_PLN_ID = QTY.REPO_PLN_ID" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK = QTY.PLN_YRWK" ).append("\n"); 
		query.append("AND PLN.PLN_SEQ = QTY.PLN_SEQ" ).append("\n"); 
		query.append("#if (${isItemOnStr} == 'Y')" ).append("\n"); 
		query.append("AND 1 = 1" ).append("\n"); 
		query.append("#elseif (${isItemOnStr} == 'N')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (SUBSTR(PLN.TO_YD_CD,0,5) = C.SCC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND ONF_HIR_DIV_CD = 'O'" ).append("\n"); 
		query.append("AND PLN.PLN_YRWK BETWEEN '${fmplnyr_1}${fmplnwk_1}' AND  '${toplnyr_1}${toplnwk_1}'" ).append("\n"); 
		query.append("#if (${inclexecplan_1} == '0')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.REPO_PLN_ID, PLN.PLN_YRWK, TO_YD_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("PLN_YRWK DESC" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY REPO_PLN_ID, PLN_YRWK, TO_ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("----------------------------------------------------------------------------------Safety Stock" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("TO_CHAR(BB.PLN_YRWK) PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(", '88Safety Stock' ITEM" ).append("\n"); 
		query.append(", '0' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append(", 'inflow' AS FLOW" ).append("\n"); 
		query.append(", '88Safety Stock' ITEM" ).append("\n"); 
		query.append(", '0' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = TO_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, TO_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("@[repo_pln_Id] REPO_PLN_ID" ).append("\n"); 
		query.append(", '' PLN_YRWK" ).append("\n"); 
		query.append(", PLN.ECC_CD AS TO_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(SFSTK_VOL_QTY) CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_SCNR_ECC_SFT_STK PLN" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("SCNR_ID = (SELECT SCNR_ID FROM EQR_EQ_REPO_PLN WHERE REPO_PLN_ID = @[repo_pln_Id] )" ).append("\n"); 
		query.append("#if (${item_1} != '' || ${lane_1} != '' || ${vvd_1} != '')" ).append("\n"); 
		query.append("AND 1 = 2" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY ECC_CD, REPO_PLN_ID" ).append("\n"); 
		query.append(")AA," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YR||PLN_WK AS PLN_YRWK" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("PLN_YR||PLN_WK BETWEEN '${fmplnyr_1}${fmplnwk_1}' AND  '${toplnyr_1}${toplnwk_1}'" ).append("\n"); 
		query.append(") BB" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("---------------------------------------------------------------------------------------	+/- ETC" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(",'inflow' AS FLOW" ).append("\n"); 
		query.append(", '66+/- ETC' ITEM" ).append("\n"); 
		query.append(", '0' LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", SUM(DECODE ( CNTR_TPSZ_CD , '$key' , CNTR_QTY ))    ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(",REPO_PLN_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(",(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("#if (${typeby_1} == 'R')" ).append("\n"); 
		query.append("RCC_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'C')" ).append("\n"); 
		query.append("CNT_CD" ).append("\n"); 
		query.append("#elseif (${typeby_1} == 'L')" ).append("\n"); 
		query.append("LCC_CD" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM EQR_ECC_MST" ).append("\n"); 
		query.append("WHERE ECC_CD = FM_ECC_CD" ).append("\n"); 
		query.append(") ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", CNTR_QTY" ).append("\n"); 
		query.append(", ROW_NUMBER() OVER (PARTITION BY PLN_YRWK, FM_ECC_CD , CNTR_TPSZ_CD ORDER BY ROWNUM) RUMM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("REPO_PLN_ID" ).append("\n"); 
		query.append(", PLN_YRWK" ).append("\n"); 
		query.append(", PLN.ECC_CD AS FM_ECC_CD" ).append("\n"); 
		query.append(", CNTR_TPSZ_CD" ).append("\n"); 
		query.append(", SUM(CNTR_QTY) AS CNTR_QTY" ).append("\n"); 
		query.append("FROM" ).append("\n"); 
		query.append("EQR_ADD_PLN PLN" ).append("\n"); 
		query.append("#if (${type_1} != '' && $arrEccCd.size() > 0)" ).append("\n"); 
		query.append(",(SELECT ECC_CD FROM EQR_ECC_MST WHERE 1 = 1" ).append("\n"); 
		query.append("#if (${type_1} == 'R')" ).append("\n"); 
		query.append("AND RCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'L')" ).append("\n"); 
		query.append("AND LCC_CD" ).append("\n"); 
		query.append("#elseif (${type_1} == 'E')" ).append("\n"); 
		query.append("AND ECC_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrEccCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrEccCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("))C" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("WHERE" ).append("\n"); 
		query.append("REPO_PLN_ID = @[repo_pln_Id]" ).append("\n"); 
		query.append("#if (${type_1} != '')" ).append("\n"); 
		query.append("AND (PLN.ECC_CD = C.ECC_CD)" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND PLN_YRWK BETWEEN '${fmplnyr_1}${fmplnwk_1}'	 AND  '${toplnyr_1}${toplnwk_1}'" ).append("\n"); 
		query.append("#if($arrCntrTpszCd.size() > 0)" ).append("\n"); 
		query.append("AND CNTR_TPSZ_CD IN(" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append("#if($velocityCount < $arrCntrTpszCd.size())" ).append("\n"); 
		query.append("'$key'," ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("'$key'" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("GROUP BY" ).append("\n"); 
		query.append("REPO_PLN_ID, PLN_YRWK, PLN.ECC_CD, CNTR_TPSZ_CD" ).append("\n"); 
		query.append("ORDER BY" ).append("\n"); 
		query.append("PLN_YRWK DESC" ).append("\n"); 
		query.append(") E" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("GROUP BY  RUMM ,REPO_PLN_ID , PLN_YRWK, ECC_CD" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("YY.ECC_CD" ).append("\n"); 
		query.append(", YY.PLN_YRWK" ).append("\n"); 
		query.append(", DECODE(" ).append("\n"); 
		query.append("SUBSTR(YY.ITEM,1,1),'0'," ).append("\n"); 
		query.append("'('|| (" ).append("\n"); 
		query.append("SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD') ,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE PLN_YR||PLN_WK  = YY.PLN_YRWK" ).append("\n"); 
		query.append(") ||')'" ).append("\n"); 
		query.append(",'6'," ).append("\n"); 
		query.append("'('|| (" ).append("\n"); 
		query.append("SELECT TO_CHAR(TO_DATE(WK_ST_DT,'YYYYMMDD') ,'YYYYMMDD')" ).append("\n"); 
		query.append("FROM EQR_WK_PRD" ).append("\n"); 
		query.append("WHERE PLN_YR||PLN_WK  = YY.PLN_YRWK" ).append("\n"); 
		query.append(") ||')'" ).append("\n"); 
		query.append(",'7',' ','8',' ','9',' ',YY.FLOW" ).append("\n"); 
		query.append(") FLOW" ).append("\n"); 
		query.append(", SUBSTR(YY.ITEM,3) ITEM" ).append("\n"); 
		query.append(", DECODE(SUBSTR(YY.ITEM,1,1),'3',1,'5',1,0) LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append("FROM XX," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK ," ).append("\n"); 
		query.append("ECC_CD," ).append("\n"); 
		query.append("'inflow' FLOW," ).append("\n"); 
		query.append("ITEM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT PLN_YRWK," ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(", FLOW" ).append("\n"); 
		query.append(", ITEM" ).append("\n"); 
		query.append(", LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append("FROM XX" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(") X," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT '11I/B Generation' ITEM FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '22Repo In' FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '33Execution' FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '44On-Hire' FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '55Execution' FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '66+/- ETC' FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '77Balance' FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '88Safety Stock' FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '99* Variance' FROM DUAL" ).append("\n"); 
		query.append(") Y" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK," ).append("\n"); 
		query.append("ECC_CD," ).append("\n"); 
		query.append("'outflow' FLOW," ).append("\n"); 
		query.append("ITEM" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("DISTINCT PLN_YRWK ," ).append("\n"); 
		query.append("ECC_CD" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("PLN_YRWK" ).append("\n"); 
		query.append(", ECC_CD" ).append("\n"); 
		query.append(", FLOW" ).append("\n"); 
		query.append(", ITEM" ).append("\n"); 
		query.append(", LVL" ).append("\n"); 
		query.append("#foreach ($key in ${arrCntrTpszCd})" ).append("\n"); 
		query.append(", ${key}CNTR_QTY" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append(", REPO_PLN_ID" ).append("\n"); 
		query.append("FROM XX" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append(") X," ).append("\n"); 
		query.append("(" ).append("\n"); 
		query.append("SELECT '00Initial' ITEM FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '10Demand Vol' ITEM FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '20Repo Out' FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '30Execution' FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '40Off-Hire' FROM DUAL UNION ALL" ).append("\n"); 
		query.append("SELECT '50Execution' FROM DUAL" ).append("\n"); 
		query.append(") Y" ).append("\n"); 
		query.append(") YY" ).append("\n"); 
		query.append("WHERE XX.PLN_YRWK (+)=YY.PLN_YRWK" ).append("\n"); 
		query.append("AND  XX.ECC_CD (+)=YY.ECC_CD" ).append("\n"); 
		query.append("AND  XX.FLOW (+)=YY.FLOW" ).append("\n"); 
		query.append("AND  XX.item (+) = YY.ITEM" ).append("\n"); 
		query.append("ORDER BY  ECC_CD, PLN_YRWK,  YY.FLOW  DESC, YY.ITEM" ).append("\n"); 

	}
}