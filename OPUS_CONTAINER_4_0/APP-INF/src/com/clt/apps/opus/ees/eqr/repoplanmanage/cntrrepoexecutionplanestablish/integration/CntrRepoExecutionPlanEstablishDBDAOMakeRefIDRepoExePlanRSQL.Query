<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="CntrRepoExecutionPlanEstablishDBDAOMakeRefIDRepoExePlanRSQL">
			<desc><![CDATA[Ref Id Select]]></desc>
			<sql><![CDATA[
SELECT SUBSTR(@[old_repo_plan_id] , 7, 4)
       ||SUBSTR(@[old_repo_plan_id] , 12, 4)
       ||@[onf_hir_div_cd]
       ||LTRIM(TO_CHAR(NVL(MAX(SUBSTR(REF_ID, -3))+1, 001), '000')) SEQ        
FROM 
    ${table_name}                                                           
WHERE REPO_PLN_ID            = @[repo_plan_id]  -- repo plan id                                                               
AND   REF_ID LIKE SUBSTR(@[old_repo_plan_id] , 7, 4)||SUBSTR(@[old_repo_plan_id] , 12, 4)||@[onf_hir_div_cd]||'%'
AND   LENGTH(REF_ID) = 12
			]]></sql>
			<params>
				<param name="old_repo_plan_id" type="12" value="1" out="N"/>
				<param name="onf_hir_div_cd" type="12" value="2" out="N"/>
				<param name="repo_plan_id" type="12" value="3" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
