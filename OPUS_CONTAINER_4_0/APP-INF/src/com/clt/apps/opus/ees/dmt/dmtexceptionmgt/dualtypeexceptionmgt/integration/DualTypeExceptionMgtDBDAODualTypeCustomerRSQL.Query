<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="DualTypeExceptionMgtDBDAODualTypeCustomerRSQL">
			<desc><![CDATA[지역 Calculation Type과 무관하게 Combined Tariff 적용이 필요한 등록된 화주정보 조회용 쿼리]]></desc>
			<sql><![CDATA[
SELECT	DECODE(A.DUL_EXPT_DELT_FLG, 'N', 'Live', 'Deleted') DUL_EXPT_DELT_DESC
	,	A.CUST_CNT_CD || LPAD(A.CUST_SEQ, 6, '0') CUST_CD
	,	B.CUST_LGL_ENG_NM CUST_NM
    ,	DMDT_CTRT_EXPT_TP_CD
    ,	TO_CHAR(A.DUL_EXPT_EFF_DT, 'YYYY-MM-DD') DUL_EXPT_EFF_DT
    ,	TO_CHAR(A.DUL_EXPT_EXP_DT, 'YYYY-MM-DD') DUL_EXPT_EXP_DT
    ,	A.IO_BND_CD
    ,	A.CVRG_CNT_CD
    ,	A.CVRG_RGN_STE_CD
    ,	A.CVRG_LOC_CD
	,	CASE 
			WHEN DMDT_CTRT_EXPT_TP_CD = 'B' THEN
				CASE 
					WHEN DMDT_CNTR_TP_CD IS NOT NULL AND DMDT_CGO_TP_CD IS NOT NULL
					THEN DMDT_CNTR_TP_CD || ':' || DMDT_CGO_TP_CD
					ELSE ''
			    END						
			WHEN DMDT_CTRT_EXPT_TP_CD = 'S' THEN DMDT_CNTR_CGO_TP_CD
		END DMDT_CNTR_CGO_TP_CD
    ,	A.DUL_EXPT_RMK
	,	CUST_EXPT_SEQ
	,	C.USR_NM UPD_USR_NM
    ,	TO_CHAR(A.UPD_DT, 'YYYY-MM-DD') UPD_DT
    ,	A.UPD_OFC_CD 

FROM	DMT_DUL_TP_EXPT A
    ,	MDM_CUSTOMER B
    ,	COM_USER C

WHERE    A.CUST_CNT_CD = B.CUST_CNT_CD
    AND A.CUST_SEQ = B.CUST_SEQ
#if(${cust_cnt_cd} != '')
	AND A.CUST_CNT_CD = @[cust_cnt_cd]
#end
#if(${cust_seq} != '')
	AND A.CUST_SEQ = TO_NUMBER(@[cust_seq])
#end
#if(${dul_expt_eff_dt} != '')
	AND (
		(A.DUL_EXPT_EFF_DT >= TO_DATE(@[dul_expt_eff_dt], 'YYYYMMDD') AND A.DUL_EXPT_EFF_DT <= TO_DATE(NVL(@[dul_expt_exp_dt], '99991231'), 'YYYYMMDD'))
		OR
		(A.DUL_EXPT_EFF_DT <= TO_DATE(@[dul_expt_eff_dt], 'YYYYMMDD') AND A.DUL_EXPT_EXP_DT >= TO_DATE(@[dul_expt_eff_dt], 'YYYYMMDD'))
	)
#end
#if(${dul_expt_delt_flg} != '')
	AND A.DUL_EXPT_DELT_FLG = @[dul_expt_delt_flg]
#end
	AND A.UPD_USR_ID = C.USR_ID

ORDER BY CUST_CD ASC			]]></sql>
			<params>
				<param name="cust_cnt_cd" type="12" value="" out="N"/>
				<param name="cust_seq" type="12" value="" out="N"/>
				<param name="dul_expt_eff_dt" type="12" value="" out="N"/>
				<param name="dul_expt_exp_dt" type="12" value="" out="N"/>
				<param name="dul_expt_delt_flg" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
