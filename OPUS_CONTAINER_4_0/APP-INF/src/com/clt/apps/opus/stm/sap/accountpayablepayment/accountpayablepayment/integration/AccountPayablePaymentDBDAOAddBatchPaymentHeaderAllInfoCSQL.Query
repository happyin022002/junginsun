<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountPayablePaymentDBDAOAddBatchPaymentHeaderAllInfoCSQL">
			<desc><![CDATA[addBatchPaymentHeaderAllInfo]]></desc>
			<sql><![CDATA[
INSERT INTO SAP_PAY_HDR
(   PAY_SEQ
  , BANK_ACCT_SEQ
  , BANK_ACCT_NM
  , PAY_DT
  , PAY_NO
  , PAY_TP_CD
  , PAY_AMT
  , CURR_CD
  , PAY_MZD_LU_CD
  , PAY_ADDR1
  , PAY_ADDR2
  , PAY_BAT_NM
  , PAY_CTY_CD
  , PAY_CNT_CD
  , PAY_STS_LU_CD
  , VNDR_NM
  , PAY_ZIP_CD
  , BANK_ACCT_NO
  , BANK_ACCT_TP_NM
  , DOC_SEQ
  , PAY_STE_NM
  , PAY_VOID_DT
  , ATTR_CATE_CTNT
  , ATTR_CTNT1
  , ATTR_CTNT2
  , ATTR_CTNT3
  , ATTR_CTNT4
  , ATTR_CTNT5
  , ATTR_CTNT6
  , ATTR_CTNT7
  , ATTR_CTNT8
  , ATTR_CTNT9
  , ATTR_CTNT10
  , ATTR_CTNT11
  , ATTR_CTNT12
  , ATTR_CTNT13
  , ATTR_CTNT14
  , ATTR_CTNT15
  , FTU_PAY_DUE_DT
  , VNDR_NO
  , PAY_XCH_RT
  , PAY_XCH_DT
  , XCH_RT_TP_CD
  , PAY_FUNC_AMT
  , PAY_BAT_RUN_SEQ
  , GLO_ATTR_CATE_CTNT
  , GLO_ATTR_CTNT1
  , GLO_ATTR_CTNT2
  , GLO_ATTR_CTNT3
  , GLO_ATTR_CTNT4
  , GLO_ATTR_CTNT5
  , GLO_ATTR_CTNT6
  , GLO_ATTR_CTNT7
  , GLO_ATTR_CTNT8
  , GLO_ATTR_CTNT9
  , GLO_ATTR_CTNT10
  , GLO_ATTR_CTNT11
  , GLO_ATTR_CTNT12
  , GLO_ATTR_CTNT13
  , GLO_ATTR_CTNT14
  , GLO_ATTR_CTNT15
  , GLO_ATTR_CTNT16
  , GLO_ATTR_CTNT17
  , GLO_ATTR_CTNT18
  , GLO_ATTR_CTNT19
  , GLO_ATTR_CTNT20
  , XTER_BANK_ACCT_SEQ
  , PAY_DESC
  , IBAN_NO
  , OFC_CD
  , CRE_USR_ID
  , CRE_DT
  , UPD_USR_ID
  , UPD_DT
)
SELECT  @[pay_seq]                   AS PAY_SEQ
      , SISC.BANK_ACCT_SEQ           AS BANK_ACCT_SEQ
      , SBA.BANK_ACCT_NM             AS BANK_ACCT_NM
      , SISC.PAY_DT                  AS PAY_DT
      , @[doc_first_no] + @[loop_index] - 1  AS PAY_NO -- (Loop는 Vendor별 Summary 처리한 배열의 Index 값)
      , 'B'                          AS PAY_TP_CD
      , @[pay_amt]                   AS PAY_AMT
      , SISC.PAY_CURR_CD             AS PAY_CURR_CD
      , SISC.PAY_MZD_LU_CD           AS PAY_MZD_LU_CD
      , MV.ENG_ADDR                  AS PAY_ADDR1
      , MV.LOCL_LANG_ADDR            AS PAY_ADDR2
      , SISC.PAY_BAT_NM              AS PAY_BAT_NM
      , SSI.AP_CTY_CD                AS PAY_CTY_CD
      , SSI.AP_CNT_CD                AS PAY_CNT_CD
      , 'NEGOTIABLE'                 AS PAY_STS_LU_CD
      , MV.VNDR_LGL_ENG_NM           AS VNDR_NM
      , SSI.ZIP_CD                   AS PAY_ZIP_CD
      , SBA.BANK_ACCT_NO             AS BANK_ACCT_NO
      , ''                           AS BANK_ACCT_TP_NM
      , SAP_PAY_HDR_DOC_SEQ.NEXTVAL  AS DOC_SEQ
      , ''                           AS PAY_STE_NM
      , ''                           AS PAY_VOID_DT
      , ''                           AS ATTR_CATE_CTNT
      , ''                           AS ATTR_CTNT1
      , ''                           AS ATTR_CTNT2
      , ''                           AS ATTR_CTNT3
      , ''                           AS ATTR_CTNT4
      , ''                           AS ATTR_CTNT5
      , ''                           AS ATTR_CTNT6
      , ''                           AS ATTR_CTNT7
      , ''                           AS ATTR_CTNT8
      , ''                           AS ATTR_CTNT9
      , ''                           AS ATTR_CTNT10
      , ''                           AS ATTR_CTNT11
      , ''                           AS ATTR_CTNT12
      , ''                           AS ATTR_CTNT13
      , ''                           AS ATTR_CTNT14
      , ''                           AS ATTR_CTNT15
      , ''                           AS FTU_PAY_DUE_DT
      , SSI.VNDR_NO                  AS VNDR_NO
      , DECODE(SISC.PAY_CURR_CD, @[functional_currency], 1, SISC.PAY_XCH_RT)              AS PAY_XCH_RT
      , DECODE(SISC.PAY_CURR_CD, @[functional_currency], TO_CHAR(SISC.PAY_DT, 'YYYYMMDD'), TO_CHAR(SISC.PAY_XCH_DT, 'YYYYMMDD')) AS PAY_XCH_DT
      , SSI.PAY_XCH_RT_TP_CD         AS XCH_RT_TP_CD
      , DECODE(SISC.PAY_XCH_RT, NULL, ROUND(@[pay_amt], (SELECT NVL(MC.DP_PRCS_KNT, 0) FROM MDM_CURRENCY MC WHERE MC.CURR_CD = @[functional_currency])),
               ROUND(@[pay_amt] * SISC.PAY_XCH_RT, (SELECT NVL(MC.DP_PRCS_KNT, 0) FROM MDM_CURRENCY MC WHERE MC.CURR_CD = @[functional_currency]))) AS PAY_FUNC_AMT
      , SSI.PAY_BAT_SEQ              AS PAY_BAT_RUN_SEQ
      , ''                           AS GLO_ATTR_CATE_CTNT
      , ''                           AS GLO_ATTR_CTNT1
      , ''                           AS GLO_ATTR_CTNT2
      , ''                           AS GLO_ATTR_CTNT3
      , ''                           AS GLO_ATTR_CTNT4
      , ''                           AS GLO_ATTR_CTNT5
      , ''                           AS GLO_ATTR_CTNT6
      , ''                           AS GLO_ATTR_CTNT7
      , ''                           AS GLO_ATTR_CTNT8
      , ''                           AS GLO_ATTR_CTNT9
      , ''                           AS GLO_ATTR_CTNT10
      , ''                           AS GLO_ATTR_CTNT11
      , ''                           AS GLO_ATTR_CTNT12
      , ''                           AS GLO_ATTR_CTNT13
      , ''                           AS GLO_ATTR_CTNT14
      , ''                           AS GLO_ATTR_CTNT15
      , ''                           AS GLO_ATTR_CTNT16
      , ''                           AS GLO_ATTR_CTNT17
      , ''                           AS GLO_ATTR_CTNT18
      , ''                           AS GLO_ATTR_CTNT19
      , ''                           AS GLO_ATTR_CTNT20
      , SSI.XTER_BANK_ACCT_SEQ       AS XTER_BANK_ACCT_SEQ
      , MV.VNDR_LGL_ENG_NM           AS PAY_DESC
      , SBA.IBAN_NO                  AS IBAN_NO
      , SISC.OFC_CD                  AS OFC_CD
      , @[usr_id]                    AS CRE_USR_ID
      , SYSDATE                      AS CRE_DT
      , @[usr_id]                    AS UPD_USR_ID
      , SYSDATE                      AS UPD_DT
FROM    SAP_SEL_INV SSI
      , SAP_INV_SEL_CRTE SISC
      , SAP_BANK_ACCT SBA
      , MDM_VENDOR MV
WHERE   SSI.PAY_BAT_SEQ = SISC.PAY_BAT_SEQ
AND     SSI.PAY_BAT_NM = SISC.PAY_BAT_NM 
AND     SISC.BANK_ACCT_SEQ = SBA.BANK_ACCT_SEQ 
AND     TO_NUMBER(SSI.VNDR_NO) = MV.VNDR_SEQ
AND     SSI.PAY_BAT_SEQ = @[pay_bat_seq]
AND     SSI.PAY_BAT_NM = @[pay_bat_nm]
AND     SSI.VNDR_NO = @[vndr_no]
AND     ROWNUM = 1			]]></sql>
			<params>
				<param name="pay_seq" type="12" value="" out="N"/>
				<param name="doc_first_no" type="12" value="" out="N"/>
				<param name="loop_index" type="12" value="" out="N"/>
				<param name="pay_amt" type="12" value="" out="N"/>
				<param name="functional_currency" type="12" value="" out="N"/>
				<param name="usr_id" type="12" value="" out="N"/>
				<param name="pay_bat_seq" type="12" value="" out="N"/>
				<param name="pay_bat_nm" type="12" value="" out="N"/>
				<param name="vndr_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
