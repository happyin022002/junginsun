<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableOutstandingDBDAOmodifyOutstandingDetailUSQL">
			<desc><![CDATA[SAR_OTS_DTL 테이블에 update]]></desc>
			<sql><![CDATA[
UPDATE SAR_OTS_DTL SET
    INV_AMT = NVL(INV_AMT, 0) + NVL(@[inv_amt], 0)
    , INV_UPD_DT = DECODE(NVL(@[inv_amt], 0), 0, INV_UPD_DT, SYSDATE)
	, RCT_AMT = NVL(RCT_AMT, 0) + NVL(@[rct_amt], 0)
    , RCT_UPD_DT = DECODE(NVL(@[rct_amt], 0), 0, RCT_UPD_DT, SYSDATE)
	, ADJ_AMT = NVL(ADJ_AMT, 0) + NVL(@[adj_amt], 0)
    , ADJ_UPD_DT = DECODE(NVL(@[adj_amt], 0), 0, ADJ_UPD_DT, SYSDATE)
    , BAL_AMT = NVL(BAL_AMT, 0) + (NVL(@[inv_amt], 0) - NVL(@[rct_amt], 0) + NVL(@[adj_amt], 0))
    , BAL_UPD_DT = SYSDATE
	, WRTF_AMT = NVL(WRTF_AMT, 0) + NVL(@[wrtf_amt], 0)
	, WRTF_UPD_DT = DECODE(NVL(@[wrtf_amt], 0), 0, WRTF_UPD_DT, SYSDATE)
    , LOCL_XCH_RT = NVL(@[locl_xch_rt], NVL(LOCL_XCH_RT, 0))
    , USD_XCH_RT = NVL(@[usd_xch_rt], NVL(USD_XCH_RT, 0))
    , BAL_LOCL_AMT = (SELECT ROUND((NVL(BAL_AMT, 0) + NVL(@[inv_amt], 0) - NVL(@[rct_amt], 0) + NVL(@[adj_amt], 0)) * NVL(@[locl_xch_rt], NVL(LOCL_XCH_RT, 0)), A.DP_PRCS_KNT)
                      FROM MDM_CURRENCY A,
						   SAR_OTS_HDR B
                      WHERE A.CURR_CD = B.OFC_CURR_CD
					  AND B.RHQ_CD = @[rhq_cd]
					  AND B.OTS_OFC_CD = @[ots_ofc_cd]
					  AND B.BL_NO = @[bl_no]
					  AND B.INV_NO = @[inv_no])
    , BAL_USD_AMT = ROUND((NVL(BAL_AMT, 0) + NVL(@[inv_amt], 0) - NVL(@[rct_amt], 0) + NVL(@[adj_amt], 0)) * NVL(@[usd_xch_rt], NVL(USD_XCH_RT, 0)), 2)
    , UPD_USR_ID = @[upd_usr_id]
    , UPD_DT = SYSDATE
WHERE RHQ_CD = @[rhq_cd]
AND OTS_OFC_CD = @[ots_ofc_cd]
AND BL_NO = @[bl_no]
AND INV_NO = @[inv_no]
AND BL_CURR_CD = @[bl_curr_cd]
AND CHG_TP_CD = @[chg_tp_cd]			]]></sql>
			<params>
				<param name="inv_amt" type="12" value="" out="N"/>
				<param name="rct_amt" type="12" value="" out="N"/>
				<param name="adj_amt" type="12" value="" out="N"/>
				<param name="wrtf_amt" type="12" value="" out="N"/>
				<param name="locl_xch_rt" type="12" value="" out="N"/>
				<param name="usd_xch_rt" type="12" value="" out="N"/>
				<param name="rhq_cd" type="12" value="" out="N"/>
				<param name="ots_ofc_cd" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="inv_no" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="bl_curr_cd" type="12" value="" out="N"/>
				<param name="chg_tp_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
