<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountPayableCommonDBDAOSearchGLDatePeriodCheckRSQL">
			<desc><![CDATA[입력된 G/L Date에 대해서 회계 Period을 Check하여 해당 월이 입력 가능한 Open월인지 확인 ( O : open , C : Close )]]></desc>
			<sql><![CDATA[
  SELECT DECODE( CHK1, '', DECODE(CHK2, '', CHK3, CHK2), CHK1 ) CHK_PRD
  FROM 
  (
      SELECT MAX(CHK1) CHK1, MAX(CHK2) CHK2, MAX(CHK3) CHK3 
      FROM
      (
		SELECT  CLZ_STS_CD  AS CHK1 , '' CHK2, '' CHK3 
		FROM AP_PERIOD 
		WHERE EFF_YRMON = SUBSTR(REPLACE(@[gl_dt],'-'),0,6) 
		AND SYS_DIV_CD = '34' 
		AND OFC_CD = @[ofc_cd] --  INPUT
		AND AR_AP_DIV_CD = 'P'
		UNION 
		SELECT  '' CHK1, CLZ_STS_CD AS CHK2 , '' CHK3
		FROM    AP_PERIOD AP
		      , MDM_ORGANIZATION MO
		WHERE   AP.EFF_YRMON  = SUBSTR(REPLACE(@[gl_dt],'-'),0,6) 
		AND AP.SYS_DIV_CD = '34' 
		AND MO.OFC_CD = @[ofc_cd]    
		AND AP.AR_AP_DIV_CD = 'P'
		AND     AP.OFC_CD = MO.AR_HD_QTR_OFC_CD
		UNION
		SELECT  '' CHK1, '' CHK2, prd_sts_cd  AS CHK3
		FROM sco_period 
		WHERE eff_yrmon = SUBSTR(REPLACE(@[gl_dt],'-'),0,6) 
		AND prd_appl_cd = 'AP'
      ) A
  )			]]></sql>
			<params>
				<param name="gl_dt" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
