/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : AccountReceivableCollectIFDBDAOsearchIFSakuraReceiptListRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.08.26
*@LastModifier : 
*@LastVersion : 1.0
* 2016.08.26 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.stm.sar.accountreceivablecollect.accountreceivablecollectif.intergration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class AccountReceivableCollectIFDBDAOsearchIFSakuraReceiptListRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * searchIFSakuraReceiptList
	  * </pre>
	  */
	public AccountReceivableCollectIFDBDAOsearchIFSakuraReceiptListRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rct_no",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("check_status",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.stm.sar.accountreceivablecollect.accountreceivablecollectif.intergration").append("\n"); 
		query.append("FileName : AccountReceivableCollectIFDBDAOsearchIFSakuraReceiptListRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("#if (${rct_no} == '' )" ).append("\n"); 
		query.append("SELECT DISTINCT" ).append("\n"); 
		query.append("       SR.RCT_NO AS ref_doc_no" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if (${grp_yn} == 'Y' )" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("	IF_SEQ_NO," ).append("\n"); 
		query.append("  REC_ID," ).append("\n"); 
		query.append("	ACCT_CO_CD," ).append("\n"); 
		query.append("	IF_DOC_TP_CD," ).append("\n"); 
		query.append("	DOC_DT," ).append("\n"); 
		query.append("	PST_DT," ).append("\n"); 
		query.append("	REF_DOC_NO," ).append("\n"); 
		query.append("	DOC_HDR_CD," ).append("\n"); 
		query.append("	CURR_CD, " ).append("\n"); 
		query.append("	TAX_CALC_AUTO_FLG," ).append("\n"); 
		query.append("    DECODE(REC_TP_CD, 'REC', DECODE(sign(nvl(doc_amt,0)+nvl(locl_amt,0)),'1','11','01'), PST_KEY_CD) PST_KEY_CD,-- 20160722" ).append("\n"); 
		query.append("	VAT_TAX_CD," ).append("\n"); 
		query.append("    ABS(LOCL_AMT) LOCL_AMT, --20160723" ).append("\n"); 
		query.append("    ABS(DOC_AMT) DOC_AMT, --20160723" ).append("\n"); 
		query.append("  LOCL_TAX_AMT," ).append("\n"); 
		query.append("  DOC_TAX_AMT," ).append("\n"); 
		query.append("	ASGN_NO," ).append("\n"); 
		query.append("	ITM_DESC," ).append("\n"); 
		query.append("	PLN_DT," ).append("\n"); 
		query.append("	COST_CTR_CD," ).append("\n"); 
		query.append("	ORD_NO," ).append("\n"); 
		query.append("	MN_ASET_NO," ).append("\n"); 
		query.append("	SUB_ASET_NO," ).append("\n"); 
		query.append("	ASET_TJ_TP_CD," ).append("\n"); 
		query.append("	ASET_VAL_DT," ).append("\n"); 
		query.append("	GL_ACCT_NO," ).append("\n"); 
		query.append("	CUST_NO," ).append("\n"); 
		query.append("	VNDR_CRTR_ACCT_NO," ).append("\n"); 
		query.append("	DUE_DT_CALC_BSEL_DT," ).append("\n"); 
		query.append("	PAY_MZD_CD," ).append("\n"); 
		query.append("	STE_CNTRL_BANK_IND_CD," ).append("\n"); 
		query.append("	MTRL_NO," ).append("\n"); 
		query.append("	FUEL_LAND_QTY," ).append("\n"); 
		query.append("	MEAS_BSE_UT_CD," ).append("\n"); 
		query.append("	PFITCTR_CD," ).append("\n"); 
		query.append("	ALTN_ACCT_NO," ).append("\n"); 
		query.append("	BIZ_PRNR_REF_KEY_CD1," ).append("\n"); 
		query.append("	BIZ_PRNR_REF_KEY_CD2," ).append("\n"); 
		query.append("	LINE_ITM_REF_KEY_CD," ).append("\n"); 
		query.append("	INSTR_KEY_CD1," ).append("\n"); 
		query.append("	INSTR_KEY_CD2," ).append("\n"); 
		query.append("	INSTR_KEY_CD3," ).append("\n"); 
		query.append("	PAY_REF_CD," ).append("\n"); 
		query.append("	AUTOMTC_PAY_CURR_CD," ).append("\n"); 
		query.append("	PAY_CURR_AMT," ).append("\n"); 
		query.append("	CTRT_NO," ).append("\n"); 
		query.append("	CTRT_TP_CD," ).append("\n"); 
		query.append("	PAY_RSN_CD," ).append("\n"); 
		query.append("	CLSS_CD," ).append("\n"); 
		query.append("	ACT_PLC_CD," ).append("\n"); 
		query.append("	ENTR_EXPN_ID," ).append("\n"); 
		query.append("	BUD_MGMT_DIV_CD," ).append("\n"); 
		query.append("	ACT_DT," ).append("\n"); 
		query.append("	VSL_CD," ).append("\n"); 
		query.append("	VVL_CD," ).append("\n"); 
		query.append("	HUS_BANK_ID," ).append("\n"); 
		query.append("	PAY_BLCK_KEY_CD," ).append("\n"); 
		query.append("	NULL N1ST_LODG_PORT_CD," ).append("\n"); 
		query.append("	NULL N1ST_LODG_PORT_ETD_DT," ).append("\n"); 
		query.append("	NULL LST_DCHG_PORT_CD," ).append("\n"); 
		query.append("	NULL LST_DCHG_PORT_ETA_DT," ).append("\n"); 
		query.append("	NULL TRD_CD," ).append("\n"); 
		query.append("	NULL TRNK_VVD_CD," ).append("\n"); 
		query.append("	REC_TP_CD," ).append("\n"); 
		query.append("	NULL SLAN_CD," ).append("\n"); 
		query.append("	NULL BKG_QTY," ).append("\n"); 
		query.append("	NULL ASA_FLG, " ).append("\n"); 
		query.append("	RVS_FLG," ).append("\n"); 
		query.append("    CRE_USR_ID," ).append("\n"); 
		query.append("	UPD_USR_ID" ).append("\n"); 
		query.append("FROM(" ).append("\n"); 
		query.append("SELECT" ).append("\n"); 
		query.append("	IF_SEQ_NO," ).append("\n"); 
		query.append("	MAX(REC_ID) REC_ID," ).append("\n"); 
		query.append("	ACCT_CO_CD," ).append("\n"); 
		query.append("	IF_DOC_TP_CD," ).append("\n"); 
		query.append("	DOC_DT," ).append("\n"); 
		query.append("	PST_DT," ).append("\n"); 
		query.append("	REF_DOC_NO," ).append("\n"); 
		query.append("	DOC_HDR_CD," ).append("\n"); 
		query.append("	CURR_CD, " ).append("\n"); 
		query.append("	TAX_CALC_AUTO_FLG," ).append("\n"); 
		query.append("    DECODE(REC_TP_CD, 'REC', 'XX', PST_KEY_CD) PST_KEY_CD, --20160722" ).append("\n"); 
		query.append("	VAT_TAX_CD," ).append("\n"); 
		query.append("    SUM(DECODE(REC_TP_CD, 'REC', DECODE(PST_KEY_CD,'11', LOCL_AMT, LOCL_AMT*(-1)), LOCL_AMT)) LOCL_AMT," ).append("\n"); 
		query.append("    SUM(DECODE(REC_TP_CD, 'REC', DECODE(PST_KEY_CD,'11', DOC_AMT, DOC_AMT*(-1)), DOC_AMT)) DOC_AMT," ).append("\n"); 
		query.append("	SUM(LOCL_TAX_AMT) LOCL_TAX_AMT," ).append("\n"); 
		query.append("	SUM(DOC_TAX_AMT) DOC_TAX_AMT," ).append("\n"); 
		query.append("	ASGN_NO," ).append("\n"); 
		query.append("	ITM_DESC," ).append("\n"); 
		query.append("	PLN_DT," ).append("\n"); 
		query.append("	COST_CTR_CD," ).append("\n"); 
		query.append("	ORD_NO," ).append("\n"); 
		query.append("	MN_ASET_NO," ).append("\n"); 
		query.append("	SUB_ASET_NO," ).append("\n"); 
		query.append("	ASET_TJ_TP_CD," ).append("\n"); 
		query.append("	ASET_VAL_DT," ).append("\n"); 
		query.append("	GL_ACCT_NO," ).append("\n"); 
		query.append("	CUST_NO," ).append("\n"); 
		query.append("	VNDR_CRTR_ACCT_NO," ).append("\n"); 
		query.append("	DUE_DT_CALC_BSEL_DT," ).append("\n"); 
		query.append("	PAY_MZD_CD," ).append("\n"); 
		query.append("	STE_CNTRL_BANK_IND_CD," ).append("\n"); 
		query.append("	MTRL_NO," ).append("\n"); 
		query.append("	FUEL_LAND_QTY," ).append("\n"); 
		query.append("	MEAS_BSE_UT_CD," ).append("\n"); 
		query.append("	PFITCTR_CD," ).append("\n"); 
		query.append("	ALTN_ACCT_NO," ).append("\n"); 
		query.append("	BIZ_PRNR_REF_KEY_CD1," ).append("\n"); 
		query.append("	BIZ_PRNR_REF_KEY_CD2," ).append("\n"); 
		query.append("	LINE_ITM_REF_KEY_CD," ).append("\n"); 
		query.append("	INSTR_KEY_CD1," ).append("\n"); 
		query.append("	INSTR_KEY_CD2," ).append("\n"); 
		query.append("	INSTR_KEY_CD3," ).append("\n"); 
		query.append("	PAY_REF_CD," ).append("\n"); 
		query.append("	AUTOMTC_PAY_CURR_CD," ).append("\n"); 
		query.append("	PAY_CURR_AMT," ).append("\n"); 
		query.append("	CTRT_NO," ).append("\n"); 
		query.append("	CTRT_TP_CD," ).append("\n"); 
		query.append("	PAY_RSN_CD," ).append("\n"); 
		query.append("	CLSS_CD," ).append("\n"); 
		query.append("	ACT_PLC_CD," ).append("\n"); 
		query.append("	ENTR_EXPN_ID," ).append("\n"); 
		query.append("	BUD_MGMT_DIV_CD," ).append("\n"); 
		query.append("	ACT_DT," ).append("\n"); 
		query.append("	VSL_CD," ).append("\n"); 
		query.append("	VVL_CD," ).append("\n"); 
		query.append("	HUS_BANK_ID," ).append("\n"); 
		query.append("	PAY_BLCK_KEY_CD," ).append("\n"); 
		query.append("	NULL N1ST_LODG_PORT_CD," ).append("\n"); 
		query.append("	NULL N1ST_LODG_PORT_ETD_DT," ).append("\n"); 
		query.append("	NULL LST_DCHG_PORT_CD," ).append("\n"); 
		query.append("	NULL LST_DCHG_PORT_ETA_DT," ).append("\n"); 
		query.append("	NULL TRD_CD," ).append("\n"); 
		query.append("	NULL TRNK_VVD_CD," ).append("\n"); 
		query.append("	REC_TP_CD," ).append("\n"); 
		query.append("	NULL SLAN_CD," ).append("\n"); 
		query.append("	NULL BKG_QTY," ).append("\n"); 
		query.append("	NULL ASA_FLG, " ).append("\n"); 
		query.append("	RVS_FLG," ).append("\n"); 
		query.append("	XCH_RT, --20160826 추가" ).append("\n"); 
		query.append("    CRE_USR_ID," ).append("\n"); 
		query.append("	UPD_USR_ID" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("--Receipt" ).append("\n"); 
		query.append("SELECT " ).append("\n"); 
		query.append("       --EAI 생성 시 doc_hdr_cd 기준으로 채번" ).append("\n"); 
		query.append("       NVL(SCD.AR_IF_SEQ,999999999999999)   AS if_seq_no" ).append("\n"); 
		query.append("       , ''             AS rec_id" ).append("\n"); 
		query.append("       , '1000'         AS acct_co_cd" ).append("\n"); 
		query.append("       , DECODE( SUBSTR(MO.FINC_RGN_CD, 1,2), '11','U2','H2') AS if_doc_tp_Cd                --2" ).append("\n"); 
		query.append("       , SR.RCT_DT      AS doc_dt                                                       --3" ).append("\n"); 
		query.append("       , SRA.GL_DT      AS pst_dt                                                       --4" ).append("\n"); 
		query.append("       , REPLACE(SR.RCT_NO,'REC') AS ref_doc_no                                         --5" ).append("\n"); 
		query.append("       , NULL    AS doc_hdr_cd								--6" ).append("\n"); 
		query.append("       , SR.RCT_CURR_CD AS curr_cd							--7" ).append("\n"); 
		query.append("       , NULL            AS tax_calc_auto_flg                                            --8" ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD IN ('CASH', 'UNID', 'UNAPP', 'REC') THEN" ).append("\n"); 
		query.append("                 DECODE(NVL(SCD.ACCT_DR_AMT, 0)+NVL(SCD.INP_DR_AMT, 0), 0, '11', '01')" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD IN ('EXCH_GAIN', 'EXCH_LOSS', 'HDR_RND') THEN" ).append("\n"); 
		query.append("                 DECODE(NVL(SCD.ACCT_DR_AMT, 0)+NVL(SCD.INP_DR_AMT, 0), 0, '50', '40')" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'WRTF' THEN" ).append("\n"); 
		query.append("                 CASE" ).append("\n"); 
		query.append("                     --20160826 WHT 수정" ).append("\n"); 
		query.append("                     WHEN SRA.WRTF_TP_CD = 'RFD' THEN" ).append("\n"); 
		query.append("                         DECODE(NVL(SCD.ACCT_DR_AMT, 0)+NVL(SCD.INP_DR_AMT, 0), 0, '11', '01')" ).append("\n"); 
		query.append("                     ELSE    " ).append("\n"); 
		query.append("                         DECODE(NVL(SCD.ACCT_DR_AMT, 0)+NVL(SCD.INP_DR_AMT, 0), 0, '50', '40')" ).append("\n"); 
		query.append("                 END" ).append("\n"); 
		query.append("         END            AS pst_key_cd    --9" ).append("\n"); 
		query.append("         --20160826 WHT 수정" ).append("\n"); 
		query.append("        , CASE" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'HDR_RND') OR (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD NOT IN ('RFD','EDI','WHT','EDL')) THEN" ).append("\n"); 
		query.append("                 DECODE( SUBSTR(MO.FINC_RGN_CD, 1,2), '11','B0','D0')  " ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD ='WHT') THEN" ).append("\n"); 
		query.append("                 'F0'  " ).append("\n"); 
		query.append("         END  AS vat_tax_cd  --10" ).append("\n"); 
		query.append("       , CASE " ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD IN ('EXCH_GAIN', 'EXCH_LOSS', 'HDR_RND') THEN" ).append("\n"); 
		query.append("                 CASE" ).append("\n"); 
		query.append("                     WHEN SR.RCT_CURR_CD = FUNC.CURR_CD THEN" ).append("\n"); 
		query.append("                         NULL" ).append("\n"); 
		query.append("                     ELSE    " ).append("\n"); 
		query.append("                         ABS(NVL(SCD.ACCT_DR_AMT, 0) - NVL(SCD.ACCT_CR_AMT, 0))" ).append("\n"); 
		query.append("                 END" ).append("\n"); 
		query.append("             ELSE" ).append("\n"); 
		query.append("                 CASE" ).append("\n"); 
		query.append("                     WHEN SR.RCT_CURR_CD = FUNC.CURR_CD THEN" ).append("\n"); 
		query.append("                         NULL" ).append("\n"); 
		query.append("                     ELSE" ).append("\n"); 
		query.append("                         ABS(NVL(SCD.ACCT_DR_AMT, 0) - NVL(SCD.ACCT_CR_AMT, 0))" ).append("\n"); 
		query.append("                 END" ).append("\n"); 
		query.append("         END  AS locl_amt   --11" ).append("\n"); 
		query.append("       , " ).append("\n"); 
		query.append("         CASE " ).append("\n"); 
		query.append("             WHEN SR.RCT_CURR_CD = FUNC.CURR_CD THEN" ).append("\n"); 
		query.append("                 ABS(NVL(SCD.ACCT_DR_AMT, 0) - NVL(SCD.ACCT_CR_AMT, 0))" ).append("\n"); 
		query.append("             ELSE" ).append("\n"); 
		query.append("                 CASE" ).append("\n"); 
		query.append("                     WHEN (SCD.DTRB_SRC_TP_CD = 'REC') AND (SCD.CURR_CD <> SR.RCT_CURR_CD) THEN" ).append("\n"); 
		query.append("                         TO_NUMBER(SAR_GET_CUR_AMT_FNC(SR.RCT_CURR_CD, ABS(NVL(SCD.INP_DR_AMT, 0) - NVL(SCD.INP_CR_AMT, 0)) * SRA.OTS_TO_RCT_XCH_RT))" ).append("\n"); 
		query.append("                     ELSE" ).append("\n"); 
		query.append("                         ABS(NVL(SCD.INP_DR_AMT, 0) - NVL(SCD.INP_CR_AMT, 0))" ).append("\n"); 
		query.append("                 END" ).append("\n"); 
		query.append("        END            AS doc_amt    --12" ).append("\n"); 
		query.append("        ,sra.ots_to_rct_xch_rt" ).append("\n"); 
		query.append("        ,scd.conv_xch_rt" ).append("\n"); 
		query.append("       ,'' AS locl_tax_amt    --13" ).append("\n"); 
		query.append("       ,'' AS doc_tax_amt     --14" ).append("\n"); 
		query.append("       , CASE " ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'CASH' THEN  " ).append("\n"); 
		query.append("                 SUBSTR(SR.CHQ_NO,0,18)" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'REC'  THEN" ).append("\n"); 
		query.append("                 (SELECT NVL(A.ORG_INV_NO, SOC.BL_NO)" ).append("\n"); 
		query.append("                 FROM SAR_OTS_HDR A" ).append("\n"); 
		query.append("                 WHERE A.RHQ_CD = SOC.RHQ_CD" ).append("\n"); 
		query.append("                 AND A.OTS_OFC_CD = SOC.OTS_OFC_CD" ).append("\n"); 
		query.append("                 AND A.BL_NO = SOC.BL_NO" ).append("\n"); 
		query.append("                 AND A.INV_NO = SOC.INV_NO" ).append("\n"); 
		query.append("                 AND A.BL_NO = SOC.BL_NO)" ).append("\n"); 
		query.append("             ELSE" ).append("\n"); 
		query.append("                 REPLACE(SR.RCT_NO,'REC')" ).append("\n"); 
		query.append("         END             AS asgn_no    --15" ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD IN ('CASH', 'UNID', 'UNAPP', 'REC') THEN" ).append("\n"); 
		query.append("                 SR.RCT_OFC_CD||':'||(SELECT USR_NM " ).append("\n"); 
		query.append("                                      FROM   COM_USER" ).append("\n"); 
		query.append("                                      WHERE  USR_ID = SRA.CRE_USR_ID)        " ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD = 'RFD' THEN" ).append("\n"); 
		query.append("                 (SELECT AP_OFC_CD" ).append("\n"); 
		query.append("                  FROM   SAR_RCT_APLY_DTL SRAD" ).append("\n"); 
		query.append("                  WHERE  SRAD.RCT_APLY_DTL_SEQ = SRA.RCT_APLY_DTL_SEQ" ).append("\n"); 
		query.append("                  AND    SRAD.RCT_SEQ = SRA.RCT_SEQ)" ).append("\n"); 
		query.append("                 ||':'||(SELECT USR_NM " ).append("\n"); 
		query.append("                                      FROM   COM_USER" ).append("\n"); 
		query.append("                                      WHERE  USR_ID = SRA.CRE_USR_ID)" ).append("\n"); 
		query.append("             ELSE " ).append("\n"); 
		query.append("                  NULL" ).append("\n"); 
		query.append("         END             AS itm_desc   --16    " ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD IN ('CASH', 'UNAPP','UNID')) OR (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD = 'RFD') THEN" ).append("\n"); 
		query.append("                 SR.RCT_DPS_DT " ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD IN ('REC')) THEN" ).append("\n"); 
		query.append("                 SOHI.SAIL_DT" ).append("\n"); 
		query.append("             ELSE " ).append("\n"); 
		query.append("                 NULL" ).append("\n"); 
		query.append("         END             AS pln_dt   --17                                                   " ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD IN ('EXCH_GAIN', 'EXCH_LOSS', 'HDR_RND') THEN" ).append("\n"); 
		query.append("                 CASE " ).append("\n"); 
		query.append("                     WHEN SCD.FM_DTRB_SRC_SEQ IS NOT NULL THEN" ).append("\n"); 
		query.append("                      " ).append("\n"); 
		query.append("                         NVL(DECODE(SOHI.SVC_SCP_CD, 'OTH', NULL," ).append("\n"); 
		query.append("                             (SELECT MSS.MODI_COST_CTR_CD " ).append("\n"); 
		query.append("                              FROM   MDM_SVC_SCP MSS" ).append("\n"); 
		query.append("                              WHERE  MSS.SVC_SCP_CD =SOHI.SVC_SCP_CD)), " ).append("\n"); 
		query.append("                                NVL(DECODE((SELECT SSCC.TGT_CD " ).append("\n"); 
		query.append("                                            FROM   SCO_STMT_CD_CONV SSCC " ).append("\n"); 
		query.append("                                            WHERE  SSCC.CONV_TP_CD = 'GL ACCT OF PROFIT CENTER'" ).append("\n"); 
		query.append("                                            AND    SSCC.SRC_CD = MA.MODI_ACCT_CD " ).append("\n"); 
		query.append("                                            AND    SSCC.USE_FLG = 'Y' " ).append("\n"); 
		query.append("                                            AND    SSCC.DELT_FLG = 'N' " ).append("\n"); 
		query.append("                                            AND ROWNUM = 1), 'ZH', MO.MODI_COST_CTR_CD," ).append("\n"); 
		query.append("                                                                  (SELECT SSCC.TGT_CD " ).append("\n"); 
		query.append("                                                                   FROM   SCO_STMT_CD_CONV SSCC " ).append("\n"); 
		query.append("                                                                   WHERE  SSCC.CONV_TP_CD = 'GL ACCT OF PROFIT CENTER'" ).append("\n"); 
		query.append("                                                                   AND    SSCC.SRC_CD = MA.MODI_ACCT_CD " ).append("\n"); 
		query.append("                                                                   AND SSCC.USE_FLG = 'Y' " ).append("\n"); 
		query.append("                                                                   AND SSCC.DELT_FLG = 'N' " ).append("\n"); 
		query.append("                                                                   AND ROWNUM = 1)), 'A106') )" ).append("\n"); 
		query.append("                     ELSE" ).append("\n"); 
		query.append("                        'A106'" ).append("\n"); 
		query.append("                 END                      " ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF') AND (SRA.WRTF_TP_CD NOT IN ('RFD','WHT')) THEN             " ).append("\n"); 
		query.append("                  'A106'" ).append("\n"); 
		query.append("             --20160826 WHT 수정" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF') AND (SRA.WRTF_TP_CD ='WHT') THEN             " ).append("\n"); 
		query.append("                  'Z002'" ).append("\n"); 
		query.append("             ELSE" ).append("\n"); 
		query.append("                 NULL" ).append("\n"); 
		query.append("         END             AS cost_ctr_cd  --18 (추후 Code Conversion 필요)" ).append("\n"); 
		query.append("       ,'' AS ord_no                     --19" ).append("\n"); 
		query.append("       ,'' AS mn_aset_no                 --20" ).append("\n"); 
		query.append("       ,'' AS sub_aset_no                --21" ).append("\n"); 
		query.append("       ,'' AS aset_tj_tp_cd              --22  " ).append("\n"); 
		query.append("       ,'' AS aset_val_dt                --23        " ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'EXCH_GAIN') THEN" ).append("\n"); 
		query.append("                 '8225101000'  --GAIN" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'EXCH_LOSS' THEN" ).append("\n"); 
		query.append("                 '8325401000'  --LOSS" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'HDR_RND') THEN" ).append("\n"); 
		query.append("                 '7001000000'    " ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'WRTF' THEN" ).append("\n"); 
		query.append("                 CASE" ).append("\n"); 
		query.append("                     WHEN SRA.WRTF_TP_CD NOT IN ('RFD', 'WHT') THEN" ).append("\n"); 
		query.append("                         MA.MODI_ACCT_CD" ).append("\n"); 
		query.append("                     --20160826 WHT 수정" ).append("\n"); 
		query.append("                     WHEN SRA.WRTF_TP_CD = 'WHT' THEN" ).append("\n"); 
		query.append("                        '8705300000'" ).append("\n"); 
		query.append("                 END" ).append("\n"); 
		query.append("         END             AS gl_acct_no       --24  " ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'CASH' THEN" ).append("\n"); 
		query.append("                 CASE " ).append("\n"); 
		query.append("                     WHEN SR.RCT_CUST_CNT_CD is null THEN" ).append("\n"); 
		query.append("                          'SAP999999'" ).append("\n"); 
		query.append("                     WHEN SR.RCT_CUST_CNT_CD ='TB' THEN" ).append("\n"); 
		query.append("                            (SELECT 'G5'|| ML.CNT_CD || LPAD(TO_CHAR(MV.VNDR_SEQ),6, '0')" ).append("\n"); 
		query.append("                              FROM  MDM_VENDOR MV ," ).append("\n"); 
		query.append("                                    MDM_ORGANIZATION MO ," ).append("\n"); 
		query.append("                                    MDM_LOCATION ML" ).append("\n"); 
		query.append("                              WHERE  MV.OFC_CD = MO.OFC_CD(+)" ).append("\n"); 
		query.append("                              AND    MO.LOC_CD = ML.LOC_CD(+)" ).append("\n"); 
		query.append("                              AND    MV.RFND_PSDO_CUST_CD = SR.RCT_CUST_CNT_CD||TRIM(TO_CHAR(SR.RCT_CUST_SEQ, '000000')))" ).append("\n"); 
		query.append("                     ELSE " ).append("\n"); 
		query.append("                         'G1'||SR.RCT_CUST_CNT_CD||TRIM(TO_CHAR(SR.RCT_CUST_SEQ, '000000'))" ).append("\n"); 
		query.append("                 END" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'UNID' THEN" ).append("\n"); 
		query.append("                 'SAP999999'" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD IN ('UNAPP') THEN" ).append("\n"); 
		query.append("                   CASE " ).append("\n"); 
		query.append("                     WHEN SCD.CUST_CNT_CD ='TB' THEN" ).append("\n"); 
		query.append("                            (SELECT 'G5'|| ML.CNT_CD || LPAD(TO_CHAR(MV.VNDR_SEQ),6, '0')" ).append("\n"); 
		query.append("                              FROM  MDM_VENDOR MV ," ).append("\n"); 
		query.append("                                    MDM_ORGANIZATION MO ," ).append("\n"); 
		query.append("                                    MDM_LOCATION ML" ).append("\n"); 
		query.append("                              WHERE  MV.OFC_CD = MO.OFC_CD(+)" ).append("\n"); 
		query.append("                              AND    MO.LOC_CD = ML.LOC_CD(+)" ).append("\n"); 
		query.append("                              AND    MV.RFND_PSDO_CUST_CD = SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000')))" ).append("\n"); 
		query.append("                     ELSE " ).append("\n"); 
		query.append("                         'G1'||SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append("                     END" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD IN ('REC') THEN" ).append("\n"); 
		query.append("                   CASE " ).append("\n"); 
		query.append("                     WHEN SCD.CUST_CNT_CD ='TB' THEN" ).append("\n"); 
		query.append("                            (SELECT 'G5'|| ML.CNT_CD || LPAD(TO_CHAR(MV.VNDR_SEQ),6, '0')" ).append("\n"); 
		query.append("                              FROM  MDM_VENDOR MV ," ).append("\n"); 
		query.append("                                    MDM_ORGANIZATION MO ," ).append("\n"); 
		query.append("                                    MDM_LOCATION ML" ).append("\n"); 
		query.append("                              WHERE  MV.OFC_CD = MO.OFC_CD(+)" ).append("\n"); 
		query.append("                              AND    MO.LOC_CD = ML.LOC_CD(+)" ).append("\n"); 
		query.append("                              AND    MV.RFND_PSDO_CUST_CD = SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000')))" ).append("\n"); 
		query.append("                     ELSE " ).append("\n"); 
		query.append("                         CASE " ).append("\n"); 
		query.append("                              WHEN  (SELECT NVL(A.ORG_INV_NO, 'XX')" ).append("\n"); 
		query.append("                                     FROM SAR_OTS_HDR A" ).append("\n"); 
		query.append("                                     WHERE A.RHQ_CD = SOC.RHQ_CD" ).append("\n"); 
		query.append("                                     AND A.OTS_OFC_CD = SOC.OTS_OFC_CD" ).append("\n"); 
		query.append("                                     AND A.BL_NO = SOC.BL_NO" ).append("\n"); 
		query.append("                                     AND A.INV_NO = SOC.INV_NO" ).append("\n"); 
		query.append("                                     AND A.BL_NO = SOC.BL_NO) ='XX' THEN" ).append("\n"); 
		query.append("                                     " ).append("\n"); 
		query.append("                                   'G1'||SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append("                               ELSE" ).append("\n"); 
		query.append("                                   MC.MODI_CUST_CD" ).append("\n"); 
		query.append("                          END" ).append("\n"); 
		query.append("                   END" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD = 'RFD' THEN" ).append("\n"); 
		query.append("                   CASE " ).append("\n"); 
		query.append("                     WHEN SCD.CUST_CNT_CD ='TB' THEN" ).append("\n"); 
		query.append("                            (SELECT 'G5'|| ML.CNT_CD || LPAD(TO_CHAR(MV.VNDR_SEQ),6, '0')" ).append("\n"); 
		query.append("                              FROM  MDM_VENDOR MV ," ).append("\n"); 
		query.append("                                    MDM_ORGANIZATION MO ," ).append("\n"); 
		query.append("                                    MDM_LOCATION ML" ).append("\n"); 
		query.append("                              WHERE  MV.OFC_CD = MO.OFC_CD(+)" ).append("\n"); 
		query.append("                              AND    MO.LOC_CD = ML.LOC_CD(+)" ).append("\n"); 
		query.append("                              AND    MV.RFND_PSDO_CUST_CD = SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000')))" ).append("\n"); 
		query.append("                     ELSE " ).append("\n"); 
		query.append("                         'G1'||SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append("                   END" ).append("\n"); 
		query.append("             --20160826 WHT 수정" ).append("\n"); 
		query.append("             --WHEN SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD = 'WHT' AND SUBSTR(MO.FINC_RGN_CD, 1,2) <> '11' THEN             " ).append("\n"); 
		query.append("             --     MO.MODI_AGN_CD" ).append("\n"); 
		query.append("             ELSE" ).append("\n"); 
		query.append("                 NULL" ).append("\n"); 
		query.append("         END            AS cust_no          --25 (추후 Code Conversion 필요)" ).append("\n"); 
		query.append("       ,'' AS vndr_crtr_acct_no             --26" ).append("\n"); 
		query.append("       " ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             --20160826 WHT 수정" ).append("\n"); 
		query.append("             --WHEN (SCD.DTRB_SRC_TP_CD IN ('CASH', 'UNID', 'UNAPP', 'REC')) OR (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD IN ('WHT', 'RFD')) THEN" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD IN ('CASH', 'UNID', 'UNAPP', 'REC')) OR (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD = 'RFD') THEN" ).append("\n"); 
		query.append("                 SR.RCT_DPS_DT " ).append("\n"); 
		query.append("             ELSE" ).append("\n"); 
		query.append("                 NULL" ).append("\n"); 
		query.append("         END            AS due_dt_calc_bsel_dt      --27" ).append("\n"); 
		query.append("       ,CASE" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD IN ('CASH', 'UNID', 'UNAPP', 'REC') THEN" ).append("\n"); 
		query.append("                 (SELECT SUBSTR(SSC.TGT_CD,0,1)" ).append("\n"); 
		query.append("                  FROM   SCO_STMT_CD_CONV SSC" ).append("\n"); 
		query.append("                  WHERE  SSC.CONV_TP_CD = 'RECEIPT TYPE'" ).append("\n"); 
		query.append("                  AND    SSC.SRC_CD = SR.RCT_TP_CD)" ).append("\n"); 
		query.append("             ELSE" ).append("\n"); 
		query.append("                 NULL" ).append("\n"); 
		query.append("         END            AS pay_mzd_cd      --28   (Code Conversion 적용)" ).append("\n"); 
		query.append("       ,'' AS ste_cntrl_bank_ind_cd        --29" ).append("\n"); 
		query.append("       ,'' AS mtrl_no                      --30" ).append("\n"); 
		query.append("       ,'' AS fuel_land_qty                --31" ).append("\n"); 
		query.append("       ,'' AS meas_bse_ut_cd               --32" ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD IN ('EXCH_GAIN', 'EXCH_LOSS', 'HDR_RND') THEN" ).append("\n"); 
		query.append("                 CASE " ).append("\n"); 
		query.append("                     WHEN SCD.FM_DTRB_SRC_SEQ IS NOT NULL THEN" ).append("\n"); 
		query.append("                         NVL(DECODE(SOHI.SVC_SCP_CD, 'OTH', NULL," ).append("\n"); 
		query.append("                             (SELECT MSS.MODI_COST_CTR_CD " ).append("\n"); 
		query.append("                              FROM   MDM_SVC_SCP MSS" ).append("\n"); 
		query.append("                              WHERE  MSS.SVC_SCP_CD =SOHI.SVC_SCP_CD)), " ).append("\n"); 
		query.append("                                NVL(DECODE((SELECT SSCC.TGT_CD " ).append("\n"); 
		query.append("                                            FROM   SCO_STMT_CD_CONV SSCC " ).append("\n"); 
		query.append("                                            WHERE  SSCC.CONV_TP_CD = 'GL ACCT OF PROFIT CENTER'" ).append("\n"); 
		query.append("                                            AND    SSCC.SRC_CD = MA.MODI_ACCT_CD " ).append("\n"); 
		query.append("                                            AND    SSCC.USE_FLG = 'Y' " ).append("\n"); 
		query.append("                                            AND    SSCC.DELT_FLG = 'N' " ).append("\n"); 
		query.append("                                            AND ROWNUM = 1), 'ZH', MO.MODI_COST_CTR_CD," ).append("\n"); 
		query.append("                                                                  (SELECT SSCC.TGT_CD " ).append("\n"); 
		query.append("                                                                   FROM   SCO_STMT_CD_CONV SSCC " ).append("\n"); 
		query.append("                                                                   WHERE  SSCC.CONV_TP_CD = 'GL ACCT OF PROFIT CENTER'" ).append("\n"); 
		query.append("                                                                   AND    SSCC.SRC_CD = MA.MODI_ACCT_CD " ).append("\n"); 
		query.append("                                                                   AND SSCC.USE_FLG = 'Y' " ).append("\n"); 
		query.append("                                                                   AND SSCC.DELT_FLG = 'N' " ).append("\n"); 
		query.append("                                                                   AND ROWNUM = 1)), 'A106') )" ).append("\n"); 
		query.append("                     ELSE" ).append("\n"); 
		query.append("                          'A106'" ).append("\n"); 
		query.append("                 END                      " ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF') AND (SRA.WRTF_TP_CD NOT IN ('RFD','WHT')) THEN                 " ).append("\n"); 
		query.append("                  'A106'" ).append("\n"); 
		query.append("              --20160826 WHT 수정" ).append("\n"); 
		query.append("              WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF') AND (SRA.WRTF_TP_CD ='WHT') THEN                 " ).append("\n"); 
		query.append("              'Z002'" ).append("\n"); 
		query.append("             ELSE" ).append("\n"); 
		query.append("                 NULL" ).append("\n"); 
		query.append("         END            AS pfitctr_cd      --33" ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'CASH' THEN" ).append("\n"); 
		query.append("                 DECODE( SUBSTR(MO.FINC_RGN_CD, 1,2), '11', (SELECT TGT_CD" ).append("\n"); 
		query.append("                                                             FROM SCO_STMT_CD_CONV" ).append("\n"); 
		query.append("                                                             WHERE CONV_TP_CD = 'TEMP RECEIPT G/L'" ).append("\n"); 
		query.append("                                                             AND SRC_CD =( SELECT OPN_OFC_CD" ).append("\n"); 
		query.append("                                                                           FROM SAP_BANK_ACCT " ).append("\n"); 
		query.append("                                                                           WHERE BANK_ACCT_SEQ =SR.BANK_ACCT_SEQ)), '55495GT000')" ).append("\n"); 
		query.append("                " ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'UNID' THEN " ).append("\n"); 
		query.append("                 '55496GT000'" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'UNAPP' THEN" ).append("\n"); 
		query.append("                 '55497GT000'" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'REC' THEN" ).append("\n"); 
		query.append("                  MA.MODI_ACCT_CD" ).append("\n"); 
		query.append("            -- 20160826 WHT 수정" ).append("\n"); 
		query.append("            -- WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF') AND (SRA.WRTF_TP_CD = 'WHT') THEN" ).append("\n"); 
		query.append("            --     DECODE( SUBSTR(MO.FINC_RGN_CD, 1,2), '11', '', '5360000000')" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF') AND (SRA.WRTF_TP_CD = 'RFD') THEN" ).append("\n"); 
		query.append("                 '5400269050'" ).append("\n"); 
		query.append("         END            AS altn_acct_no   --34             " ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'CASH' THEN" ).append("\n"); 
		query.append("                 'Z002'" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'REC' THEN" ).append("\n"); 
		query.append("                  NVL(DECODE(SOHI.SVC_SCP_CD, 'OTH', NULL," ).append("\n"); 
		query.append("                       (SELECT MSS.MODI_COST_CTR_CD " ).append("\n"); 
		query.append("                        FROM   MDM_SVC_SCP MSS" ).append("\n"); 
		query.append("                        WHERE  MSS.SVC_SCP_CD =SOHI.SVC_SCP_CD)), " ).append("\n"); 
		query.append("                        NVL(DECODE((SELECT SSCC.TGT_CD " ).append("\n"); 
		query.append("                                    FROM   SCO_STMT_CD_CONV SSCC " ).append("\n"); 
		query.append("                                    WHERE  SSCC.CONV_TP_CD = 'GL ACCT OF PROFIT CENTER'" ).append("\n"); 
		query.append("                                    AND    SSCC.SRC_CD = MA.MODI_ACCT_CD " ).append("\n"); 
		query.append("                                    AND    SSCC.USE_FLG = 'Y' " ).append("\n"); 
		query.append("                                    AND    SSCC.DELT_FLG = 'N' " ).append("\n"); 
		query.append("                                    AND ROWNUM = 1), 'ZH', MO.MODI_COST_CTR_CD," ).append("\n"); 
		query.append("                                                          (SELECT SSCC.TGT_CD " ).append("\n"); 
		query.append("                                                           FROM   SCO_STMT_CD_CONV SSCC " ).append("\n"); 
		query.append("                                                           WHERE  SSCC.CONV_TP_CD = 'GL ACCT OF PROFIT CENTER'" ).append("\n"); 
		query.append("                                                           AND    SSCC.SRC_CD = MA.MODI_ACCT_CD " ).append("\n"); 
		query.append("                                                           AND SSCC.USE_FLG = 'Y' " ).append("\n"); 
		query.append("                                                           AND SSCC.DELT_FLG = 'N' " ).append("\n"); 
		query.append("                                                           AND ROWNUM = 1)), 'A106') )" ).append("\n"); 
		query.append("            " ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'UNID' THEN" ).append("\n"); 
		query.append("                 'A106'" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'UNAPP' THEN" ).append("\n"); 
		query.append("                 'A106'" ).append("\n"); 
		query.append("             --20160826 WHT 수정" ).append("\n"); 
		query.append("             --WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF') AND (SRA.WRTF_TP_CD = 'WHT') THEN" ).append("\n"); 
		query.append("             --    DECODE( SUBSTR(MO.FINC_RGN_CD, 1,2), '11', '', 'A106')" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF') AND (SRA.WRTF_TP_CD = 'RFD') THEN" ).append("\n"); 
		query.append("                 'A106'" ).append("\n"); 
		query.append("         END           AS biz_prnr_ref_key_cd1  --35 " ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD IN ('CASH', 'UNID', 'UNAPP', 'REC') THEN " ).append("\n"); 
		query.append("                 DECODE( SUBSTR(MO.FINC_RGN_CD, 1,2), '11', (SELECT TGT_CD" ).append("\n"); 
		query.append("                                                             FROM   SCO_STMT_CD_CONV" ).append("\n"); 
		query.append("                                                             WHERE  CONV_TP_CD = 'CASHIER PLACE CODE'" ).append("\n"); 
		query.append("                                                             AND    SRC_CD =( SELECT OPN_OFC_CD" ).append("\n"); 
		query.append("                                                                              FROM SAP_BANK_ACCT " ).append("\n"); 
		query.append("                                                                              WHERE BANK_ACCT_SEQ =SR.BANK_ACCT_SEQ)), 'GT')" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD = 'RFD') THEN" ).append("\n"); 
		query.append("                   DECODE( SUBSTR(MO.FINC_RGN_CD, 1,2), '11', '01','GT')" ).append("\n"); 
		query.append("             ELSE  " ).append("\n"); 
		query.append("                 NULL" ).append("\n"); 
		query.append("         END           AS biz_prnr_ref_key_cd2  --36" ).append("\n"); 
		query.append("       ,'' AS line_itm_ref_key_cd               --37" ).append("\n"); 
		query.append("       ,'' AS instr_key_cd1                     --38" ).append("\n"); 
		query.append("       ,'' AS instr_key_cd2                     --39" ).append("\n"); 
		query.append("       ,'' AS instr_key_cd3                     --40 " ).append("\n"); 
		query.append("      -- 20160826 WHT 수정" ).append("\n"); 
		query.append("      -- , CASE " ).append("\n"); 
		query.append("      --       WHEN SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD = 'WHT' AND SUBSTR(MO.FINC_RGN_CD, 1,2) <> '11' THEN" ).append("\n"); 
		query.append("      --          '35'" ).append("\n"); 
		query.append("      --       ELSE" ).append("\n"); 
		query.append("      --           ''" ).append("\n"); 
		query.append("      --   END          AS pay_ref_cd             --41" ).append("\n"); 
		query.append("       ,''  AS pay_ref_cd             --41" ).append("\n"); 
		query.append("        , ''      AS automtc_pay_curr_cd     --42" ).append("\n"); 
		query.append("       , ''         AS pay_curr_amt             --43" ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'CASH' THEN" ).append("\n"); 
		query.append("                   CASE " ).append("\n"); 
		query.append("                     WHEN SR.RCT_CUST_CNT_CD is null THEN" ).append("\n"); 
		query.append("                          'SAP999999'" ).append("\n"); 
		query.append("                     WHEN SR.RCT_CUST_CNT_CD ='TB' THEN" ).append("\n"); 
		query.append("                            (SELECT 'G5'|| ML.CNT_CD || LPAD(TO_CHAR(MV.VNDR_SEQ),6, '0')" ).append("\n"); 
		query.append("                              FROM  MDM_VENDOR MV ," ).append("\n"); 
		query.append("                                    MDM_ORGANIZATION MO ," ).append("\n"); 
		query.append("                                    MDM_LOCATION ML" ).append("\n"); 
		query.append("                              WHERE  MV.OFC_CD = MO.OFC_CD(+)" ).append("\n"); 
		query.append("                              AND    MO.LOC_CD = ML.LOC_CD(+)" ).append("\n"); 
		query.append("                              AND    MV.RFND_PSDO_CUST_CD = SR.RCT_CUST_CNT_CD||TRIM(TO_CHAR(SR.RCT_CUST_SEQ, '000000')))" ).append("\n"); 
		query.append("                     ELSE " ).append("\n"); 
		query.append("                         'G1'||SR.RCT_CUST_CNT_CD||TRIM(TO_CHAR(SR.RCT_CUST_SEQ, '000000'))" ).append("\n"); 
		query.append("                  END" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'UNID' THEN" ).append("\n"); 
		query.append("                 DECODE( SUBSTR(MO.FINC_RGN_CD, 1,2), '11', 'SAP999999', MO.MODI_AGN_CD)" ).append("\n"); 
		query.append("          " ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'REC' THEN" ).append("\n"); 
		query.append("                 CASE" ).append("\n"); 
		query.append("                     WHEN SUBSTR(MO.FINC_RGN_CD, 1,2) = '11' THEN" ).append("\n"); 
		query.append("                         CASE " ).append("\n"); 
		query.append("                            WHEN SCD.CUST_CNT_CD ='TB' THEN" ).append("\n"); 
		query.append("                                    (SELECT 'G5'|| ML.CNT_CD || LPAD(TO_CHAR(MV.VNDR_SEQ),6, '0')" ).append("\n"); 
		query.append("                                      FROM  MDM_VENDOR MV ," ).append("\n"); 
		query.append("                                            MDM_ORGANIZATION MO ," ).append("\n"); 
		query.append("                                            MDM_LOCATION ML" ).append("\n"); 
		query.append("                                      WHERE  MV.OFC_CD = MO.OFC_CD(+)" ).append("\n"); 
		query.append("                                      AND    MO.LOC_CD = ML.LOC_CD(+)" ).append("\n"); 
		query.append("                                      AND    MV.RFND_PSDO_CUST_CD = SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000')))" ).append("\n"); 
		query.append("                             ELSE " ).append("\n"); 
		query.append("                                 CASE " ).append("\n"); 
		query.append("                                      WHEN  (SELECT NVL(A.ORG_INV_NO, 'XX')" ).append("\n"); 
		query.append("                                             FROM SAR_OTS_HDR A" ).append("\n"); 
		query.append("                                             WHERE A.RHQ_CD = SOC.RHQ_CD" ).append("\n"); 
		query.append("                                             AND A.OTS_OFC_CD = SOC.OTS_OFC_CD" ).append("\n"); 
		query.append("                                             AND A.BL_NO = SOC.BL_NO" ).append("\n"); 
		query.append("                                             AND A.INV_NO = SOC.INV_NO" ).append("\n"); 
		query.append("                                             AND A.BL_NO = SOC.BL_NO) ='XX' THEN" ).append("\n"); 
		query.append("                                             " ).append("\n"); 
		query.append("                                           'G1'||SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append("                                       ELSE" ).append("\n"); 
		query.append("                                           MC.MODI_CUST_CD" ).append("\n"); 
		query.append("                                  END" ).append("\n"); 
		query.append("                          END" ).append("\n"); 
		query.append("                     ELSE" ).append("\n"); 
		query.append("                         (SELECT MO2.MODI_AGN_CD" ).append("\n"); 
		query.append("                          FROM   MDM_ORGANIZATION MO2" ).append("\n"); 
		query.append("                          WHERE  MO2.OFC_CD = SOHI.INV_OFC_CD)" ).append("\n"); 
		query.append("                     END" ).append("\n"); 
		query.append("             WHEN SCD.DTRB_SRC_TP_CD = 'UNAPP' THEN" ).append("\n"); 
		query.append("                 CASE" ).append("\n"); 
		query.append("                     WHEN SUBSTR(MO.FINC_RGN_CD, 1,2) = '11' THEN" ).append("\n"); 
		query.append("                         CASE " ).append("\n"); 
		query.append("                           WHEN SCD.CUST_CNT_CD ='TB' THEN" ).append("\n"); 
		query.append("                                    (SELECT 'G5'|| ML.CNT_CD || LPAD(TO_CHAR(MV.VNDR_SEQ),6, '0')" ).append("\n"); 
		query.append("                                      FROM  MDM_VENDOR MV ," ).append("\n"); 
		query.append("                                            MDM_ORGANIZATION MO ," ).append("\n"); 
		query.append("                                            MDM_LOCATION ML" ).append("\n"); 
		query.append("                                      WHERE  MV.OFC_CD = MO.OFC_CD(+)" ).append("\n"); 
		query.append("                                      AND    MO.LOC_CD = ML.LOC_CD(+)" ).append("\n"); 
		query.append("                                      AND    MV.RFND_PSDO_CUST_CD = SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000')))" ).append("\n"); 
		query.append("                             ELSE " ).append("\n"); 
		query.append("                                 'G1'||SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append("                          END" ).append("\n"); 
		query.append("                     ELSE    " ).append("\n"); 
		query.append("                         MO.MODI_AGN_CD" ).append("\n"); 
		query.append("                 END" ).append("\n"); 
		query.append("            --20160826 WHT 수정" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD = 'WHT') THEN" ).append("\n"); 
		query.append("                CASE " ).append("\n"); 
		query.append("                     WHEN SCD.CUST_CNT_CD ='TB' THEN" ).append("\n"); 
		query.append("                            (SELECT 'G5'|| ML.CNT_CD || LPAD(TO_CHAR(MV.VNDR_SEQ),6, '0')" ).append("\n"); 
		query.append("                              FROM  MDM_VENDOR MV ," ).append("\n"); 
		query.append("                                    MDM_ORGANIZATION MO ," ).append("\n"); 
		query.append("                                    MDM_LOCATION ML" ).append("\n"); 
		query.append("                              WHERE  MV.OFC_CD = MO.OFC_CD(+)" ).append("\n"); 
		query.append("                              AND    MO.LOC_CD = ML.LOC_CD(+)" ).append("\n"); 
		query.append("                              AND    MV.RFND_PSDO_CUST_CD = SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000')))" ).append("\n"); 
		query.append("                     ELSE " ).append("\n"); 
		query.append("                         'G1'||SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append("                  END" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD = 'RFD') THEN" ).append("\n"); 
		query.append("                 CASE" ).append("\n"); 
		query.append("                     WHEN SUBSTR(MO.FINC_RGN_CD, 1,2) = '11' THEN" ).append("\n"); 
		query.append("                         CASE " ).append("\n"); 
		query.append("                             WHEN SCD.CUST_CNT_CD ='TB' THEN" ).append("\n"); 
		query.append("                                    (SELECT 'G5'|| ML.CNT_CD || LPAD(TO_CHAR(MV.VNDR_SEQ),6, '0')" ).append("\n"); 
		query.append("                                      FROM  MDM_VENDOR MV ," ).append("\n"); 
		query.append("                                            MDM_ORGANIZATION MO ," ).append("\n"); 
		query.append("                                            MDM_LOCATION ML" ).append("\n"); 
		query.append("                                      WHERE  MV.OFC_CD = MO.OFC_CD(+)" ).append("\n"); 
		query.append("                                      AND    MO.LOC_CD = ML.LOC_CD(+)" ).append("\n"); 
		query.append("                                      AND    MV.RFND_PSDO_CUST_CD = SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000')))" ).append("\n"); 
		query.append("                             ELSE " ).append("\n"); 
		query.append("                                 'G1'||SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append("                          END" ).append("\n"); 
		query.append("                     ELSE" ).append("\n"); 
		query.append("                         (SELECT MO2.MODI_AGN_CD" ).append("\n"); 
		query.append("                          FROM  MDM_ORGANIZATION MO2" ).append("\n"); 
		query.append("                          WHERE    MO2.OFC_CD = (SELECT DISTINCT AP_OFC_CD" ).append("\n"); 
		query.append("                                                 FROM   SAR_RCT_APLY_DTL SRAD" ).append("\n"); 
		query.append("                                                 WHERE  SRAD.RCT_APLY_DTL_SEQ = SRA.RCT_APLY_DTL_SEQ)" ).append("\n"); 
		query.append("                         ) " ).append("\n"); 
		query.append("                 END " ).append("\n"); 
		query.append("             ELSE" ).append("\n"); 
		query.append("                  CASE " ).append("\n"); 
		query.append("                    WHEN SCD.CUST_CNT_CD ='TB' THEN" ).append("\n"); 
		query.append("                            (SELECT 'G5'|| ML.CNT_CD || LPAD(TO_CHAR(MV.VNDR_SEQ),6, '0')" ).append("\n"); 
		query.append("                              FROM  MDM_VENDOR MV ," ).append("\n"); 
		query.append("                                    MDM_ORGANIZATION MO ," ).append("\n"); 
		query.append("                                    MDM_LOCATION ML" ).append("\n"); 
		query.append("                              WHERE  MV.OFC_CD = MO.OFC_CD(+)" ).append("\n"); 
		query.append("                              AND    MO.LOC_CD = ML.LOC_CD(+)" ).append("\n"); 
		query.append("                              AND    MV.RFND_PSDO_CUST_CD = SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000')))" ).append("\n"); 
		query.append("                     ELSE " ).append("\n"); 
		query.append("                         'G1'||SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000'))" ).append("\n"); 
		query.append("                  END" ).append("\n"); 
		query.append("         END            AS ctrt_no              --44                           " ).append("\n"); 
		query.append("       , 'Z' AS ctrt_tp_cd                      --45" ).append("\n"); 
		query.append("       ,'' AS pay_rsn_cd                        --46" ).append("\n"); 
		query.append("       ,'' AS clss_cd                           --47" ).append("\n"); 
		query.append("       , CASE " ).append("\n"); 
		query.append("             --20160826 WHT 수정" ).append("\n"); 
		query.append("             --WHEN (SCD.DTRB_SRC_TP_CD IN ('EXCH_GAIN', 'EXCH_LOSS', 'HDR_RND')) " ).append("\n"); 
		query.append("             --  OR (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD NOT IN ('RFD', 'WHT')) THEN" ).append("\n"); 
		query.append("              WHEN (SCD.DTRB_SRC_TP_CD IN ('EXCH_GAIN', 'EXCH_LOSS', 'HDR_RND')) " ).append("\n"); 
		query.append("               OR (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD NOT IN ('RFD')) THEN" ).append("\n"); 
		query.append("                 (SELECT ML.MODI_LOC_CD" ).append("\n"); 
		query.append("                  FROM   MDM_LOCATION ML" ).append("\n"); 
		query.append("                  WHERE  ML.LOC_CD = MO.LOC_CD                                       " ).append("\n"); 
		query.append("                 )             " ).append("\n"); 
		query.append("             ELSE" ).append("\n"); 
		query.append("                 NULL                  " ).append("\n"); 
		query.append("        END             AS act_plc_cd          --48 (Code Conversion 적용)" ).append("\n"); 
		query.append("       ,'' AS entr_expn_id                     --49" ).append("\n"); 
		query.append("       ,'' AS bud_mgmt_div_cd                  --50" ).append("\n"); 
		query.append("       , CASE " ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD IN ('EXCH_GAIN', 'EXCH_LOSS', 'HDR_RND')) THEN" ).append("\n"); 
		query.append("                 SR.RCT_DT" ).append("\n"); 
		query.append("            --20160826 WHT 수정" ).append("\n"); 
		query.append("            -- WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD NOT IN ('RFD', 'WHT')) THEN" ).append("\n"); 
		query.append("            WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD NOT IN ('RFD')) THEN" ).append("\n"); 
		query.append("                 SRA.GL_DT" ).append("\n"); 
		query.append("             ELSE" ).append("\n"); 
		query.append("                 ''" ).append("\n"); 
		query.append("         END            AS act_dt             --51" ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD NOT IN ('RFD', 'WHT')) THEN" ).append("\n"); 
		query.append("                 (SELECT MODI_VSL_CD" ).append("\n"); 
		query.append("                  FROM   MDM_VSL_CNTR" ).append("\n"); 
		query.append("                  WHERE  VSL_CD = SUBSTR(SLC.SGM_CTNT6, 1, 4) ) " ).append("\n"); 
		query.append("             ELSE" ).append("\n"); 
		query.append("                 ''" ).append("\n"); 
		query.append("         END            AS vsl_cd            --52" ).append("\n"); 
		query.append("       , CASE" ).append("\n"); 
		query.append("             WHEN (SCD.DTRB_SRC_TP_CD = 'WRTF' AND SRA.WRTF_TP_CD NOT IN ('RFD', 'WHT')) THEN" ).append("\n"); 
		query.append("                  ''" ).append("\n"); 
		query.append("         ELSE" ).append("\n"); 
		query.append("             ''" ).append("\n"); 
		query.append("         END    AS vvl_Cd                   --53" ).append("\n"); 
		query.append("       ,DECODE(SCD.DTRB_SRC_TP_CD, 'CASH',  SUBSTR(SBA.BANK_ACCT_NM,0,5), '') AS hus_bank_id  --54" ).append("\n"); 
		query.append("       ,'' AS pay_blck_key_cd               --55" ).append("\n"); 
		query.append("       ,SCD.DTRB_SRC_TP_CD     AS  rec_tp_cd" ).append("\n"); 
		query.append("       ,SCD.CLT_DTRB_SEQ " ).append("\n"); 
		query.append("       ,SCD.DTRB_SRC_SEQ       " ).append("\n"); 
		query.append("       ,SRA.RCT_APLY_DTL_SEQ" ).append("\n"); 
		query.append("       ,SOHI.SVC_SCP_CD" ).append("\n"); 
		query.append("       ,ma.modi_acct_cd" ).append("\n"); 
		query.append("       ,DECODE(trim(scd.rvs_src_seq),null,'N','Y') AS rvs_flg " ).append("\n"); 
		query.append("       ,SCD.CRE_USR_ID" ).append("\n"); 
		query.append("	   ,SCD.UPD_USR_ID" ).append("\n"); 
		query.append("     ,SCD.CONV_XCH_RT  AS XCH_RT --20160826 추가" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("FROM   SAR_RECEIPT     SR,      " ).append("\n"); 
		query.append("       SAP_BANK_ACCT   SBA," ).append("\n"); 
		query.append("       SAR_RCV_APPL    SRA," ).append("\n"); 
		query.append("       SAR_CLT_DTRB    SCD," ).append("\n"); 
		query.append("       SAR_OTS_HIS     SOHI," ).append("\n"); 
		query.append("       SAR_OTS_CHG     SOC," ).append("\n"); 
		query.append("       SCO_LEGR_CD_CMB SLC," ).append("\n"); 
		query.append("       MDM_CUSTOMER    MC," ).append("\n"); 
		query.append("       MDM_ORGANIZATION MO," ).append("\n"); 
		query.append("       MDM_ACCOUNT MA," ).append("\n"); 
		query.append("       (SELECT SLD.LU_CD CURR_CD" ).append("\n"); 
		query.append("        FROM   SCO_LU_HDR SLH," ).append("\n"); 
		query.append("               SCO_LU_DTL SLD" ).append("\n"); 
		query.append("        WHERE SLH.LU_APPL_CD ='SCO'" ).append("\n"); 
		query.append("        AND   SLH.LU_TP_CD ='FUNCTIONAL CURRENCY'" ).append("\n"); 
		query.append("        AND   SLH.LU_TP_CD = SLD.LU_TP_CD) FUNC       " ).append("\n"); 
		query.append("WHERE  SR.RCT_SEQ = SRA.RCT_SEQ " ).append("\n"); 
		query.append("AND    SR.BANK_ACCT_SEQ = SBA.BANK_ACCT_SEQ" ).append("\n"); 
		query.append("AND    SRA.RCV_APPL_SEQ = SCD.DTRB_SRC_SEQ" ).append("\n"); 
		query.append("AND    SRA.OTS_HIS_SEQ = SOC.OTS_HIS_SEQ(+)" ).append("\n"); 
		query.append("AND    SRA.CHG_TP_CD = SOC.CHG_TP_CD(+)" ).append("\n"); 
		query.append("AND    SOC.OTS_HIS_SEQ = SOHI.OTS_HIS_SEQ(+)" ).append("\n"); 
		query.append("AND    SCD.DTRB_CD_CMB_SEQ = SLC.CD_CMB_SEQ" ).append("\n"); 
		query.append("AND    SCD.CUST_CNT_CD = MC.CUST_CNT_CD(+)" ).append("\n"); 
		query.append("AND    SCD.CUST_SEQ = MC.CUST_SEQ(+)" ).append("\n"); 
		query.append("AND    SLC.SGM_CTNT4 = MA.ACCT_CD" ).append("\n"); 
		query.append("AND    SR.RCT_OFC_CD = MO.OFC_CD" ).append("\n"); 
		query.append("AND    NVL(SCD.ACCT_DR_AMT, 0) - NVL(SCD.ACCT_CR_AMT, 0) + NVL(SCD.INP_DR_AMT, 0) - NVL(SCD.INP_CR_AMT, 0) <> 0" ).append("\n"); 
		query.append("AND    SCD.DTRB_SRC_TBL_CD = 'RCT'" ).append("\n"); 
		query.append("#if (${rct_no} != '' )" ).append("\n"); 
		query.append("AND    SR.RCT_NO = @[rct_no]" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("AND    SCD.AR_IF_STS_CD = @[check_status]" ).append("\n"); 
		query.append("#if (${grp_yn} == 'Y' )" ).append("\n"); 
		query.append(") GROUP BY" ).append("\n"); 
		query.append(" IF_SEQ_NO" ).append("\n"); 
		query.append(",ACCT_CO_CD" ).append("\n"); 
		query.append(",IF_DOC_TP_CD" ).append("\n"); 
		query.append(",DOC_DT" ).append("\n"); 
		query.append(",PST_DT" ).append("\n"); 
		query.append(",REF_DOC_NO" ).append("\n"); 
		query.append(",DOC_HDR_CD" ).append("\n"); 
		query.append(",CURR_CD" ).append("\n"); 
		query.append(",TAX_CALC_AUTO_FLG" ).append("\n"); 
		query.append(",DECODE(REC_TP_CD, 'REC', 'XX', PST_KEY_CD) --20160722" ).append("\n"); 
		query.append(",VAT_TAX_CD" ).append("\n"); 
		query.append(",ASGN_NO" ).append("\n"); 
		query.append(",ITM_DESC" ).append("\n"); 
		query.append(",PLN_DT" ).append("\n"); 
		query.append(",COST_CTR_CD" ).append("\n"); 
		query.append(",ORD_NO" ).append("\n"); 
		query.append(",MN_ASET_NO" ).append("\n"); 
		query.append(",SUB_ASET_NO" ).append("\n"); 
		query.append(",ASET_TJ_TP_CD" ).append("\n"); 
		query.append(",ASET_VAL_DT" ).append("\n"); 
		query.append(",GL_ACCT_NO" ).append("\n"); 
		query.append(",CUST_NO" ).append("\n"); 
		query.append(",VNDR_CRTR_ACCT_NO" ).append("\n"); 
		query.append(",DUE_DT_CALC_BSEL_DT" ).append("\n"); 
		query.append(",PAY_MZD_CD" ).append("\n"); 
		query.append(",STE_CNTRL_BANK_IND_CD" ).append("\n"); 
		query.append(",MTRL_NO" ).append("\n"); 
		query.append(",FUEL_LAND_QTY" ).append("\n"); 
		query.append(",MEAS_BSE_UT_CD" ).append("\n"); 
		query.append(",PFITCTR_CD" ).append("\n"); 
		query.append(",ALTN_ACCT_NO" ).append("\n"); 
		query.append(",BIZ_PRNR_REF_KEY_CD1" ).append("\n"); 
		query.append(",BIZ_PRNR_REF_KEY_CD2" ).append("\n"); 
		query.append(",LINE_ITM_REF_KEY_CD" ).append("\n"); 
		query.append(",INSTR_KEY_CD1" ).append("\n"); 
		query.append(",INSTR_KEY_CD2" ).append("\n"); 
		query.append(",INSTR_KEY_CD3" ).append("\n"); 
		query.append(",PAY_REF_CD" ).append("\n"); 
		query.append(",AUTOMTC_PAY_CURR_CD" ).append("\n"); 
		query.append(",PAY_CURR_AMT" ).append("\n"); 
		query.append(",CTRT_NO" ).append("\n"); 
		query.append(",CTRT_TP_CD" ).append("\n"); 
		query.append(",PAY_RSN_CD" ).append("\n"); 
		query.append(",CLSS_CD" ).append("\n"); 
		query.append(",ACT_PLC_CD" ).append("\n"); 
		query.append(",ENTR_EXPN_ID" ).append("\n"); 
		query.append(",BUD_MGMT_DIV_CD" ).append("\n"); 
		query.append(",ACT_DT" ).append("\n"); 
		query.append(",VSL_CD" ).append("\n"); 
		query.append(",VVL_CD" ).append("\n"); 
		query.append(",HUS_BANK_ID" ).append("\n"); 
		query.append(",PAY_BLCK_KEY_CD" ).append("\n"); 
		query.append(",REC_TP_CD" ).append("\n"); 
		query.append(",RVS_FLG" ).append("\n"); 
		query.append(",CRE_USR_ID" ).append("\n"); 
		query.append(",UPD_USR_ID" ).append("\n"); 
		query.append(",XCH_RT --20160826 추가" ).append("\n"); 
		query.append(" ORDER BY IF_SEQ_NO,RVS_FLG )" ).append("\n"); 
		query.append("#end" ).append("\n"); 

	}
}