<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableAgentDBDAOSearchASARemittanceDrCrAmtRSQL">
			<desc><![CDATA[select receipt & refund adjust]]></desc>
			<sql><![CDATA[
SELECT SUM(DECODE(DR_CR,'D', AMT)) AS DEBIT_AMT  
         , SUM(DECODE(DR_CR,'C', AMT)) AS CREDIT_AMT
     FROM (
        SELECT NVL(SUM(C.OTS_APLY_AMT),0) AS AMT 
            , 'D' DR_CR    
        FROM  SAR_RECEIPT A
            , SAR_RCT_APLY_HDR   B
            , SAR_RCT_APLY_DTL   C     
        WHERE 1 =1
        AND A.ASA_NO = @[asa_no]
        AND NVL(B.RVS_FLG,'N') <> 'Y'
        AND A.RCT_CXL_RSN_CD IS NULL
        AND A.RCT_SEQ = B.RCT_SEQ
        AND B.RCT_APLY_HDR_SEQ = C.RCT_APLY_HDR_SEQ
        AND B.RCT_SEQ = C.RCT_SEQ  
        UNION ALL
        SELECT NVL(SUM(B.ADJ_AMT),0) AS AMT   -- adjust plus amount(refund, reverse)
            , 'C' DR_CR    
        FROM SAR_ADJ_HDR   A, 
             SAR_ADJ_DTL   B     
        WHERE 1 =1 
        AND A.OTS_ADJ_SEQ = B.OTS_ADJ_SEQ
        AND A.ASA_NO = @[asa_no]
        AND B.ADJ_TP_CD = 'RFD'
        AND NVL(A.RVS_FLG,'N') <> 'Y'
    ) A			]]></sql>
			<params>
				<param name="asa_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
