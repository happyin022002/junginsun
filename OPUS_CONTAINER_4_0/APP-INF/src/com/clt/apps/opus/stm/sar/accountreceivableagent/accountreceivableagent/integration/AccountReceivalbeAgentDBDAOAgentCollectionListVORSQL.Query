<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivalbeAgentDBDAOAgentCollectionListVORSQL">
			<desc><![CDATA[Agent Collection Entry]]></desc>
			<sql><![CDATA[
SELECT  
@[asa_no1]||@[asa_no2]||@[asa_no3]          ASA_NO           
,SOH.BL_NO                                  BL_NO                        
,SOD.CHG_TP_CD                              CHG_TP_CD 
,5                                          ASA_CLT_SEQ
,SOH.OTS_OFC_CD                             AR_OFC_CD      
,SOH.VSL_CD||SOH.SKD_VOY_NO ||SOH.DIR_CD    VVD_CD     
,DECODE(SOH.BKG_IO_BND_CD, 'O', SOH.POL_CD 
                         , 'I', SOH.POD_CD) PORT_CD          
,'C'                                        ASA_TP_CD
,''                                         USD_AMT         
,TO_CHAR(TO_DATE(SOH.DUE_DT,'YYYYMMDD')
                           ,'YYYY-MM-DD')   DUE_DT
,1                                          ASA_XCH_RT1     
,''                                         EQV_LOCL_AMT  	
,''                                         LOCL_AMT        
,''                                         ASA_XCH_RT2     
,''                                         CHG_USD_AMT          
,SOD.BAL_LOCL_AMT                           TTL_AMT
,'TEST'                                     ASA_RMK 
,SOH.OTS_OFC_CD                             AGN_CD
,SOH.SVC_SCP_CD                             SVC_SCP_CD 
,''                                         EFF_DT
,SOH.BKG_IO_BND_CD                          IB_OB_CD 
,@[asa_curr_cd]                             ASA_CURR_CD 
,SOS.GL_DT                                  GL_YRMON 
,SOD.BL_CURR_CD                             LOCL_CURR_CD
,SOH.SAIL_ARR_DT                            SAIL_ARR_DT
,SOH.CRE_USR_ID	                            CRE_USR_ID 
,SOH.CRE_DT                                 CRE_DT
,SOH.UPD_USR_ID                             UPD_USR_ID
,SOH.UPD_DT                                 UPD_DT

,'' N3RD_CURR_CD1   ,'' N3RD_AMT1     	,'' N3RD_CURR_CD2   ,'' N3RD_AMT2       ,'' N3RD_CURR_CD3             
,'' N3RD_AMT3       ,'' N3RD_CURR_CD4 	,'' N3RD_AMT4       ,'' N3RD_XCH_RT1    ,'' N3RD_XCH_RT2             

,'' N3RD_XCH_RT3    ,'' N3RD_XCH_RT4  	,'' EQV_LOCL_AMT2   ,'' N3RD_LOCL_AMT1  ,'' N3RD_LOCL_AMT2           
,'' N3RD_LOCL_AMT3  ,'' N3RD_LOCL_AMT4	

        
,'' OPTION1      ,'' OPTION2        ,'' ASA_NO1      ,'' ASA_NO2      ,'' ASA_NO3
,'' BND          ,'' GL_YRMON_FM	,'' GL_YRMON_TO	 ,'' DUE_DT_FM	  ,'' DUE_DT_TO

FROM SAR_OTS_HDR SOH, 
     SAR_OTS_DTL SOD,
     SAR_OTS_HIS SOS,
     MDM_CUSTOMER MC, 
     MDM_CR_CUST MCC
WHERE SOH.RHQ_CD            = SOD.RHQ_CD
AND SOH.RHQ_CD              = SOS.RHQ_CD
AND SOH.OTS_OFC_CD          = SOD.OTS_OFC_CD
AND SOH.OTS_OFC_CD          = SOS.OTS_OFC_CD
AND SOH.BL_NO               = SOD.BL_NO 
AND SOH.BL_NO               = SOS.BL_NO 
AND SOH.INV_NO              = SOD.INV_NO
AND SOH.INV_NO              = SOS.INV_NO
AND SOD.BL_CURR_CD          = SOS.CURR_CD
AND SOH.BIL_TO_CUST_CNT_CD  = MC.CUST_CNT_CD
AND SOH.BIL_TO_CUST_SEQ     = MC.CUST_SEQ  
AND MC.CUST_CNT_CD          = MCC.CUST_CNT_CD  (+)
AND MC.CUST_SEQ             = MCC.CUST_SEQ  (+)
AND SOH.OTS_OFC_CD          = NVL(@[ar_ofc_cd],SOH.OTS_OFC_CD)
AND SOS.GL_DT              <= NVL(SUBSTR(REPLACE(@[gl_yrmon_to],'-',''),1,6),SOS.GL_DT)
AND 'C'                     = NVL(@[option1],'C')
AND SOH.BL_NO               = NVL(@[bl_no],SOH.BL_NO)

#if (${option2} == 'V' )       
    #if ( ${bnd} != 'ALL'  ) 
       AND SOH.BKG_IO_BND_CD  =  @[bnd] 
    #end
    
    #if ( ${vvd_cd} != '' )
       AND SOH.VSL_CD||SOH.SKD_VOY_NO ||SOH.DIR_CD = @[vvd_cd]
    #end  
    
    #if ( ${svc_scp_cd} != '' )
      AND SOH.SVC_SCP_CD = @[svc_scp_cd]
    #end  
    
    #if ( ${port_cd} != '' )
      AND DECODE(SOH.BKG_IO_BND_CD, 'O', SOH.POL_CD, 'I', SOH.POD_CD) = @[port_cd]
    #end  
    
#elseif ( ${option2} == 'D' )
    
    #if ( ${due_dt_fm} != '' )
         AND SOH.DUE_DT >=  REPLACE(@[due_dt_fm],'-','')       
    #end                   
    #if ( ${due_dt_to} != '' )
         AND SOH.DUE_DT <=  REPLACE(@[due_dt_to],'-','')       
    #end                           
    
#end			]]></sql>
			<params>
				<param name="asa_no1" type="12" value="" out="N"/>
				<param name="asa_no2" type="12" value="" out="N"/>
				<param name="asa_no3" type="12" value="" out="N"/>
				<param name="asa_curr_cd" type="12" value="" out="N"/>
				<param name="ar_ofc_cd" type="12" value="" out="N"/>
				<param name="gl_yrmon_to" type="12" value="" out="N"/>
				<param name="option1" type="12" value="" out="N"/>
				<param name="bl_no" type="12" value="" out="N"/>
				<param name="bnd" type="12" value="" out="N"/>
				<param name="vvd_cd" type="12" value="" out="N"/>
				<param name="svc_scp_cd" type="12" value="" out="N"/>
				<param name="port_cd" type="12" value="" out="N"/>
				<param name="due_dt_fm" type="12" value="" out="N"/>
				<param name="due_dt_to" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
