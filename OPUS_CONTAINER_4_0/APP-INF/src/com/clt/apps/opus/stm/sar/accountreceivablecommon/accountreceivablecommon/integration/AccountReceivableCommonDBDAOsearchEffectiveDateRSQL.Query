<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableCommonDBDAOsearchEffectiveDateRSQL">
			<desc><![CDATA[결산일자 조회]]></desc>
			<sql><![CDATA[
select  DECODE( substr(replace(@[eff_dt],'-',''),1,6)||'01', new_eff_dt, replace(@[eff_dt],'-',''), new_eff_dt) new_eff_dt
from ( select nvl(MAX(decode(gubn,'OFC', new_eff_dt,'')), 
                  nvl(MAX(decode(gubn,'RHQ', new_eff_dt,'')),'')) new_eff_dt     
       from 
           (  SELECT 'OFC' gubn, MIN(EFF_YRMON)||'01' as new_eff_dt
              FROM   AP_PERIOD
              WHERE  SYS_DIV_CD = @[sys_div_cd]
              AND    CLZ_STS_CD ='O'
              AND    OFC_CD =  @[ofc_cd]
              AND    AR_AP_DIV_CD = @[ar_ap_div_cd]
              AND    EFF_YRMON >= substr(replace(@[eff_dt],'-',''),1,6)
              HAVING MIN(EFF_YRMON) IS NOT NULL 
              UNION ALL
              SELECT 'RHQ' gubn, MIN(EFF_YRMON)||'01' as new_eff_dt
              FROM   AP_PERIOD
              WHERE  SYS_DIV_CD = @[sys_div_cd]
              AND    CLZ_STS_CD ='O'
              AND    OFC_CD = (select AR_HD_QTR_OFC_CD
                      from   MDM_ORGANIZATION
                      where  ofc_cd =  @[ofc_cd])
              AND    AR_AP_DIV_CD = @[ar_ap_div_cd]
              AND    EFF_YRMON >= substr(replace(@[eff_dt],'-',''),1,6)
              HAVING MIN(EFF_YRMON) IS NOT NULL ))			]]></sql>
			<params>
				<param name="eff_dt" type="12" value="" out="N"/>
				<param name="sys_div_cd" type="12" value="" out="N"/>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="ar_ap_div_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
