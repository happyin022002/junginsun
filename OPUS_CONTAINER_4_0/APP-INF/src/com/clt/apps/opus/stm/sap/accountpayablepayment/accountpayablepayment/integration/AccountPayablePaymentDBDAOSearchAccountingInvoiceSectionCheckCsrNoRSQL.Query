<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountPayablePaymentDBDAOSearchAccountingInvoiceSectionCheckCsrNoRSQL">
			<desc><![CDATA[Accounting 처리시 CSR No별로 하는 경우 해당 Invoice의 구분 값으로 Invoice만 처리 할지 Apply까지 모두 처리 할지 여부를 판단]]></desc>
			<sql><![CDATA[
SELECT  CASE WHEN (SELECT COUNT(SID.LINE_TP_LU_CD) FROM SAP_INV_DTL SID WHERE SID.INV_SEQ = SIH.INV_SEQ AND SID.LINE_TP_LU_CD = 'PREPAY') = 0 THEN 
             'INVOICE'
             WHEN (SELECT COUNT(SID.LINE_TP_LU_CD) FROM SAP_INV_DTL SID WHERE SID.INV_SEQ = SIH.INV_SEQ AND SID.LINE_TP_LU_CD = 'PREPAY') > 0 
             AND  (SELECT COUNT(SID.LINE_TP_LU_CD) FROM SAP_INV_DTL SID WHERE SID.INV_SEQ = SIH.INV_SEQ AND SID.LINE_TP_LU_CD <> 'PREPAY' AND NVL(SID.ACCTG_PST_FLG, 'N') <> 'Y') = 0 THEN
             'PREPAY' 
             WHEN (SELECT COUNT(SID.LINE_TP_LU_CD) FROM SAP_INV_DTL SID WHERE SID.INV_SEQ = SIH.INV_SEQ AND SID.LINE_TP_LU_CD = 'PREPAY') > 0 
             AND  (SELECT COUNT(SID.LINE_TP_LU_CD) FROM SAP_INV_DTL SID WHERE SID.INV_SEQ = SIH.INV_SEQ AND SID.LINE_TP_LU_CD <> 'PREPAY' AND NVL(SID.ACCTG_PST_FLG, 'N') <> 'Y') > 0 THEN
             'ALL' ELSE 'INVOICE' END AS INV_STATUS 
FROM    SAP_INV_HDR SIH
WHERE   SIH.INV_NO = @[inv_no]
			]]></sql>
			<params>
				<param name="inv_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
