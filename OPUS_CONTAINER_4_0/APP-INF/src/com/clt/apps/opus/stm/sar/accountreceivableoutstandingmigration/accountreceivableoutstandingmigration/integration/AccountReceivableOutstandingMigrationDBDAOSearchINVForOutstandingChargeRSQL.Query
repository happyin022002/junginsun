<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableOutstandingMigrationDBDAOSearchINVForOutstandingChargeRSQL">
			<desc><![CDATA[Outstanding Charge를 생성하기 위한 Invoice 정보를 select]]></desc>
			<sql><![CDATA[
SELECT  C.AR_HD_QTR_OFC_CD RHQ_CD
      , DECODE(NVL(E.OTS_CD, 'ARO'), 'COU', E.REP_OTS_OFC_CD, A.AR_OFC_CD) OTS_OFC_CD
      , A.BL_SRC_NO BL_NO
      , DECODE(D.OTS_SMRY_CD, 'INV', NVL(A.INV_NO, '**********'), '**********') INV_NO
      , B.CURR_CD BL_CURR_CD
      , B.CHG_CD CHG_TP_CD
      , NVL(SUM(B.CHG_AMT), 0) BAL_AMT
      , A.AR_IF_NO||B.AR_IF_SER_NO IF_NO
      , NVL(SUM(B.CHG_AMT), 0) INV_AMT
      , F.TJ_SRC_NM
      , A.GL_EFF_DT GL_DT
      , A.UPD_USR_ID CRE_USR_ID
      , A.UPD_USR_ID
FROM    OPUSADM_TMP.INV_AR_MN A
      , OPUSADM_TMP.INV_AR_CHG B
      , MDM_ORGANIZATION C
      , INV_AR_STUP_OFC D
      , SCO_OFC_INFO E
      , OPUSADM_TMP.INV_AR_AMT F
WHERE   A.AR_IF_NO = B.AR_IF_NO
AND     B.AR_IF_NO = F.AR_IF_NO
AND     B.AR_IF_SER_NO = F.AR_IF_SER_NO
AND     A.AR_OFC_CD = C.OFC_CD
AND     A.AR_OFC_CD = D.AR_OFC_CD(+)
AND     A.AR_OFC_CD = E.OFC_CD(+)
AND     D.DELT_FLG(+) = 'N'
AND     A.AR_IF_NO = @[if_no]
GROUP   BY C.AR_HD_QTR_OFC_CD
      , E.OTS_CD
      , E.REP_OTS_OFC_CD
      , A.AR_OFC_CD
      , A.BL_SRC_NO
      , D.OTS_SMRY_CD
      , A.INV_NO
      , B.CURR_CD
      , B.CHG_CD 
      , A.AR_IF_NO 
      , B.AR_IF_SER_NO
      , F.TJ_SRC_NM
      , A.GL_EFF_DT
      , A.UPD_USR_ID
ORDER   BY B.AR_IF_SER_NO
      , B.CHG_CD			]]></sql>
			<params>
				<param name="if_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
