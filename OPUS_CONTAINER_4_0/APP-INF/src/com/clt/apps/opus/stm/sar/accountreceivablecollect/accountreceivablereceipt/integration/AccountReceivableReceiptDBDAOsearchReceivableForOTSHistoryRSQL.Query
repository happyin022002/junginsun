<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableReceiptDBDAOsearchReceivableForOTSHistoryRSQL">
			<desc><![CDATA[OTS History 반영대상 Receivable 정보 조회]]></desc>
			<sql><![CDATA[
SELECT B.IF_NO
    , B.RHQ_CD
    , B.OTS_OFC_CD
    , B.BL_NO
    , B.INV_NO
    , B.CURR_CD
    , DECODE(A.RCV_APPL_TP_CD, 'RECEIPT', DECODE(C.RCT_TP_CD, 'OFF', 'RCTOFF', 'RCT'), DECODE(C.RCT_TP_CD, 'OFF', 'RCTOFFR', 'RCTR')) OTS_HIS_TP_CD
    , B.OTS_SRC_CD
    , A.GL_DT
    , NVL(SUM(A.APLY_AMT), 0) * (-1) OTS_AMT
    , C.RCT_NO REF_NO
    , C.RCT_OFC_CD INV_OFC_CD
    , B.OTS_RMK
    , A.CRE_USR_ID
    , A.UPD_USR_ID
    , B.SHP_TO_CUST_CNT_CD
    , B.SHP_TO_CUST_SEQ
    , B.BIL_TO_CUST_CNT_CD
    , B.BIL_TO_CUST_SEQ
    , B.VSL_CD
    , B.SKD_VOY_NO
    , B.DIR_CD
    , B.SVC_SCP_CD
    , B.XCH_RT_TP_CD
    , B.LOCL_XCH_RT
    , B.USD_XCH_RT
    , B.BKG_IO_BND_CD
    , B.XCH_RT_DT
    , B.POL_CD
    , B.POD_CD    
	, B.REV_TP_SRC_CD
	, B.REV_VVD_CD
FROM SAR_RCV_APPL A,
     SAR_OTS_HIS B,
	 SAR_RECEIPT C,
	 SAR_RCV_APPL_SEQ_TMP D
WHERE A.OTS_HIS_SEQ = B.OTS_HIS_SEQ
AND A.RCT_SEQ = C.RCT_SEQ
AND A.RCV_APPL_SEQ = D.RCV_APPL_SEQ
GROUP BY B.IF_NO
    , B.RHQ_CD
    , B.OTS_OFC_CD
    , B.BL_NO
    , B.INV_NO
    , B.CURR_CD
    , A.RCV_APPL_TP_CD
	, C.RCT_TP_CD
    , B.OTS_SRC_CD
    , A.GL_DT
    , C.RCT_NO
    , C.RCT_OFC_CD
    , B.OTS_RMK
    , A.CRE_USR_ID
    , A.UPD_USR_ID
    , B.SHP_TO_CUST_CNT_CD
    , B.SHP_TO_CUST_SEQ
    , B.BIL_TO_CUST_CNT_CD
    , B.BIL_TO_CUST_SEQ
    , B.VSL_CD
    , B.SKD_VOY_NO
    , B.DIR_CD
    , B.SVC_SCP_CD
    , B.XCH_RT_TP_CD
    , B.LOCL_XCH_RT
    , B.USD_XCH_RT
    , B.BKG_IO_BND_CD
    , B.XCH_RT_DT
    , B.POL_CD
    , B.POD_CD
	, B.REV_TP_SRC_CD
	, B.REV_VVD_CD
    , B.OTS_HIS_SEQ
ORDER BY B.OTS_HIS_SEQ			]]></sql>
			<params>
			</params>
		</query>
	</querys>
</sqls>
