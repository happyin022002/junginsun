<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="StatementCommonDBDAOSearchAcclJobStatusRSQL">
			<desc><![CDATA[SearchAcclJobStatus]]></desc>
			<sql><![CDATA[
SELECT
        EXEC_STATUS
FROM
(
    SELECT  ROW_NUMBER() OVER (ORDER BY TMP_SEQ) AS ROW_SEQ
        ,   AA.*
    FROM
    (
        SELECT  1 AS TMP_SEQ
            ,   DECODE(AA.ATTR_CTNT3, 'START','Running', 'END','Completed', 'Error') AS EXEC_STATUS
        FROM
        (
            SELECT  DENSE_RANK() OVER (PARTITION BY PGM_APPL_NM, SRC_MDL_CD, ERR_DESC, EXE_YRMON ORDER BY ATTR_CTNT1 DESC, ATTR_CTNT2 DESC) AS LST_SEQ
                ,   L.*
            FROM    SAC_IF_ERR_LOG L
            WHERE   1 = 1
              AND   PGM_APPL_NM = 'SAC_TRS_TES_ACCRUAL_PKG'
              AND   SRC_MDL_CD = @[job_nm]
              AND   ERR_DESC = 'EXEC_LOG'
              AND   L.EXE_YRMON = REPLACE(@[accl_month],'-','')
        ) AA
        WHERE AA.LST_SEQ = 1
        UNION ALL
        SELECT  2 AS TMP_SEQ
            ,   'Not Run' AS EXEC_STATUS
        FROM    DUAL
    ) AA
) AAA
WHERE ROW_SEQ = 1			]]></sql>
			<params>
				<param name="job_nm" type="12" value="" out="N"/>
				<param name="accl_month" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
