/*=========================================================
*Copyright(c) 2016 CyberLogitec
*@FileName : AccountReceivableOutstandingDBDAOsearchOustandingbySADateRSQLRSQL.java
*@FileTitle : 
*Open Issues :
*Change history :
*@LastModifyDate : 2016.08.18
*@LastModifier : 
*@LastVersion : 1.0
* 2016.08.18 
* 1.0 Creation
=========================================================*/
package com.clt.apps.opus.stm.sar.accountreceivableoutstanding.accountreceivableoutstanding.integration;

import java.util.HashMap;
import org.apache.log4j.Logger;
import com.clt.framework.support.db.ISQLTemplate;

/**
 *
 * @author 
 * @see DAO 참조
 * @since J2EE 1.6
 */

public class AccountReceivableOutstandingDBDAOsearchOustandingbySADateRSQLRSQL implements ISQLTemplate{

	private StringBuffer query = new StringBuffer();
	
	Logger log =Logger.getLogger(this.getClass());
	
	/** Parameters definition in params/param elements */
	private HashMap<String,String[]> params = null;
	
	/**
	  * <pre>
	  * outstanding inquiry
	  * </pre>
	  */
	public AccountReceivableOutstandingDBDAOsearchOustandingbySADateRSQLRSQL(){
		setQuery();
		params = new HashMap<String,String[]>();
		String tmp = null;
		String[] arrTmp = null;
		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("kind3_code",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("port",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ots_tp_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("overdue_to",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sail_arr_dt_fm",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_cust_seq",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("startpart",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("kind2_radio",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("overdue_from",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("endpart",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("bnd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("svc_scp_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("kind3_code2",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sail_arr_dt",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("rate_yn",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("credit_flg",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("ots_grp_tp_cd",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("sail_arr_dt_to",new String[]{arrTmp[0],arrTmp[1]});

		tmp = java.sql.Types.VARCHAR + ",N";
		arrTmp = tmp.split(",");
		if(arrTmp.length !=2){
			throw new IllegalArgumentException();
		}
		params.put("f_cust_cnt_cd",new String[]{arrTmp[0],arrTmp[1]});

		query.append("/*").append("\n"); 
		query.append("Path : com.clt.apps.opus.stm.sar.accountreceivableoutstanding.accountreceivableoutstanding.integration").append("\n"); 
		query.append("FileName : AccountReceivableOutstandingDBDAOsearchOustandingbySADateRSQLRSQL").append("\n"); 
		query.append("*/").append("\n"); 
	}
	
	public String getSQL(){
		return query.toString();
	}
	
	public HashMap<String,String[]> getParams() {
		return params;
	}

	/**
	 * Query 생성
	 */
	public void setQuery(){
		query.append("SELECT *" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("SELECT ORG_T.*" ).append("\n"); 
		query.append(" ,ROWNUM AS RNUM " ).append("\n"); 
		query.append(" ,COUNT(*) OVER() AS TOTAL_CNT" ).append("\n"); 
		query.append("#if ( ${startpart} == '1')" ).append("\n"); 
		query.append(" --,COUNT(*) OVER() AS TOTAL_CNT" ).append("\n"); 
		query.append(" ,SUM(TOT_USD)  OVER() AS TOTAL_USD_AMT" ).append("\n"); 
		query.append(" ,SUM(TOT_LCL)  OVER()  AS TOTAL_LCL_AMT" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append(" --,0 AS TOTAL_CNT" ).append("\n"); 
		query.append(" ,0 AS TOTAL_USD_AMT" ).append("\n"); 
		query.append(" ,0 AS TOTAL_LCL_AMT" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("FROM (" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( ${summary_yn} == 'S')" ).append("\n"); 
		query.append("	SELECT  RHQ_CD,  " ).append("\n"); 
		query.append("	        OTS_OFC_CD, " ).append("\n"); 
		query.append("		#if ( ${kind_3} == 'CUSTOMER')" ).append("\n"); 
		query.append("	       	CUST_CD," ).append("\n"); 
		query.append("	       	CUST_NM," ).append("\n"); 
		query.append("	       	CREDIT_CURR_CD,           " ).append("\n"); 
		query.append("	       	CREDIT_LIMIT," ).append("\n"); 
		query.append("	       	OB_TERM,  " ).append("\n"); 
		query.append("	       	IB_TERM," ).append("\n"); 
		query.append("	       	CREDIT_FLG," ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'VVD')" ).append("\n"); 
		query.append("			VVD ,	" ).append("\n"); 
		query.append("	    #elseif ( ${kind_3} == 'SALESREP')" ).append("\n"); 
		query.append("			SALE_REP_CD," ).append("\n"); 
		query.append("	    #elseif ( ${kind_3} == 'SA_DATE')" ).append("\n"); 
		query.append("			SAIL_ARR_DT," ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'HJSREF')" ).append("\n"); 
		query.append("			REF_NO," ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'BLNO' || ${kind_3} == 'INVNO')" ).append("\n"); 
		query.append("		   	BL_NO," ).append("\n"); 
		query.append("	       	BKG_NO," ).append("\n"); 
		query.append("	       	INV_NO,  " ).append("\n"); 
		query.append("	       	CUST_CD," ).append("\n"); 
		query.append("	       	CUST_NM," ).append("\n"); 
		query.append("	       	--PDL - ref#38078 Invoice Currency 추가" ).append("\n"); 
		query.append("	       	INV_CURR_CD," ).append("\n"); 
		query.append("			--PDL - ref#38078 Invoice ROE vs Local, Invoice ROE vs USD 추가" ).append("\n"); 
		query.append("       		INV_LOCL_XCH_RT,       " ).append("\n"); 
		query.append("       		INV_USD_XCH_RT," ).append("\n"); 
		query.append("	       	CREDIT_CURR_CD, " ).append("\n"); 
		query.append("	       	CREDIT_LIMIT," ).append("\n"); 
		query.append("	       	OB_TERM,  " ).append("\n"); 
		query.append("	        IB_TERM," ).append("\n"); 
		query.append("	        CREDIT_FLG, " ).append("\n"); 
		query.append("	        VVD , " ).append("\n"); 
		query.append("	        LANE_CD, " ).append("\n"); 
		query.append("	        BND, " ).append("\n"); 
		query.append("	        SAIL_ARR_DT, " ).append("\n"); 
		query.append("	        POR_CD, " ).append("\n"); 
		query.append("	        POL_CD, " ).append("\n"); 
		query.append("	        POD_CD, " ).append("\n"); 
		query.append("	        DEL_CD, " ).append("\n"); 
		query.append("	        INV_DT, " ).append("\n"); 
		query.append("	        SVC_SCP_CD, " ).append("\n"); 
		query.append("	        SALE_REP_CD," ).append("\n"); 
		query.append("	        REF_NO, " ).append("\n"); 
		query.append("	        DUE_DT, " ).append("\n"); 
		query.append("	        OVER_DUE," ).append("\n"); 
		query.append("	        OTS_GRP_TP_CD, " ).append("\n"); 
		query.append("	        OTS_TP_CD, " ).append("\n"); 
		query.append("	        SC_NO, " ).append("\n"); 
		query.append("	        RMK, " ).append("\n"); 
		query.append("	        KIND2," ).append("\n"); 
		query.append("	        AP_AR_OFFST_NO," ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'APAR_OFFSET')" ).append("\n"); 
		query.append("			AP_AR_OFFST_NO," ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		    MAX(EX_RATE)						EX_RATE," ).append("\n"); 
		query.append("	    	MAX(USD_EQV_LCL)					USD_EQV_LCL," ).append("\n"); 
		query.append("	    	SUM(INV_TOT_LCL)					INV_TOT_LCL," ).append("\n"); 
		query.append("	    	SUM(INV_TOT_USD)					INV_TOT_USD," ).append("\n"); 
		query.append("	    	SUM(RCT_TOT_LCL)					RCT_TOT_LCL," ).append("\n"); 
		query.append("	    	SUM(RCT_TOT_USD)					RCT_TOT_USD," ).append("\n"); 
		query.append("	    	SUM(ADJ_TOT_LCL)					ADJ_TOT_LCL," ).append("\n"); 
		query.append("	    	SUM(ADJ_TOT_USD)					ADJ_TOT_USD," ).append("\n"); 
		query.append("	    	SUM(TOT_LCL)						TOT_LCL," ).append("\n"); 
		query.append("	    	SUM(TOT_USD)						TOT_USD," ).append("\n"); 
		query.append("			SUM(INV_AMT)						INV_AMT," ).append("\n"); 
		query.append("			SUM(RCT_AMT)						RCT_AMT," ).append("\n"); 
		query.append("			SUM(ADJ_AMT)						ADJ_AMT," ).append("\n"); 
		query.append("			SUM(BAL_AMT)						BAL_AMT," ).append("\n"); 
		query.append("			NVL(OTS_PAY_CD, 'N') 				OTS_PAY_CD," ).append("\n"); 
		query.append("			ORG_INV_NO" ).append("\n"); 
		query.append("	FROM (" ).append("\n"); 
		query.append("	     SELECT RHQ_CD,  " ).append("\n"); 
		query.append("	    		OTS_OFC_CD, " ).append("\n"); 
		query.append("			#if ( ${kind_3} == 'CUSTOMER')" ).append("\n"); 
		query.append("	       		CUST_CD," ).append("\n"); 
		query.append("	       		CUST_NM," ).append("\n"); 
		query.append("	       		CREDIT_CURR_CD,           " ).append("\n"); 
		query.append("	       		CREDIT_LIMIT," ).append("\n"); 
		query.append("	       		OB_TERM,  " ).append("\n"); 
		query.append("	       		IB_TERM," ).append("\n"); 
		query.append("	       		CREDIT_FLG," ).append("\n"); 
		query.append("			#elseif ( ${kind_3} == 'VVD')" ).append("\n"); 
		query.append("				VVD ,	" ).append("\n"); 
		query.append("	    	#elseif ( ${kind_3} == 'SALESREP')" ).append("\n"); 
		query.append("				SALE_REP_CD," ).append("\n"); 
		query.append("	    	#elseif ( ${kind_3} == 'SA_DATE')" ).append("\n"); 
		query.append("				SAIL_ARR_DT," ).append("\n"); 
		query.append("			#elseif ( ${kind_3} == 'HJSREF')" ).append("\n"); 
		query.append("				REF_NO," ).append("\n"); 
		query.append("			#elseif ( ${kind_3} == 'BLNO' || ${kind_3} == 'INVNO')" ).append("\n"); 
		query.append("		   		BL_NO," ).append("\n"); 
		query.append("	       		BKG_NO," ).append("\n"); 
		query.append("	       		INV_NO,  " ).append("\n"); 
		query.append("	       		CUST_CD," ).append("\n"); 
		query.append("	       		CUST_NM," ).append("\n"); 
		query.append("	       		--PDL - ref#38078 Invoice Currency 추가" ).append("\n"); 
		query.append("	       		INV_CURR_CD," ).append("\n"); 
		query.append("				--PDL - ref#38078 Invoice ROE vs Local, Invoice ROE vs USD 추가" ).append("\n"); 
		query.append("       			INV_LOCL_XCH_RT,       " ).append("\n"); 
		query.append("       			INV_USD_XCH_RT," ).append("\n"); 
		query.append("	       		CREDIT_CURR_CD, " ).append("\n"); 
		query.append("	       		CREDIT_LIMIT," ).append("\n"); 
		query.append("	       		OB_TERM,  " ).append("\n"); 
		query.append("	        	IB_TERM," ).append("\n"); 
		query.append("	        	CREDIT_FLG, " ).append("\n"); 
		query.append("	        	VVD , " ).append("\n"); 
		query.append("	        	LANE_CD, " ).append("\n"); 
		query.append("	        	BND, " ).append("\n"); 
		query.append("	        	SAIL_ARR_DT, " ).append("\n"); 
		query.append("	        	POR_CD, " ).append("\n"); 
		query.append("	        	POL_CD, " ).append("\n"); 
		query.append("	        	POD_CD, " ).append("\n"); 
		query.append("	        	DEL_CD, " ).append("\n"); 
		query.append("	        	INV_DT, " ).append("\n"); 
		query.append("	        	SVC_SCP_CD, " ).append("\n"); 
		query.append("	        	SALE_REP_CD," ).append("\n"); 
		query.append("	        	REF_NO, " ).append("\n"); 
		query.append("	        	DUE_DT, " ).append("\n"); 
		query.append("	        	OVER_DUE," ).append("\n"); 
		query.append("	        	OTS_GRP_TP_CD, " ).append("\n"); 
		query.append("	        	OTS_TP_CD, " ).append("\n"); 
		query.append("	        	SC_NO, " ).append("\n"); 
		query.append("	        	RMK, " ).append("\n"); 
		query.append("	        	KIND2," ).append("\n"); 
		query.append("	        	AP_AR_OFFST_NO," ).append("\n"); 
		query.append("			#elseif ( ${kind_3} == 'APAR_OFFSET')" ).append("\n"); 
		query.append("				AP_AR_OFFST_NO," ).append("\n"); 
		query.append("			#end" ).append("\n"); 
		query.append("	       		EX_RATE, " ).append("\n"); 
		query.append("	       		USD_EQV_LCL,      " ).append("\n"); 
		query.append("	       		INV_TOT_LCL," ).append("\n"); 
		query.append("	       		INV_TOT_USD," ).append("\n"); 
		query.append("	       		RCT_TOT_LCL," ).append("\n"); 
		query.append("	       		RCT_TOT_USD," ).append("\n"); 
		query.append("	       		ADJ_TOT_LCL," ).append("\n"); 
		query.append("	       		ADJ_TOT_USD," ).append("\n"); 
		query.append("	       		TOT_LCL," ).append("\n"); 
		query.append("	       		TOT_USD," ).append("\n"); 
		query.append("		   		INV_AMT," ).append("\n"); 
		query.append("		   		RCT_AMT," ).append("\n"); 
		query.append("		   		ADJ_AMT," ).append("\n"); 
		query.append("		   		BAL_AMT," ).append("\n"); 
		query.append("				OTS_PAY_CD," ).append("\n"); 
		query.append("				ORG_INV_NO	" ).append("\n"); 
		query.append("		 FROM (	    " ).append("\n"); 
		query.append("		       SELECT 	'1' 					SORT_SEQ," ).append("\n"); 
		query.append("						SOH.RHQ_CD       		RHQ_CD,  " ).append("\n"); 
		query.append("		       			SOH.OTS_OFC_CD   		OTS_OFC_CD, " ).append("\n"); 
		query.append("					#if ( ${kind_3} == 'CUSTOMER')" ).append("\n"); 
		query.append("		       			SOH.BIL_TO_CUST_CNT_CD||LPAD(SOH.BIL_TO_CUST_SEQ,6, '0') CUST_CD," ).append("\n"); 
		query.append("		       			MC.CUST_LGL_ENG_NM   	CUST_NM," ).append("\n"); 
		query.append("		       			MCC.CR_CURR_CD       	CREDIT_CURR_CD,           " ).append("\n"); 
		query.append("		       			MCC.CR_AMT   	        CREDIT_LIMIT," ).append("\n"); 
		query.append("		       			MCC.OB_CR_TERM_DYS   	OB_TERM,  " ).append("\n"); 
		query.append("		       			MCC.IB_CR_TERM_DYS   	IB_TERM," ).append("\n"); 
		query.append("		       			MCC.CR_FLG   	        CREDIT_FLG, " ).append("\n"); 
		query.append("					#elseif ( ${kind_3} == 'VVD')" ).append("\n"); 
		query.append("						SOH.VSL_CD||SOH.SKD_VOY_NO ||SOH.DIR_CD 		VVD ,	" ).append("\n"); 
		query.append("		    		#elseif ( ${kind_3} == 'SALESREP')" ).append("\n"); 
		query.append("						SOH.CUST_SREP_CD								SALE_REP_CD," ).append("\n"); 
		query.append("		    		#elseif ( ${kind_3} == 'SA_DATE')" ).append("\n"); 
		query.append("						TO_CHAR(TO_DATE(SOH.SAIL_ARR_DT,'YYYY-MM-DD'),'YYYY-MM-DD')      SAIL_ARR_DT," ).append("\n"); 
		query.append("					#elseif ( ${kind_3} == 'HJSREF')" ).append("\n"); 
		query.append("						SOH.BKG_REF_NO       							REF_NO," ).append("\n"); 
		query.append("					#elseif ( ${kind_3} == 'BLNO' || ${kind_3} == 'INVNO')" ).append("\n"); 
		query.append("			   			SOH.BL_NO        										BL_NO," ).append("\n"); 
		query.append("		       			SOH.BKG_NO      	 									BKG_NO," ).append("\n"); 
		query.append("		       			SOH.INV_NO       										INV_NO,  " ).append("\n"); 
		query.append("		       			SOH.BIL_TO_CUST_CNT_CD||LPAD(SOH.BIL_TO_CUST_SEQ,6, '0') CUST_CD," ).append("\n"); 
		query.append("		       			MC.CUST_LGL_ENG_NM   									CUST_NM," ).append("\n"); 
		query.append("						--PDL - ref#38078 Invoice Currency 추가" ).append("\n"); 
		query.append("       					SOH.INV_CURR_CD  										INV_CURR_CD," ).append("\n"); 
		query.append("						--PDL - ref#38078 Invoice ROE vs Local, Invoice ROE vs USD 추가" ).append("\n"); 
		query.append("		       			ROUND(SOH.INV_LOCL_XCH_RT, 6)							INV_LOCL_XCH_RT," ).append("\n"); 
		query.append("       					ROUND(SOH.INV_USD_XCH_RT, 6)							INV_USD_XCH_RT," ).append("\n"); 
		query.append("		       			MCC.CR_CURR_CD       									CREDIT_CURR_CD, " ).append("\n"); 
		query.append("		       			TO_CHAR(ROUND(NVL(MCC.CR_AMT,0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = NVL(MCC.CR_CURR_CD, SOH.OFC_CURR_CD)),0))) CREDIT_LIMIT," ).append("\n"); 
		query.append("		       			MCC.OB_CR_TERM_DYS   									OB_TERM,  " ).append("\n"); 
		query.append("		       			MCC.IB_CR_TERM_DYS   									IB_TERM," ).append("\n"); 
		query.append("		       			MCC.CR_FLG           									CREDIT_FLG, " ).append("\n"); 
		query.append("		       			SOH.VSL_CD||SOH.SKD_VOY_NO ||SOH.DIR_CD 				VVD , " ).append("\n"); 
		query.append("		       			SOH.LANE_CD          									LANE_CD, " ).append("\n"); 
		query.append("		       			SOH.BKG_IO_BND_CD    									BND, " ).append("\n"); 
		query.append("		       			TO_CHAR(TO_DATE(SOH.SAIL_ARR_DT,'YYYY-MM-DD'),'YYYY-MM-DD')      SAIL_ARR_DT, " ).append("\n"); 
		query.append("		       			SOH.POR_CD           									POR_CD, " ).append("\n"); 
		query.append("		       			SOH.POL_CD           									POL_CD, " ).append("\n"); 
		query.append("		       			SOH.POD_CD           									POD_CD, " ).append("\n"); 
		query.append("		       			SOH.DEL_CD           									DEL_CD, " ).append("\n"); 
		query.append("		       			TO_CHAR(TO_DATE(SOH.INV_DT,'YYYY-MM-DD'),'YYYY-MM-DD')  INV_DT, " ).append("\n"); 
		query.append("		       			SOH.SVC_SCP_CD       									SVC_SCP_CD, " ).append("\n"); 
		query.append("		       			SOH.CUST_SREP_CD     									SALE_REP_CD," ).append("\n"); 
		query.append("		      			SOH.BKG_REF_NO       									REF_NO, " ).append("\n"); 
		query.append("		       			TO_CHAR(TO_DATE(SOH.DUE_DT,'YYYY-MM-DD'),'YYYY-MM-DD')  DUE_DT, " ).append("\n"); 
		query.append("		       			TO_DATE(TO_CHAR(SYSDATE, 'YYYYMMDD'),'YYYYMMDD') - TO_DATE(SOH.DUE_DT,'YYYYMMDD') AS OVER_DUE," ).append("\n"); 
		query.append("		       			(SELECT ATTR_CTNT1 FROM SCO_LU_DTL WHERE LU_TP_CD = 'OTS GROUP' AND LU_CD = SOH.OTS_GRP_TP_CD)  AS OTS_GRP_TP_CD, " ).append("\n"); 
		query.append("		       			SOH.OTS_TP_CD        									OTS_TP_CD, " ).append("\n"); 
		query.append("		       			SOH.SC_NO            									SC_NO, " ).append("\n"); 
		query.append("		       			SOH.OTS_RMK          									RMK, " ).append("\n"); 
		query.append("		       			SOH.OTS_SRC_CD       									KIND2," ).append("\n"); 
		query.append("		       			SOH.AP_AR_OFFST_NO   									AP_AR_OFFST_NO,         								 " ).append("\n"); 
		query.append("					#elseif ( ${kind_3} == 'APAR_OFFSET')" ).append("\n"); 
		query.append("						SOH.AP_AR_OFFST_NO   									AP_AR_OFFST_NO, " ).append("\n"); 
		query.append("					#end" ).append("\n"); 
		query.append("		       			NULL                                          			EX_RATE, " ).append("\n"); 
		query.append("		       			NULL                                           			USD_EQV_LCL,     " ).append("\n"); 
		query.append("                        ROUND(NVL(SOD.LOCL_XCH_RT * SOD.INV_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = SOH.OFC_CURR_CD),0)) INV_TOT_LCL," ).append("\n"); 
		query.append("                    	ROUND(NVL(SOD.USD_XCH_RT * SOD.INV_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = 'USD'),0)) INV_TOT_USD," ).append("\n"); 
		query.append("                    	ROUND(NVL(SOD.LOCL_XCH_RT * SOD.RCT_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = SOH.OFC_CURR_CD),0)) RCT_TOT_LCL," ).append("\n"); 
		query.append("                    	ROUND(NVL(SOD.USD_XCH_RT * SOD.RCT_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = 'USD'),0)) RCT_TOT_USD," ).append("\n"); 
		query.append("                    	ROUND(NVL(SOD.LOCL_XCH_RT * SOD.ADJ_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = SOH.OFC_CURR_CD),0)) ADJ_TOT_LCL," ).append("\n"); 
		query.append("                    	ROUND(NVL(SOD.USD_XCH_RT * SOD.ADJ_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = 'USD'),0)) ADJ_TOT_USD," ).append("\n"); 
		query.append("                    	ROUND(NVL(SOD.LOCL_XCH_RT * SOD.BAL_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = SOH.OFC_CURR_CD),0)) TOT_LCL," ).append("\n"); 
		query.append("                    	ROUND(NVL(SOD.USD_XCH_RT * SOD.BAL_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = 'USD'),0)) TOT_USD," ).append("\n"); 
		query.append("			   			0 AS INV_AMT," ).append("\n"); 
		query.append("			   			0 AS RCT_AMT," ).append("\n"); 
		query.append("			   			0 AS ADJ_AMT," ).append("\n"); 
		query.append("			   			0 AS BAL_AMT," ).append("\n"); 
		query.append("						NVL(SOH.OTS_PAY_CD,'N') AS OTS_PAY_CD," ).append("\n"); 
		query.append("						SOH.ORG_INV_NO			" ).append("\n"); 
		query.append("				" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("	SELECT  SORT_SEQ," ).append("\n"); 
		query.append("			RHQ_CD,  " ).append("\n"); 
		query.append("       		OTS_OFC_CD, " ).append("\n"); 
		query.append("       		BL_NO," ).append("\n"); 
		query.append("       		BKG_NO," ).append("\n"); 
		query.append("       		INV_NO,  " ).append("\n"); 
		query.append("       		CHG_TP_CD,  " ).append("\n"); 
		query.append("       		CUST_CD," ).append("\n"); 
		query.append("       		CUST_NM," ).append("\n"); 
		query.append("       		--PDL - ref#38078 Invoice Currency 추가" ).append("\n"); 
		query.append("			INV_CURR_CD," ).append("\n"); 
		query.append("			--PDL - ref#38078 Invoice ROE vs Local, Invoice ROE vs USD 추가" ).append("\n"); 
		query.append("       		INV_LOCL_XCH_RT,       " ).append("\n"); 
		query.append("       		INV_USD_XCH_RT," ).append("\n"); 
		query.append("       		CREDIT_CURR_CD,           " ).append("\n"); 
		query.append("       		CREDIT_LIMIT," ).append("\n"); 
		query.append("       		OB_TERM,  " ).append("\n"); 
		query.append("       		IB_TERM," ).append("\n"); 
		query.append("       		CREDIT_FLG, " ).append("\n"); 
		query.append("       		VVD , " ).append("\n"); 
		query.append("       		LANE_CD, " ).append("\n"); 
		query.append("       		BND, " ).append("\n"); 
		query.append("       		SAIL_ARR_DT, " ).append("\n"); 
		query.append("       		POR_CD, " ).append("\n"); 
		query.append("       		POL_CD, " ).append("\n"); 
		query.append("      	 	POD_CD, " ).append("\n"); 
		query.append("      	 	DEL_CD, " ).append("\n"); 
		query.append("      	 	INV_DT, " ).append("\n"); 
		query.append("       		SVC_SCP_CD, " ).append("\n"); 
		query.append("      	 	SALE_REP_CD," ).append("\n"); 
		query.append("      	 	REF_NO, " ).append("\n"); 
		query.append("    	   	DUE_DT, " ).append("\n"); 
		query.append("       		OVER_DUE," ).append("\n"); 
		query.append("	       	OTS_GRP_TP_CD, " ).append("\n"); 
		query.append("    	   	OTS_TP_CD, " ).append("\n"); 
		query.append("       		SC_NO, " ).append("\n"); 
		query.append("	       	RMK, " ).append("\n"); 
		query.append("    	   	KIND2," ).append("\n"); 
		query.append("       		AP_AR_OFFST_NO, " ).append("\n"); 
		query.append("	       	USD," ).append("\n"); 
		query.append("    	   	EX_RATE, " ).append("\n"); 
		query.append("       		USD_EQV_LCL," ).append("\n"); 
		query.append("	       	INV_TOT_LCL," ).append("\n"); 
		query.append("    	   	INV_TOT_USD," ).append("\n"); 
		query.append("       		RCT_TOT_LCL," ).append("\n"); 
		query.append("		    RCT_TOT_USD," ).append("\n"); 
		query.append("	       	ADJ_TOT_LCL," ).append("\n"); 
		query.append("    	   	ADJ_TOT_USD," ).append("\n"); 
		query.append("       		TOT_LCL," ).append("\n"); 
		query.append("	       	TOT_USD," ).append("\n"); 
		query.append("		   	INV_AMT," ).append("\n"); 
		query.append("		   	RCT_AMT,	" ).append("\n"); 
		query.append("	   		ADJ_AMT," ).append("\n"); 
		query.append("		   	BAL_AMT," ).append("\n"); 
		query.append("			OTS_PAY_CD," ).append("\n"); 
		query.append("			ORG_INV_NO" ).append("\n"); 
		query.append("	FROM  (" ).append("\n"); 
		query.append("			SELECT  '1' 													SORT_SEQ," ).append("\n"); 
		query.append("					SOH.RHQ_CD       										RHQ_CD,  " ).append("\n"); 
		query.append("		       		SOH.OTS_OFC_CD   										OTS_OFC_CD, " ).append("\n"); 
		query.append("		       		SOH.BL_NO        										BL_NO," ).append("\n"); 
		query.append("		       		SOH.BKG_NO      	 									BKG_NO," ).append("\n"); 
		query.append("		       		SOH.INV_NO       										INV_NO,  " ).append("\n"); 
		query.append("		       		SOD.CHG_TP_CD       									CHG_TP_CD,  " ).append("\n"); 
		query.append("		       		SOH.BIL_TO_CUST_CNT_CD||LPAD(SOH.BIL_TO_CUST_SEQ,6, '0') CUST_CD," ).append("\n"); 
		query.append("		       		MC.CUST_LGL_ENG_NM   									CUST_NM," ).append("\n"); 
		query.append("			       	--PDL - ref#38078 Invoice Currency 추가" ).append("\n"); 
		query.append("					SOH.INV_CURR_CD  										INV_CURR_CD," ).append("\n"); 
		query.append("					--PDL - ref#38078 Invoice ROE vs Local, Invoice ROE vs USD 추가" ).append("\n"); 
		query.append("	       			ROUND(SOH.INV_LOCL_XCH_RT, 6)							INV_LOCL_XCH_RT," ).append("\n"); 
		query.append("       				ROUND(SOH.INV_USD_XCH_RT, 6)							INV_USD_XCH_RT," ).append("\n"); 
		query.append("			       	MCC.CR_CURR_CD       									CREDIT_CURR_CD,           " ).append("\n"); 
		query.append("                    TO_CHAR(ROUND(NVL(MCC.CR_AMT,0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = NVL(MCC.CR_CURR_CD, SOH.OFC_CURR_CD)),0))) CREDIT_LIMIT," ).append("\n"); 
		query.append("			       	MCC.OB_CR_TERM_DYS   									OB_TERM,  " ).append("\n"); 
		query.append("		    	   	MCC.IB_CR_TERM_DYS   									IB_TERM," ).append("\n"); 
		query.append("		       		MCC.CR_FLG           									CREDIT_FLG, " ).append("\n"); 
		query.append("			       	SOH.VSL_CD||SOH.SKD_VOY_NO ||SOH.DIR_CD 				VVD , " ).append("\n"); 
		query.append("			       	SOH.LANE_CD          									LANE_CD, " ).append("\n"); 
		query.append("			       	SOH.BKG_IO_BND_CD    									BND, " ).append("\n"); 
		query.append("		    	   	TO_CHAR(TO_DATE(SOH.SAIL_ARR_DT,'YYYY-MM-DD'),'YYYY-MM-DD')      SAIL_ARR_DT, " ).append("\n"); 
		query.append("		       		SOH.POR_CD           									POR_CD, " ).append("\n"); 
		query.append("			       	SOH.POL_CD           									POL_CD, " ).append("\n"); 
		query.append("			       	SOH.POD_CD           									POD_CD, " ).append("\n"); 
		query.append("			       	SOH.DEL_CD           									DEL_CD, " ).append("\n"); 
		query.append("		    	   	TO_CHAR(TO_DATE(SOH.INV_DT,'YYYY-MM-DD'),'YYYY-MM-DD')  INV_DT, " ).append("\n"); 
		query.append("		       		SOH.SVC_SCP_CD       									SVC_SCP_CD, " ).append("\n"); 
		query.append("			       	SOH.CUST_SREP_CD     									SALE_REP_CD," ).append("\n"); 
		query.append("			       	SOH.BKG_REF_NO       									REF_NO, " ).append("\n"); 
		query.append("			       	TO_CHAR(TO_DATE(SOH.DUE_DT,'YYYY-MM-DD'),'YYYY-MM-DD')  DUE_DT, " ).append("\n"); 
		query.append("		    	   	TO_DATE(TO_CHAR(SYSDATE, 'YYYYMMDD'),'YYYYMMDD') - TO_DATE(SOH.DUE_DT,'YYYYMMDD') AS OVER_DUE," ).append("\n"); 
		query.append("		       		(SELECT ATTR_CTNT1 FROM SCO_LU_DTL WHERE LU_TP_CD = 'OTS GROUP' AND LU_CD = SOH.OTS_GRP_TP_CD)  AS OTS_GRP_TP_CD, " ).append("\n"); 
		query.append("			       	SOH.OTS_TP_CD        									OTS_TP_CD, " ).append("\n"); 
		query.append("			       	SOH.SC_NO            									SC_NO, " ).append("\n"); 
		query.append("			       	SOH.OTS_RMK          									RMK, " ).append("\n"); 
		query.append("		    	   	SOH.OTS_SRC_CD       									KIND2," ).append("\n"); 
		query.append("		       		SOH.AP_AR_OFFST_NO   									AP_AR_OFFST_NO, " ).append("\n"); 
		query.append("			       	SOD.BL_CURR_CD                                          USD," ).append("\n"); 
		query.append("			       	SOD.LOCL_XCH_RT                                         EX_RATE, " ).append("\n"); 
		query.append("			       	SOD.USD_XCH_RT                                          USD_EQV_LCL," ).append("\n"); 
		query.append("                    ROUND(NVL(SOD.LOCL_XCH_RT * SOD.INV_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = SOH.OFC_CURR_CD),0)) INV_TOT_LCL," ).append("\n"); 
		query.append("                    ROUND(NVL(SOD.USD_XCH_RT * SOD.INV_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = 'USD'),0)) INV_TOT_USD," ).append("\n"); 
		query.append("                    ROUND(NVL(SOD.LOCL_XCH_RT * SOD.RCT_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = SOH.OFC_CURR_CD),0)) RCT_TOT_LCL," ).append("\n"); 
		query.append("                    ROUND(NVL(SOD.USD_XCH_RT * SOD.RCT_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = 'USD'),0)) RCT_TOT_USD," ).append("\n"); 
		query.append("                    ROUND(NVL(SOD.LOCL_XCH_RT * SOD.ADJ_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = SOH.OFC_CURR_CD),0)) ADJ_TOT_LCL," ).append("\n"); 
		query.append("                    ROUND(NVL(SOD.USD_XCH_RT * SOD.ADJ_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = 'USD'),0)) ADJ_TOT_USD," ).append("\n"); 
		query.append("                    ROUND(NVL(SOD.LOCL_XCH_RT * SOD.BAL_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = SOH.OFC_CURR_CD),0)) TOT_LCL," ).append("\n"); 
		query.append("                    ROUND(NVL(SOD.USD_XCH_RT * SOD.BAL_AMT, 0), NVL((SELECT MC.DP_PRCS_KNT FROM MDM_CURRENCY MC WHERE MC.CURR_CD = 'USD'),0)) TOT_USD," ).append("\n"); 
		query.append("				   	SOD.INV_AMT AS INV_AMT," ).append("\n"); 
		query.append("				   	SOD.RCT_AMT AS RCT_AMT,	" ).append("\n"); 
		query.append("				   	SOD.ADJ_AMT AS ADJ_AMT," ).append("\n"); 
		query.append("				   	SOD.BAL_AMT AS BAL_AMT," ).append("\n"); 
		query.append("					NVL(SOH.OTS_PAY_CD,'N') AS OTS_PAY_CD," ).append("\n"); 
		query.append("					SOH.ORG_INV_NO" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("			FROM  SAR_OTS_HDR SOH, " ).append("\n"); 
		query.append("     			  SAR_OTS_DTL SOD, " ).append("\n"); 
		query.append("			      MDM_CUSTOMER MC, " ).append("\n"); 
		query.append("			      MDM_CR_CUST MCC" ).append("\n"); 
		query.append("			WHERE SOH.RHQ_CD            = SOD.RHQ_CD  " ).append("\n"); 
		query.append("			AND SOH.OTS_OFC_CD          = SOD.OTS_OFC_CD" ).append("\n"); 
		query.append("			AND SOH.BL_NO               = SOD.BL_NO " ).append("\n"); 
		query.append("			AND SOH.INV_NO              = SOD.INV_NO  " ).append("\n"); 
		query.append("			AND SOH.BIL_TO_CUST_CNT_CD  = MC.CUST_CNT_CD" ).append("\n"); 
		query.append("			AND SOH.BIL_TO_CUST_SEQ     = MC.CUST_SEQ  " ).append("\n"); 
		query.append("			AND MC.CUST_CNT_CD          = MCC.CUST_CNT_CD  (+)" ).append("\n"); 
		query.append("			AND MC.CUST_SEQ             = MCC.CUST_SEQ  (+)" ).append("\n"); 
		query.append("			AND SOH.STL_FLG  = 'N'" ).append("\n"); 
		query.append("		#if (${date_tp_cd} == 'I')" ).append("\n"); 
		query.append("			AND SOH.INV_DT        <= replace(@[sail_arr_dt],'-','')" ).append("\n"); 
		query.append("		#elseif (${date_tp_cd} == 'A')" ).append("\n"); 
		query.append("			AND SOH.SAIL_ARR_DT        <= replace(@[sail_arr_dt],'-','')" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if (${rhq} != '')" ).append("\n"); 
		query.append("			AND SOH.RHQ_CD          in (${rhq})" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			AND SOH.RHQ_CD          in ('')" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if (${ofc_cd} != '')" ).append("\n"); 
		query.append("			AND SOH.CLT_OFC_CD      in (${ofc_cd})" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			AND SOH.CLT_OFC_CD      in ('')" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if (${kind2_radio} == 'INVAR')" ).append("\n"); 
		query.append("		    and soh.ots_src_cd ='INVAR' " ).append("\n"); 
		query.append("		    AND SUBSTR(soh.rev_tp_src_cd, 1, 1) IN ('B','C')" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if (${kind2_radio}  == 'OTHER' )" ).append("\n"); 
		query.append("  			AND soh.ots_src_cd ='INVAR' AND SUBSTR(soh.rev_tp_src_cd, 1, 1) = 'M' AND soh.rev_tp_src_cd <> 'MRD'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if (${kind2_radio}  == 'TPB' )" ).append("\n"); 
		query.append("  			and soh.ots_src_cd ='INVAR' " ).append("\n"); 
		query.append("  			AND soh.rev_tp_src_cd = 'MRD'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if  (${kind2_radio}  == 'FMS' ) " ).append("\n"); 
		query.append("		    and soh.ots_src_cd ='FMS' " ).append("\n"); 
		query.append("  			AND soh.rev_tp_src_cd = 'CDM'" ).append("\n"); 
		query.append("		#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if (${kind2_radio}  == 'JOO' )  " ).append("\n"); 
		query.append("  			and soh.ots_src_cd ='JOO' " ).append("\n"); 
		query.append("		#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if (${kind2_radio} == 'STM A%' )" ).append("\n"); 
		query.append("  			and soh.ots_src_cd LIKE 'STM A%' " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		#if (${kind2_radio} == 'UNAPP')" ).append("\n"); 
		query.append("			AND 1 = 2" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${bnd} != 'ALL')" ).append("\n"); 
		query.append("   			AND SOH.BKG_IO_BND_CD = @[bnd]" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("   			AND SOH.BKG_IO_BND_CD IN ('I','O')" ).append("\n"); 
		query.append("		#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${overdue_from} != '')" ).append("\n"); 
		query.append("			AND    TO_DATE(TO_CHAR(sysdate, 'YYYYMMDD'),'YYYYMMDD') - TO_DATE(SOH.DUE_DT,'YYYYMMDD')  >= @[overdue_from]" ).append("\n"); 
		query.append("		#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${overdue_to} != '')" ).append("\n"); 
		query.append("			AND    TO_DATE(TO_CHAR(sysdate, 'YYYYMMDD'),'YYYYMMDD') - TO_DATE(SOH.DUE_DT,'YYYYMMDD')  <= @[overdue_to]" ).append("\n"); 
		query.append("		#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${svc_scp_cd} != '')" ).append("\n"); 
		query.append("   			AND SOH.SVC_SCP_CD LIKE @[svc_scp_cd]||'%'" ).append("\n"); 
		query.append("		#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${port} != '')" ).append("\n"); 
		query.append("    		#if ( ${bnd} == 'I')" ).append("\n"); 
		query.append("        		AND SOH.POD_CD LIKE @[port]||'%'" ).append("\n"); 
		query.append("    		#elseif ( ${bnd} == 'O')" ).append("\n"); 
		query.append("        		AND SOH.POL_CD LIKE @[port]||'%'" ).append("\n"); 
		query.append("    		#else" ).append("\n"); 
		query.append("        		AND ( SOH.POD_CD LIKE @[port]||'%' OR SOH.POL_CD LIKE @[port]||'%' )" ).append("\n"); 
		query.append("    		#end " ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${credit_flg} != 'ALL')" ).append("\n"); 
		query.append("   			AND NVL(MCC.CR_FLG,'N') = @[credit_flg]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${rate_yn} != 'ALL')" ).append("\n"); 
		query.append("   			AND NVL(SOH.OTS_RT_FLG,'Y') = @[rate_yn]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${bl_inv} == 'B')" ).append("\n"); 
		query.append("   			AND SOH.INV_NO	= '**********'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${bl_inv} == 'I')" ).append("\n"); 
		query.append("   			AND SOH.INV_NO	<> '**********'" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if (  ${ots_grp_tp_cd} != '' and ${ots_grp_tp_cd} != 'ALL' )" ).append("\n"); 
		query.append("   			AND SOH.OTS_GRP_TP_CD = @[ots_grp_tp_cd]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if (  ${ots_tp_cd} != '' and ${ots_tp_cd} != 'ALL')" ).append("\n"); 
		query.append("   			AND SOH.OTS_TP_CD = @[ots_tp_cd]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${f_cust_cnt_cd} != '')" ).append("\n"); 
		query.append("			AND SOH.BIL_TO_CUST_CNT_CD = @[f_cust_cnt_cd]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${f_cust_seq} != '')" ).append("\n"); 
		query.append("			AND SOH.BIL_TO_CUST_SEQ = @[f_cust_seq]" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${kind_3} == 'VVD')" ).append("\n"); 
		query.append("   			#if ( ${kind3_code2} != '')" ).append("\n"); 
		query.append("   				AND SOH.VSL_CD||SOH.SKD_VOY_NO ||SOH.DIR_CD = @[kind3_code2]" ).append("\n"); 
		query.append("   			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${kind_3} == 'SALESREP')" ).append("\n"); 
		query.append("   			#if ( ${kind3_code} != '')" ).append("\n"); 
		query.append("   				AND SOH.CUST_SREP_CD = @[kind3_code]" ).append("\n"); 
		query.append("   			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${kind_3} == 'HJSREF')" ).append("\n"); 
		query.append("   			#if ( ${kind3_code} != '')" ).append("\n"); 
		query.append("   				AND SOH.BKG_REF_NO = @[kind3_code]" ).append("\n"); 
		query.append("		   #end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${kind_3} == 'APAR_OFFSET')" ).append("\n"); 
		query.append("   			#if ( ${kind3_code} != '')" ).append("\n"); 
		query.append("   				AND SOH.AP_AR_OFFST_NO = @[kind3_code]" ).append("\n"); 
		query.append("   			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${kind_3} == 'SA_DATE')" ).append("\n"); 
		query.append("   			#if ( ${sail_arr_dt_fm} != '')" ).append("\n"); 
		query.append("   				AND SOH.SAIL_ARR_DT        >= REPLACE(@[sail_arr_dt_fm],'-','')" ).append("\n"); 
		query.append("   			#end" ).append("\n"); 
		query.append("   			#if ( ${sail_arr_dt_to} != '')" ).append("\n"); 
		query.append("   				AND SOH.SAIL_ARR_DT        <= REPLACE(@[sail_arr_dt_to],'-','')" ).append("\n"); 
		query.append("   			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${kind_3} == 'SCNO')" ).append("\n"); 
		query.append("   			#if ( ${kind3_code} != '')" ).append("\n"); 
		query.append("   				AND SOH.SC_NO LIKE  @[kind3_code]||'%'" ).append("\n"); 
		query.append("   			#else" ).append("\n"); 
		query.append("				AND SOH.SC_NO IS NOT NULL" ).append("\n"); 
		query.append("   			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${kind_3} == 'BLNO')" ).append("\n"); 
		query.append("   			#if ( ${kind3_code2} != '')" ).append("\n"); 
		query.append("   				AND SOH.BL_NO = @[kind3_code2]" ).append("\n"); 
		query.append("   			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${kind_3} == 'INVNO')" ).append("\n"); 
		query.append("   			#if ( ${kind3_code2} != '')" ).append("\n"); 
		query.append("   				AND SOH.INV_NO = @[kind3_code2]" ).append("\n"); 
		query.append("   			#end" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("        AND EXISTS(	SELECT 'X'" ).append("\n"); 
		query.append("             		FROM  SAR_OTS_DTL SOD2" ).append("\n"); 
		query.append("            		WHERE  SOD2.RHQ_CD = SOD.RHQ_CD" ).append("\n"); 
		query.append("              		AND  SOD2.OTS_OFC_CD = SOD.OTS_OFC_CD" ).append("\n"); 
		query.append("              		AND  SOD2.BL_NO = SOD.BL_NO" ).append("\n"); 
		query.append("              		AND  SOD2.INV_NO = SOD.INV_NO" ).append("\n"); 
		query.append("		#if ( ${ots_opy} == 'OTS')" ).append("\n"); 
		query.append("   			HAVING SUM(SOD2.BAL_AMT) > 0  )" ).append("\n"); 
		query.append("		#elseif ( ${ots_opy} == 'OPY')" ).append("\n"); 
		query.append("		   	HAVING SUM(SOD2.BAL_AMT) < 0  )" ).append("\n"); 
		query.append("		#else" ).append("\n"); 
		query.append("			HAVING SUM(SOD2.BAL_AMT) <> 0 )" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( ${ots_opy} != 'OTS')" ).append("\n"); 
		query.append("			UNION ALL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if ( ${summary_yn} == 'S')" ).append("\n"); 
		query.append("		SELECT '2' SORT_SEQ," ).append("\n"); 
		query.append("				MO.AR_HD_QTR_OFC_CD RHQ_CD," ).append("\n"); 
		query.append("	       		SR.RCT_OFC_CD       OTS_OFC_CD," ).append("\n"); 
		query.append("		#if ( ${kind_3} == 'CUSTOMER')" ).append("\n"); 
		query.append("		   		SR.RCT_CUST_CNT_CD|| LPAD(SR.RCT_CUST_SEQ, 6, '0') CUST_CD," ).append("\n"); 
		query.append("			   	MC.CUST_LGL_ENG_NM  CUST_NM," ).append("\n"); 
		query.append("			   	MCC.CR_CURR_CD		CREDIT_CURR_CD," ).append("\n"); 
		query.append("			   	TO_NUMBER(SAR_GET_CUR_AMT_FNC(NVL(MCC.CR_CURR_CD, MO.AR_CURR_CD),MCC.CR_AMT))	CREDIT_LIMIT," ).append("\n"); 
		query.append("	  	     	MCC.OB_CR_TERM_DYS	OB_TERM," ).append("\n"); 
		query.append("	   	    	MCC.IB_CR_TERM_DYS	IB_TERM," ).append("\n"); 
		query.append("	   	    	MCC.CR_FLG         	CREDIT_FLG," ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'VVD')" ).append("\n"); 
		query.append("				NULL                VVD," ).append("\n"); 
		query.append("  	  	#elseif ( ${kind_3} == 'SALESREP')" ).append("\n"); 
		query.append("				NULL                SALE_REP_CD," ).append("\n"); 
		query.append("  	  	#elseif ( ${kind_3} == 'SA_DATE')" ).append("\n"); 
		query.append("				NULL                SAIL_ARR_DT," ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'HJSREF')" ).append("\n"); 
		query.append("				NULL                REF_NO," ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'BLNO' || ${kind_3} == 'INVNO')	   	" ).append("\n"); 
		query.append("	       		SR.RCT_NO           BL_NO," ).append("\n"); 
		query.append("	       		NULL                BKG_NO," ).append("\n"); 
		query.append("		       	DECODE(OFC.OTS_SMRY_CD, 'INV', SR.RCT_NO, '')  INV_NO," ).append("\n"); 
		query.append("		       	SR.RCT_CUST_CNT_CD|| LPAD(SR.RCT_CUST_SEQ, 6, '0') CUST_CD," ).append("\n"); 
		query.append("	    	   	MC.CUST_LGL_ENG_NM  CUST_NM," ).append("\n"); 
		query.append("		       	--PDL - ref#38078 Invoice Currency 추가" ).append("\n"); 
		query.append("		       	SR.RCT_CURR_CD      INV_CURR_CD," ).append("\n"); 
		query.append("				--PDL - ref#38078 Invoice ROE vs Local, Invoice ROE vs USD 추가" ).append("\n"); 
		query.append("				ROUND(SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, MO.AR_CURR_CD), 6)	INV_LOCL_XCH_RT," ).append("\n"); 
		query.append("				ROUND(SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, 'USD'), 6)	INV_USD_XCH_RT," ).append("\n"); 
		query.append("			   	MCC.CR_CURR_CD		CREDIT_CURR_CD," ).append("\n"); 
		query.append("			   	SAR_GET_CUR_AMT_FNC(NVL(MCC.CR_CURR_CD, MO.AR_CURR_CD), MCC.CR_AMT)	CREDIT_LIMIT," ).append("\n"); 
		query.append("	    	   	MCC.OB_CR_TERM_DYS	OB_TERM," ).append("\n"); 
		query.append("	       		MCC.IB_CR_TERM_DYS	IB_TERM," ).append("\n"); 
		query.append("		       	MCC.CR_FLG         	CREDIT_FLG," ).append("\n"); 
		query.append("		       	NULL                VVD," ).append("\n"); 
		query.append("	    	   	NULL                LANE_CD," ).append("\n"); 
		query.append("		       	NULL                BND," ).append("\n"); 
		query.append("		       	TO_CHAR(TO_DATE(SR.RCT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD')	SAIL_ARR_DT," ).append("\n"); 
		query.append("	    	   	NULL                POR_CD," ).append("\n"); 
		query.append("	       		NULL                POL_CD," ).append("\n"); 
		query.append("		       	NULL                POD_CD," ).append("\n"); 
		query.append("		       	NULL                DEL_CD," ).append("\n"); 
		query.append("	    	   	DECODE(OFC.OTS_SMRY_CD, 'INV', TO_CHAR(TO_DATE(SR.RCT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD'), '')  INV_DT," ).append("\n"); 
		query.append("	       		NULL                SVC_SCP_CD," ).append("\n"); 
		query.append("		       	NULL                SALE_REP_CD," ).append("\n"); 
		query.append("		       	NULL                REF_NO," ).append("\n"); 
		query.append("		       	TO_CHAR(TO_DATE(SR.RCT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD')	DUE_DT," ).append("\n"); 
		query.append("	    	   	TO_DATE(TO_CHAR(SYSDATE, 'YYYYMMDD'),'YYYYMMDD') - TO_DATE(SR.RCT_DT, 'YYYYMMDD') AS OVER_DUE," ).append("\n"); 
		query.append("		       	NULL                OTS_GRP_TP_CD," ).append("\n"); 
		query.append("		       	NULL                OTS_TP_CD," ).append("\n"); 
		query.append("	    	   	NULL                SC_NO," ).append("\n"); 
		query.append("	       		NULL                RMK," ).append("\n"); 
		query.append("		       	'CASH'              KIND2," ).append("\n"); 
		query.append("				NULL                AP_AR_OFFST_NO," ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'APAR_OFFSET')" ).append("\n"); 
		query.append("				NULL                AP_AR_OFFST_NO," ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("		       	NULL                EX_RATE," ).append("\n"); 
		query.append("		       	NULL                USD_EQV_LCL," ).append("\n"); 
		query.append("	    	   	0           		INV_TOT_LCL," ).append("\n"); 
		query.append("	       		0           		INV_TOT_USD," ).append("\n"); 
		query.append("				SUM(SAR_GET_CUR_AMT_FNC(MO.AR_CURR_CD, (SR.BAL_RCT_AMT * -1) * SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, MO.AR_CURR_CD))) RCT_TOT_LCL," ).append("\n"); 
		query.append("				SUM(SAR_GET_CUR_AMT_FNC('USD', (SR.BAL_RCT_AMT * -1) * SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, 'USD'))) RCT_TOT_USD," ).append("\n"); 
		query.append("	    	   	0           		ADJ_TOT_LCL," ).append("\n"); 
		query.append("	       		0           		ADJ_TOT_USD," ).append("\n"); 
		query.append("				SUM(SAR_GET_CUR_AMT_FNC(MO.AR_CURR_CD, (SR.BAL_RCT_AMT * -1) * SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, MO.AR_CURR_CD))) TOT_LCL," ).append("\n"); 
		query.append("				SUM(SAR_GET_CUR_AMT_FNC('USD', (SR.BAL_RCT_AMT * -1) * SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, 'USD'))) TOT_USD," ).append("\n"); 
		query.append("	    	   	0           		INV_AMT," ).append("\n"); 
		query.append("				SUM(SAR_GET_CUR_AMT_FNC(SR.RCT_CURR_CD, (SR.BAL_RCT_AMT * -1)))	RCT_AMT," ).append("\n"); 
		query.append("		       	0           		ADJ_AMT," ).append("\n"); 
		query.append("				SUM(SAR_GET_CUR_AMT_FNC(SR.RCT_CURR_CD, (SR.BAL_RCT_AMT * -1)))	BAL_AMT," ).append("\n"); 
		query.append("				NULL				OTS_PAY_CD," ).append("\n"); 
		query.append("				NULL				ORG_INV_NO" ).append("\n"); 
		query.append("	#else	" ).append("\n"); 
		query.append("		SELECT '2' SORT_SEQ," ).append("\n"); 
		query.append("				MO.AR_HD_QTR_OFC_CD RHQ_CD," ).append("\n"); 
		query.append("		       	SR.RCT_OFC_CD       OTS_OFC_CD," ).append("\n"); 
		query.append("		       	SR.RCT_NO           BL_NO," ).append("\n"); 
		query.append("	    	   	NULL                BKG_NO," ).append("\n"); 
		query.append("	       		DECODE(OFC.OTS_SMRY_CD, 'INV', SR.RCT_NO, '')  INV_NO," ).append("\n"); 
		query.append("		       	NULL                CHG_TP_CD," ).append("\n"); 
		query.append("		       	SR.RCT_CUST_CNT_CD|| LPAD(SR.RCT_CUST_SEQ, 6, '0') CUST_CD," ).append("\n"); 
		query.append("	    	   	MC.CUST_LGL_ENG_NM  CUST_NM," ).append("\n"); 
		query.append("		       	--PDL - ref#38078 Invoice Currency 추가" ).append("\n"); 
		query.append("		       	SR.RCT_CURR_CD      INV_CURR_CD," ).append("\n"); 
		query.append("				--PDL - ref#38078 Invoice ROE vs Local, Invoice ROE vs USD 추가" ).append("\n"); 
		query.append("				ROUND(SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, MO.AR_CURR_CD), 6)	INV_LOCL_XCH_RT," ).append("\n"); 
		query.append("				ROUND(SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, 'USD'), 6)	INV_USD_XCH_RT," ).append("\n"); 
		query.append("		       	MCC.CR_CURR_CD		CREDIT_CURR_CD," ).append("\n"); 
		query.append("    	        SAR_GET_CUR_AMT_FNC(NVL(MCC.CR_CURR_CD, MO.AR_CURR_CD),MCC.CR_AMT) CREDIT_LIMIT," ).append("\n"); 
		query.append("		       	MCC.OB_CR_TERM_DYS	OB_TERM," ).append("\n"); 
		query.append("		       	MCC.IB_CR_TERM_DYS	IB_TERM," ).append("\n"); 
		query.append("	    	   	MCC.CR_FLG         	CREDIT_FLG," ).append("\n"); 
		query.append("	       		NULL                VVD," ).append("\n"); 
		query.append("		       	NULL                LANE_CD," ).append("\n"); 
		query.append("		       	NULL                BND," ).append("\n"); 
		query.append("	    	   	TO_CHAR(TO_DATE(SR.RCT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD')	SAIL_ARR_DT," ).append("\n"); 
		query.append("	       		NULL                POR_CD," ).append("\n"); 
		query.append("		       	NULL                POL_CD," ).append("\n"); 
		query.append("		       	NULL                POD_CD," ).append("\n"); 
		query.append("	    	   	NULL                DEL_CD," ).append("\n"); 
		query.append("	       		DECODE(OFC.OTS_SMRY_CD, 'INV', TO_CHAR(TO_DATE(SR.RCT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD'), '')  INV_DT," ).append("\n"); 
		query.append("		       	NULL                SVC_SCP_CD," ).append("\n"); 
		query.append("			    NULL                SALE_REP_CD," ).append("\n"); 
		query.append("	    	   	NULL                REF_NO," ).append("\n"); 
		query.append("	       		TO_CHAR(TO_DATE(SR.RCT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD')	DUE_DT," ).append("\n"); 
		query.append("		       	TO_DATE(TO_CHAR(SYSDATE, 'YYYYMMDD'),'YYYYMMDD') - TO_DATE(SR.RCT_DT, 'YYYYMMDD') AS OVER_DUE," ).append("\n"); 
		query.append("		       	NULL                OTS_GRP_TP_CD," ).append("\n"); 
		query.append("	    	   	NULL                OTS_TP_CD," ).append("\n"); 
		query.append("	       		NULL                SC_NO," ).append("\n"); 
		query.append("		       	NULL                RMK," ).append("\n"); 
		query.append("		       	'CASH'              KIND2," ).append("\n"); 
		query.append("	    	   	NULL                AP_AR_OFFST_NO," ).append("\n"); 
		query.append("	       		SR.RCT_CURR_CD      USD," ).append("\n"); 
		query.append("		       	ROUND(SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, MO.AR_CURR_CD), 6)	EX_RATE," ).append("\n"); 
		query.append("		       	ROUND(SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, 'USD'), 6)	USD_EQV_LCL," ).append("\n"); 
		query.append("	    	   	0           		INV_TOT_LCL," ).append("\n"); 
		query.append("	       		0           		INV_TOT_USD," ).append("\n"); 
		query.append("				SUM(SAR_GET_CUR_AMT_FNC(MO.AR_CURR_CD, (SR.BAL_RCT_AMT * -1) * SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, MO.AR_CURR_CD))) RCT_TOT_LCL," ).append("\n"); 
		query.append("				SUM(SAR_GET_CUR_AMT_FNC('USD', (SR.BAL_RCT_AMT * -1) * SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, 'USD'))) RCT_TOT_USD," ).append("\n"); 
		query.append("	    	   	0           		ADJ_TOT_LCL," ).append("\n"); 
		query.append("	       		0           		ADJ_TOT_USD," ).append("\n"); 
		query.append("				SUM(SAR_GET_CUR_AMT_FNC(MO.AR_CURR_CD, (SR.BAL_RCT_AMT * -1) * SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, MO.AR_CURR_CD))) TOT_LCL," ).append("\n"); 
		query.append("				SUM(SAR_GET_CUR_AMT_FNC('USD', (SR.BAL_RCT_AMT * -1) * SAR_GET_GL_XCH_RT_FNC('1', SR.RCT_DT, SR.RCT_CURR_CD, 'USD'))) TOT_USD," ).append("\n"); 
		query.append("	    	   	0           		INV_AMT," ).append("\n"); 
		query.append("	       		SUM(SAR_GET_CUR_AMT_FNC(SR.RCT_CURR_CD,(SR.BAL_RCT_AMT * -1)))	RCT_AMT," ).append("\n"); 
		query.append("			    0           		ADJ_AMT," ).append("\n"); 
		query.append("		       	SUM(SAR_GET_CUR_AMT_FNC(SR.RCT_CURR_CD,(SR.BAL_RCT_AMT * -1)))	BAL_AMT," ).append("\n"); 
		query.append("				NULL 				OTS_PAY_CD," ).append("\n"); 
		query.append("				NULL 				ORG_INV_NO" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("		FROM 	SAR_RECEIPT SR," ).append("\n"); 
		query.append("       			MDM_ORGANIZATION MO," ).append("\n"); 
		query.append(" 			    MDM_CUSTOMER MC," ).append("\n"); 
		query.append("       			MDM_CR_CUST  MCC," ).append("\n"); 
		query.append("	   			--20141124-2 wskim 아래 From 절 신규 추가                 " ).append("\n"); 
		query.append("       			(SELECT IAS.AR_OFC_CD OFC_CD," ).append("\n"); 
		query.append("               		    DECODE(IAS.OTS_SMRY_CD, 'BL', 'BL', 'INV', 'INV', NVL(SOI.OTS_CATE_CD, 'BL'))  OTS_SMRY_CD" ).append("\n"); 
		query.append("        		 FROM   INV_AR_STUP_OFC IAS," ).append("\n"); 
		query.append("               			SCO_OFC_INFO    SOI" ).append("\n"); 
		query.append("        		 WHERE  IAS.AR_OFC_CD = SOI.OFC_CD(+) ) OFC" ).append("\n"); 
		query.append("		WHERE  SR.RCT_OFC_CD = MO.OFC_CD   " ).append("\n"); 
		query.append("		AND    SR.RCT_CUST_CNT_CD = MC.CUST_CNT_CD" ).append("\n"); 
		query.append("		AND    SR.RCT_CUST_SEQ = MC.CUST_SEQ	" ).append("\n"); 
		query.append("		AND    MC.CUST_CNT_CD = MCC.CUST_CNT_CD(+)" ).append("\n"); 
		query.append("		AND    MC.CUST_SEQ = MCC.CUST_SEQ(+)" ).append("\n"); 
		query.append("		--20141124-2 wskim 아래 Where 절 신규 추가          " ).append("\n"); 
		query.append("		AND    MO.OFC_CD = OFC.OFC_CD" ).append("\n"); 
		query.append("		AND    SR.RCT_CUST_CNT_CD IS NOT NULL" ).append("\n"); 
		query.append("		AND    SR.RCT_CUST_SEQ IS NOT NULL" ).append("\n"); 
		query.append("	#if (${date_tp_cd} == 'A')" ).append("\n"); 
		query.append("		AND    SR.RCT_DT <= replace(@[sail_arr_dt],'-','')" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${rhq} != '')" ).append("\n"); 
		query.append("		AND    MO.AR_HD_QTR_OFC_CD IN (${rhq})" ).append("\n"); 
		query.append("	#else" ).append("\n"); 
		query.append("		AND    MO.AR_HD_QTR_OFC_CD IN ('')" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${ofc_cd} != '')" ).append("\n"); 
		query.append("		AND    SR.RCT_OFC_CD IN (${ofc_cd})" ).append("\n"); 
		query.append("	#else" ).append("\n"); 
		query.append("		AND    SR.RCT_OFC_CD IN ('')" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${kind2_radio} == 'ALL')" ).append("\n"); 
		query.append("		AND    SR.RCT_STS_CD = 'UNAPP'" ).append("\n"); 
		query.append("	#else" ).append("\n"); 
		query.append("		AND    SR.RCT_STS_CD = @[kind2_radio]" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	AND    SR.RCT_CXL_DT IS NULL" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if (${f_cust_cnt_cd} != '')" ).append("\n"); 
		query.append("		AND    SR.RCT_CUST_CNT_CD = @[f_cust_cnt_cd]" ).append("\n"); 
		query.append("		AND    SR.RCT_CUST_SEQ = @[f_cust_seq]" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if ( ${kind_3} == 'VVD' && ${kind3_code2} != '')" ).append("\n"); 
		query.append("		AND    1=2" ).append("\n"); 
		query.append("	#elseif ( ${kind_3} == 'SALESREP' && ${kind3_code} != '')" ).append("\n"); 
		query.append("		AND    1=2" ).append("\n"); 
		query.append("	#elseif ( ${kind_3} == 'SA_DATE')" ).append("\n"); 
		query.append("		#if ( ${sail_arr_dt_fm} != '' && ${sail_arr_dt_to} != '')" ).append("\n"); 
		query.append("			AND    SR.RCT_DT >= REPLACE(@[sail_arr_dt_fm], '-', '')" ).append("\n"); 
		query.append("			AND    SR.RCT_DT <= REPLACE(@[sail_arr_dt_to], '-', '')" ).append("\n"); 
		query.append("		#end" ).append("\n"); 
		query.append("	#elseif ( ${kind_3} == 'HJSREF' && ${kind3_code} != '')" ).append("\n"); 
		query.append("		AND    1=2" ).append("\n"); 
		query.append("	#elseif ( ${kind_3} == 'APAR_OFFSET' && ${kind3_code} != '')" ).append("\n"); 
		query.append("		AND    1=2" ).append("\n"); 
		query.append("	#elseif ( ${kind_3} == 'SCNO' && ${kind3_code} != '')" ).append("\n"); 
		query.append("		AND    1=2" ).append("\n"); 
		query.append("	#elseif ( ${kind_3} == 'BLNO' && ${kind3_code2} != '')" ).append("\n"); 
		query.append("		AND    SR.RCT_NO = @[kind3_code2]" ).append("\n"); 
		query.append("	#elseif ( ${kind_3} == 'INVNO' && ${kind3_code2} != '')" ).append("\n"); 
		query.append("		AND    SR.RCT_NO = @[kind3_code2]" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if ( ${bnd} == 'I' or ${bnd} == 'O')" ).append("\n"); 
		query.append("		AND		1=2" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if ( ${overdue_from} != '')" ).append("\n"); 
		query.append("		AND    TO_DATE(TO_CHAR(sysdate, 'YYYYMMDD'),'YYYYMMDD') - TO_DATE(SR.RCT_DT,'YYYYMMDD')  >= @[overdue_from]" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if ( ${overdue_to} != '')" ).append("\n"); 
		query.append("		AND    TO_DATE(TO_CHAR(sysdate, 'YYYYMMDD'),'YYYYMMDD') - TO_DATE(SR.RCT_DT,'YYYYMMDD')  <= @[overdue_to]" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if ( ${svc_scp_cd} != '')" ).append("\n"); 
		query.append("		AND 	1=2" ).append("\n"); 
		query.append("	#end " ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if ( ${port} != '')" ).append("\n"); 
		query.append("    	AND 	1=2" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if ( ${credit_flg} != 'ALL')" ).append("\n"); 
		query.append("		AND		NVL(MCC.CR_FLG,'N') = @[credit_flg]" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if ( ${ots_opy} == 'OPY')" ).append("\n"); 
		query.append("		AND 	SR.BAL_RCT_AMT > 0" ).append("\n"); 
		query.append("	#elseif ( ${ots_opy} == 'OTS')" ).append("\n"); 
		query.append("		AND 	SR.BAL_RCT_AMT < 0" ).append("\n"); 
		query.append("	#else" ).append("\n"); 
		query.append("		AND 	SR.BAL_RCT_AMT <> 0" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if ( ${ots_grp_tp_cd} != '' && ${ots_grp_tp_cd} != 'ALL')" ).append("\n"); 
		query.append("		AND		1=2" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	#if ( ${ots_tp_cd} != '' && ${ots_tp_cd} != 'ALL')" ).append("\n"); 
		query.append("		AND		1=2" ).append("\n"); 
		query.append("	#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	GROUP BY	MO.AR_HD_QTR_OFC_CD ," ).append("\n"); 
		query.append("       			SR.RCT_OFC_CD       ," ).append("\n"); 
		query.append("		       	SR.RCT_NO           ," ).append("\n"); 
		query.append("       			SR.RCT_CUST_CNT_CD|| LPAD(SR.RCT_CUST_SEQ, 6, '0') ," ).append("\n"); 
		query.append("		       	MC.CUST_LGL_ENG_NM  ," ).append("\n"); 
		query.append("		      	--PDL - ref#38078 Invoice Currency 추가" ).append("\n"); 
		query.append("		       	SR.RCT_CURR_CD," ).append("\n"); 
		query.append("				MO.AR_CURR_CD," ).append("\n"); 
		query.append("		       	SR.RCT_DT," ).append("\n"); 
		query.append("	   			DECODE(OFC.OTS_SMRY_CD, 'INV', SR.RCT_NO, '')," ).append("\n"); 
		query.append("			   	DECODE(OFC.OTS_SMRY_CD, 'INV', TO_CHAR(TO_DATE(SR.RCT_DT,'YYYY-MM-DD'), 'YYYY-MM-DD'), '')," ).append("\n"); 
		query.append("				MCC.CR_CURR_CD," ).append("\n"); 
		query.append("        		MCC.CR_AMT," ).append("\n"); 
		query.append("		        MCC.OB_CR_TERM_DYS," ).append("\n"); 
		query.append("        		MCC.IB_CR_TERM_DYS," ).append("\n"); 
		query.append("		        MCC.CR_FLG" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( ${summary_yn} == 'S')" ).append("\n"); 
		query.append("	)" ).append("\n"); 
		query.append("	GROUP BY  	RHQ_CD,  " ).append("\n"); 
		query.append("	    	  	OTS_OFC_CD, " ).append("\n"); 
		query.append("			#if ( ${kind_3} == 'CUSTOMER')" ).append("\n"); 
		query.append("	       		CUST_CD," ).append("\n"); 
		query.append("	       		CUST_NM," ).append("\n"); 
		query.append("	       		CREDIT_CURR_CD,           " ).append("\n"); 
		query.append("	       		CREDIT_LIMIT," ).append("\n"); 
		query.append("	       		OB_TERM,  " ).append("\n"); 
		query.append("	       		IB_TERM," ).append("\n"); 
		query.append("	       		CREDIT_FLG," ).append("\n"); 
		query.append("			#elseif ( ${kind_3} == 'VVD')" ).append("\n"); 
		query.append("				VVD," ).append("\n"); 
		query.append("		    #elseif ( ${kind_3} == 'SALESREP')" ).append("\n"); 
		query.append("				SALE_REP_CD," ).append("\n"); 
		query.append("	    	#elseif ( ${kind_3} == 'SA_DATE')" ).append("\n"); 
		query.append("				SAIL_ARR_DT," ).append("\n"); 
		query.append("			#elseif ( ${kind_3} == 'HJSREF')" ).append("\n"); 
		query.append("				REF_NO," ).append("\n"); 
		query.append("			#elseif ( ${kind_3} == 'BLNO' || ${kind_3} == 'INVNO')" ).append("\n"); 
		query.append("		   		BL_NO," ).append("\n"); 
		query.append("		       	BKG_NO," ).append("\n"); 
		query.append("		       	INV_NO,  " ).append("\n"); 
		query.append("	    	   	CUST_CD," ).append("\n"); 
		query.append("	       		CUST_NM," ).append("\n"); 
		query.append("		       	--PDL - ref#38078 Invoice Currency 추가" ).append("\n"); 
		query.append("		       	INV_CURR_CD," ).append("\n"); 
		query.append("				--PDL - ref#38078 Invoice ROE vs Local, Invoice ROE vs USD 추가" ).append("\n"); 
		query.append("       			INV_LOCL_XCH_RT,       " ).append("\n"); 
		query.append("	       		INV_USD_XCH_RT," ).append("\n"); 
		query.append("		       	CREDIT_CURR_CD, " ).append("\n"); 
		query.append("		       	CREDIT_LIMIT," ).append("\n"); 
		query.append("	    	   	OB_TERM,  " ).append("\n"); 
		query.append("	        	IB_TERM," ).append("\n"); 
		query.append("		        CREDIT_FLG, " ).append("\n"); 
		query.append("		        VVD , " ).append("\n"); 
		query.append("	    	    LANE_CD, " ).append("\n"); 
		query.append("	        	BND, " ).append("\n"); 
		query.append("		        SAIL_ARR_DT, " ).append("\n"); 
		query.append("		        POR_CD, " ).append("\n"); 
		query.append("	    	    POL_CD, " ).append("\n"); 
		query.append("	        	POD_CD, " ).append("\n"); 
		query.append("		        DEL_CD, " ).append("\n"); 
		query.append("		        INV_DT, " ).append("\n"); 
		query.append("	    	    SVC_SCP_CD, " ).append("\n"); 
		query.append("	        	SALE_REP_CD," ).append("\n"); 
		query.append("		        REF_NO, " ).append("\n"); 
		query.append("		        DUE_DT, " ).append("\n"); 
		query.append("	    	    OVER_DUE," ).append("\n"); 
		query.append("	        	OTS_GRP_TP_CD, " ).append("\n"); 
		query.append("		        OTS_TP_CD, " ).append("\n"); 
		query.append("		        SC_NO, " ).append("\n"); 
		query.append("	    	    RMK, " ).append("\n"); 
		query.append("	        	KIND2," ).append("\n"); 
		query.append("		        AP_AR_OFFST_NO," ).append("\n"); 
		query.append("			#elseif ( ${kind_3} == 'APAR_OFFSET')" ).append("\n"); 
		query.append("				AP_AR_OFFST_NO," ).append("\n"); 
		query.append("  	      	#elseif ( ${kind_3} == 'SCNO')" ).append("\n"); 
		query.append("    	       'x'	," ).append("\n"); 
		query.append("        	#end" ).append("\n"); 
		query.append("				OTS_PAY_CD," ).append("\n"); 
		query.append("				ORG_INV_NO" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("#if ( ${summary_yn} == 'S')" ).append("\n"); 
		query.append("		ORDER BY RHQ_CD, OTS_OFC_CD," ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("		#if ( ${kind_3} == 'CUSTOMER')" ).append("\n"); 
		query.append("			CUST_CD" ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'VVD')" ).append("\n"); 
		query.append("        	VVD" ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'SALESREP')" ).append("\n"); 
		query.append("			SALE_REP_CD" ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'SA_DATE')" ).append("\n"); 
		query.append("    		SAIL_ARR_DT" ).append("\n"); 
		query.append("	    #elseif ( ${kind_3} == 'HJSREF')" ).append("\n"); 
		query.append("			REF_NO" ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'BLNO')" ).append("\n"); 
		query.append("    	    BL_NO        	" ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'INVNO')" ).append("\n"); 
		query.append("    	    INV_NO, INV_DT, INV_CURR_CD" ).append("\n"); 
		query.append("	    #elseif ( ${kind_3} == 'APAR_OFFSET')" ).append("\n"); 
		query.append("			AP_AR_OFFST_NO" ).append("\n"); 
		query.append("		#elseif ( ${kind_3} == 'SCNO')" ).append("\n"); 
		query.append("    	    'x'" ).append("\n"); 
		query.append("	    #end" ).append("\n"); 
		query.append("#else" ).append("\n"); 
		query.append("		ORDER BY SORT_SEQ, RHQ_CD, OTS_OFC_CD, CUST_CD, BL_NO, INV_NO, INV_DT, INV_CURR_CD" ).append("\n"); 
		query.append("#end" ).append("\n"); 
		query.append("" ).append("\n"); 
		query.append("	) ORG_T" ).append("\n"); 
		query.append(")" ).append("\n"); 
		query.append("WHERE RNUM BETWEEN @[startpart] AND @[endpart]" ).append("\n"); 

	}
}