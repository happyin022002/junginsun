<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountReceivableCollectIFDBDAOsearchIFSakuraASAListRSQL">
			<desc><![CDATA[searchIFSakuraASAList]]></desc>
			<sql><![CDATA[
#if (${asa_no} == '' )
SELECT DISTINCT
       SAH.ADJ_NO AS ref_doc_no
#else

#if (${grp_yn} == 'Y' )
SELECT
	MAX(IF_SEQ_NO) IF_SEQ_NO,
	MAX(REC_ID) REC_ID,
	ACCT_CO_CD,
	IF_DOC_TP_CD,
	DOC_DT,
	PST_DT,
	REF_DOC_NO,
	DOC_HDR_CD,
	CURR_CD, 
	TAX_CALC_AUTO_FLG,
	PST_KEY_CD,
	VAT_TAX_CD,
	SUM(LOCL_AMT) LOCL_AMT,
	SUM(DOC_AMT) DOC_AMT,
	SUM(LOCL_TAX_AMT) LOCL_TAX_AMT,
	SUM(DOC_TAX_AMT) DOC_TAX_AMT,
	ASGN_NO,
	ITM_DESC,
	PLN_DT,
	COST_CTR_CD,
	ORD_NO,
	MN_ASET_NO,
	SUB_ASET_NO,
	ASET_TJ_TP_CD,
	ASET_VAL_DT,
	GL_ACCT_NO,
	CUST_NO,
	VNDR_CRTR_ACCT_NO,
	DUE_DT_CALC_BSEL_DT,
	PAY_MZD_CD,
	STE_CNTRL_BANK_IND_CD,
	MTRL_NO,
	FUEL_LAND_QTY,
	MEAS_BSE_UT_CD,
	PFITCTR_CD,
	ALTN_ACCT_NO,
	BIZ_PRNR_REF_KEY_CD1,
	BIZ_PRNR_REF_KEY_CD2,
	LINE_ITM_REF_KEY_CD,
	INSTR_KEY_CD1,
	INSTR_KEY_CD2,
	INSTR_KEY_CD3,
	PAY_REF_CD,
	AUTOMTC_PAY_CURR_CD,
	PAY_CURR_AMT,
	CTRT_NO,
	CTRT_TP_CD,
	PAY_RSN_CD,
	CLSS_CD,
	ACT_PLC_CD,
	ENTR_EXPN_ID,
	BUD_MGMT_DIV_CD,
	ACT_DT,
	VSL_CD,
	VVL_CD,
	HUS_BANK_ID,
	PAY_BLCK_KEY_CD,
	NULL N1ST_LODG_PORT_CD,
	NULL N1ST_LODG_PORT_ETD_DT,
	NULL LST_DCHG_PORT_CD,
	NULL LST_DCHG_PORT_ETA_DT,
	NULL TRD_CD,
	NULL TRNK_VVD_CD,
	REC_TP_CD,
	NULL SLAN_CD,
	NULL BKG_QTY,
	NULL ASA_FLG, 
	RVS_FLG,
    CRE_USR_ID,
	UPD_USR_ID
FROM (
#end
SELECT DISTINCT
      --  SAR_AR_IF_SEQ.NEXTVAL  as AR_IF_Seq
       --SAH.ADJ_HIS_SEQ AS If_Seq_No
       null AS If_Seq_No
       , '' AS rec_id
       , '1000' AS acct_co_cd    
       , 'H2' AS if_doc_tp_Cd 
       , SAH.ADJ_APLY_DT AS doc_dt
       , SAH.ADJ_GL_DT  AS pst_dt
       --20150312 wskim
       --, SUBSTR(SOHI.IF_NO, 1, LENGTH(SOHI.IF_NO)-1) AS ref_doc_no
       , SAH.ADJ_NO AS ref_doc_no
       --EAI에서 끌고가는 시간을 하나로 Fix 해야 함(Batch No.(File ID 'OPR301' + Timestamp [YYYYMMDDHHMMSS])
       --,'OPR301'||TO_CHAR(SYSDATE,'YYYYMMDDHHMMSS') AS doc_hdr_cd
       , NULL    AS doc_hdr_cd             --6
       , SAM.CURR_CD  AS curr_cd           --7
       ,'' AS tax_calc_auto_flg            --8
       , CASE
             WHEN SCD.DTRB_SRC_TP_CD IN ('ADJ', 'REC') THEN
                 DECODE(NVL(SCD.ACCT_DR_AMT, 0), 0, '11', '01')
             ELSE
                 DECODE(NVL(SCD.ACCT_DR_AMT, 0), 0, '50', '40')
         END    AS pst_key_cd            --9
       --20150227 wskim V1.9 적용 
       --, NULL           AS vat_tax_cd    --10
       , CASE
             WHEN SCD.DTRB_SRC_TP_CD = 'HDR_RND' THEN
                 DECODE( SUBSTR(MO.FINC_RGN_CD, 1,2), '11','B0','D0')  
         END  AS vat_tax_cd  --10
       -- 20151026 Currency Key의 기준으로 local amount 계산 기준 바꿔야함.
       , CASE 
             WHEN SCD.DTRB_SRC_TP_CD IN ('ADJ', 'REC') THEN
                 CASE
                     WHEN SAM.CURR_CD = FC.CURR_CD THEN
                         NULL
                     ELSE
                         ABS(NVL(SCD.ACCT_DR_AMT, 0) - NVL(SCD.ACCT_CR_AMT, 0))
                 END
             ELSE
                 ABS(NVL(SCD.ACCT_DR_AMT, 0) - NVL(SCD.ACCT_CR_AMT, 0)) 
         END            AS locl_amt   --11
       --, DECODE(SIGN(SAH.ADJ_AMT),1,SCD.INP_DR_AMT,-1,SCD.INP_CR_AMT) AS doc_amt
       , CASE 
             WHEN (SCD.CURR_CD = SACR.LOCL_CURR_CD) AND (SCD.DTRB_SRC_TP_CD IN ('ADJ', 'REC')) THEN
                 ABS(NVL(SCD.INP_DR_AMT, 0) - NVL(SCD.INP_CR_AMT, 0))
             WHEN SCD.CURR_CD = 'USD' AND (SCD.DTRB_SRC_TP_CD IN ('ADJ', 'REC')) THEN
                 TO_NUMBER(SAR_GET_CUR_AMT_FNC(SACR.LOCL_CURR_CD, (ABS(NVL(SCD.INP_DR_AMT, 0) - NVL(SCD.INP_CR_AMT, 0)) * SACR.ASA_XCH_RT1)))
             WHEN SCD.CURR_CD = SACR.N3RD_CURR_CD1 AND (SCD.DTRB_SRC_TP_CD IN ('ADJ', 'REC')) THEN
                 TO_NUMBER(SAR_GET_CUR_AMT_FNC(SACR.LOCL_CURR_CD, (ABS(NVL(SCD.INP_DR_AMT, 0) - NVL(SCD.INP_CR_AMT, 0)) * SACR.N3RD_XCH_RT1)))
             WHEN SCD.CURR_CD = SACR.N3RD_CURR_CD2 AND (SCD.DTRB_SRC_TP_CD IN ('ADJ', 'REC')) THEN
                 TO_NUMBER(SAR_GET_CUR_AMT_FNC(SACR.LOCL_CURR_CD, (ABS(NVL(SCD.INP_DR_AMT, 0) - NVL(SCD.INP_CR_AMT, 0)) * SACR.N3RD_XCH_RT2)))
             WHEN SCD.CURR_CD = SACR.N3RD_CURR_CD3 AND (SCD.DTRB_SRC_TP_CD IN ('ADJ', 'REC')) THEN
                 TO_NUMBER(SAR_GET_CUR_AMT_FNC(SACR.LOCL_CURR_CD, (ABS(NVL(SCD.INP_DR_AMT, 0) - NVL(SCD.INP_CR_AMT, 0)) * SACR.N3RD_XCH_RT3)))
             WHEN SCD.CURR_CD = SACR.N3RD_CURR_CD4 AND (SCD.DTRB_SRC_TP_CD IN ('ADJ', 'REC')) THEN
                 TO_NUMBER(SAR_GET_CUR_AMT_FNC(SACR.LOCL_CURR_CD, (ABS(NVL(SCD.INP_DR_AMT, 0) - NVL(SCD.INP_CR_AMT, 0)) * SACR.N3RD_XCH_RT4)))
             ELSE
                 0
        END    AS doc_amt             --12
       ,'' AS locl_tax_amt            --13
       ,'' AS doc_tax_amt             --14
       --, DECODE(SCD.DTRB_SRC_TP_CD,'EXCH_LOSS',REPLACE(SAH.ADJ_NO,'ADJ'),'EXCH_GAIN',REPLACE(SAH.ADJ_NO,'ADJ'), 'HDR_RND',REPLACE(SAH.ADJ_NO,'ADJ'), SOC.BL_NO)  AS asgn_no -- 길이초과 19 max 18 DEV
       --20160314  Migration시 ORG_INV_NO 송부
       --  , DECODE(SCD.DTRB_SRC_TP_CD, 'ADJ', SAM.ASA_NO, 'REC', SOHI.BL_NO, SAM.ASA_NO)   AS asgn_no    --15
          , CASE 
             WHEN SCD.DTRB_SRC_TP_CD= 'ADJ' THEN  
                  SAM.ASA_NO
             WHEN SCD.DTRB_SRC_TP_CD= 'REC'  THEN
                (SELECT NVL(A.ORG_INV_NO, SOHI.BL_NO)
                 FROM SAR_OTS_HDR A
                 WHERE A.RHQ_CD = SOHI.RHQ_CD
                 AND A.OTS_OFC_CD = SOHI.OTS_OFC_CD
                 AND A.BL_NO = SOHI.BL_NO
                 AND A.INV_NO = SOHI.INV_NO
                 AND A.BL_NO = SOHI.BL_NO)
             ELSE
                 SAM.ASA_NO
         END             AS asgn_no   
          --20160314
       , DECODE(SCD.DTRB_SRC_TP_CD,'REC', SAM.AGN_CD||':'
                                                    ||(SELECT USR_NM 
                                                        FROM COM_USER
                                                        WHERE USR_ID = SAH.CRE_USR_ID),'') AS itm_desc --16
       -- 20150319 REC일떄 sailing date로 변경
       --, DECODE(SCD.DTRB_SRC_TP_CD, 'REC', SAM.ASA_PRD_TO_DT, '') AS pln_dt                            --17
        , DECODE(SCD.DTRB_SRC_TP_CD, 'REC', SOHI.SAIL_DT, '') AS pln_dt                            --17
       -- EXCH_GAIN/LOSS, HDR_RND : MDA Trade 에서 profit_center_code 가져옴
       , CASE
             WHEN SCD.DTRB_SRC_TP_CD IN ('EXCH_GAIN', 'EXCH_LOSS', 'HDR_RND') THEN
                 --20150306 WSKIM Profit Center code 변경
                 /*(SELECT MSS.MODI_COST_CTR_CD 
                  FROM   MDM_SVC_SCP MSS
                  WHERE  MSS.SVC_SCP_CD =SOHI.SVC_SCP_CD)*/
                 NVL((SELECT MSS.MODI_COST_CTR_CD 
                      FROM   MDM_SVC_SCP MSS
                      WHERE  MSS.SVC_SCP_CD =SOHI.SVC_SCP_CD), 
                        NVL(DECODE((SELECT SSCC.TGT_CD 
                                    FROM   SCO_STMT_CD_CONV SSCC 
                                    WHERE  SSCC.CONV_TP_CD = 'GL ACCT OF PROFIT CENTER'
                                    AND    SSCC.SRC_CD = MA.MODI_ACCT_CD 
                                    AND    SSCC.USE_FLG = 'Y' 
                                    AND    SSCC.DELT_FLG = 'N' 
                                    AND ROWNUM = 1), 'ZH', MO.MODI_COST_CTR_CD,
                                                          (SELECT SSCC.TGT_CD 
                                                           FROM   SCO_STMT_CD_CONV SSCC 
                                                           WHERE  SSCC.CONV_TP_CD = 'GL ACCT OF PROFIT CENTER'
                                                           AND    SSCC.SRC_CD = MA.MODI_ACCT_CD 
                                                           AND SSCC.USE_FLG = 'Y' 
                                                           AND SSCC.DELT_FLG = 'N' 
                                                           AND ROWNUM = 1)), 'A106') )
         END  AS COST_CTR_CD         --18
       ,'' AS ORD_NO                 --19
       ,'' AS MN_ASET_NO             --20
       ,'' AS SUB_ASET_NO            --21
       ,'' AS ASET_TJ_TP_CD          --22
       ,'' AS ASET_VAL_DT            --23
       --20150107 wskim Receipt(ASA)는 EXCH_GAIN/LOSS, HDR_RND에만 적용.G/L Account Number       
       , CASE
             WHEN (SCD.DTRB_SRC_TP_CD = 'EXCH_GAIN') THEN
                 '8225101000'  --GAIN
             WHEN SCD.DTRB_SRC_TP_CD = 'EXCH_LOSS' THEN
                 '8325401000'  --LOSS
             WHEN (SCD.DTRB_SRC_TP_CD = 'HDR_RND') THEN
                 --20150120 wskim HDR_RND 부분 G/L Account Number 변경
                 /*CASE 
                     --Debit 금액이 있으면  LOSS, Credit 금액이 있으면 GAIN
                     WHEN NVL(SCD.ACCT_DR_AMT, 0) <> 0 THEN
                         '8325401000'
                     WHEN NVL(SCD.ACCT_CR_AMT, 0) <> 0 THEN
                         '8225101000' 
                 END             
                 */
                 '7001000000'   --HDR_ROUND
         END  AS GL_ACCT_NO          --24
       --, DECODE(SCD.DTRB_SRC_TBL_CD,'REC',SCD.CUST_CNT_CD||TO_CHAR(SCD.CUST_SEQ,'000000'),'RFD',SCD.CUST_CNT_CD||TO_CHAR(SCD.CUST_SEQ,'000000'),'') AS cust_no -- 향후  MDA vendor에서 SAP Account 가져옴
       , CASE 
             --20150224 wskim 컬럼 변경. SCD.DTRB_SRC_TBL_CD -> SCD.DTRB_SRC_TP_CD
             --WHEN SCD.DTRB_SRC_TBL_CD = 'ADJ' THEN
             WHEN SCD.DTRB_SRC_TP_CD = 'ADJ' THEN
                 --20150304 wskim 로직 변경
                 /*(SELECT MODI_VNDR_CD
                  FROM   MDM_VENDOR MV                                  
                  WHERE  MV.VNDR_SEQ = MO.VNDR_SEQ)*/
                 MO.MODI_AGN_CD
             --20150224 wskim 컬럼 변경. SCD.DTRB_SRC_TBL_CD -> SCD.DTRB_SRC_TP_CD     
             --WHEN SCD.DTRB_SRC_TBL_CD = 'REC' THEN
             --20161012 Migration 관련 수정
             WHEN SCD.DTRB_SRC_TP_CD = 'REC' THEN
                CASE 
                      WHEN  (SELECT NVL(A.ORG_INV_NO, 'XX')
                             FROM SAR_OTS_HDR A
                             WHERE A.RHQ_CD = SOC.RHQ_CD
                             AND A.OTS_OFC_CD = SOC.OTS_OFC_CD
                             AND A.BL_NO = SOC.BL_NO
                             AND A.INV_NO = SOC.INV_NO
                             AND A.BL_NO = SOC.BL_NO) ='XX' THEN
                             
                           'G1'||SCD.CUST_CNT_CD||TRIM(TO_CHAR(SCD.CUST_SEQ, '000000'))
                       ELSE
                           MC.MODI_CUST_CD
                 END
             ELSE
                 NULL
             END    AS cust_no      --25 
       ,'' AS vndr_crtr_acct_no     --26
       --20150302 wskim 로직수정.v2.0
       --, DECODE(SCD.DTRB_SRC_TP_CD, 'REC', SAM.ASA_PRD_TO_DT, '')  AS due_dt_calc_bsel_dt   --27
       , CASE
             WHEN SCD.DTRB_SRC_TP_CD IN ('REC','ADJ') THEN
                 SAM.ASA_PRD_TO_DT
         END   AS due_dt_calc_bsel_dt   --27
       --20150305 wskim substr(ssc.tgt_Cd, 0, 1) -> ssc.tgt_cd
       , DECODE(SCD.DTRB_SRC_TP_CD, 'REC', (SELECT SUBSTR(SSC.TGT_CD,0,1)
                                            FROM   SCO_STMT_CD_CONV SSC
                                            WHERE  SSC.CONV_TP_CD = 'RECEIPT TYPE'
                                            AND    SSC.SRC_CD = 'OFF'
                                           ), '') AS pay_mzd_cd                     --28
       ,'' AS ste_cntrl_bank_ind_cd  --29
       ,'' AS mtrl_no                --30
       ,'' AS fuel_land_qty          --31
       ,'' AS meas_bse_ut_cd         --32
       -- EXCH_GAIN/LOSS, HDR_RND : MDA Trade 에서 profit_center_code 가져옴
       , CASE
             WHEN SCD.DTRB_SRC_TP_CD IN ('EXCH_GAIN', 'EXCH_LOSS', 'HDR_RND') THEN
                 --20150306 WSKIM Profit Center code 변경
                 /*(SELECT MSS.MODI_COST_CTR_CD 
                  FROM   MDM_SVC_SCP MSS
                  WHERE  MSS.SVC_SCP_CD =SOHI.SVC_SCP_CD)*/
                 NVL((SELECT MSS.MODI_COST_CTR_CD 
                      FROM   MDM_SVC_SCP MSS
                      WHERE  MSS.SVC_SCP_CD =SOHI.SVC_SCP_CD), 
                        NVL(DECODE((SELECT SSCC.TGT_CD 
                                    FROM   SCO_STMT_CD_CONV SSCC 
                                    WHERE  SSCC.CONV_TP_CD = 'GL ACCT OF PROFIT CENTER'
                                    AND    SSCC.SRC_CD = MA.MODI_ACCT_CD 
                                    AND    SSCC.USE_FLG = 'Y' 
                                    AND    SSCC.DELT_FLG = 'N' 
                                    AND ROWNUM = 1), 'ZH', MO.MODI_COST_CTR_CD,
                                                          (SELECT SSCC.TGT_CD 
                                                           FROM   SCO_STMT_CD_CONV SSCC 
                                                           WHERE  SSCC.CONV_TP_CD = 'GL ACCT OF PROFIT CENTER'
                                                           AND    SSCC.SRC_CD = MA.MODI_ACCT_CD 
                                                           AND SSCC.USE_FLG = 'Y' 
                                                           AND SSCC.DELT_FLG = 'N' 
                                                           AND ROWNUM = 1)), 'A106') )
         END  AS pfitctr_cd          --33
       , CASE
             --20150224 wskim 컬럼 변경. SCD.DTRB_SRC_TBL_CD -> SCD.DTRB_SRC_TP_CD
             --WHEN SCD.DTRB_SRC_TBL_CD = 'ADJ' THEN
             WHEN SCD.DTRB_SRC_TP_CD = 'ADJ' THEN
                 '5360000000'
             --WHEN SCD.DTRB_SRC_TBL_CD = 'REC' THEN
             WHEN SCD.DTRB_SRC_TP_CD = 'REC' THEN
                 (SELECT MA.MODI_ACCT_CD
                  FROM   MDM_ACCOUNT MA
                  WHERE  MA.ACCT_CD = SLC.SGM_CTNT4)
             ELSE 
                 ''                 
        END  AS altn_acct_no        --34
      , CASE
             --20150224 wskim 컬럼 변경. SCD.DTRB_SRC_TBL_CD -> SCD.DTRB_SRC_TP_CD
             --WHEN SCD.DTRB_SRC_TBL_CD = 'ADJ' THEN
             WHEN SCD.DTRB_SRC_TP_CD = 'ADJ' THEN
                 'A106'
             -- Receipt(ASA)의 REC : MDA Organization 에서 profit_center_code 가져옴
             --20150224 wskim 컬럼 변경. SCD.DTRB_SRC_TBL_CD -> SCD.DTRB_SRC_TP_CD
             --WHEN SCD.DTRB_SRC_TBL_CD = 'REC' THEN
             WHEN SCD.DTRB_SRC_TP_CD = 'REC' THEN
                 --20150306 WSKIM Profit Center code 변경
                 /*(SELECT MSS.MODI_COST_CTR_CD 
                  FROM   MDM_SVC_SCP MSS
                  WHERE  MSS.SVC_SCP_CD =SOHI.SVC_SCP_CD)*/
                 NVL((SELECT MSS.MODI_COST_CTR_CD 
                      FROM   MDM_SVC_SCP MSS
                      WHERE  MSS.SVC_SCP_CD =SOHI.SVC_SCP_CD), 
                        NVL(DECODE((SELECT SSCC.TGT_CD 
                                    FROM   SCO_STMT_CD_CONV SSCC 
                                    WHERE  SSCC.CONV_TP_CD = 'GL ACCT OF PROFIT CENTER'
                                    AND    SSCC.SRC_CD = MA.MODI_ACCT_CD 
                                    AND    SSCC.USE_FLG = 'Y' 
                                    AND    SSCC.DELT_FLG = 'N' 
                                    AND ROWNUM = 1), 'ZH', MO.MODI_COST_CTR_CD,
                                                          (SELECT SSCC.TGT_CD 
                                                           FROM   SCO_STMT_CD_CONV SSCC 
                                                           WHERE  SSCC.CONV_TP_CD = 'GL ACCT OF PROFIT CENTER'
                                                           AND    SSCC.SRC_CD = MA.MODI_ACCT_CD 
                                                           AND SSCC.USE_FLG = 'Y' 
                                                           AND SSCC.DELT_FLG = 'N' 
                                                           AND ROWNUM = 1)), 'A106') )       
             ELSE
                 ''
         END  AS biz_prnr_ref_key_cd1     --35
       , CASE
             --20150224 wskim 컬럼 변경. SCD.DTRB_SRC_TBL_CD -> SCD.DTRB_SRC_TP_CD
             --WHEN SCD.DTRB_SRC_TBL_CD = 'REC' THEN
             WHEN SCD.DTRB_SRC_TP_CD = 'REC' THEN
                 (SELECT TGT_CD
                  FROM   SCO_STMT_CD_CONV
                  WHERE  CONV_TP_CD = 'CASHIER PLACE CODE'
                  AND    SRC_CD = SAM.AGN_CD) 
             ELSE
                 ''
         END  AS biz_prnr_ref_key_cd2     --36
       ,'' AS line_itm_ref_key_cd         --37
       ,'' AS instr_key_cd1               --38
       ,'' AS instr_key_cd2               --39
       ,'' AS instr_key_cd3               --40
       --20150224 wskim 컬럼 변경. SCD.DTRB_SRC_TBL_CD -> SCD.DTRB_SRC_TP_CD
       --, DECODE(SCD.DTRB_SRC_TBL_CD, 'ADJ', '41', '')  AS pay_ref_cd    --41
       , DECODE(SCD.DTRB_SRC_TP_CD, 'ADJ', '41', '')  AS pay_ref_cd    --41
       --20150129 wskim space로 변경 됨.
       -- , DECODE(SCD.DTRB_SRC_TBL_CD, 'REC', DECODE(SCD.CURR_CD, FC.CURR_CD, '', FC.CURR_CD), '') AS automtc_pay_curr_cd    --42
       , '' AS automtc_pay_curr_cd        --42
       --20150129 wskim space로 변경 됨.
       --, DECODE(SCD.DTRB_SRC_TBL_CD, 'REC', DECODE(SCD.CURR_CD, FC.CURR_CD, '', ABS(NVL(SCD.ACCT_DR_AMT, 0) - NVL(SCD.ACCT_CR_AMT, 0))), NULL) AS pay_curr_amt   --43
       , '' AS pay_curr_amt               --43
       --20150120 wskim Office SAP-ID 변경
       /*, (SELECT MODI_VNDR_CD
          FROM MDM_VENDOR MV
          WHERE MV.VNDR_SEQ = MO.VNDR_SEQ
         )   AS ctrt_no 
       */
       , MO.MODI_AGN_CD  AS ctrt_no       --44  
       , 'Z' AS ctrt_tp_cd                --45
       ,'' AS pay_rsn_cd                  --46
       ,'' AS clss_cd                     --47
       ,CASE 
            WHEN SCD.DTRB_SRC_TP_CD IN ('ADJ', 'REC') THEN 
                ''
            ELSE
                (SELECT ML.MODI_LOC_CD
                 FROM   MDM_LOCATION ML
                 WHERE ML.LOC_CD = MO.LOC_CD)                
        END  AS act_plc_cd                --48
       ,'' AS entr_expn_id                --49
       ,'' AS bud_mgmt_div_cd             --50
       ,CASE 
            WHEN SCD.DTRB_SRC_TP_CD IN ('ADJ', 'REC') THEN 
                ''
            ELSE 
                SAH.ADJ_APLY_DT  
        END AS act_dt                     --51
       ,'' AS vsl_cd                      --52
       ,'' AS vvl_Cd                      --53
       ,'' AS hus_bank_id                 --54
       ,'' AS pay_blck_key_cd             --55
       --20150129 wskim 신규 추가 항목. REC_TP_CD
       ,SCD.DTRB_SRC_TP_CD     AS  rec_tp_cd
       ,SCD.CLT_DTRB_SEQ 
       ,mo.VNDR_SEQ
       ,'N' AS rvs_flg -- 20150319 narmal/reverse sequence 분리
       ,SCD.CRE_USR_ID
	   ,SCD.UPD_USR_ID
#end
FROM   SAR_ADJ_HIS SAH 
     , SAR_CLT_DTRB SCD 
     , SCO_LEGR_CD_CMB SLC 
     , SAR_ASA_MST SAM
     , SAR_AGN_CLT_RFND_MST SACR     
     , SAR_OTS_CHG SOC 
     , SAR_OTS_HIS SOHI       
     , MDM_ORGANIZATION MO
     --20150306 wskim MDM_ACCOUNT 추가
     ,  MDM_ACCOUNT MA
     ,  MDM_CUSTOMER    MC --20161012 Migration 관련 수정
     , (SELECT SLD.LU_CD CURR_CD
        FROM   SCO_LU_HDR SLH
              ,SCO_LU_DTL SLD
        WHERE  SLH.LU_APPL_CD ='SCO'
        AND    SLH.LU_TP_CD ='FUNCTIONAL CURRENCY'
        AND    SLH.LU_TP_CD = SLD.LU_TP_CD) FC
WHERE  SAH.ADJ_HIS_SEQ = SCD.DTRB_SRC_SEQ 
AND    SCD.DTRB_CD_CMB_SEQ = SLC.CD_CMB_SEQ 
AND    SCD.CUST_CNT_CD = MC.CUST_CNT_CD(+) --20161012 Migration 관련 수정
AND    SCD.CUST_SEQ = MC.CUST_SEQ(+) --20161012 Migration 관련 수정
AND    SAH.OTS_HIS_SEQ = SOC.OTS_HIS_SEQ 
AND    SAH.CHG_TP_CD = SOC.CHG_TP_CD
AND    SOC.OTS_HIS_SEQ = SOHI.OTS_HIS_SEQ
AND    SAH.ADJ_NO = SAM.ASA_NO
AND    SAM.ASA_NO = SACR.ASA_NO
AND    SOHI.OTS_OFC_CD = SACR.AR_OFC_CD
AND    SOHI.BL_NO = SACR.BL_NO
AND    SOC.CHG_TP_CD = SACR.CHG_TP_CD
--asa curr 환산 환율 구하는 중    
AND    MO.OFC_CD = SAM.AGN_CD
--20150306 wskim MDM_ACCOUNT 추가
AND    SLC.SGM_CTNT4 = MA.ACCT_CD
AND    SCD.DTRB_SRC_TBL_CD = 'ADJ'
#if (${asa_no} != '' )
AND    SAH.ADJ_NO = @[asa_no]
#end
AND    SCD.AR_IF_STS_CD = @[check_status]
#if (${grp_yn} == 'Y' )
) GROUP BY
 ACCT_CO_CD
,IF_DOC_TP_CD
,DOC_DT
,PST_DT
,REF_DOC_NO
,DOC_HDR_CD
,CURR_CD
,TAX_CALC_AUTO_FLG
,PST_KEY_CD
,VAT_TAX_CD
,ASGN_NO
,ITM_DESC
,PLN_DT
,COST_CTR_CD
,ORD_NO
,MN_ASET_NO
,SUB_ASET_NO
,ASET_TJ_TP_CD
,ASET_VAL_DT
,GL_ACCT_NO
,CUST_NO
,VNDR_CRTR_ACCT_NO
,DUE_DT_CALC_BSEL_DT
,PAY_MZD_CD
,STE_CNTRL_BANK_IND_CD
,MTRL_NO
,FUEL_LAND_QTY
,MEAS_BSE_UT_CD
,PFITCTR_CD
,ALTN_ACCT_NO
,BIZ_PRNR_REF_KEY_CD1
,BIZ_PRNR_REF_KEY_CD2
,LINE_ITM_REF_KEY_CD
,INSTR_KEY_CD1
,INSTR_KEY_CD2
,INSTR_KEY_CD3
,PAY_REF_CD
,AUTOMTC_PAY_CURR_CD
,PAY_CURR_AMT
,CTRT_NO
,CTRT_TP_CD
,PAY_RSN_CD
,CLSS_CD
,ACT_PLC_CD
,ENTR_EXPN_ID
,BUD_MGMT_DIV_CD
,ACT_DT
,VSL_CD
,VVL_CD
,HUS_BANK_ID
,PAY_BLCK_KEY_CD
,REC_TP_CD
,RVS_FLG
,CRE_USR_ID
,UPD_USR_ID
 ORDER BY RVS_FLG 
#end			]]></sql>
			<params>
				<param name="asa_no" type="12" value="" out="N"/>
				<param name="check_status" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
