<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountPayablePaymentDBDAOSearchPaymentScheduleListRSQL">
			<desc><![CDATA[STM_SAP_0050 select를 위한 쿼리]]></desc>
			<sql><![CDATA[
SELECT  P.DUE_DT                                 AS DUE_DT
      , I.OFC_CD                                 AS OFC_CD
      , I.AP_PAY_GRP_LU_CD                       AS AP_PAY_GRP_LU_CD
      , MV.VNDR_SEQ || '_' || MV.VNDR_LGL_ENG_NM AS VNDR_LGL_ENG_NM
      , I.INV_NO                                 AS INV_NO
      , I.GL_DT                                  AS GL_DT
      , I.INV_CURR_CD                            AS INV_CURR_CD
      , TRIM(OPUSADM.SAP_GET_CUR_AMT_FNC(I.INV_CURR_CD, P.PAY_RMN_AMT))  AS PAY_RMN_AMT
      , I.INV_DESC                               AS INV_DESC
      , SUP_BANK.SUPPLIER_BANK_N_ACCT_NUM        AS BANK_ACCT_NO
      , I.PAY_MZD_LU_CD                          AS PAY_MZD_LU_CD
 FROM   SAP_PAY_SKD P
      , SAP_INV_HDR I
      , MDM_VENDOR MV
      , (SELECT SBA.BANK_ACCT_NO
               ,SBA.BANK_ACCT_SEQ
               ,SBB.BANK_NM || '_' || SBA.BANK_ACCT_NO SUPPLIER_BANK_N_ACCT_NUM
          FROM SAP_BANK_BRNC SBB
              ,SAP_BANK_ACCT SBA
         WHERE SBB.BANK_BRNC_SEQ = SBA.BANK_BRNC_SEQ) SUP_BANK
 WHERE MV.VNDR_SEQ    = I.VNDR_NO
   AND I.INV_SEQ      = P.INV_SEQ
   AND P.XTER_BANK_ACCT_SEQ = SUP_BANK.BANK_ACCT_SEQ(+)
   AND I.INV_CXL_DT   IS NULL
   AND P.PAY_RMN_AMT  <> 0
   AND (I.PAY_STS_FLG = 'N' OR I.PAY_STS_FLG = 'P')
   AND P.PAY_STS_FLG  <> 'Y'
   AND (I.AP_APSTS_CD IN ('WFAPPROVED', 'NOT REQUIRED', 'MANUALLY APPROVED'))
   AND NVL(P.INV_HLD_FLG, 'N') = 'N'
   AND I.OFC_CD       = @[ofc_cd]
   AND P.DUE_DT       >= TO_DATE(@[due_dt_fr], 'YYYY-MM-DD')
   AND P.DUE_DT       < TO_DATE(@[due_dt_to], 'YYYY-MM-DD') + 1
#if (${ap_pay_grp_lu_cd} != '') 
   AND I.AP_PAY_GRP_LU_CD = @[ap_pay_grp_lu_cd]
#end
#if (${pay_mzd_lu_cd} != '') 
   AND I.PAY_MZD_LU_CD = @[pay_mzd_lu_cd]
#end
#if (${vndr_no} != '') 
   AND MV.VNDR_SEQ   = @[vndr_no]
#end
#if (${inv_curr_cd} != '') 
   AND I.INV_CURR_CD = @[inv_curr_cd]
#end
 ORDER BY P.DUE_DT, I.INV_CURR_CD, I.AP_PAY_GRP_LU_CD, MV.VNDR_SEQ			]]></sql>
			<params>
				<param name="ofc_cd" type="12" value="" out="N"/>
				<param name="due_dt_fr" type="12" value="" out="N"/>
				<param name="due_dt_to" type="12" value="" out="N"/>
				<param name="ap_pay_grp_lu_cd" type="12" value="" out="N"/>
				<param name="pay_mzd_lu_cd" type="12" value="" out="N"/>
				<param name="vndr_no" type="12" value="" out="N"/>
				<param name="inv_curr_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
