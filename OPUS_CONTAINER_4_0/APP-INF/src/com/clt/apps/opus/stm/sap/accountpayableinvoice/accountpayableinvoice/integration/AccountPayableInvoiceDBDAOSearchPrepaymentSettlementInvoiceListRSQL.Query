<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="AccountPayableInvoiceDBDAOSearchPrepaymentSettlementInvoiceListRSQL">
			<desc><![CDATA[searchPrepaymentSettlementInvoiceList]]></desc>
			<sql><![CDATA[
SELECT
   INV_SEQ
 , VNDR_NO
 , INV_NO
 , INV_CURR_CD
 , INV_PAY_CURR_CD
 , TRIM(SAP_GET_CUR_AMT_FNC(INV_CURR_CD, INV_AMT ))  INV_AMT
 , INV_PAY_AMT
 , INV_DT
 , AP_INV_SRC_CD
 , INV_TP_LU_CD
 , INV_DESC
 , BAT_SEQ
 , INV_VAT_AMT
 , INV_TERM_NM
 , INV_TERM_DT
 , PAY_MZD_LU_CD
 , AP_PAY_GRP_LU_CD
 , PAY_STS_FLG
 , INV_FUNC_AMT
 , INV_VAT_CD
 , INV_XCH_RT
 , INV_XCH_RT_TP_CD
 , INV_XCH_DT
 , ERY_STL_DT
 , ATTR_CATE_NM
 , AP_APSTS_CD
 , INV_CXL_DT
 , CXL_USR_ID
 , INV_CXL_AMT
 , OFC_CD
 , GLO_ATTR_CATE_NM
 , PAY_CURR_INV_AMT
 , GL_DT
 , INV_APRO_RDY_FLG
 , DTRB_SET_SEQ
 , XTER_BANK_ACCT_SEQ
 , LIAB_CD_CMB_SEQ
 , ( SELECT VNDR_LGL_ENG_NM FROM MDM_VENDOR WHERE VNDR_SEQ = TO_NUMBER(H.VNDR_NO) AND ROWNUM=1 ) AS VNDR_LGL_ENG_NM
 , (
	 SELECT  TRIM( SAP_GET_CUR_AMT_FNC(H.INV_CURR_CD, SUM(NVL(SID.PPAY_RMN_AMT, SID.DTRB_AMT))) ) 
     FROM    SAP_INV_DTL SID
     WHERE   SID.INV_SEQ = H.INV_SEQ
     AND     SID.LINE_TP_LU_CD IN ('ITEM', 'ACCRUAL', 'REC_TAX', 'NONREC_TAX')
     AND     NVL(SID.RVS_FLG, 'N') <> 'Y'
    )  AS PREPAY_RMN_TOT_AMT 
 ,(SELECT NVL(DP_PRCS_KNT, 0) FROM MDM_CURRENCY M WHERE M.CURR_CD = H.INV_CURR_CD AND ROWNUM=1 ) AS INV_CURR_PRCS
FROM SAP_INV_HDR H
WHERE 1=1
#if (${inv_seq} != '') 
AND H.INV_SEQ = @[inv_seq]
#end			]]></sql>
			<params>
				<param name="inv_seq" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
