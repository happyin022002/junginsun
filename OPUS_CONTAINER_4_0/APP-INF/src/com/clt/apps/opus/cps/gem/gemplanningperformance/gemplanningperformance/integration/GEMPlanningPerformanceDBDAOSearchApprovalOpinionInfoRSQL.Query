<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="GEMPlanningPerformanceDBDAOSearchApprovalOpinionInfoRSQL">
			<desc><![CDATA[요청된 비용계획에 대하여 승인 정보를 조회한다]]></desc>
			<sql><![CDATA[
SELECT DECODE(COUNT(GEN_EXPN_APRO_STEP_CD), 0, 'RQST', 'RQST' ) GEN_EXPN_APRO_STEP_CD
, MAX(GEN_EXPN_APSTS_CD) GEN_EXPN_APSTS_CD
, MAX(DECODE(GEN_EXPN_APSTS_CD, 'AP', UPD_USR_ID, 'RJ', UPD_USR_ID, '' )) UPD_USR_ID
, MAX(DECODE(GEN_EXPN_APSTS_CD, 'AP', TO_CHAR(UPD_DT, 'YYYYMMDD'), 'RJ', TO_CHAR(UPD_DT, 'YYYYMMDD'), '' )) UPD_DT
, MAX(DECODE(GEN_EXPN_APSTS_CD, 'AP', APRO_OPIN_RMK, 'RJ', APRO_OPIN_RMK, '' )) APRO_OPIN_RMK
FROM GEM_APRO_STEP
WHERE GEN_EXPN_RQST_NO = @[gen_expn_rqst_no]
AND GEN_EXPN_CD = @[gen_expn_cd]
AND GEN_EXPN_ITM_NO = @[gen_expn_item_no]
AND GEN_EXPN_APRO_STEP_CD = 'RQ'

UNION ALL

SELECT DECODE(COUNT(GEN_EXPN_APRO_STEP_CD), 0, 'RHQ | BU', 'RHQ | BU' ) GEN_EXPN_APRO_STEP_CD
, MAX(GEN_EXPN_APSTS_CD) GEN_EXPN_APSTS_CD
, MAX(DECODE(GEN_EXPN_APSTS_CD, 'AP', UPD_USR_ID, 'RJ', UPD_USR_ID, '' )) UPD_USR_ID
, MAX(DECODE(GEN_EXPN_APSTS_CD, 'AP', TO_CHAR(UPD_DT, 'YYYYMMDD'), 'RJ', TO_CHAR(UPD_DT, 'YYYYMMDD'), '' )) UPD_DT
, MAX(DECODE(GEN_EXPN_APSTS_CD, 'AP', APRO_OPIN_RMK, 'RJ', APRO_OPIN_RMK, '' )) APRO_OPIN_RMK
FROM GEM_APRO_STEP
WHERE GEN_EXPN_RQST_NO = @[gen_expn_rqst_no]
AND GEN_EXPN_CD = @[gen_expn_cd]
AND GEN_EXPN_ITM_NO = @[gen_expn_item_no]
AND GEN_EXPN_APRO_STEP_CD = 'HQ'

UNION ALL

SELECT DECODE(COUNT(GEN_EXPN_APRO_STEP_CD), 0, 'TIC', 'TIC' ) GEN_EXPN_APRO_STEP_CD
, MAX(GEN_EXPN_APSTS_CD) GEN_EXPN_APSTS_CD
, MAX(DECODE(GEN_EXPN_APSTS_CD, 'AP', UPD_USR_ID, 'RJ', UPD_USR_ID, '' )) UPD_USR_ID
, MAX(DECODE(GEN_EXPN_APSTS_CD, 'AP', TO_CHAR(UPD_DT, 'YYYYMMDD'), 'RJ', TO_CHAR(UPD_DT, 'YYYYMMDD'), '' )) UPD_DT
, MAX(DECODE(GEN_EXPN_APSTS_CD, 'AP', APRO_OPIN_RMK, 'RJ', APRO_OPIN_RMK, '' )) APRO_OPIN_RMK
FROM GEM_APRO_STEP
WHERE GEN_EXPN_RQST_NO = @[gen_expn_rqst_no]
AND GEN_EXPN_CD = @[gen_expn_cd]
AND GEN_EXPN_ITM_NO = @[gen_expn_item_no]
AND GEN_EXPN_APRO_STEP_CD = 'TC'

UNION ALL

SELECT DECODE(COUNT(GEN_EXPN_APRO_STEP_CD), 0, 'COM', 'COM' ) GEN_EXPN_APRO_STEP_CD
, MAX(GEN_EXPN_APSTS_CD) GEN_EXPN_APSTS_CD
, MAX(DECODE(GEN_EXPN_APSTS_CD, 'AP', UPD_USR_ID, 'RJ', UPD_USR_ID, '' )) UPD_USR_ID
, MAX(DECODE(GEN_EXPN_APSTS_CD, 'AP', TO_CHAR(UPD_DT, 'YYYYMMDD'), 'RJ', TO_CHAR(UPD_DT, 'YYYYMMDD'), '' )) UPD_DT
, MAX(DECODE(GEN_EXPN_APSTS_CD, 'AP', APRO_OPIN_RMK, 'RJ', APRO_OPIN_RMK, '' )) APRO_OPIN_RMK
FROM GEM_APRO_STEP
WHERE GEN_EXPN_RQST_NO = @[gen_expn_rqst_no]
AND GEN_EXPN_CD = @[gen_expn_cd]
AND GEN_EXPN_ITM_NO = @[gen_expn_item_no]
AND GEN_EXPN_APRO_STEP_CD = 'CO'
			]]></sql>
			<params>
				<param name="gen_expn_rqst_no" type="12" value="" out="N"/>
				<param name="gen_expn_cd" type="12" value="" out="N"/>
				<param name="gen_expn_item_no" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
