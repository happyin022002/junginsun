<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="NetworkCostDBDAOCreatePndlmSvcDtlCSQL">
			<desc><![CDATA[]]></desc>
			<sql><![CDATA[
INSERT INTO COA_PNDLM_SVC_DTL (
         SLAN_CD
        ,DIR_CD
        ,RLANE_CD
        ,YD_CD
        ,EFF_FM_DT
        ,EFF_TO_DT
        ,PNDLM_RTO								--20151210.ADD
        ,CRE_USR_ID
        ,CRE_DT
        ,UPD_USR_ID
        ,UPD_DT)
SELECT DISTINCT  
         @[slan_cd]
        ,@[dir_cd] 
        ,@[rlane_cd]
        ,TRIM(YD_CD)			AS YD_CD
        ,@[eff_fm_dt]
        ,@[eff_to_dt]
        ,TO_NUMBER(TRIM('0'))	AS PNDLM_RTO			--20151210.ADD
        ,@[cre_usr_id]
        ,SYSDATE
        ,@[upd_usr_id]       
        ,SYSDATE
   FROM VSK_VSL_PORT_SKD 
  WHERE SLAN_CD    = @[slan_cd]
    AND SKD_DIR_CD = @[dir_cd]
    AND TO_CHAR(PF_ETD_DT,'YYYYMMDD')  > @[eff_fm_dt]	--20151215.MOD
 UNION ALL												--20151210.ADD
  SELECT  
         @[slan_cd]
        ,@[dir_cd] 
        ,@[rlane_cd]
        ,TRIM('XXXXXXX')		AS YD_CD
        ,@[eff_fm_dt]
        ,@[eff_to_dt]
        ,DECODE(@[last_yn],'Y',1-(ROUND(1/TO_NUMBER(@[rs_cnt]),2)*(TO_NUMBER(@[rs_cnt])-1)),ROUND(1/TO_NUMBER(@[rs_cnt]),2))	AS PNDLM_RTO
        ,@[cre_usr_id]
        ,SYSDATE
        ,@[upd_usr_id]       
        ,SYSDATE
   FROM DUAL			]]></sql>
			<params>
				<param name="slan_cd" type="12" value="" out="N"/>
				<param name="dir_cd" type="12" value="" out="N"/>
				<param name="rlane_cd" type="12" value="" out="N"/>
				<param name="eff_fm_dt" type="12" value="" out="N"/>
				<param name="eff_to_dt" type="12" value="" out="N"/>
				<param name="cre_usr_id" type="12" value="" out="N"/>
				<param name="upd_usr_id" type="12" value="" out="N"/>
				<param name="last_yn" type="12" value="" out="N"/>
				<param name="rs_cnt" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
