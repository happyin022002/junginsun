<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="KoreaCustomsReportDBDAOsearchTransHistBySndDtRSQL">
			<desc><![CDATA[Send Date를 이용하여 Transmit History를 조회한다.]]></desc>
			<sql><![CDATA[
SELECT /*+ ORDERED */distinct  
	   DECODE(SLOG.MSG_LOG_TP_ID,'5ID',DECODE(vvd.DCHG_RPT_SND_DT,null,'Un-Send','Send'),'6TA',DECODE(SLOG.SND_DT,null,'Un-Send','Send'),'6TC',DECODE(SLOG.SND_DT,null,'Un-Send','Send'),decode(vvd.MF_SND_DT,null,'Un-Send','Send')) IF_SENDED
     , MSG_LOG_TP_ID  A_MSG_LOG_TP_ID
     , TRIM(MF_RCVR_USR_ID) A_MF_RCVR_USR_ID
     , ' ' A_RECEIVER
     , CORR_CD1 A_CORR_CD1
     , DECODE(SLOG.MSG_LOG_TP_ID,'5ID',DECODE(vvd.DCHG_RPT_SND_DT,null,' ',TO_CHAR(SLOG.SND_DT,'YYYYMMDD')),'6TA',TO_CHAR(SLOG.SND_DT,'YYYYMMDD'),'6TC',TO_CHAR(SLOG.SND_DT,'YYYYMMDD'),DECODE(vvd.MF_SND_DT,null,' ',TO_CHAR(SLOG.SND_DT, 'YYYYMMDD'))) A_SND_DT_DD
     , DECODE(SLOG.MSG_LOG_TP_ID,'5ID',DECODE(vvd.DCHG_RPT_SND_DT,null,' ',TO_CHAR(SLOG.SND_DT,'hh24:mi:ss')),'6TA',TO_CHAR(SLOG.SND_DT,'hh24:mi:ss'),'6TC',TO_CHAR(SLOG.SND_DT,'hh24:mi:ss'),DECODE(vvd.MF_SND_DT,null,' ',TO_CHAR(SLOG.SND_DT, 'hh24:mi:ss'))) A_SND_DT_TT
     , VVD.VSL_CD||VVD.SKD_VOY_NO||VVD.SKD_DIR_CD A_VVD_CD
     , POL_CD A_POL_CD
     , POD_CD A_POD_CD
     , OFC_CD A_OFC_CD
     , BL_NO A_BL_NO
     , SMT_AMD_NO A_SUBMIT_NO
     , BL_KNT A_BL_KNT
     , TTL_FEU_KNT A_FLD_40FT
     , TTL_TEU_KNT A_FLD_20FT
     , TRSM_USR_ID A_TRSM_USR_ID
     , DECODE(KR_CSTMS_DECL_CD,'N',' ',KR_CSTMS_DECL_CD) A_KS_TYPE
     , ' ' A_C_TP
     , ' ' A_E_SVC_SEND_DATE
     , SLOG.MF_SND_SEQ MF_SND_SEQ
     , (SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD02959' AND INTG_CD_VAL_CTNT = SLOG.TRSM_CXL_TP_CD) TRSM_CXL_TP_CD
     , (SELECT INTG_CD_VAL_DP_DESC FROM COM_INTG_CD_DTL WHERE INTG_CD_ID = 'CD02960' AND INTG_CD_VAL_CTNT = SLOG.TRSM_CXL_RSN_CD) TRSM_CXL_RSN_CD
     , SLOG.TRSM_CXL_DESC
  FROM BKG_CSTMS_KR_VVD_SMRY VVD, BKG_CSTMS_KR_SND_LOG SLOG
 WHERE VVD.VSL_CD(+) = SLOG.VSL_CD
   AND VVD.SKD_VOY_NO(+) = SLOG.SKD_VOY_NO
   AND VVD.SKD_DIR_CD(+) = SLOG.SKD_DIR_CD                    
   AND MSG_LOG_TP_ID = NVL(@[in_msg_type],MSG_LOG_TP_ID)
   AND SLOG.SND_DT >= TO_DATE(@[in_snd_dt_s]||'000000', 'YYYYMMDDHH24MISS') 
   AND SLOG.SND_DT <= TO_DATE(@[in_snd_dt_e]||'235959', 'YYYYMMDDHH24MISS')
   AND NVL(KR_CSTMS_DECL_CD,' ') Like @[in_ks_type]||'%'
   AND NVL(POL_CD,' ') Like @[in_pol_cd]||'%'
   AND NVL(POD_CD,' ') Like @[in_pod_cd]||'%'
   AND NVL(OFC_CD,' ') Like @[in_ofc_cd]||'%'
   AND NVL(TRSM_USR_ID,' ') Like @[in_usr_id]||'%'
 ORDER BY A_SND_DT_DD, A_SND_DT_TT			]]></sql>
			<params>
				<param name="in_msg_type" type="12" value="" out="N"/>
				<param name="in_snd_dt_s" type="12" value="" out="N"/>
				<param name="in_snd_dt_e" type="12" value="" out="N"/>
				<param name="in_ks_type" type="12" value="" out="N"/>
				<param name="in_pol_cd" type="12" value="" out="N"/>
				<param name="in_pod_cd" type="12" value="" out="N"/>
				<param name="in_ofc_cd" type="12" value="" out="N"/>
				<param name="in_usr_id" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
