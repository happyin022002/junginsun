<?xml version="1.0" encoding="UTF-8"?>
<sqls>
	<querys>
		<query name="OfficeMappingDBDAOSearchLaneOfficeRelationNewLaneAddListRSQL">
			<desc><![CDATA[RHQ-Office Mapping Data 를 조회]]></desc>
			<sql><![CDATA[
SELECT DECODE(O.RHQ_CD, NULL, 0, 1) + DECODE(O.RGN_OFC_CD, NULL, 0, 1) AS LVL
        ,O.RHQ_CD
        ,O.RGN_OFC_CD
    FROM CSQ_QTA_OFC O
        ,CSQ_DAT_RLT R
        ,(
			SELECT DECODE(A2.CPY_NO, 1, NVL(TRD_CD,@[f_trd_cd])) AS TRD_CD
                  ,DECODE(A2.CPY_NO, 1, NVL(CONV_DIR_CD, @[f_dir_cd])) AS CONV_DIR_CD
                  ,DECODE(A2.CPY_NO, 1, NVL(DIR_CD, @[f_dir_cd])) AS DIR_CD
              FROM CSQ_DIR_CONV A1
                  ,COM_CPY_NO A2
             WHERE A1.BSE_TP_CD(+)  = @[f_bse_tp_cd]
               AND A1.BSE_YR(+)     = @[f_bse_yr]
               AND A1.BSE_QTR_CD(+) = DECODE(@[f_bse_tp_cd], 'Y', '00', @[f_bse_qtr_cd])
               AND A1.TRD_CD(+)     = @[f_trd_cd]
               AND A1.RLANE_CD(+)   = @[f_rlane_cd]
               AND A1.DIR_CD(+)     = @[f_dir_cd]
               AND DECODE(A2.CPY_NO, 1, @[f_bse_tp_cd]) = A1.BSE_TP_CD(+)
               AND A2.CPY_NO        = 1
   
         ) C
   WHERE 1=1
     AND R.BSE_TP_CD   = @[f_bse_tp_cd]
     AND R.BSE_YR      = @[f_bse_yr]
     AND R.BSE_QTR_CD  = DECODE(@[f_bse_tp_cd], 'Y', '00', @[f_bse_qtr_cd])
     AND R.OFC_VW_CD   = SUBSTR(@[f_ofc_vw_cd], 1, 1)

     AND O.RHQ_CD      = R.RHQ_CD
     AND O.DELT_FLG    = 'N'
     
     AND R.TRD_CD      = C.TRD_CD
     AND R.CONV_DIR_CD = C.CONV_DIR_CD
GROUP BY GROUPING SETS (
                         (O.RHQ_CD)
                        ,(O.RHQ_CD, O.RGN_OFC_CD)
                       )
ORDER BY RHQ_CD
        ,LVL
        ,RGN_OFC_CD			]]></sql>
			<params>
				<param name="f_trd_cd" type="12" value="" out="N"/>
				<param name="f_dir_cd" type="12" value="" out="N"/>
				<param name="f_bse_tp_cd" type="12" value="" out="N"/>
				<param name="f_bse_yr" type="12" value="" out="N"/>
				<param name="f_bse_qtr_cd" type="12" value="" out="N"/>
				<param name="f_rlane_cd" type="12" value="" out="N"/>
				<param name="f_ofc_vw_cd" type="12" value="" out="N"/>
			</params>
		</query>
	</querys>
</sqls>
